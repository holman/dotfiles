# Setup new machine from scratch

## manual installations
chrome

## rsync files
clean up old home directory, check for anything new to exclude, then:
`./.dotfiles/macos/sync_new_cp.sh`

## settings
keyboard->modifer keys->caps-lock = ctrl

## setup with dotfiles
clone dotfiles repo
`./.dotfiles/script/bootstrap`

## brew install
`brew bundle --file homebrew/Brewfile`  

## time machine

```
sudo tmutil inheritbackup /Volumes/DISKNAME/Backups.backupdb/COMPUTERNAME
sudo tmutil setdestination /Volumes/DISKNAME
sudo tmutil associatedisk -a / /Volumes/DISKNAME/Backups.backupdb/COMPUTERNAME/Latest/Macintosh\ HD
```
better to manually set exclusions while viewing old exclusions since there is 
no obvious way to dump these. There is an option to show hidden files during 
exclusion. Best to exclude repo `.git` and data folders, `Desktop`, `Downloads`
`temp`; drag `/System` to exclude all system files; `/usr` to ensure homebrew
files are not backed up.

## duplicati
On old machine turn off duplicati on startup: Users & Groups -> Login Items
copy `~/.config/Duplicati` to new machine and open duplicati.

## mail backup
link google account
Download attachments: all

## keychain
I didn't do this for new setup in June 2021 but you can:
```
scp ~/Library/Keychains/login.keychain-db NEWCP:~/Library/Keychains/oldlogin.keychain-db
```
then in keychain app; `file->Add Keychain`; drag and drop anything you want to keep.

## Launch Agents
.dotfiles/macos/install.sh sets these up for you
`sudo launchctl load SOME_SERVICE.plist` to load service
`sudo launchctl unload SOME_SERVICE.plist` to unload

# Setup machine from time machine backup
You don't back up system files so don't do system restore:  
- use migration assistant to restore files and computer settings
- `./.dotfiles/bootstrap`
- `brew bundle --file homebrew/Brewfile`  
- git clone hwpl (since data/ and .git are not backed up)  
- set iterm shell to ...


