(function(e){function t(t){for(var n,i,o=t[0],u=t[1],l=t[2],m=0,p=[];m<o.length;m++)i=o[m],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&p.push(a[i][0]),a[i]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(e[n]=u[n]);c&&c(t);while(p.length)p.shift()();return r.push.apply(r,l||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],n=!0,o=1;o<s.length;o++){var u=s[o];0!==a[u]&&(n=!1)}n&&(r.splice(t--,1),e=i(i.s=s[0]))}return e}var n={},a={app:0},r=[];function i(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=n,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(s,n,function(t){return e[t]}.bind(null,n));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var c=u;r.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"034f":function(e,t,s){"use strict";s("64a9")},"2d72":function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);s("cadf"),s("551c"),s("f751"),s("097d");var n=s("a026"),a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{style:e.cssProps,attrs:{id:"app"}},[s("div",{staticClass:"vue-container"},[s("messages-section",{attrs:{messages:e.messages,users:e.users}}),s("form-section",{ref:"formSection",attrs:{window:e.window,users:e.users,atMentions:e.atMentions,status:e.statusText}}),s("div",{class:e.setInfoBoxStyle},[e.window.infoMessage?s("markdown-element",{attrs:{text:e.window.infoMessage,inline:!1}}):e._e()],1)],1)])},r=[],i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"messages-section"},e._l(e.messages,(function(t){return s("messages-date-group",{key:t.date,attrs:{users:e.users,groups:t.groups,date:t.date}})})),1)},o=[],u=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"messages-date-section"},[s("date-separator",{attrs:{date:e.date}}),e._l(e.groups,(function(t){return s("message-group",{key:t.key,attrs:{messages:t.messages,users:e.users,userId:t.userId,user:t.user,timestamp:t.minTimestamp}})}))],2)},l=[],c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message-group"},[s("div",{staticClass:"message-group-image"},[s("img",{attrs:{src:e.user?e.user.avatarUri:null}})]),s("div",{staticClass:"message-group-content"},[s("div",[s("strong",[e._v(e._s(e.userName))]),e._v("\n             \n            "),s("span",{staticClass:"timestamp"},[e._v(e._s(e.readableTimestamp))])]),s("ul",{staticClass:"message-list"},e._l(e.messages,(function(t){return s("message-item",{key:t.timestamp,attrs:{message:t,users:e.users}})})),1)])])},m=[],p=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("li",{class:{unread:e.message.isUnread}},[s("markdown-element",{attrs:{inline:!1,text:e.message.text}}),e.message.isEdited?s("span",{staticClass:"edited"},[e._v("(edited)")]):e._e(),s("message-reactions",{attrs:{reactions:e.message.reactions}}),e.message.content?s("message-content",{attrs:{content:e.message.content}}):e._e(),e.hasReplies?s("message-replies",{attrs:{message:e.message,users:e.users}}):e._e()],1)},d=[],f=(s("ac6a"),s("456d"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"li-line",style:{borderColor:e.borderColor}},[e.content.pretext?s("div",[e._v(e._s(e.content.pretext)+" ")]):e._e(),e.content.author?s("message-author",{attrs:{content:e.content}}):e._e(),e.content.title?s("message-title",{attrs:{content:e.content}}):e._e(),e.content.text?s("markdown-element",{attrs:{text:e.content.text,inline:!1}}):e._e(),e.content.footer?s("markdown-element",{attrs:{text:e.content.footer,inline:!0}}):e._e()],1)}),g=[],h=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"msg-title"},[s("a",{attrs:{href:e.content.titleLink,onclick:e.titleOnclick,tabindex:-1}},[e._v("\n    "+e._s(e.content.title)+"\n    ")])])},v=[],_=acquireVsCodeApi();function b(e,t){_.postMessage({type:e,body:t})}function x(e){var t=new Date(1e3*+e);return t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}function y(e){return b("link",e)}var w={name:"message-title",props:["content"],methods:{titleOnclick:function(){return y(this.content.titleLink),!1}}},O=w,j=s("2877"),k=Object(j["a"])(O,h,v,!1,null,null,null),E=k.exports,C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"msg-author"},[s("img",{attrs:{src:e.content.authorIcon}}),s("span",[e._v(e._s(e.content.author))])])},M=[],T={name:"message-author",props:["content"]},S=T,I=Object(j["a"])(S,C,M,!1,null,null,null),$=I.exports,L=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.html?s("div",{style:e.inlineStyleObject,domProps:{innerHTML:e._s(e.html)}}):e._e()},P=[],R=s("d4cd"),D=s("5371");var U={name:"markdown-element",props:["text","inline"],computed:{html:function(){var e=new R({breaks:!0}).use(D);return this.inline?e.renderInline(this.text):e.render(this.text)},inlineStyleObject:function(){return{display:this.inline?"inline":"block"}}}},F=U,K=Object(j["a"])(F,L,P,!1,null,null,null),H=K.exports,B={name:"message-content",props:["content"],computed:{borderColor:function(){var e=this.content.borderColor,t="var(--vscode-scrollbarSlider-activeBackground)";return e?"#".concat(e):t}},components:{MessageTitle:E,MessageAuthor:$,MarkdownElement:H}},N=B,A=Object(j["a"])(N,f,g,!1,null,null,null),z=A.exports,G=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ul",{staticClass:"message-reactions"},e._l(e.reactions,(function(e){return s("message-reaction",{key:e.name,attrs:{emoji:e.name,count:e.count,users:e.userIds}})})),1)},J=[],V=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("li",[s("div",[e._v(e._s(e.emoji))]),s("div",[e._v(e._s(e.count))])])},q=[],W={name:"message-reaction",props:["emoji","count","users"]},Z=W,Q=Object(j["a"])(Z,V,q,!1,null,null,null),X=Q.exports,Y={name:"message-reactions",props:["reactions"],components:{MessageReaction:X}},ee=Y,te=Object(j["a"])(ee,G,J,!1,null,null,null),se=te.exports,ne=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"replies-container"},[s("div",{staticClass:"replies-summary"},[s("message-replies-images",{attrs:{images:e.imageUrls}}),s("div",[e._v(e._s(e.count)+" replies")]),s("div",[s("a",{staticClass:"pointer",on:{click:e.expandHandler}},[e._v(e._s(e.expandText))])])],1),e.isExpanded?s("ul",{staticClass:"replies"},e._l(e.message.replies,(function(t){return s("message-reply-item",{key:t.timestamp,attrs:{users:e.users,userId:t.userId,timestamp:t.timestamp,text:t.text}})})),1):e._e(),e.isExpanded?s("message-input",{ref:"threadFormSection",attrs:{placeholder:e.placeholder,users:e.users,onSubmit:e.onSubmit}}):e._e()],1)},ae=[],re=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("vue-tribute",{attrs:{options:e.tributeOptions}},[s("p",{directives:[{name:"focus",rawName:"v-focus"}],ref:"messageInput",staticClass:"editable",attrs:{contenteditable:"","data-ph":e.placeholderText},on:{keydown:function(t){return t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.onKeydown(t)},focus:e.onFocus,input:e.onInput,"tribute-replaced":e.onTributeReplaced}})])},ie=[],oe=(s("7f7f"),s("8615"),s("24cb")),ue={name:"message-input",props:["placeholderText","users","onSubmit"],components:{VueTribute:oe["a"]},watch:{users:function(e,t){var s=this;Object.keys(e).length!==Object.keys(t).length&&setTimeout((function(){s.tributeOptions.values=Object.values(e).map((function(e){return{key:e.name,value:e.name}}))}),200)}},data:function(){return{text:"",inComposition:!1,sendTypingEvents:!0,tributeOptions:{values:[],selectTemplate:function(e){return'<span class="at-mention" contenteditable="false">@'.concat(e.original.value,"</span>")}}}},mounted:function(){var e=this;this.$refs.messageInput.addEventListener("compositionstart",(function(t){e.inComposition=!0})),this.$refs.messageInput.addEventListener("compositionend",(function(t){e.inComposition=!1}))},methods:{onSubmitFunc:function(e){this.onSubmit(this.text),this.clearInput()},onFocus:function(e){return b("is_focused")},onKeydown:function(e){var t=this;"Enter"!==e.code||e.shiftKey||this.inComposition?this.sendTypingEvents&&(this.sendTypingEvents=!1,b("typing"),setTimeout((function(){t.sendTypingEvents=!0}),300)):(e.preventDefault(),this.text&&this.onSubmitFunc())},clearInput:function(){this.text="",this.$refs.messageInput.innerHTML=""},onInput:function(e){this.text=e.target.innerText},onTributeReplaced:function(e){console.log("replaced",e.detail)}}};n["a"].directive("focus",{inserted:function(e){e.focus()}});var le=ue,ce=(s("dabf"),Object(j["a"])(le,re,ie,!1,null,null,null)),me=ce.exports,pe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"reply-images-container"},e._l(e.images,(function(e){return s("img",{key:e,staticClass:"reply-image",attrs:{src:e}})})),0)},de=[],fe={name:"message-replies-images",props:["images"]},ge=fe,he=Object(j["a"])(ge,pe,de,!1,null,null,null),ve=he.exports,_e=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("li",[s("span",[s("strong",[e._v(e._s(e.username))]),e._v("\n         \n        "),s("span",{staticClass:"timestamp"},[e._v(e._s(e.readableTimestamp)+":")])]),e._v("\n     \n    "),e.text?s("markdown-element",{attrs:{text:e.text,inline:!0}}):e._e()],1)},be=[],xe={name:"message-reply-item",props:["userId","timestamp","text","users"],components:{MarkdownElement:H},computed:{username:function(){var e=this.users[this.userId];return e?e.name:this.userId},readableTimestamp:function(){return x(this.timestamp)}}},ye=xe,we=Object(j["a"])(ye,_e,be,!1,null,null,null),Oe=we.exports,je={name:"message-replies",props:["message","users"],components:{MessageRepliesImages:ve,MessageReplyItem:Oe,MessageInput:me},data:function(){return{isExpanded:!1}},methods:{expandHandler:function(e){var t=this;if(this.isExpanded=!this.isExpanded,this.isExpanded){var s=Object.keys(this.message.replies).filter((function(e){return!t.message.replies[e].text})).length>0;s&&_.postMessage({type:"fetch_replies",parentTimestamp:this.message.timestamp})}},onSubmit:function(e){var t={text:e,parentTimestamp:this.message.timestamp};b("thread_reply",t)}},computed:{imageUrls:function(){var e=this,t=Object.keys(this.message.replies).map((function(t){return e.message.replies[t].userId})),s=t.filter((function(e,s){return t.indexOf(e)==s}));return s.filter((function(t){return t in e.users})).filter((function(t){return e.users[t].avatarUri})).map((function(t){return e.users[t].avatarUri}))},placeholder:function(){return"Reply to thread"},count:function(){return Object.keys(this.message.replies).length},expandText:function(){return this.isExpanded?"Show less":"Show all"}}},ke=je,Ee=(s("c371"),Object(j["a"])(ke,ne,ae,!1,null,null,null)),Ce=Ee.exports,Me={name:"message-item",props:["message","users"],computed:{hasReplies:function(){return Object.keys(this.message.replies).length>0}},components:{MessageContent:z,MessageReplies:Ce,MessageReactions:se,MarkdownElement:H}},Te=Me,Se=Object(j["a"])(Te,p,d,!1,null,null,null),Ie=Se.exports,$e={name:"message-group",props:["messages","users","userId","user","timestamp"],computed:{readableTimestamp:function(){return x(this.timestamp)},userName:function(){return this.user?this.user.displayName:this.userId}},components:{MessageItem:Ie}},Le=$e,Pe=Object(j["a"])(Le,c,m,!1,null,null,null),Re=Pe.exports,De=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("h3",{staticClass:"date-heading"},[e._v(e._s(e.dateString))])},Ue=[],Fe={name:"date-separator",props:["date"],computed:{dateString:function(){var e={weekday:"long",month:"long",day:"numeric",timeZone:"UTC"};return new Date(this.date).toLocaleDateString("en-US",e)}}},Ke=Fe,He=Object(j["a"])(Ke,De,Ue,!1,null,null,null),Be=He.exports,Ne={props:["groups","users","date"],components:{DateSeparator:Be,MessageGroup:Re}},Ae=Ne,ze=Object(j["a"])(Ae,u,l,!1,null,null,null),Ge=ze.exports,Je={name:"messages-section",props:["messages","users"],components:{MessagesDateGroup:Ge},data:function(){return{messagesLength:0}},updated:function(){var e=this.messages.map((function(e){return e.groups})),t=[].concat.apply([],e),s=t.reduce((function(e,t){return e+t.messages.length}),0);s!==this.messagesLength&&(this.messagesLength=s,this.$el.scrollTop=this.$el.scrollHeight)}},Ve=Je,qe=Object(j["a"])(Ve,i,o,!1,null,null,null),We=qe.exports,Ze=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"form-section"},[s("div",{class:e.isDisabled},[s("message-input",{attrs:{onSubmit:e.onSubmit,users:e.users,placeholderText:e.placeholder}}),s("status-text",{attrs:{status:e.status}})],1)])},Qe=[],Xe=(s("f559"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"status-text"},[e._v(e._s(e.status))])}),Ye=[],et={name:"status-text",props:["status"]},tt=et,st=Object(j["a"])(tt,Xe,Ye,!1,null,null,null),nt=st.exports,at={name:"form-section",props:["window","users","status","atMentions"],components:{StatusText:nt,MessageInput:me},computed:{placeholder:function(){return"Message ".concat(this.window?this.window.name:"")},isDisabled:function(){return this.window&&this.window.isDisabled?"disabled":""}},methods:{onSubmit:function(e){var t=e.startsWith("/")?"command":"text";b(t,e)}},mounted:function(){return b("is_ready")}},rt=at,it=(s("de93"),Object(j["a"])(rt,Ze,Qe,!1,null,null,null)),ot=it.exports,ut={name:"app",props:["data"],components:{MessagesSection:We,FormSection:ot,MarkdownElement:H},computed:{messages:function(){return this.data?this.data.messages:[]},users:function(){return this.data?this.data.users:{}},window:function(){return this.data?this.data.window:{}},statusText:function(){return this.data?this.data.statusText:""},atMentions:function(){return this.data?this.data.atMentions:[]},setInfoBoxStyle:function(){return this.data&&this.data.window&&this.data.window.infoMessage?"infoBox":"disabled"},cssProps:function(){return{"--chat-code-font-family":this.data?this.data.fontFamily:"monospace","--chat-font-size":this.data?"".concat(this.data.fontSize,"px"):"12px"}}}},lt=ut,ct=(s("034f"),Object(j["a"])(lt,a,r,!1,null,null,null)),mt=ct.exports,pt=new n["a"]({template:'<app :data="data"> </app>',props:["data"],components:{App:mt},el:"#app"});window.addEventListener("message",(function(e){pt.data=e.data}))},"64a9":function(e,t,s){},b7c1:function(e,t,s){},c371:function(e,t,s){"use strict";s("2d72")},c756:function(e,t,s){},dabf:function(e,t,s){"use strict";s("c756")},de93:function(e,t,s){"use strict";s("b7c1")}});
//# sourceMappingURL=app.js.map