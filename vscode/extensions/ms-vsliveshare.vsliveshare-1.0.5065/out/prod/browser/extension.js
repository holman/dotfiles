!function(e,t){for(var n in t)e[n]=t[n]}(exports,function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(i,s,function(t){return e[t]}.bind(null,s));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=702)}([function(e,t){e.exports=require("vscode")},function(e,t,n){(function(e){e.exports=function(){"use strict";var t,i;function s(){return t.apply(null,arguments)}function r(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function o(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function c(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(a(e,t))return!1;return!0}function l(e){return void 0===e}function u(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function d(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function h(e,t){var n,i=[];for(n=0;n<e.length;++n)i.push(t(e[n],n));return i}function f(e,t){for(var n in t)a(t,n)&&(e[n]=t[n]);return a(t,"toString")&&(e.toString=t.toString),a(t,"valueOf")&&(e.valueOf=t.valueOf),e}function p(e,t,n,i){return Tt(e,t,n,i,!0).utc()}function m(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function g(e){if(null==e._isValid){var t=m(e),n=i.call(t.parsedDateParts,(function(e){return null!=e})),s=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(s=s&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return s;e._isValid=s}return e._isValid}function y(e){var t=p(NaN);return null!=e?f(m(t),e):m(t).userInvalidated=!0,t}i=Array.prototype.some?Array.prototype.some:function(e){var t,n=Object(this),i=n.length>>>0;for(t=0;t<i;t++)if(t in n&&e.call(this,n[t],t,n))return!0;return!1};var v=s.momentProperties=[],S=!1;function _(e,t){var n,i,s;if(l(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),l(t._i)||(e._i=t._i),l(t._f)||(e._f=t._f),l(t._l)||(e._l=t._l),l(t._strict)||(e._strict=t._strict),l(t._tzm)||(e._tzm=t._tzm),l(t._isUTC)||(e._isUTC=t._isUTC),l(t._offset)||(e._offset=t._offset),l(t._pf)||(e._pf=m(t)),l(t._locale)||(e._locale=t._locale),v.length>0)for(n=0;n<v.length;n++)l(s=t[i=v[n]])||(e[i]=s);return e}function E(e){_(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===S&&(S=!0,s.updateOffset(this),S=!1)}function w(e){return e instanceof E||null!=e&&null!=e._isAMomentObject}function b(e){!1===s.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function C(e,t){var n=!0;return f((function(){if(null!=s.deprecationHandler&&s.deprecationHandler(null,e),n){var i,r,o,c=[];for(r=0;r<arguments.length;r++){if(i="","object"==typeof arguments[r]){for(o in i+="\n["+r+"] ",arguments[0])a(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[r];c.push(i)}b(e+"\nArguments: "+Array.prototype.slice.call(c).join("")+"\n"+(new Error).stack),n=!1}return t.apply(this,arguments)}),t)}var T,M={};function A(e,t){null!=s.deprecationHandler&&s.deprecationHandler(e,t),M[e]||(b(t),M[e]=!0)}function k(e){return"undefined"!=typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function R(e,t){var n,i=f({},e);for(n in t)a(t,n)&&(o(e[n])&&o(t[n])?(i[n]={},f(i[n],e[n]),f(i[n],t[n])):null!=t[n]?i[n]=t[n]:delete i[n]);for(n in e)a(e,n)&&!a(t,n)&&o(e[n])&&(i[n]=f({},i[n]));return i}function P(e){null!=e&&this.set(e)}function I(e,t,n){var i=""+Math.abs(e),s=t-i.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,s)).toString().substr(1)+i}s.suppressDeprecationWarnings=!1,s.deprecationHandler=null,T=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)a(e,t)&&n.push(t);return n};var N=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,L=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,D={},x={};function O(e,t,n,i){var s=i;"string"==typeof i&&(s=function(){return this[i]()}),e&&(x[e]=s),t&&(x[t[0]]=function(){return I(s.apply(this,arguments),t[1],t[2])}),n&&(x[n]=function(){return this.localeData().ordinal(s.apply(this,arguments),e)})}function F(e,t){return e.isValid()?(t=U(t,e.localeData()),D[t]=D[t]||function(e){var t,n,i,s=e.match(N);for(t=0,n=s.length;t<n;t++)x[s[t]]?s[t]=x[s[t]]:s[t]=(i=s[t]).match(/\[[\s\S]/)?i.replace(/^\[|\]$/g,""):i.replace(/\\/g,"");return function(t){var i,r="";for(i=0;i<n;i++)r+=k(s[i])?s[i].call(t,e):s[i];return r}}(t),D[t](e)):e.localeData().invalidDate()}function U(e,t){var n=5;function i(e){return t.longDateFormat(e)||e}for(L.lastIndex=0;n>=0&&L.test(e);)e=e.replace(L,i),L.lastIndex=0,n-=1;return e}var j={};function H(e,t){var n=e.toLowerCase();j[n]=j[n+"s"]=j[t]=e}function B(e){return"string"==typeof e?j[e]||j[e.toLowerCase()]:void 0}function Y(e){var t,n,i={};for(n in e)a(e,n)&&(t=B(n))&&(i[t]=e[n]);return i}var W={};function q(e,t){W[e]=t}function V(e){return e%4==0&&e%100!=0||e%400==0}function $(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function K(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=$(t)),n}function z(e,t){return function(n){return null!=n?(J(this,e,n),s.updateOffset(this,t),this):G(this,e)}}function G(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function J(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&V(e.year())&&1===e.month()&&29===e.date()?(n=K(n),e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),we(n,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](n))}var X,Z=/\d/,Q=/\d\d/,ee=/\d{3}/,te=/\d{4}/,ne=/[+-]?\d{6}/,ie=/\d\d?/,se=/\d\d\d\d?/,re=/\d\d\d\d\d\d?/,oe=/\d{1,3}/,ae=/\d{1,4}/,ce=/[+-]?\d{1,6}/,le=/\d+/,ue=/[+-]?\d+/,de=/Z|[+-]\d\d:?\d\d/gi,he=/Z|[+-]\d\d(?::?\d\d)?/gi,fe=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function pe(e,t,n){X[e]=k(t)?t:function(e,i){return e&&n?n:t}}function me(e,t){return a(X,e)?X[e](t._strict,t._locale):new RegExp(ge(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,n,i,s){return t||n||i||s}))))}function ge(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}X={};var ye,ve={};function Se(e,t){var n,i=t;for("string"==typeof e&&(e=[e]),u(t)&&(i=function(e,n){n[t]=K(e)}),n=0;n<e.length;n++)ve[e[n]]=i}function _e(e,t){Se(e,(function(e,n,i,s){i._w=i._w||{},t(e,i._w,i,s)}))}function Ee(e,t,n){null!=t&&a(ve,e)&&ve[e](t,n._a,n,e)}function we(e,t){if(isNaN(e)||isNaN(t))return NaN;var n,i=(t%(n=12)+n)%n;return e+=(t-i)/12,1===i?V(e)?29:28:31-i%7%2}ye=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},O("M",["MM",2],"Mo",(function(){return this.month()+1})),O("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),O("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),H("month","M"),q("month",8),pe("M",ie),pe("MM",ie,Q),pe("MMM",(function(e,t){return t.monthsShortRegex(e)})),pe("MMMM",(function(e,t){return t.monthsRegex(e)})),Se(["M","MM"],(function(e,t){t[1]=K(e)-1})),Se(["MMM","MMMM"],(function(e,t,n,i){var s=n._locale.monthsParse(e,i,n._strict);null!=s?t[1]=s:m(n).invalidMonth=e}));var be="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Ce="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Te=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Me=fe,Ae=fe;function ke(e,t,n){var i,s,r,o=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)r=p([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(r,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(s=ye.call(this._shortMonthsParse,o))?s:null:-1!==(s=ye.call(this._longMonthsParse,o))?s:null:"MMM"===t?-1!==(s=ye.call(this._shortMonthsParse,o))||-1!==(s=ye.call(this._longMonthsParse,o))?s:null:-1!==(s=ye.call(this._longMonthsParse,o))||-1!==(s=ye.call(this._shortMonthsParse,o))?s:null}function Re(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=K(t);else if(!u(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),we(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function Pe(e){return null!=e?(Re(this,e),s.updateOffset(this,!0),this):G(this,"Month")}function Ie(){function e(e,t){return t.length-e.length}var t,n,i=[],s=[],r=[];for(t=0;t<12;t++)n=p([2e3,t]),i.push(this.monthsShort(n,"")),s.push(this.months(n,"")),r.push(this.months(n,"")),r.push(this.monthsShort(n,""));for(i.sort(e),s.sort(e),r.sort(e),t=0;t<12;t++)i[t]=ge(i[t]),s[t]=ge(s[t]);for(t=0;t<24;t++)r[t]=ge(r[t]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function Ne(e){return V(e)?366:365}O("Y",0,0,(function(){var e=this.year();return e<=9999?I(e,4):"+"+e})),O(0,["YY",2],0,(function(){return this.year()%100})),O(0,["YYYY",4],0,"year"),O(0,["YYYYY",5],0,"year"),O(0,["YYYYYY",6,!0],0,"year"),H("year","y"),q("year",1),pe("Y",ue),pe("YY",ie,Q),pe("YYYY",ae,te),pe("YYYYY",ce,ne),pe("YYYYYY",ce,ne),Se(["YYYYY","YYYYYY"],0),Se("YYYY",(function(e,t){t[0]=2===e.length?s.parseTwoDigitYear(e):K(e)})),Se("YY",(function(e,t){t[0]=s.parseTwoDigitYear(e)})),Se("Y",(function(e,t){t[0]=parseInt(e,10)})),s.parseTwoDigitYear=function(e){return K(e)+(K(e)>68?1900:2e3)};var Le=z("FullYear",!0);function De(e,t,n,i,s,r,o){var a;return e<100&&e>=0?(a=new Date(e+400,t,n,i,s,r,o),isFinite(a.getFullYear())&&a.setFullYear(e)):a=new Date(e,t,n,i,s,r,o),a}function xe(e){var t,n;return e<100&&e>=0?((n=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Oe(e,t,n){var i=7+t-n;return-(7+xe(e,0,i).getUTCDay()-t)%7+i-1}function Fe(e,t,n,i,s){var r,o,a=1+7*(t-1)+(7+n-i)%7+Oe(e,i,s);return a<=0?o=Ne(r=e-1)+a:a>Ne(e)?(r=e+1,o=a-Ne(e)):(r=e,o=a),{year:r,dayOfYear:o}}function Ue(e,t,n){var i,s,r=Oe(e.year(),t,n),o=Math.floor((e.dayOfYear()-r-1)/7)+1;return o<1?i=o+je(s=e.year()-1,t,n):o>je(e.year(),t,n)?(i=o-je(e.year(),t,n),s=e.year()+1):(s=e.year(),i=o),{week:i,year:s}}function je(e,t,n){var i=Oe(e,t,n),s=Oe(e+1,t,n);return(Ne(e)-i+s)/7}function He(e,t){return e.slice(t,7).concat(e.slice(0,t))}O("w",["ww",2],"wo","week"),O("W",["WW",2],"Wo","isoWeek"),H("week","w"),H("isoWeek","W"),q("week",5),q("isoWeek",5),pe("w",ie),pe("ww",ie,Q),pe("W",ie),pe("WW",ie,Q),_e(["w","ww","W","WW"],(function(e,t,n,i){t[i.substr(0,1)]=K(e)})),O("d",0,"do","day"),O("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),O("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),O("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),O("e",0,0,"weekday"),O("E",0,0,"isoWeekday"),H("day","d"),H("weekday","e"),H("isoWeekday","E"),q("day",11),q("weekday",11),q("isoWeekday",11),pe("d",ie),pe("e",ie),pe("E",ie),pe("dd",(function(e,t){return t.weekdaysMinRegex(e)})),pe("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),pe("dddd",(function(e,t){return t.weekdaysRegex(e)})),_e(["dd","ddd","dddd"],(function(e,t,n,i){var s=n._locale.weekdaysParse(e,i,n._strict);null!=s?t.d=s:m(n).invalidWeekday=e})),_e(["d","e","E"],(function(e,t,n,i){t[i]=K(e)}));var Be="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ye="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),We="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),qe=fe,Ve=fe,$e=fe;function Ke(e,t,n){var i,s,r,o=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)r=p([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(r,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(s=ye.call(this._weekdaysParse,o))?s:null:"ddd"===t?-1!==(s=ye.call(this._shortWeekdaysParse,o))?s:null:-1!==(s=ye.call(this._minWeekdaysParse,o))?s:null:"dddd"===t?-1!==(s=ye.call(this._weekdaysParse,o))||-1!==(s=ye.call(this._shortWeekdaysParse,o))||-1!==(s=ye.call(this._minWeekdaysParse,o))?s:null:"ddd"===t?-1!==(s=ye.call(this._shortWeekdaysParse,o))||-1!==(s=ye.call(this._weekdaysParse,o))||-1!==(s=ye.call(this._minWeekdaysParse,o))?s:null:-1!==(s=ye.call(this._minWeekdaysParse,o))||-1!==(s=ye.call(this._weekdaysParse,o))||-1!==(s=ye.call(this._shortWeekdaysParse,o))?s:null}function ze(){function e(e,t){return t.length-e.length}var t,n,i,s,r,o=[],a=[],c=[],l=[];for(t=0;t<7;t++)n=p([2e3,1]).day(t),i=ge(this.weekdaysMin(n,"")),s=ge(this.weekdaysShort(n,"")),r=ge(this.weekdays(n,"")),o.push(i),a.push(s),c.push(r),l.push(i),l.push(s),l.push(r);o.sort(e),a.sort(e),c.sort(e),l.sort(e),this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+o.join("|")+")","i")}function Ge(){return this.hours()%12||12}function Je(e,t){O(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function Xe(e,t){return t._meridiemParse}O("H",["HH",2],0,"hour"),O("h",["hh",2],0,Ge),O("k",["kk",2],0,(function(){return this.hours()||24})),O("hmm",0,0,(function(){return""+Ge.apply(this)+I(this.minutes(),2)})),O("hmmss",0,0,(function(){return""+Ge.apply(this)+I(this.minutes(),2)+I(this.seconds(),2)})),O("Hmm",0,0,(function(){return""+this.hours()+I(this.minutes(),2)})),O("Hmmss",0,0,(function(){return""+this.hours()+I(this.minutes(),2)+I(this.seconds(),2)})),Je("a",!0),Je("A",!1),H("hour","h"),q("hour",13),pe("a",Xe),pe("A",Xe),pe("H",ie),pe("h",ie),pe("k",ie),pe("HH",ie,Q),pe("hh",ie,Q),pe("kk",ie,Q),pe("hmm",se),pe("hmmss",re),pe("Hmm",se),pe("Hmmss",re),Se(["H","HH"],3),Se(["k","kk"],(function(e,t,n){var i=K(e);t[3]=24===i?0:i})),Se(["a","A"],(function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e})),Se(["h","hh"],(function(e,t,n){t[3]=K(e),m(n).bigHour=!0})),Se("hmm",(function(e,t,n){var i=e.length-2;t[3]=K(e.substr(0,i)),t[4]=K(e.substr(i)),m(n).bigHour=!0})),Se("hmmss",(function(e,t,n){var i=e.length-4,s=e.length-2;t[3]=K(e.substr(0,i)),t[4]=K(e.substr(i,2)),t[5]=K(e.substr(s)),m(n).bigHour=!0})),Se("Hmm",(function(e,t,n){var i=e.length-2;t[3]=K(e.substr(0,i)),t[4]=K(e.substr(i))})),Se("Hmmss",(function(e,t,n){var i=e.length-4,s=e.length-2;t[3]=K(e.substr(0,i)),t[4]=K(e.substr(i,2)),t[5]=K(e.substr(s))}));var Ze,Qe=z("Hours",!0),et={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:be,monthsShort:Ce,week:{dow:0,doy:6},weekdays:Be,weekdaysMin:We,weekdaysShort:Ye,meridiemParse:/[ap]\.?m?\.?/i},tt={},nt={};function it(e,t){var n,i=Math.min(e.length,t.length);for(n=0;n<i;n+=1)if(e[n]!==t[n])return n;return i}function st(e){return e?e.toLowerCase().replace("_","-"):e}function rt(t){var i=null;if(void 0===tt[t]&&void 0!==e&&e&&e.exports)try{i=Ze._abbr,n(1347)("./"+t),ot(i)}catch(e){tt[t]=null}return tt[t]}function ot(e,t){var n;return e&&((n=l(t)?ct(e):at(e,t))?Ze=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Ze._abbr}function at(e,t){if(null!==t){var n,i=et;if(t.abbr=e,null!=tt[e])A("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=tt[e]._config;else if(null!=t.parentLocale)if(null!=tt[t.parentLocale])i=tt[t.parentLocale]._config;else{if(null==(n=rt(t.parentLocale)))return nt[t.parentLocale]||(nt[t.parentLocale]=[]),nt[t.parentLocale].push({name:e,config:t}),null;i=n._config}return tt[e]=new P(R(i,t)),nt[e]&&nt[e].forEach((function(e){at(e.name,e.config)})),ot(e),tt[e]}return delete tt[e],null}function ct(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Ze;if(!r(e)){if(t=rt(e))return t;e=[e]}return function(e){for(var t,n,i,s,r=0;r<e.length;){for(t=(s=st(e[r]).split("-")).length,n=(n=st(e[r+1]))?n.split("-"):null;t>0;){if(i=rt(s.slice(0,t).join("-")))return i;if(n&&n.length>=t&&it(s,n)>=t-1)break;t--}r++}return Ze}(e)}function lt(e){var t,n=e._a;return n&&-2===m(e).overflow&&(t=n[1]<0||n[1]>11?1:n[2]<1||n[2]>we(n[0],n[1])?2:n[3]<0||n[3]>24||24===n[3]&&(0!==n[4]||0!==n[5]||0!==n[6])?3:n[4]<0||n[4]>59?4:n[5]<0||n[5]>59?5:n[6]<0||n[6]>999?6:-1,m(e)._overflowDayOfYear&&(t<0||t>2)&&(t=2),m(e)._overflowWeeks&&-1===t&&(t=7),m(e)._overflowWeekday&&-1===t&&(t=8),m(e).overflow=t),e}var ut=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,dt=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ht=/Z|[+-]\d\d(?::?\d\d)?/,ft=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],pt=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],mt=/^\/?Date\((-?\d+)/i,gt=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,yt={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function vt(e){var t,n,i,s,r,o,a=e._i,c=ut.exec(a)||dt.exec(a);if(c){for(m(e).iso=!0,t=0,n=ft.length;t<n;t++)if(ft[t][1].exec(c[1])){s=ft[t][0],i=!1!==ft[t][2];break}if(null==s)return void(e._isValid=!1);if(c[3]){for(t=0,n=pt.length;t<n;t++)if(pt[t][1].exec(c[3])){r=(c[2]||" ")+pt[t][0];break}if(null==r)return void(e._isValid=!1)}if(!i&&null!=r)return void(e._isValid=!1);if(c[4]){if(!ht.exec(c[4]))return void(e._isValid=!1);o="Z"}e._f=s+(r||"")+(o||""),bt(e)}else e._isValid=!1}function St(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function _t(e){var t,n,i,s,r,o,a,c,l=gt.exec(e._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(l){if(n=l[4],i=l[3],s=l[2],r=l[5],o=l[6],a=l[7],c=[St(n),Ce.indexOf(i),parseInt(s,10),parseInt(r,10),parseInt(o,10)],a&&c.push(parseInt(a,10)),t=c,!function(e,t,n){return!e||Ye.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(m(n).weekdayMismatch=!0,n._isValid=!1,!1)}(l[1],t,e))return;e._a=t,e._tzm=function(e,t,n){if(e)return yt[e];if(t)return 0;var i=parseInt(n,10),s=i%100;return(i-s)/100*60+s}(l[8],l[9],l[10]),e._d=xe.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),m(e).rfc2822=!0}else e._isValid=!1}function Et(e,t,n){return null!=e?e:null!=t?t:n}function wt(e){var t,n,i,r,o,a=[];if(!e._d){for(i=function(e){var t=new Date(s.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}(e),e._w&&null==e._a[2]&&null==e._a[1]&&function(e){var t,n,i,s,r,o,a,c,l;null!=(t=e._w).GG||null!=t.W||null!=t.E?(r=1,o=4,n=Et(t.GG,e._a[0],Ue(Mt(),1,4).year),i=Et(t.W,1),((s=Et(t.E,1))<1||s>7)&&(c=!0)):(r=e._locale._week.dow,o=e._locale._week.doy,l=Ue(Mt(),r,o),n=Et(t.gg,e._a[0],l.year),i=Et(t.w,l.week),null!=t.d?((s=t.d)<0||s>6)&&(c=!0):null!=t.e?(s=t.e+r,(t.e<0||t.e>6)&&(c=!0)):s=r),i<1||i>je(n,r,o)?m(e)._overflowWeeks=!0:null!=c?m(e)._overflowWeekday=!0:(a=Fe(n,i,s,r,o),e._a[0]=a.year,e._dayOfYear=a.dayOfYear)}(e),null!=e._dayOfYear&&(o=Et(e._a[0],i[0]),(e._dayOfYear>Ne(o)||0===e._dayOfYear)&&(m(e)._overflowDayOfYear=!0),n=xe(o,0,e._dayOfYear),e._a[1]=n.getUTCMonth(),e._a[2]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=a[t]=i[t];for(;t<7;t++)e._a[t]=a[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[3]&&0===e._a[4]&&0===e._a[5]&&0===e._a[6]&&(e._nextDay=!0,e._a[3]=0),e._d=(e._useUTC?xe:De).apply(null,a),r=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[3]=24),e._w&&void 0!==e._w.d&&e._w.d!==r&&(m(e).weekdayMismatch=!0)}}function bt(e){if(e._f!==s.ISO_8601)if(e._f!==s.RFC_2822){e._a=[],m(e).empty=!0;var t,n,i,r,o,a,c=""+e._i,l=c.length,u=0;for(i=U(e._f,e._locale).match(N)||[],t=0;t<i.length;t++)r=i[t],(n=(c.match(me(r,e))||[])[0])&&((o=c.substr(0,c.indexOf(n))).length>0&&m(e).unusedInput.push(o),c=c.slice(c.indexOf(n)+n.length),u+=n.length),x[r]?(n?m(e).empty=!1:m(e).unusedTokens.push(r),Ee(r,n,e)):e._strict&&!n&&m(e).unusedTokens.push(r);m(e).charsLeftOver=l-u,c.length>0&&m(e).unusedInput.push(c),e._a[3]<=12&&!0===m(e).bigHour&&e._a[3]>0&&(m(e).bigHour=void 0),m(e).parsedDateParts=e._a.slice(0),m(e).meridiem=e._meridiem,e._a[3]=function(e,t,n){var i;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((i=e.isPM(n))&&t<12&&(t+=12),i||12!==t||(t=0),t):t}(e._locale,e._a[3],e._meridiem),null!==(a=m(e).era)&&(e._a[0]=e._locale.erasConvertYear(a,e._a[0])),wt(e),lt(e)}else _t(e);else vt(e)}function Ct(e){var t=e._i,n=e._f;return e._locale=e._locale||ct(e._l),null===t||void 0===n&&""===t?y({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),w(t)?new E(lt(t)):(d(t)?e._d=t:r(n)?function(e){var t,n,i,s,r,o,a=!1;if(0===e._f.length)return m(e).invalidFormat=!0,void(e._d=new Date(NaN));for(s=0;s<e._f.length;s++)r=0,o=!1,t=_({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[s],bt(t),g(t)&&(o=!0),r+=m(t).charsLeftOver,r+=10*m(t).unusedTokens.length,m(t).score=r,a?r<i&&(i=r,n=t):(null==i||r<i||o)&&(i=r,n=t,o&&(a=!0));f(e,n||t)}(e):n?bt(e):function(e){var t=e._i;l(t)?e._d=new Date(s.now()):d(t)?e._d=new Date(t.valueOf()):"string"==typeof t?function(e){var t=mt.exec(e._i);null===t?(vt(e),!1===e._isValid&&(delete e._isValid,_t(e),!1===e._isValid&&(delete e._isValid,e._strict?e._isValid=!1:s.createFromInputFallback(e)))):e._d=new Date(+t[1])}(e):r(t)?(e._a=h(t.slice(0),(function(e){return parseInt(e,10)})),wt(e)):o(t)?function(e){if(!e._d){var t=Y(e._i),n=void 0===t.day?t.date:t.day;e._a=h([t.year,t.month,n,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),wt(e)}}(e):u(t)?e._d=new Date(t):s.createFromInputFallback(e)}(e),g(e)||(e._d=null),e))}function Tt(e,t,n,i,s){var a,l={};return!0!==t&&!1!==t||(i=t,t=void 0),!0!==n&&!1!==n||(i=n,n=void 0),(o(e)&&c(e)||r(e)&&0===e.length)&&(e=void 0),l._isAMomentObject=!0,l._useUTC=l._isUTC=s,l._l=n,l._i=e,l._f=t,l._strict=i,(a=new E(lt(Ct(l))))._nextDay&&(a.add(1,"d"),a._nextDay=void 0),a}function Mt(e,t,n,i){return Tt(e,t,n,i,!1)}s.createFromInputFallback=C("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),s.ISO_8601=function(){},s.RFC_2822=function(){};var At=C("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Mt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:y()})),kt=C("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Mt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:y()}));function Rt(e,t){var n,i;if(1===t.length&&r(t[0])&&(t=t[0]),!t.length)return Mt();for(n=t[0],i=1;i<t.length;++i)t[i].isValid()&&!t[i][e](n)||(n=t[i]);return n}var Pt=["year","quarter","month","week","day","hour","minute","second","millisecond"];function It(e){var t=Y(e),n=t.year||0,i=t.quarter||0,s=t.month||0,r=t.week||t.isoWeek||0,o=t.day||0,c=t.hour||0,l=t.minute||0,u=t.second||0,d=t.millisecond||0;this._isValid=function(e){var t,n,i=!1;for(t in e)if(a(e,t)&&(-1===ye.call(Pt,t)||null!=e[t]&&isNaN(e[t])))return!1;for(n=0;n<Pt.length;++n)if(e[Pt[n]]){if(i)return!1;parseFloat(e[Pt[n]])!==K(e[Pt[n]])&&(i=!0)}return!0}(t),this._milliseconds=+d+1e3*u+6e4*l+1e3*c*60*60,this._days=+o+7*r,this._months=+s+3*i+12*n,this._data={},this._locale=ct(),this._bubble()}function Nt(e){return e instanceof It}function Lt(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Dt(e,t){O(e,0,0,(function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+I(~~(e/60),2)+t+I(~~e%60,2)}))}Dt("Z",":"),Dt("ZZ",""),pe("Z",he),pe("ZZ",he),Se(["Z","ZZ"],(function(e,t,n){n._useUTC=!0,n._tzm=Ot(he,e)}));var xt=/([\+\-]|\d\d)/gi;function Ot(e,t){var n,i,s=(t||"").match(e);return null===s?null:0===(i=60*(n=((s[s.length-1]||[])+"").match(xt)||["-",0,0])[1]+K(n[2]))?0:"+"===n[0]?i:-i}function Ft(e,t){var n,i;return t._isUTC?(n=t.clone(),i=(w(e)||d(e)?e.valueOf():Mt(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),s.updateOffset(n,!1),n):Mt(e).local()}function Ut(e){return-Math.round(e._d.getTimezoneOffset())}function jt(){return!!this.isValid()&&this._isUTC&&0===this._offset}s.updateOffset=function(){};var Ht=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Bt=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Yt(e,t){var n,i,s,r,o,c,l=e,d=null;return Nt(e)?l={ms:e._milliseconds,d:e._days,M:e._months}:u(e)||!isNaN(+e)?(l={},t?l[t]=+e:l.milliseconds=+e):(d=Ht.exec(e))?(n="-"===d[1]?-1:1,l={y:0,d:K(d[2])*n,h:K(d[3])*n,m:K(d[4])*n,s:K(d[5])*n,ms:K(Lt(1e3*d[6]))*n}):(d=Bt.exec(e))?(n="-"===d[1]?-1:1,l={y:Wt(d[2],n),M:Wt(d[3],n),w:Wt(d[4],n),d:Wt(d[5],n),h:Wt(d[6],n),m:Wt(d[7],n),s:Wt(d[8],n)}):null==l?l={}:"object"==typeof l&&("from"in l||"to"in l)&&(r=Mt(l.from),o=Mt(l.to),s=r.isValid()&&o.isValid()?(o=Ft(o,r),r.isBefore(o)?c=qt(r,o):((c=qt(o,r)).milliseconds=-c.milliseconds,c.months=-c.months),c):{milliseconds:0,months:0},(l={}).ms=s.milliseconds,l.M=s.months),i=new It(l),Nt(e)&&a(e,"_locale")&&(i._locale=e._locale),Nt(e)&&a(e,"_isValid")&&(i._isValid=e._isValid),i}function Wt(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function qt(e,t){var n={};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Vt(e,t){return function(n,i){var s;return null===i||isNaN(+i)||(A(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=n,n=i,i=s),$t(this,Yt(n,i),e),this}}function $t(e,t,n,i){var r=t._milliseconds,o=Lt(t._days),a=Lt(t._months);e.isValid()&&(i=null==i||i,a&&Re(e,G(e,"Month")+a*n),o&&J(e,"Date",G(e,"Date")+o*n),r&&e._d.setTime(e._d.valueOf()+r*n),i&&s.updateOffset(e,o||a))}Yt.fn=It.prototype,Yt.invalid=function(){return Yt(NaN)};var Kt=Vt(1,"add"),zt=Vt(-1,"subtract");function Gt(e){return"string"==typeof e||e instanceof String}function Jt(e){return w(e)||d(e)||Gt(e)||u(e)||function(e){var t=r(e),n=!1;return t&&(n=0===e.filter((function(t){return!u(t)&&Gt(e)})).length),t&&n}(e)||function(e){var t,n,i=o(e)&&!c(e),s=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"];for(t=0;t<r.length;t+=1)n=r[t],s=s||a(e,n);return i&&s}(e)||null==e}function Xt(e){var t,n=o(e)&&!c(e),i=!1,s=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(t=0;t<s.length;t+=1)i=i||a(e,s[t]);return n&&i}function Zt(e,t){if(e.date()<t.date())return-Zt(t,e);var n=12*(t.year()-e.year())+(t.month()-e.month()),i=e.clone().add(n,"months");return-(n+(t-i<0?(t-i)/(i-e.clone().add(n-1,"months")):(t-i)/(e.clone().add(n+1,"months")-i)))||0}function Qt(e){var t;return void 0===e?this._locale._abbr:(null!=(t=ct(e))&&(this._locale=t),this)}s.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",s.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var en=C("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function tn(){return this._locale}function nn(e,t){return(e%t+t)%t}function sn(e,t,n){return e<100&&e>=0?new Date(e+400,t,n)-126227808e5:new Date(e,t,n).valueOf()}function rn(e,t,n){return e<100&&e>=0?Date.UTC(e+400,t,n)-126227808e5:Date.UTC(e,t,n)}function on(e,t){return t.erasAbbrRegex(e)}function an(){var e,t,n=[],i=[],s=[],r=[],o=this.eras();for(e=0,t=o.length;e<t;++e)i.push(ge(o[e].name)),n.push(ge(o[e].abbr)),s.push(ge(o[e].narrow)),r.push(ge(o[e].name)),r.push(ge(o[e].abbr)),r.push(ge(o[e].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+i.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+s.join("|")+")","i")}function cn(e,t){O(0,[e,e.length],0,t)}function ln(e,t,n,i,s){var r;return null==e?Ue(this,i,s).year:(t>(r=je(e,i,s))&&(t=r),un.call(this,e,t,n,i,s))}function un(e,t,n,i,s){var r=Fe(e,t,n,i,s),o=xe(r.year,0,r.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}O("N",0,0,"eraAbbr"),O("NN",0,0,"eraAbbr"),O("NNN",0,0,"eraAbbr"),O("NNNN",0,0,"eraName"),O("NNNNN",0,0,"eraNarrow"),O("y",["y",1],"yo","eraYear"),O("y",["yy",2],0,"eraYear"),O("y",["yyy",3],0,"eraYear"),O("y",["yyyy",4],0,"eraYear"),pe("N",on),pe("NN",on),pe("NNN",on),pe("NNNN",(function(e,t){return t.erasNameRegex(e)})),pe("NNNNN",(function(e,t){return t.erasNarrowRegex(e)})),Se(["N","NN","NNN","NNNN","NNNNN"],(function(e,t,n,i){var s=n._locale.erasParse(e,i,n._strict);s?m(n).era=s:m(n).invalidEra=e})),pe("y",le),pe("yy",le),pe("yyy",le),pe("yyyy",le),pe("yo",(function(e,t){return t._eraYearOrdinalRegex||le})),Se(["y","yy","yyy","yyyy"],0),Se(["yo"],(function(e,t,n,i){var s;n._locale._eraYearOrdinalRegex&&(s=e.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?t[0]=n._locale.eraYearOrdinalParse(e,s):t[0]=parseInt(e,10)})),O(0,["gg",2],0,(function(){return this.weekYear()%100})),O(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),cn("gggg","weekYear"),cn("ggggg","weekYear"),cn("GGGG","isoWeekYear"),cn("GGGGG","isoWeekYear"),H("weekYear","gg"),H("isoWeekYear","GG"),q("weekYear",1),q("isoWeekYear",1),pe("G",ue),pe("g",ue),pe("GG",ie,Q),pe("gg",ie,Q),pe("GGGG",ae,te),pe("gggg",ae,te),pe("GGGGG",ce,ne),pe("ggggg",ce,ne),_e(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,n,i){t[i.substr(0,2)]=K(e)})),_e(["gg","GG"],(function(e,t,n,i){t[i]=s.parseTwoDigitYear(e)})),O("Q",0,"Qo","quarter"),H("quarter","Q"),q("quarter",7),pe("Q",Z),Se("Q",(function(e,t){t[1]=3*(K(e)-1)})),O("D",["DD",2],"Do","date"),H("date","D"),q("date",9),pe("D",ie),pe("DD",ie,Q),pe("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),Se(["D","DD"],2),Se("Do",(function(e,t){t[2]=K(e.match(ie)[0])}));var dn=z("Date",!0);O("DDD",["DDDD",3],"DDDo","dayOfYear"),H("dayOfYear","DDD"),q("dayOfYear",4),pe("DDD",oe),pe("DDDD",ee),Se(["DDD","DDDD"],(function(e,t,n){n._dayOfYear=K(e)})),O("m",["mm",2],0,"minute"),H("minute","m"),q("minute",14),pe("m",ie),pe("mm",ie,Q),Se(["m","mm"],4);var hn=z("Minutes",!1);O("s",["ss",2],0,"second"),H("second","s"),q("second",15),pe("s",ie),pe("ss",ie,Q),Se(["s","ss"],5);var fn,pn,mn=z("Seconds",!1);for(O("S",0,0,(function(){return~~(this.millisecond()/100)})),O(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),O(0,["SSS",3],0,"millisecond"),O(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),O(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),O(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),O(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),O(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),O(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),H("millisecond","ms"),q("millisecond",16),pe("S",oe,Z),pe("SS",oe,Q),pe("SSS",oe,ee),fn="SSSS";fn.length<=9;fn+="S")pe(fn,le);function gn(e,t){t[6]=K(1e3*("0."+e))}for(fn="S";fn.length<=9;fn+="S")Se(fn,gn);pn=z("Milliseconds",!1),O("z",0,0,"zoneAbbr"),O("zz",0,0,"zoneName");var yn=E.prototype;function vn(e){return e}yn.add=Kt,yn.calendar=function(e,t){1===arguments.length&&(Jt(arguments[0])?(e=arguments[0],t=void 0):Xt(arguments[0])&&(t=arguments[0],e=void 0));var n=e||Mt(),i=Ft(n,this).startOf("day"),r=s.calendarFormat(this,i)||"sameElse",o=t&&(k(t[r])?t[r].call(this,n):t[r]);return this.format(o||this.localeData().calendar(r,this,Mt(n)))},yn.clone=function(){return new E(this)},yn.diff=function(e,t,n){var i,s,r;if(!this.isValid())return NaN;if(!(i=Ft(e,this)).isValid())return NaN;switch(s=6e4*(i.utcOffset()-this.utcOffset()),t=B(t)){case"year":r=Zt(this,i)/12;break;case"month":r=Zt(this,i);break;case"quarter":r=Zt(this,i)/3;break;case"second":r=(this-i)/1e3;break;case"minute":r=(this-i)/6e4;break;case"hour":r=(this-i)/36e5;break;case"day":r=(this-i-s)/864e5;break;case"week":r=(this-i-s)/6048e5;break;default:r=this-i}return n?r:$(r)},yn.endOf=function(e){var t,n;if(void 0===(e=B(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?rn:sn,e){case"year":t=n(this.year()+1,0,1)-1;break;case"quarter":t=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=n(this.year(),this.month()+1,1)-1;break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=36e5-nn(t+(this._isUTC?0:6e4*this.utcOffset()),36e5)-1;break;case"minute":t=this._d.valueOf(),t+=6e4-nn(t,6e4)-1;break;case"second":t=this._d.valueOf(),t+=1e3-nn(t,1e3)-1}return this._d.setTime(t),s.updateOffset(this,!0),this},yn.format=function(e){e||(e=this.isUtc()?s.defaultFormatUtc:s.defaultFormat);var t=F(this,e);return this.localeData().postformat(t)},yn.from=function(e,t){return this.isValid()&&(w(e)&&e.isValid()||Mt(e).isValid())?Yt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},yn.fromNow=function(e){return this.from(Mt(),e)},yn.to=function(e,t){return this.isValid()&&(w(e)&&e.isValid()||Mt(e).isValid())?Yt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},yn.toNow=function(e){return this.to(Mt(),e)},yn.get=function(e){return k(this[e=B(e)])?this[e]():this},yn.invalidAt=function(){return m(this).overflow},yn.isAfter=function(e,t){var n=w(e)?e:Mt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=B(t)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())},yn.isBefore=function(e,t){var n=w(e)?e:Mt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=B(t)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())},yn.isBetween=function(e,t,n,i){var s=w(e)?e:Mt(e),r=w(t)?t:Mt(t);return!!(this.isValid()&&s.isValid()&&r.isValid())&&(("("===(i=i||"()")[0]?this.isAfter(s,n):!this.isBefore(s,n))&&(")"===i[1]?this.isBefore(r,n):!this.isAfter(r,n)))},yn.isSame=function(e,t){var n,i=w(e)?e:Mt(e);return!(!this.isValid()||!i.isValid())&&("millisecond"===(t=B(t)||"millisecond")?this.valueOf()===i.valueOf():(n=i.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))},yn.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},yn.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},yn.isValid=function(){return g(this)},yn.lang=en,yn.locale=Qt,yn.localeData=tn,yn.max=kt,yn.min=At,yn.parsingFlags=function(){return f({},m(this))},yn.set=function(e,t){if("object"==typeof e){var n,i=function(e){var t,n=[];for(t in e)a(e,t)&&n.push({unit:t,priority:W[t]});return n.sort((function(e,t){return e.priority-t.priority})),n}(e=Y(e));for(n=0;n<i.length;n++)this[i[n].unit](e[i[n].unit])}else if(k(this[e=B(e)]))return this[e](t);return this},yn.startOf=function(e){var t,n;if(void 0===(e=B(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?rn:sn,e){case"year":t=n(this.year(),0,1);break;case"quarter":t=n(this.year(),this.month()-this.month()%3,1);break;case"month":t=n(this.year(),this.month(),1);break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=n(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=nn(t+(this._isUTC?0:6e4*this.utcOffset()),36e5);break;case"minute":t=this._d.valueOf(),t-=nn(t,6e4);break;case"second":t=this._d.valueOf(),t-=nn(t,1e3)}return this._d.setTime(t),s.updateOffset(this,!0),this},yn.subtract=zt,yn.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},yn.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},yn.toDate=function(){return new Date(this.valueOf())},yn.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?F(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):k(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",F(n,"Z")):F(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},yn.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,n,i="moment",s="";return this.isLocal()||(i=0===this.utcOffset()?"moment.utc":"moment.parseZone",s="Z"),e="["+i+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n=s+'[")]',this.format(e+t+"-MM-DD[T]HH:mm:ss.SSS"+n)},"undefined"!=typeof Symbol&&null!=Symbol.for&&(yn[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),yn.toJSON=function(){return this.isValid()?this.toISOString():null},yn.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},yn.unix=function(){return Math.floor(this.valueOf()/1e3)},yn.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},yn.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},yn.eraName=function(){var e,t,n,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e){if(n=this.startOf("day").valueOf(),i[e].since<=n&&n<=i[e].until)return i[e].name;if(i[e].until<=n&&n<=i[e].since)return i[e].name}return""},yn.eraNarrow=function(){var e,t,n,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e){if(n=this.startOf("day").valueOf(),i[e].since<=n&&n<=i[e].until)return i[e].narrow;if(i[e].until<=n&&n<=i[e].since)return i[e].narrow}return""},yn.eraAbbr=function(){var e,t,n,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e){if(n=this.startOf("day").valueOf(),i[e].since<=n&&n<=i[e].until)return i[e].abbr;if(i[e].until<=n&&n<=i[e].since)return i[e].abbr}return""},yn.eraYear=function(){var e,t,n,i,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e)if(n=r[e].since<=r[e].until?1:-1,i=this.startOf("day").valueOf(),r[e].since<=i&&i<=r[e].until||r[e].until<=i&&i<=r[e].since)return(this.year()-s(r[e].since).year())*n+r[e].offset;return this.year()},yn.year=Le,yn.isLeapYear=function(){return V(this.year())},yn.weekYear=function(e){return ln.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},yn.isoWeekYear=function(e){return ln.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},yn.quarter=yn.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},yn.month=Pe,yn.daysInMonth=function(){return we(this.year(),this.month())},yn.week=yn.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},yn.isoWeek=yn.isoWeeks=function(e){var t=Ue(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},yn.weeksInYear=function(){var e=this.localeData()._week;return je(this.year(),e.dow,e.doy)},yn.weeksInWeekYear=function(){var e=this.localeData()._week;return je(this.weekYear(),e.dow,e.doy)},yn.isoWeeksInYear=function(){return je(this.year(),1,4)},yn.isoWeeksInISOWeekYear=function(){return je(this.isoWeekYear(),1,4)},yn.date=dn,yn.day=yn.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=function(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}(e,this.localeData()),this.add(e-t,"d")):t},yn.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},yn.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=function(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7},yn.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},yn.hour=yn.hours=Qe,yn.minute=yn.minutes=hn,yn.second=yn.seconds=mn,yn.millisecond=yn.milliseconds=pn,yn.utcOffset=function(e,t,n){var i,r=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=Ot(he,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(i=Ut(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),r!==e&&(!t||this._changeInProgress?$t(this,Yt(e-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,s.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?r:Ut(this)},yn.utc=function(e){return this.utcOffset(0,e)},yn.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ut(this),"m")),this},yn.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Ot(de,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},yn.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Mt(e).utcOffset():0,(this.utcOffset()-e)%60==0)},yn.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},yn.isLocal=function(){return!!this.isValid()&&!this._isUTC},yn.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},yn.isUtc=jt,yn.isUTC=jt,yn.zoneAbbr=function(){return this._isUTC?"UTC":""},yn.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},yn.dates=C("dates accessor is deprecated. Use date instead.",dn),yn.months=C("months accessor is deprecated. Use month instead",Pe),yn.years=C("years accessor is deprecated. Use year instead",Le),yn.zone=C("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",(function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()})),yn.isDSTShifted=C("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",(function(){if(!l(this._isDSTShifted))return this._isDSTShifted;var e,t={};return _(t,this),(t=Ct(t))._a?(e=t._isUTC?p(t._a):Mt(t._a),this._isDSTShifted=this.isValid()&&function(e,t,n){var i,s=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),o=0;for(i=0;i<s;i++)(n&&e[i]!==t[i]||!n&&K(e[i])!==K(t[i]))&&o++;return o+r}(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}));var Sn=P.prototype;function _n(e,t,n,i){var s=ct(),r=p().set(i,t);return s[n](r,e)}function En(e,t,n){if(u(e)&&(t=e,e=void 0),e=e||"",null!=t)return _n(e,t,n,"month");var i,s=[];for(i=0;i<12;i++)s[i]=_n(e,i,n,"month");return s}function wn(e,t,n,i){"boolean"==typeof e?(u(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,u(t)&&(n=t,t=void 0),t=t||"");var s,r=ct(),o=e?r._week.dow:0,a=[];if(null!=n)return _n(t,(n+o)%7,i,"day");for(s=0;s<7;s++)a[s]=_n(t,(s+o)%7,i,"day");return a}Sn.calendar=function(e,t,n){var i=this._calendar[e]||this._calendar.sameElse;return k(i)?i.call(t,n):i},Sn.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.match(N).map((function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e})).join(""),this._longDateFormat[e])},Sn.invalidDate=function(){return this._invalidDate},Sn.ordinal=function(e){return this._ordinal.replace("%d",e)},Sn.preparse=vn,Sn.postformat=vn,Sn.relativeTime=function(e,t,n,i){var s=this._relativeTime[n];return k(s)?s(e,t,n,i):s.replace(/%d/i,e)},Sn.pastFuture=function(e,t){var n=this._relativeTime[e>0?"future":"past"];return k(n)?n(t):n.replace(/%s/i,t)},Sn.set=function(e){var t,n;for(n in e)a(e,n)&&(k(t=e[n])?this[n]=t:this["_"+n]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},Sn.eras=function(e,t){var n,i,r,o=this._eras||ct("en")._eras;for(n=0,i=o.length;n<i;++n){switch(typeof o[n].since){case"string":r=s(o[n].since).startOf("day"),o[n].since=r.valueOf()}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":r=s(o[n].until).startOf("day").valueOf(),o[n].until=r.valueOf()}}return o},Sn.erasParse=function(e,t,n){var i,s,r,o,a,c=this.eras();for(e=e.toUpperCase(),i=0,s=c.length;i<s;++i)if(r=c[i].name.toUpperCase(),o=c[i].abbr.toUpperCase(),a=c[i].narrow.toUpperCase(),n)switch(t){case"N":case"NN":case"NNN":if(o===e)return c[i];break;case"NNNN":if(r===e)return c[i];break;case"NNNNN":if(a===e)return c[i]}else if([r,o,a].indexOf(e)>=0)return c[i]},Sn.erasConvertYear=function(e,t){var n=e.since<=e.until?1:-1;return void 0===t?s(e.since).year():s(e.since).year()+(t-e.offset)*n},Sn.erasAbbrRegex=function(e){return a(this,"_erasAbbrRegex")||an.call(this),e?this._erasAbbrRegex:this._erasRegex},Sn.erasNameRegex=function(e){return a(this,"_erasNameRegex")||an.call(this),e?this._erasNameRegex:this._erasRegex},Sn.erasNarrowRegex=function(e){return a(this,"_erasNarrowRegex")||an.call(this),e?this._erasNarrowRegex:this._erasRegex},Sn.months=function(e,t){return e?r(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Te).test(t)?"format":"standalone"][e.month()]:r(this._months)?this._months:this._months.standalone},Sn.monthsShort=function(e,t){return e?r(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Te.test(t)?"format":"standalone"][e.month()]:r(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},Sn.monthsParse=function(e,t,n){var i,s,r;if(this._monthsParseExact)return ke.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(s=p([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),n||this._monthsParse[i]||(r="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[i]=new RegExp(r.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[i].test(e))return i;if(n&&"MMM"===t&&this._shortMonthsParse[i].test(e))return i;if(!n&&this._monthsParse[i].test(e))return i}},Sn.monthsRegex=function(e){return this._monthsParseExact?(a(this,"_monthsRegex")||Ie.call(this),e?this._monthsStrictRegex:this._monthsRegex):(a(this,"_monthsRegex")||(this._monthsRegex=Ae),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},Sn.monthsShortRegex=function(e){return this._monthsParseExact?(a(this,"_monthsRegex")||Ie.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(a(this,"_monthsShortRegex")||(this._monthsShortRegex=Me),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},Sn.week=function(e){return Ue(e,this._week.dow,this._week.doy).week},Sn.firstDayOfYear=function(){return this._week.doy},Sn.firstDayOfWeek=function(){return this._week.dow},Sn.weekdays=function(e,t){var n=r(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?He(n,this._week.dow):e?n[e.day()]:n},Sn.weekdaysMin=function(e){return!0===e?He(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin},Sn.weekdaysShort=function(e){return!0===e?He(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort},Sn.weekdaysParse=function(e,t,n){var i,s,r;if(this._weekdaysParseExact)return Ke.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(s=p([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(s,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(s,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(s,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(r="^"+this.weekdays(s,"")+"|^"+this.weekdaysShort(s,"")+"|^"+this.weekdaysMin(s,""),this._weekdaysParse[i]=new RegExp(r.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[i].test(e))return i;if(n&&"ddd"===t&&this._shortWeekdaysParse[i].test(e))return i;if(n&&"dd"===t&&this._minWeekdaysParse[i].test(e))return i;if(!n&&this._weekdaysParse[i].test(e))return i}},Sn.weekdaysRegex=function(e){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||ze.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(a(this,"_weekdaysRegex")||(this._weekdaysRegex=qe),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},Sn.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||ze.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(a(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ve),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},Sn.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||ze.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(a(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=$e),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},Sn.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},Sn.meridiem=function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},ot("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===K(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),s.lang=C("moment.lang is deprecated. Use moment.locale instead.",ot),s.langData=C("moment.langData is deprecated. Use moment.localeData instead.",ct);var bn=Math.abs;function Cn(e,t,n,i){var s=Yt(t,n);return e._milliseconds+=i*s._milliseconds,e._days+=i*s._days,e._months+=i*s._months,e._bubble()}function Tn(e){return e<0?Math.floor(e):Math.ceil(e)}function Mn(e){return 4800*e/146097}function An(e){return 146097*e/4800}function kn(e){return function(){return this.as(e)}}var Rn=kn("ms"),Pn=kn("s"),In=kn("m"),Nn=kn("h"),Ln=kn("d"),Dn=kn("w"),xn=kn("M"),On=kn("Q"),Fn=kn("y");function Un(e){return function(){return this.isValid()?this._data[e]:NaN}}var jn=Un("milliseconds"),Hn=Un("seconds"),Bn=Un("minutes"),Yn=Un("hours"),Wn=Un("days"),qn=Un("months"),Vn=Un("years"),$n=Math.round,Kn={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function zn(e,t,n,i,s){return s.relativeTime(t||1,!!n,e,i)}var Gn=Math.abs;function Jn(e){return(e>0)-(e<0)||+e}function Xn(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n,i,s,r,o,a,c=Gn(this._milliseconds)/1e3,l=Gn(this._days),u=Gn(this._months),d=this.asSeconds();return d?(e=$(c/60),t=$(e/60),c%=60,e%=60,n=$(u/12),u%=12,i=c?c.toFixed(3).replace(/\.?0+$/,""):"",s=d<0?"-":"",r=Jn(this._months)!==Jn(d)?"-":"",o=Jn(this._days)!==Jn(d)?"-":"",a=Jn(this._milliseconds)!==Jn(d)?"-":"",s+"P"+(n?r+n+"Y":"")+(u?r+u+"M":"")+(l?o+l+"D":"")+(t||e||c?"T":"")+(t?a+t+"H":"")+(e?a+e+"M":"")+(c?a+i+"S":"")):"P0D"}var Zn=It.prototype;return Zn.isValid=function(){return this._isValid},Zn.abs=function(){var e=this._data;return this._milliseconds=bn(this._milliseconds),this._days=bn(this._days),this._months=bn(this._months),e.milliseconds=bn(e.milliseconds),e.seconds=bn(e.seconds),e.minutes=bn(e.minutes),e.hours=bn(e.hours),e.months=bn(e.months),e.years=bn(e.years),this},Zn.add=function(e,t){return Cn(this,e,t,1)},Zn.subtract=function(e,t){return Cn(this,e,t,-1)},Zn.as=function(e){if(!this.isValid())return NaN;var t,n,i=this._milliseconds;if("month"===(e=B(e))||"quarter"===e||"year"===e)switch(t=this._days+i/864e5,n=this._months+Mn(t),e){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(t=this._days+Math.round(An(this._months)),e){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return 24*t+i/36e5;case"minute":return 1440*t+i/6e4;case"second":return 86400*t+i/1e3;case"millisecond":return Math.floor(864e5*t)+i;default:throw new Error("Unknown unit "+e)}},Zn.asMilliseconds=Rn,Zn.asSeconds=Pn,Zn.asMinutes=In,Zn.asHours=Nn,Zn.asDays=Ln,Zn.asWeeks=Dn,Zn.asMonths=xn,Zn.asQuarters=On,Zn.asYears=Fn,Zn.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*K(this._months/12):NaN},Zn._bubble=function(){var e,t,n,i,s,r=this._milliseconds,o=this._days,a=this._months,c=this._data;return r>=0&&o>=0&&a>=0||r<=0&&o<=0&&a<=0||(r+=864e5*Tn(An(a)+o),o=0,a=0),c.milliseconds=r%1e3,e=$(r/1e3),c.seconds=e%60,t=$(e/60),c.minutes=t%60,n=$(t/60),c.hours=n%24,o+=$(n/24),s=$(Mn(o)),a+=s,o-=Tn(An(s)),i=$(a/12),a%=12,c.days=o,c.months=a,c.years=i,this},Zn.clone=function(){return Yt(this)},Zn.get=function(e){return e=B(e),this.isValid()?this[e+"s"]():NaN},Zn.milliseconds=jn,Zn.seconds=Hn,Zn.minutes=Bn,Zn.hours=Yn,Zn.days=Wn,Zn.weeks=function(){return $(this.days()/7)},Zn.months=qn,Zn.years=Vn,Zn.humanize=function(e,t){if(!this.isValid())return this.localeData().invalidDate();var n,i,s=!1,r=Kn;return"object"==typeof e&&(t=e,e=!1),"boolean"==typeof e&&(s=e),"object"==typeof t&&(r=Object.assign({},Kn,t),null!=t.s&&null==t.ss&&(r.ss=t.s-1)),n=this.localeData(),i=function(e,t,n,i){var s=Yt(e).abs(),r=$n(s.as("s")),o=$n(s.as("m")),a=$n(s.as("h")),c=$n(s.as("d")),l=$n(s.as("M")),u=$n(s.as("w")),d=$n(s.as("y")),h=r<=n.ss&&["s",r]||r<n.s&&["ss",r]||o<=1&&["m"]||o<n.m&&["mm",o]||a<=1&&["h"]||a<n.h&&["hh",a]||c<=1&&["d"]||c<n.d&&["dd",c];return null!=n.w&&(h=h||u<=1&&["w"]||u<n.w&&["ww",u]),(h=h||l<=1&&["M"]||l<n.M&&["MM",l]||d<=1&&["y"]||["yy",d])[2]=t,h[3]=+e>0,h[4]=i,zn.apply(null,h)}(this,!s,r,n),s&&(i=n.pastFuture(+this,i)),n.postformat(i)},Zn.toISOString=Xn,Zn.toString=Xn,Zn.toJSON=Xn,Zn.locale=Qt,Zn.localeData=tn,Zn.toIsoString=C("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Xn),Zn.lang=en,O("X",0,0,"unix"),O("x",0,0,"valueOf"),pe("x",ue),pe("X",/[+-]?\d+(\.\d{1,3})?/),Se("X",(function(e,t,n){n._d=new Date(1e3*parseFloat(e))})),Se("x",(function(e,t,n){n._d=new Date(K(e))})),
//! moment.js
s.version="2.27.0",t=Mt,s.fn=yn,s.min=function(){var e=[].slice.call(arguments,0);return Rt("isBefore",e)},s.max=function(){var e=[].slice.call(arguments,0);return Rt("isAfter",e)},s.now=function(){return Date.now?Date.now():+new Date},s.utc=p,s.unix=function(e){return Mt(1e3*e)},s.months=function(e,t){return En(e,t,"months")},s.isDate=d,s.locale=ot,s.invalid=y,s.duration=Yt,s.isMoment=w,s.weekdays=function(e,t,n){return wn(e,t,n,"weekdays")},s.parseZone=function(){return Mt.apply(null,arguments).parseZone()},s.localeData=ct,s.isDuration=Nt,s.monthsShort=function(e,t){return En(e,t,"monthsShort")},s.weekdaysMin=function(e,t,n){return wn(e,t,n,"weekdaysMin")},s.defineLocale=at,s.updateLocale=function(e,t){if(null!=t){var n,i,s=et;null!=tt[e]&&null!=tt[e].parentLocale?tt[e].set(R(tt[e]._config,t)):(null!=(i=rt(e))&&(s=i._config),t=R(s,t),null==i&&(t.abbr=e),(n=new P(t)).parentLocale=tt[e],tt[e]=n),ot(e)}else null!=tt[e]&&(null!=tt[e].parentLocale?(tt[e]=tt[e].parentLocale,e===ot()&&ot(e)):null!=tt[e]&&delete tt[e]);return tt[e]},s.locales=function(){return T(tt)},s.weekdaysShort=function(e,t,n){return wn(e,t,n,"weekdaysShort")},s.normalizeUnits=B,s.relativeTimeRounding=function(e){return void 0===e?$n:"function"==typeof e&&($n=e,!0)},s.relativeTimeThreshold=function(e,t){return void 0!==Kn[e]&&(void 0===t?Kn[e]:(Kn[e]=t,"s"===e&&(Kn.ss=t-1),!0))},s.calendarFormat=function(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},s.prototype=yn,s.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},s}()}).call(this,n(121)(e))},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Information=2]="Information",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.None=6]="None"}(i||(i={}))},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var i=n(723),s=n(196),r=n(115);function o(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return l(this,e,t,n)}function l(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=h(e,t);return e}(e,t,n,i):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|p(t,n),s=(e=a(e,i)).write(t,n);s!==i&&(e=e.slice(0,s));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|f(t.length);return 0===(e=a(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?a(e,0):h(e,t);if("Buffer"===t.type&&r(t.data))return h(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(u(t),e=a(e,t<0?0:0|f(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|f(t.length);e=a(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function f(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function p(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return B(e).length;default:if(i)return H(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,n);case"utf8":case"utf-8":return M(this,t,n);case"ascii":return A(this,t,n);case"latin1":case"binary":return k(this,t,n);case"base64":return T(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function g(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function y(e,t,n,i,s){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=s?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(s)return-1;n=e.length-1}else if(n<0){if(!s)return-1;n=0}if("string"==typeof t&&(t=c.from(t,i)),c.isBuffer(t))return 0===t.length?-1:v(e,t,n,i,s);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,i,s);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,i,s){var r,o=1,a=e.length,c=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,n/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(s){var u=-1;for(r=n;r<a;r++)if(l(e,r)===l(t,-1===u?0:r-u)){if(-1===u&&(u=r),r-u+1===c)return u*o}else-1!==u&&(r-=r-u),u=-1}else for(n+c>a&&(n=a-c),r=n;r>=0;r--){for(var d=!0,h=0;h<c;h++)if(l(e,r+h)!==l(t,h)){d=!1;break}if(d)return r}return-1}function S(e,t,n,i){n=Number(n)||0;var s=e.length-n;i?(i=Number(i))>s&&(i=s):i=s;var r=t.length;if(r%2!=0)throw new TypeError("Invalid hex string");i>r/2&&(i=r/2);for(var o=0;o<i;++o){var a=parseInt(t.substr(2*o,2),16);if(isNaN(a))return o;e[n+o]=a}return o}function _(e,t,n,i){return Y(H(t,e.length-n),e,n,i)}function E(e,t,n,i){return Y(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function w(e,t,n,i){return E(e,t,n,i)}function b(e,t,n,i){return Y(B(t),e,n,i)}function C(e,t,n,i){return Y(function(e,t){for(var n,i,s,r=[],o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),i=n>>8,s=n%256,r.push(s),r.push(i);return r}(t,e.length-n),e,n,i)}function T(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function M(e,t,n){n=Math.min(e.length,n);for(var i=[],s=t;s<n;){var r,o,a,c,l=e[s],u=null,d=l>239?4:l>223?3:l>191?2:1;if(s+d<=n)switch(d){case 1:l<128&&(u=l);break;case 2:128==(192&(r=e[s+1]))&&(c=(31&l)<<6|63&r)>127&&(u=c);break;case 3:r=e[s+1],o=e[s+2],128==(192&r)&&128==(192&o)&&(c=(15&l)<<12|(63&r)<<6|63&o)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:r=e[s+1],o=e[s+2],a=e[s+3],128==(192&r)&&128==(192&o)&&128==(192&a)&&(c=(15&l)<<18|(63&r)<<12|(63&o)<<6|63&a)>65535&&c<1114112&&(u=c)}null===u?(u=65533,d=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),s+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=4096));return n}(i)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=o(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return l(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,i){return u(t),t<=0?a(e,t):void 0!==n?"string"==typeof i?a(e,t).fill(n,i):a(e,t).fill(n):a(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return d(null,e)},c.allocUnsafeSlow=function(e){return d(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,s=0,r=Math.min(n,i);s<r;++s)if(e[s]!==t[s]){n=e[s],i=t[s];break}return n<i?-1:i<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!r(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=c.allocUnsafe(t),s=0;for(n=0;n<e.length;++n){var o=e[n];if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,s),s+=o.length}return i},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?M(this,0,e):m.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,i,s){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===s&&(s=this.length),t<0||n>e.length||i<0||s>this.length)throw new RangeError("out of range index");if(i>=s&&t>=n)return 0;if(i>=s)return-1;if(t>=n)return 1;if(this===e)return 0;for(var r=(s>>>=0)-(i>>>=0),o=(n>>>=0)-(t>>>=0),a=Math.min(r,o),l=this.slice(i,s),u=e.slice(t,n),d=0;d<a;++d)if(l[d]!==u[d]){r=l[d],o=u[d];break}return r<o?-1:o<r?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},c.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var s=this.length-t;if((void 0===n||n>s)&&(n=s),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var r=!1;;)switch(i){case"hex":return S(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":return E(this,e,t,n);case"latin1":case"binary":return w(this,e,t,n);case"base64":return b(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,n);default:if(r)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),r=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function A(e,t,n){var i="";n=Math.min(e.length,n);for(var s=t;s<n;++s)i+=String.fromCharCode(127&e[s]);return i}function k(e,t,n){var i="";n=Math.min(e.length,n);for(var s=t;s<n;++s)i+=String.fromCharCode(e[s]);return i}function R(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var s="",r=t;r<n;++r)s+=j(e[r]);return s}function P(e,t,n){for(var i=e.slice(t,n),s="",r=0;r<i.length;r+=2)s+=String.fromCharCode(i[r]+256*i[r+1]);return s}function I(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,n,i,s,r){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<r)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function L(e,t,n,i){t<0&&(t=65535+t+1);for(var s=0,r=Math.min(e.length-n,2);s<r;++s)e[n+s]=(t&255<<8*(i?s:1-s))>>>8*(i?s:1-s)}function D(e,t,n,i){t<0&&(t=4294967295+t+1);for(var s=0,r=Math.min(e.length-n,4);s<r;++s)e[n+s]=t>>>8*(i?s:3-s)&255}function x(e,t,n,i,s,r){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function O(e,t,n,i,r){return r||x(e,0,n,4),s.write(e,t,n,i,23,4),n+4}function F(e,t,n,i,r){return r||x(e,0,n,8),s.write(e,t,n,i,52,8),n+8}c.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var s=t-e;n=new c(s,void 0);for(var r=0;r<s;++r)n[r]=this[r+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var i=this[e],s=1,r=0;++r<t&&(s*=256);)i+=this[e+r]*s;return i},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var i=this[e+--t],s=1;t>0&&(s*=256);)i+=this[e+--t]*s;return i},c.prototype.readUInt8=function(e,t){return t||I(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||I(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||I(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var i=this[e],s=1,r=0;++r<t&&(s*=256);)i+=this[e+r]*s;return i>=(s*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var i=t,s=1,r=this[e+--i];i>0&&(s*=256);)r+=this[e+--i]*s;return r>=(s*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readInt8=function(e,t){return t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||I(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||I(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||I(e,4,this.length),s.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||I(e,4,this.length),s.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||I(e,8,this.length),s.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||I(e,8,this.length),s.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||N(this,e,t,n,Math.pow(2,8*n)-1,0);var s=1,r=0;for(this[t]=255&e;++r<n&&(s*=256);)this[t+r]=e/s&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||N(this,e,t,n,Math.pow(2,8*n)-1,0);var s=n-1,r=1;for(this[t+s]=255&e;--s>=0&&(r*=256);)this[t+s]=e/r&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var s=Math.pow(2,8*n-1);N(this,e,t,n,s-1,-s)}var r=0,o=1,a=0;for(this[t]=255&e;++r<n&&(o*=256);)e<0&&0===a&&0!==this[t+r-1]&&(a=1),this[t+r]=(e/o>>0)-a&255;return t+n},c.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var s=Math.pow(2,8*n-1);N(this,e,t,n,s-1,-s)}var r=n-1,o=1,a=0;for(this[t+r]=255&e;--r>=0&&(o*=256);)e<0&&0===a&&0!==this[t+r+1]&&(a=1),this[t+r]=(e/o>>0)-a&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return O(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return O(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return F(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return F(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var s,r=i-n;if(this===e&&n<t&&t<i)for(s=r-1;s>=0;--s)e[s+t]=this[s+n];else if(r<1e3||!c.TYPED_ARRAY_SUPPORT)for(s=0;s<r;++s)e[s+t]=this[s+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+r),t);return r},c.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var s=e.charCodeAt(0);s<256&&(e=s)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!c.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var r;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(r=t;r<n;++r)this[r]=e;else{var o=c.isBuffer(e)?e:H(new c(e,i).toString()),a=o.length;for(r=0;r<n-t;++r)this[r+t]=o[r%a]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function j(e){return e<16?"0"+e.toString(16):e.toString(16)}function H(e,t){var n;t=t||1/0;for(var i=e.length,s=null,r=[],o=0;o<i;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!s){if(n>56319){(t-=3)>-1&&r.push(239,191,189);continue}if(o+1===i){(t-=3)>-1&&r.push(239,191,189);continue}s=n;continue}if(n<56320){(t-=3)>-1&&r.push(239,191,189),s=n;continue}n=65536+(s-55296<<10|n-56320)}else s&&(t-=3)>-1&&r.push(239,191,189);if(s=null,n<128){if((t-=1)<0)break;r.push(n)}else if(n<2048){if((t-=2)<0)break;r.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;r.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;r.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return r}function B(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(U,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Y(e,t,n,i){for(var s=0;s<i&&!(s+n>=t.length||s>=e.length);++s)t[s+n]=e[s];return s}}).call(this,n(27))},function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});var s=n(325);t.WorkspaceProvider=s.WorkspaceProvider;var r=n(411);t.FileSystemManager=r.FileSystemManager;var o=n(23);t.sessionStateTracker=o.sessionStateTracker,t.setSessionStateTracker=o.setSessionStateTracker;var a=n(233);t.ApplyEditResult=a.ApplyEditResult;var c=n(79);t.CoEditingMessageFactory=c.MessageFactory,t.CoauthoringService=c.CoauthoringService;var l=n(949);t.HostSyncService=l.HostSyncService;var u=n(412);t.VSCodeBufferManager=u.VSCodeBufferManager,t.desyncReload=u.desyncReload;var d=n(166);t.SharedColors=d.SharedColors;const h=n(60);t.coeditingUtils=h;const f=n(235);t.textChange=f;var p=n(414);t.OTAlgorithm=p.OTAlgorithm,t.OTAlgorithmStatus=p.OTAlgorithmStatus,t.OTEdit=p.Edit;var m=n(234);t.CollabBuffer=m.CollabBuffer,t.CollabBufferPosition=m.CollabBufferPosition;var g=n(413);t.PrefixSumComputer=g.PrefixSumComputer;var y=n(416);t.SyncManager=y.SyncManager;var v=n(236);t.getTimedArray=v.getTimedArray,t.setArray=v.setArray;var S=n(61);t.dependencies=S.dependencies,t.Dependencies=S.Dependencies,i(n(21));var _=n(50);t.PathManager=_.PathManager,t.VSLS_SCHEME=_.VSLS_SCHEME,t.VSLS_EXTERNAL_SCHEME=_.VSLS_EXTERNAL_SCHEME,t.FILE_SCHEME=_.FILE_SCHEME,t.GITHUB_DEV_SCHEME=_.GITHUB_DEV_SCHEME,t.KNOWN_SCHEMES=_.KNOWN_SCHEMES;var E=n(15);t.SettingKeys=E.SettingKeys,t.FeatureSet=E.FeatureSet;var w=n(13);t.Settings=w.Settings,t.featureFlags=w.featureFlags;var b=n(1020);t.defaultSettings=b.defaultSettings;var C=n(94);t.SessionContext=C.SessionContext;var T=n(1021);t.RpcServices=T.RpcServices;var M=n(29);t.workspaceSessionInfoTracker=M.workspaceSessionInfoTracker;var A=n(427);t.AccessControlManager=A.AccessControlManager;var k=n(429);t.WorkspaceAccessControlManager=k.WorkspaceAccessControlManager,i(n(239));var R=n(1022);t.stateLazyLoad=R.stateLazyLoad;var P=n(22);t.ExtensionUtil=P.ExtensionUtil;var I=n(68);t.PathUtil=I.PathUtil;var N=n(431);t.EnumUtil=N.EnumUtil;var L=n(165);t.checkDebugging=L.checkDebugging;var D=n(237);t.calculateFileHash=D.calculateFileHash;var x=n(244);t.TelemetryUtil=x.TelemetryUtil;var O=n(33);t.DecoratorHelper=O.DecoratorHelper;var F=n(95);t.ClipboardUtil=F.ClipboardUtil;var U=n(130);t.TimeTracker=U.TimeTracker;var j=n(1023);t.askToSignInAndReload=j.askToSignInAndReload;var H=n(446);t.showInvitationLink=H.showInvitationLink;var B=n(1025);t.copyInvitationLinkToClipboard=B.copyInvitationLinkToClipboard,i(n(447)),i(n(448));var Y=n(246);t.TokenExchangeService=Y.TokenExchangeService;var W=n(97);t.SupportedAuthProviders=W.SupportedAuthProviders;var q=n(26);t.localize=q.localize,t.setLocalizeCallback=q.setLocalizeCallback;var V=n(445);t.WorkspaceServices=V.WorkspaceServices;var $=n(16);t.TelemetryEventNames=$.TelemetryEventNames,t.TelemetryPropertyNames=$.TelemetryPropertyNames,t.TelemetryEventOrigin=$.TelemetryEventOrigin;var K=n(161);t.ExtensionTelemetry=K.ExtensionTelemetry;var z=n(169);t.ActiveTimeRecorder=z.ActiveTimeRecorder;var G=n(1026);t.SamplingFilter=G.SamplingFilter,t.MissingConversationIdFilter=G.MissingConversationIdFilter;var J=n(93);t.CoauthoringTelemetry=J.CoauthoringTelemetry;const X=n(1027);t.rpcTelemetry=X;var Z=n(428);t.WellKnownRestrictedOperations=Z.WellKnownRestrictedOperations;var Q=n(31);t.userAuthStateTracker=Q.userAuthStateTracker;var ee=n(1029);t.RpcServiceHelper=ee.RpcServiceHelper;const te=n(69);t.constants=te;var ne=n(70);t.TreeViewItem=ne.TreeViewItem;var ie=n(1030);t.SessionExplorerProvider=ie.SessionExplorerProvider;var se=n(101);t.TreeDataProviderContext=se.TreeDataProviderContext;var re=n(1031);t.ParticipantsTreeDataProvider=re.ParticipantsTreeDataProvider;var oe=n(1035);t.TerminalsTreeDataProvider=oe.TerminalsTreeDataProvider;var ae=n(1036);t.ServerSharingTreeDataProvider=ae.ServerSharingTreeDataProvider;var ce=n(136);t.TreeDataProviderBase=ce.TreeDataProviderBase;var le=n(1037);t.HelpViewletProvider=le.HelpViewletProvider;var ue=n(1038);t.CollabActionTreeDataProvider=ue.CollabActionTreeDataProvider;var de=n(260);t.getLabelAndLinkTreeViewItems=de.getLabelAndLinkTreeViewItems;var he=n(241);t.UserError=he.UserError;var fe=n(243);t.ByDesignError=fe.ByDesignError;var pe=n(1039);t.decorate=pe.decorate,t.debounce=pe.debounce,t.memoize=pe.memoize;var me=n(102);t.telemetryCommandDecorator=me.telemetryCommandDecorator;var ge=n(137);t.errorNotificationCommandDecorator=ge.errorNotificationCommandDecorator;var ye=n(176);t.telemetryStatusCommandDecorator=ye.telemetryStatusCommandDecorator;var ve=n(1040);t.singleInvocationCommandDecorator=ve.singleInvocationCommandDecorator;var Se=n(261);t.sessionStateTransitionsCommandDecorator=Se.sessionStateTransitionsCommandDecorator;var _e=n(262);t.validationCommandDecorator=_e.validationCommandDecorator;var Ee=n(177);t.authenticationCommandDecorator=Ee.authenticationCommandDecorator;var we=n(178);t.cancellationDecorator=we.cancellationDecorator;var be=n(450);t.progressCommandDecorator=be.progressCommandDecorator;var Ce=n(1041);t.ExtensionSetupBase=Ce.ExtensionSetupBase;var Te=n(424);t.methodDecoratorsFactory=Te.methodDecoratorsFactory,t.commandBindingDecorator=Te.commandBindingDecorator,t.ControllerHelper=Te.ControllerHelper;var Me=n(1050);t.StatusBarController=Me.StatusBarController;var Ae=n(1051);t.createSimpleStatusBar=Ae.createSimpleStatusBar;var ke=n(452);t.initDisposableManager=ke.initDisposableManager,t.createInittableDisposable=ke.createInittableDisposable,t.lazyInittable=ke.lazyInittable;var Re=n(96);t.auth=Re.auth;var Pe=n(1052);t.registerProtocolHandler=Pe.registerProtocolHandler;var Ie=n(1053);t.AuthenticationProviderBase=Ie.AuthenticationProvider;var Ne=n(430);t.AuthenticationProviderService=Ne.AuthenticationProviderService;var Le=n(449);t.setAuthReloadFlag=Le.setAuthReloadFlag,t.resetAuthReloadFlag=Le.resetAuthReloadFlag,t.SignInReloadMode=Le.SignInReloadMode;var De=n(240);t.liveshareGithubStrategy=De.liveshareGithubStrategy,t.liveshareAnonymousStrategy=De.liveshareAnonymousStrategy;var xe=n(451);t.registerCoreCommands=xe.registerCommands;var Oe=n(1054);t.JoinCommandUtilities=Oe.JoinCommandUtilities;var Fe=n(1055);t.ShareCommandUtilities=Fe.ShareCommandUtilities;var Ue=n(453);t.getAllRootFileSystemPaths=Ue.getAllRootFileSystemPaths;var je=n(1056);t.Commands=je.Commands;var He=n(263);t.LiveShareCommandBase=He.LiveShareCommandBase,i(n(1057));var Be=n(1127);t.startLocalWorkspaceHubService=Be.startLocalWorkspaceHubService,i(n(264)),i(n(467));var Ye=n(42);t.initExpServiceAsync=Ye.initAsync,t.getExpService=Ye.getExpService;var We=n(168);t.TreatmentVariables=We.TreatmentVariables;var qe=n(1128);t.ArgumentError=qe.ArgumentError,t.Requires=qe.Requires;var Ve=n(1129);t.SearchProvider=Ve.SearchProvider;var $e=n(1131);t.reconnectHostCallback=$e.reconnectHostCallback;var Ke=n(1132);t.recordTerminalActivities=Ke.recordTerminalActivities,t.disposeActivityListeners=Ke.disposeActivityListeners;var ze=n(232);t.NotebookConstants=ze.NotebookConstants;var Ge=n(410);t.findNotebookCell=Ge.findNotebookCell,t.findNotebookCellWithCustomMetadata=Ge.findNotebookCellWithCustomMetadata,t.getNotebookCellData=Ge.getNotebookCellData,t.getCellId=Ge.getCellId,t.findNotebookCellById=Ge.findNotebookCellById,t.sortCells=Ge.sortCells,t.getNotebookHash=Ge.getNotebookHash;var Je=n(409);t.assert=Je.assert;var Xe=n(1133);t.initInviteLinkSupport=Xe.initInviteLinkSupport;var Ze=n(175);t.showWelcomePage=Ze.showWelcomePage,t.WelcomePageSource=Ze.WelcomePageSource,t.showWelcomeNotification=Ze.showWelcomeNotification,i(n(1134)),t.rc=n(1145)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vsls=n(226),t.contactProtocol=n(904)},function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(215)),i(n(369)),i(n(125)),i(n(847)),i(n(849))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(857);t.vslsCommands=i.vslsCommands;var s=n(872);t.telemetryCommandDecorator=s.telemetryCommandDecorator;var r=n(874);t.errorNotificationCommandDecorator=r.errorNotificationCommandDecorator;var o=n(875);t.CommandBase=o.CommandBase;var a=n(92);t.CommandError=a.CommandError;var c=n(876);t.CommandErrorCode=c.CommandErrorCode;var l=n(388);t.CancellationError=l.CancellationError;var u=n(386);t.ByDesignError=u.ByDesignError;var d=n(389);t.NonBlockingError=d.NonBlockingError;var h=n(387);t.UserError=h.UserError;var f=n(877);t.OptOutTelemetryFilter=f.OptOutTelemetryFilter;var p=n(878);t.LogZipExporter=p.LogZipExporter;var m=n(128);t.traceSource=m.traceSource;var g=n(385);t.NotificationUtil=g.NotificationUtil;var y=n(127);t.getExtensionContext=y.getExtensionContext;var v=n(895);t.getExtensionUri=v.getExtensionUri;var S=n(896);t.launchUrlScraper=S.launchUrlScraper;var _=n(225);t.dataScrapingManagerInstance=_.dataScrapingManagerInstance,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(224));var E=n(901);t.createTerminalRenderer=E.createTerminalRenderer;var w=n(902);t.fileAccess=w.fileAccessInstance;var b=n(903);t.VscodeSessionStatusProvider=b.VscodeSessionStatusProvider;var C=n(394);t.VscodeSessionStatus=C.VscodeSessionStatus;var T=n(392);t.VscodeActivityProvider=T.VscodeActivityProvider;var M=n(393);t.VscodeActivityType=M.VscodeActivityType;var A=n(222);t.loadJSON=A.loadJSON},function(e,t,n){"use strict";(function(e){function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});const s=n(116),r=n(327);t.RequestType=r.RequestType,t.RequestType0=r.RequestType0,t.RequestType1=r.RequestType1,t.RequestType2=r.RequestType2,t.RequestType3=r.RequestType3,t.RequestType4=r.RequestType4,t.RequestType5=r.RequestType5,t.RequestType6=r.RequestType6,t.RequestType7=r.RequestType7,t.RequestType8=r.RequestType8,t.RequestType9=r.RequestType9,t.ResponseError=r.ResponseError,t.ErrorCodes=r.ErrorCodes,t.NotificationType=r.NotificationType,t.NotificationType0=r.NotificationType0,t.NotificationType1=r.NotificationType1,t.NotificationType2=r.NotificationType2,t.NotificationType3=r.NotificationType3,t.NotificationType4=r.NotificationType4,t.NotificationType5=r.NotificationType5,t.NotificationType6=r.NotificationType6,t.NotificationType7=r.NotificationType7,t.NotificationType8=r.NotificationType8,t.NotificationType9=r.NotificationType9;const o=n(197);t.MessageReader=o.MessageReader,t.StreamMessageReader=o.StreamMessageReader,t.IPCMessageReader=o.IPCMessageReader,t.SocketMessageReader=o.SocketMessageReader;const a=n(198);t.MessageWriter=a.MessageWriter,t.StreamMessageWriter=a.StreamMessageWriter,t.IPCMessageWriter=a.IPCMessageWriter,t.SocketMessageWriter=a.SocketMessageWriter;const c=n(152);t.Disposable=c.Disposable,t.Event=c.Event,t.Emitter=c.Emitter;const l=n(738);t.CancellationTokenSource=l.CancellationTokenSource,t.CancellationToken=l.CancellationToken;const u=n(739);var d,h,f,p,m,g,y;i(n(740)),i(n(815)),function(e){e.type=new r.NotificationType("$/cancelRequest")}(d||(d={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Verbose=2]="Verbose"}(h=t.Trace||(t.Trace={})),function(e){e.fromString=function(t){switch(t=t.toLowerCase()){case"off":return e.Off;case"messages":return e.Messages;case"verbose":return e.Verbose;default:return e.Off}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Verbose:return"verbose";default:return"off"}}}(h=t.Trace||(t.Trace={})),function(e){e.Text="text",e.JSON="json"}(t.TraceFormat||(t.TraceFormat={})),function(e){e.fromString=function(t){return"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(f=t.TraceFormat||(t.TraceFormat={})),function(e){e.type=new r.NotificationType("$/setTraceNotification")}(p=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new r.NotificationType("$/logTraceNotification")}(m=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(g=t.ConnectionErrors||(t.ConnectionErrors={}));class v extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,v.prototype)}}function S(t,n,i,o){let a=0,S=0,_=0;let E,w,b=void 0,C=Object.create(null),T=void 0,M=Object.create(null),A=new u.LinkedMap,k=Object.create(null),R=Object.create(null),P=h.Off,I=f.Text,N=y.New,L=new c.Emitter,D=new c.Emitter,x=new c.Emitter,O=new c.Emitter;function F(e){return"req-"+e.toString()}function U(e,t){var n;r.isRequestMessage(t)?e.set(F(t.id),t):r.isResponseMessage(t)?e.set(null===(n=t.id)?"res-unknown-"+(++_).toString():"res-"+n.toString(),t):e.set("not-"+(++S).toString(),t)}function j(e){}function H(){return N===y.Listening}function B(){return N===y.Closed}function Y(){return N===y.Disposed}function W(){N!==y.New&&N!==y.Listening||(N=y.Closed,D.fire(void 0))}function q(){E||0===A.size||(E=e(()=>{E=void 0,function(){if(0===A.size)return;let e=A.shift();try{r.isRequestMessage(e)?function(e){if(Y())return;function t(t,i,s){let o={jsonrpc:"2.0",id:e.id};t instanceof r.ResponseError?o.error=t.toJson():o.result=void 0===t?null:t,$(o,i,s),n.write(o)}function i(t,i,s){let r={jsonrpc:"2.0",id:e.id,error:t.toJson()};$(r,i,s),n.write(r)}!function(e){if(P===h.Off||!w)return;if(I===f.Text){let t=void 0;P===h.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),w.log(`Received request '${e.method} - (${e.id})'.`,t)}else K("receive-request",e)}(e);let o,a,c=C[e.method];c&&(o=c.type,a=c.handler);let u=Date.now();if(a||b){let c=new l.CancellationTokenSource,d=String(e.id);R[d]=c;try{let l;l=void 0===e.params||void 0!==o&&0===o.numberOfParams?a?a(c.token):b(e.method,c.token):s.array(e.params)&&(void 0===o||o.numberOfParams>1)?a?a(...e.params,c.token):b(e.method,...e.params,c.token):a?a(e.params,c.token):b(e.method,e.params,c.token);let h=l;l?h.then?h.then(n=>{delete R[d],t(n,e.method,u)},t=>{delete R[d],t instanceof r.ResponseError?i(t,e.method,u):t&&s.string(t.message)?i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,u):i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)}):(delete R[d],t(l,e.method,u)):(delete R[d],function(t,i,s){void 0===t&&(t=null);let r={jsonrpc:"2.0",id:e.id,result:t};$(r,i,s),n.write(r)}(l,e.method,u))}catch(n){delete R[d],n instanceof r.ResponseError?t(n,e.method,u):n&&s.string(n.message)?i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${n.message}`),e.method,u):i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)}}else i(new r.ResponseError(r.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,u)}(e):r.isNotificationMessage(e)?function(e){if(Y())return;let t,n=void 0;if(e.method===d.type.method)t=e=>{let t=e.id,n=R[String(t)];n&&n.cancel()};else{let i=M[e.method];i&&(t=i.handler,n=i.type)}if(t||T)try{!function(e){if(P===h.Off||!w||e.method===m.type.method)return;if(I===f.Text){let t=void 0;P===h.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),w.log(`Received notification '${e.method}'.`,t)}else K("receive-notification",e)}(e),void 0===e.params||void 0!==n&&0===n.numberOfParams?t?t():T(e.method):s.array(e.params)&&(void 0===n||n.numberOfParams>1)?t?t(...e.params):T(e.method,...e.params):t?t(e.params):T(e.method,e.params)}catch(t){t.message?i.error(`Notification handler '${e.method}' failed with message: ${t.message}`):i.error(`Notification handler '${e.method}' failed unexpectedly.`)}else x.fire(e)}(e):r.isResponseMessage(e)?function(e){if(Y())return;if(null===e.id)e.error?i.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let t=String(e.id),n=k[t];if(function(e,t){if(P===h.Off||!w)return;if(I===f.Text){let n=void 0;if(P===h.Verbose&&(e.error&&e.error.data?n=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?n=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),t){let i=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";w.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${i}`,n)}else w.log(`Received response ${e.id} without active response promise.`,n)}else K("receive-response",e)}(e,n),n){delete k[t];try{if(e.error){let t=e.error;n.reject(new r.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");n.resolve(e.result)}}catch(e){e.message?i.error(`Response handler '${n.method}' failed with message: ${e.message}`):i.error(`Response handler '${n.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void i.error("Received empty message.");i.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);let t=e;if(s.string(t.id)||s.number(t.id)){let e=String(t.id),n=k[e];n&&n.reject(new Error("The received response has neither a result nor an error property."))}}(e)}finally{q()}}()}))}t.onClose(W),t.onError((function(e){L.fire([e,void 0,void 0])})),n.onClose(W),n.onError((function(e){L.fire(e)}));let V=e=>{try{if(r.isNotificationMessage(e)&&e.method===d.type.method){let t=F(e.params.id),i=A.get(t);if(r.isRequestMessage(i)){let s=o&&o.cancelUndispatched?o.cancelUndispatched(i,j):void 0;if(s&&(void 0!==s.error||void 0!==s.result))return A.delete(t),s.id=i.id,$(s,e.method,Date.now()),void n.write(s)}}U(A,e)}finally{q()}};function $(e,t,n){if(P!==h.Off&&w)if(I===f.Text){let i=void 0;P===h.Verbose&&(e.error&&e.error.data?i=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?i=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(i="No result returned.\n\n")),w.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-n}ms`,i)}else K("send-response",e)}function K(e,t){if(!w||P===h.Off)return;const n={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};w.log(n)}function z(){if(B())throw new v(g.Closed,"Connection is closed.");if(Y())throw new v(g.Disposed,"Connection is disposed.")}function G(e){return void 0===e?null:e}function J(e,t){let n,i=e.numberOfParams;switch(i){case 0:n=null;break;case 1:n=G(t[0]);break;default:n=[];for(let e=0;e<t.length&&e<i;e++)n.push(G(t[e]));if(t.length<i)for(let e=t.length;e<i;e++)n.push(null)}return n}let X={sendNotification:(e,...t)=>{let i,r;if(z(),s.string(e))switch(i=e,t.length){case 0:r=null;break;case 1:r=t[0];break;default:r=t}else i=e.method,r=J(e,t);let o={jsonrpc:"2.0",method:i,params:r};!function(e){if(P!==h.Off&&w)if(I===f.Text){let t=void 0;P===h.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),w.log(`Sending notification '${e.method}'.`,t)}else K("send-notification",e)}(o),n.write(o)},onNotification:(e,t)=>{z(),s.func(e)?T=e:t&&(s.string(e)?M[e]={type:void 0,handler:t}:M[e.method]={type:e,handler:t})},sendRequest:(e,...t)=>{let i,o;z(),function(){if(!H())throw new Error("Call listen() first.")}();let c=void 0;if(s.string(e))switch(i=e,t.length){case 0:o=null;break;case 1:l.CancellationToken.is(t[0])?(o=null,c=t[0]):o=G(t[0]);break;default:const e=t.length-1;l.CancellationToken.is(t[e])?(c=t[e],o=2===t.length?G(t[0]):t.slice(0,e).map(e=>G(e))):o=t.map(e=>G(e))}else{i=e.method,o=J(e,t);let n=e.numberOfParams;c=l.CancellationToken.is(t[n])?t[n]:void 0}let u=a++,p=new Promise((e,t)=>{let s={jsonrpc:"2.0",id:u,method:i,params:o},a={method:i,timerStart:Date.now(),resolve:e,reject:t};!function(e){if(P!==h.Off&&w)if(I===f.Text){let t=void 0;P===h.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),w.log(`Sending request '${e.method} - (${e.id})'.`,t)}else K("send-request",e)}(s);try{n.write(s)}catch(e){a.reject(new r.ResponseError(r.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),a=null}a&&(k[String(u)]=a)});return c&&c.onCancellationRequested(()=>{X.sendNotification(d.type,{id:u})}),p},onRequest:(e,t)=>{z(),s.func(e)?b=e:t&&(s.string(e)?C[e]={type:void 0,handler:t}:C[e.method]={type:e,handler:t})},trace:(e,t,n)=>{let i=!1,r=f.Text;void 0!==n&&(s.boolean(n)?i=n:(i=n.sendNotification||!1,r=n.traceFormat||f.Text)),P=e,I=r,w=P===h.Off?void 0:t,!i||B()||Y()||X.sendNotification(p.type,{value:h.toString(e)})},onError:L.event,onClose:D.event,onUnhandledNotification:x.event,onDispose:O.event,dispose:()=>{if(Y())return;N=y.Disposed,O.fire(void 0);let e=new Error("Connection got disposed.");Object.keys(k).forEach(t=>{k[t].reject(e)}),k=Object.create(null),R=Object.create(null),A=new u.LinkedMap,s.func(n.dispose)&&n.dispose(),s.func(t.dispose)&&t.dispose()},listen:()=>{z(),function(){if(H())throw new v(g.AlreadyListening,"Connection is already listening")}(),N=y.Listening,t.listen(V)},inspect:()=>{console.log("inspect")}};return X.onNotification(m.type,e=>{P!==h.Off&&w&&w.log(e.message,P===h.Verbose?e.verbose:void 0)}),X}t.ConnectionError=v,function(e){e.is=function(e){let t=e;return t&&s.func(t.cancelUndispatched)}}(t.ConnectionStrategy||(t.ConnectionStrategy={})),function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(y||(y={})),t.createMessageConnection=function(e,n,i,s){var r;return i||(i=t.NullLogger),S(void 0!==(r=e).listen&&void 0===r.read?e:new o.StreamMessageReader(e),function(e){return void 0!==e.write&&void 0===e.end}(n)?n:new a.StreamMessageWriter(n),i,s)}}).call(this,n(57).setImmediate)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(860);t.Telemetry=i.Telemetry,t.TelemetryClass=i.TelemetryClass,t.TelemetryEvent=i.TelemetryEvent,t.Fault=i.Fault,t.TimedEvent=i.TimedEvent,t.cleanSensitiveInformation=i.cleanSensitiveInformation,t.propagateOffsetMarkTime=i.propagateOffsetMarkTime;var s=n(221);t.TelemetryPropertyNames=s.TelemetryPropertyNames;var r=n(380);t.FaultType=r.FaultType;var o=n(381);t.TelemetryResult=o.Result;var a=n(863);t.SendOnceFilter=a.SendOnceFilter,t.SamplingFilter=a.SamplingFilter},function(e,t,n){"use strict";(function(e){n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"i",(function(){return h})),n.d(t,"j",(function(){return f})),n.d(t,"f",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"b",(function(){return g})),n.d(t,"h",(function(){return y}));var i=n(2),s=n(72),r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},o=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){e.done?s(e.value):new n((function(t){t(e.value)})).then(o,a)}c((i=i.apply(e,t||[])).next())}))},a=function(e,t){var n,i,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,i=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],i=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},c="5.0.8",l=function(){function e(){}return e.isRequired=function(e,t){if(null==e)throw new Error("The '"+t+"' argument is required.")},e.isNotEmpty=function(e,t){if(!e||e.match(/^\s*$/))throw new Error("The '"+t+"' argument should not be empty.")},e.isIn=function(e,t,n){if(!(e in t))throw new Error("Unknown "+n+" value: "+e+".")},e}(),u=function(){function e(){}return Object.defineProperty(e,"isBrowser",{get:function(){return"object"==typeof window},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isWebWorker",{get:function(){return"object"==typeof self&&"importScripts"in self},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isNode",{get:function(){return!this.isBrowser&&!this.isWebWorker},enumerable:!0,configurable:!0}),e}();function d(e,t){var n="";return h(e)?(n="Binary data of length "+e.byteLength,t&&(n+=". Content: '"+function(e){var t=new Uint8Array(e),n="";return t.forEach((function(e){n+="0x"+(e<16?"0":"")+e.toString(16)+" "})),n.substr(0,n.length-1)}(e)+"'")):"string"==typeof e&&(n="String data of length "+e.length,t&&(n+=". Content: '"+e+"'")),n}function h(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function f(e,t,n,s,c,l,u,f,p){return o(this,void 0,void 0,(function(){var o,m,g,v,S,_,E,w;return a(this,(function(a){switch(a.label){case 0:return m={},c?[4,c()]:[3,2];case 1:(g=a.sent())&&((o={}).Authorization="Bearer "+g,m=o),a.label=2;case 2:return v=y(),S=v[0],_=v[1],m[S]=_,e.log(i.a.Trace,"("+t+" transport) sending data. "+d(l,u)+"."),E=h(l)?"arraybuffer":"text",[4,n.post(s,{content:l,headers:r({},m,p),responseType:E,withCredentials:f})];case 3:return w=a.sent(),e.log(i.a.Trace,"("+t+" transport) request complete. Response status: "+w.statusCode+"."),[2]}}))}))}function p(e){return void 0===e?new g(i.a.Information):null===e?s.a.instance:e.log?e:new g(e)}var m=function(){function e(e,t){this.subject=e,this.observer=t}return e.prototype.dispose=function(){var e=this.subject.observers.indexOf(this.observer);e>-1&&this.subject.observers.splice(e,1),0===this.subject.observers.length&&this.subject.cancelCallback&&this.subject.cancelCallback().catch((function(e){}))},e}(),g=function(){function e(e){this.minimumLogLevel=e,this.outputConsole=console}return e.prototype.log=function(e,t){if(e>=this.minimumLogLevel)switch(e){case i.a.Critical:case i.a.Error:this.outputConsole.error("["+(new Date).toISOString()+"] "+i.a[e]+": "+t);break;case i.a.Warning:this.outputConsole.warn("["+(new Date).toISOString()+"] "+i.a[e]+": "+t);break;case i.a.Information:this.outputConsole.info("["+(new Date).toISOString()+"] "+i.a[e]+": "+t);break;default:this.outputConsole.log("["+(new Date).toISOString()+"] "+i.a[e]+": "+t)}},e}();function y(){var e="X-SignalR-User-Agent";return u.isNode&&(e="User-Agent"),[e,v(c,S(),E(),_())]}function v(e,t,n,i){var s="Microsoft SignalR/",r=e.split(".");return s+=r[0]+"."+r[1],s+=" ("+e+"; ",s+=t&&""!==t?t+"; ":"Unknown OS; ",s+=""+n,s+=i?"; "+i:"; Unknown Runtime Version",s+=")"}function S(){if(!u.isNode)return"";switch(e.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return e.platform}}function _(){if(u.isNode)return e.versions.node}function E(){return u.isNode?"NodeJS":"Browser"}}).call(this,n(11))},function(e,t){var n,i,s=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var c,l=[],u=!1,d=-1;function h(){u&&c&&(u=!1,c.length?l=c.concat(l):d=-1,l.length&&f())}function f(){if(!u){var e=a(h);u=!0;for(var t=l.length;t;){for(c=l,l=[];++d<t;)c&&c[d].run();d=-1,t=l.length}c=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||u||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(227),s=n(15),r=n(32);class o{static get(e){return o.settingsProvider.get(e)}static getMemento(e){return o.settingsProvider.mementoConfig.get(e)}static saveMemento(e,t){return o.settingsProvider.mementoConfig.save(e,t)}static getUri(e,t){const n=t?o.getMemento(e):o.get(e);if(n)return a(n)}static get scheme(){return"vsls"}static get isVSLSTeamMember(){return!!o.get(s.SettingKeys.teamStatus)}static get isInternalFeatureSet(){return o.get(s.SettingKeys.isInternal)}static get isInsidersFeatureSet(){const e=o.get(s.SettingKeys.featureSet);return!!e&&s.FeatureSet[e]===s.FeatureSet.insiders}static get isNativeAuth(){return!!o.get(s.SettingKeys.nativeAuthFlow)}static save(e,t,n=!0){return o.settingsProvider.save(e,t,n)}}function a(e){try{return r.parse(e)}catch(e){return}}t.Settings=o,o.settingsProvider=i.settingsProviderInstance,t.featureFlags={api:!1,localUndo:!1,localRedo:!1,multiRootWorkspaceVSIDE:!1,propagateFolderEvents:!1,agentExtension:!1,comments:!0,attemptReconnection:!0},t.parseUrl=a},function(e,t,n){var i=n(3),s=i.Buffer;function r(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return s(e,t,n)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?e.exports=i:(r(i,t),t.Buffer=o),o.prototype=Object.create(s.prototype),r(s,o),o.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return s(e,t,n)},o.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=s(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return s(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.accountProvider="accountProvider",e.account="account",e.connectionMode="connectionMode",e.allowGuestDebugControl="allowGuestDebugControl",e.allowGuestTaskControl="allowGuestTaskControl",e.autoShareServers="autoShareServers",e.anonymousGuestApproval="anonymousGuestApproval",e.diagnosticLoggingLevel="diagnosticLoggingLevel",e.diagnosticMode="diagnosticMode",e.allowedDomains="allowedDomains",e.allowReadWriteTerminals="allowReadWriteTerminals",e.featureSet="featureSet",e.nameTagVisibility="nameTagVisibility",e.showReadOnlyUsersInEditor="showReadOnlyUsersInEditor",e.focusBehavior="focusBehavior",e.shareExternalFiles="shareExternalFiles",e.guestApprovalRequired="guestApprovalRequired",e.allowGuestCommandControl="languages.allowGuestCommandControl",e.allowGuestExecuteCells="notebooks.allowGuestExecuteCells",e.joinDebugSessionOption="joinDebugSessionOption",e.showVerboseNotifications="showVerboseNotifications",e.publishWorkspaceInfo="publishWorkspaceInfo",e.diagnosticLogging="diagnosticLogging",e.populateGitCoAuthors="populateGitCoAuthors",e.showInStatusBar="showInStatusBar",e.comments="comments",e.openSharedServers="openSharedServers",e.presence="presence",e.teamStatus="teamStatus",e.allowInvites="allowInvites",e.alwaysFollowHost="alwaysFollowHost",e.remoteLabelAndLinks="remoteLabelAndLinks",e.authFlowTest="authFlowTest",e.nativeAuthFlow="nativeAuthFlow",e.commandPrefix="commandPrefix",e.serviceUri="serviceUri",e.signalRServiceUri="signalRServiceUri",e.scheme="scheme",e.authority="authority",e.canCollectPII="canCollectPII",e.desyncReload="desyncReload",e.userEmail="userEmail",e.isInternal="isInternal",e.isCloudEnvironment="isCloudEnvironment",e.name="name",e.shortName="shortName",e.abbreviation="abbreviation",e.licenseUrl="licenseUrl",e.privacyUrl="privacyUrl",e.hasUsed="hasUsed",e.configName="configName",e.activityTimeout="activityTimeout",e.customAccountAuthReloadFlag="customAccountAuthReloadFlag",e.anonymousAuthReloadFlag="anonymousAuthReloadFlag",e.extensionPermissions="extensionPermissions",e.authenticationProvider="authenticationProvider",e.useClientFileService="useClientFileService",e.remoteSettingsUri="remoteSettingsUri",e.remoteSettingsUpdateMinutes="remoteSettingsUpdateMinutes",e.textSearchResultsLimit="textSearchResultsLimit",e.textSearchPreviewLimit="textSearchPreviewLimit",e.whatsNewUri="whatsNewUri",e.runsInVSCodeDev="runsInVSCodeDev",e.joinWorkspaceId="joinWorkspaceId",e.performanceLogging="performanceLogging",e.anonymousUserName="anonymousUserName",e.microphoneId="microphoneId",e.speakerId="speakerId",e.newChatDisplayDate="newChatDisplayDate",e.newAudioDisplayDate="newAudioDisplayDate",e.showLauncherInstallNotification="showLauncherInstallNotification",e.showLauncherError="showLauncherError",e.sessionCount="sessionCount",e.dontRequestFeedback="dontRequestFeedback",e.dontRequestAdditionalFeedback="dontRequestAdditionalFeedback",e.surveyShownDate="surveyShownDate",e.firstActivationTime="firstActivationTime"}(t.SettingKeys||(t.SettingKeys={})),function(e){e.stable="stable",e.insiders="insiders"}(t.FeatureSet||(t.FeatureSet={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.TelemetryEventNames=i,i.ADD_EXTERNAL_FILE="add-external-file",i.REMOVE_USER="remove-user",i.BLOCK_USER="block-user",i.FAULT_PREFIX="Fault/",i.ACTIVATE_EXTENSION="activate-extension",i.CLICK_SHARE_BUTTON="click-sharebutton",i.DEACTIVATE_EXTENSION="deactivate-extension",i.ACTIVATE_AGENTASYNC="activate-agentasync",i.JOIN_ON_START_EVENT="join-on-start",i.START_AGENT="start-agent",i.START_AGENT_CONNECTION="start-agentconnection",i.SIGN_IN="signin-user",i.SIGN_IN_EXPLICIT="signin-user-explicit",i.INITIATE_SESSION="initiate-session",i.PRE_RELOAD_WORKSPACE="pre-reload-workspace",i.JOIN_WORKSPACE="join-workspace",i.JOINED_PS_FROM_VIEWLET="join-ps-from-viewlet",i.SHARE_WORKSPACE="share-workspace",i.HAS_COLLABORATORS="has-collaborators",i.CREATE_INVITATION_LINK="create-invitationlink",i.CREATE_WORKSPACE="create-workspace",i.LIST_PLANNED_SESSION="list-planned-session",i.CREATE_PLANNED_SESSION="create-planned-session",i.DELETE_PLANNED_SESSION="delete-planned-session",i.RENAME_PLANNED_SESSION="rename-planned-session",i.COPY_PLANNED_SESSION_LINK="copy-planned-session-link",i.SHOW_PLANNED_SESSIONS="show-planned-sessions",i.PLANNED_SESSIONS_LIST_IS_NOT_EMPTY="planned-sessions-list-is-not-empty",i.WORKSPACE_SIGNIN_RELOAD="signin-reload-workspace",i.HTTP_REQUEST_COMPLETE="complete-httprequest",i.INITIALIZE_DEBUGGING="initialize-debugging",i.INITIALIZE_COAUTHORING="initialize-coauthoring",i.VERSION_CHECK_FAIL=i.FAULT_PREFIX+"check-version-fault",i.ASSERT_FAULT=i.FAULT_PREFIX+"assert-fault",i.DOWNLOAD_FAULT=i.FAULT_PREFIX+"download-fault",i.SIGN_IN_FAULT=i.FAULT_PREFIX+"signin-user-fault",i.SIGN_IN_FAULT_EXPLICIT=i.FAULT_PREFIX+"signin-user-fault-explicit",i.AGENT_INIT_SIGN_IN_ATTEMPT_FAULT=i.FAULT_PREFIX+"signin-agentinit-fault",i.USER_ACTION_AGENT_INIT_SIGN_IN_ATTEMPT_FAULT=i.FAULT_PREFIX+"userinteraction-agentinit-fault",i.UPDATE_WORKPSACE_NAME_FAIL=i.FAULT_PREFIX+"update-workspace-name-fault",i.LEAVE_COLLABORATION_FAIL=i.FAULT_PREFIX+"leave-collaboration-fault",i.CREATE_INVITATION_LINK_FAULT=i.FAULT_PREFIX+"create-invitationlink-fault",i.CREATE_FAULT=i.FAULT_PREFIX+"create-workspace-fault",i.LIST_PLANNED_SESSION_FAULT=i.FAULT_PREFIX+"list-planned-session-fault",i.CREATE_PLANNED_SESSION_FAULT=i.FAULT_PREFIX+"create-planned-session-fault",i.DELETE_PLANNED_SESSION_FAULT=i.FAULT_PREFIX+"delete-planned-session-fault",i.RENAME_PLANNED_SESSION_FAULT=i.FAULT_PREFIX+"rename-planned-session-fault",i.COPY_PLANNED_SESSION_LINK_FAULT=i.FAULT_PREFIX+"copy-planned-session-link-fault",i.JOIN_PLANNED_SESSION_FAULT=i.FAULT_PREFIX+"join-planned-session-fault",i.SHARE_FAULT=i.FAULT_PREFIX+"share-workspace-fault",i.JOIN_FAULT=i.FAULT_PREFIX+"join-workspace-fault",i.ACTIVATE_EXTENSION_FAULT=i.FAULT_PREFIX+"activate-extension-fault",i.DEACTIVATE_EXTENSION_FAULT=i.FAULT_PREFIX+"deactivate-extension-fault",i.ACTIVATE_AGENTASYNC_FAULT=i.FAULT_PREFIX+"activate-agentasync-fault",i.UNHANDLED_COMMAND_ERROR_FAULT=i.FAULT_PREFIX+"unhandled-commanderror-fault",i.UNHANDLED_REJECTION_FAULT=i.FAULT_PREFIX+"unhandled-rejection-fault",i.REQUEST_OPERATION_ACCESS_FAULT=i.FAULT_PREFIX+"request-operation-access-fault",i.TRANSITION="transition-state",i.REPORT_AGENTPROGRESS="report-agentprogress",i.WRITE_LOGS_FAILED=i.FAULT_PREFIX+"write-logs-failed",i.OPEN_LOGS_FAILED=i.FAULT_PREFIX+"open-logs-failed",i.NAME_LOGS_FILE_FAILED=i.FAULT_PREFIX+"name-logfile-failed",i.ACTIVATE_EXTENSION_API="activate-extensionapi",i.SHARE_EXTENSION_SERVICE="share-extensionservice",i.INVOKE_EXTENSION_COMMAND="invoke-extensioncommand",i.FEEDBACK="report-feedback",i.OPEN_LINK="open-link",i.PASTE_INVALIDLINK_FAULT=i.FAULT_PREFIX+"paste-invalidlink-fault",i.LINUX_VERSION="report-linuxversion",i.SESSION="participate-session",i.SILENT_SIGNIN_TIMEOUT=i.FAULT_PREFIX+"signin-timeout-fault",i.JOIN_FROM_BROWSER_FAULT=i.FAULT_PREFIX+"join-browser-fault",i.SHARE_TERMINAL="share-terminal",i.SHARE_TERMINAL_FAULT=i.FAULT_PREFIX+"share-terminal-fault",i.MAKE_TERMINAL_READ_ONLY="make-terminal-read-only",i.MAKE_TERMINAL_READ_ONLY_FAULT=i.FAULT_PREFIX+"make-terminal-read-only-fault",i.MAKE_TERMINAL_READ_WRITE="make-terminal-read-write",i.MAKE_TERMINAL_READ_WRITE_FAULT=i.FAULT_PREFIX+"make-terminal-read-write-fault",i.RUN_SHARED_TERMINAL_FAULT=i.FAULT_PREFIX+"run-terminal-fault",i.OPEN_TERMINAL="open-terminal",i.OPEN_TERMINAL_FAULT=i.FAULT_PREFIX+"open-terminal-fault",i.REMOVE_TERMINAL="remove-terminal",i.REMOVE_TERMINAL_FAULT=i.FAULT_PREFIX+"remove-terminal-fault",i.LIST_TERMINALS="list-terminals",i.LIST_TERMINALS_FAULT=i.FAULT_PREFIX+"list-terminals-fault",i.SHOW_WHATS_NEW_INFO="show-whatsnew",i.WELCOME_PAGE_TOAST_SHOWN="show-welcomepage-toast",i.WELCOME_PAGE_TOAST_SHOWN_INTERACTION="interact-welcomepage-toast",i.WELCOME_PAGE_SHOWN="show-welcomepage",i.WELCOME_PAGE_DISMISSED="dismiss-welcomepage",i.WELCOME_PAGE_COPY_CLICKED="copy-clicked-welcomepage",i.WELCOME_PAGE_LINK_CLICKED="link-clicked-welcomepage",i.SUMMON_PARTICIPANTS_INVOKED="summon-participants",i.COPY_COLLABORATION_LINK_INVOKLED="copy-collaborationlink",i.COMMAND_INITIATED="command-initiated",i.ZEROUSER_SESSION="zerouser-session",i.GUEST_INITIATED_DEBUGGING="guest-initiated-debugging-started",i.REJECT_RESTRICTED_OPERATION="reject-restrictedOperation",i.REQUEST_RESTRICTED_OPERATION="request-restrictedOperationAccess",i.SET_RESTRICTED_OPERATION_ACCESS="set-restrictedOperationAccess",i.REPORT_SETTINGS="report-settings",i.CHANGE_SETTING="change-setting",i.WORKSPACE_CONNECTION_ERROR="drop-workspaceconnection-fault",i.INVOKE_NEWPROTOCOLHANDLER="invoke-newprotocolhandler",i.UNDO_FAILURE="undo-failed",i.REDO_FAILURE="redo-failed",i.FOLLOW_USER_FAILURE="follow-user-failed",i.UNFOLLOW_USER_FAILURE="unfollow-user-failed",i.CHAT_WITH_CONTACT="chat-with-contact",i.CHAT_WITH_CONTACT_FAULT="chat-with-contact-fault",i.CHAT_SELECT_WINDOW="chat-select-window",i.CHAT_SELECT_WINDOW_FAULT="chat-select-window-fault",i.START_OR_JOIN_AUDIO="start-or-join-audio",i.START_OR_JOIN_AUDIO_FAULT="start-or-join-audio-fault",i.INVITE_CONTACT="invite-contact",i.INVITE_CONTACT_FAULT="invite-contact-fault",i.INVITE_CONTACT_BY_EMAIL="invite-contact-by-email",i.INVITE_CONTACT_BY_EMAIL_FAULT="invite-contact-by-email-fault",i.INVITE_NO_CONTACT_BY_EMAIL="invite-no-contact-by-email",i.INVITE_NO_CONTACT_BY_EMAIL_FAULT="invite-no-contact-by-email-fault",i.REMOVE_RECENT_CONTACT="remove-recent-contact",i.REMOVE_RECENT_CONTACT_FAULT="remove-recent-contact-fault",i.INVITE_AVAILABLE_CONTACTS="invite-available-contacts",i.INVITE_AVAILABLE_CONTACTS_FAULT="invite-available-contacts-fault",i.SELECT_PRESENCE_PROVIDER="select-presence-provider",i.SELECT_PRESENCE_PROVIDER_FAULT="select-presence-provider-fault",i.INVITE_SEARCH_CONTACTS="invite-search-contacts",i.INVITE_SEARCH_CONTACTS_FAULT="invite-search-contacts-fault",i.CHANGE_SELF_PRESENCE="change-self-presence",i.CHANGE_SELF_PRESENCE_FAULT="change-self-presence-fault",i.CHANGE_SELF_PRESENCE_STATUS="change-self-presence-status",i.CHANGE_SELF_PRESENCE_STATUS_FAULT="change-self-presence-status-fault",i.SIGN_IN_PRESENCE="sign-in-presence",i.SIGN_IN_PRESENCE_FAULT="sign-in-presence-fault",i.SIGN_OUT_PRESENCE="sign-out-presence",i.SIGN_OUT_PRESENCE_FAULT="sign-out-presence-fault",i.SHARE_SERVER="share-server",i.SHOW_LINK_INVITE_TOAST="show-invitetoast",i.RESPOND_TOAST="respond-invitetoast",i.SHARE_SERVER_FAULT=i.FAULT_PREFIX+"share-server-fault",i.UNSHARE_SERVER="unshare-server",i.UNSHARE_SERVER_FAULT=i.FAULT_PREFIX+"unshare-server-fault",i.BROWSE_SERVER="browse-server",i.BROWSE_SERVER_FAULT=i.FAULT_PREFIX+"browse-server-fault",i.COPY_URL_SERVER="copyurl-server",i.COPY_URL_SERVER_FAULT=i.FAULT_PREFIX+"copyurl-server-fault",i.LIST_SERVERS="list-servers",i.LIST_SERVERS_FAULT=i.FAULT_PREFIX+"list-servers-fault",i.OPEN_SCC_RESOURCE="open-scc-resource",i.OPEN_SCC_RESOURCE_FAULT=i.FAULT_PREFIX+"open-scc-resource-fault",i.OPEN_SCC_CHANGE="open-scc-change",i.OPEN_SCC_CHANGE_FAULT=i.FAULT_PREFIX+"open-scc-change-fault",i.DISCARD_SCC_CHANGE="discard-scc-change",i.DISCARD_SCC_CHANGE_FAULT=i.FAULT_PREFIX+"discard-scc-change-fault",i.DISCARD_ALL_SCC_CHANGES="discard-all-scc-changes",i.DISCARD_ALL_SCC_CHANGES_FAULT=i.FAULT_PREFIX+"discard-all-scc-changes-fault",i.REVERT_SCC_CHANGE="revert-scc-change",i.REVERT_SCC_CHANGE_FAULT=i.FAULT_PREFIX+"revert-scc-change-fault",i.USER_ELEVATION_TOGGLE_COMMAND="elevatetoggle-user",i.USER_ELEVATION_TOGGLE_COMMAND_FAULT=i.USER_ELEVATION_TOGGLE_COMMAND+"-fault",i.CREATE_COMMENT_THREAD="create-comment-thread",i.CREATE_COMMENT_THREAD_FAULT=i.FAULT_PREFIX+"create-comment-thread-fault",i.DELETE_COMMENT_THREAD="delete-comment-thread",i.DELETE_COMMENT_THREAD_FAULT=i.FAULT_PREFIX+"delete-comment-thread-fault",i.REPLY_COMMENT="reply-comment",i.REPLY_COMMENT_FAULT=i.FAULT_PREFIX+"reply-comment-fault",i.EDIT_COMMENT="edit-comment",i.EDIT_COMMENT_FAULT=i.FAULT_PREFIX+"edit-comment-fault",i.DELETE_COMMENT="delete-comment",i.DELETE_COMMENT_FAULT=i.FAULT_PREFIX+"delete-comment-fault",i.SAVE_COMMENT="save-comment",i.SAVE_COMMENT_FAULT=i.FAULT_PREFIX+"save-comment-fault",i.CANCEL_EDIT_COMMENT="cancel-edit-comment",i.CANCEL_EDIT_COMMENT_FAULT=i.FAULT_PREFIX+"cancel-edit-comment-fault",i.DISMISS_SURVEY="dismiss-survey",i.EVALUATED_CLIENT_FOR_EXPERIMENT="evaluated-client-for-experiment",i.TOKEN_EXPIRED="token-expired-presence-fault",i.AUDIO_CONNECT_CALL="audio-connect-call",i.AUDIO_CALL_STARTED_NOTIFICATION="audio-call-started-notification",i.AUDIO_CALL_INFO_NOTIFICATION="audio-call-info-notification",i.AUDIO_CALL_UNEXPECTED_NOTIFICATION="audio-call-unexpected-notification",i.AUDIO_INVALID_SESSION_TRANSITION="audio-invalid-session-transition",i.AUDIO_GET_SELECTED_DEVICES="audio-get-selected-devices",i.AUDIO_GET_PARTICIPANTS="audio-get-participants",i.AUDIO_END_CALL="audio-end-call",i.AUDIO_ENUMERATE_DEVICES="audio-enumerate-devices",i.AUDIO_MUTE="audio-mute",i.AUDIO_UNMUTE="audio-unmute",i.AUDIO_SELECT_DEVICE="audio-select-device",i.INSTALL_RECOVERY="install-recovery",i.INSTALL_RECOVERY_TOAST="install-recovery-toast",i.DELETE_RUNTIME_DEPENDENCIES="delete-runtime-dependencies",i.JOIN_PROMPT_DISPLAYED="join-prompt-displayed",i.CHAT_HANDSHAKE_REQUEST="chat-handshake-request",i.CHAT_HANDSHAKE_RESPONSE="chat-handshake-response",i.CHAT_UNKNOWN_USER_ID="chat-unknown-user-id",i.CHAT_DISABLED_MESSAGE="chat-disabled-message",i.CHAT_COMMAND_INVOKED="chat-command-invoked",i.CHAT_CREATE_WINDOW="chat-create-window",i.CHAT_UPDATE_WINDOW="chat-update-window",i.CHAT_ISCONNECTED_CHANGED="chat-isconnected-changed",i.CHAT_NOTIFY="chat-notify",i.CHAT_FAULT="chat-fault",i.CHAT_OPEN_SESSION="chat-open-session",i.CHAT_OPEN_SESSION_FAULT=i.FAULT_PREFIX+"chat-open-session-fault",i.RESPOND_ANONYMOUS_JOIN_REQUEST="respond-anonymous-join-request",i.AUTH_PROMPTED_SIGNIN="auth-prompted-signin",i.AUTH_SILENT_CHECK="auth-silent-check",i.UPDATE_ANONYMOUS_GUEST_ACCESS_LEVEL="update-anonymous-guest-access-level",i.TRY_LOAD_SESSION="try-load-session",i.COLLABORATE_BLOCK="collaborate-block",i.PIN="pin",i.FOCUS_PARTICIPANT="focus-participant",i.FOCUS_PARTICIPANTS="focus-participants";class s{}t.TelemetryPropertyNames=s,s.FEATURE_NAME="liveshare.",s.FEATURE_NAME_V2=s.FEATURE_NAME+"v2.",s.AGENT_START_AGENT_FOUND=s.FEATURE_NAME+"AgentFound",s.AGENT_SPAWN_START_TIME=s.FEATURE_NAME+"AgentSpawnStartTime",s.AGENT_SPAWN_END_TIME=s.FEATURE_NAME+"AgentSpawnEndTime",s.CORRELATION_ID=s.FEATURE_NAME+"CorrelationId",s.EVENT_RESULT=s.FEATURE_NAME+"Result",s.EVENT_MESSAGE=s.FEATURE_NAME+"Message",s.EVENT_EXCEPTION_STACK=s.FEATURE_NAME+"ExceptionStack",s.EVENT_EXCEPTION_CODE=s.FEATURE_NAME+"ExceptionCode",s.EVENT_DURATION=s.FEATURE_NAME+"Duration",s.IS_DEBUGGING=s.FEATURE_NAME+"IsDebugging",s.IS_VSCODE_ACCOUNT_ENABLED=s.FEATURE_NAME+"IsVSCodeAccountEnabled",s.IS_VSCODE_ACCOUNT_AUTH_SUPPORTED=s.FEATURE_NAME+"IsVSCodeAccountSupported",s.IS_MAC_OSX_CATALINA_OR_NEWER=s.FEATURE_NAME+"IsMacOSxCatalinaOrNewer",s.AUTH_FLOW_INITIALIZATION_COMMAND=s.FEATURE_NAME+"AuthFlowInitializationCommand",s.SILENT_SIGN_IN=s.FEATURE_NAME+"SilentSignIn",s.SIGN_IN_WITH_CODE=s.FEATURE_NAME+"WithCode",s.SIGN_IN_WITH_BROWSER=s.FEATURE_NAME+"BrowserSignIn",s.JOIN_WITH_LINK=s.FEATURE_NAME+"WithLink",s.COMMAND_TEXT=s.FEATURE_NAME+"CommandText",s.JOIN_INVOKE_COMMAND=s.FEATURE_NAME+"CommandText",s.TELEMETRY_EVENT_VERSION=s.FEATURE_NAME+"TelemetryEventVersion",s.SHARE_WORKSPACE_STARTING=s.FEATURE_NAME+"ShareWorkspaceStarting",s.SHARE_WORKSPACE_COMPLETE=s.FEATURE_NAME+"ShareWorkspaceComplete",s.SHARE_WORKSPACE_COUNT_OF_WORKSPACE_FOLDERS=s.FEATURE_NAME+"WorkspaceFolderCount",s.SHARED_AS_PLANNED_SESSION=s.FEATURE_NAME+"SharedAsPlannedSession",s.FIREWALL_CHECK_COMPLETE=s.FEATURE_NAME+"FirewallCheckComplete",s.FIREWALL_CHECK_STARTING=s.FEATURE_NAME+"FirewallCheckStarting",s.GET_WORKSPACE_COMPLETE=s.FEATURE_NAME+"GetWorkspaceComplete",s.INIT_COEDITING_COMPLETE=s.FEATURE_NAME+"InitCoeditingComplete",s.INIT_DEBUGGING_COMPLETE=s.FEATURE_NAME+"InitDebuggingComplete",s.INIT_LSP_COMPLETE=s.FEATURE_NAME+"InitLspComplete",s.INIT_BREAKPOINT_COMPLETE=s.FEATURE_NAME+"InitBreakpointComplete",s.INIT_TASK_COMPLETE=s.FEATURE_NAME+"InitTaskComplete",s.INIT_ACCESS_CONTROL_COMPLETE=s.FEATURE_NAME+"InitAccessControlComplete",s.INIT_TEXT_SEARCH_SERVICE_COMPLETE=s.FEATURE_NAME+"InitTextSearchServiceComplete",s.INIT_GUEST_CHANNEL_SERVICE_COMPLETE=s.FEATURE_NAME+"InitGuestChannelServiceComplete",s.INIT_GUEST_NOTEBOOKS_SERVICE_COMPLETE=s.FEATURE_NAME+"InitGuestNotebooksServiceComplete",s.INIT_SOURCE_CONTROL_SERVICE_COMPLETE=s.FEATURE_NAME+"InitSourceControlServiceComplete",s.INIT_COMMENT_SERVICE_COMPLETE=s.FEATURE_NAME+"InitCommentServiceComplete",s.INIT_SYNC_SERVICE_COMPLETE=s.FEATURE_NAME+"InitSyncServiceComplete",s.INIT_FILE_SERVICE_COMPLETE=s.FEATURE_NAME+"InitFileServiceComplete",s.INIT_HOST_NOTEBOOKS_SERVICE_COMPLETE=s.FEATURE_NAME+"InitHostNotebooksServiceComplete",s.INIT_COMMENT_MANAGER_COMPLETE=s.FEATURE_NAME+"InitCommentManagerComplete",s.INIT_COMMAND_COMPLETE=s.FEATURE_NAME+"InitCommandComplete",s.INIT_PATH_MANAGER_COMPLETE=s.FEATURE_NAME+"InitPathManagerComplete",s.REJECTED_BY_HOST=s.FEATURE_NAME+"RejectedByHost",s.REJECTED_BY_HOST_AS_ANONYMOUS=s.FEATURE_NAME+"RejectedByHostAsAnonymous",s.JOIN_REQUEST_TIMED_OUT=s.FEATURE_NAME+"JoinRequestTimedOut",s.WORKSPACE_NOT_FOUND=s.FEATURE_NAME+"WorkspaceNotFound",s.UNAUTHORIZED=s.FEATURE_NAME+"Unauthorized",s.RELOAD_START_TIME=s.FEATURE_NAME+"ReloadStartTime",s.RELOAD_RESUMED_TIME=s.FEATURE_NAME+"ReloadResumedTime",s.RELOAD_END_TIME=s.FEATURE_NAME+"ReloadEndTime",s.JOIN_WORKSPACE_COMPLETE=s.FEATURE_NAME+"JoinWorkspaceComplete",s.SERVICE_ENDPOINT=s.FEATURE_NAME+"ServiceEndpoint",s.IS_HOST=s.FEATURE_NAME+"IsHost",s.IS_READONLY_SESSION=s.FEATURE_NAME+"IsReadOnlySession",s.CREATE_WORKSPACE=s.FEATURE_NAME+"CreateWorkspace",s.CREATE_PLANNED_SESSION=s.FEATURE_NAME+"CreatePlannedSession",s.DELETE_PLANNED_SESSION=s.FEATURE_NAME+"DeletePlannedSession",s.RENAME_PLANNED_SESSION=s.FEATURE_NAME+"RenamePlannedSession",s.LIST_PLANNED_SESSION=s.FEATURE_NAME+"ListPlannedSession",s.COPY_PLANNED_SESSION_LINK=s.FEATURE_NAME+"CopyPlannedSessionLink",s.JOIN_PLANNED_SESSION=s.FEATURE_NAME+"JoinPlannedSession",s.PERSISTENT_WORKSPACE_EXISTS=s.FEATURE_NAME+"PersistentWorkspaceExists",s.SHARE_FROM_CREATE_WORKSPACE=s.FEATURE_NAME+"ShareFromCreateWorkspace",s.COPYLINK_FROM_CREATE_WORKSPACE=s.FEATURE_NAME+"CopyLinkFromCreateWorkspace",s.MOREINFO_FROM_CREATE_WORKSPACE=s.FEATURE_NAME+"MoreInfoFromCreateWorkspace",s.CONVERSATION_ID=s.FEATURE_NAME_V2+"ConversationId",s.VERSION_PLATFORMNAME=s.FEATURE_NAME+"Version.PlatformName",s.VERSION_PLATFORMVERSION=s.FEATURE_NAME+"Version.PlatformVersion",s.VERSION_PLATFORMVERSION_SERVICEPACK=s.FEATURE_NAME+"Version.PlatformVersion.ServicePack",s.FAULT_TYPE=s.FEATURE_NAME+"FaultType",s.ENVIRONMENT_VECTOR=s.FEATURE_NAME+"EnvironmentVector",s.PERFORMANCE_RUN=s.FEATURE_NAME+"PerformanceRun",s.CURRENT_STATE=s.FEATURE_NAME+"CurrentState",s.NEXT_STATE=s.FEATURE_NAME+"NextState",s.TRANSITION_ACTION=s.FEATURE_NAME+"TransitionAction",s.EXTENSION_ACTIVATION_INITIAL_INIT_COMPLETE=s.FEATURE_NAME+"ExtensionActivationInitialInitComplete",s.EXTENSION_ACTIVATION_COMPAT_CHECK_COMPLETE=s.FEATURE_NAME+"ExtensionActivationCompatCheckComplete",s.EXTENSION_ACTIVATION_LAUNCHER_SETUP_COMPLETE=s.FEATURE_NAME+"ExtensionActivationLauncherSetupComplete",s.EXTENSION_ACTIVATION_AGENT_PROCESS_SETUP_COMPLETE=s.FEATURE_NAME+"ExtensionActivationAgentProcessSetupComplete",s.EXTENSION_ACTIVATION_POST_JOIN=s.FEATURE_NAME+"ActivatedPostJoin",s.JOIN_FROM_BROWSER=s.FEATURE_NAME+"JoinFromBrowser",s.JOIN_DEBUG_SESSION_OPTION=s.FEATURE_NAME+"JoinDebugSessionOption",s.IS_FIRST_ACTIVATION=s.FEATURE_NAME+"IsFirstActivation",s.IS_FIRST_EXTENSION_RUN=s.FEATURE_NAME+"IsFirstExtensionRun",s.IS_ELECTRON_DEPENDENCY_SHOULD_BE_INSTALLED=s.FEATURE_NAME+"IsElectronDependencyShouldBeInstalled",s.IS_ELECTRON_DEPENDENCY_INSTALLED=s.FEATURE_NAME+"IsElectronDependencyInstalled",s.IS_RUNTIME_DEPENDENCIES_INSTALLED=s.FEATURE_NAME+"IsRuntimeDependenciesInstalled",s.IS_EXTENSION_BEING_UPDATED=s.FEATURE_NAME+"isExtensionBeingUpdated",s.IS_EXTENSION_PACK_CANDIDATE_PRESENT=s.FEATURE_NAME+"isExtensionPackCandidatePresent",s.SHOWED_INITIAL_INSTALL_INFO_PAGE=s.FEATURE_NAME+"ShowedInitialInstallInfoPage",s.INITIAL_INSTALL_INFO_PAGE_EXPERIMENT_OPEN_BY_DEFAULT=s.FEATURE_NAME+"InitialInstallInfoPageExperimentOpenByDefault",s.NAME_TAG_VISIBILITY=s.FEATURE_NAME+"NameTagVisibility",s.NUM_DEBUGGING_PROCESSES=s.FEATURE_NAME+"NumDebuggingProcesses",s.DEBUG_PROMPT=s.FEATURE_NAME+"DebugPrompt",s.NUM_OPEN_FILES=s.FEATURE_NAME+"NumOpenFiles",s.IS_INTERNAL=s.FEATURE_NAME+"IsInternal",s.IS_CLOUD_ENVIRONMENT=s.FEATURE_NAME+"IsCloudEnvironment",s.USER_TEAM_STATUS=s.FEATURE_NAME+"UserTeamStatus",s.CONNECTION_MODE=s.FEATURE_NAME+"ConnectionMode",s.CONNECTION_MODE_USED=s.FEATURE_NAME+"ConnectionModeUsed",s.CREATED_AT=s.FEATURE_NAME+"CreatedAt",s.UPDATED_AT=s.FEATURE_NAME+"UpdatedAt",s.EXPIRES_AT=s.FEATURE_NAME+"ExpiresAt",s.PROGRESS_DURATION=s.FEATURE_NAME+"ProgressDuration",s.AGENT_START_INITAL_DATA=s.FEATURE_NAME+"InitialData",s.AGENT_START_RESOLVED_STATE=s.FEATURE_NAME+"ResolvedState",s.AGENT_START_PROCESS_SPAWN_COMMAND_SENT=s.FEATURE_NAME+"ProcessSpawnCommandSent",s.AGENT_START_CONNECTION_RETRY_COUNT=s.FEATURE_NAME+"RetryCount",s.AGENT_START_CONNECTION_URI_PROTOCOL=s.FEATURE_NAME+"UriProtocol",s.AGENT_START_CONNECTION_OWNER=s.FEATURE_NAME+"Owner",s.AGENT_WAS_DOWNLOAD_CORRUPTED=s.FEATURE_NAME+"WasDownloadCorrupted",s.CLIENT_LOG_LINES=s.FEATURE_NAME+"ClientLogLines",s.AGENT_LOG_LINES=s.FEATURE_NAME+"AgentLogLines",s.FEATURE_FLAGS=s.FEATURE_NAME+"FeatureFlags",s.EXTENSION_REQUESTED_API_VERSION=s.FEATURE_NAME+"ExtensionRequestedApiVersion",s.EXTENSION_NAME=s.FEATURE_NAME+"ExtensionName",s.EXTENSION_VERSION=s.FEATURE_NAME+"ExtensionVersion",s.EXTENSION_INVOKED_COMMAND=s.FEATURE_NAME+"ExtensionInvokedCommand",s.EXTENSION_INVOKED_COMMAND_OPTIONS=s.FEATURE_NAME+"ExtensionInvokedCommandOptions",s.EXTENSION_SERVICE_NAME=s.FEATURE_NAME+"ExtensionServiceName",s.EXTENSION_SERVICE_PERMITTED=s.FEATURE_NAME+"ExtensionServicePermitted",s.START_WAITING_FOR_HOST=s.FEATURE_NAME+"StartWaitingForHost",s.DONE_WAITING_FOR_HOST=s.FEATURE_NAME+"DoneWaitingForHost",s.RECONNECTING_TO_HOST=s.FEATURE_NAME+"ReconnectingToHost",s.RECONNECTED_TO_HOST=s.FEATURE_NAME+"ReconnectedToHost",s.GUEST_CANCELED=s.FEATURE_NAME+"GuestCanceled",s.TRANSITION_SEQUENCE=s.FEATURE_NAME+"TransitionSequence",s.TIME_SINCE_LAST_TRANSITION=s.FEATURE_NAME+"TimeSinceLastTransition",s.GUESTS_BY_IDE=s.FEATURE_NAME+"GuestsByIDE",s.DISTINCT_GUESTS_BY_IDE=s.FEATURE_NAME+"DistinctGuestsByIDE",s.ACTIVE_COLLABORATION_DURATION=s.FEATURE_NAME+"ActiveCollaborationDuration",s.ACTIVE_COLLABORATION_BLOCKS=s.FEATURE_NAME+"ActiveCollaborationBlocks",s.FILE_NAME=s.FEATURE_NAME+"FileName",s.RELOAD_POST_TIMEOUT=s.FEATURE_NAME+"ReloadPostTimeout",s.SHARED_TERMINAL_SHELL=s.FEATURE_NAME+"SharedTerminalShell",s.SHARED_TERMINAL_READONLY=s.FEATURE_NAME+"SharedTerminalReadOnly",s.IS_ALTERNATE_SHARE_BUTTON_TEXT=s.FEATURE_NAME+"AlternateShareButtonText",s.COMMAND_AUTH_RETRY_COUNT=s.FEATURE_NAME+"CommandAuthRetryCount",s.COMMAND_DID_AUTH=s.FEATURE_NAME+"CommandDidAuth",s.COMMAND_ALLOWS_ANONYMOUS=s.FEATURE_NAME+"COMMAND_ALLOWS_ANONYMOUS",s.COMMAND_SHOULED_SKIP_ANONYMOUS_PROMPT=s.FEATURE_NAME+"CommandShouldSkipAnonymousPrompt",s.COMMAND_DID_AUTH_FULL=s.FEATURE_NAME+"CommandDidAuthFull",s.COMMAND_AUTO_AUTHED_ANONYMOUSLY_BUT_ANONYMOUS_NOT_ALLOWED=s.FEATURE_NAME+"CommandAutoAuthedAnonymouslyButAnonymousNotAllowed",s.COMMAND_AUTO_AUTHED_RESULT=s.FEATURE_NAME+"CommandAutoAuthedResult",s.COMMAND_STARTED_UNAUTHENTICATED=s.FEATURE_NAME+"CommandStartedUnauthenticated",s.COMMAND_SHOULD_SHOW_ANONYMOUS_TOAST=s.FEATURE_NAME+"CommandShouldShowAnonymousToast",s.COMMAND_STARTED_BLOCKING_AUTH=s.FEATURE_NAME+"CommandStartedBlockingAuth",s.COMMAND_BLOCKING_ANONYMOUS_LOGIN_FLOW_RESULT=s.FEATURE_NAME+"CommandBlockingAnonymousLoginFlowResult",s.COMMAND_BLOCKING_NON_ANONYMOUS_LOGIN_FLOW_RESULT=s.FEATURE_NAME+"CommandBlockingNonAnonymousLoginFlowResult",s.COMMAND_AUTH_PROMPT_QUESTION_RESULT=s.FEATURE_NAME+"CommandAuthPromptQuestionResult",s.COMMAND_AUTH_PROMPT_OPENED=s.FEATURE_NAME+"CommandAuthPromptOpened",s.USER_OPTED_OUT_TO_AUTH_ON_JOIN=s.FEATURE_NAME+"UserOptedOutToAuthOnJoin",s.USER_PICKED_NAME_LENGTH=s.FEATURE_NAME+"UserPickedNameLength",s.USER_PICKED_DEFAULT_NAME=s.FEATURE_NAME+"UserPickedDefaultName",s.COMMAND_COMPLETED_AUTH_FULL=s.FEATURE_NAME+"CommandCompleteAuthFull",s.MORE_INFO_CLICKED=s.FEATURE_NAME+"MoreInfoClicked",s.ZEROUSER_SESSION_REASON=s.FEATURE_NAME+"ZeroUserSessionReason",s.DEBUGGING_STARTED_WORKSPACE_FOLDER=s.FEATURE_NAME+"DebuggingStartedForWorkspaceFolder",s.DEBUGGING_STARTED_WORKSPACE_FOLDER_COUNT=s.FEATURE_NAME+"DebuggingWorkspaceFolderCount",s.OPERATION_NAME=s.FEATURE_NAME+"OperationName",s.OPERATION_ACCESS=s.FEATURE_NAME+"OperationAccess",s.REJECTION_REASON=s.FEATURE_NAME+"RejectionReason",s.SETTING_VALUES=s.FEATURE_NAME+"Settings",s.USER_DISMISSED_SIGN_IN_MODAL=s.FEATURE_NAME+"UserDismissedSignInModal",s.SIGN_IN_MODAL_URL_CHANGES=s.FEATURE_NAME+"SignInModalURLChanges",s.SESSION_ID=s.FEATURE_NAME+"LiveShareSessionId",s.RELOAD_SELECTED=s.FEATURE_NAME+"UserSelectedReload",s.INIT_SEARCHPROVIDER_COMPLETE=s.FEATURE_NAME+"InitSearchProviderComplete",s.ADD_ADDITIONALROOTS_COMPLETE=s.FEATURE_NAME+"AddAdditionalRootsComplete",s.JOIN_WITHOUT_RELOAD=s.FEATURE_NAME+"JoinWithoutReload",s.JOIN_FROM_PROTOCOL_HANDLER=s.FEATURE_NAME+"JoinFromProtocolHandler",s.JOIN_FROM_INVITE_LINK=s.FEATURE_NAME+"JoinFromInviteLink",s.URI=s.FEATURE_NAME+"Uri",s.JOIN_CORRELATION_ID=s.FEATURE_NAME+"JoinCorrelationId",s.SIGN_IN_RETRIES=s.FEATURE_NAME+"SignInRetries",s.EMPTY_WORKSPACE_FOLDERS_OPENED=s.FEATURE_NAME+"EmptyWorkspaceFoldersOpened",s.AUTO_SHARING_ON_LOAD=s.FEATURE_NAME+"AutoSharingOnLoad",s.STATE_EVENT_FIRST=s.FEATURE_NAME+"StateEventFirst",s.STATE_EVENT_LAST=s.FEATURE_NAME+"StateEventLast",s.STATE_EVENT_ORDER=s.FEATURE_NAME+"StateEventOrder",s.STATUS_EVENT_ORDER=s.FEATURE_NAME+"StatusEventOrder",s.EXTERNAL_SIGNIN_STARTING=s.FEATURE_NAME+"ExternalSignInStarting",s.EXTERNAL_SIGNIN_USER_MADE_VENDOR_CHOICE=s.FEATURE_NAME+"ExternalSignInUserMadeVendorChoice",s.EXTERNAL_SIGNIN_USER_COMPLETE_FLOW=s.FEATURE_NAME+"ExternalSignInUserCompleteFlow",s.EXTERNAL_SIGNIN_USER_COMPLETE_FLOW_TOKEN_SET=s.FEATURE_NAME+"ExternalSignInUserCompleteFlowTokenSet",s.BROWSER_NAME=s.FEATURE_NAME+"BrowserName",s.BROWSER_VERSION=s.FEATURE_NAME+"BrowserVersion",s.EXTERNAL_SIGNIN_SELECTED_VENDOR=s.FEATURE_NAME+"ExternalSignInSelectedVendor",s.EXTERNAL_SIGNIN_COMPLETE=s.FEATURE_NAME+"ExternalSignInComplete",s.ATTEMPT_DEFAULT_LOGIN_STARTING=s.FEATURE_NAME+"AttemptDefaultLoginStarting",s.ATTEMPT_DEFAULT_LOGIN_COMPLETE=s.FEATURE_NAME+"AttemptDefaultLoginComplete",s.ATTEMPT_LOGIN_STARTING=s.FEATURE_NAME+"AttemptLoginStarting",s.ATTEMPT_LOGIN_COMPLETE=s.FEATURE_NAME+"AttemptLoginComplete",s.ATTEMPT_ANONYMOUS_LOGIN_STARTING=s.FEATURE_NAME+"AttemptAnonymousLoginStarting",s.ATTEMPT_ANONYMOUS_LOGIN_COMPLETE=s.FEATURE_NAME+"AttemptAnonymousLoginComplete",s.SILENT_NATIVE_LOGIN_STARTING=s.FEATURE_NAME+"SilentNativeLoginStarting",s.SILENT_NATIVE_LOGIN_RESULT=s.FEATURE_NAME+"SilentNativeLoginResult",s.SILENT_NATIVE_LOGIN_SIGNED_IN_WITH_NATIVE_PROVIDER=s.FEATURE_NAME+"SilentNativeLoginSignedInWithNativeProvider",s.SILENT_NATIVE_LOGIN_AUTH_PROVIDER=s.FEATURE_NAME+"SilentNativeLoginAuthProvider",s.SILENT_NATIVE_LOGIN_SIGNED_IN_AS_ANONYMOUS=s.FEATURE_NAME+"SilentNativeLoginSignedInAsAnonymous",s.SILENT_NATIVE_LOGIN_ATTEMPTING_ANONYMOUS_STRATEGY=s.FEATURE_NAME+"SilentNativeLoginAttemptingAnonymousStrategy",s.SILENT_NATIVE_LOGIN_IS_ANONYMOUS_TOKEN_SET=s.FEATURE_NAME+"SilentNativeLoginIsAnonymousTokenSet",s.PROMPTED_NATIVE_LOGIN_STARTING=s.FEATURE_NAME+"PromptedNativeLoginStarting",s.PROMPTED_NATIVE_LOGIN_RESULT=s.FEATURE_NAME+"PromptedNativeLoginResult",s.PROMPTED_NATIVE_LOGIN_THE_USER_CANCELED_AUTH_PROVIDER_PICK=s.FEATURE_NAME+"PromptedNativeLoginTheUserCanceledAuthProviderPick",s.PROMPTED_NATIVE_LOGIN_CANCELED_VIA_CANCELLATION_TOKEN=s.FEATURE_NAME+"PromptedNativeLoginCancelledViaCancellationToken",s.PROMPTED_NATIVE_LOGIN_SELECTED_AUTH_PROVIDER=s.FEATURE_NAME+"PromptedNativeLoginSelectedAuthProvider",s.PROMPTED_NATIVE_LOGIN_FAILED_TO_ACQUIRE_AUTH_TOKEN=s.FEATURE_NAME+"PromptedNativeLoginFailedToAcquireAuthToken",s.LOGIN_IS_NATIVE=s.FEATURE_NAME+"IsNative",s.LOGIN_RESULT=s.FEATURE_NAME+"Result",s.LOGIN_IS_CANCELED=s.FEATURE_NAME+"AuthCanceled",s.TRY_LOAD_SESSION_RESULT=s.FEATURE_NAME+"Result",s.VSCODE_ERROR_CALL_STACK=s.FEATURE_NAME+"VscodeErrorCallStack",s.SIGNIN_STARTING=s.FEATURE_NAME+"SigninStarting",s.SIGNIN_PROMPT_STARTING=s.FEATURE_NAME+"SigninPromptStarting",s.SIGNIN_PROMPT_COMPLETED=s.FEATURE_NAME+"SigninPromptCompleted",s.SIGNIN_COMPLETED=s.FEATURE_NAME+"SigninCompleted",s.SIGNIN_COMPLETED_ERROR=s.FEATURE_NAME+"SigninCompletedError",s.SIGNIN_COMPLETED_CANCEL=s.FEATURE_NAME+"SigninCompletedCancel",s.SIGNIN_CHECK_STARTING=s.FEATURE_NAME+"SigninCheckStarting",s.SIGNIN_CHECK_COMPLETED=s.FEATURE_NAME+"SigninCheckCompleted",s.SIGNIN_CHECK_COMPLETED_ERROR=s.FEATURE_NAME+"SigninCheckCompletedError",s.SIGNIN_CHECK_COMPLETED_CANCEL=s.FEATURE_NAME+"SigninCheckCompletedCancel",s.WELCOME_PAGE_LINK=s.FEATURE_NAME+"WelcomePageLink",s.SHARE_INIT_WORKSPACE_FOLDERS_COUNT=s.FEATURE_NAME+"ShareInitWorkspaceFoldersCount",s.CURRENT_AB_EXPERIMENT=s.FEATURE_NAME+"CurrentAbExperiment",s.CURRENT_AB_TESTER_VERSION=s.FEATURE_NAME+"CurrentAbTesterVersion",s.CURRENT_AB_EXPERIMENT_GROUP=s.FEATURE_NAME+"CurrentAbExperimentGroup",s.COUNT_OF_CONCURRENT_AB_EXPERIMENTS=s.FEATURE_NAME+"CountOfConcurrentAbExperiments",s.FIRST_LIVESHARE_ACTIVATION=s.FEATURE_NAME+"FirstLiveShareActivation",s.SELECTED_FOR_ELECTRON_AUTH_MODAL_EXPERIMENT=s.FEATURE_NAME+"SelectedForElectronAuthModalExperiment",s.AUTH_ELECTRON_MODAL_USED=s.FEATURE_NAME+"AuthElectronModalUsed",s.AUTH_ELECTRON_MODAL_EXCEPTION=s.FEATURE_NAME+"AuthElectronModalException",s.RECOVER_ROOT_FOLDER=s.FEATURE_NAME+"RecoverRootFolder",s.SAMPLE_RATE=s.FEATURE_NAME+"SampleRate",s.DEFAULT_SIGN_IN=s.FEATURE_NAME+"DefaultSignIn",s.EVALUATED_EXPERIMENT_NAME=s.FEATURE_NAME+"evaluated-experiment-name",s.EVALUATED_EXPERIMENT_GROUP=s.FEATURE_NAME+"evaluated-experiment-group",s.INVITE_CONTACT_TYPE=s.FEATURE_NAME+"InviteContactType",s.TOAST_RESULT=s.FEATURE_NAME+"ToastResult",s.TOKEN_EXPIRED_DAYS=s.FEATURE_NAME+"TokenExpiredDays",s.WAIT_FOR_HOST_PROMPT=s.FEATURE_NAME+"WaitForHostPrompt",s.RETRY_JOIN=s.FEATURE_NAME+"RetryJoin",s.AUTH_CANCEL_WAIT_FOR_CODE=s.FEATURE_NAME+"AuthCancelWaitingForExternalCode",s.AUTH_CANCEL_BROWSER_CANCEL=s.FEATURE_NAME+"AuthCancelBrowserOperationCancelled",s.AUTH_CANCEL_NO_TOKEN_USER_CANCELLED=s.FEATURE_NAME+"AuthCancelNoTokenOrUserCancelled",s.AUTH_CANCEL_NO_ANON_AUTH=s.FEATURE_NAME+"AuthCancelNoAnonAuth",s.AUTH_CANCEL_ANONYMOUS_LOGIN_FLOW=s.FEATURE_NAME+"AuthCancelAnonymousLoginFlow",s.CREATE_INVITATION_LINK=s.FEATURE_NAME+"CreateInvitationLink",s.INSTALL_RECOVERY_SOURCE=s.FEATURE_NAME+"install-recovery-source",s.INSTALL_RECOVERY_TOAST_RESULT=s.FEATURE_NAME+"install-recovery-toast-result",s.INSTALL_RECOVERY_RELOAD=s.FEATURE_NAME+"install-recovery-reload",s.INSTALL_RECOVERY_CANCELED=s.FEATURE_NAME+"install-recovery-canceled",s.INSTALL_RECOVERY_RETRY=s.FEATURE_NAME+"install-recovery-retry",s.INSTALL_RECOVERY_RETRY_CANCELED=s.FEATURE_NAME+"install-recovery-retry-canceled",s.INSTALL_RECOVERY_DISABLED=s.FEATURE_NAME+"install-recovery-disabled",s.DELETE_DEPENDENCIES_DOWNLOAD_FILE=s.FEATURE_NAME+"delete-dependencies-download-file",s.DELETE_DEPENDENCIES_INSTALLED_FILE=s.FEATURE_NAME+"reinstall-dependencies-installed-file",s.DELETE_DEPENDENCIES_CLEAN_INSTALL_PATH=s.FEATURE_NAME+"reinstall-dependencies-clean-install-path",s.SELECTED_ACTION=s.FEATURE_NAME+"SelectedAction",s.AUDIO_DEVICE_TYPE=s.FEATURE_NAME+"AudioDeviceType",s.AUDIO_SESSION_STATE=s.FEATURE_NAME+"AudioSessionState",s.AUDIO_SESSION_ACTION=s.FEATURE_NAME+"AudioSessionAction",s.CHAT_IS_DIRECT_MESSAGE=s.FEATURE_NAME+"ChatIsDirectMessage",s.CHAT_DISABLED_MESSAGE_KEY=s.FEATURE_NAME+"ChatDisabledMessageKey",s.CHAT_NOTIFY_TYPE=s.FEATURE_NAME+"ChatNotifyType",s.CHAT_COMMAND=s.FEATURE_NAME+"ChatCommand",s.CHAT_ISDISABLED=s.FEATURE_NAME+"ChatIsDisabled",s.CHAT_ISCONNECTED=s.FEATURE_NAME+"ChatIsConnected",s.PLANNED_SESSIONS_LIST_SIZE=s.FEATURE_NAME+"PlannedSessionsListSize",s.ACCEPTED=s.FEATURE_NAME+"Accepted",s.READONLY=s.FEATURE_NAME+"Readonly",s.IS_ANONYMOUS_ELEVATED=s.FEATURE_NAME+"IsAnonymousElevated",function(e){e[e.StatusBar=0]="StatusBar",e[e.Command=1]="Command"}(t.TelemetryEventOrigin||(t.TelemetryEventOrigin={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"AbortError",(function(){return a})),n.d(t,"HttpError",(function(){return r})),n.d(t,"TimeoutError",(function(){return o})),n.d(t,"HttpClient",(function(){return u})),n.d(t,"HttpResponse",(function(){return l})),n.d(t,"DefaultHttpClient",(function(){return w})),n.d(t,"HubConnection",(function(){return P})),n.d(t,"HubConnectionState",(function(){return C})),n.d(t,"HubConnectionBuilder",(function(){return ie})),n.d(t,"MessageType",(function(){return v})),n.d(t,"LogLevel",(function(){return d.a})),n.d(t,"HttpTransportType",(function(){return k})),n.d(t,"TransferFormat",(function(){return R})),n.d(t,"NullLogger",(function(){return Z.a})),n.d(t,"JsonHubProtocol",(function(){return ee})),n.d(t,"Subject",(function(){return T})),n.d(t,"VERSION",(function(){return h.e}));var i,s=(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=function(e){function t(t,n){var i=this,s=this.constructor.prototype;return(i=e.call(this,t)||this).statusCode=n,i.__proto__=s,i}return s(t,e),t}(Error),o=function(e){function t(t){void 0===t&&(t="A timeout occurred.");var n=this,i=this.constructor.prototype;return(n=e.call(this,t)||this).__proto__=i,n}return s(t,e),t}(Error),a=function(e){function t(t){void 0===t&&(t="An abort occurred.");var n=this,i=this.constructor.prototype;return(n=e.call(this,t)||this).__proto__=i,n}return s(t,e),t}(Error),c=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},l=function(e,t,n){this.statusCode=e,this.statusText=t,this.content=n},u=function(){function e(){}return e.prototype.get=function(e,t){return this.send(c({},t,{method:"GET",url:e}))},e.prototype.post=function(e,t){return this.send(c({},t,{method:"POST",url:e}))},e.prototype.delete=function(e,t){return this.send(c({},t,{method:"DELETE",url:e}))},e.prototype.getCookieString=function(e){return""},e}(),d=n(2),h=n(10),f=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),p=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},m=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){e.done?s(e.value):new n((function(t){t(e.value)})).then(o,a)}c((i=i.apply(e,t||[])).next())}))},g=function(e,t){var n,i,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,i=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],i=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},y=function(e){function t(t){var n=e.call(this)||this;if(n.logger=t,"undefined"==typeof fetch){var i=require;n.jar=new(i("tough-cookie").CookieJar),n.fetchType=i("node-fetch"),n.fetchType=i("fetch-cookie")(n.fetchType,n.jar),n.abortControllerType=i("abort-controller")}else n.fetchType=fetch.bind(self),n.abortControllerType=AbortController;return n}return f(t,e),t.prototype.send=function(e){return m(this,void 0,void 0,(function(){var t,n,i,s,c,u,h,f=this;return g(this,(function(m){switch(m.label){case 0:if(e.abortSignal&&e.abortSignal.aborted)throw new a;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");t=new this.abortControllerType,e.abortSignal&&(e.abortSignal.onabort=function(){t.abort(),n=new a}),i=null,e.timeout&&(s=e.timeout,i=setTimeout((function(){t.abort(),f.logger.log(d.a.Warning,"Timeout from HTTP request."),n=new o}),s)),m.label=1;case 1:return m.trys.push([1,3,4,5]),[4,this.fetchType(e.url,{body:e.content,cache:"no-cache",credentials:!0===e.withCredentials?"include":"same-origin",headers:p({"Content-Type":"text/plain;charset=UTF-8","X-Requested-With":"XMLHttpRequest"},e.headers),method:e.method,mode:"cors",redirect:"manual",signal:t.signal})];case 2:return c=m.sent(),[3,5];case 3:if(u=m.sent(),n)throw n;throw this.logger.log(d.a.Warning,"Error from HTTP request. "+u+"."),u;case 4:return i&&clearTimeout(i),e.abortSignal&&(e.abortSignal.onabort=null),[7];case 5:if(!c.ok)throw new r(c.statusText,c.status);return[4,function(e,t){var n;switch(t){case"arraybuffer":n=e.arrayBuffer();break;case"text":n=e.text();break;case"blob":case"document":case"json":throw new Error(t+" is not supported.");default:n=e.text()}return n}(c,e.responseType)];case 6:return h=m.sent(),[2,new l(c.status,c.statusText,h)]}}))}))},t.prototype.getCookieString=function(e){var t="";return h.c.isNode&&this.jar&&this.jar.getCookies(e,(function(e,n){return t=n.join("; ")})),t},t}(u);var v,S=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),_=function(e){function t(t){var n=e.call(this)||this;return n.logger=t,n}return S(t,e),t.prototype.send=function(e){var t=this;return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new a):e.method?e.url?new Promise((function(n,i){var s=new XMLHttpRequest;s.open(e.method,e.url,!0),s.withCredentials=void 0===e.withCredentials||e.withCredentials,s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("Content-Type","text/plain;charset=UTF-8");var c=e.headers;c&&Object.keys(c).forEach((function(e){s.setRequestHeader(e,c[e])})),e.responseType&&(s.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=function(){s.abort(),i(new a)}),e.timeout&&(s.timeout=e.timeout),s.onload=function(){e.abortSignal&&(e.abortSignal.onabort=null),s.status>=200&&s.status<300?n(new l(s.status,s.statusText,s.response||s.responseText)):i(new r(s.statusText,s.status))},s.onerror=function(){t.logger.log(d.a.Warning,"Error from HTTP request. "+s.status+": "+s.statusText+"."),i(new r(s.statusText,s.status))},s.ontimeout=function(){t.logger.log(d.a.Warning,"Timeout from HTTP request."),i(new o)},s.send(e.content||"")})):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t}(u),E=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),w=function(e){function t(t){var n=e.call(this)||this;if("undefined"!=typeof fetch||h.c.isNode)n.httpClient=new y(t);else{if("undefined"==typeof XMLHttpRequest)throw new Error("No usable HttpClient found.");n.httpClient=new _(t)}return n}return E(t,e),t.prototype.send=function(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new a):e.method?e.url?this.httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t.prototype.getCookieString=function(e){return this.httpClient.getCookieString(e)},t}(u),b=n(701);!function(e){e[e.Invocation=1]="Invocation",e[e.StreamItem=2]="StreamItem",e[e.Completion=3]="Completion",e[e.StreamInvocation=4]="StreamInvocation",e[e.CancelInvocation=5]="CancelInvocation",e[e.Ping=6]="Ping",e[e.Close=7]="Close"}(v||(v={}));var C,T=function(){function e(){this.observers=[]}return e.prototype.next=function(e){for(var t=0,n=this.observers;t<n.length;t++){n[t].next(e)}},e.prototype.error=function(e){for(var t=0,n=this.observers;t<n.length;t++){var i=n[t];i.error&&i.error(e)}},e.prototype.complete=function(){for(var e=0,t=this.observers;e<t.length;e++){var n=t[e];n.complete&&n.complete()}},e.prototype.subscribe=function(e){return this.observers.push(e),new h.d(this,e)},e}(),M=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){e.done?s(e.value):new n((function(t){t(e.value)})).then(o,a)}c((i=i.apply(e,t||[])).next())}))},A=function(e,t){var n,i,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,i=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],i=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};!function(e){e.Disconnected="Disconnected",e.Connecting="Connecting",e.Connected="Connected",e.Disconnecting="Disconnecting",e.Reconnecting="Reconnecting"}(C||(C={}));var k,R,P=function(){function e(e,t,n,i){var s=this;this.nextKeepAlive=0,h.a.isRequired(e,"connection"),h.a.isRequired(t,"logger"),h.a.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this.logger=t,this.protocol=n,this.connection=e,this.reconnectPolicy=i,this.handshakeProtocol=new b.a,this.connection.onreceive=function(e){return s.processIncomingData(e)},this.connection.onclose=function(e){return s.connectionClosed(e)},this.callbacks={},this.methods={},this.closedCallbacks=[],this.reconnectingCallbacks=[],this.reconnectedCallbacks=[],this.invocationId=0,this.receivedHandshakeResponse=!1,this.connectionState=C.Disconnected,this.connectionStarted=!1,this.cachedPingMessage=this.protocol.writeMessage({type:v.Ping})}return e.create=function(t,n,i,s){return new e(t,n,i,s)},Object.defineProperty(e.prototype,"state",{get:function(){return this.connectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connectionId",{get:function(){return this.connection&&this.connection.connectionId||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseUrl",{get:function(){return this.connection.baseUrl||""},set:function(e){if(this.connectionState!==C.Disconnected&&this.connectionState!==C.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e},enumerable:!0,configurable:!0}),e.prototype.start=function(){return this.startPromise=this.startWithStateTransitions(),this.startPromise},e.prototype.startWithStateTransitions=function(){return M(this,void 0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:if(this.connectionState!==C.Disconnected)return[2,Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."))];this.connectionState=C.Connecting,this.logger.log(d.a.Debug,"Starting HubConnection."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.startInternal()];case 2:return t.sent(),this.connectionState=C.Connected,this.connectionStarted=!0,this.logger.log(d.a.Debug,"HubConnection connected successfully."),[3,4];case 3:return e=t.sent(),this.connectionState=C.Disconnected,this.logger.log(d.a.Debug,"HubConnection failed to start successfully because of error '"+e+"'."),[2,Promise.reject(e)];case 4:return[2]}}))}))},e.prototype.startInternal=function(){return M(this,void 0,void 0,(function(){var e,t,n,i=this;return A(this,(function(s){switch(s.label){case 0:return this.stopDuringStartError=void 0,this.receivedHandshakeResponse=!1,e=new Promise((function(e,t){i.handshakeResolver=e,i.handshakeRejecter=t})),[4,this.connection.start(this.protocol.transferFormat)];case 1:s.sent(),s.label=2;case 2:return s.trys.push([2,5,,7]),t={protocol:this.protocol.name,version:this.protocol.version},this.logger.log(d.a.Debug,"Sending handshake request."),[4,this.sendMessage(this.handshakeProtocol.writeHandshakeRequest(t))];case 3:return s.sent(),this.logger.log(d.a.Information,"Using HubProtocol '"+this.protocol.name+"'."),this.cleanupTimeout(),this.resetTimeoutPeriod(),this.resetKeepAliveInterval(),[4,e];case 4:if(s.sent(),this.stopDuringStartError)throw this.stopDuringStartError;return[3,7];case 5:return n=s.sent(),this.logger.log(d.a.Debug,"Hub handshake failed with error '"+n+"' during start(). Stopping HubConnection."),this.cleanupTimeout(),this.cleanupPingTimer(),[4,this.connection.stop(n)];case 6:throw s.sent(),n;case 7:return[2]}}))}))},e.prototype.stop=function(){return M(this,void 0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:return e=this.startPromise,this.stopPromise=this.stopInternal(),[4,this.stopPromise];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,4,,5]),[4,e];case 3:return t.sent(),[3,5];case 4:return t.sent(),[3,5];case 5:return[2]}}))}))},e.prototype.stopInternal=function(e){return this.connectionState===C.Disconnected?(this.logger.log(d.a.Debug,"Call to HubConnection.stop("+e+") ignored because it is already in the disconnected state."),Promise.resolve()):this.connectionState===C.Disconnecting?(this.logger.log(d.a.Debug,"Call to HttpConnection.stop("+e+") ignored because the connection is already in the disconnecting state."),this.stopPromise):(this.connectionState=C.Disconnecting,this.logger.log(d.a.Debug,"Stopping HubConnection."),this.reconnectDelayHandle?(this.logger.log(d.a.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this.reconnectDelayHandle),this.reconnectDelayHandle=void 0,this.completeClose(),Promise.resolve()):(this.cleanupTimeout(),this.cleanupPingTimer(),this.stopDuringStartError=e||new Error("The connection was stopped before the hub handshake could complete."),this.connection.stop(e)))},e.prototype.stream=function(e){for(var t=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var s,r=this.replaceStreamingParams(n),o=r[0],a=r[1],c=this.createStreamInvocation(e,n,a),l=new T;return l.cancelCallback=function(){var e=t.createCancelInvocation(c.invocationId);return delete t.callbacks[c.invocationId],s.then((function(){return t.sendWithProtocol(e)}))},this.callbacks[c.invocationId]=function(e,t){t?l.error(t):e&&(e.type===v.Completion?e.error?l.error(new Error(e.error)):l.complete():l.next(e.item))},s=this.sendWithProtocol(c).catch((function(e){l.error(e),delete t.callbacks[c.invocationId]})),this.launchStreams(o,s),l},e.prototype.sendMessage=function(e){return this.resetKeepAliveInterval(),this.connection.send(e)},e.prototype.sendWithProtocol=function(e){return this.sendMessage(this.protocol.writeMessage(e))},e.prototype.send=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=this.replaceStreamingParams(t),s=i[0],r=i[1],o=this.sendWithProtocol(this.createInvocation(e,t,!0,r));return this.launchStreams(s,o),o},e.prototype.invoke=function(e){for(var t=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var s=this.replaceStreamingParams(n),r=s[0],o=s[1],a=this.createInvocation(e,n,!1,o),c=new Promise((function(e,n){t.callbacks[a.invocationId]=function(t,i){i?n(i):t&&(t.type===v.Completion?t.error?n(new Error(t.error)):e(t.result):n(new Error("Unexpected message type: "+t.type)))};var i=t.sendWithProtocol(a).catch((function(e){n(e),delete t.callbacks[a.invocationId]}));t.launchStreams(r,i)}));return c},e.prototype.on=function(e,t){e&&t&&(e=e.toLowerCase(),this.methods[e]||(this.methods[e]=[]),-1===this.methods[e].indexOf(t)&&this.methods[e].push(t))},e.prototype.off=function(e,t){if(e){e=e.toLowerCase();var n=this.methods[e];if(n)if(t){var i=n.indexOf(t);-1!==i&&(n.splice(i,1),0===n.length&&delete this.methods[e])}else delete this.methods[e]}},e.prototype.onclose=function(e){e&&this.closedCallbacks.push(e)},e.prototype.onreconnecting=function(e){e&&this.reconnectingCallbacks.push(e)},e.prototype.onreconnected=function(e){e&&this.reconnectedCallbacks.push(e)},e.prototype.processIncomingData=function(e){if(this.cleanupTimeout(),this.receivedHandshakeResponse||(e=this.processHandshakeResponse(e),this.receivedHandshakeResponse=!0),e)for(var t=0,n=this.protocol.parseMessages(e,this.logger);t<n.length;t++){var i=n[t];switch(i.type){case v.Invocation:this.invokeClientMethod(i);break;case v.StreamItem:case v.Completion:var s=this.callbacks[i.invocationId];s&&(i.type===v.Completion&&delete this.callbacks[i.invocationId],s(i));break;case v.Ping:break;case v.Close:this.logger.log(d.a.Information,"Close message received from server.");var r=i.error?new Error("Server returned an error on close: "+i.error):void 0;!0===i.allowReconnect?this.connection.stop(r):this.stopPromise=this.stopInternal(r);break;default:this.logger.log(d.a.Warning,"Invalid message type: "+i.type+".")}}this.resetTimeoutPeriod()},e.prototype.processHandshakeResponse=function(e){var t,n,i;try{i=(t=this.handshakeProtocol.parseHandshakeResponse(e))[0],n=t[1]}catch(e){var s="Error parsing handshake response: "+e;this.logger.log(d.a.Error,s);var r=new Error(s);throw this.handshakeRejecter(r),r}if(n.error){s="Server returned handshake error: "+n.error;this.logger.log(d.a.Error,s);r=new Error(s);throw this.handshakeRejecter(r),r}return this.logger.log(d.a.Debug,"Server handshake complete."),this.handshakeResolver(),i},e.prototype.resetKeepAliveInterval=function(){this.connection.features.inherentKeepAlive||(this.nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this.cleanupPingTimer())},e.prototype.resetTimeoutPeriod=function(){var e=this;if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this.timeoutHandle=setTimeout((function(){return e.serverTimeout()}),this.serverTimeoutInMilliseconds),void 0!==this.pingServerHandle))){var t=this.nextKeepAlive-(new Date).getTime();t<0&&(t=0),this.pingServerHandle=setTimeout((function(){return M(e,void 0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:if(this.connectionState!==C.Connected)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.sendMessage(this.cachedPingMessage)];case 2:return e.sent(),[3,4];case 3:return e.sent(),this.cleanupPingTimer(),[3,4];case 4:return[2]}}))}))}),t)}},e.prototype.serverTimeout=function(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))},e.prototype.invokeClientMethod=function(e){var t=this,n=this.methods[e.target.toLowerCase()];if(n){try{n.forEach((function(n){return n.apply(t,e.arguments)}))}catch(t){this.logger.log(d.a.Error,"A callback for the method "+e.target.toLowerCase()+" threw error '"+t+"'.")}if(e.invocationId){var i="Server requested a response, which is not supported in this version of the client.";this.logger.log(d.a.Error,i),this.stopPromise=this.stopInternal(new Error(i))}}else this.logger.log(d.a.Warning,"No client method with the name '"+e.target+"' found.")},e.prototype.connectionClosed=function(e){this.logger.log(d.a.Debug,"HubConnection.connectionClosed("+e+") called while in state "+this.connectionState+"."),this.stopDuringStartError=this.stopDuringStartError||e||new Error("The underlying connection was closed before the hub handshake could complete."),this.handshakeResolver&&this.handshakeResolver(),this.cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this.cleanupTimeout(),this.cleanupPingTimer(),this.connectionState===C.Disconnecting?this.completeClose(e):this.connectionState===C.Connected&&this.reconnectPolicy?this.reconnect(e):this.connectionState===C.Connected&&this.completeClose(e)},e.prototype.completeClose=function(e){var t=this;if(this.connectionStarted){this.connectionState=C.Disconnected,this.connectionStarted=!1;try{this.closedCallbacks.forEach((function(n){return n.apply(t,[e])}))}catch(t){this.logger.log(d.a.Error,"An onclose callback called with error '"+e+"' threw error '"+t+"'.")}}},e.prototype.reconnect=function(e){return M(this,void 0,void 0,(function(){var t,n,i,s,r,o=this;return A(this,(function(a){switch(a.label){case 0:if(t=Date.now(),n=0,i=void 0!==e?e:new Error("Attempting to reconnect due to a unknown error."),null===(s=this.getNextRetryDelay(n++,0,i)))return this.logger.log(d.a.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),this.completeClose(e),[2];if(this.connectionState=C.Reconnecting,e?this.logger.log(d.a.Information,"Connection reconnecting because of error '"+e+"'."):this.logger.log(d.a.Information,"Connection reconnecting."),this.onreconnecting){try{this.reconnectingCallbacks.forEach((function(t){return t.apply(o,[e])}))}catch(t){this.logger.log(d.a.Error,"An onreconnecting callback called with error '"+e+"' threw error '"+t+"'.")}if(this.connectionState!==C.Reconnecting)return this.logger.log(d.a.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting."),[2]}a.label=1;case 1:return null===s?[3,7]:(this.logger.log(d.a.Information,"Reconnect attempt number "+n+" will start in "+s+" ms."),[4,new Promise((function(e){o.reconnectDelayHandle=setTimeout(e,s)}))]);case 2:if(a.sent(),this.reconnectDelayHandle=void 0,this.connectionState!==C.Reconnecting)return this.logger.log(d.a.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting."),[2];a.label=3;case 3:return a.trys.push([3,5,,6]),[4,this.startInternal()];case 4:if(a.sent(),this.connectionState=C.Connected,this.logger.log(d.a.Information,"HubConnection reconnected successfully."),this.onreconnected)try{this.reconnectedCallbacks.forEach((function(e){return e.apply(o,[o.connection.connectionId])}))}catch(e){this.logger.log(d.a.Error,"An onreconnected callback called with connectionId '"+this.connection.connectionId+"; threw error '"+e+"'.")}return[2];case 5:return r=a.sent(),this.logger.log(d.a.Information,"Reconnect attempt failed because of error '"+r+"'."),this.connectionState!==C.Reconnecting?(this.logger.log(d.a.Debug,"Connection moved to the '"+this.connectionState+"' from the reconnecting state during reconnect attempt. Done reconnecting."),this.connectionState===C.Disconnecting&&this.completeClose(),[2]):(i=r instanceof Error?r:new Error(r.toString()),s=this.getNextRetryDelay(n++,Date.now()-t,i),[3,6]);case 6:return[3,1];case 7:return this.logger.log(d.a.Information,"Reconnect retries have been exhausted after "+(Date.now()-t)+" ms and "+n+" failed attempts. Connection disconnecting."),this.completeClose(),[2]}}))}))},e.prototype.getNextRetryDelay=function(e,t,n){try{return this.reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:n})}catch(n){return this.logger.log(d.a.Error,"IRetryPolicy.nextRetryDelayInMilliseconds("+e+", "+t+") threw error '"+n+"'."),null}},e.prototype.cancelCallbacksWithError=function(e){var t=this.callbacks;this.callbacks={},Object.keys(t).forEach((function(n){(0,t[n])(null,e)}))},e.prototype.cleanupPingTimer=function(){this.pingServerHandle&&(clearTimeout(this.pingServerHandle),this.pingServerHandle=void 0)},e.prototype.cleanupTimeout=function(){this.timeoutHandle&&clearTimeout(this.timeoutHandle)},e.prototype.createInvocation=function(e,t,n,i){if(n)return 0!==i.length?{arguments:t,streamIds:i,target:e,type:v.Invocation}:{arguments:t,target:e,type:v.Invocation};var s=this.invocationId;return this.invocationId++,0!==i.length?{arguments:t,invocationId:s.toString(),streamIds:i,target:e,type:v.Invocation}:{arguments:t,invocationId:s.toString(),target:e,type:v.Invocation}},e.prototype.launchStreams=function(e,t){var n=this;if(0!==e.length){t||(t=Promise.resolve());var i=function(i){e[i].subscribe({complete:function(){t=t.then((function(){return n.sendWithProtocol(n.createCompletionMessage(i))}))},error:function(e){var s;s=e instanceof Error?e.message:e&&e.toString?e.toString():"Unknown error",t=t.then((function(){return n.sendWithProtocol(n.createCompletionMessage(i,s))}))},next:function(e){t=t.then((function(){return n.sendWithProtocol(n.createStreamItemMessage(i,e))}))}})};for(var s in e)i(s)}},e.prototype.replaceStreamingParams=function(e){for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i];if(this.isObservable(s)){var r=this.invocationId;this.invocationId++,t[r]=s,n.push(r.toString()),e.splice(i,1)}}return[t,n]},e.prototype.isObservable=function(e){return e&&e.subscribe&&"function"==typeof e.subscribe},e.prototype.createStreamInvocation=function(e,t,n){var i=this.invocationId;return this.invocationId++,0!==n.length?{arguments:t,invocationId:i.toString(),streamIds:n,target:e,type:v.StreamInvocation}:{arguments:t,invocationId:i.toString(),target:e,type:v.StreamInvocation}},e.prototype.createCancelInvocation=function(e){return{invocationId:e,type:v.CancelInvocation}},e.prototype.createStreamItemMessage=function(e,t){return{invocationId:e,item:t,type:v.StreamItem}},e.prototype.createCompletionMessage=function(e,t,n){return t?{error:t,invocationId:e,type:v.Completion}:{invocationId:e,result:n,type:v.Completion}},e}(),I=[0,2e3,1e4,3e4,null],N=function(){function e(e){this.retryDelays=void 0!==e?e.concat([null]):I}return e.prototype.nextRetryDelayInMilliseconds=function(e){return this.retryDelays[e.previousRetryCount]},e}();!function(e){e[e.None=0]="None",e[e.WebSockets=1]="WebSockets",e[e.ServerSentEvents=2]="ServerSentEvents",e[e.LongPolling=4]="LongPolling"}(k||(k={})),function(e){e[e.Text=1]="Text",e[e.Binary=2]="Binary"}(R||(R={}));var L=function(){function e(){this.isAborted=!1,this.onabort=null}return e.prototype.abort=function(){this.isAborted||(this.isAborted=!0,this.onabort&&this.onabort())},Object.defineProperty(e.prototype,"signal",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aborted",{get:function(){return this.isAborted},enumerable:!0,configurable:!0}),e}(),D=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},x=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){e.done?s(e.value):new n((function(t){t(e.value)})).then(o,a)}c((i=i.apply(e,t||[])).next())}))},O=function(e,t){var n,i,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,i=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],i=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},F=function(){function e(e,t,n,i,s,r){this.httpClient=e,this.accessTokenFactory=t,this.logger=n,this.pollAbort=new L,this.logMessageContent=i,this.withCredentials=s,this.headers=r,this.running=!1,this.onreceive=null,this.onclose=null}return Object.defineProperty(e.prototype,"pollAborted",{get:function(){return this.pollAbort.aborted},enumerable:!0,configurable:!0}),e.prototype.connect=function(e,t){return x(this,void 0,void 0,(function(){var n,i,s,o,a,c,l,u,f;return O(this,(function(p){switch(p.label){case 0:if(h.a.isRequired(e,"url"),h.a.isRequired(t,"transferFormat"),h.a.isIn(t,R,"transferFormat"),this.url=e,this.logger.log(d.a.Trace,"(LongPolling transport) Connecting."),t===R.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");return i=Object(h.h)(),s=i[0],o=i[1],a=D(((n={})[s]=o,n),this.headers),c={abortSignal:this.pollAbort.signal,headers:a,timeout:1e5,withCredentials:this.withCredentials},t===R.Binary&&(c.responseType="arraybuffer"),[4,this.getAccessToken()];case 1:return l=p.sent(),this.updateHeaderToken(c,l),u=e+"&_="+Date.now(),this.logger.log(d.a.Trace,"(LongPolling transport) polling: "+u+"."),[4,this.httpClient.get(u,c)];case 2:return 200!==(f=p.sent()).statusCode?(this.logger.log(d.a.Error,"(LongPolling transport) Unexpected response code: "+f.statusCode+"."),this.closeError=new r(f.statusText||"",f.statusCode),this.running=!1):this.running=!0,this.receiving=this.poll(this.url,c),[2]}}))}))},e.prototype.getAccessToken=function(){return x(this,void 0,void 0,(function(){return O(this,(function(e){switch(e.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:return[2,e.sent()];case 2:return[2,null]}}))}))},e.prototype.updateHeaderToken=function(e,t){e.headers||(e.headers={}),t?e.headers.Authorization="Bearer "+t:e.headers.Authorization&&delete e.headers.Authorization},e.prototype.poll=function(e,t){return x(this,void 0,void 0,(function(){var n,i,s,a;return O(this,(function(c){switch(c.label){case 0:c.trys.push([0,,8,9]),c.label=1;case 1:return this.running?[4,this.getAccessToken()]:[3,7];case 2:n=c.sent(),this.updateHeaderToken(t,n),c.label=3;case 3:return c.trys.push([3,5,,6]),i=e+"&_="+Date.now(),this.logger.log(d.a.Trace,"(LongPolling transport) polling: "+i+"."),[4,this.httpClient.get(i,t)];case 4:return 204===(s=c.sent()).statusCode?(this.logger.log(d.a.Information,"(LongPolling transport) Poll terminated by server."),this.running=!1):200!==s.statusCode?(this.logger.log(d.a.Error,"(LongPolling transport) Unexpected response code: "+s.statusCode+"."),this.closeError=new r(s.statusText||"",s.statusCode),this.running=!1):s.content?(this.logger.log(d.a.Trace,"(LongPolling transport) data received. "+Object(h.g)(s.content,this.logMessageContent)+"."),this.onreceive&&this.onreceive(s.content)):this.logger.log(d.a.Trace,"(LongPolling transport) Poll timed out, reissuing."),[3,6];case 5:return a=c.sent(),this.running?a instanceof o?this.logger.log(d.a.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this.closeError=a,this.running=!1):this.logger.log(d.a.Trace,"(LongPolling transport) Poll errored after shutdown: "+a.message),[3,6];case 6:return[3,1];case 7:return[3,9];case 8:return this.logger.log(d.a.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this.raiseOnClose(),[7];case 9:return[2]}}))}))},e.prototype.send=function(e){return x(this,void 0,void 0,(function(){return O(this,(function(t){return this.running?[2,Object(h.j)(this.logger,"LongPolling",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent,this.withCredentials,this.headers)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]}))}))},e.prototype.stop=function(){return x(this,void 0,void 0,(function(){var e,t,n,i,s,r;return O(this,(function(o){switch(o.label){case 0:this.logger.log(d.a.Trace,"(LongPolling transport) Stopping polling."),this.running=!1,this.pollAbort.abort(),o.label=1;case 1:return o.trys.push([1,,5,6]),[4,this.receiving];case 2:return o.sent(),this.logger.log(d.a.Trace,"(LongPolling transport) sending DELETE request to "+this.url+"."),e={},t=Object(h.h)(),n=t[0],i=t[1],e[n]=i,s={headers:D({},e,this.headers),withCredentials:this.withCredentials},[4,this.getAccessToken()];case 3:return r=o.sent(),this.updateHeaderToken(s,r),[4,this.httpClient.delete(this.url,s)];case 4:return o.sent(),this.logger.log(d.a.Trace,"(LongPolling transport) DELETE request sent."),[3,6];case 5:return this.logger.log(d.a.Trace,"(LongPolling transport) Stop finished."),this.raiseOnClose(),[7];case 6:return[2]}}))}))},e.prototype.raiseOnClose=function(){if(this.onclose){var e="(LongPolling transport) Firing onclose event.";this.closeError&&(e+=" Error: "+this.closeError),this.logger.log(d.a.Trace,e),this.onclose(this.closeError)}},e}(),U=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},j=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){e.done?s(e.value):new n((function(t){t(e.value)})).then(o,a)}c((i=i.apply(e,t||[])).next())}))},H=function(e,t){var n,i,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,i=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],i=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},B=function(){function e(e,t,n,i,s,r,o){this.httpClient=e,this.accessTokenFactory=t,this.logger=n,this.logMessageContent=i,this.withCredentials=r,this.eventSourceConstructor=s,this.headers=o,this.onreceive=null,this.onclose=null}return e.prototype.connect=function(e,t){return j(this,void 0,void 0,(function(){var n,i=this;return H(this,(function(s){switch(s.label){case 0:return h.a.isRequired(e,"url"),h.a.isRequired(t,"transferFormat"),h.a.isIn(t,R,"transferFormat"),this.logger.log(d.a.Trace,"(SSE transport) Connecting."),this.url=e,this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(n=s.sent())&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(n)),s.label=2;case 2:return[2,new Promise((function(n,s){var r=!1;if(t===R.Text){var o;if(h.c.isBrowser||h.c.isWebWorker)o=new i.eventSourceConstructor(e,{withCredentials:i.withCredentials});else{var a=i.httpClient.getCookieString(e),c={};c.Cookie=a;var l=Object(h.h)(),u=l[0],f=l[1];c[u]=f,o=new i.eventSourceConstructor(e,{withCredentials:i.withCredentials,headers:U({},c,i.headers)})}try{o.onmessage=function(e){if(i.onreceive)try{i.logger.log(d.a.Trace,"(SSE transport) data received. "+Object(h.g)(e.data,i.logMessageContent)+"."),i.onreceive(e.data)}catch(e){return void i.close(e)}},o.onerror=function(e){var t=new Error(e.data||"Error occurred");r?i.close(t):s(t)},o.onopen=function(){i.logger.log(d.a.Information,"SSE connected to "+i.url),i.eventSource=o,r=!0,n()}}catch(e){return void s(e)}}else s(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))}))]}}))}))},e.prototype.send=function(e){return j(this,void 0,void 0,(function(){return H(this,(function(t){return this.eventSource?[2,Object(h.j)(this.logger,"SSE",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent,this.withCredentials,this.headers)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]}))}))},e.prototype.stop=function(){return this.close(),Promise.resolve()},e.prototype.close=function(e){this.eventSource&&(this.eventSource.close(),this.eventSource=void 0,this.onclose&&this.onclose(e))},e}(),Y=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},W=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){e.done?s(e.value):new n((function(t){t(e.value)})).then(o,a)}c((i=i.apply(e,t||[])).next())}))},q=function(e,t){var n,i,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,i=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],i=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},V=function(){function e(e,t,n,i,s,r){this.logger=n,this.accessTokenFactory=t,this.logMessageContent=i,this.webSocketConstructor=s,this.httpClient=e,this.onreceive=null,this.onclose=null,this.headers=r}return e.prototype.connect=function(e,t){return W(this,void 0,void 0,(function(){var n,i=this;return q(this,(function(s){switch(s.label){case 0:return h.a.isRequired(e,"url"),h.a.isRequired(t,"transferFormat"),h.a.isIn(t,R,"transferFormat"),this.logger.log(d.a.Trace,"(WebSockets transport) Connecting."),this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(n=s.sent())&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(n)),s.label=2;case 2:return[2,new Promise((function(n,s){var r;e=e.replace(/^http/,"ws");var o=i.httpClient.getCookieString(e),a=!1;if(h.c.isNode){var c={},l=Object(h.h)(),u=l[0],f=l[1];c[u]=f,o&&(c.Cookie=""+o),r=new i.webSocketConstructor(e,void 0,{headers:Y({},c,i.headers)})}r||(r=new i.webSocketConstructor(e)),t===R.Binary&&(r.binaryType="arraybuffer"),r.onopen=function(t){i.logger.log(d.a.Information,"WebSocket connected to "+e+"."),i.webSocket=r,a=!0,n()},r.onerror=function(e){var t=null;t="undefined"!=typeof ErrorEvent&&e instanceof ErrorEvent?e.error:new Error("There was an error with the transport."),s(t)},r.onmessage=function(e){if(i.logger.log(d.a.Trace,"(WebSockets transport) data received. "+Object(h.g)(e.data,i.logMessageContent)+"."),i.onreceive)try{i.onreceive(e.data)}catch(e){return void i.close(e)}},r.onclose=function(e){if(a)i.close(e);else{var t=null;t="undefined"!=typeof ErrorEvent&&e instanceof ErrorEvent?e.error:new Error("There was an error with the transport."),s(t)}}}))]}}))}))},e.prototype.send=function(e){return this.webSocket&&this.webSocket.readyState===this.webSocketConstructor.OPEN?(this.logger.log(d.a.Trace,"(WebSockets transport) sending data. "+Object(h.g)(e,this.logMessageContent)+"."),this.webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")},e.prototype.stop=function(){return this.webSocket&&this.close(void 0),Promise.resolve()},e.prototype.close=function(e){this.webSocket&&(this.webSocket.onclose=function(){},this.webSocket.onmessage=function(){},this.webSocket.onerror=function(){},this.webSocket.close(),this.webSocket=void 0),this.logger.log(d.a.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this.isCloseEvent(e)||!1!==e.wasClean&&1e3===e.code?e instanceof Error?this.onclose(e):this.onclose():this.onclose(new Error("WebSocket closed with status code: "+e.code+" ("+e.reason+").")))},e.prototype.isCloseEvent=function(e){return e&&"boolean"==typeof e.wasClean&&"number"==typeof e.code},e}(),$=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},K=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){e.done?s(e.value):new n((function(t){t(e.value)})).then(o,a)}c((i=i.apply(e,t||[])).next())}))},z=function(e,t){var n,i,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,i=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],i=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},G=function(){function e(e,t){if(void 0===t&&(t={}),this.stopPromiseResolver=function(){},this.features={},this.negotiateVersion=1,h.a.isRequired(e,"url"),this.logger=Object(h.f)(t.logger),this.baseUrl=this.resolveUrl(e),(t=t||{}).logMessageContent=void 0!==t.logMessageContent&&t.logMessageContent,"boolean"!=typeof t.withCredentials&&void 0!==t.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");t.withCredentials=void 0===t.withCredentials||t.withCredentials;var n=null,i=null;if(h.c.isNode){var s=require;n=s("ws"),i=s("eventsource")}h.c.isNode||"undefined"==typeof WebSocket||t.WebSocket?h.c.isNode&&!t.WebSocket&&n&&(t.WebSocket=n):t.WebSocket=WebSocket,h.c.isNode||"undefined"==typeof EventSource||t.EventSource?h.c.isNode&&!t.EventSource&&void 0!==i&&(t.EventSource=i):t.EventSource=EventSource,this.httpClient=t.httpClient||new w(this.logger),this.connectionState="Disconnected",this.connectionStarted=!1,this.options=t,this.onreceive=null,this.onclose=null}return e.prototype.start=function(e){return K(this,void 0,void 0,(function(){var t;return z(this,(function(n){switch(n.label){case 0:return e=e||R.Binary,h.a.isIn(e,R,"transferFormat"),this.logger.log(d.a.Debug,"Starting connection with transfer format '"+R[e]+"'."),"Disconnected"!==this.connectionState?[2,Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."))]:(this.connectionState="Connecting",this.startInternalPromise=this.startInternal(e),[4,this.startInternalPromise]);case 1:return n.sent(),"Disconnecting"!==this.connectionState?[3,3]:(t="Failed to start the HttpConnection before stop() was called.",this.logger.log(d.a.Error,t),[4,this.stopPromise]);case 2:return n.sent(),[2,Promise.reject(new Error(t))];case 3:if("Connected"!==this.connectionState)return t="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!",this.logger.log(d.a.Error,t),[2,Promise.reject(new Error(t))];n.label=4;case 4:return this.connectionStarted=!0,[2]}}))}))},e.prototype.send=function(e){return"Connected"!==this.connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this.sendQueue||(this.sendQueue=new J(this.transport)),this.sendQueue.send(e))},e.prototype.stop=function(e){return K(this,void 0,void 0,(function(){var t=this;return z(this,(function(n){switch(n.label){case 0:return"Disconnected"===this.connectionState?(this.logger.log(d.a.Debug,"Call to HttpConnection.stop("+e+") ignored because the connection is already in the disconnected state."),[2,Promise.resolve()]):"Disconnecting"===this.connectionState?(this.logger.log(d.a.Debug,"Call to HttpConnection.stop("+e+") ignored because the connection is already in the disconnecting state."),[2,this.stopPromise]):(this.connectionState="Disconnecting",this.stopPromise=new Promise((function(e){t.stopPromiseResolver=e})),[4,this.stopInternal(e)]);case 1:return n.sent(),[4,this.stopPromise];case 2:return n.sent(),[2]}}))}))},e.prototype.stopInternal=function(e){return K(this,void 0,void 0,(function(){var t;return z(this,(function(n){switch(n.label){case 0:this.stopError=e,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.startInternalPromise];case 2:return n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:if(!this.transport)return[3,9];n.label=5;case 5:return n.trys.push([5,7,,8]),[4,this.transport.stop()];case 6:return n.sent(),[3,8];case 7:return t=n.sent(),this.logger.log(d.a.Error,"HttpConnection.transport.stop() threw error '"+t+"'."),this.stopConnection(),[3,8];case 8:return this.transport=void 0,[3,10];case 9:this.logger.log(d.a.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed."),n.label=10;case 10:return[2]}}))}))},e.prototype.startInternal=function(e){return K(this,void 0,void 0,(function(){var t,n,i,s,r,o;return z(this,(function(a){switch(a.label){case 0:t=this.baseUrl,this.accessTokenFactory=this.options.accessTokenFactory,a.label=1;case 1:return a.trys.push([1,12,,13]),this.options.skipNegotiation?this.options.transport!==k.WebSockets?[3,3]:(this.transport=this.constructTransport(k.WebSockets),[4,this.startTransport(t,e)]):[3,5];case 2:return a.sent(),[3,4];case 3:throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");case 4:return[3,11];case 5:n=null,i=0,s=function(){var e;return z(this,(function(s){switch(s.label){case 0:return[4,r.getNegotiationResponse(t)];case 1:if(n=s.sent(),"Disconnecting"===r.connectionState||"Disconnected"===r.connectionState)throw new Error("The connection was stopped during negotiation.");if(n.error)throw new Error(n.error);if(n.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");return n.url&&(t=n.url),n.accessToken&&(e=n.accessToken,r.accessTokenFactory=function(){return e}),i++,[2]}}))},r=this,a.label=6;case 6:return[5,s()];case 7:a.sent(),a.label=8;case 8:if(n.url&&i<100)return[3,6];a.label=9;case 9:if(100===i&&n.url)throw new Error("Negotiate redirection limit exceeded.");return[4,this.createTransport(t,this.options.transport,n,e)];case 10:a.sent(),a.label=11;case 11:return this.transport instanceof F&&(this.features.inherentKeepAlive=!0),"Connecting"===this.connectionState&&(this.logger.log(d.a.Debug,"The HttpConnection connected successfully."),this.connectionState="Connected"),[3,13];case 12:return o=a.sent(),this.logger.log(d.a.Error,"Failed to start the connection: "+o),this.connectionState="Disconnected",this.transport=void 0,this.stopPromiseResolver(),[2,Promise.reject(o)];case 13:return[2]}}))}))},e.prototype.getNegotiationResponse=function(e){return K(this,void 0,void 0,(function(){var t,n,i,s,r,o,a,c,l;return z(this,(function(u){switch(u.label){case 0:return t={},this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(n=u.sent())&&(t.Authorization="Bearer "+n),u.label=2;case 2:i=Object(h.h)(),s=i[0],r=i[1],t[s]=r,o=this.resolveNegotiateUrl(e),this.logger.log(d.a.Debug,"Sending negotiation request: "+o+"."),u.label=3;case 3:return u.trys.push([3,5,,6]),[4,this.httpClient.post(o,{content:"",headers:$({},t,this.options.headers),withCredentials:this.options.withCredentials})];case 4:return 200!==(a=u.sent()).statusCode?[2,Promise.reject(new Error("Unexpected status code returned from negotiate '"+a.statusCode+"'"))]:((!(c=JSON.parse(a.content)).negotiateVersion||c.negotiateVersion<1)&&(c.connectionToken=c.connectionId),[2,c]);case 5:return l=u.sent(),this.logger.log(d.a.Error,"Failed to complete negotiation with the server: "+l),[2,Promise.reject(l)];case 6:return[2]}}))}))},e.prototype.createConnectUrl=function(e,t){return t?e+(-1===e.indexOf("?")?"?":"&")+"id="+t:e},e.prototype.createTransport=function(e,t,n,i){return K(this,void 0,void 0,(function(){var s,r,o,a,c,l,u,h,f,p,m;return z(this,(function(g){switch(g.label){case 0:return s=this.createConnectUrl(e,n.connectionToken),this.isITransport(t)?(this.logger.log(d.a.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,[4,this.startTransport(s,i)]):[3,2];case 1:return g.sent(),this.connectionId=n.connectionId,[2];case 2:r=[],o=n.availableTransports||[],a=n,c=0,l=o,g.label=3;case 3:return c<l.length?(u=l[c],(h=this.resolveTransportOrError(u,t,i))instanceof Error?(r.push(u.transport+" failed: "+h),[3,12]):[3,4]):[3,13];case 4:if(!this.isITransport(h))return[3,12];if(this.transport=h,a)return[3,9];g.label=5;case 5:return g.trys.push([5,7,,8]),[4,this.getNegotiationResponse(e)];case 6:return a=g.sent(),[3,8];case 7:return f=g.sent(),[2,Promise.reject(f)];case 8:s=this.createConnectUrl(e,a.connectionToken),g.label=9;case 9:return g.trys.push([9,11,,12]),[4,this.startTransport(s,i)];case 10:return g.sent(),this.connectionId=a.connectionId,[2];case 11:return p=g.sent(),this.logger.log(d.a.Error,"Failed to start the transport '"+u.transport+"': "+p),a=void 0,r.push(u.transport+" failed: "+p),"Connecting"!==this.connectionState?(m="Failed to select transport before stop() was called.",this.logger.log(d.a.Debug,m),[2,Promise.reject(new Error(m))]):[3,12];case 12:return c++,[3,3];case 13:return r.length>0?[2,Promise.reject(new Error("Unable to connect to the server with any of the available transports. "+r.join(" ")))]:[2,Promise.reject(new Error("None of the transports supported by the client are supported by the server."))]}}))}))},e.prototype.constructTransport=function(e){switch(e){case k.WebSockets:if(!this.options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new V(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.WebSocket,this.options.headers||{});case k.ServerSentEvents:if(!this.options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new B(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.EventSource,this.options.withCredentials,this.options.headers||{});case k.LongPolling:return new F(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.withCredentials,this.options.headers||{});default:throw new Error("Unknown transport: "+e+".")}},e.prototype.startTransport=function(e,t){var n=this;return this.transport.onreceive=this.onreceive,this.transport.onclose=function(e){return n.stopConnection(e)},this.transport.connect(e,t)},e.prototype.resolveTransportOrError=function(e,t,n){var i=k[e.transport];if(null==i)return this.logger.log(d.a.Debug,"Skipping transport '"+e.transport+"' because it is not supported by this client."),new Error("Skipping transport '"+e.transport+"' because it is not supported by this client.");if(!function(e,t){return!e||0!=(t&e)}(t,i))return this.logger.log(d.a.Debug,"Skipping transport '"+k[i]+"' because it was disabled by the client."),new Error("'"+k[i]+"' is disabled by the client.");if(!(e.transferFormats.map((function(e){return R[e]})).indexOf(n)>=0))return this.logger.log(d.a.Debug,"Skipping transport '"+k[i]+"' because it does not support the requested transfer format '"+R[n]+"'."),new Error("'"+k[i]+"' does not support "+R[n]+".");if(i===k.WebSockets&&!this.options.WebSocket||i===k.ServerSentEvents&&!this.options.EventSource)return this.logger.log(d.a.Debug,"Skipping transport '"+k[i]+"' because it is not supported in your environment.'"),new Error("'"+k[i]+"' is not supported in your environment.");this.logger.log(d.a.Debug,"Selecting transport '"+k[i]+"'.");try{return this.constructTransport(i)}catch(e){return e}},e.prototype.isITransport=function(e){return e&&"object"==typeof e&&"connect"in e},e.prototype.stopConnection=function(e){var t=this;if(this.logger.log(d.a.Debug,"HttpConnection.stopConnection("+e+") called while in state "+this.connectionState+"."),this.transport=void 0,e=this.stopError||e,this.stopError=void 0,"Disconnected"!==this.connectionState){if("Connecting"===this.connectionState)throw this.logger.log(d.a.Warning,"Call to HttpConnection.stopConnection("+e+") was ignored because the connection is still in the connecting state."),new Error("HttpConnection.stopConnection("+e+") was called while the connection is still in the connecting state.");if("Disconnecting"===this.connectionState&&this.stopPromiseResolver(),e?this.logger.log(d.a.Error,"Connection disconnected with error '"+e+"'."):this.logger.log(d.a.Information,"Connection disconnected."),this.sendQueue&&(this.sendQueue.stop().catch((function(e){t.logger.log(d.a.Error,"TransportSendQueue.stop() threw error '"+e+"'.")})),this.sendQueue=void 0),this.connectionId=void 0,this.connectionState="Disconnected",this.connectionStarted){this.connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(t){this.logger.log(d.a.Error,"HttpConnection.onclose("+e+") threw error '"+t+"'.")}}}else this.logger.log(d.a.Debug,"Call to HttpConnection.stopConnection("+e+") was ignored because the connection is already in the disconnected state.")},e.prototype.resolveUrl=function(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if(!h.c.isBrowser||!window.document)throw new Error("Cannot resolve '"+e+"'.");var t=window.document.createElement("a");return t.href=e,this.logger.log(d.a.Information,"Normalizing '"+e+"' to '"+t.href+"'."),t.href},e.prototype.resolveNegotiateUrl=function(e){var t=e.indexOf("?"),n=e.substring(0,-1===t?e.length:t);return"/"!==n[n.length-1]&&(n+="/"),n+="negotiate",-1===(n+=-1===t?"":e.substring(t)).indexOf("negotiateVersion")&&(n+=-1===t?"?":"&",n+="negotiateVersion="+this.negotiateVersion),n},e}();var J=function(){function e(e){this.transport=e,this.buffer=[],this.executing=!0,this.sendBufferedData=new X,this.transportResult=new X,this.sendLoopPromise=this.sendLoop()}return e.prototype.send=function(e){return this.bufferData(e),this.transportResult||(this.transportResult=new X),this.transportResult.promise},e.prototype.stop=function(){return this.executing=!1,this.sendBufferedData.resolve(),this.sendLoopPromise},e.prototype.bufferData=function(e){if(this.buffer.length&&typeof this.buffer[0]!=typeof e)throw new Error("Expected data to be of type "+typeof this.buffer+" but was of type "+typeof e);this.buffer.push(e),this.sendBufferedData.resolve()},e.prototype.sendLoop=function(){return K(this,void 0,void 0,(function(){var t,n,i;return z(this,(function(s){switch(s.label){case 0:return[4,this.sendBufferedData.promise];case 1:if(s.sent(),!this.executing)return this.transportResult&&this.transportResult.reject("Connection stopped."),[3,6];this.sendBufferedData=new X,t=this.transportResult,this.transportResult=void 0,n="string"==typeof this.buffer[0]?this.buffer.join(""):e.concatBuffers(this.buffer),this.buffer.length=0,s.label=2;case 2:return s.trys.push([2,4,,5]),[4,this.transport.send(n)];case 3:return s.sent(),t.resolve(),[3,5];case 4:return i=s.sent(),t.reject(i),[3,5];case 5:return[3,0];case 6:return[2]}}))}))},e.concatBuffers=function(e){for(var t=e.map((function(e){return e.byteLength})).reduce((function(e,t){return e+t})),n=new Uint8Array(t),i=0,s=0,r=e;s<r.length;s++){var o=r[s];n.set(new Uint8Array(o),i),i+=o.byteLength}return n.buffer},e}(),X=function(){function e(){var e=this;this.promise=new Promise((function(t,n){var i;return i=[t,n],e.resolver=i[0],e.rejecter=i[1],i}))}return e.prototype.resolve=function(){this.resolver()},e.prototype.reject=function(e){this.rejecter(e)},e}(),Z=n(72),Q=n(73),ee=function(){function e(){this.name="json",this.version=1,this.transferFormat=R.Text}return e.prototype.parseMessages=function(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=Z.a.instance);for(var n=[],i=0,s=Q.a.parse(e);i<s.length;i++){var r=s[i],o=JSON.parse(r);if("number"!=typeof o.type)throw new Error("Invalid payload.");switch(o.type){case v.Invocation:this.isInvocationMessage(o);break;case v.StreamItem:this.isStreamItemMessage(o);break;case v.Completion:this.isCompletionMessage(o);break;case v.Ping:case v.Close:break;default:t.log(d.a.Information,"Unknown message type '"+o.type+"' ignored.");continue}n.push(o)}return n},e.prototype.writeMessage=function(e){return Q.a.write(JSON.stringify(e))},e.prototype.isInvocationMessage=function(e){this.assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this.assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")},e.prototype.isStreamItemMessage=function(e){if(this.assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")},e.prototype.isCompletionMessage=function(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this.assertNotEmptyString(e.error,"Invalid payload for Completion message."),this.assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")},e.prototype.assertNotEmptyString=function(e,t){if("string"!=typeof e||""===e)throw new Error(t)},e}(),te=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},ne={trace:d.a.Trace,debug:d.a.Debug,info:d.a.Information,information:d.a.Information,warn:d.a.Warning,warning:d.a.Warning,error:d.a.Error,critical:d.a.Critical,none:d.a.None};var ie=function(){function e(){}return e.prototype.configureLogging=function(e){if(h.a.isRequired(e,"logging"),void 0!==e.log)this.logger=e;else if("string"==typeof e){var t=function(e){var t=ne[e.toLowerCase()];if(void 0!==t)return t;throw new Error("Unknown log level: "+e)}(e);this.logger=new h.b(t)}else this.logger=new h.b(e);return this},e.prototype.withUrl=function(e,t){return h.a.isRequired(e,"url"),h.a.isNotEmpty(e,"url"),this.url=e,this.httpConnectionOptions=te({},this.httpConnectionOptions,"object"==typeof t?t:{transport:t}),this},e.prototype.withHubProtocol=function(e){return h.a.isRequired(e,"protocol"),this.protocol=e,this},e.prototype.withAutomaticReconnect=function(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return e?Array.isArray(e)?this.reconnectPolicy=new N(e):this.reconnectPolicy=e:this.reconnectPolicy=new N,this},e.prototype.build=function(){var e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");var t=new G(this.url,e);return P.create(t,this.logger||Z.a.instance,this.protocol||new ee,this.reconnectPolicy)},e}()},function(e,t,n){(function(e){function n(e,t){for(var n=0,i=e.length-1;i>=0;i--){var s=e[i];"."===s?e.splice(i,1):".."===s?(e.splice(i,1),n++):n&&(e.splice(i,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function i(e,t){if(e.filter)return e.filter(t);for(var n=[],i=0;i<e.length;i++)t(e[i],i,e)&&n.push(e[i]);return n}t.resolve=function(){for(var t="",s=!1,r=arguments.length-1;r>=-1&&!s;r--){var o=r>=0?arguments[r]:e.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,s="/"===o.charAt(0))}return(s?"/":"")+(t=n(i(t.split("/"),(function(e){return!!e})),!s).join("/"))||"."},t.normalize=function(e){var r=t.isAbsolute(e),o="/"===s(e,-1);return(e=n(i(e.split("/"),(function(e){return!!e})),!r).join("/"))||r||(e="."),e&&o&&(e+="/"),(r?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(i(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,n){function i(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var s=i(e.split("/")),r=i(n.split("/")),o=Math.min(s.length,r.length),a=o,c=0;c<o;c++)if(s[c]!==r[c]){a=c;break}var l=[];for(c=a;c<s.length;c++)l.push("..");return(l=l.concat(r.slice(a))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,i=-1,s=!0,r=e.length-1;r>=1;--r)if(47===(t=e.charCodeAt(r))){if(!s){i=r;break}}else s=!1;return-1===i?n?"/":".":n&&1===i?"/":e.slice(0,i)},t.basename=function(e,t){var n=function(e){"string"!=typeof e&&(e+="");var t,n=0,i=-1,s=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!s){n=t+1;break}}else-1===i&&(s=!1,i=t+1);return-1===i?"":e.slice(n,i)}(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,n=0,i=-1,s=!0,r=0,o=e.length-1;o>=0;--o){var a=e.charCodeAt(o);if(47!==a)-1===i&&(s=!1,i=o+1),46===a?-1===t?t=o:1!==r&&(r=1):-1!==t&&(r=-1);else if(!s){n=o+1;break}}return-1===t||-1===i||0===r||1===r&&t===i-1&&t===n+1?"":e.slice(t,i)};var s="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n(11))},function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(194)),i(n(704)),i(n(317)),i(n(321)),i(n(726));var s=n(320);t.LoggerSettings=s.LoggerSettings;var r=n(728);t.GlobPatternTraceFilter=r.GlobPatternTraceFilter;var o=n(733);t.VerbosityTraceFilter=o.VerbosityTraceFilter;var a=n(151);t.TraceListener=a.TraceListener;var c=n(113);t.TraceFormat=c.TraceFormat;var l=n(734);t.TraceSource=l.TraceSource;var u=n(735);t.TraceFilters=u.TraceFilters;var d=n(736);t.Logger=d.Logger,t.LoggerBase=d.LoggerBase;var h=n(319);t.Privacy=h.Privacy},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var s=n(326);t.RpcErrorCodes=s.RpcErrorCodes,t.RpcProxy=s.RpcProxy;var r=n(218);t.RpcServiceHandler=r.RpcServiceHandler,t.methodProgress=r.methodProgress;var o=n(851);t.RpcClient=o.RpcClient;var a=n(214);t.RpcClientProxy=a.RpcClientProxy,t.RpcClientProxyBase=a.RpcClientProxyBase;var c=n(375);t.RpcLoggerAdapter=c.RpcLoggerAdapter;var l=n(376);t.RpcConnectionClosedError=l.RpcConnectionClosedError,t.RpcConnectionShutdownError=l.RpcConnectionShutdownError;var u=n(852);t.RpcServer=u.RpcServer;var d=n(853);t.RpcMessageWriter=d.RpcMessageWriter;var h=n(854);t.DataFormat=h.DataFormat,t.dataFormat=h.dataFormat;var f=n(855);t.RpcProxyCache=f.RpcProxyCache;const p=i(n(126));t.rpcUtils=p,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(377));var m=n(856);t.createDuplexRpcMessageStreams=m.createDuplexRpcMessageStreams,t.rpcMaxMessageSize=10485760},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Initializing=0]="Initializing",e[e.SignedOut=1]="SignedOut",e[e.SigningIn=2]="SigningIn",e[e.ExternallySigningIn=3]="ExternallySigningIn",e[e.SignedIn=4]="SignedIn",e[e.SharingInProgress=5]="SharingInProgress",e[e.Shared=6]="Shared",e[e.JoiningInProgress=7]="JoiningInProgress",e[e.Joined=8]="Joined"}(t.SessionState||(t.SessionState={})),function(e){e[e.AttemptSharing=0]="AttemptSharing",e[e.SharingError=1]="SharingError",e[e.SharingSuccess=2]="SharingSuccess",e[e.EndSharing=3]="EndSharing",e[e.Unjoin=4]="Unjoin",e[e.AttemptJoining=5]="AttemptJoining",e[e.JoiningError=6]="JoiningError",e[e.JoiningPendingReload=7]="JoiningPendingReload",e[e.JoiningSuccess=8]="JoiningSuccess",e[e.AttemptSignIn=9]="AttemptSignIn",e[e.AwaitExternalSignIn=10]="AwaitExternalSignIn",e[e.SignInError=11]="SignInError",e[e.SignInSuccess=12]="SignInSuccess",e[e.SignOut=13]="SignOut",e[e.Create=14]="Create"}(t.SessionAction||(t.SessionAction={})),function(e){e[e.EnvironmentReadyForFileOperation=0]="EnvironmentReadyForFileOperation",e[e.JoiningCompleted=1]="JoiningCompleted"}(t.SessionPromise||(t.SessionPromise={}))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(5),r=n(13),o=n(15),a=n(18),c=n(26),l=n(9),u=n(16),d=n(7),h=n(29),f=n(42),p=n(7),m=n(60),g={location:i.ProgressLocation.Window,title:""},y=Object.assign(Object.assign({},g),{isUserInitiated:!0});class v{static init(e,t,n){v.extensionContext=e,v._extensionId=n,d.traceSource.info("Extension, IDE, OS : "+v.clientInfoToString(t)),l.Telemetry.addFilter(new l.SendOnceFilter(u.TelemetryEventNames.UNHANDLED_REJECTION_FAULT,[l.TelemetryPropertyNames.EVENT_MESSAGE]))}static getPackage(){return v.getPackageExtension(v._extensionId)}static getPackageExtension(e){const t=i.extensions.getExtension(e);if(t)return t.packageJSON}static get extensionId(){return v._extensionId}static get context(){if(!v.extensionContext)throw new Error("Extension context not initialized");return v.extensionContext}static get enableModalNotifications(){return!e.env.VSLS_TEST_DISABLE_MODAL}static async setCommandContext(e,t){v.contextValues[e]=t,await i.commands.executeCommand("setContext",e,t)}static getCommandContext(e){return v.contextValues[e]}static getErrorString(e){switch(e){case s.vsls.ErrorCodes.CouldNotConnectToServer:return c.localize("error.CouldNotConnectToServer");case s.vsls.ErrorCodes.OlderThanServer:return c.localize("error.OlderThanServer").replace("$(shortName)",r.Settings.get(o.SettingKeys.shortName));case s.vsls.ErrorCodes.NewerThanServer:return c.localize("error.NewerThanServer").replace("$(shortName)",r.Settings.get(o.SettingKeys.shortName));case s.vsls.ErrorCodes.OlderThanPeer:return c.localize("error.OlderThanPeer").replace("$(shortName)",r.Settings.get(o.SettingKeys.shortName));case s.vsls.ErrorCodes.NewerThanPeer:return c.localize("error.NewerThanPeer").replace("$(shortName)",r.Settings.get(o.SettingKeys.shortName));case s.vsls.ErrorCodes.OlderThanAgent:return c.localize("error.OlderThanAgent").replace("$(shortName)",r.Settings.get(o.SettingKeys.shortName));case s.vsls.ErrorCodes.NewerThanAgent:return c.localize("error.NewerThanAgent").replace("$(shortName)",r.Settings.get(o.SettingKeys.shortName));case s.vsls.ErrorCodes.NoIPAddressesDetected:return c.localize("error.NoIPAddressesDetected");case s.vsls.ErrorCodes.NoConnectionAddresses:return c.localize("error.NoConnectionAddresses");case s.vsls.ErrorCodes.AutoConnectionFailed:return c.localize("error.AutoConnectionFailed");case s.vsls.ErrorCodes.RelayConnectionFailed:return c.localize("error.RelayConnectionFailed");case s.vsls.ErrorCodes.DirectConnectionFailed:return c.localize("error.DirectConnectionFailed");case s.vsls.ErrorCodes.SessionProtocolError:return c.localize("error.SessionProtocolError").replace("$(shortName)",r.Settings.get(o.SettingKeys.shortName));case s.vsls.ErrorCodes.SessionAuthenticationFailed:return c.localize("error.SessionAuthenticationFailed");case s.vsls.ErrorCodes.DirectConnectionNotEnabled:return c.localize("error.DirectConnectionNotEnabled");case s.vsls.ErrorCodes.RelayConnectionNotEnabled:return c.localize("error.RelayConnectionNotEnabled");case s.vsls.ErrorCodes.CollaborationSessionUsersLimitReached:return c.localize("error.CollaborationSessionUsersLimitReached");case s.vsls.ErrorCodes.CollaborationSessionGuestRejected:return c.localize("error.CollaborationSessionGuestRejected");case s.vsls.ErrorCodes.CollaborationSessionRequestTimedOut:return c.localize("error.CollaborationSessionRequestTimedOut");case s.vsls.ErrorCodes.CollaborationSessionGuestCanceled:return c.localize("error.CollaborationSessionGuestCanceled");case s.vsls.ErrorCodes.CollaborationSessionNotFound:return c.localize("error.CollaborationSessionNotFound");case s.vsls.ErrorCodes.CollaborationSessionGuestBlocked:return c.localize("error.CollaborationSessionGuestBlocked");case s.vsls.ErrorCodes.NonSuccessHttpStatusCodeReceived:return c.localize("error.NonSuccessHttpStatusCodeReceived");case s.vsls.ErrorCodes.KeychainAccessFailed:return c.localize("error.KeychainAccessFailed");case s.vsls.ErrorCodes.RelayConnectionHostFailure:return c.localize("error.RelayConnectionHostFailure");case s.vsls.ErrorCodes.RelayConnectionGuestFailure:return c.localize("error.RelayConnectionGuestFailure");case s.vsls.ErrorCodes.RemoteLaunchNotEnabled:return c.localize("error.RemoteLaunchNotEnabled");case s.vsls.ErrorCodes.CouldNotConnectToServerAuthFailed:return c.localize("error.CouldNotConnectToServerAuthFailed");default:return""}}static getLocalizedProgressString(e){switch(e){case s.vsls.WorkspaceProgress.OpeningRemoteSession:return c.localize("progress.openingRemoteSession");case s.vsls.WorkspaceProgress.JoiningRemoteSession:return c.localize("progress.joiningRemoteSession");case s.vsls.WorkspaceProgress.WaitingForHost:return c.localize("progress.waitingForHost");case s.vsls.WorkspaceProgress.ReconnectingToHost:return c.localize("progress.reconnectingToHost");default:return""}}static getProgressUpdateString(e){return v.getLocalizedProgressString(e)}static getWaitingForHostProgressUpdateString(e,t){if(!t)return;let n=this.getLocalizedProgressString(e);if(n){const e=r.Settings.get(o.SettingKeys.anonymousUserName),i=t.isAnonymous&&e?e:t.displayName||t.emailAddress||"Unknown user";n=n.replace("$(userName)",i)}return n}static getWorkspaceFilePath(e){return a.join(e,`${r.Settings.get(o.SettingKeys.name)}.code-workspace`)}static async runWithProgress(e,t=y){const n=Object.assign(Object.assign({},y),t),{isUserInitiated:s,cancellationToken:r}=n;if(!r||!r.isCancellationRequested)return s||(n.title=""),await i.window.withProgress(n,async t=>new Promise(async(n,i)=>{r&&r.onCancellationRequested(()=>{n(null)});try{n(await e(t))}catch(e){i(e)}}))}static async showErrorAsync(e,t={},n=[]){const s=("string"==typeof e?e:e.code&&v.getErrorString(e.code)||e.message)||"Unknown error",{modal:r,hideReportAProblem:o}=t;if(o)return await i.window.showErrorMessage(s,{modal:r},...n);const a={title:"Report a Problem"},c=await i.window.showErrorMessage(s,{modal:r},a,...n);return c&&c.title===a.title&&this.reportIssue(),c}static async reportIssue(){const{name:e,publisher:t}=v.getPackage();await i.commands.executeCommand("vscode.openIssueReporter",`${t}.${e}`)}static registerCommand(e,t,n){return i.commands.registerCommand(e,(async function(...n){try{return new l.TelemetryEvent(u.TelemetryEventNames.COMMAND_INITIATED).addProperty("commandName",e).send(),await t.call(this,...n)}catch(t){v.reportCommandError(e,t)}}),n)}static addNewTreeViewItemAdornment(e,t){if(!e)return;let n=!1;const i=new Date,s=r.Settings.get(t);if(s){const e=new Date(s),t=new Date;t.setDate(i.getDate()-7),n=e>t}else r.Settings.save(t,i),n=!0;return e.tooltip=`${e.label} ${n?c.localize("treeView.newTooltip"):""}`,e.label=`${e.label}${n?"":""}`,e}static registerTextEditorCommand(e,t,n){return i.commands.registerTextEditorCommand(e,(function(n,i,...s){try{return t.call(this,n,i,...s)}catch(t){v.reportCommandError(e,t)}}),n)}static async tryRegisterCommand(e,t,n,i=!1,s=!1){let r=void 0;if(await v.isCommandDefined(e)){if(r=this.registeredCommands[e],!s)return r;if(r){const e=v.context.subscriptions.indexOf(r);e>=0&&v.context.subscriptions.splice(e,1),r.dispose()}}try{r=i?v.registerTextEditorCommand(e,t,n):v.registerCommand(e,t,n),v.registeredCommands[e]=r,v.context.subscriptions.push(r)}catch(e){console.error(e)}return r}static async isCommandDefined(e){return(await i.commands.getCommands()).indexOf(e)>=0}static disposeCommand(e){this.registeredCommands[e]&&(this.registeredCommands[e].dispose(),delete this.registeredCommands[e])}static clientInfoToString(e){let t="";return e?(e.extensionVersion&&(e.extensionName&&(t+=e.extensionName,t+="/"),t+=e.extensionVersion),e.applicationVersion&&(t.length>0&&(t+=" "),e.applicationName&&(t+=e.applicationName,t+="/"),t+=e.applicationVersion),e.platformVersion&&(t.length>0&&(t+=" "),e.platformName&&(t+=e.platformName,t+="/"),t+=e.platformVersion),t):t}static getExtensionVersion(e,t=!0){let n=v.getPackageExtension(e).version;return t||(n=n.replace(/-.*/,"")),n}static reportCommandError(e,t){const n=`Unhandled error in '${e}' command: `;d.traceSource.error(n,t),l.Telemetry.sendFault(u.TelemetryEventNames.UNHANDLED_COMMAND_ERROR_FAULT,l.FaultType.Error,n+t.message,t),v.showErrorAsync(t)}static getGlobalStoragePath(){return v.context.globalStoragePath||v.context.extensionPath}static openBrowser(t){e.env.VSLS_TEST_DISABLE_BROWSE?i.window.showInformationMessage("[OPEN] "+t):i.env.openExternal(i.Uri.parse(t))}static isNode(){return void 0!==e&&void 0!==e.release&&"node"===e.release.name}static getExtensionUri(e){return d.getExtensionUri(e,v.context)}static isReadWriteAnonymousEnabled(){var e;return null===(e=f.getExpService())||void 0===e?void 0:e.getTreatmentVariable("vscode","readWriteAnonymous")}static async getAnonymousReadOnlyLabel(e,t,n){if(!e)return"";const i=await e.isClientReadOnly(t.id),s=t.isAnonymous;let r,o=h.workspaceSessionInfoTracker.getAnonymousAccess(t.id),a=this.isReadWriteAnonymousEnabled()&&o===h.AnonymousAccessLevel.readWrite,l="";if(t.isHost)return l;if(n){const t=await e.isClientExplicitlyReadWrite(n);r=i&&!t&&!s}else r=i&&!s;return r?l=c.localize("guestNameViewlet.ReadOnlyLabel"):s&&(l=a?c.localize("guestNameViewlet.AnonymousReadWriteLabel"):c.localize("guestNameViewlet.ReadOnlyAndAnonymousLabel")),l}static async setTransientWorkspace(e){try{const t=i.workspace.workspaceFile.fsPath,n=JSON.parse((new TextDecoder).decode(p.fileAccess.readFileSync(t)));n.transient=e,p.fileAccess.writeFileAsync(t,JSON.stringify(n))}catch(e){m.assert(!1,"Setting transient workspace failed.")}}}t.ExtensionUtil=v,v.contextValues={},v.registeredCommands={}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(21),r=n(905),o=n(161);t.sessionStateTracker=new class{constructor(){this.stateChangedEmitter=new i.EventEmitter,this.onStateChanged=this.stateChangedEmitter.event,this.statusChangedEmitter=new i.EventEmitter,this.onStatusChanged=this.statusChangedEmitter.event,this.currentState=s.SessionState.Initializing,this.currentHigherState=void 0}get State(){return this.currentState}get HigherState(){return this.currentHigherState}transitionHigherState(e,t){e===s.SessionState.SharingInProgress||e===s.SessionState.JoiningInProgress||e===s.SessionState.Shared||e===s.SessionState.Joined?this.currentHigherState=e:t!==s.SessionAction.SharingError&&t!==s.SessionAction.JoiningError&&t!==s.SessionAction.EndSharing&&t!==s.SessionAction.Unjoin||(this.currentHigherState=void 0)}transition(e){const t=r.sessionMachine[this.State];if(t){let n=t[e];return void 0!==n?("function"==typeof n&&(n=n()),this.transitionHigherState(n,e),this.sendTransitionTelemetry(n,e),this.setState(n,e),this.State):void 0}}sendTransitionTelemetry(e,t){o.ExtensionTelemetry.sendTransition(s.SessionState[this.State],s.SessionState[e],s.SessionAction[t])}setState(e,t){const n=this.currentState,i=this.currentAction;this.currentState=e,this.currentAction=t,this.stateChangedEmitter.fire({newState:e,oldState:n,newAction:t,oldAction:i})}setStatus(e){const t=this.currentStatus;this.currentStatus=e,this.statusChangedEmitter.fire({newStatus:e,oldStatus:t})}point(e){void 0!==e&&this.setStatus(e)}},t.setSessionStateTracker=function(e){t.sessionStateTracker=e}},function(e,t,n){"use strict";var i,s="object"==typeof Reflect?Reflect:null,r=s&&"function"==typeof s.apply?s.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};i=s&&"function"==typeof s.ownKeys?s.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function l(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function d(e,t,n,i){var s,r,o,a;if(l(n),void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),r=e._events),o=r[t]),void 0===o)o=r[t]=n,++e._eventsCount;else if("function"==typeof o?o=r[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),(s=u(e))>0&&o.length>s&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,a=c,console&&console.warn&&console.warn(a)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},s=h.bind(i);return s.listener=n,i.wrapFn=s,s}function p(e,t,n){var i=e._events;if(void 0===i)return[];var s=i[t];return void 0===s?[]:"function"==typeof s?n?[s.listener||s]:[s]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(s):g(s,s.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else{var l=c.length,u=g(c,l);for(n=0;n<l;++n)r(u[n],this,t)}return!0},a.prototype.addListener=function(e,t){return d(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return d(this,e,t,!0)},a.prototype.once=function(e,t){return l(t),this.on(e,f(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return l(t),this.prependListener(e,f(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,i,s,r,o;if(l(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(s=-1,r=n.length-1;r>=0;r--)if(n[r]===t||n[r].listener===t){o=n[r].listener,s=r;break}if(s<0)return this;0===s?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,s),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var s,r=Object.keys(n);for(i=0;i<r.length;++i)"removeListener"!==(s=r[i])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},a.prototype.listeners=function(e){return p(this,e,!0)},a.prototype.rawListeners=function(e){return p(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(e,t,n){(function(e){!function(e,t){"use strict";function i(e,t){if(!e)throw new Error(t||"Assertion failed")}function s(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}function r(e,t,n){if(r.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(n=t,t=10),this._init(e||0,t||10,n||"be"))}var o;"object"==typeof e?e.exports=r:t.BN=r,r.BN=r,r.wordSize=26;try{o=n(772).Buffer}catch(e){}function a(e,t,n){for(var i=0,s=Math.min(e.length,n),r=t;r<s;r++){var o=e.charCodeAt(r)-48;i<<=4,i|=o>=49&&o<=54?o-49+10:o>=17&&o<=22?o-17+10:15&o}return i}function c(e,t,n,i){for(var s=0,r=Math.min(e.length,n),o=t;o<r;o++){var a=e.charCodeAt(o)-48;s*=i,s+=a>=49?a-49+10:a>=17?a-17+10:a}return s}r.isBN=function(e){return e instanceof r||null!==e&&"object"==typeof e&&e.constructor.wordSize===r.wordSize&&Array.isArray(e.words)},r.max=function(e,t){return e.cmp(t)>0?e:t},r.min=function(e,t){return e.cmp(t)<0?e:t},r.prototype._init=function(e,t,n){if("number"==typeof e)return this._initNumber(e,t,n);if("object"==typeof e)return this._initArray(e,t,n);"hex"===t&&(t=16),i(t===(0|t)&&t>=2&&t<=36);var s=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&s++,16===t?this._parseHex(e,s):this._parseBase(e,t,s),"-"===e[0]&&(this.negative=1),this.strip(),"le"===n&&this._initArray(this.toArray(),t,n)},r.prototype._initNumber=function(e,t,n){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(i(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===n&&this._initArray(this.toArray(),t,n)},r.prototype._initArray=function(e,t,n){if(i("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var s=0;s<this.length;s++)this.words[s]=0;var r,o,a=0;if("be"===n)for(s=e.length-1,r=0;s>=0;s-=3)o=e[s]|e[s-1]<<8|e[s-2]<<16,this.words[r]|=o<<a&67108863,this.words[r+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,r++);else if("le"===n)for(s=0,r=0;s<e.length;s+=3)o=e[s]|e[s+1]<<8|e[s+2]<<16,this.words[r]|=o<<a&67108863,this.words[r+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,r++);return this.strip()},r.prototype._parseHex=function(e,t){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,s,r=0;for(n=e.length-6,i=0;n>=t;n-=6)s=a(e,n,n+6),this.words[i]|=s<<r&67108863,this.words[i+1]|=s>>>26-r&4194303,(r+=24)>=26&&(r-=26,i++);n+6!==t&&(s=a(e,t,n+6),this.words[i]|=s<<r&67108863,this.words[i+1]|=s>>>26-r&4194303),this.strip()},r.prototype._parseBase=function(e,t,n){this.words=[0],this.length=1;for(var i=0,s=1;s<=67108863;s*=t)i++;i--,s=s/t|0;for(var r=e.length-n,o=r%i,a=Math.min(r,r-o)+n,l=0,u=n;u<a;u+=i)l=c(e,u,u+i,t),this.imuln(s),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l);if(0!==o){var d=1;for(l=c(e,u,e.length,t),u=0;u<o;u++)d*=t;this.imuln(d),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l)}},r.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},r.prototype.clone=function(){var e=new r(null);return this.copy(e),e},r.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},r.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},r.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},r.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],u=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],d=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function h(e,t,n){n.negative=t.negative^e.negative;var i=e.length+t.length|0;n.length=i,i=i-1|0;var s=0|e.words[0],r=0|t.words[0],o=s*r,a=67108863&o,c=o/67108864|0;n.words[0]=a;for(var l=1;l<i;l++){for(var u=c>>>26,d=67108863&c,h=Math.min(l,t.length-1),f=Math.max(0,l-e.length+1);f<=h;f++){var p=l-f|0;u+=(o=(s=0|e.words[p])*(r=0|t.words[f])+d)/67108864|0,d=67108863&o}n.words[l]=0|d,c=0|u}return 0!==c?n.words[l]=0|c:n.length--,n.strip()}r.prototype.toString=function(e,t){var n;if(t=0|t||1,16===(e=e||10)||"hex"===e){n="";for(var s=0,r=0,o=0;o<this.length;o++){var a=this.words[o],c=(16777215&(a<<s|r)).toString(16);n=0!==(r=a>>>24-s&16777215)||o!==this.length-1?l[6-c.length]+c+n:c+n,(s+=2)>=26&&(s-=26,o--)}for(0!==r&&(n=r.toString(16)+n);n.length%t!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}if(e===(0|e)&&e>=2&&e<=36){var h=u[e],f=d[e];n="";var p=this.clone();for(p.negative=0;!p.isZero();){var m=p.modn(f).toString(e);n=(p=p.idivn(f)).isZero()?m+n:l[h-m.length]+m+n}for(this.isZero()&&(n="0"+n);n.length%t!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}i(!1,"Base should be between 2 and 36")},r.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},r.prototype.toJSON=function(){return this.toString(16)},r.prototype.toBuffer=function(e,t){return i(void 0!==o),this.toArrayLike(o,e,t)},r.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},r.prototype.toArrayLike=function(e,t,n){var s=this.byteLength(),r=n||Math.max(1,s);i(s<=r,"byte array longer than desired length"),i(r>0,"Requested array length <= 0"),this.strip();var o,a,c="le"===t,l=new e(r),u=this.clone();if(c){for(a=0;!u.isZero();a++)o=u.andln(255),u.iushrn(8),l[a]=o;for(;a<r;a++)l[a]=0}else{for(a=0;a<r-s;a++)l[a]=0;for(a=0;!u.isZero();a++)o=u.andln(255),u.iushrn(8),l[r-a-1]=o}return l},Math.clz32?r.prototype._countBits=function(e){return 32-Math.clz32(e)}:r.prototype._countBits=function(e){var t=e,n=0;return t>=4096&&(n+=13,t>>>=13),t>=64&&(n+=7,t>>>=7),t>=8&&(n+=4,t>>>=4),t>=2&&(n+=2,t>>>=2),n+t},r.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,n=0;return 0==(8191&t)&&(n+=13,t>>>=13),0==(127&t)&&(n+=7,t>>>=7),0==(15&t)&&(n+=4,t>>>=4),0==(3&t)&&(n+=2,t>>>=2),0==(1&t)&&n++,n},r.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},r.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var n=this._zeroBits(this.words[t]);if(e+=n,26!==n)break}return e},r.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},r.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},r.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},r.prototype.isNeg=function(){return 0!==this.negative},r.prototype.neg=function(){return this.clone().ineg()},r.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},r.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},r.prototype.ior=function(e){return i(0==(this.negative|e.negative)),this.iuor(e)},r.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},r.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},r.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var n=0;n<t.length;n++)this.words[n]=this.words[n]&e.words[n];return this.length=t.length,this.strip()},r.prototype.iand=function(e){return i(0==(this.negative|e.negative)),this.iuand(e)},r.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},r.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},r.prototype.iuxor=function(e){var t,n;this.length>e.length?(t=this,n=e):(t=e,n=this);for(var i=0;i<n.length;i++)this.words[i]=t.words[i]^n.words[i];if(this!==t)for(;i<t.length;i++)this.words[i]=t.words[i];return this.length=t.length,this.strip()},r.prototype.ixor=function(e){return i(0==(this.negative|e.negative)),this.iuxor(e)},r.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},r.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},r.prototype.inotn=function(e){i("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),n=e%26;this._expand(t),n>0&&t--;for(var s=0;s<t;s++)this.words[s]=67108863&~this.words[s];return n>0&&(this.words[s]=~this.words[s]&67108863>>26-n),this.strip()},r.prototype.notn=function(e){return this.clone().inotn(e)},r.prototype.setn=function(e,t){i("number"==typeof e&&e>=0);var n=e/26|0,s=e%26;return this._expand(n+1),this.words[n]=t?this.words[n]|1<<s:this.words[n]&~(1<<s),this.strip()},r.prototype.iadd=function(e){var t,n,i;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(n=this,i=e):(n=e,i=this);for(var s=0,r=0;r<i.length;r++)t=(0|n.words[r])+(0|i.words[r])+s,this.words[r]=67108863&t,s=t>>>26;for(;0!==s&&r<n.length;r++)t=(0|n.words[r])+s,this.words[r]=67108863&t,s=t>>>26;if(this.length=n.length,0!==s)this.words[this.length]=s,this.length++;else if(n!==this)for(;r<n.length;r++)this.words[r]=n.words[r];return this},r.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},r.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var n,i,s=this.cmp(e);if(0===s)return this.negative=0,this.length=1,this.words[0]=0,this;s>0?(n=this,i=e):(n=e,i=this);for(var r=0,o=0;o<i.length;o++)r=(t=(0|n.words[o])-(0|i.words[o])+r)>>26,this.words[o]=67108863&t;for(;0!==r&&o<n.length;o++)r=(t=(0|n.words[o])+r)>>26,this.words[o]=67108863&t;if(0===r&&o<n.length&&n!==this)for(;o<n.length;o++)this.words[o]=n.words[o];return this.length=Math.max(this.length,o),n!==this&&(this.negative=1),this.strip()},r.prototype.sub=function(e){return this.clone().isub(e)};var f=function(e,t,n){var i,s,r,o=e.words,a=t.words,c=n.words,l=0,u=0|o[0],d=8191&u,h=u>>>13,f=0|o[1],p=8191&f,m=f>>>13,g=0|o[2],y=8191&g,v=g>>>13,S=0|o[3],_=8191&S,E=S>>>13,w=0|o[4],b=8191&w,C=w>>>13,T=0|o[5],M=8191&T,A=T>>>13,k=0|o[6],R=8191&k,P=k>>>13,I=0|o[7],N=8191&I,L=I>>>13,D=0|o[8],x=8191&D,O=D>>>13,F=0|o[9],U=8191&F,j=F>>>13,H=0|a[0],B=8191&H,Y=H>>>13,W=0|a[1],q=8191&W,V=W>>>13,$=0|a[2],K=8191&$,z=$>>>13,G=0|a[3],J=8191&G,X=G>>>13,Z=0|a[4],Q=8191&Z,ee=Z>>>13,te=0|a[5],ne=8191&te,ie=te>>>13,se=0|a[6],re=8191&se,oe=se>>>13,ae=0|a[7],ce=8191&ae,le=ae>>>13,ue=0|a[8],de=8191&ue,he=ue>>>13,fe=0|a[9],pe=8191&fe,me=fe>>>13;n.negative=e.negative^t.negative,n.length=19;var ge=(l+(i=Math.imul(d,B))|0)+((8191&(s=(s=Math.imul(d,Y))+Math.imul(h,B)|0))<<13)|0;l=((r=Math.imul(h,Y))+(s>>>13)|0)+(ge>>>26)|0,ge&=67108863,i=Math.imul(p,B),s=(s=Math.imul(p,Y))+Math.imul(m,B)|0,r=Math.imul(m,Y);var ye=(l+(i=i+Math.imul(d,q)|0)|0)+((8191&(s=(s=s+Math.imul(d,V)|0)+Math.imul(h,q)|0))<<13)|0;l=((r=r+Math.imul(h,V)|0)+(s>>>13)|0)+(ye>>>26)|0,ye&=67108863,i=Math.imul(y,B),s=(s=Math.imul(y,Y))+Math.imul(v,B)|0,r=Math.imul(v,Y),i=i+Math.imul(p,q)|0,s=(s=s+Math.imul(p,V)|0)+Math.imul(m,q)|0,r=r+Math.imul(m,V)|0;var ve=(l+(i=i+Math.imul(d,K)|0)|0)+((8191&(s=(s=s+Math.imul(d,z)|0)+Math.imul(h,K)|0))<<13)|0;l=((r=r+Math.imul(h,z)|0)+(s>>>13)|0)+(ve>>>26)|0,ve&=67108863,i=Math.imul(_,B),s=(s=Math.imul(_,Y))+Math.imul(E,B)|0,r=Math.imul(E,Y),i=i+Math.imul(y,q)|0,s=(s=s+Math.imul(y,V)|0)+Math.imul(v,q)|0,r=r+Math.imul(v,V)|0,i=i+Math.imul(p,K)|0,s=(s=s+Math.imul(p,z)|0)+Math.imul(m,K)|0,r=r+Math.imul(m,z)|0;var Se=(l+(i=i+Math.imul(d,J)|0)|0)+((8191&(s=(s=s+Math.imul(d,X)|0)+Math.imul(h,J)|0))<<13)|0;l=((r=r+Math.imul(h,X)|0)+(s>>>13)|0)+(Se>>>26)|0,Se&=67108863,i=Math.imul(b,B),s=(s=Math.imul(b,Y))+Math.imul(C,B)|0,r=Math.imul(C,Y),i=i+Math.imul(_,q)|0,s=(s=s+Math.imul(_,V)|0)+Math.imul(E,q)|0,r=r+Math.imul(E,V)|0,i=i+Math.imul(y,K)|0,s=(s=s+Math.imul(y,z)|0)+Math.imul(v,K)|0,r=r+Math.imul(v,z)|0,i=i+Math.imul(p,J)|0,s=(s=s+Math.imul(p,X)|0)+Math.imul(m,J)|0,r=r+Math.imul(m,X)|0;var _e=(l+(i=i+Math.imul(d,Q)|0)|0)+((8191&(s=(s=s+Math.imul(d,ee)|0)+Math.imul(h,Q)|0))<<13)|0;l=((r=r+Math.imul(h,ee)|0)+(s>>>13)|0)+(_e>>>26)|0,_e&=67108863,i=Math.imul(M,B),s=(s=Math.imul(M,Y))+Math.imul(A,B)|0,r=Math.imul(A,Y),i=i+Math.imul(b,q)|0,s=(s=s+Math.imul(b,V)|0)+Math.imul(C,q)|0,r=r+Math.imul(C,V)|0,i=i+Math.imul(_,K)|0,s=(s=s+Math.imul(_,z)|0)+Math.imul(E,K)|0,r=r+Math.imul(E,z)|0,i=i+Math.imul(y,J)|0,s=(s=s+Math.imul(y,X)|0)+Math.imul(v,J)|0,r=r+Math.imul(v,X)|0,i=i+Math.imul(p,Q)|0,s=(s=s+Math.imul(p,ee)|0)+Math.imul(m,Q)|0,r=r+Math.imul(m,ee)|0;var Ee=(l+(i=i+Math.imul(d,ne)|0)|0)+((8191&(s=(s=s+Math.imul(d,ie)|0)+Math.imul(h,ne)|0))<<13)|0;l=((r=r+Math.imul(h,ie)|0)+(s>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,i=Math.imul(R,B),s=(s=Math.imul(R,Y))+Math.imul(P,B)|0,r=Math.imul(P,Y),i=i+Math.imul(M,q)|0,s=(s=s+Math.imul(M,V)|0)+Math.imul(A,q)|0,r=r+Math.imul(A,V)|0,i=i+Math.imul(b,K)|0,s=(s=s+Math.imul(b,z)|0)+Math.imul(C,K)|0,r=r+Math.imul(C,z)|0,i=i+Math.imul(_,J)|0,s=(s=s+Math.imul(_,X)|0)+Math.imul(E,J)|0,r=r+Math.imul(E,X)|0,i=i+Math.imul(y,Q)|0,s=(s=s+Math.imul(y,ee)|0)+Math.imul(v,Q)|0,r=r+Math.imul(v,ee)|0,i=i+Math.imul(p,ne)|0,s=(s=s+Math.imul(p,ie)|0)+Math.imul(m,ne)|0,r=r+Math.imul(m,ie)|0;var we=(l+(i=i+Math.imul(d,re)|0)|0)+((8191&(s=(s=s+Math.imul(d,oe)|0)+Math.imul(h,re)|0))<<13)|0;l=((r=r+Math.imul(h,oe)|0)+(s>>>13)|0)+(we>>>26)|0,we&=67108863,i=Math.imul(N,B),s=(s=Math.imul(N,Y))+Math.imul(L,B)|0,r=Math.imul(L,Y),i=i+Math.imul(R,q)|0,s=(s=s+Math.imul(R,V)|0)+Math.imul(P,q)|0,r=r+Math.imul(P,V)|0,i=i+Math.imul(M,K)|0,s=(s=s+Math.imul(M,z)|0)+Math.imul(A,K)|0,r=r+Math.imul(A,z)|0,i=i+Math.imul(b,J)|0,s=(s=s+Math.imul(b,X)|0)+Math.imul(C,J)|0,r=r+Math.imul(C,X)|0,i=i+Math.imul(_,Q)|0,s=(s=s+Math.imul(_,ee)|0)+Math.imul(E,Q)|0,r=r+Math.imul(E,ee)|0,i=i+Math.imul(y,ne)|0,s=(s=s+Math.imul(y,ie)|0)+Math.imul(v,ne)|0,r=r+Math.imul(v,ie)|0,i=i+Math.imul(p,re)|0,s=(s=s+Math.imul(p,oe)|0)+Math.imul(m,re)|0,r=r+Math.imul(m,oe)|0;var be=(l+(i=i+Math.imul(d,ce)|0)|0)+((8191&(s=(s=s+Math.imul(d,le)|0)+Math.imul(h,ce)|0))<<13)|0;l=((r=r+Math.imul(h,le)|0)+(s>>>13)|0)+(be>>>26)|0,be&=67108863,i=Math.imul(x,B),s=(s=Math.imul(x,Y))+Math.imul(O,B)|0,r=Math.imul(O,Y),i=i+Math.imul(N,q)|0,s=(s=s+Math.imul(N,V)|0)+Math.imul(L,q)|0,r=r+Math.imul(L,V)|0,i=i+Math.imul(R,K)|0,s=(s=s+Math.imul(R,z)|0)+Math.imul(P,K)|0,r=r+Math.imul(P,z)|0,i=i+Math.imul(M,J)|0,s=(s=s+Math.imul(M,X)|0)+Math.imul(A,J)|0,r=r+Math.imul(A,X)|0,i=i+Math.imul(b,Q)|0,s=(s=s+Math.imul(b,ee)|0)+Math.imul(C,Q)|0,r=r+Math.imul(C,ee)|0,i=i+Math.imul(_,ne)|0,s=(s=s+Math.imul(_,ie)|0)+Math.imul(E,ne)|0,r=r+Math.imul(E,ie)|0,i=i+Math.imul(y,re)|0,s=(s=s+Math.imul(y,oe)|0)+Math.imul(v,re)|0,r=r+Math.imul(v,oe)|0,i=i+Math.imul(p,ce)|0,s=(s=s+Math.imul(p,le)|0)+Math.imul(m,ce)|0,r=r+Math.imul(m,le)|0;var Ce=(l+(i=i+Math.imul(d,de)|0)|0)+((8191&(s=(s=s+Math.imul(d,he)|0)+Math.imul(h,de)|0))<<13)|0;l=((r=r+Math.imul(h,he)|0)+(s>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,i=Math.imul(U,B),s=(s=Math.imul(U,Y))+Math.imul(j,B)|0,r=Math.imul(j,Y),i=i+Math.imul(x,q)|0,s=(s=s+Math.imul(x,V)|0)+Math.imul(O,q)|0,r=r+Math.imul(O,V)|0,i=i+Math.imul(N,K)|0,s=(s=s+Math.imul(N,z)|0)+Math.imul(L,K)|0,r=r+Math.imul(L,z)|0,i=i+Math.imul(R,J)|0,s=(s=s+Math.imul(R,X)|0)+Math.imul(P,J)|0,r=r+Math.imul(P,X)|0,i=i+Math.imul(M,Q)|0,s=(s=s+Math.imul(M,ee)|0)+Math.imul(A,Q)|0,r=r+Math.imul(A,ee)|0,i=i+Math.imul(b,ne)|0,s=(s=s+Math.imul(b,ie)|0)+Math.imul(C,ne)|0,r=r+Math.imul(C,ie)|0,i=i+Math.imul(_,re)|0,s=(s=s+Math.imul(_,oe)|0)+Math.imul(E,re)|0,r=r+Math.imul(E,oe)|0,i=i+Math.imul(y,ce)|0,s=(s=s+Math.imul(y,le)|0)+Math.imul(v,ce)|0,r=r+Math.imul(v,le)|0,i=i+Math.imul(p,de)|0,s=(s=s+Math.imul(p,he)|0)+Math.imul(m,de)|0,r=r+Math.imul(m,he)|0;var Te=(l+(i=i+Math.imul(d,pe)|0)|0)+((8191&(s=(s=s+Math.imul(d,me)|0)+Math.imul(h,pe)|0))<<13)|0;l=((r=r+Math.imul(h,me)|0)+(s>>>13)|0)+(Te>>>26)|0,Te&=67108863,i=Math.imul(U,q),s=(s=Math.imul(U,V))+Math.imul(j,q)|0,r=Math.imul(j,V),i=i+Math.imul(x,K)|0,s=(s=s+Math.imul(x,z)|0)+Math.imul(O,K)|0,r=r+Math.imul(O,z)|0,i=i+Math.imul(N,J)|0,s=(s=s+Math.imul(N,X)|0)+Math.imul(L,J)|0,r=r+Math.imul(L,X)|0,i=i+Math.imul(R,Q)|0,s=(s=s+Math.imul(R,ee)|0)+Math.imul(P,Q)|0,r=r+Math.imul(P,ee)|0,i=i+Math.imul(M,ne)|0,s=(s=s+Math.imul(M,ie)|0)+Math.imul(A,ne)|0,r=r+Math.imul(A,ie)|0,i=i+Math.imul(b,re)|0,s=(s=s+Math.imul(b,oe)|0)+Math.imul(C,re)|0,r=r+Math.imul(C,oe)|0,i=i+Math.imul(_,ce)|0,s=(s=s+Math.imul(_,le)|0)+Math.imul(E,ce)|0,r=r+Math.imul(E,le)|0,i=i+Math.imul(y,de)|0,s=(s=s+Math.imul(y,he)|0)+Math.imul(v,de)|0,r=r+Math.imul(v,he)|0;var Me=(l+(i=i+Math.imul(p,pe)|0)|0)+((8191&(s=(s=s+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;l=((r=r+Math.imul(m,me)|0)+(s>>>13)|0)+(Me>>>26)|0,Me&=67108863,i=Math.imul(U,K),s=(s=Math.imul(U,z))+Math.imul(j,K)|0,r=Math.imul(j,z),i=i+Math.imul(x,J)|0,s=(s=s+Math.imul(x,X)|0)+Math.imul(O,J)|0,r=r+Math.imul(O,X)|0,i=i+Math.imul(N,Q)|0,s=(s=s+Math.imul(N,ee)|0)+Math.imul(L,Q)|0,r=r+Math.imul(L,ee)|0,i=i+Math.imul(R,ne)|0,s=(s=s+Math.imul(R,ie)|0)+Math.imul(P,ne)|0,r=r+Math.imul(P,ie)|0,i=i+Math.imul(M,re)|0,s=(s=s+Math.imul(M,oe)|0)+Math.imul(A,re)|0,r=r+Math.imul(A,oe)|0,i=i+Math.imul(b,ce)|0,s=(s=s+Math.imul(b,le)|0)+Math.imul(C,ce)|0,r=r+Math.imul(C,le)|0,i=i+Math.imul(_,de)|0,s=(s=s+Math.imul(_,he)|0)+Math.imul(E,de)|0,r=r+Math.imul(E,he)|0;var Ae=(l+(i=i+Math.imul(y,pe)|0)|0)+((8191&(s=(s=s+Math.imul(y,me)|0)+Math.imul(v,pe)|0))<<13)|0;l=((r=r+Math.imul(v,me)|0)+(s>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,i=Math.imul(U,J),s=(s=Math.imul(U,X))+Math.imul(j,J)|0,r=Math.imul(j,X),i=i+Math.imul(x,Q)|0,s=(s=s+Math.imul(x,ee)|0)+Math.imul(O,Q)|0,r=r+Math.imul(O,ee)|0,i=i+Math.imul(N,ne)|0,s=(s=s+Math.imul(N,ie)|0)+Math.imul(L,ne)|0,r=r+Math.imul(L,ie)|0,i=i+Math.imul(R,re)|0,s=(s=s+Math.imul(R,oe)|0)+Math.imul(P,re)|0,r=r+Math.imul(P,oe)|0,i=i+Math.imul(M,ce)|0,s=(s=s+Math.imul(M,le)|0)+Math.imul(A,ce)|0,r=r+Math.imul(A,le)|0,i=i+Math.imul(b,de)|0,s=(s=s+Math.imul(b,he)|0)+Math.imul(C,de)|0,r=r+Math.imul(C,he)|0;var ke=(l+(i=i+Math.imul(_,pe)|0)|0)+((8191&(s=(s=s+Math.imul(_,me)|0)+Math.imul(E,pe)|0))<<13)|0;l=((r=r+Math.imul(E,me)|0)+(s>>>13)|0)+(ke>>>26)|0,ke&=67108863,i=Math.imul(U,Q),s=(s=Math.imul(U,ee))+Math.imul(j,Q)|0,r=Math.imul(j,ee),i=i+Math.imul(x,ne)|0,s=(s=s+Math.imul(x,ie)|0)+Math.imul(O,ne)|0,r=r+Math.imul(O,ie)|0,i=i+Math.imul(N,re)|0,s=(s=s+Math.imul(N,oe)|0)+Math.imul(L,re)|0,r=r+Math.imul(L,oe)|0,i=i+Math.imul(R,ce)|0,s=(s=s+Math.imul(R,le)|0)+Math.imul(P,ce)|0,r=r+Math.imul(P,le)|0,i=i+Math.imul(M,de)|0,s=(s=s+Math.imul(M,he)|0)+Math.imul(A,de)|0,r=r+Math.imul(A,he)|0;var Re=(l+(i=i+Math.imul(b,pe)|0)|0)+((8191&(s=(s=s+Math.imul(b,me)|0)+Math.imul(C,pe)|0))<<13)|0;l=((r=r+Math.imul(C,me)|0)+(s>>>13)|0)+(Re>>>26)|0,Re&=67108863,i=Math.imul(U,ne),s=(s=Math.imul(U,ie))+Math.imul(j,ne)|0,r=Math.imul(j,ie),i=i+Math.imul(x,re)|0,s=(s=s+Math.imul(x,oe)|0)+Math.imul(O,re)|0,r=r+Math.imul(O,oe)|0,i=i+Math.imul(N,ce)|0,s=(s=s+Math.imul(N,le)|0)+Math.imul(L,ce)|0,r=r+Math.imul(L,le)|0,i=i+Math.imul(R,de)|0,s=(s=s+Math.imul(R,he)|0)+Math.imul(P,de)|0,r=r+Math.imul(P,he)|0;var Pe=(l+(i=i+Math.imul(M,pe)|0)|0)+((8191&(s=(s=s+Math.imul(M,me)|0)+Math.imul(A,pe)|0))<<13)|0;l=((r=r+Math.imul(A,me)|0)+(s>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,i=Math.imul(U,re),s=(s=Math.imul(U,oe))+Math.imul(j,re)|0,r=Math.imul(j,oe),i=i+Math.imul(x,ce)|0,s=(s=s+Math.imul(x,le)|0)+Math.imul(O,ce)|0,r=r+Math.imul(O,le)|0,i=i+Math.imul(N,de)|0,s=(s=s+Math.imul(N,he)|0)+Math.imul(L,de)|0,r=r+Math.imul(L,he)|0;var Ie=(l+(i=i+Math.imul(R,pe)|0)|0)+((8191&(s=(s=s+Math.imul(R,me)|0)+Math.imul(P,pe)|0))<<13)|0;l=((r=r+Math.imul(P,me)|0)+(s>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,i=Math.imul(U,ce),s=(s=Math.imul(U,le))+Math.imul(j,ce)|0,r=Math.imul(j,le),i=i+Math.imul(x,de)|0,s=(s=s+Math.imul(x,he)|0)+Math.imul(O,de)|0,r=r+Math.imul(O,he)|0;var Ne=(l+(i=i+Math.imul(N,pe)|0)|0)+((8191&(s=(s=s+Math.imul(N,me)|0)+Math.imul(L,pe)|0))<<13)|0;l=((r=r+Math.imul(L,me)|0)+(s>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,i=Math.imul(U,de),s=(s=Math.imul(U,he))+Math.imul(j,de)|0,r=Math.imul(j,he);var Le=(l+(i=i+Math.imul(x,pe)|0)|0)+((8191&(s=(s=s+Math.imul(x,me)|0)+Math.imul(O,pe)|0))<<13)|0;l=((r=r+Math.imul(O,me)|0)+(s>>>13)|0)+(Le>>>26)|0,Le&=67108863;var De=(l+(i=Math.imul(U,pe))|0)+((8191&(s=(s=Math.imul(U,me))+Math.imul(j,pe)|0))<<13)|0;return l=((r=Math.imul(j,me))+(s>>>13)|0)+(De>>>26)|0,De&=67108863,c[0]=ge,c[1]=ye,c[2]=ve,c[3]=Se,c[4]=_e,c[5]=Ee,c[6]=we,c[7]=be,c[8]=Ce,c[9]=Te,c[10]=Me,c[11]=Ae,c[12]=ke,c[13]=Re,c[14]=Pe,c[15]=Ie,c[16]=Ne,c[17]=Le,c[18]=De,0!==l&&(c[19]=l,n.length++),n};function p(e,t,n){return(new m).mulp(e,t,n)}function m(e,t){this.x=e,this.y=t}Math.imul||(f=h),r.prototype.mulTo=function(e,t){var n=this.length+e.length;return 10===this.length&&10===e.length?f(this,e,t):n<63?h(this,e,t):n<1024?function(e,t,n){n.negative=t.negative^e.negative,n.length=e.length+t.length;for(var i=0,s=0,r=0;r<n.length-1;r++){var o=s;s=0;for(var a=67108863&i,c=Math.min(r,t.length-1),l=Math.max(0,r-e.length+1);l<=c;l++){var u=r-l,d=(0|e.words[u])*(0|t.words[l]),h=67108863&d;a=67108863&(h=h+a|0),s+=(o=(o=o+(d/67108864|0)|0)+(h>>>26)|0)>>>26,o&=67108863}n.words[r]=a,i=o,o=s}return 0!==i?n.words[r]=i:n.length--,n.strip()}(this,e,t):p(this,e,t)},m.prototype.makeRBT=function(e){for(var t=new Array(e),n=r.prototype._countBits(e)-1,i=0;i<e;i++)t[i]=this.revBin(i,n,e);return t},m.prototype.revBin=function(e,t,n){if(0===e||e===n-1)return e;for(var i=0,s=0;s<t;s++)i|=(1&e)<<t-s-1,e>>=1;return i},m.prototype.permute=function(e,t,n,i,s,r){for(var o=0;o<r;o++)i[o]=t[e[o]],s[o]=n[e[o]]},m.prototype.transform=function(e,t,n,i,s,r){this.permute(r,e,t,n,i,s);for(var o=1;o<s;o<<=1)for(var a=o<<1,c=Math.cos(2*Math.PI/a),l=Math.sin(2*Math.PI/a),u=0;u<s;u+=a)for(var d=c,h=l,f=0;f<o;f++){var p=n[u+f],m=i[u+f],g=n[u+f+o],y=i[u+f+o],v=d*g-h*y;y=d*y+h*g,g=v,n[u+f]=p+g,i[u+f]=m+y,n[u+f+o]=p-g,i[u+f+o]=m-y,f!==a&&(v=c*d-l*h,h=c*h+l*d,d=v)}},m.prototype.guessLen13b=function(e,t){var n=1|Math.max(t,e),i=1&n,s=0;for(n=n/2|0;n;n>>>=1)s++;return 1<<s+1+i},m.prototype.conjugate=function(e,t,n){if(!(n<=1))for(var i=0;i<n/2;i++){var s=e[i];e[i]=e[n-i-1],e[n-i-1]=s,s=t[i],t[i]=-t[n-i-1],t[n-i-1]=-s}},m.prototype.normalize13b=function(e,t){for(var n=0,i=0;i<t/2;i++){var s=8192*Math.round(e[2*i+1]/t)+Math.round(e[2*i]/t)+n;e[i]=67108863&s,n=s<67108864?0:s/67108864|0}return e},m.prototype.convert13b=function(e,t,n,s){for(var r=0,o=0;o<t;o++)r+=0|e[o],n[2*o]=8191&r,r>>>=13,n[2*o+1]=8191&r,r>>>=13;for(o=2*t;o<s;++o)n[o]=0;i(0===r),i(0==(-8192&r))},m.prototype.stub=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=0;return t},m.prototype.mulp=function(e,t,n){var i=2*this.guessLen13b(e.length,t.length),s=this.makeRBT(i),r=this.stub(i),o=new Array(i),a=new Array(i),c=new Array(i),l=new Array(i),u=new Array(i),d=new Array(i),h=n.words;h.length=i,this.convert13b(e.words,e.length,o,i),this.convert13b(t.words,t.length,l,i),this.transform(o,r,a,c,i,s),this.transform(l,r,u,d,i,s);for(var f=0;f<i;f++){var p=a[f]*u[f]-c[f]*d[f];c[f]=a[f]*d[f]+c[f]*u[f],a[f]=p}return this.conjugate(a,c,i),this.transform(a,c,h,r,i,s),this.conjugate(h,r,i),this.normalize13b(h,i),n.negative=e.negative^t.negative,n.length=e.length+t.length,n.strip()},r.prototype.mul=function(e){var t=new r(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},r.prototype.mulf=function(e){var t=new r(null);return t.words=new Array(this.length+e.length),p(this,e,t)},r.prototype.imul=function(e){return this.clone().mulTo(e,this)},r.prototype.imuln=function(e){i("number"==typeof e),i(e<67108864);for(var t=0,n=0;n<this.length;n++){var s=(0|this.words[n])*e,r=(67108863&s)+(67108863&t);t>>=26,t+=s/67108864|0,t+=r>>>26,this.words[n]=67108863&r}return 0!==t&&(this.words[n]=t,this.length++),this},r.prototype.muln=function(e){return this.clone().imuln(e)},r.prototype.sqr=function(){return this.mul(this)},r.prototype.isqr=function(){return this.imul(this.clone())},r.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),n=0;n<t.length;n++){var i=n/26|0,s=n%26;t[n]=(e.words[i]&1<<s)>>>s}return t}(e);if(0===t.length)return new r(1);for(var n=this,i=0;i<t.length&&0===t[i];i++,n=n.sqr());if(++i<t.length)for(var s=n.sqr();i<t.length;i++,s=s.sqr())0!==t[i]&&(n=n.mul(s));return n},r.prototype.iushln=function(e){i("number"==typeof e&&e>=0);var t,n=e%26,s=(e-n)/26,r=67108863>>>26-n<<26-n;if(0!==n){var o=0;for(t=0;t<this.length;t++){var a=this.words[t]&r,c=(0|this.words[t])-a<<n;this.words[t]=c|o,o=a>>>26-n}o&&(this.words[t]=o,this.length++)}if(0!==s){for(t=this.length-1;t>=0;t--)this.words[t+s]=this.words[t];for(t=0;t<s;t++)this.words[t]=0;this.length+=s}return this.strip()},r.prototype.ishln=function(e){return i(0===this.negative),this.iushln(e)},r.prototype.iushrn=function(e,t,n){var s;i("number"==typeof e&&e>=0),s=t?(t-t%26)/26:0;var r=e%26,o=Math.min((e-r)/26,this.length),a=67108863^67108863>>>r<<r,c=n;if(s-=o,s=Math.max(0,s),c){for(var l=0;l<o;l++)c.words[l]=this.words[l];c.length=o}if(0===o);else if(this.length>o)for(this.length-=o,l=0;l<this.length;l++)this.words[l]=this.words[l+o];else this.words[0]=0,this.length=1;var u=0;for(l=this.length-1;l>=0&&(0!==u||l>=s);l--){var d=0|this.words[l];this.words[l]=u<<26-r|d>>>r,u=d&a}return c&&0!==u&&(c.words[c.length++]=u),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},r.prototype.ishrn=function(e,t,n){return i(0===this.negative),this.iushrn(e,t,n)},r.prototype.shln=function(e){return this.clone().ishln(e)},r.prototype.ushln=function(e){return this.clone().iushln(e)},r.prototype.shrn=function(e){return this.clone().ishrn(e)},r.prototype.ushrn=function(e){return this.clone().iushrn(e)},r.prototype.testn=function(e){i("number"==typeof e&&e>=0);var t=e%26,n=(e-t)/26,s=1<<t;return!(this.length<=n)&&!!(this.words[n]&s)},r.prototype.imaskn=function(e){i("number"==typeof e&&e>=0);var t=e%26,n=(e-t)/26;if(i(0===this.negative,"imaskn works only with positive numbers"),this.length<=n)return this;if(0!==t&&n++,this.length=Math.min(n,this.length),0!==t){var s=67108863^67108863>>>t<<t;this.words[this.length-1]&=s}return this.strip()},r.prototype.maskn=function(e){return this.clone().imaskn(e)},r.prototype.iaddn=function(e){return i("number"==typeof e),i(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},r.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},r.prototype.isubn=function(e){if(i("number"==typeof e),i(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},r.prototype.addn=function(e){return this.clone().iaddn(e)},r.prototype.subn=function(e){return this.clone().isubn(e)},r.prototype.iabs=function(){return this.negative=0,this},r.prototype.abs=function(){return this.clone().iabs()},r.prototype._ishlnsubmul=function(e,t,n){var s,r,o=e.length+n;this._expand(o);var a=0;for(s=0;s<e.length;s++){r=(0|this.words[s+n])+a;var c=(0|e.words[s])*t;a=((r-=67108863&c)>>26)-(c/67108864|0),this.words[s+n]=67108863&r}for(;s<this.length-n;s++)a=(r=(0|this.words[s+n])+a)>>26,this.words[s+n]=67108863&r;if(0===a)return this.strip();for(i(-1===a),a=0,s=0;s<this.length;s++)a=(r=-(0|this.words[s])+a)>>26,this.words[s]=67108863&r;return this.negative=1,this.strip()},r.prototype._wordDiv=function(e,t){var n=(this.length,e.length),i=this.clone(),s=e,o=0|s.words[s.length-1];0!==(n=26-this._countBits(o))&&(s=s.ushln(n),i.iushln(n),o=0|s.words[s.length-1]);var a,c=i.length-s.length;if("mod"!==t){(a=new r(null)).length=c+1,a.words=new Array(a.length);for(var l=0;l<a.length;l++)a.words[l]=0}var u=i.clone()._ishlnsubmul(s,1,c);0===u.negative&&(i=u,a&&(a.words[c]=1));for(var d=c-1;d>=0;d--){var h=67108864*(0|i.words[s.length+d])+(0|i.words[s.length+d-1]);for(h=Math.min(h/o|0,67108863),i._ishlnsubmul(s,h,d);0!==i.negative;)h--,i.negative=0,i._ishlnsubmul(s,1,d),i.isZero()||(i.negative^=1);a&&(a.words[d]=h)}return a&&a.strip(),i.strip(),"div"!==t&&0!==n&&i.iushrn(n),{div:a||null,mod:i}},r.prototype.divmod=function(e,t,n){return i(!e.isZero()),this.isZero()?{div:new r(0),mod:new r(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(s=a.div.neg()),"div"!==t&&(o=a.mod.neg(),n&&0!==o.negative&&o.iadd(e)),{div:s,mod:o}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(s=a.div.neg()),{div:s,mod:a.mod}):0!=(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(o=a.mod.neg(),n&&0!==o.negative&&o.isub(e)),{div:a.div,mod:o}):e.length>this.length||this.cmp(e)<0?{div:new r(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new r(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new r(this.modn(e.words[0]))}:this._wordDiv(e,t);var s,o,a},r.prototype.div=function(e){return this.divmod(e,"div",!1).div},r.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},r.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},r.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var n=0!==t.div.negative?t.mod.isub(e):t.mod,i=e.ushrn(1),s=e.andln(1),r=n.cmp(i);return r<0||1===s&&0===r?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},r.prototype.modn=function(e){i(e<=67108863);for(var t=(1<<26)%e,n=0,s=this.length-1;s>=0;s--)n=(t*n+(0|this.words[s]))%e;return n},r.prototype.idivn=function(e){i(e<=67108863);for(var t=0,n=this.length-1;n>=0;n--){var s=(0|this.words[n])+67108864*t;this.words[n]=s/e|0,t=s%e}return this.strip()},r.prototype.divn=function(e){return this.clone().idivn(e)},r.prototype.egcd=function(e){i(0===e.negative),i(!e.isZero());var t=this,n=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var s=new r(1),o=new r(0),a=new r(0),c=new r(1),l=0;t.isEven()&&n.isEven();)t.iushrn(1),n.iushrn(1),++l;for(var u=n.clone(),d=t.clone();!t.isZero();){for(var h=0,f=1;0==(t.words[0]&f)&&h<26;++h,f<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(s.isOdd()||o.isOdd())&&(s.iadd(u),o.isub(d)),s.iushrn(1),o.iushrn(1);for(var p=0,m=1;0==(n.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(n.iushrn(p);p-- >0;)(a.isOdd()||c.isOdd())&&(a.iadd(u),c.isub(d)),a.iushrn(1),c.iushrn(1);t.cmp(n)>=0?(t.isub(n),s.isub(a),o.isub(c)):(n.isub(t),a.isub(s),c.isub(o))}return{a:a,b:c,gcd:n.iushln(l)}},r.prototype._invmp=function(e){i(0===e.negative),i(!e.isZero());var t=this,n=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var s,o=new r(1),a=new r(0),c=n.clone();t.cmpn(1)>0&&n.cmpn(1)>0;){for(var l=0,u=1;0==(t.words[0]&u)&&l<26;++l,u<<=1);if(l>0)for(t.iushrn(l);l-- >0;)o.isOdd()&&o.iadd(c),o.iushrn(1);for(var d=0,h=1;0==(n.words[0]&h)&&d<26;++d,h<<=1);if(d>0)for(n.iushrn(d);d-- >0;)a.isOdd()&&a.iadd(c),a.iushrn(1);t.cmp(n)>=0?(t.isub(n),o.isub(a)):(n.isub(t),a.isub(o))}return(s=0===t.cmpn(1)?o:a).cmpn(0)<0&&s.iadd(e),s},r.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),n=e.clone();t.negative=0,n.negative=0;for(var i=0;t.isEven()&&n.isEven();i++)t.iushrn(1),n.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;n.isEven();)n.iushrn(1);var s=t.cmp(n);if(s<0){var r=t;t=n,n=r}else if(0===s||0===n.cmpn(1))break;t.isub(n)}return n.iushln(i)},r.prototype.invm=function(e){return this.egcd(e).a.umod(e)},r.prototype.isEven=function(){return 0==(1&this.words[0])},r.prototype.isOdd=function(){return 1==(1&this.words[0])},r.prototype.andln=function(e){return this.words[0]&e},r.prototype.bincn=function(e){i("number"==typeof e);var t=e%26,n=(e-t)/26,s=1<<t;if(this.length<=n)return this._expand(n+1),this.words[n]|=s,this;for(var r=s,o=n;0!==r&&o<this.length;o++){var a=0|this.words[o];r=(a+=r)>>>26,a&=67108863,this.words[o]=a}return 0!==r&&(this.words[o]=r,this.length++),this},r.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},r.prototype.cmpn=function(e){var t,n=e<0;if(0!==this.negative&&!n)return-1;if(0===this.negative&&n)return 1;if(this.strip(),this.length>1)t=1;else{n&&(e=-e),i(e<=67108863,"Number is too big");var s=0|this.words[0];t=s===e?0:s<e?-1:1}return 0!==this.negative?0|-t:t},r.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},r.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,n=this.length-1;n>=0;n--){var i=0|this.words[n],s=0|e.words[n];if(i!==s){i<s?t=-1:i>s&&(t=1);break}}return t},r.prototype.gtn=function(e){return 1===this.cmpn(e)},r.prototype.gt=function(e){return 1===this.cmp(e)},r.prototype.gten=function(e){return this.cmpn(e)>=0},r.prototype.gte=function(e){return this.cmp(e)>=0},r.prototype.ltn=function(e){return-1===this.cmpn(e)},r.prototype.lt=function(e){return-1===this.cmp(e)},r.prototype.lten=function(e){return this.cmpn(e)<=0},r.prototype.lte=function(e){return this.cmp(e)<=0},r.prototype.eqn=function(e){return 0===this.cmpn(e)},r.prototype.eq=function(e){return 0===this.cmp(e)},r.red=function(e){return new w(e)},r.prototype.toRed=function(e){return i(!this.red,"Already a number in reduction context"),i(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},r.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},r.prototype._forceRed=function(e){return this.red=e,this},r.prototype.forceRed=function(e){return i(!this.red,"Already a number in reduction context"),this._forceRed(e)},r.prototype.redAdd=function(e){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},r.prototype.redIAdd=function(e){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},r.prototype.redSub=function(e){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},r.prototype.redISub=function(e){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},r.prototype.redShl=function(e){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},r.prototype.redMul=function(e){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},r.prototype.redIMul=function(e){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},r.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},r.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},r.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},r.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},r.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},r.prototype.redPow=function(e){return i(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function y(e,t){this.name=e,this.p=new r(t,16),this.n=this.p.bitLength(),this.k=new r(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function v(){y.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function S(){y.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function _(){y.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function E(){y.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function w(e){if("string"==typeof e){var t=r._prime(e);this.m=t.p,this.prime=t}else i(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function b(e){w.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new r(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}y.prototype._tmp=function(){var e=new r(null);return e.words=new Array(Math.ceil(this.n/13)),e},y.prototype.ireduce=function(e){var t,n=e;do{this.split(n,this.tmp),t=(n=(n=this.imulK(n)).iadd(this.tmp)).bitLength()}while(t>this.n);var i=t<this.n?-1:n.ucmp(this.p);return 0===i?(n.words[0]=0,n.length=1):i>0?n.isub(this.p):void 0!==n.strip?n.strip():n._strip(),n},y.prototype.split=function(e,t){e.iushrn(this.n,0,t)},y.prototype.imulK=function(e){return e.imul(this.k)},s(v,y),v.prototype.split=function(e,t){for(var n=Math.min(e.length,9),i=0;i<n;i++)t.words[i]=e.words[i];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var s=e.words[9];for(t.words[t.length++]=4194303&s,i=10;i<e.length;i++){var r=0|e.words[i];e.words[i-10]=(4194303&r)<<4|s>>>22,s=r}s>>>=22,e.words[i-10]=s,0===s&&e.length>10?e.length-=10:e.length-=9},v.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,n=0;n<e.length;n++){var i=0|e.words[n];t+=977*i,e.words[n]=67108863&t,t=64*i+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},s(S,y),s(_,y),s(E,y),E.prototype.imulK=function(e){for(var t=0,n=0;n<e.length;n++){var i=19*(0|e.words[n])+t,s=67108863&i;i>>>=26,e.words[n]=s,t=i}return 0!==t&&(e.words[e.length++]=t),e},r._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new v;else if("p224"===e)t=new S;else if("p192"===e)t=new _;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new E}return g[e]=t,t},w.prototype._verify1=function(e){i(0===e.negative,"red works only with positives"),i(e.red,"red works only with red numbers")},w.prototype._verify2=function(e,t){i(0==(e.negative|t.negative),"red works only with positives"),i(e.red&&e.red===t.red,"red works only with red numbers")},w.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},w.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},w.prototype.add=function(e,t){this._verify2(e,t);var n=e.add(t);return n.cmp(this.m)>=0&&n.isub(this.m),n._forceRed(this)},w.prototype.iadd=function(e,t){this._verify2(e,t);var n=e.iadd(t);return n.cmp(this.m)>=0&&n.isub(this.m),n},w.prototype.sub=function(e,t){this._verify2(e,t);var n=e.sub(t);return n.cmpn(0)<0&&n.iadd(this.m),n._forceRed(this)},w.prototype.isub=function(e,t){this._verify2(e,t);var n=e.isub(t);return n.cmpn(0)<0&&n.iadd(this.m),n},w.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},w.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},w.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},w.prototype.isqr=function(e){return this.imul(e,e.clone())},w.prototype.sqr=function(e){return this.mul(e,e)},w.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(i(t%2==1),3===t){var n=this.m.add(new r(1)).iushrn(2);return this.pow(e,n)}for(var s=this.m.subn(1),o=0;!s.isZero()&&0===s.andln(1);)o++,s.iushrn(1);i(!s.isZero());var a=new r(1).toRed(this),c=a.redNeg(),l=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new r(2*u*u).toRed(this);0!==this.pow(u,l).cmp(c);)u.redIAdd(c);for(var d=this.pow(u,s),h=this.pow(e,s.addn(1).iushrn(1)),f=this.pow(e,s),p=o;0!==f.cmp(a);){for(var m=f,g=0;0!==m.cmp(a);g++)m=m.redSqr();i(g<p);var y=this.pow(d,new r(1).iushln(p-g-1));h=h.redMul(y),d=y.redSqr(),f=f.redMul(d),p=g}return h},w.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},w.prototype.pow=function(e,t){if(t.isZero())return new r(1).toRed(this);if(0===t.cmpn(1))return e.clone();var n=new Array(16);n[0]=new r(1).toRed(this),n[1]=e;for(var i=2;i<n.length;i++)n[i]=this.mul(n[i-1],e);var s=n[0],o=0,a=0,c=t.bitLength()%26;for(0===c&&(c=26),i=t.length-1;i>=0;i--){for(var l=t.words[i],u=c-1;u>=0;u--){var d=l>>u&1;s!==n[0]&&(s=this.sqr(s)),0!==d||0!==o?(o<<=1,o|=d,(4===++a||0===i&&0===u)&&(s=this.mul(s,n[o]),a=0,o=0)):a=0}c=26}return s},w.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},w.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},r.mont=function(e){return new b(e)},s(b,w),b.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},b.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},b.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var n=e.imul(t),i=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=n.isub(i).iushrn(this.shift),r=s;return s.cmp(this.m)>=0?r=s.isub(this.m):s.cmpn(0)<0&&(r=s.iadd(this.m)),r._forceRed(this)},b.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new r(0)._forceRed(this);var n=e.mul(t),i=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=n.isub(i).iushrn(this.shift),o=s;return s.cmp(this.m)>=0?o=s.isub(this.m):s.cmpn(0)<0&&(o=s.iadd(this.m)),o._forceRed(this)},b.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}).call(this,n(121)(e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={"statusbar.placeHolder":"What would you like to do with other collaborators?","statusbar.InviteOthers":"Invite Others (Copy Link)","statusbar.InviteOthersMessage":"Copy the invitation link so you can send it to other participants.","statusbar.FocusParticipants":"Focus Participants","statusbar.FocusParticipantsMessage":"Request other participants to follow you.","statusbar.ShareReadOnlyTerminal":"Share Read-only Terminal","statusbar.ShareTerminal":"Share Terminal","statusbar.ShareTerminalMessage":"Start a new terminal / command prompt for use by all participants.","statusbar.ShareServer":"Share Server","statusbar.ShareServerMessage":"Expose a local TCP port to all participants.","statusbar.ShowSharedServers":"Show Shared Servers","statusbar.ShowSharedServersMessage":"Show local TCP servers shared with collaboration participants.","statusbar.StartCollaboration":"Start Collaboration Session","statusbar.StopSharingServer":"Stop Sharing Server","statusbar.StopSharingServerMessage":"Stop sharing a local TCP port for all participants.","statusbar.StopCollaborationSession":"Stop Collaboration Session","statusbar.StopCollaborationSessionMessage":"Stop collaboration session, stop sharing all content, and remove all participant access.","statusbar.SignInMessage":"Sign in with your GitHub or Microsoft account to gain read/write access.","statusbar.AttachSharedDebuggingSession":"Attach to a Shared Debugging Session","statusbar.AttachSharedDebuggingSessionMessage":"Attach your debugger to a debug session that the host has shared with participants.","statusbar.AccessSharedTerminal":"Access Shared Terminal","statusbar.AccessSharedTerminalMessage":"Open terminal that the host has shared with participants.","statusbar.AccessSharedServer":"Access Shared Server","statusbar.AccessSharedServerMessage":"Copy a named, shared TCP port for use","statusbar.LeaveCollaborationSession":"Leave Collaboration Session","statusbar.LeaveCollaborationSessionMessage":"Stop participating in this collaboration session.","statusbar.SignedUserPlaceholder":"What would you like to do?","statusbar.StartSession":"Start Collaboration Session","statusbar.StartSessionMessage":"Start a collaboration session to share content and invite participants.","statusbar.StartReadOnly":"Start Read-only Collaboration Session","statusbar.StartReadOnlyMessage":"Start a read-only collaboration session to share content and invite participants.","statusbar.JoinSession":"Join Collaboration Session","statusbar.JoinSessionMessage":"Join a collaboration session to access shared content.","generic.CopyAgain":"Copy again","generic.CopyLink":"Copy link","generic.MakeReadWrite":"Make read/write","generic.MakeReadOnly":"Make read-only","generic.StartSharing":"Start Sharing","generic.Help":"Help","generic.OK":"OK","generic.SignIn":"Sign in","generic.ContinueAsAnonymous":"Continue as anonymous","generic.moreInfo":"More info","generic.dontShowAgain":"Don't show again","error.CouldNotConnectToServer":"Could not connect to the server. Check that you are connected to the internet.","error.OlderThanServer":"The $(shortName) service requires a newer version of the extension than you have installed.","error.NewerThanServer":"The extension you have installed requires a newer version of the $(shortName) service.","error.OlderThanPeer":"The $(shortName) extension you have installed is too old to connect to this collaboration session.","error.NewerThanPeer":"The collaboration session host is on an older version of the $(shortName) extension than you are.","error.OlderThanAgent":"The $(shortName) agent is newer than the extension","error.NewerThanAgent":"The $(shortName) agent is older than the extension","error.NoIPAddressesDetected":'Unable to share in "Direct" mode as there are no suitable IP addresses. Switch to "Auto" or "Relay" mode and retry.',"error.NoConnectionAddresses":'Could not find a compatible connection address. Switch to "Auto" mode and retry.',"error.AutoConnectionFailed":"Unable to connect to the host. Verify both you and the host are online.","error.RelayConnectionFailed":'Unable to connect to the host in "Relay" mode. Verify you and the host are online. If so, switch to "Auto" or "Direct" mode and retry.',"error.DirectConnectionFailed":'Unable to connect to the host in "Direct" mode. Verify you and the host are online. If so, switch to "Auto" or "Relay" mode and retry.',"error.SessionProtocolError":"Unable to join the host due to a protocol error. Verify you and the host are online and are using the latest version of $(shortName).","error.SessionAuthenticationFailed":"Unable to join the host due to an authentication error. Verify the host is online, then sign out and sign in again and retry.","error.AuthTokenConversionFailed":"Live Share didn't succeed reusing a GitHub token for authentication. This could be caused by either a token expiration or revocation. Refresh your GitHub account in VSCode and run Live Share again to fix the problem.","error.AuthTokenConversionFailedWithCode":"Token exchange failed with code: ${code}","error.UnexpectedAuthenticationError":"Unexpected authentication error. Try signing in again.","error.DirectConnectionNotEnabled":'The host does not allow direct connections. Switch to "Auto" or "Relay" mode and retry.',"error.RelayConnectionNotEnabled":'Unable to connect since the host does not allow relayed connections. Switch to "Auto" or "Direct" mode and retry.',"error.CollaborationSessionUsersLimitReached":"Could not join the collaboration session as it has already reached the maximum of 5 participants. To increase the participant limit, please ask the host to change the Increased Guest Limit setting, reload and then start a new collaboration session.","error.CollaborationSessionGuestRejected":"The host has rejected you from joining the collaboration session.","error.CollaborationSessionRequestTimedOut":"Timed out while waiting for the host to respond to your request.","error.CollaborationSessionGuestCanceled":"Request to join the collaboration session was canceled.","error.CollaborationSessionNotFound":"Collaboration session not found.","error.CollaborationSessionGuestBlocked":"The host has blocked you from joining the collaboration. If this was accidental, please ask the host to restart the session.","error.NonSuccessHttpStatusCodeReceived":"Could not connect to the server. Received non success status code.","error.KeychainAccessFailed":"Live Share was unable to access the login keychain. This can happen if you recently changed your password or your login keychain has become corrupted. See more info for details on how to fix it.","error.RelayConnectionHostFailure":"The host's network conditions are poor or they are no longer connected to the Live Share cloud relay. Ask them to check their network conditions, restart the collaboration session, and try again.","error.RelayConnectionGuestFailure":"Unable to connect to Live Share cloud relay. Check your proxy, firewall and network settings and try again.","error.RemoteLaunchNotEnabled":"The host doesnt allow starting the debugger. If needed, ask them to enable it.","error.CouldNotConnectToServerAuthFailed":"Could not connect to the server. HTTPS connection failed, verify there are no self-signed certificates or custom cert validation policies blocking Live Share.","error.CannotCreatePlannedSession":"Failed to create a planned session","error.CannotDeletePlannedSession":"Failed to delete a planned session","error.CannotRenamePlannedSession":"Failed to rename planned session","error.CannotCopyPlannedSessionLink":"Failed to copy planned session link","error.CannotJoinPlannedSession":"Failed to join planned session","error.CaseSensitiveFileSystem":"It looks like you have a directory with files that have the same name, except for the casing. This is currently unsupported and may lead to errors.","error.RunningVsCodeOutsideOfApplicationsFolder":"You are running VS Code outside the Applications folder, so we cannot install support for joining sessions using a browser link. You can still join sessions manually.","error.FailedToInstallJoiningSessionsViaBrowser":"Failed to install support for joining sessions using a browser link. You can still join sessions manually.","error.InvitationLinkExpired":"This invite link has expired. Share again to generate a new link.","progress.openingRemoteSession":"Opening remote session...","progress.joiningRemoteSession":"Joining remote session...","progress.waitingForHost":"Waiting for host approval...","progress.reconnectingToHost":"Connection lost. Reconnecting to host...","progress.creatingPlannedSession":"Creating planned session...","progress.deletingPlannedSession":"Deleting planned session...","fileError.FileNotFound":"Path not found: $(path)","fileError.FileExists":"Path already exists: $(path)","fileError.NoPermissions":"Access denied: $(path)","fileError.FileTooLarge":"File is too large.","fileError.FileNotAvailable":"File is not available.","notification.AcceptRejectGuest":" requested to join the collaboration session.","notification.Accept":"Accept","notification.AcceptReadOnly":"Accept read-only","notification.AcceptReadWrite":"Accept read-write","notification.Reject":"Reject","notification.AlwaysAcceptAnonymous":"Always accept anonymous","notification.InformGuestJoined":" joined the collaboration session.","notification.GuestDisconnected":" was disconnected.","notification.GuestLeft":" left the collaboration session.","notification.FocusAccept":"$(userId) focused your attention.","notification.FocusRequest":"$(userId) requested you to follow them.","notification.CopyPlannedSessionLink":"Session link copied.","notification.CoeditingInformationCopiedToClipboard":"Co-editing information copied to clipboard.","notification.JoiningFromBrowserPermission":"To support joining a session using a browser link, we need permission to run an installer on your system. Your OS may ask you for your admin (sudo) password in a terminal. Install now?","notification.BrowserLinkLauncherInstallCommandCopiedToClipboard":"Browser link launcher install command copied to clipboard.","notification.CompleteIntegrationLater":'You can run the "Live Share: Launcher Setup" command to complete the integration later.',"notification.BrowserLinkLauncherInstalled":"Browser link launcher successfully installed.","notification.copyInstead":"Copy instead","notification.install":"Install","notification.InvitationLinkCopied":"Invitation link copied to clipboard! Send it to anyone you trust","notification.InvitationLinkSessionShared":'Session shared! Click "Copy link" to get an invitation link ',"notification.InvitationLinkMoreInfo":'or click "More info" to learn about secure sharing.',"notification.ReusableInvitationLinkCopied":'A Reusable Session link is copied to the clipboard. Save the link to a secure location. Learn more about how to use your Session by clicking "More info".',"notification.ReusableInvitationLinkCreated":'A Reusable Session link is created! Click "Copy link" to get the link. Save the link to a secure location. Learn more about how to use your Session by clicking "More info".',"notification.SignIntoJoin":"Sign in with VS Live Share to join a collaboration session.","notification.YouNeedToSignInBeforeJoin":"You need to sign in before joining the collaboration session.","notification.ProgressNotifiers":"$(options.title)","notification.CannotEditTheTerminal":"Cannot edit the terminal in read-only mode (anonymous). Sign in to proceed.","plannedSessions.quickPickSelectWindow":"Select a planned session","plannedSessions.expiresatTooltip":"Expiration: ","plannedSessions.NewLabel":"Create planned session...","plannedSessions.CreateaPlannedSessionTooltip":"Create a planned session","plannedSessions.Name":"Specify the name of the planned session","plannedSessions.NameCannotBeEmpty":"Name cannot be empty. Please enter an alphanumeric name for the session","plannedSessions.NameIsInvalid":"Name is invalid. Please enter an alphanumeric name for the session","guestNameToast.ReadOnlyLabel":" (Read-only)","guestNameToast.ReadOnlyAndAnonymousLabel":" (Anonymous & Read-only)","guestNameToast.AnonymousReadWriteLabel":" (Anonymous & Read-write)","guestNameToast.AnonymousLabel":" (Anonymous)","extension.liveshare.InLiveShareSession":"In a Live Share session","searchContacts.placeholder":"Type to search for contacts","selectPresenceProviderCommand.placeHolder":"Select the presence provider to use","inviteContactStatus.invited":"Invited","inviteContactStatus.dismissed":"Dismissed","inviteContactStatus.joining":"Joining","guestNameViewlet.ReadOnlyLabel":" (Read-only)","guestNameViewlet.ReadOnlyAndAnonymousLabel":" (Anonymous & Read-only)","guestNameViewlet.AnonymousReadWriteLabel":" (Anonymous & Read-write)","anonymousAuthStrategy.readOnlyUser":"Read-only User","anonymousAuthStrategy.continueAs":"Continue as","anonymousAuthStrategy.continueAsDescription":"Continue without signing in as a Read-only guest","authentication.SignInPromptPlaceholder":"Please select account to sign in","authentication.SignInPrompt":"Sign in using ${key} account","commentManager.cannotCreateCommentThread":"Cannot create comment thread","commentManager.cannotDeleteThread":"Cannot delete comment thread","commentManager.cannotReply":"Cannot reply","commentManager.cannotEditComment":"Cannot edit comment","commentManager.cannotSaveComment":"Cannot save comment","commentManager.cannotCancelEditComment":"Cannot cancel editing comment","commentManager.cannotDeleteComment":"Cannot delete comment","commentManager.deleteOtherComments":"delete other comments on the thread first","commentManager.controllerLabel":"Live Share Session Comments","commentManager.participants":"Participants:","chat.statusBarText":"Live Share Chat: $(unreads) new","chat.sessionChatLabel":"Session Chat","chat.quickPickItemDescription":"Live Share Chat","chat.quickPickSelectWindow":"Select a chat channel","chat.unreadLabel":"($(unread) new)","chat.typingStatus":"$(username) is typing...","chat.sessionStarted":"_has started the Live Share session_","chat.sessionEnded":"_has ended the Live Share session_","chat.sessionJoined":"_has joined the Live Share session_","chat.sessionLeft":"_has left the Live Share session_","chat.hostUnsupported":"The host of this collaboration session is currently disconnected from chat or is using a version of _Live Share_ that does not support this feature. [Learn more](https://aka.ms/vsls-chat)","chat.contactUnsupported":"The person you are trying to contact is currently unavailable or using a version of _Live Share_ that does not support this feature. [Learn more](https://aka.ms/vsls-chat)","chat.legacyExtensionUnsupported":"Please update the `Live Share Chat` companion extension. The version installed is no longer compatible. [Learn more](https://aka.ms/vsls-chat)","chat.unknownUser":"Unknown user","chat.openSessionChatWindow":"Open session chat","chat.chatServiceDisconnected":"The chat service is currently disconnected. Please try again shortly.","calling.quickPickConnectedPlaceholder":"What would you like to do?","calling.quickPickDisconnectLabel":"$(x) Disconnect","calling.quickPickDisconnectDetail":"Disconnect from the audio call.","calling.quickPickMuteYourselfLabel":"$(mute) Mute Yourself","calling.quickPickUnmuteYourselfLabel":"$(unmute) Unmute Yourself","calling.quickPickMuteYourselfDetail":"Mute yourself so others cannot hear you.","calling.quickPickUnmuteYourselfDetail":"Unmute your microphone so others can hear you.","calling.quickPickViewParticipantsLabel":"$(organization) View Participants","calling.quickPickViewParticipantsDetail":"View the list of Live Share participants that are currently in the call.","calling.quickPickConfigureSpeakersLabel":"$(unmute) Configure Speakers","calling.quickPickConfigureSpeakersDetail":"Select which speakers to use for the audio call.","calling.quickPickConfigureMicrophoneLabel":"$(megaphone) Configure Microphone","calling.quickPickConfigureMicrophoneDetail":"Select which microphone to use for the audio call.","calling.treeAudioCallParticipantsInitial":"Participants (0)","calling.treeJoinAudioCall":"Join audio call...","calling.treeStartAudioCall":"Start audio call...","calling.treeJoiningAudioCall":"Joining audio call...","calling.treeStartingAudioCall":"Starting audio call...","calling.treeEndingAudioCall":"Ending audio call...","calling.treeAudioCallLabel":"Audio Call","calling.treeAudioCallParticipantsCount":"Audio Call Participants ($(participantCount))","calling.treeUnknownUser":"Unknown user","calling.treeSelfItem":"$(displayName) (you)","calling.joinButton":"Join","calling.connectingAudio":"Connecting audio...","calling.disconnectingAudio":"Disconnecting audio...","calling.viewParticipantsQuickPickPlaceholder":"Audio Call Participants","calling.selectMicrophoneQuickPickPlaceholder":"Select the microphone to use","calling.selectSpeakersQuickPickPlaceholder":"Select the speaker to use","calling.joinInformationMessage":"An audio call has been started for this collaboration session.","info.SearchResultsLimited":"The result set contains only a subset of all matches. Please be more specific in your search to narrow down the results.","treeView.newTooltip":"[New]","guestServerController-promtHostSharedServer":"The host has shared a server $(sessionName) with you. Would you like to view this in the browser?","guestServerController-yes":"Yes","guestServerController-no":"No","guestServerController-serverUnshared":"Cannot open server $(sessionName) in browser. The host has unshared the server","emptyWorkspace.liveShareWorkspace":"Live Share Workspace","notebooks.openWithDifferentNotebookTypeOnHost1":"The host has the notebook open with","notebooks.openWithDifferentNotebookTypeOnHost2":"Use the same view to open","notebooks.openedWithLocalContentProvider":"Co-editing is not supported for notebooks opened with non-shared views.","notebooks.kernelDetail":"Kernel to execute cells on the host's machine","notebooks.executeCellsAccessGranted":"The host has granted you access to execute notebook cells","notebooks.executeCellsAccessDenied":"The host has rejected your request to execute notebook cells","notebooks.executeCellsReadOnly":"You cannot execute notebook cells in a read-only session","notebooks.executeCellsLackingPermission":"The host has not given you permission to execute notebook cells","notebooks.executeCellsRequestAccess":"Request access","notebooks.executeCellsAllowForSession":"Allow for this session","notebooks.executeCellsAllowAlways":"Allow always","notebooks.executeCellsReject":"Reject","notebooks.executeCellsRequested":"A guest is requesting permission to execute notebook cells",startCollaborationSession:"Start collaboration session...",joinCollaborationSession:"Join collaboration session...",startReadOnlyCollaborationSession:"Start read-only collaboration session...",CreateLinkProgress:"Creating a Reusable Session link...",CannotCreatePersistentSession:"Failed to create a Reusable Session link","web.previewMessage":"Live Share web support is currently in preview. Let us know if you have any feedback!","web.previewContactUs":"Contact us on GitHub","presence.signInMessage":"Sign in to presence will allow people to see your status based on your e-mail"};let s=e=>i.hasOwnProperty(e)?i[e]:e;t.setLocalizeCallback=function(e){s=e},t.localize=function(e){return s(e)},t.localizeDate=function(e){return e.toLocaleString()}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";t.randomBytes=t.rng=t.pseudoRandomBytes=t.prng=n(75),t.createHash=t.Hash=n(118),t.createHmac=t.Hmac=n(335);var i=n(755),s=Object.keys(i),r=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(s);t.getHashes=function(){return r};var o=n(338);t.pbkdf2=o.pbkdf2,t.pbkdf2Sync=o.pbkdf2Sync;var a=n(757);t.Cipher=a.Cipher,t.createCipher=a.createCipher,t.Cipheriv=a.Cipheriv,t.createCipheriv=a.createCipheriv,t.Decipher=a.Decipher,t.createDecipher=a.createDecipher,t.Decipheriv=a.Decipheriv,t.createDecipheriv=a.createDecipheriv,t.getCiphers=a.getCiphers,t.listCiphers=a.listCiphers;var c=n(208);t.DiffieHellmanGroup=c.DiffieHellmanGroup,t.createDiffieHellmanGroup=c.createDiffieHellmanGroup,t.getDiffieHellman=c.getDiffieHellman,t.createDiffieHellman=c.createDiffieHellman,t.DiffieHellman=c.DiffieHellman;var l=n(776);t.createSign=l.createSign,t.Sign=l.Sign,t.createVerify=l.createVerify,t.Verify=l.Verify,t.createECDH=n(810);var u=n(811);t.publicEncrypt=u.publicEncrypt,t.privateEncrypt=u.privateEncrypt,t.publicDecrypt=u.publicDecrypt,t.privateDecrypt=u.privateDecrypt;var d=n(814);t.randomFill=d.randomFill,t.randomFillSync=d.randomFillSync,t.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join("\n"))},t.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(49),r=n(9),o=n(16),a=n(26),c=n(22);var l;!function(e){e.readOnly="readOnly",e.readWrite="readWrite"}(l=t.AnonymousAccessLevel||(t.AnonymousAccessLevel={}));t.workspaceSessionInfoTracker=new class{constructor(){this._workspaceSessionInfo=null,this.plannedWorkspaceList=null,this.isReadOnlyPrivate=!1,this.isPlannedSessionsChangedPrivate=!1,this.anonymousAccessMap=new Map,this.readOnlyChangedEmitter=new i.EventEmitter,this.onReadOnlyChanged=this.readOnlyChangedEmitter.event,this.plannedSessionsChangedEmitter=new i.EventEmitter,this.onPlannedSessionsChanged=this.plannedSessionsChangedEmitter.event,this.anonymousAccessLevelChangedInSessionEmitter=new i.EventEmitter,this.onAccessLevelChangedInSession=this.anonymousAccessLevelChangedInSessionEmitter.event}get workspaceSessionInfo(){return this._workspaceSessionInfo}set workspaceSessionInfo(e){var t;this._workspaceSessionInfo=e,(null===(t=this._workspaceSessionInfo)||void 0===t?void 0:t.id)&&c.ExtensionUtil.getCommandContext("liveshare:isWeb")&&(this._workspaceSessionInfo.joinUri=`https://vscode.dev/liveshare/${this._workspaceSessionInfo.id}`),(null==e?void 0:e.conversationId)&&(r.Telemetry.addContextProperty(o.TelemetryPropertyNames.CONVERSATION_ID,e.conversationId),r.Telemetry.addContextProperty(o.TelemetryPropertyNames.SESSION_ID,s()))}get isReadOnly(){return this.isReadOnlyPrivate}set isReadOnly(e){e!==t.workspaceSessionInfoTracker.isReadOnly&&(e?r.Telemetry.addContextProperty(o.TelemetryPropertyNames.IS_READONLY_SESSION,!0,!1):r.Telemetry.removeContextProperty(o.TelemetryPropertyNames.IS_READONLY_SESSION),t.workspaceSessionInfoTracker.isReadOnlyPrivate=e,this.readOnlyChangedEmitter.fire(e))}get isPlannedSessionsChanged(){return this.isPlannedSessionsChangedPrivate}set isPlannedSessionsChanged(e){e!==t.workspaceSessionInfoTracker.isPlannedSessionsChanged&&(t.workspaceSessionInfoTracker.isPlannedSessionsChangedPrivate=e,this.plannedSessionsChangedEmitter.fire(e)),t.workspaceSessionInfoTracker.isPlannedSessionsChangedPrivate=!1}async setAnonymousAccess(e,t){const n=new r.TelemetryEvent(o.TelemetryEventNames.RESPOND_ANONYMOUS_JOIN_REQUEST);switch(t){case a.localize("notification.AcceptReadOnly"):case a.localize("notification.Accept"):case a.localize("notification.AlwaysAcceptAnonymous"):this.anonymousAccessMap.set(e,l.readOnly),n.addProperty(o.TelemetryPropertyNames.READONLY,!0),n.addProperty(o.TelemetryPropertyNames.ACCEPTED,!0);break;case a.localize("notification.AcceptReadWrite"):this.anonymousAccessMap.set(e,l.readWrite),n.addProperty(o.TelemetryPropertyNames.READONLY,!1),n.addProperty(o.TelemetryPropertyNames.ACCEPTED,!0);break;case a.localize("notification.Reject"):n.addProperty(o.TelemetryPropertyNames.ACCEPTED,!1)}n.send()}async updateAnonymousAccess(e,t){const n=new r.TelemetryEvent(o.TelemetryEventNames.UPDATE_ANONYMOUS_GUEST_ACCESS_LEVEL),i=e.participantId,s=e.sessionId;t?(this.anonymousAccessMap.set(i,l.readOnly),this.anonymousAccessLevelChangedInSessionEmitter.fire(),this.anonymousUserId=s,n.addProperty(o.TelemetryPropertyNames.IS_ANONYMOUS_ELEVATED,!1)):(this.anonymousAccessMap.set(i,l.readWrite),this.anonymousAccessLevelChangedInSessionEmitter.fire(),this.anonymousUserId=s,n.addProperty(o.TelemetryPropertyNames.IS_ANONYMOUS_ELEVATED,!0)),n.send()}getAnonymousAccess(e){return this.anonymousAccessMap.get(e)}getAnonymousAccessMapHasTheProfile(e){const t=e.participantId;return this.anonymousAccessMap.has(t)}clearAnonymousAccessMap(){this.anonymousAccessMap.clear()}getAccessLevelChangedUserID(){return this.anonymousUserId}}},function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});const s=n(56);t.ErrorCodes=s.ErrorCodes,t.ResponseError=s.ResponseError,t.CancellationToken=s.CancellationToken,t.CancellationTokenSource=s.CancellationTokenSource,t.Disposable=s.Disposable,t.Event=s.Event,t.Emitter=s.Emitter,t.Trace=s.Trace,t.TraceFormat=s.TraceFormat,t.SetTraceNotification=s.SetTraceNotification,t.LogTraceNotification=s.LogTraceNotification,t.RequestType=s.RequestType,t.RequestType0=s.RequestType0,t.NotificationType=s.NotificationType,t.NotificationType0=s.NotificationType0,t.MessageReader=s.MessageReader,t.MessageWriter=s.MessageWriter,t.ConnectionStrategy=s.ConnectionStrategy,t.StreamMessageReader=s.StreamMessageReader,t.StreamMessageWriter=s.StreamMessageWriter,t.IPCMessageReader=s.IPCMessageReader,t.IPCMessageWriter=s.IPCMessageWriter,t.createClientPipeTransport=s.createClientPipeTransport,t.createServerPipeTransport=s.createServerPipeTransport,t.generateRandomPipeName=s.generateRandomPipeName,t.createClientSocketTransport=s.createClientSocketTransport,t.createServerSocketTransport=s.createServerSocketTransport,t.ProgressType=s.ProgressType,i(n(1284)),i(n(1285));const r=n(1296),o=n(1297);!function(e){let t,n,i,s,a,c;!function(e){e.method=r.CallHierarchyPrepareRequest.method,e.type=r.CallHierarchyPrepareRequest.type}(t=e.CallHierarchyPrepareRequest||(e.CallHierarchyPrepareRequest={})),function(e){e.method=r.CallHierarchyIncomingCallsRequest.method,e.type=r.CallHierarchyIncomingCallsRequest.type}(n=e.CallHierarchyIncomingCallsRequest||(e.CallHierarchyIncomingCallsRequest={})),function(e){e.method=r.CallHierarchyOutgoingCallsRequest.method,e.type=r.CallHierarchyOutgoingCallsRequest.type}(i=e.CallHierarchyOutgoingCallsRequest||(e.CallHierarchyOutgoingCallsRequest={})),e.SemanticTokenTypes=o.SemanticTokenTypes,e.SemanticTokenModifiers=o.SemanticTokenModifiers,e.SemanticTokens=o.SemanticTokens,function(e){e.method=o.SemanticTokensRequest.method,e.type=o.SemanticTokensRequest.type}(s=e.SemanticTokensRequest||(e.SemanticTokensRequest={})),function(e){e.method=o.SemanticTokensEditsRequest.method,e.type=o.SemanticTokensEditsRequest.type}(a=e.SemanticTokensEditsRequest||(e.SemanticTokensEditsRequest={})),function(e){e.method=o.SemanticTokensRangeRequest.method,e.type=o.SemanticTokensRangeRequest.type}(c=e.SemanticTokensRangeRequest||(e.SemanticTokensRangeRequest={}))}(t.Proposed||(t.Proposed={})),t.createProtocolConnection=function(e,t,n,i){return s.createMessageConnection(e,t,n,i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(6);t.userAuthStateTracker=new class{constructor(){this.userInfoChangedEmitter=new i.EventEmitter,this.onUserInfoChanged=this.userInfoChangedEmitter.event,this.isCustomAccount=!1,this.defaultAuthAttemptCompleteSignal=new s.Signal}get userInfo(){return this.userInfo_}set userInfo(e){this.userInfo_=e,this.userInfoChangedEmitter.fire()}isCurrentUserAnonymous(){return!(!this.userInfo||!this.userInfo.isAnonymous)}get IsSignedIn(){return!!this.userInfo}completeDefaultAuthAttempt(){this.defaultAuthAttemptCompleteSignal.resolve({})}}},function(e,t,n){"use strict";var i=n(897),s=n(898);function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=S,t.resolve=function(e,t){return S(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?S(e,!1,!0).resolveObject(t):t},t.format=function(e){s.isString(e)&&(e=S(e));return e instanceof r?e.format():r.prototype.format.call(e)},t.Url=r;var o=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(l),d=["%","/","?",";","#"].concat(u),h=["/","?","#"],f=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},y={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=n(223);function S(e,t,n){if(e&&s.isObject(e)&&e instanceof r)return e;var i=new r;return i.parse(e,t,n),i}r.prototype.parse=function(e,t,n){if(!s.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),a=-1!==r&&r<e.indexOf("#")?"?":"#",l=e.split(a);l[0]=l[0].replace(/\\/g,"/");var S=e=l.join(a);if(S=S.trim(),!n&&1===e.split("#").length){var _=c.exec(S);if(_)return this.path=S,this.href=S,this.pathname=_[1],_[2]?(this.search=_[2],this.query=t?v.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var E=o.exec(S);if(E){var w=(E=E[0]).toLowerCase();this.protocol=w,S=S.substr(E.length)}if(n||E||S.match(/^\/\/[^@\/]+@[^@\/]+/)){var b="//"===S.substr(0,2);!b||E&&g[E]||(S=S.substr(2),this.slashes=!0)}if(!g[E]&&(b||E&&!y[E])){for(var C,T,M=-1,A=0;A<h.length;A++){-1!==(k=S.indexOf(h[A]))&&(-1===M||k<M)&&(M=k)}-1!==(T=-1===M?S.lastIndexOf("@"):S.lastIndexOf("@",M))&&(C=S.slice(0,T),S=S.slice(T+1),this.auth=decodeURIComponent(C)),M=-1;for(A=0;A<d.length;A++){var k;-1!==(k=S.indexOf(d[A]))&&(-1===M||k<M)&&(M=k)}-1===M&&(M=S.length),this.host=S.slice(0,M),S=S.slice(M),this.parseHost(),this.hostname=this.hostname||"";var R="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!R)for(var P=this.hostname.split(/\./),I=(A=0,P.length);A<I;A++){var N=P[A];if(N&&!N.match(f)){for(var L="",D=0,x=N.length;D<x;D++)N.charCodeAt(D)>127?L+="x":L+=N[D];if(!L.match(f)){var O=P.slice(0,A),F=P.slice(A+1),U=N.match(p);U&&(O.push(U[1]),F.unshift(U[2])),F.length&&(S="/"+F.join(".")+S),this.hostname=O.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),R||(this.hostname=i.toASCII(this.hostname));var j=this.port?":"+this.port:"",H=this.hostname||"";this.host=H+j,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==S[0]&&(S="/"+S))}if(!m[w])for(A=0,I=u.length;A<I;A++){var B=u[A];if(-1!==S.indexOf(B)){var Y=encodeURIComponent(B);Y===B&&(Y=escape(B)),S=S.split(B).join(Y)}}var W=S.indexOf("#");-1!==W&&(this.hash=S.substr(W),S=S.slice(0,W));var q=S.indexOf("?");if(-1!==q?(this.search=S.substr(q),this.query=S.substr(q+1),t&&(this.query=v.parse(this.query)),S=S.slice(0,q)):t&&(this.search="",this.query={}),S&&(this.pathname=S),y[w]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){j=this.pathname||"";var V=this.search||"";this.path=j+V}return this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",i=this.hash||"",r=!1,o="";this.host?r=e+this.host:this.hostname&&(r=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&s.isObject(this.query)&&Object.keys(this.query).length&&(o=v.stringify(this.query));var a=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||y[t])&&!1!==r?(r="//"+(r||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):r||(r=""),i&&"#"!==i.charAt(0)&&(i="#"+i),a&&"?"!==a.charAt(0)&&(a="?"+a),t+r+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+i},r.prototype.resolve=function(e){return this.resolveObject(S(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(s.isString(e)){var t=new r;t.parse(e,!1,!0),e=t}for(var n=new r,i=Object.keys(this),o=0;o<i.length;o++){var a=i[o];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var c=Object.keys(e),l=0;l<c.length;l++){var u=c[l];"protocol"!==u&&(n[u]=e[u])}return y[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!y[e.protocol]){for(var d=Object.keys(e),h=0;h<d.length;h++){var f=d[h];n[f]=e[f]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||g[e.protocol])n.pathname=e.pathname;else{for(var p=(e.pathname||"").split("/");p.length&&!(e.host=p.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),n.pathname=p.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var m=n.pathname||"",v=n.search||"";n.path=m+v}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var S=n.pathname&&"/"===n.pathname.charAt(0),_=e.host||e.pathname&&"/"===e.pathname.charAt(0),E=_||S||n.host&&e.pathname,w=E,b=n.pathname&&n.pathname.split("/")||[],C=(p=e.pathname&&e.pathname.split("/")||[],n.protocol&&!y[n.protocol]);if(C&&(n.hostname="",n.port=null,n.host&&(""===b[0]?b[0]=n.host:b.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===p[0]?p[0]=e.host:p.unshift(e.host)),e.host=null),E=E&&(""===p[0]||""===b[0])),_)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,b=p;else if(p.length)b||(b=[]),b.pop(),b=b.concat(p),n.search=e.search,n.query=e.query;else if(!s.isNullOrUndefined(e.search)){if(C)n.hostname=n.host=b.shift(),(R=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=R.shift(),n.host=n.hostname=R.shift());return n.search=e.search,n.query=e.query,s.isNull(n.pathname)&&s.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!b.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var T=b.slice(-1)[0],M=(n.host||e.host||b.length>1)&&("."===T||".."===T)||""===T,A=0,k=b.length;k>=0;k--)"."===(T=b[k])?b.splice(k,1):".."===T?(b.splice(k,1),A++):A&&(b.splice(k,1),A--);if(!E&&!w)for(;A--;A)b.unshift("..");!E||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),M&&"/"!==b.join("/").substr(-1)&&b.push("");var R,P=""===b[0]||b[0]&&"/"===b[0].charAt(0);C&&(n.hostname=n.host=P?"":b.length?b.shift():"",(R=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=R.shift(),n.host=n.hostname=R.shift()));return(E=E||n.host&&b.length)&&!P&&b.unshift(""),b.length?n.pathname=b.join("/"):(n.pathname=null,n.path=null),s.isNull(n.pathname)&&s.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(968);class s{static getCoreCommand(e){const t=e;return t.next?s.getCoreCommand(t.next):t}static setupDecorator(e){return s.setupDecoratorInner(t=>s.buildMetaProfilingCommandDecorator(e(t)))}static setupDecoratorInner(e){return t=>{const n=function(...n){const i="f"===t.name?t.apply(this,n):s.buildMetaProfilingCommandDecorator(new t(...n));return e(i)};return n.prototype=t.prototype,n}}static buildMetaProfilingCommandDecorator(e){return new i.MetaProfilingCommandDecorator(s.getCoreCommand(e),e)}}t.DecoratorHelper=s},function(e,t,n){e.exports=s;var i=n(24).EventEmitter;function s(){i.call(this)}n(12)(s,i),s.Readable=n(76),s.Writable=n(746),s.Duplex=n(747),s.Transform=n(748),s.PassThrough=n(749),s.Stream=s,s.prototype.pipe=function(e,t){var n=this;function s(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function r(){n.readable&&n.resume&&n.resume()}n.on("data",s),e.on("drain",r),e._isStdio||t&&!1===t.end||(n.on("end",a),n.on("close",c));var o=!1;function a(){o||(o=!0,e.end())}function c(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){if(u(),0===i.listenerCount(this,"error"))throw e}function u(){n.removeListener("data",s),e.removeListener("drain",r),n.removeListener("end",a),n.removeListener("close",c),n.removeListener("error",l),e.removeListener("error",l),n.removeListener("end",u),n.removeListener("close",u),e.removeListener("close",u)}return n.on("error",l),e.on("error",l),n.on("end",u),n.on("close",u),e.on("close",u),e.emit("pipe",n),e}},function(e,t,n){"use strict";var i=n(398),s=Object.prototype.toString;function r(e){return"[object Array]"===s.call(e)}function o(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==s.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function l(e){return"[object Function]"===s.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),r(e))for(var n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}e.exports={isArray:r,isArrayBuffer:function(e){return"[object ArrayBuffer]"===s.call(e)},isBuffer:function(e){return null!==e&&!o(e)&&null!==e.constructor&&!o(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:c,isUndefined:o,isDate:function(e){return"[object Date]"===s.call(e)},isFile:function(e){return"[object File]"===s.call(e)},isBlob:function(e){return"[object Blob]"===s.call(e)},isFunction:l,isStream:function(e){return a(e)&&l(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:u,merge:function e(){var t={};function n(n,i){c(t[i])&&c(n)?t[i]=e(t[i],n):c(n)?t[i]=e({},n):r(n)?t[i]=n.slice():t[i]=n}for(var i=0,s=arguments.length;i<s;i++)u(arguments[i],n);return t},extend:function(e,t,n){return u(t,(function(t,s){e[s]=n&&"function"==typeof t?i(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatBuffer=t.SshDataWriter=t.SshDataReader=void 0;const i=n(3),s=n(98),r=n(51);class o{constructor(e){this.buffer=e,this.position=0}get available(){return this.buffer.length-this.position}read(e){if(this.available<e)throw new Error("Attempted to read past end of buffer.");const t=this.buffer.slice(this.position,this.position+e);return this.position+=e,t}readByte(){if(0===this.available)throw new Error("Attempted to read past end of buffer.");const e=this.buffer[this.position];return this.position++,e}readBinary(){const e=this.readUInt32();if(this.available<e)throw new Error("Attempted to read past end of buffer.");const t=this.buffer.slice(this.position,this.position+e);return this.position+=e,t}readString(e){return this.readBinary().toString()}readList(e){const t=this.readString(e);return 0===t.length?[]:t.split(",")}readBoolean(){return 0!==this.readByte()}readUInt32(){if(this.available<4)throw new Error("Attempted to read past end of buffer.");const e=this.buffer[this.position+0],t=this.buffer[this.position+1],n=this.buffer[this.position+2],i=this.buffer[this.position+3];return this.position+=4,(e<<24|t<<16|n<<8|i)>>>0}readUInt64(){if(this.available<8)throw new Error("Attempted to read past end of buffer.");const e=this.buffer[this.position+0],t=this.buffer[this.position+1],n=this.buffer[this.position+2],i=this.buffer[this.position+3],s=this.buffer[this.position+4],r=this.buffer[this.position+5],o=this.buffer[this.position+6],a=this.buffer[this.position+7];return this.position+=8,4294967296*((e<<24|t<<16|n<<8|i)>>>0)+((s<<24|r<<16|o<<8|a)>>>0)}readBigInt(){const e=this.readBinary();return 0===e.length?r.BigInt.zero:r.BigInt.fromBytes(e)}}t.SshDataReader=o,o.mpintZero=i.Buffer.alloc(1);let a;t.SshDataWriter=class{constructor(e){this.buffer=e,this.position=0}write(e){this.ensureCapacity(this.position+e.length),e.copy(this.buffer,this.position),this.position+=e.length}writeByte(e){this.ensureCapacity(this.position+1),this.buffer[this.position]=e,this.position++}writeBinary(e){this.ensureCapacity(this.position+4+e.length),this.writeUInt32(e.length),e.copy(this.buffer,this.position),this.position+=e.length}writeString(e,t){this.writeBinary(i.Buffer.from(e))}writeList(e,t){this.writeString(e?e.join(","):"",t)}writeBoolean(e){this.writeByte(e?1:0)}writeUInt32(e){this.ensureCapacity(this.position+4),this.buffer[this.position+0]=e>>>24,this.buffer[this.position+1]=e>>>16,this.buffer[this.position+2]=e>>>8,this.buffer[this.position+3]=e>>>0,this.position+=4}writeUInt64(e){this.ensureCapacity(this.position+8);const t=4294967295&e,n=(e-t)/4294967296;this.buffer[this.position+0]=n>>>24,this.buffer[this.position+1]=n>>>16,this.buffer[this.position+2]=n>>>8,this.buffer[this.position+3]=n>>>0,this.buffer[this.position+4]=t>>>24,this.buffer[this.position+5]=t>>>16,this.buffer[this.position+6]=t>>>8,this.buffer[this.position+7]=t>>>0,this.position+=8}writeBigInt(e){const t=e.toBytes();1===t.length&&0===t[0]?this.writeUInt32(0):this.writeBinary(t)}writeRandom(e){this.ensureCapacity(this.position+e);const t=this.buffer.slice(this.position,this.position+e);s.SshAlgorithms.random.getBytes(t),this.position+=e}skip(e){this.ensureCapacity(this.position+e),this.position+=e}ensureCapacity(e){if(this.buffer.length<e){let t=Math.max(512,2*this.buffer.length);for(;t<e;)t*=2;const n=i.Buffer.alloc(t);this.buffer.copy(n,0,0,this.position),this.buffer=n}}toBuffer(){return this.buffer.slice(0,this.position)}},t.formatBuffer=function(e,t,n){let i=`${void 0===t?"Buffer":t}[${e.length}] (${function(e){a||(a=function(){let e;const t=[];for(let n=0;n<256;n++){e=n;for(let t=0;t<8;t++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}());let t=-1;for(let n=0;n<e.length;n++)t=t>>>8^a[255&(t^e[n])];return(((-1^t)>>>0)+4294967296).toString(16).substr(-8).toUpperCase()}(e)})\n`;if(!1===n)return i;const s=Math.min(2048,e.length);for(let t=0;t<s;t+=16){t<1e3&&(i+="0"),t<100&&(i+="0"),t<10&&(i+="0"),i+=t+":";for(let n=t;n<t+16;n++)i+=n<s?" "+e.slice(n,n+1).toString("hex"):"   ";i+="  ";for(let n=t;n<t+16;n++)if(n<s){const t=e[n];i+=t>32&&t<=127?e.slice(n,n+1).toString():"."}else i+=" ";i+="\n"}return s<e.length&&(i+="...\n"),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatBuffer=t.SshDataWriter=t.SshDataReader=void 0;const i=n(3),s=n(103),r=n(53);class o{constructor(e){this.buffer=e,this.position=0}get available(){return this.buffer.length-this.position}read(e){if(this.available<e)throw new Error("Attempted to read past end of buffer.");const t=this.buffer.slice(this.position,this.position+e);return this.position+=e,t}readByte(){if(0===this.available)throw new Error("Attempted to read past end of buffer.");const e=this.buffer[this.position];return this.position++,e}readBinary(){const e=this.readUInt32();if(this.available<e)throw new Error("Attempted to read past end of buffer.");const t=this.buffer.slice(this.position,this.position+e);return this.position+=e,t}readString(e){return this.readBinary().toString()}readList(e){const t=this.readString(e);return 0===t.length?[]:t.split(",")}readBoolean(){return 0!==this.readByte()}readUInt32(){if(this.available<4)throw new Error("Attempted to read past end of buffer.");const e=this.buffer[this.position+0],t=this.buffer[this.position+1],n=this.buffer[this.position+2],i=this.buffer[this.position+3];return this.position+=4,(e<<24|t<<16|n<<8|i)>>>0}readUInt64(){if(this.available<8)throw new Error("Attempted to read past end of buffer.");const e=this.buffer[this.position+0],t=this.buffer[this.position+1],n=this.buffer[this.position+2],i=this.buffer[this.position+3],s=this.buffer[this.position+4],r=this.buffer[this.position+5],o=this.buffer[this.position+6],a=this.buffer[this.position+7];return this.position+=8,4294967296*((e<<24|t<<16|n<<8|i)>>>0)+((s<<24|r<<16|o<<8|a)>>>0)}readBigInt(){const e=this.readBinary();return 0===e.length?r.BigInt.zero:r.BigInt.fromBytes(e)}}t.SshDataReader=o,o.mpintZero=i.Buffer.alloc(1);let a;t.SshDataWriter=class{constructor(e){this.buffer=e,this.position=0}write(e){this.ensureCapacity(this.position+e.length),e.copy(this.buffer,this.position),this.position+=e.length}writeByte(e){this.ensureCapacity(this.position+1),this.buffer[this.position]=e,this.position++}writeBinary(e){this.ensureCapacity(this.position+4+e.length),this.writeUInt32(e.length),e.copy(this.buffer,this.position),this.position+=e.length}writeString(e,t){this.writeBinary(i.Buffer.from(e))}writeList(e,t){this.writeString(e?e.join(","):"",t)}writeBoolean(e){this.writeByte(e?1:0)}writeUInt32(e){this.ensureCapacity(this.position+4),this.buffer[this.position+0]=e>>>24,this.buffer[this.position+1]=e>>>16,this.buffer[this.position+2]=e>>>8,this.buffer[this.position+3]=e>>>0,this.position+=4}writeUInt64(e){this.ensureCapacity(this.position+8);const t=4294967295&e,n=(e-t)/4294967296;this.buffer[this.position+0]=n>>>24,this.buffer[this.position+1]=n>>>16,this.buffer[this.position+2]=n>>>8,this.buffer[this.position+3]=n>>>0,this.buffer[this.position+4]=t>>>24,this.buffer[this.position+5]=t>>>16,this.buffer[this.position+6]=t>>>8,this.buffer[this.position+7]=t>>>0,this.position+=8}writeBigInt(e){const t=e.toBytes();1===t.length&&0===t[0]?this.writeUInt32(0):this.writeBinary(t)}writeRandom(e){this.ensureCapacity(this.position+e);const t=this.buffer.slice(this.position,this.position+e);s.SshAlgorithms.random.getBytes(t),this.position+=e}skip(e){this.ensureCapacity(this.position+e),this.position+=e}ensureCapacity(e){if(this.buffer.length<e){let t=Math.max(512,2*this.buffer.length);for(;t<e;)t*=2;const n=i.Buffer.alloc(t);this.buffer.copy(n,0,0,this.position),this.buffer=n}}toBuffer(){return this.buffer.slice(0,this.position)}},t.formatBuffer=function(e,t,n){let i=`${void 0===t?"Buffer":t}[${e.length}] (${function(e){a||(a=function(){let e;const t=[];for(let n=0;n<256;n++){e=n;for(let t=0;t<8;t++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}());let t=-1;for(let n=0;n<e.length;n++)t=t>>>8^a[255&(t^e[n])];return(((-1^t)>>>0)+4294967296).toString(16).substr(-8).toUpperCase()}(e)})\n`;if(!1===n)return i;const s=Math.min(2048,e.length);for(let t=0;t<s;t+=16){t<1e3&&(i+="0"),t<100&&(i+="0"),t<10&&(i+="0"),i+=t+":";for(let n=t;n<t+16;n++)i+=n<s?" "+e.slice(n,n+1).toString("hex"):"   ";i+="  ";for(let n=t;n<t+16;n++)if(n<s){const t=e[n];i+=t>32&&t<=127?e.slice(n,n+1).toString():"."}else i+=" ";i+="\n"}return s<e.length&&(i+="...\n"),i}},function(e,t){function n(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=n,n.equal=function(e,t,n){if(e!=t)throw new Error(n||"Assertion failed: "+e+" != "+t)}},function(e,t,n){"use strict";var i=t,s=n(25),r=n(38),o=n(351);i.assert=r,i.toArray=o.toArray,i.zero2=o.zero2,i.toHex=o.toHex,i.encode=o.encode,i.getNAF=function(e,t,n){var i=new Array(Math.max(e.bitLength(),n)+1);i.fill(0);for(var s=1<<t+1,r=e.clone(),o=0;o<i.length;o++){var a,c=r.andln(s-1);r.isOdd()?(a=c>(s>>1)-1?(s>>1)-c:c,r.isubn(a)):a=0,i[o]=a,r.iushrn(1)}return i},i.getJSF=function(e,t){var n=[[],[]];e=e.clone(),t=t.clone();for(var i,s=0,r=0;e.cmpn(-s)>0||t.cmpn(-r)>0;){var o,a,c=e.andln(3)+s&3,l=t.andln(3)+r&3;3===c&&(c=-1),3===l&&(l=-1),o=0==(1&c)?0:3!==(i=e.andln(7)+s&7)&&5!==i||2!==l?c:-c,n[0].push(o),a=0==(1&l)?0:3!==(i=t.andln(7)+r&7)&&5!==i||2!==c?l:-l,n[1].push(a),2*s===o+1&&(s=1-s),2*r===a+1&&(r=1-r),e.iushrn(1),t.iushrn(1)}return n},i.cachedProperty=function(e,t,n){var i="_"+t;e.prototype[t]=function(){return void 0!==this[i]?this[i]:this[i]=n.call(this)}},i.parseBytes=function(e){return"string"==typeof e?i.toArray(e,"hex"):e},i.intFromLE=function(e){return new s(e,"hex","le")}},function(e,t,n){var i=t.global=n(1253),s=t.hasBuffer=i&&!!i.isBuffer,r=t.hasArrayBuffer="undefined"!=typeof ArrayBuffer,o=t.isArray=n(115);t.isArrayBuffer=r?function(e){return e instanceof ArrayBuffer||p(e)}:y;var a=t.isBuffer=s?i.isBuffer:y,c=t.isView=r?ArrayBuffer.isView||v("ArrayBuffer","buffer"):y;t.alloc=f,t.concat=function(e,n){n||(n=0,Array.prototype.forEach.call(e,(function(e){n+=e.length})));var i=this!==t&&this||e[0],s=f.call(i,n),r=0;return Array.prototype.forEach.call(e,(function(e){r+=h.copy.call(e,s,r)})),s},t.from=function(e){return"string"==typeof e?m.call(this,e):g(this).from(e)};var l=t.Array=n(1254),u=t.Buffer=n(1255),d=t.Uint8Array=n(1256),h=t.prototype=n(302);function f(e){return g(this).alloc(e)}var p=v("ArrayBuffer");function m(e){var t=3*e.length,n=f.call(this,t),i=h.write.call(n,e);return t!==i&&(n=h.slice.call(n,0,i)),n}function g(e){return a(e)?u:c(e)?d:o(e)?l:s?u:r?d:l}function y(){return!1}function v(e,t){return e="[object "+e+"]",function(n){return null!=n&&{}.toString.call(t?n[t]:n)===e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(56);class s extends i.RequestType0{constructor(e){super(e)}}t.ProtocolRequestType0=s;class r extends i.RequestType{constructor(e){super(e)}}t.ProtocolRequestType=r;class o extends i.NotificationType{constructor(e){super(e)}}t.ProtocolNotificationType=o;class a extends i.NotificationType0{constructor(e){super(e)}}t.ProtocolNotificationType0=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(396),s=n(9),r=n(22),o=n(69),a=n(13);class c{setSharedProperty(e,t){s.Telemetry.addContextProperty(e,t)}postEvent(e,t){const n=new s.TelemetryEvent(e);for(let[e,i]of t)n.addProperty(e,i);n.send()}}let l;t.getExpService=function(){return l},t.initAsync=async function(e,t){const n=`${o.LIVESHARE_EXTENSION_ID}${t?"-web":""}`,s=r.ExtensionUtil.getExtensionVersion(o.LIVESHARE_EXTENSION_ID);l=await i.getExperimentationServiceAsync(n,s,a.Settings.isVSLSTeamMember?i.TargetPopulation.Team:a.Settings.isInternalFeatureSet?i.TargetPopulation.Internal:a.Settings.isInsidersFeatureSet?i.TargetPopulation.Insiders:i.TargetPopulation.Public,new c,e.globalState)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectDisposedError=t.SshReconnectError=t.SshConnectionError=t.SshChannelError=t.BigInt=t.DerWriter=t.DerReader=t.formatBuffer=t.SshDataWriter=t.SshDataReader=t.ECDsa=t.Rsa=t.Encryption=t.HmacAlgorithm=t.EncryptionAlgorithm=t.PublicKeyAlgorithm=t.KeyExchangeAlgorithm=t.SshAlgorithms=t.CommandRequestMessage=t.ChannelRequestType=t.ChannelRequestMessage=t.ChannelOpenMessage=t.SshChannelOpenFailureReason=t.SshReconnectFailureReason=t.SshDisconnectReason=t.SessionRequestFailureMessage=t.SessionRequestSuccessMessage=t.DebugMessage=t.SessionRequestMessage=t.SshMessage=t.SshChannelClosedEventArgs=t.SshSessionClosedEventArgs=t.SshChannelOpeningEventArgs=t.SshRequestEventArgs=t.SshAuthenticatingEventArgs=t.SshAuthenticationType=t.serviceActivation=t.SshService=t.SshRpcMessageStream=t.WebSocketStream=t.NodeStream=t.BaseStream=t.SshStream=t.SshChannel=t.SshServerSession=t.SshClientSession=t.SshSession=t.SshVersionInfo=t.SshProtocolExtensionNames=t.SshSessionConfiguration=void 0,t.MultiChannelStream=t.SessionContour=t.ChannelMetrics=t.SessionMetrics=t.Queue=t.Semaphore=t.PromiseCompletionSource=t.CancellationError=t.CancellationTokenSource=t.CancellationToken=void 0;var i=n(131);Object.defineProperty(t,"SshSessionConfiguration",{enumerable:!0,get:function(){return i.SshSessionConfiguration}}),Object.defineProperty(t,"SshProtocolExtensionNames",{enumerable:!0,get:function(){return i.SshProtocolExtensionNames}});var s=n(439);Object.defineProperty(t,"SshVersionInfo",{enumerable:!0,get:function(){return s.SshVersionInfo}});var r=n(133);Object.defineProperty(t,"SshSession",{enumerable:!0,get:function(){return r.SshSession}});var o=n(1013);Object.defineProperty(t,"SshClientSession",{enumerable:!0,get:function(){return o.SshClientSession}});var a=n(1014);Object.defineProperty(t,"SshServerSession",{enumerable:!0,get:function(){return a.SshServerSession}});var c=n(255);Object.defineProperty(t,"SshChannel",{enumerable:!0,get:function(){return c.SshChannel}});var l=n(444);Object.defineProperty(t,"SshStream",{enumerable:!0,get:function(){return l.SshStream}});var u=n(1015);Object.defineProperty(t,"BaseStream",{enumerable:!0,get:function(){return u.BaseStream}}),Object.defineProperty(t,"NodeStream",{enumerable:!0,get:function(){return u.NodeStream}}),Object.defineProperty(t,"WebSocketStream",{enumerable:!0,get:function(){return u.WebSocketStream}});var d=n(1016);Object.defineProperty(t,"SshRpcMessageStream",{enumerable:!0,get:function(){return d.SshRpcMessageStream}});var h=n(174);Object.defineProperty(t,"SshService",{enumerable:!0,get:function(){return h.SshService}});var f=n(99);Object.defineProperty(t,"serviceActivation",{enumerable:!0,get:function(){return f.serviceActivation}});var p=n(259);Object.defineProperty(t,"SshAuthenticationType",{enumerable:!0,get:function(){return p.SshAuthenticationType}}),Object.defineProperty(t,"SshAuthenticatingEventArgs",{enumerable:!0,get:function(){return p.SshAuthenticatingEventArgs}});var m=n(256);Object.defineProperty(t,"SshRequestEventArgs",{enumerable:!0,get:function(){return m.SshRequestEventArgs}});var g=n(440);Object.defineProperty(t,"SshChannelOpeningEventArgs",{enumerable:!0,get:function(){return g.SshChannelOpeningEventArgs}});var y=n(443);Object.defineProperty(t,"SshSessionClosedEventArgs",{enumerable:!0,get:function(){return y.SshSessionClosedEventArgs}});var v=n(438);Object.defineProperty(t,"SshChannelClosedEventArgs",{enumerable:!0,get:function(){return v.SshChannelClosedEventArgs}});var S=n(100);Object.defineProperty(t,"SshMessage",{enumerable:!0,get:function(){return S.SshMessage}});var _=n(52);Object.defineProperty(t,"SessionRequestMessage",{enumerable:!0,get:function(){return _.SessionRequestMessage}}),Object.defineProperty(t,"DebugMessage",{enumerable:!0,get:function(){return _.DebugMessage}}),Object.defineProperty(t,"SessionRequestSuccessMessage",{enumerable:!0,get:function(){return _.SessionRequestSuccessMessage}}),Object.defineProperty(t,"SessionRequestFailureMessage",{enumerable:!0,get:function(){return _.SessionRequestFailureMessage}}),Object.defineProperty(t,"SshDisconnectReason",{enumerable:!0,get:function(){return _.SshDisconnectReason}}),Object.defineProperty(t,"SshReconnectFailureReason",{enumerable:!0,get:function(){return _.SshReconnectFailureReason}});var E=n(80);Object.defineProperty(t,"SshChannelOpenFailureReason",{enumerable:!0,get:function(){return E.SshChannelOpenFailureReason}}),Object.defineProperty(t,"ChannelOpenMessage",{enumerable:!0,get:function(){return E.ChannelOpenMessage}}),Object.defineProperty(t,"ChannelRequestMessage",{enumerable:!0,get:function(){return E.ChannelRequestMessage}}),Object.defineProperty(t,"ChannelRequestType",{enumerable:!0,get:function(){return E.ChannelRequestType}}),Object.defineProperty(t,"CommandRequestMessage",{enumerable:!0,get:function(){return E.CommandRequestMessage}});var w=n(98);Object.defineProperty(t,"SshAlgorithms",{enumerable:!0,get:function(){return w.SshAlgorithms}}),Object.defineProperty(t,"KeyExchangeAlgorithm",{enumerable:!0,get:function(){return w.KeyExchangeAlgorithm}}),Object.defineProperty(t,"PublicKeyAlgorithm",{enumerable:!0,get:function(){return w.PublicKeyAlgorithm}}),Object.defineProperty(t,"EncryptionAlgorithm",{enumerable:!0,get:function(){return w.EncryptionAlgorithm}}),Object.defineProperty(t,"HmacAlgorithm",{enumerable:!0,get:function(){return w.HmacAlgorithm}}),Object.defineProperty(t,"Encryption",{enumerable:!0,get:function(){return w.Encryption}}),Object.defineProperty(t,"Rsa",{enumerable:!0,get:function(){return w.Rsa}}),Object.defineProperty(t,"ECDsa",{enumerable:!0,get:function(){return w.ECDsa}});var b=n(36);Object.defineProperty(t,"SshDataReader",{enumerable:!0,get:function(){return b.SshDataReader}}),Object.defineProperty(t,"SshDataWriter",{enumerable:!0,get:function(){return b.SshDataWriter}}),Object.defineProperty(t,"formatBuffer",{enumerable:!0,get:function(){return b.formatBuffer}});var C=n(254);Object.defineProperty(t,"DerReader",{enumerable:!0,get:function(){return C.DerReader}}),Object.defineProperty(t,"DerWriter",{enumerable:!0,get:function(){return C.DerWriter}});var T=n(51);Object.defineProperty(t,"BigInt",{enumerable:!0,get:function(){return T.BigInt}});var M=n(45);Object.defineProperty(t,"SshChannelError",{enumerable:!0,get:function(){return M.SshChannelError}}),Object.defineProperty(t,"SshConnectionError",{enumerable:!0,get:function(){return M.SshConnectionError}}),Object.defineProperty(t,"SshReconnectError",{enumerable:!0,get:function(){return M.SshReconnectError}}),Object.defineProperty(t,"ObjectDisposedError",{enumerable:!0,get:function(){return M.ObjectDisposedError}});var A=n(82);Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return A.CancellationToken}}),Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return A.CancellationTokenSource}}),Object.defineProperty(t,"CancellationError",{enumerable:!0,get:function(){return A.CancellationError}});var k=n(81);Object.defineProperty(t,"PromiseCompletionSource",{enumerable:!0,get:function(){return k.PromiseCompletionSource}});var R=n(134);Object.defineProperty(t,"Semaphore",{enumerable:!0,get:function(){return R.Semaphore}});var P=n(173);Object.defineProperty(t,"Queue",{enumerable:!0,get:function(){return P.Queue}});var I=n(442);Object.defineProperty(t,"SessionMetrics",{enumerable:!0,get:function(){return I.SessionMetrics}});var N=n(437);Object.defineProperty(t,"ChannelMetrics",{enumerable:!0,get:function(){return N.ChannelMetrics}});var L=n(1017);Object.defineProperty(t,"SessionContour",{enumerable:!0,get:function(){return L.SessionContour}});var D=n(1018);Object.defineProperty(t,"MultiChannelStream",{enumerable:!0,get:function(){return D.MultiChannelStream}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.traceData=t.trace=void 0;const i=n(433).name.replace(/^@\w+\//,""),s=n(252),r=s(i);t.trace=r;const o=s(i+":ssh"),a=s(i+":data");t.traceData=a,o.enabled&&(r.enabled=!0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectDisposedError=t.SshChannelError=t.SshReconnectError=t.SshConnectionError=void 0;class i extends Error{constructor(e,t){super(e),this.reason=t}}t.SshConnectionError=i;class s extends Error{constructor(e,t){super(e),this.reason=t}}t.SshReconnectError=s;class r extends Error{constructor(e,t){super(e),this.reason=t}}t.SshChannelError=r;class o extends Error{constructor(e){var t,n;let i;i="string"==typeof e?e:"function"==typeof e?e.name+" disposed.":(null!==(n=null===(t=null==e?void 0:e.constructor)||void 0===t?void 0:t.name)&&void 0!==n?n:"Object ")+" disposed.",super(i)}}t.ObjectDisposedError=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.traceData=t.trace=void 0;const i=n(476).name.replace(/^@\w+\//,""),s=n(252),r=s(i);t.trace=r;const o=s(i+":ssh"),a=s(i+":data");t.traceData=a,o.enabled&&(r.enabled=!0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectDisposedError=t.SshChannelError=t.SshReconnectError=t.SshConnectionError=void 0;class i extends Error{constructor(e,t){super(e),this.reason=t}}t.SshConnectionError=i;class s extends Error{constructor(e,t){super(e),this.reason=t}}t.SshReconnectError=s;class r extends Error{constructor(e,t){super(e),this.reason=t}}t.SshChannelError=r;class o extends Error{constructor(e){var t,n;let i;i="string"==typeof e?e:"function"==typeof e?e.name+" disposed.":(null!==(n=null===(t=null==e?void 0:e.constructor)||void 0===t?void 0:t.name)&&void 0!==n?n:"Object ")+" disposed.",super(i)}}t.ObjectDisposedError=o},function(e,t,n){"use strict";var i=n(38),s=n(12);function r(e,t){return 55296==(64512&e.charCodeAt(t))&&(!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1)))}function o(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function a(e){return 1===e.length?"0"+e:e}function c(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}t.inherits=s,t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),s=0;s<e.length;s+=2)n.push(parseInt(e[s]+e[s+1],16))}else for(var i=0,s=0;s<e.length;s++){var o=e.charCodeAt(s);o<128?n[i++]=o:o<2048?(n[i++]=o>>6|192,n[i++]=63&o|128):r(e,s)?(o=65536+((1023&o)<<10)+(1023&e.charCodeAt(++s)),n[i++]=o>>18|240,n[i++]=o>>12&63|128,n[i++]=o>>6&63|128,n[i++]=63&o|128):(n[i++]=o>>12|224,n[i++]=o>>6&63|128,n[i++]=63&o|128)}else for(s=0;s<e.length;s++)n[s]=0|e[s];return n},t.toHex=function(e){for(var t="",n=0;n<e.length;n++)t+=a(e[n].toString(16));return t},t.htonl=o,t.toHex32=function(e,t){for(var n="",i=0;i<e.length;i++){var s=e[i];"little"===t&&(s=o(s)),n+=c(s.toString(16))}return n},t.zero2=a,t.zero8=c,t.join32=function(e,t,n,s){var r=n-t;i(r%4==0);for(var o=new Array(r/4),a=0,c=t;a<o.length;a++,c+=4){var l;l="big"===s?e[c]<<24|e[c+1]<<16|e[c+2]<<8|e[c+3]:e[c+3]<<24|e[c+2]<<16|e[c+1]<<8|e[c],o[a]=l>>>0}return o},t.split32=function(e,t){for(var n=new Array(4*e.length),i=0,s=0;i<e.length;i++,s+=4){var r=e[i];"big"===t?(n[s]=r>>>24,n[s+1]=r>>>16&255,n[s+2]=r>>>8&255,n[s+3]=255&r):(n[s+3]=r>>>24,n[s+2]=r>>>16&255,n[s+1]=r>>>8&255,n[s]=255&r)}return n},t.rotr32=function(e,t){return e>>>t|e<<32-t},t.rotl32=function(e,t){return e<<t|e>>>32-t},t.sum32=function(e,t){return e+t>>>0},t.sum32_3=function(e,t,n){return e+t+n>>>0},t.sum32_4=function(e,t,n,i){return e+t+n+i>>>0},t.sum32_5=function(e,t,n,i,s){return e+t+n+i+s>>>0},t.sum64=function(e,t,n,i){var s=e[t],r=i+e[t+1]>>>0,o=(r<i?1:0)+n+s;e[t]=o>>>0,e[t+1]=r},t.sum64_hi=function(e,t,n,i){return(t+i>>>0<t?1:0)+e+n>>>0},t.sum64_lo=function(e,t,n,i){return t+i>>>0},t.sum64_4_hi=function(e,t,n,i,s,r,o,a){var c=0,l=t;return c+=(l=l+i>>>0)<t?1:0,c+=(l=l+r>>>0)<r?1:0,e+n+s+o+(c+=(l=l+a>>>0)<a?1:0)>>>0},t.sum64_4_lo=function(e,t,n,i,s,r,o,a){return t+i+r+a>>>0},t.sum64_5_hi=function(e,t,n,i,s,r,o,a,c,l){var u=0,d=t;return u+=(d=d+i>>>0)<t?1:0,u+=(d=d+r>>>0)<r?1:0,u+=(d=d+a>>>0)<a?1:0,e+n+s+o+c+(u+=(d=d+l>>>0)<l?1:0)>>>0},t.sum64_5_lo=function(e,t,n,i,s,r,o,a,c,l){return t+i+r+a+l>>>0},t.rotr64_hi=function(e,t,n){return(t<<32-n|e>>>n)>>>0},t.rotr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0},t.shr64_hi=function(e,t,n){return e>>>n},t.shr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0}},function(e,t,n){var i=n(861),s=n(862),r=s;r.v1=i,r.v4=s,e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(18),s=n(49),r=n(0),o=n(5),a=n(68),c=n(409),l=n(21),u=n(23),d=n(13),h=n(232),f=n(410);class p{constructor(e,t){this.forcePrefixedRoot=e,this.fileService=t,this.localPathsToVslsPaths=new Map,this.vslsPathsToLocalPaths=new Map,this.vslsExternalUriToIds=new Map,this.vslsExternalIdToUris=new Map,this.scheme=`${d.Settings.scheme}:`}async init(){this.fileService().onExternalFilesChanged(e=>{e.changeType===o.vsls.CollectionChangeType.Add&&this.registerExternalFilesAsync(e.localPaths,e.vslsPaths)})}async registerExternalFilesAsync(e,t){if(null!=e)for(let n=0;n<e.length;++n){let i=a.PathUtil.normalizePath(e[n]),s=a.PathUtil.normalizePath(t[n]);this.localPathsToVslsPaths.set(i,s),this.vslsPathsToLocalPaths.set(s,i)}}getOriginalUri(e){let t=r.Uri.parse(e).toString().toLowerCase();if(!this.vslsExternalIdToUris.has(t))throw new Error("Unknown document id");return this.vslsExternalIdToUris.get(t)}code2ProtocolUriConverter(e){if(!e)return;if("http"===e.scheme.toLowerCase()||"https"===e.scheme.toLowerCase()||"command"===e.scheme.toLowerCase())return e.toString();const t=this.code2protocolWorkspaceFilesOnly(e);if(null!==t)return t.toString();let n=e.toString();if(this.vslsExternalUriToIds.has(n))return this.vslsExternalUriToIds.get(n);let o=i.basename(e.fsPath),a=s().replace(/-/g,""),c=r.Uri.parse(`${p.vslsExternalScheme}:/${a}/${o}`).toString().toLowerCase();return this.vslsExternalUriToIds.set(n,c),this.vslsExternalIdToUris.set(c,e),c}code2protocolWorkspaceFilesOnly(e){let t=r.workspace.getWorkspaceFolder(e);if(!t)return null;const n=r.workspace.asRelativePath(e,!1),i=a.PathUtil.convertToForwardSlashes(n);let s="";return(t.index>0||this.forcePrefixedRoot)&&(s=`~${t.index}/`),r.Uri.parse(`${this.scheme}/${s}${i}`)}protocol2CodeUriConverter(e){if(e)return this.protocolUri2CodeUriConverter(r.Uri.parse(e))}isExternalVslsPath(e){return e.startsWith(p.externalPrefix)&&e.length>p.externalPrefix.length+1}protocolUri2CodeUriConverter(e){const t=r.workspace.workspaceFolders?r.workspace.workspaceFolders[0]:null,n=e.scheme.toLowerCase(),s=e.path.startsWith(p.notebookCellPrefix);if(n===p.rawScheme&&t&&t.uri.scheme===p.rawScheme||"http"===n||"https"===n)return e.path.startsWith(p.gitPrefix)?this.LiveShareSourceControlUriFromRelativeGitUri(e):s?this.NotebookCellUriFromRelativeNotebookCellUri(e):e;if(n===p.vslsExternalScheme)return this.getOriginalUri(e.toString());if(n!==p.rawScheme)throw new Error("Unknown path format from the client");if(e.path.startsWith(p.untitledPrefix))return r.Uri.parse(`${p.untitledScheme}:${i.basename(e.path)}`);if(e.path.startsWith(p.gitPrefix))return this.GitUriFromRelativeGitUri(e);if(s)return this.NotebookCellUriFromRelativeNotebookCellUri(e);if((u.sessionStateTracker.State===l.SessionState.Shared||u.sessionStateTracker.State===l.SessionState.SharingInProgress)&&this.isExternalVslsPath(e.path)){let t=e.path,n=this.vslsPathsToLocalPaths.get(t);if(n)return r.Uri.parse(n)}if(!t)return e;let{moniker:o,relativePath:c}=a.PathUtil.getMonikerFromUri(e),d=parseInt(o,10);if(void 0===r.Uri.joinPath){let n=t.uri.fsPath;if(""!==o){const t=r.workspace.workspaceFolders[d];if(!t)return e;n=t.uri.fsPath}return(n.endsWith("/")||n.endsWith("\\"))&&(n=n.substr(0,n.length-1)),(c.startsWith("/")||c.startsWith("\\"))&&(c=c.substring(1)),r.Uri.file(i.join(n,c))}let h=t.uri;if(""!==o){const t=r.workspace.workspaceFolders[d];if(!t)return e;h=t.uri}return h.path.length>1&&(h.path.endsWith("/")||h.path.endsWith("\\"))&&(h=h.with({path:h.path.substring(0,h.path.length-1)})),r.Uri.joinPath(h,c)}relativePathToLocalPath(e){if(!e)return null;if(e.startsWith(this.scheme)||e.startsWith("file:"))throw new Error("Supplied path is not a relative path");let t=null;return t=e.startsWith("/")?`${this.scheme}${e}`:`${this.scheme}/${e}`,this.protocol2CodeUriConverter(t)}localPathToRelativePath(e){if(!e||e.scheme===p.outputScheme)return null;if(e.scheme===p.rawScheme)return e.path;if(e.scheme!==p.gitScheme&&e.scheme!==p.vslsSccScheme&&e.scheme!==p.notebookCellScheme){if(!!!r.workspace.getWorkspaceFolder(e)){if(u.sessionStateTracker.State===l.SessionState.Shared||u.sessionStateTracker.State===l.SessionState.SharingInProgress){if(e.scheme===p.untitledScheme){let t=this.localPathsToVslsPaths.get(e.fsPath);if(!t){let n=s().replace(/-/g,"");const i=r.workspace.asRelativePath(e,!1);return t=`${p.untitledPrefix}/${n}/${i}`,this.localPathsToVslsPaths.set(e.fsPath,t),this.vslsPathsToLocalPaths.set(t,e.fsPath),t}return t}let t=a.PathUtil.normalizePath(e.toString()),n=this.localPathsToVslsPaths.get(t);if(n)return n}return null}}if(e.scheme===p.gitScheme){let t=r.workspace.asRelativePath(e.fsPath,!1);return this.RelativeGitUriFromGitUri(e,t)}if(e.scheme===p.vslsSccScheme)return this.RelativeGitUriFromLiveShareSourceControlUri(e);if(e.scheme===p.notebookCellScheme)return this.RelativeNotebookCellPathFromLocalNotebookCellUri(e);const t=this.code2protocolWorkspaceFilesOnly(e);return null==t?void 0:t.path}getFromVslsPathsToLocalPaths(e){return this.vslsPathsToLocalPaths.get(e)}deleteFromVslsPathsToLocalPaths(e){return this.vslsPathsToLocalPaths.delete(e)}getFromLocalPathsToVslsPaths(e){return this.localPathsToVslsPaths.get(e)}deleteFromLocalPathsToVslsPaths(e){return this.localPathsToVslsPaths.delete(e)}LiveShareSourceControlUriFromRelativeGitUri(e){var t=this.GetRelativeGitUriDetails(e.path);if(t){let e=t.ref,n=t.hostPath;n.startsWith("/")&&(n=n.slice(1,n.length));let i=r.Uri.file(n),s=t.guestPath,o={path:i.fsPath,version:JSON.stringify({ref:e}),sccId:1,groupId:"workingTree",resourceUri:s},a=`vsls-scc:${i.fsPath}?${JSON.stringify(o)}`;return r.Uri.parse(a)}return null}resourceUriFromLiveShareSourceControlUri(e){let t=JSON.parse(e.query).resourceUri;return r.Uri.parse(t)}RelativeGitUriFromLiveShareSourceControlUri(e){let t=JSON.parse(e.query),n=void 0,i=null==t?void 0:t.version;if(i){let e=JSON.parse(i);n=null==e?void 0:e.ref}n||(n="~");let s=a.PathUtil.convertToForwardSlashes(e.path);return s.startsWith("/")&&(s=s.slice(1,s.length)),`${p.gitPrefix}/${n}/${s}::${t.resourceUri}`}RelativeGitUriFromGitUri(e,t){let n=JSON.parse(e.query);return`${p.gitPrefix}/${n.ref}${e.path}::${this.scheme}/${t}`}GitUriFromRelativeGitUri(e){var t=this.GetRelativeGitUriDetails(e.path);if(t){let e={path:r.Uri.file(t.hostPath).fsPath,ref:t.ref};return r.Uri.parse(`${p.gitScheme}:/${t.hostPath}?${JSON.stringify(e)}`)}return null}GetRelativeGitUriDetails(e){if(e.startsWith("/~git/")){let t=e.substr("/~git/".length,e.length-"/~git/".length),n=t.indexOf("/"),i=t.substr(0,n),s=t.substr(n+1,t.length-n).split("::");if(2==s.length)return{ref:i,hostPath:s[0],guestPath:s[1]}}return null}RelativeNotebookCellPathFromLocalNotebookCellUri(e){var t;const n=null===(t=r.workspace.notebookDocuments)||void 0===t?void 0:t.find(t=>t.uri.path===e.path);if(!n)return null;const i=this.localPathToRelativePath(n.uri),s=n.notebookType.startsWith(h.NotebookConstants.mirrorNotebookTypePrefix)?n.notebookType.substring(h.NotebookConstants.mirrorNotebookTypePrefix.length):n.notebookType,o=f.findNotebookCell(e);if(!o)return null;const a=f.getCellId(o);return a?`${p.notebookCellPrefix}${i}?${s}#${a}`:null}getLocalNotebookUriFromRelativeNotebookCellUri(e){const t=e.path.substring(p.notebookCellPrefix.length);return this.relativePathToLocalPath(t)}NotebookCellUriFromRelativeNotebookCellUri(e){var t,n;const i=this.getLocalNotebookUriFromRelativeNotebookCellUri(e);return null===(n=null===(t=f.findNotebookCellById(i,e.fragment))||void 0===t?void 0:t.document)||void 0===n?void 0:n.uri}async openNotebookCellDocument(e,t=!1){const n=r.Uri.parse(e),i=this.getLocalNotebookUriFromRelativeNotebookCellUri(n);if(await r.workspace.openNotebookDocument(i))return this.openRelativePath(e,t,!1);throw new Error(`Could not open notebook ${e}`)}async openRelativePath(e,t=!1,n=!0){const i=this.relativePathToLocalPath(e);if(i){if(i.scheme===p.notebookCellScheme){const e=f.findNotebookCell(i),n=null==e?void 0:e.document;return t&&e&&await r.window.showNotebookDocument(null==e?void 0:e.notebook),c.assert(null!==n,"Notebook cell document should be non-null"),n}const e=await r.workspace.openTextDocument(i);return t&&await r.window.showTextDocument(e),e}if(e.startsWith(p.notebookCellPrefix)&&n)return this.openNotebookCellDocument(e,t);throw new Error(`Could not open relative path ${e}`)}async dispose(){this.vslsExternalIdToUris.clear(),this.vslsExternalUriToIds.clear(),this.localPathsToVslsPaths.clear(),this.vslsPathsToLocalPaths.clear()}}t.PathManager=p,p.outputScheme="output",p.vslsExternalScheme="vslsexternal",p.githubDevScheme="vscode-vfs",p.fileScheme="file",p.gitScheme="git",p.vslsSccScheme="vsls-scc",p.externalPrefix="/~external",p.untitledPrefix="/~untitled",p.gitPrefix="/~git",p.untitledScheme="untitled",p.notebookCellScheme="vscode-notebook-cell",p.notebookCellPrefix="/~notebook",p.rawScheme=d.Settings.scheme,t.VSLS_SCHEME=p.rawScheme,t.FILE_SCHEME=p.fileScheme,t.GITHUB_DEV_SCHEME=p.githubDevScheme,t.VSLS_EXTERNAL_SCHEME=p.vslsExternalScheme,t.KNOWN_SCHEMES=["http","https",t.VSLS_EXTERNAL_SCHEME,t.VSLS_SCHEME]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BigInt=void 0;const i=n(3),s=n(36);class r{constructor(e){if(this.buffer=e,0===e.length)throw new Error("BigInt buffer length must be greater than zero.")}get sign(){const e=this.buffer[0];return 0===e?this.buffer.length>1?1:0:0==(128&e)?1:-1}static fromInt32(e){if(0===e)return r.zero;let t=!1;e<0&&(t=!0,e=-e);const n=[];for(let t=24;t>=0;t-=8)(e>=1<<t||n.length>0)&&(n.push(e>>t),e&=~((1<<t)-1));return t&&(0==(128&n[0])?n[0]|=128:n.splice(0,0,128)),new r(i.Buffer.from(new Uint8Array(n)))}toInt32(){if(this.buffer.length>4)throw new TypeError("BigInt value cannot be converted to a 32-bit signed integer.");let e=this.buffer[0];this.sign<0&&(e&=127);for(let t=1;t<this.buffer.length;t++)e=(e<<8)+this.buffer[t];return this.sign<0&&(e=-e),e}static fromBytes(e,t){if(!i.Buffer.isBuffer(e))throw new TypeError("Buffer expected.");if(0===e.length)throw new Error("BigInt buffer length must be greater than zero.");t=null!=t?t:{};const n=0!=(128&e[0]),s=t.unsigned&&n?1:0;let o=0;for(let t=0;t<e.length-1&&0===e[t];t++)0==(128&e[t+1])&&o++;const a=i.Buffer.alloc(e.length+s-o);return e.copy(a,s,o,e.length),new r(a)}toBytes(e){e=null!=e?e:{};let t=this.buffer;if(e.unsigned){if(this.sign<0)throw new TypeError("Cannot format a negative BigInt as unsigned.");if(0===t[0]&&t.length>1&&(t=t.slice(1,t.length)),void 0!==e.length){if(t.length>e.length)throw new Error(`BigInt (${t.length} bytes) is too large for length ${e.length}.`);if(t.length<e.length){const n=i.Buffer.alloc(e.length);return t.copy(n,e.length-t.length),n}}}const n=i.Buffer.alloc(t.length);return t.copy(n,0,0,t.length),n}copyTo(e,t=0){this.buffer.copy(e,t,0,this.buffer.length)}equals(e){return e instanceof r&&this.buffer.equals(e.buffer)}toString(e){return(0,s.formatBuffer)(this.buffer,null!=e?e:"BigInt")}}t.BigInt=r,r.zero=new r(i.Buffer.alloc(1))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionReconnectFailureMessage=t.SshReconnectFailureReason=t.SessionReconnectResponseMessage=t.SessionReconnectRequestMessage=t.SessionChannelRequestMessage=t.ExtensionInfoMessage=t.SessionRequestFailureMessage=t.SessionRequestSuccessMessage=t.SessionRequestMessage=t.ServiceAcceptMessage=t.ServiceRequestMessage=t.DebugMessage=t.UnimplementedMessage=t.IgnoreMessage=t.DisconnectMessage=t.SshDisconnectReason=void 0;const i=n(100),s=n(80);var r;!function(e){e[e.none=0]="none",e[e.hostNotAllowedToConnect=1]="hostNotAllowedToConnect",e[e.protocolError=2]="protocolError",e[e.keyExchangeFailed=3]="keyExchangeFailed",e[e.reserved=4]="reserved",e[e.macError=5]="macError",e[e.compressionError=6]="compressionError",e[e.serviceNotAvailable=7]="serviceNotAvailable",e[e.protocolVersionNotSupported=8]="protocolVersionNotSupported",e[e.hostKeyNotVerifiable=9]="hostKeyNotVerifiable",e[e.connectionLost=10]="connectionLost",e[e.byApplication=11]="byApplication",e[e.tooManyConnections=12]="tooManyConnections",e[e.authCancelledByUser=13]="authCancelledByUser",e[e.noMoreAuthMethodsAvailable=14]="noMoreAuthMethodsAvailable",e[e.illegalUserName=15]="illegalUserName"}(t.SshDisconnectReason||(t.SshDisconnectReason={}));class o extends i.SshMessage{get messageType(){return 1}onRead(e){this.reasonCode=e.readUInt32(),this.description=e.readString("utf8"),e.available>=4?this.language=e.readString("ascii"):this.language=null}onWrite(e){e.writeUInt32(this.validateField(this.reasonCode,"reason code")),e.writeString(this.description||"","utf8"),this.language&&e.writeString(this.language,"ascii")}}t.DisconnectMessage=o;class a extends i.SshMessage{get messageType(){return 2}onRead(e){}onWrite(e){}}t.IgnoreMessage=a;class c extends i.SshMessage{get messageType(){return 3}onRead(e){this.sequenceNumber=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.sequenceNumber,"sequence number"))}toString(){return this.unimplementedMessageType?`${super.toString()} (messageType=${this.unimplementedMessageType})`:`${super.toString()} (sequenceNumber=${this.sequenceNumber})`}}t.UnimplementedMessage=c;class l extends i.SshMessage{constructor(e){super(),this.alwaysDisplay=!1,this.message=e}get messageType(){return 4}onRead(e){this.alwaysDisplay=e.readBoolean(),this.message=e.readString("utf8"),this.language=e.readString("ascii")}onWrite(e){var t,n;e.writeBoolean(this.alwaysDisplay),e.writeString(null!==(t=this.message)&&void 0!==t?t:"","utf8"),e.writeString(null!==(n=this.language)&&void 0!==n?n:"","ascii")}toString(){return`${super.toString()}: ${this.message}`}}t.DebugMessage=l;class u extends i.SshMessage{get messageType(){return 5}onRead(e){this.serviceName=e.readString("ascii")}onWrite(e){e.writeString(this.validateField(this.serviceName,"service name"),"ascii")}}t.ServiceRequestMessage=u;class d extends i.SshMessage{get messageType(){return 6}onRead(e){this.serviceName=e.readString("ascii")}onWrite(e){e.writeString(this.validateField(this.serviceName,"service name"),"ascii")}}t.ServiceAcceptMessage=d;class h extends i.SshMessage{constructor(e,t){super(),this.requestType=e,this.wantReply=null!=t&&t}get messageType(){return 80}onRead(e){this.requestType=e.readString("ascii"),this.wantReply=e.readBoolean()}onWrite(e){e.writeString(this.validateField(this.requestType,"request type"),"ascii"),e.writeBoolean(this.wantReply)}toString(){return`${super.toString()} (requestType=${this.requestType})`}}t.SessionRequestMessage=h;class f extends i.SshMessage{get messageType(){return 81}onRead(e){}onWrite(e){}}t.SessionRequestSuccessMessage=f;class p extends i.SshMessage{get messageType(){return 82}onRead(e){}onWrite(e){}}t.SessionRequestFailureMessage=p;class m extends i.SshMessage{constructor(){super(...arguments),this.extensionInfo={}}get messageType(){return 7}onRead(e){const t=e.readUInt32();this.extensionInfo={};for(let n=0;n<t;n++){const t=e.readString("ascii"),n=e.readString("utf8");this.extensionInfo[t]=n}}onWrite(e){const t=Object.keys(this.extensionInfo);e.writeUInt32(t.length);for(let n of t)e.writeString(n,"ascii"),e.writeString(this.extensionInfo[n]||"","utf8")}toString(){let e="";for(const[t,n]of Object.entries(this.extensionInfo))e&&(e+="; "),e+=t,n&&(e+="="+n);return`${super.toString()} (${e})`}}t.ExtensionInfoMessage=m,m.serverIndicator="ext-info-c",m.clientIndicator="ext-info-c";t.SessionChannelRequestMessage=class extends h{onRead(e){super.onRead(e),this.senderChannel=e.readUInt32();const t=new s.ChannelRequestMessage;t.read(e),this.request=t}onWrite(e){super.onWrite(e),e.writeUInt32(this.validateField(this.senderChannel,"sender channel")),this.validateField(this.request,"request message").write(e)}};t.SessionReconnectRequestMessage=class extends h{onRead(e){super.onRead(e),this.clientReconnectToken=e.readBinary(),this.lastReceivedSequenceNumber=e.readUInt64()}onWrite(e){super.onWrite(e),e.writeBinary(this.validateField(this.clientReconnectToken,"clientReconnectToken")),e.writeUInt64(this.validateField(this.lastReceivedSequenceNumber,"lastReceivedSequenceNumber"))}};t.SessionReconnectResponseMessage=class extends f{onRead(e){super.onRead(e),this.serverReconnectToken=e.readBinary(),this.lastReceivedSequenceNumber=e.readUInt64()}onWrite(e){super.onWrite(e),e.writeBinary(this.validateField(this.serverReconnectToken,"serverReconnectToken")),e.writeUInt64(this.validateField(this.lastReceivedSequenceNumber,"lastReceivedSequenceNumber"))}},function(e){e[e.none=0]="none",e[e.unknownServerFailure=1]="unknownServerFailure",e[e.sessionNotFound=2]="sessionNotFound",e[e.invalidClientReconnectToken=3]="invalidClientReconnectToken",e[e.serverDroppedMessages=4]="serverDroppedMessages",e[e.unknownClientFailure=101]="unknownClientFailure",e[e.differentServerHostKey=102]="differentServerHostKey",e[e.invalidServerReconnectToken=103]="invalidServerReconnectToken",e[e.clientDroppedMessages=104]="clientDroppedMessages"}(r=t.SshReconnectFailureReason||(t.SshReconnectFailureReason={}));t.SessionReconnectFailureMessage=class extends p{onRead(e){e.available>0&&(this.reasonCode=e.readUInt32(),this.description=e.readString("utf8"),this.language=e.readString("ascii"))}onWrite(e){e.writeUInt32(this.validateField(this.reasonCode,"reason code")),e.writeString(this.description||"","utf8"),e.writeString(this.language||"en","ascii")}toString(){return`${super.toString} (${r[this.reasonCode||0]}: ${this.description})`}},i.SshMessage.index.set(1,o),i.SshMessage.index.set(2,a),i.SshMessage.index.set(3,c),i.SshMessage.index.set(5,u),i.SshMessage.index.set(6,d),i.SshMessage.index.set(7,m),i.SshMessage.index.set(80,h),i.SshMessage.index.set(81,f),i.SshMessage.index.set(82,p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BigInt=void 0;const i=n(3),s=n(37);class r{constructor(e){if(this.buffer=e,0===e.length)throw new Error("BigInt buffer length must be greater than zero.")}get sign(){const e=this.buffer[0];return 0===e?this.buffer.length>1?1:0:0==(128&e)?1:-1}static fromInt32(e){if(0===e)return r.zero;let t=!1;e<0&&(t=!0,e=-e);const n=[];for(let t=24;t>=0;t-=8)(e>=1<<t||n.length>0)&&(n.push(e>>t),e&=~((1<<t)-1));return t&&(0==(128&n[0])?n[0]|=128:n.splice(0,0,128)),new r(i.Buffer.from(new Uint8Array(n)))}toInt32(){if(this.buffer.length>4)throw new TypeError("BigInt value cannot be converted to a 32-bit signed integer.");let e=this.buffer[0];this.sign<0&&(e&=127);for(let t=1;t<this.buffer.length;t++)e=(e<<8)+this.buffer[t];return this.sign<0&&(e=-e),e}static fromBytes(e,t){if(!i.Buffer.isBuffer(e))throw new TypeError("Buffer expected.");if(0===e.length)throw new Error("BigInt buffer length must be greater than zero.");t=null!=t?t:{};const n=0!=(128&e[0]),s=t.unsigned&&n?1:0;let o=0;for(let t=0;t<e.length-1&&0===e[t];t++)0==(128&e[t+1])&&o++;const a=i.Buffer.alloc(e.length+s-o);return e.copy(a,s,o,e.length),new r(a)}toBytes(e){e=null!=e?e:{};let t=this.buffer;if(e.unsigned){if(this.sign<0)throw new TypeError("Cannot format a negative BigInt as unsigned.");if(0===t[0]&&t.length>1&&(t=t.slice(1,t.length)),void 0!==e.length){if(t.length>e.length)throw new Error(`BigInt (${t.length} bytes) is too large for length ${e.length}.`);if(t.length<e.length){const n=i.Buffer.alloc(e.length);return t.copy(n,e.length-t.length),n}}}const n=i.Buffer.alloc(t.length);return t.copy(n,0,0,t.length),n}copyTo(e,t=0){this.buffer.copy(e,t,0,this.buffer.length)}equals(e){return e instanceof r&&this.buffer.equals(e.buffer)}toString(e){return(0,s.formatBuffer)(this.buffer,null!=e?e:"BigInt")}}t.BigInt=r,r.zero=new r(i.Buffer.alloc(1))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionReconnectFailureMessage=t.SshReconnectFailureReason=t.SessionReconnectResponseMessage=t.SessionReconnectRequestMessage=t.SessionChannelRequestMessage=t.ExtensionInfoMessage=t.SessionRequestFailureMessage=t.SessionRequestSuccessMessage=t.SessionRequestMessage=t.ServiceAcceptMessage=t.ServiceRequestMessage=t.DebugMessage=t.UnimplementedMessage=t.IgnoreMessage=t.DisconnectMessage=t.SshDisconnectReason=void 0;const i=n(105),s=n(84);var r;!function(e){e[e.none=0]="none",e[e.hostNotAllowedToConnect=1]="hostNotAllowedToConnect",e[e.protocolError=2]="protocolError",e[e.keyExchangeFailed=3]="keyExchangeFailed",e[e.reserved=4]="reserved",e[e.macError=5]="macError",e[e.compressionError=6]="compressionError",e[e.serviceNotAvailable=7]="serviceNotAvailable",e[e.protocolVersionNotSupported=8]="protocolVersionNotSupported",e[e.hostKeyNotVerifiable=9]="hostKeyNotVerifiable",e[e.connectionLost=10]="connectionLost",e[e.byApplication=11]="byApplication",e[e.tooManyConnections=12]="tooManyConnections",e[e.authCancelledByUser=13]="authCancelledByUser",e[e.noMoreAuthMethodsAvailable=14]="noMoreAuthMethodsAvailable",e[e.illegalUserName=15]="illegalUserName"}(t.SshDisconnectReason||(t.SshDisconnectReason={}));class o extends i.SshMessage{get messageType(){return 1}onRead(e){this.reasonCode=e.readUInt32(),this.description=e.readString("utf8"),e.available>=4?this.language=e.readString("ascii"):this.language=null}onWrite(e){e.writeUInt32(this.validateField(this.reasonCode,"reason code")),e.writeString(this.description||"","utf8"),this.language&&e.writeString(this.language,"ascii")}}t.DisconnectMessage=o;class a extends i.SshMessage{get messageType(){return 2}onRead(e){}onWrite(e){}}t.IgnoreMessage=a;class c extends i.SshMessage{get messageType(){return 3}onRead(e){this.sequenceNumber=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.sequenceNumber,"sequence number"))}toString(){return this.unimplementedMessageType?`${super.toString()} (messageType=${this.unimplementedMessageType})`:`${super.toString()} (sequenceNumber=${this.sequenceNumber})`}}t.UnimplementedMessage=c;class l extends i.SshMessage{constructor(e){super(),this.alwaysDisplay=!1,this.message=e}get messageType(){return 4}onRead(e){this.alwaysDisplay=e.readBoolean(),this.message=e.readString("utf8"),this.language=e.readString("ascii")}onWrite(e){var t,n;e.writeBoolean(this.alwaysDisplay),e.writeString(null!==(t=this.message)&&void 0!==t?t:"","utf8"),e.writeString(null!==(n=this.language)&&void 0!==n?n:"","ascii")}toString(){return`${super.toString()}: ${this.message}`}}t.DebugMessage=l;class u extends i.SshMessage{get messageType(){return 5}onRead(e){this.serviceName=e.readString("ascii")}onWrite(e){e.writeString(this.validateField(this.serviceName,"service name"),"ascii")}}t.ServiceRequestMessage=u;class d extends i.SshMessage{get messageType(){return 6}onRead(e){this.serviceName=e.readString("ascii")}onWrite(e){e.writeString(this.validateField(this.serviceName,"service name"),"ascii")}}t.ServiceAcceptMessage=d;class h extends i.SshMessage{constructor(e,t){super(),this.requestType=e,this.wantReply=null!=t&&t}get messageType(){return 80}onRead(e){this.requestType=e.readString("ascii"),this.wantReply=e.readBoolean()}onWrite(e){e.writeString(this.validateField(this.requestType,"request type"),"ascii"),e.writeBoolean(this.wantReply)}toString(){return`${super.toString()} (requestType=${this.requestType})`}}t.SessionRequestMessage=h;class f extends i.SshMessage{get messageType(){return 81}onRead(e){}onWrite(e){}}t.SessionRequestSuccessMessage=f;class p extends i.SshMessage{get messageType(){return 82}onRead(e){}onWrite(e){}}t.SessionRequestFailureMessage=p;class m extends i.SshMessage{constructor(){super(...arguments),this.extensionInfo={}}get messageType(){return 7}onRead(e){const t=e.readUInt32();this.extensionInfo={};for(let n=0;n<t;n++){const t=e.readString("ascii"),n=e.readString("utf8");this.extensionInfo[t]=n}}onWrite(e){const t=Object.keys(this.extensionInfo);e.writeUInt32(t.length);for(let n of t)e.writeString(n,"ascii"),e.writeString(this.extensionInfo[n]||"","utf8")}toString(){let e="";for(const[t,n]of Object.entries(this.extensionInfo))e&&(e+="; "),e+=t,n&&(e+="="+n);return`${super.toString()} (${e})`}}t.ExtensionInfoMessage=m,m.serverIndicator="ext-info-c",m.clientIndicator="ext-info-c";t.SessionChannelRequestMessage=class extends h{onRead(e){super.onRead(e),this.senderChannel=e.readUInt32();const t=new s.ChannelRequestMessage;t.read(e),this.request=t}onWrite(e){super.onWrite(e),e.writeUInt32(this.validateField(this.senderChannel,"sender channel")),this.validateField(this.request,"request message").write(e)}};t.SessionReconnectRequestMessage=class extends h{onRead(e){super.onRead(e),this.clientReconnectToken=e.readBinary(),this.lastReceivedSequenceNumber=e.readUInt64()}onWrite(e){super.onWrite(e),e.writeBinary(this.validateField(this.clientReconnectToken,"clientReconnectToken")),e.writeUInt64(this.validateField(this.lastReceivedSequenceNumber,"lastReceivedSequenceNumber"))}};t.SessionReconnectResponseMessage=class extends f{onRead(e){super.onRead(e),this.serverReconnectToken=e.readBinary(),this.lastReceivedSequenceNumber=e.readUInt64()}onWrite(e){super.onWrite(e),e.writeBinary(this.validateField(this.serverReconnectToken,"serverReconnectToken")),e.writeUInt64(this.validateField(this.lastReceivedSequenceNumber,"lastReceivedSequenceNumber"))}},function(e){e[e.none=0]="none",e[e.unknownServerFailure=1]="unknownServerFailure",e[e.sessionNotFound=2]="sessionNotFound",e[e.invalidClientReconnectToken=3]="invalidClientReconnectToken",e[e.serverDroppedMessages=4]="serverDroppedMessages",e[e.unknownClientFailure=101]="unknownClientFailure",e[e.differentServerHostKey=102]="differentServerHostKey",e[e.invalidServerReconnectToken=103]="invalidServerReconnectToken",e[e.clientDroppedMessages=104]="clientDroppedMessages"}(r=t.SshReconnectFailureReason||(t.SshReconnectFailureReason={}));t.SessionReconnectFailureMessage=class extends p{onRead(e){e.available>0&&(this.reasonCode=e.readUInt32(),this.description=e.readString("utf8"),this.language=e.readString("ascii"))}onWrite(e){e.writeUInt32(this.validateField(this.reasonCode,"reason code")),e.writeString(this.description||"","utf8"),e.writeString(this.language||"en","ascii")}toString(){return`${super.toString} (${r[this.reasonCode||0]}: ${this.description})`}},i.SshMessage.index.set(1,o),i.SshMessage.index.set(2,a),i.SshMessage.index.set(3,c),i.SshMessage.index.set(5,u),i.SshMessage.index.set(6,d),i.SshMessage.index.set(7,m),i.SshMessage.index.set(80,h),i.SshMessage.index.set(81,f),i.SshMessage.index.set(82,p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(0),r=n(24),o=n(286),a=n(287),c=n(7),l=n(19),u=n(20),d=n(6),h=n(1146),f=n(1147),p=n(1148),m=n(494),g=n(4),y=n(5);var v;!function(e){e.LiveshareStatus="liveshareStatus",e.WorkspaceName="workspaceName"}(v=t.PublishProperties||(t.PublishProperties={}));class S extends r.EventEmitter{constructor(){super(...arguments),this.recentContactsPresenceRequests=new _,this.recentContacts=[],this.aggregatedSuggestedUsers=[],this.suggestedContactPresenceRequests=new _,this.suggestedUserByProvider={},this.updateRecentContactsInProgress=new d.Mutex,this.updateSuggestedContactsInProgress=new d.Mutex,this.requestContactsResults=new Set,this.invitedContactsMap=new Map,this.internalEmitter=new r.EventEmitter,this.supportMultiplePresenceProviders=!1,this.serviceProviders=[],this.presenceStatusProviders=[]}static get Instance(){return S.singleton||(S.singleton=new S),S.singleton}initialize(e){return this._initialize(e.rpcClient(),e.authService(),e,()=>Promise.resolve(Array.from(e.workspaceServices().registeredServices)))}async _initialize(e,t,n,i){this.trace=c.traceSource.withName("Contact.Manager"),this.authCoreService=t,this.once(g.ContactManagerEvents.ProviderAdded,()=>{this.emit(g.ContactManagerEvents.Ready)}),await g.ExtensionUtil.tryRegisterCommand("liveshare.removeInvitedContactFromFileTreeExplorer",this.removeInvitedContact,this,!1),await g.ExtensionUtil.tryRegisterCommand("liveshare.removeInvitedContactFromActivityBar",this.removeInvitedContact,this,!1);const s=async t=>{const n=t.filter(e=>e.startsWith("contactService-"));for(let t of n){const n={name:t,methods:y.contactProtocol.ContactServiceProvider.methods,events:y.contactProtocol.ContactServiceProvider.events},i=u.RpcProxy.create(n,e,c.traceSource.withName(y.vsls.TraceSources.ClientRpcContact));await this.registerAndInitializeServiceProvider(t.substr("contactService-".length),i)}};e.ensureConnectionAsync().then(async()=>{const e=await i();s(e)}).catch(e=>{c.traceSource.info("Failed to get context services:"+e)}),n.workspaceService().onServicesChanged(e=>{e.changeType===y.vsls.CollectionChangeType.Add&&s(e.serviceNames)}),n.workspaceUserService().onWorkspaceSessionChanged(async e=>{if((e.changeType===y.vsls.WorkspaceSessionChangeType.Joined||e.changeType===y.vsls.WorkspaceSessionChangeType.Unjoined)&&!e.userProfile.isAnonymous){e.changeType===y.vsls.WorkspaceSessionChangeType.Joined&&await this.addUserProfile(e.userProfile);const t=Array.from(this.invitedContactsMap.values()).find(t=>t.contact.id===e.userProfile.id||t.contact.contact.email===e.userProfile.email);t&&this.setInviteStatus(t.contact.id,y.vsls.InviteContactStatus.None)}});let r=!1;const o=(e,t)=>{r=e,this.trace.verbose(`->loadRecentCollaborators:${t}`),this.loadRecentCollaborators(e)};g.sessionStateTracker.onStateChanged(async e=>{if(this.trace.verbose(`->onStateChanged state:${e.newState}`),e.newState===g.SessionState.Joined){const e=Object.values(g.workspaceSessionInfoTracker.workspaceSessionInfo.sessions).find(e=>e.isHost);e&&await this.addUserProfile(e)}e.newState===g.SessionState.SignedOut?o(!1,"signedOut"):e.newState>=g.SessionState.SignedIn&&!r&&(o(!0,"signedIn"),e.newState===g.SessionState.SignedIn&&this.invitedContactsMap.clear());const t={};t[v.LiveshareStatus]=e.newState,await this.publishProperties(t)}),this.trace.verbose(`->initialize state:${g.sessionStateTracker.State}`),g.sessionStateTracker.State>=g.SessionState.SignedIn&&o(!0,"initialize");const a=(e,t)=>this.registerContactProvider(e,t);h.registerGitProvider(a,this.trace),f.registerSelfInviteProvider(t,a,this.trace),await this.updateContexts();const l=g.Settings.get(g.SettingKeys.activityTimeout);this.registerPresenceStatusProvider(new p.IdlePresenceStatus(this.trace,l)),this.registerPresenceStatusProvider(new m.SessionStateStatusProvider)}get isPublishEnabeld(){return!0}registerPresenceStatusProvider(e){this.presenceStatusProviders.push(e),e.onStatusChanged(t=>this.onPresenceStatusProviderChanged(e,t))}async initializeProvider(e){const t={};t[v.LiveshareStatus]=g.sessionStateTracker.State,!0===g.Settings.get(g.SettingKeys.publishWorkspaceInfo)&&(t[v.WorkspaceName]=s.workspace.name),await e.initialize(this.isPublishEnabeld,{status:y.contactProtocol.PresenceStatus.Available,properties:t}),this.updatePreferedPresenceProvider(e),e.capabilites.supportsContactPresenceRequest&&await this.updateAllContacts(),await this.updateContexts()}registerServiceProvider(e,t){this.trace.info(`registerContactProvider-> serviceId:${e}`);const n=new o.ContactServiceManager(e,t,this);return n.addListener(g.ContactServiceEvents.Initialized,()=>this.fireContactsChanged()),n.addListener(g.ContactServiceEvents.ContactsChanged,()=>this.fireContactsChanged()),n.addListener(g.ContactServiceEvents.AvailableUsersChanged,()=>this.onAvailableUsersChanged()),n.addListener(g.ContactServiceEvents.SelfContactChanged,()=>this.onSelfUserChangedNotification(n)),n.addListener(g.ContactServiceEvents.InviteLinkReceived,e=>this.onInviteLinkReceived(n,e)),n.addListener(g.ContactServiceEvents.MessageReceived,e=>this.onMessageReceived(e)),n.addListener(g.ContactServiceEvents.SuggestedUsersUpdate,e=>this.onSuggestedUsersUpdate(n,e)),n.addListener(g.ContactServiceEvents.ContactsChangedNotification,e=>this.onContactsChangedNotification(n,e)),n.addListener(g.ContactServiceEvents.ContactPropertyChangedNotification,e=>this.onContactPropertiesChangedNotification(e)),n.addListener(g.ContactServiceEvents.SignedStateChanged,e=>this.onPresenceSignedStatusNotification(n)),n.addListener(g.ContactServiceEvents.CapabilitiesChanged,e=>this.onCapabilitiesChanged(n,e)),n.addListener(g.ContactServiceEvents.AuthenticationRequired,e=>this.onAuthenticationRequired(n)),this.serviceProviders.push(n),n}async registerAndInitializeServiceProvider(e,t){const n=this.registerServiceProvider(e,t);return await this.initializeProvider(n),this.emit(g.ContactManagerEvents.ProviderAdded,n),n}registerContactProvider(e,t){const n=this.registerServiceProvider(e,t);return this.initializeProvider(n).catch(t=>{this.trace.error(`Failed to register contact provider:${e}`,t)}),this.emit(g.ContactManagerEvents.ProviderAdded,n),new i.Disposable(()=>{const e=this.serviceProviders.indexOf(n);e>=0&&this.serviceProviders.splice(e,1)})}async dispose(){for(let e of this.serviceProviders.splice(0,this.serviceProviders.length))await e._Dispose()}get selectedPreferedProviderId(){return g.Settings.getMemento("liveshare.preferedPresenceProviderId")}async setPreferedPresenceProvider(e){g.Settings.saveMemento("liveshare.preferedPresenceProviderId",e.serviceId),this.preferedPresenceProvider!==e&&(this.preferedPresenceProvider=e,this.updatePreferedProviderSelfStatus(),this.updatePreferedProviderSignedStatus(),await this.updateAllContacts())}isRecentContat(e){return-1!==this.recentContacts.findIndex(t=>t.contactModel.id===e.id)}isSuggestedContat(e){return-1!==this.aggregatedSuggestedUsers.findIndex(t=>t.id===e.id)}getServiceManager(e){return this.serviceProviders.find(t=>t.serviceId===e)}getSuggestedUsers(e){return e?this.aggregatedSuggestedUsers.filter(e):this.aggregatedSuggestedUsers}getRecentContacts(e){const t=this.recentContacts.map(e=>e.contactModel);return e?t.filter(e):t}getAllAvailableContacts(e){const t=[];return this.serviceProviders.forEach(n=>{let i=n.availableUsers;e&&(i=i.filter(e)),t.push(...i)}),t}get isDoNotDisturbState(){return!!this.serviceProviders.find(e=>e.selfUser&&e.selfUser.contact.status===y.contactProtocol.PresenceStatus.DoNotDisturb)}get selfContact(){var e;return null===(e=this.preferedPresenceProvider)||void 0===e?void 0:e.selfUser}get presenceStatus(){return this.preferedPresenceProvider&&this.preferedPresenceProvider.selfUser?this.preferedPresenceProvider.selfUser.contact.status:y.contactProtocol.PresenceStatus.Unknown}async signOut(){this.preferedPresenceProvider&&await this.preferedPresenceProvider.signOut()}async signIn(){this.preferedPresenceProvider&&await this.preferedPresenceProvider.signIn()}async publishPresence(e){e===y.contactProtocol.PresenceStatus.Available?(this.publishedPresenceStatus=void 0,this.presenceStatusProviders.forEach(e=>e.reset()),e=this.getPresenceStatusFromProviders()):this.publishedPresenceStatus=e,await this.publishPresenceInternal(e,{allowInvites:g.Settings.get(g.SettingKeys.allowInvites)})}async publishProperties(e){await this.publishPresenceInternal(y.contactProtocol.PresenceStatus.Unknown,e)}get supportedPresenceStatus(){return this.preferedPresenceProvider&&this.preferedPresenceProvider.capabilites&&this.preferedPresenceProvider.capabilites.supportedPresenceStatus?this.preferedPresenceProvider.capabilites.supportedPresenceStatus:[y.contactProtocol.PresenceStatus.Available,y.contactProtocol.PresenceStatus.Busy,y.contactProtocol.PresenceStatus.DoNotDisturb,y.contactProtocol.PresenceStatus.Away]}async searchContacts(e,t,n){const i=this.serviceProviders.filter(e=>e.capabilites&&e.capabilites.supportsSearchContacts).map(async i=>await i.searchContactsRequest(e,t,n)),s=await Promise.all(i);return s.length>0?s.reduce((e,t)=>e.concat(t)):[]}async sendMessage(e,t,n,i){const s=this.getSendMessageProvider();return!!s&&(await s.sendMessage(e,t,n,i),!0)}get signedStatus(){return this.preferedPresenceProvider?this.preferedPresenceProvider.signedStatus:y.contactProtocol.SignedStatus.None}get hasSendMessageProvider(){return void 0!==this.getSendMessageProvider()}async removeRecentContact(e){const t=this.recentContacts.findIndex(t=>t.contactModel.contact.id===e.contact.id);if(-1!==t){const n=this.recentContacts.splice(t,1);return await n[0].dispose(),await this.authCoreService.removeRecentCollaboratorAsync(e.contact.id),await this.updateAllContacts(),!0}return!1}async requestContacts(e){const t=await this.requestContactsInternal(e);return this.requestContactsResults.add(t),t}onInviteStatusChanged(e){this.internalEmitter.addListener("onInviteStatusChanged",e)}get invitedContacts(){return Array.from(this.invitedContactsMap.values()).filter(e=>e.status!==y.vsls.InviteContactStatus.None).map(e=>e.contact)}isContactInvited(e){return this.invitedContactsMap.has(e)}getInviteStatus(e){return this.invitedContactsMap.has(e)?this.invitedContactsMap.get(e).status:y.vsls.InviteContactStatus.None}async fireInviteStatusChanged(e,t,n){this.trace.info(`fireInviteStatusChanged-> targetContactId:${l.TraceFormat.formatText(e)} fromContactId:${l.TraceFormat.formatText(t)} status:${n}`),await this.sendMessage(e,"inviteStatusChanged",{fromContactId:t,status:n})}addInviteContact(e){this.invitedContactsMap.set(e.id,{contact:e,status:y.vsls.InviteContactStatus.None}),this.emit(g.ContactManagerEvents.InviteContactsUpdate)}async onPresenceStatusProviderChanged(e,t){if(this.trace.verbose(`onActivityStatusChanged-> id:${e.id} newStatus:${t} publishedPresenceStatus:${this.publishedPresenceStatus}`),!this.publishedPresenceStatus){const e=this.getPresenceStatusFromProviders();await this.publishPresenceInternal(e,{allowInvites:g.Settings.get(g.SettingKeys.allowInvites)})}}getPresenceStatusFromProviders(){const e=this.presenceStatusProviders.sort((e,t)=>t.priority-e.priority).find(e=>e.status!==y.contactProtocol.PresenceStatus.Unknown);return e?e.status:y.contactProtocol.PresenceStatus.Available}async publishPresenceInternal(e,t){if(this.isPublishEnabeld){const n=this.serviceProviders.map(async n=>await n.publishPresence(e,t));await Promise.all(n)}}setInviteStatus(e,t){this.trace.info(`setInviteStatus-> contactId:${l.TraceFormat.formatText(e)} status:${t}`),t===y.vsls.InviteContactStatus.None?(this.invitedContactsMap.delete(e),this.emit(g.ContactManagerEvents.InviteContactsUpdate)):this.invitedContactsMap.has(e)&&(this.invitedContactsMap.get(e).status=t);const n=this.aggregatedSuggestedUsers.find(t=>t.id===e);n&&n.fireChanged("inviteStatus");const i=this.recentContacts.find(t=>t.contactModel.id===e);i&&i.contactModel.fireChanged("inviteStatus"),this.internalEmitter.emit("onInviteStatusChanged")}getSendMessageProvider(){return this.serviceProviders.find(e=>e.capabilites&&e.capabilites.supportsMessageRequest)}removeInvitedContact(e){this.trace.info(`removeInvitedContact-> contactId:${l.TraceFormat.formatText(e.options.contactId)}`),this.setInviteStatus(e.options.contactId,y.vsls.InviteContactStatus.None)}async updateContexts(){await g.ExtensionUtil.setCommandContext("liveshare:hasPresenceProviders",-1!==this.serviceProviders.findIndex(e=>e.capabilites.supportsPresence)),await g.ExtensionUtil.setCommandContext("liveshare:hasPublishPresenceProviders",-1!==this.serviceProviders.findIndex(e=>e.capabilites.supportsPublishPresence)),await g.ExtensionUtil.setCommandContext("liveshare:hasSearchContactsProviders",-1!==this.serviceProviders.findIndex(e=>e.capabilites.supportsSearchContacts))}fireContactsChanged(){this.emit(g.ContactManagerEvents.ContactsChanged)}updatePreferedPresenceProvider(e){if(e.capabilites.supportsContactPresenceRequest||e.capabilites.supportsSignedStateRequest){const t=this.preferedPresenceProvider&&this.preferedPresenceProvider.serviceId===this.selectedPreferedProviderId;(!this.preferedPresenceProvider||e.serviceId===this.selectedPreferedProviderId||!t&&e.priority>=this.preferedPresenceProvider.priority)&&(this.preferedPresenceProvider=e,this.updatePreferedProviderSelfStatus(),this.updatePreferedProviderSignedStatus())}}onAuthenticationRequired(e){}async onCapabilitiesChanged(e,t){const n=t.oldCapabilities,i=t.newCapabilities;this.trace.info(`onCapabilitiesChanged-> serviceId:${e.serviceId} old:${JSON.stringify(n)} new:${JSON.stringify(i)}`),n.supportsPresence===i.supportsPresence&&n.supportsContactPresenceRequest===i.supportsContactPresenceRequest||await this.updateAllContacts(),this.updatePreferedPresenceProvider(e),await this.updateContexts(),this.emit(g.ContactManagerEvents.ProviderCapabilitiesChanged,e)}onInviteLinkReceived(e,t){if(t.fromContact&&!t.fromContact.id&&(t.fromContact.id=t.fromContactId),!this.isSelfContact(t.fromContact)){const e=g.Settings.get(g.SettingKeys.allowInvites);let n=!1;if("none"===e)n=!0;else if("contacts"===e||"recentContacts"===e){const i=this.recentContacts.map(e=>e.contactModel.id);"contacts"===e&&i.push(...this.aggregatedSuggestedUsers.map(e=>e.id)),n=-1===i.findIndex(e=>e===t.fromContact.id)}if(n)return void this.trace.info(`invite rejected for contactId:${t.fromContact.id} allowInvites:${e}`)}const n={provider:e,originator:t.fromContact?new a.ContactModelApi(e.serviceId,t.fromContact,{},this):e.lookupContactById(t.fromContactId),link:t.link};this.emit(g.ContactManagerEvents.InviteLinkReceived,n)}async onAvailableUsersChanged(){await g.ExtensionUtil.setCommandContext("liveshare:hasAvailableContacts",-1!==this.serviceProviders.findIndex(e=>e.availableUsers.length>0)),this.fireContactsChanged()}onMessageReceived(e){if(this.trace.info(`onMessageReceived-> type:${e.type} body:${JSON.stringify(e.body)}`),"inviteStatusChanged"===e.type){const t=e.body;this.invitedContactsMap.has(t.fromContactId)&&this.setInviteStatus(t.fromContactId,t.status)}}async onSuggestedUsersUpdate(e,t){this.trace.info(`onSuggestedUsersUpdate-> serviceId:${e.serviceId} count:${t.contacts.length}`),this.suggestedUserByProvider[e.serviceId]=t,await this.updateAllContacts()}updatePreferedProviderSelfStatus(){if(this.preferedPresenceProvider&&this.preferedPresenceProvider.selfUser){const e=this.preferedPresenceProvider.selfUser.contact.status;s.commands.executeCommand("setContext","liveshare:status",e)}}updatePreferedProviderSignedStatus(){this.preferedPresenceProvider&&s.commands.executeCommand("setContext","liveshare:presenceSignedStatus",this.preferedPresenceProvider.signedStatus)}onPresenceSignedStatusNotification(e){this.preferedPresenceProvider===e&&this.updatePreferedProviderSignedStatus(),this.emit(g.ContactManagerEvents.SignedStateChanged,this.signedStatus)}onSelfUserChangedNotification(e){this.preferedPresenceProvider===e&&this.updatePreferedProviderSelfStatus(),this.fireContactsChanged()}onContactPropertiesChangedNotification(e){let t=this.aggregatedSuggestedUsers.find(t=>t.contact.id===e.contactId);t&&(o.ContactServiceManager.updateContactPropertyChanges(t,e.changes),this.emit(g.ContactManagerEvents.SuggestedUsersUpdate)),t=this.recentContacts.map(e=>e.contactModel).find(t=>t.contact.id===e.contactId),t&&(o.ContactServiceManager.updateContactPropertyChanges(t,e.changes),this.emit(g.ContactManagerEvents.RecentContactsUpdate)),this.requestContactsResults.forEach(n=>{t=n.contactModels.find(t=>t.contact.id===e.contactId),t&&o.ContactServiceManager.updateContactPropertyChanges(t,e.changes)})}onContactsChangedNotification(e,t){this.preferedPresenceProvider===e&&this.updatePreferedProviderSelfStatus();let n=[];o.ContactServiceManager.updateContacts(this.aggregatedSuggestedUsers,t,n),n.length>0&&this.emit(g.ContactManagerEvents.SuggestedUsersUpdate),n=[],o.ContactServiceManager.updateContacts(this.recentContacts.map(e=>e.contactModel),t,n),n.length>0&&this.emit(g.ContactManagerEvents.RecentContactsUpdate),this.requestContactsResults.forEach(e=>{n=[],o.ContactServiceManager.updateContacts(e.contactModels,t,n)})}async loadRecentCollaborators(e){this.updateRecentContactsWithProgress(async()=>{if(await this.disposeRecentContactsInternal(),this.recentContacts=[],e){const e=await this.authCoreService.getCurrentUserAsync();e&&e.recentCollaborators?(this.trace.verbose(`loading recent collaborators count:${e.recentCollaborators.length}`),await this.addRecentCollaborators(e.recentCollaborators.map(e=>({id:e.id,email:e.email,displayName:e.name,status:y.contactProtocol.PresenceStatus.Unknown})))):this.trace.warning("no current user retrieved from auth service")}this.emit(g.ContactManagerEvents.RecentContactsUpdate)})}async updateRecentContacts(){this.updateRecentContactsWithProgress(()=>this.updateRecentContactsInternal())}async updateRecentContactsWithProgress(e){await this.updateRecentContactsInProgress.dispatch(e)}async disposeRecentContactsInternal(){const e=this.recentContacts.map(e=>(e.contact.status=y.contactProtocol.PresenceStatus.Unknown,e.contact));return await Promise.all(this.recentContacts.map(e=>e.dispose())),e}async updateRecentContactsInternal(){this.trace.verbose(`->updateRecentContacts -> count:${this.recentContacts.length}`);const e=await this.disposeRecentContactsInternal();this.recentContacts=[],await this.addRecentCollaborators(e),this.trace.verbose("<-updateRecentContacts"),this.emit(g.ContactManagerEvents.RecentContactsUpdate)}async requestContactsInternal(e){const t=[],n=e.map(e=>{const t=new y.contactProtocol.Contact;return t.id=e,t.email=e,t}),i=new _;await this.requestContactsWithPresenceAsync(t,n,i);n.forEach(e=>{-1===t.findIndex(t=>t.contact.email===e.email)&&(e.status=y.contactProtocol.PresenceStatus.Offline,t.push(new a.ContactModelApi(null,e,{},this)))});const s=new E(e,t,()=>(this.requestContactsResults.delete(s),i.clear()));return s}async updateAllContacts(){await this.updateRecentContacts(),await this.updateSuggestedUsers();for(const e of this.requestContactsResults.values()){const t=await this.requestContactsInternal(e.emails);e.update(t)}}async addUserProfile(e){this.trace.verbose(`addUserProfile id:${l.TraceFormat.formatText(e.id)} name:${l.TraceFormat.formatText(e.name)} `+`email:${l.TraceFormat.formatEmail(e.email)}`);const t=this.recentContacts.findIndex(t=>t.contact.id===e.id);if(-1===t){const t={id:e.id,displayName:e.name,email:e.email,avatarUri:e.avatarUri};await this.addRecentContact(t),await this.updateSuggestedUsers()}else if(0!==t){const e=this.recentContacts.splice(t,1);this.recentContacts.unshift(...e)}this.emit(g.ContactManagerEvents.RecentContactsUpdate)}async addRecentContact(e){this.trace.verbose(`addRecentContact id:${l.TraceFormat.formatText(e.id)} `+`displayName:${l.TraceFormat.formatText(e.displayName)} email:${l.TraceFormat.formatEmail(e.email)}`);const t=[],n=[e],i=new _;e.status=y.contactProtocol.PresenceStatus.Unknown,await this.requestContactsWithPresenceAsync(t,n,i),this.recentContacts=this.recentContacts.filter(t=>t.contact.id!==e.id),this.recentContacts.push({contact:e,contactModel:t.length>0?t[0]:new a.ContactModelApi(null,e,{},this),dispose:async()=>await i.clear()})}async addRecentCollaborators(e){const t=[];await this.recentContactsPresenceRequests.clear();const n=await this.requestContactsWithPresenceAsync(t,e,this.recentContactsPresenceRequests),i=()=>Promise.resolve();this.recentContacts.push(...e.map(e=>{let s;const r=n.findIndex(t=>t===e.id);return s=-1!==r?t[r]:new a.ContactModelApi(null,e,{},this),{contact:e,contactModel:s,dispose:i}}))}selectPresenceProviders(e){let t=this.serviceProviders.filter(t=>e(t.capabilites));return t.length>1&&!this.supportMultiplePresenceProviders&&this.preferedPresenceProvider&&(t=[this.preferedPresenceProvider]),t}async requestContactsWithPresenceAsync(e,t,n){const i=[],s=this.selectPresenceProviders(e=>e.supportsPresence);t=t.filter(t=>!s.find(n=>{const s=n.findMatchContact(t);return!!s&&(i.push(t.id),e.push(s),!0)}));const r=this.selectPresenceProviders(e=>e.supportsContactPresenceRequest);for(let s=0;s<r.length&&t.length>0;s++){const o=r[s];try{this.trace.verbose(`Request presence on service:${o.serviceId} for contact ids:${t.map(e=>l.TraceFormat.formatText(e.id)).concat(",")} `+`emails:${t.map(e=>l.TraceFormat.formatEmail(e.email)).join(",")}`);const s=await o.contactsPresenceRequest(t),r=Object.values(s);r.length>0&&(n.addRequest(o,r),e.push(...r),Object.keys(s).forEach(e=>{this.trace.verbose(`Presence support found for id:${l.TraceFormat.formatText(e)} => id:${l.TraceFormat.formatText(s[e].contact.id)} `+`email:${l.TraceFormat.formatEmail(s[e].contact.email)}`),i.push(e);const n=t.findIndex(t=>t.id===e);-1!==n&&t.splice(n,1)}))}catch(e){this.trace.error(`Failed to request presence for service:${o.serviceId} `)}}return i}async updateSuggestedUsers(){await this.updateSuggestedContactsInProgress.dispatch(()=>this.updateSuggestedUsersInternal())}isSelfContact(e){return this.serviceProviders.findIndex(t=>t.selfUser&&t.capabilites.supportsInviteLink&&(t.selfUser.contact.id===e.id||t.selfUser.contact.email===e.email))>=0}async updateSuggestedUsersInternal(){this.trace.verbose("->updateSuggestedUsers"),await this.suggestedContactPresenceRequests.clear();let e=[];const t={},n=Object.keys(this.suggestedUserByProvider).filter(e=>this.suggestedUserByProvider[e].exclusive&&this.suggestedUserByProvider[e].contacts.length>0).sort((e,t)=>{const n=this.getServiceManager(e).priority,i=this.getServiceManager(t).priority;return n>i?-1:n<i?1:0});if(n.length>0){const e=n[0];t[e]=this.suggestedUserByProvider[e].contacts}else Object.keys(this.suggestedUserByProvider).forEach(e=>t[e]=this.suggestedUserByProvider[e].contacts);const i=Object.keys(t).map(async n=>{const i=t[n];if(this.trace.verbose(`suggest contacts from provider:${n} ids:${i.map(e=>l.TraceFormat.formatText(e.contact.id)).join(",")} `+`emails:${i.map(e=>l.TraceFormat.formatEmail(e.contact.email)).join(",")}`),!this.getServiceManager(n).capabilites.supportsPresence){const t=i.map(e=>e.contact);(await this.requestContactsWithPresenceAsync(e,t,this.suggestedContactPresenceRequests)).forEach(e=>{const t=i.findIndex(t=>t.contact.id===e);-1!==t&&i.splice(t,1)})}e.push(...i)});await Promise.all(i),this.aggregatedSuggestedUsers=e,this.trace.info(`<- updateSuggestedUsers count:${e.length}`),this.emit(g.ContactManagerEvents.SuggestedUsersUpdate)}}class _{constructor(){this.contactPresenceRequests=[]}addRequest(e,t){this.contactPresenceRequests.push({serviceProvider:e,contacts:t})}async clear(){let e=this.contactPresenceRequests.map(async e=>{e.serviceProvider.capabilites&&e.serviceProvider.capabilites.supportsContactPresenceRequest&&await e.serviceProvider.contactsPresenceDispose(e.contacts.map(e=>e.contact.id))});try{await Promise.all(e)}catch(e){}this.contactPresenceRequests=[]}}class E{constructor(e,t,n){this.emails=e,this.contactModels=t,this.disposeCallback=n,this.contactsChangedEmitter=new s.EventEmitter}get onContactsChanged(){return this.contactsChangedEmitter.event}dispose(){return this.disposeCallback()}update(e){this.contactModels=e.contactModels,this.disposeCallback=e.disposeCallback,this.contactsChangedEmitter.fire()}}const w=S.Instance;t.ContactManager=w},function(e,t,n){"use strict";(function(e){function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});const s=n(150),r=n(1279);t.RequestType=r.RequestType,t.RequestType0=r.RequestType0,t.RequestType1=r.RequestType1,t.RequestType2=r.RequestType2,t.RequestType3=r.RequestType3,t.RequestType4=r.RequestType4,t.RequestType5=r.RequestType5,t.RequestType6=r.RequestType6,t.RequestType7=r.RequestType7,t.RequestType8=r.RequestType8,t.RequestType9=r.RequestType9,t.ResponseError=r.ResponseError,t.ErrorCodes=r.ErrorCodes,t.NotificationType=r.NotificationType,t.NotificationType0=r.NotificationType0,t.NotificationType1=r.NotificationType1,t.NotificationType2=r.NotificationType2,t.NotificationType3=r.NotificationType3,t.NotificationType4=r.NotificationType4,t.NotificationType5=r.NotificationType5,t.NotificationType6=r.NotificationType6,t.NotificationType7=r.NotificationType7,t.NotificationType8=r.NotificationType8,t.NotificationType9=r.NotificationType9;const o=n(310);t.MessageReader=o.MessageReader,t.StreamMessageReader=o.StreamMessageReader,t.IPCMessageReader=o.IPCMessageReader,t.SocketMessageReader=o.SocketMessageReader;const a=n(311);t.MessageWriter=a.MessageWriter,t.StreamMessageWriter=a.StreamMessageWriter,t.IPCMessageWriter=a.IPCMessageWriter,t.SocketMessageWriter=a.SocketMessageWriter;const c=n(190);t.Disposable=c.Disposable,t.Event=c.Event,t.Emitter=c.Emitter;const l=n(1280);t.CancellationTokenSource=l.CancellationTokenSource,t.CancellationToken=l.CancellationToken;const u=n(1281);var d,h,f,p,m,g,y,v;i(n(1282)),i(n(1283)),function(e){e.type=new r.NotificationType("$/cancelRequest")}(d||(d={})),function(e){e.type=new r.NotificationType("$/progress")}(h||(h={}));t.ProgressType=class{constructor(){}},t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Verbose=2]="Verbose"}(f=t.Trace||(t.Trace={})),function(e){e.fromString=function(t){if(!s.string(t))return e.Off;switch(t=t.toLowerCase()){case"off":return e.Off;case"messages":return e.Messages;case"verbose":return e.Verbose;default:return e.Off}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Verbose:return"verbose";default:return"off"}}}(f=t.Trace||(t.Trace={})),function(e){e.Text="text",e.JSON="json"}(t.TraceFormat||(t.TraceFormat={})),function(e){e.fromString=function(t){return"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(p=t.TraceFormat||(t.TraceFormat={})),function(e){e.type=new r.NotificationType("$/setTraceNotification")}(m=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new r.NotificationType("$/logTraceNotification")}(g=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(y=t.ConnectionErrors||(t.ConnectionErrors={}));class S extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,S.prototype)}}function _(t,n,i,o){let a=0,_=0,E=0;let w,b,C=void 0,T=Object.create(null),M=void 0,A=Object.create(null),k=new Map,R=new u.LinkedMap,P=Object.create(null),I=Object.create(null),N=f.Off,L=p.Text,D=v.New,x=new c.Emitter,O=new c.Emitter,F=new c.Emitter,U=new c.Emitter,j=new c.Emitter;function H(e){return"req-"+e.toString()}function B(e,t){var n;r.isRequestMessage(t)?e.set(H(t.id),t):r.isResponseMessage(t)?e.set(null===(n=t.id)?"res-unknown-"+(++E).toString():"res-"+n.toString(),t):e.set("not-"+(++_).toString(),t)}function Y(e){}function W(){return D===v.Listening}function q(){return D===v.Closed}function V(){return D===v.Disposed}function $(){D!==v.New&&D!==v.Listening||(D=v.Closed,O.fire(void 0))}function K(){w||0===R.size||(w=e(()=>{w=void 0,function(){if(0===R.size)return;let e=R.shift();try{r.isRequestMessage(e)?function(e){if(V())return;function t(t,i,s){let o={jsonrpc:"2.0",id:e.id};t instanceof r.ResponseError?o.error=t.toJson():o.result=void 0===t?null:t,G(o,i,s),n.write(o)}function i(t,i,s){let r={jsonrpc:"2.0",id:e.id,error:t.toJson()};G(r,i,s),n.write(r)}!function(e){if(N===f.Off||!b)return;if(L===p.Text){let t=void 0;N===f.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),b.log(`Received request '${e.method} - (${e.id})'.`,t)}else J("receive-request",e)}(e);let o,a,c=T[e.method];c&&(o=c.type,a=c.handler);let u=Date.now();if(a||C){let c=new l.CancellationTokenSource,d=String(e.id);I[d]=c;try{let l;l=void 0===e.params||void 0!==o&&0===o.numberOfParams?a?a(c.token):C(e.method,c.token):s.array(e.params)&&(void 0===o||o.numberOfParams>1)?a?a(...e.params,c.token):C(e.method,...e.params,c.token):a?a(e.params,c.token):C(e.method,e.params,c.token);let h=l;l?h.then?h.then(n=>{delete I[d],t(n,e.method,u)},t=>{delete I[d],t instanceof r.ResponseError?i(t,e.method,u):t&&s.string(t.message)?i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,u):i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)}):(delete I[d],t(l,e.method,u)):(delete I[d],function(t,i,s){void 0===t&&(t=null);let r={jsonrpc:"2.0",id:e.id,result:t};G(r,i,s),n.write(r)}(l,e.method,u))}catch(n){delete I[d],n instanceof r.ResponseError?t(n,e.method,u):n&&s.string(n.message)?i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${n.message}`),e.method,u):i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)}}else i(new r.ResponseError(r.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,u)}(e):r.isNotificationMessage(e)?function(e){if(V())return;let t,n=void 0;if(e.method===d.type.method)t=e=>{let t=e.id,n=I[String(t)];n&&n.cancel()};else{let i=A[e.method];i&&(t=i.handler,n=i.type)}if(t||M)try{!function(e){if(N===f.Off||!b||e.method===g.type.method)return;if(L===p.Text){let t=void 0;N===f.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),b.log(`Received notification '${e.method}'.`,t)}else J("receive-notification",e)}(e),void 0===e.params||void 0!==n&&0===n.numberOfParams?t?t():M(e.method):s.array(e.params)&&(void 0===n||n.numberOfParams>1)?t?t(...e.params):M(e.method,...e.params):t?t(e.params):M(e.method,e.params)}catch(t){t.message?i.error(`Notification handler '${e.method}' failed with message: ${t.message}`):i.error(`Notification handler '${e.method}' failed unexpectedly.`)}else F.fire(e)}(e):r.isResponseMessage(e)?function(e){if(V())return;if(null===e.id)e.error?i.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let t=String(e.id),n=P[t];if(function(e,t){if(N===f.Off||!b)return;if(L===p.Text){let n=void 0;if(N===f.Verbose&&(e.error&&e.error.data?n=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?n=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),t){let i=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";b.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${i}`,n)}else b.log(`Received response ${e.id} without active response promise.`,n)}else J("receive-response",e)}(e,n),n){delete P[t];try{if(e.error){let t=e.error;n.reject(new r.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");n.resolve(e.result)}}catch(e){e.message?i.error(`Response handler '${n.method}' failed with message: ${e.message}`):i.error(`Response handler '${n.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void i.error("Received empty message.");i.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);let t=e;if(s.string(t.id)||s.number(t.id)){let e=String(t.id),n=P[e];n&&n.reject(new Error("The received response has neither a result nor an error property."))}}(e)}finally{K()}}()}))}t.onClose($),t.onError((function(e){x.fire([e,void 0,void 0])})),n.onClose($),n.onError((function(e){x.fire(e)}));let z=e=>{try{if(r.isNotificationMessage(e)&&e.method===d.type.method){let t=H(e.params.id),i=R.get(t);if(r.isRequestMessage(i)){let s=o&&o.cancelUndispatched?o.cancelUndispatched(i,Y):void 0;if(s&&(void 0!==s.error||void 0!==s.result))return R.delete(t),s.id=i.id,G(s,e.method,Date.now()),void n.write(s)}}B(R,e)}finally{K()}};function G(e,t,n){if(N!==f.Off&&b)if(L===p.Text){let i=void 0;N===f.Verbose&&(e.error&&e.error.data?i=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?i=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(i="No result returned.\n\n")),b.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-n}ms`,i)}else J("send-response",e)}function J(e,t){if(!b||N===f.Off)return;const n={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};b.log(n)}function X(){if(q())throw new S(y.Closed,"Connection is closed.");if(V())throw new S(y.Disposed,"Connection is disposed.")}function Z(e){return void 0===e?null:e}function Q(e,t){let n,i=e.numberOfParams;switch(i){case 0:n=null;break;case 1:n=Z(t[0]);break;default:n=[];for(let e=0;e<t.length&&e<i;e++)n.push(Z(t[e]));if(t.length<i)for(let e=t.length;e<i;e++)n.push(null)}return n}let ee={sendNotification:(e,...t)=>{let i,r;if(X(),s.string(e))switch(i=e,t.length){case 0:r=null;break;case 1:r=t[0];break;default:r=t}else i=e.method,r=Q(e,t);let o={jsonrpc:"2.0",method:i,params:r};!function(e){if(N!==f.Off&&b)if(L===p.Text){let t=void 0;N===f.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),b.log(`Sending notification '${e.method}'.`,t)}else J("send-notification",e)}(o),n.write(o)},onNotification:(e,t)=>{X(),s.func(e)?M=e:t&&(s.string(e)?A[e]={type:void 0,handler:t}:A[e.method]={type:e,handler:t})},onProgress:(e,t,n)=>{if(k.has(t))throw new Error(`Progress handler for token ${t} already registered`);return k.set(t,n),{dispose:()=>{k.delete(t)}}},sendProgress:(e,t,n)=>{ee.sendNotification(h.type,{token:t,value:n})},onUnhandledProgress:U.event,sendRequest:(e,...t)=>{let i,o;X(),function(){if(!W())throw new Error("Call listen() first.")}();let c=void 0;if(s.string(e))switch(i=e,t.length){case 0:o=null;break;case 1:l.CancellationToken.is(t[0])?(o=null,c=t[0]):o=Z(t[0]);break;default:const e=t.length-1;l.CancellationToken.is(t[e])?(c=t[e],o=2===t.length?Z(t[0]):t.slice(0,e).map(e=>Z(e))):o=t.map(e=>Z(e))}else{i=e.method,o=Q(e,t);let n=e.numberOfParams;c=l.CancellationToken.is(t[n])?t[n]:void 0}let u=a++,h=new Promise((e,t)=>{let s={jsonrpc:"2.0",id:u,method:i,params:o},a={method:i,timerStart:Date.now(),resolve:e,reject:t};!function(e){if(N!==f.Off&&b)if(L===p.Text){let t=void 0;N===f.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),b.log(`Sending request '${e.method} - (${e.id})'.`,t)}else J("send-request",e)}(s);try{n.write(s)}catch(e){a.reject(new r.ResponseError(r.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),a=null}a&&(P[String(u)]=a)});return c&&c.onCancellationRequested(()=>{ee.sendNotification(d.type,{id:u})}),h},onRequest:(e,t)=>{X(),s.func(e)?C=e:t&&(s.string(e)?T[e]={type:void 0,handler:t}:T[e.method]={type:e,handler:t})},trace:(e,t,n)=>{let i=!1,r=p.Text;void 0!==n&&(s.boolean(n)?i=n:(i=n.sendNotification||!1,r=n.traceFormat||p.Text)),N=e,L=r,b=N===f.Off?void 0:t,!i||q()||V()||ee.sendNotification(m.type,{value:f.toString(e)})},onError:x.event,onClose:O.event,onUnhandledNotification:F.event,onDispose:j.event,dispose:()=>{if(V())return;D=v.Disposed,j.fire(void 0);let e=new Error("Connection got disposed.");Object.keys(P).forEach(t=>{P[t].reject(e)}),P=Object.create(null),I=Object.create(null),R=new u.LinkedMap,s.func(n.dispose)&&n.dispose(),s.func(t.dispose)&&t.dispose()},listen:()=>{X(),function(){if(W())throw new S(y.AlreadyListening,"Connection is already listening")}(),D=v.Listening,t.listen(z)},inspect:()=>{console.log("inspect")}};return ee.onNotification(g.type,e=>{N!==f.Off&&b&&b.log(e.message,N===f.Verbose?e.verbose:void 0)}),ee.onNotification(h.type,e=>{const t=k.get(e.token);t?t(e.value):U.fire(e)}),ee}t.ConnectionError=S,function(e){e.is=function(e){let t=e;return t&&s.func(t.cancelUndispatched)}}(t.ConnectionStrategy||(t.ConnectionStrategy={})),function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(v||(v={})),t.createMessageConnection=function(e,n,i,s){var r;return i||(i=t.NullLogger),_(void 0!==(r=e).listen&&void 0===r.read?e:new o.StreamMessageReader(e),function(e){return void 0!==e.write&&void 0===e.end}(n)?n:new a.StreamMessageWriter(n),i,s)}}).call(this,n(57).setImmediate)},function(e,t,n){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,s=Function.prototype.apply;function r(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new r(s.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new r(s.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(737),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(27))},function(e,t,n){"use strict";(function(t){var i=n(883);
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function s(e,t){if(e===t)return 0;for(var n=e.length,i=t.length,s=0,r=Math.min(n,i);s<r;++s)if(e[s]!==t[s]){n=e[s],i=t[s];break}return n<i?-1:i<n?1:0}function r(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var o=n(59),a=Object.prototype.hasOwnProperty,c=Array.prototype.slice,l="foo"===function(){}.name;function u(e){return Object.prototype.toString.call(e)}function d(e){return!r(e)&&("function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}var h=e.exports=v,f=/\s*function\s+([^\(\s]*)\s*/;function p(e){if(o.isFunction(e)){if(l)return e.name;var t=e.toString().match(f);return t&&t[1]}}function m(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function g(e){if(l||!o.isFunction(e))return o.inspect(e);var t=p(e);return"[Function"+(t?": "+t:"")+"]"}function y(e,t,n,i,s){throw new h.AssertionError({message:n,actual:e,expected:t,operator:i,stackStartFunction:s})}function v(e,t){e||y(e,!0,t,"==",h.ok)}function S(e,t,n,i){if(e===t)return!0;if(r(e)&&r(t))return 0===s(e,t);if(o.isDate(e)&&o.isDate(t))return e.getTime()===t.getTime();if(o.isRegExp(e)&&o.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(d(e)&&d(t)&&u(e)===u(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===s(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(r(e)!==r(t))return!1;var a=(i=i||{actual:[],expected:[]}).actual.indexOf(e);return-1!==a&&a===i.expected.indexOf(t)||(i.actual.push(e),i.expected.push(t),function(e,t,n,i){if(null==e||null==t)return!1;if(o.isPrimitive(e)||o.isPrimitive(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var s=_(e),r=_(t);if(s&&!r||!s&&r)return!1;if(s)return e=c.call(e),t=c.call(t),S(e,t,n);var a,l,u=b(e),d=b(t);if(u.length!==d.length)return!1;for(u.sort(),d.sort(),l=u.length-1;l>=0;l--)if(u[l]!==d[l])return!1;for(l=u.length-1;l>=0;l--)if(a=u[l],!S(e[a],t[a],n,i))return!1;return!0}(e,t,n,i))}return n?e===t:e==t}function _(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function E(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function w(e,t,n,i){var s;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(i=n,n=null),s=function(e){var t;try{e()}catch(e){t=e}return t}(t),i=(n&&n.name?" ("+n.name+").":".")+(i?" "+i:"."),e&&!s&&y(s,n,"Missing expected exception"+i);var r="string"==typeof i,a=!e&&s&&!n;if((!e&&o.isError(s)&&r&&E(s,n)||a)&&y(s,n,"Got unwanted exception"+i),e&&s&&n&&!E(s,n)||!e&&s)throw s}h.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return m(g(e.actual),128)+" "+e.operator+" "+m(g(e.expected),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||y;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var i=n.stack,s=p(t),r=i.indexOf("\n"+s);if(r>=0){var o=i.indexOf("\n",r+1);i=i.substring(o+1)}this.stack=i}}},o.inherits(h.AssertionError,Error),h.fail=y,h.ok=v,h.equal=function(e,t,n){e!=t&&y(e,t,n,"==",h.equal)},h.notEqual=function(e,t,n){e==t&&y(e,t,n,"!=",h.notEqual)},h.deepEqual=function(e,t,n){S(e,t,!1)||y(e,t,n,"deepEqual",h.deepEqual)},h.deepStrictEqual=function(e,t,n){S(e,t,!0)||y(e,t,n,"deepStrictEqual",h.deepStrictEqual)},h.notDeepEqual=function(e,t,n){S(e,t,!1)&&y(e,t,n,"notDeepEqual",h.notDeepEqual)},h.notDeepStrictEqual=function e(t,n,i){S(t,n,!0)&&y(t,n,i,"notDeepStrictEqual",e)},h.strictEqual=function(e,t,n){e!==t&&y(e,t,n,"===",h.strictEqual)},h.notStrictEqual=function(e,t,n){e===t&&y(e,t,n,"!==",h.notStrictEqual)},h.throws=function(e,t,n){w(!0,e,t,n)},h.doesNotThrow=function(e,t,n){w(!1,e,t,n)},h.ifError=function(e){if(e)throw e},h.strict=i((function e(t,n){t||y(t,!0,n,"==",e)}),h,{equal:h.strictEqual,deepEqual:h.deepStrictEqual,notEqual:h.notStrictEqual,notDeepEqual:h.notDeepStrictEqual}),h.strict.strict=h.strict;var b=Object.keys||function(e){var t=[];for(var n in e)a.call(e,n)&&t.push(n);return t}}).call(this,n(27))},function(e,t,n){(function(e){var i=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},i=0;i<t.length;i++)n[t[i]]=Object.getOwnPropertyDescriptor(e,t[i]);return n},s=/%[sdj%]/g;t.format=function(e){if(!y(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(a(arguments[n]));return t.join(" ")}n=1;for(var i=arguments,r=i.length,o=String(e).replace(s,(function(e){if("%%"===e)return"%";if(n>=r)return e;switch(e){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(e){return"[Circular]"}default:return e}})),c=i[n];n<r;c=i[++n])m(c)||!_(c)?o+=" "+c:o+=" "+a(c);return o},t.deprecate=function(n,i){if(void 0!==e&&!0===e.noDeprecation)return n;if(void 0===e)return function(){return t.deprecate(n,i).apply(this,arguments)};var s=!1;return function(){if(!s){if(e.throwDeprecation)throw new Error(i);e.traceDeprecation?console.trace(i):console.error(i),s=!0}return n.apply(this,arguments)}};var r,o={};function a(e,n){var i={seen:[],stylize:l};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),p(n)?i.showHidden=n:n&&t._extend(i,n),v(i.showHidden)&&(i.showHidden=!1),v(i.depth)&&(i.depth=2),v(i.colors)&&(i.colors=!1),v(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=c),u(i,e,i.depth)}function c(e,t){var n=a.styles[t];return n?"["+a.colors[n][0]+"m"+e+"["+a.colors[n][1]+"m":e}function l(e,t){return e}function u(e,n,i){if(e.customInspect&&n&&b(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var s=n.inspect(i,e);return y(s)||(s=u(e,s,i)),s}var r=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(y(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(g(t))return e.stylize(""+t,"number");if(p(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,n);if(r)return r;var o=Object.keys(n),a=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(n)),w(n)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return d(n);if(0===o.length){if(b(n)){var c=n.name?": "+n.name:"";return e.stylize("[Function"+c+"]","special")}if(S(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(E(n))return e.stylize(Date.prototype.toString.call(n),"date");if(w(n))return d(n)}var l,_="",C=!1,T=["{","}"];(f(n)&&(C=!0,T=["[","]"]),b(n))&&(_=" [Function"+(n.name?": "+n.name:"")+"]");return S(n)&&(_=" "+RegExp.prototype.toString.call(n)),E(n)&&(_=" "+Date.prototype.toUTCString.call(n)),w(n)&&(_=" "+d(n)),0!==o.length||C&&0!=n.length?i<0?S(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),l=C?function(e,t,n,i,s){for(var r=[],o=0,a=t.length;o<a;++o)k(t,String(o))?r.push(h(e,t,n,i,String(o),!0)):r.push("");return s.forEach((function(s){s.match(/^\d+$/)||r.push(h(e,t,n,i,s,!0))})),r}(e,n,i,a,o):o.map((function(t){return h(e,n,i,a,t,C)})),e.seen.pop(),function(e,t,n){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(l,_,T)):T[0]+_+T[1]}function d(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,n,i,s,r){var o,a,c;if((c=Object.getOwnPropertyDescriptor(t,s)||{value:t[s]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),k(i,s)||(o="["+s+"]"),a||(e.seen.indexOf(c.value)<0?(a=m(n)?u(e,c.value,null):u(e,c.value,n-1)).indexOf("\n")>-1&&(a=r?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),v(o)){if(r&&s.match(/^\d+$/))return a;(o=JSON.stringify(""+s)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+a}function f(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function m(e){return null===e}function g(e){return"number"==typeof e}function y(e){return"string"==typeof e}function v(e){return void 0===e}function S(e){return _(e)&&"[object RegExp]"===C(e)}function _(e){return"object"==typeof e&&null!==e}function E(e){return _(e)&&"[object Date]"===C(e)}function w(e){return _(e)&&("[object Error]"===C(e)||e instanceof Error)}function b(e){return"function"==typeof e}function C(e){return Object.prototype.toString.call(e)}function T(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(v(r)&&(r=e.env.NODE_DEBUG||""),n=n.toUpperCase(),!o[n])if(new RegExp("\\b"+n+"\\b","i").test(r)){var i=e.pid;o[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,i,e)}}else o[n]=function(){};return o[n]},t.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=f,t.isBoolean=p,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=y,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=v,t.isRegExp=S,t.isObject=_,t.isDate=E,t.isError=w,t.isFunction=b,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(884);var M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(){var e=new Date,t=[T(e.getHours()),T(e.getMinutes()),T(e.getSeconds())].join(":");return[e.getDate(),M[e.getMonth()],t].join(" ")}function k(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",A(),t.format.apply(t,arguments))},t.inherits=n(885),t._extend=function(e,t){if(!t||!_(t))return e;for(var n=Object.keys(t),i=n.length;i--;)e[n[i]]=t[n[i]];return e};var R="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function P(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(R&&e[R]){var t;if("function"!=typeof(t=e[R]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,R,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,i=new Promise((function(e,i){t=e,n=i})),s=[],r=0;r<arguments.length;r++)s.push(arguments[r]);s.push((function(e,i){e?n(e):t(i)}));try{e.apply(this,s)}catch(e){n(e)}return i}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),R&&Object.defineProperty(t,R,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,i(e))},t.promisify.custom=R,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],i=0;i<arguments.length;i++)n.push(arguments[i]);var s=n.pop();if("function"!=typeof s)throw new TypeError("The last argument must be of type Function");var r=this,o=function(){return s.apply(r,arguments)};t.apply(this,n).then((function(t){e.nextTick(o,null,t)}),(function(t){e.nextTick(P,t,o)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,i(t)),n}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(165),s=n(7),r=n(93),o=n(5),a=n(231);function c(e){return t=>e+t+"[0m"}t.assert=function(e,t,n,c){e||(i.checkDebugging(),s.traceSource.withName(o.vsls.TraceSources.ClientCoEditing).error(`Assertion Violation: ${t}`),r.CoauthoringTelemetry.ReportFailedAssertion(n||t,c),a.showDiagnosticErrorMessage(`Coediting Assertion Violation: ${t}`))},function(e){e.black=c("[30m"),e.red=c("[31m"),e.green=c("[32m"),e.yellow=c("[33m"),e.blue=c("[34m"),e.magenta=c("[35m"),e.cyan=c("[36m"),e.white=c("[37m")}(t.colorize||(t.colorize={}));class l{constructor(){this.indentValue=0}indent(){this.indentValue++}reset(){this.indentValue=0}unindent(){this.indentValue--}logTrace(e,...t){this.logInternal(e.verbose.bind(e),...t)}log(...e){this.logInternal(console.log,...e)}logInternal(e,...t){let n="";for(let e=0;e<this.indentValue;e++)n+="|   ";e(n+t.join(""))}}t.LoggerImpl=l,t.logger=new l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(7),s=n(9),r=n(94),o=n(50),a=n(965),c=n(966),l=n(239),u=n(967),d=n(969),h=n(970),f=n(411),p=n(994),m=n(995),g=n(424),y=n(427),v=n(429),S=n(430),_=n(445);class E{}function w(){if(!E.rpcServices)throw new Error("rpcServices not defined");return E.rpcServices}t.Dependencies=E,t.dependencies=function(e,t,n){const r={rpcClient:l.delayedLoadMutable("rpcClient"),rpcFactory:(e,t)=>w().rpcFactory(e,t),sessionContext:()=>e,trace:()=>t,telemetry:()=>n,contextUtil:l.lazyLoad(()=>new a.ContextUtil),workspaceService:l.lazyLoad(()=>w().workspaceService()),accessControlService:l.lazyLoad(()=>w().accessControlService()),workspaceAccessControlService:l.lazyLoad(()=>w().workspaceAccessControlService()),fileService:l.lazyLoad(()=>w().fileService()),streamManagerService:l.lazyLoad(()=>w().streamManagerService()),streamService:l.lazyLoad(()=>w().streamService()),chatService:l.lazyLoad(()=>w().chatService()),terminalService:l.lazyLoad(()=>w().terminalService()),rpcServiceHandler:()=>w().rpcServiceHandler(),fileSystemManager:l.lazyLoad(()=>new f.FileSystemManager(r,r.sessionContext())),coEditingCommands:l.lazyLoad(()=>new p.CoEditingCommands(r.sessionContext())),pathManager:l.lazyLoad(()=>new o.PathManager(!1,r.fileService)),sourceEventService:l.lazyLoad(()=>w().sourceEventService()),workspaceUserService:l.lazyLoad(()=>w().workspaceUserService()),syncService:l.lazyLoad(()=>w().syncService()),serverSharingService:l.lazyLoad(()=>w().serverSharingService()),portForwardingService:l.lazyLoad(()=>w().portForwardingService()),commandContextBuilder:l.lazyLoad(()=>new u.CommandContextBuilder(i.traceSource)),commandRegistryProvider:l.lazyLoad(()=>new d.CommandRegistryProvider(r.commandContextBuilder(),s.Telemetry,i.traceSource.withName("CommandRegistry"))),progressNotifierUtil:l.lazyLoad(()=>new c.ProgressNotifierUtil(r.contextUtil(),r.workspaceService(),i.traceSource.withName("Progress"))),authenticationFlow:l.lazyLoad(()=>new h.AuthenticationFlow(r.authenticationProvider(),i.traceSource.withName("AuthenticationFlow"))),authenticationProvider:l.delayedLoadMutable("authenticationProvider"),sessionStateManager:l.lazyLoad(()=>new m.SessionStateManager),methodDecorators:l.lazyLoad(()=>g.methodDecoratorsFactory(r)),authService:l.lazyLoadMutable(()=>new S.AuthenticationProviderService(i.traceSource.withName("AuthenticationProviderService"))),workspaceServices:l.lazyLoad(()=>new _.WorkspaceServices(r.workspaceService())),accessControlManager:l.lazyLoad(()=>new y.AccessControlManager(r.workspaceAccessControlService(),r.accessControlService(),r.sessionContext(),r.fileSystemManager(),r.hostSessionId())),hostSessionId:l.delayedLoadMutable("hostSessionId"),workspaceAccessControlManager:l.lazyLoad(()=>new v.WorkspaceAccessControlManager(r,r.hostSessionId())),statusBarController:l.delayedLoadMutable("statusBarController")};return r}(r.SessionContext,i.traceSource,s.Telemetry)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1032);t.Access=i.Access,t.Role=i.Role,t.View=i.View,t.ViewItem=i.ViewItem,t.extensionId=i.extensionId,t.ActivityType=i.ActivityType},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6);class s extends i.BaseError{constructor(){super(...arguments),this.errorType="ConnectionError"}}t.ConnectionError=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(272);t.LogLevel=i.LogLevel;var s=n(180);t.CallbackContainer=s.CallbackContainer;var r=n(470);t.HubMethodOption=r.HubMethodOption;var o=n(1100);t.ConnectionChangeType=o.ConnectionChangeType;var a=n(1101);t.ContactServiceProxy=a.ContactServiceProxy;var c=n(1102);t.RelayServiceProxy=c.RelayServiceProxy;var l=n(472);t.ParticipantChangeType=l.ParticipantChangeType,t.SendOption=l.SendOption;var u=n(473);t.RelayDataHubProxy=u.RelayDataHubProxy;var d=n(1103);t.SequenceRelayDataHubProxy=d.SequenceRelayDataHubProxy;var h=n(474);t.RelayHubMessageProperties=h.RelayHubMessageProperties},function(e,t,n){var i=n(14).Buffer,s=n(34).Transform,r=n(202).StringDecoder;function o(e){s.call(this),this.hashMode="string"==typeof e,this.hashMode?this[e]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}n(12)(o,s),o.prototype.update=function(e,t,n){"string"==typeof e&&(e=i.from(e,t));var s=this._update(e);return this.hashMode?this:(n&&(s=this._toString(s,n)),s)},o.prototype.setAutoPadding=function(){},o.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},o.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},o.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},o.prototype._transform=function(e,t,n){var i;try{this.hashMode?this._update(e):this.push(this._update(e))}catch(e){i=e}finally{n(i)}},o.prototype._flush=function(e){var t;try{this.push(this.__final())}catch(e){t=e}e(t)},o.prototype._finalOrDigest=function(e){var t=this.__final()||i.alloc(0);return e&&(t=this._toString(t,e,!0)),t},o.prototype._toString=function(e,t,n){if(this._decoder||(this._decoder=new r(t),this._encoding=t),this._encoding!==t)throw new Error("can't switch encodings");var i=this._decoder.write(e);return n&&(i+=this._decoder.end()),i},e.exports=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Net={Socket:function(){}}},function(e,t,n){(function(n){var i;t=e.exports=K,i="object"==typeof n&&n.env&&n.env.NODE_DEBUG&&/\bsemver\b/i.test(n.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var s=Number.MAX_SAFE_INTEGER||9007199254740991,r=t.re=[],o=t.src=[],a=0,c=a++;o[c]="0|[1-9]\\d*";var l=a++;o[l]="[0-9]+";var u=a++;o[u]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var d=a++;o[d]="("+o[c]+")\\.("+o[c]+")\\.("+o[c]+")";var h=a++;o[h]="("+o[l]+")\\.("+o[l]+")\\.("+o[l]+")";var f=a++;o[f]="(?:"+o[c]+"|"+o[u]+")";var p=a++;o[p]="(?:"+o[l]+"|"+o[u]+")";var m=a++;o[m]="(?:-("+o[f]+"(?:\\."+o[f]+")*))";var g=a++;o[g]="(?:-?("+o[p]+"(?:\\."+o[p]+")*))";var y=a++;o[y]="[0-9A-Za-z-]+";var v=a++;o[v]="(?:\\+("+o[y]+"(?:\\."+o[y]+")*))";var S=a++,_="v?"+o[d]+o[m]+"?"+o[v]+"?";o[S]="^"+_+"$";var E="[v=\\s]*"+o[h]+o[g]+"?"+o[v]+"?",w=a++;o[w]="^"+E+"$";var b=a++;o[b]="((?:<|>)?=?)";var C=a++;o[C]=o[l]+"|x|X|\\*";var T=a++;o[T]=o[c]+"|x|X|\\*";var M=a++;o[M]="[v=\\s]*("+o[T]+")(?:\\.("+o[T]+")(?:\\.("+o[T]+")(?:"+o[m]+")?"+o[v]+"?)?)?";var A=a++;o[A]="[v=\\s]*("+o[C]+")(?:\\.("+o[C]+")(?:\\.("+o[C]+")(?:"+o[g]+")?"+o[v]+"?)?)?";var k=a++;o[k]="^"+o[b]+"\\s*"+o[M]+"$";var R=a++;o[R]="^"+o[b]+"\\s*"+o[A]+"$";var P=a++;o[P]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var I=a++;o[I]="(?:~>?)";var N=a++;o[N]="(\\s*)"+o[I]+"\\s+",r[N]=new RegExp(o[N],"g");var L=a++;o[L]="^"+o[I]+o[M]+"$";var D=a++;o[D]="^"+o[I]+o[A]+"$";var x=a++;o[x]="(?:\\^)";var O=a++;o[O]="(\\s*)"+o[x]+"\\s+",r[O]=new RegExp(o[O],"g");var F=a++;o[F]="^"+o[x]+o[M]+"$";var U=a++;o[U]="^"+o[x]+o[A]+"$";var j=a++;o[j]="^"+o[b]+"\\s*("+E+")$|^$";var H=a++;o[H]="^"+o[b]+"\\s*("+_+")$|^$";var B=a++;o[B]="(\\s*)"+o[b]+"\\s*("+E+"|"+o[M]+")",r[B]=new RegExp(o[B],"g");var Y=a++;o[Y]="^\\s*("+o[M]+")\\s+-\\s+("+o[M]+")\\s*$";var W=a++;o[W]="^\\s*("+o[A]+")\\s+-\\s+("+o[A]+")\\s*$";var q=a++;o[q]="(<|>)?=?\\s*\\*";for(var V=0;V<35;V++)i(V,o[V]),r[V]||(r[V]=new RegExp(o[V]));function $(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof K)return e;if("string"!=typeof e)return null;if(e.length>256)return null;if(!(t.loose?r[w]:r[S]).test(e))return null;try{return new K(e,t)}catch(e){return null}}function K(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof K){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof K))return new K(e,t);i("SemVer",e,t),this.options=t,this.loose=!!t.loose;var n=e.trim().match(t.loose?r[w]:r[S]);if(!n)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>s||this.major<0)throw new TypeError("Invalid major version");if(this.minor>s||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>s||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<s)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}t.parse=$,t.valid=function(e,t){var n=$(e,t);return n?n.version:null},t.clean=function(e,t){var n=$(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null},t.SemVer=K,K.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},K.prototype.toString=function(){return this.version},K.prototype.compare=function(e){return i("SemVer.compare",this.version,this.options,e),e instanceof K||(e=new K(e,this.options)),this.compareMain(e)||this.comparePre(e)},K.prototype.compareMain=function(e){return e instanceof K||(e=new K(e,this.options)),G(this.major,e.major)||G(this.minor,e.minor)||G(this.patch,e.patch)},K.prototype.comparePre=function(e){if(e instanceof K||(e=new K(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],s=e.prerelease[t];if(i("prerelease compare",t,n,s),void 0===n&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===n)return-1;if(n!==s)return G(n,s)}while(++t)},K.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var n=this.prerelease.length;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);-1===n&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,n,i){"string"==typeof n&&(i=n,n=void 0);try{return new K(e,n).inc(t,i).version}catch(e){return null}},t.diff=function(e,t){if(Q(e,t))return null;var n=$(e),i=$(t),s="";if(n.prerelease.length||i.prerelease.length){s="pre";var r="prerelease"}for(var o in n)if(("major"===o||"minor"===o||"patch"===o)&&n[o]!==i[o])return s+o;return r},t.compareIdentifiers=G;var z=/^[0-9]+$/;function G(e,t){var n=z.test(e),i=z.test(t);return n&&i&&(e=+e,t=+t),e===t?0:n&&!i?-1:i&&!n?1:e<t?-1:1}function J(e,t,n){return new K(e,n).compare(new K(t,n))}function X(e,t,n){return J(e,t,n)>0}function Z(e,t,n){return J(e,t,n)<0}function Q(e,t,n){return 0===J(e,t,n)}function ee(e,t,n){return 0!==J(e,t,n)}function te(e,t,n){return J(e,t,n)>=0}function ne(e,t,n){return J(e,t,n)<=0}function ie(e,t,n,i){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return Q(e,n,i);case"!=":return ee(e,n,i);case">":return X(e,n,i);case">=":return te(e,n,i);case"<":return Z(e,n,i);case"<=":return ne(e,n,i);default:throw new TypeError("Invalid operator: "+t)}}function se(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof se){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof se))return new se(e,t);i("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===re?this.value="":this.value=this.operator+this.semver.version,i("comp",this)}t.rcompareIdentifiers=function(e,t){return G(t,e)},t.major=function(e,t){return new K(e,t).major},t.minor=function(e,t){return new K(e,t).minor},t.patch=function(e,t){return new K(e,t).patch},t.compare=J,t.compareLoose=function(e,t){return J(e,t,!0)},t.rcompare=function(e,t,n){return J(t,e,n)},t.sort=function(e,n){return e.sort((function(e,i){return t.compare(e,i,n)}))},t.rsort=function(e,n){return e.sort((function(e,i){return t.rcompare(e,i,n)}))},t.gt=X,t.lt=Z,t.eq=Q,t.neq=ee,t.gte=te,t.lte=ne,t.cmp=ie,t.Comparator=se;var re={};function oe(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof oe)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new oe(e.raw,t);if(e instanceof se)return new oe(e.value,t);if(!(this instanceof oe))return new oe(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function ae(e){return!e||"x"===e.toLowerCase()||"*"===e}function ce(e,t,n,i,s,r,o,a,c,l,u,d,h){return((t=ae(n)?"":ae(i)?">="+n+".0.0":ae(s)?">="+n+"."+i+".0":">="+t)+" "+(a=ae(c)?"":ae(l)?"<"+(+c+1)+".0.0":ae(u)?"<"+c+"."+(+l+1)+".0":d?"<="+c+"."+l+"."+u+"-"+d:"<="+a)).trim()}function le(e,t,n){for(var s=0;s<e.length;s++)if(!e[s].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(s=0;s<e.length;s++)if(i(e[s].semver),e[s].semver!==re&&e[s].semver.prerelease.length>0){var r=e[s].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0}function ue(e,t,n){try{t=new oe(t,n)}catch(e){return!1}return t.test(e)}function de(e,t,n,i){var s,r,o,a,c;switch(e=new K(e,i),t=new oe(t,i),n){case">":s=X,r=ne,o=Z,a=">",c=">=";break;case"<":s=Z,r=te,o=X,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(ue(e,t,i))return!1;for(var l=0;l<t.set.length;++l){var u=t.set[l],d=null,h=null;if(u.forEach((function(e){e.semver===re&&(e=new se(">=0.0.0")),d=d||e,h=h||e,s(e.semver,d.semver,i)?d=e:o(e.semver,h.semver,i)&&(h=e)})),d.operator===a||d.operator===c)return!1;if((!h.operator||h.operator===a)&&r(e,h.semver))return!1;if(h.operator===c&&o(e,h.semver))return!1}return!0}se.prototype.parse=function(e){var t=this.options.loose?r[j]:r[H],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: "+e);this.operator=n[1],"="===this.operator&&(this.operator=""),n[2]?this.semver=new K(n[2],this.options.loose):this.semver=re},se.prototype.toString=function(){return this.value},se.prototype.test=function(e){return i("Comparator.test",e,this.options.loose),this.semver===re||("string"==typeof e&&(e=new K(e,this.options)),ie(e,this.operator,this.semver,this.options))},se.prototype.intersects=function(e,t){if(!(e instanceof se))throw new TypeError("a Comparator is required");var n;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return n=new oe(e.value,t),ue(this.value,n,t);if(""===e.operator)return n=new oe(this.value,t),ue(e.semver,n,t);var i=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),s=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),r=this.semver.version===e.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=ie(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=ie(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return i||s||r&&o||a||c},t.Range=oe,oe.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},oe.prototype.toString=function(){return this.range},oe.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?r[W]:r[Y];e=e.replace(n,ce),i("hyphen replace",e),e=e.replace(r[B],"$1$2$3"),i("comparator trim",e,r[B]),e=(e=(e=e.replace(r[N],"$1~")).replace(r[O],"$1^")).split(/\s+/).join(" ");var s=t?r[j]:r[H],o=e.split(" ").map((function(e){return function(e,t){return i("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){i("caret",e,t);var n=t.loose?r[U]:r[F];return e.replace(n,(function(t,n,s,r,o){var a;return i("caret",e,t,n,s,r,o),ae(n)?a="":ae(s)?a=">="+n+".0.0 <"+(+n+1)+".0.0":ae(r)?a="0"===n?">="+n+"."+s+".0 <"+n+"."+(+s+1)+".0":">="+n+"."+s+".0 <"+(+n+1)+".0.0":o?(i("replaceCaret pr",o),a="0"===n?"0"===s?">="+n+"."+s+"."+r+"-"+o+" <"+n+"."+s+"."+(+r+1):">="+n+"."+s+"."+r+"-"+o+" <"+n+"."+(+s+1)+".0":">="+n+"."+s+"."+r+"-"+o+" <"+(+n+1)+".0.0"):(i("no pr"),a="0"===n?"0"===s?">="+n+"."+s+"."+r+" <"+n+"."+s+"."+(+r+1):">="+n+"."+s+"."+r+" <"+n+"."+(+s+1)+".0":">="+n+"."+s+"."+r+" <"+(+n+1)+".0.0"),i("caret return",a),a}))}(e,t)})).join(" ")}(e,t),i("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var n=t.loose?r[D]:r[L];return e.replace(n,(function(t,n,s,r,o){var a;return i("tilde",e,t,n,s,r,o),ae(n)?a="":ae(s)?a=">="+n+".0.0 <"+(+n+1)+".0.0":ae(r)?a=">="+n+"."+s+".0 <"+n+"."+(+s+1)+".0":o?(i("replaceTilde pr",o),a=">="+n+"."+s+"."+r+"-"+o+" <"+n+"."+(+s+1)+".0"):a=">="+n+"."+s+"."+r+" <"+n+"."+(+s+1)+".0",i("tilde return",a),a}))}(e,t)})).join(" ")}(e,t),i("tildes",e),e=function(e,t){return i("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var n=t.loose?r[R]:r[k];return e.replace(n,(function(t,n,s,r,o,a){i("xRange",e,t,n,s,r,o,a);var c=ae(s),l=c||ae(r),u=l||ae(o);return"="===n&&u&&(n=""),c?t=">"===n||"<"===n?"<0.0.0":"*":n&&u?(l&&(r=0),o=0,">"===n?(n=">=",l?(s=+s+1,r=0,o=0):(r=+r+1,o=0)):"<="===n&&(n="<",l?s=+s+1:r=+r+1),t=n+s+"."+r+"."+o):l?t=">="+s+".0.0 <"+(+s+1)+".0.0":u&&(t=">="+s+"."+r+".0 <"+s+"."+(+r+1)+".0"),i("xRange return",t),t}))}(e,t)})).join(" ")}(e,t),i("xrange",e),e=function(e,t){return i("replaceStars",e,t),e.trim().replace(r[q],"")}(e,t),i("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(o=o.filter((function(e){return!!e.match(s)}))),o=o.map((function(e){return new se(e,this.options)}),this)},oe.prototype.intersects=function(e,t){if(!(e instanceof oe))throw new TypeError("a Range is required");return this.set.some((function(n){return n.every((function(n){return e.set.some((function(e){return e.every((function(e){return n.intersects(e,t)}))}))}))}))},t.toComparators=function(e,t){return new oe(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},oe.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new K(e,this.options));for(var t=0;t<this.set.length;t++)if(le(this.set[t],e,this.options))return!0;return!1},t.satisfies=ue,t.maxSatisfying=function(e,t,n){var i=null,s=null;try{var r=new oe(t,n)}catch(e){return null}return e.forEach((function(e){r.test(e)&&(i&&-1!==s.compare(e)||(s=new K(i=e,n)))})),i},t.minSatisfying=function(e,t,n){var i=null,s=null;try{var r=new oe(t,n)}catch(e){return null}return e.forEach((function(e){r.test(e)&&(i&&1!==s.compare(e)||(s=new K(i=e,n)))})),i},t.minVersion=function(e,t){e=new oe(e,t);var n=new K("0.0.0");if(e.test(n))return n;if(n=new K("0.0.0-0"),e.test(n))return n;n=null;for(var i=0;i<e.set.length;++i){e.set[i].forEach((function(e){var t=new K(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":n&&!X(n,t)||(n=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}))}if(n&&e.test(n))return n;return null},t.validRange=function(e,t){try{return new oe(e,t).range||"*"}catch(e){return null}},t.ltr=function(e,t,n){return de(e,t,"<",n)},t.gtr=function(e,t,n){return de(e,t,">",n)},t.outside=de,t.prerelease=function(e,t){var n=$(e,t);return n&&n.prerelease.length?n.prerelease:null},t.intersects=function(e,t,n){return e=new oe(e,n),t=new oe(t,n),e.intersects(t)},t.coerce=function(e){if(e instanceof K)return e;if("string"!=typeof e)return null;var t=e.match(r[P]);if(null==t)return null;return $(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(18),r=n(13);let o,a;function c(){return a||(a=new RegExp('"'+r.Settings.scheme+':([^"]*)"',"g")),a}class l{static replaceSchemeWithPath(e,t){return(t.endsWith("/")||t.endsWith("\\"))&&(t=t.substr(0,t.length-1)),e.replace((o||(o=new RegExp(r.Settings.scheme+":","g")),o),t)}static getMonikerFromUri(e){if(e.scheme!==r.Settings.scheme)throw new Error(`Invalid scheme: '${e.scheme}', expected: '${r.Settings.scheme}'`);return l.getMonikerFromRelativePath(e.path)}static getMonikerFromRelativePath(e){const t=e.indexOf("/",1);if(t<3||"~"!==e[1])return{moniker:"",relativePath:e};const n=(t>1?t:e.length)-2;return{moniker:e.substr(2,n),relativePath:e.substr(2+n)}}static getRelativePathFromPrefixedPath(e){const{moniker:t,relativePath:n}=l.getMonikerFromRelativePath(e);return"0"!==t?e:n}static getPrefixedRoot(e){return"0"!==e&&e?`/~${e}`:"/"}static replaceSchemeWithPathInLine(e,t){let n=e.replace(c(),e=>l.convertToForwardSlashesIfNeeded(e,t));return l.replaceSchemeWithPath(n,t)}static replacePathWithScheme(e,t){(t.endsWith("/")||t.endsWith("\\"))&&(t=t.substr(0,t.length-1));let n=new RegExp(t.replace(/[\/\\]+/g,"[\\/\\\\]+"),"gi");return e.replace(n,r.Settings.scheme+":")}static replacePathWithSchemeInLine(e,t){return l.replacePathWithScheme(e,t).replace(c(),e=>e.replace(/[\/\\]+/g,"/"))}static removeRootFromFileSystemPath(e,t){(t.endsWith("/")||t.endsWith("\\"))&&(t=t.substr(0,t.length-1));let n=new RegExp(t.replace(/[\/\\]+/g,"[\\/\\\\]+"),"gi");return e.replace(n,"")}static convertToForwardSlashes(e){return e.replace(/\\\\/g,"/").replace(/\\/g,"/")}static convertToForwardSlashesIfNeeded(e,t){return"/"===t[0]?l.convertToForwardSlashes(e):e}static removeLeadingSlash(e){return e.startsWith("/")?e.substring(1):e}static removeFinalSlash(e){return e.endsWith("/")?e.substring(0,e.length-1):e}static normalizePath(e){return this.removeFinalSlash(this.convertToForwardSlashes(e))}static EscapeBackslash(e){return e.replace(/\\/g,"\\\\")}static removePath(e,t=""){return e.replace(/([A-Za-z]:)?(\S*[\\\/])+\S*/gi,(e,n,i,s,r)=>{if(/^\d{1,4}\/\d{1,2}\/\d{1,4}$/.test(e))return e;{const s=(n?n.length:0)+i.length,r=e.substr(s);return t+r}})}static getWorkspaceName(e){return(s.basename(e)||e).replace(/:[\\|\/]?|\\|\//g,"$")}static getPrimaryWorkspaceFileSystemPath(){if(i.workspace.workspaceFolders&&i.workspace.workspaceFolders.length)return i.workspace.workspaceFolders[0].uri.fsPath}}t.PathUtil=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_ANONYMOUS_USER_NAME="Guest User",t.READ_ONLY_LABEL="Read-only",t.READ_WRITE_LABEL="Read-write",t.LIVESHARE_EXTENSION_ID="ms-vsliveshare.vsliveshare",t.LIVESHARE_PRESENCE_PROVIDER_ID="LivesharePresence"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);class s extends i.TreeItem{constructor(e){super(e.label,e.collapsibleState||i.TreeItemCollapsibleState.None),this.options=e,this.tooltip=e.tooltip,this.command=e.command,this.iconPath=e.iconPath,this.contextValue=e.type,this.resourceUri=e.resourceUri,this.description=e.description}}t.TreeViewItem=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=Object.prototype.toString;function s(e){return"[object String]"===i.call(e)}function r(e){return"[object Function]"===i.call(e)}function o(e){return Array.isArray(e)}t.boolean=function(e){return!0===e||!1===e},t.string=s,t.number=function(e){return"[object Number]"===i.call(e)},t.error=function(e){return"[object Error]"===i.call(e)},t.func=r,t.array=o,t.stringArray=function(e){return o(e)&&e.every(e=>s(e))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.thenable=function(e){return e&&r(e.then)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.prototype.log=function(e,t){},e.instance=new e,e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.write=function(t){return""+t+e.RecordSeparator},e.parse=function(t){if(t[t.length-1]!==e.RecordSeparator)throw new Error("Message is incomplete.");var n=t.split(e.RecordSeparator);return n.pop(),n},e.RecordSeparatorCode=30,e.RecordSeparator=String.fromCharCode(e.RecordSeparatorCode),e}()},function(e,t){},function(e,t,n){"use strict";(function(t,i){var s=n(14).Buffer,r=t.crypto||t.msCrypto;r&&r.getRandomValues?e.exports=function(e,t){if(e>4294967295)throw new RangeError("requested too many random bytes");var n=s.allocUnsafe(e);if(e>0)if(e>65536)for(var o=0;o<e;o+=65536)r.getRandomValues(n.slice(o,o+65536));else r.getRandomValues(n);if("function"==typeof t)return i.nextTick((function(){t(null,n)}));return n}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this,n(27),n(11))},function(e,t,n){(t=e.exports=n(329)).Stream=t,t.Readable=t,t.Writable=n(201),t.Duplex=n(77),t.Transform=n(332),t.PassThrough=n(745)},function(e,t,n){"use strict";var i=n(153),s=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=d;var r=Object.create(n(119));r.inherits=n(12);var o=n(329),a=n(201);r.inherits(d,o);for(var c=s(a.prototype),l=0;l<c.length;l++){var u=c[l];d.prototype[u]||(d.prototype[u]=a.prototype[u])}function d(e){if(!(this instanceof d))return new d(e);o.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||i.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),d.prototype._destroy=function(e,t){this.push(null),this.end(),i.nextTick(t,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(364);t.assert=(e,t)=>{if(!0!==e){throw"string"==typeof t?new i.AssertionError(t):t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5);class s{static CoauthoringMessage(e){let t;switch(e.messageType){case i.vsls.MessageType.FileOpenAcknowledge:const n=e;t=s.FileOpenAcknowledgeMessage(n.clientId,n.fileName,n.fileVersion,n.joinerId,n.savedVersionNumber,n.startServerVersionNumber,n.changes,n.fallbackText,n.history,n.isReadOnly,n.wasUnableToOpen);break;case i.vsls.MessageType.FileOpenRequest:const r=e;t=s.FileOpenRequestMessage(r.clientId,r.fileName,r.hashCode,r.sendJumpTo);break;case i.vsls.MessageType.ResetFileClient:const o=e;t=s.ResetFileClientMessage(o.clientId,o.fileName);break;case i.vsls.MessageType.Handshake:const a=e;t=s.HandshakeMessage(a.clientId,a.fileName,a.hashCode,a.serverVersionNumber);break;case i.vsls.MessageType.FileRelease:const c=e;t=s.FileReleaseMessage(c.clientId,c.fileName);break;case i.vsls.MessageType.JoinAcknowledge:const l=e;t=s.JoinAcknowledgeMessage(l.clientId,l.joinerId,l.clientIds,l.files);break;case i.vsls.MessageType.JoinRequest:const u=e;t=s.JoinRequestMessage(u.clientId);break;case i.vsls.MessageType.PresenterUpdate:const d=e;t=s.PresenterUpdateMessage(d.clientId,d.newPresenterId);break;case i.vsls.MessageType.FollowChange:const h=e;t=s.FollowChangeMessage(h.clientId,h.followedClient,h.follow);break;case i.vsls.MessageType.SaveFile:const f=e;t=s.SaveFileMessage(f.clientId,f.fileName);break;case i.vsls.MessageType.SaveNotebook:const p=e;t=s.SaveNotebookMessage(p.clientId,p.fileName);break;case i.vsls.MessageType.UntitledFileOpened:const m=e;t=s.UntitledFileOpenedMessage(m.clientId,m.fileName);break;case i.vsls.MessageType.UntitledFileClosed:const g=e;t=s.UntitledFileClosedMessage(g.clientId,g.fileName);break;case i.vsls.MessageType.DiffViewOpen:const y=e;t=s.DiffViewOpenMessage(y.clientId,y.leftFile,y.rightFile);break;case i.vsls.MessageType.DiffViewClosed:const v=e;t=s.DiffViewClosedMessage(v.clientId,v.leftFile,v.rightFile);break;case i.vsls.MessageType.SelectionChange:const S=e;t=s.SelectionChangeMessage(S.clientId,S.fileName,S.fileVersion,S.serverVersionNumber,S.start,S.length,S.isReversed,S.kind,S.forceJumpForClientId);break;case i.vsls.MessageType.NotebookSelectionChange:const _=e;t=s.NotebookSelectionChangeMessage(_.clientId,_.fileName,_.index);break;case i.vsls.MessageType.VisibleRangesChange:const E=e;t=s.VisibleRangesChangeMessage(E.clientId,E.clientVisibleRanges);break;case i.vsls.MessageType.TextChange:const w=e,b=w.changes&&w.changes.map(e=>s.TextChange(e.start,e.length,e.newText));t=s.TextChangeMessage(w.clientId,w.fileName,w.fileVersion,w.changeServerVersion,b);break;case i.vsls.MessageType.Summon:const C=e;t=s.SummonMessage(C.clientId,C.recipientId);break;case i.vsls.MessageType.LayoutScroll:const T=e;t=s.LayoutScrollMessage(T.clientId,T.fileName,T.fileVersion,T.serverVersionNumber,T.start,T.length,T.editorId,T.visibleRanges);break;case i.vsls.MessageType.NotebookScroll:const M=e;t=s.NotebookScrollMessage(M.clientId,M.fileName,M.start,M.end);break;case i.vsls.MessageType.AnonymousAccessLevelChange:const A=e;t=s.AnonymousAccessLevelChangeMessage(A.clientId,A.fileName);break;case i.vsls.MessageType.Ping:const k=e;t=s.PingMessage(k.clientId);break;default:return e}return t.sendId=e.sendId,t}static SummonMessage(e,t){return{messageType:i.vsls.MessageType.Summon,clientId:e||0,recipientId:t}}static FileOpenAcknowledgeMessage(e,t,n,s,r,o,a,c,l,u,d){return{messageType:i.vsls.MessageType.FileOpenAcknowledge,clientId:e||0,fileName:t||"",fileVersion:n||0,joinerId:s||0,savedVersionNumber:r||0,startServerVersionNumber:o||0,changes:a||[],fallbackText:"string"==typeof c?c:void 0,history:l||[],isReadOnly:u||!1,wasUnableToOpen:d||!1}}static FileOpenRequestMessage(e,t,n,s){return{messageType:i.vsls.MessageType.FileOpenRequest,clientId:e||0,fileName:t||"",hashCode:n||0,sendJumpTo:s||!1}}static ResetFileClientMessage(e,t){return{messageType:i.vsls.MessageType.ResetFileClient,clientId:e||0,fileName:t||""}}static HandshakeMessage(e,t,n,s){return{messageType:i.vsls.MessageType.Handshake,clientId:e||0,fileName:t||"",hashCode:n||0,serverVersionNumber:s||0}}static FileReleaseMessage(e,t){return{messageType:i.vsls.MessageType.FileRelease,clientId:e||0,fileName:t||""}}static JoinAcknowledgeMessage(e,t,n,s){return{messageType:i.vsls.MessageType.JoinAcknowledge,clientId:e||0,joinerId:t||0,clientIds:n||[],files:s||[]}}static JoinRequestMessage(e){return{messageType:i.vsls.MessageType.JoinRequest,clientId:e||0}}static PresenterUpdateMessage(e,t){return{messageType:i.vsls.MessageType.PresenterUpdate,clientId:e||0,newPresenterId:t||0}}static FollowChangeMessage(e,t,n){return{messageType:i.vsls.MessageType.FollowChange,clientId:e||0,followedClient:t||0,follow:n||!1}}static AnonymousAccessLevelChangeMessage(e,t){return{messageType:i.vsls.MessageType.AnonymousAccessLevelChange,clientId:e||0,fileName:t||""}}static SaveFileMessage(e,t){return{messageType:i.vsls.MessageType.SaveFile,clientId:e||0,fileName:t||""}}static SaveNotebookMessage(e,t){return{messageType:i.vsls.MessageType.SaveNotebook,clientId:e||0,fileName:t||""}}static UntitledFileOpenedMessage(e,t){return{messageType:i.vsls.MessageType.UntitledFileOpened,clientId:e||0,fileName:t||""}}static UntitledFileClosedMessage(e,t){return{messageType:i.vsls.MessageType.UntitledFileClosed,clientId:e||0,fileName:t||""}}static DiffViewOpenMessage(e,t,n){return{messageType:i.vsls.MessageType.DiffViewOpen,clientId:e||0,leftFile:t||"",rightFile:n||""}}static DiffViewClosedMessage(e,t,n){return{messageType:i.vsls.MessageType.DiffViewClosed,clientId:e||0,leftFile:t||"",rightFile:n||""}}static SelectionChangeMessage(e,t,n,s,r,o,a,c,l){return{messageType:i.vsls.MessageType.SelectionChange,clientId:e||0,fileName:t||"",fileVersion:n,forceJumpForClientId:void 0===l?-1:l,isReversed:a||!1,length:o||0,serverVersionNumber:s||0,start:r||0,kind:c}}static NotebookSelectionChangeMessage(e,t,n){return{messageType:i.vsls.MessageType.NotebookSelectionChange,clientId:e||0,fileName:t||"",index:n||0}}static VisibleRangesChangeMessage(e,t){return{messageType:i.vsls.MessageType.VisibleRangesChange,clientId:e||0,clientVisibleRanges:t||[]}}static LayoutScrollMessage(e,t,n,s,r,o,a,c){return{messageType:i.vsls.MessageType.LayoutScroll,clientId:e||0,fileName:t||"",fileVersion:n,serverVersionNumber:s||0,start:r||0,length:o||0,editorId:a||"",visibleRanges:c||[]}}static NotebookScrollMessage(e,t,n,s){return{messageType:i.vsls.MessageType.NotebookScroll,clientId:e||0,fileName:t||"",start:n||0,end:s||0}}static PingMessage(e){return{messageType:i.vsls.MessageType.Ping,clientId:e||0}}static TextChangeMessage(e,t,n,s,r){return{messageType:i.vsls.MessageType.TextChange,changes:r||[],changeServerVersion:s||0,clientId:e||0,fileName:t||"",fileVersion:n}}static TextChange(e,t,n){return{length:t||0,newText:n||"",start:e||0}}}t.MessageFactory=s,t.IsFileContentMessage=function(e){switch(e.messageType){case i.vsls.MessageType.FileRelease:case i.vsls.MessageType.SaveFile:case i.vsls.MessageType.SelectionChange:case i.vsls.MessageType.TextChange:case i.vsls.MessageType.LayoutScroll:return!0;case i.vsls.MessageType.FileOpenAcknowledge:case i.vsls.MessageType.FileOpenRequest:case i.vsls.MessageType.JoinAcknowledge:case i.vsls.MessageType.JoinRequest:default:return!1}};class r{}t.CoauthoringService=r,r.SERVICE="Coauthoring"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelFailureMessage=t.ChannelSuccessMessage=t.ChannelSignalMessage=t.CommandRequestMessage=t.ChannelRequestMessage=t.ChannelRequestType=t.ChannelCloseMessage=t.ChannelEofMessage=t.ChannelDataMessage=t.ChannelWindowAdjustMessage=t.ChannelOpenFailureMessage=t.SshChannelOpenFailureReason=t.ChannelOpenConfirmationMessage=t.ChannelOpenMessage=t.ConnectionMessage=void 0;const i=n(100),s=n(36);class r extends i.SshMessage{}t.ConnectionMessage=r;class o extends r{get messageType(){return 90}onRead(e){this.channelType=e.readString("ascii"),this.senderChannel=e.readUInt32(),this.initialWindowSize=e.readUInt32(),this.maximumPacketSize=e.readUInt32()}onWrite(e){e.writeString(this.validateField(this.channelType,"channel type"),"ascii"),e.writeUInt32(this.validateField(this.senderChannel,"sender channel")),e.writeUInt32(this.initialWindowSize||o.defaultInitialWindowSize),e.writeUInt32(this.maximumPacketSize||o.defaultMaximumPacketSize)}}t.ChannelOpenMessage=o,o.defaultInitialWindowSize=1048576,o.defaultMaximumPacketSize=16384;class a extends r{get messageType(){return 91}onRead(e){this.recipientChannel=e.readUInt32(),this.senderChannel=e.readUInt32(),this.initialWindowSize=e.readUInt32(),this.maximumPacketSize=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel")),e.writeUInt32(this.validateField(this.senderChannel,"sender channel")),e.writeUInt32(this.validateField(this.initialWindowSize,"initial window size")),e.writeUInt32(this.validateField(this.maximumPacketSize,"max packet size"))}toString(){return`${super.toString()} (recipientChannel=${this.recipientChannel} senderChannel=${this.senderChannel})`}}var c,l;t.ChannelOpenConfirmationMessage=a,function(e){e[e.none=0]="none",e[e.administrativelyProhibited=1]="administrativelyProhibited",e[e.connectFailed=2]="connectFailed",e[e.unknownChannelType=3]="unknownChannelType",e[e.resourceShortage=4]="resourceShortage"}(c=t.SshChannelOpenFailureReason||(t.SshChannelOpenFailureReason={}));class u extends r{get messageType(){return 92}onRead(e){this.recipientChannel=e.readUInt32(),this.reasonCode=e.readUInt32(),this.description=e.readString("utf8"),this.language=e.readString("ascii")}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel")),e.writeUInt32(this.validateField(this.reasonCode,"reason code")),e.writeString(this.description||"","utf8"),e.writeString(this.language||"en","ascii")}toString(){return`${super.toString} (${c[this.reasonCode||0]}: ${this.description})`}}t.ChannelOpenFailureMessage=u;class d extends r{get messageType(){return 93}onRead(e){this.recipientChannel=e.readUInt32(),this.bytesToAdd=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel")),e.writeUInt32(this.validateField(this.bytesToAdd,"bytes to add"))}}t.ChannelWindowAdjustMessage=d;class h extends r{get messageType(){return 94}onRead(e){this.recipientChannel=e.readUInt32(),this.data=e.readBinary()}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel")),e.writeBinary(this.validateField(this.data,"data"))}toString(){return this.data?(0,s.formatBuffer)(this.data,""):"[0]"}}t.ChannelDataMessage=h;class f extends r{get messageType(){return 96}onRead(e){this.recipientChannel=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel"))}}t.ChannelEofMessage=f;class p extends r{get messageType(){return 97}onRead(e){this.recipientChannel=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel"))}}t.ChannelCloseMessage=p,function(e){e.command="exec",e.shell="shell",e.terminal="pty-req",e.signal="signal",e.exitSignal="exit-signal",e.exitStatus="exit-status"}(l=t.ChannelRequestType||(t.ChannelRequestType={}));class m extends r{constructor(e,t){super(),this.requestType=e,this.wantReply=null!=t&&t}get messageType(){return 98}onRead(e){this.recipientChannel=e.readUInt32(),this.requestType=e.readString("ascii"),this.wantReply=e.readBoolean()}onWrite(e){e.writeUInt32(this.recipientChannel||0),e.writeString(this.validateField(this.requestType,"request type"),"ascii"),e.writeBoolean(this.wantReply)}}t.ChannelRequestMessage=m;t.CommandRequestMessage=class extends m{constructor(){super(),this.requestType=l.command}onRead(e){super.onRead(e),this.command=e.readString("utf8")}onWrite(e){super.onWrite(e),e.writeString(this.validateField(this.command,"command"),"utf8")}toString(){return`${super.toString()} (requestType=${this.requestType})`}};t.ChannelSignalMessage=class extends m{constructor(){super()}get signal(){return this.signalValue}set signal(e){this.requestType=l.signal,this.signalValue=e}get exitSignal(){return this.signalValue}set exitSignal(e){this.requestType=l.exitSignal,this.signalValue=e}get errorMessage(){return this.errorMessageValue}set errorMessage(e){if(this.requestType!==l.exitSignal)throw new Error(`Error message property is only valid for ${l.exitSignal} messages.`);this.errorMessageValue=e}get exitStatus(){return this.statusValue}set exitStatus(e){this.requestType=l.exitStatus,this.statusValue=e}onRead(e){switch(super.onRead(e),this.requestType){case l.exitStatus:this.exitStatus=e.readUInt32();break;case l.signal:this.signal=e.readString("ascii");break;case l.exitSignal:this.exitSignal=e.readString("ascii"),e.readBoolean(),this.errorMessage=e.readString("utf8"),e.readString("ascii")}}onWrite(e){if(!this.requestType)throw new Error("Signal message request type not set.");switch(this.wantReply=!1,super.onWrite(e),this.requestType){case l.exitStatus:e.writeUInt32(this.validateField(this.exitStatus,"exit status"));break;case l.signal:e.writeString(this.validateField(this.signal,"signal"),"ascii");break;case l.exitSignal:e.writeString(this.validateField(this.exitSignal,"exit signal"),"ascii"),e.writeBoolean(!1),e.writeString(this.errorMessage||"","utf8"),e.writeString("","ascii");break;default:throw new Error(`Unknown signal message request type: ${this.requestType}`)}}};class g extends r{get messageType(){return 99}onRead(e){this.recipientChannel=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel"))}}t.ChannelSuccessMessage=g;class y extends r{get messageType(){return 100}onRead(e){this.recipientChannel=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel"))}}t.ChannelFailureMessage=y,i.SshMessage.index.set(90,o),i.SshMessage.index.set(91,a),i.SshMessage.index.set(92,u),i.SshMessage.index.set(93,d),i.SshMessage.index.set(94,h),i.SshMessage.index.set(96,f),i.SshMessage.index.set(97,p),i.SshMessage.index.set(98,m),i.SshMessage.index.set(99,g),i.SshMessage.index.set(100,y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseCompletionSource=void 0;t.PromiseCompletionSource=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}resolve(e){}reject(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withCancellation=t.CancellationError=t.CancellationTokenSource=t.CancellationToken=void 0;const i=n(8);Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return i.CancellationToken}}),Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return i.CancellationTokenSource}});class s extends Error{constructor(e){super(e||"Operation cancelled.")}}t.CancellationError=s,t.withCancellation=function(e,t){return t?Promise.race([e,new Promise((e,n)=>{t.isCancellationRequested?n(new s):t.onCancellationRequested(()=>{n(new s)})})]):e}},function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1059);t.ConnectedState=s.ConnectedState,i(n(1060)),i(n(1061));var r=n(1062);t.WorkspaceApi=r.WorkspaceApi,i(n(1063)),i(n(1064)),i(n(1065)),i(n(1066)),i(n(455)),i(n(456));var o=n(1067);t.WorkspaceClientBase=o.WorkspaceClientBase},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelFailureMessage=t.ChannelSuccessMessage=t.ChannelSignalMessage=t.CommandRequestMessage=t.ChannelRequestMessage=t.ChannelRequestType=t.ChannelCloseMessage=t.ChannelEofMessage=t.ChannelDataMessage=t.ChannelWindowAdjustMessage=t.ChannelOpenFailureMessage=t.SshChannelOpenFailureReason=t.ChannelOpenConfirmationMessage=t.ChannelOpenMessage=t.ConnectionMessage=void 0;const i=n(105),s=n(37);class r extends i.SshMessage{}t.ConnectionMessage=r;class o extends r{get messageType(){return 90}onRead(e){this.channelType=e.readString("ascii"),this.senderChannel=e.readUInt32(),this.initialWindowSize=e.readUInt32(),this.maximumPacketSize=e.readUInt32()}onWrite(e){e.writeString(this.validateField(this.channelType,"channel type"),"ascii"),e.writeUInt32(this.validateField(this.senderChannel,"sender channel")),e.writeUInt32(this.initialWindowSize||o.defaultInitialWindowSize),e.writeUInt32(this.maximumPacketSize||o.defaultMaximumPacketSize)}}t.ChannelOpenMessage=o,o.defaultInitialWindowSize=1048576,o.defaultMaximumPacketSize=16384;class a extends r{get messageType(){return 91}onRead(e){this.recipientChannel=e.readUInt32(),this.senderChannel=e.readUInt32(),this.initialWindowSize=e.readUInt32(),this.maximumPacketSize=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel")),e.writeUInt32(this.validateField(this.senderChannel,"sender channel")),e.writeUInt32(this.validateField(this.initialWindowSize,"initial window size")),e.writeUInt32(this.validateField(this.maximumPacketSize,"max packet size"))}toString(){return`${super.toString()} (recipientChannel=${this.recipientChannel} senderChannel=${this.senderChannel})`}}var c,l;t.ChannelOpenConfirmationMessage=a,function(e){e[e.none=0]="none",e[e.administrativelyProhibited=1]="administrativelyProhibited",e[e.connectFailed=2]="connectFailed",e[e.unknownChannelType=3]="unknownChannelType",e[e.resourceShortage=4]="resourceShortage"}(c=t.SshChannelOpenFailureReason||(t.SshChannelOpenFailureReason={}));class u extends r{get messageType(){return 92}onRead(e){this.recipientChannel=e.readUInt32(),this.reasonCode=e.readUInt32(),this.description=e.readString("utf8"),this.language=e.readString("ascii")}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel")),e.writeUInt32(this.validateField(this.reasonCode,"reason code")),e.writeString(this.description||"","utf8"),e.writeString(this.language||"en","ascii")}toString(){return`${super.toString} (${c[this.reasonCode||0]}: ${this.description})`}}t.ChannelOpenFailureMessage=u;class d extends r{get messageType(){return 93}onRead(e){this.recipientChannel=e.readUInt32(),this.bytesToAdd=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel")),e.writeUInt32(this.validateField(this.bytesToAdd,"bytes to add"))}}t.ChannelWindowAdjustMessage=d;class h extends r{get messageType(){return 94}onRead(e){this.recipientChannel=e.readUInt32(),this.data=e.readBinary()}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel")),e.writeBinary(this.validateField(this.data,"data"))}toString(){return this.data?(0,s.formatBuffer)(this.data,""):"[0]"}}t.ChannelDataMessage=h;class f extends r{get messageType(){return 96}onRead(e){this.recipientChannel=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel"))}}t.ChannelEofMessage=f;class p extends r{get messageType(){return 97}onRead(e){this.recipientChannel=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel"))}}t.ChannelCloseMessage=p,function(e){e.command="exec",e.shell="shell",e.terminal="pty-req",e.signal="signal",e.exitSignal="exit-signal",e.exitStatus="exit-status"}(l=t.ChannelRequestType||(t.ChannelRequestType={}));class m extends r{constructor(e,t){super(),this.requestType=e,this.wantReply=null!=t&&t}get messageType(){return 98}onRead(e){this.recipientChannel=e.readUInt32(),this.requestType=e.readString("ascii"),this.wantReply=e.readBoolean()}onWrite(e){e.writeUInt32(this.recipientChannel||0),e.writeString(this.validateField(this.requestType,"request type"),"ascii"),e.writeBoolean(this.wantReply)}}t.ChannelRequestMessage=m;t.CommandRequestMessage=class extends m{constructor(){super(),this.requestType=l.command}onRead(e){super.onRead(e),this.command=e.readString("utf8")}onWrite(e){super.onWrite(e),e.writeString(this.validateField(this.command,"command"),"utf8")}toString(){return`${super.toString()} (requestType=${this.requestType})`}};t.ChannelSignalMessage=class extends m{constructor(){super()}get signal(){return this.signalValue}set signal(e){this.requestType=l.signal,this.signalValue=e}get exitSignal(){return this.signalValue}set exitSignal(e){this.requestType=l.exitSignal,this.signalValue=e}get errorMessage(){return this.errorMessageValue}set errorMessage(e){if(this.requestType!==l.exitSignal)throw new Error(`Error message property is only valid for ${l.exitSignal} messages.`);this.errorMessageValue=e}get exitStatus(){return this.statusValue}set exitStatus(e){this.requestType=l.exitStatus,this.statusValue=e}onRead(e){switch(super.onRead(e),this.requestType){case l.exitStatus:this.exitStatus=e.readUInt32();break;case l.signal:this.signal=e.readString("ascii");break;case l.exitSignal:this.exitSignal=e.readString("ascii"),e.readBoolean(),this.errorMessage=e.readString("utf8"),e.readString("ascii")}}onWrite(e){if(!this.requestType)throw new Error("Signal message request type not set.");switch(this.wantReply=!1,super.onWrite(e),this.requestType){case l.exitStatus:e.writeUInt32(this.validateField(this.exitStatus,"exit status"));break;case l.signal:e.writeString(this.validateField(this.signal,"signal"),"ascii");break;case l.exitSignal:e.writeString(this.validateField(this.exitSignal,"exit signal"),"ascii"),e.writeBoolean(!1),e.writeString(this.errorMessage||"","utf8"),e.writeString("","ascii");break;default:throw new Error(`Unknown signal message request type: ${this.requestType}`)}}};class g extends r{get messageType(){return 99}onRead(e){this.recipientChannel=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel"))}}t.ChannelSuccessMessage=g;class y extends r{get messageType(){return 100}onRead(e){this.recipientChannel=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel"))}}t.ChannelFailureMessage=y,i.SshMessage.index.set(90,o),i.SshMessage.index.set(91,a),i.SshMessage.index.set(92,u),i.SshMessage.index.set(93,d),i.SshMessage.index.set(94,h),i.SshMessage.index.set(96,f),i.SshMessage.index.set(97,p),i.SshMessage.index.set(98,m),i.SshMessage.index.set(99,g),i.SshMessage.index.set(100,y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseCompletionSource=void 0;t.PromiseCompletionSource=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}resolve(e){}reject(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withCancellation=t.CancellationError=t.CancellationTokenSource=t.CancellationToken=void 0;const i=n(8);Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return i.CancellationToken}}),Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return i.CancellationTokenSource}});class s extends Error{constructor(e){super(e||"Operation cancelled.")}}t.CancellationError=s,t.withCancellation=function(e,t){return t?Promise.race([e,new Promise((e,n)=>{t.isCancellationRequested?n(new s):t.onCancellationRequested(()=>{n(new s)})})]):e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4);t.AUTH_TOKEN_TENANT_ID="72f988bf-86f1-41af-91ab-2d7cd011db47",t.VSLS_CHAT_WINDOW={id:"vsls-window-id",displayName:i.localize("chat.sessionChatLabel")},function(e){e.startOrJoinCall="liveshare.callingService.startOrJoinCall",e.endCall="liveshare.callingService.endCall",e.muteSelf="liveshare.callingService.muteSelf",e.unmuteSelf="liveshare.callingService.unmuteSelf",e.muteOrUnmute="liveshare.callingService.muteOrUnmute",e.selectMicrophone="liveshare.callingService.selectMicrophone",e.selectSpeaker="liveshare.callingService.selectSpeaker",e.setMicrophone="liveshare.callingService.setDevice.microphone",e.setSpeaker="liveshare.callingService.setDevice.speaker",e.viewParticipants="liveshare.callingService.viewParticipants",e.callSettings="liveshare.callingService.callSettings"}(t.CallingServiceCommands||(t.CallingServiceCommands={})),t.MESSAGE_SERVICE_NAME="ms-vsliveshare.vsliveshare-audio.MessagingService",t.MESSAGE_SERVICE_NOTIFICATION_EVENT_NAME="notification",function(e){e[e.CallStarted=1]="CallStarted",e[e.CallInformationRequest=2]="CallInformationRequest"}(t.CallingEventType||(t.CallingEventType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1252);t.default=i.default},function(e,t,n){"use strict";var i=n(14).Buffer,s=n(58),r=n(186),o=n(1233),a=n(1234),c=n(1235);e.exports=function(e){var t=[],n=[];return{encode:c(t,(e=e||{forceFloat64:!1,compatibilityMode:!1,disableTimestampEncoding:!1,protoAction:"error"}).forceFloat64,e.compatibilityMode,e.disableTimestampEncoding),decode:a(n,e),register:function(e,t,n,o){return s(t,"must have a constructor"),s(n,"must have an encode function"),s(e>=0,"must have a non-negative type"),s(o,"must have a decode function"),this.registerEncoder((function(e){return e instanceof t}),(function(t){var s=r(),o=i.allocUnsafe(1);return o.writeInt8(e,0),s.append(o),s.append(n(t)),s})),this.registerDecoder(e,o),this},registerEncoder:function(e,n){return s(e,"must have an encode function"),s(n,"must have an encode function"),t.push({check:e,encode:n}),this},registerDecoder:function(e,t){return s(e>=0,"must have a non-negative type"),s(t,"must have a decode function"),n.push({type:e,decode:t}),this},encoder:o.encoder,decoder:o.decoder,buffer:!0,type:"msgpack5",IncompleteBufferError:a.IncompleteBufferError}}},function(e,t,n){var i=n(14).Buffer;function s(e,t){this._block=i.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}s.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=i.from(e,t));for(var n=this._block,s=this._blockSize,r=e.length,o=this._len,a=0;a<r;){for(var c=o%s,l=Math.min(r-a,s-c),u=0;u<l;u++)n[c+u]=e[a+u];a+=l,(o+=l)%s==0&&this._update(n)}return this._len+=r,this},s.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var n=8*this._len;if(n<=4294967295)this._block.writeUInt32BE(n,this._blockSize-4);else{var i=(4294967295&n)>>>0,s=(n-i)/4294967296;this._block.writeUInt32BE(s,this._blockSize-8),this._block.writeUInt32BE(i,this._blockSize-4)}this._update(this._block);var r=this._hash();return e?r.toString(e):r},s.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e.exports=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e,t){super("string"==typeof e?e:null==e?void 0:e.message),this.errorCode=t,this.errorType="BaseError",e instanceof Error&&(this.originalError=e,this.stack=e.stack,this.originalErrorType=this.getOriginalErrorCode(e),this.errorCode=null!=t?t:e.errorCode)}getOriginalErrorCode(e){const{errorType:t="<no-type>",errorCode:n="<no-code>"}=e;return`[${t}:${n}]`}}t.BaseError=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(9);class s extends Error{constructor(e={}){super(e.message),this.isSuppressUserNotification=!1,this.code=e.code,this.userMessage=e.userMessage,this.telemetryResult=e.telemetryResult||i.TelemetryResult.Failure}withUserMessage(e){return this.userMessage=e,this}withSuppressUserNotification(e){return this.isSuppressUserNotification=e,this}}t.CommandError=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(19),s=n(9),r=n(68),o=n(16);class a{static init(){s.Telemetry.addFilter(new s.SendOnceFilter(d.ASSERTION_FAILED,[o.TelemetryPropertyNames.EVENT_MESSAGE])),s.Telemetry.addFilter(new s.SendOnceFilter(d.COEDITING_ERROR,[o.TelemetryPropertyNames.EVENT_MESSAGE])),s.Telemetry.addFilter(new s.SendOnceFilter(d.DESYNC)),s.Telemetry.addFilter(new s.SendOnceFilter(d.SYNC_CHECK)),s.Telemetry.addFilter(new s.SendOnceFilter(d.SYNC_CHECK_LOCAL)),s.Telemetry.addFilter(new s.SendOnceFilter(d.SYNC_CHECK_FOR_VERSION)),s.Telemetry.addFilter(new s.SendOnceFilter(d.SLOW_SYNC_CHECK)),s.Telemetry.addFilter(new s.SendOnceFilter(d.DROPPED_MESSAGE,[h.ID_TYPE,h.WITH_DELAY])),s.Telemetry.addFilter(new s.SendOnceFilter("block-coeditattempt",["liveshare.BlockReason"])),s.Telemetry.addFilter(new s.SendOnceFilter(o.TelemetryEventNames.ADD_EXTERNAL_FILE)),s.Telemetry.addFilter(new s.SendOnceFilter(d.SLOW_PING)),this.coeditingLogs=new i.MemoryTraceListener(50)}static ReportMetrics(e){let t=new s.TelemetryEvent(d.REPORT_METRICS);for(let n of e)n.AttachToEvent(t);t.send()}static get logListener(){return a.coeditingLogs}static getLogs(){return this.coeditingLogs.getLogs().reverse().join("\n")}static addLogs(e){let t=this.getLogs();t=t.replace(/[\\|\/]/gi,"-"),e.addProperty(h.LOGS,t)}static BufferClosed(e,t,n,i,r,o,a,c,l,u,f,p,m){const g=new s.TelemetryEvent(d.BUFFER_CLOSED);g.addProperty(h.CONTENT_TYPE,e),g.addMeasure(h.NUMBER_OF_LOCAL_EDITS,t),g.addMeasure(h.NUMBER_OF_REMOTE_EDITS,n),g.addProperty(h.NUMBER_OF_HIGH_DENSITY_EDITS,JSON.stringify(i)),g.addMeasure(h.NUMBER_OF_LOCAL_UNDOS,r),g.addMeasure(h.NUMBER_OF_REMOTE_UNDOS,o),g.addMeasure(h.NUMBER_OF_SIMULTANEOUS_EDITS,l),g.addMeasure(h.LINE_DIFF_COUNT,u),g.addMeasure(h.LINE_DIFF_SUM,f),g.addMeasure(h.NUMBER_OF_VISIBLE_EDITS,p),g.addMeasure(h.NUMBER_OF_INVISIBLE_EDITS,m),g.send()}static AddSessionClosedEventAugmenter(e){this.sessionClosedEventAugmenters.push(e)}static SessionClosed(e,t,n,i,r,o,a,c,l,u){const f=new s.TelemetryEvent(d.SESSION_CLOSED);this.sessionClosedEventAugmenters.forEach(e=>e(f)),this.sessionClosedEventAugmenters=[],f.addMeasure(h.NUMBER_OF_JUMP_TOS,e),f.addMeasure(h.NUMBER_OF_FAILED_JUMP_TOS,t),f.addMeasure(h.NUMBER_OF_PINS,n),f.addMeasure(h.NUMBER_OF_EXPLICIT_UNPINS,i),f.addMeasure(h.NUMBER_OF_AUTOMATIC_UNPINS,r),f.addMeasure(h.NUMBER_OF_SYNC_CHECKS,o),f.addMeasure(h.NUMBER_OF_FAILED_SYNC_CHECKS,a),f.addMeasure(h.NUMBER_OF_SLOW_SYNC_CHECKS,c),f.addMeasure(h.NUMBER_OF_OPEN_DIFFS,l),f.addMeasure(h.NUMBER_OF_CLOSED_DIFFS,u),f.send()}static ReportNonFunctionalNavigation(e){const t=new s.TelemetryEvent(d.NON_FUNCTIONAL_NAVIGATION);t.addProperty(h.NON_FUNCTIONAL_NAVIGATION,l[e]),t.send()}static ReportDesync(e,t,n,i=!1){const r=new s.TelemetryEvent(d.DESYNC);r.addProperty(h.DESYNC_REASON,u[e]),r.addProperty(h.FILE_EXTENSION,t),r.addProperty(h.MONIKER,n),r.addProperty(h.DESYNC_RECOVERY,i),this.addLogs(r),r.send()}static ReportDesyncReload(){new s.TelemetryEvent(d.DESYNC_RELOAD).send()}static ReportFuzzyDesync(e,t,n){const i=new s.TelemetryEvent(d.FUZZY_DESYNC);i.addProperty(h.FILE_EXTENSION,e),i.addProperty(h.MONIKER,t),i.addProperty(h.AUTO_SAVE,n),this.addLogs(i),i.send()}static ReportFalseDesync(){new s.TelemetryEvent(d.FALSE_DESYNC).send()}static ReportSyncCheck(){new s.TelemetryEvent(d.SYNC_CHECK).send()}static ReportLocalSyncCheck(){new s.TelemetryEvent(d.SYNC_CHECK_LOCAL).send()}static ReportSyncCheckForVersion(e){const t=new s.TelemetryEvent(d.SYNC_CHECK_FOR_VERSION);t.addProperty(h.SENDING_SYNC_CHECK,e),t.send()}static ReportSlowSyncCheck(){new s.TelemetryEvent(d.SLOW_SYNC_CHECK).send()}static ReportFailedAssertion(e,t){const n=new s.Fault(d.ASSERTION_FAILED,s.FaultType.Error,e,new Error("Assertion Failed"));if(t){const e=t.split("."),i=e.length>1?e.pop():"NA",s=r.PathUtil.getMonikerFromRelativePath(t).moniker||"None";n.addProperty(h.FILE_EXTENSION,i),n.addProperty(h.MONIKER,s)}this.addLogs(n),n.send()}static ReportCoeditingError(e,t){new s.Fault(d.COEDITING_ERROR,s.FaultType.Error,e,t).send()}static ReportDroppedMessage(e,t,n,i){const r=new s.TelemetryEvent(d.DROPPED_MESSAGE);r.addMeasure(h.EXPECTED_ID,e),r.addMeasure(h.ACTUAL_ID,t),r.addProperty(h.ID_TYPE,n),r.addProperty(h.WITH_DELAY,i),r.send()}static ReportCaseSensitiveFileSystem(){new s.TelemetryEvent(d.REPORT_CASE_SENSITIVE_FILE_SYSTEM).send()}}t.CoauthoringTelemetry=a,a.FEATURE_PREFIX="Coauthoring/",a.PROPERTY_PREFIX=o.TelemetryPropertyNames.FEATURE_NAME+"Coauthoring.",a.sessionClosedEventAugmenters=[];t.TimeTelemetry=class{constructor(e,t){this.total=0,this.canceled=0,this.failed=0,this.buckets=[new c(25),new c(50),new c(100),new c(250),new c(500),new c(1e3),new c(2e3),new c(Math.max())],this.name=e,a.AddSessionClosedEventAugmenter(e=>{t&&t(),this.AttachToEvent(e)})}RecordTime(e){this.total++;for(let t=0;t<this.buckets.length;t++)if(this.buckets[t].max>=e)return void this.buckets[t].count++}AttachToEvent(e){this.buckets.forEach(t=>{e.addMeasure(`${a.PROPERTY_PREFIX}${this.name}.${t.name}`,t.count)}),e.addMeasure(`${a.PROPERTY_PREFIX}${this.name}.count`,this.total),e.addMeasure(`${a.PROPERTY_PREFIX}${this.name}.canceled`,this.canceled),e.addMeasure(`${a.PROPERTY_PREFIX}${this.name}.failed`,this.failed)}RecordCancel(){this.canceled++,this.total++}RecordFailed(){this.failed++,this.total++}};class c{constructor(e){this.max=0,this.count=0,this.max=e,this.name="bucket."+(this.max===Math.max()?"max":this.max.toString())}}var l,u;t.Bucket=c,function(e){e[e.FindInFiles=0]="FindInFiles"}(l=t.NonFunctionalNavigation||(t.NonFunctionalNavigation={})),function(e){e[e.Unknown=0]="Unknown",e[e.MessagesOutOfOrder=1]="MessagesOutOfOrder"}(u=t.DesyncReason||(t.DesyncReason={}));class d{}t.Event=d,d.NON_FUNCTIONAL_NAVIGATION=a.FEATURE_PREFIX+"navigate-nonfunctional",d.BUFFER_CLOSED=a.FEATURE_PREFIX+"close-buffer",d.SESSION_CLOSED=a.FEATURE_PREFIX+"close-session",d.REPORT_METRICS=a.FEATURE_PREFIX+"report-timingmetrics",d.DESYNC=a.FEATURE_PREFIX+"desync-coediting",d.DESYNC_RELOAD=a.FEATURE_PREFIX+"desync-reload",d.FUZZY_DESYNC=a.FEATURE_PREFIX+"desync-fuzzy",d.FALSE_DESYNC=a.FEATURE_PREFIX+"desync-falsealarm",d.SYNC_CHECK=a.FEATURE_PREFIX+"sync-check",d.SYNC_CHECK_LOCAL=a.FEATURE_PREFIX+"sync-checklocal",d.SYNC_CHECK_FOR_VERSION=a.FEATURE_PREFIX+"sync-checkforversion",d.SLOW_SYNC_CHECK=a.FEATURE_PREFIX+"sync-checkslow",d.COEDITING_ERROR=a.FEATURE_PREFIX+"coedit-processing-error",d.DROPPED_MESSAGE=a.FEATURE_PREFIX+"drop-message",d.DROPPED_HOST_MESSAGE_FAULT=o.TelemetryEventNames.FAULT_PREFIX+"drop-hostmessage-fault",d.ASSERTION_FAILED=o.TelemetryEventNames.FAULT_PREFIX+"assert-coediting-fault",d.ADD_UNTITLED_FILE=a.FEATURE_PREFIX+"add-untitledfile",d.RECEIVE_UNTITLED_FILE=a.FEATURE_PREFIX+"receive-untitledfile",d.CLOSE_UNTITLED_FILE=a.FEATURE_PREFIX+"close-untitledfile",d.SAVE_UNTITLED_FILE=a.FEATURE_PREFIX+"save-untitledfile",d.REPORT_CASE_SENSITIVE_FILE_SYSTEM=a.FEATURE_PREFIX+"report-casesensitivefilesystem",d.SLOW_PING="ping-slow",d.RESYNC_DOCUMENT="resync-document";class h{}h.CONTENT_TYPE=a.PROPERTY_PREFIX+"ContentType",h.NUMBER_OF_LOCAL_EDITS=a.PROPERTY_PREFIX+"NumberOfLocalEdits",h.NUMBER_OF_REMOTE_EDITS=a.PROPERTY_PREFIX+"NumberOfRemoteEdits",h.NUMBER_OF_HIGH_DENSITY_EDITS=a.PROPERTY_PREFIX+"NumberOfHighDensityEdits",h.NUMBER_OF_LOCAL_UNDOS=a.PROPERTY_PREFIX+"NumberOfLocalUndos",h.NUMBER_OF_REMOTE_UNDOS=a.PROPERTY_PREFIX+"NumberOfRemoteUndos",h.NUMBER_OF_HIGHLIGHTS=a.PROPERTY_PREFIX+"NumberOfHighlights",h.AVERAGE_LATENCY=a.PROPERTY_PREFIX+"AverageLatency",h.NUMBER_OF_JUMP_TOS=a.PROPERTY_PREFIX+"NumberOfJumpTos",h.NUMBER_OF_FAILED_JUMP_TOS=a.PROPERTY_PREFIX+"NumberOfFailedJumpTos",h.NUMBER_OF_PINS=a.PROPERTY_PREFIX+"NumberOfPins",h.NUMBER_OF_EXPLICIT_UNPINS=a.PROPERTY_PREFIX+"NumberOfExplicitUnpins",h.NUMBER_OF_AUTOMATIC_UNPINS=a.PROPERTY_PREFIX+"NumberOfAutomaticUnpins",h.NUMBER_OF_SYNC_CHECKS=a.PROPERTY_PREFIX+"NumberOfSyncChecks",h.SENDING_SYNC_CHECK=a.PROPERTY_PREFIX+"SendingSyncCheck",h.NUMBER_OF_FAILED_SYNC_CHECKS=a.PROPERTY_PREFIX+"NumberOfFailedSyncChecks",h.NUMBER_OF_SLOW_SYNC_CHECKS=a.PROPERTY_PREFIX+"NumberOfSlowSyncChecks",h.NON_FUNCTIONAL_NAVIGATION=a.PROPERTY_PREFIX+"NonFunctionalNavigation",h.DESYNC_REASON=a.PROPERTY_PREFIX+"DesyncReason",h.FILE_EXTENSION=a.PROPERTY_PREFIX+"FileExtension",h.MONIKER=a.PROPERTY_PREFIX+"Moniker",h.AUTO_SAVE=a.PROPERTY_PREFIX+"AutoSave",h.NUMBER_OF_SIMULTANEOUS_EDITS=a.PROPERTY_PREFIX+"NumSimultaneousEdits",h.LINE_DIFF_SUM=a.PROPERTY_PREFIX+"LineDiffSum",h.LINE_DIFF_COUNT=a.PROPERTY_PREFIX+"LineDiffCount",h.NUMBER_OF_VISIBLE_EDITS=a.PROPERTY_PREFIX+"NumVisibleEdits",h.NUMBER_OF_INVISIBLE_EDITS=a.PROPERTY_PREFIX+"NumInvisibleEdits",h.DESYNC_RECOVERY=a.PROPERTY_PREFIX+"DesyncRecovery",h.NUMBER_OF_OPEN_DIFFS=a.PROPERTY_PREFIX+"NumOpenDiff",h.NUMBER_OF_CLOSED_DIFFS=a.PROPERTY_PREFIX+"NumClosedDiff",h.ID_TYPE=a.PROPERTY_PREFIX+"IdType",h.EXPECTED_ID=a.PROPERTY_PREFIX+"ExpectedEventId",h.ACTUAL_ID=a.PROPERTY_PREFIX+"ActualEventId",h.WITH_DELAY=a.PROPERTY_PREFIX+"WithDelay",h.LOGS=a.PROPERTY_PREFIX+"Logs"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(6),r=n(22),o=n(954),a=n(23),c=n(29),l=n(31),u=n(963),d=n(169),h=n(964),f=n(21),p=n(13),m=n(15),g=n(9),y=n(16);class v{constructor(){this.guestCountByIDE={},this.distinctGuestCountByIDE={},this.collaboratorChangedEmitter=new i.EventEmitter,this.onCollaboratorChanged=this.collaboratorChangedEmitter.event,this.hasCollaboratorsChangedEmitter=new i.EventEmitter,this.onHasCollaboratorsChanged=this.hasCollaboratorsChangedEmitter.event,this.accessControlChangedEmitter=new i.EventEmitter,this.onAccessControlChanged=this.accessControlChangedEmitter.event,this.collaboratorsJoinedEmitter=new i.EventEmitter,this.onCollaboratorsJoined=this.collaboratorsJoinedEmitter.event,this.coeditingClientChangedEmitter=new i.EventEmitter,this.onCoeditingClientChanged=this.coeditingClientChangedEmitter.event,a.sessionStateTracker.onStateChanged(this.onSessionStateChanged.bind(this)),this.sessionPromiseMap=new Map([[f.SessionPromise.EnvironmentReadyForFileOperation,new s.Signal],[f.SessionPromise.JoiningCompleted,new s.Signal]]),c.workspaceSessionInfoTracker.onReadOnlyChanged(e=>{r.ExtensionUtil.setCommandContext("liveshare:isReadOnlySession",e)})}get coeditingClient(){return this.coeditingClientInstance}updateTelemetryContext(e){let t=[f.SessionState.Shared,f.SessionState.Joined].indexOf(e.oldState)>=0;if(this.isCollaborating){if(c.workspaceSessionInfoTracker.workspaceSessionInfo){let t=e.newState===f.SessionState.Shared;const n=i.workspace.getConfiguration(p.Settings.get(m.SettingKeys.configName));d.SessionTelemetry.startSession(t,n),t&&this.resetTelemetry()}}else t&&(h.CollaboratorsTelemetry.endSession(),d.SessionTelemetry.endSession(this.guestCountByIDE,this.distinctGuestCountByIDE))}onWorkspaceAccessControlChanged(e){this.accessControlChangedEmitter.fire(e)}getLatestPreviousSessionId(e){if(!this.collaboratorManager)return;const{userIdBySessionIdHistory:t}=this.collaboratorManager,n=[];for(let i of Object.keys(t)){const s=parseInt(i,10);e===t[i]&&n.push(s)}return Math.max(...n)}initCoEditingContext(e){if(!c.workspaceSessionInfoTracker.workspaceSessionInfo)throw new Error("Failed to join a collaboration session. The host is offline. Ask them to start the session and rejoin.");let t=g.Telemetry.startTimedEvent(y.TelemetryEventNames.INITIALIZE_COAUTHORING,!0);t.addMeasure(y.TelemetryPropertyNames.NUM_OPEN_FILES,i.window.visibleTextEditors.length),l.userAuthStateTracker.userInfo=e.userInfo,this.collaboratorManager=new u.CollaboratorManager(this,c.workspaceSessionInfoTracker.workspaceSessionInfo.sessions),this.collaboratorManager.onCollaboratorsJoined(()=>this.collaboratorsJoinedEmitter.fire()),this.collaboratorManager.onCollaboratorChanged(e=>{this.collaboratorsChanged(e),h.CollaboratorsTelemetry.sendChangeCollaboratorsEvent(e)});const n=new o.CoEditing({sourceEventService:e.sourceEventService,clientID:c.workspaceSessionInfoTracker.workspaceSessionInfo.sessionNumber,isGuest:e.isGuest,fileService:e.fileSystemService,pathManager:e.pathManager,clientAccessCheck:e.clientAccessCheck,collaboratorManager:this.collaboratorManager,joinCompleted:e.joinCompleted,fileSystemManager:e.fileSystemManager,syncService:e.syncService,presentationMode:c.workspaceSessionInfoTracker.workspaceSessionInfo.isPresentation});return n.init(),this.coeditingClientInstance=n,this.coeditingClientChangedEmitter.fire(n),t.end(g.TelemetryResult.Success),new i.Disposable(()=>n.dispose())}collaboratorsChanged(e){for(let e of this.collaboratorManager.getIDEs())void 0===this.guestCountByIDE[e]&&(this.guestCountByIDE[e]=0),void 0===this.distinctGuestCountByIDE[e]&&(this.distinctGuestCountByIDE[e]=0),this.guestCountByIDE[e]=Math.max(this.guestCountByIDE[e],this.collaboratorManager.getCollaboratorCountByIDE(e)),this.distinctGuestCountByIDE[e]=Math.max(this.distinctGuestCountByIDE[e],this.collaboratorManager.getDistinctCollaboratorCountByIDE(e));this.collaboratorChangedEmitter.fire(e)}disposeCoEditingContext(){c.workspaceSessionInfoTracker.workspaceSessionInfo=null,this.collaboratorManager&&(this.collaboratorManager.dispose(),this.collaboratorManager=null),this.coeditingClientInstance&&(this.coeditingClientInstance.dispose(),this.coeditingClientInstance=null,this.coeditingClientChangedEmitter.fire(null))}get hasServersShared(){return this.serversShared}set hasServersShared(e){this.serversShared=e,r.ExtensionUtil.setCommandContext("liveshare:isServerShared",e)}get hasSharedTerminals(){return this.hasSharedTerminalsFlag}set hasSharedTerminals(e){this.hasSharedTerminalsFlag=e,r.ExtensionUtil.setCommandContext("liveshare:hasSharedTerminals",e)}get isPlannedSessionsReady(){return this.isPlannedSessionsReadyFlag}set isPlannedSessionsReady(e){this.isPlannedSessionsReadyFlag=e,r.ExtensionUtil.setCommandContext("liveshare:isPlannedSessionsReady",e)}get isCollaborating(){return[f.SessionState.Shared,f.SessionState.Joined].indexOf(a.sessionStateTracker.State)>=0}get isStartingCollaboration(){return[f.SessionState.JoiningInProgress,f.SessionState.SharingInProgress].indexOf(a.sessionStateTracker.State)>=0}onSessionStateChanged(e){this.isCollaborating&&p.Settings.save(m.SettingKeys.hasUsed,!0),this.updateTelemetryContext(e);const{newState:t}=e;r.ExtensionUtil.setCommandContext("liveshare:state",f.SessionState[t]),r.ExtensionUtil.setCommandContext("liveshare:isCollaborating",t===f.SessionState.Shared||t===f.SessionState.Joined),t!==f.SessionState.Joined&&t!==f.SessionState.Shared&&(this.disposeCoEditingContext(),this.hasServersShared=!1,this.hasSharedTerminals=!1,c.workspaceSessionInfoTracker.isReadOnly=!1)}get hasCollaborators(){return this.hasCollaborators_}set hasCollaborators(e){e!==this.hasCollaborators_&&(this.hasCollaborators_=e,r.ExtensionUtil.setCommandContext("liveshare:hasCollaborators",e),this.hasCollaboratorsChangedEmitter.fire(e))}waitForSessionPromise(e){return this.sessionPromiseMap.get(e).promise}joined(){this.sessionPromiseMap.get(f.SessionPromise.EnvironmentReadyForFileOperation).isFulfilled||this.environmentReadyForFileOperation(),a.sessionStateTracker.transition(f.SessionAction.JoiningSuccess),this.sessionPromiseMap.get(f.SessionPromise.JoiningCompleted).resolve()}environmentReadyForFileOperation(){this.sessionPromiseMap.get(f.SessionPromise.EnvironmentReadyForFileOperation).resolve()}notJoining(){this.sessionPromiseMap.get(f.SessionPromise.JoiningCompleted).resolve(null)}static get Instance(){return v.singleton||(v.singleton=new v),v.singleton}resetTelemetry(){h.CollaboratorsTelemetry.resetActiveEvent(!1),h.CollaboratorsTelemetry.listenerAdded||(h.CollaboratorsTelemetry.listenerAdded=!0,this.onHasCollaboratorsChanged(e=>{h.CollaboratorsTelemetry.activeEvent.end(g.TelemetryResult.Success),h.CollaboratorsTelemetry.resetActiveEvent(e)}))}dispose(){this.isCollaborating&&d.SessionTelemetry.endSession(this.guestCountByIDE,this.distinctGuestCountByIDE)}}t.SessionContextClass=v;const S=v.Instance;t.SessionContext=S},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(962),r=i.env.clipboard,o=void 0!==r;t.ClipboardUtil=class{async pasteFromClipboardAsync(){try{return o?await r.readText():await s.clipboard.readAsync()}catch(e){return""}}async copyToClipboardAsync(e){try{return o?await r.writeText(e):await s.clipboard.writeAsync(e),!0}catch(e){return!1}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(971),r=n(9);t.getKeytar=()=>function(e){const t=require;try{return t(`${i.env.appRoot}/node_modules.asar/${e}`)}catch(e){}try{return t(`${i.env.appRoot}/node_modules/${e}`)}catch(e){}}("keytar");class o{async init(e,n,i=[],o){this.authAPI=await s.activateInternal(e,n,r.Telemetry,[...i],o||t.getKeytar())}get API(){if(!this.authAPI)throw new Error("The auth API wasn't yet initialized. Please call the `init` function first");return this.authAPI}}t.Authentication=o,t.auth=new o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(7),r=n(999),o=n(1019);var a;!function(e){e.GitHub="github",e.Microsoft="microsoft"}(a=t.SupportedAuthProviders||(t.SupportedAuthProviders={}));t.NativeAuthProvider=class{constructor(){this.registeredTokenProviders=new Map,this.onSignOutEmitter=new i.EventEmitter,this.onSignOut=this.onSignOutEmitter.event,this.registeredTokenProviders.set(a.GitHub,new r.GitHubAuthTokenProvider),this.registeredTokenProviders.set(a.Microsoft,new o.MicrosoftAuthTokenProvider),this.registeredTokenProviders.forEach(e=>{e.onSignOut(this.handleOnDidSignOut.bind(this))})}async getCachedTokenOrLogin(e,t){let n=await this.getCachedToken(e);if(n)return n;let i=this.registeredTokenProviders.get(e);return i?await i.signIn(t)?await i.getAccessToken():(s.traceSource.verbose(`Attempt to login with ${e} failed`),null):(s.traceSource.verbose(`Attempting to log in with not supported auth provider - ${e}`),null)}async getCachedToken(e){let t=this.registeredTokenProviders.get(e);return t?await t.getAccessToken():(s.traceSource.verbose(`Attempting to get a cached auth token from not supported auth provider - ${e}`),null)}resetAccessTokenCache(e){let t=this.registeredTokenProviders.get(e);if(!t)return s.traceSource.verbose(`Attempting to reset a cached auth token of unsupported auth provider - ${e}`),null;t.resetCascadeToken()}handleOnDidSignOut(){this.onSignOutEmitter.fire()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.algorithmNames=t.SshAlgorithms=t.Encryption=t.ECDsa=t.Rsa=t.HmacAlgorithm=t.EncryptionAlgorithm=t.PublicKeyAlgorithm=t.KeyExchangeAlgorithm=void 0;const i=n(247);Object.defineProperty(t,"KeyExchangeAlgorithm",{enumerable:!0,get:function(){return i.KeyExchangeAlgorithm}});const s=n(132);Object.defineProperty(t,"PublicKeyAlgorithm",{enumerable:!0,get:function(){return s.PublicKeyAlgorithm}});const r=n(248);Object.defineProperty(t,"EncryptionAlgorithm",{enumerable:!0,get:function(){return r.EncryptionAlgorithm}});const o=n(249);Object.defineProperty(t,"HmacAlgorithm",{enumerable:!0,get:function(){return o.HmacAlgorithm}});const a=!("object"!=typeof crypto||!crypto.subtle),c=n(1e3),l=n(1001),u=n(1002),d=n(1003),h=n(250),f=n(1006),p=a?c.WebDiffieHellman:n(434).NodeDiffieHellman,m=a?c.WebECDiffieHellman:n(434).NodeECDiffieHellman,g=a?l.WebRsa:n(1007).NodeRsa;t.Rsa=g;const y=a?u.WebECDsa:n(1008).NodeECDsa;t.ECDsa=y;const v=a?d.WebEncryption:n(1009).NodeEncryption;t.Encryption=v;const S=a?h.WebHmac:n(253).NodeHmac,_=a?f.WebRandom:n(1010).NodeRandom;class E{}t.SshAlgorithms=E,E.keyExchange={none:null,dhGroup14Sha256:new p("diffie-hellman-group14-sha256",2048,"SHA2-256"),dhGroup16Sha512:new p("diffie-hellman-group16-sha512",4096,"SHA2-512"),ecdhNistp256Sha256:new m("ecdh-sha2-nistp256",256,"SHA2-256"),ecdhNistp384Sha384:new m("ecdh-sha2-nistp384",384,"SHA2-384"),ecdhNistp521Sha512:new m("ecdh-sha2-nistp521",521,"SHA2-512")},E.publicKey={none:null,rsaWithSha256:new g("rsa-sha2-256","SHA2-256"),rsaWithSha512:new g("rsa-sha2-512","SHA2-512"),ecdsaSha2Nistp256:new y("ecdsa-sha2-nistp256","SHA2-256"),ecdsaSha2Nistp384:new y("ecdsa-sha2-nistp384","SHA2-384"),ecdsaSha2Nistp521:new y("ecdsa-sha2-nistp521","SHA2-512")},E.encryption={none:null,aes256Ctr:new v("aes256-ctr","AES","CTR",256),aes256Gcm:new v("aes256-gcm@openssh.com","AES","GCM",256)},E.hmac={none:null,hmacSha256:new S("hmac-sha2-256","SHA2-256"),hmacSha512:new S("hmac-sha2-512","SHA2-512"),hmacSha256Etm:new S("hmac-sha2-256-etm@openssh.com","SHA2-256",!0),hmacSha512Etm:new S("hmac-sha2-512-etm@openssh.com","SHA2-512",!0)},E.compression={none:null},E.random=new _,t.algorithmNames=function(e){return e.map(e=>e?e.name:"none")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findService=t.serviceActivation=void 0,t.serviceActivation=function(e){return t=>{t.activations||(t.activations=[]),t.activations.push(e)}},t.findService=function(e,t){for(let n of e.keys()){const e=n.activations;let i=!1;for(let s of e)if(i=!0,t(s))return n;if(!i)throw new Error(`SSH service type '${n.name}' must have one or more `+"'serviceActivation' decorators.")}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshMessage=void 0;const i=n(3),s=n(36);class r{get messageType(){return 0}toBuffer(){const e=new s.SshDataWriter(i.Buffer.alloc(16));return this.write(e),e.toBuffer()}read(e){this.rawBytes=e.buffer;const t=e.readByte();if(t!==this.messageType)throw new Error(`Message type ${t} is not valid.`);this.onRead(e)}write(e){e.writeByte(this.messageType),this.onWrite(e)}onRead(e){throw new Error("Not supported.")}onWrite(e){throw new Error("Not supported.")}validateField(e,t){if(void 0===e)throw new Error(`${this.constructor.name} ${t} is required.`);return e}toString(){return this.constructor.name}static create(e,t){const n=r.index.get(e);if(n){const e=new n;return e.read(new s.SshDataReader(t)),e}return null}convertTo(e,t=!1){const n=new s.SshDataReader(t?i.Buffer.from(this.rawBytes):this.rawBytes);return e.read(n),e}}t.SshMessage=r,r.index=new Map},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.Sharing=1]="Sharing",e[e.Joined=2]="Joined",e[e.SharedOrJoined=3]="SharedOrJoined",e[e.NotSharedOrJoined=4]="NotSharedOrJoined"}(t.TreeDataProviderContext||(t.TreeDataProviderContext={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(33),s=n(426),r=n(61);t.telemetryCommandDecorator=function(e,t,n,o=1,a){return i.DecoratorHelper.setupDecorator(c=>new s.TelemetryCommandDecorator(i.DecoratorHelper.getCoreCommand(c),c,r.dependencies.workspaceService(),r.dependencies.telemetry(),e,t,n,o,a))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.algorithmNames=t.SshAlgorithms=t.Encryption=t.ECDsa=t.Rsa=t.HmacAlgorithm=t.EncryptionAlgorithm=t.PublicKeyAlgorithm=t.KeyExchangeAlgorithm=void 0;const i=n(274);Object.defineProperty(t,"KeyExchangeAlgorithm",{enumerable:!0,get:function(){return i.KeyExchangeAlgorithm}});const s=n(141);Object.defineProperty(t,"PublicKeyAlgorithm",{enumerable:!0,get:function(){return s.PublicKeyAlgorithm}});const r=n(275);Object.defineProperty(t,"EncryptionAlgorithm",{enumerable:!0,get:function(){return r.EncryptionAlgorithm}});const o=n(276);Object.defineProperty(t,"HmacAlgorithm",{enumerable:!0,get:function(){return o.HmacAlgorithm}});const a=!("object"!=typeof crypto||!crypto.subtle),c=n(1105),l=n(1106),u=n(1107),d=n(1108),h=n(277),f=n(1109),p=a?c.WebDiffieHellman:n(477).NodeDiffieHellman,m=a?c.WebECDiffieHellman:n(477).NodeECDiffieHellman,g=a?l.WebRsa:n(1110).NodeRsa;t.Rsa=g;const y=a?u.WebECDsa:n(1111).NodeECDsa;t.ECDsa=y;const v=a?d.WebEncryption:n(1112).NodeEncryption;t.Encryption=v;const S=a?h.WebHmac:n(279).NodeHmac,_=a?f.WebRandom:n(1113).NodeRandom;class E{}t.SshAlgorithms=E,E.keyExchange={none:null,dhGroup14Sha256:new p("diffie-hellman-group14-sha256",2048,"SHA2-256"),dhGroup16Sha512:new p("diffie-hellman-group16-sha512",4096,"SHA2-512"),ecdhNistp256Sha256:new m("ecdh-sha2-nistp256",256,"SHA2-256"),ecdhNistp384Sha384:new m("ecdh-sha2-nistp384",384,"SHA2-384"),ecdhNistp521Sha512:new m("ecdh-sha2-nistp521",521,"SHA2-512")},E.publicKey={none:null,rsaWithSha256:new g("rsa-sha2-256","SHA2-256"),rsaWithSha512:new g("rsa-sha2-512","SHA2-512"),ecdsaSha2Nistp256:new y("ecdsa-sha2-nistp256","SHA2-256"),ecdsaSha2Nistp384:new y("ecdsa-sha2-nistp384","SHA2-384"),ecdsaSha2Nistp521:new y("ecdsa-sha2-nistp521","SHA2-512")},E.encryption={none:null,aes256Ctr:new v("aes256-ctr","AES","CTR",256),aes256Gcm:new v("aes256-gcm@openssh.com","AES","GCM",256)},E.hmac={none:null,hmacSha256:new S("hmac-sha2-256","SHA2-256"),hmacSha512:new S("hmac-sha2-512","SHA2-512"),hmacSha256Etm:new S("hmac-sha2-256-etm@openssh.com","SHA2-256",!0),hmacSha512Etm:new S("hmac-sha2-512-etm@openssh.com","SHA2-512",!0)},E.compression={none:null},E.random=new _,t.algorithmNames=function(e){return e.map(e=>e?e.name:"none")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findService=t.serviceActivation=void 0,t.serviceActivation=function(e){return t=>{t.activations||(t.activations=[]),t.activations.push(e)}},t.findService=function(e,t){for(let n of e.keys()){const e=n.activations;let i=!1;for(let s of e)if(i=!0,t(s))return n;if(!i)throw new Error(`SSH service type '${n.name}' must have one or more `+"'serviceActivation' decorators.")}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshMessage=void 0;const i=n(3),s=n(37);class r{get messageType(){return 0}toBuffer(){const e=new s.SshDataWriter(i.Buffer.alloc(16));return this.write(e),e.toBuffer()}read(e){this.rawBytes=e.buffer;const t=e.readByte();if(t!==this.messageType)throw new Error(`Message type ${t} is not valid.`);this.onRead(e)}write(e){e.writeByte(this.messageType),this.onWrite(e)}onRead(e){throw new Error("Not supported.")}onWrite(e){throw new Error("Not supported.")}validateField(e,t){if(void 0===e)throw new Error(`${this.constructor.name} ${t} is required.`);return e}toString(){return this.constructor.name}static create(e,t){const n=r.index.get(e);if(n){const e=new n;return e.read(new s.SshDataReader(t)),e}return null}convertTo(e,t=!1){const n=new s.SshDataReader(t?i.Buffer.from(this.rawBytes):this.rawBytes);return e.read(n),e}}t.SshMessage=r,r.index=new Map},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PARTICIPANT_PROPERTY_IS_HOST="isHost",t.PARTICIPANT_PROPERTY_HOST_FLAGS="hostFlags",t.DATA_TYPE_JOINED_READY="joined-ready",t.DATA_TYPE_JOINED_READY_ACK="joined-ready.ack",t.DATA_TYPE_LIVESHARE_HUB="ms-liveshare-hub",t.POST_FIX_NOTIFY="-notify",function(e){e[e.JoinReadAck=1]="JoinReadAck"}(t.HostFlags||(t.HostFlags={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(55);t.ContactManager=i.ContactManager,t.PublishProperties=i.PublishProperties;var s=n(184);t.defaultCompareContacts=s.defaultCompareContacts;var r=n(494);t.SessionStateStatusProvider=r.SessionStateStatusProvider;var o=n(287);t.ContactModelApi=o.ContactModelApi;var a=n(286);t.ContactServiceManager=a.ContactServiceManager;var c=n(145);t.ContactsProviderViewlet=c.ContactsProviderViewlet,t.ContactServiceExplorerItem=c.ContactServiceExplorerItem,t.ContactTreeExplorerItem=c.ContactTreeExplorerItem;var l=n(108);t.ContactCommandUtilities=l.ContactCommandUtilities;var u=n(1149);t.registerContactCommands=u.registerCommands;var d=n(288);t.ProviderBase=d.ProviderBase,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(289))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(6),r=n(185),o=n(55),a=n(286),c=n(4);class l{static async inviteHelper(e){const t=await l.getCurrentLink(e.contact.email);if(t){const n=o.ContactManager.getServiceManager(e.serviceId);return n&&n.capabilites.supportsInviteLink&&!a.ContactServiceManager.isOffline(e)?(await n.sendInviteLink(e.contact.id,t),o.ContactManager.addInviteContact(e)):await l.inviteByEmailInternal(e.contact.email,e.contact.displayName,t),!0}return!1}static async inviteByEmail(e,t){const n=await l.getCurrentLink(e);return!!n&&(await l.inviteByEmailInternal(e,t,n),!0)}static async getCurrentLink(e){const t=c.sessionStateTracker.State===c.SessionState.JoiningInProgress||c.sessionStateTracker.State===c.SessionState.Joined;if(!t){await l.ensureWorkspaceShared();const t=c.getExpService();if(t&&await t.isCachedFlightEnabled("invitationLink"))return await i.commands.executeCommand("liveshare.createInvitationLink",{workspaceId:c.workspaceSessionInfoTracker.workspaceSessionInfo.id,guestUsers:[e]})}return t||c.sessionStateTracker.State===c.SessionState.Shared?c.workspaceSessionInfoTracker.workspaceSessionInfo.joinUri:null}static async ensureWorkspaceSharedInternal(){const e=c.sessionStateTracker.State;if(e===c.SessionState.SharingInProgress){const e=new s.Signal;c.sessionStateTracker.onStateChanged(t=>{t.newAction===c.SessionAction.SharingError?e.cancel():t.newAction===c.SessionAction.SharingSuccess&&e.resolve()}),await e.promise}else if(e!==c.SessionState.Shared){const e="liveshare.start";await i.commands.executeCommand(e,{suppressNotification:!0})}}static async ensureWorkspaceShared(){await l.ensureWorkspaceSharedInProgress,l.ensureWorkspaceSharedInProgress=l.ensureWorkspaceSharedInternal(),await l.ensureWorkspaceSharedInProgress}static async inviteByEmailInternal(t,n,s){const o=c.getExpService();let a=encodeURIComponent(`${s}`);o&&await o.isCachedFlightEnabled("invitationLink")&&(a=encodeURIComponent(`This Live Share session link is only accessible by ${n} (${t}) : ${s}`));const l=encodeURIComponent("Join my Visual Studio Live Share session");if("win32"===e.platform){const e=`mailto:${t}?subject=${l}^&body=${a}`;r.exec(`start ${e}`)}else if("darwin"===e.platform){const e=`mailto:${t}?subject=${l}&body=${decodeURIComponent(a)}`;r.exec(`open '${e}'`)}else{const e=`mailto:${t}?subject=${l}&body=${a}`;i.commands.executeCommand("vscode.open",i.Uri.parse(e))}}}t.ContactCommandUtilities=l,l.ensureWorkspaceSharedInProgress=Promise.resolve()}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(7),r=n(1161);class o{constructor(){this.tracePrefix="[Communications Manager]",this.chatViewChanged=new i.EventEmitter}static get Instance(){return o.singleton||(o.singleton=new o),o.singleton}initialize(e){return this._initialize(e.rpcClient(),e.authService(),e.accessControlManager,e,()=>Promise.resolve(Array.from(e.workspaceServices().registeredServices)))}async _initialize(e,t,i,o,a){if(this.trace=s.traceSource.withName("Communications.Manager"),await this.isChatEnabled()&&(this.chatViewController=new r.ChatViewController(t,i,o,this.chatViewChanged,this.trace)),await this.isAudioEnabled()){const{CallingServiceManager:i}=n(1209);this.callingServiceManager=new i(t,e,a,this.trace),await this.callingServiceManager.initialize()}}get onChatViewChanged(){return this.chatViewChanged.event}async isChatEnabled(e=!1){return!r.ChatViewController.isUnsupportedChatExtensionInstalled(e)}async isAudioEnabled(){return!1}async openSessionChat(e){return this.trace.info(`${this.tracePrefix} open session chat`),await this.chatViewController.openSessionChat(e)}}const a=o.Instance;t.CommunicationsManager=a},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(30),r=n(543),o=n(312),a=n(71),c=n(1298),l=n(111);!function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(30));class u{error(e){console.error(e)}warn(e){console.warn(e)}info(e){console.info(e)}log(e){console.log(e)}}var d,h,f,p,m;!function(e){e[e.Continue=1]="Continue",e[e.Shutdown=2]="Shutdown"}(d=t.ErrorAction||(t.ErrorAction={})),function(e){e[e.DoNotRestart=1]="DoNotRestart",e[e.Restart=2]="Restart"}(h=t.CloseAction||(t.CloseAction={}));class g{constructor(e){this.name=e,this.restarts=[]}error(e,t,n){return n&&n<=3?d.Continue:d.Shutdown}closed(){if(this.restarts.push(Date.now()),this.restarts.length<5)return h.Restart;return this.restarts[this.restarts.length-1]-this.restarts[0]<=18e4?(i.window.showErrorMessage(`The ${this.name} server crashed 5 times in the last 3 minutes. The server will not be restarted.`),h.DoNotRestart):(this.restarts.shift(),h.Restart)}}!function(e){e[e.Info=1]="Info",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.Never=4]="Never"}(f=t.RevealOutputChannelOn||(t.RevealOutputChannelOn={})),function(e){e[e.Stopped=1]="Stopped",e[e.Running=2]="Running"}(p=t.State||(t.State={})),function(e){e[e.Initial=0]="Initial",e[e.Starting=1]="Starting",e[e.StartFailed=2]="StartFailed",e[e.Running=3]="Running",e[e.Stopping=4]="Stopping",e[e.Stopped=5]="Stopped"}(m||(m={}));const y=[s.SymbolKind.File,s.SymbolKind.Module,s.SymbolKind.Namespace,s.SymbolKind.Package,s.SymbolKind.Class,s.SymbolKind.Method,s.SymbolKind.Property,s.SymbolKind.Field,s.SymbolKind.Constructor,s.SymbolKind.Enum,s.SymbolKind.Interface,s.SymbolKind.Function,s.SymbolKind.Variable,s.SymbolKind.Constant,s.SymbolKind.String,s.SymbolKind.Number,s.SymbolKind.Boolean,s.SymbolKind.Array,s.SymbolKind.Object,s.SymbolKind.Key,s.SymbolKind.Null,s.SymbolKind.EnumMember,s.SymbolKind.Struct,s.SymbolKind.Event,s.SymbolKind.Operator,s.SymbolKind.TypeParameter],v=[s.CompletionItemKind.Text,s.CompletionItemKind.Method,s.CompletionItemKind.Function,s.CompletionItemKind.Constructor,s.CompletionItemKind.Field,s.CompletionItemKind.Variable,s.CompletionItemKind.Class,s.CompletionItemKind.Interface,s.CompletionItemKind.Module,s.CompletionItemKind.Property,s.CompletionItemKind.Unit,s.CompletionItemKind.Value,s.CompletionItemKind.Enum,s.CompletionItemKind.Keyword,s.CompletionItemKind.Snippet,s.CompletionItemKind.Color,s.CompletionItemKind.File,s.CompletionItemKind.Reference,s.CompletionItemKind.Folder,s.CompletionItemKind.EnumMember,s.CompletionItemKind.Constant,s.CompletionItemKind.Struct,s.CompletionItemKind.Event,s.CompletionItemKind.Operator,s.CompletionItemKind.TypeParameter];function S(e,t){return void 0===e[t]&&(e[t]={}),e[t]}var _;!function(e){e.is=function(e){let t=e;return t&&a.func(t.register)&&a.func(t.unregister)&&a.func(t.dispose)&&void 0!==t.messages}}(_||(_={}));class E{constructor(e,t,n,i,s,r){this._client=e,this._event=t,this._type=n,this._middleware=i,this._createParams=s,this._selectorFilter=r,this._selectors=new Map}static textDocumentFilter(e,t){for(const n of e)if(i.languages.match(n,t))return!0;return!1}register(e,t){t.registerOptions.documentSelector&&(this._listener||(this._listener=this._event(this.callback,this)),this._selectors.set(t.id,t.registerOptions.documentSelector))}callback(e){this._selectorFilter&&!this._selectorFilter(this._selectors.values(),e)||(this._middleware?this._middleware(e,e=>this._client.sendNotification(this._type,this._createParams(e))):this._client.sendNotification(this._type,this._createParams(e)),this.notificationSent(e))}notificationSent(e){}unregister(e){this._selectors.delete(e),0===this._selectors.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&this._listener.dispose()}}class w extends E{constructor(e,t){super(e,i.workspace.onDidOpenTextDocument,s.DidOpenTextDocumentNotification.type,e.clientOptions.middleware.didOpen,t=>e.code2ProtocolConverter.asOpenTextDocumentParams(t),E.textDocumentFilter),this._syncedDocuments=t}get messages(){return s.DidOpenTextDocumentNotification.type}fillClientCapabilities(e){S(S(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.openClose&&this.register(this.messages,{id:l.generateUuid(),registerOptions:{documentSelector:t}})}register(e,t){if(super.register(e,t),!t.registerOptions.documentSelector)return;let n=t.registerOptions.documentSelector;i.workspace.textDocuments.forEach(e=>{let t=e.uri.toString();if(!this._syncedDocuments.has(t)&&i.languages.match(n,e)){let n=this._client.clientOptions.middleware,i=e=>{this._client.sendNotification(this._type,this._createParams(e))};n.didOpen?n.didOpen(e,i):i(e),this._syncedDocuments.set(t,e)}})}notificationSent(e){super.notificationSent(e),this._syncedDocuments.set(e.uri.toString(),e)}}class b extends E{constructor(e,t){super(e,i.workspace.onDidCloseTextDocument,s.DidCloseTextDocumentNotification.type,e.clientOptions.middleware.didClose,t=>e.code2ProtocolConverter.asCloseTextDocumentParams(t),E.textDocumentFilter),this._syncedDocuments=t}get messages(){return s.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){S(S(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.openClose&&this.register(this.messages,{id:l.generateUuid(),registerOptions:{documentSelector:t}})}notificationSent(e){super.notificationSent(e),this._syncedDocuments.delete(e.uri.toString())}unregister(e){let t=this._selectors.get(e);super.unregister(e);let n=this._selectors.values();this._syncedDocuments.forEach(e=>{if(i.languages.match(t,e)&&!this._selectorFilter(n,e)){let t=this._client.clientOptions.middleware,n=e=>{this._client.sendNotification(this._type,this._createParams(e))};this._syncedDocuments.delete(e.uri.toString()),t.didClose?t.didClose(e,n):n(e)}})}}class C{constructor(e){this._client=e,this._changeData=new Map,this._forcingDelivery=!1}get messages(){return s.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){S(S(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&void 0!==n.change&&n.change!==s.TextDocumentSyncKind.None&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:n.change})})}register(e,t){t.registerOptions.documentSelector&&(this._listener||(this._listener=i.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(t.id,{documentSelector:t.registerOptions.documentSelector,syncKind:t.registerOptions.syncKind}))}callback(e){if(0!==e.contentChanges.length)for(const t of this._changeData.values())if(i.languages.match(t.documentSelector,e.document)){let n=this._client.clientOptions.middleware;if(t.syncKind===s.TextDocumentSyncKind.Incremental){let t=this._client.code2ProtocolConverter.asChangeTextDocumentParams(e);n.didChange?n.didChange(e,()=>this._client.sendNotification(s.DidChangeTextDocumentNotification.type,t)):this._client.sendNotification(s.DidChangeTextDocumentNotification.type,t)}else if(t.syncKind===s.TextDocumentSyncKind.Full){let t=e=>{this._changeDelayer?(this._changeDelayer.uri!==e.document.uri.toString()&&(this.forceDelivery(),this._changeDelayer.uri=e.document.uri.toString()),this._changeDelayer.delayer.trigger(()=>{this._client.sendNotification(s.DidChangeTextDocumentNotification.type,this._client.code2ProtocolConverter.asChangeTextDocumentParams(e.document))})):(this._changeDelayer={uri:e.document.uri.toString(),delayer:new c.Delayer(200)},this._changeDelayer.delayer.trigger(()=>{this._client.sendNotification(s.DidChangeTextDocumentNotification.type,this._client.code2ProtocolConverter.asChangeTextDocumentParams(e.document))},-1))};n.didChange?n.didChange(e,t):t(e)}}}unregister(e){this._changeData.delete(e),0===this._changeData.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._changeDelayer=void 0,this._forcingDelivery=!1,this._changeData.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}forceDelivery(){if(!this._forcingDelivery&&this._changeDelayer)try{this._forcingDelivery=!0,this._changeDelayer.delayer.forceDelivery()}finally{this._forcingDelivery=!1}}}class T extends E{constructor(e){super(e,i.workspace.onWillSaveTextDocument,s.WillSaveTextDocumentNotification.type,e.clientOptions.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),(e,t)=>E.textDocumentFilter(e,t.document))}get messages(){return s.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){S(S(e,"textDocument"),"synchronization").willSave=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.willSave&&this.register(this.messages,{id:l.generateUuid(),registerOptions:{documentSelector:t}})}}class M{constructor(e){this._client=e,this._selectors=new Map}get messages(){return s.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){S(S(e,"textDocument"),"synchronization").willSaveWaitUntil=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.willSaveWaitUntil&&this.register(this.messages,{id:l.generateUuid(),registerOptions:{documentSelector:t}})}register(e,t){t.registerOptions.documentSelector&&(this._listener||(this._listener=i.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(t.id,t.registerOptions.documentSelector))}callback(e){if(E.textDocumentFilter(this._selectors.values(),e.document)){let t=this._client.clientOptions.middleware,n=e=>this._client.sendRequest(s.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(e)).then(e=>{let t=this._client.protocol2CodeConverter.asTextEdits(e);return void 0===t?[]:t});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,n):n(e))}}unregister(e){this._selectors.delete(e),0===this._selectors.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}}class A extends E{constructor(e){super(e,i.workspace.onDidSaveTextDocument,s.DidSaveTextDocumentNotification.type,e.clientOptions.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),E.textDocumentFilter)}get messages(){return s.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){S(S(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.save&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{includeText:!!n.save.includeText})})}register(e,t){this._includeText=!!t.registerOptions.includeText,super.register(e,t)}}class k{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}get messages(){return s.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){S(S(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0}initialize(e,t){}register(e,t){if(!Array.isArray(t.registerOptions.watchers))return;let n=[];for(let e of t.registerOptions.watchers){if(!a.string(e.globPattern))continue;let t=!0,r=!0,o=!0;void 0!==e.kind&&null!==e.kind&&(t=0!=(e.kind&s.WatchKind.Create),r=0!=(e.kind&s.WatchKind.Change),o=0!=(e.kind&s.WatchKind.Delete));let c=i.workspace.createFileSystemWatcher(e.globPattern,!t,!r,!o);this.hookListeners(c,t,r,o),n.push(c)}this._watchers.set(t.id,n)}registerRaw(e,t){let n=[];for(let e of t)this.hookListeners(e,!0,!0,!0,n);this._watchers.set(e,n)}hookListeners(e,t,n,i,r){t&&e.onDidCreate(e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:s.FileChangeType.Created}),null,r),n&&e.onDidChange(e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:s.FileChangeType.Changed}),null,r),i&&e.onDidDelete(e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:s.FileChangeType.Deleted}),null,r)}unregister(e){let t=this._watchers.get(e);if(t)for(let e of t)e.dispose()}dispose(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}}class R{constructor(e,t){this._client=e,this._message=t,this._providers=new Map}get messages(){return this._message}register(e,t){if(e.method!==this.messages.method)throw new Error(`Register called on wrong feature. Requested ${e.method} but reached feature ${this.messages.method}`);if(!t.registerOptions.documentSelector)return;let n=this.registerLanguageProvider(t.registerOptions);n&&this._providers.set(t.id,n)}unregister(e){let t=this._providers.get(e);t&&t.dispose()}dispose(){this._providers.forEach(e=>{e.dispose()}),this._providers.clear()}}t.TextDocumentFeature=R;class P extends R{constructor(e){super(e,s.CompletionRequest.type)}fillClientCapabilities(e){let t=S(S(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[s.MarkupKind.Markdown,s.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0},t.completionItemKind={valueSet:v}}initialize(e,t){e.completionProvider&&t&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},e.completionProvider)})}registerLanguageProvider(e){let t=e.triggerCharacters||[],n=this._client,r=(e,t,i,r)=>n.sendRequest(s.CompletionRequest.type,n.code2ProtocolConverter.asCompletionParams(e,t,i),r).then(n.protocol2CodeConverter.asCompletionResult,e=>(n.logFailedRequest(s.CompletionRequest.type,e),Promise.resolve([]))),o=(e,t)=>n.sendRequest(s.CompletionResolveRequest.type,n.code2ProtocolConverter.asCompletionItem(e),t).then(n.protocol2CodeConverter.asCompletionItem,t=>(n.logFailedRequest(s.CompletionResolveRequest.type,t),Promise.resolve(e))),a=this._client.clientOptions.middleware;return i.languages.registerCompletionItemProvider(e.documentSelector,{provideCompletionItems:(e,t,n,i)=>a.provideCompletionItem?a.provideCompletionItem(e,t,i,n,r):r(e,t,i,n),resolveCompletionItem:e.resolveProvider?(e,t)=>a.resolveCompletionItem?a.resolveCompletionItem(e,t,o):o(e,t):void 0},...t)}}class I extends R{constructor(e){super(e,s.HoverRequest.type)}fillClientCapabilities(e){const t=S(S(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[s.MarkupKind.Markdown,s.MarkupKind.PlainText]}initialize(e,t){e.hoverProvider&&t&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t})})}registerLanguageProvider(e){let t=this._client,n=(e,n,i)=>t.sendRequest(s.HoverRequest.type,t.code2ProtocolConverter.asTextDocumentPositionParams(e,n),i).then(t.protocol2CodeConverter.asHover,e=>(t.logFailedRequest(s.HoverRequest.type,e),Promise.resolve(null))),r=t.clientOptions.middleware;return i.languages.registerHoverProvider(e.documentSelector,{provideHover:(e,t,i)=>r.provideHover?r.provideHover(e,t,i,n):n(e,t,i)})}}class N extends R{constructor(e){super(e,s.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=S(S(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[s.MarkupKind.Markdown,s.MarkupKind.PlainText]}}initialize(e,t){e.signatureHelpProvider&&t&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},e.signatureHelpProvider)})}registerLanguageProvider(e){let t=this._client,n=(e,n,i)=>t.sendRequest(s.SignatureHelpRequest.type,t.code2ProtocolConverter.asTextDocumentPositionParams(e,n),i).then(t.protocol2CodeConverter.asSignatureHelp,e=>(t.logFailedRequest(s.SignatureHelpRequest.type,e),Promise.resolve(null))),r=t.clientOptions.middleware,o=e.triggerCharacters||[];return i.languages.registerSignatureHelpProvider(e.documentSelector,{provideSignatureHelp:(e,t,i)=>r.provideSignatureHelp?r.provideSignatureHelp(e,t,i,n):n(e,t,i)},...o)}}class L extends R{constructor(e){super(e,s.DefinitionRequest.type)}fillClientCapabilities(e){S(S(e,"textDocument"),"definition").dynamicRegistration=!0}initialize(e,t){e.definitionProvider&&t&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t})})}registerLanguageProvider(e){let t=this._client,n=(e,n,i)=>t.sendRequest(s.DefinitionRequest.type,t.code2ProtocolConverter.asTextDocumentPositionParams(e,n),i).then(t.protocol2CodeConverter.asDefinitionResult,e=>(t.logFailedRequest(s.DefinitionRequest.type,e),Promise.resolve(null))),r=t.clientOptions.middleware;return i.languages.registerDefinitionProvider(e.documentSelector,{provideDefinition:(e,t,i)=>r.provideDefinition?r.provideDefinition(e,t,i,n):n(e,t,i)})}}class D extends R{constructor(e){super(e,s.ReferencesRequest.type)}fillClientCapabilities(e){S(S(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){e.referencesProvider&&t&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t})})}registerLanguageProvider(e){let t=this._client,n=(e,n,i,r)=>t.sendRequest(s.ReferencesRequest.type,t.code2ProtocolConverter.asReferenceParams(e,n,i),r).then(t.protocol2CodeConverter.asReferences,e=>(t.logFailedRequest(s.ReferencesRequest.type,e),Promise.resolve([]))),r=t.clientOptions.middleware;return i.languages.registerReferenceProvider(e.documentSelector,{provideReferences:(e,t,i,s)=>r.provideReferences?r.provideReferences(e,t,i,s,n):n(e,t,i,s)})}}class x extends R{constructor(e){super(e,s.DocumentHighlightRequest.type)}fillClientCapabilities(e){S(S(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){e.documentHighlightProvider&&t&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t})})}registerLanguageProvider(e){let t=this._client,n=(e,n,i)=>t.sendRequest(s.DocumentHighlightRequest.type,t.code2ProtocolConverter.asTextDocumentPositionParams(e,n),i).then(t.protocol2CodeConverter.asDocumentHighlights,e=>(t.logFailedRequest(s.DocumentHighlightRequest.type,e),Promise.resolve([]))),r=t.clientOptions.middleware;return i.languages.registerDocumentHighlightProvider(e.documentSelector,{provideDocumentHighlights:(e,t,i)=>r.provideDocumentHighlights?r.provideDocumentHighlights(e,t,i,n):n(e,t,i)})}}class O extends R{constructor(e){super(e,s.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=S(S(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:y},t.hierarchicalDocumentSymbolSupport=!0}initialize(e,t){e.documentSymbolProvider&&t&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t})})}registerLanguageProvider(e){let t=this._client,n=(e,n)=>t.sendRequest(s.DocumentSymbolRequest.type,t.code2ProtocolConverter.asDocumentSymbolParams(e),n).then(e=>{if(null!==e){if(0===e.length)return[];{let n=e[0];return s.DocumentSymbol.is(n)?t.protocol2CodeConverter.asDocumentSymbols(e):t.protocol2CodeConverter.asSymbolInformations(e)}}},e=>(t.logFailedRequest(s.DocumentSymbolRequest.type,e),Promise.resolve([]))),r=t.clientOptions.middleware;return i.languages.registerDocumentSymbolProvider(e.documentSelector,{provideDocumentSymbols:(e,t)=>r.provideDocumentSymbols?r.provideDocumentSymbols(e,t,n):n(e,t)})}}class F extends class{constructor(e,t){this._client=e,this._message=t,this._providers=new Map}get messages(){return this._message}register(e,t){if(e.method!==this.messages.method)throw new Error(`Register called on wron feature. Requested ${e.method} but reached feature ${this.messages.method}`);let n=this.registerLanguageProvider(t.registerOptions);n&&this._providers.set(t.id,n)}unregister(e){let t=this._providers.get(e);t&&t.dispose()}dispose(){this._providers.forEach(e=>{e.dispose()}),this._providers.clear()}}{constructor(e){super(e,s.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=S(S(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:y}}initialize(e){e.workspaceSymbolProvider&&this.register(this.messages,{id:l.generateUuid(),registerOptions:void 0})}registerLanguageProvider(e){let t=this._client,n=(e,n)=>t.sendRequest(s.WorkspaceSymbolRequest.type,{query:e},n).then(t.protocol2CodeConverter.asSymbolInformations,e=>(t.logFailedRequest(s.WorkspaceSymbolRequest.type,e),Promise.resolve([]))),r=t.clientOptions.middleware;return i.languages.registerWorkspaceSymbolProvider({provideWorkspaceSymbols:(e,t)=>r.provideWorkspaceSymbols?r.provideWorkspaceSymbols(e,t,n):n(e,t)})}}class U extends R{constructor(e){super(e,s.CodeActionRequest.type)}fillClientCapabilities(e){const t=S(S(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.codeActionLiteralSupport={codeActionKind:{valueSet:["",s.CodeActionKind.QuickFix,s.CodeActionKind.Refactor,s.CodeActionKind.RefactorExtract,s.CodeActionKind.RefactorInline,s.CodeActionKind.RefactorRewrite,s.CodeActionKind.Source,s.CodeActionKind.SourceOrganizeImports]}}}initialize(e,t){e.codeActionProvider&&t&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t})})}registerLanguageProvider(e){let t=this._client,n=(e,n,i,r)=>{let o={textDocument:t.code2ProtocolConverter.asTextDocumentIdentifier(e),range:t.code2ProtocolConverter.asRange(n),context:t.code2ProtocolConverter.asCodeActionContext(i)};return t.sendRequest(s.CodeActionRequest.type,o,r).then(e=>{if(null===e)return;let n=[];for(let i of e)s.Command.is(i)?n.push(t.protocol2CodeConverter.asCommand(i)):n.push(t.protocol2CodeConverter.asCodeAction(i));return n},e=>(t.logFailedRequest(s.CodeActionRequest.type,e),Promise.resolve([])))},r=t.clientOptions.middleware;return i.languages.registerCodeActionsProvider(e.documentSelector,{provideCodeActions:(e,t,i,s)=>r.provideCodeActions?r.provideCodeActions(e,t,i,s,n):n(e,t,i,s)})}}class j extends R{constructor(e){super(e,s.CodeLensRequest.type)}fillClientCapabilities(e){S(S(e,"textDocument"),"codeLens").dynamicRegistration=!0}initialize(e,t){e.codeLensProvider&&t&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},e.codeLensProvider)})}registerLanguageProvider(e){let t=this._client,n=(e,n)=>t.sendRequest(s.CodeLensRequest.type,t.code2ProtocolConverter.asCodeLensParams(e),n).then(t.protocol2CodeConverter.asCodeLenses,e=>(t.logFailedRequest(s.CodeLensRequest.type,e),Promise.resolve([]))),r=(e,n)=>t.sendRequest(s.CodeLensResolveRequest.type,t.code2ProtocolConverter.asCodeLens(e),n).then(t.protocol2CodeConverter.asCodeLens,n=>(t.logFailedRequest(s.CodeLensResolveRequest.type,n),e)),o=t.clientOptions.middleware;return i.languages.registerCodeLensProvider(e.documentSelector,{provideCodeLenses:(e,t)=>o.provideCodeLenses?o.provideCodeLenses(e,t,n):n(e,t),resolveCodeLens:e.resolveProvider?(e,t)=>o.resolveCodeLens?o.resolveCodeLens(e,t,r):r(e,t):void 0})}}class H extends R{constructor(e){super(e,s.DocumentFormattingRequest.type)}fillClientCapabilities(e){S(S(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){e.documentFormattingProvider&&t&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t})})}registerLanguageProvider(e){let t=this._client,n=(e,n,i)=>{let r={textDocument:t.code2ProtocolConverter.asTextDocumentIdentifier(e),options:t.code2ProtocolConverter.asFormattingOptions(n)};return t.sendRequest(s.DocumentFormattingRequest.type,r,i).then(t.protocol2CodeConverter.asTextEdits,e=>(t.logFailedRequest(s.DocumentFormattingRequest.type,e),Promise.resolve([])))},r=t.clientOptions.middleware;return i.languages.registerDocumentFormattingEditProvider(e.documentSelector,{provideDocumentFormattingEdits:(e,t,i)=>r.provideDocumentFormattingEdits?r.provideDocumentFormattingEdits(e,t,i,n):n(e,t,i)})}}class B extends R{constructor(e){super(e,s.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){S(S(e,"textDocument"),"rangeFormatting").dynamicRegistration=!0}initialize(e,t){e.documentRangeFormattingProvider&&t&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t})})}registerLanguageProvider(e){let t=this._client,n=(e,n,i,r)=>{let o={textDocument:t.code2ProtocolConverter.asTextDocumentIdentifier(e),range:t.code2ProtocolConverter.asRange(n),options:t.code2ProtocolConverter.asFormattingOptions(i)};return t.sendRequest(s.DocumentRangeFormattingRequest.type,o,r).then(t.protocol2CodeConverter.asTextEdits,e=>(t.logFailedRequest(s.DocumentRangeFormattingRequest.type,e),Promise.resolve([])))},r=t.clientOptions.middleware;return i.languages.registerDocumentRangeFormattingEditProvider(e.documentSelector,{provideDocumentRangeFormattingEdits:(e,t,i,s)=>r.provideDocumentRangeFormattingEdits?r.provideDocumentRangeFormattingEdits(e,t,i,s,n):n(e,t,i,s)})}}class Y extends R{constructor(e){super(e,s.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){S(S(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){e.documentOnTypeFormattingProvider&&t&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},e.documentOnTypeFormattingProvider)})}registerLanguageProvider(e){let t=this._client,n=e.moreTriggerCharacter||[],r=(e,n,i,r,o)=>{let a={textDocument:t.code2ProtocolConverter.asTextDocumentIdentifier(e),position:t.code2ProtocolConverter.asPosition(n),ch:i,options:t.code2ProtocolConverter.asFormattingOptions(r)};return t.sendRequest(s.DocumentOnTypeFormattingRequest.type,a,o).then(t.protocol2CodeConverter.asTextEdits,e=>(t.logFailedRequest(s.DocumentOnTypeFormattingRequest.type,e),Promise.resolve([])))},o=t.clientOptions.middleware;return i.languages.registerOnTypeFormattingEditProvider(e.documentSelector,{provideOnTypeFormattingEdits:(e,t,n,i,s)=>o.provideOnTypeFormattingEdits?o.provideOnTypeFormattingEdits(e,t,n,i,s,r):r(e,t,n,i,s)},e.firstTriggerCharacter,...n)}}class W extends R{constructor(e){super(e,s.RenameRequest.type)}fillClientCapabilities(e){S(S(e,"textDocument"),"rename").dynamicRegistration=!0}initialize(e,t){e.renameProvider&&t&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t})})}registerLanguageProvider(e){let t=this._client,n=(e,n,i,r)=>{let o={textDocument:t.code2ProtocolConverter.asTextDocumentIdentifier(e),position:t.code2ProtocolConverter.asPosition(n),newName:i};return t.sendRequest(s.RenameRequest.type,o,r).then(t.protocol2CodeConverter.asWorkspaceEdit,e=>(t.logFailedRequest(s.RenameRequest.type,e),Promise.reject(new Error(e.message))))},r=t.clientOptions.middleware;return i.languages.registerRenameProvider(e.documentSelector,{provideRenameEdits:(e,t,i,s)=>r.provideRenameEdits?r.provideRenameEdits(e,t,i,s,n):n(e,t,i,s)})}}class q extends R{constructor(e){super(e,s.DocumentLinkRequest.type)}fillClientCapabilities(e){S(S(e,"textDocument"),"documentLink").dynamicRegistration=!0}initialize(e,t){e.documentLinkProvider&&t&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},e.documentLinkProvider)})}registerLanguageProvider(e){let t=this._client,n=(e,n)=>t.sendRequest(s.DocumentLinkRequest.type,t.code2ProtocolConverter.asDocumentLinkParams(e),n).then(t.protocol2CodeConverter.asDocumentLinks,e=>{t.logFailedRequest(s.DocumentLinkRequest.type,e),Promise.resolve(new Error(e.message))}),r=(e,n)=>t.sendRequest(s.DocumentLinkResolveRequest.type,t.code2ProtocolConverter.asDocumentLink(e),n).then(t.protocol2CodeConverter.asDocumentLink,e=>{t.logFailedRequest(s.DocumentLinkResolveRequest.type,e),Promise.resolve(new Error(e.message))}),o=t.clientOptions.middleware;return i.languages.registerDocumentLinkProvider(e.documentSelector,{provideDocumentLinks:(e,t)=>o.provideDocumentLinks?o.provideDocumentLinks(e,t,n):n(e,t),resolveDocumentLink:e.resolveProvider?(e,t)=>o.resolveDocumentLink?o.resolveDocumentLink(e,t,r):r(e,t):void 0})}}class V{constructor(e){this._client=e,this._listeners=new Map}get messages(){return s.DidChangeConfigurationNotification.type}fillClientCapabilities(e){S(S(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){let e=this._client.clientOptions.synchronize.configurationSection;void 0!==e&&this.register(this.messages,{id:l.generateUuid(),registerOptions:{section:e}})}register(e,t){let n=i.workspace.onDidChangeConfiguration(e=>{this.onDidChangeConfiguration(t.registerOptions.section,e)});this._listeners.set(t.id,n),void 0!==t.registerOptions.section&&this.onDidChangeConfiguration(t.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}onDidChangeConfiguration(e,t){let n;if(n=a.string(e)?[e]:e,void 0!==n&&void 0!==t){if(!n.some(e=>t.affectsConfiguration(e)))return}let i=e=>{void 0!==e?this._client.sendNotification(s.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(e)}):this._client.sendNotification(s.DidChangeConfigurationNotification.type,{settings:null})},r=this.getMiddleware();r?r(n,i):i(n)}extractSettingsInformation(e){function t(e,t){let n=e;for(let e=0;e<t.length-1;e++){let i=n[t[e]];i||(i=Object.create(null),n[t[e]]=i),n=i}return n}let n=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,s=Object.create(null);for(let r=0;r<e.length;r++){let o=e[r],a=o.indexOf("."),c=null;if(c=a>=0?i.workspace.getConfiguration(o.substr(0,a),n).get(o.substr(a+1)):i.workspace.getConfiguration(o,n),c){let n=e[r].split(".");t(s,n)[n[n.length-1]]=c}}return s}getMiddleware(){let e=this._client.clientOptions.middleware;return e.workspace&&e.workspace.didChangeConfiguration?e.workspace.didChangeConfiguration:void 0}}class ${constructor(e){this._client=e,this._commands=new Map}get messages(){return s.ExecuteCommandRequest.type}fillClientCapabilities(e){S(S(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e,t){let n=this._client;if(t.registerOptions.commands){let e=[];for(const r of t.registerOptions.commands)e.push(i.commands.registerCommand(r,(...e)=>{let t={command:r,arguments:e};return n.sendRequest(s.ExecuteCommandRequest.type,t).then(void 0,e=>{n.logFailedRequest(s.ExecuteCommandRequest.type,e)})}));this._commands.set(t.id,e)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(e=>e.dispose())}dispose(){this._commands.forEach(e=>{e.forEach(e=>e.dispose())}),this._commands.clear()}}!function(e){e.is=function(e){return e&&s.MessageReader.is(e.reader)&&s.MessageWriter.is(e.writer)}}(t.MessageTransports||(t.MessageTransports={}));t.BaseLanguageClient=class{constructor(e,t,n){this._features=[],this._method2Message=new Map,this._dynamicFeatures=new Map,this._id=e,this._name=t,n=n||{},this._clientOptions={documentSelector:n.documentSelector||[],synchronize:n.synchronize||{},diagnosticCollectionName:n.diagnosticCollectionName,outputChannelName:n.outputChannelName||this._name,revealOutputChannelOn:n.revealOutputChannelOn||f.Error,stdioEncoding:n.stdioEncoding||"utf8",initializationOptions:n.initializationOptions,initializationFailedHandler:n.initializationFailedHandler,errorHandler:n.errorHandler||new g(this._name),middleware:n.middleware||{},uriConverters:n.uriConverters,workspaceFolder:n.workspaceFolder},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this.state=m.Initial,this._connectionPromise=void 0,this._resolvedConnection=void 0,this._initializeResult=void 0,n.outputChannel?(this._outputChannel=n.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._listeners=void 0,this._providers=void 0,this._diagnostics=void 0,this._fileEvents=[],this._fileEventDelayer=new c.Delayer(250),this._onReady=new Promise((e,t)=>{this._onReadyCallbacks={resolve:e,reject:t}}),this._onStop=void 0,this._telemetryEmitter=new s.Emitter,this._stateChangeEmitter=new s.Emitter,this._tracer={log:(e,t)=>{this.logTrace(e,t)}},this._c2p=r.createConverter(n.uriConverters?n.uriConverters.code2Protocol:void 0),this._p2c=o.createConverter(n.uriConverters?n.uriConverters.protocol2Code:void 0),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get state(){return this._state}set state(e){let t=this.getPublicState();this._state=e;let n=this.getPublicState();n!==t&&this._stateChangeEmitter.fire({oldState:t,newState:n})}getPublicState(){return this.state===m.Running?p.Running:p.Stopped}get initializeResult(){return this._initializeResult}sendRequest(e,...t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");this.forceDocumentSync();try{return this._resolvedConnection.sendRequest(e,...t)}catch(t){throw this.error(`Sending request ${a.string(e)?e:e.method} failed.`,t),t}}onRequest(e,t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");try{this._resolvedConnection.onRequest(e,t)}catch(t){throw this.error(`Registering request handler ${a.string(e)?e:e.method} failed.`,t),t}}sendNotification(e,t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");this.forceDocumentSync();try{this._resolvedConnection.sendNotification(e,t)}catch(t){throw this.error(`Sending notification ${a.string(e)?e:e.method} failed.`,t),t}}onNotification(e,t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");try{this._resolvedConnection.onNotification(e,t)}catch(t){throw this.error(`Registering notification handler ${a.string(e)?e:e.method} failed.`,t),t}}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=i.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get diagnostics(){return this._diagnostics}createDefaultErrorHandler(){return new g(this._name)}set trace(e){this._trace=e,this.onReady().then(()=>{this.resolveConnection().then(t=>{t.trace(e,this._tracer)})},()=>{})}data2String(e){if(e instanceof s.ResponseError){const t=e;return`  Message: ${t.message}\n  Code: ${t.code} ${t.data?"\n"+t.data.toString():""}`}return e instanceof Error?a.string(e.stack)?e.stack:e.message:a.string(e)?e:e.toString()}info(e,t){this.outputChannel.appendLine(`[Info  - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.outputChannel.appendLine(this.data2String(t)),this._clientOptions.revealOutputChannelOn<=f.Info&&this.outputChannel.show(!0)}warn(e,t){this.outputChannel.appendLine(`[Warn  - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.outputChannel.appendLine(this.data2String(t)),this._clientOptions.revealOutputChannelOn<=f.Warn&&this.outputChannel.show(!0)}error(e,t){this.outputChannel.appendLine(`[Error - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.outputChannel.appendLine(this.data2String(t)),this._clientOptions.revealOutputChannelOn<=f.Error&&this.outputChannel.show(!0)}logTrace(e,t){this.outputChannel.appendLine(`[Trace - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.outputChannel.appendLine(this.data2String(t))}needsStart(){return this.state===m.Initial||this.state===m.Stopping||this.state===m.Stopped}needsStop(){return this.state===m.Starting||this.state===m.Running}onReady(){return this._onReady}isConnectionActive(){return this.state===m.Running&&!!this._resolvedConnection}start(){return this._listeners=[],this._providers=[],this._diagnostics||(this._diagnostics=this._clientOptions.diagnosticCollectionName?i.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):i.languages.createDiagnosticCollection()),this.state=m.Starting,this.resolveConnection().then(e=>(e.onLogMessage(e=>{switch(e.type){case s.MessageType.Error:this.error(e.message);break;case s.MessageType.Warning:this.warn(e.message);break;case s.MessageType.Info:this.info(e.message);break;default:this.outputChannel.appendLine(e.message)}}),e.onShowMessage(e=>{switch(e.type){case s.MessageType.Error:i.window.showErrorMessage(e.message);break;case s.MessageType.Warning:i.window.showWarningMessage(e.message);break;case s.MessageType.Info:i.window.showInformationMessage(e.message);break;default:i.window.showInformationMessage(e.message)}}),e.onRequest(s.ShowMessageRequest.type,e=>{let t;switch(e.type){case s.MessageType.Error:t=i.window.showErrorMessage;break;case s.MessageType.Warning:t=i.window.showWarningMessage;break;case s.MessageType.Info:t=i.window.showInformationMessage;break;default:t=i.window.showInformationMessage}let n=e.actions||[];return t(e.message,...n)}),e.onTelemetry(e=>{this._telemetryEmitter.fire(e)}),e.listen(),this.initialize(e))).then(void 0,e=>{this.state=m.StartFailed,this._onReadyCallbacks.reject(e),this.error("Starting client failed",e),i.window.showErrorMessage(`Couldn't start client ${this._name}`)}),new i.Disposable(()=>{this.needsStop()&&this.stop()})}resolveConnection(){return this._connectionPromise||(this._connectionPromise=this.createConnection()),this._connectionPromise}initialize(t){this.refreshTrace(t,!1);let n=this._clientOptions.initializationOptions,r=this._clientOptions.workspaceFolder?this._clientOptions.workspaceFolder.uri.fsPath:this._clientGetRootPath(),o={processId:e.pid,rootPath:r||null,rootUri:r?this._c2p.asUri(i.Uri.file(r)):null,capabilities:this.computeClientCapabilities(),initializationOptions:a.func(n)?n():n,trace:s.Trace.toString(this._trace),workspaceFolders:null};return this.fillInitializeParams(o),t.initialize(o).then(e=>{this._resolvedConnection=t,this._initializeResult=e,this.state=m.Running;let n=void 0;return a.number(e.capabilities.textDocumentSync)&&e.capabilities.textDocumentSync!==s.TextDocumentSyncKind.None?n={openClose:!0,change:e.capabilities.textDocumentSync,save:{includeText:!1}}:void 0!==e.capabilities.textDocumentSync&&null!==e.capabilities.textDocumentSync&&(n=e.capabilities.textDocumentSync),this._capabilities=Object.assign({},e.capabilities,{resolvedTextDocumentSync:n}),t.onDiagnostics(e=>this.handleDiagnostics(e)),t.onRequest(s.RegistrationRequest.type,e=>this.handleRegistrationRequest(e)),t.onRequest("client/registerFeature",e=>this.handleRegistrationRequest(e)),t.onRequest(s.UnregistrationRequest.type,e=>this.handleUnregistrationRequest(e)),t.onRequest("client/unregisterFeature",e=>this.handleUnregistrationRequest(e)),t.onRequest(s.ApplyWorkspaceEditRequest.type,e=>this.handleApplyWorkspaceEdit(e)),t.sendNotification(s.InitializedNotification.type,{}),this.hookFileEvents(t),this.hookConfigurationChanged(t),this.initializeFeatures(t),this._onReadyCallbacks.resolve(),e}).then(void 0,e=>{this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(e)?this.initialize(t):(this.stop(),this._onReadyCallbacks.reject(e)):e instanceof s.ResponseError&&e.data&&e.data.retry?i.window.showErrorMessage(e.message,{title:"Retry",id:"retry"}).then(n=>{n&&"retry"===n.id?this.initialize(t):(this.stop(),this._onReadyCallbacks.reject(e))}):(e&&e.message&&i.window.showErrorMessage(e.message),this.error("Server initialization failed.",e),this.stop(),this._onReadyCallbacks.reject(e))})}_clientGetRootPath(){let e=i.workspace.workspaceFolders;if(!e||0===e.length)return;let t=e[0];return"file"===t.uri.scheme?t.uri.fsPath:void 0}stop(){return this._initializeResult=void 0,this._connectionPromise?this.state===m.Stopping&&this._onStop?this._onStop:(this.state=m.Stopping,this.cleanUp(),this._onStop=this.resolveConnection().then(e=>e.shutdown().then(()=>{e.exit(),e.dispose(),this.state=m.Stopped,this._onStop=void 0,this._connectionPromise=void 0,this._resolvedConnection=void 0}))):(this.state=m.Stopped,Promise.resolve())}cleanUp(e=!0,t=!0){this._listeners&&(this._listeners.forEach(e=>e.dispose()),this._listeners=void 0),this._providers&&(this._providers.forEach(e=>e.dispose()),this._providers=void 0),this._syncedDocuments&&this._syncedDocuments.clear();for(let e of this._dynamicFeatures.values())e.dispose();e&&this._outputChannel&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0),t&&this._diagnostics&&(this._diagnostics.dispose(),this._diagnostics=void 0)}notifyFileEvent(e){this._fileEvents.push(e),this._fileEventDelayer.trigger(()=>{this.onReady().then(()=>{this.resolveConnection().then(e=>{this.isConnectionActive()&&e.didChangeWatchedFiles({changes:this._fileEvents}),this._fileEvents=[]})},e=>{this.error("Notify file events failed.",e)})})}forceDocumentSync(){this._dynamicFeatures.get(s.DidChangeTextDocumentNotification.type.method).forceDelivery()}handleDiagnostics(e){if(!this._diagnostics)return;let t=this._p2c.asUri(e.uri),n=this._p2c.asDiagnostics(e.diagnostics),i=this.clientOptions.middleware.handleDiagnostics;i?i(t,n,(e,t)=>this.setDiagnostics(e,t)):this.setDiagnostics(t,n)}setDiagnostics(e,t){this._diagnostics&&this._diagnostics.set(e,t)}createConnection(){let e=(e,t,n)=>{this.handleConnectionError(e,t,n)},t=()=>{this.handleConnectionClosed()};return this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8").then(n=>function(e,t,n,i){let r=new u,o=s.createProtocolConnection(e,t,r);return o.onError(e=>{n(e[0],e[1],e[2])}),o.onClose(i),{listen:()=>o.listen(),sendRequest:(e,...t)=>o.sendRequest(a.string(e)?e:e.method,...t),onRequest:(e,t)=>o.onRequest(a.string(e)?e:e.method,t),sendNotification:(e,t)=>o.sendNotification(a.string(e)?e:e.method,t),onNotification:(e,t)=>o.onNotification(a.string(e)?e:e.method,t),trace:(e,t,n=!1)=>o.trace(e,t,n),initialize:e=>o.sendRequest(s.InitializeRequest.type,e),shutdown:()=>o.sendRequest(s.ShutdownRequest.type,void 0),exit:()=>o.sendNotification(s.ExitNotification.type),onLogMessage:e=>o.onNotification(s.LogMessageNotification.type,e),onShowMessage:e=>o.onNotification(s.ShowMessageNotification.type,e),onTelemetry:e=>o.onNotification(s.TelemetryEventNotification.type,e),didChangeConfiguration:e=>o.sendNotification(s.DidChangeConfigurationNotification.type,e),didChangeWatchedFiles:e=>o.sendNotification(s.DidChangeWatchedFilesNotification.type,e),didOpenTextDocument:e=>o.sendNotification(s.DidOpenTextDocumentNotification.type,e),didChangeTextDocument:e=>o.sendNotification(s.DidChangeTextDocumentNotification.type,e),didCloseTextDocument:e=>o.sendNotification(s.DidCloseTextDocumentNotification.type,e),didSaveTextDocument:e=>o.sendNotification(s.DidSaveTextDocumentNotification.type,e),onDiagnostics:e=>o.onNotification(s.PublishDiagnosticsNotification.type,e),dispose:()=>o.dispose()}}(n.reader,n.writer,e,t))}handleConnectionClosed(){if(this.state===m.Stopping||this.state===m.Stopped)return;try{this._resolvedConnection&&this._resolvedConnection.dispose()}catch(e){}let e=h.DoNotRestart;try{e=this._clientOptions.errorHandler.closed()}catch(e){}this._connectionPromise=void 0,this._resolvedConnection=void 0,e===h.DoNotRestart?(this.error("Connection to server got closed. Server will not be restarted."),this.state=m.Stopped,this.cleanUp(!1,!0)):e===h.Restart&&(this.info("Connection to server got closed. Server will restart."),this.cleanUp(!1,!1),this.state=m.Initial,this.start())}handleConnectionError(e,t,n){this._clientOptions.errorHandler.error(e,t,n)===d.Shutdown&&(this.error("Connection to server is erroring. Shutting down server."),this.stop())}hookConfigurationChanged(e){i.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)})}refreshTrace(e,t=!1){let n=i.workspace.getConfiguration(this._id),r=s.Trace.Off;n&&(r=s.Trace.fromString(n.get("trace.server","off"))),this._trace=r,e.trace(this._trace,this._tracer,t)}hookFileEvents(e){let t,n=this._clientOptions.synchronize.fileEvents;n&&(t=a.array(n)?n:[n],t&&this._dynamicFeatures.get(s.DidChangeWatchedFilesNotification.type.method).registerRaw(l.generateUuid(),t))}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),_.is(e)){let t=e.messages;if(Array.isArray(t))for(let n of t)this._method2Message.set(n.method,n),this._dynamicFeatures.set(n.method,e);else this._method2Message.set(t.method,t),this._dynamicFeatures.set(t.method,e)}}registerBuiltinFeatures(){this.registerFeature(new V(this)),this.registerFeature(new w(this,this._syncedDocuments)),this.registerFeature(new C(this)),this.registerFeature(new T(this)),this.registerFeature(new M(this)),this.registerFeature(new A(this)),this.registerFeature(new b(this,this._syncedDocuments)),this.registerFeature(new k(this,e=>this.notifyFileEvent(e))),this.registerFeature(new P(this)),this.registerFeature(new I(this)),this.registerFeature(new N(this)),this.registerFeature(new L(this)),this.registerFeature(new D(this)),this.registerFeature(new x(this)),this.registerFeature(new O(this)),this.registerFeature(new F(this)),this.registerFeature(new U(this)),this.registerFeature(new j(this)),this.registerFeature(new H(this)),this.registerFeature(new B(this)),this.registerFeature(new Y(this)),this.registerFeature(new W(this)),this.registerFeature(new q(this)),this.registerFeature(new $(this))}fillInitializeParams(e){for(let t of this._features)a.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let e={};S(e,"workspace").applyEdit=!0,S(S(e,"workspace"),"workspaceEdit").documentChanges=!0,S(S(e,"textDocument"),"publishDiagnostics").relatedInformation=!0;for(let t of this._features)t.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let e of this._features)e.initialize(this._capabilities,t)}handleRegistrationRequest(e){return new Promise((t,n)=>{for(let t of e.registrations){const e=this._dynamicFeatures.get(t.method);if(!e)return void n(new Error(`No feature implementation for ${t.method} found. Registration failed.`));const i=t.registerOptions||{};i.documentSelector=i.documentSelector||this._clientOptions.documentSelector;const s={id:t.id,registerOptions:i};e.register(this._method2Message.get(t.method),s)}t()})}handleUnregistrationRequest(e){return new Promise((t,n)=>{for(let t of e.unregisterations){const e=this._dynamicFeatures.get(t.method);if(!e)return void n(new Error(`No feature implementation for ${t.method} found. Unregistration failed.`));e.unregister(t.id)}t()})}handleApplyWorkspaceEdit(e){let t=e.edit,n=new Map;i.workspace.textDocuments.forEach(e=>n.set(e.uri.toString(),e));let s=!1;if(t.documentChanges)for(const e of t.documentChanges)if(e.textDocument.version&&e.textDocument.version>=0){let t=n.get(e.textDocument.uri);if(t&&t.version!==e.textDocument.version){s=!0;break}}return s?Promise.resolve({applied:!1}):i.workspace.applyEdit(this._p2c.asWorkspaceEdit(e.edit)).then(e=>({applied:e}))}logFailedRequest(e,t){t instanceof s.ResponseError&&t.code===s.ErrorCodes.RequestCancelled||this.error(`Request ${e.method} failed.`,t)}}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class s extends i{constructor(){super([s._randomHex(),s._randomHex(),s._randomHex(),s._randomHex(),s._randomHex(),s._randomHex(),s._randomHex(),s._randomHex(),"-",s._randomHex(),s._randomHex(),s._randomHex(),s._randomHex(),"-","4",s._randomHex(),s._randomHex(),s._randomHex(),"-",s._oneOf(s._timeHighBits),s._randomHex(),s._randomHex(),s._randomHex(),"-",s._randomHex(),s._randomHex(),s._randomHex(),s._randomHex(),s._randomHex(),s._randomHex(),s._randomHex(),s._randomHex(),s._randomHex(),s._randomHex(),s._randomHex(),s._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return s._oneOf(s._chars)}}function r(){return new s}s._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],s._timeHighBits=["8","9","a","b"],t.empty=new i("00000000-0000-0000-0000-000000000000"),t.v4=r;const o=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function a(e){return o.test(e)}t.isUUID=a,t.parse=function(e){if(!a(e))throw new Error("invalid uuid");return new i(e)},t.generateUuid=function(){return r().asHex()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Trace=1]="Trace",e[e.Debug=2]="Debug",e[e.Info=3]="Info",e[e.Warning=4]="Warning",e[e.Error=5]="Error",e[e.Critical=6]="Critical",e[e.Off=7]="Off"}(t.LogLevel||(t.LogLevel={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(710),s=n(18),r=n(319),o=n(320),a=n(112),c=n(195),l=n(321),u=e=>{if(void 0===typeof e)return"<undefined>";if(null===typeof e)return"<null>";if("string"==typeof e)return`"${e}"`;if("number"==typeof e)return`#${e}`;if("boolean"==typeof e)return`${e}`;if(e instanceof Symbol)return e.toString();if(e instanceof Error)return l.errorToString(e);try{return d.stringify(e)}catch(t){try{return e.toString()}catch(e){return"<unknown type>"}}};class d{static formatDate(e,t){return i(e,t||"yyyy-mm-dd HH:MM:ss.l ",!0)}static formatEvent(e,t,n,i,s,...r){let o;switch(n){case a.LogLevel.Critical:o="C";break;case a.LogLevel.Error:o="E";break;case a.LogLevel.Warning:o="W";break;case a.LogLevel.Info:o="I";break;case a.LogLevel.Debug:o="V";break;default:o="?"}const c=null===e?"":d.formatDate(e);let l;return s.length>d.maxMessageLength&&(s=s.substr(0,d.maxMessageLength)+"..."),l=0!==i?`[${c}${t} ${o}] (${i}) ${s}`:`[${c}${t} ${o}] ${s}`,l+=r.map(u).map((e,t)=>`> object #${t}: ${e}`).join("\n"),l}static parseEventId(e){let t=e.match(/\] \(([0-9]+)\)/);return t?parseInt(t[1],10):0}static formatPath(e){if(!e)return"<null>";if(o.LoggerSettings.disableObfuscation)return e;const t=r.Privacy.getShortHash(s.dirname(e)),n=s.extname(e),i=r.Privacy.getShortHash(s.basename(e,n)),a=e.replace("\\","/").indexOf("/");return 2===a&&":"===e[1]?`<?:${e[2]}${t}${e[2]}${i}${n}>`:0===a?`<${e[0]}${t}${e[0]}${i}${n}>`:a>0?`<${t}${e[a]}${i}${n}>`:`<${i}${n}>`}static formatEmail(e){if(!e)return"<null>";if(o.LoggerSettings.disableObfuscation)return e;const t=r.Privacy.getShortHash(e);return`<${t.substr(0,4)}@${t.substr(4)}>`}static formatText(e){if(!e)return"<null>";if(o.LoggerSettings.disableObfuscation)return e;const t=r.Privacy.getShortHash(e);return`<${e.length}:${t}>`}static stringify(e){return o.LoggerSettings.disableObfuscation?JSON.stringify(e,null,2):JSON.stringify(e,(e,t)=>{if(t instanceof Error)return l.errorToString(t);const n=o.LoggerSettings.obfuscateProperties[e];if(n)switch(n){case c.LogValueType.Text:return d.formatText(t);case c.LogValueType.Email:return d.formatEmail(t);case c.LogValueType.Path:return d.formatPath(t)}return t},2)}}t.TraceFormat=d,d.maxMessageLength=5120},function(e,t){t.getArg=function(e,t,n){if(t in e)return e[t];if(3===arguments.length)return n;throw new Error('"'+t+'" is a required argument.')};var n=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,i=/^data:.+\,.+$/;function s(e){var t=e.match(n);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}function r(e){var t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}function o(e){var n=e,i=s(e);if(i){if(!i.path)return e;n=i.path}for(var o,a=t.isAbsolute(n),c=n.split(/\/+/),l=0,u=c.length-1;u>=0;u--)"."===(o=c[u])?c.splice(u,1):".."===o?l++:l>0&&(""===o?(c.splice(u+1,l),l=0):(c.splice(u,2),l--));return""===(n=c.join("/"))&&(n=a?"/":"."),i?(i.path=n,r(i)):n}function a(e,t){""===e&&(e="."),""===t&&(t=".");var n=s(t),a=s(e);if(a&&(e=a.path||"/"),n&&!n.scheme)return a&&(n.scheme=a.scheme),r(n);if(n||t.match(i))return t;if(a&&!a.host&&!a.path)return a.host=t,r(a);var c="/"===t.charAt(0)?t:o(e.replace(/\/+$/,"")+"/"+t);return a?(a.path=c,r(a)):c}t.urlParse=s,t.urlGenerate=r,t.normalize=o,t.join=a,t.isAbsolute=function(e){return"/"===e.charAt(0)||n.test(e)},t.relative=function(e,t){""===e&&(e="."),e=e.replace(/\/$/,"");for(var n=0;0!==t.indexOf(e+"/");){var i=e.lastIndexOf("/");if(i<0)return t;if((e=e.slice(0,i)).match(/^([^\/]+:\/)?\/*$/))return t;++n}return Array(n+1).join("../")+t.substr(e.length+1)};var c=!("__proto__"in Object.create(null));function l(e){return e}function u(e){if(!e)return!1;var t=e.length;if(t<9)return!1;if(95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(var n=t-10;n>=0;n--)if(36!==e.charCodeAt(n))return!1;return!0}function d(e,t){return e===t?0:null===e?1:null===t?-1:e>t?1:-1}t.toSetString=c?l:function(e){return u(e)?"$"+e:e},t.fromSetString=c?l:function(e){return u(e)?e.slice(1):e},t.compareByOriginalPositions=function(e,t,n){var i=d(e.source,t.source);return 0!==i||0!==(i=e.originalLine-t.originalLine)||0!==(i=e.originalColumn-t.originalColumn)||n||0!==(i=e.generatedColumn-t.generatedColumn)||0!==(i=e.generatedLine-t.generatedLine)?i:d(e.name,t.name)},t.compareByGeneratedPositionsDeflated=function(e,t,n){var i=e.generatedLine-t.generatedLine;return 0!==i||0!==(i=e.generatedColumn-t.generatedColumn)||n||0!==(i=d(e.source,t.source))||0!==(i=e.originalLine-t.originalLine)||0!==(i=e.originalColumn-t.originalColumn)?i:d(e.name,t.name)},t.compareByGeneratedPositionsInflated=function(e,t){var n=e.generatedLine-t.generatedLine;return 0!==n||0!==(n=e.generatedColumn-t.generatedColumn)||0!==(n=d(e.source,t.source))||0!==(n=e.originalLine-t.originalLine)||0!==(n=e.originalColumn-t.originalColumn)?n:d(e.name,t.name)},t.parseSourceMapInput=function(e){return JSON.parse(e.replace(/^\)]}'[^\n]*\n/,""))},t.computeSourceURL=function(e,t,n){if(t=t||"",e&&("/"!==e[e.length-1]&&"/"!==t[0]&&(e+="/"),t=e+t),n){var i=s(n);if(!i)throw new Error("sourceMapURL could not be parsed");if(i.path){var c=i.path.lastIndexOf("/");c>=0&&(i.path=i.path.substring(0,c+1))}t=a(r(i),t)}return o(t)}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";function i(e){return"string"==typeof e||e instanceof String}function s(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=function(e){return!0===e||!1===e},t.string=i,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=s,t.stringArray=function(e){return s(e)&&e.every(e=>i(e))}},function(e,t){t.endianness=function(){return"LE"},t.hostname=function(){return"undefined"!=typeof location?location.hostname:""},t.loadavg=function(){return[]},t.uptime=function(){return 0},t.freemem=function(){return Number.MAX_VALUE},t.totalmem=function(){return Number.MAX_VALUE},t.cpus=function(){return[]},t.type=function(){return"Browser"},t.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},t.networkInterfaces=t.getNetworkInterfaces=function(){return{}},t.arch=function(){return"javascript"},t.platform=function(){return"browser"},t.tmpdir=t.tmpDir=function(){return"/tmp"},t.EOL="\n",t.homedir=function(){return"/"}},function(e,t,n){"use strict";var i=n(12),s=n(199),r=n(203),o=n(204),a=n(65);function c(e){a.call(this,"digest"),this._hash=e}i(c,a),c.prototype._update=function(e){this._hash.update(e)},c.prototype._final=function(){return this._hash.digest()},e.exports=function(e){return"md5"===(e=e.toLowerCase())?new s:"rmd160"===e||"ripemd160"===e?new r:new c(o(e))}},function(e,t,n){(function(e){function n(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===n(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===n(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===n(e)},t.isError=function(e){return"[object Error]"===n(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=e.isBuffer}).call(this,n(3).Buffer)},function(e,t,n){(function(t){e.exports=function(e,n){for(var i=Math.min(e.length,n.length),s=new t(i),r=0;r<i;++r)s[r]=e[r]^n[r];return s}}).call(this,n(3).Buffer)},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";var i=n(48),s=n(38);function r(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}t.BlockHash=r,r.prototype.update=function(e,t){if(e=i.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var n=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-n,e.length),0===this.pending.length&&(this.pending=null),e=i.join32(e,0,e.length-n,this.endian);for(var s=0;s<e.length;s+=this._delta32)this._update(e,s,s+this._delta32)}return this},r.prototype.digest=function(e){return this.update(this._pad()),s(null===this.pending),this._digest(e)},r.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,n=t-(e+this.padLength)%t,i=new Array(n+this.padLength);i[0]=128;for(var s=1;s<n;s++)i[s]=0;if(e<<=3,"big"===this.endian){for(var r=8;r<this.padLength;r++)i[s++]=0;i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=e>>>24&255,i[s++]=e>>>16&255,i[s++]=e>>>8&255,i[s++]=255&e}else for(i[s++]=255&e,i[s++]=e>>>8&255,i[s++]=e>>>16&255,i[s++]=e>>>24&255,i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=0,r=8;r<this.padLength;r++)i[s++]=0;return i}},function(e,t,n){var i=t;i.bignum=n(25),i.define=n(797).define,i.base=n(124),i.constants=n(357),i.decoders=n(802),i.encoders=n(804)},function(e,t,n){var i=t;i.Reporter=n(799).Reporter,i.DecoderBuffer=n(356).DecoderBuffer,i.EncoderBuffer=n(356).EncoderBuffer,i.Node=n(800)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(91);t.BaseError=i.BaseError;var s=n(818);t.AggregateError=s.AggregateError;var r=n(364);t.AssertionError=r.AssertionError;var o=n(366);t.PromiseRaceError=o.PromiseRaceError;var a=n(367);t.CancellationError=a.CancellationError;var c=n(819);t.NotImplementedError=c.NotImplementedError;var l=n(820);t.AuthenticationError=l.AuthenticationError},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6),s=n(8);function r(e){return`on${e.substr(0,1).toUpperCase()}${e.substr(1)}`}t.getEventPropertyName=r,t.onAllEvents=function(e,t,n){const s=[];for(const i of t){const t=e[r(i)];s.push(t(e=>n(i,e)))}return i.createDisposable(()=>{s.forEach(e=>e.dispose())})},t.notifyConnections=function(e,t,n,i){e.forEach(s=>{try{s.sendNotification(t,n)}catch(n){null==i||i.error(`failed to send notification method:${t} index:${e.indexOf(s)}`)}})};t.WrappedMessageReader=class{constructor(e,t){this.messageReader=e,this.messageTransformer=t,this.onError=this.messageReader.onError,this.onClose=this.messageReader.onClose,this.onPartialMessage=this.messageReader.onPartialMessage}listen(e){this.messageReader.listen(t=>{e(this.messageTransformer(t))})}dispose(){this.messageReader.dispose()}};t.WrappedMessageWriter=class{constructor(e,t){this.messageWriter=e,this.messageTransformer=t,this.onError=this.messageWriter.onError,this.onClose=this.messageWriter.onClose}write(e){this.messageWriter.write(this.messageTransformer(e))}dispose(){this.messageWriter.dispose()}};t.TimingFilter=class{constructor(){this.times=new Map}filter(e,t){if("number"!=typeof t.id)return t;if(this.times.has(t.id)){const n=Date.now()-this.times.get(t.id);this.times.delete(t.id),(e||void 0!==t.times)&&(t.times=o.addTime(t.times,n))}else this.times.set(t.id,Date.now());return t}};class o{static addTime(e,t){void 0===e&&(e=[]);const n=t-o.getTotalTime(e);return e.push(n>0?n:0),e}static getLatency(e){let t=0;if(e)for(let n=1;n<e.length;n+=2)t+=e[n];return t}static getProcessingTime(e){let t=0;if(e)for(let n=0;n<e.length;n+=2)t+=e[n];return t}static getTotalTime(e){return o.getLatency(e)+o.getProcessingTime(e)}}t.TimedRpcMessageUtils=o,t.addContextToRpcMessage=function(e){if(!e)return e;const t=e.context,n=e.params;return"object"!=typeof t||"object"!=typeof n||Array.isArray(n)||n.context?e:Object.assign({},e,{params:Object.assign({context:t},n)})};t.RpcRequestsWithContext=class{constructor(){this.methods=new Set,this.readFilter=this.filterMessage.bind(this)}add(e){e&&this.methods.add(e)}filterMessage(e){const t=e;if(!t.method||!this.methods.has(t.method))return e;const n=e.context||{};return t.params?Array.isArray(t.params)&&t.params.push(n):t.params=[n],t}},t.createMethodNotFoundResponse=function(e){return new s.ResponseError(s.ErrorCodes.MethodNotFound,`method:${e} not supported`)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(220);t.setExtensionContext=e=>{t.extensionContext=e},t.getExtensionContext=()=>(i.throwNotInitialized(t.extensionContext),t.extensionContext)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(19);t.traceSource=new i.TraceSource("Client")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileAccess=new class{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(7),s=n(19),r=n(13),o=n(15);class a{static initialize(){if(r.Settings.get(o.SettingKeys.performanceLogging)){const e="Live Share: Performance";this.perfLogger=i.traceSource.withName(e);const t=new s.OutputTraceListener(e);this.perfLogger.addTraceListener(t),t.addOutputChannel(!0)}a.start("extension:start")}static start(e,t){const n=a.getTime();this.originTime||(this.originTime=n),this.timings.set(e,n);const i=t?`${t} ${e}`:e;this.markTime(i,n)}static stop(e,t,n){var i;let s=this.timings.get(e);if(this.timings.delete(e),!s)return;const r=a.getTime(),o=r-s,c=t?`${t} ${e}`:e,l=n?`${n} `:"";null===(i=this.perfLogger)||void 0===i||i.verbose(`${c}, Since start: (${r-a.originTime}ms) Completed ${l}(${o}ms)`)}static markTime(e,t){var n;const i=t||a.getTime();null===(n=this.perfLogger)||void 0===n||n.verbose(`${e} starting, Since start: (${i-a.originTime}ms)`)}static async timeIt(e,t){this.start(e);const n=await t();return this.stop(e),n}static getTime(){return(new Date).getTime()}}t.TimeTracker=a,a.timings=new Map},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshSessionConfiguration=t.SshProtocolExtensionNames=void 0;const i=n(98),s=n(436),r=n(135),o=n(258);var a;!function(e){e.serverSignatureAlgorithms="server-sig-algs",e.openChannelRequest="open-channel-request@microsoft.com",e.sessionReconnect="session-reconnect@microsoft.com",e.sessionLatency="session-latency@microsoft.com"}(a=t.SshProtocolExtensionNames||(t.SshProtocolExtensionNames={}));t.SshSessionConfiguration=class{constructor(e=!0){this.protocolExtensions=[],this.services=new Map,this.keyExchangeAlgorithms=[],this.publicKeyAlgorithms=[],this.encryptionAlgorithms=[],this.hmacAlgorithms=[],this.compressionAlgorithms=[],this.maxClientAuthenticationAttempts=5,this.enableKeyExchangeGuess=!1,this.keyRotationThreshold=536870912,this.protocolExtensions.push(a.serverSignatureAlgorithms),this.protocolExtensions.push(a.openChannelRequest),this.services.set(s.KeyExchangeService,null),this.services.set(r.ConnectionService,null),this.services.set(o.AuthenticationService,null),e?(this.keyExchangeAlgorithms.push(i.SshAlgorithms.keyExchange.ecdhNistp384Sha384),this.keyExchangeAlgorithms.push(i.SshAlgorithms.keyExchange.ecdhNistp256Sha256),this.keyExchangeAlgorithms.push(i.SshAlgorithms.keyExchange.dhGroup16Sha512),this.keyExchangeAlgorithms.push(i.SshAlgorithms.keyExchange.dhGroup14Sha256),this.publicKeyAlgorithms.push(i.SshAlgorithms.publicKey.rsaWithSha512),this.publicKeyAlgorithms.push(i.SshAlgorithms.publicKey.rsaWithSha256),this.publicKeyAlgorithms.push(i.SshAlgorithms.publicKey.ecdsaSha2Nistp384),this.publicKeyAlgorithms.push(i.SshAlgorithms.publicKey.ecdsaSha2Nistp256),this.encryptionAlgorithms.push(i.SshAlgorithms.encryption.aes256Gcm),this.encryptionAlgorithms.push(i.SshAlgorithms.encryption.aes256Ctr),this.hmacAlgorithms.push(i.SshAlgorithms.hmac.hmacSha512Etm),this.hmacAlgorithms.push(i.SshAlgorithms.hmac.hmacSha256Etm),this.hmacAlgorithms.push(i.SshAlgorithms.hmac.hmacSha512),this.hmacAlgorithms.push(i.SshAlgorithms.hmac.hmacSha256)):(this.keyExchangeAlgorithms.push(i.SshAlgorithms.keyExchange.none),this.publicKeyAlgorithms.push(i.SshAlgorithms.publicKey.none),this.encryptionAlgorithms.push(i.SshAlgorithms.encryption.none),this.hmacAlgorithms.push(i.SshAlgorithms.hmac.none)),this.compressionAlgorithms.push(i.SshAlgorithms.compression.none)}addService(e,t){if(this.services.has(e))throw new Error("Duplicate service entry.");this.services.set(e,t)}getKeyExchangeAlgorithm(e){return this.getAlgorithm(e,this.keyExchangeAlgorithms)}getPublicKeyAlgorithm(e){return this.getAlgorithm(e,this.publicKeyAlgorithms)}getEncryptionAlgorithm(e){return this.getAlgorithm(e,this.encryptionAlgorithms)}getHmacAlgorithm(e){return this.getAlgorithm(e,this.hmacAlgorithms)}getCompressionAlgorithm(e){return this.getAlgorithm(e,this.compressionAlgorithms)}getAlgorithm(e,t){const n=t.find(t=>!!t&&t.name===e);if(!n){if("none"===e)return null;throw new Error("Algorithm not found: "+e)}return n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PublicKeyAlgorithm=void 0;const i=n(3),s=n(36);t.PublicKeyAlgorithm=class{constructor(e,t,n){this.name=e,this.keyAlgorithmName=t,this.hashAlgorithmName=n}readSignatureData(e){const t=new s.SshDataReader(e),n=t.readString("ascii");if(n!==this.name)throw new Error("Mismatched public key algorithm: "+`got '${n}', expected '${this.name}'.`);return t.readBinary()}createSignatureData(e){const t=new s.SshDataWriter(i.Buffer.alloc(this.name.length+e.length+20));return t.writeString(this.name,"ascii"),t.writeBinary(e),t.toBuffer()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshSession=void 0;const i=n(44),s=n(3),r=n(8),o=n(131),a=n(255),c=n(439),l=n(1011),u=n(436),d=n(99),h=n(135),f=n(258),p=n(257),m=n(80),g=n(441),y=n(52),v=n(442),S=n(81),_=n(443),E=n(256),w=n(98),b=n(82),C=n(45),T=n(134);class M{constructor(e,t){if(this.config=e,this.remoteVersion=null,this.activatedServices=new Map,this.connectionService=null,this.requestHandler=null,this.blockedMessages=[],this.blockedMessagesSemaphore=new T.Semaphore(1),this.connected=!1,this.disposed=!1,this.metrics=new v.SessionMetrics,this.reconnecting=!1,this.sessionId=null,this.principalValue=null,this.authenticatingEmitter=new r.Emitter,this.onAuthenticating=this.authenticatingEmitter.event,this.closedEmitter=new r.Emitter,this.onClosed=this.closedEmitter.event,this.disconnectedEmitter=new r.Emitter,this.onDisconnected=this.disconnectedEmitter.event,this.serviceActivatedEmitter=new r.Emitter,this.onServiceActivated=this.serviceActivatedEmitter.event,this.channelOpeningEmitter=new r.Emitter,this.onChannelOpening=this.channelOpeningEmitter.event,this.requestEmitter=new r.Emitter,this.onRequest=this.requestEmitter.event,!e)throw new TypeError("Session configuration is required.");if(e.keyExchangeAlgorithms.find(e=>!!e))this.kexService=new u.KeyExchangeService(this,null!=t&&t);else{if(e.encryptionAlgorithms.length>0&&e.encryptionAlgorithms.indexOf(null)<0)throw new Error("Encryption requires a key-exchange algorithm to be configured.");if(e.hmacAlgorithms.length>0&&e.hmacAlgorithms.indexOf(null)<0)throw new Error("HMAC requires a key-exchange algorithm to be configured.");if(e.publicKeyAlgorithms.length>0&&e.publicKeyAlgorithms.indexOf(null)<0)throw new Error("Host authentication requires a key-exchange algorithm to be configured.");this.kexService=null}}get algorithms(){return this.protocol?this.protocol.algorithms:null}get principal(){return this.principalValue}set principal(e){this.principalValue=e}get isConnected(){return this.connected}get isClosed(){return this.disposed}get services(){return[...this.activatedServices.values()]}get channels(){var e,t;return null!==(t=null===(e=this.connectionService)||void 0===e?void 0:e.channels)&&void 0!==t?t:[]}get protocolExtensions(){var e;return(null===(e=this.protocol)||void 0===e?void 0:e.extensions)||null}getService(e){const t=this.activatedServices.get(e);return t||null}activateService(e){let t;if("function"==typeof e)t=e;else{let n=e;if(t=(0,d.findService)(this.config.services,e=>e.serviceRequest===n),!t)return null}let n=this.activatedServices.get(t);if(!n){if(!this.config.services.has(t))throw new Error(`Service type not configured: ${t.name}`);n=new t(this,this.config.services.get(t)),t===h.ConnectionService&&(this.connectionService=n),this.activatedServices.set(t,n),this.serviceActivatedEmitter.fire(n)}return n}async connect(e,t){if(!e)throw new TypeError("A session stream is required.");if(this.disposed)throw new C.ObjectDisposedError(this);this.connectPromise||(this.connectPromise=this.doConnect(e,t)),await this.connectPromise}async doConnect(e,t){(0,i.trace)(`${this} ${this.reconnecting?"re":""}connecting...`),this.protocol=new l.SshProtocol(e,this.config,this.metrics),this.protocol.kexService=this.kexService,await this.exchangeVersions(t),this.kexService?await this.encrypt(t):(await(0,b.withCancellation)(this.versionExchangePromise,t),this.connected=!0),this.processMessages().catch(e=>{(0,i.trace)(`Unhandled error processing messages: ${e.message||JSON.stringify(e)}`)})}async exchangeVersions(e){const t=this.protocol.writeProtocolVersion(M.localVersion.toString(),e),n=this.protocol.readProtocolVersion(e);this.versionExchangePromise=n.then(async e=>{let t;(0,i.trace)(`Local version: ${M.localVersion}, remote version: ${e}`);const n=c.SshVersionInfo.tryParse(e);if(n){if(this.remoteVersion=n,"2.0"===n.protocolVersion)return;t=`Remote SSH version ${this.remoteVersion} is not supported. `+"This library only supports SSH v2.0."}else t=`Could not parse remote SSH version ${e}`;await this.close(y.SshDisconnectReason.protocolVersionNotSupported,t,new Error(t))}),await t}async encrypt(e){var t,n;const s=this.protocol;if(!s)throw new C.ObjectDisposedError(this);await s.considerReExchange(!0,e),await(0,b.withCancellation)(this.versionExchangePromise,e),this.connected=!0;let r=null;for(;!(this.isClosed||(null===(t=this.protocol)||void 0===t?void 0:t.algorithms)||r instanceof y.DisconnectMessage)&&(r=await s.receiveMessage(e),r);)await this.dispatchMessage(r,e);if(!(null===(n=this.protocol)||void 0===n?void 0:n.algorithms))throw new C.SshConnectionError("Session closed while encrypting.",y.SshDisconnectReason.connectionLost);this.protocol.algorithms.cipher&&(0,i.trace)(`${this} encrypted.`)}async processMessages(){var e;for(this.connected=!0;!this.disposed;){const t=this.protocol;if(!t)break;let n=null;try{n=await t.receiveMessage()}catch(t){if(!(t instanceof Error))throw t;let n=y.SshDisconnectReason.protocolError;t instanceof C.SshConnectionError?n=null!==(e=t.reason)&&void 0!==e?e:n:(0,i.trace)(`Error receiving message: ${t.message||JSON.stringify(t)}`),await this.close(n,t.message,t)}if(!n){await this.close(y.SshDisconnectReason.connectionLost,"Connection lost.");break}try{await this.dispatchMessage(n)}catch(e){if(!(e instanceof Error))throw e;(0,i.trace)(`Error handling ${n}: ${e.message||JSON.stringify(e)}`),await this.close(y.SshDisconnectReason.protocolError,e.message,e)}}this.connected=!1}get canAcceptRequests(){var e;return!(this.kexService&&(!(null===(e=this.protocol)||void 0===e?void 0:e.algorithms)||this.protocol.algorithms.cipher&&!this.principal))}async sendMessage(e,t){var n,s;if(!e)throw new TypeError("Message expected.");if(t&&t.isCancellationRequested)throw new b.CancellationError;const r=this.protocol;if(!r||this.disposed)throw new C.ObjectDisposedError(this);if(this.kexService&&this.kexService.exchanging&&e.messageType>4&&(e.messageType<20||e.messageType>49))return void this.blockedMessages.push(e);let a;await this.blockedMessagesSemaphore.wait(t);try{a=await r.sendMessage(e,t),this.blockedMessagesSemaphore.release()}catch(t){if(this.blockedMessagesSemaphore.release(),t instanceof C.SshConnectionError){if(t.reason===y.SshDisconnectReason.connectionLost&&(null===(n=this.protocolExtensions)||void 0===n?void 0:n.has(o.SshProtocolExtensionNames.sessionReconnect)))return}if(!(t instanceof Error))throw t;throw(0,i.trace)(`Error sending ${e}: ${t.message||JSON.stringify(t)}`),t}if(!a&&!(null===(s=this.protocolExtensions)||void 0===s?void 0:s.has(o.SshProtocolExtensionNames.sessionReconnect)))throw new C.SshConnectionError("Session disconnected.",y.SshDisconnectReason.connectionLost)}dispatchMessage(e,t){var n;return e instanceof m.ConnectionMessage&&this.connectionService?this.connectionService.handleMessage(e,t):e instanceof p.NewKeysMessage?this.handleNewKeysMessage(e,t):e instanceof p.KeyExchangeMessage?this.handleKeyExchangeMessage(e,t):e instanceof g.AuthenticationMessage?null===(n=this.getService(f.AuthenticationService))||void 0===n?void 0:n.handleMessage(e,t):e instanceof y.ServiceRequestMessage?this.handleServiceRequestMessage(e,t):e instanceof y.ServiceAcceptMessage?this.handleServiceAcceptMessage(e,t):e instanceof y.SessionRequestMessage?this.handleRequestMessage(e,t):e instanceof y.SessionRequestSuccessMessage?this.handleRequestSuccessMessage(e):e instanceof y.SessionRequestFailureMessage?this.handleRequestFailureMessage(e):e instanceof y.ExtensionInfoMessage?this.handleExtensionInfoMessage(e,t):e instanceof y.UnimplementedMessage?this.handleUnimplementedMessage(e,t):e instanceof y.DebugMessage?this.handleDebugMessage(e):void 0}async handleRequestMessage(e,t){var n;let s=!1;if("initial-channel-request@microsoft.com"===e.requestType&&this.config.protocolExtensions.includes(o.SshProtocolExtensionNames.openChannelRequest)){const n=e.convertTo(new y.SessionChannelRequestMessage),i=n.senderChannel,r=this.channels.find(e=>e.remoteChannelId===i);r&&n.request&&(n.request.wantReply=!1,s=await r.handleRequest(n.request,t))}else if("enable-session-reconnect@microsoft.com"===e.requestType&&(null===(n=this.config.protocolExtensions)||void 0===n?void 0:n.includes(o.SshProtocolExtensionNames.sessionReconnect)))this.protocol.incomingMessagesHaveReconnectInfo||(this.protocol.incomingMessagesHaveReconnectInfo=!0,this.protocol.incomingMessagesHaveLatencyInfo=this.protocol.extensions.has(o.SshProtocolExtensionNames.sessionLatency),s=!0);else if(this.canAcceptRequests){const n=new E.SshRequestEventArgs(e.requestType||"",e,this.principal),i=(0,d.findService)(this.config.services,t=>t.sessionRequest===e.requestType);if(i){const e=this.activateService(i);return void await e.onSessionRequest(n,t)}this.raiseSessionRequest(n),s=n.isAuthorized||!1}else(0,i.trace)("Session request blocked because the session is not yet authenticated."),s=!1;e.wantReply&&await this.sendMessage(s?new y.SessionRequestSuccessMessage:new y.SessionRequestFailureMessage,t)}raiseSessionRequest(e){this.requestEmitter.fire(e)}async handleServiceRequestMessage(e,t){}async handleServiceAcceptMessage(e,t){}async handleKeyExchangeMessage(e,t){if(!this.kexService){if(!(e instanceof p.KeyExchangeInitMessage&&this.protocol))return void await this.close(y.SshDisconnectReason.keyExchangeFailed);this.kexService=this.activateService(u.KeyExchangeService),this.protocol.kexService=this.kexService,await this.protocol.considerReExchange(!0,t)}return this.kexService.handleMessage(e,t)}async handleNewKeysMessage(e,t){try{await this.blockedMessagesSemaphore.wait(t),await this.protocol.handleNewKeys(t);try{for(;this.blockedMessages.length>0;){const e=this.blockedMessages.shift();if(!this.protocol)throw new C.ObjectDisposedError(this);await this.protocol.sendMessage(e,t)}}catch(e){if(!(e instanceof Error))throw e;await this.close(y.SshDisconnectReason.protocolError,void 0,e)}}finally{this.blockedMessagesSemaphore.release()}}async handleUnimplementedMessage(e,t){void 0!==e.unimplementedMessageType&&await this.sendMessage(e,t)}handleDebugMessage(e){e.message&&(0,i.trace)(e.message)}async raiseAuthenticatingEvent(e){(0,i.trace)(`${this} Authenticating(${e})`),this.authenticatingEmitter.fire(e);let t=e.authenticationPromise;return t||(t=Promise.resolve(null)),await t}async request(e,t){if(!e)throw new TypeError("Request is required.");if(!e.wantReply)return await this.sendMessage(e,t),!0;return await this.requestResponse(e,y.SessionRequestSuccessMessage,y.SessionRequestFailureMessage,t)instanceof y.SessionRequestSuccessMessage}async requestResponse(e,t,n,i){if(!e)throw new TypeError("Request is required.");if(!t)throw new TypeError("Success response type is required.");if(!n)throw new TypeError("Failure response type is required.");if(this.requestHandler)throw new Error("Another request is already pending.");e.wantReply=!0;const s=new S.PromiseCompletionSource;if(i){if(i.isCancellationRequested)throw new b.CancellationError;i.onCancellationRequested(()=>{this.requestHandler=null,s.reject(new b.CancellationError)})}return this.requestHandler=(e,i)=>{var r,o;if(this.requestHandler=null,e)s.reject(e);else if(i instanceof y.SessionRequestFailureMessage){const e=null!==(r=null==i?void 0:i.convertTo(new n,!0))&&void 0!==r?r:null;s.resolve(e)}else if(i instanceof y.SessionRequestSuccessMessage){const e=null!==(o=null==i?void 0:i.convertTo(new t,!0))&&void 0!==o?o:null;s.resolve(e)}else s.reject(new Error("Unknown response message type."))},await this.sendMessage(e,i),await s.promise}handleRequestSuccessMessage(e){this.requestHandler&&this.requestHandler(void 0,e)}handleRequestFailureMessage(e){this.requestHandler&&this.requestHandler(void 0,e)}async acceptChannel(e,t){const n="string"==typeof e?e:void 0;t||"object"!=typeof e||(t=e),this.activateService(h.ConnectionService);const i=this.connectionService.acceptChannel(n||a.SshChannel.sessionChannelType,t);return await i}async openChannel(e,t,n){let i;if("string"==typeof e||null===e?(i=new m.ChannelOpenMessage,i.channelType=null!=e?e:a.SshChannel.sessionChannelType):e instanceof m.ChannelOpenMessage?i=e:(i=new m.ChannelOpenMessage,i.channelType=a.SshChannel.sessionChannelType,n=e),t instanceof m.ChannelRequestMessage)return await this.openChannelWithInitialRequest(i,t,n);n||null===t||(n=t),this.activateService(h.ConnectionService);const s=new S.PromiseCompletionSource;return await this.connectionService.openChannel(i,s,n),await s.promise}async openChannelWithInitialRequest(e,t,n){var i;this.activateService(h.ConnectionService);const s=new S.PromiseCompletionSource,r=await this.connectionService.openChannel(e,s,n);if(n){if(n.isCancellationRequested)throw new b.CancellationError;n.onCancellationRequested(()=>s.reject(new b.CancellationError))}let a,c;const l=this.config.protocolExtensions.includes(o.SshProtocolExtensionNames.openChannelRequest)&&(null===(i=this.protocolExtensions)||void 0===i?void 0:i.has(o.SshProtocolExtensionNames.openChannelRequest));if(!1===l)a=await s.promise,c=await a.request(t,n);else{const e=t.wantReply||void 0===l,i=new y.SessionChannelRequestMessage;i.requestType="initial-channel-request@microsoft.com",i.senderChannel=r,i.request=t,i.wantReply=e;const o=this.request(i,n);a=await s.promise,e?(c=await o,c||void 0!==l||(c=await a.request(t))):c=!0}if(!c)throw await a.close(),new Error("The initial channel request was denied.");return a}async handleChannelOpening(e,t){const n=(0,d.findService)(this.config.services,t=>t.channelType===e.channel.channelType&&!t.channelRequest);if(n){const i=this.activateService(n);await i.onChannelOpening(e,t)}else this.raiseChannelOpening(e)}raiseChannelOpening(e){this.channelOpeningEmitter.fire(e)}async sendExtensionInfo(e){const t=new y.ExtensionInfoMessage;t.extensionInfo={};for(let e of this.config.protocolExtensions)if(e===o.SshProtocolExtensionNames.serverSignatureAlgorithms){const n=Array.from(new Set((0,w.algorithmNames)(this.config.publicKeyAlgorithms))).join(",");t.extensionInfo[e]=n}else t.extensionInfo[e]="";await this.sendMessage(t,e)}async handleExtensionInfoMessage(e,t){if(!this.protocol)return;if(this.protocol.extensions=new Map,e.extensionInfo){for(let t of this.config.protocolExtensions){const n=e.extensionInfo[t];"string"==typeof n&&this.protocol.extensions.set(t,n)}this.protocol.extensions.has(o.SshProtocolExtensionNames.sessionReconnect)&&await this.enableReconnect(t)}}async close(e,t,n){var s,r,o;if(!this.disposed&&this.connected){if(this.connected=!1,(0,i.trace)(`${this} Close(${y.SshDisconnectReason[e]}, "${t||""}")`),e!==y.SshDisconnectReason.connectionLost)try{const n=new y.DisconnectMessage;n.reasonCode=e,n.description=t||"",await(null===(s=this.protocol)||void 0===s?void 0:s.sendMessage(n))}catch(e){}else if(this.handleDisconnected())return null===(r=this.protocol)||void 0===r||r.dispose(),(0,i.trace)(`${this} disconnected.`),void this.disconnectedEmitter.fire();this.disposed=!0,n&&(null===(o=this.connectionService)||void 0===o||o.close(n)),this.closedEmitter.fire(new _.SshSessionClosedEventArgs(e,t||"Disconnected.",n||null)),this.dispose()}}handleDisconnected(){var e,t;return this.connectPromise=void 0,null===(e=this.kexService)||void 0===e||e.abortKeyExchange(),!!(null===(t=this.protocolExtensions)||void 0===t?void 0:t.has(o.SshProtocolExtensionNames.sessionReconnect))}dispose(){var e,t;this.disposed||((0,i.trace)(`${this} disposed.`),this.disposed=!0,this.closedEmitter.fire(new _.SshSessionClosedEventArgs(y.SshDisconnectReason.none,"SshSession disposed",null))),this.requestHandler&&this.requestHandler(new C.SshConnectionError("Connection closed.")),this.metrics.close(),null===(e=this.connectionService)||void 0===e||e.dispose();for(let e of this.activatedServices.values())e!==this.connectionService&&e.dispose();this.activatedServices.clear(),null===(t=this.protocol)||void 0===t||t.dispose(),this.protocol=void 0}async enableReconnect(e){var t;try{if(await this.blockedMessagesSemaphore.wait(),null===(t=this.kexService)||void 0===t?void 0:t.exchanging)(0,i.trace)("Failed to initialize session reconnect because a key-exchange was in-progress.");else{const t=new y.SessionRequestMessage("enable-session-reconnect@microsoft.com",!1);await this.protocol.sendMessage(t,e),this.protocol&&(this.protocol.outgoingMessagesHaveReconnectInfo=!0,this.protocol.outgoingMessagesHaveLatencyInfo=this.protocol.extensions.has(o.SshProtocolExtensionNames.sessionLatency))}this.blockedMessagesSemaphore.release()}catch(e){throw this.blockedMessagesSemaphore.release(),e instanceof Error&&await this.close(y.SshDisconnectReason.protocolError,void 0,e),e}}async createReconnectToken(e,t){return await this.algorithms.signer.sign(s.Buffer.concat([e,t]))}async verifyReconnectToken(e,t,n){return await this.algorithms.verifier.verify(s.Buffer.concat([e,t]),n)}toString(){return this.constructor.name}}t.SshSession=M,M.localVersion=c.SshVersionInfo.getLocalVersion()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Semaphore=void 0;const i=n(81),s=n(82),r=n(45);t.Semaphore=class{constructor(e=0){this.completions=[],this.disposed=!1,this.count=e}get currentCount(){return this.count}release(e=1){if(this.disposed)throw new r.ObjectDisposedError(this);const t=this.count;for(;e>0;e--)if(this.completions.length>0){this.completions.shift().resolve(!0)}else this.count++;return t}tryRelease(){try{this.release()}catch(e){if(!(e instanceof r.ObjectDisposedError))throw e}}async wait(e,t){const n="number"==typeof e?e:void 0;if(void 0===t&&"object"==typeof e&&(t=e),this.disposed)throw new r.ObjectDisposedError(this);if(null==t?void 0:t.isCancellationRequested)throw new s.CancellationError;if(this.count>0)return this.count--,!0;if(0===n)return!1;{const e=new i.PromiseCompletionSource;this.completions.push(e);const r=[e.promise];if(n&&r.push(new Promise(e=>setTimeout(()=>e(!1),n))),t){const e=new i.PromiseCompletionSource;t.onCancellationRequested(()=>{e.reject(new s.CancellationError)}),r.push(e.promise)}if(await Promise.race(r))return!0;{const t=this.completions.indexOf(e);return t>=0&&this.completions.splice(t,1),!1}}}dispose(){if(!this.disposed){this.disposed=!0;for(let e of this.completions)e.reject(new r.ObjectDisposedError(this));this.completions.splice(0,this.completions.length),this.count=0}}}},function(e,t,n){"use strict";var i,s=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionService=void 0;const r=n(44),o=n(174),a=n(80),c=n(81),l=n(255),u=n(82),d=n(45),h=n(440),f=n(99);let p=i=class extends o.SshService{constructor(e){super(e),this.channelCounter=0,this.channelMap=new Map,this.nonAcceptedChannels=new Map,this.pendingChannels=new Map,this.pendingAcceptChannels=new Map}get channels(){return Array.from(this.channelMap.values())}close(e){for(let t of this.channelMap.values())t.close(e)}dispose(){const e=[...this.channelMap.values()];let t=[...this.pendingChannels.values()].map(e=>e.completionSource);this.pendingAcceptChannels.size>0&&(t=t.concat([...this.pendingAcceptChannels.values()].reduce((e,t)=>e.concat(t))));for(let t of e)t.dispose();for(let e of t)e.reject(new d.SshConnectionError("Session closed."));super.dispose()}async acceptChannel(e,t){const n=new c.PromiseCompletionSource;let i;if(t){if(t.isCancellationRequested)throw new u.CancellationError;i=t.onCancellationRequested(()=>{const t=this.pendingAcceptChannels.get(e);if(t){const e=t.findIndex(e=>Object.is(e,n));e>=0&&t.splice(e,1)}n.reject(new u.CancellationError)})}let s=null;if(s=Array.from(this.nonAcceptedChannels.values()).find(t=>t.channelType===e)||null,s)this.nonAcceptedChannels.delete(s.channelId);else{let t=this.pendingAcceptChannels.get(e);t||(t=[],this.pendingAcceptChannels.set(e,t)),t.push(n)}try{return s||await n.promise}finally{i&&i.dispose()}}async openChannel(e,t,n){const i=++this.channelCounter;e.senderChannel=i;let s=null;if(n){if(n.isCancellationRequested)throw new u.CancellationError;s=n.onCancellationRequested(()=>{this.pendingChannels.delete(i)&&t.reject(new u.CancellationError)})}return this.pendingChannels.set(i,{openMessage:e,completionSource:t,cancellationRegistration:s}),await this.session.sendMessage(e),i}handleMessage(e,t){if(e instanceof a.ChannelDataMessage)return this.handleDataMessage(e);if(e instanceof a.ChannelWindowAdjustMessage)return this.handleAdjustWindowMessage(e);if(e instanceof a.ChannelEofMessage)return this.handleEofMessage(e);if(e instanceof a.ChannelOpenMessage)return this.handleOpenMessage(e,t);if(e instanceof a.ChannelCloseMessage)return this.handleCloseMessage(e);if(e instanceof a.ChannelOpenConfirmationMessage)return this.handleOpenConfirmationMessage(e,t);if(e instanceof a.ChannelOpenFailureMessage)return this.handleOpenFailureMessage(e);if(e instanceof a.ChannelRequestMessage)return this.handleRequestMessage(e,t);if(e instanceof a.ChannelSuccessMessage)return this.handleSuccessMessage(e);if(e instanceof a.ChannelFailureMessage)return this.handleFailureMessage(e);throw new Error(`Message not implemented: ${e}`)}async handleOpenMessage(e,t){if(!this.session.canAcceptRequests){(0,r.trace)("Channel open request blocked because the session is not yet authenticated.");const n=new a.ChannelOpenFailureMessage;return n.recipientChannel=e.senderChannel,n.reasonCode=a.SshChannelOpenFailureReason.administrativelyProhibited,n.description="Authenticate before opening channels.",void await this.session.sendMessage(n,t)}if(!e.channelType){const n=new a.ChannelOpenFailureMessage;return n.recipientChannel=e.senderChannel,n.reasonCode=a.SshChannelOpenFailureReason.unknownChannelType,n.description="Channel type not specified.",void await this.session.sendMessage(n,t)}const n=new l.SshChannel(this,e.channelType,e.senderChannel,e.initialWindowSize,e.maximumPacketSize,++this.channelCounter),i=new h.SshChannelOpeningEventArgs(e,n,!0);try{await this.session.handleChannelOpening(i,t)}catch(e){throw n.dispose(),e}if(i.failureReason!==a.SshChannelOpenFailureReason.none){const e=new a.ChannelOpenFailureMessage;e.recipientChannel=n.remoteChannelId,e.reasonCode=i.failureReason,e.description=i.failureDescription||void 0;try{await this.session.sendMessage(e,t)}finally{n.dispose()}return}if(this.session.isClosed)return void n.dispose();this.channelMap.set(n.channelId,n);const s=new a.ChannelOpenConfirmationMessage;s.recipientChannel=n.remoteChannelId,s.senderChannel=n.channelId,s.initialWindowSize=e.initialWindowSize,s.maximumPacketSize=e.maximumPacketSize,await this.session.sendMessage(s,t);let o=!1;const c=this.pendingAcceptChannels.get(n.channelType);for(;c&&c.length>0;){c.shift().resolve(n),o=!0;break}o||this.nonAcceptedChannels.set(n.channelId,n),this.onChannelOpenCompleted(n.channelId,n),n.enableSending()}handleCloseMessage(e){const t=this.findChannelById(e.recipientChannel);t&&t.handleClose()}async handleOpenConfirmationMessage(e,t){var n;let i,s=null;const r=this.pendingChannels.get(e.recipientChannel);if(!r)throw this.channelMap.has(e.recipientChannel)?new Error("Duplicate channel ID."):new Error("Channel confirmation was not requested.");i=r.openMessage,s=r.completionSource,r.cancellationRegistration&&r.cancellationRegistration.dispose(),this.pendingChannels.delete(e.recipientChannel);const o=new l.SshChannel(this,i.channelType||l.SshChannel.sessionChannelType,e.senderChannel,e.initialWindowSize,e.maximumPacketSize,e.recipientChannel);this.channelMap.set(o.channelId,o);const c=new h.SshChannelOpeningEventArgs(i,o,!1);if(await this.session.handleChannelOpening(c,t),s){if(c.failureReason!==a.SshChannelOpenFailureReason.none)return void s.reject(new d.SshChannelError(null!==(n=c.failureDescription)&&void 0!==n?n:"Channel open failure.",c.failureReason));s.resolve(o)}else this.onChannelOpenCompleted(o.channelId,o);o.enableSending()}handleOpenFailureMessage(e){let t=null;const n=this.pendingChannels.get(e.recipientChannel);n&&(t=n.completionSource,n.cancellationRegistration&&n.cancellationRegistration.dispose(),this.pendingChannels.delete(e.recipientChannel)),null!=t?t.reject(new d.SshChannelError(e.description||"Channel open rejected.",e.reasonCode)):this.onChannelOpenCompleted(e.recipientChannel,null)}async handleRequestMessage(e,t){const n=this.findChannelById(e.recipientChannel);n?await n.handleRequest(e,t):(0,r.trace)(`Invalid channel ID ${e.recipientChannel} in channel request message.`)}handleSuccessMessage(e){const t=this.findChannelById(e.recipientChannel);t?t.handleResponse(!0):(0,r.trace)(`Invalid channel ID ${e.recipientChannel} in channel success message.`)}handleFailureMessage(e){const t=this.findChannelById(e.recipientChannel);t?t.handleResponse(!1):(0,r.trace)(`Invalid channel ID ${e.recipientChannel} in channel failure message.`)}handleDataMessage(e){const t=this.findChannelById(e.recipientChannel);if(t)return t.handleDataReceived(e.data)}handleAdjustWindowMessage(e){const t=this.findChannelById(e.recipientChannel);t&&t.adjustRemoteWindow(e.bytesToAdd)}handleEofMessage(e){const t=this.findChannelById(e.recipientChannel);t&&t.handleEof()}onChannelOpenCompleted(e,t){t?(0,r.trace)(`${this.session} ChannelOpenCompleted(${t})`):(0,r.trace)(`${this.session} ChannelOpenCompleted(${e} failed)`)}findChannelById(e){var t;return null!==(t=this.channelMap.get(e))&&void 0!==t?t:null}_removeChannel(e){this.channelMap.delete(e.channelId),this.pendingChannels.delete(e.channelId)}};p.serviceName="ssh-connection",p=i=s([(0,f.serviceActivation)({serviceRequest:i.serviceName})],p),t.ConnectionService=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(22);t.TreeDataProviderBase=class{constructor(e,t){this.id=e,this.supportedContext=t,this.isChildItemCacheDisabled=!1,this.changeEventEmitter=new i.EventEmitter,this.onDidChangeTreeData=this.changeEventEmitter.event}static getThemeIconPath(e){return{dark:s.ExtensionUtil.getExtensionUri(`images/dark/${e}.svg`),light:s.ExtensionUtil.getExtensionUri(`images/light/${e}.svg`)}}refresh(e){this.changeEventEmitter.fire(e)}getTreeItem(e){return e}async getChildren(e){if(e)return this.items&&!this.isChildItemCacheDisabled||(this.items=await this.getChildrenItems(e)),this.items;const t=await this.getRootItem();return t?[t]:[]}refreshItems(){this.items=void 0}forceRefreshItems(){this.refreshItems(),this.refresh()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(61),s=n(425),r=n(33);t.errorNotificationCommandDecorator=function(e,t,n=!1,o,a){return r.DecoratorHelper.setupDecorator(c=>new s.ErrorNotificationCommandDecorator(r.DecoratorHelper.getCoreCommand(c),c,i.dependencies.telemetry(),t,e,n,o,a))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6),s=n(8),r=n(265),o=n(139),a=n(454),c=n(63),l=n(266);class u extends i.DisposableClass{constructor(e,t,n={}){super(e),this.traceName=e,this.performance=t,this.options=n,this.isDisconnectedFlag=!1,this.isDisposingRef=!1,this.onConnectionChangedEventEmitter=new s.Emitter,this.connectionStatus="none",this.previousConnectionStatus="none",this.addToDisposables(this.onConnectionChangedEventEmitter)}get isDisconnected(){return this.isDisconnectedFlag}getId(e){throw new c.ConnectionError("Not implemented.")}get onConnectionChanged(){if(this.isDisposed)throw new a.ConnectionStateError("Cannot listen to `onConnectionChanged`, connection already disposed.");return this.onConnectionChangedEventEmitter.event}get isDisposing(){return this.isDisposingRef}get status(){return this.connectionStatus}get previousStatus(){return this.previousConnectionStatus}async connect(){var e,t;try{return this.trace.info("asked to connect"),(null===(e=this.connectionSignal)||void 0===e?void 0:e.isCancelled)||(null===(t=this.connectionSignal)||void 0===t?void 0:t.isRejected)?await this.connectionSignal.promise:(i.assert("disconnected"!==this.status,new a.ConnectionStateError("Connection already disconnected, please create a new one.")),i.assert(!this.isDisposed,new a.ConnectionStateError("Connection is already disposed, please create a new one.")),this.connectionSignal?(this.trace.info(`return promise, resolved: ${this.connectionSignal.isResolved}`),await this.connectionSignal.promise):(this.trace.info("creating new connection"),await this.createConnection()))}catch(e){throw this.handleConnectionError(e),o.errorToConnectionError(e)}}disconnect(e){return this.isDisconnectedFlag=!0,Promise.resolve(this.dispose(e))}dispose(e){return this.isDisposingRef=!0,this.isDisposed||(this.onConnectionChangedHandler("disconnected",new r.ConnectionCancellationError("Disposing the connection.")),super.dispose(e)),this}async connectWithTimeout(e){try{return this.trace.info(`asked to connect with timeout of ${e} ms`),isFinite(e)?await i.timeoutPromise(this.connect(),e,new l.ConnectionTimeoutError(`Could not establish connection in ${e}ms.`)):await this.connect()}catch(e){throw this.handleConnectionError(e),o.errorToConnectionError(e)}}onConnectionChangedHandler(e,t){if(e===this.connectionStatus)return;this.trace.info(`connection status changed: ${this.connectionStatus} -> ${e}, error:`,t),this.previousConnectionStatus=this.connectionStatus,this.connectionStatus=e;const n={status:e,previousStatus:this.previousConnectionStatus};this.trace.info("firing change event: ",n),this.onConnectionChangedEventEmitter.fire(n),i.assertDefined(this.connectionSignal,"No `connectionSignal` found."),this.connectionSignal.isFulfilled||("connected"===e&&(this.trace.info(" connected"),this.connectionSignal.resolve(this)),"disconnected"===e&&(this.trace.info("disconnected"),this.connectionSignal.reject(o.errorToConnectionError(null!=t?t:new c.ConnectionError("Connection failed.")))))}initializeConnection(){return this.trace.info("creating connection"),this.connectionSignal=new i.Signal,this.connectionSignal.promise.catch(e=>{this.trace.verbose(`signal rejected reason -> ${i.propertiesToString(e)}`)}),this.addToDisposables(this.connectionSignal),this.onConnectionChangedHandler("connecting"),this}async createConnection(){throw this.initializeConnection(),i.assertDefined(this.connectionSignal,new c.ConnectionError("No `connectionSignal` found.")),await this.connectionSignal.promise,new c.ConnectionError("Not implemented.")}handleConnectionError(e){var t;this.trace.error("connection failed: ",e),this.onConnectionChangedHandler("disconnected",e),null===(t=this.connectionSignal)||void 0===t||t.reject(o.errorToConnectionError(e)),this.dispose()}}t.Connection=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6),s=n(265),r=n(63);t.errorToConnectionError=e=>e instanceof r.ConnectionError?e:e instanceof i.CancellationError?new s.ConnectionCancellationError(e):new r.ConnectionError(e)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshSessionConfiguration=t.SshProtocolExtensionNames=void 0;const i=n(103),s=n(479),r=n(144),o=n(284);var a;!function(e){e.serverSignatureAlgorithms="server-sig-algs",e.openChannelRequest="open-channel-request@microsoft.com",e.sessionReconnect="session-reconnect@microsoft.com",e.sessionLatency="session-latency@microsoft.com"}(a=t.SshProtocolExtensionNames||(t.SshProtocolExtensionNames={}));t.SshSessionConfiguration=class{constructor(e=!0){this.protocolExtensions=[],this.services=new Map,this.keyExchangeAlgorithms=[],this.publicKeyAlgorithms=[],this.encryptionAlgorithms=[],this.hmacAlgorithms=[],this.compressionAlgorithms=[],this.maxClientAuthenticationAttempts=5,this.enableKeyExchangeGuess=!1,this.keyRotationThreshold=536870912,this.protocolExtensions.push(a.serverSignatureAlgorithms),this.protocolExtensions.push(a.openChannelRequest),this.services.set(s.KeyExchangeService,null),this.services.set(r.ConnectionService,null),this.services.set(o.AuthenticationService,null),e?(this.keyExchangeAlgorithms.push(i.SshAlgorithms.keyExchange.ecdhNistp384Sha384),this.keyExchangeAlgorithms.push(i.SshAlgorithms.keyExchange.ecdhNistp256Sha256),this.keyExchangeAlgorithms.push(i.SshAlgorithms.keyExchange.dhGroup16Sha512),this.keyExchangeAlgorithms.push(i.SshAlgorithms.keyExchange.dhGroup14Sha256),this.publicKeyAlgorithms.push(i.SshAlgorithms.publicKey.rsaWithSha512),this.publicKeyAlgorithms.push(i.SshAlgorithms.publicKey.rsaWithSha256),this.publicKeyAlgorithms.push(i.SshAlgorithms.publicKey.ecdsaSha2Nistp384),this.publicKeyAlgorithms.push(i.SshAlgorithms.publicKey.ecdsaSha2Nistp256),this.encryptionAlgorithms.push(i.SshAlgorithms.encryption.aes256Gcm),this.encryptionAlgorithms.push(i.SshAlgorithms.encryption.aes256Ctr),this.hmacAlgorithms.push(i.SshAlgorithms.hmac.hmacSha512Etm),this.hmacAlgorithms.push(i.SshAlgorithms.hmac.hmacSha256Etm),this.hmacAlgorithms.push(i.SshAlgorithms.hmac.hmacSha512),this.hmacAlgorithms.push(i.SshAlgorithms.hmac.hmacSha256)):(this.keyExchangeAlgorithms.push(i.SshAlgorithms.keyExchange.none),this.publicKeyAlgorithms.push(i.SshAlgorithms.publicKey.none),this.encryptionAlgorithms.push(i.SshAlgorithms.encryption.none),this.hmacAlgorithms.push(i.SshAlgorithms.hmac.none)),this.compressionAlgorithms.push(i.SshAlgorithms.compression.none)}addService(e,t){if(this.services.has(e))throw new Error("Duplicate service entry.");this.services.set(e,t)}getKeyExchangeAlgorithm(e){return this.getAlgorithm(e,this.keyExchangeAlgorithms)}getPublicKeyAlgorithm(e){return this.getAlgorithm(e,this.publicKeyAlgorithms)}getEncryptionAlgorithm(e){return this.getAlgorithm(e,this.encryptionAlgorithms)}getHmacAlgorithm(e){return this.getAlgorithm(e,this.hmacAlgorithms)}getCompressionAlgorithm(e){return this.getAlgorithm(e,this.compressionAlgorithms)}getAlgorithm(e,t){const n=t.find(t=>!!t&&t.name===e);if(!n){if("none"===e)return null;throw new Error("Algorithm not found: "+e)}return n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PublicKeyAlgorithm=void 0;const i=n(3),s=n(37);t.PublicKeyAlgorithm=class{constructor(e,t,n){this.name=e,this.keyAlgorithmName=t,this.hashAlgorithmName=n}readSignatureData(e){const t=new s.SshDataReader(e),n=t.readString("ascii");if(n!==this.name)throw new Error("Mismatched public key algorithm: "+`got '${n}', expected '${this.name}'.`);return t.readBinary()}createSignatureData(e){const t=new s.SshDataWriter(i.Buffer.alloc(this.name.length+e.length+20));return t.writeString(this.name,"ascii"),t.writeBinary(e),t.toBuffer()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshSession=void 0;const i=n(46),s=n(3),r=n(8),o=n(140),a=n(281),c=n(482),l=n(1114),u=n(479),d=n(104),h=n(144),f=n(284),p=n(283),m=n(84),g=n(484),y=n(54),v=n(485),S=n(85),_=n(486),E=n(282),w=n(103),b=n(86),C=n(47),T=n(143);class M{constructor(e,t){if(this.config=e,this.remoteVersion=null,this.activatedServices=new Map,this.connectionService=null,this.requestHandler=null,this.blockedMessages=[],this.blockedMessagesSemaphore=new T.Semaphore(1),this.connected=!1,this.disposed=!1,this.metrics=new v.SessionMetrics,this.reconnecting=!1,this.sessionId=null,this.principalValue=null,this.authenticatingEmitter=new r.Emitter,this.onAuthenticating=this.authenticatingEmitter.event,this.closedEmitter=new r.Emitter,this.onClosed=this.closedEmitter.event,this.disconnectedEmitter=new r.Emitter,this.onDisconnected=this.disconnectedEmitter.event,this.serviceActivatedEmitter=new r.Emitter,this.onServiceActivated=this.serviceActivatedEmitter.event,this.channelOpeningEmitter=new r.Emitter,this.onChannelOpening=this.channelOpeningEmitter.event,this.requestEmitter=new r.Emitter,this.onRequest=this.requestEmitter.event,!e)throw new TypeError("Session configuration is required.");if(e.keyExchangeAlgorithms.find(e=>!!e))this.kexService=new u.KeyExchangeService(this,null!=t&&t);else{if(e.encryptionAlgorithms.length>0&&e.encryptionAlgorithms.indexOf(null)<0)throw new Error("Encryption requires a key-exchange algorithm to be configured.");if(e.hmacAlgorithms.length>0&&e.hmacAlgorithms.indexOf(null)<0)throw new Error("HMAC requires a key-exchange algorithm to be configured.");if(e.publicKeyAlgorithms.length>0&&e.publicKeyAlgorithms.indexOf(null)<0)throw new Error("Host authentication requires a key-exchange algorithm to be configured.");this.kexService=null}}get algorithms(){return this.protocol?this.protocol.algorithms:null}get principal(){return this.principalValue}set principal(e){this.principalValue=e}get isConnected(){return this.connected}get isClosed(){return this.disposed}get services(){return[...this.activatedServices.values()]}get channels(){var e,t;return null!==(t=null===(e=this.connectionService)||void 0===e?void 0:e.channels)&&void 0!==t?t:[]}get protocolExtensions(){var e;return(null===(e=this.protocol)||void 0===e?void 0:e.extensions)||null}getService(e){const t=this.activatedServices.get(e);return t||null}activateService(e){let t;if("function"==typeof e)t=e;else{let n=e;if(t=(0,d.findService)(this.config.services,e=>e.serviceRequest===n),!t)return null}let n=this.activatedServices.get(t);if(!n){if(!this.config.services.has(t))throw new Error(`Service type not configured: ${t.name}`);n=new t(this,this.config.services.get(t)),t===h.ConnectionService&&(this.connectionService=n),this.activatedServices.set(t,n),this.serviceActivatedEmitter.fire(n)}return n}async connect(e,t){if(!e)throw new TypeError("A session stream is required.");if(this.disposed)throw new C.ObjectDisposedError(this);this.connectPromise||(this.connectPromise=this.doConnect(e,t)),await this.connectPromise}async doConnect(e,t){(0,i.trace)(`${this} ${this.reconnecting?"re":""}connecting...`),this.protocol=new l.SshProtocol(e,this.config,this.metrics),this.protocol.kexService=this.kexService,await this.exchangeVersions(t),this.kexService?await this.encrypt(t):(await(0,b.withCancellation)(this.versionExchangePromise,t),this.connected=!0),this.processMessages().catch(e=>{(0,i.trace)(`Unhandled error processing messages: ${e.message||JSON.stringify(e)}`)})}async exchangeVersions(e){const t=this.protocol.writeProtocolVersion(M.localVersion.toString(),e),n=this.protocol.readProtocolVersion(e);this.versionExchangePromise=n.then(async e=>{let t;(0,i.trace)(`Local version: ${M.localVersion}, remote version: ${e}`);const n=c.SshVersionInfo.tryParse(e);if(n){if(this.remoteVersion=n,"2.0"===n.protocolVersion)return;t=`Remote SSH version ${this.remoteVersion} is not supported. `+"This library only supports SSH v2.0."}else t=`Could not parse remote SSH version ${e}`;await this.close(y.SshDisconnectReason.protocolVersionNotSupported,t,new Error(t))}),await t}async encrypt(e){var t,n;const s=this.protocol;if(!s)throw new C.ObjectDisposedError(this);await s.considerReExchange(!0,e),await(0,b.withCancellation)(this.versionExchangePromise,e),this.connected=!0;let r=null;for(;!(this.isClosed||(null===(t=this.protocol)||void 0===t?void 0:t.algorithms)||r instanceof y.DisconnectMessage)&&(r=await s.receiveMessage(e),r);)await this.dispatchMessage(r,e);if(!(null===(n=this.protocol)||void 0===n?void 0:n.algorithms))throw new C.SshConnectionError("Session closed while encrypting.",y.SshDisconnectReason.connectionLost);this.protocol.algorithms.cipher&&(0,i.trace)(`${this} encrypted.`)}async processMessages(){var e;for(this.connected=!0;!this.disposed;){const t=this.protocol;if(!t)break;let n=null;try{n=await t.receiveMessage()}catch(t){if(!(t instanceof Error))throw t;let n=y.SshDisconnectReason.protocolError;t instanceof C.SshConnectionError?n=null!==(e=t.reason)&&void 0!==e?e:n:(0,i.trace)(`Error receiving message: ${t.message||JSON.stringify(t)}`),await this.close(n,t.message,t)}if(!n){await this.close(y.SshDisconnectReason.connectionLost,"Connection lost.");break}try{await this.dispatchMessage(n)}catch(e){if(!(e instanceof Error))throw e;(0,i.trace)(`Error handling ${n}: ${e.message||JSON.stringify(e)}`),await this.close(y.SshDisconnectReason.protocolError,e.message,e)}}this.connected=!1}get canAcceptRequests(){var e;return!(this.kexService&&(!(null===(e=this.protocol)||void 0===e?void 0:e.algorithms)||this.protocol.algorithms.cipher&&!this.principal))}async sendMessage(e,t){var n,s;if(!e)throw new TypeError("Message expected.");if(t&&t.isCancellationRequested)throw new b.CancellationError;const r=this.protocol;if(!r||this.disposed)throw new C.ObjectDisposedError(this);if(this.kexService&&this.kexService.exchanging&&e.messageType>4&&(e.messageType<20||e.messageType>49))return void this.blockedMessages.push(e);let a;await this.blockedMessagesSemaphore.wait(t);try{a=await r.sendMessage(e,t),this.blockedMessagesSemaphore.release()}catch(t){if(this.blockedMessagesSemaphore.release(),t instanceof C.SshConnectionError){if(t.reason===y.SshDisconnectReason.connectionLost&&(null===(n=this.protocolExtensions)||void 0===n?void 0:n.has(o.SshProtocolExtensionNames.sessionReconnect)))return}if(!(t instanceof Error))throw t;throw(0,i.trace)(`Error sending ${e}: ${t.message||JSON.stringify(t)}`),t}if(!a&&!(null===(s=this.protocolExtensions)||void 0===s?void 0:s.has(o.SshProtocolExtensionNames.sessionReconnect)))throw new C.SshConnectionError("Session disconnected.",y.SshDisconnectReason.connectionLost)}dispatchMessage(e,t){var n;return e instanceof m.ConnectionMessage&&this.connectionService?this.connectionService.handleMessage(e,t):e instanceof p.NewKeysMessage?this.handleNewKeysMessage(e,t):e instanceof p.KeyExchangeMessage?this.handleKeyExchangeMessage(e,t):e instanceof g.AuthenticationMessage?null===(n=this.getService(f.AuthenticationService))||void 0===n?void 0:n.handleMessage(e,t):e instanceof y.ServiceRequestMessage?this.handleServiceRequestMessage(e,t):e instanceof y.ServiceAcceptMessage?this.handleServiceAcceptMessage(e,t):e instanceof y.SessionRequestMessage?this.handleRequestMessage(e,t):e instanceof y.SessionRequestSuccessMessage?this.handleRequestSuccessMessage(e):e instanceof y.SessionRequestFailureMessage?this.handleRequestFailureMessage(e):e instanceof y.ExtensionInfoMessage?this.handleExtensionInfoMessage(e,t):e instanceof y.UnimplementedMessage?this.handleUnimplementedMessage(e,t):e instanceof y.DebugMessage?this.handleDebugMessage(e):void 0}async handleRequestMessage(e,t){var n;let s=!1;if("initial-channel-request@microsoft.com"===e.requestType&&this.config.protocolExtensions.includes(o.SshProtocolExtensionNames.openChannelRequest)){const n=e.convertTo(new y.SessionChannelRequestMessage),i=n.senderChannel,r=this.channels.find(e=>e.remoteChannelId===i);r&&n.request&&(n.request.wantReply=!1,s=await r.handleRequest(n.request,t))}else if("enable-session-reconnect@microsoft.com"===e.requestType&&(null===(n=this.config.protocolExtensions)||void 0===n?void 0:n.includes(o.SshProtocolExtensionNames.sessionReconnect)))this.protocol.incomingMessagesHaveReconnectInfo||(this.protocol.incomingMessagesHaveReconnectInfo=!0,this.protocol.incomingMessagesHaveLatencyInfo=this.protocol.extensions.has(o.SshProtocolExtensionNames.sessionLatency),s=!0);else if(this.canAcceptRequests){const n=new E.SshRequestEventArgs(e.requestType||"",e,this.principal),i=(0,d.findService)(this.config.services,t=>t.sessionRequest===e.requestType);if(i){const e=this.activateService(i);return void await e.onSessionRequest(n,t)}this.raiseSessionRequest(n),s=n.isAuthorized||!1}else(0,i.trace)("Session request blocked because the session is not yet authenticated."),s=!1;e.wantReply&&await this.sendMessage(s?new y.SessionRequestSuccessMessage:new y.SessionRequestFailureMessage,t)}raiseSessionRequest(e){this.requestEmitter.fire(e)}async handleServiceRequestMessage(e,t){}async handleServiceAcceptMessage(e,t){}async handleKeyExchangeMessage(e,t){if(!this.kexService){if(!(e instanceof p.KeyExchangeInitMessage&&this.protocol))return void await this.close(y.SshDisconnectReason.keyExchangeFailed);this.kexService=this.activateService(u.KeyExchangeService),this.protocol.kexService=this.kexService,await this.protocol.considerReExchange(!0,t)}return this.kexService.handleMessage(e,t)}async handleNewKeysMessage(e,t){try{await this.blockedMessagesSemaphore.wait(t),await this.protocol.handleNewKeys(t);try{for(;this.blockedMessages.length>0;){const e=this.blockedMessages.shift();if(!this.protocol)throw new C.ObjectDisposedError(this);await this.protocol.sendMessage(e,t)}}catch(e){if(!(e instanceof Error))throw e;await this.close(y.SshDisconnectReason.protocolError,void 0,e)}}finally{this.blockedMessagesSemaphore.release()}}async handleUnimplementedMessage(e,t){void 0!==e.unimplementedMessageType&&await this.sendMessage(e,t)}handleDebugMessage(e){e.message&&(0,i.trace)(e.message)}async raiseAuthenticatingEvent(e){(0,i.trace)(`${this} Authenticating(${e})`),this.authenticatingEmitter.fire(e);let t=e.authenticationPromise;return t||(t=Promise.resolve(null)),await t}async request(e,t){if(!e)throw new TypeError("Request is required.");if(!e.wantReply)return await this.sendMessage(e,t),!0;return await this.requestResponse(e,y.SessionRequestSuccessMessage,y.SessionRequestFailureMessage,t)instanceof y.SessionRequestSuccessMessage}async requestResponse(e,t,n,i){if(!e)throw new TypeError("Request is required.");if(!t)throw new TypeError("Success response type is required.");if(!n)throw new TypeError("Failure response type is required.");if(this.requestHandler)throw new Error("Another request is already pending.");e.wantReply=!0;const s=new S.PromiseCompletionSource;if(i){if(i.isCancellationRequested)throw new b.CancellationError;i.onCancellationRequested(()=>{this.requestHandler=null,s.reject(new b.CancellationError)})}return this.requestHandler=(e,i)=>{var r,o;if(this.requestHandler=null,e)s.reject(e);else if(i instanceof y.SessionRequestFailureMessage){const e=null!==(r=null==i?void 0:i.convertTo(new n,!0))&&void 0!==r?r:null;s.resolve(e)}else if(i instanceof y.SessionRequestSuccessMessage){const e=null!==(o=null==i?void 0:i.convertTo(new t,!0))&&void 0!==o?o:null;s.resolve(e)}else s.reject(new Error("Unknown response message type."))},await this.sendMessage(e,i),await s.promise}handleRequestSuccessMessage(e){this.requestHandler&&this.requestHandler(void 0,e)}handleRequestFailureMessage(e){this.requestHandler&&this.requestHandler(void 0,e)}async acceptChannel(e,t){const n="string"==typeof e?e:void 0;t||"object"!=typeof e||(t=e),this.activateService(h.ConnectionService);const i=this.connectionService.acceptChannel(n||a.SshChannel.sessionChannelType,t);return await i}async openChannel(e,t,n){let i;if("string"==typeof e||null===e?(i=new m.ChannelOpenMessage,i.channelType=null!=e?e:a.SshChannel.sessionChannelType):e instanceof m.ChannelOpenMessage?i=e:(i=new m.ChannelOpenMessage,i.channelType=a.SshChannel.sessionChannelType,n=e),t instanceof m.ChannelRequestMessage)return await this.openChannelWithInitialRequest(i,t,n);n||null===t||(n=t),this.activateService(h.ConnectionService);const s=new S.PromiseCompletionSource;return await this.connectionService.openChannel(i,s,n),await s.promise}async openChannelWithInitialRequest(e,t,n){var i;this.activateService(h.ConnectionService);const s=new S.PromiseCompletionSource,r=await this.connectionService.openChannel(e,s,n);if(n){if(n.isCancellationRequested)throw new b.CancellationError;n.onCancellationRequested(()=>s.reject(new b.CancellationError))}let a,c;const l=this.config.protocolExtensions.includes(o.SshProtocolExtensionNames.openChannelRequest)&&(null===(i=this.protocolExtensions)||void 0===i?void 0:i.has(o.SshProtocolExtensionNames.openChannelRequest));if(!1===l)a=await s.promise,c=await a.request(t,n);else{const e=t.wantReply||void 0===l,i=new y.SessionChannelRequestMessage;i.requestType="initial-channel-request@microsoft.com",i.senderChannel=r,i.request=t,i.wantReply=e;const o=this.request(i,n);a=await s.promise,e?(c=await o,c||void 0!==l||(c=await a.request(t))):c=!0}if(!c)throw await a.close(),new Error("The initial channel request was denied.");return a}async handleChannelOpening(e,t){const n=(0,d.findService)(this.config.services,t=>t.channelType===e.channel.channelType&&!t.channelRequest);if(n){const i=this.activateService(n);await i.onChannelOpening(e,t)}else this.raiseChannelOpening(e)}raiseChannelOpening(e){this.channelOpeningEmitter.fire(e)}async sendExtensionInfo(e){const t=new y.ExtensionInfoMessage;t.extensionInfo={};for(let e of this.config.protocolExtensions)if(e===o.SshProtocolExtensionNames.serverSignatureAlgorithms){const n=Array.from(new Set((0,w.algorithmNames)(this.config.publicKeyAlgorithms))).join(",");t.extensionInfo[e]=n}else t.extensionInfo[e]="";await this.sendMessage(t,e)}async handleExtensionInfoMessage(e,t){if(!this.protocol)return;if(this.protocol.extensions=new Map,e.extensionInfo){for(let t of this.config.protocolExtensions){const n=e.extensionInfo[t];"string"==typeof n&&this.protocol.extensions.set(t,n)}this.protocol.extensions.has(o.SshProtocolExtensionNames.sessionReconnect)&&await this.enableReconnect(t)}}async close(e,t,n){var s,r,o;if(!this.disposed&&this.connected){if(this.connected=!1,(0,i.trace)(`${this} Close(${y.SshDisconnectReason[e]}, "${t||""}")`),e!==y.SshDisconnectReason.connectionLost)try{const n=new y.DisconnectMessage;n.reasonCode=e,n.description=t||"",await(null===(s=this.protocol)||void 0===s?void 0:s.sendMessage(n))}catch(e){}else if(this.handleDisconnected())return null===(r=this.protocol)||void 0===r||r.dispose(),(0,i.trace)(`${this} disconnected.`),void this.disconnectedEmitter.fire();this.disposed=!0,n&&(null===(o=this.connectionService)||void 0===o||o.close(n)),this.closedEmitter.fire(new _.SshSessionClosedEventArgs(e,t||"Disconnected.",n||null)),this.dispose()}}handleDisconnected(){var e,t;return this.connectPromise=void 0,null===(e=this.kexService)||void 0===e||e.abortKeyExchange(),!!(null===(t=this.protocolExtensions)||void 0===t?void 0:t.has(o.SshProtocolExtensionNames.sessionReconnect))}dispose(){var e,t;this.disposed||((0,i.trace)(`${this} disposed.`),this.disposed=!0,this.closedEmitter.fire(new _.SshSessionClosedEventArgs(y.SshDisconnectReason.none,"SshSession disposed",null))),this.requestHandler&&this.requestHandler(new C.SshConnectionError("Connection closed.")),this.metrics.close(),null===(e=this.connectionService)||void 0===e||e.dispose();for(let e of this.activatedServices.values())e!==this.connectionService&&e.dispose();this.activatedServices.clear(),null===(t=this.protocol)||void 0===t||t.dispose(),this.protocol=void 0}async enableReconnect(e){var t;try{if(await this.blockedMessagesSemaphore.wait(),null===(t=this.kexService)||void 0===t?void 0:t.exchanging)(0,i.trace)("Failed to initialize session reconnect because a key-exchange was in-progress.");else{const t=new y.SessionRequestMessage("enable-session-reconnect@microsoft.com",!1);await this.protocol.sendMessage(t,e),this.protocol&&(this.protocol.outgoingMessagesHaveReconnectInfo=!0,this.protocol.outgoingMessagesHaveLatencyInfo=this.protocol.extensions.has(o.SshProtocolExtensionNames.sessionLatency))}this.blockedMessagesSemaphore.release()}catch(e){throw this.blockedMessagesSemaphore.release(),e instanceof Error&&await this.close(y.SshDisconnectReason.protocolError,void 0,e),e}}async createReconnectToken(e,t){return await this.algorithms.signer.sign(s.Buffer.concat([e,t]))}async verifyReconnectToken(e,t,n){return await this.algorithms.verifier.verify(s.Buffer.concat([e,t]),n)}toString(){return this.constructor.name}}t.SshSession=M,M.localVersion=c.SshVersionInfo.getLocalVersion()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Semaphore=void 0;const i=n(85),s=n(86),r=n(47);t.Semaphore=class{constructor(e=0){this.completions=[],this.disposed=!1,this.count=e}get currentCount(){return this.count}release(e=1){if(this.disposed)throw new r.ObjectDisposedError(this);const t=this.count;for(;e>0;e--)if(this.completions.length>0){this.completions.shift().resolve(!0)}else this.count++;return t}tryRelease(){try{this.release()}catch(e){if(!(e instanceof r.ObjectDisposedError))throw e}}async wait(e,t){const n="number"==typeof e?e:void 0;if(void 0===t&&"object"==typeof e&&(t=e),this.disposed)throw new r.ObjectDisposedError(this);if(null==t?void 0:t.isCancellationRequested)throw new s.CancellationError;if(this.count>0)return this.count--,!0;if(0===n)return!1;{const e=new i.PromiseCompletionSource;this.completions.push(e);const r=[e.promise];if(n&&r.push(new Promise(e=>setTimeout(()=>e(!1),n))),t){const e=new i.PromiseCompletionSource;t.onCancellationRequested(()=>{e.reject(new s.CancellationError)}),r.push(e.promise)}if(await Promise.race(r))return!0;{const t=this.completions.indexOf(e);return t>=0&&this.completions.splice(t,1),!1}}}dispose(){if(!this.disposed){this.disposed=!0;for(let e of this.completions)e.reject(new r.ObjectDisposedError(this));this.completions.splice(0,this.completions.length),this.count=0}}}},function(e,t,n){"use strict";var i,s=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionService=void 0;const r=n(46),o=n(183),a=n(84),c=n(85),l=n(281),u=n(86),d=n(47),h=n(483),f=n(104);let p=i=class extends o.SshService{constructor(e){super(e),this.channelCounter=0,this.channelMap=new Map,this.nonAcceptedChannels=new Map,this.pendingChannels=new Map,this.pendingAcceptChannels=new Map}get channels(){return Array.from(this.channelMap.values())}close(e){for(let t of this.channelMap.values())t.close(e)}dispose(){const e=[...this.channelMap.values()];let t=[...this.pendingChannels.values()].map(e=>e.completionSource);this.pendingAcceptChannels.size>0&&(t=t.concat([...this.pendingAcceptChannels.values()].reduce((e,t)=>e.concat(t))));for(let t of e)t.dispose();for(let e of t)e.reject(new d.SshConnectionError("Session closed."));super.dispose()}async acceptChannel(e,t){const n=new c.PromiseCompletionSource;let i;if(t){if(t.isCancellationRequested)throw new u.CancellationError;i=t.onCancellationRequested(()=>{const t=this.pendingAcceptChannels.get(e);if(t){const e=t.findIndex(e=>Object.is(e,n));e>=0&&t.splice(e,1)}n.reject(new u.CancellationError)})}let s=null;if(s=Array.from(this.nonAcceptedChannels.values()).find(t=>t.channelType===e)||null,s)this.nonAcceptedChannels.delete(s.channelId);else{let t=this.pendingAcceptChannels.get(e);t||(t=[],this.pendingAcceptChannels.set(e,t)),t.push(n)}try{return s||await n.promise}finally{i&&i.dispose()}}async openChannel(e,t,n){const i=++this.channelCounter;e.senderChannel=i;let s=null;if(n){if(n.isCancellationRequested)throw new u.CancellationError;s=n.onCancellationRequested(()=>{this.pendingChannels.delete(i)&&t.reject(new u.CancellationError)})}return this.pendingChannels.set(i,{openMessage:e,completionSource:t,cancellationRegistration:s}),await this.session.sendMessage(e),i}handleMessage(e,t){if(e instanceof a.ChannelDataMessage)return this.handleDataMessage(e);if(e instanceof a.ChannelWindowAdjustMessage)return this.handleAdjustWindowMessage(e);if(e instanceof a.ChannelEofMessage)return this.handleEofMessage(e);if(e instanceof a.ChannelOpenMessage)return this.handleOpenMessage(e,t);if(e instanceof a.ChannelCloseMessage)return this.handleCloseMessage(e);if(e instanceof a.ChannelOpenConfirmationMessage)return this.handleOpenConfirmationMessage(e,t);if(e instanceof a.ChannelOpenFailureMessage)return this.handleOpenFailureMessage(e);if(e instanceof a.ChannelRequestMessage)return this.handleRequestMessage(e,t);if(e instanceof a.ChannelSuccessMessage)return this.handleSuccessMessage(e);if(e instanceof a.ChannelFailureMessage)return this.handleFailureMessage(e);throw new Error(`Message not implemented: ${e}`)}async handleOpenMessage(e,t){if(!this.session.canAcceptRequests){(0,r.trace)("Channel open request blocked because the session is not yet authenticated.");const n=new a.ChannelOpenFailureMessage;return n.recipientChannel=e.senderChannel,n.reasonCode=a.SshChannelOpenFailureReason.administrativelyProhibited,n.description="Authenticate before opening channels.",void await this.session.sendMessage(n,t)}if(!e.channelType){const n=new a.ChannelOpenFailureMessage;return n.recipientChannel=e.senderChannel,n.reasonCode=a.SshChannelOpenFailureReason.unknownChannelType,n.description="Channel type not specified.",void await this.session.sendMessage(n,t)}const n=new l.SshChannel(this,e.channelType,e.senderChannel,e.initialWindowSize,e.maximumPacketSize,++this.channelCounter),i=new h.SshChannelOpeningEventArgs(e,n,!0);try{await this.session.handleChannelOpening(i,t)}catch(e){throw n.dispose(),e}if(i.failureReason!==a.SshChannelOpenFailureReason.none){const e=new a.ChannelOpenFailureMessage;e.recipientChannel=n.remoteChannelId,e.reasonCode=i.failureReason,e.description=i.failureDescription||void 0;try{await this.session.sendMessage(e,t)}finally{n.dispose()}return}if(this.session.isClosed)return void n.dispose();this.channelMap.set(n.channelId,n);const s=new a.ChannelOpenConfirmationMessage;s.recipientChannel=n.remoteChannelId,s.senderChannel=n.channelId,s.initialWindowSize=e.initialWindowSize,s.maximumPacketSize=e.maximumPacketSize,await this.session.sendMessage(s,t);let o=!1;const c=this.pendingAcceptChannels.get(n.channelType);for(;c&&c.length>0;){c.shift().resolve(n),o=!0;break}o||this.nonAcceptedChannels.set(n.channelId,n),this.onChannelOpenCompleted(n.channelId,n),n.enableSending()}handleCloseMessage(e){const t=this.findChannelById(e.recipientChannel);t&&t.dispose()}async handleOpenConfirmationMessage(e,t){var n;let i,s=null;const r=this.pendingChannels.get(e.recipientChannel);if(!r)throw this.channelMap.has(e.recipientChannel)?new Error("Duplicate channel ID."):new Error("Channel confirmation was not requested.");i=r.openMessage,s=r.completionSource,r.cancellationRegistration&&r.cancellationRegistration.dispose(),this.pendingChannels.delete(e.recipientChannel);const o=new l.SshChannel(this,i.channelType||l.SshChannel.sessionChannelType,e.senderChannel,e.initialWindowSize,e.maximumPacketSize,e.recipientChannel);this.channelMap.set(o.channelId,o);const c=new h.SshChannelOpeningEventArgs(i,o,!1);if(await this.session.handleChannelOpening(c,t),s){if(c.failureReason!==a.SshChannelOpenFailureReason.none)return void s.reject(new d.SshChannelError(null!==(n=c.failureDescription)&&void 0!==n?n:"Channel open failure.",c.failureReason));s.resolve(o)}else this.onChannelOpenCompleted(o.channelId,o);o.enableSending()}handleOpenFailureMessage(e){let t=null;const n=this.pendingChannels.get(e.recipientChannel);n&&(t=n.completionSource,n.cancellationRegistration&&n.cancellationRegistration.dispose(),this.pendingChannels.delete(e.recipientChannel)),null!=t?t.reject(new d.SshChannelError(e.description||"Channel open rejected.",e.reasonCode)):this.onChannelOpenCompleted(e.recipientChannel,null)}async handleRequestMessage(e,t){const n=this.findChannelById(e.recipientChannel);n?await n.handleRequest(e,t):(0,r.trace)(`Invalid channel ID ${e.recipientChannel} in channel request message.`)}handleSuccessMessage(e){const t=this.findChannelById(e.recipientChannel);t?t.handleResponse(!0):(0,r.trace)(`Invalid channel ID ${e.recipientChannel} in channel success message.`)}handleFailureMessage(e){const t=this.findChannelById(e.recipientChannel);t?t.handleResponse(!1):(0,r.trace)(`Invalid channel ID ${e.recipientChannel} in channel failure message.`)}handleDataMessage(e){const t=this.findChannelById(e.recipientChannel);if(t)return t.handleDataReceived(e.data)}handleAdjustWindowMessage(e){const t=this.findChannelById(e.recipientChannel);t&&t.adjustRemoteWindow(e.bytesToAdd)}handleEofMessage(e){const t=this.findChannelById(e.recipientChannel);t&&t.handleEof()}onChannelOpenCompleted(e,t){t?(0,r.trace)(`${this.session} ChannelOpenCompleted(${t})`):(0,r.trace)(`${this.session} ChannelOpenCompleted(${e} failed)`)}findChannelById(e){var t;return null!==(t=this.channelMap.get(e))&&void 0!==t?t:null}_removeChannel(e){this.channelMap.delete(e.channelId),this.pendingChannels.delete(e.channelId)}};p.serviceName="ssh-connection",p=i=s([(0,f.serviceActivation)({serviceRequest:i.serviceName})],p),t.ConnectionService=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(18);var r;!function(e){e.SuggestedContacts="contacts.suggested",e.AvailableContacts="contacts.available",e.ContactsProvider="contacts.provider",e.SelfContact="contacts.selfContact",e.Contact="contacts.contact",e.ContactInvited="contacts.contact.invited",e.ContactOffline="contacts.contact.offline",e.RecentContact="contacts.recentContact",e.RecentContactOffline="contacts.recentContact.offline",e.RecentContactInvited="contacts.recentContact.invited",e.NoContact="contacts.noContact",e.RecentContacts="contacts.RecentContacts",e.NoSuggestedContacts="contacts.NoSuggestedUsers",e.NoRecentContacts="contacts.NoRecentContacts",e.InvitedContact="contacts.invited"}(r||(r={}));const o=n(55),a=n(184),c=n(4),l=n(5);class u{constructor(e){this.sessionContext=e,this.changeEventEmitter=new i.EventEmitter,this.onDidChangeTreeData=this.changeEventEmitter.event,this.joinedUserProfiles=new Map,this.refresh=()=>{this.changeEventEmitter.fire(void 0)},o.ContactManager.addListener(c.ContactManagerEvents.ContactsChanged,this.refresh),o.ContactManager.addListener(c.ContactManagerEvents.SuggestedUsersUpdate,this.refresh),o.ContactManager.addListener(c.ContactManagerEvents.RecentContactsUpdate,this.refresh),o.ContactManager.addListener(c.ContactManagerEvents.InviteContactsUpdate,this.refresh),this.sessionContext.onCollaboratorChanged(e=>this.onCollaboratorChanged(e))}getTreeItem(e){return e}async getChildren(e){return e?await this.getElementChildren(e):await this.getDefaultRootChildren()}async getElementChildren(e){switch(e.contextValue){case r.SuggestedContacts:return this.getSuggestedUsersChildren();case r.RecentContacts:return this.getRecentContactsChildren();case r.ContactsProvider:return this.getContactServiceChildren(e.contactServiceManager);case r.AvailableContacts:return this.getAvailableContactsChildren(e.contactServiceManager);case r.NoRecentContacts:case r.NoSuggestedContacts:return[new c.TreeViewItem({type:r.NoContact,label:"Invite participants...",command:{title:"Invite participants...",command:"liveshare.inviteNoUserJoinByEmail"}})];default:return[]}}createContactTreeExplorerItem(e,t,n){const i=u.getPresenceStatusName(t);let s=`${t.contact.displayName} - ${i} (${t.contact.email})`;const r=(e,n,i)=>{const s=t.properties[e];s&&n(s)&&i(s)};return r(o.PublishProperties.LiveshareStatus,e=>{const t=e;return t===c.SessionState.Joined||t===c.SessionState.Shared},e=>{const n=c.localize("extension.liveshare.InLiveShareSession");s=`${t.contact.displayName} - ${n} (${t.contact.email})`}),r(o.PublishProperties.WorkspaceName,e=>""!==e,e=>s+=`\nWorkspace: ${e}`),new h(t,e,{type:n,label:`${t.contact.displayName}`,tooltip:s,iconPath:this.getPresenceIconUri(t)})}getContactModelChildren(e,t){return e.sort(a.defaultCompareContacts).map(e=>{const n=o.ContactManager.getServiceManager(e.serviceId);return this.createContactTreeExplorerItem(n,e,t(e))})}onCollaboratorChanged(e){e.changeType===l.vsls.WorkspaceSessionChangeType.Joined?this.joinedUserProfiles.set(e.userProfile.id,e.userProfile):e.changeType!==l.vsls.WorkspaceSessionChangeType.Unjoined&&e.changeType!==l.vsls.WorkspaceSessionChangeType.Canceled||this.joinedUserProfiles.delete(e.userProfile.id),this.refresh()}getSuggestedUsersChildren(){return this.getContactModelChildren(o.ContactManager.getSuggestedUsers(),e=>this.isContactCollaborator(e)||o.ContactManager.isContactInvited(e.id)?r.ContactInvited:u.isContactOffline(e)?r.ContactOffline:r.Contact)}getRecentContactsChildren(){return this.getContactModelChildren(o.ContactManager.getRecentContacts(),e=>this.isContactCollaborator(e)||o.ContactManager.isContactInvited(e.id)?r.RecentContactInvited:u.isContactOffline(e)?r.RecentContactOffline:r.RecentContact)}getAvailableContactsChildren(e){return u.getContactsWithPresence(e.availableUsers).map(t=>this.createContactTreeExplorerItem(e,t,r.Contact))}getCollaborators(){return Object.values(this.sessionContext.collaboratorManager.getCollaborators())}isContactCollaborator(e){if(!this.sessionContext.collaboratorManager)return!1;return void 0!==this.getCollaborators().filter(e=>!e.isOwner).concat(Array.from(this.joinedUserProfiles.values())).find(t=>t.id===e.id||t.email===e.contact.email)}getContactServiceChildren(e){let t=[];if(e.capabilites.supportsAvailableContacts){const n=new d(e,{type:r.AvailableContacts,collapsibleState:i.TreeItemCollapsibleState.Collapsed,label:`Available contacts (${u.getContactsWithPresence(e.availableUsers).length})`});t.push(n)}const n=e.selfUser;if(n){const i=new h(n,e,{type:r.SelfContact,label:`${n.contact.displayName} - ${u.getPresenceStatusName(n)}`,iconPath:this.getPresenceIconUri(n)});t.unshift(i)}return t}async getDefaultRootChildren(){const e=[],t=o.ContactManager.getSuggestedUsers(),n=o.ContactManager.getRecentContacts(),s=n.length>0,a=new c.TreeViewItem({type:s?r.RecentContacts:r.NoRecentContacts,collapsibleState:i.TreeItemCollapsibleState.Expanded,label:`Recent contacts (${n.length})`});e.push(a);const l=t.length>0,u=new c.TreeViewItem({type:l?r.SuggestedContacts:r.NoSuggestedContacts,collapsibleState:i.TreeItemCollapsibleState.Expanded,label:`Suggested contacts (${t.length})`});return e.push(u),e}static getPresenceIcon(e){switch(e.contact.status){case l.contactProtocol.PresenceStatus.Available:return"available.svg";case l.contactProtocol.PresenceStatus.DoNotDisturb:return"dnd.svg";case l.contactProtocol.PresenceStatus.Away:return"away.svg";case l.contactProtocol.PresenceStatus.Busy:return"busy.svg";default:return"invisible.svg"}}getPresenceIconUri(e){return c.ExtensionUtil.getExtensionUri(s.join("images","presence",u.getPresenceIcon(e)))}static getContactsWithPresence(e){return e.filter(e=>e.contact.status!==l.contactProtocol.PresenceStatus.Offline)}static getPresenceStatusName(e){return u.toPresenceStatusName(e.contact.status)}static toPresenceStatusName(e){switch(e){case l.contactProtocol.PresenceStatus.Available:return"Available";case l.contactProtocol.PresenceStatus.DoNotDisturb:return"Do not disturb";case l.contactProtocol.PresenceStatus.Away:return"Away";case l.contactProtocol.PresenceStatus.Busy:return"Busy";case l.contactProtocol.PresenceStatus.Offline:default:return"Offline"}}static isContactOffline(e){const t=e.contact.status;return void 0===t||t===l.contactProtocol.PresenceStatus.Offline||t===l.contactProtocol.PresenceStatus.Unknown}}t.ContactsProviderViewlet=u;class d extends c.TreeViewItem{constructor(e,t){super(t),this.contactServiceManager=e}}t.ContactServiceExplorerItem=d;class h extends d{constructor(e,t,n){super(t,n),this.contactModel=e}}t.ContactTreeExplorerItem=h},function(e,t,n){var i=n(292),s=n(1168),r=n(1169),o=i?i.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?s(e):r(e)}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.availabilityChangedEvent=t.RemoteServiceConnections=t.MessageDelimiters=t.Formatters=void 0,function(e){e[e.Utf8=0]="Utf8",e[e.MessagePack=1]="MessagePack"}(t.Formatters||(t.Formatters={})),function(e){e[e.HttpLikeHeaders=0]="HttpLikeHeaders",e[e.BigEndianInt32LengthHeader=1]="BigEndianInt32LengthHeader"}(t.MessageDelimiters||(t.MessageDelimiters={})),function(e){e[e.None=0]="None",e[e.Multiplexing=1]="Multiplexing",e[e.IpcPipe=2]="IpcPipe",e[e.ClrActivation=8]="ClrActivation"}(t.RemoteServiceConnections||(t.RemoteServiceConnections={})),t.availabilityChangedEvent="availabilityChanged"},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(34),s=n(187);async function r(e,t){const n=new s.Deferred;return e.write(t,e=>{e?n.reject(e):n.resolve()}),n.promise}async function o(t,n,i=!1,r){const o=new s.Deferred;for(;n>0;){const e=t.read(n);if(null===e){const e=new s.Deferred;t.once("readable",e.resolve.bind(e)),t.once("end",o.resolve.bind(o));const n=Promise.race([e.promise,o.promise]);if(await(r?r.racePromise(n):n),e.isCompleted)continue}if(!i&&(!e||e.length<n))throw new Error("Stream terminated before required bytes were read.");return e}return new e([])}t.writeAsync=r,t.writeSubstream=function(t){return new i.Writable({async write(n,i,s){try{const i=new DataView(new ArrayBuffer(4));i.setUint32(0,n.length,!1),await r(t,e.from(i.buffer)),await r(t,n),s()}catch(e){s(e)}},final(e){t.write(new Uint8Array(4),e)}})},t.readSubstream=function(e){return new i.Readable({async read(t){const n=await o(e,4),i=new DataView(n.buffer,n.byteOffset,n.length).getUint32(0,!1);if(0===i)return void this.push(null);const s=await o(e,i);this.push(s)}})},t.getBufferFrom=o,t.throwIfDisposed=function(e){if(e.isDisposed)throw new Error("disposed")},t.requireInteger=function(e,t,n,i="signed"){if(!Number.isInteger(t))throw new Error(`${e} must be an integer.`);let s=8*n;"signed"===i&&s--;const r=Math.pow(2,s)-1,o="signed"===i?-Math.pow(2,s):0;if(t>r||t<o)throw new Error(`${e} must be in the range ${o}-${r}.`)},t.removeFromQueue=function(e,t){if(t){const n=t.indexOf(e);n>=0&&t.splice(n,1)}}}).call(this,n(3).Buffer)},function(e,t,n){"use strict";function i(e){return"string"==typeof e||e instanceof String}function s(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=function(e){return!0===e||!1===e},t.string=i,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=s,t.stringArray=function(e){return s(e)&&e.every(e=>i(e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(113);t.TraceListener=class{constructor(){this.filter=null}traceEvent(e,t,n,i,...s){this.filter&&!this.filter.shouldTrace(e,t,n)||this.writeEvent(e,t,n,i,...s)}writeLine(e,t,n){n&&(t=`[${i.TraceFormat.formatDate(new Date)} ${e}] ${t}`),this.writeTo(t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.create=function(e){return{dispose:e}}}(t.Disposable||(t.Disposable={})),function(e){const t={dispose(){}};e.None=function(){return t}}(t.Event||(t.Event={}));class i{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(this._callbacks){for(var n=!1,i=0,s=this._callbacks.length;i<s;i++)if(this._callbacks[i]===e){if(this._contexts[i]===t)return this._callbacks.splice(i,1),void this._contexts.splice(i,1);n=!0}if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}}invoke(...e){if(!this._callbacks)return[];for(var t=[],n=this._callbacks.slice(0),i=this._contexts.slice(0),s=0,r=n.length;s<r;s++)try{t.push(n[s].apply(i[s],e))}catch(e){console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class s{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,n)=>{let r;return this._callbacks||(this._callbacks=new i),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t),r={dispose:()=>{this._callbacks.remove(e,t),r.dispose=s._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this)}},Array.isArray(n)&&n.push(r),r}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}s._noop=function(){},t.Emitter=s},function(e,t,n){"use strict";(function(t){void 0===t||!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:function(e,n,i,s){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var r,o,a=arguments.length;switch(a){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick((function(){e.call(null,n)}));case 3:return t.nextTick((function(){e.call(null,n,i)}));case 4:return t.nextTick((function(){e.call(null,n,i,s)}));default:for(r=new Array(a-1),o=0;o<r.length;)r[o++]=arguments[o];return t.nextTick((function(){e.apply(null,r)}))}}}:e.exports=t}).call(this,n(11))},function(e,t,n){var i=n(14).Buffer;function s(e){i.isBuffer(e)||(e=i.from(e));for(var t=e.length/4|0,n=new Array(t),s=0;s<t;s++)n[s]=e.readUInt32BE(4*s);return n}function r(e){for(;0<e.length;e++)e[0]=0}function o(e,t,n,i,s){for(var r,o,a,c,l=n[0],u=n[1],d=n[2],h=n[3],f=e[0]^t[0],p=e[1]^t[1],m=e[2]^t[2],g=e[3]^t[3],y=4,v=1;v<s;v++)r=l[f>>>24]^u[p>>>16&255]^d[m>>>8&255]^h[255&g]^t[y++],o=l[p>>>24]^u[m>>>16&255]^d[g>>>8&255]^h[255&f]^t[y++],a=l[m>>>24]^u[g>>>16&255]^d[f>>>8&255]^h[255&p]^t[y++],c=l[g>>>24]^u[f>>>16&255]^d[p>>>8&255]^h[255&m]^t[y++],f=r,p=o,m=a,g=c;return r=(i[f>>>24]<<24|i[p>>>16&255]<<16|i[m>>>8&255]<<8|i[255&g])^t[y++],o=(i[p>>>24]<<24|i[m>>>16&255]<<16|i[g>>>8&255]<<8|i[255&f])^t[y++],a=(i[m>>>24]<<24|i[g>>>16&255]<<16|i[f>>>8&255]<<8|i[255&p])^t[y++],c=(i[g>>>24]<<24|i[f>>>16&255]<<16|i[p>>>8&255]<<8|i[255&m])^t[y++],[r>>>=0,o>>>=0,a>>>=0,c>>>=0]}var a=[0,1,2,4,8,16,32,64,128,27,54],c=function(){for(var e=new Array(256),t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;for(var n=[],i=[],s=[[],[],[],[]],r=[[],[],[],[]],o=0,a=0,c=0;c<256;++c){var l=a^a<<1^a<<2^a<<3^a<<4;l=l>>>8^255&l^99,n[o]=l,i[l]=o;var u=e[o],d=e[u],h=e[d],f=257*e[l]^16843008*l;s[0][o]=f<<24|f>>>8,s[1][o]=f<<16|f>>>16,s[2][o]=f<<8|f>>>24,s[3][o]=f,f=16843009*h^65537*d^257*u^16843008*o,r[0][l]=f<<24|f>>>8,r[1][l]=f<<16|f>>>16,r[2][l]=f<<8|f>>>24,r[3][l]=f,0===o?o=a=1:(o=u^e[e[e[h^u]]],a^=e[e[a]])}return{SBOX:n,INV_SBOX:i,SUB_MIX:s,INV_SUB_MIX:r}}();function l(e){this._key=s(e),this._reset()}l.blockSize=16,l.keySize=32,l.prototype.blockSize=l.blockSize,l.prototype.keySize=l.keySize,l.prototype._reset=function(){for(var e=this._key,t=e.length,n=t+6,i=4*(n+1),s=[],r=0;r<t;r++)s[r]=e[r];for(r=t;r<i;r++){var o=s[r-1];r%t==0?(o=o<<8|o>>>24,o=c.SBOX[o>>>24]<<24|c.SBOX[o>>>16&255]<<16|c.SBOX[o>>>8&255]<<8|c.SBOX[255&o],o^=a[r/t|0]<<24):t>6&&r%t==4&&(o=c.SBOX[o>>>24]<<24|c.SBOX[o>>>16&255]<<16|c.SBOX[o>>>8&255]<<8|c.SBOX[255&o]),s[r]=s[r-t]^o}for(var l=[],u=0;u<i;u++){var d=i-u,h=s[d-(u%4?0:4)];l[u]=u<4||d<=4?h:c.INV_SUB_MIX[0][c.SBOX[h>>>24]]^c.INV_SUB_MIX[1][c.SBOX[h>>>16&255]]^c.INV_SUB_MIX[2][c.SBOX[h>>>8&255]]^c.INV_SUB_MIX[3][c.SBOX[255&h]]}this._nRounds=n,this._keySchedule=s,this._invKeySchedule=l},l.prototype.encryptBlockRaw=function(e){return o(e=s(e),this._keySchedule,c.SUB_MIX,c.SBOX,this._nRounds)},l.prototype.encryptBlock=function(e){var t=this.encryptBlockRaw(e),n=i.allocUnsafe(16);return n.writeUInt32BE(t[0],0),n.writeUInt32BE(t[1],4),n.writeUInt32BE(t[2],8),n.writeUInt32BE(t[3],12),n},l.prototype.decryptBlock=function(e){var t=(e=s(e))[1];e[1]=e[3],e[3]=t;var n=o(e,this._invKeySchedule,c.INV_SUB_MIX,c.INV_SBOX,this._nRounds),r=i.allocUnsafe(16);return r.writeUInt32BE(n[0],0),r.writeUInt32BE(n[3],4),r.writeUInt32BE(n[2],8),r.writeUInt32BE(n[1],12),r},l.prototype.scrub=function(){r(this._keySchedule),r(this._invKeySchedule),r(this._key)},e.exports.AES=l},function(e,t,n){var i=n(14).Buffer,s=n(199);e.exports=function(e,t,n,r){if(i.isBuffer(e)||(e=i.from(e,"binary")),t&&(i.isBuffer(t)||(t=i.from(t,"binary")),8!==t.length))throw new RangeError("salt should be Buffer with 8 byte length");for(var o=n/8,a=i.alloc(o),c=i.alloc(r||0),l=i.alloc(0);o>0||r>0;){var u=new s;u.update(l),u.update(e),t&&u.update(t),l=u.digest();var d=0;if(o>0){var h=a.length-o;d=Math.min(o,l.length),l.copy(a,h,0,d),o-=d}if(d<l.length&&r>0){var f=c.length-r,p=Math.min(r,l.length-d);l.copy(c,f,d,d+p),r-=p}}return l.fill(0),{key:a,iv:c}}},function(e,t,n){"use strict";var i=n(25),s=n(39),r=s.getNAF,o=s.getJSF,a=s.assert;function c(e,t){this.type=e,this.p=new i(t.p,16),this.red=t.prime?i.red(t.prime):i.mont(this.p),this.zero=new i(0).toRed(this.red),this.one=new i(1).toRed(this.red),this.two=new i(2).toRed(this.red),this.n=t.n&&new i(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var n=this.n&&this.p.div(this.n);!n||n.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function l(e,t){this.curve=e,this.type=t,this.precomputed=null}e.exports=c,c.prototype.point=function(){throw new Error("Not implemented")},c.prototype.validate=function(){throw new Error("Not implemented")},c.prototype._fixedNafMul=function(e,t){a(e.precomputed);var n=e._getDoubles(),i=r(t,1,this._bitLength),s=(1<<n.step+1)-(n.step%2==0?2:1);s/=3;var o,c,l=[];for(o=0;o<i.length;o+=n.step){c=0;for(var u=o+n.step-1;u>=o;u--)c=(c<<1)+i[u];l.push(c)}for(var d=this.jpoint(null,null,null),h=this.jpoint(null,null,null),f=s;f>0;f--){for(o=0;o<l.length;o++)(c=l[o])===f?h=h.mixedAdd(n.points[o]):c===-f&&(h=h.mixedAdd(n.points[o].neg()));d=d.add(h)}return d.toP()},c.prototype._wnafMul=function(e,t){var n=4,i=e._getNAFPoints(n);n=i.wnd;for(var s=i.points,o=r(t,n,this._bitLength),c=this.jpoint(null,null,null),l=o.length-1;l>=0;l--){for(var u=0;l>=0&&0===o[l];l--)u++;if(l>=0&&u++,c=c.dblp(u),l<0)break;var d=o[l];a(0!==d),c="affine"===e.type?d>0?c.mixedAdd(s[d-1>>1]):c.mixedAdd(s[-d-1>>1].neg()):d>0?c.add(s[d-1>>1]):c.add(s[-d-1>>1].neg())}return"affine"===e.type?c.toP():c},c.prototype._wnafMulAdd=function(e,t,n,i,s){var a,c,l,u=this._wnafT1,d=this._wnafT2,h=this._wnafT3,f=0;for(a=0;a<i;a++){var p=(l=t[a])._getNAFPoints(e);u[a]=p.wnd,d[a]=p.points}for(a=i-1;a>=1;a-=2){var m=a-1,g=a;if(1===u[m]&&1===u[g]){var y=[t[m],null,null,t[g]];0===t[m].y.cmp(t[g].y)?(y[1]=t[m].add(t[g]),y[2]=t[m].toJ().mixedAdd(t[g].neg())):0===t[m].y.cmp(t[g].y.redNeg())?(y[1]=t[m].toJ().mixedAdd(t[g]),y[2]=t[m].add(t[g].neg())):(y[1]=t[m].toJ().mixedAdd(t[g]),y[2]=t[m].toJ().mixedAdd(t[g].neg()));var v=[-3,-1,-5,-7,0,7,5,1,3],S=o(n[m],n[g]);for(f=Math.max(S[0].length,f),h[m]=new Array(f),h[g]=new Array(f),c=0;c<f;c++){var _=0|S[0][c],E=0|S[1][c];h[m][c]=v[3*(_+1)+(E+1)],h[g][c]=0,d[m]=y}}else h[m]=r(n[m],u[m],this._bitLength),h[g]=r(n[g],u[g],this._bitLength),f=Math.max(h[m].length,f),f=Math.max(h[g].length,f)}var w=this.jpoint(null,null,null),b=this._wnafT4;for(a=f;a>=0;a--){for(var C=0;a>=0;){var T=!0;for(c=0;c<i;c++)b[c]=0|h[c][a],0!==b[c]&&(T=!1);if(!T)break;C++,a--}if(a>=0&&C++,w=w.dblp(C),a<0)break;for(c=0;c<i;c++){var M=b[c];0!==M&&(M>0?l=d[c][M-1>>1]:M<0&&(l=d[c][-M-1>>1].neg()),w="affine"===l.type?w.mixedAdd(l):w.add(l))}}for(a=0;a<i;a++)d[a]=null;return s?w:w.toP()},c.BasePoint=l,l.prototype.eq=function(){throw new Error("Not implemented")},l.prototype.validate=function(){return this.curve.validate(this)},c.prototype.decodePoint=function(e,t){e=s.toArray(e,t);var n=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*n)return 6===e[0]?a(e[e.length-1]%2==0):7===e[0]&&a(e[e.length-1]%2==1),this.point(e.slice(1,1+n),e.slice(1+n,1+2*n));if((2===e[0]||3===e[0])&&e.length-1===n)return this.pointFromX(e.slice(1,1+n),3===e[0]);throw new Error("Unknown point format")},l.prototype.encodeCompressed=function(e){return this.encode(e,!0)},l.prototype._encode=function(e){var t=this.curve.p.byteLength(),n=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",t))},l.prototype.encode=function(e,t){return s.encode(this._encode(t),e)},l.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},l.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},l.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],i=this,s=0;s<t;s+=e){for(var r=0;r<e;r++)i=i.dbl();n.push(i)}return{step:e,points:n}},l.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],n=(1<<e)-1,i=1===n?null:this.dbl(),s=1;s<n;s++)t[s]=t[s-1].add(i);return{wnd:e,points:t}},l.prototype._getBeta=function(){return null},l.prototype.dblp=function(e){for(var t=this,n=0;n<e;n++)t=t.dbl();return t}},function(e,t,n){var i=n(796),s=n(807),r=n(808),o=n(206),a=n(338),c=n(14).Buffer;function l(e){var t;"object"!=typeof e||c.isBuffer(e)||(t=e.passphrase,e=e.key),"string"==typeof e&&(e=c.from(e));var n,l,u=r(e,t),d=u.tag,h=u.data;switch(d){case"CERTIFICATE":l=i.certificate.decode(h,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(l||(l=i.PublicKey.decode(h,"der")),n=l.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPublicKey.decode(l.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return l.subjectPrivateKey=l.subjectPublicKey,{type:"ec",data:l};case"1.2.840.10040.4.1":return l.algorithm.params.pub_key=i.DSAparam.decode(l.subjectPublicKey.data,"der"),{type:"dsa",data:l.algorithm.params};default:throw new Error("unknown key id "+n)}throw new Error("unknown key type "+d);case"ENCRYPTED PRIVATE KEY":h=function(e,t){var n=e.algorithm.decrypt.kde.kdeparams.salt,i=parseInt(e.algorithm.decrypt.kde.kdeparams.iters.toString(),10),r=s[e.algorithm.decrypt.cipher.algo.join(".")],l=e.algorithm.decrypt.cipher.iv,u=e.subjectPrivateKey,d=parseInt(r.split("-")[1],10)/8,h=a.pbkdf2Sync(t,n,i,d,"sha1"),f=o.createDecipheriv(r,h,l),p=[];return p.push(f.update(u)),p.push(f.final()),c.concat(p)}(h=i.EncryptedPrivateKey.decode(h,"der"),t);case"PRIVATE KEY":switch(n=(l=i.PrivateKey.decode(h,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPrivateKey.decode(l.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:l.algorithm.curve,privateKey:i.ECPrivateKey.decode(l.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return l.algorithm.params.priv_key=i.DSAparam.decode(l.subjectPrivateKey,"der"),{type:"dsa",params:l.algorithm.params};default:throw new Error("unknown key id "+n)}throw new Error("unknown key type "+d);case"RSA PUBLIC KEY":return i.RSAPublicKey.decode(h,"der");case"RSA PRIVATE KEY":return i.RSAPrivateKey.decode(h,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:i.DSAPrivateKey.decode(h,"der")};case"EC PRIVATE KEY":return{curve:(h=i.ECPrivateKey.decode(h,"der")).parameters.value,privateKey:h.privateKey};default:throw new Error("unknown key type "+d)}}e.exports=l,l.signature=i.signature},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(78);t.assertDefined=(e,t)=>i.assert(null!=e,t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.TelemetryEventNames=i,i.FAULT_PREFIX="Fault/",i.NAME_LOGS_FILE_FAILED=i.FAULT_PREFIX+"name-logfile-failed",i.OPEN_LOGS_FAILED=i.FAULT_PREFIX+"open-logs-failed",i.WRITE_LOGS_FAILED=i.FAULT_PREFIX+"write-logs-failed",i.UNHANDLED_COMMAND_ERROR_FAULT=i.FAULT_PREFIX+"unhandled-commanderror-fault";class s{}t.TelemetryPropertyNames=s,s.FEATURE_NAME="vscode-vsls-command.",s.FEATURE_NAME_V2=s.FEATURE_NAME+"v2.",s.COMMAND_TEXT=s.FEATURE_NAME+"CommandText",s.TELEMETRY_EVENT_VERSION=s.FEATURE_NAME+"TelemetryEventVersion",s.CURRENT_AB_EXPERIMENT=s.FEATURE_NAME+"CurrentAbExperiment",s.CURRENT_AB_EXPERIMENT_GROUP=s.FEATURE_NAME+"CurrentAbExperimentGroup",s.COUNT_OF_CONCURRENT_AB_EXPERIMENTS=s.FEATURE_NAME+"CountOfConcurrentAbExperiments",s.IS_FIRST_ACTIVATION=s.FEATURE_NAME+"IsFirstActivation"},function(e,t,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function s(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)s(n,i)&&(e[i]=n[i])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,i,s){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),s);else for(var r=0;r<i;r++)e[s+r]=t[n+r]},flattenChunks:function(e){var t,n,i,s,r,o;for(i=0,t=0,n=e.length;t<n;t++)i+=e[t].length;for(o=new Uint8Array(i),s=0,t=0,n=e.length;t<n;t++)r=e[t],o.set(r,s),s+=r.length;return o}},o={arraySet:function(e,t,n,i,s){for(var r=0;r<i;r++)e[s+r]=t[n+r]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,r)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(13),s=n(15),r=n(9),o=n(16);class a{static sendShareFault(e,t,n,i){r.Telemetry.sendFault(o.TelemetryEventNames.SHARE_FAULT,e,t,n,i)}static sendJoinFault(e,t,n,i){r.Telemetry.sendFault(o.TelemetryEventNames.JOIN_FAULT,e,t,n,i)}static sendSignInFault(e,t,n,i){r.Telemetry.sendFault(o.TelemetryEventNames.SIGN_IN_FAULT,e,t,n,i)}static sendActivateExtensionFault(e,t,n,i){r.Telemetry.sendFault(o.TelemetryEventNames.ACTIVATE_EXTENSION_FAULT,e,t,n,i)}static sendDeactivateExtensionFault(e,t,n,i){r.Telemetry.sendFault(o.TelemetryEventNames.DEACTIVATE_EXTENSION_FAULT,e,t,n,i)}static sendActivateAgentAsyncFault(e,t,n,i){r.Telemetry.sendFault(o.TelemetryEventNames.ACTIVATE_AGENTASYNC_FAULT,e,t,n,i)}static sendTransition(e,t,n){let i=(new Date).getTime(),s=i-this.lastTransitionTime;this.lastTransitionTime=i;let a=new r.TelemetryEvent(o.TelemetryEventNames.TRANSITION);a.addProperty(o.TelemetryPropertyNames.CURRENT_STATE,e),a.addProperty(o.TelemetryPropertyNames.NEXT_STATE,t),a.addProperty(o.TelemetryPropertyNames.TRANSITION_ACTION,n),a.addMeasure(o.TelemetryPropertyNames.TRANSITION_SEQUENCE,this.transitionSeq++),a.addMeasure(o.TelemetryPropertyNames.TIME_SINCE_LAST_TRANSITION,s),a.send()}static reportChangedSetting(){new r.TelemetryEvent(o.TelemetryEventNames.CHANGE_SETTING).send()}static versionCheckFail(e,t,n){let i=new r.Fault(o.TelemetryEventNames.VERSION_CHECK_FAIL,r.FaultType.User,"Version check failed.");i.addProperty(o.TelemetryPropertyNames.VERSION_PLATFORMNAME,e),i.addProperty(o.TelemetryPropertyNames.VERSION_PLATFORMVERSION,t),i.addProperty(o.TelemetryPropertyNames.VERSION_PLATFORMVERSION_SERVICEPACK,String(n)),i.send()}static ReportFailedAssertion(e){new r.Fault(o.TelemetryEventNames.ASSERT_FAULT,r.FaultType.Error,e,new Error("Assertion Failed")).send()}static async setUserInfo(e){e&&e.emailAddress&&(e.emailAddress!==i.Settings.get(s.SettingKeys.userEmail)&&await i.Settings.save(s.SettingKeys.userEmail,e.emailAddress),e.emailAddress.endsWith("microsoft.com")&&!i.Settings.get(s.SettingKeys.isInternal)&&(await i.Settings.save(s.SettingKeys.isInternal,!0),r.Telemetry.addContextProperty(o.TelemetryPropertyNames.IS_INTERNAL,"true")))}static setServiceEndpoint(e){r.Telemetry.addContextProperty(o.TelemetryPropertyNames.SERVICE_ENDPOINT,e)}static setSettingsContextProperties(){r.Telemetry.addContextProperty(o.TelemetryPropertyNames.IS_INTERNAL,i.Settings.get(s.SettingKeys.isInternal)?"true":"false"),r.Telemetry.addContextProperty(o.TelemetryPropertyNames.IS_CLOUD_ENVIRONMENT,i.Settings.get(s.SettingKeys.isCloudEnvironment)?"true":"false"),r.Telemetry.addContextProperty(o.TelemetryPropertyNames.USER_TEAM_STATUS,i.Settings.get(s.SettingKeys.teamStatus)),r.Telemetry.addContextProperty(o.TelemetryPropertyNames.CONNECTION_MODE,i.Settings.get(s.SettingKeys.connectionMode)),r.Telemetry.addContextProperty(o.TelemetryPropertyNames.FEATURE_FLAGS,JSON.stringify(i.featureFlags))}static genericOperation(e,t,n){const i=new r.TelemetryEvent(e);i.addProperty(o.TelemetryPropertyNames.EVENT_RESULT,this.capitalizeFirstChar(t)),this.setPayloadAndSend(i,n)}static sendFault(e,t,n,i){const s=new r.Fault(e,i||r.FaultType.Error,t);this.setPayloadAndSend(s,n)}static setPayloadAndSend(e,t){if(t)for(let n in t)if(t.hasOwnProperty(n)){const i=void 0===t[n]||null===t[n]?void 0:t[n].toString();e.addProperty(o.TelemetryPropertyNames.FEATURE_NAME+this.capitalizeFirstChar(n),i)}r.Telemetry.correlate(e),e.send()}static capitalizeFirstChar(e){return e.charAt(0).toUpperCase()+e.slice(1)}}t.ExtensionTelemetry=a,a.transitionSeq=0,a.lastTransitionTime=(new Date).getTime()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.accountProvider="accountProvider",e.account="account",e.connectionMode="connectionMode",e.allowGuestDebugControl="allowGuestDebugControl",e.allowGuestTaskControl="allowGuestTaskControl",e.autoShareServers="autoShareServers",e.anonymousGuestApproval="anonymousGuestApproval",e.diagnosticLoggingLevel="diagnosticLoggingLevel",e.diagnosticMode="diagnosticMode",e.allowedDomains="allowedDomains",e.allowReadWriteTerminals="allowReadWriteTerminals",e.featureSet="featureSet",e.nameTagVisibility="nameTagVisibility",e.showReadOnlyUsersInEditor="showReadOnlyUsersInEditor",e.focusBehavior="focusBehavior",e.shareExternalFiles="shareExternalFiles",e.guestApprovalRequired="guestApprovalRequired",e.allowGuestCommandControl="languages.allowGuestCommandControl",e.allowGuestExecuteCells="notebooks.allowGuestExecuteCells",e.joinDebugSessionOption="joinDebugSessionOption",e.showVerboseNotifications="showVerboseNotifications",e.publishWorkspaceInfo="publishWorkspaceInfo",e.diagnosticLogging="diagnosticLogging",e.populateGitCoAuthors="populateGitCoAuthors",e.showInStatusBar="showInStatusBar",e.comments="comments",e.openSharedServers="openSharedServers",e.presence="presence",e.teamStatus="teamStatus",e.allowInvites="allowInvites",e.alwaysFollowHost="alwaysFollowHost",e.remoteLabelAndLinks="remoteLabelAndLinks",e.authFlowTest="authFlowTest",e.nativeAuthFlow="nativeAuthFlow",e.commandPrefix="commandPrefix",e.serviceUri="serviceUri",e.signalRServiceUri="signalRServiceUri",e.scheme="scheme",e.authority="authority",e.canCollectPII="canCollectPII",e.desyncReload="desyncReload",e.userEmail="userEmail",e.isInternal="isInternal",e.isCloudEnvironment="isCloudEnvironment",e.name="name",e.shortName="shortName",e.abbreviation="abbreviation",e.licenseUrl="licenseUrl",e.privacyUrl="privacyUrl",e.hasUsed="hasUsed",e.configName="configName",e.activityTimeout="activityTimeout",e.customAccountAuthReloadFlag="customAccountAuthReloadFlag",e.anonymousAuthReloadFlag="anonymousAuthReloadFlag",e.extensionPermissions="extensionPermissions",e.authenticationProvider="authenticationProvider",e.useClientFileService="useClientFileService",e.remoteSettingsUri="remoteSettingsUri",e.remoteSettingsUpdateMinutes="remoteSettingsUpdateMinutes",e.textSearchResultsLimit="textSearchResultsLimit",e.textSearchPreviewLimit="textSearchPreviewLimit",e.whatsNewUri="whatsNewUri",e.runsInVSCodeDev="runsInVSCodeDev",e.joinWorkspaceId="joinWorkspaceId",e.performanceLogging="performanceLogging",e.anonymousUserName="anonymousUserName",e.microphoneId="microphoneId",e.speakerId="speakerId",e.newChatDisplayDate="newChatDisplayDate",e.newAudioDisplayDate="newAudioDisplayDate",e.showLauncherInstallNotification="showLauncherInstallNotification",e.showLauncherError="showLauncherError",e.sessionCount="sessionCount",e.dontRequestFeedback="dontRequestFeedback",e.dontRequestAdditionalFeedback="dontRequestAdditionalFeedback",e.surveyShownDate="surveyShownDate",e.firstActivationTime="firstActivationTime"}(t.SettingKeys||(t.SettingKeys={})),function(e){e.stable="stable",e.insiders="insiders"}(t.FeatureSet||(t.FeatureSet={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(227),s=n(162),r=n(32);class o{static get(e){return o.settingsProvider.get(e)}static getMemento(e){return o.settingsProvider.mementoConfig.get(e)}static saveMemento(e,t){return o.settingsProvider.mementoConfig.save(e,t)}static getUri(e,t){const n=t?o.getMemento(e):o.get(e);if(n)return a(n)}static get scheme(){return"vsls"}static get isVSLSTeamMember(){return!!o.get(s.SettingKeys.teamStatus)}static get isInternalFeatureSet(){return o.get(s.SettingKeys.isInternal)}static get isInsidersFeatureSet(){const e=o.get(s.SettingKeys.featureSet);return!!e&&s.FeatureSet[e]===s.FeatureSet.insiders}static get isNativeAuth(){return!!o.get(s.SettingKeys.nativeAuthFlow)}static save(e,t,n=!0){return o.settingsProvider.save(e,t,n)}}function a(e){try{return r.parse(e)}catch(e){return}}t.Settings=o,o.settingsProvider=i.settingsProviderInstance,t.featureFlags={api:!1,localUndo:!1,localRedo:!1,multiRootWorkspaceVSIDE:!1,propagateFolderEvents:!1,agentExtension:!1,comments:!0,attemptReconnection:!0},t.parseUrl=a},function(e,t,n){e.exports=n(918)},function(e,t,n){"use strict";(function(e){var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.Yes=1]="Yes",e[e.No=2]="No"}(n||(n={}));let i=n.Unknown;t.checkDebugging=function(){if(i===n.Unknown){i=n.No;for(let t of e.execArgv)if(t.startsWith("--inspect-brk")||t.startsWith("--debug")){i=n.Yes;break}}return i===n.Yes}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(950),r=n(50);var o;!function(e){e.Never="Never",e.Activity="Activity",e.Always="Always"}(o=t.NameTagVisibility||(t.NameTagVisibility={}));class a{constructor(e){this.color=e,this.backgroundCssColor=p.toCssColor(this.color.backgroundColor),this.textCssColor=p.toCssColor(this.color.textColor)}dispose(){this.decoration&&this.decoration.dispose()}render(e,t,n,i){this.decoration&&(this.decoration.dispose(),this.decoration=void 0),e&&e.length&&t&&n&&(this._createDecorationStyle(t,n,i),this._renderCore(e,t,n))}}t.TextEditorDecoratorBase=a;class c extends a{constructor(e,t){super(e),this.displayName=t}_renderCore(e,t,n){if(!this.decoration)return;const s={range:new i.Range(t,t)};n.isEmpty&&(s.hoverMessage=this.displayName),e.forEach(e=>{e.setDecorations(this.decoration,[s])})}_createDecorationStyle(e,t){const n=0===e.character?"0.17":"0.25",s={position:"absolute",display:"inline-block",top:"0","font-size":"200%","font-weight":"bold","z-index":1},r=p.stringifyCssProperties(s),o={rangeBehavior:i.DecorationRangeBehavior.ClosedClosed,before:{contentText:"",margin:`0px 0px 0px -${n}ch`,color:this.backgroundCssColor,textDecoration:`none; ${r}`}};this.decoration=i.window.createTextEditorDecorationType(o)}}t.CursorDecorator=c;class l extends a{constructor(e,t){super(e),this.displayName=t}updateDisplayName(e){this.displayName=e}_renderCore(e,t,n){if(!this.decoration)return;const s=new i.Range(t,t);e.forEach(e=>{e.setDecorations(this.decoration,[s])})}_createDecorationStyle(e,t,n){let s=!0;(0===e.line||t&&!t.isEmpty&&!t.isSingleLine&&t.end.isEqual(e))&&(s=!(!n||0!==e.line||1!==n));const r={position:"absolute",top:`${s?-1:1}rem`,"border-radius":"0.15rem",padding:"0px 0.5ch",display:"inline-block","pointer-events":"none",color:this.textCssColor,"font-size":"0.7rem","z-index":1,"font-weight":"bold"},o=p.stringifyCssProperties(r),a={backgroundColor:this.backgroundCssColor,rangeBehavior:i.DecorationRangeBehavior.ClosedClosed,textDecoration:"none; position: relative; z-index: 1;",after:{contentText:this.displayName,backgroundColor:this.backgroundCssColor,textDecoration:`none; ${o}`}};this.decoration=i.window.createTextEditorDecorationType(a)}}t.NameTagDecorator=l;class u extends a{constructor(e){super(e.withBackgroundAlpha(.6))}_renderCore(e,t,n){if(!this.decoration)return;const s=new i.Range(t,t);e.forEach(e=>{e.setDecorations(this.decoration,[s])})}_createDecorationStyle(e,t){this.decoration=i.window.createTextEditorDecorationType({overviewRulerLane:i.OverviewRulerLane.Full,overviewRulerColor:this.backgroundCssColor})}}t.RulerDecorator=u;class d extends a{constructor(e,t){super(e.withBackgroundAlpha(.35)),this.displayName=t}_renderCore(e,t,n){if(n.isEmpty)return;const i={range:n,hoverMessage:this.displayName};e.forEach(e=>{e.setDecorations(this.decoration,[i])})}_createDecorationStyle(e,t){this.decoration=i.window.createTextEditorDecorationType({backgroundColor:this.backgroundCssColor,borderRadius:"0.1rem"})}}t.SelectionDecorator=d;t.ClientDecoratorManager=class{constructor(e,t,n,i){this.clientId=e,this.clientDisplayName=t,this.clientColor=f.requestColor(e),this.nameTagVisibility=n,this.positionTracker=i,this.selectionDecorator=new d(this.clientColor,this.clientDisplayName),this.cursorDecorator=new c(this.clientColor,this.clientDisplayName),this.nameTagDecorator=new l(this.clientColor,this.clientDisplayName),this.rulerDecorator=new u(this.clientColor)}dispose(){this.nameTagVisibilityTimer&&clearTimeout(this.nameTagVisibilityTimer),this.disposeDecorators()}updateNameTag(e){this.nameTagDecorator.updateDisplayName(e)}updateDecorators(){var e;const t=this.positionTracker.getClientPosition(this.clientId),n=[],s=(null==t?void 0:t.documentPosition)||(null==t?void 0:t.notebookPosition);let a;if(s){i.window.visibleTextEditors.forEach(e=>{e.document.uri.toString()===s.documentUri.toString()&&(e.document.uri.scheme.startsWith(r.PathManager.notebookCellScheme)&&(a=e.document.lineCount),n.push(e))});try{i.window.visibleNotebookEditors.forEach(e=>{e.document.uri.toString()===s.documentUri.toString()&&n.push(e)})}catch(e){}}if(!n.length)return void this.disposeDecorators();const c=s.range,l=(null===(e=t.documentPosition)||void 0===e?void 0:e.isReversed)?c.start:c.end;switch(this.selectionDecorator.render(n,l,c),this.rulerDecorator.render(n,l,c),this.nameTagVisibility){case o.Always:this.cursorDecorator.render(n,l,c),this.nameTagDecorator.render(n,l,c,a);break;case o.Never:this.cursorDecorator.render(n,l,c),this.nameTagDecorator&&this.nameTagDecorator.dispose();break;case o.Activity:default:this.nameTagVisibilityTimer&&clearTimeout(this.nameTagVisibilityTimer),this.cursorDecorator.render(n,l,c),this.nameTagDecorator.render(n,l,c,a),this.nameTagVisibilityTimer=setTimeout(()=>{this.nameTagDecorator.dispose()},1500)}}disposeDecorators(){this.selectionDecorator.dispose(),this.cursorDecorator.dispose(),this.nameTagDecorator.dispose(),this.rulerDecorator.dispose()}};class h{constructor(e,t){this.backgroundColor=e,this.textColor=t}withBackgroundAlpha(e){e=Math.max(0,e),e=Math.min(1,e);const t=new i.Color(this.backgroundColor.red,this.backgroundColor.green,this.backgroundColor.blue,e);return new h(t,this.textColor)}}class f{static requestColor(e){return f._initcolors(),f.allColors[e%f.allColors.length]}static _initcolors(){if(f.allColors)return;const e=[["rgba(0, 0, 0, 1)","rgba(255, 185, 0, 1)"],["rgba(255, 255, 255, 1)","rgba(16, 124, 16, 1)"],["rgba(255, 255, 255, 1)","rgba(180, 0, 158, 1)"],["rgba(0, 0, 0, 1)","rgba(186, 216, 10, 1)"],["rgba(0, 0, 0, 1)","rgba(255, 140, 0, 1)"],["rgba(255, 255, 255, 1)","rgba(227, 0, 140, 1)"],["rgba(255, 255, 255, 1)","rgba(92, 45, 145, 1)"],["rgba(0, 0, 0, 1)","rgba(0, 178, 148, 1)"],["rgba(0, 0, 0, 1)","rgba(255, 241, 0, 1)"],["rgba(0, 0, 0, 1)","rgba(180, 160, 255, 1)"]],t=i.workspace.getConfiguration("workbench.colorCustomizations");let n=t&&t["cascade.cursorForegroundBackgroundColors"];n&&Array.isArray(n)&&(f.allColors=f.parseColors(n)),f.allColors&&f.allColors.length||(f.allColors=f.parseColors(e))}static parseColors(e){return e.map(e=>{if(e&&2===e.length){const t=p.toVSCodeColor(e[0]),n=p.toVSCodeColor(e[1]);if(t&&n)return new h(n,t)}}).filter(e=>!!e).reverse()}}t.SharedColors=f;class p{static stringifyCssProperties(e){return Object.keys(e).map(t=>`${t}: ${e[t]};`).join(" ")}static toCssColor(e){return`rgba(${Math.round(255*e.red)}, ${Math.round(255*e.green)}, ${Math.round(255*e.blue)}, ${e.alpha})`}static toVSCodeColor(e){const t=s.get.rgb(e);if(t){const[e,n,s,r]=t;return new i.Color(e/255,n/255,s/255,r)}return null}static isSamePosition(e,t){return null!==e&&null!==t&&e.isEqual(t)}static isSameRange(e,t){return null!==e&&null!==t&&e.isEqual(t)}}t.DecoratorUtils=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(956);t.ActivityType=i.ActivityType,t.activitySource=i.activitySource},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.TreatmentVariables=i,i.VSCodeConfig="vscode",i.NativeAuthEnabled="nativeAuth",i.CheckForCancelBeforeReturningResponse="checkForCancelBeforeReturningResponse",i.TransientWorkspaces="transientWorkspaces",i.DontShowWelcomePage="dontShowLiveShareWelcomePage",i.FollowIndicator="followIndicator",i.ResyncOnMisappliedEdit="resyncOnMisappliedEdit",i.FocusIndividual="focusIndividual",i.FollowIndicators="followIndicators"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(24),s=n(94),r=n(15),o=n(9),a=n(16);class c{static startSession(e,t){this.activeTimeRecorder=new l(()=>{this.collaborateBlockEvent=new o.TimedEvent(a.TelemetryEventNames.COLLABORATE_BLOCK,!1,!0)},e=>{this.collaborateBlockEvent.addMeasure(a.TelemetryPropertyNames.ACTIVE_COLLABORATION_DURATION,e),this.collaborateBlockEvent.end(o.TelemetryResult.Success)}),c.sessionTimedEvent=o.Telemetry.startTimedEvent(a.TelemetryEventNames.SESSION),o.Telemetry.addContextProperty(a.TelemetryPropertyNames.IS_HOST,e),c.reportSettings(t)}static endSession(e,t){this.activeTimeRecorder.stop(),c.sessionEvent.emit(c.sessionEndEventName),c.sessionTimedEvent.addProperty(a.TelemetryPropertyNames.GUESTS_BY_IDE,JSON.stringify(e)),c.sessionTimedEvent.addProperty(a.TelemetryPropertyNames.DISTINCT_GUESTS_BY_IDE,JSON.stringify(t)),c.sessionTimedEvent.addMeasure(a.TelemetryPropertyNames.ACTIVE_COLLABORATION_DURATION,this.activeTimeRecorder.activeDuration),c.sessionTimedEvent.addMeasure(a.TelemetryPropertyNames.ACTIVE_COLLABORATION_BLOCKS,this.activeTimeRecorder.activeBlocks),c.sessionTimedEvent.end(o.TelemetryResult.Success),o.Telemetry.removeContextProperty(a.TelemetryPropertyNames.CONVERSATION_ID),o.Telemetry.removeContextProperty(a.TelemetryPropertyNames.IS_HOST),o.Telemetry.removeContextProperty(a.TelemetryPropertyNames.SESSION_ID)}static reportSettings(e){const t=Object.assign({},e);t[r.SettingKeys.account]=o.cleanSensitiveInformation(e[r.SettingKeys.account]),t[r.SettingKeys.accountProvider]=o.cleanSensitiveInformation(e[r.SettingKeys.accountProvider]);const n=new o.TelemetryEvent(a.TelemetryEventNames.REPORT_SETTINGS);n.addProperty(a.TelemetryPropertyNames.SETTING_VALUES,JSON.stringify(t)),n.send()}static recordActivity(){var e;s.SessionContext.hasCollaborators&&(null===(e=this.activeTimeRecorder)||void 0===e||e.recordActivity())}}t.SessionTelemetry=c,c.sessionEvent=new i.EventEmitter,c.sessionEndEventName="sessionEnd";class l{constructor(e,t,n=u){this.onBlockStart=e,this.onBlockEnd=t,this.idleTime=n,this.duration=0,this.blocks=0,this.firstActivity=0,this.lastActivity=0,this.newBlock=!0}endActiveBlock(){if(this.newBlock)return;const e=this.lastActivity-this.firstActivity;this.duration+=e,this.blocks++,this.newBlock=!0,this.onBlockEnd(e)}recordActivity(){clearTimeout(this.idleTimer);const e=(new Date).getTime();this.newBlock&&(this.newBlock=!1,this.firstActivity=e,this.onBlockStart()),this.lastActivity=e,this.idleTimer=setTimeout(()=>this.endActiveBlock(),this.idleTime)}stop(){this.endActiveBlock()}get activeDuration(){return this.duration}get activeBlocks(){return this.blocks}}t.ActiveTimeRecorder=l;const u=3e5},function(e,t,n){"use strict";var i=n(982);function s(e){this.message=e}s.prototype=new Error,s.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new s("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(i(e.split(".")[n]))}catch(e){throw new s("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{static get extensionName(){if(!this.extensionNameInternal)throw new Error("`extensionName` is not set, set `extensionName` first.");return this.extensionNameInternal}static set extensionName(e){if(this.extensionNameInternal)throw new Error("`extensionName` is already set.");this.extensionNameInternal=e}}t.Constants=i,i.PRODUCT_NAME="Account",i.UPDATE_TOKENS_THROTTLE_PERIOD_MS=5e3,i.VSONLINE_INTEGRATION_TEST="vso-integration-test",i.extensionNameInternal=null},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.curves=void 0,t.curves=[{shortName:"P-256",name:"nistp256",oid:"1.2.840.10045.3.1.7",keySize:256},{shortName:"P-384",name:"nistp384",oid:"1.3.132.0.34",keySize:384},{shortName:"P-521",name:"nistp521",oid:"1.3.132.0.35",keySize:521}]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Queue=void 0;class i{constructor(){this.array=new Array,this.first=0,this.count=0,this.version=0}get size(){return this.count}enqueue(e){if(this.count===this.array.length){const e=new Array(Math.max(16,2*this.count));for(let t=0;t<this.count;t++)e[t]=this.array[(this.first+t)%this.count];this.array=e,this.first=0}this.array[(this.first+this.count)%this.array.length]=e,this.count++,this.version++}dequeue(){if(0===this.count)return;const e=this.array[this.first];return this.array[this.first]=void 0,this.first=(this.first+1)%this.array.length,this.count--,this.version++,e}peek(){if(0===this.count)return;return this.array[this.first]}clear(){this.first=0,this.count=0,this.array.fill(void 0),this.version++}*[Symbol.iterator](){const e=this.version;for(let t=0;t<this.count;t++){const n=this.array[(this.first+t)%this.array.length];if(yield n,this.version!==e)throw new Error("Iterator is invalid due to changes in the collection.")}}}t.Queue=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshService=void 0;t.SshService=class{constructor(e){this.session=e}dispose(){}async onSessionRequest(e,t){this.session.raiseSessionRequest(e)}async onChannelOpening(e,t){this.session.raiseChannelOpening(e)}async onChannelRequest(e,t,n){}async sendMessage(e,t){await this.session.sendMessage(e,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(9),r=n(1024),o=n(16),a=n(29),c=n(94),l=n(21),u=n(23),d=n(31),h=n(22),f=n(15),p=n(13),m=n(49);let g,y;var v;function S(){return u.sessionStateTracker.State===l.SessionState.Shared&&a.workspaceSessionInfoTracker.workspaceSessionInfo?a.workspaceSessionInfoTracker.workspaceSessionInfo.joinUri:null}t.showWelcomeNotification=async()=>{await p.Settings.save(f.SettingKeys.whatsNewUri,""),new s.TelemetryEvent(o.TelemetryEventNames.WELCOME_PAGE_TOAST_SHOWN).send();const e={title:"Get started"},n=await i.window.showInformationMessage("VS Live Share installed! You can now collaboratively edit and debug with your team in real time.",e),r=new s.TelemetryEvent(o.TelemetryEventNames.WELCOME_PAGE_TOAST_SHOWN_INTERACTION);let a=!1;n&&n.title===e.title?(await t.showWelcomePage(v.Install),r.addProperty("openedPage",!0),a=!0):r.addProperty("openedPage",!1),r.addProperty(o.TelemetryPropertyNames.SHOWED_INITIAL_INSTALL_INFO_PAGE,a),r.send()},t.showWelcomePage=async e=>{const t=new s.TelemetryEvent(o.TelemetryEventNames.WELCOME_PAGE_SHOWN);t.addProperty("source",e),t.addProperty("state",l.SessionState[u.sessionStateTracker.State]),t.addProperty("type","web-view"),await async function(e){if(g)return void g.reveal(i.ViewColumn.One);let t=h.ExtensionUtil.getExtensionUri("welcomePage");const n=[t];h.ExtensionUtil.isNode()&&(t=t.with({scheme:"vscode-resource"}));g=i.window.createWebviewPanel("vsliveshare-welcome-page","vsliveshare-welcome-page",i.ViewColumn.Active,{enableScripts:!0,localResourceRoots:n});const r=i.workspace.getConfiguration();y||(y=new _(t));y.joinUri=S(),y.sessionState=u.sessionStateTracker.State,y.sessionHigherState=u.sessionStateTracker.HigherState,y.isWebview=!0,y.isFirstTimeJoin=e===v.FirstJoin,y.isPostReloadJoin=!!r.get("vsliveshare.join.reload.workspaceId"),y.isAuthenticated=d.userAuthStateTracker.IsSignedIn,y.hasCollaborators=c.SessionContext.hasCollaborators,g.webview.html=y.html,g.webview.onDidReceiveMessage((function(e){switch(e.command){case"copyUrl":return new s.TelemetryEvent(o.TelemetryEventNames.WELCOME_PAGE_COPY_CLICKED).send(),void i.commands.executeCommand("liveshare.collaboration.link.copy");case"onClick":return void new s.TelemetryEvent(o.TelemetryEventNames.WELCOME_PAGE_LINK_CLICKED).addProperty(o.TelemetryPropertyNames.WELCOME_PAGE_LINK,e.text).send();case"shareWithYourself":new s.TelemetryEvent(o.TelemetryEventNames.WELCOME_PAGE_LINK_CLICKED).addProperty(o.TelemetryPropertyNames.WELCOME_PAGE_LINK,e.text).send();const t={link:S(),newWindow:!0};return void i.commands.executeCommand(`${p.Settings.get(f.SettingKeys.commandPrefix)}.join`,t);case"signIn":new s.TelemetryEvent(o.TelemetryEventNames.WELCOME_PAGE_LINK_CLICKED).addProperty(o.TelemetryPropertyNames.WELCOME_PAGE_LINK,e.text).send();const n={};return void i.commands.executeCommand("liveshare.start",n);case"startFromWelcomePage":return void i.commands.executeCommand("liveshare.startFromWelcomePage");default:return}}));let a=[];a.push(u.sessionStateTracker.onStateChanged(async e=>{y.isPostReloadJoin=!!r.get("vsliveshare.join.reload.workspaceId"),y.joinUri=S(),y.sessionState=e.newState,y.sessionHigherState=u.sessionStateTracker.HigherState,y.sessionAction=e.newAction,y.isAuthenticated=d.userAuthStateTracker.IsSignedIn,g.webview.html=y.html}));a.push(c.SessionContext.onCollaboratorsJoined(async()=>{y.hasCollaborators=c.SessionContext.hasCollaborators,g.webview.html=y.html})),g.onDidDispose(()=>{const e=new s.TelemetryEvent(o.TelemetryEventNames.WELCOME_PAGE_DISMISSED);for(const e of a)e.dispose();a=[],g=null,e.send()})}(e)},function(e){e.Help="Help",e.Install="Install",e.Sharing="Sharing",e.FirstShare="FirstShare",e.FirstJoin="FirstJoin"}(v=t.WelcomePageSource||(t.WelcomePageSource={}));class _{constructor(e){this.baseWelcomePagePath=e}get html(){const e=`${this.baseWelcomePagePath.toString()}/welcomePageMain.js`,t=`${this.baseWelcomePagePath.toString()}/welcomePage.css`;let n=r.welcomePage;const i=m().replace(/-/g,""),s=`<script nonce="${i}">const vslsCurrentSessionState=${this.sessionState}; vslsCurrentSessionHigherState=${this.sessionHigherState}; \n        vslsCurrentSessionAction=${this.sessionAction}; const vslsIsWebView=true; const vslsIsFirstTimeJoin=${this.isFirstTimeJoin}; \n        const vslsIsPostReloadJoin = ${this.isPostReloadJoin}; const vslsSessionState=${JSON.stringify(l.SessionState)}; const vslsSessionAction=${JSON.stringify(l.SessionAction)}; \n        const vslsIsAuthenticated=${this.isAuthenticated};\n        const hasCollaborators=${this.hasCollaborators};<\/script>`;return n=n.replace("${mainScriptUri}",e).replace("${styleUri}",t),n.replace(/\$\{joinUri\}/g,this.joinUri).replace('<script nonce="${nonce}"><\/script>',s).replace(/\$\{nonce\}/g,i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(33),s=n(61),r=n(23),o=n(16),a=n(21);t.telemetryStatusCommandDecorator=function(){return i.DecoratorHelper.setupDecorator(e=>new c(i.DecoratorHelper.getCoreCommand(e),e,s.dependencies.sessionContext(),s.dependencies.contextUtil()))};class c{constructor(e,t,n,i){this.command=e,this.next=t,this.sessionContext=n,this.contextUtil=i}async invoke(e,t){let n=void 0;const i={},s=[`liveshare.SessionState.${this.deriveEventName(a.SessionState[r.sessionStateTracker.State],i)}`],c={},l=[],u={},d=[],h=e=>{t.trace.info(`SessionContext: State update from "${a.SessionState[e.oldState]}" (${a.SessionAction[e.oldAction]}) to "${a.SessionState[e.newState]}" (${a.SessionAction[e.newAction]}).`);const n=`liveshare.SessionState.${this.deriveEventName(a.SessionState[e.newState],i)}`;s.push(n);const r=`liveshare.SessionAction.${this.deriveEventName(a.SessionAction[e.newAction],c)}`;l.push(r)},f=e=>{const n=this.contextUtil.scrubPrefix(e.oldStatus),i=this.contextUtil.scrubPrefix(e.newStatus);t.trace.info(`SessionContext: Status update from "${n}" to "${i}".`);const s=`liveshare.SessionStatus.${this.deriveEventName(i,u)}`;t.telemetryEvent.markTime(s),d.push(s)};let p,m;try{p=r.sessionStateTracker.onStateChanged(h),m=r.sessionStateTracker.onStatusChanged(f),t.telemetryEvent.addProperty(o.TelemetryPropertyNames.STATE_EVENT_FIRST,`liveshare.SessionState.${a.SessionState[r.sessionStateTracker.State]}`.toLowerCase()),n=await this.next.invoke(e,t)}finally{t.telemetryEvent.addProperty(o.TelemetryPropertyNames.STATE_EVENT_ORDER,s.length>0?String(s).toLowerCase():""),t.telemetryEvent.addProperty(o.TelemetryPropertyNames.STATUS_EVENT_ORDER,d.length>0?String(d).toLowerCase():""),t.telemetryEvent.addProperty(o.TelemetryPropertyNames.STATE_EVENT_LAST,`liveshare.SessionState.${a.SessionState[r.sessionStateTracker.State]}`.toLowerCase()),p&&p.dispose(),m&&m.dispose()}return n}deriveEventName(e,t){const n=t[e]=void 0!==t[e]?t[e]+1:0;return n>0?`${e+n}`:e}}t.TelemetryStatusCommandDecorator=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),s=n(61),r=n(33),o=n(22),a=n(31),c=n(23),l=n(16),u=n(13),d=n(449),h=n(15),f=n(242),p=n(130);t.authenticationCommandDecorator=function(e){return r.DecoratorHelper.setupDecorator(t=>new m(t,s.dependencies.authenticationFlow(),s.dependencies.authenticationProvider(),d.isAnonymousAuthReloadFlagValid,e))};class m{constructor(e,t,n,i,s){this.next=e,this.authenticationFlow=t,this.authenticationProvider=n,this.isAnonymousAuthReloadFlagValidFunction=i,this.authDecoratorOptions=s,this.authAttemptCount=0,this.authDecoratorOptions=Object.assign({authAttemptMax:1},this.authDecoratorOptions)}async shouldShowAnonymousToast(e,t){const n=e.isAllowAnonymous;if(n&&e.disableAnonymousPrompt)return!1;let i="liveshare.join.postReload"==t.commandText||await this.isAnonymousAuthReloadFlagValidFunction();return a.userAuthStateTracker.isCurrentUserAnonymous()&&n&&!i}async invoke(e,t){e=Object.assign({isNativeAuth:u.Settings.get(h.SettingKeys.nativeAuthFlow)},e),t.telemetryEvent.addProperty(l.TelemetryPropertyNames.DEFAULT_SIGN_IN,!!e.isDefaultSignIn),e.isDefaultSignIn||await a.userAuthStateTracker.defaultAuthAttemptCompleteSignal.promise;let n=void 0;try{let i=this.authenticationProvider.isAuthenticated();if(t.telemetryEvent.addProperty(l.TelemetryPropertyNames.COMMAND_ALLOWS_ANONYMOUS,e.isAllowAnonymous),t.telemetryEvent.addProperty(l.TelemetryPropertyNames.COMMAND_SHOULED_SKIP_ANONYMOUS_PROMPT,e.disableAnonymousPrompt),t.telemetryEvent.addMeasure(l.TelemetryPropertyNames.COMMAND_AUTH_RETRY_COUNT,this.authAttemptCount),t.telemetryEvent.addPropertyIfNotExists(l.TelemetryPropertyNames.COMMAND_STARTED_UNAUTHENTICATED,!i),t.telemetryEvent.addProperty(l.TelemetryPropertyNames.COMMAND_STARTED_BLOCKING_AUTH,!1),!i){try{i=await p.TimeTracker.timeIt("attemptAuthenticationCheckFlow",async()=>await this.authenticationFlow.attemptAuthenticationCheckFlow(e,t))}catch(e){t.trace.error(`Authentication check error: ${e}`),i=!1}if(t.telemetryEvent.addProperty(l.TelemetryPropertyNames.COMMAND_AUTO_AUTHED_RESULT,i),e.isDefaultSignIn){if(a.userAuthStateTracker.completeDefaultAuthAttempt(),!i)throw new f.NonBlockingError("Authentication check returned false.");return i}}!e.isAllowAnonymous&&a.userAuthStateTracker.isCurrentUserAnonymous()&&(i=!1,t.telemetryEvent.addProperty(l.TelemetryPropertyNames.COMMAND_AUTO_AUTHED_ANONYMOUSLY_BUT_ANONYMOUS_NOT_ALLOWED,!0));const s=await this.shouldShowAnonymousToast(e,t);if(!i||s){let n;t.telemetryEvent.addProperty(l.TelemetryPropertyNames.COMMAND_DID_AUTH_FULL,!i),t.telemetryEvent.addProperty(l.TelemetryPropertyNames.COMMAND_STARTED_BLOCKING_AUTH,!0),t.telemetryEvent.addProperty(l.TelemetryPropertyNames.COMMAND_SHOULD_SHOW_ANONYMOUS_TOAST,s),e.isAllowAnonymous&&(n=await this.authenticationFlow.attemptPromptedUserAnonymousLoginFlow(e,t),t.telemetryEvent.addProperty(l.TelemetryPropertyNames.COMMAND_BLOCKING_ANONYMOUS_LOGIN_FLOW_RESULT,n)),n||(t.telemetryEvent.addProperty(l.TelemetryPropertyNames.COMMAND_BLOCKING_NON_ANONYMOUS_LOGIN_FLOW_RESULT,!1),await this.authenticationFlow.attemptPromptedUserLoginFlow(e,t),t.telemetryEvent.addProperty(l.TelemetryPropertyNames.COMMAND_BLOCKING_NON_ANONYMOUS_LOGIN_FLOW_RESULT,!0)),i=!0}const{cancellationTokenSource:r}=t;if(r&&r.token.isCancellationRequested)return;o.ExtensionUtil.setCommandContext("liveshare:isAnonymousUser",a.userAuthStateTracker.isCurrentUserAnonymous()),void 0!==this.authDecoratorOptions.statusPostAuth&&this.shouldPerformSessionAction(e)&&c.sessionStateTracker.transition(this.authDecoratorOptions.statusPostAuth),n=await this.next.invoke(e,t)}catch(s){if(s.code!==i.vsls.ErrorCodes.UnauthorizedHttpStatusCode)throw s;if(!(this.authAttemptCount++<this.authDecoratorOptions.authAttemptMax))throw t.trace.info("AuthRetry: No authentication fail retries left."),s;t.trace.info(`AuthRetry: About to retry, attempt ${this.authAttemptCount}.`),t.telemetryEvent.addProperty(l.TelemetryPropertyNames.SIGN_IN_RETRIES,this.authAttemptCount),await this.authenticationProvider.clearCache(),n=await this.invoke(e,t)}return n}shouldPerformSessionAction(e){return!this.authDecoratorOptions.validateSessionAction||this.authDecoratorOptions.validateSessionAction(e)}}t.AuthenticationCommandDecorator=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(33),r=n(61);t.cancellationDecorator=function(){return s.DecoratorHelper.setupDecorator(e=>new o(s.DecoratorHelper.getCoreCommand(e),e,r.dependencies.sessionContext()))};class o{constructor(e,t,n){this.command=e,this.next=t,this.sessionContext=n}async invoke(e,t){let n;return this.cancelPreviousCommandIfRunning(),o.currentCancellationTokenSource=new i.CancellationTokenSource,t.cancellationTokenSource=o.currentCancellationTokenSource,n=await this.next.invoke(e,t),n}cancelPreviousCommandIfRunning(){const e=o.currentCancellationTokenSource,t=e&&e.token;t&&!t.isCancellationRequested&&e.cancel()}}t.CancellationDecorator=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1068);t.WorkspaceClient=i.WorkspaceClient;var s=n(457);t.SshHelpers=s.SshHelpers,t.isNode=s.isNode},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CallbackContainer=class{constructor(){this.callbacks=[]}get items(){return this.callbacks}add(e){return e&&this.callbacks.push(e),{dispose:()=>{const t=this.callbacks.indexOf(e);-1!==t&&this.callbacks.splice(t,1)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.curves=void 0,t.curves=[{shortName:"P-256",name:"nistp256",oid:"1.2.840.10045.3.1.7",keySize:256},{shortName:"P-384",name:"nistp384",oid:"1.3.132.0.34",keySize:384},{shortName:"P-521",name:"nistp521",oid:"1.3.132.0.35",keySize:521}]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Queue=void 0;class i{constructor(){this.array=new Array,this.first=0,this.count=0,this.version=0}get size(){return this.count}enqueue(e){if(this.count===this.array.length){const e=new Array(Math.max(16,2*this.count));for(let t=0;t<this.count;t++)e[t]=this.array[(this.first+t)%this.count];this.array=e,this.first=0}this.array[(this.first+this.count)%this.array.length]=e,this.count++,this.version++}dequeue(){if(0===this.count)return;const e=this.array[this.first];return this.array[this.first]=void 0,this.first=(this.first+1)%this.array.length,this.count--,this.version++,e}peek(){if(0===this.count)return;return this.array[this.first]}clear(){this.first=0,this.count=0,this.array.fill(void 0),this.version++}*[Symbol.iterator](){const e=this.version;for(let t=0;t<this.count;t++){const n=this.array[(this.first+t)%this.array.length];if(yield n,this.version!==e)throw new Error("Iterator is invalid due to changes in the collection.")}}}t.Queue=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshService=void 0;t.SshService=class{constructor(e){this.session=e}dispose(){}async onSessionRequest(e,t){this.session.raiseSessionRequest(e)}async onChannelOpening(e,t){this.session.raiseChannelOpening(e)}async onChannelRequest(e,t,n){}async sendMessage(e,t){await this.session.sendMessage(e,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5);function s(e){switch(e){case i.contactProtocol.PresenceStatus.Available:return 1;case i.contactProtocol.PresenceStatus.Away:return 2;case i.contactProtocol.PresenceStatus.Busy:return 3;case i.contactProtocol.PresenceStatus.DoNotDisturb:return 4;default:return 100}}t.defaultCompareContacts=function(e,t){const n=s(e.contact.status),i=s(t.contact.status);return n>i?1:n<i?-1:e.contact.displayName>t.contact.displayName?1:e.contact.displayName<t.contact.displayName?-1:0}},function(e,t,n){},function(e,t,n){"use strict";var i=n(76).Duplex,s=n(59),r=n(14).Buffer;function o(e){if(!(this instanceof o))return new o(e);if(this._bufs=[],this.length=0,"function"==typeof e){this._callback=e;var t=function(e){this._callback&&(this._callback(e),this._callback=null)}.bind(this);this.on("pipe",(function(e){e.on("error",t)})),this.on("unpipe",(function(e){e.removeListener("error",t)}))}else this.append(e);i.call(this)}s.inherits(o,i),o.prototype._offset=function(e){var t,n=0,i=0;if(0===e)return[0,0];for(;i<this._bufs.length;i++){if(e<(t=n+this._bufs[i].length)||i==this._bufs.length-1)return[i,e-n];n=t}},o.prototype._reverseOffset=function(e){for(var t=e[0],n=e[1],i=0;i<t;i++)n+=this._bufs[i].length;return n},o.prototype.append=function(e){var t=0;if(r.isBuffer(e))this._appendBuffer(e);else if(Array.isArray(e))for(;t<e.length;t++)this.append(e[t]);else if(e instanceof o)for(;t<e._bufs.length;t++)this.append(e._bufs[t]);else null!=e&&("number"==typeof e&&(e=e.toString()),this._appendBuffer(r.from(e)));return this},o.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length},o.prototype._write=function(e,t,n){this._appendBuffer(e),"function"==typeof n&&n()},o.prototype._read=function(e){if(!this.length)return this.push(null);e=Math.min(e,this.length),this.push(this.slice(0,e)),this.consume(e)},o.prototype.end=function(e){i.prototype.end.call(this,e),this._callback&&(this._callback(null,this.slice()),this._callback=null)},o.prototype.get=function(e){if(!(e>this.length||e<0)){var t=this._offset(e);return this._bufs[t[0]][t[1]]}},o.prototype.slice=function(e,t){return"number"==typeof e&&e<0&&(e+=this.length),"number"==typeof t&&t<0&&(t+=this.length),this.copy(null,0,e,t)},o.prototype.copy=function(e,t,n,i){if(("number"!=typeof n||n<0)&&(n=0),("number"!=typeof i||i>this.length)&&(i=this.length),n>=this.length)return e||r.alloc(0);if(i<=0)return e||r.alloc(0);var s,o,a=!!e,c=this._offset(n),l=i-n,u=l,d=a&&t||0,h=c[1];if(0===n&&i==this.length){if(!a)return 1===this._bufs.length?this._bufs[0]:r.concat(this._bufs,this.length);for(o=0;o<this._bufs.length;o++)this._bufs[o].copy(e,d),d+=this._bufs[o].length;return e}if(u<=this._bufs[c[0]].length-h)return a?this._bufs[c[0]].copy(e,t,h,h+u):this._bufs[c[0]].slice(h,h+u);for(a||(e=r.allocUnsafe(l)),o=c[0];o<this._bufs.length;o++){if(!(u>(s=this._bufs[o].length-h))){this._bufs[o].copy(e,d,h,h+u),d+=s;break}this._bufs[o].copy(e,d,h),d+=s,u-=s,h&&(h=0)}return e.length>d?e.slice(0,d):e},o.prototype.shallowSlice=function(e,t){if(e=e||0,t="number"!=typeof t?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return new o;var n=this._offset(e),i=this._offset(t),s=this._bufs.slice(n[0],i[0]+1);return 0==i[1]?s.pop():s[s.length-1]=s[s.length-1].slice(0,i[1]),0!=n[1]&&(s[0]=s[0].slice(n[1])),new o(s)},o.prototype.toString=function(e,t,n){return this.slice(t,n).toString(e)},o.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;){if(!(e>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},o.prototype.duplicate=function(){for(var e=0,t=new o;e<this._bufs.length;e++)t.append(this._bufs[e]);return t},o.prototype.destroy=function(){this._bufs.length=0,this.length=0,this.push(null)},o.prototype.indexOf=function(e,t,n){if(void 0===n&&"string"==typeof t&&(n=t,t=void 0),"function"==typeof e||Array.isArray(e))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if("number"==typeof e?e=r.from([e]):"string"==typeof e?e=r.from(e,n):e instanceof o?e=e.slice():r.isBuffer(e)||(e=r.from(e)),t=Number(t||0),isNaN(t)&&(t=0),t<0&&(t=this.length+t),t<0&&(t=0),0===e.length)return t>this.length?this.length:t;for(var i=this._offset(t),s=i[0],a=i[1];s<this._bufs.length;s++){for(var c=this._bufs[s];a<c.length;){if(c.length-a>=e.length){var l=c.indexOf(e,a);if(-1!==l)return this._reverseOffset([s,l]);a=c.length-e.length+1}else{var u=this._reverseOffset([s,a]);if(this._match(u,e))return u;a++}}a=0}return-1},o.prototype._match=function(e,t){if(this.length-e<t.length)return!1;for(var n=0;n<t.length;n++)if(this.get(e+n)!==t[n])return!1;return!0},function(){var e={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(var t in e)!function(t){o.prototype[t]=null===e[t]?function(e,n){return this.slice(e,e+n)[t](0,n)}:function(n){return this.slice(n,n+e[t])[t](0)}}(t)}(),e.exports=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Deferred=class{constructor(e){this.state=e,this._isResolved=!1,this._isRejected=!1,this.promise=new Promise((e,t)=>{this.resolvePromise=e,this.rejectPromise=t})}get isCompleted(){return this._isResolved||this._isRejected}get isResolved(){return this._isResolved}get isRejected(){return this._isRejected}get error(){return this._error}resolve(e){return!this.isCompleted&&(this.resolvePromise(e),this._isResolved=!0,!0)}reject(e){return!this.isCompleted&&(this.rejectPromise(e),this._error=e,this._isRejected=!0,!0)}}},function(e,t,n){var i=n(115);t.createCodec=a,t.install=function(e){for(var t in e)r.prototype[t]=o(r.prototype[t],e[t])},t.filter=function(e){return i(e)?function(e){return e=e.slice(),function(n){return e.reduce(t,n)};function t(e,t){return t(e)}}(e):e};var s=n(40);function r(e){if(!(this instanceof r))return new r(e);this.options=e,this.init()}function o(e,t){return e&&t?function(){return e.apply(this,arguments),t.apply(this,arguments)}:e||t}function a(e){return new r(e)}r.prototype.init=function(){var e=this.options;return e&&e.uint8array&&(this.bufferish=s.Uint8Array),this},t.preset=a({preset:!0})},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});const r=n(4),o=n(5),a=n(0),c=n(67),l=n(0),u=n(4);function d(){return a.comments&&a.comments.createCommentController&&c.gte(c.coerce(a.version),"1.35.0")&&r.Settings.get(r.SettingKeys.comments)}t.commentsSupported=d;t.commentManagerFactory=(e,t)=>{const{controllerDecorator:n,errorNotificationMethodDecorator:r,telemetryMethodDecorator:c}=e.methodDecorators();let v=class{constructor(e,t){this.threads=new Map,this.commentCountChanged=new a.EventEmitter,this.disposables=[],this.pathManager=e.pathManager,this.service=t.commentService,this.session=e.sessionContext(),this.hostCommentService=t.hostCommentService,this.fileService=e.fileService,this.trace=e.trace().withName("CommentManager")}get sessionId(){return this.session.coeditingClient.clientID}get participantId(){const e=this.session.collaboratorManager.getUserId(this.sessionId);if(!e)throw new Error("Cannot get UserId for current Live Share user");return e}get commentCount(){let e=0;for(let[,{vscodeThread:{comments:t}}]of this.threads)e+=t.length;return e}get onCommentCountChanged(){return this.commentCountChanged.event}async init(){d()&&(u.ControllerHelper.register(this,this.disposables),this.isActive=!0,this.service().onCommentThreadChanged(this.serviceCommentThreadChanged,this,this.disposables),this.session.coeditingClient.positionTracker.onNamedPositionsChanged(e=>this.positionChanged(e)),this.getThreads().catch(e=>this.trace.error("Error getting comment threads",e)))}async dispose(){if(!this.isActive)return;this.isActive=!1,this.commentController=void 0;for(const e of this.disposables)e.dispose();this.disposables=[],this.getThreadsPromise=void 0;const e=this.threads.size>0;this.threads.clear(),e&&this.commentCountChanged.fire()}async provideCommentingRanges(e,t){if(!this.isActive||!e)return[];const n=this.getDocumentPath(e);if(!n)return[];if(p()){const[e]=await this.fileService().listAsync([n],{includeExcluded:!0,includeHidden:!0});if(!e||!this.isActive)return[];const{attributes:t}=e;if(t===o.vsls.FileAttributes.External||t===o.vsls.FileAttributes.Excluded||t===o.vsls.FileAttributes.Hidden)return[]}else if(e.uri.path.startsWith(u.PathManager.externalPrefix))return[];return this.trackThreadPositions(e,n),[new a.Range(0,0,e.lineCount-1,0)]}async createThread({text:e,thread:t}){if(t)if(this.isActive)try{const{resource:n,range:i}=t;if(!n)throw new Error("No resource provided on VSCode thread");if(!this.isSupportedScheme(n))throw new Error(`Unexpected scheme '${n.scheme}' of VSCode thread.resource`);const s=this.pathManager().localPathToRelativePath(n);if(!s)throw new Error(`Failed to get relative document path for VSCode document ${n.toString()}`);const r=this.createVslsComment(e),o={threadContext:{documentVersion:0,filePath:s,rightFileStart:{line:i.start.line,offset:i.start.character},rightFileEnd:{line:i.end.line,offset:i.end.character}},lastUpdatedSessionId:this.sessionId,rightSnapshotIndex:1,comments:[r]},c=await a.workspace.openTextDocument(n),l=this.cloneVslsThreadIfNeeded(await this.service().createCommentThreadAsync(o));if(!this.isActive)return void t.dispose();if(!l)throw new Error("CommentService.createCommentThreadAsync() returned null unexpectedly");const u=l.threadId;if("number"!=typeof u)throw new Error("CommentService.createCommentThreadAsync() returned a thread with missing or incorrect type threadId");if(!l.comments||0===l.comments.length)throw new Error("CommentService.createCommentThreadAsync() returned a thread without comments");if(l.comments.length>1)throw new Error("CommentService.createCommentThreadAsync() returned a thread with more than one comment");this.addVSCodeComment(l,t),p()&&(t.contextValue="deletable"),this.threads.set(u,{vslsThread:l,vscodeThread:t}),this.trackThreadPosition(u,c),this.commentCountChanged.fire()}catch(e){throw t.dispose(),e}else t.dispose()}async deleteThread(e){if(e){if(e.comments.length){const{threadId:t}=e.comments[0];for(let n=e.comments.length-1;n>=0&&this.isActive;--n){const{commentId:i}=e.comments[n];await this.service().deleteCommentAsync(t,i,this.sessionId)}this.threads.delete(t),this.commentCountChanged.fire()}e.dispose()}}async reply({text:e,thread:t}){if(!this.isActive)return;if(!t)return;if(!t.comments.length)return;const{vslsThread:n}=t.comments[0],i=n.comments.length?n.comments[n.comments.length-1].commentId:-1,s=this.createVslsComment(e,n.threadId,i),r=await this.service().createCommentAsync(s);this.isActive?(this.addVSCodeComment(n,t,r),this.commentCountChanged.fire()):t.dispose()}async editComment(e){m(e,!0)}async saveComment(e){if(!m(e,!1))return;if(!this.isActive)return;const{commentId:t,text:n,threadId:i,vslsThread:s,vscodeThread:r}=e,o=s.comments.findIndex(e=>e.commentId===t);if(-1===o)return;const a=this.cloneVslsCommentIfNeeded(await this.service().updateCommentAsync(i,t,this.sessionId,n));if(a.commentId!==t)throw new Error("Comment service updateCommentAsync() changed commentId unexpectedly");s.comments[o]=a}async cancelEditComment(e){if(!e)return;if(!this.isActive)return;const{commentId:t,vslsThread:n,vscodeThread:i}=e,{text:s}=n.comments.find(e=>e.commentId===t);s&&m(e,!1,s)}async deleteComment(e){if(!e)return;if(!this.isActive)return;const{commentId:t,vscodeThread:n,threadId:i,vslsThread:s}=e;if(!s.comments.length)return void n.dispose();const r=s.comments.findIndex(e=>e.commentId===t);if(-1!==r){if(s.comments.length>1){if(0===r)throw new u.ByDesignError(u.localize("commentManager.deleteOtherComments"));s.comments.splice(r,1)}else this.threads.delete(i);g(n,t),await this.service().deleteCommentAsync(i,t,this.sessionId),this.commentCountChanged.fire()}else g(n,t)}async getThreads(){this.getThreadsPromise||(this.getThreadsPromise=this.getThreadsFromService()),await this.getThreadsPromise}async getThreadsFromService(){let e;try{e=await this.service().getAllCommentThreadsAsync()}catch(e){return this.trace.info("Cannot get comment threads from the host. Comments may be disabled or not supported on the host.",e),void await this.dispose()}if(this.isActive){if(!this.commentController){const e=u.localize("commentManager.controllerLabel");this.commentController=a.comments.createCommentController("vsls-comments",e),this.commentController.commentingRangeProvider=this,this.disposables.push(this.commentController)}for(const t of e)this.createVscodeThread(t);e.length&&this.commentCountChanged.fire()}}createVscodeThread(e){if(!this.isActive||!e||this.threads.has(e.threadId))return;e=this.cloneVslsThreadIfNeeded(e);const{threadId:t,threadContext:n,comments:i}=e;if(!n||!n.rightFileStart)return;const s=this.getResource(n.filePath);if(!s)return;const r=f(n),o=this.commentController.createCommentThread(s,r,[]);o.comments=(i||[]).map(t=>this.createVscodeComment(t,o,e)),o.label=y(o),o.collapsibleState=a.CommentThreadCollapsibleState.Collapsed,p()&&(o.contextValue="deletable"),this.threads.set(t,{vslsThread:e,vscodeThread:o})}cloneVslsThreadIfNeeded(e){if(!p()||!e)return e;const t=e.threadContext?Object.assign({},e.threadContext):void 0,n=e.comments?e.comments.map(e=>this.cloneVslsCommentIfNeeded(e)):void 0;return Object.assign({},e,{comments:n,threadContext:t})}cloneVslsCommentIfNeeded(e){if(!e)throw new Error("The comment is null or undefined");if(!p())return e;const t=e.likers?e.likers.slice():void 0;return Object.assign({},e,{likers:t})}getResource(e){return e&&(p()?this.pathManager().relativePathToLocalPath(e):l.Uri.parse(`${u.VSLS_SCHEME}:${e}`))}async trackThreadPositions(e,t){try{if(await this.getThreads(),!this.isActive)return;if(p()){for(const t of this.threads.keys())this.trackThreadPosition(t,e);return}const n=await this.service().getAllCommentThreadsAsync();if(!this.isActive)return;for(const{threadId:i,threadContext:s}of n){if(s.filePath!==t)continue;const{vslsThread:n,vscodeThread:r,isTracked:o}=this.threads.get(i);if(!r||o)continue;const a=f(s);a.start.line===r.range.start.line&&a.start.character===r.range.start.character&&a.end.line===r.range.end.line&&a.end.character===r.range.end.character||(n.threadContext=s,r.range=a),this.trackThreadPosition(i,e)}}catch(e){this.trace.error(`Error tracking document positions in ${t}`,e)}}trackThreadPosition(e,t){const n=this.threads.get(e);if(n&&!n.isTracked&&n.vscodeThread.resource.toString()===t.uri.toString()&&this.isActive){const i=this.pathManager().localPathToRelativePath(t.uri),s="commentThread_"+e.toString(10);this.session.coeditingClient.positionTracker.setNamedPosition(s,i,t,n.vscodeThread.range,!1),n.isTracked=!0}}getDocumentPath(e){if(e&&e.uri&&this.isSupportedScheme(e.uri))return this.pathManager().localPathToRelativePath(e.uri)}isSupportedScheme(e){return(p()?[u.FILE_SCHEME,u.GITHUB_DEV_SCHEME]:[u.VSLS_SCHEME]).includes(e.scheme)}createVslsComment(e,t=0,n=-1){const i=this.sessionId,s=this.participantId;return{lastUpdatedSessionId:i,parentId:n,threadId:t,participantLabel:this.session.collaboratorManager.getDisplayName(i),participantId:s,text:e}}createVscodeComment(e,t,n){if(!e)throw new Error("The comment is null or undefined");const{commentId:i,text:s,participantId:r,participantLabel:o}=e,c=new a.MarkdownString(s),l=o||r,u=r===this.participantId;return new h(i,c,l,u,t,n)}addVSCodeComment(e,t,n,i){n?(n=this.cloneVslsCommentIfNeeded(n),e.comments.push(n)):n=e.comments[e.comments.length-1];const s=this.createVscodeComment(n,t,e);t.comments=[...t.comments,s],t.label=y(t)}serviceCommentThreadChanged(e){if(!e)return;if(e.newThread)return void(e.newThread.lastUpdatedSessionId!==this.sessionId&&(this.createVscodeThread(e.newThread),this.commentCountChanged.fire()));if(!e.changedComment||e.changedComment.lastUpdatedSessionId===this.sessionId)return;const{commentId:t,threadId:n,isDeleted:i}=e.changedComment,{vslsThread:s,vscodeThread:r}=this.threads.get(n);if(!r)return;const o=s.comments.findIndex(e=>e.commentId===t);if(i){if(-1===o)return;return g(r,t),s.comments.splice(o,1),s.comments.length||this.threads.delete(n),void this.commentCountChanged.fire()}if(-1===o)return this.addVSCodeComment(s,r,e.changedComment),void this.commentCountChanged.fire();const a=this.cloneVslsCommentIfNeeded(e.changedComment),c=this.createVscodeComment(a,r,s);s.comments[o]=a,r.comments=r.comments.map(e=>e.commentId===t?c:e)}positionChanged(e){for(const t of e){if(!t.name||!t.name.startsWith("commentThread_"))continue;const e=Number.parseInt(t.name.substr("commentThread_".length),10);if(isNaN(e))continue;const{vslsThread:n,vscodeThread:i}=this.threads.get(e);if(!i||!n)continue;const{rightFileStart:s,rightFileEnd:r}=n.threadContext;if(!s||!r)continue;const o={line:t.range.start.line,offset:t.range.start.character},a={line:t.range.end.line,offset:t.range.end.character};s.line===o.line&&s.offset===o.offset&&r.line===a.line&&r.offset===a.offset||(n.threadContext.rightFileStart=o,n.threadContext.rightFileEnd=a,i.range=t.range,p()&&this.hostCommentService().updateThreadPosition(e,o,a))}}};return i([r(u.localize("commentManager.cannotCreateCommentThread"),u.TelemetryEventNames.CREATE_COMMENT_THREAD_FAULT),c(u.TelemetryEventNames.CREATE_COMMENT_THREAD,u.TelemetryEventNames.CREATE_COMMENT_THREAD_FAULT,"CommentManager.createThread"),u.commandBindingDecorator("liveshare.comments.createThread"),s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Promise)],v.prototype,"createThread",null),i([r(u.localize("commentManager.cannotDeleteThread"),u.TelemetryEventNames.DELETE_COMMENT_THREAD_FAULT),c(u.TelemetryEventNames.DELETE_COMMENT_THREAD,u.TelemetryEventNames.DELETE_COMMENT_THREAD_FAULT,"CommentManager.deleteThread"),u.commandBindingDecorator("liveshare.comments.deleteThread"),s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Promise)],v.prototype,"deleteThread",null),i([r(u.localize("commentManager.cannotReply"),u.TelemetryEventNames.REPLY_COMMENT_FAULT),c(u.TelemetryEventNames.REPLY_COMMENT,u.TelemetryEventNames.REPLY_COMMENT_FAULT,"CommentManager.reply"),u.commandBindingDecorator("liveshare.comments.reply"),s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Promise)],v.prototype,"reply",null),i([r(u.localize("commentManager.cannotEditComment"),u.TelemetryEventNames.EDIT_COMMENT_FAULT),c(u.TelemetryEventNames.EDIT_COMMENT,u.TelemetryEventNames.EDIT_COMMENT_FAULT,"CommentManager.editComment"),u.commandBindingDecorator("liveshare.comments.editComment"),s("design:type",Function),s("design:paramtypes",[h]),s("design:returntype",Promise)],v.prototype,"editComment",null),i([r(u.localize("commentManager.cannotSaveComment"),u.TelemetryEventNames.SAVE_COMMENT_FAULT),c(u.TelemetryEventNames.SAVE_COMMENT,u.TelemetryEventNames.SAVE_COMMENT_FAULT,"CommentManager.saveComment"),u.commandBindingDecorator("liveshare.comments.saveComment"),s("design:type",Function),s("design:paramtypes",[h]),s("design:returntype",Promise)],v.prototype,"saveComment",null),i([r(u.localize("commentManager.cannotCancelEditComment"),u.TelemetryEventNames.CANCEL_EDIT_COMMENT_FAULT),c(u.TelemetryEventNames.CANCEL_EDIT_COMMENT,u.TelemetryEventNames.CANCEL_EDIT_COMMENT_FAULT,"CommentManager.cancelEditComment"),u.commandBindingDecorator("liveshare.comments.cancelEditComment"),s("design:type",Function),s("design:paramtypes",[h]),s("design:returntype",Promise)],v.prototype,"cancelEditComment",null),i([r(u.localize("commentManager.cannotDeleteComment"),u.TelemetryEventNames.DELETE_COMMENT_FAULT),c(u.TelemetryEventNames.DELETE_COMMENT,u.TelemetryEventNames.DELETE_COMMENT_FAULT,"CommentManager.deleteComment"),u.commandBindingDecorator("liveshare.comments.deleteComment"),s("design:type",Function),s("design:paramtypes",[h]),s("design:returntype",Promise)],v.prototype,"deleteComment",null),v=i([n,s("design:paramtypes",[Object,Object])],v),new v(e,t)};class h{constructor(e,t,n,i,s,r){this.commentId=e,this.body=t,this.vscodeThread=s,this.vslsThread=r,this.mode=a.CommentMode.Preview,this.author={name:n},i?this.contextValue="editable_deletable":p()&&(this.contextValue="deletable")}get text(){return"string"==typeof this.body?this.body:this.body?this.body.value:void 0}get threadId(){return this.vslsThread.threadId}}function f(e){const t=new a.Position(e.rightFileStart.line,e.rightFileStart.offset),n=e.rightFileEnd?new a.Position(e.rightFileEnd.line,e.rightFileEnd.offset):t;return new a.Range(t,n)}function p(){return u.sessionStateTracker.State===u.SessionState.Shared||u.sessionStateTracker.State===u.SessionState.SharingInProgress}function m(e,t,n){if(!e)return!1;const{vscodeThread:i,commentId:s}=e;if("number"!=typeof s||isNaN(s))throw new Error("VSCode comment does not have id");if(!i)throw new Error("VSCode comment does not have parent");return i.comments=i.comments.map(e=>(e.commentId===s&&(e.mode=t?a.CommentMode.Editing:a.CommentMode.Preview,n&&(e.body=new a.MarkdownString(n))),e)),i.collapsibleState=a.CommentThreadCollapsibleState.Expanded,!0}function g(e,t){e.comments=e.comments.filter(e=>e.commentId!==t),e.comments.length?e.label=y(e):e.dispose()}function y(e){if(!e)throw new Error("vscodeThread is null or undefined");const t=new Set(e.comments.map(e=>e.author.name));let n="";for(const e of t)e&&(n=n?`${n}, ${e}`:e);const i=u.localize("commentManager.participants");return n?`${i} ${n}`:void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.create=function(e){return{dispose:e}}}(t.Disposable||(t.Disposable={})),function(e){const t={dispose(){}};e.None=function(){return t}}(t.Event||(t.Event={}));class i{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(this._callbacks){for(var n=!1,i=0,s=this._callbacks.length;i<s;i++)if(this._callbacks[i]===e){if(this._contexts[i]===t)return this._callbacks.splice(i,1),void this._contexts.splice(i,1);n=!0}if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}}invoke(...e){if(!this._callbacks)return[];for(var t=[],n=this._callbacks.slice(0),i=this._contexts.slice(0),s=0,r=n.length;s<r;s++)try{t.push(n[s].apply(i[s],e))}catch(e){console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class s{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,n)=>{let r;return this._callbacks||(this._callbacks=new i),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t),r={dispose:()=>{this._callbacks.remove(e,t),r.dispose=s._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this)}},Array.isArray(n)&&n.push(r),r}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}t.Emitter=s,s._noop=function(){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(9),s=n(4);class r{}t.LanguageServiceTelemetryEventNames=r,r.LSPSERVER_INIT_FAULT=s.TelemetryEventNames.FAULT_PREFIX+"init-lspserver-fault",r.SUMMARIZE_LSREQUESTS="summarize-lsrequests",r.GET_DIAGNOSTICS_FAULT=s.TelemetryEventNames.FAULT_PREFIX+"get-diagnostics-fault",r.RESET_LANGUAGE_SERVICES="reset-languageservices",r.SHOW_OPPORTUNISTIC_CODE_LENS="show-opportunisticcodelens",r.INVOKE_OPPORTUNISTIC_CODE_LENS="invoke-opportunisticcodelens";class o{}t.LanuageServiceTelemetryPropertyNames=o,o.SERVICED_REQUESTS=s.TelemetryPropertyNames.FEATURE_NAME+"ServicedRequests",o.REJECTED_REQUESTS=s.TelemetryPropertyNames.FEATURE_NAME+"RejectedRequests",o.UNACKNOWLEDGED_HOST_CHANGES_REJECTS=s.TelemetryPropertyNames.FEATURE_NAME+"UnacknowledgedHostChangesRejects",o.REJECTED_REQUESTS_DETAILS=s.TelemetryPropertyNames.FEATURE_NAME+"RejectedRequestsDetails",t.summarizeLsRequests=function(e,t,n,s){let a=new i.TelemetryEvent(r.SUMMARIZE_LSREQUESTS);a.addMeasure(o.SERVICED_REQUESTS,e),a.addMeasure(o.REJECTED_REQUESTS,t),a.addMeasure(o.UNACKNOWLEDGED_HOST_CHANGES_REJECTS,n),a.addProperty(o.REJECTED_REQUESTS_DETAILS,JSON.stringify(s)),a.send()}},function(e,t,n){"use strict";function i(e){return function(e){return e>=97&&e<=122}(e)||function(e){return e>=65&&e<=90}(e)}function s(e,t,n=e.length){if("string"!=typeof e||"string"!=typeof t)return!1;for(let s=0;s<n;s++){const n=e.charCodeAt(s),r=t.charCodeAt(s);if(n!==r)if(i(n)&&i(r)){let e=Math.abs(n-r);if(0!==e&&32!==e)return!1}else if(String.fromCharCode(n).toLowerCase()!==String.fromCharCode(r).toLowerCase())return!1}return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.stripWildcards=function(e){return e.replace(/\*/g,"")},t.startsWith=function(e,t){if(e.length<t.length)return!1;if(e===t)return!0;for(let n=0;n<t.length;n++)if(e[n]!==t[n])return!1;return!0},t.startsWithIgnoreCase=function(e,t){const n=t.length;return!(t.length>e.length)&&s(e,t,n)},t.endsWith=function(e,t){let n=e.length-t.length;return n>0?e.indexOf(t,n)===n:0===n&&e===t},t.equalsIgnoreCase=function(e,t){return(e?e.length:0)===(t?t.length:0)&&s(e,t)},t.fuzzyContains=function(e,t){if(!e||!t)return!1;if(e.length<t.length)return!1;const n=t.length,i=e.toLowerCase();let s=0,r=-1;for(;s<n;){let e=i.indexOf(t[s],r+1);if(e<0)return!1;r=e,s++}return!0}},function(e,t,n){var i;try{i=n(458)}catch(e){}finally{if(i||"undefined"==typeof window||(i=window),!i)throw new Error("Could not determine global this")}var s=i.WebSocket||i.MozWebSocket,r=n(1349);function o(e,t){return t?new s(e,t):new s(e)}s&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(o,e,{get:function(){return s[e]}})})),e.exports={w3cwebsocket:s?o:null,version:r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(112);t.LogLevel=i.LogLevel;var s=n(195);t.LogValueType=s.LogValueType},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.Text=1]="Text",e[e.Path=2]="Path",e[e.Email=3]="Email"}(t.LogValueType||(t.LogValueType={}))},function(e,t){t.read=function(e,t,n,i,s){var r,o,a=8*s-i-1,c=(1<<a)-1,l=c>>1,u=-7,d=n?s-1:0,h=n?-1:1,f=e[t+d];for(d+=h,r=f&(1<<-u)-1,f>>=-u,u+=a;u>0;r=256*r+e[t+d],d+=h,u-=8);for(o=r&(1<<-u)-1,r>>=-u,u+=i;u>0;o=256*o+e[t+d],d+=h,u-=8);if(0===r)r=1-l;else{if(r===c)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,i),r-=l}return(f?-1:1)*o*Math.pow(2,r-i)},t.write=function(e,t,n,i,s,r){var o,a,c,l=8*r-s-1,u=(1<<l)-1,d=u>>1,h=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:r-1,p=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+d>=1?h/c:h*Math.pow(2,1-d))*c>=2&&(o++,c/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(t*c-1)*Math.pow(2,s),o+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,s),o=0));s>=8;e[n+f]=255&a,f+=p,a/=256,s-=8);for(o=o<<s|a,l+=s;l>0;e[n+f]=255&o,f+=p,o/=256,l-=8);e[n+f-p]|=128*m}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(152),s=n(116);let r=e.from("\r","ascii")[0],o=e.from("\n","ascii")[0];class a{constructor(t="utf8"){this.encoding=t,this.index=0,this.buffer=e.allocUnsafe(8192)}append(t){var n=t;if("string"==typeof t){var i=t,s=e.byteLength(i,this.encoding);(n=e.allocUnsafe(s)).write(i,0,s,this.encoding)}if(this.buffer.length-this.index>=n.length)n.copy(this.buffer,this.index,0,n.length);else{var r=8192*(Math.ceil((this.index+n.length)/8192)+1);0===this.index?(this.buffer=e.allocUnsafe(r),n.copy(this.buffer,0,0,n.length)):this.buffer=e.concat([this.buffer.slice(0,this.index),n],r)}this.index+=n.length}tryReadHeaders(){let e=void 0,t=0;for(;t+3<this.index&&(this.buffer[t]!==r||this.buffer[t+1]!==o||this.buffer[t+2]!==r||this.buffer[t+3]!==o);)t++;if(t+3>=this.index)return e;e=Object.create(null),this.buffer.toString("ascii",0,t).split("\r\n").forEach(t=>{let n=t.indexOf(":");if(-1===n)throw new Error("Message header must separate key and value using :");let i=t.substr(0,n),s=t.substr(n+1).trim();e[i]=s});let n=t+4;return this.buffer=this.buffer.slice(n),this.index=this.index-n,e}tryReadContent(e){if(this.index<e)return null;let t=this.buffer.toString(this.encoding,0,e),n=e;return this.buffer.copy(this.buffer,0,n),this.index=this.index-n,t}get numberOfBytes(){return this.index}}!function(e){e.is=function(e){let t=e;return t&&s.func(t.listen)&&s.func(t.dispose)&&s.func(t.onError)&&s.func(t.onClose)&&s.func(t.onPartialMessage)}}(t.MessageReader||(t.MessageReader={}));class c{constructor(){this.errorEmitter=new i.Emitter,this.closeEmitter=new i.Emitter,this.partialMessageEmitter=new i.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader recevied error. Reason: ${s.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=c;class l extends c{constructor(e,t="utf8"){super(),this.readable=e,this.buffer=new a(t),this._partialMessageTimeout=1e4}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e,this.readable.on("data",e=>{this.onData(e)}),this.readable.on("error",e=>this.fireError(e)),this.readable.on("close",()=>this.fireClose())}onData(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){let e=this.buffer.tryReadHeaders();if(!e)return;let t=e["Content-Length"];if(!t)throw new Error("Header must provide a Content-Length property.");let n=parseInt(t);if(isNaN(n))throw new Error("Content-Length value must be a number.");this.nextMessageLength=n}var t=this.buffer.tryReadContent(this.nextMessageLength);if(null===t)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.messageToken++;var n=JSON.parse(t);this.callback(n)}}clearPartialMessageTimer(){this.partialMessageTimer&&(clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}t.StreamMessageReader=l;t.IPCMessageReader=class extends c{constructor(e){super(),this.process=e;let t=this.process;t.on("error",e=>this.fireError(e)),t.on("close",()=>this.fireClose())}listen(e){this.process.on("message",e)}};t.SocketMessageReader=class extends l{constructor(e,t="utf-8"){super(e,t)}}}).call(this,n(3).Buffer)},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(152),s=n(116);!function(e){e.is=function(e){let t=e;return t&&s.func(t.dispose)&&s.func(t.onClose)&&s.func(t.onError)&&s.func(t.write)}}(t.MessageWriter||(t.MessageWriter={}));class r{constructor(){this.errorEmitter=new i.Emitter,this.closeEmitter=new i.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer recevied error. Reason: ${s.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=r;t.StreamMessageWriter=class extends r{constructor(e,t="utf8"){super(),this.writable=e,this.encoding=t,this.errorCount=0,this.writable.on("error",e=>this.fireError(e)),this.writable.on("close",()=>this.fireClose())}write(t){let n=JSON.stringify(t),i=["Content-Length: ",e.byteLength(n,this.encoding).toString(),"\r\n","\r\n"];try{this.writable.write(i.join(""),"ascii"),this.writable.write(n,this.encoding),this.errorCount=0}catch(e){this.errorCount++,this.fireError(e,t,this.errorCount)}}};t.IPCMessageWriter=class extends r{constructor(e){super(),this.process=e,this.errorCount=0,this.queue=[],this.sending=!1;let t=this.process;t.on("error",e=>this.fireError(e)),t.on("close",()=>this.fireClose)}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){try{this.process.send&&(this.sending=!0,this.process.send(e,void 0,void 0,t=>{this.sending=!1,t?(this.errorCount++,this.fireError(t,e,this.errorCount)):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())}))}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}};t.SocketMessageWriter=class extends r{constructor(e,t="utf8"){super(),this.socket=e,this.queue=[],this.sending=!1,this.encoding=t,this.errorCount=0,this.socket.on("error",e=>this.fireError(e)),this.socket.on("close",()=>this.fireClose())}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(t){let n=JSON.stringify(t),i=["Content-Length: ",e.byteLength(n,this.encoding).toString(),"\r\n","\r\n"];try{this.sending=!0,this.socket.write(i.join(""),"ascii",e=>{e&&this.handleError(e,t);try{this.socket.write(n,this.encoding,e=>{this.sending=!1,e?this.handleError(e,t):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())})}catch(e){this.handleError(e,t)}})}catch(e){this.handleError(e,t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}}}).call(this,n(3).Buffer)},function(e,t,n){"use strict";var i=n(12),s=n(328),r=n(14).Buffer,o=new Array(16);function a(){s.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function c(e,t){return e<<t|e>>>32-t}function l(e,t,n,i,s,r,o){return c(e+(t&n|~t&i)+s+r|0,o)+t|0}function u(e,t,n,i,s,r,o){return c(e+(t&i|n&~i)+s+r|0,o)+t|0}function d(e,t,n,i,s,r,o){return c(e+(t^n^i)+s+r|0,o)+t|0}function h(e,t,n,i,s,r,o){return c(e+(n^(t|~i))+s+r|0,o)+t|0}i(a,s),a.prototype._update=function(){for(var e=o,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);var n=this._a,i=this._b,s=this._c,r=this._d;n=l(n,i,s,r,e[0],3614090360,7),r=l(r,n,i,s,e[1],3905402710,12),s=l(s,r,n,i,e[2],606105819,17),i=l(i,s,r,n,e[3],3250441966,22),n=l(n,i,s,r,e[4],4118548399,7),r=l(r,n,i,s,e[5],1200080426,12),s=l(s,r,n,i,e[6],2821735955,17),i=l(i,s,r,n,e[7],4249261313,22),n=l(n,i,s,r,e[8],1770035416,7),r=l(r,n,i,s,e[9],2336552879,12),s=l(s,r,n,i,e[10],4294925233,17),i=l(i,s,r,n,e[11],2304563134,22),n=l(n,i,s,r,e[12],1804603682,7),r=l(r,n,i,s,e[13],4254626195,12),s=l(s,r,n,i,e[14],2792965006,17),n=u(n,i=l(i,s,r,n,e[15],1236535329,22),s,r,e[1],4129170786,5),r=u(r,n,i,s,e[6],3225465664,9),s=u(s,r,n,i,e[11],643717713,14),i=u(i,s,r,n,e[0],3921069994,20),n=u(n,i,s,r,e[5],3593408605,5),r=u(r,n,i,s,e[10],38016083,9),s=u(s,r,n,i,e[15],3634488961,14),i=u(i,s,r,n,e[4],3889429448,20),n=u(n,i,s,r,e[9],568446438,5),r=u(r,n,i,s,e[14],3275163606,9),s=u(s,r,n,i,e[3],4107603335,14),i=u(i,s,r,n,e[8],1163531501,20),n=u(n,i,s,r,e[13],2850285829,5),r=u(r,n,i,s,e[2],4243563512,9),s=u(s,r,n,i,e[7],1735328473,14),n=d(n,i=u(i,s,r,n,e[12],2368359562,20),s,r,e[5],4294588738,4),r=d(r,n,i,s,e[8],2272392833,11),s=d(s,r,n,i,e[11],1839030562,16),i=d(i,s,r,n,e[14],4259657740,23),n=d(n,i,s,r,e[1],2763975236,4),r=d(r,n,i,s,e[4],1272893353,11),s=d(s,r,n,i,e[7],4139469664,16),i=d(i,s,r,n,e[10],3200236656,23),n=d(n,i,s,r,e[13],681279174,4),r=d(r,n,i,s,e[0],3936430074,11),s=d(s,r,n,i,e[3],3572445317,16),i=d(i,s,r,n,e[6],76029189,23),n=d(n,i,s,r,e[9],3654602809,4),r=d(r,n,i,s,e[12],3873151461,11),s=d(s,r,n,i,e[15],530742520,16),n=h(n,i=d(i,s,r,n,e[2],3299628645,23),s,r,e[0],4096336452,6),r=h(r,n,i,s,e[7],1126891415,10),s=h(s,r,n,i,e[14],2878612391,15),i=h(i,s,r,n,e[5],4237533241,21),n=h(n,i,s,r,e[12],1700485571,6),r=h(r,n,i,s,e[3],2399980690,10),s=h(s,r,n,i,e[10],4293915773,15),i=h(i,s,r,n,e[1],2240044497,21),n=h(n,i,s,r,e[8],1873313359,6),r=h(r,n,i,s,e[15],4264355552,10),s=h(s,r,n,i,e[6],2734768916,15),i=h(i,s,r,n,e[13],1309151649,21),n=h(n,i,s,r,e[4],4149444226,6),r=h(r,n,i,s,e[11],3174756917,10),s=h(s,r,n,i,e[2],718787259,15),i=h(i,s,r,n,e[9],3951481745,21),this._a=this._a+n|0,this._b=this._b+i|0,this._c=this._c+s|0,this._d=this._d+r|0},a.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=r.allocUnsafe(16);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e},e.exports=a},function(e,t,n){var i=n(3),s=i.Buffer;function r(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return s(e,t,n)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?e.exports=i:(r(i,t),t.Buffer=o),r(s,o),o.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return s(e,t,n)},o.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=s(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return s(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},function(e,t,n){"use strict";(function(t,i,s){var r=n(153);function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var i=e.entry;e.entry=null;for(;i;){var s=i.callback;t.pendingcb--,s(n),i=i.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=v;var a,c=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?i:r.nextTick;v.WritableState=y;var l=Object.create(n(119));l.inherits=n(12);var u={deprecate:n(744)},d=n(330),h=n(200).Buffer,f=s.Uint8Array||function(){};var p,m=n(331);function g(){}function y(e,t){a=a||n(77),e=e||{};var i=t instanceof a;this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var s=e.highWaterMark,l=e.writableHighWaterMark,u=this.objectMode?16:16384;this.highWaterMark=s||0===s?s:i&&(l||0===l)?l:u,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var d=!1===e.decodeStrings;this.decodeStrings=!d,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,i=n.sync,s=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,i,s){--t.pendingcb,n?(r.nextTick(s,i),r.nextTick(C,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(s(i),e._writableState.errorEmitted=!0,e.emit("error",i),C(e,t))}(e,n,i,t,s);else{var o=w(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||E(e,n),i?c(_,e,n,o,s):_(e,n,o,s)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function v(e){if(a=a||n(77),!(p.call(v,this)||this instanceof a))return new v(e);this._writableState=new y(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),d.call(this)}function S(e,t,n,i,s,r,o){t.writelen=i,t.writecb=o,t.writing=!0,t.sync=!0,n?e._writev(s,t.onwrite):e._write(s,r,t.onwrite),t.sync=!1}function _(e,t,n,i){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,i(),C(e,t)}function E(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,s=new Array(i),r=t.corkedRequestsFree;r.entry=n;for(var a=0,c=!0;n;)s[a]=n,n.isBuf||(c=!1),n=n.next,a+=1;s.allBuffers=c,S(e,t,!0,t.length,s,"",r.finish),t.pendingcb++,t.lastBufferedRequest=null,r.next?(t.corkedRequestsFree=r.next,r.next=null):t.corkedRequestsFree=new o(t),t.bufferedRequestCount=0}else{for(;n;){var l=n.chunk,u=n.encoding,d=n.callback;if(S(e,t,!1,t.objectMode?1:l.length,l,u,d),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function w(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function b(e,t){e._final((function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),C(e,t)}))}function C(e,t){var n=w(t);return n&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,r.nextTick(b,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}l.inherits(v,d),y.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(y.prototype,"buffer",{get:u.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(v,Symbol.hasInstance,{value:function(e){return!!p.call(this,e)||this===v&&(e&&e._writableState instanceof y)}})):p=function(e){return e instanceof this},v.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},v.prototype.write=function(e,t,n){var i,s=this._writableState,o=!1,a=!s.objectMode&&(i=e,h.isBuffer(i)||i instanceof f);return a&&!h.isBuffer(e)&&(e=function(e){return h.from(e)}(e)),"function"==typeof t&&(n=t,t=null),a?t="buffer":t||(t=s.defaultEncoding),"function"!=typeof n&&(n=g),s.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),r.nextTick(t,n)}(this,n):(a||function(e,t,n,i){var s=!0,o=!1;return null===n?o=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),r.nextTick(i,o),s=!1),s}(this,s,e,n))&&(s.pendingcb++,o=function(e,t,n,i,s,r){if(!n){var o=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=h.from(t,n));return t}(t,i,s);i!==o&&(n=!0,s="buffer",i=o)}var a=t.objectMode?1:i.length;t.length+=a;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:s,isBuf:n,callback:r,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else S(e,t,!1,a,i,s,r);return c}(this,s,a,e,t,n)),o},v.prototype.cork=function(){this._writableState.corked++},v.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||E(this,e))},v.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(v.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),v.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},v.prototype._writev=null,v.prototype.end=function(e,t,n){var i=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(e,t,n){t.ending=!0,C(e,t),n&&(t.finished?r.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,i,n)},Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),v.prototype.destroy=m.destroy,v.prototype._undestroy=m.undestroy,v.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,n(11),n(57).setImmediate,n(27))},function(e,t,n){"use strict";var i=n(14).Buffer,s=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===s||!s(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=l,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=u,this.end=d,t=3;break;default:return this.write=h,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var i=n.charCodeAt(n.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function l(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function u(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.StringDecoder=r,r.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},r.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},r.prototype.text=function(e,t){var n=function(e,t,n){var i=t.length-1;if(i<n)return 0;var s=o(t[i]);if(s>=0)return s>0&&(e.lastNeed=s-1),s;if(--i<n||-2===s)return 0;if((s=o(t[i]))>=0)return s>0&&(e.lastNeed=s-2),s;if(--i<n||-2===s)return 0;if((s=o(t[i]))>=0)return s>0&&(2===s?s=0:e.lastNeed=s-3),s;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var i=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},r.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,n){"use strict";var i=n(3).Buffer,s=n(12),r=n(328),o=new Array(16),a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],c=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],l=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],u=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],d=[0,1518500249,1859775393,2400959708,2840853838],h=[1352829926,1548603684,1836072691,2053994217,0];function f(){r.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function p(e,t){return e<<t|e>>>32-t}function m(e,t,n,i,s,r,o,a){return p(e+(t^n^i)+r+o|0,a)+s|0}function g(e,t,n,i,s,r,o,a){return p(e+(t&n|~t&i)+r+o|0,a)+s|0}function y(e,t,n,i,s,r,o,a){return p(e+((t|~n)^i)+r+o|0,a)+s|0}function v(e,t,n,i,s,r,o,a){return p(e+(t&i|n&~i)+r+o|0,a)+s|0}function S(e,t,n,i,s,r,o,a){return p(e+(t^(n|~i))+r+o|0,a)+s|0}s(f,r),f.prototype._update=function(){for(var e=o,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);for(var n=0|this._a,i=0|this._b,s=0|this._c,r=0|this._d,f=0|this._e,_=0|this._a,E=0|this._b,w=0|this._c,b=0|this._d,C=0|this._e,T=0;T<80;T+=1){var M,A;T<16?(M=m(n,i,s,r,f,e[a[T]],d[0],l[T]),A=S(_,E,w,b,C,e[c[T]],h[0],u[T])):T<32?(M=g(n,i,s,r,f,e[a[T]],d[1],l[T]),A=v(_,E,w,b,C,e[c[T]],h[1],u[T])):T<48?(M=y(n,i,s,r,f,e[a[T]],d[2],l[T]),A=y(_,E,w,b,C,e[c[T]],h[2],u[T])):T<64?(M=v(n,i,s,r,f,e[a[T]],d[3],l[T]),A=g(_,E,w,b,C,e[c[T]],h[3],u[T])):(M=S(n,i,s,r,f,e[a[T]],d[4],l[T]),A=m(_,E,w,b,C,e[c[T]],h[4],u[T])),n=f,f=r,r=p(s,10),s=i,i=M,_=C,C=b,b=p(w,10),w=E,E=A}var k=this._b+s+b|0;this._b=this._c+r+C|0,this._c=this._d+f+_|0,this._d=this._e+n+E|0,this._e=this._a+i+w|0,this._a=k},f.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=i.alloc?i.alloc(20):new i(20);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e.writeInt32LE(this._e,16),e},e.exports=f},function(e,t,n){(t=e.exports=function(e){e=e.toLowerCase();var n=t[e];if(!n)throw new Error(e+" is not supported (we accept pull requests)");return new n}).sha=n(750),t.sha1=n(751),t.sha224=n(752),t.sha256=n(333),t.sha384=n(753),t.sha512=n(334)},function(e,t,n){"use strict";var i=n(38);function s(e){this.options=e,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}e.exports=s,s.prototype._init=function(){},s.prototype.update=function(e){return 0===e.length?[]:"decrypt"===this.type?this._updateDecrypt(e):this._updateEncrypt(e)},s.prototype._buffer=function(e,t){for(var n=Math.min(this.buffer.length-this.bufferOff,e.length-t),i=0;i<n;i++)this.buffer[this.bufferOff+i]=e[t+i];return this.bufferOff+=n,n},s.prototype._flushBuffer=function(e,t){return this._update(this.buffer,0,e,t),this.bufferOff=0,this.blockSize},s.prototype._updateEncrypt=function(e){var t=0,n=0,i=(this.bufferOff+e.length)/this.blockSize|0,s=new Array(i*this.blockSize);0!==this.bufferOff&&(t+=this._buffer(e,t),this.bufferOff===this.buffer.length&&(n+=this._flushBuffer(s,n)));for(var r=e.length-(e.length-t)%this.blockSize;t<r;t+=this.blockSize)this._update(e,t,s,n),n+=this.blockSize;for(;t<e.length;t++,this.bufferOff++)this.buffer[this.bufferOff]=e[t];return s},s.prototype._updateDecrypt=function(e){for(var t=0,n=0,i=Math.ceil((this.bufferOff+e.length)/this.blockSize)-1,s=new Array(i*this.blockSize);i>0;i--)t+=this._buffer(e,t),n+=this._flushBuffer(s,n);return t+=this._buffer(e,t),s},s.prototype.final=function(e){var t,n;return e&&(t=this.update(e)),n="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),t?t.concat(n):n},s.prototype._pad=function(e,t){if(0===t)return!1;for(;t<e.length;)e[t++]=0;return!0},s.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var e=new Array(this.blockSize);return this._update(this.buffer,0,e,0),e},s.prototype._unpad=function(e){return e},s.prototype._finalDecrypt=function(){i.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var e=new Array(this.blockSize);return this._flushBuffer(e,0),this._unpad(e)}},function(e,t,n){var i=n(762),s=n(770),r=n(346);t.createCipher=t.Cipher=i.createCipher,t.createCipheriv=t.Cipheriv=i.createCipheriv,t.createDecipher=t.Decipher=s.createDecipher,t.createDecipheriv=t.Decipheriv=s.createDecipheriv,t.listCiphers=t.getCiphers=function(){return Object.keys(r)}},function(e,t,n){var i={ECB:n(763),CBC:n(764),CFB:n(765),CFB8:n(766),CFB1:n(767),OFB:n(768),CTR:n(344),GCM:n(344)},s=n(346);for(var r in s)s[r].module=i[s[r].mode];e.exports=s},function(e,t,n){(function(e){var i=n(349),s=n(774),r=n(775);var o={binary:!0,hex:!0,base64:!0};t.DiffieHellmanGroup=t.createDiffieHellmanGroup=t.getDiffieHellman=function(t){var n=new e(s[t].prime,"hex"),i=new e(s[t].gen,"hex");return new r(n,i)},t.createDiffieHellman=t.DiffieHellman=function t(n,s,a,c){return e.isBuffer(s)||void 0===o[s]?t(n,"binary",s,a):(s=s||"binary",c=c||"binary",a=a||new e([2]),e.isBuffer(a)||(a=new e(a,c)),"number"==typeof n?new r(i(n,a),a,!0):(e.isBuffer(n)||(n=new e(n,s)),new r(n,a,!0)))}}).call(this,n(3).Buffer)},function(e,t,n){var i;function s(e){this.rand=e}if(e.exports=function(e){return i||(i=new s(null)),i.generate(e)},e.exports.Rand=s,s.prototype.generate=function(e){return this._rand(e)},s.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),n=0;n<t.length;n++)t[n]=this.rand.getByte();return t},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?s.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?s.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:"object"==typeof window&&(s.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var r=n(773);if("function"!=typeof r.randomBytes)throw new Error("Not supported");s.prototype._rand=function(e){return r.randomBytes(e)}}catch(e){}},function(e,t,n){(function(t){var i=n(25),s=n(75);function r(e,n){var s=function(e){var t=o(e);return{blinder:t.toRed(i.mont(e.modulus)).redPow(new i(e.publicExponent)).fromRed(),unblinder:t.invm(e.modulus)}}(n),r=n.modulus.byteLength(),a=(i.mont(n.modulus),new i(e).mul(s.blinder).umod(n.modulus)),c=a.toRed(i.mont(n.prime1)),l=a.toRed(i.mont(n.prime2)),u=n.coefficient,d=n.prime1,h=n.prime2,f=c.redPow(n.exponent1),p=l.redPow(n.exponent2);f=f.fromRed(),p=p.fromRed();var m=f.isub(p).imul(u).umod(d);return m.imul(h),p.iadd(m),new t(p.imul(s.unblinder).umod(n.modulus).toArray(!1,r))}function o(e){for(var t=e.modulus.byteLength(),n=new i(s(t));n.cmp(e.modulus)>=0||!n.umod(e.prime1)||!n.umod(e.prime2);)n=new i(s(t));return n}e.exports=r,r.getr=o}).call(this,n(3).Buffer)},function(e,t,n){"use strict";var i=t;i.version=n(778).version,i.utils=n(39),i.rand=n(209),i.curve=n(352),i.curves=n(212),i.ec=n(789),i.eddsa=n(793)},function(e,t,n){"use strict";var i,s=t,r=n(213),o=n(352),a=n(39).assert;function c(e){"short"===e.type?this.curve=new o.short(e):"edwards"===e.type?this.curve=new o.edwards(e):this.curve=new o.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,a(this.g.validate(),"Invalid curve"),a(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function l(e,t){Object.defineProperty(s,e,{configurable:!0,enumerable:!0,get:function(){var n=new c(t);return Object.defineProperty(s,e,{configurable:!0,enumerable:!0,value:n}),n}})}s.PresetCurve=c,l("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:r.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),l("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:r.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),l("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:r.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),l("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:r.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),l("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:r.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),l("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["9"]}),l("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{i=n(788)}catch(e){i=void 0}l("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:r.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",i]})},function(e,t,n){var i=t;i.utils=n(48),i.common=n(122),i.sha=n(782),i.ripemd=n(786),i.hmac=n(787),i.sha1=i.sha.sha1,i.sha256=i.sha.sha256,i.sha224=i.sha.sha224,i.sha384=i.sha.sha384,i.sha512=i.sha.sha512,i.ripemd160=i.ripemd.ripemd160},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(19),s=n(6);class r extends s.DisposableClass{constructor(e){super(e)}async sendNotification(e,t,n){const s=await this.ensureConnectionAsync(),r=i.LoggerSettings.disableObfuscation?JSON.stringify(n):"";e.verbose(`sendNotification-> ${t}: ${r}`),Array.isArray(n)?s.sendNotification(t,...n):s.sendNotification(t,n)}async sendRequest(e,t,n,r,...o){let a=!1;const c=await Promise.race([this.ensureConnectionAsync(),new Promise((e,t)=>{if(r){if(r.isCancellationRequested)return t(new s.CancellationError("The request was cancelled."));r.onCancellationRequested(()=>{a||t(new s.CancellationError("The request was cancelled."))})}})]);a=!0;let l="";i.LoggerSettings.disableObfuscation&&(l=JSON.stringify(o),l=l.substr(1,l.length-2)),e.verbose(`< ${t}(${l})`);const u=Date.now();let d;try{let e;n&&(n.cancellation=r,o.progress=n),e=r?c.sendRequest(t,o,r):c.sendRequest(t,o),d=await e}catch(n){throw this.isDisposed,e.error(`> ${t}() error: `+n.data),n}const h=(Date.now()-u).toFixed(1);return i.LoggerSettings.disableObfuscation?e.verbose(`> ${t}() => ${JSON.stringify(d)} t:${h}`):e.verbose(`> ${t}() succeeded t:${h}`),d}}t.RpcClientProxyBase=r;class o extends r{constructor(e,t){super(t),this.promise=e,this.initPromise=Promise.resolve()}static fromRpcConnection(e,t){return new o(Promise.resolve(e),t)}static fromPromise(e,t){return new o(e,t)}ensureConnectionAsync(){return this.promise}}t.RpcClientProxy=o},function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(816)),i(n(822));var s=n(825);t.once=s.once;var r=n(826);t.onlyOnce=r.onlyOnce;var o=n(368);t.wait=o.wait;var a=n(827);t.raceAsync=a.raceAsync;var c=n(831);t.withCache=c.withCache;var l=n(832);t.withMutexByArguments=l.withMutexByArguments;var u=n(833);t.idFunction=u.idFunction;var d=n(365);t.withRetries=d.withRetries;var h=n(834);t.connectEvents=h.connectEvents;var f=n(372);t.cleanupPII=f.cleanupPII,t.obfusticatePaths=f.obfusticatePaths,t.obfusticateEmailAddresses=f.obfusticateEmailAddresses;var p=n(835);t.randomInt=p.randomInt;var m=n(373);t.randomBytes=m.randomBytes;var g=n(836);t.randomString=g.randomString;var y=n(370);t.hashString=y.hashString;var v=n(837);t.debounce=v.debounce;var S=n(838);t.throttle=S.throttle;var _=n(217);t.defer=_.defer;var E=n(839);t.arrayUnique=E.arrayUnique;var w=n(840);t.isThenable=w.isThenable;var b=n(371);t.createDisposable=b.createDisposable;var C=n(841);t.timeoutPromise=C.timeoutPromise;var T=n(374);t.errorToObject=T.errorToObject;var M=n(842);t.errorToString=M.errorToString;var A=n(843);t.notImplemented=A.notImplemented,i(n(844));var k=n(845);t.promiseAny=k.promiseAny;var R=n(846);function P(e){if(e)return JSON.stringify(e,Object.getOwnPropertyNames(e))}t.toCamelCase=R.toCamelCase,t.propertiesToJSON=P,t.propertiesToString=function(e){var t;return`type:${null===(t=null==e?void 0:e.constructor)||void 0===t?void 0:t.name} props:${P(e)}`}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(215),s=n(125);class r{constructor(e){this.stateReference="pending",this.promiseReference=new Promise((e,t)=>{this.promiseResolve=e,this.promiseReject=t}),this.resolve=this.resolve.bind(this),this.reject=this.reject.bind(this),this.cancel=this.cancel.bind(this),e&&(e.isCancellationRequested?this.cancel():e.onCancellationRequested&&e.onCancellationRequested(()=>{this.isFulfilled||this.cancel()}))}get isFulfilled(){return"pending"!==this.state}get state(){return this.stateReference}get isResolved(){return"resolved"===this.state}get isRejected(){return"rejected"===this.state}get isCancelled(){return"cancelled"===this.state}resolve(e){this.isFulfilled||(this.stateReference="resolved",i.assertDefined(this.promiseResolve,"No `promiseResolve` function found."),this.promiseResolve(e))}reject(e){this.isFulfilled||(this.stateReference="rejected",i.assertDefined(this.promiseReject,"No `promiseReject` function found."),this.promiseReject(e))}cancel(){this.isFulfilled||(this.stateReference="cancelled",i.assertDefined(this.promiseReject,"No `promiseReject` function found."),this.promiseReject(new s.CancellationError))}get promise(){return this.promiseReference}static from(e){const t=new r;return i.isThenable(e)?e.then(t.resolve,t.reject):t.resolve(e),t}dispose(){this.isFulfilled||this.cancel()}}t.Signal=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defer=(e,t=1)=>setTimeout(e,t)},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(8)),r=n(6),o=n(126),a=n(375),c=n(126);t.methodProgress="$/progress";class l extends r.DisposableClass{constructor(e){super(e),this.rpcRequestsWithContext=new o.RpcRequestsWithContext,this.rpcReadFilters=[this.rpcRequestsWithContext.readFilter],this.rpcWriteFilters=[],this.progressHandlers=new Map,this.requests=new Map,this.requestsWithProgress=new Set,this.notifications=new Map,this.notificationsCookies=0,this.handleNoneRequestCallbacks=new r.CallbackContainer,this.handleNoneNotificationCallbacks=new r.CallbackContainer,this.addProgressFilters()}get serviceNames(){const e=new Set,t=t=>{for(const n of t)e.add(n.split(".")[0])};return t(this.requests.keys()),t(this.notifications.keys()),Array.from(e)}clear(){this.requests.clear(),this.requestsWithProgress.clear(),this.notifications.clear(),this.handleNoneRequestCallbacks.clear(),this.handleNoneNotificationCallbacks.clear()}onHandleNoneRequest(e){return this.handleNoneRequestCallbacks.add(e)}onHandleNoneNotification(e){return this.handleNoneNotificationCallbacks.add(e)}createRpcConnection(e,t){return s.createMessageConnection(this.createFilteredMessageReader(e.reader),this.createFilteredMessageWriter(e.writer),new a.RpcLoggerAdapter(t))}addReadFilter(e){return u(this.rpcReadFilters,e)}addWriteFilter(e){return u(this.rpcWriteFilters,e)}addRequestMethod(e,t){this.requests.set(e,t)}addRequestMethodWithContext(e,t){this.addRequestMethod(e,t),this.rpcRequestsWithContext.add(e)}addRequestMethodWithProgress(e,t){this.addRequestMethod(e,t),this.requestsWithProgress.add(e)}removeRequestMethod(e){this.requests.delete(e),this.requestsWithProgress.delete(e)}addNotificationHandler(e,t){let n=this.notifications.get(e);n||(n=[],this.notifications.set(e,n));const i={cookie:++this.notificationsCookies,notificationHandler:t};return n.push(i),i.cookie}removeNotificationHandler(e,t){const n=this.notifications.get(e);if(n){const e=n.findIndex(e=>e.cookie===t);if(-1!==e)return n.splice(e,1)[0].notificationHandler}}onRequest(e,n,i,...s){const r=this.requests.get(i);if(!r){for(const e of this.handleNoneRequestCallbacks.items){const t=e(n,i,...s);if(void 0!==t)return t}return Promise.resolve(c.createMethodNotFoundResponse(i))}const[o]=s.splice(0,1);if(this.requestsWithProgress.has(i)){const e={report:e=>{n.sendNotification(t.methodProgress,{id:o,value:e})}};s.splice(s.length-1,0,e)}return e?e(r,...s):r(...s)}onNotification(e,n,...i){if(n!==t.methodProgress||"object"!=typeof i[0])if(this.notifications.has(n))this.notifications.get(n).forEach(e=>{e.notificationHandler(...i)});else for(const t of this.handleNoneNotificationCallbacks.items)t(e,n,...i)}createFilteredMessageReader(e){return new o.WrappedMessageReader(e,e=>l.filterMessage(e,this.rpcReadFilters))}createFilteredMessageWriter(e){return new o.WrappedMessageWriter(e,e=>l.filterMessage(e,this.rpcWriteFilters))}static filterMessage(e,t){for(const n of t)e=n(e);return e}addProgressFilters(){this.rpcReadFilters.push(e=>{const n=e,i=n.id;if(void 0!==i)Array.isArray(n.params)?n.params.splice(0,0,i):void 0===n.result&&void 0===n.error||this.progressHandlers.delete(i);else if(n.method===t.methodProgress){let e=n.params;void 0===e.id&&(e=n.params[0]);const t=this.progressHandlers.get(e.id);t&&t.report(e.value,e.id)}return e}),this.rpcWriteFilters.push(e=>{const t=e,n=t.id,i=t.params;if(void 0!==n&&i&&i.progress&&"function"==typeof i.progress.report){this.progressHandlers.set(t.id,t.params.progress);const e=i.progress.cancellation;e&&e.onCancellationRequested(()=>{this.progressHandlers.delete(n)}),delete i.progress}return e})}}t.RpcServiceHandlerBase=l;function u(e,t){return e.push(t),{dispose:()=>{const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}}t.RpcServiceHandler=class extends l{registerRpcService(e,t,n,i){if(!e)throw new Error("service argument is missing or undefined");if(!t)throw new Error("serviceInfo argument is missing or undefined");if(n&&n.filter(e=>t.methods.indexOf(e)<0).length>0)throw new Error("invalid context method");const s=t.name;if(!s)throw new Error("serviceInfo.serviceName is empty or undefined");let r=!0;const o=new Set,a=new Map;let l=[];const u={dispose:()=>{r=!1;for(const e of l)e.dispose();l=[];for(const e of o)this.removeRequestMethod(e);o.clear();for(const[e,t]of a)this.removeNotificationHandler(e,t);a.clear()}},d=e.$RestrictedHandlers$;try{for(const r of t.methods){const a=`${s}.${r}`,c=d&&d.get(r);if(c){this.addRequestMethodWithContext(a,(...t)=>c.apply(e,t)),o.add(a);continue}const l=e[r]||e[r+"Async"];if("function"==typeof l)n&&n.indexOf(r)>=0?this.addRequestMethodWithContext(a,(...t)=>l.apply(e,t)):this.addRequestMethod(a,(...t)=>l.apply(e,t)),o.add(a);else if(i||void 0===i)throw new Error(`Object ${t.name} does not implement method '${r}' of service '${s}'.`)}if(t.voidMethods)for(const n of t.voidMethods){const r=`${s}.${n}`;if(d&&d.get(n))throw new Error(`Restricted operation check is not supported yet for notification methods. Object ${t.name} restricts notification '${n}' of service '${s}'.`);const o=this[n]||e[n];if("function"!=typeof o){if(i)throw new Error(`Object ${t.name} does not implement notification '${n}' of service '${s}'.`);continue}const c=this.addNotificationHandler(r,(...t)=>o.apply(e,t));a.set(r,c)}if(t.events)for(const n of t.events){if(!n)continue;const t=c.getEventPropertyName(n),i=e[t];"function"==typeof i&&i(e=>{r&&this.sendNotification(this.trace,`${s}.${n}`,e).catch(e=>this.trace.error(`Failed to send notification:${s}.${n}`,e))},l)}}catch(e){throw u.dispose(),e}return u}}},function(e,t,n){"use strict";(function(t){function n(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function i(e,t){for(var n,i="",s=0,r=-1,o=0,a=0;a<=e.length;++a){if(a<e.length)n=e.charCodeAt(a);else{if(47===n)break;n=47}if(47===n){if(r===a-1||1===o);else if(r!==a-1&&2===o){if(i.length<2||2!==s||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){var c=i.lastIndexOf("/");if(c!==i.length-1){-1===c?(i="",s=0):s=(i=i.slice(0,c)).length-1-i.lastIndexOf("/"),r=a,o=0;continue}}else if(2===i.length||1===i.length){i="",s=0,r=a,o=0;continue}t&&(i.length>0?i+="/..":i="..",s=2)}else i.length>0?i+="/"+e.slice(r+1,a):i=e.slice(r+1,a),s=a-r-1;r=a,o=0}else 46===n&&-1!==o?++o:o=-1}return i}var s={resolve:function(){for(var e,s="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var a;o>=0?a=arguments[o]:(void 0===e&&(e=t.cwd()),a=e),n(a),0!==a.length&&(s=a+"/"+s,r=47===a.charCodeAt(0))}return s=i(s,!r),r?s.length>0?"/"+s:"/":s.length>0?s:"."},normalize:function(e){if(n(e),0===e.length)return".";var t=47===e.charCodeAt(0),s=47===e.charCodeAt(e.length-1);return 0!==(e=i(e,!t)).length||t||(e="."),e.length>0&&s&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return n(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var i=arguments[t];n(i),i.length>0&&(void 0===e?e=i:e+="/"+i)}return void 0===e?".":s.normalize(e)},relative:function(e,t){if(n(e),n(t),e===t)return"";if((e=s.resolve(e))===(t=s.resolve(t)))return"";for(var i=1;i<e.length&&47===e.charCodeAt(i);++i);for(var r=e.length,o=r-i,a=1;a<t.length&&47===t.charCodeAt(a);++a);for(var c=t.length-a,l=o<c?o:c,u=-1,d=0;d<=l;++d){if(d===l){if(c>l){if(47===t.charCodeAt(a+d))return t.slice(a+d+1);if(0===d)return t.slice(a+d)}else o>l&&(47===e.charCodeAt(i+d)?u=d:0===d&&(u=0));break}var h=e.charCodeAt(i+d);if(h!==t.charCodeAt(a+d))break;47===h&&(u=d)}var f="";for(d=i+u+1;d<=r;++d)d!==r&&47!==e.charCodeAt(d)||(0===f.length?f+="..":f+="/..");return f.length>0?f+t.slice(a+u):(a+=u,47===t.charCodeAt(a)&&++a,t.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(n(e),0===e.length)return".";for(var t=e.charCodeAt(0),i=47===t,s=-1,r=!0,o=e.length-1;o>=1;--o)if(47===(t=e.charCodeAt(o))){if(!r){s=o;break}}else r=!1;return-1===s?i?"/":".":i&&1===s?"//":e.slice(0,s)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');n(e);var i,s=0,r=-1,o=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,c=-1;for(i=e.length-1;i>=0;--i){var l=e.charCodeAt(i);if(47===l){if(!o){s=i+1;break}}else-1===c&&(o=!1,c=i+1),a>=0&&(l===t.charCodeAt(a)?-1==--a&&(r=i):(a=-1,r=c))}return s===r?r=c:-1===r&&(r=e.length),e.slice(s,r)}for(i=e.length-1;i>=0;--i)if(47===e.charCodeAt(i)){if(!o){s=i+1;break}}else-1===r&&(o=!1,r=i+1);return-1===r?"":e.slice(s,r)},extname:function(e){n(e);for(var t=-1,i=0,s=-1,r=!0,o=0,a=e.length-1;a>=0;--a){var c=e.charCodeAt(a);if(47!==c)-1===s&&(r=!1,s=a+1),46===c?-1===t?t=a:1!==o&&(o=1):-1!==t&&(o=-1);else if(!r){i=a+1;break}}return-1===t||-1===s||0===o||1===o&&t===s-1&&t===i+1?"":e.slice(t,s)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,i=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+i:n+e+i:i}("/",e)},parse:function(e){n(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var i,s=e.charCodeAt(0),r=47===s;r?(t.root="/",i=1):i=0;for(var o=-1,a=0,c=-1,l=!0,u=e.length-1,d=0;u>=i;--u)if(47!==(s=e.charCodeAt(u)))-1===c&&(l=!1,c=u+1),46===s?-1===o?o=u:1!==d&&(d=1):-1!==o&&(d=-1);else if(!l){a=u+1;break}return-1===o||-1===c||0===d||1===d&&o===c-1&&o===a+1?-1!==c&&(t.base=t.name=0===a&&r?e.slice(1,c):e.slice(a,c)):(0===a&&r?(t.name=e.slice(1,o),t.base=e.slice(1,c)):(t.name=e.slice(a,o),t.base=e.slice(a,c)),t.ext=e.slice(o,c)),a>0?t.dir=e.slice(0,a-1):r&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};s.posix=s,e.exports=s}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throwNotInitialized=e=>{if(!e)throw new Error("The API was not initialized, please call `initialize` method first.");return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{static get FAULT_TYPE(){return i.FEATURE_NAME+"FaultType"}static get EVENT_ID(){return i.FEATURE_NAME+"EventId"}static get CORRELATION_ID(){return i.FEATURE_NAME+"CorrelationId"}static get LOG_LINES(){return i.FEATURE_NAME+"LogLines"}static get EVENT_MESSAGE(){return i.FEATURE_NAME+"Message"}static get EVENT_EXCEPTION_STACK(){return i.FEATURE_NAME+"ExceptionStack"}static get EVENT_RESULT(){return i.FEATURE_NAME+"Result"}static get EVENT_TYPE(){return i.FEATURE_NAME+"Type"}static get EVENT_DURATION(){return i.FEATURE_NAME+"Duration"}static get EVENT_CREATION_TIME(){return i.FEATURE_NAME+"CreationTime"}static get SESSION_ID(){return i.FEATURE_NAME+"SessionId"}static get EVENT_EXCEPTION_CODE(){return i.FEATURE_NAME+"ExceptionCode"}static get SAMPLE_RATE(){return i.FEATURE_NAME+"SampleRate"}static get SEQUENCE_NUMBER(){return i.FEATURE_NAME+"SequenceNumber"}}t.TelemetryPropertyNames=i,i.FEATURE_NAME="liveshare.";class s{}t.TelemetryPropertyValues=s,s.START="start",s.END="end"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(129),s=n(383),r=new Map;t.loadJSON=(e,t=!1)=>{if(t){const t=r.get(e);if(void 0!==t)return t}const n=i.fileAccess.readFileSync(e,"utf8"),o=s(n),a=JSON.parse(o);return t&&r.set(e,a),a}},function(e,t,n){"use strict";t.decode=t.parse=n(899),t.encode=t.stringify=n(900)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Activatable=function(e){return class extends e{activate(){return this.isActivated=!0,Promise.resolve(this.isActivated)}deactivate(){return this.isActivated=!1,Promise.resolve()}}},t.Inittable=function(e){return class extends e{init(){return this.isInitialized=!0,Promise.resolve()}}},t.Disposable=function(e){return class extends e{dispose(){return this.isDisposed=!0,Promise.resolve()}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(224),s=n(128);class r extends(i.Inittable(i.Disposable(Object))){constructor(){super(),this.disposables=[],this.deferredWork=Promise.resolve(!0),this.builders=new Map,this.jobs=[],this.trace=s.traceSource.withName("DataScrapingManager"),this.deferredWork=this.deferredWork.then(()=>this.init()).catch(e=>{this.trace.error(e.message)})}static get vscode(){return n(0)}static get Instance(){return r.singleton||(r.singleton=new r),r.singleton}get onScrappingStarted(){return this.eventEmitter||(this.eventEmitter=new r.vscode.EventEmitter),this.eventEmitter.event}async dispose(){await this.deferredWork,this.disposables.splice(0).forEach(e=>e.dispose()),this.jobs.splice(0).forEach(e=>e.dispose()),await super.dispose()}async init(){!this.isInitialized&&r.vscode.window.onDidOpenTerminal&&(r.vscode.window.onDidOpenTerminal(this.handleTerminalCreated,this,this.disposables),r.vscode.window.onDidCloseTerminal(this.handleTerminalClosed,this,this.disposables),r.vscode.window.terminals.forEach(this.handleTerminalCreated,this),await super.init())}async registerDataScraper(e,t){if(await this.deferredWork,this.builders.set(e,t),this.isInitialized){const n=r.vscode.window.terminals.map(async n=>{const i=t(n);i&&(await i.init(),this.createJob(n,i,e))});await Promise.all(n)}return new r.vscode.Disposable(()=>this.unregisterDataScraper(e))}unregisterDataScraper(e){this.builders.delete(e);const t=this.jobs.splice(0);t.filter(t=>t.kind===e).forEach(e=>e.dispose()),this.jobs.push(...t.filter(t=>t.kind!==e))}async handleTerminalCreated(e){const t=[...this.builders.entries()].map(async t=>{const[n,i]=t,s=i(e);s&&(await s.init(),this.createJob(e,s,n))});this.deferredWork=this.deferredWork.then(()=>Promise.all(t)).catch(e=>{this.trace.error(e.message)})}createJob(e,t,n){let i;i="function"==typeof r.vscode.window.onDidWriteTerminalData?r.vscode.window.onDidWriteTerminalData(n=>{n.terminal===e&&t.processData(n.data)}):e.onDidWriteData(t.processData,t);const s={kind:n,dataScraper:t,terminal:e,registration:i,dispose:()=>(i.dispose(),t.dispose())};return this.jobs.push(s),this.eventEmitter||(this.eventEmitter=new r.vscode.EventEmitter),this.eventEmitter.fire(s.terminal),s}handleTerminalClosed(e){const t=this.jobs.splice(0);t.filter(t=>t.terminal===e).forEach(e=>e.dispose()),this.jobs.push(...t.filter(t=>t.terminal!==e))}}t.DataScrapingManager=r;const o=r.Instance;t.dataScrapingManagerInstance=o},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});const r=n(20);class o{}t.RemoteStreamMoniker=o;class a{}t.FileServiceRootDirectoryConfiguration=a;class c{}i([r.dataFormat(a),s("design:type",Array)],c.prototype,"directories",void 0),t.FileServiceRootConfiguration=c;class l{}t.MaybeImmutableOfAccessControl=l;class u extends l{}var d;t.AccessControl=u,function(e){e[e.Begin="begin"]="Begin",e[e.Current="current"]="Current",e[e.End="end"]="End"}(t.SeekOrigin||(t.SeekOrigin={}));class h{}t.FeatureFlagStore=h;class f{}t.EventArgs=f;t.AttemptHubConnectionEventArgs=class extends f{},function(e){e[e.None="none"]="None",e[e.TokenExpired="tokenExpired"]="TokenExpired",e[e.ServiceUnavailable="serviceUnavailable"]="ServiceUnavailable"}(t.HubConnectionError||(t.HubConnectionError={}));t.AgentTraceEventArgs=class extends f{};t.AgentSessionRequest=class{};t.AgentSessionResponse=class{};class p{}i([r.dataFormat(r.DataFormat.Omit),s("design:type",String)],p.prototype,"token",void 0),i([r.dataFormat(r.DataFormat.Omit),s("design:type",String)],p.prototype,"code",void 0),t.AuthenticationToken=p;class m{}i([r.dataFormat(r.DataFormat.Hide),s("design:type",String)],m.prototype,"accountId",void 0),t.UserAccountInfo=m;class g extends m{}i([r.dataFormat(r.DataFormat.Hide),s("design:type",String)],g.prototype,"id",void 0),i([r.dataFormat(r.DataFormat.Hide),s("design:type",String)],g.prototype,"displayName",void 0),i([r.dataFormat(r.DataFormat.Email),s("design:type",String)],g.prototype,"emailAddress",void 0),i([r.dataFormat(r.DataFormat.Hide),s("design:type",String)],g.prototype,"userName",void 0),i([r.dataFormat(r.DataFormat.Uri),s("design:type",String)],g.prototype,"avatarUri",void 0),t.UserInfo=g,function(e){e[e.Unknown="unknown"]="Unknown",e[e.Transient="transient"]="Transient",e[e.Pending="pending"]="Pending",e[e.Accepted="accepted"]="Accepted",e[e.Deleted="deleted"]="Deleted"}(t.UserAccountStatus||(t.UserAccountStatus={}));class y{}i([r.dataFormat(r.DataFormat.Email),s("design:type",String)],y.prototype,"email",void 0),i([r.dataFormat(r.DataFormat.Hide),s("design:type",String)],y.prototype,"name",void 0),i([r.dataFormat(r.DataFormat.Uri),s("design:type",String)],y.prototype,"avatarUri",void 0),t.RecentCollaborator=y;t.AuthenticationOptions=class{};class v extends f{}i([r.dataFormat(g),s("design:type",g)],v.prototype,"account",void 0),i([r.dataFormat(r.DataFormat.Omit),s("design:type",String)],v.prototype,"accessToken",void 0),t.AuthenticationChangedEventArgs=v;class S{}i([r.dataFormat(g),s("design:type",g)],S.prototype,"userInfo",void 0),i([r.dataFormat(r.DataFormat.Omit),s("design:type",String)],S.prototype,"accessToken",void 0),t.AuthenticatedUserInfo=S;t.BrokerManifest=class{};t.BrokerEventArgs=class extends f{},function(e){e[e.Text="text"]="Text",e[e.Typing="typing"]="Typing"}(t.ChatMessageType||(t.ChatMessageType={}));t.ChatParticipant=class{};class _{}t.ChatMessageBody=_;class E{}i([r.dataFormat(_),s("design:type",_)],E.prototype,"body",void 0),t.ChatMessage=E;class w extends f{}i([r.dataFormat(E),s("design:type",E)],w.prototype,"message",void 0),t.MessageReceivedEventArgs=w;class b{constructor(){this.startOffset=-1}}t.Position=b,function(e){e[e.Active="active"]="Active",e[e.Closed="closed"]="Closed"}(t.CommentThreadStatus||(t.CommentThreadStatus={}));class C{}i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],C.prototype,"filePath",void 0),i([r.dataFormat(b),s("design:type",b)],C.prototype,"leftFileStart",void 0),i([r.dataFormat(b),s("design:type",b)],C.prototype,"leftFileEnd",void 0),i([r.dataFormat(b),s("design:type",b)],C.prototype,"rightFileStart",void 0),i([r.dataFormat(b),s("design:type",b)],C.prototype,"rightFileEnd",void 0),t.CommentThreadContext=C;class T{}i([r.dataFormat(r.DataFormat.Text),s("design:type",String)],T.prototype,"participantId",void 0),i([r.dataFormat(r.DataFormat.Text),s("design:type",String)],T.prototype,"participantLabel",void 0),i([r.dataFormat(r.DataFormat.Text),s("design:type",String)],T.prototype,"text",void 0),t.Comment=T;class M{}i([r.dataFormat(T),s("design:type",Array)],M.prototype,"comments",void 0),i([r.dataFormat(C),s("design:type",C)],M.prototype,"threadContext",void 0),t.CommentThread=M;class A extends f{}i([r.dataFormat(M),s("design:type",M)],A.prototype,"newThread",void 0),i([r.dataFormat(T),s("design:type",T)],A.prototype,"changedComment",void 0),t.CommentThreadChangedEventArgs=A;class k{}i([r.dataFormat(C),r.dataFormat(C),s("design:type",C)],k.prototype,"threadContext",void 0),t.CommentThreadLocation=k;t.AddressAndMask=class{};t.AgentVersionInfo=class{};t.ClientVersionInfo=class{},function(e){e[e.None="none"]="None",e[e.Allow="allow"]="Allow",e[e.Block="block"]="Block"}(t.FirewallStatus||(t.FirewallStatus={}));t.HubMethodNotifyEventArgs=class extends f{};t.HubConnectionStateEventArgs=class extends f{},function(e){e[e.None="none"]="None",e[e.Invited="invited"]="Invited",e[e.Dismissed="dismissed"]="Dismissed",e[e.Joining="joining"]="Joining",e[e.Joined="joined"]="Joined"}(t.InviteContactStatus||(t.InviteContactStatus={}));t.InviteStatusNotify=class{},function(e){e[e.Idle="idle"]="Idle",e[e.Shared="shared"]="Shared"}(t.LiveShareSessionState||(t.LiveShareSessionState={}));class R{}i([r.dataFormat(r.DataFormat.Uri),s("design:type",String)],R.prototype,"browseUrl",void 0),t.SharedServer=R,function(e){e[e.Private="private"]="Private",e[e.Public="public"]="Public",e[e.Org="org"]="Org"}(t.PrivacyEnum||(t.PrivacyEnum={}));class P{}t.SharedPipe=P;class I extends f{}i([r.dataFormat(R),s("design:type",R)],I.prototype,"server",void 0),t.ServerSharingStartedEventArgs=I;class N extends f{}i([r.dataFormat(P),s("design:type",P)],N.prototype,"pipe",void 0),t.PipeSharingStartedEventArgs=N;class L extends f{}i([r.dataFormat(R),s("design:type",R)],L.prototype,"server",void 0),t.ServerSharingStoppedEventArgs=L;class D extends f{}i([r.dataFormat(P),s("design:type",P)],D.prototype,"pipe",void 0),t.PipeSharingStoppedEventArgs=D;class x extends f{}i([r.dataFormat(R),s("design:type",R)],x.prototype,"server",void 0),t.ServerSharingChangedEventArgs=x;t.SessionUpdateEventArgs=class extends f{};class O{}i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],O.prototype,"instanceId",void 0),t.SourceControlIdentifier=O;class F{}i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],F.prototype,"version",void 0),t.SourceControlVersion=F,function(e){e[e.Workspace="workspace"]="Workspace",e[e.External="external"]="External",e[e.SpecificVerision="specificVerision"]="SpecificVerision",e[e.WorkspaceWithSpecificVersion="workspaceWithSpecificVersion"]="WorkspaceWithSpecificVersion"}(t.SourceControlResourceType||(t.SourceControlResourceType={})),function(e){e[e.None="none"]="None",e[e.Add="add"]="Add",e[e.Edit="edit"]="Edit",e[e.Delete="delete"]="Delete",e[e.Rename="rename"]="Rename",e[e.Conflict="conflict"]="Conflict",e[e.IndexEdit="indexEdit"]="IndexEdit",e[e.IndexDelete="indexDelete"]="IndexDelete",e[e.IndexCopy="indexCopy"]="IndexCopy",e[e.Untracked="untracked"]="Untracked",e[e.Ignored="ignored"]="Ignored",e[e.AddByUs="addByUs"]="AddByUs",e[e.AddByThem="addByThem"]="AddByThem",e[e.DeleteByUs="deleteByUs"]="DeleteByUs",e[e.DeleteByThem="deleteByThem"]="DeleteByThem",e[e.AddBoth="addBoth"]="AddBoth",e[e.DeleteBoth="deleteBoth"]="DeleteBoth"}(t.SourceControlChangeType||(t.SourceControlChangeType={}));class U{}i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],U.prototype,"path",void 0),i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],U.prototype,"version",void 0),t.SourceControlResource=U;class j{}i([r.dataFormat(U),s("design:type",U)],j.prototype,"current",void 0),i([r.dataFormat(U),s("design:type",U)],j.prototype,"original",void 0),t.SourceControlResourceState=j;class H extends U{}i([r.dataFormat(r.DataFormat.Uri),s("design:type",String)],H.prototype,"instanceId",void 0),t.SourceControlResourceIdentifier=H;class B{}i([r.dataFormat(j),s("design:type",Array)],B.prototype,"resourceStates",void 0),t.SourceControlResourceGroup=B;class Y extends O{}i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],Y.prototype,"name",void 0),i([r.dataFormat(B),s("design:type",Array)],Y.prototype,"resourceGroups",void 0),t.SourceControlInstance=Y;class W{}i([r.dataFormat(U),s("design:type",U)],W.prototype,"right",void 0),i([r.dataFormat(U),s("design:type",U)],W.prototype,"left",void 0),i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],W.prototype,"title",void 0),t.SourceControlResourceDiff=W,function(e){e[e.Updated="updated"]="Updated",e[e.Added="added"]="Added",e[e.Removed="removed"]="Removed"}(t.SourceControlChange||(t.SourceControlChange={}));class q extends f{}i([r.dataFormat(O),s("design:type",O)],q.prototype,"sourceControl",void 0),t.SourceControlChangedEventArgs=q;class V extends f{}i([r.dataFormat(O),s("design:type",O)],V.prototype,"sourceControl",void 0),i([r.dataFormat(U),s("design:type",Array)],V.prototype,"resources",void 0),t.SourceControlResourceChangedEventArgs=V;t.SyncStatus=class{},function(e){e[e.PlainText="plainText"]="PlainText",e[e.TextWithAnsiEscapeCodes="textWithAnsiEscapeCodes"]="TextWithAnsiEscapeCodes"}(t.TaskOutputContentType||(t.TaskOutputContentType={}));class ${}i([r.dataFormat(o),s("design:type",o)],$.prototype,"streamMoniker",void 0),t.TaskOutputFeedInfo=$;class K{}t.TaskOutputOptions=K;class z{}i([r.dataFormat($),s("design:type",$)],z.prototype,"feed",void 0),i([r.dataFormat(K),s("design:type",K)],z.prototype,"options",void 0),t.TaskOutputInfo=z;class G extends f{}i([r.dataFormat(z),s("design:type",z)],G.prototype,"taskOutput",void 0),t.TaskOutputEventArgs=G;t.TelemetrySettings=class{};class J extends f{}i([r.dataFormat(r.DataFormat.Omit),s("design:type",Object)],J.prototype,"payload",void 0),t.GenericOperationEventArgs=J,function(e){e[e.None="none"]="None",e[e.Success="success"]="Success",e[e.Failure="failure"]="Failure",e[e.UserFault="userFault"]="UserFault",e[e.UserCancel="userCancel"]="UserCancel"}(t.TelemetryResult||(t.TelemetryResult={}));class X extends f{}i([r.dataFormat(r.DataFormat.Omit),s("design:type",Object)],X.prototype,"payload",void 0),t.FaultTelemetryEventArgs=X;class Z{}i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],Z.prototype,"cwd",void 0),i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],Z.prototype,"app",void 0),i([r.dataFormat(r.DataFormat.Hide),s("design:type",Array)],Z.prototype,"commandLine",void 0),i([r.dataFormat(r.DataFormat.Omit),s("design:type",Boolean)],Z.prototype,"verbatimCommandLine",void 0),i([r.dataFormat(r.DataFormat.Omit),s("design:type",Object)],Z.prototype,"environment",void 0),t.TerminalOptions=Z;class Q{}i([r.dataFormat(Z),s("design:type",Z)],Q.prototype,"options",void 0),t.TerminalInfo=Q;class ee extends f{}i([r.dataFormat(Q),s("design:type",Q)],ee.prototype,"terminal",void 0),t.TerminalEventArgs=ee;class te{}t.RestrictedOperation=te;t.SharedTerminalRestrictedOperation=class extends te{};t.VSServerWorkspaceInfo=class{};t.VSServerCreateSessionInfo=class{};class ne{}t.MaybeImmutableOfWorkspaceAccessControl=ne;class ie extends ne{}i([r.dataFormat(u),s("design:type",u)],ie.prototype,"defaultAccessControl",void 0),t.WorkspaceAccessControl=ie;class se extends f{}i([r.dataFormat(ie),s("design:type",ie)],se.prototype,"accessControl",void 0),t.WorkspaceAccessControlEventArgs=se;class re extends f{}i([r.dataFormat(te),s("design:type",te)],re.prototype,"operation",void 0),t.RestrictedOperationAccessRequestedEventArgs=re,function(e){e[e.Error="error"]="Error",e[e.Warning="warning"]="Warning",e[e.Message="message"]="Message"}(t.ErrorSeverity||(t.ErrorSeverity={}));class oe{}i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],oe.prototype,"fileId",void 0),i([r.dataFormat(r.DataFormat.Hide),s("design:type",String)],oe.prototype,"message",void 0),i([r.dataFormat(r.DataFormat.Omit),s("design:type",Object)],oe.prototype,"properties",void 0),t.DiagnosticEntry=oe;class ae extends f{}i([r.dataFormat(oe),s("design:type",Array)],ae.prototype,"entries",void 0),t.DiagnosticDataChangedEventArgs=ae;t.InvitationLinkInfo=class{};class ce{}i([r.dataFormat(r.DataFormat.Text),s("design:type",String)],ce.prototype,"name",void 0),i([r.dataFormat(r.DataFormat.Omit),s("design:type",String)],ce.prototype,"joinUri",void 0),i([r.dataFormat(r.DataFormat.Omit),s("design:type",String)],ce.prototype,"ownerId",void 0),t.WorkspaceInfo=ce,function(e){e[e.Unknown="unknown"]="Unknown",e[e.Available="available"]="Available",e[e.Unavailable="unavailable"]="Unavailable",e[e.Connected="connected"]="Connected",e[e.Disconnected="disconnected"]="Disconnected"}(t.WorkspaceConnectionStatus||(t.WorkspaceConnectionStatus={})),function(e){e[e.None="none"]="None",e[e.Requested="requested"]="Requested",e[e.UserRemoved="userRemoved"]="UserRemoved",e[e.UserBlocked="userBlocked"]="UserBlocked",e[e.SessionEnded="sessionEnded"]="SessionEnded",e[e.ConnectionLost="connectionLost"]="ConnectionLost",e[e.InternalError="internalError"]="InternalError",e[e.SessionExpired="sessionExpired"]="SessionExpired",e[e.NetworkDisconnected="networkDisconnected"]="NetworkDisconnected",e[e.ListenerWentOffline="listenerWentOffline"]="ListenerWentOffline",e[e.CollaborationServiceFactoryCriticalFailure="collaborationServiceFactoryCriticalFailure"]="CollaborationServiceFactoryCriticalFailure"}(t.WorkspaceDisconnectedReason||(t.WorkspaceDisconnectedReason={}));t.WorkspaceConnectionStatusChangedEventArgs=class extends f{};class le extends f{}i([r.dataFormat(ce),s("design:type",ce)],le.prototype,"workspace",void 0),t.WorkspaceReadyForConnectionEventArgs=le,function(e){e[e.None="none"]="None",e[e.CreatedWorkspace="createdWorkspace"]="CreatedWorkspace",e[e.InitializedAgentServices="initializedAgentServices"]="InitializedAgentServices",e[e.InitializedRelayAndTCP="initializedRelayAndTCP"]="InitializedRelayAndTCP",e[e.AddedUserToWorkspace="addedUserToWorkspace"]="AddedUserToWorkspace",e[e.JoinedLocalWorkspace="joinedLocalWorkspace"]="JoinedLocalWorkspace",e[e.ReadWorkspaceInfo="readWorkspaceInfo"]="ReadWorkspaceInfo",e[e.OpeningRemoteSession="openingRemoteSession"]="OpeningRemoteSession",e[e.OpenedRemoteSession="openedRemoteSession"]="OpenedRemoteSession",e[e.JoiningRemoteSession="joiningRemoteSession"]="JoiningRemoteSession",e[e.JoinedRemoteSession="joinedRemoteSession"]="JoinedRemoteSession",e[e.WaitingForHost="waitingForHost"]="WaitingForHost",e[e.DoneWaitingForHost="doneWaitingForHost"]="DoneWaitingForHost",e[e.ReconnectingToHost="reconnectingToHost"]="ReconnectingToHost",e[e.ReconnectedToHost="reconnectedToHost"]="ReconnectedToHost",e[e.ReconnectionFailed="reconnectionFailed"]="ReconnectionFailed",e[e.UpdatedWorkspace="updatedWorkspace"]="UpdatedWorkspace"}(t.WorkspaceProgress||(t.WorkspaceProgress={}));t.WorkspaceProgressEventArgs=class extends f{};class ue extends ce{}i([r.dataFormat(r.DataFormat.Path),s("design:type",Array)],ue.prototype,"rootDirectories",void 0),i([r.dataFormat(c),s("design:type",c)],ue.prototype,"persistentRootConfiguration",void 0),t.WorkspaceShareInfo=ue,function(e){e[e.Auto="auto"]="Auto",e[e.Direct="direct"]="Direct",e[e.Relay="relay"]="Relay",e[e.Local="local"]="Local",e[e.SignalR="signalR"]="SignalR"}(t.ConnectionMode||(t.ConnectionMode={}));class de{}t.ClientCapabilities=de;class he{}i([r.dataFormat(r.DataFormat.Text),s("design:type",String)],he.prototype,"directAddress",void 0),i([r.dataFormat(r.DataFormat.Text),s("design:type",String)],he.prototype,"relayAddress",void 0),i([r.dataFormat(r.DataFormat.Token),s("design:type",String)],he.prototype,"relaySharedAccessSignature",void 0),i([r.dataFormat(r.DataFormat.Token),s("design:type",String)],he.prototype,"joiningUserSessionToken",void 0),i([r.dataFormat(de),s("design:type",de)],he.prototype,"clientCapabilities",void 0),i([r.dataFormat(r.DataFormat.Token),s("design:type",String)],he.prototype,"userIdentity",void 0),i([r.dataFormat(r.DataFormat.Token),s("design:type",String)],he.prototype,"initialViewName",void 0),t.WorkspaceJoinInfo=he;t.WorkspaceListOptions=class{constructor(){this.includeRemoteWorkspaces=!0,this.onlyManagedWorkspaces=!1}};t.WorkspaceSessionInfo=class extends ce{};class fe{}i([r.dataFormat(r.DataFormat.Text),s("design:type",String)],fe.prototype,"name",void 0),i([r.dataFormat(r.DataFormat.Email),s("design:type",String)],fe.prototype,"email",void 0),i([r.dataFormat(r.DataFormat.Text),s("design:type",String)],fe.prototype,"userName",void 0),i([r.dataFormat(r.DataFormat.Text),s("design:type",String)],fe.prototype,"provider",void 0),i([r.dataFormat(r.DataFormat.Uri),s("design:type",String)],fe.prototype,"avatarUri",void 0),i([r.dataFormat(de),s("design:type",de)],fe.prototype,"clientCapabilities",void 0),t.WorkspaceUserProfile=fe;t.WorkspaceServicesChangedEventArgs=class extends f{},function(e){e[e.None="none"]="None",e[e.Add="add"]="Add",e[e.Remove="remove"]="Remove",e[e.Replace="replace"]="Replace"}(t.CollectionChangeType||(t.CollectionChangeType={}));t.GuestAcceptance=class{},function(e){e[e.None="none"]="None",e[e.Joined="joined"]="Joined",e[e.Unjoined="unjoined"]="Unjoined",e[e.Canceled="canceled"]="Canceled",e[e.Requested="requested"]="Requested"}(t.WorkspaceSessionChangeType||(t.WorkspaceSessionChangeType={}));class pe extends f{}i([r.dataFormat(fe),s("design:type",fe)],pe.prototype,"userProfile",void 0),t.WorkspaceSessionChangedEventArgs=pe;class me{}i([r.dataFormat(h),s("design:type",h)],me.prototype,"experimentalFeatures",void 0),t.UserSettings=me;t.VSOnlineSettings=class{};class ge{}i([r.dataFormat(r.DataFormat.Text),s("design:type",String)],ge.prototype,"newText",void 0),t.TextChange=ge;class ye{constructor(){this.messageType=d.Unknown}}t.MessageBase=ye,function(e){e[e.SelectionChange="selectionChange"]="SelectionChange",e[e.NotebookSelectionChange="notebookSelectionChange"]="NotebookSelectionChange",e[e.VisibleRangesChange="visibleRangesChange"]="VisibleRangesChange",e[e.TextChange="textChange"]="TextChange",e[e.FileOpenRequest="fileOpenRequest"]="FileOpenRequest",e[e.ResetFileClient="resetFileClient"]="ResetFileClient",e[e.UntitledFileSaved="untitledFileSaved"]="UntitledFileSaved",e[e.UntitledFileOpened="untitledFileOpened"]="UntitledFileOpened",e[e.UntitledFileClosed="untitledFileClosed"]="UntitledFileClosed",e[e.DiffViewOpen="diffViewOpen"]="DiffViewOpen",e[e.DiffViewClosed="diffViewClosed"]="DiffViewClosed",e[e.FileOpenAcknowledge="fileOpenAcknowledge"]="FileOpenAcknowledge",e[e.FileRelease="fileRelease"]="FileRelease",e[e.SaveFile="saveFile"]="SaveFile",e[e.SaveNotebook="saveNotebook"]="SaveNotebook",e[e.JoinRequest="joinRequest"]="JoinRequest",e[e.JoinAcknowledge="joinAcknowledge"]="JoinAcknowledge",e[e.ReadOnlyChange="readOnlyChange"]="ReadOnlyChange",e[e.Handshake="handshake"]="Handshake",e[e.Summon="summon"]="Summon",e[e.LayoutScroll="layoutScroll"]="LayoutScroll",e[e.NotebookScroll="notebookScroll"]="NotebookScroll",e[e.ProjectFileOpened="projectFileOpened"]="ProjectFileOpened",e[e.ProjectFileClosed="projectFileClosed"]="ProjectFileClosed",e[e.PresenterUpdate="presenterUpdate"]="PresenterUpdate",e[e.FollowChange="followChange"]="FollowChange",e[e.AnonymousAccessLevelChange="anonymousAccessLevelChange"]="AnonymousAccessLevelChange",e[e.Ping="ping"]="Ping",e[e.Unknown="unknown"]="Unknown"}(d=t.MessageType||(t.MessageType={}));class ve extends ye{}i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],ve.prototype,"fileName",void 0),t.FileMessageBase=ve;t.JoinRequestMessage=class extends ye{};class Se extends ye{}i([r.dataFormat(r.DataFormat.Path),s("design:type",Array)],Se.prototype,"files",void 0),t.JoinAcknowledgeMessage=Se;t.PresenterUpdateMessage=class extends ye{};t.FollowChangeMessage=class extends ye{};t.SelectionChangeMessage=class extends ve{};t.NotebookSelectionChangeMessage=class extends ve{};class _e{}t.Range=_e;class Ee extends ve{}i([r.dataFormat(_e),s("design:type",Array)],Ee.prototype,"visibleRanges",void 0),t.LayoutScrollMessage=Ee;t.NotebookScrollMessage=class extends ve{};class we{}i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],we.prototype,"fileName",void 0),i([r.dataFormat(_e),s("design:type",Array)],we.prototype,"visibleRanges",void 0),t.EditorVisibleRanges=we;class be extends ye{}i([r.dataFormat(we),s("design:type",Array)],be.prototype,"clientVisibleRanges",void 0),t.VisibleRangesChangeMessage=be;t.FileOpenRequestMessage=class extends ve{};t.ResetFileClientMessage=class extends ve{};t.UntitledFileSavedMessage=class extends ve{};t.UntitledFileOpenedMessage=class extends ve{};t.UntitledFileClosedMessage=class extends ve{};class Ce extends ye{}t.DiffViewMessage=Ce;t.DiffViewOpenMessage=class extends Ce{};t.DiffViewClosedMessage=class extends Ce{};t.HandshakeMessage=class extends ve{};t.SaveFileMessage=class extends ve{};t.SaveNotebookMessage=class extends ve{};t.FileReleaseMessage=class extends ve{};t.AnonymousAcccessLevelChangedMessage=class extends ve{};class Te extends ve{}i([r.dataFormat(ge),s("design:type",Array)],Te.prototype,"changes",void 0),t.TextChangeMessage=Te;t.ReadOnlyChangeMessage=class extends ve{};t.ProjectFileOpenedMessage=class extends ve{};t.ProjectFileClosedMessage=class extends ve{};class Me{}i([r.dataFormat(Te),s("design:type",Te)],Me.prototype,"message",void 0),t.ServerVersionSnapshot=Me;class Ae extends ve{}i([r.dataFormat(Me),s("design:type",Array)],Ae.prototype,"history",void 0),t.FileOpenAcknowledgeMessage=Ae;t.SummonMessage=class extends ye{};t.PingMessage=class extends ye{},function(e){e[e.NotifyDidOpenClose="notifyDidOpenClose"]="NotifyDidOpenClose",e[e.NotifyDidChange="notifyDidChange"]="NotifyDidChange",e[e.NotifyDidSave="notifyDidSave"]="NotifyDidSave",e[e.NotifyAll="notifyAll"]="NotifyAll"}(t.DocumentChangesNotificationFlags||(t.DocumentChangesNotificationFlags={}));t.CoeditingInformation=class{};class ke{}t.DocumentFilter=ke;class Re{}i([r.dataFormat(ke),s("design:type",Array)],Re.prototype,"documentFilters",void 0),t.LanguageServerProviderMetadata=Re;t.NotificationEventArgs=class extends f{};t.LspMessage=class{};class Pe{}t.DebugSession=Pe,function(e){e[e.None="none"]="None",e[e.Add="add"]="Add",e[e.Remove="remove"]="Remove"}(t.DebugSessionChangeType||(t.DebugSessionChangeType={}));class Ie extends f{}i([r.dataFormat(Pe),s("design:type",Pe)],Ie.prototype,"debugSession",void 0),t.DebugSessionChangedEventArgs=Ie;t.LaunchConfigurationChangedEventArgs=class extends f{},function(e){e[e.Go="go"]="Go",e[e.StepIn="stepIn"]="StepIn",e[e.StepOut="stepOut"]="StepOut",e[e.StepOver="stepOver"]="StepOver"}(t.ContinueReason||(t.ContinueReason={}));class Ne extends f{}i([r.dataFormat(u),s("design:type",u)],Ne.prototype,"accessControl",void 0),t.AccessControlEventArgs=Ne,function(e){e[e.Allowed="allowed"]="Allowed",e[e.RejectedInReadOnlySession="rejectedInReadOnlySession"]="RejectedInReadOnlySession",e[e.RejectedForNotOwner="rejectedForNotOwner"]="RejectedForNotOwner",e[e.DisabledByHostConfiguration="disabledByHostConfiguration"]="DisabledByHostConfiguration",e[e.ExplicitlyRejectedByHost="explicitlyRejectedByHost"]="ExplicitlyRejectedByHost",e[e.RejectedPersistentRootNotSupported="rejectedPersistentRootNotSupported"]="RejectedPersistentRootNotSupported"}(t.RestrictedOperationAccess||(t.RestrictedOperationAccess={}));class Le extends f{}i([r.dataFormat(te),s("design:type",te)],Le.prototype,"operation",void 0),t.RestrictedOperationAccessEventArgs=Le;t.FileListOptions=class{},function(e){e[e.None="none"]="None",e[e.Children="children"]="Children",e[e.SingleChildDescendants="singleChildDescendants"]="SingleChildDescendants",e[e.AllDescendants="allDescendants"]="AllDescendants"}(t.FileRecurseMode||(t.FileRecurseMode={})),function(e){e[e.None="none"]="None",e[e.Hidden="hidden"]="Hidden",e[e.ReadOnly="readOnly"]="ReadOnly",e[e.Excluded="excluded"]="Excluded",e[e.External="external"]="External"}(t.FileAttributes||(t.FileAttributes={}));class De{constructor(){this.exists=!0}}i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],De.prototype,"path",void 0),i([r.dataFormat(De),s("design:type",Array)],De.prototype,"children",void 0),t.FileInfo=De;t.FileRootInfo=class extends De{};class xe extends De{}i([r.dataFormat(r.DataFormat.Text),s("design:type",String)],xe.prototype,"text",void 0),t.FileTextInfo=xe;t.FileReadOptions=class{};t.FileWriteOptions=class{};t.FileMoveOptions=class{};t.FileDeleteOptions=class{};t.FileWatchOptions=class{};class Oe{}i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],Oe.prototype,"path",void 0),i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],Oe.prototype,"fullPath",void 0),i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],Oe.prototype,"localFullPath",void 0),t.FileChange=Oe,function(e){e[e.None="none"]="None",e[e.Updated="updated"]="Updated",e[e.Added="added"]="Added",e[e.Deleted="deleted"]="Deleted"}(t.FileChangeType||(t.FileChangeType={}));class Fe extends f{}i([r.dataFormat(Oe),s("design:type",Array)],Fe.prototype,"changes",void 0),t.FilesChangedEventArgs=Fe;class Ue extends f{}i([r.dataFormat(r.DataFormat.Path),s("design:type",Array)],Ue.prototype,"localPaths",void 0),i([r.dataFormat(r.DataFormat.Path),s("design:type",Array)],Ue.prototype,"vslsPaths",void 0),t.ExternalFilesChangedEventArgs=Ue;class je extends f{}i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],je.prototype,"root",void 0),i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],je.prototype,"fullPath",void 0),t.RootsChangedEventArgs=je;class He{}i([r.dataFormat(r.DataFormat.Text),s("design:type",String)],He.prototype,"description",void 0),t.DiffBaseInfo=He;t.ExternalFileMapResult=class{};class Be{}t.TextSearchResultRange=Be;class Ye{}i([r.dataFormat(r.DataFormat.Path),s("design:type",String)],Ye.prototype,"path",void 0),i([r.dataFormat(r.DataFormat.Text),s("design:type",String)],Ye.prototype,"text",void 0),i([r.dataFormat(Be),s("design:type",Array)],Ye.prototype,"ranges",void 0),i([r.dataFormat(Be),s("design:type",Array)],Ye.prototype,"previewRanges",void 0),t.TextSearchResult=Ye;class We{}i([r.dataFormat(xe),s("design:type",Array)],We.prototype,"results",void 0),t.ReadTextResult=We;class qe{}i([r.dataFormat(r.DataFormat.Text),s("design:type",Array)],qe.prototype,"fileIncludes",void 0),i([r.dataFormat(r.DataFormat.Text),s("design:type",Array)],qe.prototype,"fileExcludes",void 0),i([r.dataFormat(r.DataFormat.Text),s("design:type",String)],qe.prototype,"pattern",void 0),t.TextSearchOptions=qe;t.NodeType=class{};t.SolutionWorkspaceNode=class{};t.SolutionChangedEventArgs=class extends f{};t.WorkspaceRootChangedEventArgs=class extends f{},function(e){e[e.Empty="empty"]="Empty",e[e.Folder="folder"]="Folder",e[e.Solution="solution"]="Solution"}(t.WorkspaceMode||(t.WorkspaceMode={}));t.SolutionChangeType=class{};class Ve extends f{}i([r.dataFormat(r.DataFormat.Hide),s("design:type",String)],Ve.prototype,"jsonContent",void 0),t.SourceEventArgs=Ve,function(e){e[e.None="none"]="None",e[e.CanRead="canRead"]="CanRead",e[e.CanWrite="canWrite"]="CanWrite",e[e.CanSeek="canSeek"]="CanSeek"}(t.StreamTraits||(t.StreamTraits={})),function(e){e[e.Global="global"]="Global",e[e.Workspace="workspace"]="Workspace",e[e.WorkspaceFolder="workspaceFolder"]="WorkspaceFolder"}(t.TaskScope||(t.TaskScope={}));class $e{}t.WorkspaceTask=$e;class Ke{}t.TaskExecutionMoniker=Ke,function(e){e[e.Started="started"]="Started",e[e.Terminated="terminated"]="Terminated"}(t.TaskExecutionStatusChange||(t.TaskExecutionStatusChange={}));class ze extends f{}i([r.dataFormat(Ke),s("design:type",Ke)],ze.prototype,"taskExecution",void 0),i([r.dataFormat($e),s("design:type",$e)],ze.prototype,"task",void 0),t.TaskExecutionStatusEventArgs=ze,function(e){e[e.Started="started"]="Started",e[e.AlreadyRunning="alreadyRunning"]="AlreadyRunning",e[e.RetryLater="retryLater"]="RetryLater",e[e.TaskNotFound="taskNotFound"]="TaskNotFound",e[e.RejectedByHost="rejectedByHost"]="RejectedByHost"}(t.RunTaskStatus||(t.RunTaskStatus={}));class Ge{}i([r.dataFormat(Ke),s("design:type",Ke)],Ge.prototype,"taskExecution",void 0),t.RunTaskResult=Ge;t.WorkspaceTaskRestrictedOperation=class extends te{},function(e){e[e.CouldNotConnectToServer=-32e3]="CouldNotConnectToServer",e[e.OlderThanServer=-32001]="OlderThanServer",e[e.NewerThanServer=-32002]="NewerThanServer",e[e.OlderThanPeer=-32003]="OlderThanPeer",e[e.NewerThanPeer=-32004]="NewerThanPeer",e[e.OlderThanAgent=-32005]="OlderThanAgent",e[e.NewerThanAgent=-32006]="NewerThanAgent",e[e.NoIPAddressesDetected=-32010]="NoIPAddressesDetected",e[e.NoConnectionAddresses=-32011]="NoConnectionAddresses",e[e.AutoConnectionFailed=-32012]="AutoConnectionFailed",e[e.RelayConnectionFailed=-32013]="RelayConnectionFailed",e[e.DirectConnectionFailed=-32014]="DirectConnectionFailed",e[e.SessionProtocolError=-32015]="SessionProtocolError",e[e.SessionAuthenticationFailed=-32016]="SessionAuthenticationFailed",e[e.ReconnectFailed=-32017]="ReconnectFailed",e[e.DirectConnectionNotEnabled=-32020]="DirectConnectionNotEnabled",e[e.RelayConnectionNotEnabled=-32021]="RelayConnectionNotEnabled",e[e.CollaborationSessionUsersLimitReached=-32022]="CollaborationSessionUsersLimitReached",e[e.CollaborationSessionGuestRejected=-32023]="CollaborationSessionGuestRejected",e[e.CollaborationSessionRequestTimedOut=-32024]="CollaborationSessionRequestTimedOut",e[e.CollaborationSessionGuestCanceled=-32025]="CollaborationSessionGuestCanceled",e[e.CollaborationSessionNotFound=-32026]="CollaborationSessionNotFound",e[e.CollaborationSessionEnded=-32027]="CollaborationSessionEnded",e[e.CollaborationSessionGuestBlocked=-32028]="CollaborationSessionGuestBlocked",e[e.NonSuccessHttpStatusCodeReceived=-32030]="NonSuccessHttpStatusCodeReceived",e[e.KeychainAccessFailed=-32031]="KeychainAccessFailed",e[e.UnauthorizedHttpStatusCode=-32032]="UnauthorizedHttpStatusCode",e[e.ForbiddenHttpStatusCode=-32033]="ForbiddenHttpStatusCode",e[e.RelayConnectionHostFailure=-32040]="RelayConnectionHostFailure",e[e.RelayConnectionGuestFailure=-32041]="RelayConnectionGuestFailure",e[e.RelayHubNotFoundFailure=-32045]="RelayHubNotFoundFailure",e[e.RelayHubNoHostFailure=-32046]="RelayHubNoHostFailure",e[e.RelayHubNotConnectedFailure=-32047]="RelayHubNotConnectedFailure",e[e.BrokerNotAuthorized=-32050]="BrokerNotAuthorized",e[e.CouldNotConnectToServerAuthFailed=-32060]="CouldNotConnectToServerAuthFailed",e[e.RemoteLaunchNotEnabled=-32200]="RemoteLaunchNotEnabled",e[e.CollaborationSessionGuestRejectedWithSpecificReason=-32300]="CollaborationSessionGuestRejectedWithSpecificReason",e[e.OperationRejected=-32400]="OperationRejected",e[e.OperationRejectedInReadOnlySession=-32401]="OperationRejectedInReadOnlySession",e[e.OperationRejectedForNotOwner=-32402]="OperationRejectedForNotOwner",e[e.OperationRejectedAsPersistentRootNotSupported=-32403]="OperationRejectedAsPersistentRootNotSupported",e[e.FileOperationNotSupported=-32500]="FileOperationNotSupported",e[e.ErrorFileAdditionFailed=-32501]="ErrorFileAdditionFailed",e[e.ErrorFileDeleteFailed=-32502]="ErrorFileDeleteFailed",e[e.ErrorFileRenameFailed=-32503]="ErrorFileRenameFailed",e[e.FileAlreadyExists=-32504]="FileAlreadyExists",e[e.ErrorFolderAdditionFailed=-32505]="ErrorFolderAdditionFailed",e[e.ErrorFolderRenameFailed=-32506]="ErrorFolderRenameFailed"}(t.ErrorCodes||(t.ErrorCodes={})),function(e){e[e.None=0]="None",e[e.AgentLogCreated=1002]="AgentLogCreated",e[e.AgentOutput=2001]="AgentOutput",e[e.CallingOutput=10001]="CallingOutput",e[e.RpcListeningOnPipe=1001]="RpcListeningOnPipe"}(t.TraceEventIds||(t.TraceEventIds={})),function(e){e.Agent="Agent",e.AgentAuth="Agent.Auth",e.AgentCSharpLS="Agent.CSharpLS",e.AgentFile="Agent.File",e.AgentFirewall="Agent.Firewall",e.AgentHttp="Agent.Http",e.AgentProxy="Agent.Proxy",e.AgentPortForwarding="Agent.PortFowrading",e.AgentTcpListenersObserver="Agent.TcpListeners",e.AgentRpc="Agent.Rpc",e.AgentRpcAuth="Agent.Rpc.Auth",e.AgentRpcChat="Agent.Rpc.Chat",e.AgentRpcFile="Agent.Rpc.File",e.AgentRpcFirewall="Agent.Rpc.Firewall",e.AgentRpcServerSharing="Agent.Rpc.ServerSharing",e.AgentRpcSourceEvent="Agent.Rpc.SourceEvent",e.AgentRpcStream="Agent.Rpc.Stream",e.AgentRpcStreamManager="Agent.Rpc.StreamManager",e.AgentRpcStreamTransport="Agent.Rpc.StreamTransport",e.AgentRpcTerminal="Agent.Rpc.Terminal",e.AgentTerminalConnection="Agent.Terminal.Connection",e.AgentRpcWorkspace="Agent.Rpc.Workspace",e.AgentRpcWorkspaceUser="Agent.Rpc.WorkspaceUser",e.AgentRpcTaskOutput="Agent.Rpc.TaskOutput",e.AgentSsh="Agent.Ssh",e.AgentTSLS="Agent.TSLS",e.AgentWorkspace="Agent.Workspace",e.AgentWorkspaceSessionAccessControl="Agent.WorkspaceSession.AccessControl",e.ClientAgent="Client.Agent",e.ClientCoEditing="Client.CoEditing",e.ClientCoEditingBufferManager="Client.CoEditing.BufferManager",e.ClientCoEditingVSCodeEvent="Client.CoEditing.VSCodeEvent",e.ClientFileProvider="Client.FileProvider",e.ClientLauncher="Client.Launcher",e.ClientRpc="Client.Rpc",e.ClientRpcAgentSession="Client.Rpc.AgentSession",e.ClientRpcAuth="Client.Rpc.Auth",e.ClientRpcFile="Client.Rpc.File",e.ClientRpcPortForwarding="Client.Rpc.PortForwarding",e.ClientRpcServerSharing="Client.Rpc.ServerSharing",e.ClientRpcSourceEvent="Client.Rpc.SourceEvent",e.ClientRpcStream="Client.Rpc.Stream",e.ClientRpcStreamManager="Client.Rpc.StreamManager",e.ClientRpcTerminal="Client.Rpc.Terminal",e.ClientRpcChat="Client.Rpc.Chat",e.ClientRpcTerminalEndpoint="Client.Rpc.TerminalEndpoint",e.ClientRpcWorkspace="Client.Rpc.Workspace",e.ClientRpcWorkspaceUser="Client.Rpc.WorkspaceUser",e.ClientRpcSessionContext="Client.Rpc.SessionContext",e.ClientRpcContact="Client.Rpc.Contact",e.ClientWorkspace="Client.Workspace",e.ClientRemoteBuild="Client.RemoteBuild",e.ClientCSharpLS="Client.CSharpLS",e.ClientSharedTerminal="Client.SharedTerminal",e.ClientWorkspaceAccessControl="Client.Workspace.AccessControl",e.ClientAccessControl="Client.AccessControl",e.ClientSearch="Client.Search",e.ClientSourceControl="Client.SourceControl",e.ClientSyncService="Client.SyncService",e.ClientCommentService="Client.CommentService",e.ClientGettingStartedPageContentProvider="Client.GettingStartedPageContentProvider",e.ClientPortForwardingBrowser="Client.PortForwardingBrowser",e.ClientOnlineEnvironmentSessionService="Client.OnlineEnvironmentSessionService",e.Calling="Calling",e.DebugHostAdapter="Debug.HostAdapter",e.DebugRpcHostAdapter="Debug.Rpc.HostAdapter",e.DebugAdapterHost="Debug.AdapterHost",e.ForwardingTcpServer="ForwardingTcpServer",e.ForwardingPipeServer="ForwardingPipeServer",e.Telemetry="Telemetry",e.ClientAccessCheck="ClientAccessCheck",e.LSPCoauthoringManager="LSP.CoauthoringManager",e.RemoteServiceBroker="RemoteServiceBroker",e.ReviewsDiffs="Reviews.Diffs",e.Cli="CLI",e.CliRestore="CLI.restore",e.CliStart="CLI.start",e.CliStop="CLI.stop",e.TTY="TTY",e.Settings="Settings",e.API="API",e.VmAgent="VmAgent",e.SelfHostedAgent="SelfHostedAgent",e.EnvironmentConfig="EnvConfig",e.VMConfig="VMCFG",e.LinuxContainerUpdate="LinuxContainerUpdate",e.ShutDownEnvironmentHandler="ShutdownEnvironment",e.StartEnvironmentHandler="StartEnvironment",e.VmAgentRpcService="VmAgentRpcService",e.RebuildEnvironmentHandler="RebuildEnvironment",e.WarmupEnvironmentHandler="WarmupEnvironment",e.StartLiveShareHandler="StartLiveShare",e.StartPortForwardingHandler="StartPortForwardingHandler",e.ContainerEnvironmentMonitor="ContainerMonitor",e.SSHServerMonitor="SSHServerMonitor",e.ContainerTunnel="ContainerTunnel",e.RunningContainerInfoProvider="RunningContainerInfo",e.DevContainerChangesWatcher="DevContainerChangesWatcher",e.VSCodeServerHostService="VSCodeServerHostService",e.SshServerHostService="SSHServerHostService",e.CodespaceHostService="CodespaceHostService",e.ClientAutoSuspendMonitor="ClientAutoSuspendMonitor",e.DockerImagePrune="DockerImagePrune",e.PrebuildPoolUpdateHandler="PrebuildPoolUpdate",e.StandAloneAgent="StandAloneAgent",e.Viewlet="Viewlet",e.VSIX="VSIX",e.ClientPrefix="Client.",e.ClientLSP="Client.LSP",e.LSPHost="LSP.Host",e.BreakpointManager="BreakpointManager",e.DebugAdapter="Debug.Adapter",e.DebugRemote="Debug.Remote",e.DebugSessionHost="Debug.SessionHost",e.DebugHost="Debug.Host",e.DebugRpcHost="Debug.Rpc.Host",e.DebugTargetHostProcess="Debug.TargetHostProcess",e.DebugRpcSessionHost="Debug.Rpc.SessionHost"}(t.TraceSources||(t.TraceSources={})),t.AgentSessionService={name:"agentSessionService",methods:["initializeSession","enableReconnect","keepAlive","forceKill"],events:[]},t.AuthenticationCoreService={methods:["getCurrentAuthenticatedUser","getCurrentUser","removeRecentCollaborator","removeAllRecentCollaborators"],events:["authenticationChanged"]},t.AuthenticationService={name:"auth",methods:["getLoginUri","findLoginCode","login","loginAsAnonymous","loginWithCachedToken","loginWithExternalToken","logout","getCachedToken","getCurrentAuthenticatedUser","getCurrentUser","removeRecentCollaborator","removeAllRecentCollaborators"],events:["authenticationChanged"]},t.BrokerAuthorizationService={name:"brokerAuthorization",methods:["authorize"],events:[]},t.BrokerManagerService={name:"brokerManager",methods:["register","tryRevoke"],events:[]},t.ChatService={name:"chat",methods:["getMessageHistory","getParticipants","sendMessage","dispose"],events:["messageReceived"]},t.CommentService={name:"commentService",methods:["createCommentThread","createComment","updateComment","deleteComment","getAllCommentThreads","getCommentThreadPositions","updateLike"],events:["commentThreadChanged"]},t.ConfigurationService={name:"version",methods:["exchangeVersions","exchangeSettings","getSubnetMasks"],events:[]},t.FirewallService={name:"firewall",methods:["getFirewallStatus"],events:[]},t.HubConnectionService={name:"hubConnection",methods:["getIsConnected","getIsAttempting","getEnabled","setEnabled","registerHubMethodNotify","unregisterHubMethodNotify","invokeHubMethod","sendHubMethod"],events:["hubConnectionStateChanged","hubConnectionAttempted","hubMethodNotified"]},t.OnlineEnvironmentSessionService={name:"onlineEnvironmentLiveShareSessionService",methods:["getSessionState","updateSessionState"],events:[]},t.PortForwardingService={name:"portForwarding",methods:["getSharedServers","getSharedPipes","getLastAccessTime","setDestinationPort"],events:["sharingStarted","pipeSharingStarted","browseSharingStarted","sharingStopped","pipeSharingStopped","sharingChanged"]},t.ServerSharingService={name:"serverSharing",methods:["startSharing","startSharingPipe","stopSharing","stopSharingPipe","stopSharingBrowseSessions","getSharedServers","getSharedPipes","updateSessionName","updateSharedServerVisibility","updateSharedServerProtocol","updateSharedServerPrivacy"],events:["sharingStarted","pipeSharingStarted","browseSharingStarted","sharingStopped","pipeSharingStopped","sharingChanged"]},t.SessionContextService={name:"sessionContext",methods:["getServiceNames"],voidMethods:["sendSessionStateUpdateToClient","sendSessionStatusUpdateToClient"],events:["sessionStateUpdate","sessionStatusUpdate"]},t.SourceControlService={name:"sourceControl",methods:["getAllSourceControls","getSourceControls","getSourceControl","getRecentVersions","getRecentVersionsTillMergeVersion","getDiffsForVersion","getDiffForResource","getResource","cleanResources","getMergeVersion","getRemoteVersionsNames","getCurrentVersionName"],events:["sourceControlChanged","resourceChanged"]},t.SyncService={name:"syncService",methods:["checkSync","checkSyncForVersion","checkSyncForVersion2"],events:[]},t.TaskOutputService={name:"taskOutput",methods:["getTaskOutputs","shareTaskOutput","updateTaskOutputFeed","closeTaskOutput"],events:["taskOutputShared","taskOutputFeedUpdated","taskOutputClosed"]},t.TelemetryService={name:"telemetry",methods:["initialize","getServiceUri"],events:["genericOperation","fault"]},t.TerminalEndpoint={name:"terminalEndpoint",methods:["readBytes","writeBytes","readString","writeString"],events:[]},t.TerminalService={name:"terminal",methods:["startTerminal","getRunningTerminals","resizeTerminal","stopTerminal","clearTerminalBuffer","setTerminalReadOnlyForGuests"],events:["terminalStarted","terminalResized","terminalStopped","terminalReadOnlyChanged"]},t.TextSearchService={name:"textSearch",methods:["getTextSearchResults","getTextSearchResultsWithProgress"],events:[]},t.VSServerHostService={name:"vsServerHostService",methods:["createSession"],events:[]},t.WorkspaceAccessControlService={name:"workspaceAccessControl",methods:["getAccessControl","setAccessControl","requestOperationAccess","setOperationAccess","rejectOperation"],events:["accessControlChanged","operationRejected","operationAccessChanged","opeationAccessRequested"]},t.WorkspaceDiagnosticsService={name:"workspaceDiagnostics",methods:["getDiagnostics"],events:["diagnosticDataChanged"]},t.WorkspaceService={name:"workspace",methods:["getWorkspace","listWorkspaces","createPersistentWorkspace","deleteWorkspace","renameWorkspace","shareWorkspace","createInvitationLink","getInvitationLinks","unshareWorkspace","beginJoinWorkspace","joinWorkspace","unjoinWorkspace","registerServices","canUserShareWorkspace","canUserHostWorkspace","createPublicInviteLink","disconnectGuest","unjoinOnlineEnvironmentsGuests","setWorkspaceReadyForConnection","updateWorkspaceOwner"],events:["servicesChanged","connectionStatusChanged","progressUpdated","userRemoved","userBlocked","workspaceReadyForConnection"]},t.WorkspaceUserService={name:"workspaceuser",methods:["acceptOrRejectGuest","autoAcceptGuests","removeUser","removeAllInteractiveUsers","fireProgressUpdatedToGuest","getCountOfGuestsWithSameAccount","createGuestDisplayName","getCachedGuestDisplayName","getGuestUserProfile","getCountOfInteractiveGuests"],events:["workspaceSessionChanged"]},t.LanguageServerProvider={methods:["getMetadata","request"],voidMethods:["notify"],events:["notified"]},t.DebuggerHostService={name:"DebuggerHostService",methods:["getCurrentDebugSessions","launchDebugSession","getLaunchConfigurations"],events:["debugSessionChanged","launchConfigurationsChanged"]},t.AccessControlService={name:"accessControl",methods:["getAccessControl"],events:["accessControlChanged"]},t.FileService={name:"file",methods:["registerExternalFiles","listRoots","list","readText","readTextWithProgress","writeText","createDirectory","delete","copy","move","getFiles","isExcluded","findFiles","getTextSearchResults","getTextSearchResultsWithProgress","clearRoots","addRoot","removeRoot","replaceRoot"],events:["filesChanged","rootsChanged","externalFilesChanged"]},t.SolutionViewService={name:"solutionView",methods:["getSolutionMode","getSolutionCaption","getChildrenNodes","getRootNodes","addNewItem","renameItem","deleteItem"],events:["solutionChanged","workspaceRootChanged"]},t.SourceEventService={name:"sourceEvent",methods:["fireEvent","setSourceData","getSourceData"],events:["event"]},t.StreamManagerService={name:"streamManager",methods:["getStream"],events:[]},t.StreamService={name:"stream",methods:["getStreamTraits","getLength","setLength","seek","readBytes","writeBytes","disposeStream"],events:[]},t.WorkspaceTaskService={name:"workspaceTask",methods:["getSupportedTasks","getTaskExecutions","runTask","runProjectTask","runDefaultBuildTask","terminateTask"],events:["taskStarted","taskTerminated"]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(906);t.settingsProviderInstance=new i.DefaultSettingsProvider,t.readUserSettings=async function(){return{}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(5),r=n(163),o=n(162),a=n(18),c=n(395),l=n(9),u=n(229),d=n(7),h=n(909),f=n(910),p=n(7),m=n(942),g={location:i.ProgressLocation.Window,title:""},y=Object.assign(Object.assign({},g),{isUserInitiated:!0});class v{static init(e,t,n){v.extensionContext=e,v._extensionId=n,d.traceSource.info("Extension, IDE, OS : "+v.clientInfoToString(t)),l.Telemetry.addFilter(new l.SendOnceFilter(u.TelemetryEventNames.UNHANDLED_REJECTION_FAULT,[l.TelemetryPropertyNames.EVENT_MESSAGE]))}static getPackage(){return v.getPackageExtension(v._extensionId)}static getPackageExtension(e){const t=i.extensions.getExtension(e);if(t)return t.packageJSON}static get extensionId(){return v._extensionId}static get context(){if(!v.extensionContext)throw new Error("Extension context not initialized");return v.extensionContext}static get enableModalNotifications(){return!e.env.VSLS_TEST_DISABLE_MODAL}static async setCommandContext(e,t){v.contextValues[e]=t,await i.commands.executeCommand("setContext",e,t)}static getCommandContext(e){return v.contextValues[e]}static getErrorString(e){switch(e){case s.vsls.ErrorCodes.CouldNotConnectToServer:return c.localize("error.CouldNotConnectToServer");case s.vsls.ErrorCodes.OlderThanServer:return c.localize("error.OlderThanServer").replace("$(shortName)",r.Settings.get(o.SettingKeys.shortName));case s.vsls.ErrorCodes.NewerThanServer:return c.localize("error.NewerThanServer").replace("$(shortName)",r.Settings.get(o.SettingKeys.shortName));case s.vsls.ErrorCodes.OlderThanPeer:return c.localize("error.OlderThanPeer").replace("$(shortName)",r.Settings.get(o.SettingKeys.shortName));case s.vsls.ErrorCodes.NewerThanPeer:return c.localize("error.NewerThanPeer").replace("$(shortName)",r.Settings.get(o.SettingKeys.shortName));case s.vsls.ErrorCodes.OlderThanAgent:return c.localize("error.OlderThanAgent").replace("$(shortName)",r.Settings.get(o.SettingKeys.shortName));case s.vsls.ErrorCodes.NewerThanAgent:return c.localize("error.NewerThanAgent").replace("$(shortName)",r.Settings.get(o.SettingKeys.shortName));case s.vsls.ErrorCodes.NoIPAddressesDetected:return c.localize("error.NoIPAddressesDetected");case s.vsls.ErrorCodes.NoConnectionAddresses:return c.localize("error.NoConnectionAddresses");case s.vsls.ErrorCodes.AutoConnectionFailed:return c.localize("error.AutoConnectionFailed");case s.vsls.ErrorCodes.RelayConnectionFailed:return c.localize("error.RelayConnectionFailed");case s.vsls.ErrorCodes.DirectConnectionFailed:return c.localize("error.DirectConnectionFailed");case s.vsls.ErrorCodes.SessionProtocolError:return c.localize("error.SessionProtocolError").replace("$(shortName)",r.Settings.get(o.SettingKeys.shortName));case s.vsls.ErrorCodes.SessionAuthenticationFailed:return c.localize("error.SessionAuthenticationFailed");case s.vsls.ErrorCodes.DirectConnectionNotEnabled:return c.localize("error.DirectConnectionNotEnabled");case s.vsls.ErrorCodes.RelayConnectionNotEnabled:return c.localize("error.RelayConnectionNotEnabled");case s.vsls.ErrorCodes.CollaborationSessionUsersLimitReached:return c.localize("error.CollaborationSessionUsersLimitReached");case s.vsls.ErrorCodes.CollaborationSessionGuestRejected:return c.localize("error.CollaborationSessionGuestRejected");case s.vsls.ErrorCodes.CollaborationSessionRequestTimedOut:return c.localize("error.CollaborationSessionRequestTimedOut");case s.vsls.ErrorCodes.CollaborationSessionGuestCanceled:return c.localize("error.CollaborationSessionGuestCanceled");case s.vsls.ErrorCodes.CollaborationSessionNotFound:return c.localize("error.CollaborationSessionNotFound");case s.vsls.ErrorCodes.CollaborationSessionGuestBlocked:return c.localize("error.CollaborationSessionGuestBlocked");case s.vsls.ErrorCodes.NonSuccessHttpStatusCodeReceived:return c.localize("error.NonSuccessHttpStatusCodeReceived");case s.vsls.ErrorCodes.KeychainAccessFailed:return c.localize("error.KeychainAccessFailed");case s.vsls.ErrorCodes.RelayConnectionHostFailure:return c.localize("error.RelayConnectionHostFailure");case s.vsls.ErrorCodes.RelayConnectionGuestFailure:return c.localize("error.RelayConnectionGuestFailure");case s.vsls.ErrorCodes.RemoteLaunchNotEnabled:return c.localize("error.RemoteLaunchNotEnabled");case s.vsls.ErrorCodes.CouldNotConnectToServerAuthFailed:return c.localize("error.CouldNotConnectToServerAuthFailed");default:return""}}static getLocalizedProgressString(e){switch(e){case s.vsls.WorkspaceProgress.OpeningRemoteSession:return c.localize("progress.openingRemoteSession");case s.vsls.WorkspaceProgress.JoiningRemoteSession:return c.localize("progress.joiningRemoteSession");case s.vsls.WorkspaceProgress.WaitingForHost:return c.localize("progress.waitingForHost");case s.vsls.WorkspaceProgress.ReconnectingToHost:return c.localize("progress.reconnectingToHost");default:return""}}static getProgressUpdateString(e){return v.getLocalizedProgressString(e)}static getWaitingForHostProgressUpdateString(e,t){if(!t)return;let n=this.getLocalizedProgressString(e);if(n){const e=r.Settings.get(o.SettingKeys.anonymousUserName),i=t.isAnonymous&&e?e:t.displayName||t.emailAddress||"Unknown user";n=n.replace("$(userName)",i)}return n}static getWorkspaceFilePath(e){return a.join(e,`${r.Settings.get(o.SettingKeys.name)}.code-workspace`)}static async runWithProgress(e,t=y){const n=Object.assign(Object.assign({},y),t),{isUserInitiated:s,cancellationToken:r}=n;if(!r||!r.isCancellationRequested)return s||(n.title=""),await i.window.withProgress(n,async t=>new Promise(async(n,i)=>{r&&r.onCancellationRequested(()=>{n(null)});try{n(await e(t))}catch(e){i(e)}}))}static async showErrorAsync(e,t={},n=[]){const s=("string"==typeof e?e:e.code&&v.getErrorString(e.code)||e.message)||"Unknown error",{modal:r,hideReportAProblem:o}=t;if(o)return await i.window.showErrorMessage(s,{modal:r},...n);const a={title:"Report a Problem"},c=await i.window.showErrorMessage(s,{modal:r},a,...n);return c&&c.title===a.title&&this.reportIssue(),c}static async reportIssue(){const{name:e,publisher:t}=v.getPackage();await i.commands.executeCommand("vscode.openIssueReporter",`${t}.${e}`)}static registerCommand(e,t,n){return i.commands.registerCommand(e,(async function(...n){try{return new l.TelemetryEvent(u.TelemetryEventNames.COMMAND_INITIATED).addProperty("commandName",e).send(),await t.call(this,...n)}catch(t){v.reportCommandError(e,t)}}),n)}static addNewTreeViewItemAdornment(e,t){if(!e)return;let n=!1;const i=new Date,s=r.Settings.get(t);if(s){const e=new Date(s),t=new Date;t.setDate(i.getDate()-7),n=e>t}else r.Settings.save(t,i),n=!0;return e.tooltip=`${e.label} ${n?c.localize("treeView.newTooltip"):""}`,e.label=`${e.label}${n?"":""}`,e}static registerTextEditorCommand(e,t,n){return i.commands.registerTextEditorCommand(e,(function(n,i,...s){try{return t.call(this,n,i,...s)}catch(t){v.reportCommandError(e,t)}}),n)}static async tryRegisterCommand(e,t,n,i=!1,s=!1){let r=void 0;if(await v.isCommandDefined(e)){if(r=this.registeredCommands[e],!s)return r;if(r){const e=v.context.subscriptions.indexOf(r);e>=0&&v.context.subscriptions.splice(e,1),r.dispose()}}try{r=i?v.registerTextEditorCommand(e,t,n):v.registerCommand(e,t,n),v.registeredCommands[e]=r,v.context.subscriptions.push(r)}catch(e){console.error(e)}return r}static async isCommandDefined(e){return(await i.commands.getCommands()).indexOf(e)>=0}static disposeCommand(e){this.registeredCommands[e]&&(this.registeredCommands[e].dispose(),delete this.registeredCommands[e])}static clientInfoToString(e){let t="";return e?(e.extensionVersion&&(e.extensionName&&(t+=e.extensionName,t+="/"),t+=e.extensionVersion),e.applicationVersion&&(t.length>0&&(t+=" "),e.applicationName&&(t+=e.applicationName,t+="/"),t+=e.applicationVersion),e.platformVersion&&(t.length>0&&(t+=" "),e.platformName&&(t+=e.platformName,t+="/"),t+=e.platformVersion),t):t}static getExtensionVersion(e,t=!0){let n=v.getPackageExtension(e).version;return t||(n=n.replace(/-.*/,"")),n}static reportCommandError(e,t){const n=`Unhandled error in '${e}' command: `;d.traceSource.error(n,t),l.Telemetry.sendFault(u.TelemetryEventNames.UNHANDLED_COMMAND_ERROR_FAULT,l.FaultType.Error,n+t.message,t),v.showErrorAsync(t)}static getGlobalStoragePath(){return v.context.globalStoragePath||v.context.extensionPath}static openBrowser(t){e.env.VSLS_TEST_DISABLE_BROWSE?i.window.showInformationMessage("[OPEN] "+t):i.env.openExternal(i.Uri.parse(t))}static isNode(){return void 0!==e&&void 0!==e.release&&"node"===e.release.name}static getExtensionUri(e){return d.getExtensionUri(e,v.context)}static isReadWriteAnonymousEnabled(){var e;return null===(e=f.getExpService())||void 0===e?void 0:e.getTreatmentVariable("vscode","readWriteAnonymous")}static async getAnonymousReadOnlyLabel(e,t,n){if(!e)return"";const i=await e.isClientReadOnly(t.id),s=t.isAnonymous;let r,o=h.workspaceSessionInfoTracker.getAnonymousAccess(t.id),a=this.isReadWriteAnonymousEnabled()&&o===h.AnonymousAccessLevel.readWrite,l="";if(t.isHost)return l;if(n){const t=await e.isClientExplicitlyReadWrite(n);r=i&&!t&&!s}else r=i&&!s;return r?l=c.localize("guestNameViewlet.ReadOnlyLabel"):s&&(l=a?c.localize("guestNameViewlet.AnonymousReadWriteLabel"):c.localize("guestNameViewlet.ReadOnlyAndAnonymousLabel")),l}static async setTransientWorkspace(e){try{const t=i.workspace.workspaceFile.fsPath,n=JSON.parse((new TextDecoder).decode(p.fileAccess.readFileSync(t)));n.transient=e,p.fileAccess.writeFileAsync(t,JSON.stringify(n))}catch(e){m.assert(!1,"Setting transient workspace failed.")}}}t.ExtensionUtil=v,v.contextValues={},v.registeredCommands={}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.TelemetryEventNames=i,i.ADD_EXTERNAL_FILE="add-external-file",i.REMOVE_USER="remove-user",i.BLOCK_USER="block-user",i.FAULT_PREFIX="Fault/",i.ACTIVATE_EXTENSION="activate-extension",i.CLICK_SHARE_BUTTON="click-sharebutton",i.DEACTIVATE_EXTENSION="deactivate-extension",i.ACTIVATE_AGENTASYNC="activate-agentasync",i.JOIN_ON_START_EVENT="join-on-start",i.START_AGENT="start-agent",i.START_AGENT_CONNECTION="start-agentconnection",i.SIGN_IN="signin-user",i.SIGN_IN_EXPLICIT="signin-user-explicit",i.INITIATE_SESSION="initiate-session",i.PRE_RELOAD_WORKSPACE="pre-reload-workspace",i.JOIN_WORKSPACE="join-workspace",i.JOINED_PS_FROM_VIEWLET="join-ps-from-viewlet",i.SHARE_WORKSPACE="share-workspace",i.HAS_COLLABORATORS="has-collaborators",i.CREATE_INVITATION_LINK="create-invitationlink",i.CREATE_WORKSPACE="create-workspace",i.LIST_PLANNED_SESSION="list-planned-session",i.CREATE_PLANNED_SESSION="create-planned-session",i.DELETE_PLANNED_SESSION="delete-planned-session",i.RENAME_PLANNED_SESSION="rename-planned-session",i.COPY_PLANNED_SESSION_LINK="copy-planned-session-link",i.SHOW_PLANNED_SESSIONS="show-planned-sessions",i.PLANNED_SESSIONS_LIST_IS_NOT_EMPTY="planned-sessions-list-is-not-empty",i.WORKSPACE_SIGNIN_RELOAD="signin-reload-workspace",i.HTTP_REQUEST_COMPLETE="complete-httprequest",i.INITIALIZE_DEBUGGING="initialize-debugging",i.INITIALIZE_COAUTHORING="initialize-coauthoring",i.VERSION_CHECK_FAIL=i.FAULT_PREFIX+"check-version-fault",i.ASSERT_FAULT=i.FAULT_PREFIX+"assert-fault",i.DOWNLOAD_FAULT=i.FAULT_PREFIX+"download-fault",i.SIGN_IN_FAULT=i.FAULT_PREFIX+"signin-user-fault",i.SIGN_IN_FAULT_EXPLICIT=i.FAULT_PREFIX+"signin-user-fault-explicit",i.AGENT_INIT_SIGN_IN_ATTEMPT_FAULT=i.FAULT_PREFIX+"signin-agentinit-fault",i.USER_ACTION_AGENT_INIT_SIGN_IN_ATTEMPT_FAULT=i.FAULT_PREFIX+"userinteraction-agentinit-fault",i.UPDATE_WORKPSACE_NAME_FAIL=i.FAULT_PREFIX+"update-workspace-name-fault",i.LEAVE_COLLABORATION_FAIL=i.FAULT_PREFIX+"leave-collaboration-fault",i.CREATE_INVITATION_LINK_FAULT=i.FAULT_PREFIX+"create-invitationlink-fault",i.CREATE_FAULT=i.FAULT_PREFIX+"create-workspace-fault",i.LIST_PLANNED_SESSION_FAULT=i.FAULT_PREFIX+"list-planned-session-fault",i.CREATE_PLANNED_SESSION_FAULT=i.FAULT_PREFIX+"create-planned-session-fault",i.DELETE_PLANNED_SESSION_FAULT=i.FAULT_PREFIX+"delete-planned-session-fault",i.RENAME_PLANNED_SESSION_FAULT=i.FAULT_PREFIX+"rename-planned-session-fault",i.COPY_PLANNED_SESSION_LINK_FAULT=i.FAULT_PREFIX+"copy-planned-session-link-fault",i.JOIN_PLANNED_SESSION_FAULT=i.FAULT_PREFIX+"join-planned-session-fault",i.SHARE_FAULT=i.FAULT_PREFIX+"share-workspace-fault",i.JOIN_FAULT=i.FAULT_PREFIX+"join-workspace-fault",i.ACTIVATE_EXTENSION_FAULT=i.FAULT_PREFIX+"activate-extension-fault",i.DEACTIVATE_EXTENSION_FAULT=i.FAULT_PREFIX+"deactivate-extension-fault",i.ACTIVATE_AGENTASYNC_FAULT=i.FAULT_PREFIX+"activate-agentasync-fault",i.UNHANDLED_COMMAND_ERROR_FAULT=i.FAULT_PREFIX+"unhandled-commanderror-fault",i.UNHANDLED_REJECTION_FAULT=i.FAULT_PREFIX+"unhandled-rejection-fault",i.REQUEST_OPERATION_ACCESS_FAULT=i.FAULT_PREFIX+"request-operation-access-fault",i.TRANSITION="transition-state",i.REPORT_AGENTPROGRESS="report-agentprogress",i.WRITE_LOGS_FAILED=i.FAULT_PREFIX+"write-logs-failed",i.OPEN_LOGS_FAILED=i.FAULT_PREFIX+"open-logs-failed",i.NAME_LOGS_FILE_FAILED=i.FAULT_PREFIX+"name-logfile-failed",i.ACTIVATE_EXTENSION_API="activate-extensionapi",i.SHARE_EXTENSION_SERVICE="share-extensionservice",i.INVOKE_EXTENSION_COMMAND="invoke-extensioncommand",i.FEEDBACK="report-feedback",i.OPEN_LINK="open-link",i.PASTE_INVALIDLINK_FAULT=i.FAULT_PREFIX+"paste-invalidlink-fault",i.LINUX_VERSION="report-linuxversion",i.SESSION="participate-session",i.SILENT_SIGNIN_TIMEOUT=i.FAULT_PREFIX+"signin-timeout-fault",i.JOIN_FROM_BROWSER_FAULT=i.FAULT_PREFIX+"join-browser-fault",i.SHARE_TERMINAL="share-terminal",i.SHARE_TERMINAL_FAULT=i.FAULT_PREFIX+"share-terminal-fault",i.MAKE_TERMINAL_READ_ONLY="make-terminal-read-only",i.MAKE_TERMINAL_READ_ONLY_FAULT=i.FAULT_PREFIX+"make-terminal-read-only-fault",i.MAKE_TERMINAL_READ_WRITE="make-terminal-read-write",i.MAKE_TERMINAL_READ_WRITE_FAULT=i.FAULT_PREFIX+"make-terminal-read-write-fault",i.RUN_SHARED_TERMINAL_FAULT=i.FAULT_PREFIX+"run-terminal-fault",i.OPEN_TERMINAL="open-terminal",i.OPEN_TERMINAL_FAULT=i.FAULT_PREFIX+"open-terminal-fault",i.REMOVE_TERMINAL="remove-terminal",i.REMOVE_TERMINAL_FAULT=i.FAULT_PREFIX+"remove-terminal-fault",i.LIST_TERMINALS="list-terminals",i.LIST_TERMINALS_FAULT=i.FAULT_PREFIX+"list-terminals-fault",i.SHOW_WHATS_NEW_INFO="show-whatsnew",i.WELCOME_PAGE_TOAST_SHOWN="show-welcomepage-toast",i.WELCOME_PAGE_TOAST_SHOWN_INTERACTION="interact-welcomepage-toast",i.WELCOME_PAGE_SHOWN="show-welcomepage",i.WELCOME_PAGE_DISMISSED="dismiss-welcomepage",i.WELCOME_PAGE_COPY_CLICKED="copy-clicked-welcomepage",i.WELCOME_PAGE_LINK_CLICKED="link-clicked-welcomepage",i.SUMMON_PARTICIPANTS_INVOKED="summon-participants",i.COPY_COLLABORATION_LINK_INVOKLED="copy-collaborationlink",i.COMMAND_INITIATED="command-initiated",i.ZEROUSER_SESSION="zerouser-session",i.GUEST_INITIATED_DEBUGGING="guest-initiated-debugging-started",i.REJECT_RESTRICTED_OPERATION="reject-restrictedOperation",i.REQUEST_RESTRICTED_OPERATION="request-restrictedOperationAccess",i.SET_RESTRICTED_OPERATION_ACCESS="set-restrictedOperationAccess",i.REPORT_SETTINGS="report-settings",i.CHANGE_SETTING="change-setting",i.WORKSPACE_CONNECTION_ERROR="drop-workspaceconnection-fault",i.INVOKE_NEWPROTOCOLHANDLER="invoke-newprotocolhandler",i.UNDO_FAILURE="undo-failed",i.REDO_FAILURE="redo-failed",i.FOLLOW_USER_FAILURE="follow-user-failed",i.UNFOLLOW_USER_FAILURE="unfollow-user-failed",i.CHAT_WITH_CONTACT="chat-with-contact",i.CHAT_WITH_CONTACT_FAULT="chat-with-contact-fault",i.CHAT_SELECT_WINDOW="chat-select-window",i.CHAT_SELECT_WINDOW_FAULT="chat-select-window-fault",i.START_OR_JOIN_AUDIO="start-or-join-audio",i.START_OR_JOIN_AUDIO_FAULT="start-or-join-audio-fault",i.INVITE_CONTACT="invite-contact",i.INVITE_CONTACT_FAULT="invite-contact-fault",i.INVITE_CONTACT_BY_EMAIL="invite-contact-by-email",i.INVITE_CONTACT_BY_EMAIL_FAULT="invite-contact-by-email-fault",i.INVITE_NO_CONTACT_BY_EMAIL="invite-no-contact-by-email",i.INVITE_NO_CONTACT_BY_EMAIL_FAULT="invite-no-contact-by-email-fault",i.REMOVE_RECENT_CONTACT="remove-recent-contact",i.REMOVE_RECENT_CONTACT_FAULT="remove-recent-contact-fault",i.INVITE_AVAILABLE_CONTACTS="invite-available-contacts",i.INVITE_AVAILABLE_CONTACTS_FAULT="invite-available-contacts-fault",i.SELECT_PRESENCE_PROVIDER="select-presence-provider",i.SELECT_PRESENCE_PROVIDER_FAULT="select-presence-provider-fault",i.INVITE_SEARCH_CONTACTS="invite-search-contacts",i.INVITE_SEARCH_CONTACTS_FAULT="invite-search-contacts-fault",i.CHANGE_SELF_PRESENCE="change-self-presence",i.CHANGE_SELF_PRESENCE_FAULT="change-self-presence-fault",i.CHANGE_SELF_PRESENCE_STATUS="change-self-presence-status",i.CHANGE_SELF_PRESENCE_STATUS_FAULT="change-self-presence-status-fault",i.SIGN_IN_PRESENCE="sign-in-presence",i.SIGN_IN_PRESENCE_FAULT="sign-in-presence-fault",i.SIGN_OUT_PRESENCE="sign-out-presence",i.SIGN_OUT_PRESENCE_FAULT="sign-out-presence-fault",i.SHARE_SERVER="share-server",i.SHOW_LINK_INVITE_TOAST="show-invitetoast",i.RESPOND_TOAST="respond-invitetoast",i.SHARE_SERVER_FAULT=i.FAULT_PREFIX+"share-server-fault",i.UNSHARE_SERVER="unshare-server",i.UNSHARE_SERVER_FAULT=i.FAULT_PREFIX+"unshare-server-fault",i.BROWSE_SERVER="browse-server",i.BROWSE_SERVER_FAULT=i.FAULT_PREFIX+"browse-server-fault",i.COPY_URL_SERVER="copyurl-server",i.COPY_URL_SERVER_FAULT=i.FAULT_PREFIX+"copyurl-server-fault",i.LIST_SERVERS="list-servers",i.LIST_SERVERS_FAULT=i.FAULT_PREFIX+"list-servers-fault",i.OPEN_SCC_RESOURCE="open-scc-resource",i.OPEN_SCC_RESOURCE_FAULT=i.FAULT_PREFIX+"open-scc-resource-fault",i.OPEN_SCC_CHANGE="open-scc-change",i.OPEN_SCC_CHANGE_FAULT=i.FAULT_PREFIX+"open-scc-change-fault",i.DISCARD_SCC_CHANGE="discard-scc-change",i.DISCARD_SCC_CHANGE_FAULT=i.FAULT_PREFIX+"discard-scc-change-fault",i.DISCARD_ALL_SCC_CHANGES="discard-all-scc-changes",i.DISCARD_ALL_SCC_CHANGES_FAULT=i.FAULT_PREFIX+"discard-all-scc-changes-fault",i.REVERT_SCC_CHANGE="revert-scc-change",i.REVERT_SCC_CHANGE_FAULT=i.FAULT_PREFIX+"revert-scc-change-fault",i.USER_ELEVATION_TOGGLE_COMMAND="elevatetoggle-user",i.USER_ELEVATION_TOGGLE_COMMAND_FAULT=i.USER_ELEVATION_TOGGLE_COMMAND+"-fault",i.CREATE_COMMENT_THREAD="create-comment-thread",i.CREATE_COMMENT_THREAD_FAULT=i.FAULT_PREFIX+"create-comment-thread-fault",i.DELETE_COMMENT_THREAD="delete-comment-thread",i.DELETE_COMMENT_THREAD_FAULT=i.FAULT_PREFIX+"delete-comment-thread-fault",i.REPLY_COMMENT="reply-comment",i.REPLY_COMMENT_FAULT=i.FAULT_PREFIX+"reply-comment-fault",i.EDIT_COMMENT="edit-comment",i.EDIT_COMMENT_FAULT=i.FAULT_PREFIX+"edit-comment-fault",i.DELETE_COMMENT="delete-comment",i.DELETE_COMMENT_FAULT=i.FAULT_PREFIX+"delete-comment-fault",i.SAVE_COMMENT="save-comment",i.SAVE_COMMENT_FAULT=i.FAULT_PREFIX+"save-comment-fault",i.CANCEL_EDIT_COMMENT="cancel-edit-comment",i.CANCEL_EDIT_COMMENT_FAULT=i.FAULT_PREFIX+"cancel-edit-comment-fault",i.DISMISS_SURVEY="dismiss-survey",i.EVALUATED_CLIENT_FOR_EXPERIMENT="evaluated-client-for-experiment",i.TOKEN_EXPIRED="token-expired-presence-fault",i.AUDIO_CONNECT_CALL="audio-connect-call",i.AUDIO_CALL_STARTED_NOTIFICATION="audio-call-started-notification",i.AUDIO_CALL_INFO_NOTIFICATION="audio-call-info-notification",i.AUDIO_CALL_UNEXPECTED_NOTIFICATION="audio-call-unexpected-notification",i.AUDIO_INVALID_SESSION_TRANSITION="audio-invalid-session-transition",i.AUDIO_GET_SELECTED_DEVICES="audio-get-selected-devices",i.AUDIO_GET_PARTICIPANTS="audio-get-participants",i.AUDIO_END_CALL="audio-end-call",i.AUDIO_ENUMERATE_DEVICES="audio-enumerate-devices",i.AUDIO_MUTE="audio-mute",i.AUDIO_UNMUTE="audio-unmute",i.AUDIO_SELECT_DEVICE="audio-select-device",i.INSTALL_RECOVERY="install-recovery",i.INSTALL_RECOVERY_TOAST="install-recovery-toast",i.DELETE_RUNTIME_DEPENDENCIES="delete-runtime-dependencies",i.JOIN_PROMPT_DISPLAYED="join-prompt-displayed",i.CHAT_HANDSHAKE_REQUEST="chat-handshake-request",i.CHAT_HANDSHAKE_RESPONSE="chat-handshake-response",i.CHAT_UNKNOWN_USER_ID="chat-unknown-user-id",i.CHAT_DISABLED_MESSAGE="chat-disabled-message",i.CHAT_COMMAND_INVOKED="chat-command-invoked",i.CHAT_CREATE_WINDOW="chat-create-window",i.CHAT_UPDATE_WINDOW="chat-update-window",i.CHAT_ISCONNECTED_CHANGED="chat-isconnected-changed",i.CHAT_NOTIFY="chat-notify",i.CHAT_FAULT="chat-fault",i.CHAT_OPEN_SESSION="chat-open-session",i.CHAT_OPEN_SESSION_FAULT=i.FAULT_PREFIX+"chat-open-session-fault",i.RESPOND_ANONYMOUS_JOIN_REQUEST="respond-anonymous-join-request",i.AUTH_PROMPTED_SIGNIN="auth-prompted-signin",i.AUTH_SILENT_CHECK="auth-silent-check",i.UPDATE_ANONYMOUS_GUEST_ACCESS_LEVEL="update-anonymous-guest-access-level",i.TRY_LOAD_SESSION="try-load-session",i.COLLABORATE_BLOCK="collaborate-block",i.PIN="pin",i.FOCUS_PARTICIPANT="focus-participant",i.FOCUS_PARTICIPANTS="focus-participants";class s{}t.TelemetryPropertyNames=s,s.FEATURE_NAME="liveshare.",s.FEATURE_NAME_V2=s.FEATURE_NAME+"v2.",s.AGENT_START_AGENT_FOUND=s.FEATURE_NAME+"AgentFound",s.AGENT_SPAWN_START_TIME=s.FEATURE_NAME+"AgentSpawnStartTime",s.AGENT_SPAWN_END_TIME=s.FEATURE_NAME+"AgentSpawnEndTime",s.CORRELATION_ID=s.FEATURE_NAME+"CorrelationId",s.EVENT_RESULT=s.FEATURE_NAME+"Result",s.EVENT_MESSAGE=s.FEATURE_NAME+"Message",s.EVENT_EXCEPTION_STACK=s.FEATURE_NAME+"ExceptionStack",s.EVENT_EXCEPTION_CODE=s.FEATURE_NAME+"ExceptionCode",s.EVENT_DURATION=s.FEATURE_NAME+"Duration",s.IS_DEBUGGING=s.FEATURE_NAME+"IsDebugging",s.IS_VSCODE_ACCOUNT_ENABLED=s.FEATURE_NAME+"IsVSCodeAccountEnabled",s.IS_VSCODE_ACCOUNT_AUTH_SUPPORTED=s.FEATURE_NAME+"IsVSCodeAccountSupported",s.IS_MAC_OSX_CATALINA_OR_NEWER=s.FEATURE_NAME+"IsMacOSxCatalinaOrNewer",s.AUTH_FLOW_INITIALIZATION_COMMAND=s.FEATURE_NAME+"AuthFlowInitializationCommand",s.SILENT_SIGN_IN=s.FEATURE_NAME+"SilentSignIn",s.SIGN_IN_WITH_CODE=s.FEATURE_NAME+"WithCode",s.SIGN_IN_WITH_BROWSER=s.FEATURE_NAME+"BrowserSignIn",s.JOIN_WITH_LINK=s.FEATURE_NAME+"WithLink",s.COMMAND_TEXT=s.FEATURE_NAME+"CommandText",s.JOIN_INVOKE_COMMAND=s.FEATURE_NAME+"CommandText",s.TELEMETRY_EVENT_VERSION=s.FEATURE_NAME+"TelemetryEventVersion",s.SHARE_WORKSPACE_STARTING=s.FEATURE_NAME+"ShareWorkspaceStarting",s.SHARE_WORKSPACE_COMPLETE=s.FEATURE_NAME+"ShareWorkspaceComplete",s.SHARE_WORKSPACE_COUNT_OF_WORKSPACE_FOLDERS=s.FEATURE_NAME+"WorkspaceFolderCount",s.SHARED_AS_PLANNED_SESSION=s.FEATURE_NAME+"SharedAsPlannedSession",s.FIREWALL_CHECK_COMPLETE=s.FEATURE_NAME+"FirewallCheckComplete",s.FIREWALL_CHECK_STARTING=s.FEATURE_NAME+"FirewallCheckStarting",s.GET_WORKSPACE_COMPLETE=s.FEATURE_NAME+"GetWorkspaceComplete",s.INIT_COEDITING_COMPLETE=s.FEATURE_NAME+"InitCoeditingComplete",s.INIT_DEBUGGING_COMPLETE=s.FEATURE_NAME+"InitDebuggingComplete",s.INIT_LSP_COMPLETE=s.FEATURE_NAME+"InitLspComplete",s.INIT_BREAKPOINT_COMPLETE=s.FEATURE_NAME+"InitBreakpointComplete",s.INIT_TASK_COMPLETE=s.FEATURE_NAME+"InitTaskComplete",s.INIT_ACCESS_CONTROL_COMPLETE=s.FEATURE_NAME+"InitAccessControlComplete",s.INIT_TEXT_SEARCH_SERVICE_COMPLETE=s.FEATURE_NAME+"InitTextSearchServiceComplete",s.INIT_GUEST_CHANNEL_SERVICE_COMPLETE=s.FEATURE_NAME+"InitGuestChannelServiceComplete",s.INIT_GUEST_NOTEBOOKS_SERVICE_COMPLETE=s.FEATURE_NAME+"InitGuestNotebooksServiceComplete",s.INIT_SOURCE_CONTROL_SERVICE_COMPLETE=s.FEATURE_NAME+"InitSourceControlServiceComplete",s.INIT_COMMENT_SERVICE_COMPLETE=s.FEATURE_NAME+"InitCommentServiceComplete",s.INIT_SYNC_SERVICE_COMPLETE=s.FEATURE_NAME+"InitSyncServiceComplete",s.INIT_FILE_SERVICE_COMPLETE=s.FEATURE_NAME+"InitFileServiceComplete",s.INIT_HOST_NOTEBOOKS_SERVICE_COMPLETE=s.FEATURE_NAME+"InitHostNotebooksServiceComplete",s.INIT_COMMENT_MANAGER_COMPLETE=s.FEATURE_NAME+"InitCommentManagerComplete",s.INIT_COMMAND_COMPLETE=s.FEATURE_NAME+"InitCommandComplete",s.INIT_PATH_MANAGER_COMPLETE=s.FEATURE_NAME+"InitPathManagerComplete",s.REJECTED_BY_HOST=s.FEATURE_NAME+"RejectedByHost",s.REJECTED_BY_HOST_AS_ANONYMOUS=s.FEATURE_NAME+"RejectedByHostAsAnonymous",s.JOIN_REQUEST_TIMED_OUT=s.FEATURE_NAME+"JoinRequestTimedOut",s.WORKSPACE_NOT_FOUND=s.FEATURE_NAME+"WorkspaceNotFound",s.UNAUTHORIZED=s.FEATURE_NAME+"Unauthorized",s.RELOAD_START_TIME=s.FEATURE_NAME+"ReloadStartTime",s.RELOAD_RESUMED_TIME=s.FEATURE_NAME+"ReloadResumedTime",s.RELOAD_END_TIME=s.FEATURE_NAME+"ReloadEndTime",s.JOIN_WORKSPACE_COMPLETE=s.FEATURE_NAME+"JoinWorkspaceComplete",s.SERVICE_ENDPOINT=s.FEATURE_NAME+"ServiceEndpoint",s.IS_HOST=s.FEATURE_NAME+"IsHost",s.IS_READONLY_SESSION=s.FEATURE_NAME+"IsReadOnlySession",s.CREATE_WORKSPACE=s.FEATURE_NAME+"CreateWorkspace",s.CREATE_PLANNED_SESSION=s.FEATURE_NAME+"CreatePlannedSession",s.DELETE_PLANNED_SESSION=s.FEATURE_NAME+"DeletePlannedSession",s.RENAME_PLANNED_SESSION=s.FEATURE_NAME+"RenamePlannedSession",s.LIST_PLANNED_SESSION=s.FEATURE_NAME+"ListPlannedSession",s.COPY_PLANNED_SESSION_LINK=s.FEATURE_NAME+"CopyPlannedSessionLink",s.JOIN_PLANNED_SESSION=s.FEATURE_NAME+"JoinPlannedSession",s.PERSISTENT_WORKSPACE_EXISTS=s.FEATURE_NAME+"PersistentWorkspaceExists",s.SHARE_FROM_CREATE_WORKSPACE=s.FEATURE_NAME+"ShareFromCreateWorkspace",s.COPYLINK_FROM_CREATE_WORKSPACE=s.FEATURE_NAME+"CopyLinkFromCreateWorkspace",s.MOREINFO_FROM_CREATE_WORKSPACE=s.FEATURE_NAME+"MoreInfoFromCreateWorkspace",s.CONVERSATION_ID=s.FEATURE_NAME_V2+"ConversationId",s.VERSION_PLATFORMNAME=s.FEATURE_NAME+"Version.PlatformName",s.VERSION_PLATFORMVERSION=s.FEATURE_NAME+"Version.PlatformVersion",s.VERSION_PLATFORMVERSION_SERVICEPACK=s.FEATURE_NAME+"Version.PlatformVersion.ServicePack",s.FAULT_TYPE=s.FEATURE_NAME+"FaultType",s.ENVIRONMENT_VECTOR=s.FEATURE_NAME+"EnvironmentVector",s.PERFORMANCE_RUN=s.FEATURE_NAME+"PerformanceRun",s.CURRENT_STATE=s.FEATURE_NAME+"CurrentState",s.NEXT_STATE=s.FEATURE_NAME+"NextState",s.TRANSITION_ACTION=s.FEATURE_NAME+"TransitionAction",s.EXTENSION_ACTIVATION_INITIAL_INIT_COMPLETE=s.FEATURE_NAME+"ExtensionActivationInitialInitComplete",s.EXTENSION_ACTIVATION_COMPAT_CHECK_COMPLETE=s.FEATURE_NAME+"ExtensionActivationCompatCheckComplete",s.EXTENSION_ACTIVATION_LAUNCHER_SETUP_COMPLETE=s.FEATURE_NAME+"ExtensionActivationLauncherSetupComplete",s.EXTENSION_ACTIVATION_AGENT_PROCESS_SETUP_COMPLETE=s.FEATURE_NAME+"ExtensionActivationAgentProcessSetupComplete",s.EXTENSION_ACTIVATION_POST_JOIN=s.FEATURE_NAME+"ActivatedPostJoin",s.JOIN_FROM_BROWSER=s.FEATURE_NAME+"JoinFromBrowser",s.JOIN_DEBUG_SESSION_OPTION=s.FEATURE_NAME+"JoinDebugSessionOption",s.IS_FIRST_ACTIVATION=s.FEATURE_NAME+"IsFirstActivation",s.IS_FIRST_EXTENSION_RUN=s.FEATURE_NAME+"IsFirstExtensionRun",s.IS_ELECTRON_DEPENDENCY_SHOULD_BE_INSTALLED=s.FEATURE_NAME+"IsElectronDependencyShouldBeInstalled",s.IS_ELECTRON_DEPENDENCY_INSTALLED=s.FEATURE_NAME+"IsElectronDependencyInstalled",s.IS_RUNTIME_DEPENDENCIES_INSTALLED=s.FEATURE_NAME+"IsRuntimeDependenciesInstalled",s.IS_EXTENSION_BEING_UPDATED=s.FEATURE_NAME+"isExtensionBeingUpdated",s.IS_EXTENSION_PACK_CANDIDATE_PRESENT=s.FEATURE_NAME+"isExtensionPackCandidatePresent",s.SHOWED_INITIAL_INSTALL_INFO_PAGE=s.FEATURE_NAME+"ShowedInitialInstallInfoPage",s.INITIAL_INSTALL_INFO_PAGE_EXPERIMENT_OPEN_BY_DEFAULT=s.FEATURE_NAME+"InitialInstallInfoPageExperimentOpenByDefault",s.NAME_TAG_VISIBILITY=s.FEATURE_NAME+"NameTagVisibility",s.NUM_DEBUGGING_PROCESSES=s.FEATURE_NAME+"NumDebuggingProcesses",s.DEBUG_PROMPT=s.FEATURE_NAME+"DebugPrompt",s.NUM_OPEN_FILES=s.FEATURE_NAME+"NumOpenFiles",s.IS_INTERNAL=s.FEATURE_NAME+"IsInternal",s.IS_CLOUD_ENVIRONMENT=s.FEATURE_NAME+"IsCloudEnvironment",s.USER_TEAM_STATUS=s.FEATURE_NAME+"UserTeamStatus",s.CONNECTION_MODE=s.FEATURE_NAME+"ConnectionMode",s.CONNECTION_MODE_USED=s.FEATURE_NAME+"ConnectionModeUsed",s.CREATED_AT=s.FEATURE_NAME+"CreatedAt",s.UPDATED_AT=s.FEATURE_NAME+"UpdatedAt",s.EXPIRES_AT=s.FEATURE_NAME+"ExpiresAt",s.PROGRESS_DURATION=s.FEATURE_NAME+"ProgressDuration",s.AGENT_START_INITAL_DATA=s.FEATURE_NAME+"InitialData",s.AGENT_START_RESOLVED_STATE=s.FEATURE_NAME+"ResolvedState",s.AGENT_START_PROCESS_SPAWN_COMMAND_SENT=s.FEATURE_NAME+"ProcessSpawnCommandSent",s.AGENT_START_CONNECTION_RETRY_COUNT=s.FEATURE_NAME+"RetryCount",s.AGENT_START_CONNECTION_URI_PROTOCOL=s.FEATURE_NAME+"UriProtocol",s.AGENT_START_CONNECTION_OWNER=s.FEATURE_NAME+"Owner",s.AGENT_WAS_DOWNLOAD_CORRUPTED=s.FEATURE_NAME+"WasDownloadCorrupted",s.CLIENT_LOG_LINES=s.FEATURE_NAME+"ClientLogLines",s.AGENT_LOG_LINES=s.FEATURE_NAME+"AgentLogLines",s.FEATURE_FLAGS=s.FEATURE_NAME+"FeatureFlags",s.EXTENSION_REQUESTED_API_VERSION=s.FEATURE_NAME+"ExtensionRequestedApiVersion",s.EXTENSION_NAME=s.FEATURE_NAME+"ExtensionName",s.EXTENSION_VERSION=s.FEATURE_NAME+"ExtensionVersion",s.EXTENSION_INVOKED_COMMAND=s.FEATURE_NAME+"ExtensionInvokedCommand",s.EXTENSION_INVOKED_COMMAND_OPTIONS=s.FEATURE_NAME+"ExtensionInvokedCommandOptions",s.EXTENSION_SERVICE_NAME=s.FEATURE_NAME+"ExtensionServiceName",s.EXTENSION_SERVICE_PERMITTED=s.FEATURE_NAME+"ExtensionServicePermitted",s.START_WAITING_FOR_HOST=s.FEATURE_NAME+"StartWaitingForHost",s.DONE_WAITING_FOR_HOST=s.FEATURE_NAME+"DoneWaitingForHost",s.RECONNECTING_TO_HOST=s.FEATURE_NAME+"ReconnectingToHost",s.RECONNECTED_TO_HOST=s.FEATURE_NAME+"ReconnectedToHost",s.GUEST_CANCELED=s.FEATURE_NAME+"GuestCanceled",s.TRANSITION_SEQUENCE=s.FEATURE_NAME+"TransitionSequence",s.TIME_SINCE_LAST_TRANSITION=s.FEATURE_NAME+"TimeSinceLastTransition",s.GUESTS_BY_IDE=s.FEATURE_NAME+"GuestsByIDE",s.DISTINCT_GUESTS_BY_IDE=s.FEATURE_NAME+"DistinctGuestsByIDE",s.ACTIVE_COLLABORATION_DURATION=s.FEATURE_NAME+"ActiveCollaborationDuration",s.ACTIVE_COLLABORATION_BLOCKS=s.FEATURE_NAME+"ActiveCollaborationBlocks",s.FILE_NAME=s.FEATURE_NAME+"FileName",s.RELOAD_POST_TIMEOUT=s.FEATURE_NAME+"ReloadPostTimeout",s.SHARED_TERMINAL_SHELL=s.FEATURE_NAME+"SharedTerminalShell",s.SHARED_TERMINAL_READONLY=s.FEATURE_NAME+"SharedTerminalReadOnly",s.IS_ALTERNATE_SHARE_BUTTON_TEXT=s.FEATURE_NAME+"AlternateShareButtonText",s.COMMAND_AUTH_RETRY_COUNT=s.FEATURE_NAME+"CommandAuthRetryCount",s.COMMAND_DID_AUTH=s.FEATURE_NAME+"CommandDidAuth",s.COMMAND_ALLOWS_ANONYMOUS=s.FEATURE_NAME+"COMMAND_ALLOWS_ANONYMOUS",s.COMMAND_SHOULED_SKIP_ANONYMOUS_PROMPT=s.FEATURE_NAME+"CommandShouldSkipAnonymousPrompt",s.COMMAND_DID_AUTH_FULL=s.FEATURE_NAME+"CommandDidAuthFull",s.COMMAND_AUTO_AUTHED_ANONYMOUSLY_BUT_ANONYMOUS_NOT_ALLOWED=s.FEATURE_NAME+"CommandAutoAuthedAnonymouslyButAnonymousNotAllowed",s.COMMAND_AUTO_AUTHED_RESULT=s.FEATURE_NAME+"CommandAutoAuthedResult",s.COMMAND_STARTED_UNAUTHENTICATED=s.FEATURE_NAME+"CommandStartedUnauthenticated",s.COMMAND_SHOULD_SHOW_ANONYMOUS_TOAST=s.FEATURE_NAME+"CommandShouldShowAnonymousToast",s.COMMAND_STARTED_BLOCKING_AUTH=s.FEATURE_NAME+"CommandStartedBlockingAuth",s.COMMAND_BLOCKING_ANONYMOUS_LOGIN_FLOW_RESULT=s.FEATURE_NAME+"CommandBlockingAnonymousLoginFlowResult",s.COMMAND_BLOCKING_NON_ANONYMOUS_LOGIN_FLOW_RESULT=s.FEATURE_NAME+"CommandBlockingNonAnonymousLoginFlowResult",s.COMMAND_AUTH_PROMPT_QUESTION_RESULT=s.FEATURE_NAME+"CommandAuthPromptQuestionResult",s.COMMAND_AUTH_PROMPT_OPENED=s.FEATURE_NAME+"CommandAuthPromptOpened",s.USER_OPTED_OUT_TO_AUTH_ON_JOIN=s.FEATURE_NAME+"UserOptedOutToAuthOnJoin",s.USER_PICKED_NAME_LENGTH=s.FEATURE_NAME+"UserPickedNameLength",s.USER_PICKED_DEFAULT_NAME=s.FEATURE_NAME+"UserPickedDefaultName",s.COMMAND_COMPLETED_AUTH_FULL=s.FEATURE_NAME+"CommandCompleteAuthFull",s.MORE_INFO_CLICKED=s.FEATURE_NAME+"MoreInfoClicked",s.ZEROUSER_SESSION_REASON=s.FEATURE_NAME+"ZeroUserSessionReason",s.DEBUGGING_STARTED_WORKSPACE_FOLDER=s.FEATURE_NAME+"DebuggingStartedForWorkspaceFolder",s.DEBUGGING_STARTED_WORKSPACE_FOLDER_COUNT=s.FEATURE_NAME+"DebuggingWorkspaceFolderCount",s.OPERATION_NAME=s.FEATURE_NAME+"OperationName",s.OPERATION_ACCESS=s.FEATURE_NAME+"OperationAccess",s.REJECTION_REASON=s.FEATURE_NAME+"RejectionReason",s.SETTING_VALUES=s.FEATURE_NAME+"Settings",s.USER_DISMISSED_SIGN_IN_MODAL=s.FEATURE_NAME+"UserDismissedSignInModal",s.SIGN_IN_MODAL_URL_CHANGES=s.FEATURE_NAME+"SignInModalURLChanges",s.SESSION_ID=s.FEATURE_NAME+"LiveShareSessionId",s.RELOAD_SELECTED=s.FEATURE_NAME+"UserSelectedReload",s.INIT_SEARCHPROVIDER_COMPLETE=s.FEATURE_NAME+"InitSearchProviderComplete",s.ADD_ADDITIONALROOTS_COMPLETE=s.FEATURE_NAME+"AddAdditionalRootsComplete",s.JOIN_WITHOUT_RELOAD=s.FEATURE_NAME+"JoinWithoutReload",s.JOIN_FROM_PROTOCOL_HANDLER=s.FEATURE_NAME+"JoinFromProtocolHandler",s.JOIN_FROM_INVITE_LINK=s.FEATURE_NAME+"JoinFromInviteLink",s.URI=s.FEATURE_NAME+"Uri",s.JOIN_CORRELATION_ID=s.FEATURE_NAME+"JoinCorrelationId",s.SIGN_IN_RETRIES=s.FEATURE_NAME+"SignInRetries",s.EMPTY_WORKSPACE_FOLDERS_OPENED=s.FEATURE_NAME+"EmptyWorkspaceFoldersOpened",s.AUTO_SHARING_ON_LOAD=s.FEATURE_NAME+"AutoSharingOnLoad",s.STATE_EVENT_FIRST=s.FEATURE_NAME+"StateEventFirst",s.STATE_EVENT_LAST=s.FEATURE_NAME+"StateEventLast",s.STATE_EVENT_ORDER=s.FEATURE_NAME+"StateEventOrder",s.STATUS_EVENT_ORDER=s.FEATURE_NAME+"StatusEventOrder",s.EXTERNAL_SIGNIN_STARTING=s.FEATURE_NAME+"ExternalSignInStarting",s.EXTERNAL_SIGNIN_USER_MADE_VENDOR_CHOICE=s.FEATURE_NAME+"ExternalSignInUserMadeVendorChoice",s.EXTERNAL_SIGNIN_USER_COMPLETE_FLOW=s.FEATURE_NAME+"ExternalSignInUserCompleteFlow",s.EXTERNAL_SIGNIN_USER_COMPLETE_FLOW_TOKEN_SET=s.FEATURE_NAME+"ExternalSignInUserCompleteFlowTokenSet",s.BROWSER_NAME=s.FEATURE_NAME+"BrowserName",s.BROWSER_VERSION=s.FEATURE_NAME+"BrowserVersion",s.EXTERNAL_SIGNIN_SELECTED_VENDOR=s.FEATURE_NAME+"ExternalSignInSelectedVendor",s.EXTERNAL_SIGNIN_COMPLETE=s.FEATURE_NAME+"ExternalSignInComplete",s.ATTEMPT_DEFAULT_LOGIN_STARTING=s.FEATURE_NAME+"AttemptDefaultLoginStarting",s.ATTEMPT_DEFAULT_LOGIN_COMPLETE=s.FEATURE_NAME+"AttemptDefaultLoginComplete",s.ATTEMPT_LOGIN_STARTING=s.FEATURE_NAME+"AttemptLoginStarting",s.ATTEMPT_LOGIN_COMPLETE=s.FEATURE_NAME+"AttemptLoginComplete",s.ATTEMPT_ANONYMOUS_LOGIN_STARTING=s.FEATURE_NAME+"AttemptAnonymousLoginStarting",s.ATTEMPT_ANONYMOUS_LOGIN_COMPLETE=s.FEATURE_NAME+"AttemptAnonymousLoginComplete",s.SILENT_NATIVE_LOGIN_STARTING=s.FEATURE_NAME+"SilentNativeLoginStarting",s.SILENT_NATIVE_LOGIN_RESULT=s.FEATURE_NAME+"SilentNativeLoginResult",s.SILENT_NATIVE_LOGIN_SIGNED_IN_WITH_NATIVE_PROVIDER=s.FEATURE_NAME+"SilentNativeLoginSignedInWithNativeProvider",s.SILENT_NATIVE_LOGIN_AUTH_PROVIDER=s.FEATURE_NAME+"SilentNativeLoginAuthProvider",s.SILENT_NATIVE_LOGIN_SIGNED_IN_AS_ANONYMOUS=s.FEATURE_NAME+"SilentNativeLoginSignedInAsAnonymous",s.SILENT_NATIVE_LOGIN_ATTEMPTING_ANONYMOUS_STRATEGY=s.FEATURE_NAME+"SilentNativeLoginAttemptingAnonymousStrategy",s.SILENT_NATIVE_LOGIN_IS_ANONYMOUS_TOKEN_SET=s.FEATURE_NAME+"SilentNativeLoginIsAnonymousTokenSet",s.PROMPTED_NATIVE_LOGIN_STARTING=s.FEATURE_NAME+"PromptedNativeLoginStarting",s.PROMPTED_NATIVE_LOGIN_RESULT=s.FEATURE_NAME+"PromptedNativeLoginResult",s.PROMPTED_NATIVE_LOGIN_THE_USER_CANCELED_AUTH_PROVIDER_PICK=s.FEATURE_NAME+"PromptedNativeLoginTheUserCanceledAuthProviderPick",s.PROMPTED_NATIVE_LOGIN_CANCELED_VIA_CANCELLATION_TOKEN=s.FEATURE_NAME+"PromptedNativeLoginCancelledViaCancellationToken",s.PROMPTED_NATIVE_LOGIN_SELECTED_AUTH_PROVIDER=s.FEATURE_NAME+"PromptedNativeLoginSelectedAuthProvider",s.PROMPTED_NATIVE_LOGIN_FAILED_TO_ACQUIRE_AUTH_TOKEN=s.FEATURE_NAME+"PromptedNativeLoginFailedToAcquireAuthToken",s.LOGIN_IS_NATIVE=s.FEATURE_NAME+"IsNative",s.LOGIN_RESULT=s.FEATURE_NAME+"Result",s.LOGIN_IS_CANCELED=s.FEATURE_NAME+"AuthCanceled",s.TRY_LOAD_SESSION_RESULT=s.FEATURE_NAME+"Result",s.VSCODE_ERROR_CALL_STACK=s.FEATURE_NAME+"VscodeErrorCallStack",s.SIGNIN_STARTING=s.FEATURE_NAME+"SigninStarting",s.SIGNIN_PROMPT_STARTING=s.FEATURE_NAME+"SigninPromptStarting",s.SIGNIN_PROMPT_COMPLETED=s.FEATURE_NAME+"SigninPromptCompleted",s.SIGNIN_COMPLETED=s.FEATURE_NAME+"SigninCompleted",s.SIGNIN_COMPLETED_ERROR=s.FEATURE_NAME+"SigninCompletedError",s.SIGNIN_COMPLETED_CANCEL=s.FEATURE_NAME+"SigninCompletedCancel",s.SIGNIN_CHECK_STARTING=s.FEATURE_NAME+"SigninCheckStarting",s.SIGNIN_CHECK_COMPLETED=s.FEATURE_NAME+"SigninCheckCompleted",s.SIGNIN_CHECK_COMPLETED_ERROR=s.FEATURE_NAME+"SigninCheckCompletedError",s.SIGNIN_CHECK_COMPLETED_CANCEL=s.FEATURE_NAME+"SigninCheckCompletedCancel",s.WELCOME_PAGE_LINK=s.FEATURE_NAME+"WelcomePageLink",s.SHARE_INIT_WORKSPACE_FOLDERS_COUNT=s.FEATURE_NAME+"ShareInitWorkspaceFoldersCount",s.CURRENT_AB_EXPERIMENT=s.FEATURE_NAME+"CurrentAbExperiment",s.CURRENT_AB_TESTER_VERSION=s.FEATURE_NAME+"CurrentAbTesterVersion",s.CURRENT_AB_EXPERIMENT_GROUP=s.FEATURE_NAME+"CurrentAbExperimentGroup",s.COUNT_OF_CONCURRENT_AB_EXPERIMENTS=s.FEATURE_NAME+"CountOfConcurrentAbExperiments",s.FIRST_LIVESHARE_ACTIVATION=s.FEATURE_NAME+"FirstLiveShareActivation",s.SELECTED_FOR_ELECTRON_AUTH_MODAL_EXPERIMENT=s.FEATURE_NAME+"SelectedForElectronAuthModalExperiment",s.AUTH_ELECTRON_MODAL_USED=s.FEATURE_NAME+"AuthElectronModalUsed",s.AUTH_ELECTRON_MODAL_EXCEPTION=s.FEATURE_NAME+"AuthElectronModalException",s.RECOVER_ROOT_FOLDER=s.FEATURE_NAME+"RecoverRootFolder",s.SAMPLE_RATE=s.FEATURE_NAME+"SampleRate",s.DEFAULT_SIGN_IN=s.FEATURE_NAME+"DefaultSignIn",s.EVALUATED_EXPERIMENT_NAME=s.FEATURE_NAME+"evaluated-experiment-name",s.EVALUATED_EXPERIMENT_GROUP=s.FEATURE_NAME+"evaluated-experiment-group",s.INVITE_CONTACT_TYPE=s.FEATURE_NAME+"InviteContactType",s.TOAST_RESULT=s.FEATURE_NAME+"ToastResult",s.TOKEN_EXPIRED_DAYS=s.FEATURE_NAME+"TokenExpiredDays",s.WAIT_FOR_HOST_PROMPT=s.FEATURE_NAME+"WaitForHostPrompt",s.RETRY_JOIN=s.FEATURE_NAME+"RetryJoin",s.AUTH_CANCEL_WAIT_FOR_CODE=s.FEATURE_NAME+"AuthCancelWaitingForExternalCode",s.AUTH_CANCEL_BROWSER_CANCEL=s.FEATURE_NAME+"AuthCancelBrowserOperationCancelled",s.AUTH_CANCEL_NO_TOKEN_USER_CANCELLED=s.FEATURE_NAME+"AuthCancelNoTokenOrUserCancelled",s.AUTH_CANCEL_NO_ANON_AUTH=s.FEATURE_NAME+"AuthCancelNoAnonAuth",s.AUTH_CANCEL_ANONYMOUS_LOGIN_FLOW=s.FEATURE_NAME+"AuthCancelAnonymousLoginFlow",s.CREATE_INVITATION_LINK=s.FEATURE_NAME+"CreateInvitationLink",s.INSTALL_RECOVERY_SOURCE=s.FEATURE_NAME+"install-recovery-source",s.INSTALL_RECOVERY_TOAST_RESULT=s.FEATURE_NAME+"install-recovery-toast-result",s.INSTALL_RECOVERY_RELOAD=s.FEATURE_NAME+"install-recovery-reload",s.INSTALL_RECOVERY_CANCELED=s.FEATURE_NAME+"install-recovery-canceled",s.INSTALL_RECOVERY_RETRY=s.FEATURE_NAME+"install-recovery-retry",s.INSTALL_RECOVERY_RETRY_CANCELED=s.FEATURE_NAME+"install-recovery-retry-canceled",s.INSTALL_RECOVERY_DISABLED=s.FEATURE_NAME+"install-recovery-disabled",s.DELETE_DEPENDENCIES_DOWNLOAD_FILE=s.FEATURE_NAME+"delete-dependencies-download-file",s.DELETE_DEPENDENCIES_INSTALLED_FILE=s.FEATURE_NAME+"reinstall-dependencies-installed-file",s.DELETE_DEPENDENCIES_CLEAN_INSTALL_PATH=s.FEATURE_NAME+"reinstall-dependencies-clean-install-path",s.SELECTED_ACTION=s.FEATURE_NAME+"SelectedAction",s.AUDIO_DEVICE_TYPE=s.FEATURE_NAME+"AudioDeviceType",s.AUDIO_SESSION_STATE=s.FEATURE_NAME+"AudioSessionState",s.AUDIO_SESSION_ACTION=s.FEATURE_NAME+"AudioSessionAction",s.CHAT_IS_DIRECT_MESSAGE=s.FEATURE_NAME+"ChatIsDirectMessage",s.CHAT_DISABLED_MESSAGE_KEY=s.FEATURE_NAME+"ChatDisabledMessageKey",s.CHAT_NOTIFY_TYPE=s.FEATURE_NAME+"ChatNotifyType",s.CHAT_COMMAND=s.FEATURE_NAME+"ChatCommand",s.CHAT_ISDISABLED=s.FEATURE_NAME+"ChatIsDisabled",s.CHAT_ISCONNECTED=s.FEATURE_NAME+"ChatIsConnected",s.PLANNED_SESSIONS_LIST_SIZE=s.FEATURE_NAME+"PlannedSessionsListSize",s.ACCEPTED=s.FEATURE_NAME+"Accepted",s.READONLY=s.FEATURE_NAME+"Readonly",s.IS_ANONYMOUS_ELEVATED=s.FEATURE_NAME+"IsAnonymousElevated",function(e){e[e.StatusBar=0]="StatusBar",e[e.Command=1]="Command"}(t.TelemetryEventOrigin||(t.TelemetryEventOrigin={}))},function(e,t,n){"use strict";(function(t){var i=n(35),s=n(923),r=n(400),o={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c,l={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(c=n(401)),c),transformRequest:[function(e,t){return s(t,"Accept"),s(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)||t&&"application/json"===t["Content-Type"]?(a(t,"application/json"),function(e,t,n){if(i.isString(e))try{return(t||JSON.parse)(e),i.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,n=t&&t.silentJSONParsing,s=t&&t.forcedJSONParsing,o=!n&&"json"===this.responseType;if(o||s&&i.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(o){if("SyntaxError"===e.name)throw r(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};l.headers={common:{Accept:"application/json, text/plain, */*"}},i.forEach(["delete","get","head"],(function(e){l.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){l.headers[e]=i.merge(o)})),e.exports=l}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(13),s=n(15),r=n(7);t.showDiagnosticErrorMessage=function(e){i.Settings.get(s.SettingKeys.diagnosticMode)&&r.NotificationUtil.showErrorMessage(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.NotebookConstants=i,i.cellIdPropertyName="vsls_cell_id",i.mirrorNotebookTypePrefix="vsls-",i.notebookErrorMimeType="application/vnd.code.notebook.error",i.notebookStandardErrorMimeType="application/vnd.code.notebook.stderr"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.SCROLL=0]="SCROLL",e[e.EDITORS=1]="EDITORS"}(t.UpdateCoEditorVisibleRangesReason||(t.UpdateCoEditorVisibleRangesReason={})),function(e){e[e.SUCCESSFUL=0]="SUCCESSFUL",e[e.FAILED=1]="FAILED",e[e.MODIFIED=2]="MODIFIED"}(t.ApplyEditResult||(t.ApplyEditResult={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(60),s=n(235),r=n(413),o=n(165);class a{constructor(e,t){this.line=e,this.character=t}}t.CollabBufferPosition=a;class c{constructor(e,t,n,i,s,r){this.offset=e,this.length=t,this.start=n,this.end=i,this.oldText=s,this.newText=r}}class l{constructor(e,t,n,i){this.index=e,this.offset=t,this.length=n,this.text=i}}class u{constructor(e,t){this.trace=t,this.recording=!1,this.recordedEdits=null,this.unexpandedRecordedEdits=null,this.recordEditsForUndo=!1,this.recordedUndoEdits=null,this.lines=u.convertStringToLines(e);const n=new Uint32Array(this.lines.length);this.lines.forEach((e,t)=>{n[t]=e.length}),this.lineStarts=new r.PrefixSumComputer(n)}static convertStringToLines(e){const t=e.length;let n=[],i=0,s=0,r=0;for(let o=0;o<t;o++){const t=e.charCodeAt(o);10===t?(n[i++]=e.substring(s,o+1),s=o+1):13===r&&(n[i++]=e.substring(s,o),s=o),r=t}return n[i++]=e.substring(s,t+1),13===r&&(n[i++]=""),n}static convertVsCodeContentChangeToCollabChange(e,t){let n=new a(e.range.start.line,e.range.start.character),i=new a(e.range.end.line,e.range.end.character),s=e.text;return function(e,t){return e.length>0&&10===e.charCodeAt(0)&&(t.line>0||t.character>0)}(s,n)&&([s,n]=function(e,t,n){let i,s;return 0===t.character?(s=n.getLineContent(t.line-1),i=new a(t.line-1,s.length-1)):(s=n.getLineContent(t.line),i=new a(t.line,t.character-1)),13===s.charCodeAt(i.character)&&(t=i,e="\r\n"+e),[e,t]}(s,n,t)),[n,i,s]}_validatePosition(e){let{line:t,character:n}=e;if(t<0)return t=0,n=0,new a(t,n);if(t>=this.lines.length)return t=this.lines.length-1,n=this.lines[t].length,new a(t,n);let i=this.lines[t].length;return n<0?(n=0,new a(t,n)):n>i?(n=i,new a(t,n)):e}offsetAt(e){return e=this._validatePosition(e),this.lineStarts.getAccumulatedValue(e.line-1)+e.character}positionAt(e){e=Math.floor(e),e=Math.max(0,e);const t=this.lineStarts.getIndexOf(e),n=this.lines[t.index].length;return new a(t.index,Math.min(t.remainder,n))}getContent(){return this.lines.join("")}getLineContent(e){return i.assert(e<this.lines.length,"Line content requested outside of buffer"),this.lines[e]}getMaximumOffset(){return this.lineStarts.getAccumulatedValue(this.lines.length)}startCapturingEditsFromUndoing(){this.recordEditsForUndo=!0,this.recordedUndoEdits=[]}stopCapturingEditsFromUndoing(){this.recordEditsForUndo=!1;let e=this.recordedUndoEdits;return this.recordedUndoEdits=null,e}beginRecording(){this.recording=!0,this.recordedEdits=null,this.unexpandedRecordedEdits=null}endRecording(){const e=this.recordedEdits||[],t=this.unexpandedRecordedEdits||[];return this.recordedEdits=null,this.unexpandedRecordedEdits=null,this.recording=!1,[e,t]}_convertToInternalEditWithValidation(e,t,n){e=this._validatePosition(e),t=this._validatePosition(t);const i=this.offsetAt(e),s=this.offsetAt(t),r=this._getContentInRange(e,t);return new c(i,s-i,e,t,r,n)}_convertInternalEditsToTextChange(e){const t=this._expandCRLFEdits(e);let n=new Array(t.length),i=new Array(t.length),r=0,o=0;for(let a=0;a<t.length;a++){const c=e[a],l=t[a];n[a]=new s.TextChange(l.offset,l.oldText,l.offset+r,l.newText),i[a]=new s.TextChange(c.offset,c.oldText,c.offset+o,c.newText),r+=l.newText.length-l.length,o+=c.newText.length-c.length}return[n,i,t]}convertCollabufferChangeToITextChange(e,t,n){const i=this._convertToInternalEditWithValidation(e,t,n),[s,r,o]=this._convertInternalEditsToTextChange([i]);return s[0]}applyLocalEdit(e,t,n){const i=this._convertToInternalEditWithValidation(e,t,n);this._applyInternalEdits([i])}_convertEditsToInternalEdits(e){let t=e.map((e,t)=>new l(t,e.position,e.length,e.text));return t=u._sortAndValidateEdits(this.getMaximumOffset(),t),t=u._mergeAdjacentEdits(t),t.map(e=>{const t=this.positionAt(e.offset),n=this.positionAt(e.offset+e.length),i=this._getContentInRange(t,n);return new c(e.offset,e.length,t,n,i,e.text)})}transformEditsToTextChanges(e){const t=this._convertEditsToInternalEdits(e),[n,i,s]=this._convertInternalEditsToTextChange(t);return n}applyRemoteEdits(e){const t=this._convertEditsToInternalEdits(e);return this._applyInternalEdits(t)}static _sortAndValidateEdits(e,t){return o.checkDebugging()&&t.forEach(t=>{i.assert(t.offset>=0,"invalid position"),i.assert(t.offset<=e,"invalid position"),i.assert(t.length>=0,"invalid length"),i.assert(t.offset+t.length<=e,"invalid length")}),t.sort(u._compareEdits),o.checkDebugging()&&t.forEach((e,t,n)=>{if(0===t)return;const s=n[t-1];s.offset+s.length>e.offset&&i.assert(!1,"invalid edits: overlapping")}),t}static _compareEdits(e,t){const n=e.offset-t.offset;return 0===n?e.index-t.index:n}static _mergeAdjacentEdits(e){if(e.length<=1)return e;let t=[],n=0,i=e[0];for(let s=1,r=e.length;s<r;s++){const r=e[s];i.offset+i.length!==r.offset?(t[n++]=i,i=r):i=new l(i.index,i.offset,i.length+r.length,i.text+r.text)}return t[n++]=i,t}_getContentInRange(e,t){if(e.line===t.line)return this.lines[e.line].substring(e.character,t.character);let n=[],i=0;n[i++]=this.lines[e.line].substr(e.character);for(let s=e.line+1;s<t.line;s++)n[i++]=this.lines[s];return n[i++]=this.lines[t.line].substr(0,t.character),n.join("")}_expandCRLFEdits(e){let t=[],n=0;for(let i=0,s=e.length;i<s;i++){const s=e[i];let r=s.offset,o=s.length,l=s.start,u=s.end,d=s.oldText,h=s.newText;if(r>0){let e,t;0===l.character?(t=this.lines[l.line-1],e=new a(l.line-1,t.length-1)):(t=this.lines[l.line],e=new a(l.line,l.character-1)),13===t.charCodeAt(e.character)&&(r--,o++,h="\r"+h,d="\r"+d,l=e)}const f=this.lines[u.line];u.character<f.length&&10===f.charCodeAt(u.character)&&(o++,h+="\n",d+="\n",u=new a(u.line+1,0)),t[n++]=new c(r,o,l,u,d,h)}return t}_applyInternalEdits(e){this.trace.verbose(`CollabBuffer._applyInternalEdits ${JSON.stringify(e.map(e=>({start:e.start,end:e.end,length:e.length,offset:e.offset,newText:e.newText.length,oldText:e.oldText.length})))}`);const[t,n,i]=this._convertInternalEditsToTextChange(e);for(let e=i.length-1;e>=0;e--){const t=i[e];this._delete(t.start,t.end),this._insert(t.start,t.newText)}return this.recording&&(this.recordedEdits=s.compressConsecutiveTextChanges(this.recordedEdits||[],t),this.unexpandedRecordedEdits=s.compressConsecutiveTextChanges(this.unexpandedRecordedEdits||[],n)),this.recordEditsForUndo&&(this.recordedUndoEdits=s.compressConsecutiveTextChanges(this.recordedUndoEdits||[],t)),t}_setLineText(e,t){this.lines[e]=t,this.lineStarts.changeValue(e,t.length)}_delete(e,t){if(e.line===t.line){if(e.character===t.character)return;let n=this.lines[e.line];return void this._setLineText(e.line,n.substring(0,e.character)+n.substring(t.character))}let n=this.lines[e.line],i=this.lines[t.line];this._setLineText(e.line,n.substring(0,e.character)+i.substring(t.character)),this.lines.splice(e.line+1,t.line-e.line),this.lineStarts.removeValues(e.line+1,t.line-e.line)}_insert(e,t){if(0===t.length)return;let n=u.convertStringToLines(t);if(1===n.length){let t=this.lines[e.line];return void this._setLineText(e.line,t.substring(0,e.character)+n[0]+t.substring(e.character))}n[n.length-1]+=this.lines[e.line].substring(e.character),this._setLineText(e.line,this.lines[e.line].substring(0,e.character)+n[0]),n.shift();let i=new Uint32Array(n.length);for(let e=0;e<n.length;e++)i[e]=n[e].length;this.lines=function(e,t,n){const i=e.slice(0,t),s=e.slice(t);return i.concat(n,s)}(this.lines,e.line+1,n),this.lineStarts.insertValues(e.line+1,i)}}t.CollabBuffer=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(60);class s{constructor(e,t,n,i){this.oldPosition=e,this.oldLength=t.length,this.oldEnd=this.oldPosition+this.oldLength,this.oldText=t,this.newPosition=n,this.newLength=i.length,this.newEnd=this.newPosition+this.newLength,this.newText=i}}t.TextChange=s,t.compressConsecutiveTextChanges=function(e,t){return e?(new r).compress(e,t):t};class r{constructor(){}static _rebaseCurr(e,t){return new s(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new s(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}compress(e,t){this.prevEdits=e,this.currEdits=t,this.result=[],this.resultLen=0;let n=0;this.prevLen=this.prevEdits.length,this.prevDeltaOffset=0;let o=0;this.currLen=this.currEdits.length,this.currDeltaOffset=0;let a=this._getPrev(n),c=this._getCurr(o);for(;n<this.prevLen||o<this.currLen;){if(null===a){this._acceptCurr(c),c=this._getCurr(++o);continue}if(null===c){this._acceptPrev(a),a=this._getPrev(++n);continue}if(c.oldEnd<=a.newPosition){this._acceptCurr(c),c=this._getCurr(++o);continue}if(a.newEnd<=c.oldPosition){this._acceptPrev(a),a=this._getPrev(++n);continue}if(c.oldPosition<a.newPosition){let[e,t]=r._splitCurr(c,a.newPosition-c.oldPosition);this._acceptCurr(e),c=t;continue}if(a.newPosition<c.oldPosition){let[e,t]=r._splitPrev(a,c.oldPosition-a.newPosition);this._acceptPrev(e),a=t;continue}let e,t;if(i.assert(c.oldPosition===a.newPosition,"unexpected"),c.oldEnd===a.newEnd)e=a,t=c,a=this._getPrev(++n),c=this._getCurr(++o);else if(c.oldEnd<a.newEnd){let[n,i]=r._splitPrev(a,c.oldLength);e=n,t=c,a=i,c=this._getCurr(++o)}else{let[i,s]=r._splitCurr(c,a.newLength);e=a,t=i,a=this._getPrev(++n),c=s}this.result[this.resultLen++]=new s(e.oldPosition,e.oldText,t.newPosition,t.newText),this.prevDeltaOffset+=e.newLength-e.oldLength,this.currDeltaOffset+=t.newLength-t.oldLength}let l=r._merge(this.result);return r._removeNoOps(l)}_acceptCurr(e){this.result[this.resultLen++]=r._rebaseCurr(this.prevDeltaOffset,e),this.currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this.currLen?this.currEdits[e]:null}_acceptPrev(e){this.result[this.resultLen++]=r._rebasePrev(this.currDeltaOffset,e),this.prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this.prevLen?this.prevEdits[e]:null}static _splitPrev(e,t){let n=e.newText.substr(0,t),i=e.newText.substr(t);return[new s(e.oldPosition,e.oldText,e.newPosition,n),new s(e.oldEnd,"",e.newPosition+t,i)]}static _splitCurr(e,t){let n=e.oldText.substr(0,t),i=e.oldText.substr(t);return[new s(e.oldPosition,n,e.newPosition,e.newText),new s(e.oldPosition+t,i,e.newEnd,"")]}static _merge(e){if(0===e.length)return e;let t=[],n=0,i=e[0];for(let r=1;r<e.length;r++){let o=e[r];i.oldEnd===o.oldPosition?i=new s(i.oldPosition,i.oldText+o.oldText,i.newPosition,i.newText+o.newText):(t[n++]=i,i=o)}return t[n++]=i,t}static _removeNoOps(e){if(0===e.length)return e;let t=[],n=0;for(let i=0;i<e.length;i++){let s=e[i];s.oldText!==s.newText&&(t[n++]=s)}return t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(93);t.getTimedArray=function(e){const t=new s(e);return new Proxy([],{set:function(e,n,i){return e[n]=i,t.arrayUpdated(e),!0}})},t.setArray=function(e,t){e.length>t.length&&e.splice(t.length),e.splice(0,t.length,...t)};class s{constructor(e){this.wasZeroLength=!0,this.timeAtLastZeroLength=0,this.telemetry=new i.TimeTelemetry(e,()=>{this.arrayUpdated([])})}arrayUpdated(e){const t=0===e.length;if(t&&!this.wasZeroLength){const e=(new Date).getTime()-this.timeAtLastZeroLength;this.telemetry.RecordTime(e)}else!t&&this.wasZeroLength&&(this.timeAtLastZeroLength=(new Date).getTime());this.wasZeroLength=t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=new RegExp(/\r?\n|\r/g);t.removeLineEndings=function(e){return e.replace(i,"")},t.calculateFileHash=function(e){let t=352654597,n=t,i=0;const s=e.length;for(;s>=i+4;){t=(t<<5)+t+(t>>27)^(e.charCodeAt(i+1)<<16)+e.charCodeAt(i),n=(n<<5)+n+(n>>27)^(e.charCodeAt(i+3)<<16)+e.charCodeAt(i+2),i+=4}if(s>i){let n=e.charCodeAt(i);s>i+1&&(n+=e.charCodeAt(i+1)<<16),t=(t<<5)+t+(t>>27)^n}if(s>i+2){let t=e.charCodeAt(i+2);s>i+3&&(t+=e.charCodeAt(i+3)<<16),n=(n<<5)+n+(n>>27)^t}return t+function(e,t){const n=65535&t;return((t-n)*e|0)+(n*e|0)|0}(n,1566083941)|0}},function(e,t,n){"use strict";t.__esModule=!0;var i=n(417);t.default=i.default,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(955))},function(e,t,n){"use strict";function i(e){const t=()=>(void 0===t.value&&(t.value=t.loader()),t.value);return t.loader=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.lazyLoad=function(e){let t;return(n=!0)=>void 0!==t?t:n?t=e():void 0},t.lazyLoadMutable=i,t.lazyLoadNotImplemented=function(){throw new Error("Dependencies: Instance not provided.")},t.delayedLoadMutable=function(e){return i(()=>{throw Error(`Dependencies: ${e} is not yet initialized`)})},t.setLazyLoadMutable=function(e,t){return"function"==typeof t&&(e.loader=t),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(992),s=n(993);t.liveshareGithubStrategy=new i.LiveShareGithubStrategy,t.liveshareAnonymousStrategy=new s.LiveShareAnonymousStrategy},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e,t){super(e),this.code=t}}t.UserError=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e,t){super(e),this.code=t}}t.NonBlockingError=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e,t,n){super(e),this.code=t,this.isSuppressUserNotification=n}}t.ByDesignError=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),s=n(19),r=n(241),o=n(6),a=n(998),c=n(242),l=n(9);class u{static DeriveTelemetryResultFromErrorCode(e){switch(e.code){case i.vsls.ErrorCodes.CollaborationSessionGuestRejected:case i.vsls.ErrorCodes.ForbiddenHttpStatusCode:case i.vsls.ErrorCodes.CollaborationSessionGuestCanceled:case i.vsls.ErrorCodes.CollaborationSessionRequestTimedOut:case i.vsls.ErrorCodes.CollaborationSessionNotFound:case i.vsls.ErrorCodes.CollaborationSessionUsersLimitReached:case i.vsls.ErrorCodes.RelayConnectionHostFailure:return l.TelemetryResult.UserFailure}}static DeriveTelemetryResultFromErrorType(e){return e instanceof r.UserError?l.TelemetryResult.UserFailure:e instanceof o.CancellationError?l.TelemetryResult.Cancel:e instanceof a.IndeterminateError?l.TelemetryResult.IndeterminateFailure:e instanceof c.NonBlockingError?l.TelemetryResult.NonBlockingFailure:void 0}static DeriveTelemetryResult(e){const t=u.DeriveTelemetryResultFromErrorCode(e);if(void 0!==t)return t;const n=u.DeriveTelemetryResultFromErrorType(e);return void 0!==n?n:l.TelemetryResult.Failure}static DeriveTelemetryTitle(e,t){let n="Success";return t===l.TelemetryResult.UserFailure?n="User Failure":t===l.TelemetryResult.Cancel?n="Cancelled":t===l.TelemetryResult.IndeterminateFailure?n="Indeterminate Failure":t===l.TelemetryResult.Failure?n="Failure":t===l.TelemetryResult.NonBlockingFailure&&(n="Non Blocking Failure"),`${e} ${n}`}static BuildTelemetryMessage(e,t,n){let i="";return void 0!==n&&(i=`: ${n}`),`${this.DeriveTelemetryTitle(e,t)}${i}`}static MapTelemetryResultToFaultType(e){switch(e){case l.TelemetryResult.UserFailure:return l.FaultType.User;case l.TelemetryResult.Cancel:return l.FaultType.UserCancelled;case l.TelemetryResult.Failure:return l.FaultType.Error;case l.TelemetryResult.NonBlockingFailure:return l.FaultType.NonBlockingFault;case l.TelemetryResult.IndeterminateFailure:default:return l.FaultType.Unknown}}static MapTelemetryResultToTraceEventType(e){return e===l.TelemetryResult.Success?s.LogLevel.Info:s.LogLevel.Error}}t.TelemetryUtil=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),s=n(8),r=n(428),o=n(9),a=n(16);t.ClientAccessCheck=class{constructor(e,t){this.workspaceAccessControlService=e,this.hostSessionId=t}getContextSessionId(e){if(e&&"object"==typeof e&&(e=void 0!==e.GuestSessionId?e.GuestSessionId:"object"==typeof e.context?e.context.GuestSessionId:void 0),"number"==typeof e&&(e=e.toString()),"string"==typeof e)return e}isHostSession(e){return this.hostSessionId.toString()===e}isHostSessionContext(e){return this.isHostSession(this.getContextSessionId(e))}async isReadOnlySession(){await this.ensureWorkspaceAccessControl();const{defaultAccessControl:e={}}=this.workspaceAccessControl;return!!e.isReadOnly}async isClientExplicitlyReadWrite(e){const t=this.getContextSessionId(e);if(this.isHostSession(t)||!t)return!1;await this.ensureWorkspaceAccessControl();const{defaultAccessControl:n={},userAccessControl:i={}}=this.workspaceAccessControl,s=i[t];return!!s&&(n.isReadOnly&&!s.isReadOnly)}async isClientReadOnly(e){const t=this.getContextSessionId(e);return!(this.isHostSession(t)||!t)&&(await this.ensureWorkspaceAccessControl(),!!(this.workspaceAccessControl.userAccessControl[t]||this.workspaceAccessControl.defaultAccessControl||{}).isReadOnly)}async canPerformOperation(e,t){return!t||(t.ownerOnly&&!this.isHostSessionContext(e)?(this.sendRejectedOperationTelemetry(t,r.RestrictedOperationRejectionReason.RejectedForNotOwner),!1):!t.enabledInReadOnlySession&&await this.isClientReadOnly(e)?(this.sendRejectedOperationTelemetry(t,r.RestrictedOperationRejectionReason.RejectedInReadOnlySession),!1):!t.isEnabled||!0===t.isEnabled()||(this.sendRejectedOperationTelemetry(t,r.RestrictedOperationRejectionReason.DisabledByHost),!1))}async verifyCanPerformOperation(e,t){if(!await this.canPerformOperation(e,t)){if(t.ownerOnly&&!this.isHostSessionContext(e))throw new s.ResponseError(i.vsls.ErrorCodes.OperationRejectedForNotOwner,"This operation is not allowed for non owners.");if(!t.enabledInReadOnlySession&&await this.isClientReadOnly(e))throw new s.ResponseError(i.vsls.ErrorCodes.OperationRejectedInReadOnlySession,"This operation is not allowed in read-only collaboration session.");if(t.isEnabled){const e=t.isEnabled();if(e&&"object"==typeof e)throw new s.ResponseError(e.errorCode,e.errorMessage)}throw new s.ResponseError(i.vsls.ErrorCodes.OperationRejected,"Insufficient access rights to perform this operation.")}}async init(){await this.initWorkspaceAccessControl()}async dispose(){this.endCollaboration()}endCollaboration(){this.accessControlChangedEvent&&(this.accessControlChangedEvent.dispose(),this.accessControlChangedEvent=void 0),this.workspaceAccessControl=void 0}onWorkspaceAccessControlChanged(e){this.workspaceAccessControl=e.accessControl||{},this.workspaceAccessControl.defaultAccessControl=this.workspaceAccessControl.defaultAccessControl||{}}async initWorkspaceAccessControl(){try{this.workspaceAccessControl=await this.workspaceAccessControlService.getAccessControlAsync()||{},this.accessControlChangedEvent=this.workspaceAccessControlService.onAccessControlChanged(this.onWorkspaceAccessControlChanged,this)}catch(e){this.workspaceAccessControl={userAccessControl:{}}}}async ensureWorkspaceAccessControl(){this.workspaceAccessControl||await this.initWorkspaceAccessControl()}sendRejectedOperationTelemetry(e,t){new o.TelemetryEvent(a.TelemetryEventNames.REJECT_RESTRICTED_OPERATION).addProperty(a.TelemetryPropertyNames.OPERATION_NAME,e.name).addProperty(a.TelemetryPropertyNames.REJECTION_REASON,t).send()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(13),s=n(15),r=n(164),o=n(26);var a;!function(e){e[e.AuthTokenService=0]="AuthTokenService",e[e.AuthTokenServiceAudience=1]="AuthTokenServiceAudience"}(a||(a={}));t.TokenExchangeService=class{constructor(e){this.logger=e,this.devEnvRegExp=new RegExp(".*.dev.liveshare.vsengsaas.visualstudio.com"),this.endpointsByEnvironment={dev:{[a.AuthTokenService]:"https://sts.dev.core.vsengsaas.visualstudio.com/api/v1/tokens/exchange",[a.AuthTokenServiceAudience]:"https://ci.dev.liveshare.vsengsaas.visualstudio.com/"},ppe:{[a.AuthTokenService]:"https://sts-ppe.core.vsengsaas.visualstudio.com/api/v1/tokens/exchange",[a.AuthTokenServiceAudience]:"https://ppe.liveshare.vsengsaas.visualstudio.com/"},prod:{[a.AuthTokenService]:"https://sts.online.visualstudio.com/api/v1/tokens/exchange",[a.AuthTokenServiceAudience]:"https://insiders.liveshare.vsengsaas.visualstudio.com/"}};const t=i.Settings.get(s.SettingKeys.serviceUri);let n=void 0;t?n=this.getEnvironment(t):(e.info("Service Uri is not set. Default to production"),n="prod"),"unknown"===n&&(e.warning(`Can not determine environment for ${t} service Uri. Default to production`),n="prod"),this.currentEndpoints=this.endpointsByEnvironment[n]}async exchange(e,t){const n=(await r.default(this.currentEndpoints[a.AuthTokenService],{method:"POST",headers:{"Content-Type":"application/json-patch+json"},data:JSON.stringify({provider:`${e}`,token:`${t}`,audience:`${this.currentEndpoints[a.AuthTokenServiceAudience]}`,lifetime:"25"}),proxy:!1})).data;if(n.token)return n.token;switch(n.status){case 401:throw new Error(o.localize("error.AuthTokenConversionFailed"));default:throw new Error(o.localize("error.AuthTokenConversionFailedWithCode").replace("${code}",n.status))}}getEnvironment(e){const t=new URL(e.trim());if(this.devEnvRegExp.test(t.hostname))return"dev";switch(t.hostname){case"ppe.liveshare.vsengsaas.visualstudio.com":return"ppe";case"prod.liveshare.vsengsaas.visualstudio.com":return"prod";default:return"unknown"}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyExchangeAlgorithm=void 0;t.KeyExchangeAlgorithm=class{constructor(e,t,n,i){this.name=e,this.keySizeInBits=t,this.hashAlgorithmName=n,this.hashDigestLength=i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EncryptionAlgorithm=void 0;t.EncryptionAlgorithm=class{constructor(e){this.name=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HmacAlgorithm=void 0;t.HmacAlgorithm=class{constructor(e,t,n,i){this.name=e,this.algorithmName=t,this.keyLength=n,this.digestLength=i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebHmac=void 0;const i=n(3),s=n(249);class r extends s.HmacAlgorithm{constructor(e,t,n=!1){super(e,t,r.getHashKeyLength(t),r.getHashDigestLength(t)),this.encryptThenMac=n}async createSigner(e){const t=new o(this.algorithmName,!0,this.digestLength,this.encryptThenMac);return await t.init(e),t}async createVerifier(e){const t=new o(this.algorithmName,!1,this.digestLength,this.encryptThenMac);return await t.init(e),t}static getHashKeyLength(e){if("SHA2-512"===e)return 64;if("SHA2-384"===e)return 48;if("SHA2-256"===e)return 32;throw new Error(`Unsupported hash algorithm: ${e}`)}static getHashDigestLength(e){return this.getHashKeyLength(e)}static getWebHashAlgorithmName(e){if("SHA2-512"===e)return"SHA-512";if("SHA2-384"===e)return"SHA-384";if("SHA2-256"===e)return"SHA-256";throw new Error(`Unsupported hash algorithm: ${e}`)}}t.WebHmac=r;class o{constructor(e,t,n,i){this.algorithmName=e,this.isSigning=t,this.digestLength=n,this.encryptThenMac=i}async init(e){try{const t=this.algorithmName.replace("SHA2-","SHA-");this.key=await crypto.subtle.importKey("raw",e,{name:"HMAC",hash:{name:t}},!1,this.isSigning?["sign"]:["verify"])}catch(e){throw new Error("Failed to initialize HMAC: "+e)}}async sign(e){return i.Buffer.from(await crypto.subtle.sign({name:"HMAC",hash:{name:this.algorithmName}},this.key,e))}async verify(e,t){return await crypto.subtle.verify({name:"HMAC",hash:{name:this.algorithmName}},this.key,t,e)}dispose(){}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.JsonWebKeyFormatter=void 0;const i=n(51),s=n(172);class r{static formatRsa(e,t){const n=r.formatBigInt;let i;if(!1!==t&&e.d&&e.p&&e.q&&e.dp&&e.dq&&e.qi)i={kty:"RSA",n:n(e.modulus),e:n(e.exponent),d:n(e.d),p:n(e.p),q:n(e.q),dp:n(e.dp),dq:n(e.dq),qi:n(e.qi)};else{if(t)throw new Error("Missing private key parameters.");i={kty:"RSA",n:n(e.modulus),e:n(e.exponent)}}return i}static parseRsa(e,t){if("RSA"!==(null==e?void 0:e.kty)||!e.n||!e.e)throw new Error("Invalid RSA JWK.");const n=r.parseBigInt;let i;return i=!1!==t&&e.d&&e.p&&e.q&&e.dp&&e.dq&&e.qi?{modulus:n(e.n),exponent:n(e.e),d:n(e.d),p:n(e.p),q:n(e.q),dp:n(e.dp),dq:n(e.dq),qi:n(e.qi)}:{modulus:n(e.n),exponent:n(e.e)},i}static formatEC(e,t){const n=r.formatBigInt,i=s.curves.find(t=>t.oid===e.curve.oid||t.name===e.curve.name||t.shortName===e.curve.name),o=Math.ceil(i.keySize/8),a={kty:"EC",crv:e.curve.name,x:n(e.x,o),y:n(e.y,o)};if(!1!==t&&e.d)a.d=n(e.d,o);else if(t)throw new Error("Missing private key parameters.");return a}static parseEC(e,t){if("EC"!==(null==e?void 0:e.kty)||!(e.crv&&e.x&&e.y))throw new Error("Invalid EC JWK.");const n=r.parseBigInt,i={curve:{name:e.crv},x:n(e.x),y:n(e.y)};return!1!==t&&e.d&&(i.d=n(e.d)),i}static formatBigInt(e,t){return r.base64UrlEncode(e.toBytes({unsigned:!0,length:t}))}static parseBigInt(t){return i.BigInt.fromBytes(e.from(t,"base64"),{unsigned:!0})}static base64UrlEncode(e){return e.toString("base64").replace(/=+$/g,"").replace(/\+/g,"-").replace(/\//g,"_")}}t.JsonWebKeyFormatter=r}).call(this,n(3).Buffer)},function(e,t,n){(function(i){t.log=function(...e){return"object"==typeof console&&console.log&&console.log(...e)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let i=0,s=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(i++,"%c"===e&&(s=i))}),t.splice(s,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==i&&"env"in i&&(e=i.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n(1004)(t);const{formatters:s}=e.exports;s.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeHmac=void 0;const i=n(28),s=n(3),r=n(249);class o extends r.HmacAlgorithm{constructor(e,t,n=!1){super(e,t,o.getHashKeyLength(t),o.getHashDigestLength(t)),this.encryptThenMac=n}async createSigner(e){return new a(o.getNodeHashAlgorithmName(this.algorithmName),this.digestLength,this.encryptThenMac,e)}async createVerifier(e){return new a(o.getNodeHashAlgorithmName(this.algorithmName),this.digestLength,this.encryptThenMac,e)}static getHashKeyLength(e){if("SHA2-512"===e)return 64;if("SHA2-384"===e)return 48;if("SHA2-256"===e)return 32;throw new Error(`Unsupported hash algorithm: ${e}`)}static getHashDigestLength(e){return this.getHashKeyLength(e)}static getNodeHashAlgorithmName(e){if("SHA2-512"===e)return"sha512";if("SHA2-384"===e)return"sha384";if("SHA2-256"===e)return"sha256";throw new Error(`Unsupported hash algorithm: ${e}`)}}t.NodeHmac=o;class a{constructor(e,t,n,r){this.algorithmName=e,this.digestLength=t,this.encryptThenMac=n,this.key=i.createSecretKey?i.createSecretKey(r):s.Buffer.from(r)}async sign(e){const t=i.createHmac(this.algorithmName,this.key);return t.update(e),t.digest()}async verify(e,t){const n=i.createHmac(this.algorithmName,this.key);return n.update(e),n.digest().equals(t)}dispose(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DerWriter=t.DerReader=void 0;const i=n(3),s=n(51);class r{constructor(e,t=48){this.buffer=e,this.position=0,this.readType(t);const n=this.readLength();if(n>this.buffer.length-this.position)throw new Error("Read out of bounds.");this.buffer=this.buffer.slice(0,this.position+n)}get available(){return this.buffer.length-this.position}readNull(){if(this.readType(5),0!==this.readByte())throw new Error("Expected a 0 after Null type.")}readInteger(){this.readType(2);const e=this.readLength(),t=this.readBytes(e);return new s.BigInt(t)}readOctetString(){this.readType(4);const e=this.readLength();return this.readBytes(e)}readBitString(){this.readType(3);const e=this.readLength();if(0!==this.readByte())throw new Error("Padded bit strings are not supported.");return this.readBytes(e-1)}readObjectIdentifier(e){this.readType(6);const t=this.readLength(),n=this.position+t,i=[],s=this.readByte();i.push(Math.trunc(s/40)),i.push(s%40);let r=0;for(;this.position<n;){const e=this.readByte();0!=(128&e)?r=128*r+(127&e):(r=128*r+e,i.push(r),r=0)}if(0!==r)throw new Error("Invalid OID format.");const o=i.join(".");if(e&&o!==e)throw new Error(`Expected OID ${e}, found: ${o}`);return o}readSequence(){const e=this.position;this.readType(48);const t=this.readLength();return this.position+=t,new r(this.buffer.slice(e,this.position))}tryReadTagged(e){if(this.position>=this.buffer.length)return null;const t=this.buffer[this.position];if(0==(160&t)||(-161&t)!==e)return null;const n=this.position;this.position++;const i=this.readLength();return this.position+=i,new r(this.buffer.slice(n,this.position),t)}peek(){if(this.position>=this.buffer.length)throw new Error("Read out of bounds.");return this.buffer[this.position]}readLength(){let e=this.readByte();if(128===e)throw new Error("Indefinite-length encoding is not supported.");if(e>127){const t=127&e;if(t>4)throw new Error(`DER length size is ${t} and cannot be more than 4 bytes.`);e=0;for(let n=0;n<t;n++){e=(e<<8)+this.readByte()}if(e<0)throw new Error("Corrupted data - negative length found")}return e}readByte(){if(this.position>=this.buffer.length)throw new Error("Read out of bounds.");return this.buffer[this.position++]}readBytes(e){if(this.position+e>this.buffer.length)throw new Error("Read out of bounds.");const t=this.buffer.slice(this.position,this.position+e);return this.position+=e,t}readType(e){const t=this.readByte();if(t!==e)throw new Error(`Expected ${e} data type, found : ${t}`)}}t.DerReader=r;class o{constructor(e,t=48){this.buffer=e,this.dataType=t,this.position=0,this.buffer=e}toBuffer(){const e=this.position,t=o.getLength(e);this.ensureCapacity(1+t.length+e);const n=this.buffer.slice(0,1+t.length+e);return this.buffer.copy(n,1+t.length),n[0]=this.dataType,t.copy(n,1,0),this.buffer=this.buffer.slice(1+t.length,n.length),this.position=e,n}writeSequence(e){this.writeBytes(e.toBuffer())}writeTagged(e,t){if(e>15)throw new Error("Invalid DER tag.");this.writeByte(160|e);const n=o.getLength(t.position);this.writeBytes(n),this.writeBytes(t.buffer.slice(0,t.position))}writeNull(){this.writeByte(5),this.writeByte(0)}writeInteger(e){this.writeByte(2);const t=e.toBytes(),n=o.getLength(t.length);this.writeBytes(n),this.writeBytes(t)}writeOctetString(e){this.writeByte(4);const t=o.getLength(e.length);this.writeBytes(t),this.writeBytes(e)}writeBitString(e){this.writeByte(3);const t=o.getLength(1+e.length);this.writeBytes(t),this.writeByte(0),this.writeBytes(e)}writeObjectIdentifier(e){if(!e)throw new TypeError("OID value is null or empty.");const t=e.split(".").map(Number);if(t.length<2||t[0]>3||t[1]>=40)throw new Error(`Invalid OID: ${e}`);this.writeByte(6);let n=t.length-1;for(let e=2;e<t.length;e++){let i=t[e];for(;i>128;)n++,i/=128}const i=o.getLength(n);this.writeBytes(i),this.writeByte(40*t[0]+t[1]);for(let e=2;e<t.length;e++){let n=t[e];if(n>=128){let e=[];for(e.push(127&n);n>=128;)n/=128,e.push(128|127&n);for(;e.length>0;)this.writeByte(e.pop())}else this.writeByte(n)}}static getLength(e){if(e>127){let t=1;for(let n=e>>8;0!==n;n>>=8)t++;const n=o.lengthBuffer.slice(0,t+1);n[0]=128|t;for(let i=8*(t-1),s=1;i>=0;i-=8,s++)n[s]=e>>i;return n}{const t=o.lengthBuffer.slice(0,1);return t[0]=e,t}}writeByte(e){this.ensureCapacity(this.position+1),this.buffer[this.position++]=e}writeBytes(e){this.ensureCapacity(this.position+e.length),e.copy(this.buffer,this.position),this.position+=e.length}ensureCapacity(e){if(this.buffer.length<e){let t=Math.max(512,2*this.buffer.length);for(;t<e;)t*=2;const n=i.Buffer.alloc(t);this.buffer.copy(n,0,0,this.position),this.buffer=n}}}t.DerWriter=o,o.lengthBuffer=i.Buffer.alloc(10)},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SshChannel=void 0;const i=n(44),s=n(8),r=n(99),o=n(80),a=n(52),c=n(437),l=n(81),u=n(45),d=n(256),h=n(438),f=n(82),p=n(134);class m{constructor(e,t,n,i,r,o){this.connectionService=e,this.channelType=t,this.remoteChannelId=n,this.remoteWindowSize=i,this.remoteMaxPacketSize=r,this.channelId=o,this.remoteClosed=!1,this.localClosed=!1,this.sentEof=!1,this.disposed=!1,this.openSendingWindowCompletionSource=null,this.requestCompletionSource=null,this.sendSemaphore=new p.Semaphore(0),this.metrics=new c.ChannelMetrics,this.dataReceivedEmitter=new s.Emitter,this.onDataReceived=this.dataReceivedEmitter.event,this.eofEmitter=new s.Emitter,this.onEof=this.eofEmitter.event,this.closedEmitter=new s.Emitter,this.onClosed=this.closedEmitter.event,this.requestEmitter=new s.Emitter,this.onRequest=this.requestEmitter.event,this.windowSize=m.initialWindowSize,this.maxPacketSize=m.dataPacketSize}get session(){return this.connectionService.session}get isClosed(){return this.localClosed||this.remoteClosed}async request(e,t){if(!e)throw new TypeError("Request is required.");if(this.disposed)throw new u.ObjectDisposedError(this);if(e.recipientChannel=this.remoteChannelId,!e.wantReply)return await this.session.sendMessage(e,t),!0;if(null!=this.requestCompletionSource)throw new Error("Another request is already pending.");const n=new l.PromiseCompletionSource;if(this.requestCompletionSource=n,t){if(t.isCancellationRequested)throw new f.CancellationError;t.onCancellationRequested(()=>{n.reject(new f.CancellationError)})}return await this.session.sendMessage(e,t),await n.promise}async send(t,n){if(this.disposed)throw new u.ObjectDisposedError(this);if(0!==t.length){if(this.sentEof)throw new Error("Cannot send more data after EOF.");await this.sendSemaphore.wait(n);try{let s=0,r=t.length;for(;r>0;){let a=Math.min(Math.min(this.remoteWindowSize,this.remoteMaxPacketSize),r);for(;0===a;)this.openSendingWindowCompletionSource||(this.openSendingWindowCompletionSource=new l.PromiseCompletionSource),(0,i.trace)(`${this} send window is full. Waiting for window adjustment before sending.`),await(0,f.withCancellation)(this.openSendingWindowCompletionSource.promise,n),this.openSendingWindowCompletionSource=null,a=Math.min(Math.min(this.remoteWindowSize,this.remoteMaxPacketSize),r);const c=new o.ChannelDataMessage;c.recipientChannel=this.remoteChannelId,c.data=e.from(t.slice(s,s+a)),await this.session.sendMessage(c,n),this.remoteWindowSize-=a,r-=a,s+=a,this.metrics.addBytesSent(a)}}finally{this.sendSemaphore.tryRelease()}}else await this.sendEof()}enableSending(){this.sendSemaphore.tryRelease()}async sendEof(e){if(!this.sentEof){await this.sendSemaphore.wait(e);try{this.sentEof=!0;const t=new o.ChannelEofMessage;t.recipientChannel=this.remoteChannelId,await this.session.sendMessage(t,e)}finally{this.sendSemaphore.tryRelease()}}}async handleRequest(e,t){if(!e.requestType)throw new u.SshConnectionError("Channel request type not specified.",a.SshDisconnectReason.protocolError);if(e.requestType===o.ChannelRequestType.exitStatus){const t=new o.ChannelSignalMessage;return e.convertTo(t),this.exitStatus=t.exitStatus,!0}if(e.requestType===o.ChannelRequestType.exitSignal){const t=new o.ChannelSignalMessage;return e.convertTo(t),this.exitSignal=t.exitSignal,this.exitErrorMessage=t.errorMessage,!0}if(e.requestType===o.ChannelRequestType.signal){const t=new o.ChannelSignalMessage;e.convertTo(t)}const n=new d.SshRequestEventArgs(e.requestType,e,this.session.principal),i=(0,r.findService)(this.session.config.services,t=>(!t.channelType||t.channelType===this.channelType)&&t.channelRequest===e.requestType);await this.sendSemaphore.wait(t);try{if(i){const e=this.session.activateService(i);await e.onChannelRequest(this,n,t)}else this.requestEmitter.fire(n);if(e.wantReply){let e;if(n.isAuthorized){const t=new o.ChannelSuccessMessage;t.recipientChannel=this.remoteChannelId,e=t}else{const t=new o.ChannelFailureMessage;t.recipientChannel=this.remoteChannelId,e=t}await this.session.sendMessage(e,t)}}finally{this.sendSemaphore.tryRelease()}return n.isAuthorized||!1}handleResponse(e){this.requestCompletionSource&&(this.requestCompletionSource.resolve(e),this.requestCompletionSource=null)}handleDataReceived(e){this.metrics.addBytesReceived(e.length),this.dataReceivedEmitter.fire(e)}adjustWindow(e){if(!this.disposed&&(this.windowSize-=e,this.windowSize<=this.maxPacketSize)){const e=new o.ChannelWindowAdjustMessage;e.recipientChannel=this.remoteChannelId,e.bytesToAdd=m.initialWindowSize-this.windowSize,this.windowSize=m.initialWindowSize,this.session.sendMessage(e).catch(e=>{(0,i.trace)(`Error sending window adjust message: ${e.message||JSON.stringify(e)}`)})}}adjustRemoteWindow(e){this.remoteWindowSize+=e,this.openSendingWindowCompletionSource&&this.openSendingWindowCompletionSource.resolve(void 0)}handleEof(){(0,i.trace)(`${this} EOF received.`),this.eofEmitter.fire()}close(e,t,n){if(e instanceof Error){const t=e;return this.localClosed||(this.localClosed=!0,(0,i.trace)(`${this} Closed: ${t.message}`),this.closedEmitter.fire(new h.SshChannelClosedEventArgs(t))),void this.disposeInternal()}return"number"==typeof e?this.closeWithStatus(e,t):"string"==typeof e?this.closeWithSignal(e,t,n):this.closeDefault(e)}async closeDefault(e){var t;if(!this.remoteClosed&&!this.localClosed){this.remoteClosed=!0,await this.sendSemaphore.wait(e);try{const e=new o.ChannelCloseMessage;e.recipientChannel=this.remoteChannelId,await this.session.sendMessage(e)}catch(e){}finally{this.sendSemaphore.tryRelease()}}if(!this.localClosed){this.localClosed=!0;const e=this.raiseClosedEvent();null===(t=this.requestCompletionSource)||void 0===t||t.reject(new u.SshChannelError(e))}this.disposeInternal()}async closeWithStatus(e,t){if(!this.remoteClosed&&!this.localClosed){this.exitStatus=e;const t=new o.ChannelSignalMessage;t.recipientChannel=this.remoteChannelId,t.exitStatus=e,await this.session.sendMessage(t)}await this.closeDefault(t)}async closeWithSignal(e,t,n){if(!this.remoteClosed&&!this.localClosed){this.exitSignal=e,this.exitErrorMessage=t;const n=new o.ChannelSignalMessage;n.recipientChannel=this.remoteChannelId,n.exitSignal=e,n.errorMessage=t,await this.session.sendMessage(n)}await this.closeDefault(n)}handleClose(){var e;if(!this.localClosed){this.localClosed=!0;const t=this.raiseClosedEvent(!0);null===(e=this.requestCompletionSource)||void 0===e||e.reject(new u.SshChannelError(t))}this.disposeInternal()}raiseClosedEvent(e=!1){const t=` (S: ${this.metrics.bytesSent}, R: ${this.metrics.bytesReceived})`,n=e?"remotely":"locally";let s,r;return void 0!==this.exitStatus?(r=new h.SshChannelClosedEventArgs(this.exitStatus),s=`${this} closed ${n}: status=${this.exitStatus}`):void 0!==this.exitSignal?(r=new h.SshChannelClosedEventArgs(this.exitSignal,this.exitErrorMessage),s=`${this} closed ${n}: signal=${this.exitSignal} ${this.exitErrorMessage}`):(r=new h.SshChannelClosedEventArgs,s=`${this} closed ${n}.`),(0,i.trace)(s+t),this.closedEmitter.fire(r),s}dispose(){var e;if(!this.disposed&&!this.localClosed){if(!this.remoteClosed){this.remoteClosed=!0;const e=new o.ChannelCloseMessage;e.recipientChannel=this.remoteChannelId,this.session.sendMessage(e).catch(e=>{})}const t=this.session.isClosed?`${this.session} closed.`:`${this} disposed.`;(0,i.trace)(t);const n=new h.SshChannelClosedEventArgs("SIGABRT",t);this.localClosed=!0,this.closedEmitter.fire(n),null===(e=this.requestCompletionSource)||void 0===e||e.reject(new u.SshChannelError(t))}this.disposeInternal()}disposeInternal(){var e;this.disposed||(this.disposed=!0,null===(e=this.requestCompletionSource)||void 0===e||e.reject(new u.ObjectDisposedError(this)),this.connectionService._removeChannel(this),this.sendSemaphore.dispose())}toString(){return`SshChannel(Type: ${this.channelType}, Id: ${this.channelId}, RemoteId: ${this.remoteChannelId})`}}t.SshChannel=m,m.sessionChannelType="session",m.dataPacketSize=32768,m.initialWindowSize=32*m.dataPacketSize}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshRequestEventArgs=void 0;t.SshRequestEventArgs=class{constructor(e,t,n){this.requestType=e,this.request=t,this.principal=n}toString(){return`RequestType: ${this.requestType}`+this.request?` Request: ${this.request}`:""}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NewKeysMessage=t.KeyExchangeDhReplyMessage=t.KeyExchangeDhInitMessage=t.KeyExchangeInitMessage=t.KeyExchangeMessage=void 0;const i=n(3),s=n(100),r=n(98);class o extends s.SshMessage{}t.KeyExchangeMessage=o;class a extends o{get messageType(){return 20}onRead(e){this.cookie=e.read(16),this.keyExchangeAlgorithms=e.readList("ascii"),this.serverHostKeyAlgorithms=e.readList("ascii"),this.encryptionAlgorithmsClientToServer=e.readList("ascii"),this.encryptionAlgorithmsServerToClient=e.readList("ascii"),this.macAlgorithmsClientToServer=e.readList("ascii"),this.macAlgorithmsServerToClient=e.readList("ascii"),this.compressionAlgorithmsClientToServer=e.readList("ascii"),this.compressionAlgorithmsServerToClient=e.readList("ascii"),this.languagesClientToServer=e.readList("ascii"),this.languagesServerToClient=e.readList("ascii"),this.firstKexPacketFollows=e.readBoolean(),this.reserved=e.readUInt32()}onWrite(e){this.cookie||(this.cookie=i.Buffer.alloc(16),r.SshAlgorithms.random.getBytes(this.cookie)),e.write(this.cookie),e.writeList(this.keyExchangeAlgorithms||[],"ascii"),e.writeList(this.serverHostKeyAlgorithms||[],"ascii"),e.writeList(this.encryptionAlgorithmsClientToServer||[],"ascii"),e.writeList(this.encryptionAlgorithmsServerToClient||[],"ascii"),e.writeList(this.macAlgorithmsClientToServer||[],"ascii"),e.writeList(this.macAlgorithmsServerToClient||[],"ascii"),e.writeList(this.compressionAlgorithmsClientToServer||[],"ascii"),e.writeList(this.compressionAlgorithmsServerToClient||[],"ascii"),e.writeList(this.languagesClientToServer||[],"ascii"),e.writeList(this.languagesServerToClient||[],"ascii"),e.writeBoolean(this.validateField(this.firstKexPacketFollows,"first KEX package follows")),e.writeUInt32(this.reserved||0)}}t.KeyExchangeInitMessage=a;class c extends o{get messageType(){return 30}onRead(e){this.e=e.readBinary()}onWrite(e){e.writeBinary(this.validateField(this.e,"E"))}}t.KeyExchangeDhInitMessage=c;class l extends o{get messageType(){return 31}onRead(e){this.hostKey=e.readBinary(),this.f=e.readBinary(),this.signature=e.readBinary()}onWrite(e){e.writeBinary(this.validateField(this.hostKey,"host key")),e.writeBinary(this.validateField(this.f,"F")),e.writeBinary(this.validateField(this.signature,"signature"))}}t.KeyExchangeDhReplyMessage=l;class u extends o{get messageType(){return 21}onRead(e){}onWrite(e){}}t.NewKeysMessage=u,s.SshMessage.index.set(20,a),s.SshMessage.index.set(30,c),s.SshMessage.index.set(31,l),s.SshMessage.index.set(21,u)},function(e,t,n){"use strict";(function(e){var i,s=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationService=void 0;const r=n(44),o=n(174),a=n(441),c=n(8),l=n(36),u=n(52),d=n(259),h=n(135),f=n(99),p=n(173);let m=i=class extends o.SshService{constructor(e){var t;super(e),this.authenticationFailureCount=0,this.disposeCancellationSource=new c.CancellationTokenSource;const n=null===(t=e.algorithms)||void 0===t?void 0:t.publicKeyAlgorithmName;if(!n)throw new Error("Algorithms not initialized.");this.publicKeyAlgorithmName=n}handleMessage(e,t){if(e instanceof a.AuthenticationSuccessMessage)return this.handleSuccessMessage(e);if(e instanceof a.AuthenticationFailureMessage)return this.handleFailureMessage(e);if(e instanceof a.AuthenticationRequestMessage)return this.handleAuthenticationRequestMessage(e,t);throw new Error(`Message not implemented: ${e}`)}async handleAuthenticationRequestMessage(e,t){if((0,r.trace)(`Authentication request: ${e.methodName}`),"publickey"===e.methodName||"hostbased"===e.methodName)return this.handlePublicKeyRequestMessage(e.convertTo(new a.PublicKeyRequestMessage),t);if("password"===e.methodName)return this.handlePasswordRequestMessage(e.convertTo(new a.PasswordRequestMessage),t);if("none"===e.methodName)return this.handleAuthenticating(e,new d.SshAuthenticatingEventArgs(d.SshAuthenticationType.clientNone,{username:e.username},t));{const e=new a.AuthenticationFailureMessage;e.methodNames=["publickey","password","hostbased"],await this.session.sendMessage(e,t)}}async handlePublicKeyRequestMessage(t,n){var i,s,r;const o=this.session.config.getPublicKeyAlgorithm(t.keyAlgorithmName);if(!o){const e=new a.AuthenticationFailureMessage;return e.methodNames=["publickey","password"],void await this.session.sendMessage(e,n)}const c=o.createKeyPair();let u;if(await c.setPublicKeyBytes(t.publicKey),"hostbased"===t.methodName)u=new d.SshAuthenticatingEventArgs(d.SshAuthenticationType.clientHostBased,{username:null!==(i=t.username)&&void 0!==i?i:"",publicKey:c,clientHostname:t.clientHostname,clientUsername:t.clientUsername});else if(t.hasSignature){const i=o.readSignatureData(t.signature),s=this.session.sessionId;if(null==s)throw new Error("Session ID not initialized.");const a=new l.SshDataWriter(e.alloc(s.length+t.payloadWithoutSignature.length+20));a.writeBinary(s),a.write(t.payloadWithoutSignature);const h=a.toBuffer(),f=o.createVerifier(c);await f.verify(h,i)||await this.handleAuthenticationFailure("Public key authentication failed: invalid signature.",n),u=new d.SshAuthenticatingEventArgs(d.SshAuthenticationType.clientPublicKey,{username:null!==(r=t.username)&&void 0!==r?r:"",publicKey:c})}else u=new d.SshAuthenticatingEventArgs(d.SshAuthenticationType.clientPublicKeyQuery,{username:null!==(s=t.username)&&void 0!==s?s:"",publicKey:c});await this.handleAuthenticating(t,u,n)}async handlePasswordRequestMessage(e,t){var n,i;const s=new d.SshAuthenticatingEventArgs(d.SshAuthenticationType.clientPassword,{username:null!==(n=e.username)&&void 0!==n?n:"",password:null!==(i=e.password)&&void 0!==i?i:""});await this.handleAuthenticating(e,s,t)}async handleAuthenticating(e,t,n){var i;let s=null;try{s=await this.session.raiseAuthenticatingEvent(t)}catch(e){if(!(e instanceof Error))throw e;(0,r.trace)("Error while authenticating client: "+(null!==(i=e.message)&&void 0!==i?i:e)),s=null}if(s)if(t.authenticationType===d.SshAuthenticationType.clientPublicKeyQuery){const t=e,i=new a.PublicKeyOKMessage;i.keyAlgorithmName=t.keyAlgorithmName,i.publicKey=t.publicKey,await this.session.sendMessage(i,n)}else this.session.principal=s,e.serviceName&&this.session.activateService(e.serviceName),(0,r.trace)(`${d.SshAuthenticationType[t.authenticationType]} authentication succeeded.`),await this.session.sendMessage(new a.AuthenticationSuccessMessage,n);else await this.handleAuthenticationFailure(`${d.SshAuthenticationType[t.authenticationType]} authentication failed.`)}async handleAuthenticationFailure(e,t){this.authenticationFailureCount++,(0,r.trace)(e);const n=new a.AuthenticationFailureMessage;n.methodNames=["publickey","password","hostbased"],await this.session.sendMessage(n,t),this.authenticationFailureCount>=this.session.config.maxClientAuthenticationAttempts&&await this.session.close(u.SshDisconnectReason.noMoreAuthMethodsAvailable,"Authentication failed.")}async authenticateClient(e,t){var n,i,s,r;this.clientAuthenticationMethods=new p.Queue;for(let t of null!==(n=e.publicKeys)&&void 0!==n?n:[]){if(!t)continue;const n=null!==(i=e.username)&&void 0!==i?i:"";let s=t;const r=e.privateKeyProvider;this.clientAuthenticationMethods.enqueue(async e=>{if(!s.hasPrivateKey){if(null==r)throw new Error("A private key provider is required.");s=await r(t,null!=e?e:c.CancellationToken.None)}s?await this.requestPublicKeyAuthentication(n,s,e):await this.session.close(u.SshDisconnectReason.authCancelledByUser)})}const o=e.passwordProvider;if(o)this.clientAuthenticationMethods.enqueue(async e=>{var t;const n=o(null!=e?e:c.CancellationToken.None),i=n?await n:null;i?await this.requestPasswordAuthentication(null!==(t=i[0])&&void 0!==t?t:"",i[1],e):await this.session.close(u.SshDisconnectReason.authCancelledByUser)});else if(e.password){const t=null!==(s=e.username)&&void 0!==s?s:"",n=e.password;this.clientAuthenticationMethods.enqueue(async e=>{await this.requestPasswordAuthentication(t,n,e)})}if(0===this.clientAuthenticationMethods.size){const t=null!==(r=e.username)&&void 0!==r?r:"";this.clientAuthenticationMethods.enqueue(async e=>{await this.requestUsernameAuthentication(t,e)})}const a=this.clientAuthenticationMethods.dequeue();await a(t)}async requestUsernameAuthentication(e,t){const n=new a.AuthenticationRequestMessage;n.serviceName=h.ConnectionService.serviceName,n.methodName="none",n.username=e,await this.session.sendMessage(n,t),this.session.activateService(h.ConnectionService)}async requestPublicKeyAuthentication(e,t,n){const i=this.session.config.publicKeyAlgorithms.find(e=>(null==e?void 0:e.keyAlgorithmName)===t.keyAlgorithmName);if(!i)throw new Error(`Public key algorithm '${t.keyAlgorithmName}' is not in session config.`);const s=new a.PublicKeyRequestMessage;s.serviceName=h.ConnectionService.serviceName,s.username=e,s.keyAlgorithmName=i.name,s.publicKey=await t.getPublicKeyBytes(i.name),s.signature=await this.createAuthenticationSignature(s,i,t),await this.session.sendMessage(s,n),0===this.clientAuthenticationMethods.size&&this.session.activateService(h.ConnectionService)}async requestPasswordAuthentication(e,t,n){const i=new a.PasswordRequestMessage;i.serviceName=h.ConnectionService.serviceName,i.username=e,i.password=t,await this.session.sendMessage(i,n),this.session.activateService(h.ConnectionService)}handleFailureMessage(e){this.session.onAuthenticationComplete(!1)}handleSuccessMessage(e){this.session.activateService(h.ConnectionService),this.session.onAuthenticationComplete(!0)}async createAuthenticationSignature(t,n,i){const s=this.session.sessionId;if(null==s)throw new Error("Session ID not initialized.");const r=new l.SshDataWriter(e.alloc(t.publicKey.length+(t.username||"").length+400));r.writeBinary(s),r.writeByte(t.messageType),r.writeString(t.username||"","utf8"),r.writeString(t.serviceName||"","ascii"),r.writeString("publickey","ascii"),r.writeBoolean(!0),r.writeString(t.keyAlgorithmName,"ascii"),r.writeBinary(t.publicKey);const o=n.createSigner(i),a=await o.sign(r.toBuffer());return n.createSignatureData(a)}};m.serviceName="ssh-userauth",m=i=s([(0,f.serviceActivation)({serviceRequest:i.serviceName})],m),t.AuthenticationService=m}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshAuthenticatingEventArgs=t.SshAuthenticationType=void 0;const i=n(8);var s;!function(e){e[e.clientNone=0]="clientNone",e[e.clientHostBased=1]="clientHostBased",e[e.clientPassword=2]="clientPassword",e[e.clientPublicKeyQuery=3]="clientPublicKeyQuery",e[e.clientPublicKey=4]="clientPublicKey",e[e.serverPublicKey=10]="serverPublicKey"}(s=t.SshAuthenticationType||(t.SshAuthenticationType={}));t.SshAuthenticatingEventArgs=class{constructor(e,{username:t,password:n,publicKey:r,clientHostname:o,clientUsername:a},c){this.authenticationType=e;const l=({usernameRequired:e,passwordRequired:i,publicKeyRequired:s,clientHostnameRequired:c,clientUsernameRequired:l})=>"string"==typeof t==!!e&&("string"==typeof n==!!i&&(!!r==!!s&&("string"==typeof o==!!c&&"string"==typeof a==!!l)));let u;switch(e){case s.clientNone:u=l({usernameRequired:!0});break;case s.clientHostBased:u=l({usernameRequired:!0,publicKeyRequired:!0,clientHostnameRequired:!0,clientUsernameRequired:!0});break;case s.clientPassword:u=l({usernameRequired:!0,passwordRequired:!0});break;case s.clientPublicKeyQuery:case s.clientPublicKey:u=l({usernameRequired:!0,publicKeyRequired:!0});break;case s.serverPublicKey:u=l({publicKeyRequired:!0});break;default:throw new Error(`Invalid authentication type: ${e}`)}if(!u)throw new Error(`Invalid arguments for authentication type: ${e}`);this.username=null!=t?t:null,this.password=null!=n?n:null,this.publicKey=null!=r?r:null,this.clientHostname=null!=o?o:null,this.clientUsername=null!=a?a:null,this.cancellationValue=null!=c?c:i.CancellationToken.None}get cancellation(){return this.cancellationValue}set cancellation(e){this.cancellationValue=e}toString(){return this.password?`${this.username?'"'+this.username+'" ':""}[password]`:this.publicKey?`${this.username?'"'+this.username+'" ':""}[${this.publicKey.keyAlgorithmName}]`:`"${this.username}"`}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(70),r=n(15),o=n(13),a=n(62);t.getLabelAndLinkTreeViewItems=async function(e){const t=o.Settings.get(r.SettingKeys.remoteLabelAndLinks)||[],n=[];return(o.Settings.isInsidersFeatureSet||o.Settings.isInternalFeatureSet)&&o.Settings.get(r.SettingKeys.sessionCount)>=5&&t.filter(t=>t.location===e).forEach(e=>{n.push(new s.TreeViewItem({type:a.ViewItem.Other,collapsibleState:i.TreeItemCollapsibleState.None,label:e.label,command:{title:e.label,command:"liveshare.openLink",arguments:[e.link]}}))}),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(61),s=n(6),r=n(8),o=n(33),a=n(23);t.sessionStateTransitionsCommandDecorator=function(e,t,n,s){return o.DecoratorHelper.setupDecorator(r=>new c(o.DecoratorHelper.getCoreCommand(r),r,i.dependencies.sessionContext(),s,e,t,n))};class c{constructor(e,t,n,i,s,r,o){this.command=e,this.next=t,this.sessionContext=n,this.validateSessionAction=i,this.statusStart=s,this.statusComplete=r,this.statusCompleteError=o}async invoke(e,t){let n=void 0;c.count++;try{void 0!==this.statusStart&&this.shouldPerformSessionAction(e)&&a.sessionStateTracker.transition(this.statusStart),n=await this.next.invoke(e,t),void 0!==this.statusComplete&&this.shouldPerformSessionAction(e)&&a.sessionStateTracker.transition(this.statusComplete)}catch(t){const n=t instanceof s.CancellationError||t.code===r.ErrorCodes.RequestCancelled;if(1!==c.count&&n)return;throw this.shouldPerformSessionAction(e)&&a.sessionStateTracker.transition(this.statusCompleteError),t}finally{c.count--}return n}shouldPerformSessionAction(e){return!this.validateSessionAction||this.validateSessionAction(e)}}t.SessionStateTransitionsCommandDecorator=c,c.count=0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(33);t.validationCommandDecorator=function(){return i.DecoratorHelper.setupDecorator(e=>new s(i.DecoratorHelper.getCoreCommand(e),e))};class s{constructor(e,t){this.command=e,this.next=t}async invoke(e,t){let n=void 0,i=this.command;return i.validate&&await i.validate(e,t),n=await this.next.invoke(e,t),n}}t.ValidationCommandDecorator=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(7),s=n(452);class r extends i.CommandBase{constructor(){super(...arguments),this.postSetupManagers=[]}async invoke(e,t){return!0}invokePostSetupManagers(e,t){return s.initDisposableManager(null!=e?e:this.postSetupManagers,t)}}t.LiveShareCommandBase=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.ProviderAdded="ProviderAdded",e.ContactsChanged="ContactsChanged",e.InviteLinkReceived="MessageReceived",e.SuggestedUsersUpdate="SuggestedUsersUpdate",e.RecentContactsUpdate="RecentContactsUpdate",e.InviteContactsUpdate="InviteContactsUpdate",e.Ready="Ready",e.ProviderCapabilitiesChanged="ProviderCapabilitiesChanged",e.SignedStateChanged="SignedStateChanged"}(t.ContactManagerEvents||(t.ContactManagerEvents={})),function(e){e.Initialized="Initialized",e.SelfContactChanged="UsersPresenceChanged",e.AvailableUsersChanged="AvailableUsersChanged",e.ContactsChanged="ContactsChanged",e.InviteLinkReceived="InviteLinkReceived",e.MessageReceived="MessageReceived",e.ContactsChangedNotification="ContactsChangedNotification",e.ContactPropertyChangedNotification="ContactPropertyChangedNotification",e.SuggestedUsersUpdate="SuggestedUsersUpdate",e.CapabilitiesChanged="CapabilitiesChanged",e.SignedStateChanged="SignedStateChanged",e.AuthenticationRequired="AuthenticationRequired"}(t.ContactServiceEvents||(t.ContactServiceEvents={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(63);class s extends i.ConnectionError{constructor(){super(...arguments),this.errorType="ConnectionCancellationError"}}t.ConnectionCancellationError=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(63);class s extends i.ConnectionError{constructor(){super(...arguments),this.errorType="ConnectionTimeoutError"}}t.ConnectionTimeoutError=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6),s=n(5),r=n(83),o=n(179),a=n(459),c=n(63),l=n(138),u=n(268),d=n(139);class h extends l.Connection{constructor(e,t,n){super(e.createChild("liveshare"),t),this.performance=t,this.options=n}getId(e){const{workspaceId:t}=e;return t}get type(){return a.TConnectionTypes.MainThread}get workspaceClient(){return i.assertDefined(this.workspaceClientReference,"No `WorkspaceClient` found."),this.workspaceClientReference}getRpcService(e){return this.workspaceClient.getServiceProxy(e)}dispose(e){return super.dispose(e),this.workspaceClientReference=void 0,this.workspaceSessionInfoReference=void 0,this}get workspaceSessionInfo(){return this.workspaceSessionInfoReference}async createWorkspaceClient(){return new o.WorkspaceClient(this.trace.createChild("WorkspaceClient"),void 0,{enabled:!0,retryTimeout:.25*i.TIME_SECOND_MS,maxTimeReconnect:10*i.TIME_SECOND_MS})}setWorkspaceSessionInfo(e){this.workspaceSessionInfoReference=e}async createConnection(){try{this.initializeConnection(),this.trace.info("creating workspace client",this.options);const e=await this.createWorkspaceClient();this.addToDisposables({dispose:()=>{e.dispose("Disposed from LiveShareConnection")}});const t=await this.performance.measure({id:u.PerformanceEventIds.LiveshareJoinWorkspace,name:"join LiveShare session"},async()=>await e.join(Object.assign(Object.assign({},this.options),{performance:this.performance.createGroup(`${this.trace.name}:${this.options.workspaceId}`),checkConnectionOptions:{enabled:!0}})));return this.workspaceClientReference=e,this.setWorkspaceSessionInfo(t),this.trace.info("LS session joined and authenticated"),await this.performance.measure({name:"create workspace service"},async()=>{const t=e.getServiceProxy(s.vsls.WorkspaceService);i.assertDefined(t,"WorkspaceService not set."),await e.rpcClient.onClose(()=>{this.onConnectionChangedHandler("disconnected",new c.ConnectionError("RPC client closed."))}),this.addToDisposables(t.onConnectionStatusChanged(e=>{e.connectionStatus===s.vsls.WorkspaceConnectionStatus.Disconnected&&this.onConnectionChangedHandler("disconnected",new c.ConnectionError(`Workspace service disconnected with status: "${e.disconnectedReason}".`))}))}),this.onConnectionChangedHandler("connected"),e.onHostConnectionChanged(e=>{this.trace.info(`host connection changed to "${r.ConnectedState[e.state]}"`),e.state===r.ConnectedState.Reconnecting?this.initializeConnection():e.state===r.ConnectedState.Reconnected?this.onConnectionChangedHandler("connected"):e.state===r.ConnectedState.Closed&&this.onConnectionChangedHandler("disconnected")}),this}catch(e){throw this.handleConnectionError(e),d.errorToConnectionError(e)}}}t.LiveShareConnection=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.LiveshareJoinWorkspace="LiveshareJoinWorkspace",e.VSCodeServerStartupServerStart="VSCodeServerStartupServerStart",e.VSCodeServerStartupServerTcpPortForwarding="VSCodeServerStartupServerTCPPortForwarding"}(t.PerformanceEventIds||(t.PerformanceEventIds={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VSCODE_SERVER_PORT_NAME="VSCodeServerInternal"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6),s=n(6),r=n(138),o=n(63);class a extends r.Connection{constructor(){super(...arguments),this.onConnectionChangedEventEmitterMock=this.onConnectionChangedEventEmitter}getId(e){const{id:t,someProp:n,numericProp:i}=e;return`${t}_${n}_${i}`}onConnectionChangedHandlerMock(e,t){return this.onConnectionChangedHandler(e,t)}get connectionSignalMock(){return this.connectionSignal}finish(e){return i.assertDefined(this.connectionSignal,"No `Connection Signal` found."),e?(this.connectionSignal.reject(e),this):(this.connectionSignal.resolve(this),this)}finishWithDelay(e,t=0){return t?(s.defer(()=>{this.finish(e)},t),this):this.finish(e)}async createConnection(){return this.initializeConnection(),i.assertDefined(this.connectionSignal,new o.ConnectionError("No `connectionSignal` found.")),await this.connectionSignal.promise,this.onConnectionChangedHandler("connected"),this}initializeConnectionMock(){return this.initializeConnection()}get performanceMock(){return this.performance}}t.ConnectionMock=a},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var s=n(464);t.Performance=s.Performance,t.initializePerformanceInstance=s.initializePerformanceInstance,t.getOrCreatePerformance=s.getOrCreatePerformance;var r=n(1091);t.logPerformanceWaterfall=r.logPerformanceWaterfall,t.mocks=i(n(1095))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Information=2]="Information",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.None=6]="None"}(t.LogLevel||(t.LogLevel={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1104);t.HubStream=i.HubStream;var s=n(1122);t.createSshRpcMessageStream=s.createSshRpcMessageStream},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyExchangeAlgorithm=void 0;t.KeyExchangeAlgorithm=class{constructor(e,t,n,i){this.name=e,this.keySizeInBits=t,this.hashAlgorithmName=n,this.hashDigestLength=i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EncryptionAlgorithm=void 0;t.EncryptionAlgorithm=class{constructor(e){this.name=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HmacAlgorithm=void 0;t.HmacAlgorithm=class{constructor(e,t,n,i){this.name=e,this.algorithmName=t,this.keyLength=n,this.digestLength=i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebHmac=void 0;const i=n(3),s=n(276);class r extends s.HmacAlgorithm{constructor(e,t,n=!1){super(e,t,r.getHashKeyLength(t),r.getHashDigestLength(t)),this.encryptThenMac=n}async createSigner(e){const t=new o(this.algorithmName,!0,this.digestLength,this.encryptThenMac);return await t.init(e),t}async createVerifier(e){const t=new o(this.algorithmName,!1,this.digestLength,this.encryptThenMac);return await t.init(e),t}static getHashKeyLength(e){if("SHA2-512"===e)return 64;if("SHA2-384"===e)return 48;if("SHA2-256"===e)return 32;throw new Error(`Unsupported hash algorithm: ${e}`)}static getHashDigestLength(e){return this.getHashKeyLength(e)}static getWebHashAlgorithmName(e){if("SHA2-512"===e)return"SHA-512";if("SHA2-384"===e)return"SHA-384";if("SHA2-256"===e)return"SHA-256";throw new Error(`Unsupported hash algorithm: ${e}`)}}t.WebHmac=r;class o{constructor(e,t,n,i){this.algorithmName=e,this.isSigning=t,this.digestLength=n,this.encryptThenMac=i}async init(e){try{const t=this.algorithmName.replace("SHA2-","SHA-");this.key=await crypto.subtle.importKey("raw",e,{name:"HMAC",hash:{name:t}},!1,this.isSigning?["sign"]:["verify"])}catch(e){throw new Error("Failed to initialize HMAC: "+e)}}async sign(e){return i.Buffer.from(await crypto.subtle.sign({name:"HMAC",hash:{name:this.algorithmName}},this.key,e))}async verify(e,t){return await crypto.subtle.verify({name:"HMAC",hash:{name:this.algorithmName}},this.key,t,e)}dispose(){}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.JsonWebKeyFormatter=void 0;const i=n(53),s=n(181);class r{static formatRsa(e,t){const n=r.formatBigInt;let i;if(!1!==t&&e.d&&e.p&&e.q&&e.dp&&e.dq&&e.qi)i={kty:"RSA",n:n(e.modulus),e:n(e.exponent),d:n(e.d),p:n(e.p),q:n(e.q),dp:n(e.dp),dq:n(e.dq),qi:n(e.qi)};else{if(t)throw new Error("Missing private key parameters.");i={kty:"RSA",n:n(e.modulus),e:n(e.exponent)}}return i}static parseRsa(e,t){if("RSA"!==(null==e?void 0:e.kty)||!e.n||!e.e)throw new Error("Invalid RSA JWK.");const n=r.parseBigInt;let i;return i=!1!==t&&e.d&&e.p&&e.q&&e.dp&&e.dq&&e.qi?{modulus:n(e.n),exponent:n(e.e),d:n(e.d),p:n(e.p),q:n(e.q),dp:n(e.dp),dq:n(e.dq),qi:n(e.qi)}:{modulus:n(e.n),exponent:n(e.e)},i}static formatEC(e,t){const n=r.formatBigInt,i=s.curves.find(t=>t.oid===e.curve.oid||t.name===e.curve.name||t.shortName===e.curve.name),o=Math.ceil(i.keySize/8),a={kty:"EC",crv:e.curve.name,x:n(e.x,o),y:n(e.y,o)};if(!1!==t&&e.d)a.d=n(e.d,o);else if(t)throw new Error("Missing private key parameters.");return a}static parseEC(e,t){if("EC"!==(null==e?void 0:e.kty)||!(e.crv&&e.x&&e.y))throw new Error("Invalid EC JWK.");const n=r.parseBigInt,i={curve:{name:e.crv},x:n(e.x),y:n(e.y)};return!1!==t&&e.d&&(i.d=n(e.d)),i}static formatBigInt(e,t){return r.base64UrlEncode(e.toBytes({unsigned:!0,length:t}))}static parseBigInt(t){return i.BigInt.fromBytes(e.from(t,"base64"),{unsigned:!0})}static base64UrlEncode(e){return e.toString("base64").replace(/=+$/g,"").replace(/\+/g,"-").replace(/\//g,"_")}}t.JsonWebKeyFormatter=r}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeHmac=void 0;const i=n(28),s=n(3),r=n(276);class o extends r.HmacAlgorithm{constructor(e,t,n=!1){super(e,t,o.getHashKeyLength(t),o.getHashDigestLength(t)),this.encryptThenMac=n}async createSigner(e){return new a(o.getNodeHashAlgorithmName(this.algorithmName),this.digestLength,this.encryptThenMac,e)}async createVerifier(e){return new a(o.getNodeHashAlgorithmName(this.algorithmName),this.digestLength,this.encryptThenMac,e)}static getHashKeyLength(e){if("SHA2-512"===e)return 64;if("SHA2-384"===e)return 48;if("SHA2-256"===e)return 32;throw new Error(`Unsupported hash algorithm: ${e}`)}static getHashDigestLength(e){return this.getHashKeyLength(e)}static getNodeHashAlgorithmName(e){if("SHA2-512"===e)return"sha512";if("SHA2-384"===e)return"sha384";if("SHA2-256"===e)return"sha256";throw new Error(`Unsupported hash algorithm: ${e}`)}}t.NodeHmac=o;class a{constructor(e,t,n,r){this.algorithmName=e,this.digestLength=t,this.encryptThenMac=n,this.key=i.createSecretKey?i.createSecretKey(r):s.Buffer.from(r)}async sign(e){const t=i.createHmac(this.algorithmName,this.key);return t.update(e),t.digest()}async verify(e,t){const n=i.createHmac(this.algorithmName,this.key);return n.update(e),n.digest().equals(t)}dispose(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DerWriter=t.DerReader=void 0;const i=n(3),s=n(53);class r{constructor(e,t=48){this.buffer=e,this.position=0,this.readType(t);const n=this.readLength();if(n>this.buffer.length-this.position)throw new Error("Read out of bounds.");this.buffer=this.buffer.slice(0,this.position+n)}get available(){return this.buffer.length-this.position}readNull(){if(this.readType(5),0!==this.readByte())throw new Error("Expected a 0 after Null type.")}readInteger(){this.readType(2);const e=this.readLength(),t=this.readBytes(e);return new s.BigInt(t)}readOctetString(){this.readType(4);const e=this.readLength();return this.readBytes(e)}readBitString(){this.readType(3);const e=this.readLength();if(0!==this.readByte())throw new Error("Padded bit strings are not supported.");return this.readBytes(e-1)}readObjectIdentifier(e){this.readType(6);const t=this.readLength(),n=this.position+t,i=[],s=this.readByte();i.push(Math.trunc(s/40)),i.push(s%40);let r=0;for(;this.position<n;){const e=this.readByte();0!=(128&e)?r=128*r+(127&e):(r=128*r+e,i.push(r),r=0)}if(0!==r)throw new Error("Invalid OID format.");const o=i.join(".");if(e&&o!==e)throw new Error(`Expected OID ${e}, found: ${o}`);return o}readSequence(){const e=this.position;this.readType(48);const t=this.readLength();return this.position+=t,new r(this.buffer.slice(e,this.position))}tryReadTagged(e){if(this.position>=this.buffer.length)return null;const t=this.buffer[this.position];if(0==(160&t)||(-161&t)!==e)return null;const n=this.position;this.position++;const i=this.readLength();return this.position+=i,new r(this.buffer.slice(n,this.position),t)}peek(){if(this.position>=this.buffer.length)throw new Error("Read out of bounds.");return this.buffer[this.position]}readLength(){let e=this.readByte();if(128===e)throw new Error("Indefinite-length encoding is not supported.");if(e>127){const t=127&e;if(t>4)throw new Error(`DER length size is ${t} and cannot be more than 4 bytes.`);e=0;for(let n=0;n<t;n++){e=(e<<8)+this.readByte()}if(e<0)throw new Error("Corrupted data - negative length found")}return e}readByte(){if(this.position>=this.buffer.length)throw new Error("Read out of bounds.");return this.buffer[this.position++]}readBytes(e){if(this.position+e>this.buffer.length)throw new Error("Read out of bounds.");const t=this.buffer.slice(this.position,this.position+e);return this.position+=e,t}readType(e){const t=this.readByte();if(t!==e)throw new Error(`Expected ${e} data type, found : ${t}`)}}t.DerReader=r;class o{constructor(e,t=48){this.buffer=e,this.dataType=t,this.position=0,this.buffer=e}toBuffer(){const e=this.position,t=o.getLength(e);this.ensureCapacity(1+t.length+e);const n=this.buffer.slice(0,1+t.length+e);return this.buffer.copy(n,1+t.length),n[0]=this.dataType,t.copy(n,1,0),this.buffer=this.buffer.slice(1+t.length,n.length),this.position=e,n}writeSequence(e){this.writeBytes(e.toBuffer())}writeTagged(e,t){if(e>15)throw new Error("Invalid DER tag.");this.writeByte(160|e);const n=o.getLength(t.position);this.writeBytes(n),this.writeBytes(t.buffer.slice(0,t.position))}writeNull(){this.writeByte(5),this.writeByte(0)}writeInteger(e){this.writeByte(2);const t=e.toBytes(),n=o.getLength(t.length);this.writeBytes(n),this.writeBytes(t)}writeOctetString(e){this.writeByte(4);const t=o.getLength(e.length);this.writeBytes(t),this.writeBytes(e)}writeBitString(e){this.writeByte(3);const t=o.getLength(1+e.length);this.writeBytes(t),this.writeByte(0),this.writeBytes(e)}writeObjectIdentifier(e){if(!e)throw new TypeError("OID value is null or empty.");const t=e.split(".").map(Number);if(t.length<2||t[0]>3||t[1]>=40)throw new Error(`Invalid OID: ${e}`);this.writeByte(6);let n=t.length-1;for(let e=2;e<t.length;e++){let i=t[e];for(;i>128;)n++,i/=128}const i=o.getLength(n);this.writeBytes(i),this.writeByte(40*t[0]+t[1]);for(let e=2;e<t.length;e++){let n=t[e];if(n>=128){let e=[];for(e.push(127&n);n>=128;)n/=128,e.push(128|127&n);for(;e.length>0;)this.writeByte(e.pop())}else this.writeByte(n)}}static getLength(e){if(e>127){let t=1;for(let n=e>>8;0!==n;n>>=8)t++;const n=o.lengthBuffer.slice(0,t+1);n[0]=128|t;for(let i=8*(t-1),s=1;i>=0;i-=8,s++)n[s]=e>>i;return n}{const t=o.lengthBuffer.slice(0,1);return t[0]=e,t}}writeByte(e){this.ensureCapacity(this.position+1),this.buffer[this.position++]=e}writeBytes(e){this.ensureCapacity(this.position+e.length),e.copy(this.buffer,this.position),this.position+=e.length}ensureCapacity(e){if(this.buffer.length<e){let t=Math.max(512,2*this.buffer.length);for(;t<e;)t*=2;const n=i.Buffer.alloc(t);this.buffer.copy(n,0,0,this.position),this.buffer=n}}}t.DerWriter=o,o.lengthBuffer=i.Buffer.alloc(10)},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SshChannel=void 0;const i=n(46),s=n(8),r=n(104),o=n(84),a=n(54),c=n(480),l=n(85),u=n(47),d=n(282),h=n(481),f=n(86),p=n(143);class m{constructor(e,t,n,i,r,o){this.connectionService=e,this.channelType=t,this.remoteChannelId=n,this.remoteWindowSize=i,this.remoteMaxPacketSize=r,this.channelId=o,this.remoteClosed=!1,this.localClosed=!1,this.sentEof=!1,this.disposed=!1,this.openSendingWindowCompletionSource=null,this.requestCompletionSource=null,this.sendSemaphore=new p.Semaphore(0),this.metrics=new c.ChannelMetrics,this.dataReceivedEmitter=new s.Emitter,this.onDataReceived=this.dataReceivedEmitter.event,this.eofEmitter=new s.Emitter,this.onEof=this.eofEmitter.event,this.closedEmitter=new s.Emitter,this.onClosed=this.closedEmitter.event,this.requestEmitter=new s.Emitter,this.onRequest=this.requestEmitter.event,this.windowSize=m.initialWindowSize,this.maxPacketSize=m.dataPacketSize}get session(){return this.connectionService.session}get isClosed(){return this.localClosed||this.remoteClosed}async request(e,t){if(!e)throw new TypeError("Request is required.");if(this.disposed)throw new u.ObjectDisposedError(this);if(e.recipientChannel=this.remoteChannelId,!e.wantReply)return await this.session.sendMessage(e,t),!0;if(null!=this.requestCompletionSource)throw new Error("Another request is already pending.");const n=new l.PromiseCompletionSource;if(this.requestCompletionSource=n,t){if(t.isCancellationRequested)throw new f.CancellationError;t.onCancellationRequested(()=>{n.reject(new f.CancellationError)})}return await this.session.sendMessage(e,t),await n.promise}async send(t,n){if(this.disposed)throw new u.ObjectDisposedError(this);if(0!==t.length){if(this.sentEof)throw new Error("Cannot send more data after EOF.");await this.sendSemaphore.wait(n);try{let s=0,r=t.length;for(;r>0;){let a=Math.min(Math.min(this.remoteWindowSize,this.remoteMaxPacketSize),r);for(;0===a;)this.openSendingWindowCompletionSource||(this.openSendingWindowCompletionSource=new l.PromiseCompletionSource),(0,i.trace)(`${this} send window is full. Waiting for window adjustment before sending.`),await(0,f.withCancellation)(this.openSendingWindowCompletionSource.promise,n),this.openSendingWindowCompletionSource=null,a=Math.min(Math.min(this.remoteWindowSize,this.remoteMaxPacketSize),r);const c=new o.ChannelDataMessage;c.recipientChannel=this.remoteChannelId,c.data=e.from(t.slice(s,s+a)),await this.session.sendMessage(c,n),this.remoteWindowSize-=a,r-=a,s+=a,this.metrics.addBytesSent(a)}}finally{this.sendSemaphore.tryRelease()}}else await this.sendEof()}enableSending(){this.sendSemaphore.tryRelease()}async sendEof(e){if(!this.sentEof){await this.sendSemaphore.wait(e);try{this.sentEof=!0;const t=new o.ChannelEofMessage;t.recipientChannel=this.remoteChannelId,await this.session.sendMessage(t,e)}finally{this.sendSemaphore.tryRelease()}}}async handleRequest(e,t){if(!e.requestType)throw new u.SshConnectionError("Channel request type not specified.",a.SshDisconnectReason.protocolError);if(e.requestType===o.ChannelRequestType.exitStatus){const t=new o.ChannelSignalMessage;return e.convertTo(t),this.exitStatus=t.exitStatus,!0}if(e.requestType===o.ChannelRequestType.exitSignal){const t=new o.ChannelSignalMessage;return e.convertTo(t),this.exitSignal=t.exitSignal,this.exitErrorMessage=t.errorMessage,!0}if(e.requestType===o.ChannelRequestType.signal){const t=new o.ChannelSignalMessage;e.convertTo(t)}const n=new d.SshRequestEventArgs(e.requestType,e,this.session.principal),i=(0,r.findService)(this.session.config.services,t=>(!t.channelType||t.channelType===this.channelType)&&t.channelRequest===e.requestType);await this.sendSemaphore.wait(t);try{if(i){const e=this.session.activateService(i);await e.onChannelRequest(this,n,t)}else this.requestEmitter.fire(n);if(e.wantReply){let e;if(n.isAuthorized){const t=new o.ChannelSuccessMessage;t.recipientChannel=this.remoteChannelId,e=t}else{const t=new o.ChannelFailureMessage;t.recipientChannel=this.remoteChannelId,e=t}await this.session.sendMessage(e,t)}}finally{this.sendSemaphore.tryRelease()}return n.isAuthorized||!1}handleResponse(e){this.requestCompletionSource&&(this.requestCompletionSource.resolve(e),this.requestCompletionSource=null)}handleDataReceived(e){this.metrics.addBytesReceived(e.length),this.dataReceivedEmitter.fire(e)}adjustWindow(e){if(!this.disposed&&(this.windowSize-=e,this.windowSize<=this.maxPacketSize)){const e=new o.ChannelWindowAdjustMessage;e.recipientChannel=this.remoteChannelId,e.bytesToAdd=m.initialWindowSize-this.windowSize,this.windowSize=m.initialWindowSize,this.session.sendMessage(e).catch(e=>{(0,i.trace)(`Error sending window adjust message: ${e.message||JSON.stringify(e)}`)})}}adjustRemoteWindow(e){this.remoteWindowSize+=e,this.openSendingWindowCompletionSource&&this.openSendingWindowCompletionSource.resolve(void 0)}handleEof(){(0,i.trace)(`${this} EOF received.`),this.eofEmitter.fire()}close(e,t,n){if(!(e instanceof Error))return"number"==typeof e?this.closeWithStatus(e,t):"string"==typeof e?this.closeWithSignal(e,t,n):this.closeDefault(e);{const t=e;this.localClosed||((0,i.trace)(`${this} Closed: ${t.message}`),this.closedEmitter.fire(new h.SshChannelClosedEventArgs(t)),this.disposeInternal())}}async closeDefault(e){var t;if(!this.remoteClosed&&!this.localClosed){this.remoteClosed=!0,await this.sendSemaphore.wait(e);try{const e=new o.ChannelCloseMessage;e.recipientChannel=this.remoteChannelId,await this.session.sendMessage(e)}catch(e){}finally{this.sendSemaphore.tryRelease()}}if(!this.localClosed){this.localClosed=!0;const e=`${this} closed.`;(0,i.trace)(e),this.closedEmitter.fire(new h.SshChannelClosedEventArgs),null===(t=this.requestCompletionSource)||void 0===t||t.reject(new u.SshChannelError(e)),this.disposeInternal()}}async closeWithStatus(e,t){if(!this.remoteClosed&&!this.localClosed){this.exitStatus=e;const t=new o.ChannelSignalMessage;t.recipientChannel=this.remoteChannelId,t.exitStatus=e,await this.session.sendMessage(t)}this.localClosed||await this.closeDefault(t)}async closeWithSignal(e,t,n){if(!this.remoteClosed&&!this.localClosed){this.exitSignal=e,this.exitErrorMessage=t;const n=new o.ChannelSignalMessage;n.recipientChannel=this.remoteChannelId,n.exitSignal=e,n.errorMessage=t,await this.session.sendMessage(n)}this.localClosed||await this.closeDefault(n)}dispose(){var e;if(!this.disposed&&!this.localClosed){if(!this.remoteClosed){this.remoteClosed=!0;const e=new o.ChannelCloseMessage;e.recipientChannel=this.remoteChannelId,this.session.sendMessage(e).catch(e=>{})}let t,n;void 0!==this.exitStatus?(n=new h.SshChannelClosedEventArgs(this.exitStatus),t=`${this} disposed: status=${this.exitStatus}`):void 0!==this.exitSignal?(n=new h.SshChannelClosedEventArgs(this.exitSignal,this.exitErrorMessage),t=`${this} disposed: signal=${this.exitSignal} ${this.exitErrorMessage}`):(n=new h.SshChannelClosedEventArgs,t=`${this} disposed.`),this.localClosed=!0,(0,i.trace)(t),this.closedEmitter.fire(n),null===(e=this.requestCompletionSource)||void 0===e||e.reject(new u.SshChannelError(t))}this.disposeInternal()}disposeInternal(){var e;this.disposed||(this.disposed=!0,null===(e=this.requestCompletionSource)||void 0===e||e.reject(new u.ObjectDisposedError(this)),this.connectionService._removeChannel(this),this.sendSemaphore.dispose())}toString(){return`SshChannel(Type: ${this.channelType}, Id: ${this.channelId}, RemoteId: ${this.remoteChannelId})`}}t.SshChannel=m,m.sessionChannelType="session",m.dataPacketSize=32768,m.initialWindowSize=32*m.dataPacketSize}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshRequestEventArgs=void 0;t.SshRequestEventArgs=class{constructor(e,t,n){this.requestType=e,this.request=t,this.principal=n}toString(){return`RequestType: ${this.requestType}`+this.request?` Request: ${this.request}`:""}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NewKeysMessage=t.KeyExchangeDhReplyMessage=t.KeyExchangeDhInitMessage=t.KeyExchangeInitMessage=t.KeyExchangeMessage=void 0;const i=n(3),s=n(105),r=n(103);class o extends s.SshMessage{}t.KeyExchangeMessage=o;class a extends o{get messageType(){return 20}onRead(e){this.cookie=e.read(16),this.keyExchangeAlgorithms=e.readList("ascii"),this.serverHostKeyAlgorithms=e.readList("ascii"),this.encryptionAlgorithmsClientToServer=e.readList("ascii"),this.encryptionAlgorithmsServerToClient=e.readList("ascii"),this.macAlgorithmsClientToServer=e.readList("ascii"),this.macAlgorithmsServerToClient=e.readList("ascii"),this.compressionAlgorithmsClientToServer=e.readList("ascii"),this.compressionAlgorithmsServerToClient=e.readList("ascii"),this.languagesClientToServer=e.readList("ascii"),this.languagesServerToClient=e.readList("ascii"),this.firstKexPacketFollows=e.readBoolean(),this.reserved=e.readUInt32()}onWrite(e){this.cookie||(this.cookie=i.Buffer.alloc(16),r.SshAlgorithms.random.getBytes(this.cookie)),e.write(this.cookie),e.writeList(this.keyExchangeAlgorithms||[],"ascii"),e.writeList(this.serverHostKeyAlgorithms||[],"ascii"),e.writeList(this.encryptionAlgorithmsClientToServer||[],"ascii"),e.writeList(this.encryptionAlgorithmsServerToClient||[],"ascii"),e.writeList(this.macAlgorithmsClientToServer||[],"ascii"),e.writeList(this.macAlgorithmsServerToClient||[],"ascii"),e.writeList(this.compressionAlgorithmsClientToServer||[],"ascii"),e.writeList(this.compressionAlgorithmsServerToClient||[],"ascii"),e.writeList(this.languagesClientToServer||[],"ascii"),e.writeList(this.languagesServerToClient||[],"ascii"),e.writeBoolean(this.validateField(this.firstKexPacketFollows,"first KEX package follows")),e.writeUInt32(this.reserved||0)}}t.KeyExchangeInitMessage=a;class c extends o{get messageType(){return 30}onRead(e){this.e=e.readBinary()}onWrite(e){e.writeBinary(this.validateField(this.e,"E"))}}t.KeyExchangeDhInitMessage=c;class l extends o{get messageType(){return 31}onRead(e){this.hostKey=e.readBinary(),this.f=e.readBinary(),this.signature=e.readBinary()}onWrite(e){e.writeBinary(this.validateField(this.hostKey,"host key")),e.writeBinary(this.validateField(this.f,"F")),e.writeBinary(this.validateField(this.signature,"signature"))}}t.KeyExchangeDhReplyMessage=l;class u extends o{get messageType(){return 21}onRead(e){}onWrite(e){}}t.NewKeysMessage=u,s.SshMessage.index.set(20,a),s.SshMessage.index.set(30,c),s.SshMessage.index.set(31,l),s.SshMessage.index.set(21,u)},function(e,t,n){"use strict";(function(e){var i,s=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationService=void 0;const r=n(46),o=n(183),a=n(484),c=n(8),l=n(37),u=n(54),d=n(285),h=n(144),f=n(104),p=n(182);let m=i=class extends o.SshService{constructor(e){var t;super(e),this.authenticationFailureCount=0,this.disposeCancellationSource=new c.CancellationTokenSource;const n=null===(t=e.algorithms)||void 0===t?void 0:t.publicKeyAlgorithmName;if(!n)throw new Error("Algorithms not initialized.");this.publicKeyAlgorithmName=n}handleMessage(e,t){if(e instanceof a.AuthenticationSuccessMessage)return this.handleSuccessMessage(e);if(e instanceof a.AuthenticationFailureMessage)return this.handleFailureMessage(e);if(e instanceof a.AuthenticationRequestMessage)return this.handleAuthenticationRequestMessage(e,t);throw new Error(`Message not implemented: ${e}`)}async handleAuthenticationRequestMessage(e,t){if((0,r.trace)(`Authentication request: ${e.methodName}`),"publickey"===e.methodName||"hostbased"===e.methodName)return this.handlePublicKeyRequestMessage(e.convertTo(new a.PublicKeyRequestMessage),t);if("password"===e.methodName)return this.handlePasswordRequestMessage(e.convertTo(new a.PasswordRequestMessage),t);if("none"===e.methodName)return this.handleAuthenticating(e,new d.SshAuthenticatingEventArgs(d.SshAuthenticationType.clientNone,{username:e.username},t));{const e=new a.AuthenticationFailureMessage;e.methodNames=["publickey","password","hostbased"],await this.session.sendMessage(e,t)}}async handlePublicKeyRequestMessage(t,n){var i,s,r;const o=this.session.config.getPublicKeyAlgorithm(t.keyAlgorithmName);if(!o){const e=new a.AuthenticationFailureMessage;return e.methodNames=["publickey","password"],void await this.session.sendMessage(e,n)}const c=o.createKeyPair();let u;if(await c.setPublicKeyBytes(t.publicKey),"hostbased"===t.methodName)u=new d.SshAuthenticatingEventArgs(d.SshAuthenticationType.clientHostBased,{username:null!==(i=t.username)&&void 0!==i?i:"",publicKey:c,clientHostname:t.clientHostname,clientUsername:t.clientUsername});else if(t.hasSignature){const i=o.readSignatureData(t.signature),s=this.session.sessionId;if(null==s)throw new Error("Session ID not initialized.");const a=new l.SshDataWriter(e.alloc(s.length+t.payloadWithoutSignature.length+20));a.writeBinary(s),a.write(t.payloadWithoutSignature);const h=a.toBuffer(),f=o.createVerifier(c);await f.verify(h,i)||await this.handleAuthenticationFailure("Public key authentication failed: invalid signature.",n),u=new d.SshAuthenticatingEventArgs(d.SshAuthenticationType.clientPublicKey,{username:null!==(r=t.username)&&void 0!==r?r:"",publicKey:c})}else u=new d.SshAuthenticatingEventArgs(d.SshAuthenticationType.clientPublicKeyQuery,{username:null!==(s=t.username)&&void 0!==s?s:"",publicKey:c});await this.handleAuthenticating(t,u,n)}async handlePasswordRequestMessage(e,t){var n,i;const s=new d.SshAuthenticatingEventArgs(d.SshAuthenticationType.clientPassword,{username:null!==(n=e.username)&&void 0!==n?n:"",password:null!==(i=e.password)&&void 0!==i?i:""});await this.handleAuthenticating(e,s,t)}async handleAuthenticating(e,t,n){var i;let s=null;try{s=await this.session.raiseAuthenticatingEvent(t)}catch(e){if(!(e instanceof Error))throw e;(0,r.trace)("Error while authenticating client: "+(null!==(i=e.message)&&void 0!==i?i:e)),s=null}if(s)if(t.authenticationType===d.SshAuthenticationType.clientPublicKeyQuery){const t=e,i=new a.PublicKeyOKMessage;i.keyAlgorithmName=t.keyAlgorithmName,i.publicKey=t.publicKey,await this.session.sendMessage(i,n)}else this.session.principal=s,e.serviceName&&this.session.activateService(e.serviceName),(0,r.trace)(`${d.SshAuthenticationType[t.authenticationType]} authentication succeeded.`),await this.session.sendMessage(new a.AuthenticationSuccessMessage,n);else await this.handleAuthenticationFailure(`${d.SshAuthenticationType[t.authenticationType]} authentication failed.`)}async handleAuthenticationFailure(e,t){this.authenticationFailureCount++,(0,r.trace)(e);const n=new a.AuthenticationFailureMessage;n.methodNames=["publickey","password","hostbased"],await this.session.sendMessage(n,t),this.authenticationFailureCount>=this.session.config.maxClientAuthenticationAttempts&&await this.session.close(u.SshDisconnectReason.noMoreAuthMethodsAvailable,"Authentication failed.")}async authenticateClient(e,t){var n,i,s,r;this.clientAuthenticationMethods=new p.Queue;for(let t of null!==(n=e.publicKeys)&&void 0!==n?n:[]){if(!t)continue;const n=null!==(i=e.username)&&void 0!==i?i:"";let s=t;const r=e.privateKeyProvider;this.clientAuthenticationMethods.enqueue(async e=>{if(!s.hasPrivateKey){if(null==r)throw new Error("A private key provider is required.");s=await r(t,null!=e?e:c.CancellationToken.None)}s?await this.requestPublicKeyAuthentication(n,s,e):await this.session.close(u.SshDisconnectReason.authCancelledByUser)})}const o=e.passwordProvider;if(o)this.clientAuthenticationMethods.enqueue(async e=>{var t;const n=o(null!=e?e:c.CancellationToken.None),i=n?await n:null;i?await this.requestPasswordAuthentication(null!==(t=i[0])&&void 0!==t?t:"",i[1],e):await this.session.close(u.SshDisconnectReason.authCancelledByUser)});else if(e.password){const t=null!==(s=e.username)&&void 0!==s?s:"",n=e.password;this.clientAuthenticationMethods.enqueue(async e=>{await this.requestPasswordAuthentication(t,n,e)})}if(0===this.clientAuthenticationMethods.size){const t=null!==(r=e.username)&&void 0!==r?r:"";this.clientAuthenticationMethods.enqueue(async e=>{await this.requestUsernameAuthentication(t,e)})}const a=this.clientAuthenticationMethods.dequeue();await a(t)}async requestUsernameAuthentication(e,t){const n=new a.AuthenticationRequestMessage;n.serviceName=h.ConnectionService.serviceName,n.methodName="none",n.username=e,await this.session.sendMessage(n,t),this.session.activateService(h.ConnectionService)}async requestPublicKeyAuthentication(e,t,n){const i=this.session.config.publicKeyAlgorithms.find(e=>(null==e?void 0:e.keyAlgorithmName)===t.keyAlgorithmName);if(!i)throw new Error(`Public key algorithm '${t.keyAlgorithmName}' is not in session config.`);const s=new a.PublicKeyRequestMessage;s.serviceName=h.ConnectionService.serviceName,s.username=e,s.keyAlgorithmName=i.name,s.publicKey=await t.getPublicKeyBytes(i.name),s.signature=await this.createAuthenticationSignature(s,i,t),await this.session.sendMessage(s,n),0===this.clientAuthenticationMethods.size&&this.session.activateService(h.ConnectionService)}async requestPasswordAuthentication(e,t,n){const i=new a.PasswordRequestMessage;i.serviceName=h.ConnectionService.serviceName,i.username=e,i.password=t,await this.session.sendMessage(i,n),this.session.activateService(h.ConnectionService)}handleFailureMessage(e){this.session.onAuthenticationComplete(!1)}handleSuccessMessage(e){this.session.activateService(h.ConnectionService),this.session.onAuthenticationComplete(!0)}async createAuthenticationSignature(t,n,i){const s=this.session.sessionId;if(null==s)throw new Error("Session ID not initialized.");const r=new l.SshDataWriter(e.alloc(t.publicKey.length+(t.username||"").length+400));r.writeBinary(s),r.writeByte(t.messageType),r.writeString(t.username||"","utf8"),r.writeString(t.serviceName||"","ascii"),r.writeString("publickey","ascii"),r.writeBoolean(!0),r.writeString(t.keyAlgorithmName,"ascii"),r.writeBinary(t.publicKey);const o=n.createSigner(i),a=await o.sign(r.toBuffer());return n.createSignatureData(a)}};m.serviceName="ssh-userauth",m=i=s([(0,f.serviceActivation)({serviceRequest:i.serviceName})],m),t.AuthenticationService=m}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshAuthenticatingEventArgs=t.SshAuthenticationType=void 0;const i=n(8);var s;!function(e){e[e.clientNone=0]="clientNone",e[e.clientHostBased=1]="clientHostBased",e[e.clientPassword=2]="clientPassword",e[e.clientPublicKeyQuery=3]="clientPublicKeyQuery",e[e.clientPublicKey=4]="clientPublicKey",e[e.serverPublicKey=10]="serverPublicKey"}(s=t.SshAuthenticationType||(t.SshAuthenticationType={}));t.SshAuthenticatingEventArgs=class{constructor(e,{username:t,password:n,publicKey:r,clientHostname:o,clientUsername:a},c){this.authenticationType=e;const l=({usernameRequired:e,passwordRequired:i,publicKeyRequired:s,clientHostnameRequired:c,clientUsernameRequired:l})=>"string"==typeof t==!!e&&("string"==typeof n==!!i&&(!!r==!!s&&("string"==typeof o==!!c&&"string"==typeof a==!!l)));let u;switch(e){case s.clientNone:u=l({usernameRequired:!0});break;case s.clientHostBased:u=l({usernameRequired:!0,publicKeyRequired:!0,clientHostnameRequired:!0,clientUsernameRequired:!0});break;case s.clientPassword:u=l({usernameRequired:!0,passwordRequired:!0});break;case s.clientPublicKeyQuery:case s.clientPublicKey:u=l({usernameRequired:!0,publicKeyRequired:!0});break;case s.serverPublicKey:u=l({publicKeyRequired:!0});break;default:throw new Error(`Invalid authentication type: ${e}`)}if(!u)throw new Error(`Invalid arguments for authentication type: ${e}`);this.username=null!=t?t:null,this.password=null!=n?n:null,this.publicKey=null!=r?r:null,this.clientHostname=null!=o?o:null,this.clientUsername=null!=a?a:null,this.cancellationValue=null!=c?c:i.CancellationToken.None}get cancellation(){return this.cancellationValue}set cancellation(e){this.cancellationValue=e}toString(){return this.password?`${this.username?'"'+this.username+'" ':""}[password]`:this.publicKey?`${this.username?'"'+this.username+'" ':""}[${this.publicKey.keyAlgorithmName}]`:`"${this.username}"`}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(24),r=n(287),o=n(7),a=n(4),c=n(5);class l extends s.EventEmitter{constructor(e,t,n){super(),this.serviceId=e,this.contactServiceProvider=t,this.contactManager=n,this._selfUser=null,this._capabilites={},this._availableUsers=[],this._suggestedUsers=[],this.signedState=c.contactProtocol.SignedStatus.None,this.queueEmitEvents=[],this.trace=o.traceSource.withName("Contact.Service")}async request(e,t,n){this.trace.verbose(`Request '${e}' serviceId:${this.serviceId}`);try{return await this.contactServiceProvider.requestAsync(e,t,n)}catch(t){throw this.trace.error(`Request '${e}' failed with error:${t} serviceId:${this.serviceId}`),t}}async initialize(e,t){this.trace.verbose(`_Initialize:${this.serviceId}`),this.contactServiceProvider.onNotified(e=>this.onNotified(e.type,e.body));const n=await this.request(c.contactProtocol.Methods.RequestInitializeName,{clientID:"vscode",workspaceFolders:i.workspace.workspaceFolders,enablePublish:e,publishPresence:t});this._descriptionName=n.description,this._capabilites=n.capabilities,this._providerPriority=n.providerPriority,n.selfContact&&this.setSelfUser({contact:n.selfContact}),n.signedState&&(this.signedState=n.signedState),this.initialized=!0,this.queueEmitEvents.length>0&&(this.trace.info(`flush events-> serviceId:${this.serviceId} count:${this.queueEmitEvents.length}`),this.queueEmitEvents.forEach(e=>this.emit(e.event,e.parameter)),this.queueEmitEvents=[]),this.emit(a.ContactServiceEvents.Initialized)}async signIn(){this._capabilites&&this._capabilites.supportsSignedStateRequest&&await this.request(c.contactProtocol.Methods.RequestSignInName,{})}async signOut(){this._capabilites&&this._capabilites.supportsSignedStateRequest&&await this.request(c.contactProtocol.Methods.RequestSignOutName,{})}async _Dispose(){this._capabilites&&this._capabilites.supportsDispose&&await this.request(c.contactProtocol.Methods.RequestDisposeName,{})}async publishPresence(e,t){this._capabilites&&this._capabilites.supportsPublishPresence&&await this.request(c.contactProtocol.Methods.RequestPublishPresenceName,{status:e,properties:t})}async sendInviteLink(e,t){this._capabilites&&this._capabilites.supportsInviteLink&&await this.request(c.contactProtocol.Methods.RequestInviteName,{targetContactId:e,link:t})}async contactsPresenceRequest(e){if(this._capabilites&&!this._capabilites.supportsContactPresenceRequest)return{};const t=await this.request(c.contactProtocol.Methods.RequestContactPresenceName,{contacts:e}),n={};return t.contacts.forEach(e=>n[e.contactId]=new r.ContactModelApi(this.serviceId,e.contact,e.properties?e.properties:{},this.contactManager)),n}async contactsPresenceDispose(e){await this.request(c.contactProtocol.Methods.RequestContactPresenceDisposeName,{contactIds:e})}async searchContactsRequest(e,t,n){return(await this.request(c.contactProtocol.Methods.RequestSearchContactsName,{queryOptions:e,maxCount:t},n)).results.map(e=>new r.ContactModelApi(this.serviceId,e,{},this.contactManager))}async sendMessage(e,t,n,i){const s={targetContactId:e,type:t,body:n};await this.request(c.contactProtocol.Methods.RequestSendMessageName,s,i)}get capabilites(){return this._capabilites}get descriptionName(){return this._descriptionName}get priority(){return void 0!==this._providerPriority?this._providerPriority:100}get selfUser(){return this._selfUser}get selfUserId(){return this._selfUser?this._selfUser.contact.id:null}get signedStatus(){return this.signedState}get availableUsers(){return this._availableUsers}lookupContactById(e){return this.availableUsers.concat(this._suggestedUsers).find(t=>t.contact.id===e)}findMatchContact(e){return l.findMatchContact(this.availableUsers.concat(this._suggestedUsers),e)}static isOffline(e){return e.contact.status===c.contactProtocol.PresenceStatus.Unknown||e.contact.status===c.contactProtocol.PresenceStatus.Offline}emitEvent(e,t){this.initialized?this.emit(e,t):this.queueEmitEvents.push({event:e,parameter:t})}setSelfUser(e){var t;this._selfUser=new r.ContactModelApi(this.serviceId,e.contact,null!==(t=e.registrationInfo)&&void 0!==t?t:{},this.contactManager)}onNotified(e,t){switch(this.trace.verbose(`onNotified-> serviceId:${this.serviceId} name:${e}`),e){case c.contactProtocol.Methods.NotifySelfContactName:this.setSelfUser(t),this.emitEvent(a.ContactServiceEvents.SelfContactChanged);break;case c.contactProtocol.Methods.NotifyAvailableUsersName:const e=t;this._availableUsers=this.toContactModels(e),this.emitEvent(a.ContactServiceEvents.AvailableUsersChanged);break;case c.contactProtocol.Methods.NotifyAvailableUsersAddedName:const n=t;this._availableUsers.push(...this.toContactModels(n)),this.emitEvent(a.ContactServiceEvents.AvailableUsersChanged);break;case c.contactProtocol.Methods.NotifyAvailableUsersRemovedName:this.emitEvent(a.ContactServiceEvents.AvailableUsersChanged);break;case c.contactProtocol.Methods.NotifyPresenceChangedName:const i=t,s=[];i.changes.forEach(e=>this.updatePresenceStatus(e,s)),s.length>0&&this.emitEvent(a.ContactServiceEvents.ContactsChanged,s);const r={};i.changes.forEach(e=>{r[e.contactId]=[{property:c.contactProtocol.ContactProperty.Status,value:e.status}]}),this.emitEvent(a.ContactServiceEvents.ContactsChangedNotification,r);break;case c.contactProtocol.Methods.NotifyContactChangedName:const o=t,u=[],d=this.selfUser?[this.selfUser].concat(this.availableUsers):this.availableUsers;l.updateContacts(d,o.changes,u),u.length>0&&this.emitEvent(a.ContactServiceEvents.ContactsChanged,u),this.emitEvent(a.ContactServiceEvents.ContactsChangedNotification,o.changes);break;case c.contactProtocol.Methods.NotifyContactPropertiesChangedName:const h=t;this.emitEvent(a.ContactServiceEvents.ContactPropertyChangedNotification,h);break;case c.contactProtocol.Methods.NotifyInviteReceivedName:const f=t;this.emitEvent(a.ContactServiceEvents.InviteLinkReceived,f);break;case c.contactProtocol.Methods.NotifyMessageReceivedName:const p=t;this.emitEvent(a.ContactServiceEvents.MessageReceived,p);break;case c.contactProtocol.Methods.NotifySuggestedUsersName:const m=t;this._suggestedUsers=this.toContactModels(m,50),this.emitEvent(a.ContactServiceEvents.SuggestedUsersUpdate,{contacts:this._suggestedUsers,exclusive:m.exclusive});break;case c.contactProtocol.Methods.NotifyCapabilitiesUpdateName:const g=this._capabilites,y=t;this._capabilites=y,this.emitEvent(a.ContactServiceEvents.CapabilitiesChanged,{oldCapabilities:g,newCapabilities:y}),!y.supportsSelfContact&&this._selfUser&&(this._selfUser=null,this.emitEvent(a.ContactServiceEvents.SelfContactChanged));break;case c.contactProtocol.Methods.NotifySignedStateChangedName:const v=t;this.signedState=v.state,this.emitEvent(a.ContactServiceEvents.SignedStateChanged,this.signedState);break;case c.contactProtocol.Methods.NotifyAuthenticationRequiredName:this.emitEvent(a.ContactServiceEvents.AuthenticationRequired)}}static updatePresenceStatus(e,t,n){const i={};t.forEach(e=>{i[e.contactId]=[{property:c.contactProtocol.ContactProperty.Status,value:e.status}]}),l.updateContacts(e,i,n)}static updateContacts(e,t,n){Object.keys(t).forEach(i=>{const s=e.find(e=>e.contact.id===i);if(s){l.updateContactChanges(s,t[i])&&n&&n.push(s)}})}static updateContactPropertyChanges(e,t){const n=Object.keys(t);n.forEach(n=>{e.properties[n]=t[n]}),e.fireChanged(...n)}static updateContactChanges(e,t){const n=e.contact,i=[];return t.forEach(e=>{if(e.value)switch(e.property){case c.contactProtocol.ContactProperty.Status:n.status!==e.value&&(n.status=e.value,i.push("status"));break;case c.contactProtocol.ContactProperty.Email:n.email!==e.value&&(n.email=e.value,i.push("email"));break;case c.contactProtocol.ContactProperty.AvatarUri:n.avatarUri!==e.value&&(n.avatarUri=e.value,i.push("avatarUri"));break;case c.contactProtocol.ContactProperty.DisplayName:n.displayName!==e.value&&(n.displayName=e.value,i.push("displayName"))}}),i.length>0&&e.fireChanged(...i),i.length>0}updatePresenceStatus(e,t){const n=this._selfUser&&this._selfUser.contact.id===e.contactId?[this._selfUser]:this.availableUsers;l.updatePresenceStatus(n,[e],t)}toContactModels(e,t){let n=e.contacts;return t&&n.length>t&&(n=n.slice(0,t)),n.map(e=>(e.status||(e.status=c.contactProtocol.PresenceStatus.Unknown),new r.ContactModelApi(this.serviceId,e,{},this.contactManager)))}static findMatchContact(e,t){return e.find(e=>t.id===e.contact.id||t.email===e.contact.id)}}t.ContactServiceManager=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);t.ContactModelApi=class{constructor(e,t,n,s){this.serviceId=e,this.contact=t,this.properties=n,this.contactManager=s,this.onDidChangePropertyEmitter=new i.EventEmitter}get inviteStatus(){return this.contactManager.getInviteStatus(this.id)}get id(){return this.contact.id}fireChanged(...e){this.onDidChangePropertyEmitter.fire(e)}get onDidChangeProperty(){return this.onDidChangePropertyEmitter.event}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(5);t.ProviderBase=class{constructor(){this.onNotifiedEmitter=new i.EventEmitter}async requestAsync(e,t,n){let i=null;switch(e){case s.contactProtocol.Methods.RequestInitializeName:i=await this.requestInitialize(t);break;default:throw new Error(`type:${e} not supported`)}return i}get onNotified(){return this.onNotifiedEmitter.event}notify(e,t){this.onNotifiedEmitter.fire({type:e,body:t})}notifySuggestedUsers(e){this.notify(s.contactProtocol.Methods.NotifySuggestedUsersName,{contacts:e})}notifyPresenceChanged(e,t){const n=new s.contactProtocol.ContactPresenceUpdate;n.contactId=e,n.status=t;const i=new s.contactProtocol.PresenceChangedNotification;i.changes=[n],this.notify(s.contactProtocol.Methods.NotifyPresenceChangedName,i)}notifyContactChanged(e,t){const n={changes:{}};n.changes[e]=t,this.notify(s.contactProtocol.Methods.NotifyContactChangedName,n)}notifyContactPropertiesChanged(e,t){this.notify(s.contactProtocol.Methods.NotifyContactPropertiesChangedName,{contactId:e,changes:t})}notifySignedStateChanged(e){this.notify(s.contactProtocol.Methods.NotifySignedStateChangedName,{state:e})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4);t.setLivesharePresenceEnabled=e=>i.Settings.save(i.SettingKeys.presence,e),t.isLivesharePresenceEnabled=()=>!0===i.Settings.get(i.SettingKeys.presence),t.isSignalRServiceEnabled=()=>void 0!==i.Settings.getUri(i.SettingKeys.signalRServiceUri)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(109);t.CommunicationsManager=i.CommunicationsManager;var s=n(1220);t.ChatTreeDataProvider=s.ChatTreeDataProvider;var r=n(1221);t.AudioTreeDataProvider=r.AudioTreeDataProvider;var o=n(1222);t.registerCommunicationsCommands=o.registerCommands;var a=n(1225);t.ChatService=a.ChatService},function(e,t,n){var i=n(1164),s=n(1165),r=n(1166);e.exports=function(e,t,n){return t==t?r(e,t,n):i(e,s,n)}},function(e,t,n){var i=n(496).Symbol;e.exports=i},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(24),s=n(7),r=n(9),o=n(4);var a,c,l;!function(e){e.AudioConnecting="AudioConnecting",e.AudioDisconnecting="AudioDisconnecting",e.Initializing="Initializing",e.LiveShareWithoutAudio="LiveShareWithoutAudio",e.LiveShareWithAudio="LiveShareWithAudio",e.NoLiveShare="NoLiveShare"}(a=t.AudioSessionState||(t.AudioSessionState={})),function(e){e[e.InitializeDone=0]="InitializeDone",e[e.LiveShareSessionStarted=1]="LiveShareSessionStarted",e[e.LiveShareSessionEnded=2]="LiveShareSessionEnded",e[e.AttemptConnectAudio=3]="AttemptConnectAudio",e[e.AttemptDisconnectAudio=4]="AttemptDisconnectAudio",e[e.AudioConnected=5]="AudioConnected",e[e.AudioDisconnected=6]="AudioDisconnected",e[e.AudioConnectionFailed=7]="AudioConnectionFailed"}(c=t.AudioSessionAction||(t.AudioSessionAction={})),t.sessionMachine={[a.Initializing]:{[c.InitializeDone]:a.NoLiveShare},[a.NoLiveShare]:{[c.LiveShareSessionStarted]:a.LiveShareWithoutAudio},[a.LiveShareWithoutAudio]:{[c.AttemptConnectAudio]:a.AudioConnecting,[c.AudioConnected]:a.LiveShareWithAudio,[c.LiveShareSessionEnded]:a.NoLiveShare},[a.AudioConnecting]:{[c.AudioConnected]:a.LiveShareWithAudio,[c.AudioDisconnected]:a.LiveShareWithoutAudio,[c.AudioConnectionFailed]:a.LiveShareWithoutAudio,[c.LiveShareSessionEnded]:a.NoLiveShare},[a.AudioDisconnecting]:{[c.AudioDisconnected]:a.LiveShareWithoutAudio,[c.AudioConnectionFailed]:a.LiveShareWithoutAudio,[c.LiveShareSessionEnded]:a.NoLiveShare},[a.LiveShareWithAudio]:{[c.AttemptDisconnectAudio]:a.AudioDisconnecting,[c.AudioDisconnected]:a.LiveShareWithoutAudio,[c.LiveShareSessionEnded]:a.NoLiveShare}},function(e){e.StateChanged="StateChanged"}(l=t.AudioSessionEvents||(t.AudioSessionEvents={}));class u extends i.EventEmitter{constructor(){super(),this.currentState=a.Initializing,this.trace=s.traceSource.withName("Calling.AudioSessionContext")}static get Instance(){return u.singleton||(u.singleton=new u),u.singleton}get State(){return u.Instance.currentState}transition(e){const n=t.sessionMachine[this.State];if(this.trace.verbose(`Current state: ${this.State}, Action: ${c[e]}`),n){const t=n[e];return void 0!==t?(u.Instance.setState(t),u.Instance.State):(r.Telemetry.sendTelemetryEvent(o.TelemetryEventNames.AUDIO_INVALID_SESSION_TRANSITION,{[o.TelemetryPropertyNames.AUDIO_SESSION_STATE]:this.State.toString(),[o.TelemetryPropertyNames.AUDIO_SESSION_ACTION]:e.toString()}),void this.trace.warning(`No transition exists for state: ${this.State}, action: ${c[e]}`))}this.trace.warning(`No config for the given state exists in the machine: action ${c[e]}`)}setState(e){const t=u.Instance.currentState;t!==e&&(u.Instance.currentState=e,u.Instance.emit(l.StateChanged,e,t))}}const d=u.Instance;t.AudioSessionContext=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(296);t.DebugSession=i.DebugSession,t.InitializedEvent=i.InitializedEvent,t.TerminatedEvent=i.TerminatedEvent,t.StoppedEvent=i.StoppedEvent,t.ContinuedEvent=i.ContinuedEvent,t.OutputEvent=i.OutputEvent,t.ThreadEvent=i.ThreadEvent,t.BreakpointEvent=i.BreakpointEvent,t.ModuleEvent=i.ModuleEvent,t.LoadedSourceEvent=i.LoadedSourceEvent,t.CapabilitiesEvent=i.CapabilitiesEvent,t.ProgressStartEvent=i.ProgressStartEvent,t.ProgressUpdateEvent=i.ProgressUpdateEvent,t.ProgressEndEvent=i.ProgressEndEvent,t.Thread=i.Thread,t.StackFrame=i.StackFrame,t.Scope=i.Scope,t.Variable=i.Variable,t.Breakpoint=i.Breakpoint,t.Source=i.Source,t.Module=i.Module,t.CompletionItem=i.CompletionItem,t.ErrorDestination=i.ErrorDestination;const s=n(1242);t.LoggingDebugSession=s.LoggingDebugSession;const r=n(510);t.Logger=r;const o=n(297);t.Event=o.Event,t.Response=o.Response;const a=n(1244);t.Handles=a.Handles;const c=r.logger;t.logger=c},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(1241),s=n(297),r=n(66),o=n(32);t.Source=class{constructor(e,t,n=0,i,s){this.name=e,this.path=t,this.sourceReference=n,i&&(this.origin=i),s&&(this.adapterData=s)}};t.Scope=class{constructor(e,t,n=!1){this.name=e,this.variablesReference=t,this.expensive=n}};t.StackFrame=class{constructor(e,t,n,i=0,s=0){this.id=e,this.source=n,this.line=i,this.column=s,this.name=t}};t.Thread=class{constructor(e,t){this.id=e,this.name=t||"Thread #"+e}};t.Variable=class{constructor(e,t,n=0,i,s){this.name=e,this.value=t,this.variablesReference=n,"number"==typeof s&&(this.namedVariables=s),"number"==typeof i&&(this.indexedVariables=i)}};t.Breakpoint=class{constructor(e,t,n,i){this.verified=e;const s=this;"number"==typeof t&&(s.line=t),"number"==typeof n&&(s.column=n),i&&(s.source=i)}};t.Module=class{constructor(e,t){this.id=e,this.name=t}};t.CompletionItem=class{constructor(e,t,n=0){this.label=e,this.start=t,this.length=n}};class a extends s.Event{constructor(e,t,n){super("stopped"),this.body={reason:e},"number"==typeof t&&(this.body.threadId=t),"string"==typeof n&&(this.body.text=n)}}t.StoppedEvent=a;class c extends s.Event{constructor(e,t){super("continued"),this.body={threadId:e},"boolean"==typeof t&&(this.body.allThreadsContinued=t)}}t.ContinuedEvent=c;class l extends s.Event{constructor(){super("initialized")}}t.InitializedEvent=l;class u extends s.Event{constructor(e){if(super("terminated"),"boolean"==typeof e||e){this.body={restart:e}}}}t.TerminatedEvent=u;class d extends s.Event{constructor(e,t="console",n){super("output"),this.body={category:t,output:e},void 0!==n&&(this.body.data=n)}}t.OutputEvent=d;class h extends s.Event{constructor(e,t){super("thread"),this.body={reason:e,threadId:t}}}t.ThreadEvent=h;class f extends s.Event{constructor(e,t){super("breakpoint"),this.body={reason:e,breakpoint:t}}}t.BreakpointEvent=f;class p extends s.Event{constructor(e,t){super("module"),this.body={reason:e,module:t}}}t.ModuleEvent=p;class m extends s.Event{constructor(e,t){super("loadedSource"),this.body={reason:e,source:t}}}t.LoadedSourceEvent=m;class g extends s.Event{constructor(e){super("capabilities"),this.body={capabilities:e}}}t.CapabilitiesEvent=g;class y extends s.Event{constructor(e,t,n){super("progressStart"),this.body={progressId:e,title:t},"string"==typeof n&&(this.body.message=n)}}t.ProgressStartEvent=y;class v extends s.Event{constructor(e,t){super("progressUpdate"),this.body={progressId:e},"string"==typeof t&&(this.body.message=t)}}t.ProgressUpdateEvent=v;class S extends s.Event{constructor(e,t){super("progressEnd"),this.body={progressId:e},"string"==typeof t&&(this.body.message=t)}}var _;t.ProgressEndEvent=S,function(e){e[e.User=1]="User",e[e.Telemetry=2]="Telemetry"}(_=t.ErrorDestination||(t.ErrorDestination={}));class E extends i.ProtocolServer{constructor(e,t){super();const n="boolean"==typeof e&&e;this._debuggerLinesStartAt1=n,this._debuggerColumnsStartAt1=n,this._debuggerPathsAreURIs=!1,this._clientLinesStartAt1=!0,this._clientColumnsStartAt1=!0,this._clientPathsAreURIs=!1,this._isServer="boolean"==typeof t&&t,this.on("close",()=>{this.shutdown()}),this.on("error",e=>{this.shutdown()})}setDebuggerPathFormat(e){this._debuggerPathsAreURIs="path"!==e}setDebuggerLinesStartAt1(e){this._debuggerLinesStartAt1=e}setDebuggerColumnsStartAt1(e){this._debuggerColumnsStartAt1=e}setRunAsServer(e){this._isServer=e}static run(t){let n=0;if(e.argv.slice(2).forEach((function(e,t,i){const s=/^--server=(\d{4,5})$/.exec(e);s&&(n=parseInt(s[1],10))})),n>0)console.error(`waiting for debug protocol on port ${n}`),r.createServer(e=>{console.error(">> accepted connection from client"),e.on("end",()=>{console.error(">> client connection closed\n")});const n=new t(!1,!0);n.setRunAsServer(!0),n.start(e,e)}).listen(n);else{const n=new t(!1);e.on("SIGTERM",()=>{n.shutdown()}),n.start(e.stdin,e.stdout)}}shutdown(){this._isServer||this._isRunningInline()||setTimeout(()=>{e.exit(0)},100)}sendErrorResponse(e,t,n,i,s=_.User){let r;"number"==typeof t?(r={id:t,format:n},i&&(r.variables=i),s&_.User&&(r.showUser=!0),s&_.Telemetry&&(r.sendTelemetry=!0)):r=t,e.success=!1,e.message=E.formatPII(r.format,!0,r.variables),e.body||(e.body={}),e.body.error=r,this.sendResponse(e)}runInTerminalRequest(e,t,n){this.sendRequest("runInTerminal",e,t,n)}dispatchRequest(e){const t=new s.Response(e);try{if("initialize"===e.command){var n=e.arguments;if("boolean"==typeof n.linesStartAt1&&(this._clientLinesStartAt1=n.linesStartAt1),"boolean"==typeof n.columnsStartAt1&&(this._clientColumnsStartAt1=n.columnsStartAt1),"path"!==n.pathFormat)this.sendErrorResponse(t,2018,"debug adapter only supports native paths",null,_.Telemetry);else{const e=t;e.body={},this.initializeRequest(e,n)}}else"launch"===e.command?this.launchRequest(t,e.arguments,e):"attach"===e.command?this.attachRequest(t,e.arguments,e):"disconnect"===e.command?this.disconnectRequest(t,e.arguments,e):"terminate"===e.command?this.terminateRequest(t,e.arguments,e):"restart"===e.command?this.restartRequest(t,e.arguments,e):"setBreakpoints"===e.command?this.setBreakPointsRequest(t,e.arguments,e):"setFunctionBreakpoints"===e.command?this.setFunctionBreakPointsRequest(t,e.arguments,e):"setExceptionBreakpoints"===e.command?this.setExceptionBreakPointsRequest(t,e.arguments,e):"configurationDone"===e.command?this.configurationDoneRequest(t,e.arguments,e):"continue"===e.command?this.continueRequest(t,e.arguments,e):"next"===e.command?this.nextRequest(t,e.arguments,e):"stepIn"===e.command?this.stepInRequest(t,e.arguments,e):"stepOut"===e.command?this.stepOutRequest(t,e.arguments,e):"stepBack"===e.command?this.stepBackRequest(t,e.arguments,e):"reverseContinue"===e.command?this.reverseContinueRequest(t,e.arguments,e):"restartFrame"===e.command?this.restartFrameRequest(t,e.arguments,e):"goto"===e.command?this.gotoRequest(t,e.arguments,e):"pause"===e.command?this.pauseRequest(t,e.arguments,e):"stackTrace"===e.command?this.stackTraceRequest(t,e.arguments,e):"scopes"===e.command?this.scopesRequest(t,e.arguments,e):"variables"===e.command?this.variablesRequest(t,e.arguments,e):"setVariable"===e.command?this.setVariableRequest(t,e.arguments,e):"setExpression"===e.command?this.setExpressionRequest(t,e.arguments,e):"source"===e.command?this.sourceRequest(t,e.arguments,e):"threads"===e.command?this.threadsRequest(t,e):"terminateThreads"===e.command?this.terminateThreadsRequest(t,e.arguments,e):"evaluate"===e.command?this.evaluateRequest(t,e.arguments,e):"stepInTargets"===e.command?this.stepInTargetsRequest(t,e.arguments,e):"gotoTargets"===e.command?this.gotoTargetsRequest(t,e.arguments,e):"completions"===e.command?this.completionsRequest(t,e.arguments,e):"exceptionInfo"===e.command?this.exceptionInfoRequest(t,e.arguments,e):"loadedSources"===e.command?this.loadedSourcesRequest(t,e.arguments,e):"dataBreakpointInfo"===e.command?this.dataBreakpointInfoRequest(t,e.arguments,e):"setDataBreakpoints"===e.command?this.setDataBreakpointsRequest(t,e.arguments,e):"readMemory"===e.command?this.readMemoryRequest(t,e.arguments,e):"disassemble"===e.command?this.disassembleRequest(t,e.arguments,e):"cancel"===e.command?this.cancelRequest(t,e.arguments,e):"breakpointLocations"===e.command?this.breakpointLocationsRequest(t,e.arguments,e):this.customRequest(e.command,t,e.arguments,e)}catch(e){this.sendErrorResponse(t,1104,"{_stack}",{_exception:e.message,_stack:e.stack},_.Telemetry)}}initializeRequest(e,t){e.body.supportsConditionalBreakpoints=!1,e.body.supportsHitConditionalBreakpoints=!1,e.body.supportsFunctionBreakpoints=!1,e.body.supportsConfigurationDoneRequest=!0,e.body.supportsEvaluateForHovers=!1,e.body.supportsStepBack=!1,e.body.supportsSetVariable=!1,e.body.supportsRestartFrame=!1,e.body.supportsStepInTargetsRequest=!1,e.body.supportsGotoTargetsRequest=!1,e.body.supportsCompletionsRequest=!1,e.body.supportsRestartRequest=!1,e.body.supportsExceptionOptions=!1,e.body.supportsValueFormattingOptions=!1,e.body.supportsExceptionInfoRequest=!1,e.body.supportTerminateDebuggee=!1,e.body.supportsDelayedStackTraceLoading=!1,e.body.supportsLoadedSourcesRequest=!1,e.body.supportsLogPoints=!1,e.body.supportsTerminateThreadsRequest=!1,e.body.supportsSetExpression=!1,e.body.supportsTerminateRequest=!1,e.body.supportsDataBreakpoints=!1,e.body.supportsReadMemoryRequest=!1,e.body.supportsDisassembleRequest=!1,e.body.supportsCancelRequest=!1,e.body.supportsBreakpointLocationsRequest=!1,e.body.supportsClipboardContext=!1,this.sendResponse(e)}disconnectRequest(e,t,n){this.sendResponse(e),this.shutdown()}launchRequest(e,t,n){this.sendResponse(e)}attachRequest(e,t,n){this.sendResponse(e)}terminateRequest(e,t,n){this.sendResponse(e)}restartRequest(e,t,n){this.sendResponse(e)}setBreakPointsRequest(e,t,n){this.sendResponse(e)}setFunctionBreakPointsRequest(e,t,n){this.sendResponse(e)}setExceptionBreakPointsRequest(e,t,n){this.sendResponse(e)}configurationDoneRequest(e,t,n){this.sendResponse(e)}continueRequest(e,t,n){this.sendResponse(e)}nextRequest(e,t,n){this.sendResponse(e)}stepInRequest(e,t,n){this.sendResponse(e)}stepOutRequest(e,t,n){this.sendResponse(e)}stepBackRequest(e,t,n){this.sendResponse(e)}reverseContinueRequest(e,t,n){this.sendResponse(e)}restartFrameRequest(e,t,n){this.sendResponse(e)}gotoRequest(e,t,n){this.sendResponse(e)}pauseRequest(e,t,n){this.sendResponse(e)}sourceRequest(e,t,n){this.sendResponse(e)}threadsRequest(e,t){this.sendResponse(e)}terminateThreadsRequest(e,t,n){this.sendResponse(e)}stackTraceRequest(e,t,n){this.sendResponse(e)}scopesRequest(e,t,n){this.sendResponse(e)}variablesRequest(e,t,n){this.sendResponse(e)}setVariableRequest(e,t,n){this.sendResponse(e)}setExpressionRequest(e,t,n){this.sendResponse(e)}evaluateRequest(e,t,n){this.sendResponse(e)}stepInTargetsRequest(e,t,n){this.sendResponse(e)}gotoTargetsRequest(e,t,n){this.sendResponse(e)}completionsRequest(e,t,n){this.sendResponse(e)}exceptionInfoRequest(e,t,n){this.sendResponse(e)}loadedSourcesRequest(e,t,n){this.sendResponse(e)}dataBreakpointInfoRequest(e,t,n){this.sendResponse(e)}setDataBreakpointsRequest(e,t,n){this.sendResponse(e)}readMemoryRequest(e,t,n){this.sendResponse(e)}disassembleRequest(e,t,n){this.sendResponse(e)}cancelRequest(e,t,n){this.sendResponse(e)}breakpointLocationsRequest(e,t,n){this.sendResponse(e)}customRequest(e,t,n,i){this.sendErrorResponse(t,1014,"unrecognized request",null,_.Telemetry)}convertClientLineToDebugger(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e+1:this._clientLinesStartAt1?e-1:e}convertDebuggerLineToClient(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e-1:this._clientLinesStartAt1?e+1:e}convertClientColumnToDebugger(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e+1:this._clientColumnsStartAt1?e-1:e}convertDebuggerColumnToClient(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e-1:this._clientColumnsStartAt1?e+1:e}convertClientPathToDebugger(e){return this._clientPathsAreURIs!==this._debuggerPathsAreURIs?this._clientPathsAreURIs?E.uri2path(e):E.path2uri(e):e}convertDebuggerPathToClient(e){return this._debuggerPathsAreURIs!==this._clientPathsAreURIs?this._debuggerPathsAreURIs?E.uri2path(e):E.path2uri(e):e}static path2uri(t){"win32"===e.platform&&(/^[A-Z]:/.test(t)&&(t=t[0].toLowerCase()+t.substr(1)),t=t.replace(/\\/g,"/")),t=encodeURI(t);let n=new o.URL("file:");return n.pathname=t,n.toString()}static uri2path(t){let n=new o.URL(t),i=decodeURIComponent(n.pathname);return"win32"===e.platform&&(/^\/[a-zA-Z]:/.test(i)&&(i=i[1].toLowerCase()+i.substr(2)),i=i.replace(/\//g,"\\")),i}static formatPII(e,t,n){return e.replace(E._formatPIIRegexp,(function(e,i){return t&&i.length>0&&"_"!==i[0]?e:n[i]&&n.hasOwnProperty(i)?n[i]:e}))}}E._formatPIIRegexp=/{([^}]+)}/g,t.DebugSession=E}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e){this.seq=0,this.type=e}}t.Message=i;t.Response=class extends i{constructor(e,t){super("response"),this.request_seq=e.seq,this.command=e.command,t?(this.success=!1,this.message=t):this.success=!0}};t.Event=class extends i{constructor(e,t){super("event"),this.event=e,t&&(this.body=t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(9),r=n(4);class o{constructor(e,t){this.packageInfo=e,this.trace=t,this.commands=new Map}static getContributions(e,t){let n=o.map.get(e.fullName);return n||(n=new o(e,t),o.map.set(e.fullName,n)),n}registerCommand(e,t,n){const i=this.packageInfo.contributes;if(!i||!i.commands||!i.commands.find(t=>t.command===e))return void this.trace.warning("Command not declared in extension manifest: "+e);const s=i.commands.find(t=>t.command===e);if(!s["vsls-label"]||!s["vsls-detail"])return void this.trace.warning("Missing VSLS extended properties in extension manifest for command: "+e);return o.extensionCommandRegistered||(r.ExtensionUtil.registerCommand("_liveshare.extensionCommand",e=>e.thisArg.invokeExtensionCommand(e.command)),o.extensionCommandRegistered=!0),this.commands.set(e,{command:"_liveshare.extensionCommand",commandArg:{command:e,thisArg:this},label:s["vsls-label"],detail:s["vsls-detail"],enabled:t&&t.bind(n),description:""}),{dispose:()=>{this.commands.delete(e)}}}async invokeExtensionCommand(e){return this.trace.verbose(`invoke(${e})`),this.sendInvokeCommandTelemetryEvent(e),await i.commands.executeCommand(e)}static getQuickPickItems(){const e=[];for(let[t,n]of this.map)for(let[t,i]of n.commands)e.push(i);return e}sendInvokeCommandTelemetryEvent(e){s.Telemetry.sendTelemetryEvent(r.TelemetryEventNames.INVOKE_EXTENSION_COMMAND,{[r.TelemetryPropertyNames.EXTENSION_NAME]:this.packageInfo.fullName,[r.TelemetryPropertyNames.EXTENSION_VERSION]:this.packageInfo.version,[r.TelemetryPropertyNames.EXTENSION_INVOKED_COMMAND]:e})}}t.ExtensionContributions=o,o.map=new Map,o.extensionCommandRegistered=!1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceMoniker=void 0,function(e){e.create=function(e,t){if(!e||""===e)throw new Error("name cannot be empty.");return Object.freeze({name:e,version:t})},e.equals=function(e,t){return e===t||!(!e||!t)&&(e.name===t.name&&e.version===t.version)}}(t.ServiceMoniker||(t.ServiceMoniker={}))},function(e,t,n){var i=n(301).ExtBuffer,s=n(1258),r=n(1259),o=n(188);function a(){var e=this.options;return this.encode=function(e){var t=r.getWriteType(e);return function(e,n){var i=t[typeof n];if(!i)throw new Error('Unsupported type "'+typeof n+'": '+n);i(e,n)}}(e),e&&e.preset&&s.setExtPackers(this),this}o.install({addExtPacker:function(e,t,n){n=o.filter(n);var s=t.name;if(s&&"Object"!==s){(this.extPackers||(this.extPackers={}))[s]=r}else{(this.extEncoderList||(this.extEncoderList=[])).unshift([t,r])}function r(t){return n&&(t=n(t)),new i(t,e)}},getExtPacker:function(e){var t=this.extPackers||(this.extPackers={}),n=e.constructor,i=n&&n.name&&t[n.name];if(i)return i;for(var s=this.extEncoderList||(this.extEncoderList=[]),r=s.length,o=0;o<r;o++){var a=s[o];if(n===a[0])return a[1]}},init:a}),t.preset=a.call(o.preset)},function(e,t,n){t.ExtBuffer=function e(t,n){if(!(this instanceof e))return new e(t,n);this.buffer=i.from(t),this.type=n};var i=n(40)},function(e,t,n){var i,s=n(1257);t.copy=l,t.slice=u,t.toString=function(e,t,n){var i=!a&&r.isBuffer(this)?this.toString:s.toString;return i.apply(this,arguments)},t.write=(i="write",function(){var e=this[i]||s[i];return e.apply(this,arguments)});var r=n(40),o=r.global,a=r.hasBuffer&&"TYPED_ARRAY_SUPPORT"in o,c=a&&!o.TYPED_ARRAY_SUPPORT;function l(e,t,n,i){var o=r.isBuffer(this),a=r.isBuffer(e);if(o&&a)return this.copy(e,t,n,i);if(c||o||a||!r.isView(this)||!r.isView(e))return s.copy.call(this,e,t,n,i);var l=n||null!=i?u.call(this,n,i):this;return e.set(l,t),l.length}function u(e,t){var n=this.slice||!c&&this.subarray;if(n)return n.call(this,e,t);var i=r.alloc.call(this,t-e);return l.call(this,i,0,e,t),i}},function(e,t,n){(function(e){!function(t){var n,i=void 0!==e&&e,s="undefined"!=typeof Uint8Array&&Uint8Array,r="undefined"!=typeof ArrayBuffer&&ArrayBuffer,o=[0,0,0,0,0,0,0,0],a=Array.isArray||function(e){return!!e&&"[object Array]"==Object.prototype.toString.call(e)},c=4294967296;function l(e,a,l){var _=a?0:4,E=a?4:0,w=a?0:3,b=a?1:2,C=a?2:1,T=a?3:0,M=a?g:v,A=a?y:S,k=I.prototype,R="is"+e,P="_"+R;return k.buffer=void 0,k.offset=0,k[P]=!0,k.toNumber=N,k.toString=function(e){var t=this.buffer,n=this.offset,i=D(t,n+_),s=D(t,n+E),r="",o=!l&&2147483648&i;o&&(i=~i,s=c-s);e=e||10;for(;;){var a=i%e*c+s;if(i=Math.floor(i/e),s=Math.floor(a/e),r=(a%e).toString(e)+r,!i&&!s)break}o&&(r="-"+r);return r},k.toJSON=N,k.toArray=u,i&&(k.toBuffer=d),s&&(k.toArrayBuffer=h),I[R]=function(e){return!(!e||!e[P])},t[e]=I,I;function I(e,t,i,a){return this instanceof I?function(e,t,i,a,l){s&&r&&(t instanceof r&&(t=new s(t)),a instanceof r&&(a=new s(a)));if(!(t||i||a||n))return void(e.buffer=m(o,0));if(!f(t,i)){l=i,a=t,i=0,t=new(n||Array)(8)}if(e.buffer=t,e.offset=i|=0,void 0===a)return;"string"==typeof a?function(e,t,n,i){var s=0,r=n.length,o=0,a=0;"-"===n[0]&&s++;var l=s;for(;s<r;){var u=parseInt(n[s++],i);if(!(u>=0))break;a=a*i+u,o=o*i+Math.floor(a/c),a%=c}l&&(o=~o,a?a=c-a:o++);L(e,t+_,o),L(e,t+E,a)}(t,i,a,l||10):f(a,l)?p(t,i,a,l):"number"==typeof l?(L(t,i+_,a),L(t,i+E,l)):a>0?M(t,i,a):a<0?A(t,i,a):p(t,i,o,0)}(this,e,t,i,a):new I(e,t,i,a)}function N(){var e=this.buffer,t=this.offset,n=D(e,t+_),i=D(e,t+E);return l||(n|=0),n?n*c+i:i}function L(e,t,n){e[t+T]=255&n,n>>=8,e[t+C]=255&n,n>>=8,e[t+b]=255&n,n>>=8,e[t+w]=255&n}function D(e,t){return 16777216*e[t+w]+(e[t+b]<<16)+(e[t+C]<<8)+e[t+T]}}function u(e){var t=this.buffer,i=this.offset;return n=null,!1!==e&&0===i&&8===t.length&&a(t)?t:m(t,i)}function d(t){var s=this.buffer,r=this.offset;if(n=i,!1!==t&&0===r&&8===s.length&&e.isBuffer(s))return s;var o=new i(8);return p(o,0,s,r),o}function h(e){var t=this.buffer,i=this.offset,o=t.buffer;if(n=s,!1!==e&&0===i&&o instanceof r&&8===o.byteLength)return o;var a=new s(8);return p(a,0,t,i),a.buffer}function f(e,t){var n=e&&e.length;return t|=0,n&&t+8<=n&&"string"!=typeof e[t]}function p(e,t,n,i){t|=0,i|=0;for(var s=0;s<8;s++)e[t++]=255&n[i++]}function m(e,t){return Array.prototype.slice.call(e,t,t+8)}function g(e,t,n){for(var i=t+8;i>t;)e[--i]=255&n,n/=256}function y(e,t,n){var i=t+8;for(n++;i>t;)e[--i]=255&-n^255,n/=256}function v(e,t,n){for(var i=t+8;t<i;)e[t++]=255&n,n/=256}function S(e,t,n){var i=t+8;for(n++;t<i;)e[t++]=255&-n^255,n/=256}l("Uint64BE",!0,!0),l("Int64BE",!0,!1),l("Uint64LE",!1,!0),l("Int64LE",!1,!1)}("string"!=typeof t.nodeName?t:this||{})}).call(this,n(3).Buffer)},function(e,t,n){var i=n(301).ExtBuffer,s=n(1261),r=n(535).readUint8,o=n(1262),a=n(188);function c(){var e=this.options;return this.decode=function(e){var t=o.getReadToken(e);return function(e){var n=r(e),i=t[n];if(!i)throw new Error("Invalid type: "+(n?"0x"+n.toString(16):n));return i(e)}}(e),e&&e.preset&&s.setExtUnpackers(this),this}a.install({addExtUnpacker:function(e,t){(this.extUnpackers||(this.extUnpackers=[]))[e]=a.filter(t)},getExtUnpacker:function(e){return(this.extUnpackers||(this.extUnpackers=[]))[e]||function(t){return new i(t,e)}},init:c}),t.preset=c.call(a.preset)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(149);t.FrameHeader=class{constructor(e,t){t&&i.requireInteger("channelId",t,4,"signed"),this.code=e,this.channelId=t}get requiredChannelId(){if(this.channelId)return this.channelId;throw new Error("Expected ChannelId not present in frame header.")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(88),s=n(1270),r=n(24),o=n(538),a=n(539),c=n(187),l=n(305);n(307);const u=n(307),d=n(149),h=n(1271),f=n(527);class p{constructor(e,t){var n,s;this._completionSource=new c.Deferred,this.openChannels={},this.channelsOfferedByThemByName={},this.acceptingChannels={},this.eventEmitter=new r.EventEmitter,this.disposalTokenSource=i.default.create(),this.defaultChannelReceivingWindowSize=null!==(n=t.defaultChannelReceivingWindowSize)&&void 0!==n?n:p.recommendedDefaultChannelReceivingWindowSize,this.protocolMajorVersion=null!==(s=t.protocolMajorVersion)&&void 0!==s?s:1;const o=1==t.protocolMajorVersion?new h.MultiplexingStreamV1Formatter(e):2==t.protocolMajorVersion?new h.MultiplexingStreamV2Formatter(e):void 0;if(void 0===o)throw new Error(`Unsupported major protocol version: ${t.protocolMajorVersion}`);this.formatter=o}get disposalToken(){return this.disposalTokenSource.token}get completion(){return this._completionSource.promise}get isDisposed(){return this.disposalTokenSource.token.isCancelled}static async CreateAsync(e,t,n=i.default.CONTINUE){if(!e)throw new Error("stream must be specified.");(t=t||new u.MultiplexingStreamOptions).protocolMajorVersion=t.protocolMajorVersion||1,t.defaultChannelReceivingWindowSize=t.defaultChannelReceivingWindowSize||p.recommendedDefaultChannelReceivingWindowSize;const s=1==t.protocolMajorVersion?new h.MultiplexingStreamV1Formatter(e):2==t.protocolMajorVersion?new h.MultiplexingStreamV2Formatter(e):void 0;if(!s)throw new Error(`Protocol major version ${t.protocolMajorVersion} is not supported.`);const r=await s.writeHandshakeAsync(),o=await s.readHandshakeAsync(r,n);return new m(e,o.isOdd,t)}createChannel(e){var t;const n={name:"",remoteWindowSize:null!==(t=null==e?void 0:e.channelReceivingWindowSize)&&void 0!==t?t:this.defaultChannelReceivingWindowSize},i=this.formatter.serializeOfferParameters(n),s=new o.ChannelClass(this,!0,this.getUnusedChannelId(),n);return this.openChannels[s.id]=s,this.rejectOnFailure(this.sendFrameAsync(new l.FrameHeader(a.ControlCode.Offer,s.id),i,this.disposalToken)),s}acceptChannel(e,t){const n=this.openChannels[e];if(!n)throw new Error("No channel with ID "+e);return this.removeChannelFromOfferedQueue(n),this.acceptChannelOrThrow(n,t),n}rejectChannel(e){const t=this.openChannels[e];if(!t)throw new Error("No channel with that ID found.");d.removeFromQueue(t,this.channelsOfferedByThemByName[t.name]),s(t.acceptance),s(t.completion),t.dispose()}async offerChannelAsync(e,t,n=i.default.CONTINUE){var r;if(null==e)throw new Error("Name must be specified (but may be empty).");n.throwIfCancelled(),d.throwIfDisposed(this);const c={name:e,remoteWindowSize:null!==(r=null==t?void 0:t.channelReceivingWindowSize)&&void 0!==r?r:this.defaultChannelReceivingWindowSize},u=this.formatter.serializeOfferParameters(c),h=new o.ChannelClass(this,!0,this.getUnusedChannelId(),c);this.openChannels[h.id]=h;const f=new l.FrameHeader(a.ControlCode.Offer,h.id),p=n.onCancelled(e=>this.offerChannelCanceled(h,e));try{return s(h.acceptance),await this.sendFrameAsync(f,u,n),await h.acceptance,h}finally{p()}}async acceptChannelAsync(e,t,n=i.default.CONTINUE){if(null==e)throw new Error("Name must be specified (but may be empty).");let s,r;n.throwIfCancelled(),d.throwIfDisposed(this);const o=this.channelsOfferedByThemByName[e];if(o)for(;void 0===s&&o.length>0;)s=o.shift(),(s.isAccepted||s.isRejectedOrCanceled)&&(s=void 0);if(void 0===s){let n=this.acceptingChannels[e];n||(this.acceptingChannels[e]=n=[]),r=new c.Deferred(t),n.push(r)}if(void 0!==s)return this.acceptChannelOrThrow(s,t),s;{const t=n.onCancelled(t=>this.acceptChannelCanceled(r,e,t));try{return await r.promise}finally{t()}}}dispose(){this.disposalTokenSource.cancel(),this._completionSource.resolve(),this.formatter.end();for(const e in this.openChannels){const t=this.openChannels[e];s(t.acceptance),t.dispose()}}on(e,t){this.eventEmitter.on(e,t)}off(e,t){this.eventEmitter.off(e,t)}once(e,t){this.eventEmitter.once(e,t)}raiseChannelOffered(e,t,n){const i={id:e,isAccepted:n,name:t};try{this.eventEmitter.emit("channelOffered",i)}catch(e){this._completionSource.reject(e)}}acceptChannelOrThrow(e,t){var n,i;if(!e.tryAcceptOffer(t))throw e.isAccepted?new Error("Channel is already accepted."):e.isRejectedOrCanceled?new Error("Channel is no longer available for acceptance."):new Error("Channel could not be accepted.");{const s={remoteWindowSize:null!==(i=null!==(n=null==t?void 0:t.channelReceivingWindowSize)&&void 0!==n?n:e.localWindowSize)&&void 0!==i?i:this.defaultChannelReceivingWindowSize};s.remoteWindowSize<this.defaultChannelReceivingWindowSize&&(s.remoteWindowSize=this.defaultChannelReceivingWindowSize);const r=this.formatter.serializerAcceptanceParameters(s);this.rejectOnFailure(this.sendFrameAsync(new l.FrameHeader(a.ControlCode.OfferAccepted,e.id),r,this.disposalToken))}}async rejectOnFailure(e){try{await e}catch(e){this._completionSource.reject(e)}}removeChannelFromOfferedQueue(e){e.name&&d.removeFromQueue(e,this.channelsOfferedByThemByName[e.name])}acceptChannelCanceled(e,t,n){e.reject(new i.default.CancellationError(n))&&d.removeFromQueue(e,this.acceptingChannels[t])}offerChannelCanceled(e,t){e.tryCancelOffer(t)}getUnusedChannelId(){return this.lastOfferedChannelId+=2}}t.MultiplexingStream=p,p.framePayloadMaxLength=20480,p.recommendedDefaultChannelReceivingWindowSize=5*p.framePayloadMaxLength,p.defaultChannelOptions={},p.ControlFrameEncoding="utf-8";class m extends p{constructor(e,t,n){super(e,n),this.sendingSemaphore=new f.Semaphore(1),this.lastOfferedChannelId=t?-1:0,this.readFromStream(this.disposalToken).catch(e=>this._completionSource.reject(e))}get backpressureSupportEnabled(){return this.protocolMajorVersion>1}async sendFrameAsync(e,t,n=i.default.CONTINUE){if(!e)throw new Error("Header is required.");await this.sendingSemaphore.use(async()=>{n.throwIfCancelled(),d.throwIfDisposed(this),await this.formatter.writeFrameAsync(e,t)})}async sendFrame(e,t){try{if(this._completionSource.isCompleted)return;const n=new l.FrameHeader(e,t);await this.sendFrameAsync(n)}catch(e){this._completionSource.reject(e)}}onChannelWritingCompleted(e){!e.isDisposed&&this.openChannels[e.id]&&this.sendFrame(a.ControlCode.ContentWritingCompleted,e.id)}onChannelDisposed(e){this._completionSource.isCompleted||this.sendFrame(a.ControlCode.ChannelTerminated,e.id)}localContentExamined(e,t){const n=this.formatter.serializeContentProcessed(t);this.rejectOnFailure(this.sendFrameAsync(new l.FrameHeader(a.ControlCode.ContentProcessed,e.id),n))}async readFromStream(e){for(;!this.isDisposed;){const t=await this.formatter.readFrameAsync(e);if(null===t)break;switch(t.header.code){case a.ControlCode.Offer:this.onOffer(t.header.requiredChannelId,t.payload);break;case a.ControlCode.OfferAccepted:this.onOfferAccepted(t.header.requiredChannelId,t.payload);break;case a.ControlCode.Content:this.onContent(t.header.requiredChannelId,t.payload);break;case a.ControlCode.ContentProcessed:this.onContentProcessed(t.header.requiredChannelId,t.payload);break;case a.ControlCode.ContentWritingCompleted:this.onContentWritingCompleted(t.header.requiredChannelId);break;case a.ControlCode.ChannelTerminated:this.onChannelTerminated(t.header.requiredChannelId)}}this.dispose()}onOffer(e,t){const n=this.formatter.deserializeOfferParameters(t),i=new o.ChannelClass(this,!1,e,n);let s,r,a=!1;if(void 0!==(r=this.acceptingChannels[n.name]))for(;r.length>0;){const e=r.shift();if(e.resolve(i)){a=!0,s=e.state;break}}if(!a&&null!=n.name){let e;(e=this.channelsOfferedByThemByName[n.name])||(this.channelsOfferedByThemByName[n.name]=e=[]),e.push(i)}this.openChannels[e]=i,a&&this.acceptChannelOrThrow(i,s),this.raiseChannelOffered(i.id,i.name,a)}onOfferAccepted(e,t){const n=this.formatter.deserializerAcceptanceParameters(t),i=this.openChannels[e];if(!i)throw new Error("Unexpected channel created with ID "+e);i.onAccepted(n)}onContent(e,t){this.openChannels[e].onContent(t)}onContentProcessed(e,t){const n=this.openChannels[e],i=this.formatter.deserializeContentProcessed(t);n.onContentProcessed(i)}onContentWritingCompleted(e){this.openChannels[e].onContent(null)}onChannelTerminated(e){const t=this.openChannels[e];t&&(delete this.openChannels[e],this.removeChannelFromOfferedQueue(t),t.dispose())}}t.MultiplexingStreamClass=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MultiplexingStreamOptions=class{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(189);t.commentsSupported=i.commentsSupported,t.commentManagerFactory=i.commentManagerFactory;var s=n(542);t.HostCommentService=s.HostCommentService;var r=n(1307);t.CommentsTreeDataProvider=r.CommentsTreeDataProvider,t.CommentsViewItem=r.CommentsViewItem;var o=n(1309);t.HostCoauthorCommitMessageUpdater=o.HostCoauthorCommitMessageUpdater;var a=n(1310);t.HostSourceControlService=a.HostSourceControlService;var c=n(1313);t.reviewsDependencies=c.dependencies},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(185),s=n(74),r=n(110),o=n(0),a=n(30),c=n(1299),l=n(1300),u=n(1301),d=n(1302),h=n(1303),f=n(1304),p=n(71),m=n(1305),g=n(1306);var y,v,S,_,E,w,b;!function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(110)),function(e){e.is=function(e){return p.string(e.command)}}(y||(y={})),function(e){e[e.stdio=0]="stdio",e[e.ipc=1]="ipc",e[e.pipe=2]="pipe",e[e.socket=3]="socket"}(v=t.TransportKind||(t.TransportKind={})),function(e){e.isSocket=function(e){let t=e;return t&&t.kind===v.socket&&p.number(t.port)}}(S||(S={})),function(e){e.is=function(e){return p.string(e.module)}}(_||(_={})),function(e){e.is=function(e){let t=e;return t&&void 0!==t.writer&&void 0!==t.reader}}(E||(E={})),function(e){e.is=function(e){let t=e;return t&&void 0!==t.process&&"boolean"==typeof t.detached}}(w||(w={}));class C extends r.BaseLanguageClient{constructor(e,t,n,i,s){let r,o,a,c,l;p.string(t)?(r=e,o=t,a=n,c=i,l=!!s):(r=e.toLowerCase(),o=e,a=t,c=n,l=i),void 0===l&&(l=!1),super(r,o,c),this._serverOptions=a,this._forceDebug=l}stop(){return super.stop().then(()=>{if(this._serverProcess){let e=this._serverProcess;this._serverProcess=void 0,void 0!==this._isDetached&&this._isDetached||this.checkProcessDied(e),this._isDetached=void 0}})}checkProcessDied(t){t&&setTimeout(()=>{try{e.kill(t.pid,0),g.terminate(t)}catch(e){}},2e3)}handleConnectionClosed(){this._serverProcess=void 0,super.handleConnectionClosed()}createMessageTransports(t){let n,s=this._serverOptions;if(p.func(s))return s().then(e=>{if(r.MessageTransports.is(e))return this._isDetached=!!e.detached,e;if(E.is(e))return this._isDetached=!!e.detached,{reader:new a.StreamMessageReader(e.reader),writer:new a.StreamMessageWriter(e.writer)};{let n;return w.is(e)?(n=e.process,this._isDetached=e.detached):(n=e,this._isDetached=!1),n.stderr.on("data",e=>this.outputChannel.append(p.string(e)?e:e.toString(t))),{reader:new a.StreamMessageReader(n.stdout),writer:new a.StreamMessageWriter(n.stdin)}}});let o=s;return n=o.run||o.debug?"object"==typeof v8debug||this._forceDebug||function(){let t=e.execArgv;return!!t&&t.some(e=>/^--debug=?/.test(e)||/^--debug-brk=?/.test(e)||/^--inspect=?/.test(e)||/^--inspect-brk=?/.test(e))}()?o.debug:o.run:s,this._getServerWorkingDir(n.options).then(r=>{if(_.is(n)&&n.module){let s=n,o=s.transport||v.stdio;if(!s.runtime){let n=void 0;return new Promise((i,c)=>{let l=s.args&&s.args.slice()||[];o===v.ipc?l.push("--node-ipc"):o===v.stdio?l.push("--stdio"):o===v.pipe?(n=a.generateRandomPipeName(),l.push(`--pipe=${n}`)):S.isSocket(o)&&l.push(`--socket=${o.port}`),l.push(`--clientProcessId=${e.pid.toString()}`);let u=s.options||Object.create(null);u.execArgv=u.execArgv||[],u.cwd=r,o===v.ipc||o===v.stdio?m.fork(s.module,l||[],u,(e,n)=>{e||!n?c(e):(this._serverProcess=n,n.stderr.on("data",e=>this.outputChannel.append(p.string(e)?e:e.toString(t))),o===v.ipc?(n.stdout.on("data",e=>this.outputChannel.append(p.string(e)?e:e.toString(t))),i({reader:new a.IPCMessageReader(this._serverProcess),writer:new a.IPCMessageWriter(this._serverProcess)})):i({reader:new a.StreamMessageReader(n.stdout),writer:new a.StreamMessageWriter(n.stdin)}))}):o===v.pipe?a.createClientPipeTransport(n).then(e=>{m.fork(s.module,l||[],u,(n,s)=>{n||!s?c(n):(this._serverProcess=s,s.stderr.on("data",e=>this.outputChannel.append(p.string(e)?e:e.toString(t))),s.stdout.on("data",e=>this.outputChannel.append(p.string(e)?e:e.toString(t))),e.onConnected().then(e=>{i({reader:e[0],writer:e[1]})}))})}):S.isSocket(o)&&a.createClientSocketTransport(o.port).then(e=>{m.fork(s.module,l||[],u,(n,s)=>{n||!s?c(n):(this._serverProcess=s,s.stderr.on("data",e=>this.outputChannel.append(p.string(e)?e:e.toString(t))),s.stdout.on("data",e=>this.outputChannel.append(p.string(e)?e:e.toString(t))),e.onConnected().then(e=>{i({reader:e[0],writer:e[1]})}))})})})}{let n=[],c=s.options||Object.create(null);c.execArgv&&c.execArgv.forEach(e=>n.push(e)),n.push(s.module),s.args&&s.args.forEach(e=>n.push(e));let l=Object.create(null);l.cwd=r,l.env=function(t){if(!t)return e.env;let n=Object.create(null);return Object.keys(e.env).forEach(t=>n[t]=e.env[t]),Object.keys(t).forEach(e=>n[e]=t[e]),n}(c.env);let u=void 0;if(o===v.ipc?(l.stdio=[null,null,null,"ipc"],n.push("--node-ipc")):o===v.stdio?n.push("--stdio"):o===v.pipe?(u=a.generateRandomPipeName(),n.push(`--pipe=${u}`)):S.isSocket(o)&&n.push(`--socket=${o.port}`),n.push(`--clientProcessId=${e.pid.toString()}`),o===v.ipc||o===v.stdio){let e=i.spawn(s.runtime,n,l);return e&&e.pid?(this._serverProcess=e,e.stderr.on("data",e=>this.outputChannel.append(p.string(e)?e:e.toString(t))),o===v.ipc?(e.stdout.on("data",e=>this.outputChannel.append(p.string(e)?e:e.toString(t))),Promise.resolve({reader:new a.IPCMessageReader(e),writer:new a.IPCMessageWriter(e)})):Promise.resolve({reader:new a.StreamMessageReader(e.stdout),writer:new a.StreamMessageWriter(e.stdin)})):Promise.reject(`Launching server using runtime ${s.runtime} failed.`)}if(o==v.pipe)return a.createClientPipeTransport(u).then(e=>{let r=i.spawn(s.runtime,n,l);return r&&r.pid?(this._serverProcess=r,r.stderr.on("data",e=>this.outputChannel.append(p.string(e)?e:e.toString(t))),r.stdout.on("data",e=>this.outputChannel.append(p.string(e)?e:e.toString(t))),e.onConnected().then(e=>({reader:e[0],writer:e[1]}))):Promise.reject(`Launching server using runtime ${s.runtime} failed.`)});if(S.isSocket(o))return a.createClientSocketTransport(o.port).then(e=>{let r=i.spawn(s.runtime,n,l);return r&&r.pid?(this._serverProcess=r,r.stderr.on("data",e=>this.outputChannel.append(p.string(e)?e:e.toString(t))),r.stdout.on("data",e=>this.outputChannel.append(p.string(e)?e:e.toString(t))),e.onConnected().then(e=>({reader:e[0],writer:e[1]}))):Promise.reject(`Launching server using runtime ${s.runtime} failed.`)})}}else if(y.is(n)&&n.command){let e=n,s=e.args||[],o=Object.assign({},e.options);o.cwd=o.cwd||r;let c=i.spawn(e.command,s,o);return c&&c.pid?(c.stderr.on("data",e=>this.outputChannel.append(p.string(e)?e:e.toString(t))),this._serverProcess=c,this._isDetached=!!o.detached,Promise.resolve({reader:new a.StreamMessageReader(c.stdout),writer:new a.StreamMessageWriter(c.stdin)})):Promise.reject(`Launching server using command ${e.command} failed.`)}return Promise.reject(new Error("Unsupported server configuration "+JSON.stringify(s,null,4)))})}registerProposedFeatures(){this.registerFeatures(b.createAll(this))}registerBuiltinFeatures(){super.registerBuiltinFeatures(),this.registerFeature(new l.ConfigurationFeature(this)),this.registerFeature(new d.TypeDefinitionFeature(this)),this.registerFeature(new u.ImplementationFeature(this)),this.registerFeature(new c.ColorProviderFeature(this)),this.registerFeature(new h.WorkspaceFoldersFeature(this)),this.registerFeature(new f.FoldingRangeFeature(this))}_mainGetRootPath(){let e=o.workspace.workspaceFolders;if(!e||0===e.length)return;let t=e[0];return"file"===t.uri.scheme?t.uri.fsPath:void 0}_getServerWorkingDir(e){let t=e&&e.cwd;return t||(t=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath()),t?new Promise(e=>{s.lstat(t,(n,i)=>{e(!n&&i.isDirectory()?t:void 0)})}):Promise.resolve(void 0)}}t.LanguageClient=C;t.SettingMonitor=class{constructor(e,t){this._client=e,this._setting=t,this._listeners=[]}start(){return o.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new o.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let e=this._setting.indexOf("."),t=e>=0?this._setting.substr(0,e):this._setting,n=e>=0?this._setting.substr(e+1):void 0,i=n?o.workspace.getConfiguration(t).get(n,!1):o.workspace.getConfiguration(t);i&&this._client.needsStart()?this._client.start():!i&&this._client.needsStop()&&this._client.stop()}},function(e){e.createAll=function(e){return[]}}(b=t.ProposedFeatures||(t.ProposedFeatures={}))}).call(this,n(11))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(190),s=n(150);let r=e.from("\r","ascii")[0],o=e.from("\n","ascii")[0];class a{constructor(t="utf8"){this.encoding=t,this.index=0,this.buffer=e.allocUnsafe(8192)}append(t){var n=t;if("string"==typeof t){var i=t,s=e.byteLength(i,this.encoding);(n=e.allocUnsafe(s)).write(i,0,s,this.encoding)}if(this.buffer.length-this.index>=n.length)n.copy(this.buffer,this.index,0,n.length);else{var r=8192*(Math.ceil((this.index+n.length)/8192)+1);0===this.index?(this.buffer=e.allocUnsafe(r),n.copy(this.buffer,0,0,n.length)):this.buffer=e.concat([this.buffer.slice(0,this.index),n],r)}this.index+=n.length}tryReadHeaders(){let e=void 0,t=0;for(;t+3<this.index&&(this.buffer[t]!==r||this.buffer[t+1]!==o||this.buffer[t+2]!==r||this.buffer[t+3]!==o);)t++;if(t+3>=this.index)return e;e=Object.create(null),this.buffer.toString("ascii",0,t).split("\r\n").forEach(t=>{let n=t.indexOf(":");if(-1===n)throw new Error("Message header must separate key and value using :");let i=t.substr(0,n),s=t.substr(n+1).trim();e[i]=s});let n=t+4;return this.buffer=this.buffer.slice(n),this.index=this.index-n,e}tryReadContent(e){if(this.index<e)return null;let t=this.buffer.toString(this.encoding,0,e),n=e;return this.buffer.copy(this.buffer,0,n),this.index=this.index-n,t}get numberOfBytes(){return this.index}}!function(e){e.is=function(e){let t=e;return t&&s.func(t.listen)&&s.func(t.dispose)&&s.func(t.onError)&&s.func(t.onClose)&&s.func(t.onPartialMessage)}}(t.MessageReader||(t.MessageReader={}));class c{constructor(){this.errorEmitter=new i.Emitter,this.closeEmitter=new i.Emitter,this.partialMessageEmitter=new i.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${s.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=c;class l extends c{constructor(e,t="utf8"){super(),this.readable=e,this.buffer=new a(t),this._partialMessageTimeout=1e4}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e,this.readable.on("data",e=>{this.onData(e)}),this.readable.on("error",e=>this.fireError(e)),this.readable.on("close",()=>this.fireClose())}onData(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){let e=this.buffer.tryReadHeaders();if(!e)return;let t=e["Content-Length"];if(!t)throw new Error("Header must provide a Content-Length property.");let n=parseInt(t);if(isNaN(n))throw new Error("Content-Length value must be a number.");this.nextMessageLength=n}var t=this.buffer.tryReadContent(this.nextMessageLength);if(null===t)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.messageToken++;var n=JSON.parse(t);this.callback(n)}}clearPartialMessageTimer(){this.partialMessageTimer&&(clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}t.StreamMessageReader=l;t.IPCMessageReader=class extends c{constructor(e){super(),this.process=e;let t=this.process;t.on("error",e=>this.fireError(e)),t.on("close",()=>this.fireClose())}listen(e){this.process.on("message",e)}};t.SocketMessageReader=class extends l{constructor(e,t="utf-8"){super(e,t)}}}).call(this,n(3).Buffer)},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(190),s=n(150);!function(e){e.is=function(e){let t=e;return t&&s.func(t.dispose)&&s.func(t.onClose)&&s.func(t.onError)&&s.func(t.write)}}(t.MessageWriter||(t.MessageWriter={}));class r{constructor(){this.errorEmitter=new i.Emitter,this.closeEmitter=new i.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${s.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=r;t.StreamMessageWriter=class extends r{constructor(e,t="utf8"){super(),this.writable=e,this.encoding=t,this.errorCount=0,this.writable.on("error",e=>this.fireError(e)),this.writable.on("close",()=>this.fireClose())}write(t){let n=JSON.stringify(t),i=["Content-Length: ",e.byteLength(n,this.encoding).toString(),"\r\n","\r\n"];try{this.writable.write(i.join(""),"ascii"),this.writable.write(n,this.encoding),this.errorCount=0}catch(e){this.errorCount++,this.fireError(e,t,this.errorCount)}}};t.IPCMessageWriter=class extends r{constructor(e){super(),this.process=e,this.errorCount=0,this.queue=[],this.sending=!1;let t=this.process;t.on("error",e=>this.fireError(e)),t.on("close",()=>this.fireClose)}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){try{this.process.send&&(this.sending=!0,this.process.send(e,void 0,void 0,t=>{this.sending=!1,t?(this.errorCount++,this.fireError(t,e,this.errorCount)):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())}))}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}};t.SocketMessageWriter=class extends r{constructor(e,t="utf8"){super(),this.socket=e,this.queue=[],this.sending=!1,this.encoding=t,this.errorCount=0,this.socket.on("error",e=>this.fireError(e)),this.socket.on("close",()=>this.fireClose())}dispose(){super.dispose(),this.socket.destroy()}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(t){let n=JSON.stringify(t),i=["Content-Length: ",e.byteLength(n,this.encoding).toString(),"\r\n","\r\n"];try{this.sending=!0,this.socket.write(i.join(""),"ascii",e=>{e&&this.handleError(e,t);try{this.socket.write(n,this.encoding,e=>{this.sending=!1,e?this.handleError(e,t):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())})}catch(e){this.handleError(e,t)}})}catch(e){this.handleError(e,t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}}}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(30),r=n(71),o=n(544),a=n(545),c=n(546);var l;!function(e){e.is=function(e){let t=e;return t&&r.string(t.language)&&r.string(t.value)}}(l||(l={})),t.createConverter=function(e){const t=e||(e=>i.Uri.parse(e));function n(e){return t(e)}function u(e){return e.map(d)}function d(e){let t=new i.Diagnostic(p(e.range),e.message,m(e.severity));return(r.number(e.code)||r.string(e.code))&&(t.code=e.code),e.source&&(t.source=e.source),e.relatedInformation&&(t.relatedInformation=e.relatedInformation.map(h)),t}function h(e){return new i.DiagnosticRelatedInformation(C(e.location),e.message)}function f(e){if(e)return new i.Position(e.line,e.character)}function p(e){if(e)return new i.Range(f(e.start),f(e.end))}function m(e){if(null==e)return i.DiagnosticSeverity.Error;switch(e){case s.DiagnosticSeverity.Error:return i.DiagnosticSeverity.Error;case s.DiagnosticSeverity.Warning:return i.DiagnosticSeverity.Warning;case s.DiagnosticSeverity.Information:return i.DiagnosticSeverity.Information;case s.DiagnosticSeverity.Hint:return i.DiagnosticSeverity.Hint}return i.DiagnosticSeverity.Error}function g(e){if(r.string(e))return e;switch(e.kind){case s.MarkupKind.Markdown:return new i.MarkdownString(e.value);case s.MarkupKind.PlainText:return e.value;default:return`Unsupported Markup content received. Kind is: ${e.kind}`}}function y(e){let t=new o.default(e.label);e.detail&&(t.detail=e.detail),e.documentation&&(t.documentation=g(e.documentation),t.documentationFormat=r.string(e.documentation)?"$string":e.documentation.kind),e.filterText&&(t.filterText=e.filterText);let n=function(e){return e.textEdit?e.insertTextFormat===s.InsertTextFormat.Snippet?{text:new i.SnippetString(e.textEdit.newText),range:p(e.textEdit.range),fromEdit:!0}:{text:e.textEdit.newText,range:p(e.textEdit.range),fromEdit:!0}:e.insertText?e.insertTextFormat===s.InsertTextFormat.Snippet?{text:new i.SnippetString(e.insertText),fromEdit:!1}:{text:e.insertText,fromEdit:!1}:void 0}(e);if(n&&(t.insertText=n.text,t.range=n.range,t.fromEdit=n.fromEdit),r.number(e.kind)){let[n,r]=(a=e.kind,s.CompletionItemKind.Text<=a&&a<=s.CompletionItemKind.TypeParameter?[a-1,void 0]:[i.CompletionItemKind.Text,a]);t.kind=n,r&&(t.originalItemKind=r)}var a;return e.sortText&&(t.sortText=e.sortText),e.additionalTextEdits&&(t.additionalTextEdits=S(e.additionalTextEdits)),r.stringArray(e.commitCharacters)&&(t.commitCharacters=e.commitCharacters.slice()),e.command&&(t.command=P(e.command)),!0!==e.deprecated&&!1!==e.deprecated||(t.deprecated=e.deprecated),!0!==e.preselect&&!1!==e.preselect||(t.preselect=e.preselect),void 0!==e.data&&(t.data=e.data),t}function v(e){if(e)return new i.TextEdit(p(e.range),e.newText)}function S(e){if(e)return e.map(v)}function _(e){return e.map(E)}function E(e){let t=new i.SignatureInformation(e.label);return e.documentation&&(t.documentation=g(e.documentation)),e.parameters&&(t.parameters=w(e.parameters)),t}function w(e){return e.map(b)}function b(e){let t=new i.ParameterInformation(e.label);return e.documentation&&(t.documentation=g(e.documentation)),t}function C(e){if(e)return new i.Location(t(e.uri),p(e.range))}function T(e){let t=new i.DocumentHighlight(p(e.range));return r.number(e.kind)&&(t.kind=M(e.kind)),t}function M(e){switch(e){case s.DocumentHighlightKind.Text:return i.DocumentHighlightKind.Text;case s.DocumentHighlightKind.Read:return i.DocumentHighlightKind.Read;case s.DocumentHighlightKind.Write:return i.DocumentHighlightKind.Write}return i.DocumentHighlightKind.Text}function A(e){return e<=s.SymbolKind.TypeParameter?e-1:i.SymbolKind.Property}function k(e,n){let s=new i.SymbolInformation(e.name,A(e.kind),p(e.location.range),e.location.uri?t(e.location.uri):n);return e.containerName&&(s.containerName=e.containerName),s}function R(e){let t=new i.DocumentSymbol(e.name,e.detail||"",A(e.kind),p(e.range),p(e.selectionRange));if(void 0!==e.children&&e.children.length>0){let n=[];for(let t of e.children)n.push(R(t));t.children=n}return t}function P(e){let t={title:e.title,command:e.command};return e.arguments&&(t.arguments=e.arguments),t}const I=new Map;function N(e){if(!e)return;let t=new a.default(p(e.range));return e.command&&(t.command=P(e.command)),void 0!==e.data&&null!==e.data&&(t.data=e.data),t}function L(e){if(!e)return;let n=new i.WorkspaceEdit;return e.documentChanges?e.documentChanges.forEach(e=>{n.set(t(e.textDocument.uri),S(e.edits))}):e.changes&&Object.keys(e.changes).forEach(i=>{n.set(t(i),S(e.changes[i]))}),n}function D(e){let t=p(e.range),i=e.target?n(e.target):void 0,s=new c.default(t,i);return void 0!==e.data&&null!==e.data&&(s.data=e.data),s}function x(e){return new i.Color(e.red,e.green,e.blue,e.alpha)}function O(e){return new i.ColorInformation(p(e.range),x(e.color))}function F(e){let t=new i.ColorPresentation(e.label);return t.additionalTextEdits=S(e.additionalTextEdits),e.textEdit&&(t.textEdit=v(e.textEdit)),t}function U(e){if(e)switch(e){case s.FoldingRangeKind.Comment:return i.FoldingRangeKind.Comment;case s.FoldingRangeKind.Imports:return i.FoldingRangeKind.Imports;case s.FoldingRangeKind.Region:return i.FoldingRangeKind.Region}}function j(e){return new i.FoldingRange(e.startLine,e.endLine,U(e.kind))}return I.set("",i.CodeActionKind.Empty),I.set(s.CodeActionKind.QuickFix,i.CodeActionKind.QuickFix),I.set(s.CodeActionKind.Refactor,i.CodeActionKind.Refactor),I.set(s.CodeActionKind.RefactorExtract,i.CodeActionKind.RefactorExtract),I.set(s.CodeActionKind.RefactorInline,i.CodeActionKind.RefactorInline),I.set(s.CodeActionKind.RefactorRewrite,i.CodeActionKind.RefactorRewrite),I.set(s.CodeActionKind.Source,i.CodeActionKind.Source),I.set(s.CodeActionKind.SourceOrganizeImports,i.CodeActionKind.SourceOrganizeImports),{asUri:n,asDiagnostics:u,asDiagnostic:d,asRange:p,asPosition:f,asDiagnosticSeverity:m,asHover:function(e){if(e)return new i.Hover(function(e){if(r.string(e))return new i.MarkdownString(e);if(l.is(e)){return(new i.MarkdownString).appendCodeblock(e.value,e.language)}if(Array.isArray(e)){let t=[];for(let n of e){let e=new i.MarkdownString;l.is(n)?e.appendCodeblock(n.value,n.language):e.appendMarkdown(n),t.push(e)}return t}{let t;switch(e.kind){case s.MarkupKind.Markdown:return new i.MarkdownString(e.value);case s.MarkupKind.PlainText:return t=new i.MarkdownString,t.appendText(e.value),t;default:return t=new i.MarkdownString,t.appendText(`Unsupported Markup content received. Kind is: ${e.kind}`),t}}}(e.contents),p(e.range))},asCompletionResult:function(e){if(!e)return;if(Array.isArray(e)){return e.map(y)}let t=e;return new i.CompletionList(t.items.map(y),t.isIncomplete)},asCompletionItem:y,asTextEdit:v,asTextEdits:S,asSignatureHelp:function(e){if(!e)return;let t=new i.SignatureHelp;return r.number(e.activeSignature)?t.activeSignature=e.activeSignature:t.activeSignature=0,r.number(e.activeParameter)?t.activeParameter=e.activeParameter:t.activeParameter=0,e.signatures&&(t.signatures=_(e.signatures)),t},asSignatureInformations:_,asSignatureInformation:E,asParameterInformations:w,asParameterInformation:b,asDefinitionResult:function(e){if(e)return r.array(e)?e.map(e=>C(e)):C(e)},asLocation:C,asReferences:function(e){if(e)return e.map(e=>C(e))},asDocumentHighlights:function(e){if(e)return e.map(T)},asDocumentHighlight:T,asDocumentHighlightKind:M,asSymbolInformations:function(e,t){if(e)return e.map(e=>k(e,t))},asSymbolInformation:k,asDocumentSymbols:function(e){if(null!=e)return e.map(R)},asDocumentSymbol:R,asCommand:P,asCommands:function(e){if(e)return e.map(P)},asCodeAction:function(e){if(null==e)return;let t=new i.CodeAction(e.title);return void 0!==e.kind&&(t.kind=function(e){if(null==e)return;let t=I.get(e);if(t)return t;let n=e.split(".");t=i.CodeActionKind.Empty;for(let e of n)t=t.append(e);return t}(e.kind)),e.diagnostics&&(t.diagnostics=u(e.diagnostics)),e.edit&&(t.edit=L(e.edit)),e.command&&(t.command=P(e.command)),t},asCodeLens:N,asCodeLenses:function(e){if(e)return e.map(e=>N(e))},asWorkspaceEdit:L,asDocumentLink:D,asDocumentLinks:function(e){if(e)return e.map(D)},asFoldingRangeKind:U,asFoldingRange:j,asFoldingRanges:function(e){if(Array.isArray(e))return e.map(j)},asColor:x,asColorInformation:O,asColorInformations:function(e){if(Array.isArray(e))return e.map(O)},asColorPresentation:F,asColorPresentations:function(e){if(Array.isArray(e))return e.map(F)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(309),r=n(1320),o=n(28),a=n(1321);t.REMOTE_COMMAND_NAME="_liveshare.remotecommand",t.REMOTE_CODE_LENS_NAME="liveshare.remotecodelens",t.REMOTE_CODE_ACTION_NAME="liveshare.remotecodeaction";const c=["vscode.open","editor.action.showReferences","merge-conflict.compare"],l={};function u(e,n,i){let s={title:e.title,command:t.REMOTE_COMMAND_NAME,tooltip:e.tooltip,arguments:n};return i.asCommand(s)}function d(e){let t;try{t=JSON.stringify(e)}catch(n){t=r.stringify(e)}const n=o.createHmac("sha256","key");return n.update(t),n.digest("hex")}function h(e,t,n,i,s){if(c.indexOf(t.command)>=0){const e=l[t.command];return e&&(t=e.toProtocol(t,n,i)),u(t,[t],n)}{let i=[e,d(t)];return s&&(i=i.concat(s)),u(t,[{title:"DummyTitle",command:"NotALocalCommand",arguments:i}],n)}}t.isSafeCommand=function(e){return e.startsWith("vscode")||e.startsWith("editor")},t.hashCommand=d,t.wrapCodeLensCommand=function(e,n,i,s){return h(t.REMOTE_CODE_LENS_NAME,e,i,s,[i.asUri(n)])},t.wrapCodeActionCommand=function(e,n,i,s,r){return h(t.REMOTE_CODE_ACTION_NAME,e,s,r,[s.asUri(n),s.asRange(i)])},t.handleLiveShareRemoteCommand=async function(e,t,n){if(e.command){let r=e;c.indexOf(r.command)>=0?function(e,t){const n=l[e.command];n&&(e=n.toCode(e,t));let s=e.arguments||[];i.commands.executeCommand(e.command,...s)}(r,n):await async function(e,t){let n={command:e.command,arguments:e.arguments};const r=await t.sendRequest(s.ExecuteCommandRequest.type,n);if("boolean"==typeof r&&!r){await i.window.showErrorMessage("The host doesnt allow running this command. If needed, ask them to enable it.","More info")&&i.env.openExternal(i.Uri.parse("https://aka.ms/vsls-security#code-commands"))}}(r,t)}else if(e.edit){let t=e.edit;i.workspace.applyEdit(n.asWorkspaceEdit(t))}};const f={toProtocol:(e,t,n)=>{let i=e.arguments[0],s=e.arguments[1],r=e.arguments[2];return e.arguments[0]=t.asUri(i),e.arguments[1]=t.asPosition(s),e.arguments[2]=r.map(e=>n.asLocation(e)),e},toCode:(e,t)=>{let n=e.arguments[0],i=e.arguments[1],s=e.arguments[2];return e.arguments[0]=t.asUri(n),e.arguments[1]=t.asPosition(i),e.arguments[2]=s.map(e=>a.asLocation(e,t)),e}};l["vscode.open"]={toProtocol:(e,t,n)=>{let i=e.arguments[0];return e.arguments[0]=t.asUri(i),e},toCode:(e,t)=>{let n=e.arguments[0];return e.arguments[0]=t.asUri(n),e}},l["editor.action.showReferences"]=f,l["merge-conflict.compare"]={toProtocol:(e,t,n)=>{const i=t.asRange(e.arguments[0].current.content),s=t.asRange(e.arguments[0].incoming.content);return e.arguments=[i,s],e},toCode:(e,t)=>(e.arguments=[{current:{content:t.asRange(e.arguments[0])},incoming:{content:t.asRange(e.arguments[1])}}],e)}},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.id="id",e.prompt="prompt"}(i=t.MetadataKey||(t.MetadataKey={}));class s{constructor(e,t,n){this.terminal=e,this.own=t,this.workers=n,this.metadata={}}dispose(){this.workers.forEach(e=>e.dispose()),this.own&&this.terminal.dispose()}get(e){return this.metadata[e]}update(e,t){this.metadata[e]=t}}t.TerminalEntry=s;t.TerminalCache=class{constructor(){this.terminalEntries=[]}clean(e){if(e){this.terminalEntries.filter(e=>e.own).map(e=>e.terminal).forEach(e=>this.remove(e));for(const e of this.terminalEntries)e.workers.splice(0).forEach(e=>e.dispose())}else{this.terminalEntries.splice(0).forEach(e=>e.dispose())}}has(e){return!!this.terminalEntries.find(t=>t.terminal===e)}get(e){return this.terminalEntries.find(t=>t.terminal===e)}hasId(e){return!!this.terminalEntries.find(t=>t.get(i.id)===`${e}`)}getById(e){return this.terminalEntries.find(t=>t.get(i.id)===`${e}`)}register(e,t,n,...r){let o;return this.has(e)?(o=this.get(e),o.own=n||o.own,o.workers.push(...r)):(o=new s(e,n,r),this.terminalEntries.push(o)),null!==t&&o.update(i.id,`${t}`),o}remove(e){const t=this.terminalEntries.findIndex(t=>t.terminal===e);if(-1!==t){this.terminalEntries[t].dispose(),this.terminalEntries.splice(t,1)}}},t.isTaskTerminal=function(e){return!!e.name&&e.name.startsWith("Task")},t.isSharedTerminal=function(e){return!!e.name&&e.name.endsWith("[Shared]")}},function(e,t,n){"use strict";n.r(t),n.d(t,"HttpClient",(function(){return C})),n.d(t,"HttpError",(function(){return g})),n.d(t,"HttpClientError",(function(){return y})),n.d(t,"HttpClientAuthenticationError",(function(){return v})),n.d(t,"HttpClientResponseError",(function(){return S})),n.d(t,"HttpCancellationError",(function(){return _}));var i=n(316),s=n.n(i),r=n(700);const o={fetch:void 0,Request:void 0,AbortController:void 0},{fetch:a,Request:c,AbortController:l}="undefined"!=typeof self?self:"undefined"!=typeof window?window:o;var u=null!=a?a:s.a,d=null!=c?c:i.Request,h=null!=l?l:r.AbortController;function f(e){const t=new h;e.isCancellationRequested&&t.abort();const n=e.onCancellationRequested(()=>{n.dispose(),t.abort()});return t.signal}var p=n(8);function m(e){const t=new p.CancellationTokenSource,n=setTimeout(()=>{t.cancel()},e);return{cancel:t.cancel.bind(t),dispose(){clearTimeout(n),t.dispose()},token:t.token}}class g extends Error{constructor(){super(...arguments),this.errorType="HttpError"}}class y extends g{constructor(e){if(super(e),this.errorType="HttpClientError",e instanceof y)return e;let t;t=e instanceof Error?e.message:"string"==typeof e?e:"",this.message=t,this.name="HttpClientError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,y)}}class v extends g{constructor(e){super(`Request failed with status code ${e.status}.`),this.response=e,this.errorType="HttpClientAuthenticationError",this.name="HttpClientAuthenticationError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,v)}}class S extends g{constructor(e){super(`Request failed with status code ${e.status}.`),this.response=e,this.errorType="HttpClientResponseError",this.name="HttpClientResponseError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,S)}}class _ extends g{constructor(e){super(e),this.errorType="HttpCancellationError",this.name="CancellationError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,_)}}class E{constructor(e,t,n,i,s){var r;this.logger=e,this.configuration=t,this.request=n,this.init=i,this.cancellationToken=s,this.retry=0,this.input=this.request instanceof URL?this.request.toString():this.request;let o="GET";"string"!=typeof this.input&&(o=this.input.method),(null===(r=this.init)||void 0===r?void 0:r.method)&&(o=this.init.method),this.method=o,this.url="string"==typeof this.input?this.input:this.input.url}then(e,t){return this.fetch().then(e,t)}async text(){const e=await this.fetchWithCancellationCheck();return await e.text()}async json(){const e=await this.fetchWithCancellationCheck();return await e.json()}async arrayBuffer(){const e=await this.fetchWithCancellationCheck();return await e.arrayBuffer()}async blob(){const e=await this.fetchWithCancellationCheck();return await e.blob()}async formData(){const e=await this.fetchWithCancellationCheck();return await e.formData()}async value(){return await this.json()}async fetch(){var e;if(this.logger.verbose(`${this.method} - fetch start`),null===(e=this.cancellationToken)||void 0===e?void 0:e.isCancellationRequested)throw new _;const t=await this.prepareRequest();return this.ongoingPromise=this.retryRequest(t),await this.ongoingPromise}async fetchWithCancellationCheck(){var e;const t=await this.fetch();if(null===(e=this.cancellationToken)||void 0===e?void 0:e.isCancellationRequested)throw new _;return t}async makeRequest(e){let t;try{t=await u(e),this.logger.verbose(`${this.method} - fetch response. (url=${this.url};status=${t.status})`)}catch(e){if("AbortError"===e.name)throw this.logger.verbose(`${this.method} - fetch cancelled. (url=${this.url};cancelled=true)`),new _(e.message);throw this.logger.verbose(`${this.method} - fetch failed. (url=${this.url};reason=${e.message};failed=true)`),new y(e)}if(this.configuration.throwOnErrorStatus&&(401===t.status||403===t.status))throw new v(t);if(this.configuration.throwOnErrorStatus&&!t.ok)throw new S(t);return t}async retryRequest(e){try{return await this.makeRequest(e)}catch(t){if(!this.shouldRetry(t))throw t;const n=await this.prepareRetryRequest(e,t.response);return await this.delayRetry(t),this.retry++,await this.retryRequest(n)}}shouldRetry(e){return!(this.retry>=this.configuration.retryCount)&&!!(e instanceof S&&e.response&&this.configuration.retryStatusCodes.includes(e.response.status))}delayRetry(e){let t=1e3*this.retry;if(e instanceof S){const n=e.response.headers.get("Retry-After");if(null!==n){let e=Number(n);isNaN(e)?e=Math.max(Date.parse(n)-Date.now(),0):e*=1e3,isNaN(e)||(t=Math.max(t,e))}}return new Promise(e=>{setTimeout(e,t)})}async prepareRequest(){var e;let t=new d(this.input,Object.assign({credentials:"same-origin"},this.init));this.configuration.beforeRequest&&(t=await this.configuration.beforeRequest(t));const n=null!==(e=this.cancellationToken)&&void 0!==e?e:m(this.configuration.timeout).token;return new d(t,{signal:f(n)})}async prepareRetryRequest(e,t){var n;let i=e;if(this.configuration.beforeRetry){const n=await this.configuration.beforeRetry(e,t,this.retry);Array.isArray(n)?(this.retry=n[1],i=n[0]):i=n}const s=null!==(n=this.cancellationToken)&&void 0!==n?n:m(this.configuration.timeout).token;return new d(i,{signal:f(s)})}}const w={requestNumber:1},b={timeout:3e4,throwOnErrorStatus:!0,beforeRequest:void 0,beforeRetry:void 0,retryCount:2,retryStatusCodes:[429,500,503]};class C{constructor(e,t={}){this.logger=e,this.configuration=Object.assign(Object.assign({},b),t)}fetch(e,t,n){return new E(this.logger.withName(`FetchRequest:${w.requestNumber++}`),this.configuration,e,t,n)}method(e,t,n,i){return this.fetch(t,Object.assign(Object.assign({},n),{method:e}),i)}get(e,t,n){return this.method("GET",e,t,n)}post(e,t,n){return this.method("POST",e,t,n)}put(e,t,n){return this.method("PUT",e,t,n)}patch(e,t,n){return this.method("PATCH",e,t,n)}head(e,t,n){return this.method("HEAD",e,t,n)}delete(e,t,n){return this.method("DELETE",e,t,n)}}},function(e,t,n){"use strict";var i=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==i)return i;throw new Error("unable to locate global object")}();e.exports=t=i.fetch,t.default=i.fetch.bind(i),t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(706);t.DebugConsoleLogger=i.DebugConsoleLogger},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(112),s=n(113),r=n(151);class o extends r.TraceListener{constructor(e=console){super(),this.consoleReference=e}writeTo(e){this.consoleReference.log(e)}writeEvent(e,t,n,r,...o){const a=s.TraceFormat.formatEvent(null,e,t,n,r,...o);switch(t){case i.LogLevel.Critical:case i.LogLevel.Error:return this.consoleReference.error(a);case i.LogLevel.Warning:return this.consoleReference.warn(a);case i.LogLevel.Debug:return this.consoleReference.debug?this.consoleReference.debug(a):this.consoleReference.log(a);default:return this.consoleReference.log(a)}}}t.ConsoleTraceListener=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(711);class s{static setKey(e){s.privacyKey=e}static getShortHash(e,t=8,n=!1){return this.getHash(e,n).substr(0,t)}static getHash(e,t=!1){if(!e)return"<null>";let n;if(t)n=i.sha256.create();else{if(!s.privacyKey)return"<redacted>";n=i.sha256.hmac.create(s.privacyKey)}return n.update(e).hex()}static getSha256Hash(e,t){const n=i.sha256.create().update((new TextEncoder).encode(e||"")).toString();return"number"==typeof t&&t>0&&n.length>t?n.substr(0,t):n}}t.Privacy=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(195);class s{}t.LoggerSettings=s,s.disableObfuscation=!1,s.obfuscateProperties={email:i.LogValueType.Email,name:i.LogValueType.Text,token:i.LogValueType.Text,sessionToken:i.LogValueType.Text}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(713);t.errorToString=i.errorToString},function(e,t,n){var i=n(323),s=n(114),r=n(324).ArraySet,o=n(717).MappingList;function a(e){e||(e={}),this._file=s.getArg(e,"file",null),this._sourceRoot=s.getArg(e,"sourceRoot",null),this._skipValidation=s.getArg(e,"skipValidation",!1),this._sources=new r,this._names=new r,this._mappings=new o,this._sourcesContents=null}a.prototype._version=3,a.fromSourceMap=function(e){var t=e.sourceRoot,n=new a({file:e.file,sourceRoot:t});return e.eachMapping((function(e){var i={generated:{line:e.generatedLine,column:e.generatedColumn}};null!=e.source&&(i.source=e.source,null!=t&&(i.source=s.relative(t,i.source)),i.original={line:e.originalLine,column:e.originalColumn},null!=e.name&&(i.name=e.name)),n.addMapping(i)})),e.sources.forEach((function(i){var r=i;null!==t&&(r=s.relative(t,i)),n._sources.has(r)||n._sources.add(r);var o=e.sourceContentFor(i);null!=o&&n.setSourceContent(i,o)})),n},a.prototype.addMapping=function(e){var t=s.getArg(e,"generated"),n=s.getArg(e,"original",null),i=s.getArg(e,"source",null),r=s.getArg(e,"name",null);this._skipValidation||this._validateMapping(t,n,i,r),null!=i&&(i=String(i),this._sources.has(i)||this._sources.add(i)),null!=r&&(r=String(r),this._names.has(r)||this._names.add(r)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:null!=n&&n.line,originalColumn:null!=n&&n.column,source:i,name:r})},a.prototype.setSourceContent=function(e,t){var n=e;null!=this._sourceRoot&&(n=s.relative(this._sourceRoot,n)),null!=t?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[s.toSetString(n)]=t):this._sourcesContents&&(delete this._sourcesContents[s.toSetString(n)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))},a.prototype.applySourceMap=function(e,t,n){var i=t;if(null==t){if(null==e.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');i=e.file}var o=this._sourceRoot;null!=o&&(i=s.relative(o,i));var a=new r,c=new r;this._mappings.unsortedForEach((function(t){if(t.source===i&&null!=t.originalLine){var r=e.originalPositionFor({line:t.originalLine,column:t.originalColumn});null!=r.source&&(t.source=r.source,null!=n&&(t.source=s.join(n,t.source)),null!=o&&(t.source=s.relative(o,t.source)),t.originalLine=r.line,t.originalColumn=r.column,null!=r.name&&(t.name=r.name))}var l=t.source;null==l||a.has(l)||a.add(l);var u=t.name;null==u||c.has(u)||c.add(u)}),this),this._sources=a,this._names=c,e.sources.forEach((function(t){var i=e.sourceContentFor(t);null!=i&&(null!=n&&(t=s.join(n,t)),null!=o&&(t=s.relative(o,t)),this.setSourceContent(t,i))}),this)},a.prototype._validateMapping=function(e,t,n,i){if(t&&"number"!=typeof t.line&&"number"!=typeof t.column)throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if((!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0)||t||n||i)&&!(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&n))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:n,original:t,name:i}))},a.prototype._serializeMappings=function(){for(var e,t,n,r,o=0,a=1,c=0,l=0,u=0,d=0,h="",f=this._mappings.toArray(),p=0,m=f.length;p<m;p++){if(e="",(t=f[p]).generatedLine!==a)for(o=0;t.generatedLine!==a;)e+=";",a++;else if(p>0){if(!s.compareByGeneratedPositionsInflated(t,f[p-1]))continue;e+=","}e+=i.encode(t.generatedColumn-o),o=t.generatedColumn,null!=t.source&&(r=this._sources.indexOf(t.source),e+=i.encode(r-d),d=r,e+=i.encode(t.originalLine-1-l),l=t.originalLine-1,e+=i.encode(t.originalColumn-c),c=t.originalColumn,null!=t.name&&(n=this._names.indexOf(t.name),e+=i.encode(n-u),u=n)),h+=e}return h},a.prototype._generateSourcesContent=function(e,t){return e.map((function(e){if(!this._sourcesContents)return null;null!=t&&(e=s.relative(t,e));var n=s.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,n)?this._sourcesContents[n]:null}),this)},a.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e},a.prototype.toString=function(){return JSON.stringify(this.toJSON())},t.SourceMapGenerator=a},function(e,t,n){var i=n(716);t.encode=function(e){var t,n="",s=function(e){return e<0?1+(-e<<1):0+(e<<1)}(e);do{t=31&s,(s>>>=5)>0&&(t|=32),n+=i.encode(t)}while(s>0);return n},t.decode=function(e,t,n){var s,r,o,a,c=e.length,l=0,u=0;do{if(t>=c)throw new Error("Expected more digits in base 64 VLQ value.");if(-1===(r=i.decode(e.charCodeAt(t++))))throw new Error("Invalid base64 digit: "+e.charAt(t-1));s=!!(32&r),l+=(r&=31)<<u,u+=5}while(s);n.value=(a=(o=l)>>1,1==(1&o)?-a:a),n.rest=t}},function(e,t,n){var i=n(114),s=Object.prototype.hasOwnProperty,r="undefined"!=typeof Map;function o(){this._array=[],this._set=r?new Map:Object.create(null)}o.fromArray=function(e,t){for(var n=new o,i=0,s=e.length;i<s;i++)n.add(e[i],t);return n},o.prototype.size=function(){return r?this._set.size:Object.getOwnPropertyNames(this._set).length},o.prototype.add=function(e,t){var n=r?e:i.toSetString(e),o=r?this.has(e):s.call(this._set,n),a=this._array.length;o&&!t||this._array.push(e),o||(r?this._set.set(e,a):this._set[n]=a)},o.prototype.has=function(e){if(r)return this._set.has(e);var t=i.toSetString(e);return s.call(this._set,t)},o.prototype.indexOf=function(e){if(r){var t=this._set.get(e);if(t>=0)return t}else{var n=i.toSetString(e);if(s.call(this._set,n))return this._set[n]}throw new Error('"'+e+'" is not in the set.')},o.prototype.at=function(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)},o.prototype.toArray=function(){return this._array.slice()},t.ArraySet=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(18),r=n(3),o=n(19),a=n(20),c=n(7),l=n(5),u=n(32),d=n(21),h=n(23),f=n(13),p=n(68),m=n(50),g=n(93),y=n(26),v=n(9),S=n(947),_=n(948),E=n(42),w=n(6),b=[77,88,144,0,3,0,0,0,4,0,0,0,255,255,0,0,184,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,14,31,186,14,0,180,9,205,33,184,1,76,205,33,84,104];function C(){return r.Buffer.from(b)}t.getBinaryPreamble=C;class T{constructor(e,t,n){this.workspaceService=e,this.fileService=t,this.sessionContext=n,this._version=8,this.onFilesChangedEmitter=new i.EventEmitter,this.eventRegistrations=[],this.workspaceProviders=[],this.isDisposed=!1,this.multiRootWorkspaceEnabled=!0,this.uriPrefix=f.Settings.scheme+":",this.generation=0,this.enableFileServiceCacheMutex=new w.Mutex,this.onDidChangeFile=this.onFilesChangedEmitter.event,this.getFileStat=(e,t)=>({mtime:Date.parse(e.mtime),ctime:Date.parse(e.mtime),size:void 0,type:e.isDirectory?i.FileType.Directory:i.FileType.File}),this.trace=c.traceSource.withName(l.vsls.TraceSources.ClientFileProvider),this.workspaceService.onConnectionStatusChanged(this.onWorkspaceConnectionStatusChanged,this,this.eventRegistrations),this.fileOperationStartedOnce=new Map([[1,!1],[0,!1]])}init(){this.fileService().onFilesChanged(this.onFilesChanged,this,this.eventRegistrations)}registerWorkspaceProvider(e){this.workspaceProviders.push(e)}fireFilesChanged(e){this.onFilesChangedEmitter.fire(e)}onWorkspaceConnectionStatusChanged(e){this.currentConnectionStatus=e.connectionStatus}async waitForSessionPromise(e){this.fileOperationStartedOnce.get(e)?await this.sessionContext.waitForSessionPromise(d.SessionPromise.JoiningCompleted):(this.fileOperationStartedOnce.set(e,!0),await this.sessionContext.waitForSessionPromise(d.SessionPromise.EnvironmentReadyForFileOperation))}bumpGeneration(){this.generation++}createorUpdateWorkspaceFile(e,t){const n=i.Uri.parse("vsls:/Live Share.code-workspace");this.workspaceFile=new S.MemoryFile(n,"Live Share");const s=(new TextEncoder).encode(JSON.stringify({folders:[{uri:`vsls:/?${e}`,name:t}]},void 0,"\t"));this.setWorkspaceFileInfo(n,s)}onFilesChanged(e){let t=!1;const n=e.changes.map(e=>{const n=p.PathUtil.getRelativePathFromPrefixedPath(e.fullPath),s=i.Uri.parse(`${this.uriPrefix}${n}`),r=T.toFileChangeType(e.changeType);return r===i.FileChangeType.Created&&(t=!0),{type:r,uri:s}});this.onFilesChangedEmitter.fire(n),t&&this.workspaceFile&&i.commands.executeCommand("workbench.files.action.refreshFilesExplorer")}static toFileChangeType(e){switch(e){case l.vsls.FileChangeType.Added:return i.FileChangeType.Created;case l.vsls.FileChangeType.Deleted:return i.FileChangeType.Deleted;case l.vsls.FileChangeType.Updated:return i.FileChangeType.Changed;default:throw new Error("changeType not supported")}}dispose(){this.isDisposed=!0,this.eventRegistrations.forEach(e=>e.dispose())}watch(e,t){return{dispose(){}}}async stat(e){var t;if(e.path===(null===(t=this.workspaceFile)||void 0===t?void 0:t.uri.path))return this.workspaceFile;if("/"===e.path||""===e.path)return{type:i.FileType.Directory,ctime:0,mtime:0,size:0};const n=this.generation;if(await this.waitForSessionPromise(1),n!==this.generation)throw this.fileError("FileNotFound",e);if(!this.isConnected)return{type:i.FileType.Unknown,ctime:0,mtime:0,size:0};const s=[e.path];let r={recurseMode:l.vsls.FileRecurseMode.None,excludePatterns:void 0,includeDetails:!0,enableMultipleRoots:this.multiRootWorkspaceEnabled};const o=await this.listAsync(s,r);if(o[0].path.startsWith(m.PathManager.untitledPrefix))try{return this.sessionContext.coeditingClient.openUntitledFiles.get(e.path)}catch(t){throw this.fileError("FileNotFound",e)}for(const e of this.workspaceProviders.filter(e=>e.onStat))await e.onStat(o);if(0===o.length||!1===o[0].exists)throw this.fileError("FileNotFound",e);return this.getFileStat(o[0],e.toString())}async readFile(e){var t;if(e.path===(null===(t=this.workspaceFile)||void 0===t?void 0:t.uri.path))return Promise.resolve(this.workspaceFile.data);if(await this.waitForSessionPromise(0),!e.path.length||!this.isConnected)throw this.fileError("FileNotFound",e);let n;try{if(e.path.startsWith(m.PathManager.untitledPrefix)){if(!this.sessionContext.coeditingClient.openUntitledFiles.has(e.path))throw this.fileError("FileNotFound",e);n={exists:!0,path:e.path,text:"",isDirectory:!1},new v.TelemetryEvent(g.Event.RECEIVE_UNTITLED_FILE).send()}else n=await this.readTextAsync(e,{})}catch(t){throw this.trace.error("readFile error:",t),t.code===a.RpcErrorCodes.MessageTooLarge?this.fileError("FileTooLarge",e):"FileNotFound"===t?this.fileError("FileNotFound",e):this.fileError("FileNotAvailable",e)}for(const e of this.workspaceProviders.filter(e=>e.onReadFile))await e.onReadFile(n);if(!1===n.exists)throw this.fileError("FileNotFound",e,o.LogLevel.Debug);let i=n.text;const s=this.sessionContext.coeditingClient.uriToFileName(e);if(s&&n.attributes!==l.vsls.FileAttributes.Hidden&&(i=await this.sessionContext.coeditingClient.performFileOpenHandshake(s,i),"boolean"==typeof i&&!1===i))return Promise.resolve(C());let c=r.Buffer.from(i,"utf8");return Promise.resolve(c)}async writeFile(e,t,n){var i;if(e.path!==(null===(i=this.workspaceFile)||void 0===i?void 0:i.uri.path)){if(await this.sessionContext.waitForSessionPromise(d.SessionPromise.JoiningCompleted),this.isSessionActive)try{if(e.path.startsWith(m.PathManager.untitledPrefix)){if(this.sessionContext.coeditingClient.openUntitledFiles.has(e.path)){return void(this.sessionContext.coeditingClient.openUntitledFiles.get(e.path).mtime=(new Date).getTime())}throw this.fileError("FileNotFound",e)}const i=await this.fileExists(e);if(!(!i||n&&n.overwrite))throw this.fileError("FileExists",e);if(!(i||n&&n.create))throw this.fileError("FileNotFound",e);if(i)return;const s=t.toString();if(!1===(await this.fileService().writeTextAsync(e.path,s,{append:!1,createIfNotExist:!0})).exists)throw this.fileError("NoPermissions",e)}catch(e){return void this.trace.error(e.message)}}else this.setWorkspaceFileInfo(e,t)}async rename(e,t,n){if(await this.sessionContext.waitForSessionPromise(d.SessionPromise.JoiningCompleted),!this.isSessionActive)throw this.fileError("FileNotFound",e);if(!await this.fileExists(e))throw this.fileError("FileNotFound",e);if(!n||!n.overwrite){if(await this.fileExists(t))throw this.fileError("FileExists",t)}if(!1===(await this.fileService().moveAsync(e.path,u.parse(t.path).path,{overwrite:!1})).exists)throw this.fileError("NoPermissions",t)}async createDirectory(e){if(await this.sessionContext.waitForSessionPromise(d.SessionPromise.JoiningCompleted),!this.isSessionActive)throw this.fileError("FileNotFound",e);if(e.path.startsWith(m.PathManager.externalPrefix))return;if(!1===(await this.fileService().createDirectoryAsync(e.path)).exists)throw this.fileError("NoPermissions",e)}async readDirectory(e){await this.sessionContext.waitForSessionPromise(d.SessionPromise.JoiningCompleted);const t=[];if(!this.isSessionActive)return t;let n,i={recurseMode:l.vsls.FileRecurseMode.Children,excludePatterns:void 0,includeDetails:!0,enableMultipleRoots:this.multiRootWorkspaceEnabled};n=await this.listAsync([e.path],i);for(const e of this.workspaceProviders.filter(e=>e.onReadDirectory))await e.onReadDirectory(n);if(1!==n.length||!1===n[0].exists)throw this.fileError("FileNotFound",e);return n=n[0].children,function(e){const t=new Set;for(let n of e){if(n.isDirectory)continue;const e=n.path.toLowerCase();if(t.has(e))return void M();t.add(e)}}(n),n&&n.forEach(n=>{let i=e.with({path:n.path}),r=this.getFileStat(n,i.toString()),o=s.basename(n.path);t.push([o,r.type])}),t}async delete(e){if(await this.sessionContext.waitForSessionPromise(d.SessionPromise.JoiningCompleted),!this.isSessionActive)throw this.fileError("FileNotFound",e);return this.fileService().deleteAsync(e.path,{useTrash:!0})}get isConnected(){return this.currentConnectionStatus!==l.vsls.WorkspaceConnectionStatus.Disconnected&&!this.isDisposed}get isSessionActive(){return h.sessionStateTracker.State===d.SessionState.Joined&&this.isConnected}setWorkspaceFileInfo(e,t){this.workspaceFile.mtime=Date.now(),this.workspaceFile.size=t.byteLength,this.workspaceFile.data=t,this.onFilesChangedEmitter.fire([{type:i.FileChangeType.Changed,uri:e}])}fileExists(e){let t={recurseMode:l.vsls.FileRecurseMode.None,excludePatterns:void 0,includeDetails:!0,enableMultipleRoots:this.multiRootWorkspaceEnabled},n=[];return n.push(e.path),this.listAsync(n,t).then(e=>!1!==e[0].exists)}async ensureStatusFileServiceCache(){await this.enableFileServiceCacheMutex.dispatch(async()=>{var e;void 0===this.enableFileServiceCache&&(this.enableFileServiceCache=!!await(null===(e=E.getExpService())||void 0===e?void 0:e.getTreatmentVariableAsync("vscode","file-service-cache")),this.enableFileServiceCache&&(this.fileServiceCache=new _.FileServiceCache(this.fileService(),c.traceSource.withName("FileServiceCache")),this.trace.info("File service cache is enabled")))})}async readTextAsync(e,t,n){if(void 0===this.enableFileServiceCache&&await this.ensureStatusFileServiceCache(),this.enableFileServiceCache){return(await this.fileServiceCache.readTextAsync([e.path],t,3e4,n))[0]}return await this.fileService().readTextAsync(e.path,t,n)}async listAsync(e,t,n){return void 0===this.enableFileServiceCache&&await this.ensureStatusFileServiceCache(),this.enableFileServiceCache?await this.fileServiceCache.listAsync(e,t,3e4,n):await this.fileService().listAsync(e,t,n)}fileError(e,t,n){let s;switch(this.trace.traceEvent(n||o.LogLevel.Error,0,`fileError: ${e} uri path:${null==t?void 0:t.path}`),e){case"FileNotFound":s=y.localize("fileError.FileNotFound");break;case"FileExists":s=y.localize("fileError.FileExists");break;case"NoPermissions":s=y.localize("fileError.NoPermissions");break;case"FileTooLarge":s=y.localize("fileError.FileTooLarge");break;case"FileNotAvailable":s=y.localize("fileError.FileNotAvailable");break;default:s=""}s=s||`Error (${e}): ${t.path}`,t&&(s=s.replace("$(path)",t.path));const r=i.FileSystemError[e];return r?r(s):new Error(s)}}function M(){g.CoauthoringTelemetry.ReportCaseSensitiveFileSystem(),i.window.showErrorMessage(y.localize("error.CaseSensitiveFileSystem"))}t.WorkspaceProvider=T},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(8)),r=n(214),o=n(19),a=n(126);!function(e){e[e.ParseError=s.ErrorCodes.ParseError]="ParseError",e[e.InvalidRequest=s.ErrorCodes.InvalidRequest]="InvalidRequest",e[e.MethodNotFound=s.ErrorCodes.MethodNotFound]="MethodNotFound",e[e.InvalidParams=s.ErrorCodes.InvalidParams]="InvalidParams",e[e.InternalError=s.ErrorCodes.InternalError]="InternalError",e[e.ServerNotInitialized=s.ErrorCodes.ServerNotInitialized]="ServerNotInitialized",e[e.UnknownErrorCode=s.ErrorCodes.UnknownErrorCode]="UnknownErrorCode",e[e.RequestCancelled=s.ErrorCodes.RequestCancelled]="RequestCancelled",e[e.MessageWriteError=s.ErrorCodes.MessageWriteError]="MessageWriteError",e[e.MessageReadError=s.ErrorCodes.MessageReadError]="MessageReadError",e[e.ServiceNotAvailable=-32099]="ServiceNotAvailable",e[e.InvocationException=-32098]="InvocationException",e[e.MessageTooLarge=-32097]="MessageTooLarge"}(t.RpcErrorCodes||(t.RpcErrorCodes={}));class c{constructor(e,t,n){this.client=e,this.serviceName=t,this.logger=n}static create(e,t,n){if(!e||!e.name)throw new Error("Missing RPC service name.");const i=new c(t,e.name,n);for(const t of e.methods){i[`${t}Async`]=function(){let e,n=arguments[arguments.length-1];n&&"object"==typeof n&&"boolean"==typeof n.isCancellationRequested?e=Array.prototype.slice.call(arguments,0,arguments.length-1):(e=Array.prototype.slice.call(arguments,0,arguments.length),n=null);let s=e[e.length-1];s&&"object"==typeof s&&"function"==typeof s.report?e.splice(e.length-1,1):s=null;const r=i.serviceName+"."+t;return i.client.sendRequest(this.logger,r,s,n,...e)}}for(const t of e.voidMethods||[])i[t]=function(){const e=Array.prototype.slice.call(arguments,0,arguments.length),n=i.serviceName+"."+t;i.client.sendNotification(this.logger,n,e).then().catch()};for(const t of e.events){const e=new s.Emitter,n=a.getEventPropertyName(t);i[n]=e.event;const r=i.serviceName+"."+t;i.client.ensureConnectionAsync().then(t=>{t.onNotification(r,(...t)=>{const n=t[0],s=o.LoggerSettings.disableObfuscation?JSON.stringify(n):"";i.logger.log(o.LogLevel.Debug,`> ${r}: ${s}`),e.fire(n)})}).catch(e=>{})}return i}static createWithConnection(e,t,n){return c.create(e,r.RpcClientProxy.fromRpcConnection(t,n),n)}static createWithPromise(e,t,n){return c.create(e,r.RpcClientProxy.fromPromise(t,n),n)}static notifyAsync(e,t,n){const i=e,s=i.serviceName+"."+t;return i.client.sendNotification(i.logger,s,n)}}t.RpcProxy=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(116);var s;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.serverErrorStart=-32099,e.serverErrorEnd=-32e3,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.RequestCancelled=-32800,e.MessageWriteError=1,e.MessageReadError=2}(s=t.ErrorCodes||(t.ErrorCodes={}));class r extends Error{constructor(e,t,n){super(t),this.code=i.number(e)?e:s.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,r.prototype)}toJson(){return{code:this.code,message:this.message,data:this.data}}}t.ResponseError=r;class o{constructor(e,t){this._method=e,this._numberOfParams=t}get method(){return this._method}get numberOfParams(){return this._numberOfParams}}t.AbstractMessageType=o;t.RequestType0=class extends o{constructor(e){super(e,0),this._=void 0}};t.RequestType=class extends o{constructor(e){super(e,1),this._=void 0}};t.RequestType1=class extends o{constructor(e){super(e,1),this._=void 0}};t.RequestType2=class extends o{constructor(e){super(e,2),this._=void 0}};t.RequestType3=class extends o{constructor(e){super(e,3),this._=void 0}};t.RequestType4=class extends o{constructor(e){super(e,4),this._=void 0}};t.RequestType5=class extends o{constructor(e){super(e,5),this._=void 0}};t.RequestType6=class extends o{constructor(e){super(e,6),this._=void 0}};t.RequestType7=class extends o{constructor(e){super(e,7),this._=void 0}};t.RequestType8=class extends o{constructor(e){super(e,8),this._=void 0}};t.RequestType9=class extends o{constructor(e){super(e,9),this._=void 0}};t.NotificationType=class extends o{constructor(e){super(e,1),this._=void 0}};t.NotificationType0=class extends o{constructor(e){super(e,0),this._=void 0}};t.NotificationType1=class extends o{constructor(e){super(e,1),this._=void 0}};t.NotificationType2=class extends o{constructor(e){super(e,2),this._=void 0}};t.NotificationType3=class extends o{constructor(e){super(e,3),this._=void 0}};t.NotificationType4=class extends o{constructor(e){super(e,4),this._=void 0}};t.NotificationType5=class extends o{constructor(e){super(e,5),this._=void 0}};t.NotificationType6=class extends o{constructor(e){super(e,6),this._=void 0}};t.NotificationType7=class extends o{constructor(e){super(e,7),this._=void 0}};t.NotificationType8=class extends o{constructor(e){super(e,8),this._=void 0}};t.NotificationType9=class extends o{constructor(e){super(e,9),this._=void 0}},t.isRequestMessage=function(e){let t=e;return t&&i.string(t.method)&&(i.string(t.id)||i.number(t.id))},t.isNotificationMessage=function(e){let t=e;return t&&i.string(t.method)&&void 0===e.id},t.isResponseMessage=function(e){let t=e;return t&&(void 0!==t.result||!!t.error)&&(i.string(t.id)||i.number(t.id)||null===t.id)}},function(e,t,n){"use strict";var i=n(14).Buffer,s=n(34).Transform;function r(e){s.call(this),this._block=i.allocUnsafe(e),this._blockSize=e,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}n(12)(r,s),r.prototype._transform=function(e,t,n){var i=null;try{this.update(e,t)}catch(e){i=e}n(i)},r.prototype._flush=function(e){var t=null;try{this.push(this.digest())}catch(e){t=e}e(t)},r.prototype.update=function(e,t){if(function(e,t){if(!i.isBuffer(e)&&"string"!=typeof e)throw new TypeError(t+" must be a string or a buffer")}(e,"Data"),this._finalized)throw new Error("Digest already called");i.isBuffer(e)||(e=i.from(e,t));for(var n=this._block,s=0;this._blockOffset+e.length-s>=this._blockSize;){for(var r=this._blockOffset;r<this._blockSize;)n[r++]=e[s++];this._update(),this._blockOffset=0}for(;s<e.length;)n[this._blockOffset++]=e[s++];for(var o=0,a=8*e.length;a>0;++o)this._length[o]+=a,(a=this._length[o]/4294967296|0)>0&&(this._length[o]-=4294967296*a);return this},r.prototype._update=function(){throw new Error("_update is not implemented")},r.prototype.digest=function(e){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var t=this._digest();void 0!==e&&(t=t.toString(e)),this._block.fill(0),this._blockOffset=0;for(var n=0;n<4;++n)this._length[n]=0;return t},r.prototype._digest=function(){throw new Error("_digest is not implemented")},e.exports=r},function(e,t,n){"use strict";(function(t,i){var s=n(153);e.exports=S;var r,o=n(115);S.ReadableState=v;n(24).EventEmitter;var a=function(e,t){return e.listeners(t).length},c=n(330),l=n(200).Buffer,u=t.Uint8Array||function(){};var d=Object.create(n(119));d.inherits=n(12);var h=n(741),f=void 0;f=h&&h.debuglog?h.debuglog("stream"):function(){};var p,m=n(742),g=n(331);d.inherits(S,c);var y=["error","close","destroy","pause","resume"];function v(e,t){e=e||{};var i=t instanceof(r=r||n(77));this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var s=e.highWaterMark,o=e.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=s||0===s?s:i&&(o||0===o)?o:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(p||(p=n(202).StringDecoder),this.decoder=new p(e.encoding),this.encoding=e.encoding)}function S(e){if(r=r||n(77),!(this instanceof S))return new S(e);this._readableState=new v(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),c.call(this)}function _(e,t,n,i,s){var r,o=e._readableState;null===t?(o.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,b(e)}(e,o)):(s||(r=function(e,t){var n;i=t,l.isBuffer(i)||i instanceof u||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));var i;return n}(o,t)),r?e.emit("error",r):o.objectMode||t&&t.length>0?("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=function(e){return l.from(e)}(t)),i?o.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):E(e,o,t,!0):o.ended?e.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!n?(t=o.decoder.write(t),o.objectMode||0!==t.length?E(e,o,t,!1):T(e,o)):E(e,o,t,!1))):i||(o.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(o)}function E(e,t,n,i){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&b(e)),T(e,t)}Object.defineProperty(S.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=g.destroy,S.prototype._undestroy=g.undestroy,S.prototype._destroy=function(e,t){this.push(null),t(e)},S.prototype.push=function(e,t){var n,i=this._readableState;return i.objectMode?n=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=l.from(e,t),t=""),n=!0),_(this,e,t,!1,n)},S.prototype.unshift=function(e){return _(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(e){return p||(p=n(202).StringDecoder),this._readableState.decoder=new p(e),this._readableState.encoding=e,this};function w(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=8388608?e=8388608:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function b(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(f("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?s.nextTick(C,e):C(e))}function C(e){f("emit readable"),e.emit("readable"),R(e)}function T(e,t){t.readingMore||(t.readingMore=!0,s.nextTick(M,e,t))}function M(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(f("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function A(e){f("readable nexttick read 0"),e.read(0)}function k(e,t){t.reading||(f("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),R(e),t.flowing&&!t.reading&&e.read(0)}function R(e){var t=e._readableState;for(f("flow",t.flowing);t.flowing&&null!==e.read(););}function P(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var i;e<t.head.data.length?(i=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):i=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,i=1,s=n.data;e-=s.length;for(;n=n.next;){var r=n.data,o=e>r.length?r.length:e;if(o===r.length?s+=r:s+=r.slice(0,e),0===(e-=o)){o===r.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=r.slice(o));break}++i}return t.length-=i,s}(e,t):function(e,t){var n=l.allocUnsafe(e),i=t.head,s=1;i.data.copy(n),e-=i.data.length;for(;i=i.next;){var r=i.data,o=e>r.length?r.length:e;if(r.copy(n,n.length-e,0,o),0===(e-=o)){o===r.length?(++s,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=r.slice(o));break}++s}return t.length-=s,n}(e,t);return i}(e,t.buffer,t.decoder),n);var n}function I(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,s.nextTick(N,t,e))}function N(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function L(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1}S.prototype.read=function(e){f("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return f("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?I(this):b(this),null;if(0===(e=w(e,t))&&t.ended)return 0===t.length&&I(this),null;var i,s=t.needReadable;return f("need readable",s),(0===t.length||t.length-e<t.highWaterMark)&&f("length less than watermark",s=!0),t.ended||t.reading?f("reading or ended",s=!1):s&&(f("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=w(n,t))),null===(i=e>0?P(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&I(this)),null!==i&&this.emit("data",i),i},S.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},S.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,f("pipe count=%d opts=%j",r.pipesCount,t);var c=(!t||!1!==t.end)&&e!==i.stdout&&e!==i.stderr?u:S;function l(t,i){f("onunpipe"),t===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,f("cleanup"),e.removeListener("close",y),e.removeListener("finish",v),e.removeListener("drain",d),e.removeListener("error",g),e.removeListener("unpipe",l),n.removeListener("end",u),n.removeListener("end",S),n.removeListener("data",m),h=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}function u(){f("onend"),e.end()}r.endEmitted?s.nextTick(c):n.once("end",c),e.on("unpipe",l);var d=function(e){return function(){var t=e._readableState;f("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,R(e))}}(n);e.on("drain",d);var h=!1;var p=!1;function m(t){f("ondata"),p=!1,!1!==e.write(t)||p||((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==L(r.pipes,e))&&!h&&(f("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,p=!0),n.pause())}function g(t){f("onerror",t),S(),e.removeListener("error",g),0===a(e,"error")&&e.emit("error",t)}function y(){e.removeListener("finish",v),S()}function v(){f("onfinish"),e.removeListener("close",y),S()}function S(){f("unpipe"),n.unpipe(e)}return n.on("data",m),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?o(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",g),e.once("close",y),e.once("finish",v),e.emit("pipe",n),r.flowing||(f("pipe resume"),n.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var i=t.pipes,s=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var r=0;r<s;r++)i[r].emit("unpipe",this,n);return this}var o=L(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},S.prototype.on=function(e,t){var n=c.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&b(this):s.nextTick(A,this))}return n},S.prototype.addListener=S.prototype.on,S.prototype.resume=function(){var e=this._readableState;return e.flowing||(f("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,s.nextTick(k,e,t))}(this,e)),this},S.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},S.prototype.wrap=function(e){var t=this,n=this._readableState,i=!1;for(var s in e.on("end",(function(){if(f("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(s){(f("wrapped data"),n.decoder&&(s=n.decoder.write(s)),n.objectMode&&null==s)||(n.objectMode||s&&s.length)&&(t.push(s)||(i=!0,e.pause()))})),e)void 0===this[s]&&"function"==typeof e[s]&&(this[s]=function(t){return function(){return e[t].apply(e,arguments)}}(s));for(var r=0;r<y.length;r++)e.on(y[r],this.emit.bind(this,y[r]));return this._read=function(t){f("wrapped _read",t),i&&(i=!1,e.resume())},this},Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),S._fromList=P}).call(this,n(27),n(11))},function(e,t,n){e.exports=n(24).EventEmitter},function(e,t,n){"use strict";var i=n(153);function s(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this,r=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return r||o?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||i.nextTick(s,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(i.nextTick(s,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,n){"use strict";e.exports=o;var i=n(77),s=Object.create(n(119));function r(e,t){var n=this._transformState;n.transforming=!1;var i=n.writecb;if(!i)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),i(e);var s=this._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);i.call(this,e),this._transformState={afterTransform:r.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",a)}function a(){var e=this;"function"==typeof this._flush?this._flush((function(t,n){c(e,t,n)})):c(this,null,null)}function c(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}s.inherits=n(12),s.inherits(o,i),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,i.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,n){var i=this._transformState;if(i.writecb=n,i.writechunk=e,i.writeencoding=t,!i.transforming){var s=this._readableState;(i.needTransform||s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var n=this;i.prototype._destroy.call(this,e,(function(e){t(e),n.emit("close")}))}},function(e,t,n){var i=n(12),s=n(90),r=n(14).Buffer,o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=new Array(64);function c(){this.init(),this._w=a,s.call(this,64,56)}function l(e,t,n){return n^e&(t^n)}function u(e,t,n){return e&t|n&(e|t)}function d(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function h(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function f(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}i(c,s),c.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},c.prototype._update=function(e){for(var t,n=this._w,i=0|this._a,s=0|this._b,r=0|this._c,a=0|this._d,c=0|this._e,p=0|this._f,m=0|this._g,g=0|this._h,y=0;y<16;++y)n[y]=e.readInt32BE(4*y);for(;y<64;++y)n[y]=0|(((t=n[y-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+n[y-7]+f(n[y-15])+n[y-16];for(var v=0;v<64;++v){var S=g+h(c)+l(c,p,m)+o[v]+n[v]|0,_=d(i)+u(i,s,r)|0;g=m,m=p,p=c,c=a+S|0,a=r,r=s,s=i,i=S+_|0}this._a=i+this._a|0,this._b=s+this._b|0,this._c=r+this._c|0,this._d=a+this._d|0,this._e=c+this._e|0,this._f=p+this._f|0,this._g=m+this._g|0,this._h=g+this._h|0},c.prototype._hash=function(){var e=r.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},e.exports=c},function(e,t,n){var i=n(12),s=n(90),r=n(14).Buffer,o=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],a=new Array(160);function c(){this.init(),this._w=a,s.call(this,128,112)}function l(e,t,n){return n^e&(t^n)}function u(e,t,n){return e&t|n&(e|t)}function d(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function h(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function f(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function p(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function m(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function g(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function y(e,t){return e>>>0<t>>>0?1:0}i(c,s),c.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},c.prototype._update=function(e){for(var t=this._w,n=0|this._ah,i=0|this._bh,s=0|this._ch,r=0|this._dh,a=0|this._eh,c=0|this._fh,v=0|this._gh,S=0|this._hh,_=0|this._al,E=0|this._bl,w=0|this._cl,b=0|this._dl,C=0|this._el,T=0|this._fl,M=0|this._gl,A=0|this._hl,k=0;k<32;k+=2)t[k]=e.readInt32BE(4*k),t[k+1]=e.readInt32BE(4*k+4);for(;k<160;k+=2){var R=t[k-30],P=t[k-30+1],I=f(R,P),N=p(P,R),L=m(R=t[k-4],P=t[k-4+1]),D=g(P,R),x=t[k-14],O=t[k-14+1],F=t[k-32],U=t[k-32+1],j=N+O|0,H=I+x+y(j,N)|0;H=(H=H+L+y(j=j+D|0,D)|0)+F+y(j=j+U|0,U)|0,t[k]=H,t[k+1]=j}for(var B=0;B<160;B+=2){H=t[B],j=t[B+1];var Y=u(n,i,s),W=u(_,E,w),q=d(n,_),V=d(_,n),$=h(a,C),K=h(C,a),z=o[B],G=o[B+1],J=l(a,c,v),X=l(C,T,M),Z=A+K|0,Q=S+$+y(Z,A)|0;Q=(Q=(Q=Q+J+y(Z=Z+X|0,X)|0)+z+y(Z=Z+G|0,G)|0)+H+y(Z=Z+j|0,j)|0;var ee=V+W|0,te=q+Y+y(ee,V)|0;S=v,A=M,v=c,M=T,c=a,T=C,a=r+Q+y(C=b+Z|0,b)|0,r=s,b=w,s=i,w=E,i=n,E=_,n=Q+te+y(_=Z+ee|0,Z)|0}this._al=this._al+_|0,this._bl=this._bl+E|0,this._cl=this._cl+w|0,this._dl=this._dl+b|0,this._el=this._el+C|0,this._fl=this._fl+T|0,this._gl=this._gl+M|0,this._hl=this._hl+A|0,this._ah=this._ah+n+y(this._al,_)|0,this._bh=this._bh+i+y(this._bl,E)|0,this._ch=this._ch+s+y(this._cl,w)|0,this._dh=this._dh+r+y(this._dl,b)|0,this._eh=this._eh+a+y(this._el,C)|0,this._fh=this._fh+c+y(this._fl,T)|0,this._gh=this._gh+v+y(this._gl,M)|0,this._hh=this._hh+S+y(this._hl,A)|0},c.prototype._hash=function(){var e=r.allocUnsafe(64);function t(t,n,i){e.writeInt32BE(t,i),e.writeInt32BE(n,i+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},e.exports=c},function(e,t,n){"use strict";var i=n(12),s=n(754),r=n(65),o=n(14).Buffer,a=n(336),c=n(203),l=n(204),u=o.alloc(128);function d(e,t){r.call(this,"digest"),"string"==typeof t&&(t=o.from(t));var n="sha512"===e||"sha384"===e?128:64;(this._alg=e,this._key=t,t.length>n)?t=("rmd160"===e?new c:l(e)).update(t).digest():t.length<n&&(t=o.concat([t,u],n));for(var i=this._ipad=o.allocUnsafe(n),s=this._opad=o.allocUnsafe(n),a=0;a<n;a++)i[a]=54^t[a],s[a]=92^t[a];this._hash="rmd160"===e?new c:l(e),this._hash.update(i)}i(d,r),d.prototype._update=function(e){this._hash.update(e)},d.prototype._final=function(){var e=this._hash.digest();return("rmd160"===this._alg?new c:l(this._alg)).update(this._opad).update(e).digest()},e.exports=function(e,t){return"rmd160"===(e=e.toLowerCase())||"ripemd160"===e?new d("rmd160",t):"md5"===e?new s(a,t):new d(e,t)}},function(e,t,n){var i=n(199);e.exports=function(e){return(new i).update(e).digest()}},function(e){e.exports=JSON.parse('{"sha224WithRSAEncryption":{"sign":"rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"RSA-SHA224":{"sign":"ecdsa/rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"sha256WithRSAEncryption":{"sign":"rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"RSA-SHA256":{"sign":"ecdsa/rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"sha384WithRSAEncryption":{"sign":"rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"RSA-SHA384":{"sign":"ecdsa/rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"sha512WithRSAEncryption":{"sign":"rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA512":{"sign":"ecdsa/rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA1":{"sign":"rsa","hash":"sha1","id":"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{"sign":"ecdsa","hash":"sha1","id":""},"sha256":{"sign":"ecdsa","hash":"sha256","id":""},"sha224":{"sign":"ecdsa","hash":"sha224","id":""},"sha384":{"sign":"ecdsa","hash":"sha384","id":""},"sha512":{"sign":"ecdsa","hash":"sha512","id":""},"DSA-SHA":{"sign":"dsa","hash":"sha1","id":""},"DSA-SHA1":{"sign":"dsa","hash":"sha1","id":""},"DSA":{"sign":"dsa","hash":"sha1","id":""},"DSA-WITH-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-WITH-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-WITH-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-WITH-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-RIPEMD160":{"sign":"dsa","hash":"rmd160","id":""},"ripemd160WithRSA":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"RSA-RIPEMD160":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"md5WithRSAEncryption":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"},"RSA-MD5":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"}}')},function(e,t,n){t.pbkdf2=n(756),t.pbkdf2Sync=n(341)},function(e,t,n){(function(t){var n=Math.pow(2,30)-1;function i(e,n){if("string"!=typeof e&&!t.isBuffer(e))throw new TypeError(n+" must be a buffer or string")}e.exports=function(e,t,s,r){if(i(e,"Password"),i(t,"Salt"),"number"!=typeof s)throw new TypeError("Iterations not a number");if(s<0)throw new TypeError("Bad iterations");if("number"!=typeof r)throw new TypeError("Key length not a number");if(r<0||r>n||r!=r)throw new TypeError("Bad key length")}}).call(this,n(3).Buffer)},function(e,t,n){(function(t){var n;t.browser?n="utf-8":n=parseInt(t.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary";e.exports=n}).call(this,n(11))},function(e,t,n){var i=n(336),s=n(203),r=n(204),o=n(339),a=n(340),c=n(14).Buffer,l=c.alloc(128),u={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function d(e,t,n){var o=function(e){function t(t){return r(e).update(t).digest()}return"rmd160"===e||"ripemd160"===e?function(e){return(new s).update(e).digest()}:"md5"===e?i:t}(e),a="sha512"===e||"sha384"===e?128:64;t.length>a?t=o(t):t.length<a&&(t=c.concat([t,l],a));for(var d=c.allocUnsafe(a+u[e]),h=c.allocUnsafe(a+u[e]),f=0;f<a;f++)d[f]=54^t[f],h[f]=92^t[f];var p=c.allocUnsafe(a+n+4);d.copy(p,0,0,a),this.ipad1=p,this.ipad2=d,this.opad=h,this.alg=e,this.blocksize=a,this.hash=o,this.size=u[e]}d.prototype.run=function(e,t){return e.copy(t,this.blocksize),this.hash(t).copy(this.opad,this.blocksize),this.hash(this.opad)},e.exports=function(e,t,n,i,s){o(e,t,n,i),c.isBuffer(e)||(e=c.from(e,a)),c.isBuffer(t)||(t=c.from(t,a));var r=new d(s=s||"sha1",e,t.length),l=c.allocUnsafe(i),h=c.allocUnsafe(t.length+4);t.copy(h,0,0,t.length);for(var f=0,p=u[s],m=Math.ceil(i/p),g=1;g<=m;g++){h.writeUInt32BE(g,t.length);for(var y=r.run(h,r.ipad1),v=y,S=1;S<n;S++){v=r.run(v,r.ipad2);for(var _=0;_<p;_++)y[_]^=v[_]}y.copy(l,f),f+=p}return l}},function(e,t,n){"use strict";t.readUInt32BE=function(e,t){return(e[0+t]<<24|e[1+t]<<16|e[2+t]<<8|e[3+t])>>>0},t.writeUInt32BE=function(e,t,n){e[0+n]=t>>>24,e[1+n]=t>>>16&255,e[2+n]=t>>>8&255,e[3+n]=255&t},t.ip=function(e,t,n,i){for(var s=0,r=0,o=6;o>=0;o-=2){for(var a=0;a<=24;a+=8)s<<=1,s|=t>>>a+o&1;for(a=0;a<=24;a+=8)s<<=1,s|=e>>>a+o&1}for(o=6;o>=0;o-=2){for(a=1;a<=25;a+=8)r<<=1,r|=t>>>a+o&1;for(a=1;a<=25;a+=8)r<<=1,r|=e>>>a+o&1}n[i+0]=s>>>0,n[i+1]=r>>>0},t.rip=function(e,t,n,i){for(var s=0,r=0,o=0;o<4;o++)for(var a=24;a>=0;a-=8)s<<=1,s|=t>>>a+o&1,s<<=1,s|=e>>>a+o&1;for(o=4;o<8;o++)for(a=24;a>=0;a-=8)r<<=1,r|=t>>>a+o&1,r<<=1,r|=e>>>a+o&1;n[i+0]=s>>>0,n[i+1]=r>>>0},t.pc1=function(e,t,n,i){for(var s=0,r=0,o=7;o>=5;o--){for(var a=0;a<=24;a+=8)s<<=1,s|=t>>a+o&1;for(a=0;a<=24;a+=8)s<<=1,s|=e>>a+o&1}for(a=0;a<=24;a+=8)s<<=1,s|=t>>a+o&1;for(o=1;o<=3;o++){for(a=0;a<=24;a+=8)r<<=1,r|=t>>a+o&1;for(a=0;a<=24;a+=8)r<<=1,r|=e>>a+o&1}for(a=0;a<=24;a+=8)r<<=1,r|=e>>a+o&1;n[i+0]=s>>>0,n[i+1]=r>>>0},t.r28shl=function(e,t){return e<<t&268435455|e>>>28-t};var i=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];t.pc2=function(e,t,n,s){for(var r=0,o=0,a=i.length>>>1,c=0;c<a;c++)r<<=1,r|=e>>>i[c]&1;for(c=a;c<i.length;c++)o<<=1,o|=t>>>i[c]&1;n[s+0]=r>>>0,n[s+1]=o>>>0},t.expand=function(e,t,n){var i=0,s=0;i=(1&e)<<5|e>>>27;for(var r=23;r>=15;r-=4)i<<=6,i|=e>>>r&63;for(r=11;r>=3;r-=4)s|=e>>>r&63,s<<=6;s|=(31&e)<<1|e>>>31,t[n+0]=i>>>0,t[n+1]=s>>>0};var s=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];t.substitute=function(e,t){for(var n=0,i=0;i<4;i++){n<<=4,n|=s[64*i+(e>>>18-6*i&63)]}for(i=0;i<4;i++){n<<=4,n|=s[256+64*i+(t>>>18-6*i&63)]}return n>>>0};var r=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];t.permute=function(e){for(var t=0,n=0;n<r.length;n++)t<<=1,t|=e>>>r[n]&1;return t>>>0},t.padSplit=function(e,t,n){for(var i=e.toString(2);i.length<t;)i="0"+i;for(var s=[],r=0;r<t;r+=n)s.push(i.slice(r,r+n));return s.join(" ")}},function(e,t,n){"use strict";var i=n(38),s=n(12),r=n(342),o=n(205);function a(){this.tmp=new Array(2),this.keys=null}function c(e){o.call(this,e);var t=new a;this._desState=t,this.deriveKeys(t,e.key)}s(c,o),e.exports=c,c.create=function(e){return new c(e)};var l=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];c.prototype.deriveKeys=function(e,t){e.keys=new Array(32),i.equal(t.length,this.blockSize,"Invalid key length");var n=r.readUInt32BE(t,0),s=r.readUInt32BE(t,4);r.pc1(n,s,e.tmp,0),n=e.tmp[0],s=e.tmp[1];for(var o=0;o<e.keys.length;o+=2){var a=l[o>>>1];n=r.r28shl(n,a),s=r.r28shl(s,a),r.pc2(n,s,e.keys,o)}},c.prototype._update=function(e,t,n,i){var s=this._desState,o=r.readUInt32BE(e,t),a=r.readUInt32BE(e,t+4);r.ip(o,a,s.tmp,0),o=s.tmp[0],a=s.tmp[1],"encrypt"===this.type?this._encrypt(s,o,a,s.tmp,0):this._decrypt(s,o,a,s.tmp,0),o=s.tmp[0],a=s.tmp[1],r.writeUInt32BE(n,o,i),r.writeUInt32BE(n,a,i+4)},c.prototype._pad=function(e,t){for(var n=e.length-t,i=t;i<e.length;i++)e[i]=n;return!0},c.prototype._unpad=function(e){for(var t=e[e.length-1],n=e.length-t;n<e.length;n++)i.equal(e[n],t);return e.slice(0,e.length-t)},c.prototype._encrypt=function(e,t,n,i,s){for(var o=t,a=n,c=0;c<e.keys.length;c+=2){var l=e.keys[c],u=e.keys[c+1];r.expand(a,e.tmp,0),l^=e.tmp[0],u^=e.tmp[1];var d=r.substitute(l,u),h=a;a=(o^r.permute(d))>>>0,o=h}r.rip(a,o,i,s)},c.prototype._decrypt=function(e,t,n,i,s){for(var o=n,a=t,c=e.keys.length-2;c>=0;c-=2){var l=e.keys[c],u=e.keys[c+1];r.expand(o,e.tmp,0),l^=e.tmp[0],u^=e.tmp[1];var d=r.substitute(l,u),h=o;o=(a^r.permute(d))>>>0,a=h}r.rip(o,a,i,s)}},function(e,t,n){var i=n(120),s=n(14).Buffer,r=n(345);function o(e){var t=e._cipher.encryptBlockRaw(e._prev);return r(e._prev),t}t.encrypt=function(e,t){var n=Math.ceil(t.length/16),r=e._cache.length;e._cache=s.concat([e._cache,s.allocUnsafe(16*n)]);for(var a=0;a<n;a++){var c=o(e),l=r+16*a;e._cache.writeUInt32BE(c[0],l+0),e._cache.writeUInt32BE(c[1],l+4),e._cache.writeUInt32BE(c[2],l+8),e._cache.writeUInt32BE(c[3],l+12)}var u=e._cache.slice(0,t.length);return e._cache=e._cache.slice(t.length),i(t,u)}},function(e,t){e.exports=function(e){for(var t,n=e.length;n--;){if(255!==(t=e.readUInt8(n))){t++,e.writeUInt8(t,n);break}e.writeUInt8(0,n)}}},function(e){e.exports=JSON.parse('{"aes-128-ecb":{"cipher":"AES","key":128,"iv":0,"mode":"ECB","type":"block"},"aes-192-ecb":{"cipher":"AES","key":192,"iv":0,"mode":"ECB","type":"block"},"aes-256-ecb":{"cipher":"AES","key":256,"iv":0,"mode":"ECB","type":"block"},"aes-128-cbc":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes-192-cbc":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes-256-cbc":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes128":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes192":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes256":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes-128-cfb":{"cipher":"AES","key":128,"iv":16,"mode":"CFB","type":"stream"},"aes-192-cfb":{"cipher":"AES","key":192,"iv":16,"mode":"CFB","type":"stream"},"aes-256-cfb":{"cipher":"AES","key":256,"iv":16,"mode":"CFB","type":"stream"},"aes-128-cfb8":{"cipher":"AES","key":128,"iv":16,"mode":"CFB8","type":"stream"},"aes-192-cfb8":{"cipher":"AES","key":192,"iv":16,"mode":"CFB8","type":"stream"},"aes-256-cfb8":{"cipher":"AES","key":256,"iv":16,"mode":"CFB8","type":"stream"},"aes-128-cfb1":{"cipher":"AES","key":128,"iv":16,"mode":"CFB1","type":"stream"},"aes-192-cfb1":{"cipher":"AES","key":192,"iv":16,"mode":"CFB1","type":"stream"},"aes-256-cfb1":{"cipher":"AES","key":256,"iv":16,"mode":"CFB1","type":"stream"},"aes-128-ofb":{"cipher":"AES","key":128,"iv":16,"mode":"OFB","type":"stream"},"aes-192-ofb":{"cipher":"AES","key":192,"iv":16,"mode":"OFB","type":"stream"},"aes-256-ofb":{"cipher":"AES","key":256,"iv":16,"mode":"OFB","type":"stream"},"aes-128-ctr":{"cipher":"AES","key":128,"iv":16,"mode":"CTR","type":"stream"},"aes-192-ctr":{"cipher":"AES","key":192,"iv":16,"mode":"CTR","type":"stream"},"aes-256-ctr":{"cipher":"AES","key":256,"iv":16,"mode":"CTR","type":"stream"},"aes-128-gcm":{"cipher":"AES","key":128,"iv":12,"mode":"GCM","type":"auth"},"aes-192-gcm":{"cipher":"AES","key":192,"iv":12,"mode":"GCM","type":"auth"},"aes-256-gcm":{"cipher":"AES","key":256,"iv":12,"mode":"GCM","type":"auth"}}')},function(e,t,n){var i=n(154),s=n(14).Buffer,r=n(65),o=n(12),a=n(769),c=n(120),l=n(345);function u(e,t,n,o){r.call(this);var c=s.alloc(4,0);this._cipher=new i.AES(t);var u=this._cipher.encryptBlock(c);this._ghash=new a(u),n=function(e,t,n){if(12===t.length)return e._finID=s.concat([t,s.from([0,0,0,1])]),s.concat([t,s.from([0,0,0,2])]);var i=new a(n),r=t.length,o=r%16;i.update(t),o&&(o=16-o,i.update(s.alloc(o,0))),i.update(s.alloc(8,0));var c=8*r,u=s.alloc(8);u.writeUIntBE(c,0,8),i.update(u),e._finID=i.state;var d=s.from(e._finID);return l(d),d}(this,n,u),this._prev=s.from(n),this._cache=s.allocUnsafe(0),this._secCache=s.allocUnsafe(0),this._decrypt=o,this._alen=0,this._len=0,this._mode=e,this._authTag=null,this._called=!1}o(u,r),u.prototype._update=function(e){if(!this._called&&this._alen){var t=16-this._alen%16;t<16&&(t=s.alloc(t,0),this._ghash.update(t))}this._called=!0;var n=this._mode.encrypt(this,e);return this._decrypt?this._ghash.update(e):this._ghash.update(n),this._len+=e.length,n},u.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var e=c(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(e,t){var n=0;e.length!==t.length&&n++;for(var i=Math.min(e.length,t.length),s=0;s<i;++s)n+=e[s]^t[s];return n}(e,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=e,this._cipher.scrub()},u.prototype.getAuthTag=function(){if(this._decrypt||!s.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},u.prototype.setAuthTag=function(e){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=e},u.prototype.setAAD=function(e){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(e),this._alen+=e.length},e.exports=u},function(e,t,n){var i=n(154),s=n(14).Buffer,r=n(65);function o(e,t,n,o){r.call(this),this._cipher=new i.AES(t),this._prev=s.from(n),this._cache=s.allocUnsafe(0),this._secCache=s.allocUnsafe(0),this._decrypt=o,this._mode=e}n(12)(o,r),o.prototype._update=function(e){return this._mode.encrypt(this,e,this._decrypt)},o.prototype._final=function(){this._cipher.scrub()},e.exports=o},function(e,t,n){var i=n(75);e.exports=v,v.simpleSieve=g,v.fermatTest=y;var s=n(25),r=new s(24),o=new(n(350)),a=new s(1),c=new s(2),l=new s(5),u=(new s(16),new s(8),new s(10)),d=new s(3),h=(new s(7),new s(11)),f=new s(4),p=(new s(12),null);function m(){if(null!==p)return p;var e=[];e[0]=2;for(var t=1,n=3;n<1048576;n+=2){for(var i=Math.ceil(Math.sqrt(n)),s=0;s<t&&e[s]<=i&&n%e[s]!=0;s++);t!==s&&e[s]<=i||(e[t++]=n)}return p=e,e}function g(e){for(var t=m(),n=0;n<t.length;n++)if(0===e.modn(t[n]))return 0===e.cmpn(t[n]);return!0}function y(e){var t=s.mont(e);return 0===c.toRed(t).redPow(e.subn(1)).fromRed().cmpn(1)}function v(e,t){if(e<16)return new s(2===t||5===t?[140,123]:[140,39]);var n,p;for(t=new s(t);;){for(n=new s(i(Math.ceil(e/8)));n.bitLength()>e;)n.ishrn(1);if(n.isEven()&&n.iadd(a),n.testn(1)||n.iadd(c),t.cmp(c)){if(!t.cmp(l))for(;n.mod(u).cmp(d);)n.iadd(f)}else for(;n.mod(r).cmp(h);)n.iadd(f);if(g(p=n.shrn(1))&&g(n)&&y(p)&&y(n)&&o.test(p)&&o.test(n))return n}}},function(e,t,n){var i=n(25),s=n(209);function r(e){this.rand=e||new s.Rand}e.exports=r,r.create=function(e){return new r(e)},r.prototype._randbelow=function(e){var t=e.bitLength(),n=Math.ceil(t/8);do{var s=new i(this.rand.generate(n))}while(s.cmp(e)>=0);return s},r.prototype._randrange=function(e,t){var n=t.sub(e);return e.add(this._randbelow(n))},r.prototype.test=function(e,t,n){var s=e.bitLength(),r=i.mont(e),o=new i(1).toRed(r);t||(t=Math.max(1,s/48|0));for(var a=e.subn(1),c=0;!a.testn(c);c++);for(var l=e.shrn(c),u=a.toRed(r);t>0;t--){var d=this._randrange(new i(2),a);n&&n(d);var h=d.toRed(r).redPow(l);if(0!==h.cmp(o)&&0!==h.cmp(u)){for(var f=1;f<c;f++){if(0===(h=h.redSqr()).cmp(o))return!1;if(0===h.cmp(u))break}if(f===c)return!1}}return!0},r.prototype.getDivisor=function(e,t){var n=e.bitLength(),s=i.mont(e),r=new i(1).toRed(s);t||(t=Math.max(1,n/48|0));for(var o=e.subn(1),a=0;!o.testn(a);a++);for(var c=e.shrn(a),l=o.toRed(s);t>0;t--){var u=this._randrange(new i(2),o),d=e.gcd(u);if(0!==d.cmpn(1))return d;var h=u.toRed(s).redPow(c);if(0!==h.cmp(r)&&0!==h.cmp(l)){for(var f=1;f<a;f++){if(0===(h=h.redSqr()).cmp(r))return h.fromRed().subn(1).gcd(e);if(0===h.cmp(l))break}if(f===a)return(h=h.redSqr()).fromRed().subn(1).gcd(e)}}return!1}},function(e,t,n){"use strict";var i=t;function s(e){return 1===e.length?"0"+e:e}function r(e){for(var t="",n=0;n<e.length;n++)t+=s(e[n].toString(16));return t}i.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"!=typeof e){for(var i=0;i<e.length;i++)n[i]=0|e[i];return n}if("hex"===t){(e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e);for(i=0;i<e.length;i+=2)n.push(parseInt(e[i]+e[i+1],16))}else for(i=0;i<e.length;i++){var s=e.charCodeAt(i),r=s>>8,o=255&s;r?n.push(r,o):n.push(o)}return n},i.zero2=s,i.toHex=r,i.encode=function(e,t){return"hex"===t?r(e):e}},function(e,t,n){"use strict";var i=t;i.base=n(156),i.short=n(779),i.mont=n(780),i.edwards=n(781)},function(e,t,n){"use strict";var i=n(48).rotr32;function s(e,t,n){return e&t^~e&n}function r(e,t,n){return e&t^e&n^t&n}function o(e,t,n){return e^t^n}t.ft_1=function(e,t,n,i){return 0===e?s(t,n,i):1===e||3===e?o(t,n,i):2===e?r(t,n,i):void 0},t.ch32=s,t.maj32=r,t.p32=o,t.s0_256=function(e){return i(e,2)^i(e,13)^i(e,22)},t.s1_256=function(e){return i(e,6)^i(e,11)^i(e,25)},t.g0_256=function(e){return i(e,7)^i(e,18)^e>>>3},t.g1_256=function(e){return i(e,17)^i(e,19)^e>>>10}},function(e,t,n){"use strict";var i=n(48),s=n(122),r=n(353),o=n(38),a=i.sum32,c=i.sum32_4,l=i.sum32_5,u=r.ch32,d=r.maj32,h=r.s0_256,f=r.s1_256,p=r.g0_256,m=r.g1_256,g=s.BlockHash,y=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function v(){if(!(this instanceof v))return new v;g.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=y,this.W=new Array(64)}i.inherits(v,g),e.exports=v,v.blockSize=512,v.outSize=256,v.hmacStrength=192,v.padLength=64,v.prototype._update=function(e,t){for(var n=this.W,i=0;i<16;i++)n[i]=e[t+i];for(;i<n.length;i++)n[i]=c(m(n[i-2]),n[i-7],p(n[i-15]),n[i-16]);var s=this.h[0],r=this.h[1],g=this.h[2],y=this.h[3],v=this.h[4],S=this.h[5],_=this.h[6],E=this.h[7];for(o(this.k.length===n.length),i=0;i<n.length;i++){var w=l(E,f(v),u(v,S,_),this.k[i],n[i]),b=a(h(s),d(s,r,g));E=_,_=S,S=v,v=a(y,w),y=g,g=r,r=s,s=a(w,b)}this.h[0]=a(this.h[0],s),this.h[1]=a(this.h[1],r),this.h[2]=a(this.h[2],g),this.h[3]=a(this.h[3],y),this.h[4]=a(this.h[4],v),this.h[5]=a(this.h[5],S),this.h[6]=a(this.h[6],_),this.h[7]=a(this.h[7],E)},v.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},function(e,t,n){"use strict";var i=n(48),s=n(122),r=n(38),o=i.rotr64_hi,a=i.rotr64_lo,c=i.shr64_hi,l=i.shr64_lo,u=i.sum64,d=i.sum64_hi,h=i.sum64_lo,f=i.sum64_4_hi,p=i.sum64_4_lo,m=i.sum64_5_hi,g=i.sum64_5_lo,y=s.BlockHash,v=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function S(){if(!(this instanceof S))return new S;y.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=v,this.W=new Array(160)}function _(e,t,n,i,s){var r=e&n^~e&s;return r<0&&(r+=4294967296),r}function E(e,t,n,i,s,r){var o=t&i^~t&r;return o<0&&(o+=4294967296),o}function w(e,t,n,i,s){var r=e&n^e&s^n&s;return r<0&&(r+=4294967296),r}function b(e,t,n,i,s,r){var o=t&i^t&r^i&r;return o<0&&(o+=4294967296),o}function C(e,t){var n=o(e,t,28)^o(t,e,2)^o(t,e,7);return n<0&&(n+=4294967296),n}function T(e,t){var n=a(e,t,28)^a(t,e,2)^a(t,e,7);return n<0&&(n+=4294967296),n}function M(e,t){var n=o(e,t,14)^o(e,t,18)^o(t,e,9);return n<0&&(n+=4294967296),n}function A(e,t){var n=a(e,t,14)^a(e,t,18)^a(t,e,9);return n<0&&(n+=4294967296),n}function k(e,t){var n=o(e,t,1)^o(e,t,8)^c(e,t,7);return n<0&&(n+=4294967296),n}function R(e,t){var n=a(e,t,1)^a(e,t,8)^l(e,t,7);return n<0&&(n+=4294967296),n}function P(e,t){var n=o(e,t,19)^o(t,e,29)^c(e,t,6);return n<0&&(n+=4294967296),n}function I(e,t){var n=a(e,t,19)^a(t,e,29)^l(e,t,6);return n<0&&(n+=4294967296),n}i.inherits(S,y),e.exports=S,S.blockSize=1024,S.outSize=512,S.hmacStrength=192,S.padLength=128,S.prototype._prepareBlock=function(e,t){for(var n=this.W,i=0;i<32;i++)n[i]=e[t+i];for(;i<n.length;i+=2){var s=P(n[i-4],n[i-3]),r=I(n[i-4],n[i-3]),o=n[i-14],a=n[i-13],c=k(n[i-30],n[i-29]),l=R(n[i-30],n[i-29]),u=n[i-32],d=n[i-31];n[i]=f(s,r,o,a,c,l,u,d),n[i+1]=p(s,r,o,a,c,l,u,d)}},S.prototype._update=function(e,t){this._prepareBlock(e,t);var n=this.W,i=this.h[0],s=this.h[1],o=this.h[2],a=this.h[3],c=this.h[4],l=this.h[5],f=this.h[6],p=this.h[7],y=this.h[8],v=this.h[9],S=this.h[10],k=this.h[11],R=this.h[12],P=this.h[13],I=this.h[14],N=this.h[15];r(this.k.length===n.length);for(var L=0;L<n.length;L+=2){var D=I,x=N,O=M(y,v),F=A(y,v),U=_(y,v,S,k,R),j=E(y,v,S,k,R,P),H=this.k[L],B=this.k[L+1],Y=n[L],W=n[L+1],q=m(D,x,O,F,U,j,H,B,Y,W),V=g(D,x,O,F,U,j,H,B,Y,W);D=C(i,s),x=T(i,s),O=w(i,s,o,a,c),F=b(i,s,o,a,c,l);var $=d(D,x,O,F),K=h(D,x,O,F);I=R,N=P,R=S,P=k,S=y,k=v,y=d(f,p,q,V),v=h(p,p,q,V),f=c,p=l,c=o,l=a,o=i,a=s,i=d(q,V,$,K),s=h(q,V,$,K)}u(this.h,0,i,s),u(this.h,2,o,a),u(this.h,4,c,l),u(this.h,6,f,p),u(this.h,8,y,v),u(this.h,10,S,k),u(this.h,12,R,P),u(this.h,14,I,N)},S.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},function(e,t,n){var i=n(12),s=n(124).Reporter,r=n(3).Buffer;function o(e,t){s.call(this,t),r.isBuffer(e)?(this.base=e,this.offset=0,this.length=e.length):this.error("Input not Buffer")}function a(e,t){if(Array.isArray(e))this.length=0,this.value=e.map((function(e){return e instanceof a||(e=new a(e,t)),this.length+=e.length,e}),this);else if("number"==typeof e){if(!(0<=e&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if("string"==typeof e)this.value=e,this.length=r.byteLength(e);else{if(!r.isBuffer(e))return t.error("Unsupported type: "+typeof e);this.value=e,this.length=e.length}}i(o,s),t.DecoderBuffer=o,o.prototype.save=function(){return{offset:this.offset,reporter:s.prototype.save.call(this)}},o.prototype.restore=function(e){var t=new o(this.base);return t.offset=e.offset,t.length=this.offset,this.offset=e.offset,s.prototype.restore.call(this,e.reporter),t},o.prototype.isEmpty=function(){return this.offset===this.length},o.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")},o.prototype.skip=function(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");var n=new o(this.base);return n._reporterState=this._reporterState,n.offset=this.offset,n.length=this.offset+e,this.offset+=e,n},o.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)},t.EncoderBuffer=a,a.prototype.join=function(e,t){return e||(e=new r(this.length)),t||(t=0),0===this.length||(Array.isArray(this.value)?this.value.forEach((function(n){n.join(e,t),t+=n.length})):("number"==typeof this.value?e[t]=this.value:"string"==typeof this.value?e.write(this.value,t):r.isBuffer(this.value)&&this.value.copy(e,t),t+=this.length)),e}},function(e,t,n){var i=t;i._reverse=function(e){var t={};return Object.keys(e).forEach((function(n){(0|n)==n&&(n|=0);var i=e[n];t[i]=n})),t},i.der=n(801)},function(e,t,n){var i=n(12),s=n(123),r=s.base,o=s.bignum,a=s.constants.der;function c(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new l,this.tree._init(e.body)}function l(e){r.Node.call(this,"der",e)}function u(e,t){var n=e.readUInt8(t);if(e.isError(n))return n;var i=a.tagClass[n>>6],s=0==(32&n);if(31==(31&n)){var r=n;for(n=0;128==(128&r);){if(r=e.readUInt8(t),e.isError(r))return r;n<<=7,n|=127&r}}else n&=31;return{cls:i,primitive:s,tag:n,tagStr:a.tag[n]}}function d(e,t,n){var i=e.readUInt8(n);if(e.isError(i))return i;if(!t&&128===i)return null;if(0==(128&i))return i;var s=127&i;if(s>4)return e.error("length octect is too long");i=0;for(var r=0;r<s;r++){i<<=8;var o=e.readUInt8(n);if(e.isError(o))return o;i|=o}return i}e.exports=c,c.prototype.decode=function(e,t){return e instanceof r.DecoderBuffer||(e=new r.DecoderBuffer(e,t)),this.tree._decode(e,t)},i(l,r.Node),l.prototype._peekTag=function(e,t,n){if(e.isEmpty())return!1;var i=e.save(),s=u(e,'Failed to peek tag: "'+t+'"');return e.isError(s)?s:(e.restore(i),s.tag===t||s.tagStr===t||s.tagStr+"of"===t||n)},l.prototype._decodeTag=function(e,t,n){var i=u(e,'Failed to decode tag of "'+t+'"');if(e.isError(i))return i;var s=d(e,i.primitive,'Failed to get length of "'+t+'"');if(e.isError(s))return s;if(!n&&i.tag!==t&&i.tagStr!==t&&i.tagStr+"of"!==t)return e.error('Failed to match tag: "'+t+'"');if(i.primitive||null!==s)return e.skip(s,'Failed to match body of: "'+t+'"');var r=e.save(),o=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');return e.isError(o)?o:(s=e.offset-r.offset,e.restore(r),e.skip(s,'Failed to match body of: "'+t+'"'))},l.prototype._skipUntilEnd=function(e,t){for(;;){var n=u(e,t);if(e.isError(n))return n;var i,s=d(e,n.primitive,t);if(e.isError(s))return s;if(i=n.primitive||null!==s?e.skip(s):this._skipUntilEnd(e,t),e.isError(i))return i;if("end"===n.tagStr)break}},l.prototype._decodeList=function(e,t,n,i){for(var s=[];!e.isEmpty();){var r=this._peekTag(e,"end");if(e.isError(r))return r;var o=n.decode(e,"der",i);if(e.isError(o)&&r)break;s.push(o)}return s},l.prototype._decodeStr=function(e,t){if("bitstr"===t){var n=e.readUInt8();return e.isError(n)?n:{unused:n,data:e.raw()}}if("bmpstr"===t){var i=e.raw();if(i.length%2==1)return e.error("Decoding of string type: bmpstr length mismatch");for(var s="",r=0;r<i.length/2;r++)s+=String.fromCharCode(i.readUInt16BE(2*r));return s}if("numstr"===t){var o=e.raw().toString("ascii");return this._isNumstr(o)?o:e.error("Decoding of string type: numstr unsupported characters")}if("octstr"===t)return e.raw();if("objDesc"===t)return e.raw();if("printstr"===t){var a=e.raw().toString("ascii");return this._isPrintstr(a)?a:e.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(t)?e.raw().toString():e.error("Decoding of string type: "+t+" unsupported")},l.prototype._decodeObjid=function(e,t,n){for(var i,s=[],r=0;!e.isEmpty();){var o=e.readUInt8();r<<=7,r|=127&o,0==(128&o)&&(s.push(r),r=0)}128&o&&s.push(r);var a=s[0]/40|0,c=s[0]%40;if(i=n?s:[a,c].concat(s.slice(1)),t){var l=t[i.join(" ")];void 0===l&&(l=t[i.join(".")]),void 0!==l&&(i=l)}return i},l.prototype._decodeTime=function(e,t){var n=e.raw().toString();if("gentime"===t)var i=0|n.slice(0,4),s=0|n.slice(4,6),r=0|n.slice(6,8),o=0|n.slice(8,10),a=0|n.slice(10,12),c=0|n.slice(12,14);else{if("utctime"!==t)return e.error("Decoding "+t+" time is not supported yet");i=0|n.slice(0,2),s=0|n.slice(2,4),r=0|n.slice(4,6),o=0|n.slice(6,8),a=0|n.slice(8,10),c=0|n.slice(10,12);i=i<70?2e3+i:1900+i}return Date.UTC(i,s-1,r,o,a,c,0)},l.prototype._decodeNull=function(e){return null},l.prototype._decodeBool=function(e){var t=e.readUInt8();return e.isError(t)?t:0!==t},l.prototype._decodeInt=function(e,t){var n=e.raw(),i=new o(n);return t&&(i=t[i.toString(10)]||i),i},l.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getDecoder("der").tree}},function(e,t,n){var i=n(12),s=n(3).Buffer,r=n(123),o=r.base,a=r.constants.der;function c(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new l,this.tree._init(e.body)}function l(e){o.Node.call(this,"der",e)}function u(e){return e<10?"0"+e:e}e.exports=c,c.prototype.encode=function(e,t){return this.tree._encode(e,t).join()},i(l,o.Node),l.prototype._encodeComposite=function(e,t,n,i){var r,o=function(e,t,n,i){var s;"seqof"===e?e="seq":"setof"===e&&(e="set");if(a.tagByName.hasOwnProperty(e))s=a.tagByName[e];else{if("number"!=typeof e||(0|e)!==e)return i.error("Unknown tag: "+e);s=e}if(s>=31)return i.error("Multi-octet tag encoding unsupported");t||(s|=32);return s|=a.tagClassByName[n||"universal"]<<6}(e,t,n,this.reporter);if(i.length<128)return(r=new s(2))[0]=o,r[1]=i.length,this._createEncoderBuffer([r,i]);for(var c=1,l=i.length;l>=256;l>>=8)c++;(r=new s(2+c))[0]=o,r[1]=128|c;l=1+c;for(var u=i.length;u>0;l--,u>>=8)r[l]=255&u;return this._createEncoderBuffer([r,i])},l.prototype._encodeStr=function(e,t){if("bitstr"===t)return this._createEncoderBuffer([0|e.unused,e.data]);if("bmpstr"===t){for(var n=new s(2*e.length),i=0;i<e.length;i++)n.writeUInt16BE(e.charCodeAt(i),2*i);return this._createEncoderBuffer(n)}return"numstr"===t?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===t?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(t)||"objDesc"===t?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+t+" unsupported")},l.prototype._encodeObjid=function(e,t,n){if("string"==typeof e){if(!t)return this.reporter.error("string objid given, but no values map found");if(!t.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=t[e].split(/[\s\.]+/g);for(var i=0;i<e.length;i++)e[i]|=0}else if(Array.isArray(e)){e=e.slice();for(i=0;i<e.length;i++)e[i]|=0}if(!Array.isArray(e))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(e));if(!n){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,40*e[0]+e[1])}var r=0;for(i=0;i<e.length;i++){var o=e[i];for(r++;o>=128;o>>=7)r++}var a=new s(r),c=a.length-1;for(i=e.length-1;i>=0;i--){o=e[i];for(a[c--]=127&o;(o>>=7)>0;)a[c--]=128|127&o}return this._createEncoderBuffer(a)},l.prototype._encodeTime=function(e,t){var n,i=new Date(e);return"gentime"===t?n=[u(i.getFullYear()),u(i.getUTCMonth()+1),u(i.getUTCDate()),u(i.getUTCHours()),u(i.getUTCMinutes()),u(i.getUTCSeconds()),"Z"].join(""):"utctime"===t?n=[u(i.getFullYear()%100),u(i.getUTCMonth()+1),u(i.getUTCDate()),u(i.getUTCHours()),u(i.getUTCMinutes()),u(i.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+t+" time is not supported yet"),this._encodeStr(n,"octstr")},l.prototype._encodeNull=function(){return this._createEncoderBuffer("")},l.prototype._encodeInt=function(e,t){if("string"==typeof e){if(!t)return this.reporter.error("String int or enum given, but no values map");if(!t.hasOwnProperty(e))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e));e=t[e]}if("number"!=typeof e&&!s.isBuffer(e)){var n=e.toArray();!e.sign&&128&n[0]&&n.unshift(0),e=new s(n)}if(s.isBuffer(e)){var i=e.length;0===e.length&&i++;var r=new s(i);return e.copy(r),0===e.length&&(r[0]=0),this._createEncoderBuffer(r)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);i=1;for(var o=e;o>=256;o>>=8)i++;for(o=(r=new Array(i)).length-1;o>=0;o--)r[o]=255&e,e>>=8;return 128&r[0]&&r.unshift(0),this._createEncoderBuffer(new s(r))},l.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},l.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getEncoder("der").tree},l.prototype._skipDefault=function(e,t,n){var i,s=this._baseState;if(null===s.default)return!1;var r=e.join();if(void 0===s.defaultBuffer&&(s.defaultBuffer=this._encodeValue(s.default,t,n).join()),r.length!==s.defaultBuffer.length)return!1;for(i=0;i<r.length;i++)if(r[i]!==s.defaultBuffer[i])return!1;return!0}},function(e){e.exports=JSON.parse('{"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}')},function(e,t,n){var i=n(118),s=n(14).Buffer;function r(e){var t=s.allocUnsafe(4);return t.writeUInt32BE(e,0),t}e.exports=function(e,t){for(var n,o=s.alloc(0),a=0;o.length<t;)n=r(a++),o=s.concat([o,i("sha1").update(e).update(n).digest()]);return o.slice(0,t)}},function(e,t){e.exports=function(e,t){for(var n=e.length,i=-1;++i<n;)e[i]^=t[i];return e}},function(e,t,n){var i=n(25),s=n(14).Buffer;e.exports=function(e,t){return s.from(e.toRed(i.mont(t.modulus)).redPow(new i(t.publicExponent)).fromRed().toArray())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(91);class s extends i.BaseError{constructor(){super(...arguments),this.errorType="AssertionError"}}t.AssertionError=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(125),s=n(78),r=n(368),o=(e,t)=>{if(t)throw e.lastError;throw e},a={retries:2,retryDelay:0,shouldStopRetries:()=>!1,isAggregateError:!0};t.withRetries=async(e,n={},c=new i.AggregateError)=>{const l=Object.assign(Object.assign({},a),n),{retries:u,retryDelay:d,shouldStopRetries:h,cancellationToken:f,isAggregateError:p}=l,m=new i.AssertionError("Retries should have at least zero retries.");s.assert(u>-1,p?c.cloneWithErrors(m):m);try{return s.assert(!(null==f?void 0:f.isCancellationRequested),new i.CancellationError("CancellationToken is cancelled.")),await e(u)}catch(n){if(c.addErrors(n),await h(n))return o(c,!p);if(n instanceof i.CancellationError)return o(c,!p);const a=new i.CancellationError("CancellationToken is cancelled after retry.");return s.assert(!(null==f?void 0:f.isCancellationRequested),p?c.cloneWithErrors(a):a),u>0?(await r.wait(d),await t.withRetries(e,Object.assign(Object.assign({},l),{retries:u-1}),c)):o(c,!p)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(91);class s extends i.BaseError{constructor(e,t,n){super(t,n),this.errorList=e,this.errorType="PromiseRaceError"}}t.PromiseRaceError=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(91);class s extends i.BaseError{constructor(){super(...arguments),this.errorType="CancellationError"}}t.CancellationError=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wait=e=>new Promise(t=>{setTimeout(t,e)})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(828);t.DisposableClass=i.DisposableClass;var s=n(216);t.Signal=s.Signal;var r=n(829);t.Mutex=r.Mutex;var o=n(830);t.CallbackContainer=o.CallbackContainer},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hashString=e=>e.split("").reduce((e,t)=>(e=((e<<5)-e+t).charCodeAt(0))&e,0).toString()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDisposable=e=>({dispose:e})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.obfusticatePaths=(e,t="")=>e.replace(/([A-Za-z]:)?(\S*[\\\/])+\S*/gi,(e,n,i,s,r)=>{if(/^\d{1,4}\/\d{1,2}\/\d{1,4}$/.test(e))return e;{const s=(n?n.length:0)+i.length,r=e.substr(s);return t+r}}),t.obfusticateEmailAddresses=e=>e.replace(/[\S]+@[\S]+/gi,"[EMAIL]"),t.cleanupPII=e=>e?t.obfusticateEmailAddresses(t.obfusticatePaths(e,"[PATH]/")):e},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(75));t.randomBytes=e=>s.default(e)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(372);t.errorToObject=(e,t=!0)=>{const n=e,{errorCode:s=-1,errorType:r="GenericError",message:o="<no message>",originalErrorType:a="<no original type>"}=n;return{errorMessage:o,originalErrorType:a,errorCode:s,errorType:r,stack:t?n.stack:i.cleanupPII(n.stack)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RpcLoggerAdapter=class{constructor(e){this.trace=e}error(e){this.trace.error(e)}warn(e){this.trace.warning(e)}info(e){this.trace.info(e)}log(e){this.trace.verbose(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(){super("RPC connection closed."),this.code=i.code,Object.setPrototypeOf(this,i.prototype)}}t.RpcConnectionClosedError=i,i.code="EPIPE";class s extends Error{constructor(){super("RPC connection closed due to client shut down."),this.code=s.code,Object.setPrototypeOf(this,s.prototype)}}t.RpcConnectionShutdownError=s,s.code="ECONNRESET"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(19);function s(e){const t=[...e];return r(t),t}function r(e){const t=e.splice(0,1)[0];if(e.length>0){const n=e[e.length-1];if(n.constructor&&"MutableToken"===n.constructor.name){return[t,e.splice(e.length-1,1)[0]]}}return[t,null]}t.getRawRpcParameters=s,t.normalizeRpcParameters=r,t.sendRpcRequest=async function(e,t,n,r){try{const o=Date.now(),a=await e.sendRequest(t,s(n)),c=(Date.now()-o).toFixed(1);return null==r||r.info(`remote rpc request method: "${t}" result: "${i.TraceFormat.stringify(a)}\n            t:${c}`),a}catch(e){throw null==r||r.error(`failed to handle request for method:${t}`,e),e}}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);e.exports=function(){return n(i),i}}else{var s=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}},function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,s=n;return[s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]]].join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Error=0]="Error",e[e.User=1]="User",e[e.Unknown=2]="Unknown",e[e.NonBlockingFault=3]="NonBlockingFault",e[e.UserCancelled=4]="UserCancelled",e[e.ByDesign=5]="ByDesign"}(t.FaultType||(t.FaultType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Cancel=0]="Cancel",e[e.Success=1]="Success",e[e.Failure=2]="Failure",e[e.UserFailure=3]="UserFailure",e[e.IndeterminateFailure=4]="IndeterminateFailure",e[e.NonBlockingFailure=5]="NonBlockingFailure",e[e.ByDesignFailure=6]="ByDesignFailure"}(t.Result||(t.Result={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setLogLocation=function(e){},t.getLogLocation=function(){},t.createLogFileListener=function(){return Promise.resolve(void 0)}},function(e,t,n){"use strict";const i=Symbol("singleComment"),s=Symbol("multiComment"),r=()=>"",o=(e,t,n)=>e.slice(t,n).replace(/\S/g," "),a=(e,t)=>{let n=t-1,i=0;for(;"\\"===e[n];)n-=1,i+=1;return Boolean(i%2)};e.exports=(e,t={})=>{const n=!1===t.whitespace?r:o;let c=!1,l=!1,u=0,d="";for(let t=0;t<e.length;t++){const r=e[t],o=e[t+1];if(!l&&'"'===r){a(e,t)||(c=!c)}if(!c)if(l||r+o!=="//"){if(l===i&&r+o==="\r\n"){t++,l=!1,d+=n(e,u,t),u=t;continue}if(l===i&&"\n"===r)l=!1,d+=n(e,u,t),u=t;else{if(!l&&r+o==="/*"){d+=e.slice(u,t),u=t,l=s,t++;continue}if(l===s&&r+o==="*/"){t++,l=!1,d+=n(e,u,t+1),u=t+1;continue}}}else d+=e.slice(u,t),u=t,l=i,t++}return d+(l?n(e.slice(u)):e.slice(u))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CommandDecoratorBase=class{constructor(e=!0){this.enableProfiling=e}setup(){const e=this,t=e.constructor.name.replace("CommandDecorator","");return this.enableProfiling?function(n){const i=class extends n{constructor(...t){super(...t),e.decorate&&e.decorate(this)}async invoke(n,i){let s,r;i.trace.info(`Decorator starting: ${t}`);const o=super.invoke.bind(this),a=async(e,t)=>{s=Date.now();try{return await o(e,t)}finally{r=Date.now()}},c=Date.now();try{return await e.invoke(a,n,i)}finally{const e=Date.now(),n=(s||e)-c,o=e-(r||e),a=n+o;i.trace.info(`Decorator finishing: ${t}. `+`Duration: ${a}ms (${n} + ${o})`)}}};return Object.defineProperty(i,"name",{writable:!1,value:n.name}),i}:function(t){const n=class extends t{constructor(...t){super(...t),e.decorate&&e.decorate(this)}invoke(t,n){const i=super.invoke.bind(this);return e.invoke(i,t,n)}};return Object.defineProperty(n,"name",{writable:!1,value:t.name}),n}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{static get Instance(){return i.singleton||(i.singleton=new i),i.singleton}get notificationProgressLocation(){return n(0).ProgressLocation.Notification}async showInformationMessage(e,t,...i){if(!t)return(await Promise.resolve().then(()=>n(0))).window.showInformationMessage(e,...i)}async showErrorMessage(e,...t){return(await Promise.resolve().then(()=>n(0))).window.showErrorMessage(e,...t)}async showWarningMessage(e,t,...i){return t?(await Promise.resolve().then(()=>n(0))).window.showWarningMessage(e,t,...i):(await Promise.resolve().then(()=>n(0))).window.showWarningMessage(e,...i)}async showInputBox(e,t){return(await Promise.resolve().then(()=>n(0))).window.showInputBox(e,t)}async showQuickPick(e,t,i,s,r={}){let o=!1;Array.isArray(e)?Array.isArray(e)&&"string"==typeof e[0]&&(o=!0,e=e.map(e=>({label:e}))):e=await e;let a=await new Promise(async(i,o)=>{const a=(await Promise.resolve().then(()=>n(0))).window.createQuickPick();a.items=e,a.activeItems=e.filter(e=>e.picked),a.canSelectMany=(null==t?void 0:t.canPickMany)||!1,a.placeholder=(null==t?void 0:t.placeHolder)||"",a.ignoreFocusOut=(null==t?void 0:t.ignoreFocusOut)||!1,a.matchOnDetail=(null==t?void 0:t.matchOnDetail)||!1,a.matchOnDescription=(null==t?void 0:t.matchOnDescription)||!1,a.value=s,r.onDidChangeValue&&a.onDidChangeValue(e=>{const t=r.onDidChangeValue(e);t.activeItems&&(a.activeItems=t.activeItems),t.selectedItems&&(a.selectedItems=t.selectedItems)}),a.onDidAccept(async()=>{if(r.onDidAccept){if(!1===await r.onDidAccept(a.selectedItems,a.value))return}a.hide(),i(a.canSelectMany?a.selectedItems:a.selectedItems[0])}),a.onDidHide(()=>{r.onDidHide&&r.onDidHide(),i(null)}),a.show()});return o&&a&&(a=Array.isArray(a)?a.map(e=>e.label):a.label),a}async withProgress(e,t,i){return(await Promise.resolve().then(()=>n(0))).window.withProgress(e,t)}async showOpenDialog(e){return(await Promise.resolve().then(()=>n(0))).window.showOpenDialog(e)}async createQuickPick(e,t,i){const s=t.map(e=>({label:e}));return new Promise((t,r)=>{const o=n(0).window.createQuickPick();o.placeholder=e,o.items=s,o.activeItems=o.items.filter(e=>e.label===i),o.onDidChangeValue(e=>{o.items=e?[{label:e},...s]:s}),o.onDidAccept(()=>{o.hide(),t(o.selectedItems[0].label)}),o.show()})}createQuickPickWithRefresh(e,t,i,s){const r=n(0).window.createQuickPick();return{setItems:e=>{r.placeholder=t,r.items=e,r.busy=!1},cancel:()=>{r.dispose()},valuePromise:new Promise(t=>{r.placeholder=e,r.items=[],r.ignoreFocusOut=!0,r.busy=!0;let n="";r.onDidChangeValue(e=>{n=e,i&&(r.busy=!0,i(e).then(e=>{r.items=e,r.busy=!1}))}),r.onDidAccept(async()=>{if(r.enabled=!1,r.selectedItems.length<1){const e=n;if(!s||!await s(e))return void(r.enabled=!0);t(e),r.dispose()}else t(r.selectedItems[0]),r.dispose()}),r.show()})}}async showSaveDialog(e){return(await Promise.resolve().then(()=>n(0))).window.showSaveDialog(e)}}t.NotificationUtilClass=i;const s=i.Instance;t.NotificationUtil=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(92),s=n(9);class r extends i.CommandError{constructor(e,t){super({message:e,code:t,telemetryResult:s.TelemetryResult.ByDesignFailure})}}t.ByDesignError=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(92),s=n(9);class r extends i.CommandError{constructor(e,t){super({message:e,code:t,telemetryResult:s.TelemetryResult.UserFailure})}}t.UserError=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(92),s=n(9);class r extends i.CommandError{constructor(e,t){super({message:e,code:t,telemetryResult:s.TelemetryResult.Cancel})}}t.CancellationError=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(92),s=n(9);class r extends i.CommandError{constructor(e,t){super({message:e,code:t,telemetryResult:s.TelemetryResult.NonBlockingFailure})}}t.NonBlockingError=r},function(e,t,n){"use strict";e.exports=function(e,t,n,i){for(var s=65535&e|0,r=e>>>16&65535|0,o=0;0!==n;){n-=o=n>2e3?2e3:n;do{r=r+(s=s+t[i++]|0)|0}while(--o);s%=65521,r%=65521}return s|r<<16|0}},function(e,t,n){"use strict";var i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();e.exports=function(e,t,n,s){var r=i,o=s+n;e^=-1;for(var a=s;a<o;a++)e=e>>>8^r[255&(e^t[a])];return-1^e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6),s=n(225),r=n(393);class o extends i.DisposableClass{constructor(e){super(e.createChild("vscode-activity-provider")),this.addToDisposables(o.vscode.workspace.onDidChangeTextDocument(e=>{this.onActivity(r.VscodeActivityType.changeTextDocument)}),o.vscode.workspace.onDidOpenTextDocument(e=>{this.onActivity(r.VscodeActivityType.openTextDocument)}),o.vscode.workspace.onDidCloseTextDocument(e=>{this.onActivity(r.VscodeActivityType.closeTextDocument)}),o.vscode.workspace.onDidSaveTextDocument(e=>{this.onActivity(r.VscodeActivityType.saveTextDocument)}),o.vscode.debug.onDidStartDebugSession(e=>{this.onActivity(r.VscodeActivityType.startDebugSession)}),o.vscode.debug.onDidTerminateDebugSession(e=>{this.onActivity(r.VscodeActivityType.terminateDebugSession)}),o.vscode.debug.onDidChangeBreakpoints(e=>{this.onActivity(r.VscodeActivityType.changeBreakpoints)}),o.vscode.tasks.onDidStartTask(e=>{this.onActivity(r.VscodeActivityType.startTask)}),o.vscode.tasks.onDidEndTask(e=>{this.onActivity(r.VscodeActivityType.endTask)}),o.vscode.tasks.onDidStartTaskProcess(e=>{this.onActivity(r.VscodeActivityType.startTaskProcess)}),o.vscode.tasks.onDidEndTaskProcess(e=>{this.onActivity(r.VscodeActivityType.endTaskProcess)}),o.vscode.window.onDidChangeActiveTextEditor(e=>{this.onActivity(r.VscodeActivityType.changeActiveTextEditor)}),o.vscode.window.onDidOpenTerminal(e=>{this.onActivity(r.VscodeActivityType.openTerminal)}),o.vscode.window.onDidCloseTerminal(e=>{this.onActivity(r.VscodeActivityType.closeTerminal)})),s.dataScrapingManagerInstance.registerDataScraper("vscodeEventsRegistration",()=>({init:this.onActivity.bind(this),processData:this.onActivity.bind(this),dispose(){}})).then(e=>{this.addToDisposables(e)});const t=o.vscode.notebook;if(t)try{"function"==typeof t.onDidOpenNotebookDocument&&this.addToDisposables(t.onDidOpenNotebookDocument(()=>{this.onActivity(r.VscodeActivityType.openNotebookDocument)})),"function"==typeof t.onDidCloseNotebookDocument&&this.addToDisposables(t.onDidCloseNotebookDocument(()=>{this.onActivity(r.VscodeActivityType.closeNotebookDocument)})),"function"==typeof t.onDidSaveNotebookDocument&&this.addToDisposables(t.onDidSaveNotebookDocument(()=>{this.onActivity(r.VscodeActivityType.saveNotebookDocument)})),"function"==typeof t.onDidChangeVisibleNotebookEditors&&this.addToDisposables(t.onDidChangeVisibleNotebookEditors(()=>{this.onActivity(r.VscodeActivityType.changeVisibleNotebookEditors)})),"function"==typeof t.onDidChangeNotebookEditorSelection&&this.addToDisposables(t.onDidChangeNotebookEditorSelection(()=>{this.onActivity(r.VscodeActivityType.changeNotebookEditorSelection)})),"function"==typeof t.onDidChangeNotebookCells&&this.addToDisposables(t.onDidChangeNotebookCells(()=>{this.onActivity(r.VscodeActivityType.changeNotebookCells)})),"function"==typeof t.onDidChangeCellOutputs&&this.addToDisposables(t.onDidChangeCellOutputs(()=>{this.onActivity(r.VscodeActivityType.changeCellOutputs)})),"function"==typeof t.onDidChangeActiveNotebookEditor&&this.addToDisposables(t.onDidChangeActiveNotebookEditor(()=>{this.onActivity(r.VscodeActivityType.changeActiveNotebookEditor)})),"function"==typeof t.onDidChangeActiveNotebookKernel&&this.addToDisposables(t.onDidChangeActiveNotebookKernel(()=>{this.onActivity(r.VscodeActivityType.changeActiveNotebookKernel)}))}catch(e){if(!(e instanceof Error&&e.message.includes("Proposed API")))throw e}this.addToDisposables(o.vscode.languages.registerHoverProvider("*",{provideHover:()=>(this.onActivity(r.VscodeActivityType.registerHoverProvider),null)}))}static get vscode(){return n(0)}}t.VscodeActivityProvider=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.changeTextDocument=0]="changeTextDocument",e[e.openTextDocument=1]="openTextDocument",e[e.closeTextDocument=2]="closeTextDocument",e[e.saveTextDocument=3]="saveTextDocument",e[e.startDebugSession=4]="startDebugSession",e[e.terminateDebugSession=5]="terminateDebugSession",e[e.changeBreakpoints=6]="changeBreakpoints",e[e.startTask=7]="startTask",e[e.endTask=8]="endTask",e[e.startTaskProcess=9]="startTaskProcess",e[e.endTaskProcess=10]="endTaskProcess",e[e.changeActiveTextEditor=11]="changeActiveTextEditor",e[e.openTerminal=12]="openTerminal",e[e.closeTerminal=13]="closeTerminal",e[e.openNotebookDocument=14]="openNotebookDocument",e[e.closeNotebookDocument=15]="closeNotebookDocument",e[e.saveNotebookDocument=16]="saveNotebookDocument",e[e.changeVisibleNotebookEditors=17]="changeVisibleNotebookEditors",e[e.changeNotebookEditorSelection=18]="changeNotebookEditorSelection",e[e.changeNotebookCells=19]="changeNotebookCells",e[e.changeCellOutputs=20]="changeCellOutputs",e[e.changeActiveNotebookEditor=21]="changeActiveNotebookEditor",e[e.changeActiveNotebookKernel=22]="changeActiveNotebookKernel",e[e.registerHoverProvider=23]="registerHoverProvider",e[e.initialActivitySignal=24]="initialActivitySignal",e[e.typeInTerminal=25]="typeInTerminal",e[e.clickedDialog=26]="clickedDialog"}(t.VscodeActivityType||(t.VscodeActivityType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Active=0]="Active",e[e.Idle=1]="Idle"}(t.VscodeSessionStatus||(t.VscodeSessionStatus={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={"statusbar.placeHolder":"What would you like to do with other collaborators?","statusbar.InviteOthers":"Invite Others (Copy Link)","statusbar.InviteOthersMessage":"Copy the invitation link so you can send it to other participants.","statusbar.FocusParticipants":"Focus Participants","statusbar.FocusParticipantsMessage":"Request other participants to follow you.","statusbar.ShareReadOnlyTerminal":"Share Read-only Terminal","statusbar.ShareTerminal":"Share Terminal","statusbar.ShareTerminalMessage":"Start a new terminal / command prompt for use by all participants.","statusbar.ShareServer":"Share Server","statusbar.ShareServerMessage":"Expose a local TCP port to all participants.","statusbar.ShowSharedServers":"Show Shared Servers","statusbar.ShowSharedServersMessage":"Show local TCP servers shared with collaboration participants.","statusbar.StartCollaboration":"Start Collaboration Session","statusbar.StopSharingServer":"Stop Sharing Server","statusbar.StopSharingServerMessage":"Stop sharing a local TCP port for all participants.","statusbar.StopCollaborationSession":"Stop Collaboration Session","statusbar.StopCollaborationSessionMessage":"Stop collaboration session, stop sharing all content, and remove all participant access.","statusbar.SignInMessage":"Sign in with your GitHub or Microsoft account to gain read/write access.","statusbar.AttachSharedDebuggingSession":"Attach to a Shared Debugging Session","statusbar.AttachSharedDebuggingSessionMessage":"Attach your debugger to a debug session that the host has shared with participants.","statusbar.AccessSharedTerminal":"Access Shared Terminal","statusbar.AccessSharedTerminalMessage":"Open terminal that the host has shared with participants.","statusbar.AccessSharedServer":"Access Shared Server","statusbar.AccessSharedServerMessage":"Copy a named, shared TCP port for use","statusbar.LeaveCollaborationSession":"Leave Collaboration Session","statusbar.LeaveCollaborationSessionMessage":"Stop participating in this collaboration session.","statusbar.SignedUserPlaceholder":"What would you like to do?","statusbar.StartSession":"Start Collaboration Session","statusbar.StartSessionMessage":"Start a collaboration session to share content and invite participants.","statusbar.StartReadOnly":"Start Read-only Collaboration Session","statusbar.StartReadOnlyMessage":"Start a read-only collaboration session to share content and invite participants.","statusbar.JoinSession":"Join Collaboration Session","statusbar.JoinSessionMessage":"Join a collaboration session to access shared content.","generic.CopyAgain":"Copy again","generic.CopyLink":"Copy link","generic.MakeReadWrite":"Make read/write","generic.MakeReadOnly":"Make read-only","generic.StartSharing":"Start Sharing","generic.Help":"Help","generic.OK":"OK","generic.SignIn":"Sign in","generic.ContinueAsAnonymous":"Continue as anonymous","generic.moreInfo":"More info","generic.dontShowAgain":"Don't show again","error.CouldNotConnectToServer":"Could not connect to the server. Check that you are connected to the internet.","error.OlderThanServer":"The $(shortName) service requires a newer version of the extension than you have installed.","error.NewerThanServer":"The extension you have installed requires a newer version of the $(shortName) service.","error.OlderThanPeer":"The $(shortName) extension you have installed is too old to connect to this collaboration session.","error.NewerThanPeer":"The collaboration session host is on an older version of the $(shortName) extension than you are.","error.OlderThanAgent":"The $(shortName) agent is newer than the extension","error.NewerThanAgent":"The $(shortName) agent is older than the extension","error.NoIPAddressesDetected":'Unable to share in "Direct" mode as there are no suitable IP addresses. Switch to "Auto" or "Relay" mode and retry.',"error.NoConnectionAddresses":'Could not find a compatible connection address. Switch to "Auto" mode and retry.',"error.AutoConnectionFailed":"Unable to connect to the host. Verify both you and the host are online.","error.RelayConnectionFailed":'Unable to connect to the host in "Relay" mode. Verify you and the host are online. If so, switch to "Auto" or "Direct" mode and retry.',"error.DirectConnectionFailed":'Unable to connect to the host in "Direct" mode. Verify you and the host are online. If so, switch to "Auto" or "Relay" mode and retry.',"error.SessionProtocolError":"Unable to join the host due to a protocol error. Verify you and the host are online and are using the latest version of $(shortName).","error.SessionAuthenticationFailed":"Unable to join the host due to an authentication error. Verify the host is online, then sign out and sign in again and retry.","error.AuthTokenConversionFailed":"Live Share didn't succeed reusing a GitHub token for authentication. This could be caused by either a token expiration or revocation. Refresh your GitHub account in VSCode and run Live Share again to fix the problem.","error.AuthTokenConversionFailedWithCode":"Token exchange failed with code: ${code}","error.UnexpectedAuthenticationError":"Unexpected authentication error. Try signing in again.","error.DirectConnectionNotEnabled":'The host does not allow direct connections. Switch to "Auto" or "Relay" mode and retry.',"error.RelayConnectionNotEnabled":'Unable to connect since the host does not allow relayed connections. Switch to "Auto" or "Direct" mode and retry.',"error.CollaborationSessionUsersLimitReached":"Could not join the collaboration session as it has already reached the maximum of 5 participants. To increase the participant limit, please ask the host to change the Increased Guest Limit setting, reload and then start a new collaboration session.","error.CollaborationSessionGuestRejected":"The host has rejected you from joining the collaboration session.","error.CollaborationSessionRequestTimedOut":"Timed out while waiting for the host to respond to your request.","error.CollaborationSessionGuestCanceled":"Request to join the collaboration session was canceled.","error.CollaborationSessionNotFound":"Collaboration session not found.","error.CollaborationSessionGuestBlocked":"The host has blocked you from joining the collaboration. If this was accidental, please ask the host to restart the session.","error.NonSuccessHttpStatusCodeReceived":"Could not connect to the server. Received non success status code.","error.KeychainAccessFailed":"Live Share was unable to access the login keychain. This can happen if you recently changed your password or your login keychain has become corrupted. See more info for details on how to fix it.","error.RelayConnectionHostFailure":"The host's network conditions are poor or they are no longer connected to the Live Share cloud relay. Ask them to check their network conditions, restart the collaboration session, and try again.","error.RelayConnectionGuestFailure":"Unable to connect to Live Share cloud relay. Check your proxy, firewall and network settings and try again.","error.RemoteLaunchNotEnabled":"The host doesnt allow starting the debugger. If needed, ask them to enable it.","error.CouldNotConnectToServerAuthFailed":"Could not connect to the server. HTTPS connection failed, verify there are no self-signed certificates or custom cert validation policies blocking Live Share.","error.CannotCreatePlannedSession":"Failed to create a planned session","error.CannotDeletePlannedSession":"Failed to delete a planned session","error.CannotRenamePlannedSession":"Failed to rename planned session","error.CannotCopyPlannedSessionLink":"Failed to copy planned session link","error.CannotJoinPlannedSession":"Failed to join planned session","error.CaseSensitiveFileSystem":"It looks like you have a directory with files that have the same name, except for the casing. This is currently unsupported and may lead to errors.","error.RunningVsCodeOutsideOfApplicationsFolder":"You are running VS Code outside the Applications folder, so we cannot install support for joining sessions using a browser link. You can still join sessions manually.","error.FailedToInstallJoiningSessionsViaBrowser":"Failed to install support for joining sessions using a browser link. You can still join sessions manually.","error.InvitationLinkExpired":"This invite link has expired. Share again to generate a new link.","progress.openingRemoteSession":"Opening remote session...","progress.joiningRemoteSession":"Joining remote session...","progress.waitingForHost":"Waiting for host approval...","progress.reconnectingToHost":"Connection lost. Reconnecting to host...","progress.creatingPlannedSession":"Creating planned session...","progress.deletingPlannedSession":"Deleting planned session...","fileError.FileNotFound":"Path not found: $(path)","fileError.FileExists":"Path already exists: $(path)","fileError.NoPermissions":"Access denied: $(path)","fileError.FileTooLarge":"File is too large.","fileError.FileNotAvailable":"File is not available.","notification.AcceptRejectGuest":" requested to join the collaboration session.","notification.Accept":"Accept","notification.AcceptReadOnly":"Accept read-only","notification.AcceptReadWrite":"Accept read-write","notification.Reject":"Reject","notification.AlwaysAcceptAnonymous":"Always accept anonymous","notification.InformGuestJoined":" joined the collaboration session.","notification.GuestDisconnected":" was disconnected.","notification.GuestLeft":" left the collaboration session.","notification.FocusAccept":"$(userId) focused your attention.","notification.FocusRequest":"$(userId) requested you to follow them.","notification.CopyPlannedSessionLink":"Session link copied.","notification.CoeditingInformationCopiedToClipboard":"Co-editing information copied to clipboard.","notification.JoiningFromBrowserPermission":"To support joining a session using a browser link, we need permission to run an installer on your system. Your OS may ask you for your admin (sudo) password in a terminal. Install now?","notification.BrowserLinkLauncherInstallCommandCopiedToClipboard":"Browser link launcher install command copied to clipboard.","notification.CompleteIntegrationLater":'You can run the "Live Share: Launcher Setup" command to complete the integration later.',"notification.BrowserLinkLauncherInstalled":"Browser link launcher successfully installed.","notification.copyInstead":"Copy instead","notification.install":"Install","notification.InvitationLinkCopied":"Invitation link copied to clipboard! Send it to anyone you trust","notification.InvitationLinkSessionShared":'Session shared! Click "Copy link" to get an invitation link ',"notification.InvitationLinkMoreInfo":'or click "More info" to learn about secure sharing.',"notification.ReusableInvitationLinkCopied":'A Reusable Session link is copied to the clipboard. Save the link to a secure location. Learn more about how to use your Session by clicking "More info".',"notification.ReusableInvitationLinkCreated":'A Reusable Session link is created! Click "Copy link" to get the link. Save the link to a secure location. Learn more about how to use your Session by clicking "More info".',"notification.SignIntoJoin":"Sign in with VS Live Share to join a collaboration session.","notification.YouNeedToSignInBeforeJoin":"You need to sign in before joining the collaboration session.","notification.ProgressNotifiers":"$(options.title)","notification.CannotEditTheTerminal":"Cannot edit the terminal in read-only mode (anonymous). Sign in to proceed.","plannedSessions.quickPickSelectWindow":"Select a planned session","plannedSessions.expiresatTooltip":"Expiration: ","plannedSessions.NewLabel":"Create planned session...","plannedSessions.CreateaPlannedSessionTooltip":"Create a planned session","plannedSessions.Name":"Specify the name of the planned session","plannedSessions.NameCannotBeEmpty":"Name cannot be empty. Please enter an alphanumeric name for the session","plannedSessions.NameIsInvalid":"Name is invalid. Please enter an alphanumeric name for the session","guestNameToast.ReadOnlyLabel":" (Read-only)","guestNameToast.ReadOnlyAndAnonymousLabel":" (Anonymous & Read-only)","guestNameToast.AnonymousReadWriteLabel":" (Anonymous & Read-write)","guestNameToast.AnonymousLabel":" (Anonymous)","extension.liveshare.InLiveShareSession":"In a Live Share session","searchContacts.placeholder":"Type to search for contacts","selectPresenceProviderCommand.placeHolder":"Select the presence provider to use","inviteContactStatus.invited":"Invited","inviteContactStatus.dismissed":"Dismissed","inviteContactStatus.joining":"Joining","guestNameViewlet.ReadOnlyLabel":" (Read-only)","guestNameViewlet.ReadOnlyAndAnonymousLabel":" (Anonymous & Read-only)","guestNameViewlet.AnonymousReadWriteLabel":" (Anonymous & Read-write)","anonymousAuthStrategy.readOnlyUser":"Read-only User","anonymousAuthStrategy.continueAs":"Continue as","anonymousAuthStrategy.continueAsDescription":"Continue without signing in as a Read-only guest","authentication.SignInPromptPlaceholder":"Please select account to sign in","authentication.SignInPrompt":"Sign in using ${key} account","commentManager.cannotCreateCommentThread":"Cannot create comment thread","commentManager.cannotDeleteThread":"Cannot delete comment thread","commentManager.cannotReply":"Cannot reply","commentManager.cannotEditComment":"Cannot edit comment","commentManager.cannotSaveComment":"Cannot save comment","commentManager.cannotCancelEditComment":"Cannot cancel editing comment","commentManager.cannotDeleteComment":"Cannot delete comment","commentManager.deleteOtherComments":"delete other comments on the thread first","commentManager.controllerLabel":"Live Share Session Comments","commentManager.participants":"Participants:","chat.statusBarText":"Live Share Chat: $(unreads) new","chat.sessionChatLabel":"Session Chat","chat.quickPickItemDescription":"Live Share Chat","chat.quickPickSelectWindow":"Select a chat channel","chat.unreadLabel":"($(unread) new)","chat.typingStatus":"$(username) is typing...","chat.sessionStarted":"_has started the Live Share session_","chat.sessionEnded":"_has ended the Live Share session_","chat.sessionJoined":"_has joined the Live Share session_","chat.sessionLeft":"_has left the Live Share session_","chat.hostUnsupported":"The host of this collaboration session is currently disconnected from chat or is using a version of _Live Share_ that does not support this feature. [Learn more](https://aka.ms/vsls-chat)","chat.contactUnsupported":"The person you are trying to contact is currently unavailable or using a version of _Live Share_ that does not support this feature. [Learn more](https://aka.ms/vsls-chat)","chat.legacyExtensionUnsupported":"Please update the `Live Share Chat` companion extension. The version installed is no longer compatible. [Learn more](https://aka.ms/vsls-chat)","chat.unknownUser":"Unknown user","chat.openSessionChatWindow":"Open session chat","chat.chatServiceDisconnected":"The chat service is currently disconnected. Please try again shortly.","calling.quickPickConnectedPlaceholder":"What would you like to do?","calling.quickPickDisconnectLabel":"$(x) Disconnect","calling.quickPickDisconnectDetail":"Disconnect from the audio call.","calling.quickPickMuteYourselfLabel":"$(mute) Mute Yourself","calling.quickPickUnmuteYourselfLabel":"$(unmute) Unmute Yourself","calling.quickPickMuteYourselfDetail":"Mute yourself so others cannot hear you.","calling.quickPickUnmuteYourselfDetail":"Unmute your microphone so others can hear you.","calling.quickPickViewParticipantsLabel":"$(organization) View Participants","calling.quickPickViewParticipantsDetail":"View the list of Live Share participants that are currently in the call.","calling.quickPickConfigureSpeakersLabel":"$(unmute) Configure Speakers","calling.quickPickConfigureSpeakersDetail":"Select which speakers to use for the audio call.","calling.quickPickConfigureMicrophoneLabel":"$(megaphone) Configure Microphone","calling.quickPickConfigureMicrophoneDetail":"Select which microphone to use for the audio call.","calling.treeAudioCallParticipantsInitial":"Participants (0)","calling.treeJoinAudioCall":"Join audio call...","calling.treeStartAudioCall":"Start audio call...","calling.treeJoiningAudioCall":"Joining audio call...","calling.treeStartingAudioCall":"Starting audio call...","calling.treeEndingAudioCall":"Ending audio call...","calling.treeAudioCallLabel":"Audio Call","calling.treeAudioCallParticipantsCount":"Audio Call Participants ($(participantCount))","calling.treeUnknownUser":"Unknown user","calling.treeSelfItem":"$(displayName) (you)","calling.joinButton":"Join","calling.connectingAudio":"Connecting audio...","calling.disconnectingAudio":"Disconnecting audio...","calling.viewParticipantsQuickPickPlaceholder":"Audio Call Participants","calling.selectMicrophoneQuickPickPlaceholder":"Select the microphone to use","calling.selectSpeakersQuickPickPlaceholder":"Select the speaker to use","calling.joinInformationMessage":"An audio call has been started for this collaboration session.","info.SearchResultsLimited":"The result set contains only a subset of all matches. Please be more specific in your search to narrow down the results.","treeView.newTooltip":"[New]","guestServerController-promtHostSharedServer":"The host has shared a server $(sessionName) with you. Would you like to view this in the browser?","guestServerController-yes":"Yes","guestServerController-no":"No","guestServerController-serverUnshared":"Cannot open server $(sessionName) in browser. The host has unshared the server","emptyWorkspace.liveShareWorkspace":"Live Share Workspace","notebooks.openWithDifferentNotebookTypeOnHost1":"The host has the notebook open with","notebooks.openWithDifferentNotebookTypeOnHost2":"Use the same view to open","notebooks.openedWithLocalContentProvider":"Co-editing is not supported for notebooks opened with non-shared views.","notebooks.kernelDetail":"Kernel to execute cells on the host's machine","notebooks.executeCellsAccessGranted":"The host has granted you access to execute notebook cells","notebooks.executeCellsAccessDenied":"The host has rejected your request to execute notebook cells","notebooks.executeCellsReadOnly":"You cannot execute notebook cells in a read-only session","notebooks.executeCellsLackingPermission":"The host has not given you permission to execute notebook cells","notebooks.executeCellsRequestAccess":"Request access","notebooks.executeCellsAllowForSession":"Allow for this session","notebooks.executeCellsAllowAlways":"Allow always","notebooks.executeCellsReject":"Reject","notebooks.executeCellsRequested":"A guest is requesting permission to execute notebook cells",startCollaborationSession:"Start collaboration session...",joinCollaborationSession:"Join collaboration session...",startReadOnlyCollaborationSession:"Start read-only collaboration session...",CreateLinkProgress:"Creating a Reusable Session link...",CannotCreatePersistentSession:"Failed to create a Reusable Session link","web.previewMessage":"Live Share web support is currently in preview. Let us know if you have any feedback!","web.previewContactUs":"Contact us on GitHub","presence.signInMessage":"Sign in to presence will allow people to see your status based on your e-mail"};let s=e=>i.hasOwnProperty(e)?i[e]:e;t.setLocalizeCallback=function(e){s=e},t.localize=function(e){return s(e)},t.localizeDate=function(e){return e.toLocaleString()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(911);t.getExperimentationService=i.getExperimentationService,t.getExperimentationServiceAsync=i.getExperimentationServiceAsync;var s=n(397);t.TargetPopulation=s.TargetPopulation},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);class s{constructor(e,t,n){this.extensionName=e,this.extensionVersion=t,this.targetPopulation=n}static trimVersionSuffix(e){return e.split(/\-[a-zA-Z0-9]+$/)[0]}getFilterValue(e){switch(e){case r.ApplicationVersion:return s.trimVersionSuffix(i.version);case r.Build:return i.env.appName;case r.ClientId:return i.env.machineId;case r.ExtensionName:return this.extensionName;case r.ExtensionVersion:return s.trimVersionSuffix(this.extensionVersion);case r.Language:return i.env.language;case r.TargetPopulation:return this.targetPopulation;default:return""}}getFilters(){let e=new Map,t=Object.values(r);for(let n of t)e.set(n,this.getFilterValue(n));return e}}var r;t.VSCodeFilterProvider=s,function(e){e.Market="X-MSEdge-Market",e.CorpNet="X-FD-Corpnet",e.ApplicationVersion="X-VSCode-AppVersion",e.Build="X-VSCode-Build",e.ClientId="X-MSEdge-ClientId",e.ExtensionName="X-VSCode-ExtensionName",e.ExtensionVersion="X-VSCode-ExtensionVersion",e.Language="X-VSCode-Language",e.TargetPopulation="X-VSCode-TargetPopulation"}(r=t.Filters||(t.Filters={})),function(e){e.Team="team",e.Internal="internal",e.Insiders="insider",e.Public="public"}(t.TargetPopulation||(t.TargetPopulation={}))},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return e.apply(t,n)}}},function(e,t,n){"use strict";var i=n(35);function s(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var r;if(n)r=n(t);else if(i.isURLSearchParams(t))r=t.toString();else{var o=[];i.forEach(t,(function(e,t){null!=e&&(i.isArray(e)?t+="[]":e=[e],i.forEach(e,(function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),o.push(s(t)+"="+s(e))})))})),r=o.join("&")}if(r){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e}},function(e,t,n){"use strict";e.exports=function(e,t,n,i,s){return e.config=t,n&&(e.code=n),e.request=i,e.response=s,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,n){"use strict";var i=n(35),s=n(924),r=n(925),o=n(399),a=n(926),c=n(929),l=n(930),u=n(402);e.exports=function(e){return new Promise((function(t,n){var d=e.data,h=e.headers,f=e.responseType;i.isFormData(d)&&delete h["Content-Type"];var p=new XMLHttpRequest;if(e.auth){var m=e.auth.username||"",g=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";h.Authorization="Basic "+btoa(m+":"+g)}var y=a(e.baseURL,e.url);function v(){if(p){var i="getAllResponseHeaders"in p?c(p.getAllResponseHeaders()):null,r={data:f&&"text"!==f&&"json"!==f?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:i,config:e,request:p};s(t,n,r),p=null}}if(p.open(e.method.toUpperCase(),o(y,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,"onloadend"in p?p.onloadend=v:p.onreadystatechange=function(){p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))&&setTimeout(v)},p.onabort=function(){p&&(n(u("Request aborted",e,"ECONNABORTED",p)),p=null)},p.onerror=function(){n(u("Network Error",e,null,p)),p=null},p.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(u(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",p)),p=null},i.isStandardBrowserEnv()){var S=(e.withCredentials||l(y))&&e.xsrfCookieName?r.read(e.xsrfCookieName):void 0;S&&(h[e.xsrfHeaderName]=S)}"setRequestHeader"in p&&i.forEach(h,(function(e,t){void 0===d&&"content-type"===t.toLowerCase()?delete h[t]:p.setRequestHeader(t,e)})),i.isUndefined(e.withCredentials)||(p.withCredentials=!!e.withCredentials),f&&"json"!==f&&(p.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){p&&(p.abort(),n(e),p=null)})),d||(d=null),p.send(d)}))}},function(e,t,n){"use strict";var i=n(400);e.exports=function(e,t,n,s,r){var o=new Error(e);return i(o,t,n,s,r)}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";var i=n(35);e.exports=function(e,t){t=t||{};var n={},s=["url","method","data"],r=["headers","auth","proxy","params"],o=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function c(e,t){return i.isPlainObject(e)&&i.isPlainObject(t)?i.merge(e,t):i.isPlainObject(t)?i.merge({},t):i.isArray(t)?t.slice():t}function l(s){i.isUndefined(t[s])?i.isUndefined(e[s])||(n[s]=c(void 0,e[s])):n[s]=c(e[s],t[s])}i.forEach(s,(function(e){i.isUndefined(t[e])||(n[e]=c(void 0,t[e]))})),i.forEach(r,l),i.forEach(o,(function(s){i.isUndefined(t[s])?i.isUndefined(e[s])||(n[s]=c(void 0,e[s])):n[s]=c(void 0,t[s])})),i.forEach(a,(function(i){i in t?n[i]=c(e[i],t[i]):i in e&&(n[i]=c(void 0,e[i]))}));var u=s.concat(r).concat(o).concat(a),d=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===u.indexOf(e)}));return i.forEach(d,l),n}},function(e,t,n){"use strict";function i(e){this.message=e}i.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},i.prototype.__CANCEL__=!0,e.exports=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_ANONYMOUS_USER_NAME="Guest User",t.READ_ONLY_LABEL="Read-only",t.READ_WRITE_LABEL="Read-write",t.LIVESHARE_EXTENSION_ID="ms-vsliveshare.vsliveshare",t.LIVESHARE_PRESENCE_PROVIDER_ID="LivesharePresence"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(6),r=n(7);t.initRemoteFileSubscribe=async function(e,t,n,o,a){const c=r.getExtensionUri("remoteSettings.json",e);return i.workspace.fs.readFile(c).then(e=>{var t=(new TextDecoder).decode(e);n(JSON.parse(t))},e=>{null==a||a.error("Failed to read remote settings file",e)}),s.createDisposable(()=>{null==a||a.verbose("disposed")})},t.loadFilefromCache=async function(e,t){return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPlatform=function(){return"browser"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(7),s=n(165),r=n(231),o=n(161);t.assert=function(e,t,n){e||(s.checkDebugging(),i.traceSource.withName("Asserts").error(`Assertion Violation: ${t}`),o.ExtensionTelemetry.ReportFailedAssertion(n||t),r.showDiagnosticErrorMessage(`Assertion Violation: ${t}`))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(232);function r(e,t,n){var s;if(!i.workspace.notebookDocuments)return;const r=i.workspace.notebookDocuments.find(t=>t.uri.toString()===e.toString());return r?null===(s=r.getCells())||void 0===s?void 0:s.find(e=>e.metadata[t]===n):void 0}function o(e){var t;if(null===(t=null==e?void 0:e.metadata)||void 0===t?void 0:t.hasOwnProperty(s.NotebookConstants.cellIdPropertyName))return e.metadata[s.NotebookConstants.cellIdPropertyName]}t.findNotebookCell=function(e){var t;if(i.workspace.notebookDocuments)for(let n of i.workspace.notebookDocuments){const i=null===(t=n.getCells())||void 0===t?void 0:t.find(t=>t.document.uri.path===e.path&&t.document.uri.fragment===e.fragment);if(i)return i}},t.findNotebookCellWithCustomMetadata=r,t.findNotebookCellById=function(e,t){return r(e,s.NotebookConstants.cellIdPropertyName,t)},t.getNotebookCellData=function(e){let t=new i.NotebookCellData(e.kind,e.document.getText(),e.document.languageId);return t.metadata=e.metadata,t},t.getCellId=o,t.sortCells=function(e){e.sort((e,t)=>e.index-t.index)},t.getNotebookHash=function(e){return e.map(e=>o(e)).join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(67),s=n(0),r=n(13),o=n(15),a=n(22),c=n(325);t.FileSystemManager=class{constructor(e,t){this.rpcServices=e,this.sessionContext=t}get workspaceProvider(){return this.provider}registerFileSystemProvider(e=!1){const t=i.gte(i.coerce(s.version),"1.23.0");if(this.providerRegistration){if(e===this.isFileSystemProviderReadOnly||!t)return;this.unregisterProvider()}else a.ExtensionUtil.context.subscriptions.push(this);this.provider||(this.provider=new c.WorkspaceProvider(this.rpcServices.workspaceService(),this.rpcServices.fileService,this.sessionContext)),this.provider.bumpGeneration(),this.providerRegistration=s.workspace.registerFileSystemProvider(r.Settings.get(o.SettingKeys.authority),this.provider,{isCaseSensitive:!0,isReadonly:e||!1}),this.isFileSystemProviderReadOnly=e}disposeWorkspaceProvider(){this.provider&&(this.provider.dispose(),this.provider=null)}dispose(){this.unregisterProvider(),this.disposeWorkspaceProvider()}unregisterProvider(){this.providerRegistration&&(this.providerRegistration.dispose(),this.providerRegistration=null)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(5),r=n(13),o=n(15),a=n(19),c=n(234),l=n(414),u=n(416),d=n(79),h=n(60),f=n(237),p=n(68),m=n(235),g=n(415),y=n(236),v=n(22),S=n(9),_=n(93),E=n(16),w=n(233);class b{constructor(e,t){this.message=e,this.serverVersionNumber=t}}var C,T,M;t.MessageAndVersionNumber=b,function(e){e[e.None=0]="None",e[e.Queue=1]="Queue",e[e.QueueAndProcess=2]="QueueAndProcess"}(C=t.CoeditingIncomingMessageBehavior||(t.CoeditingIncomingMessageBehavior={})),function(e){e[e.None=0]="None",e[e.ApplyingEdits=1]="ApplyingEdits",e[e.CapturingEdits=2]="CapturingEdits"}(T||(T={}));class A{constructor(e,t){this.algorithmState=e,this.pendingEdit=t}}function k(e,t,n){t.beginRecording(),e.contentChanges.forEach(e=>{const[n,i,s]=c.CollabBuffer.convertVsCodeContentChangeToCollabChange(e,t);t.applyLocalEdit(n,i,s)});const[i,s]=t.endRecording();n.acceptLocalChange(i,s,e.trackingId)}function R(e,t){let n,s=e.newText;const r=e.oldText,o=t.positionAt(e.oldPosition),a=t.positionAt(e.oldEnd),c=1===e.oldLength&&10===e.oldText.charCodeAt(0),l=s.length>0&&10===s.charCodeAt(s.length-1),u=s.length>1&&s.endsWith("\r\n"),d=1===e.newLength&&10===e.newText.charCodeAt(0),h=r.length>0&&10===r.charCodeAt(r.length-1);if(c&&l&&!u)n=new i.Range(o.line,o.character,o.line,o.character),s=s.substr(0,s.length-1);else if(d&&h){const r=t.positionAt(e.oldEnd-1);n=new i.Range(o.line,o.character,r.line,r.character),s=""}else n=new i.Range(o.line,o.character,a.line,a.character);return new i.TextEdit(n,s)}!function(e){e[e.Unknown=0]="Unknown",e[e.Local=1]="Local",e[e.Remote=2]="Remote"}(M||(M={}));t.VSCodeBufferManager=class{constructor(e,t,n,i,s=!1){this.isHost=i,this.saveSnapshots={},this.cachedHandshakes=[],this.pendingApplicationOfRemoteEdit=null,this.localChangesQueue=y.getTimedArray("localchangesqueuetime"),this.remoteMessagesQueue=y.getTimedArray("remotemessagesqueuetime"),this.highestQueuedEventId=-2,this.localToRemoteTransitions=[],this.localRedoStack=[],this.initialHistoryHighWaterMark=-1,this.performingUndo=T.None,this.lastChangeSource=M.Unknown,this.hasEverHadALocalEdit=!1,this.redoWouldRedoLocalUndo=!1,this.localUndoCount=0,this.remoteUndoCount=0,this.selectionChangedDebounce=null,this.scrollHappenedDebounce=[],this.host=e,this.diagnosticTrace=s,this.collabBuffer=new c.CollabBuffer(n,e.trace),this.fileName=t,this.syncManager=new u.SyncManager;let r=this;const o=new class{constructor(){this.clientID=e.clientID,this.clientCount=e.clientCount,this.trace=e.trace}get fileName(){return r.fileName}postMessage(t){e.postMessage(t)}};this.otAlgorithm=new l.OTAlgorithm(o,this.diagnosticTrace),this.otAlgorithm.serverVersionChangedEvent.on(l.serverVersionChangedEventName,()=>{this.onServerVersionChange()})}get numberOfLocalUndos(){return this.localUndoCount}get numberOfRemoteUndos(){return this.remoteUndoCount}updateFileName(e){this.fileName=e}onServerVersionChange(){0===this.otAlgorithm.getOperationalTransformStatus().unacknowledgedCount&&(this.isHost?this.postHandshake():this.cachedHandshakes.push(this.makeSnapshot()))}clearLocalChangesQueue(){for(;this.localChangesQueue.length>0;)this.localChangesQueue.pop()}onDidChangeTextDocument(e){this.performingUndo>T.ApplyingEdits||(this.localChangesQueue.push(e),this.processQueuedMessages())}vscodeRangeToVslsRange(e){const t=this.toCollabOffset(e.start);return{start:t,length:this.toCollabOffset(e.end)-t}}onDidChangeTextEditorVisibleRanges(e,t,n,i,s){if(i.length<1)return;if(this.seenSelectionWithinDebouncePeriod())return void this.resetSelectionDebounce();const r=i.map(e=>this.vscodeRangeToVslsRange(e)),o=this.otAlgorithm.getOperationalTransformStatus().serverVersion,a=d.MessageFactory.LayoutScrollMessage(this.host.clientID,e,t,o,r[0].start,r[0].length,n,r);let c=setTimeout(()=>{const e=this.scrollHappenedDebounce.indexOf(c);e>-1&&this.scrollHappenedDebounce.splice(e,1),a.trackingId=s,this.host.postMessage(a)},100);this.scrollHappenedDebounce.push(c)}getEditorVisibleRanges(e){const t=e.map(e=>this.vscodeRangeToVslsRange(e));return{fileName:this.fileName,serverVersionNumber:this.otAlgorithm.getOperationalTransformStatus().serverVersion,visibleRanges:t}}clearSelectionDebounce(){null!==this.selectionChangedDebounce&&(clearTimeout(this.selectionChangedDebounce),this.selectionChangedDebounce=null)}clearScrollHappenedDebounce(){this.scrollHappenedDebounce.forEach(e=>{clearTimeout(e)}),this.scrollHappenedDebounce=[]}seenSelectionWithinDebouncePeriod(){return null!==this.selectionChangedDebounce}havePendingScrolls(){return this.scrollHappenedDebounce.length>0}resetSelectionDebounce(){this.clearSelectionDebounce(),this.clearScrollHappenedDebounce(),this.selectionChangedDebounce=setTimeout(()=>this.clearSelectionDebounce(),100)}onDidChangeTextEditorSelection(e,t,n,i,s){if(this.pendingApplicationOfRemoteEdit)return;const r=e[0],o=this.toCollabOffset(r.start),a=this.toCollabOffset(r.end)-o,c=this.otAlgorithm.getOperationalTransformStatus().serverVersion,l=d.MessageFactory.SelectionChangeMessage(this.host.clientID,t,void 0,c,o,a,r.isReversed,n,i);l.trackingId=s,this.host.postMessage(l),this.resetSelectionDebounce()}onIncomingMessage(e,t,n=C.QueueAndProcess){t<=this.highestQueuedEventId||(this.host.trace.verbose(`Queueing remote message for ${a.TraceFormat.formatPath(this.fileName)}`),this.highestQueuedEventId=t,this.remoteMessagesQueue.push(new b(e,t)),n===C.Queue||this.performingUndo||this.processQueuedMessages())}toVSCodeDocumentPos(e){const t=this.collabBuffer.positionAt(e);return new i.Position(t.line,t.character)}toCollabOffset(e){const t=new c.CollabBufferPosition(e.line,e.character);return this.collabBuffer.offsetAt(t)}getBufferManagerStatus(){let e=this.otAlgorithm.getOperationalTransformStatus();return{serverVersion:e.serverVersion,unacknowledgedCount:e.unacknowledgedCount,waitingForRemoteEditsToBeApplied:!!this.pendingApplicationOfRemoteEdit,localChangesQueue:this.localChangesQueue.length,remoteMessagesQueue:this.remoteMessagesQueue.length,collabBufferText:this.collabBuffer.getContent()}}getCurrentHistory(){return this.otAlgorithm.getCurrentHistory().map(e=>({message:e.Message||void 0,serverVersionNumber:e.serverVersionNumber}))}initializeHistory(e){const t=e.history||[],n=[new g.ServerVersion(e.startServerVersionNumber||-1,null)];t.forEach(t=>{const i=t.serverVersionNumber;if(i<=(e.savedVersionNumber||0))return n.push(new g.ServerVersion(i,t.message)),void(this.highestQueuedEventId=i);i>this.initialHistoryHighWaterMark&&(this.initialHistoryHighWaterMark=i);const s=d.MessageFactory.CoauthoringMessage(t.message);this.onIncomingMessage(s,i,C.Queue)}),this.otAlgorithm.setInitialHistory(n)}updateInitialHistoryHighWatermark(e){this.initialHistoryHighWaterMark>e||(this.initialHistoryHighWaterMark=e)}undoLastLocalEdit(){if(this.host.trace.verbose(`Undo: Received Local Undo Request for ${a.TraceFormat.formatPath(this.fileName)}`),this.performingUndo)return this.host.trace.verbose("Undo: Already performing undo, not handling this undo"),!0;if(this.lastChangeSource===M.Local&&this.localToRemoteTransitions.length<1||this.lastChangeSource===M.Unknown&&0===this.localToRemoteTransitions.length)return this.localUndoCount++,this.redoWouldRedoLocalUndo=!0,this.host.trace.verbose(`Undo: Last change was local, let editor handle. Source: ${this.lastChangeSource}, Count: ${this.localToRemoteTransitions.length}`),!1;if(!this.hasEverHadALocalEdit)return this.host.trace.verbose("Undo: No local edits ever seen, with remote edits, nothing to undo"),!0;if(this.lastChangeSource===M.Local&&this.localToRemoteTransitions.length>0)return this.host.trace.verbose("Undo: Last edit was local, performing undo to update transitions"),this.performingUndo=T.ApplyingEdits,this.redoWouldRedoLocalUndo=!0,this.localUndoCount++,this.host.performSingleUndo().then(()=>{this.performingUndo=T.None;const e=this.localToRemoteTransitions[this.localToRemoteTransitions.length-1];this.collabBuffer.getContent()===e.beforeTransitionToLocal?(this.host.trace.verbose("Undo: Reached state of last remote edit. Updating status"),e.beforeTransitionToLocal=null,this.lastChangeSource=M.Remote,this.hasEverHadALocalEdit=e.hadLocalEdits):this.host.trace.verbose("Undo: Editor undo complete, but still more that could be undo")}),!0;h.assert(this.localToRemoteTransitions.length>0,"No local changes, but no transitions");let e,t,n,i,s,r=this.localToRemoteTransitions.length,o=this.localToRemoteTransitions[this.localToRemoteTransitions.length-1];if(!o.beforeTransitionToRemote)return!0;this.performingUndo=T.CapturingEdits,this.remoteUndoCount++,this.collabBuffer.startCapturingEditsFromUndoing(),this.host.trace.verbose("Undo: Rolling back buffer to before the last remote edit");const u=[];let f,p;return this.host.undoBufferToMatchContents(o.beforeTransitionToRemote).then(e=>(p=e,this.host.performSingleUndo())).then(t=>{e=t.edits,n=t.contents,h.assert(this.localToRemoteTransitions.length===r,"Didn't expect transitions while we were undoing"),this.localToRemoteTransitions.pop();let i=this.localToRemoteTransitions.length>0?this.localToRemoteTransitions[this.localToRemoteTransitions.length-1]:null;const s=n===p;return i&&i.beforeTransitionToLocal!==n&&(this.host.trace.verbose("Undo: Still more local undos; updating state"),o.beforeTransitionToRemote=n,this.localToRemoteTransitions.push(o)),this.localToRemoteTransitions.length<1&&(this.host.trace.verbose("Undo: No more local-remote states changes, cleaning up"),this.lastChangeSource=M.Remote,this.localToRemoteTransitions.push({beforeTransitionToRemote:n,hadLocalEdits:!s}),this.hasEverHadALocalEdit=!s),this.host.performSingleRedo()}).then(n=>{i=new c.CollabBuffer(n,this.host.trace);const r=this,o=new class{constructor(){this.clientID=1,this.clientCount=r.host.clientCount,this.trace=r.host.trace}get fileName(){return r.fileName}postMessage(e){u.push(e)}};return s=new l.OTAlgorithm(o,this.diagnosticTrace),t=e.reduce((e,t)=>{const[n,s,r]=c.CollabBuffer.convertVsCodeContentChangeToCollabChange(t,i),o=i.convertCollabufferChangeToITextChange(n,s,r);return m.compressConsecutiveTextChanges(e,[o])},[]),this.host.redoUntilNoMoreToRedo(p,e=>k(e,i,s))}).then(()=>{u.forEach((e,t)=>{s.acceptTextChangeAcknowledge(e,t)});const e=t.map(e=>d.MessageFactory.TextChange(e.oldPosition,e.oldLength,e.newText));let n=d.MessageFactory.TextChangeMessage(2,this.fileName,void 0,-1,e);n=s.TransformMessageToCurrent(n);const r=s.transformMessageToEdits(i.getMaximumOffset(),n),o=i.transformEditsToTextChanges(r),a=o.map(e=>R(e,i));return f=o.map(e=>d.MessageFactory.TextChange(e.newPosition,e.newLength,e.oldText)),this.performingUndo=T.ApplyingEdits,this.host.applyEdit(a)}).then(()=>{const e=this.otAlgorithm.getOperationalTransformStatus().serverVersion;this.localRedoStack.push({redoChanges:f,serverVersion:e}),this.host.trace.verbose("Undo: Local undo complete"),this.performingUndo=T.None},e=>{S.Telemetry.sendFault(E.TelemetryEventNames.UNDO_FAILURE,S.FaultType.Error,"Failure to apply a local undo with remote edits",e),this.performingUndo=T.None}),!0}redoLastLocalEdit(){if(this.lastChangeSource===M.Local||this.redoWouldRedoLocalUndo)return!1;if(!r.featureFlags.localRedo)return!0;if(this.localRedoStack.length<1)return!0;h.assert(this.localRedoStack.length>0,"We don't have any items to redo");const e=this.localRedoStack.pop();let t=d.MessageFactory.TextChangeMessage(-1,this.fileName,void 0,e.serverVersion,e.redoChanges);t=this.otAlgorithm.TransformMessageToCurrent(t);const n=this.otAlgorithm.transformMessageToEdits(this.collabBuffer.getMaximumOffset(),t),i=this.collabBuffer.transformEditsToTextChanges(n).map(e=>R(e,this.collabBuffer));return this.performingUndo=T.ApplyingEdits,this.host.applyEdit(i).then(()=>this.performingUndo=T.None,e=>{S.Telemetry.sendFault(E.TelemetryEventNames.REDO_FAILURE,S.FaultType.Error,"Failure to apply a local redo with remote edits",e),this.performingUndo=T.None}),!0}clearUndoStateDueToDocumentClosing(){this.localRedoStack.length=0,this.localToRemoteTransitions.length=0,this.hasEverHadALocalEdit=!1,this.host.trace.verbose(`Undo: Clearing Local Undo State due to document close: ${a.TraceFormat.formatPath(this.fileName)}`),this.lastChangeSource=M.Remote,this.localToRemoteTransitions.push({hadLocalEdits:this.hasEverHadALocalEdit,beforeTransitionToRemote:this.collabBuffer.getContent()})}takeSnapshot(){const e=this.makeSnapshot();this.saveSnapshots[e.hashCode]=e}getSavedSnapshotOrFallback(e){if(this.saveSnapshots[e])return this.saveSnapshots[e];const t=this.makeSnapshot();return t.fallbackText=this.collabBuffer.getContent(),t}makeSnapshot(){const e=this.collabBuffer.getContent(),t=this.otAlgorithm.getOperationalTransformStatus();return{changes:t.unacknowledged.map(e=>e.rollbackEdits).reverse(),hasUnacknowledgedChanges:t.unacknowledgedCount>0,hashCode:f.calculateFileHash(e),serverVersionNumber:t.serverVersion}}checkSync(){this.host.trace.verbose(`checkSync for ${a.TraceFormat.formatPath(this.fileName)}`),this.host.checkSync(this.collabBuffer.getContent())}recordSyncedState(){const e=this.makeSnapshot();this.isHost?this.syncManager.recordSnapshot(e):e.hasUnacknowledgedChanges||this.host.checkHostSync(e.serverVersionNumber,e.hashCode)}processQueuedMessages(){if(null!==this.pendingApplicationOfRemoteEdit)return void this.host.trace.verbose("Skipping step due to pending edit");this.diagnosticTrace&&(h.logger.logTrace(this.host.trace,"step"),h.logger.indent(),h.logger.logTrace(this.host.trace,"before local changes - collabbuffer: "+h.colorize.cyan(JSON.stringify(this.collabBuffer.getContent()))));const e=this.localChangesQueue.length>0;for(;this.localChangesQueue.length>0;){let e=this.localChangesQueue.shift();this._acceptLocalChange(e)}e&&this.checkSync(),this.diagnosticTrace&&h.logger.logTrace(this.host.trace,"after localchanges - collabbuffer: "+h.colorize.cyan(JSON.stringify(this.collabBuffer.getContent())));let t=!0;for(;this.remoteMessagesQueue.length>0&&t;){const e=this.remoteMessagesQueue[0],n=e.message.clientId,i=e.message.messageType;if(void 0!==n)switch(i){case s.vsls.MessageType.TextChange:t=this._handleTextChangeMessage(n,e);continue;case s.vsls.MessageType.SelectionChange:try{this._handleSelectionChangeMessageIfMostRecent(n,e)}catch(e){throw this.host.trace.error(`Error handling selection change in file: ${a.TraceFormat.formatPath(this.fileName)}`),e}break;default:const r=`Unexpected message type in buffer manager (${a.TraceFormat.formatPath(this.fileName)}): ${i}`;this.host.trace.error(r),this.remoteMessagesQueue.shift(),h.assert(!1,r)}else this.host.trace.error(`Message ${i} is missing client ID.`)}this.diagnosticTrace&&h.logger.unindent()}_handleTextChangeMessage(e,t){return e===this.host.clientID?(this.host.trace.verbose(`Received text change acknowledge for ${a.TraceFormat.formatPath(this.fileName)}`),this.remoteMessagesQueue.shift(),this.otAlgorithm.acceptTextChangeAcknowledge(t.message,t.serverVersionNumber),this.recordSyncedState(),!0):(this._beginApplyingRemoteChange(t.message,t.serverVersionNumber),!1)}_handleSelectionChangeMessageIfMostRecent(e,t){let n=!1;for(let t=1;t<this.remoteMessagesQueue.length;++t){const i=this.remoteMessagesQueue[t].message;if(i.clientId===e){n=i.messageType===s.vsls.MessageType.SelectionChange;break}}if(!n){const e=this.transformSelectionToCurrent(t.message);this.host.updateClientPosition(e)}this.remoteMessagesQueue.shift()}_acceptLocalChange(e){this.host.trace.verbose(`_acceptLocalChange for ${a.TraceFormat.formatPath(this.fileName)}`),this.lastChangeSource!==M.Remote||this.performingUndo||(this.host.trace.verbose(`Undo: Transitioning to local for ${a.TraceFormat.formatPath(this.fileName)}`),this.localToRemoteTransitions[this.localToRemoteTransitions.length-1].beforeTransitionToLocal=this.collabBuffer.getContent()),this.performingUndo||(this.hasEverHadALocalEdit=!0,this.lastChangeSource=M.Local,this.redoWouldRedoLocalUndo=!1,this.localRedoStack.length=0),k(e,this.collabBuffer,this.otAlgorithm)}_beginApplyingRemoteChange(e,t){this.host.trace.verbose(`_beginApplyingRemoteChange for ${a.TraceFormat.formatPath(this.fileName)}`);let n=-1;if(this.lastChangeSource!==M.Remote){h.assert(!this.performingUndo,"Shouldn't see remote changes while undoing"),this.host.trace.verbose(`Undo: Transitioning to Remote for ${a.TraceFormat.formatPath(this.fileName)}`);const e=t>this.initialHistoryHighWaterMark?this.collabBuffer.getContent():null;n=this.localToRemoteTransitions.push({beforeTransitionToRemote:e,hadLocalEdits:this.hasEverHadALocalEdit})}let i=this.lastChangeSource;this.lastChangeSource=M.Remote,this.redoWouldRedoLocalUndo=!1;let s=this.otAlgorithm.saveState();this.collabBuffer.beginRecording(),this.otAlgorithm.acceptRemoteChange(this.collabBuffer,e,t);let[r,o]=this.collabBuffer.endRecording();if(r=r.filter(e=>!(0===e.newLength&&0===e.oldLength)),0===r.length)return this.remoteMessagesQueue.shift(),void this.processQueuedMessages();this.host.trace.verbose(`Rolling back changes made by OT to the collab buffer for ${a.TraceFormat.formatPath(this.fileName)}`),this.collabBuffer.applyRemoteEdits(r.map(e=>({position:e.newPosition,length:e.newLength,text:e.oldText})));let c=r.map(e=>R(e,this.collabBuffer));this.diagnosticTrace&&(h.logger.logTrace(this.host.trace,"sending edit request to ext host: "+JSON.stringify(r)),h.logger.logTrace(this.host.trace,"sending edit request to ext host: "+JSON.stringify(c))),this.pendingApplicationOfRemoteEdit=new A(s,r),this.host.applyEdit(c,e.trackingId).then(e=>{if(e===w.ApplyEditResult.FAILED)return _.CoauthoringTelemetry.ReportCoeditingError("Failed to apply edits"),void this._finishApplyingRemoteChangeFail(i,n);this._finishApplyingRemoteChangeOK(e)},e=>{this.host.trace.warning("Error while applying edits"),_.CoauthoringTelemetry.ReportCoeditingError("Error while applying edits",e),this._finishApplyingRemoteChangeFail(i,n)})}async _finishApplyingRemoteChangeOK(e){if(this.host.trace.verbose(`_finishApplyingRemoteChangeOK for ${a.TraceFormat.formatPath(this.fileName)}`),h.assert(1===this.localChangesQueue.length,`expected a single local change caused by my own edit, but got ${this.localChangesQueue.length}`),this.localChangesQueue.shift(),this.remoteMessagesQueue.shift(),this.host.trace.verbose(`Applying remote edits to collab buffer for ${a.TraceFormat.formatPath(this.fileName)}`),this.collabBuffer.applyRemoteEdits(this.pendingApplicationOfRemoteEdit.pendingEdit.map(e=>({position:e.oldPosition,length:e.oldLength,text:e.newText}))),e===w.ApplyEditResult.MODIFIED)try{await this.host.resync()}catch(e){h.assert(!1,"Resync should complete successfully")}this.pendingApplicationOfRemoteEdit=null,0===this.localChangesQueue.length&&this.checkSync(),this.recordSyncedState(),this.processQueuedMessages()}_finishApplyingRemoteChangeFail(e,t){this.host.trace.info(`Applying edits to main buffer failed for ${a.TraceFormat.formatPath(this.fileName)}`);let n=this.pendingApplicationOfRemoteEdit;this.pendingApplicationOfRemoteEdit=null,t>-1&&t===this.localToRemoteTransitions.length-1&&this.lastChangeSource!==e&&(this.localToRemoteTransitions.pop(),this.lastChangeSource=e),this.otAlgorithm.loadState(n.algorithmState),this.processQueuedMessages()}transformRangeToCurrent(e,t,n,i,s){const r=d.MessageFactory.TextChange(s.start,s.length,""),o=d.MessageFactory.TextChangeMessage(e,t,n,i,[r]),a=this.otAlgorithm.TransformMessageToCurrent(o);return{start:a.changes&&a.changes[0].start||0,length:a.changes&&a.changes[0].length||0,changeServerVersion:a.changeServerVersion}}transformSelectionToCurrent(e){const t=this.transformRangeToCurrent(e.clientId,e.fileName,e.fileVersion,e.serverVersionNumber,{start:e.start,length:e.length});return d.MessageFactory.SelectionChangeMessage(e.clientId,e.fileName,e.fileVersion,t.changeServerVersion,t.start,t.length,e.isReversed,e.kind,e.forceJumpForClientId)}transformVisibleRangesToCurrent(e,t){const n=t.visibleRanges.map(n=>this.transformRangeToCurrent(e,t.fileName,void 0,t.serverVersionNumber,n));return{fileName:t.fileName,serverVersionNumber:t.serverVersionNumber,visibleRanges:n}}remoteQueueContainsSelectionChange(){return this.remoteMessagesQueue.some(e=>e.message.messageType===s.vsls.MessageType.SelectionChange)}transformScrollSelectionToCurrent(e){if(this.remoteQueueContainsSelectionChange())return null;const t=this.transformRangeToCurrent(e.clientId,e.fileName,e.fileVersion,e.serverVersionNumber,{start:e.start,length:e.length}),n=(e.visibleRanges||[]).map(t=>this.transformRangeToCurrent(e.clientId,e.fileName,e.fileVersion,e.serverVersionNumber,t));return d.MessageFactory.LayoutScrollMessage(e.clientId,e.fileName,e.fileVersion,t.changeServerVersion,t.start,t.length,e.editorId,n)}postHandshake(){const e=this.makeSnapshot(),t=d.MessageFactory.HandshakeMessage(this.host.clientID,this.fileName,e.hashCode,e.serverVersionNumber);this.host.postMessage(t)}isFileSyncedForVersion(e,t){return this.syncManager.isFileSyncedForVersion(e,t)}onHandshake(e){for(let t=0;t<this.cachedHandshakes.length;t++){const n=this.cachedHandshakes[t];if(n.serverVersionNumber===e.serverVersionNumber){this.cachedHandshakes.splice(0,t+1),this.compareHandshake(e,n);break}if(void 0!==e.serverVersionNumber&&n.serverVersionNumber>e.serverVersionNumber){this.cachedHandshakes.splice(0,t);break}}}async compareHandshake(e,t){if(e.hashCode!==t.hashCode){const e=this.fileName.split("."),t=e.length>1?e.pop():"NA",n=p.PathUtil.getMonikerFromRelativePath(this.fileName).moniker||"None";if(P)_.CoauthoringTelemetry.ReportDesync(_.DesyncReason.Unknown,t,n,!0),await i.window.showInformationMessage("Live Share: The current document is out of sync with the host, and reconnecting did not resolve the issue. Please ask the host to end and reshare the session.",{modal:!0});else{_.CoauthoringTelemetry.ReportDesync(_.DesyncReason.Unknown,t,n);const e={title:"Reconnect"};await i.window.showInformationMessage("Live Share: The current document is out of sync with the host. Please try reconnecting to the session.",{modal:!0},e)===e&&(_.CoauthoringTelemetry.ReportDesyncReload(),await r.Settings.save(o.SettingKeys.desyncReload,!0),await v.ExtensionUtil.setTransientWorkspace(!1),i.commands.executeCommand("workbench.action.reloadWindow"))}}}};let P=!1;t.desyncReload=function(){P=!0}},function(e,t,n){"use strict";function i(e){return e<0?0:e>4294967295?4294967295:0|e}Object.defineProperty(t,"__esModule",{value:!0});class s{constructor(e,t){this.index=e,this.remainder=t}}t.PrefixSumIndexOfResult=s;t.PrefixSumComputer=class{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}getCount(){return this.values.length}insertValues(e,t){e=i(e);const n=this.values,s=this.prefixSum,r=t.length;return 0!==r&&(this.values=new Uint32Array(n.length+r),this.values.set(n.subarray(0,e),0),this.values.set(n.subarray(e),e+r),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(s.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}changeValue(e,t){return e=i(e),t=i(t),this.values[e]!==t&&(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=i(e),t=i(t);const n=this.values,s=this.prefixSum;if(e>=n.length)return!1;let r=n.length-e;return t>=r&&(t=r),0!==t&&(this.values=new Uint32Array(n.length-t),this.values.set(n.subarray(0,e),0),this.values.set(n.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(s.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalValue(){return 0===this.values.length?0:this._getAccumulatedValue(this.values.length-1)}getAccumulatedValue(e){return e<0?0:(e=i(e),this._getAccumulatedValue(e))}_getAccumulatedValue(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;0===t&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let n=t;n<=e;n++)this.prefixSum[n]=this.prefixSum[n-1]+this.values[n];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalValue();let t=0,n=this.values.length-1,i=0,r=0;for(;t<=n;){i=t+(n-t)/2|0;const s=this.prefixSum[i];if(r=s-this.values[i],e<r)n=i-1;else{if(!(e>=s))break;t=i+1}}return new s(i,e-r)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(79),s=n(415),r=n(60),o=n(24),a=n(236);class c{constructor(e,t,n){this.position=e,this.length=t,this.text=n}}t.Edit=c;class l{constructor(e,t){this.serverVersion=e,this.unacknowledged=t,this.unacknowledgedCount=t.length}}t.OTAlgorithmStatus=l;class u{constructor(e,t){this.currentServerVersionNumber=e,this.unacknowledgedChanges=t}}t.OTAlgorithmState=u,t.serverVersionChangedEventName="serverVersionChanged";class d{constructor(e,t){this.unacknowledgedChanges=a.getTimedArray("unacknowledgedchangestime"),this.serverVersionChangedEvent=new o.EventEmitter,this.host=e,this.diagnosticTrace=t;const n=new class{constructor(){this.trace=e.trace}get fileName(){return e.fileName}};this.transformManager=new s.TransformManager(n)}getOperationalTransformStatus(){return new l(this.transformManager.CurrentServerVersionNumber,this.unacknowledgedChanges)}getCurrentHistory(){return this.transformManager.CurrentHistory}setInitialHistory(e){this.transformManager.setInitialHistory(e)}saveState(){let e=this.transformManager.CurrentServerVersionNumber,t=[];for(let e=0;e<this.unacknowledgedChanges.length;++e)t.push(this.unacknowledgedChanges[e].clone());return new u(e,t)}loadState(e){this.transformManager.RollbackTo(e.currentServerVersionNumber),a.setArray(this.unacknowledgedChanges,e.unacknowledgedChanges)}acceptLocalChange(e,t,n){this.diagnosticTrace&&(r.logger.log(`acceptOriginalBufferChange: ${JSON.stringify(e)}`),r.logger.indent());let s=d._toTextChangeArr(t),o=i.MessageFactory.TextChangeMessage(this.host.clientID,this.host.fileName,void 0,this.transformManager.CurrentServerVersionNumber,s);o.trackingId=n,this.unacknowledgedChanges.push(new h(o,e)),this.host.postMessage(o),this.diagnosticTrace&&r.logger.unindent()}acceptRemoteChange(e,n,i){if(this.host.trace.verbose("OTAlgorithm.acceptRemoteChange"),this.diagnosticTrace&&(r.logger.log(`acceptRemoteChange: ${JSON.stringify(n)}`),r.logger.indent()),r.assert(n.clientId!==this.host.clientID,"Changes must be from a remote client"),n.clientId===this.host.clientID)return void(this.diagnosticTrace&&r.logger.unindent());this.diagnosticTrace&&(r.logger.log("beginning to undo unacknowledged changes."),r.logger.indent());for(let t=this.unacknowledgedChanges.length-1;t>=0;--t)this.host.trace.verbose("Undoing unacknowledged change so we can apply remote change"),this._applyUndoChangeOnBuffer(e,this.unacknowledgedChanges[t].previousVersion);this.diagnosticTrace&&(r.logger.unindent(),r.logger.log("finished undo of unacknowledged changes."),r.logger.log("beginning to apply server message."),r.logger.indent());let s=this.transformManager.TransformMessageToCurrent(n);this.host.trace.verbose("OTAlgorithm applying remote change to buffer"),this._applyOperationOnBuffer(e,s),this.transformManager.AddToServersionHistory(i,n,s),this.diagnosticTrace&&(r.logger.unindent(),r.logger.log("finished applying server message."),r.logger.log("beginning to redo unacknowledged changes."),r.logger.indent());for(let t=0;t<this.unacknowledgedChanges.length;++t){let n=this.unacknowledgedChanges[t].message,s=this.transformManager.TransformMessageToCurrent(n);this.host.trace.verbose("Redoing unacknowledged change");let r=this._applyOperationOnBuffer(e,s);this.unacknowledgedChanges[t].previousVersion=r,this.transformManager.AddToServersionHistory(++i,n,s)}this.transformManager.RemoveUnacknowledgedChangesFromServerVersionHistory(this.unacknowledgedChanges.length),this.diagnosticTrace&&(r.logger.unindent(),r.logger.log("finished redo of unacknowledged changes."),r.logger.unindent()),this.serverVersionChangedEvent.emit(t.serverVersionChangedEventName)}_applyUndoChangeOnBuffer(e,t){let n=new Array(t.length);for(let e=0;e<t.length;++e){let i=t[e];n[e]=new c(i.newPosition,i.newLength,i.oldText)}e.applyRemoteEdits(n)}transformMessageToEdits(e,t){if(r.assert(t.changeServerVersion===this.transformManager.CurrentServerVersionNumber,"Cannot apply change on buffer due to different contexts."),t.changeServerVersion!==this.transformManager.CurrentServerVersionNumber)return[];const n=t.changes||[];let i=new Array(n.length),s=-1,o=-1;for(let t=0;t<n.length;++t){let a=n[t],l=a.start,u=a.start+a.length;{let e=Math.max(o,l),t=Math.max(o,u);e===l&&t===u||(this.diagnosticTrace&&r.logger.log(r.colorize.red("warning")+`: overlapping edits: position: ${l}, length: ${u-l} has been clamped to position: ${e}, length: ${t-e}`),l=e,u=t)}{let t=Math.min(Math.max(0,l),e),n=Math.min(Math.max(t,u),e);t===l&&n===u||(this.diagnosticTrace&&r.logger.log(r.colorize.red("warning")+`: edit out of bounds: position: ${l}, length: ${u-l} has been clamped to position: ${t}, length: ${n-t}`),l=t,u=n)}s=l,o=u,i[t]=new c(l,u-l,a.newText||"")}return i}_applyOperationOnBuffer(e,t){const n=this.transformMessageToEdits(e.getMaximumOffset(),t);return e.applyRemoteEdits(n)}acceptTextChangeAcknowledge(e,n){this.diagnosticTrace&&(r.logger.log("acceptTextChangeAcknowledge"),r.logger.indent());try{if(r.assert(e.clientId===this.host.clientID,"Changes must a change we initiated"),e.clientId!==this.host.clientID)return;let i=this.unacknowledgedChanges[0];this.unacknowledgedChanges.splice(0,1),this.transformManager.AddToServersionHistory(n,i.message),this.serverVersionChangedEvent.emit(t.serverVersionChangedEventName)}finally{this.diagnosticTrace&&r.logger.unindent()}}TransformMessageToCurrent(e){return this.transformManager.TransformMessageToCurrent(e)}static _toTextChangeArr(e){let t=new Array(e.length);for(let n=e.length-1;n>=0;--n){let s=e[n];t[n]=i.MessageFactory.TextChange(s.oldPosition,s.oldLength,s.newText)}return t}}t.OTAlgorithm=d;class h{constructor(e,t){this.message=e,this.previousVersion=t,this.rollbackEdits=new Array(t.length);for(let e=0;e<t.length;++e){let n=t[e];this.rollbackEdits[e]=i.MessageFactory.TextChange(n.newPosition,n.newLength,n.oldText)}}clone(){return new h(this.message,this.previousVersion)}}t.UnacknowledgedChange=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(19),s=n(79),r=n(60);class o{constructor(e){this.serverVersionHistory=new Array,this.host=e,this.serverVersionHistory.push(new l(-1,null))}AddToServersionHistory(e,t,n){let i=new l(e,t);n&&t.changeServerVersion!==n.changeServerVersion&&i.AddMessage(n),this.serverVersionHistory.push(i)}RemoveUnacknowledgedChangesFromServerVersionHistory(e){this.serverVersionHistory.splice(this.serverVersionHistory.length-e,e)}RollbackTo(e){for(let t=this.serverVersionHistory.length-1;t>=0;--t)if(this.serverVersionHistory[t].serverVersionNumber===e)return void this.serverVersionHistory.splice(t+1);r.assert(!1,"Failed to find version number to remove")}get CurrentServerVersionNumber(){return this.serverVersionHistory[this.serverVersionHistory.length-1].serverVersionNumber}get CurrentHistory(){return this.serverVersionHistory.map(e=>e.clone())}setInitialHistory(e){const t=e[e.length-1].serverVersionNumber;1===this.serverVersionHistory.length&&-1===this.serverVersionHistory[0].serverVersionNumber?(this.serverVersionHistory=e,this.host.trace.info(`Setting initial history for ${i.TraceFormat.formatPath(this.host.fileName)} (server version: ${t})`)):this.host.trace.warning(`Attempted to overwrite history for ${i.TraceFormat.formatPath(this.host.fileName)} with ${t} (current: ${this.CurrentServerVersionNumber})`)}TransformMessageToCurrent(e){return this.TransformMessageToVersionWithMessageIndex(e,this.CurrentServerVersionNumber,this.serverVersionHistory.length)}static TrackForwardAcrossChange(e,t){return o.TrackForwardAcrossChangeWithAdjustment(e,new c,t)}static TrackForwardAcrossChangeWithAdjustment(e,t,n){let i=0;for(let s=0;s<n.length;++s){let r=n[s];if(void 0===r.start||void 0===r.length)continue;const o=r.newText||"";if(r.start+r.length>=e&&s>=t.nextChangeIndex){r.start<e&&(e=r.start+o.length);break}i+=o.length-r.length}return e+=i+t.offset}static TrackBackwardAcrossChange(e,t){return o.TrackBackwardAcrossChangeWithAdjustment(e,new c,t)}static TrackBackwardAcrossChangeWithAdjustment(e,t,n){for(t.offset=0,t.nextChangeIndex=-1;++t.nextChangeIndex<n.length;){let i=n[t.nextChangeIndex];if(void 0===i.start||void 0===i.length)continue;const s=i.newText||"";if(i.start+s.length>=e){i.start<e&&(t.offset=e-i.start,e=i.start);break}e-=s.length-i.length}return e}TransformMessageIndexToVersion(e,t){let n=this.serverVersionHistory[t].GetBestMessage(e);if(n.changeServerVersion===e)return n;let i=this.TransformMessageToVersionWithMessageIndex(n,e,t);return this.serverVersionHistory[t].AddMessage(i),i}TransformMessageToVersionWithMessageIndex(e,t,n){if(r.assert(void 0!==e.changeServerVersion&&t>=e.changeServerVersion,`Can't translate messages to prior to their creation. Target: ${t}, Message: ${e.changeServerVersion}`),void 0!==e.changeServerVersion&&t<e.changeServerVersion)return e;let i=this.serverVersionHistory.length-1;for(let e=i;e>=0;--e){if(this.serverVersionHistory[e].serverVersionNumber===t){i=e;break}}let c=!1,l=i+1;for(let t=i;t>=0;--t){let n=this.serverVersionHistory[t];if(n.serverVersionNumber===e.changeServerVersion){l=t+1;break}c=c||n.Message&&n.Message.clientId!==e.clientId||!1}if(l>i)return e;if(!c)return s.MessageFactory.TextChangeMessage(e.clientId,e.fileName,e.fileVersion,t,e.changes);let u=[];for(let t of e.changes||[])u.push(s.MessageFactory.TextChange(t.start,t.length,t.newText));let d=null,h=n>i?n-1:i;for(let t=h;t>=l;--t){let n=this.serverVersionHistory[t];if(n.Message&&n.Message.clientId===e.clientId){if(null===d){d=[];for(let e=0;e<this.serverVersionHistory.length;++e){d.push([]);for(let t=0;t<u.length;++t)d[e][t]=new a}}if(void 0===e.changeServerVersion)throw new Error("Message is missing change server version.");let n=this.TransformMessageIndexToVersion(e.changeServerVersion,t);if(n.changes)for(let e=0;e<u.length;++e){let i=u[e];if(void 0===i.start||void 0===i.length){r.assert(!1,"Text change has undefined start or length.");continue}let s=o.TrackBackwardAcrossChangeWithAdjustment(i.start,d[t][e].start,n.changes||[]),a=o.TrackBackwardAcrossChangeWithAdjustment(i.start+i.length,d[t][e].end,n.changes||[]);r.assert(s>=0,"start must be positive"),r.assert(a>=s,"end must not come before start"),i.start=s,i.length=a-s}}}let f=e.changeServerVersion;for(let t=l;t<=h;++t){let n=this.serverVersionHistory[t];if(void 0!==f&&(t<=i||n.Message&&n.Message.clientId===e.clientId)){let e=this.TransformMessageIndexToVersion(f,t);if(!e.changes)continue;for(let n=0;n<u.length;++n){let i=u[n];if(void 0===i.start||void 0===i.length){r.assert(!1,"Text change has undefined start or length.");continue}let s=i.start,a=i.start+i.length;null===d?(s=o.TrackForwardAcrossChange(s,e.changes),a=o.TrackForwardAcrossChange(a,e.changes)):(s=o.TrackForwardAcrossChangeWithAdjustment(s,d[t][n].start,e.changes),a=o.TrackForwardAcrossChangeWithAdjustment(a,d[t][n].end,e.changes)),r.assert(s>=0,"start must be positive"),r.assert(a>=s,"end must not come before start"),i.start=s,i.length=a-s}t<=i&&(f=n.serverVersionNumber)}}return s.MessageFactory.TextChangeMessage(e.clientId,e.fileName,void 0,f,u)}}t.TransformManager=o;class a{constructor(){this.start=new c,this.end=new c}}class c{constructor(){this.offset=0,this.nextChangeIndex=0}}class l{constructor(e,t){this.serverVersionNumber=e,Array.isArray(t)?this.messages=t:this.messages=[t]}get Message(){return this.messages[0]}clone(){const e=this.messages.map(e=>e?s.MessageFactory.CoauthoringMessage(e):e);return new l(this.serverVersionNumber,e)}GetBestMessage(e){for(let t=this.messages.length-1;t>=0;--t){let n=this.messages[t];if(n&&void 0!==n.changeServerVersion&&n.changeServerVersion<=e)return n}throw new Error("Invalid message server version.")}AddMessage(e){for(let t=this.messages.length-1;t>=0;--t){let n=this.messages[t];if(n&&void 0!==e.changeServerVersion&&void 0!==n.changeServerVersion&&e.changeServerVersion>=n.changeServerVersion)return r.assert(e.changeServerVersion!==n.changeServerVersion,"Should never try to insert a message we have"),r.assert(e.clientId===n.clientId,"Client IDs should never change"),void this.messages.splice(t+1,0,e)}r.assert(!1,"Never should try to insert a new version before index 0")}}t.ServerVersion=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SyncManager=class{constructor(){this.snapshots=new Map,this.snapshotsQueue=[],this.pendingSyncChecks=new Map}recordSnapshot(e){if(this.pendingSyncChecks.has(e.serverVersionNumber)){const t=this.pendingSyncChecks.get(e.serverVersionNumber);t.resolve(!!e.hasUnacknowledgedChanges||e.hashCode===t.hashCode),this.pendingSyncChecks.delete(e.serverVersionNumber)}this.snapshots.set(e.serverVersionNumber,e.hasUnacknowledgedChanges?void 0:e.hashCode),this.snapshotsQueue.push(e.serverVersionNumber),this.trimBlessedStates()}trimBlessedStates(){if(!(this.snapshotsQueue.length<2e4)){for(let e=0;e<1e4;e++)this.snapshots.delete(this.snapshotsQueue[e]);this.snapshotsQueue.splice(0,1e4)}}isFileSyncedForVersion(e,t){if(this.snapshots.has(e)){const n=this.snapshots.get(e);return Promise.resolve(void 0===n||n===t)}if(this.pendingSyncChecks.has(e))return this.pendingSyncChecks.get(e).result;let n;const i=new Promise((e,t)=>{n=e});return this.pendingSyncChecks.set(e,{hashCode:t,resolve:n,result:i}),i}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){e.done?s(e.value):new n((function(t){t(e.value)})).then(o,a)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,i,s,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return{next:o(0),throw:o(1),return:o(2)};function o(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=i[2&o[0]?"return":o[0]?"throw":"next"])&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[0,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,i=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(s=r.trys,(s=s.length>0&&s[s.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(6===o[0]&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=t.call(e,r)}catch(e){o=[6,e],i=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};t.__esModule=!0;var r=function(){function e(e){this.promiseResolverQueue=[],this.permits=e}return e.prototype.getPermits=function(){return this.permits},e.prototype.wait=function(){return i(this,void 0,void 0,(function(){var e=this;return s(this,(function(t){return this.permits>0?(this.permits-=1,[2,Promise.resolve(!0)]):[2,new Promise((function(t){return e.promiseResolverQueue.push(t)}))]}))}))},e.prototype.acquire=function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){return[2,this.wait()]}))}))},e.prototype.waitFor=function(e){return i(this,void 0,void 0,(function(){var t,n,i=this;return s(this,(function(s){return this.permits>0?(this.permits-=1,[2,Promise.resolve(!0)]):(t=function(e){},n=new Promise((function(e){t=e})),this.promiseResolverQueue.push(t),setTimeout((function(){var e=i.promiseResolverQueue.indexOf(t);-1!==e&&i.promiseResolverQueue.splice(e,1),t(!1)}),e),[2,n])}))}))},e.prototype.tryAcquire=function(){return this.permits>0&&(this.permits-=1,!0)},e.prototype.drainPermits=function(){if(this.permits>0){var e=this.permits;return this.permits=0,e}return 0},e.prototype.signal=function(){if(this.permits+=1,this.permits>1&&this.promiseResolverQueue.length>0)throw new Error("this.permits should never be > 0 when there is someone waiting.");if(1===this.permits&&this.promiseResolverQueue.length>0){this.permits-=1;var e=this.promiseResolverQueue.shift();e&&e(!0)}},e.prototype.release=function(){this.signal()},e.prototype.execute=function(e){return i(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.wait()];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,,4,5]),[4,e()];case 3:return[2,t.sent()];case 4:return this.signal(),[7];case 5:return[2]}}))}))},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e,t){super(...arguments),this.code=t}}t.CancellationError=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(977);t.defaultStrategy=new i.AADv2Strategy,t.registeredStrategies=[t.defaultStrategy]},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(164));t.fetchPost=async(e,t,n)=>{let i={"Content-Type":"application/x-www-form-urlencoded"};if(n&&(i=Object.assign(Object.assign({},i),n)),"undefined"!=typeof fetch){const n=await fetch(e,{method:"POST",headers:i,body:t});return await n.json()}return(await s.default(e,{method:"POST",headers:i,data:t,proxy:!1})).data}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(986);t.getRedirectUri=async function(e){if(s.isFunction(i.env.createAppUri)){return(await i.env.createAppUri()).with({path:"/signin"})}if(!i.env.uriScheme)throw new Error("No `vscode.env.uriScheme` set.");const t=i.Uri.parse(`${i.env.uriScheme}://${e}/signin`);if(s.isFunction(i.env.asExternalUri)){return(await i.env.asExternalUri(t)).with({fragment:""})}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(987),s=i.getKeytar();t.keytarService=new class{constructor(){this.createAccessTokenKey=e=>`${e}.accessToken`,this.getAccessTokenFromKeytar=async e=>{try{return await this.keytarModule.getPassword("VS Code Account",this.createAccessTokenKey(e.name))}catch(e){}},this.storeAccessTokenToKeytar=async(e,t)=>{try{await this.deleteAccessTokenFromKeytar(e),await this.keytarModule.setPassword("VS Code Account",this.createAccessTokenKey(e.name),t)}catch(e){console.log(e)}},this.deleteAccessTokenFromKeytar=async e=>{try{await this.keytarModule.deletePassword("VS Code Account",this.createAccessTokenKey(e.name))}catch(e){console.log(e)}}}get keytarModule(){if(!this.keytarInternal)throw new Error("Please call `init` method first to pass the keytar module.");return this.keytarInternal}init(e){this.keytarInternal=e||s}async getRefreshTokenFromkeytar(e){if(this.keytarModule)try{return await this.keytarModule.getPassword("VS Code Account",e.name)}catch(e){}}async storeRefreshTokenToKeytar(e,t){if(this.keytarModule)try{await this.deleteRefreshTokenFromKeytar(e),await this.keytarModule.setPassword("VS Code Account",e.name,t)}catch(e){}}async deleteRefreshTokenFromKeytar(e){if(this.keytarModule)try{await this.keytarModule.deletePassword("VS Code Account",e.name)}catch(e){}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(28),s=n(0),r=n(170),o=n(32),a=n(13),c=n(15),l=n(69),u=n(96),d=n(6);t.LiveShareStrategyBase=class{constructor(){this.name="LiveShare",this.publicName="Github",this.endpointUrl=()=>{const e=a.Settings.getUri(c.SettingKeys.serviceUri);return o.format(e)},this.authRequestIdToStrategyInfoMap=new Map,this.minExpiration=7200,this.onTokenUpdateEmitter=new s.EventEmitter,this.onTokenUpdated=this.onTokenUpdateEmitter.event,this.getAccessToken=async()=>{const e=i.randomBytes(16).toString("base64").replace(/[^\w\s]/gi,""),t=await this.getRedirectUri(),n=new URLSearchParams(t.query).get("state")||e,r=this.getSignInUrl(),o=s.Uri.parse(r),a=decodeURIComponent(t.toString()),c=new URLSearchParams([["redirect",a],["state",n],["extensionId",n],["nonce",e]]),l=new d.Signal,u={strategy:this,redirect_uri:a,signal:l};this.authRequestIdToStrategyInfoMap.set(n,u);const h=`${o}?${c.toString()}`;return await s.env.openExternal(s.Uri.parse(h)),await l.promise},this.exchangeAuthorizationCode=async e=>{const t=await u.auth.API.fetchPost(`${this.endpointUrl()}auth/token/`,JSON.stringify({grant_type:"urn:ietf:params:oauth:grant-type:user_code",user_code:e}),{"Content-Type":"application/json"});if(t.error_description)throw new Error(t.error_description);return this.parseTokenPayloadFromAccessToken(t.access_token)},this.parseTokenPayloadFromAccessToken=e=>{const t=1e3*r(e).exp;return new Date(t).getTime()-Date.now()<1e3*this.minExpiration?null:{accessToken:e,expiresOn:t,tokenType:"vsls",strategy:this}}}signalNewToken(e){this.onTokenUpdateEmitter.fire(e)}getRedirectUri(){return u.auth.API.getRedirectUri(l.LIVESHARE_EXTENSION_ID)}getSignInUrl(){return`${this.endpointUrl()}auth/identity/github/`}async receiveProtocolHandlerCallback(e){const t=new URLSearchParams(e.query),n=t.get("extensionId");if(!n)return!1;const i=decodeURIComponent(n),s=this.authRequestIdToStrategyInfoMap.get(i);if(!s)return!1;if(t.get("error"))return s.signal.resolve(null),!0;const r=t.get("userCode");if(!r)return s.signal.reject(new Error("No code query param found.")),!0;const o=await this.exchangeAuthorizationCode(r);return s.signal.resolve(o),!0}async refreshToken(e){return this.parseTokenPayloadFromAccessToken(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(33),r=n(996),o=n(997);t.methodDecoratorsFactory=e=>({errorNotificationMethodDecorator:function(t,n,i){return function(s,o,a){return c.bindCommandDecorator(s=>r.errorNotificationCommandDecoratorFactory(s,e,n,t,!1,i),s,o,a)}},telemetryMethodDecorator:function(t,n,i,s,r){return function(a,l,u){return c.bindCommandDecorator(a=>o.telemetryCommandDecoratorFactory(a,e,t,n,i,s,r),a,l,u)}},controllerDecorator:function(t){return n=t,class extends n{constructor(){super(...arguments),this.commandContextBuilder=e.commandContextBuilder(),this.bindingContext=n.bindingContext,this.commandRegistrations=[]}registerCommands(){this.bindingContext.commandBindings.forEach(e=>{const t=this.bindingContext.commandAdaptors.get(e.methodName),s=i.commands.registerCommand(e.commandName,(...i)=>{const s=new t(this),r=this.commandContextBuilder.build(s,e.commandName,n.name);return s.invoke(i,r)},this);this.commandRegistrations.push(s)})}unregisterCommands(){this.commandRegistrations.splice(0).forEach(e=>e.dispose())}};var n}}),t.commandBindingDecorator=function(e){return function(t,n,i){c.bindCommand(e,t,n,i)}};class a{constructor(){this.commandAdaptors=new Map,this.commandBindings=[]}}class c{static getBindingContext(e){return e.constructor.bindingContext||(e.constructor.bindingContext=new a),e.constructor.bindingContext}static bindCommand(e,t,n,i){const s=c.getBindingContext(t);s.commandBindings.push({commandName:e,methodName:n,descriptor:i}),c.getOrCreateCommandAdapter(s,n,i)}static getOrCreateCommandAdapter(e,t,n){let i=e.commandAdaptors.get(t);if(!i){if("function"==typeof n.value)i=class{constructor(e){this.controller=e}async invoke(e,t){await n.value.apply(this.controller,e)}};else{if("function"!=typeof n.get)throw new Error("Unsupported command binding.");i=class{constructor(e){this.controller=e}async invoke(e,t){await n.get.apply(this.controller,e)}}}e.commandAdaptors.set(t,i)}return i}static bindCommandDecorator(e,t,n,i){const r=c.getBindingContext(t),o=c.getOrCreateCommandAdapter(r,n,i),a=s.DecoratorHelper.setupDecorator(e)(o);return r.commandAdaptors.set(n,a),i}}t.ControllerHelper=class{static register(e,t){if(!e.registerCommands||!e.unregisterCommands)throw new Error(e.constructor.name+" is not a command controller.");e.registerCommands();const n=new i.Disposable(()=>{e.unregisterCommands()});return t&&t.push(n),n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(7),s=n(241),r=n(20),o=n(6),a=n(242),c=n(243),l=n(22),u=n(9);t.ErrorNotificationCommandDecorator=class{constructor(e,t,n,i,s,r,o,a){this.command=e,this.next=t,this.telemetry=n,this.telemetryFaultEventName=i,this.title=s,this.isModalError=r,this.onError=o,this.onNoErrorMessage=a}async invoke(e,t){const{cancellationTokenSource:n}=t;let d;t.commandName=this.title;try{d=await this.next.invoke(e,t)}catch(d){try{let u;d.code&&(u=l.ExtensionUtil.getErrorString(d.code)),this.onNoErrorMessage&&(u=await this.onNoErrorMessage(d,t,e)),u||(u=d.message);const h=`${t.commandName}: ${u}`;d instanceof o.CancellationError&&n&&!n.token.isCancellationRequested&&n.cancel();const f=d instanceof s.UserError||d instanceof o.CancellationError;d.isSuppressUserNotification||d instanceof o.CancellationError&&!d.message||d instanceof r.RpcConnectionShutdownError||(f?i.NotificationUtil.showInformationMessage(h,!1):d instanceof c.ByDesignError?await i.NotificationUtil.showErrorMessage(h,{modal:this.isModalError}):d instanceof a.NonBlockingError||await i.NotificationUtil.showErrorMessage(h,{modal:this.isModalError}))}catch(e){d=e}if(d&&!d.hasRecorded){const e=`${t.commandName}: [unhandled exception (decorator)] ${d.message}`;t.trace.error(e),this.telemetry.sendFault(this.telemetryFaultEventName,u.FaultType.Error,e,d)}d&&this.onError&&await this.onError(d,t,e)}return d}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),s=n(244),r=n(16),o=n(9);t.TelemetryCommandDecorator=class{constructor(e,t,n,i,s,r,o,a,c){this.command=e,this.next=t,this.workspaceService=n,this.telemetry=i,this.telemetryEventName=s,this.telemetryFaultEventName=r,this.telemetryTitle=o,this.telemetryEventVersion=a,this.onError=c}async invoke(e,t){let n=void 0,i=void 0,a=this.telemetry.startTimedEvent(this.telemetryEventName),c=o.TelemetryResult.Success,l=void 0;t.telemetryEvent=a,this.telemetry.setCorrelationEvent(a),a.addProperty(r.TelemetryPropertyNames.COMMAND_TEXT,t.commandText),a.addMeasure(r.TelemetryPropertyNames.TELEMETRY_EVENT_VERSION,this.telemetryEventVersion),this.addInvocationTelemetryProperties(a,e.telemetryProperties),this.workspaceService.onProgressUpdated(e=>this.onWorkspaceProgressUpdated(e,a));try{n=await this.next.invoke(e,t),a.addProperty(r.TelemetryPropertyNames.EVENT_RESULT,o.TelemetryResult.Success)}catch(n){throw c=s.TelemetryUtil.DeriveTelemetryResult(n),l=s.TelemetryUtil.BuildTelemetryMessage(this.telemetryTitle,c,n.message),a.addProperty(r.TelemetryPropertyNames.EVENT_RESULT,c),this.onError&&this.onError(n,t,e),this.telemetry.sendFault(this.telemetryFaultEventName,s.TelemetryUtil.MapTelemetryResultToFaultType(c),l,n),i=n,n}finally{l=l||s.TelemetryUtil.BuildTelemetryMessage(this.telemetryTitle,o.TelemetryResult.Success);const e=a.end(c,l);t.trace.traceEvent(s.TelemetryUtil.MapTelemetryResultToTraceEventType(c),0,`Command [${t.commandName}]: ${l} (${e}ms)`),i&&(i.stack&&t.trace.error(o.cleanSensitiveInformation(i.stack)),i.hasRecorded=!0)}return n}addInvocationTelemetryProperties(e,t={}){for(let n of Object.keys(t))e.addProperty(n,t[n])}onWorkspaceProgressUpdated(e,t){switch(e.progress){case i.vsls.WorkspaceProgress.WaitingForHost:t.markTime(r.TelemetryPropertyNames.START_WAITING_FOR_HOST);break;case i.vsls.WorkspaceProgress.DoneWaitingForHost:t.markTime(r.TelemetryPropertyNames.DONE_WAITING_FOR_HOST);break;case i.vsls.WorkspaceProgress.ReconnectingToHost:t.markTime(r.TelemetryPropertyNames.RECONNECTING_TO_HOST);break;case i.vsls.WorkspaceProgress.ReconnectedToHost:t.markTime(r.TelemetryPropertyNames.RECONNECTED_TO_HOST)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(5),r=n(245),o=n(21),a=n(23),c=n(31),l=n(29),u=n(7);class d extends r.ClientAccessCheck{constructor(e,t,n,s,r){super(e,r),this.accessControlService=t,this.sessionContext=n,this.fileSystemManager=s,this.accessControl={},this.operationRejected=new i.EventEmitter,this.operationAccessChanged=new i.EventEmitter,this.disposables=[]}get isReadOnly(){return!!this.accessControl.isReadOnly}get onDidRejectOperation(){return this.operationRejected.event}get onDidChangeOperationAccess(){return this.operationAccessChanged.event}async init(){await super.init(),this.accessControl=await this.accessControlService.getAccessControlAsync()||{},this.disposables.push(this.accessControlService.onAccessControlChanged(this.accessControlChanged,this)),l.workspaceSessionInfoTracker.isReadOnly=this.isReadOnly,this.fileSystemManager.registerFileSystemProvider(this.isReadOnly),this.disposables.push(this.workspaceAccessControlService.onOperationRejected(this.workspaceAccessControlService_operationRejected,this)),this.disposables.push(this.workspaceAccessControlService.onOperationAccessChanged(this.workspaceAccessControlService_operationAccessChanged,this))}async dispose(){await super.dispose(),this.fileSystemManager.dispose(),await Promise.all(this.disposables.map(e=>e.dispose()))}async requestOperationAccess(e){await this.workspaceAccessControlService.requestOperationAccessAsync(e)}logRejectedOperation(e,t){return Promise.resolve()}async accessControlChanged(e){const t=this.isReadOnly;this.accessControl=e.accessControl||{};const n=this.isReadOnly;if(t!==n&&(l.workspaceSessionInfoTracker.isReadOnly=n,this.fileSystemManager.registerFileSystemProvider(n),a.sessionStateTracker.State===o.SessionState.Joined)){if(a.sessionStateTracker.State!==o.SessionState.Joined)return;const e=l.workspaceSessionInfoTracker.isReadOnly?"read-only":"read/write";u.NotificationUtil.showInformationMessage(`The host has given you ${e} access.`,!1)}}async workspaceAccessControlService_operationRejected(e){const t=this.sessionContext.coeditingClient.clientID===e.operation.sessionId,n=a.sessionStateTracker.State===o.SessionState.Joined,i=e.access===s.vsls.RestrictedOperationAccess.DisabledByHostConfiguration,r=c.userAuthStateTracker.isCurrentUserAnonymous();if(!e.operation||!i&&!r||!t||!n)return;const l=await this.isReadOnlySession();this.operationRejected.fire({operation:e.operation,isCurrentUserAnonymous:r,isReadOnlySession:l})}workspaceAccessControlService_operationAccessChanged(e){e.operation&&a.sessionStateTracker.State===o.SessionState.Joined&&this.operationAccessChanged.fire({operation:e.operation,access:e.access})}}t.AccessControlManager=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Edit="Edit",e.FileAccess="FileAccess",e.CodeAction="CodeAction",e.RunTask="RunTask",e.TerminateTask="TerminateTask",e.LaunchDebug="LaunchDebug",e.DebugContinue="DebugContinue",e.DebugSetVariable="DebugSetVariable",e.DebugEvaluate="DebugEvaluate",e.WriteToSharedTerminal="WriteToSharedTerminal",e.CleanSourceControlResource="CleanSourceControlResource",e.ExecuteNotebookCell="ExecuteNotebookCell"}(t.WellKnownRestrictedOperations||(t.WellKnownRestrictedOperations={})),function(e){e.RejectedInReadOnlySession="RejectedInReadOnlySession",e.RejectedForNotOwner="RejectedForNotOwner",e.DisabledByHost="DisabledByHost"}(t.RestrictedOperationRejectionReason||(t.RestrictedOperationRejectionReason={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(5),r=n(238),o=n(13),a=n(15),c=n(22),l=n(94),u=n(21),d=n(245),h=n(7),f=n(23),p=n(29),m=n(26),g=n(42);var y;!function(e){e.readOnly="readOnly",e.readWrite="readWrite"}(y=t.AnonymousAccessLevel||(t.AnonymousAccessLevel={}));class v extends d.ClientAccessCheck{constructor(e,t){super(e.workspaceAccessControlService(),t),this.guestNameSemaphore=new r.default(1),this.guestNameCounts=new Map,this.workspaceUserService=e.workspaceUserService()}get isReadOnly(){return!1}endCollaboration(){this.guestNameCounts.clear(),super.endCollaboration(),p.workspaceSessionInfoTracker.clearAnonymousAccessMap()}async setReadOnly(e){let t=await this.workspaceAccessControlService.getAccessControlAsync()||{};if(t.defaultAccessControl=t.defaultAccessControl||{},!!t.defaultAccessControl.isReadOnly!==e){if(l.SessionContext.hasCollaborators)return void await i.window.showErrorMessage("Cannot change read-only status of the collaboration session when there are participants joined.",{modal:c.ExtensionUtil.enableModalNotifications});t.defaultAccessControl.isReadOnly=e,p.workspaceSessionInfoTracker.isReadOnly=e,await this.workspaceAccessControlService.setAccessControlAsync(t)}}async getUserAccessControlBySessionId(e){return await this.ensureWorkspaceAccessControl(),this.workspaceAccessControl.userAccessControl[e]}async setUserReadOnly(e,t){const n=await this.workspaceAccessControlService.getAccessControlAsync()||{};n.defaultAccessControl=n.defaultAccessControl||{};const i=n.userAccessControl,s=i[t];(s&&s.isReadOnly)!==e&&(i[t]=Object.assign(Object.assign({},s),{isReadOnly:e}),await this.workspaceAccessControlService.setAccessControlAsync(n))}async setOperationAccess(e,t){await this.workspaceAccessControlService.setOperationAccessAsync(e,t)}async setUserAccessControl(e,t){const n="accept"===(o.Settings.get(a.SettingKeys.anonymousGuestApproval)||"").toLowerCase(),i=p.workspaceSessionInfoTracker.getAnonymousAccess(t.id)===y.readOnly;t.isAnonymous?(!this.isReadWriteAnonymousEnabled()||this.isReadWriteAnonymousEnabled()&&(i||n))&&(await this.setUserReadOnly(!0,e),n&&this.isReadWriteAnonymousEnabled()&&await p.workspaceSessionInfoTracker.setAnonymousAccess(t.id,m.localize("notification.AlwaysAcceptAnonymous"))):await this.copyPreviousAccessControl(t,e)}async copyAccessControl(e,t){const n=this.workspaceAccessControl,i=n.userAccessControl,s=i[e],r=i[t];s&&(i[t]=Object.assign(Object.assign(Object.assign({},r),s),{isReadOnly:!!s.isReadOnly}),await this.workspaceAccessControlService.setAccessControlAsync(n))}async copyPreviousAccessControl(e,t){const n=l.SessionContext.getLatestPreviousSessionId(e.id);if(n){await this.getUserAccessControlBySessionId(n)&&await this.copyAccessControl(n,t)}}async logRejectedOperation(e,t){await this.workspaceAccessControlService.rejectOperationAsync(e,t)}async onWorkspaceSessionChanged(e){if(e.changeType===s.vsls.WorkspaceSessionChangeType.Requested&&f.sessionStateTracker.State===u.SessionState.Shared){const{sessionNumber:t,userProfile:n}=e,i=await this.approveGuest(t,e);"boolean"==typeof i?(i&&await this.setUserAccessControl(t,n),await this.workspaceUserService.acceptOrRejectGuestAsync(t,{accept:i})):await this.workspaceUserService.acceptOrRejectGuestAsync(t,{accept:!1,errorCode:i.errorCode||s.vsls.ErrorCodes.CollaborationSessionGuestRejectedWithSpecificReason,message:i.errorMessage})}e.changeType===s.vsls.WorkspaceSessionChangeType.Unjoined&&f.sessionStateTracker.State===u.SessionState.Shared&&await this.showGuestLeftNotification(e)}async approveGuest(e,t){var n;const{userProfile:i}=t,r=i.clientCapabilities||{},c=!r.extensionReadOnlySupport||!r.clientReadOnlySupport,l=i.isAnonymous;if((p.workspaceSessionInfoTracker.isReadOnly||l)&&c){if(!r.extensionReadOnlySupport&&!r.clientReadOnlySupport)return{errorMessage:"Your VS Live Share extension does not support read-only collaboration session. Please update the extension."};if(!r.clientReadOnlySupport){const e="VisualStudio"===t.applicationName?"Visual Studio":void 0,n="VSCode"===t.applicationName?"VS Code":void 0,i=e||n;return{errorMessage:`Your ${i||"client"} does not support read-only collaboration session. Please update ${i||"the client"}.`}}return{errorMessage:"Read-only support is disabled. To join a read-only collaboration session, please enable the read-only support feature."}}const u=(o.Settings.get(a.SettingKeys.anonymousGuestApproval)||"").toLowerCase();if("reject"===u&&l)return{errorCode:s.vsls.ErrorCodes.ForbiddenHttpStatusCode,errorMessage:m.localize("The host does not allow anonymous guests. Please sign in.")};const d=o.Settings.get(a.SettingKeys.allowedDomains)||[];if(d&&0!==d.length){let e=null===(n=null==i?void 0:i.email)||void 0===n?void 0:n.split("@")[1];if(!d.includes(e))return{errorCode:s.vsls.ErrorCodes.ForbiddenHttpStatusCode,errorMessage:"The host has restricted you from joining the collaboration session."}}const h=this.buildGuestName(await this.getGuestDisplayName(i),l,i,!0),f="prompt"===u&&l,g=o.Settings.get(a.SettingKeys.guestApprovalRequired),y=this.isReadWriteAnonymousEnabled()&&!l;if(g||f){if(!this.isReadWriteAnonymousEnabled()||p.workspaceSessionInfoTracker.isReadOnly||y)return await this.waitForHostToAcceptGuest(e,h,l,i);if(this.isReadWriteAnonymousEnabled()&&l)return await this.waitForHostToAcceptGuestForReadWriteAnonymousExperiment(e,h,l,i)}return this.showJoinNotification(h),!0}buildGuestName(e,t,n,i){const s=p.workspaceSessionInfoTracker.isReadOnly,r=p.workspaceSessionInfoTracker.getAnonymousAccess(n.id)===y.readWrite;return s&&!t?e+=m.localize("guestNameToast.ReadOnlyLabel"):t&&(this.isReadWriteAnonymousEnabled()&&i?e+=m.localize("guestNameToast.AnonymousLabel"):this.isReadWriteAnonymousEnabled()&&r?e+=m.localize("guestNameToast.AnonymousReadWriteLabel"):e+=m.localize("guestNameToast.ReadOnlyAndAnonymousLabel")),e}async waitForHostToAcceptGuest(e,t,n,r){const c="accept"===(o.Settings.get(a.SettingKeys.anonymousGuestApproval)||"").toLowerCase();await this.workspaceUserService.fireProgressUpdatedToGuestAsync(s.vsls.WorkspaceProgress.WaitingForHost,e);const l=`${t}`+m.localize("notification.AcceptRejectGuest"),u=m.localize("notification.Accept"),d=m.localize("notification.Reject"),h=m.localize("notification.AlwaysAcceptAnonymous"),f=[u,d];n&&!c&&f.push(h);const g=await i.window.showInformationMessage(l,...f);return this.isReadWriteAnonymousEnabled()&&n&&await p.workspaceSessionInfoTracker.setAnonymousAccess(r.id,g),g===h&&await o.Settings.save(a.SettingKeys.anonymousGuestApproval,"accept"),await this.workspaceUserService.fireProgressUpdatedToGuestAsync(s.vsls.WorkspaceProgress.DoneWaitingForHost,e),g===u||g===h}async waitForHostToAcceptGuestForReadWriteAnonymousExperiment(e,t,n,r){await this.workspaceUserService.fireProgressUpdatedToGuestAsync(s.vsls.WorkspaceProgress.WaitingForHost,e);const o=`${t} `+m.localize("notification.AcceptRejectGuest"),a=m.localize("notification.AcceptReadOnly"),c=m.localize("notification.AcceptReadWrite"),l=[a,c,m.localize("notification.Reject")],u=await i.window.showInformationMessage(o,...l);return await this.workspaceUserService.fireProgressUpdatedToGuestAsync(s.vsls.WorkspaceProgress.DoneWaitingForHost,e),await p.workspaceSessionInfoTracker.setAnonymousAccess(r.id,u),u===a||u===c}isReadWriteAnonymousEnabled(){var e;return null===(e=g.getExpService())||void 0===e?void 0:e.getTreatmentVariable("vscode","readWriteAnonymous")}async showJoinNotification(e){let t=`${e}`+m.localize("notification.InformGuestJoined");const n=!!o.Settings.get(a.SettingKeys.showVerboseNotifications);await h.NotificationUtil.showInformationMessage(t,!n)}async showGuestLeftNotification(e){let t=this.getNameAndUsername(e.userProfile);switch(t=this.buildGuestName(t,e.userProfile.isAnonymous,e.userProfile,!1),e.disconnectedReason){case s.vsls.WorkspaceDisconnectedReason.NetworkDisconnected:{let e=`${t}`+m.localize("notification.GuestDisconnected");await i.window.showInformationMessage(e);break}case s.vsls.WorkspaceDisconnectedReason.Requested:{let e=`${t}`+m.localize("notification.GuestLeft");const n=!!o.Settings.get(a.SettingKeys.showVerboseNotifications);await h.NotificationUtil.showInformationMessage(e,!n);break}case s.vsls.WorkspaceDisconnectedReason.UserRemoved:case s.vsls.WorkspaceDisconnectedReason.UserBlocked:}}async getGuestDisplayName(e){let t=this.getNameAndUsername(e);await this.guestNameSemaphore.acquire();try{if(this.guestNameCounts.has(t)){return`${t} (${this.guestNameCounts.set(t,this.guestNameCounts.get(t)+1).get(t)})`}return this.guestNameCounts.set(t,0),t}finally{this.guestNameSemaphore.release()}}getNameAndUsername(e){let t=e.userName,n=e.name;if(!n)return t;if(e.isAnonymous)return n;if(n===t)return t;return`${n}${t?` (${t})`:""}`}onWorkspaceAccessControlChanged(e){super.onWorkspaceAccessControlChanged(e),p.workspaceSessionInfoTracker.isReadOnly=this.workspaceAccessControl.defaultAccessControl.isReadOnly,l.SessionContext.onWorkspaceAccessControlChanged(e)}async initWorkspaceAccessControl(){await super.initWorkspaceAccessControl()}}t.WorkspaceAccessControlManager=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(13),r=n(15),o=n(31),a=n(431),c=n(246),l=n(97),u=n(5),d=n(164);function h(){return s.Settings.get(r.SettingKeys.serviceUri)}t.AuthenticationProviderService=class{constructor(e){this.trace=e,this.authenticationChanged=new i.EventEmitter,this.onAuthenticationChanged=this.authenticationChanged.event,o.userAuthStateTracker.onUserInfoChanged(()=>this.fireAuthenticationChanged()),this.tokenExchangeService=new c.TokenExchangeService(e)}getCurrentUserAsync(e){return Promise.resolve(this.userInfo)}getCurrentAuthenticatedUserAsync(e){const t=new u.vsls.AuthenticatedUserInfo;return t.accessToken=this.loginToken,t.userInfo=this.userInfo,Promise.resolve(t)}removeRecentCollaboratorAsync(e,t){return Promise.resolve()}removeAllRecentCollaboratorsAsync(e){return Promise.resolve()}fireAuthenticationChanged(){this.trace.verbose("fireAuthenticationChanged");const e=new u.vsls.AuthenticationChangedEventArgs;e.accessToken=this.loginToken,e.account=this.userInfo,this.authenticationChanged.fire(e)}async loginAsync(e,t,n,i){if(this.trace.verbose("loginAsync"),!e.token)throw new Error("Empty token passed");return this.loginToken=e.token,this.userInfo=await async function(e){const t={headers:{Authorization:`Bearer ${e}`,"Cache-Control":"no-cache","Content-Type":"application/json"},proxy:!1},n=(await d.default.get(h()+"api/v1.2/profile",t)).data,i=n;return{id:i.id,emailAddress:i.email,displayName:i.name,userName:i.userName,avatarUri:i.avatarUri,recentCollaborators:n.recentCollaborators,isAnonymous:n.isAnonymous,programs:n.programs,accountStatus:n.status}}(e.token),this.userInfo}async loginWithExternalTokenAsync(e,t,n,i,s){if(this.trace.verbose("loginWithExternalTokenAsync"),!e.providerName)throw new Error("Empty provider name passed");if(!t.token)throw new Error("Empty native token passed");const r=a.EnumUtil.getEnumKeyByEnumValue(l.SupportedAuthProviders,e.providerName),o=l.SupportedAuthProviders[r];if(!o)throw new Error(`Provider with id ${e.providerName} is not supported`);let c=void 0;try{c=await this.tokenExchangeService.exchange(o,t.token)}catch(e){this.trace.error(`External token exchange failed with ${e}. Attempting legacy exchange.`),c=await this.performLegacyTokenExchange(o,t.token)}return await this.loginAsync({token:c},n,i,s)}logoutAsync(e,t){return this.trace.verbose("logoutAsync"),this.loginToken=void 0,this.userInfo=void 0,Promise.resolve()}async performLegacyTokenExchange(e,t){var n;const i=d.default.defaults.headers["Content-Type"];try{d.default.defaults.headers["Content-Type"]="application/json";const s={headers:{"Cache-Control":"no-cache"},proxy:!1},r=null===(n=h())||void 0===n?void 0:n.replace("prod","insiders");return(await d.default.post(r+"auth/exchange",{provider:e,token:t},s)).data.access_token}finally{d.default.defaults.headers["Content-Type"]=i}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EnumUtil=class{static getEnumKeyByEnumValue(e,t){return Object.keys(e).find(n=>e[n]==t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(43),s=n(0),r=n(97),o=n(246),a=n(13),c=n(15),l=n(31),u=n(170),d=n(9),h=n(16);t.VsCodeNativeAuthTokenProvider=class{constructor(e,t,n,i){this.providerId=e,this.scopes=t,this.logger=n,this.tokenExchangeService=i,this.onSignOutEmitter=new s.EventEmitter,this.hoursBufferCascade=2,this.onSignOut=this.onSignOutEmitter.event,this.scopes=this.scopes.sort(),this.tokenExchangeService=i||new o.TokenExchangeService(n),s.authentication.onDidChangeSessions(this.handleOnDidChangeSessions.bind(this))}async handleOnDidChangeSessions(e){if(!e)return;if(!e.provider)return;if(e.provider.id!==this.providerId)return;const t=void 0!==this.session,n=await this.tryLoadSession(!1);t&&!1===n&&await this.signOut(),t||1!=n||this.signInIsInProgress||await s.commands.executeCommand(l.userAuthStateTracker.isCurrentUserAnonymous()?`${a.Settings.get(c.SettingKeys.commandPrefix)}.signInAndReload`:"liveshare.signin")}async tryLoadSession(e,t){let n,i;try{const o=a.Settings.get(c.SettingKeys.authenticationProvider),l=r.SupportedAuthProviders[o];if(l&&l!==this.providerId&&!e)return!1;this.logger.verbose(`Attempting to load session - login = ${e}`);const u=await s.authentication.getSession(this.providerId,this.scopes,{createIfNone:e});if(u)return this.logger.verbose("Successfully loaded session"),this.session=u,i="Success",!0;this.logger.warning("Failed to load session")}catch(s){if(this.logger.warning(`Failed to load session: ${s.message}`),n=s,"User did not consent to login."!==n.message&&"Unauthorized"!==n.message&&"Cancelled"!==s&&"access_denied"!==s||!e)i="Failure";else if(await this.cancelSignIn(),i="Cancel",t){const{cancellationTokenSource:e}=t;null==e||e.cancel()}}finally{if(e){const e=new d.TelemetryEvent(h.TelemetryEventNames.TRY_LOAD_SESSION);e.addProperty(h.TelemetryPropertyNames.EVENT_RESULT,i),n&&n.stack&&e.addProperty(h.TelemetryPropertyNames.VSCODE_ERROR_CALL_STACK,d.cleanSensitiveInformation(n.stack)),t&&t.telemetryEvent&&e.correlateWith(t.telemetryEvent),e.send()}}return!1}isSignedIn(){return void 0!==this.session}async signIn(e){var t,n,s;this.signInIsInProgress=!0;try{if(this.isSignedIn())return this.logger.verbose("Already signed in"),!0;if(this.loginPromise)return await this.loginPromise.promise;this.loginPromise=new i.PromiseCompletionSource;try{await this.tryLoadSession(!0,e)}catch(e){this.logger.error(`Failed to sign in: ${e.message}`),null===(t=this.loginPromise)||void 0===t||t.reject(e)}return await this.getAccessToken()?(this.session?this.logger.info("Successfully signed in"):this.logger.info("Successfully signed in from a cached credential"),null===(n=this.loginPromise)||void 0===n||n.resolve(!0),!0):(this.logger.error("Failed to sign in: no token available"),null===(s=this.loginPromise)||void 0===s||s.resolve(!1),!1)}finally{this.loginPromise=void 0,this.signInIsInProgress=!1}}signOut(){var e;return null===(e=this.loginPromise)||void 0===e||e.reject(new Error("Logged Out")),this.loginPromise=void 0,this.resetCascadeToken(),this.session=void 0,this.onSignOutEmitter.fire(),this.logger.info("Successfully signed out"),Promise.resolve()}resetCascadeToken(){this.cascadeToken=void 0}cancelSignIn(){var e;return null===(e=this.loginPromise)||void 0===e||e.reject(new Error("Sign in cancelled")),this.loginPromise=void 0,Promise.resolve()}async getAccessToken(){var e;if(this.cascadeTokenIsValid())return this.cascadeToken;this.isSignedIn()||await this.tryLoadSession(!1);const t=null===(e=this.session)||void 0===e?void 0:e.accessToken;return t?(this.cascadeToken=await this.tokenExchangeService.exchange(this.providerId,t),this.cascadeToken):void 0}cascadeTokenIsValid(){if(!this.cascadeToken)return!1;try{const t=u(this.cascadeToken);if(!t)return this.logger.info("Can't decode Cascade token"),!1;var e=new Date;return e.setHours(e.getHours()+this.hoursBufferCascade),!(1e3*t.exp<e.getTime())||(this.logger.info("Cascade token will expire in less than two hours"),!1)}catch(e){return this.logger.error(`Failed to validate cascade token: ${e.message}`),!1}}}},function(e){e.exports=JSON.parse('{"name":"@vs/vs-ssh","version":"3.4.17","description":"SSH library for Visual Studio tools","keywords":["SSH"],"dependencies":{"buffer":"^5.2.1","debug":"^4.1.1","diffie-hellman":"^5.0.3","vscode-jsonrpc":"^4.0.0"},"author":"Microsoft","main":"./index.js"}')},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeECDiffieHellman=t.NodeDiffieHellman=void 0;const i=n(28),s=n(3),r=n(247),o=n(253),a=n(51);class c extends r.KeyExchangeAlgorithm{constructor(e,t,n){super(e,t,n,o.NodeHmac.getHashDigestLength(n))}createKeyExchange(){return new l(this.keySizeInBits,o.NodeHmac.getNodeHashAlgorithmName(this.hashAlgorithmName),this.hashDigestLength)}}t.NodeDiffieHellman=c;class l{constructor(e,t,n){switch(this.hashAlgorithmName=t,this.digestLength=n,e){case 1024:this.dh=i.getDiffieHellman("modp2");break;case 2048:this.dh=i.getDiffieHellman("modp14");break;case 4096:this.dh=i.getDiffieHellman("modp16");break;default:throw new Error("Invalid DH bit length.")}}startKeyExchange(){const e=this.dh.generateKeys(),t=a.BigInt.fromBytes(e,{unsigned:!0}).toBytes();return Promise.resolve(t)}decryptKeyExchange(e){const t=this.dh.computeSecret(e),n=a.BigInt.fromBytes(t,{unsigned:!0}).toBytes();return Promise.resolve(n)}async sign(e){const t=i.createHash(this.hashAlgorithmName);return t.update(e),s.Buffer.from(t.digest())}dispose(){}}class u extends r.KeyExchangeAlgorithm{constructor(e,t,n){super(e,t,n,o.NodeHmac.getHashDigestLength(n))}createKeyExchange(){return new d(this.keySizeInBits,o.NodeHmac.getNodeHashAlgorithmName(this.hashAlgorithmName),this.hashDigestLength)}}t.NodeECDiffieHellman=u;class d{constructor(e,t,n){switch(this.hashAlgorithmName=t,this.digestLength=n,e){case 256:this.ecdh=i.createECDH("prime256v1");break;case 384:this.ecdh=i.createECDH("secp384r1");break;case 521:this.ecdh=i.createECDH("secp521r1");break;default:throw new Error("Invalid ECDH bit length.")}}startKeyExchange(){const e=this.ecdh.generateKeys();return Promise.resolve(e)}decryptKeyExchange(e){const t=this.ecdh.computeSecret(e),n=a.BigInt.fromBytes(t,{unsigned:!0}).toBytes();return Promise.resolve(n)}async sign(e){const t=i.createHash(this.hashAlgorithmName);return t.update(e),s.Buffer.from(t.digest())}dispose(){}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.Sec1KeyFormatter=t.Pkcs1KeyFormatter=t.parsePem=t.formatPem=void 0;const i=n(51),s=n(254),r=n(172);t.formatPem=function(e,t){return`-----BEGIN ${t}-----\n`+e.toString("base64").match(/.{1,64}/g).join("\n")+"\n"+`-----END ${t}-----\n`},t.parsePem=function(t){const n=t.replace(/-+[^-\n]+KEY-+/g,"").replace(/\s/g,"");return e.from(n,"base64")};t.Pkcs1KeyFormatter=class{static formatRsaPublic(t){const n=new s.DerWriter(e.alloc(1024));return n.writeInteger(t.modulus),n.writeInteger(t.exponent),n.toBuffer()}static formatRsaPrivate(t){if(!(t.d&&t.p&&t.q&&t.dp&&t.dq&&t.qi))throw new Error("Missing private key parameters.");const n=new s.DerWriter(e.alloc(2048));return n.writeInteger(i.BigInt.fromInt32(0)),n.writeInteger(t.modulus),n.writeInteger(t.exponent),n.writeInteger(t.d),n.writeInteger(t.p),n.writeInteger(t.q),n.writeInteger(t.dp),n.writeInteger(t.dq),n.writeInteger(t.qi),n.toBuffer()}static parseRsaPublic(e){const t=new s.DerReader(e);return{modulus:t.readInteger(),exponent:t.readInteger()}}static parseRsaPrivate(e){const t=new s.DerReader(e);t.readInteger();return{modulus:t.readInteger(),exponent:t.readInteger(),d:t.readInteger(),p:t.readInteger(),q:t.readInteger(),dp:t.readInteger(),dq:t.readInteger(),qi:t.readInteger()}}};class o{static formatECPublic(t){const n=r.curves.find(e=>e.oid===t.curve.oid),i=Math.ceil(n.keySize/8),a=new s.DerWriter(e.alloc(512)),c=new s.DerWriter(e.alloc(100));c.writeObjectIdentifier(o.ecPublicKeyOid),c.writeObjectIdentifier(t.curve.oid),a.writeSequence(c);const l=t.x.toBytes({unsigned:!0,length:i}),u=t.y.toBytes({unsigned:!0,length:i}),d=e.alloc(1+l.length+u.length);return d[0]=4,l.copy(d,1),u.copy(d,1+l.length),a.writeBitString(d),a.toBuffer()}static formatECPrivate(t){const n=r.curves.find(e=>e.oid===t.curve.oid),o=Math.ceil(n.keySize/8),a=new s.DerWriter(e.alloc(512));a.writeInteger(i.BigInt.fromInt32(1)),a.writeOctetString(t.d.toBytes({unsigned:!0,length:o}));const c=new s.DerWriter(e.alloc(100));c.writeObjectIdentifier(t.curve.oid),a.writeTagged(0,c);const l=t.x.toBytes({unsigned:!0,length:o}),u=t.y.toBytes({unsigned:!0,length:o}),d=e.alloc(1+l.length+u.length);d[0]=4,l.copy(d,1),u.copy(d,1+l.length);const h=new s.DerWriter(e.alloc(512));return h.writeBitString(d),a.writeTagged(1,h),a.toBuffer()}static parseECPublic(e){var t;const n=new s.DerReader(e),a=n.readSequence(),c=a.readObjectIdentifier();if(c!==o.ecPublicKeyOid)throw new Error(`Unexpected key type OID: ${c}`);const l=a.readObjectIdentifier(),u=null===(t=r.curves.find(e=>e.oid===l))||void 0===t?void 0:t.name,d=n.readBitString();if(d.length%2!=1)throw new Error(`Unexpected key data length: ${d.length}`);const h=i.BigInt.fromBytes(d.slice(1,1+(d.length-1)/2),{unsigned:!0}),f=i.BigInt.fromBytes(d.slice(1+(d.length-1)/2),{unsigned:!0});return{curve:{name:u,oid:l},x:h,y:f}}static parseECPrivate(e){var t;const n=new s.DerReader(e),o=n.readInteger().toInt32();if(1!==o)throw new Error(`Unsupported SEC1 format version: ${o}`);const a=i.BigInt.fromBytes(n.readOctetString(),{unsigned:!0}),c=n.tryReadTagged(0);if(!c)throw new Error("SEC1 curve info not found.");const l=c.readObjectIdentifier(),u=null===(t=r.curves.find(e=>e.oid===l))||void 0===t?void 0:t.name,d=n.tryReadTagged(1);if(!d)throw new Error("SEC1 public key data not found.");const h=d.readBitString();if(h.length%2!=1)throw new Error(`Unexpected key data length: ${h.length}`);const f=i.BigInt.fromBytes(h.slice(1,1+(h.length-1)/2),{unsigned:!0}),p=i.BigInt.fromBytes(h.slice(1+(h.length-1)/2),{unsigned:!0});return{curve:{name:u,oid:l},x:f,y:p,d:a}}}t.Sec1KeyFormatter=o,o.ecPublicKeyOid="1.2.840.10045.2.1"}).call(this,n(3).Buffer)},function(e,t,n){"use strict";var i,s=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.KeyExchangeService=void 0;const r=n(44),o=n(3),a=n(133),c=n(174),l=n(51),u=n(257),d=n(98),h=n(36),f=n(45),p=n(52),m=n(1012),g=n(8),y=n(99);class v{}let S=i=class extends c.SshService{constructor(e,t){super(e),this.isClientSession=t,this.isInitialExchange=!1,this.exchangeContext=null}get exchanging(){return!!this.exchangeContext}async startKeyExchange(e){this.isInitialExchange=e,this.exchangeContext=new v;const t=this.createKeyExchangeInitMessage();let n=null;return this.isClientSession?(e&&this.session.config.enableKeyExchangeGuess&&(n=await this.createKeyExchangeGuessMessage(),t.firstKexPacketFollows=!!n),this.exchangeContext.clientKexInitPayload=t.toBuffer()):this.exchangeContext.serverKexInitPayload=t.toBuffer(),[t,n]}finishKeyExchange(){const e=this.exchangeContext.newAlgorithms;return this.exchangeContext=null,e}abortKeyExchange(){this.exchangeContext=null}createKeyExchangeInitMessage(){const e=this.isClientSession?"ext-info-c":"ext-info-s",t=this.session.config,n=new u.KeyExchangeInitMessage;return n.keyExchangeAlgorithms=(0,d.algorithmNames)(t.keyExchangeAlgorithms).concat(e),n.serverHostKeyAlgorithms=this.getPublicKeyAlgorithms(),n.encryptionAlgorithmsClientToServer=n.encryptionAlgorithmsServerToClient=(0,d.algorithmNames)(t.encryptionAlgorithms),n.macAlgorithmsClientToServer=n.macAlgorithmsServerToClient=(0,d.algorithmNames)(t.hmacAlgorithms),n.compressionAlgorithmsClientToServer=n.compressionAlgorithmsServerToClient=(0,d.algorithmNames)(t.compressionAlgorithms),n.languagesClientToServer=[""],n.languagesServerToClient=[""],n.firstKexPacketFollows=!1,n.reserved=0,n}getPublicKeyAlgorithms(){var e,t;let n=[...this.session.config.publicKeyAlgorithms];if(n.length>1&&!this.isClientSession){const i=null===(t=null===(e=this.session.credentials)||void 0===e?void 0:e.publicKeys)||void 0===t?void 0:t.map(e=>e.keyAlgorithmName);i&&(n=n.filter(e=>e&&i.includes(e.keyAlgorithmName)))}return(0,d.algorithmNames)(n)}async createKeyExchangeGuessMessage(){if(!this.exchangeContext)throw new Error("Key exchange was not started.");const e=this.session.config.keyExchangeAlgorithms[0];if(!e)return null;this.exchangeContext.keyExchange=e.name,this.exchangeContext.exchange=e.createKeyExchange(),this.exchangeContext.exchangeValue=await this.exchangeContext.exchange.startKeyExchange();const t=new u.KeyExchangeDhInitMessage;return t.e=this.exchangeContext.exchangeValue,t}handleMessage(e,t){if(e instanceof u.KeyExchangeInitMessage)return this.handleInitMessage(e,t);if(e instanceof u.KeyExchangeDhInitMessage)return this.handleDhInitMessage(e,t);if(e instanceof u.KeyExchangeDhReplyMessage)return this.handleDhReplyMessage(e,t);throw new Error(`Message not implemented: ${e}`)}async handleInitMessage(e,t){var n,i,s,o,a;if(!this.exchangeContext)throw new Error("Key exchange was not started.");const c=this.session.config;if(this.exchangeContext.keyExchange=this.chooseAlgorithm("KeyExchange",(0,d.algorithmNames)(c.keyExchangeAlgorithms),e.keyExchangeAlgorithms),"none"===this.exchangeContext.keyExchange)return(0,r.trace)("Client and server negotiated no security. Cancelling key-exchange."),this.exchangeContext.newAlgorithms=new m.SshSessionAlgorithms,void await this.session.handleNewKeysMessage(new u.NewKeysMessage,t);let l;if(this.exchangeContext.publicKey=this.chooseAlgorithm("PublicKey",this.getPublicKeyAlgorithms(),e.serverHostKeyAlgorithms),this.exchangeContext.clientEncryption=this.chooseAlgorithm("ClientEncryption",(0,d.algorithmNames)(c.encryptionAlgorithms),e.encryptionAlgorithmsClientToServer),this.exchangeContext.serverEncryption=this.chooseAlgorithm("ServerEncryption",(0,d.algorithmNames)(c.encryptionAlgorithms),e.encryptionAlgorithmsServerToClient),this.exchangeContext.clientHmac=this.chooseAlgorithm("ClientHmac",(0,d.algorithmNames)(c.hmacAlgorithms),e.macAlgorithmsClientToServer),this.exchangeContext.serverHmac=this.chooseAlgorithm("ServerHmac",(0,d.algorithmNames)(c.hmacAlgorithms),e.macAlgorithmsServerToClient),this.exchangeContext.clientCompression=this.chooseAlgorithm("ClientCompression",(0,d.algorithmNames)(c.compressionAlgorithms),e.compressionAlgorithmsClientToServer),this.exchangeContext.serverCompression=this.chooseAlgorithm("ServerCompression",(0,d.algorithmNames)(c.compressionAlgorithms),e.compressionAlgorithmsServerToClient),this.isClientSession){this.exchangeContext.serverKexInitPayload=e.toBuffer();const i=!!this.exchangeContext.exchangeValue,s=this.exchangeContext.keyExchange===(null===(n=c.keyExchangeAlgorithms[0])||void 0===n?void 0:n.name);if(!i||!s){const e=c.getKeyExchangeAlgorithm(this.exchangeContext.keyExchange);this.exchangeContext.exchange=e.createKeyExchange(),this.exchangeContext.exchangeValue=await this.exchangeContext.exchange.startKeyExchange();const n=new u.KeyExchangeDhInitMessage;n.e=this.exchangeContext.exchangeValue,await this.session.sendMessage(n,t)}l="ext-info-s"}else{if(e.firstKexPacketFollows){const t=this.exchangeContext.keyExchange===(null===(i=e.keyExchangeAlgorithms)||void 0===i?void 0:i[0]),n=t?"correct":"incorrect";if((0,r.trace)(`Client's KeyExchange guess was ${n}.`),this.exchangeContext.discardGuessedInit=!t,t&&this.session.remoteVersion.isVsSsh&&(null===(s=this.session.remoteVersion.version)||void 0===s?void 0:s.startsWith("2."))){(null===(o=e.keyExchangeAlgorithms)||void 0===o?void 0:o[0])===(null===(a=c.keyExchangeAlgorithms[0])||void 0===a?void 0:a.name)||((0,r.trace)("Ignoring correct guess for compatibility with older client."),this.exchangeContext.discardGuessedInit=!0)}}this.exchangeContext.clientKexInitPayload=e.toBuffer(),l="ext-info-c"}this.isInitialExchange&&e.keyExchangeAlgorithms.includes(l)&&await this.session.sendExtensionInfo(t)}async handleDhInitMessage(e,t){var n,i,s,r,a,c,l;if(this.isClientSession)return;const d=this.session;if(!this.exchangeContext||!this.exchangeContext.keyExchange||!this.exchangeContext.publicKey)throw new f.SshConnectionError("Key exchange not started.",p.SshDisconnectReason.protocolError);if(this.exchangeContext.discardGuessedInit)return void(this.exchangeContext.discardGuessedInit=!1);const h=this.session.config.getKeyExchangeAlgorithm(this.exchangeContext.keyExchange);if(!h)throw new f.SshConnectionError("Key exchange not supported for algorithm: "+this.exchangeContext.keyExchange,p.SshDisconnectReason.keyExchangeFailed);const y=this.session.config.getPublicKeyAlgorithm(this.exchangeContext.publicKey);if(!y)throw new f.SshConnectionError("Public key algorithm not supported: "+this.exchangeContext.publicKey,p.SshDisconnectReason.keyExchangeFailed);let v=null;if(null===(n=d.credentials)||void 0===n?void 0:n.publicKeys){const e=d.credentials.publicKeys.find(e=>e.keyAlgorithmName===y.keyAlgorithmName);if(v=null!=e?e:null,!1===(null==v?void 0:v.hasPrivateKey)){if(!d.credentials.privateKeyProvider)throw new Error("A private key provider is required.");v=await d.credentials.privateKeyProvider(e,null!=t?t:g.CancellationToken.None)}}if(null==v)throw new f.SshConnectionError("Private key not found for algorithm: "+this.exchangeContext.publicKey,p.SshDisconnectReason.keyExchangeFailed);const S=this.session.config.getEncryptionAlgorithm(this.exchangeContext.clientEncryption),_=this.session.config.getEncryptionAlgorithm(this.exchangeContext.serverEncryption),E=this.session.config.getHmacAlgorithm(this.exchangeContext.serverHmac),w=this.session.config.getHmacAlgorithm(this.exchangeContext.clientHmac),b=h.createKeyExchange(),C=e.e||o.Buffer.alloc(0),T=await b.startKeyExchange(),M=await b.decryptKeyExchange(C),A=await v.getPublicKeyBytes(y.name);if(!A)throw new f.SshConnectionError("Public key not set.",p.SshDisconnectReason.keyExchangeFailed);const k=await this.computeExchangeHash(b,A,C,T,M);this.session.sessionId||(this.session.sessionId=k);const[R,P,I,N,L,D]=await this.computeKeys(b,M,k,S,_,w,E),x=null!==(i=await(null==_?void 0:_.createCipher(!0,N,P)))&&void 0!==i?i:null,O=null!==(s=await(null==S?void 0:S.createCipher(!1,I,R)))&&void 0!==s?s:null,F=null!==(r=await(null==E?void 0:E.createSigner(D)))&&void 0!==r?r:null,U=null!==(a=await(null==w?void 0:w.createVerifier(L)))&&void 0!==a?a:null,j=new m.SshSessionAlgorithms;j.publicKeyAlgorithmName=this.exchangeContext.publicKey,j.cipher=x,j.decipher=O,j.signer=F,j.verifier=U,j.messageSigner=(null===(c=x)||void 0===c?void 0:c.authenticatedEncryption)?x:F,j.messageVerifier=(null===(l=O)||void 0===l?void 0:l.authenticatedEncryption)?O:U,j.compressor=this.session.config.getCompressionAlgorithm(this.exchangeContext.serverCompression),j.decompressor=this.session.config.getCompressionAlgorithm(this.exchangeContext.clientCompression),this.exchangeContext.newAlgorithms=j,R&&R.fill(0),I&&I.fill(0),L&&L.fill(0),P&&P.fill(0),N&&N.fill(0),D&&D.fill(0);const H=y.createSigner(v);let B=await H.sign(k);B=y.createSignatureData(B);const Y=new u.KeyExchangeDhReplyMessage;Y.hostKey=A,Y.f=T,Y.signature=B,await this.session.sendMessage(Y,t),await this.session.sendMessage(new u.NewKeysMessage,t)}async handleDhReplyMessage(e,t){var n,i,s,o,a,c,l,d;if(!this.isClientSession)return;if(!this.exchangeContext)throw new f.SshConnectionError("Key exchange was not started.",p.SshDisconnectReason.protocolError);const h=this.session.config,g=this.exchangeContext.exchange,y=this.exchangeContext.publicKey,v=h.getPublicKeyAlgorithm(y),S=h.getEncryptionAlgorithm(this.exchangeContext.clientEncryption),_=h.getEncryptionAlgorithm(this.exchangeContext.serverEncryption),E=h.getHmacAlgorithm(this.exchangeContext.serverHmac),w=h.getHmacAlgorithm(this.exchangeContext.clientHmac),b=this.exchangeContext.exchangeValue,C=e.f;if(!g||!b)throw new f.SshConnectionError("Failed to initialize crypto after key exchange.",p.SshDisconnectReason.keyExchangeFailed);this.hostKey=v.createKeyPair(),await this.hostKey.setPublicKeyBytes(e.hostKey);const T=await g.decryptKeyExchange(C),M=e.hostKey,A=await this.computeExchangeHash(g,M,b,C,T),k=v.readSignatureData(e.signature),R=v.createVerifier(this.hostKey);let P;try{P=await R.verify(A,k)}catch(e){if(!(e instanceof Error))throw e;throw(0,r.trace)(`Server public key verification error: ${null!==(n=e.message)&&void 0!==n?n:e}`),new f.SshConnectionError("Server public key verification failed: "+(null!==(i=e.message)&&void 0!==i?i:e),p.SshDisconnectReason.hostKeyNotVerifiable)}if(!P)throw(0,r.trace)("Server public key verification failed."),new f.SshConnectionError("Server public key verification failed.",p.SshDisconnectReason.hostKeyNotVerifiable);(0,r.trace)("Server public key verification succeeded."),null==this.session.sessionId&&(this.session.sessionId=A);const[I,N,L,D,x,O]=await this.computeKeys(g,T,A,S,_,w,E),F=null!==(s=await(null==S?void 0:S.createCipher(!0,L,I)))&&void 0!==s?s:null,U=null!==(o=await(null==_?void 0:_.createCipher(!1,D,N)))&&void 0!==o?o:null,j=null!==(a=await(null==w?void 0:w.createSigner(x)))&&void 0!==a?a:null,H=null!==(c=await(null==E?void 0:E.createVerifier(O)))&&void 0!==c?c:null,B=new m.SshSessionAlgorithms;B.publicKeyAlgorithmName=y,B.cipher=F,B.decipher=U,B.signer=j,B.verifier=H,B.messageSigner=(null===(l=F)||void 0===l?void 0:l.authenticatedEncryption)?F:j,B.messageVerifier=(null===(d=U)||void 0===d?void 0:d.authenticatedEncryption)?U:H,B.compressor=h.getCompressionAlgorithm(this.exchangeContext.clientCompression),B.decompressor=h.getCompressionAlgorithm(this.exchangeContext.serverCompression),this.exchangeContext.newAlgorithms=B,I&&I.fill(0),L&&L.fill(0),x&&x.fill(0),N&&N.fill(0),D&&D.fill(0),O&&O.fill(0),await this.session.sendMessage(new u.NewKeysMessage,t)}chooseAlgorithm(e,t,n){var i;let s,o;this.isClientSession?(s=n||[],o=t):(s=t,o=n||[]);const a=`${e} negotiation: `+`Server (${s.join(", ")}) `+`Client (${o.join(", ")})`;if(this.session.remoteVersion.isVsSsh&&(null===(i=this.session.remoteVersion.version)||void 0===i?void 0:i.startsWith("2."))){const e=s;s=o,o=e}for(let e of o)for(let t of s)if(t===e){const e=t;return(0,r.trace)(`${a} => ${e}`),e}throw new Error(`Failed ${a}`)}async computeExchangeHash(e,t,n,i,s){if(!this.session.remoteVersion)throw new Error("Key exchange not completed.");const r=new h.SshDataWriter(o.Buffer.alloc(2048));return this.isClientSession?(r.writeString(a.SshSession.localVersion.toString(),"ascii"),r.writeString(this.session.remoteVersion.toString(),"ascii")):(r.writeString(this.session.remoteVersion.toString(),"ascii"),r.writeString(a.SshSession.localVersion.toString(),"ascii")),r.writeBinary(this.exchangeContext.clientKexInitPayload),r.writeBinary(this.exchangeContext.serverKexInitPayload),r.writeBinary(t),r.writeBigInt(l.BigInt.fromBytes(n,{unsigned:!0})),r.writeBigInt(l.BigInt.fromBytes(i,{unsigned:!0})),r.writeBigInt(l.BigInt.fromBytes(s,{unsigned:!0})),await e.sign(r.toBuffer())}async computeKeys(e,t,n,i,s,r,a){var c,l;const u=new h.SshDataWriter(o.Buffer.alloc(4+t.length+n.length+Math.max(1+(null!==(l=null===(c=this.session.sessionId)||void 0===c?void 0:c.length)&&void 0!==l?l:0),e.digestLength)));u.writeBinary(t),u.write(n);const d=u.position;return[i&&await this.computeKey(e,u,d,i.blockLength,"A"),s&&await this.computeKey(e,u,d,s.blockLength,"B"),i&&await this.computeKey(e,u,d,i.keyLength,"C"),s&&await this.computeKey(e,u,d,s.keyLength,"D"),r&&await this.computeKey(e,u,d,r.keyLength,"E"),a&&await this.computeKey(e,u,d,a.keyLength,"F")]}async computeKey(e,t,n,i,s){const r=o.Buffer.alloc(i);let a=0,c=0,l=null;if(!this.session.sessionId)throw new Error("Session ID not set.");for(;a<i;)t.position=n,l?t.write(l):(t.writeByte(s.charCodeAt(0)),t.write(this.session.sessionId)),l=await e.sign(t.toBuffer()),c=Math.min(l.length,i-a),l.copy(r,a),a+=c;return l&&l.fill(0),r}};S.serviceName="ssh-keyexchange",S=i=s([(0,y.serviceActivation)({serviceRequest:i.serviceName})],S),t.KeyExchangeService=S},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelMetrics=void 0;t.ChannelMetrics=class{constructor(){this.bytesSentSum=0,this.bytesReceivedSum=0}get bytesSent(){return this.bytesSentSum}get bytesReceived(){return this.bytesReceivedSum}addBytesSent(e){this.bytesSentSum+=e}addBytesReceived(e){this.bytesReceivedSum+=e}toString(){return`Bytes S/R: ${this.bytesSent} / ${this.bytesReceived}; `}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshChannelClosedEventArgs=void 0;t.SshChannelClosedEventArgs=class{constructor(e,t){"number"==typeof e?this.exitStatus=e:"string"==typeof e?(this.exitSignal=e,this.errorMessage=t):e instanceof Error&&(this.error=e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshVersionInfo=void 0;const i=n(433),s=i.name.replace(/^@\w+\//,""),r=i.version;class o{constructor(e,t,n,i){this.versionString=e,this.protocolVersion=t,this.name=n,this.version=i}static tryParse(e){if(!e)throw new TypeError("Version string expected.");if(!e.startsWith("SSH-"))return null;const t=e.indexOf("-",4);if(t<=0)return null;const n=e.substring(4,t);if(!/^\d+\.\d+$/.test(n))return null;let i,s;const r=e.substring(t+1),a=r.indexOf(" "),c=r.lastIndexOf("_",a>=0?a:r.length-1);if(c>=0){i=r.substring(0,c).replace(/_/g," "),s=r.substring(c+1);for(let e=0;e<s.length;e++){const t=s[e];if(!(t>="0"&&t<="9")&&"."!==t){s=s.substring(0,e);break}}/^\d+(\.\d+)*$/.test(s)||(s=null)}else i=r,s=null;return new o(e,n,i,s)}static getLocalVersion(){return new o(`SSH-2.0-${s}_${r}`,"2.0",s,r)}toString(){return this.versionString}get isVsSsh(){return this.isVsSshCS||this.isVsSshTS}get isVsSshCS(){return"Microsoft.VisualStudio.Ssh"===this.name}get isVsSshTS(){return"vs-ssh"===this.name}}t.SshVersionInfo=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshChannelOpeningEventArgs=void 0;const i=n(80);t.SshChannelOpeningEventArgs=class{constructor(e,t,n){if(this.request=e,this.channel=t,this.isRemoteRequest=n,this.failureReason=i.SshChannelOpenFailureReason.none,this.failureDescription=null,!e)throw new TypeError("A channel open message is required.");if(!t)throw new TypeError("A channel is required.")}toString(){return`${this.channel.toString()}${this.failureReason?" "+i.SshChannelOpenFailureReason[this.failureReason]:""}`}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationSuccessMessage=t.AuthenticationFailureMessage=t.PasswordRequestMessage=t.PublicKeyOKMessage=t.PublicKeyRequestMessage=t.AuthenticationRequestMessage=t.AuthenticationMessage=void 0;const i=n(100);class s extends i.SshMessage{}t.AuthenticationMessage=s;class r extends s{get messageType(){return 50}onRead(e){this.username=e.readString("utf8"),this.serviceName=e.readString("ascii"),this.methodName=e.readString("ascii")}onWrite(e){e.writeString(this.username||"","utf8"),e.writeString(this.serviceName||"","ascii"),e.writeString(this.validateField(this.methodName,"method name"),"ascii")}}t.AuthenticationRequestMessage=r;t.PublicKeyRequestMessage=class extends r{constructor(){super(),this.methodName="publickey"}get hasSignature(){return!!(this.signature&&this.signature.length>0)}onRead(e){super.onRead(e);const t=e.readBoolean();this.keyAlgorithmName=e.readString("ascii"),this.publicKey=e.readBinary(),t?(this.signature=e.readBinary(),this.payloadWithoutSignature=this.rawBytes.slice(0,this.rawBytes.length-this.signature.length-4)):this.signature=void 0}onWrite(t){var n,i;if(super.onWrite(t),!this.keyAlgorithmName)throw new Error("Key algorithm name not set.");if("hostbased"===this.methodName){if(t.writeString(this.keyAlgorithmName,"ascii"),t.writeBinary(this.publicKey||e.alloc(0)),t.writeString(null!==(n=this.clientHostname)&&void 0!==n?n:"","ascii"),t.writeString(null!==(i=this.clientUsername)&&void 0!==i?i:"","ascii"),!this.hasSignature)throw new Error("A signature is required for a host-based authentcation request.");t.writeBinary(this.signature)}else t.writeBoolean(this.hasSignature),t.writeString(this.keyAlgorithmName,"ascii"),t.writeBinary(this.publicKey||e.alloc(0)),this.hasSignature&&t.writeBinary(this.signature)}};t.PublicKeyOKMessage=class extends s{get messageType(){return 60}onRead(e){this.keyAlgorithmName=e.readString("ascii"),this.publicKey=e.readBinary()}onWrite(e){if(!this.keyAlgorithmName)throw new Error("Key algorithm name not set.");if(!this.publicKey)throw new Error("Public key not set.");e.writeString(this.keyAlgorithmName,"ascii"),e.writeBinary(this.publicKey)}};t.PasswordRequestMessage=class extends r{constructor(){super(),this.methodName="password"}onRead(e){super.onRead(e),e.readBoolean(),this.password=e.readString("utf8")}onWrite(e){super.onWrite(e),e.writeBoolean(!1),e.writeString(this.password||"","utf8")}};class o extends s{constructor(){super(...arguments),this.partialSuccess=!1}get messageType(){return 51}onRead(e){this.methodNames=e.readList("ascii"),this.partialSuccess=e.readBoolean()}onWrite(e){e.writeList(this.methodNames||[],"ascii"),e.writeBoolean(this.partialSuccess)}}t.AuthenticationFailureMessage=o;class a extends s{get messageType(){return 52}onRead(e){}onWrite(e){}}t.AuthenticationSuccessMessage=a,i.SshMessage.index.set(50,r),i.SshMessage.index.set(51,o),i.SshMessage.index.set(52,a)}).call(this,n(3).Buffer)},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SessionMetrics=void 0;const i=n(8);t.SessionMetrics=class{constructor(){this.startTime=0,this.messagesSentCount=0,this.messagesReceivedCount=0,this.bytesSentSum=0,this.bytesReceivedSum=0,this.reconnectionsCount=0,this.currentLatency=0,this.minLatency=0,this.maxLatency=0,this.latencySum=0,this.latencyCount=0,this.messageSentEmitter=new i.Emitter,this.onMessageSent=this.messageSentEmitter.event,this.messageReceivedEmitter=new i.Emitter,this.onMessageReceived=this.messageReceivedEmitter.event,this.latencyUpdatedEmitter=new i.Emitter,this.onLatencyUpdated=this.latencyUpdatedEmitter.event,this.sessionClosedEmitter=new i.Emitter,this.onSessionClosed=this.sessionClosedEmitter.event,"object"==typeof performance&&performance.now?Object.defineProperty(this,"time",{get:this.browserTime}):"object"==typeof e&&e.hrtime&&Object.defineProperty(this,"time",{get:this.nodejsTime}),this.startTime=this.time}get time(){return Date.now()-this.startTime}browserTime(){return performance.now()-this.startTime}nodejsTime(){const[t,n]=e.hrtime();return 1e3*t+n/1e6-this.startTime}get messagesSent(){return this.messagesSentCount}get messagesReceived(){return this.messagesReceivedCount}get bytesSent(){return this.bytesSentSum}get bytesReceived(){return this.bytesReceivedSum}get reconnections(){return this.reconnectionsCount}get latencyAverageMs(){return 0===this.latencyCount?0:this.latencySum/this.latencyCount}get latencyMinMs(){return this.minLatency}get latencyMaxMs(){return this.maxLatency}get latencyCurrentMs(){return this.currentLatency}addMessageSent(e){this.messagesSentCount++,this.bytesSentSum+=e,this.messageSentEmitter.fire({time:this.time,size:e})}addMessageReceived(e){this.messagesReceivedCount++,this.bytesReceivedSum+=e,this.messageReceivedEmitter.fire({time:this.time,size:e})}addReconnection(){this.reconnectionsCount++}updateLatency(e){if(e<0)throw new Error("Measured latency cannot be negative.");this.currentLatency=e,0!==e&&((0===this.minLatency||e<this.minLatency)&&(this.minLatency=e),(0===this.maxLatency||e>this.maxLatency)&&(this.maxLatency=e),this.latencySum+=e,this.latencyCount++,this.latencyUpdatedEmitter.fire({time:this.time,latency:e}))}close(){this.currentLatency=0,this.sessionClosedEmitter.fire()}toString(){let e=`Messages S/R: ${this.messagesSent} / ${this.messagesReceived}; `+`Bytes S/R: ${this.bytesSent} / ${this.bytesReceived}; `+`Reconnections: ${this.reconnections}; `;const t=this.minLatency>=10?1:this.minLatency>=1?10:100;if(this.maxLatency>0){e+=`Latency Min-Avg-Max: ${Math.round(this.minLatency*t)/t} - ${Math.round(this.latencySum/this.latencyCount*t)/t} - ${Math.round(this.maxLatency*t)/t} ms; `}if(this.currentLatency>0){e+=`Current Latency: ${Math.round(this.currentLatency*t)/t} ms; `}return e}}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshSessionClosedEventArgs=void 0;const i=n(52);t.SshSessionClosedEventArgs=class{constructor(e,t,n){if(this.reason=e,this.message=t,this.error=n,!t)throw new TypeError("A disconnect message is required.")}toString(){return`${i.SshDisconnectReason[this.reason]}: ${this.message}`}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SshStream=void 0;const i=n(81),s=n(34);class r extends s.Duplex{constructor(t){let n=null;super({async write(n,i,s){let r;try{let s;if("string"==typeof n)s=e.from(n,i);else{if(!(n instanceof e))throw new Error("Unsupported chunk type: "+typeof n);s=n}await t.send(s)}catch(e){if(!(e instanceof Error))throw e;r=e}s&&s(r)},async writev(n,i){let s;try{if(1===n.length)return this.write(n[0].chunk,n[0].encoding,i);{const i=n.reduce((function(t,n){if(n.chunk instanceof e)return t+n.chunk.length;throw new Error("Unsupported chunk type: "+typeof n.chunk)}),0),s=e.alloc(i);let r=0;for(let e=0;e<n.length;e++)n[e].chunk.copy(s,r),r+=n[e].chunk.length;await t.send(s)}}catch(e){if(!(e instanceof Error))throw e;s=e}i&&i(s)},async final(e){let n;try{await t.close()}catch(e){if(!(e instanceof Error))throw e;n=e}e&&e(n)},read(){n&&(n.resolve(),n=null)}});const s=this;t.onDataReceived(async r=>{const o=e.alloc(r.length);r.copy(o),s.push(o)||(n||(n=new i.PromiseCompletionSource),await n.promise),t.adjustWindow(o.length)}),t.onClosed(()=>{s.push(null)}),this.channel=t}toString(){return`SshStream(Channel Type: ${this.channel.channelType}, Id: ${this.channel.channelId}, RemoteId: ${this.channel.remoteChannelId})`}}t.SshStream=r}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(5);t.WorkspaceServices=class{constructor(e){this.onServiceAddedEmitter=new i.EventEmitter,this.onServiceRemovedEmitter=new i.EventEmitter,this.registeredServices=new Set,this.onServiceAdded=this.onServiceAddedEmitter.event,this.onServiceRemoved=this.onServiceRemovedEmitter.event,e.onServicesChanged(e=>{e.changeType===s.vsls.CollectionChangeType.Add?e.serviceNames.forEach(e=>{this.registeredServices.add(e),this.onServiceAddedEmitter.fire(e)}):e.changeType===s.vsls.CollectionChangeType.Remove&&e.serviceNames.forEach(e=>{this.registeredServices.delete(e),this.onServiceRemovedEmitter.fire(e)})})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(29),r=n(175),o=n(95);t.showInvitationLink=async function e(t,n,a,c){if(n&&n!==s.workspaceSessionInfoTracker.workspaceSessionInfo.joinUri)await i.window.showErrorMessage("This invite link has expired. Share again to generate a new link.");else{const n=s.workspaceSessionInfoTracker.workspaceSessionInfo.joinUri;if(a)return void await i.window.showInputBox({prompt:"Copy Live Share invitation link",value:n,ignoreFocusOut:!0});const l=await(new o.ClipboardUtil).copyToClipboardAsync(n),u={id:1,title:"More info"},d={id:2,title:l?"Copy again":"Copy link"};let h=[u,d];const f={id:3,title:s.workspaceSessionInfoTracker.isReadOnly?"Make read/write":"Make read-only"};!1!==c&&h.splice(0,0,f);const p=await i.window.showInformationMessage((l?"Invitation link copied to clipboard! Send it to anyone you trust ":'Session shared! Click "Copy link" to get an invitation link ')+'or click "More info" to learn about secure sharing.',!0,...h);p&&p.id===d.id?await e(t,n,!l,c):p&&p.id===u.id?await r.showWelcomePage(r.WelcomePageSource.Sharing):p&&p.id===f.id&&await t.setReadOnly(!s.workspaceSessionInfoTracker.isReadOnly)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6),s=n(0);t.updateWorkspaceFolders=async function(e,t,...n){const r=new i.Signal,o=s.workspace.onDidChangeWorkspaceFolders(e=>{o.dispose(),r.resolve()});return s.workspace.updateWorkspaceFolders(e,t,...n)?(await i.timeoutPromise(r.promise,5e3,new Error("Failed to update workspace folders")),!0):(o.dispose(),!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=new(n(6).Mutex);t.executeNextCommand=async function(e,...t){return await s.dispatch(async()=>await i.commands.executeCommand(e,...t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(13),r=n(15);var o;async function a(){await s.Settings.save(r.SettingKeys.anonymousAuthReloadFlag,null)}!function(e){e[e.Anonymous=0]="Anonymous",e[e.CustomAccount=1]="CustomAccount"}(o=t.SignInReloadMode||(t.SignInReloadMode={})),t.setAuthReloadFlag=async function(e,t){t===o.Anonymous?(e.time=Date.now(),await async function(e){await s.Settings.save(r.SettingKeys.anonymousAuthReloadFlag,e)}(e)):t===o.CustomAccount&&await async function(e){await s.Settings.save(r.SettingKeys.customAccountAuthReloadFlag,e)}(e)},t.resetAuthReloadFlag=async function(e){e===o.Anonymous?await a():e===o.CustomAccount&&await async function(){await s.Settings.save(r.SettingKeys.customAccountAuthReloadFlag,null)}()},t.isAnonymousAuthReloadFlagValid=async function(){const e=i.workspace.getConfiguration().get("vsliveshare.join.reload.workspaceId"),t=s.Settings.get(r.SettingKeys.anonymousAuthReloadFlag);return!!(t&&t.time&&t.workspaceId&&e)&&(Date.now()-t.time>=6e4?(await a(),!1):t.workspaceId.toLowerCase()===e.toLowerCase())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(61),s=n(6),r=n(33);t.progressCommandDecorator=function(){return r.DecoratorHelper.setupDecorator(e=>new o(r.DecoratorHelper.getCoreCommand(e),e,i.dependencies.progressNotifierUtil()))};class o{constructor(e,t,n){this.command=e,this.next=t,this.progressNotifierUtil=n}async invoke(e,t){let n=void 0;const{cancellationTokenSource:i}=t,r=i&&i.token;return n=await this.progressNotifierUtil.create({title:t.commandName},r,async n=>new Promise(async(o,a)=>{const c=async()=>{const n=this.command;n.onCancellationRequested&&await n.onCancellationRequested(e,t),a(new s.CancellationError("The operation was cancelled."))};n&&(n.isCancellationRequested?await c():n.onCancellationRequested(async()=>{await c()})),i&&r&&(r.isCancellationRequested?await c():r.onCancellationRequested(async()=>{await c()}));try{o(await this.next.invoke(e,t))}catch(e){a(e)}})),n}}t.ProgressCommandDecorator=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1042),s=n(1043),r=n(1044),o=n(1045);t.registerCommands=e=>{e.register("liveshare.signin",i.builder),e.register("liveshare.signout",s.builder),e.register("signInAndReload",r.builder),e.register("liveshare.focusParticipants",o.builder),e.register("liveshare.focusParticipantsFromActivityBar",o.builder),e.register("liveshare.focusParticipantsFromFileTreeExplorer",o.builder)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(9),s=n(23);t.createInittableDisposable=function(e){const t={isInited:!1,init:async()=>{await e(),t.isInited=!0},dispose:()=>Promise.resolve()};return t},t.lazyInittable=function(e){return{isInited:!1,init:async()=>{const t=e();"function"==typeof t.init&&await t.init()},dispose:async()=>Promise.resolve()}},t.initDisposableManager=async function e(t,n){await Promise.all(t.map(async({instance:t,children:r,status:o})=>{try{await t.init()}catch(e){if(i.Telemetry.sendFault("init-manager-fault",i.FaultType.Error,"",e),void 0===n||n)throw e}r&&await e(r,n),o&&s.sessionStateTracker.point(o)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(50);t.getAllRootFileSystemPaths=function(){if(null==i.workspace.workspaceFolders||0===i.workspace.workspaceFolders.length)return{foundUnsupportedSchemes:!1,isVirtualWorkspace:!0,paths:[null]};const e=i.workspace.workspaceFolders.filter(e=>e.uri.scheme.toLowerCase()===s.PathManager.fileScheme),t=e.length>0,n=e.length!==i.workspace.workspaceFolders.length;return t?{foundUnsupportedSchemes:n,isVirtualWorkspace:!1,paths:e.map(e=>e.uri.fsPath)}:{foundUnsupportedSchemes:!1,isVirtualWorkspace:!0,paths:i.workspace.workspaceFolders.map(e=>e.uri.path)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(63);class s extends i.ConnectionError{constructor(){super(...arguments),this.errorType="ConnectionStateError"}}t.ConnectionStateError=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6),s=10*i.TIME_SECOND_MS;t.failedtoCheckConnectionMessage="failed to check connection";t.checkConnectionWithTimeout=async(e,t,n,r)=>{const o=Date.now(),a=()=>(Date.now()-o).toFixed(1);try{return null==t||t.verbose("checkConnectionWithTimeout -> 'started'"),await i.timeoutPromise(e.checkConnection(),null!=n?n:s,void 0,r),null==t||t.verbose(`checkConnectionWithTimeout -> 'succeeded' t:${a()}`),!0}catch(e){return e instanceof i.CancellationError?(null==t||t.verbose(`checkConnectionWithTimeout -> 'cancelled' t:${a()}`),!0):(null==t||t.error(`checkConnectionWithTimeout -> 'failed' t:${a()}`,e),!1)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6),s=n(455),r=n(8),o=5*i.TIME_SECOND_MS;let a=0;t.checkWorkspaceClient=function(e,t,n,i,c){let l;n=null!=n?n:o,(t=t.createChild(`${++a}`)).info(`Start checking connection timeout:${n}`);const u=()=>{l=setTimeout(m,n)},d=()=>{clearTimeout(l)};let h=!1;const f=new r.CancellationTokenSource,p=()=>f.token.isCancellationRequested,m=async()=>{p()||(h=!0,c&&!c()||await s.checkConnectionWithTimeout(e,t,i,f)?u():(t.info(`Failed check -> isDisposed:${p()}`),null==g||g.dispose(),p()||e.dispose(s.failedtoCheckConnectionMessage)),h=!1)};e.rpcClient.onDispose(()=>{d()});const g=e.onWorkspaceMetricsUpdated(e=>{d(),h||u()});return u(),{dispose:()=>{t.info("Stop checking connection"),f.cancel(),null==g||g.dispose()}}}},function(e,t,n){"use strict";(function(e,i){var s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=s(n(43)),a=n(1070),c=n(19),l=n(83),u=r(n(1073));class d{static getRelayUri(e,t){if(!e.relayLink)throw new Error("Workspace does not have a relay endpoint.");return e.relayLink.replace("sb:","wss:").replace(".net/",".net:443/$hc/")+`?sb-hc-action=${t}&sb-hc-token=`+encodeURIComponent(e.relaySas||"")}static openConnection(e,n){const i=d.getRelayUri(e,"connect");return n.log(c.LogLevel.Debug,`connecting to relay link:${e.relayLink}`),t.isNode()?(n.log(c.LogLevel.Debug,"creating node SSH..."),d.nodeSshStreamFactory(i,e)):(n.log(c.LogLevel.Debug,"creating web SSH..."),d.webSshStreamFactory(new WebSocket(i)))}static createSshClientSession(){return d.createSshSession(e=>new o.SshClientSession(e))}static createSshServerSession(e){return d.createSshSession(t=>new o.SshServerSession(t,e))}static async authenticate(e,t,n,i,s){const r={username:"",password:n.sessionToken};if(e.onAuthenticating(e=>{e.authenticationPromise=d.authenticateServer(t,e.publicKey)}),await e.connect(i),!await e.authenticateServer())throw new Error("Live Share server authentication failed.");if(s)await e.authenticateClient(r,(e,t)=>{e||t||(e=new Error("Live Share client authentication failed.")),e?s.reject(e):s.resolve(e)});else if(!await e.authenticateClient(r))throw new Error("Live Share client authentication failed.");return e}static createWebSocketStreamAdapter(e){return new o.WebSocketStream(new h(e))}static webSshStreamFactory(e){return e.binaryType="arraybuffer",new Promise((t,n)=>{e.onopen=()=>{t(new o.WebSocketStream(e))},e.onerror=e=>{n(new Error("Failed to connect to relay url"))}})}static createSshSession(e){const t=new o.SshSessionConfiguration;return t.keyExchangeAlgorithms.splice(0),t.keyExchangeAlgorithms.push(o.SshAlgorithms.keyExchange.ecdhNistp384Sha384),t.keyExchangeAlgorithms.push(o.SshAlgorithms.keyExchange.ecdhNistp256Sha256),t.keyExchangeAlgorithms.push(o.SshAlgorithms.keyExchange.dhGroup14Sha256),t.protocolExtensions.push(o.SshProtocolExtensionNames.sessionReconnect),t.protocolExtensions.push(o.SshProtocolExtensionNames.sessionLatency),e(t)}static nodeSshStreamFactory(e,t){const n=new a.client;return new Promise((i,s)=>{n.on("connect",e=>{i(new o.WebSocketStream(new h(e)))}),n.on("connectFailed",e=>{e.message&&e.message.startsWith("Error: ")&&(e.message=e.message.substr(7));let n=l.RelayErrorType.ServerError;/status: 401/.test(e.message)?(e.message=u.default["error.relaySasInvalid"],n=l.RelayErrorType.SasInvalid):/status: 404 Endpoint does not exist/.test(e.message)?(e.message=u.default["error.relayEndpointNotFound"],n=l.RelayErrorType.EndpointNotFound):/status: 404 There are no listeners connected/.test(e.message)?(e.message=u.default["error.relayListenerOffline"],n=l.RelayErrorType.ListenerOffline):/status: 500/.test(e.message)?(e.message=u.default["error.relayServerError"],n=l.RelayErrorType.ServerError):e.message=u.default["error.relayConnectionError"]+" "+e.message,s(new l.RelayConnectionError(e.message,{errorType:n,workspaceConnectionInfo:t}))}),n.connect(e)})}static async authenticateServer(t,n){const i=o.SshAlgorithms.publicKey.rsaWithSha512,s=await n.getPublicKeyBytes();for(const n of t&&t.hostPublicKeys||[]){const t=i.createKeyPair();await t.setPublicKeyBytes(e.from(n,"base64"));const r=await t.getPublicKeyBytes();if(s.equals(r)){return{}}}return null}}t.SshHelpers=d;class h{constructor(e){this.connection=e}set onmessage(e){e&&this.connection.on("message",t=>{e({data:t.binaryData})})}set onclose(e){e&&this.connection.on("close",(t,n)=>{e({code:t,reason:n,wasClean:!(t||n)})})}send(t){e.isBuffer(t)?this.connection.sendBytes(t):this.connection.sendBytes(e.from(t))}close(e,t){e||t?this.connection.drop(e,t):this.connection.close()}}t.isNode=()=>void 0!==i&&void 0!==i.release&&"node"===i.release.name}).call(this,n(3).Buffer,n(11))},function(e,t){var n=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"==typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return n()}try{return __global__||n()}finally{delete Object.prototype.__global__}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.MainThread="MainThread",e.ServiceWorker="ServiceWorker",e.WorkspaceHub="WorkspaceHub"}(t.TConnectionTypes||(t.TConnectionTypes={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.VSCodeServerStartup="VSCodeServerStartup"}(t.PerformanceGroupIds||(t.PerformanceGroupIds={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vscodeServerHostRPCService={name:"IVSCodeServerHostService",methods:["startRemoteServer","exportLogs","shutDownRemoteServer","getVMTerminalFilePath","getContainerTerminalFilePath","getStateFolderPath","getSharedFolderPath","getCodespaceStateFilePath","getDevcontainerStateFilePath","getSharedFile","getContainerPersistedFolderPath","isRecoveryContainer","terminateOryxTask","downloadVsCodeServerByCommitId","getPerformanceData","getCreationLogStatus"],events:["configurationFinished","devContainerConfigChanged","codespaceStopping","codespaceAvailable","creationLogUpdated"]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(269);t.getVSCodeServerSessionName=e=>e?`${i.VSCODE_SERVER_PORT_NAME}_${e}`:i.VSCODE_SERVER_PORT_NAME},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6),s=n(8),r=n(1080),o=n(266),a=n(1081),c=n(139),l=e=>Object.assign(Object.assign({},r.HUB_CONNECTION_DEFAULT_OPTIONS),e);class u extends i.DisposableClass{constructor(e,t,n,c=[]){super(e),this.performance=t,this.connectionClass=n,this.childConnectionHubs=c,this.onConnectionEmitter=new s.Emitter,this.onConnection=this.onConnectionEmitter.event,this.getConnectionId=e=>new this.connectionClass(this.trace,this.performance,e).getId(e),this.connectOnce=async(e,t={})=>{const{trace:n=this.trace}=t;return n.info("requested to connect once",e,t),await this.connect(e,Object.assign(Object.assign({},r.HUB_NO_RETRY_OPTIONS),t))},this.connections={},this.retrySignals={},this.createConnectionWithTimeout=async(e,t)=>{const{timeout:n}=t;return isFinite(n)?(this.trace.verbose(`creating connection with timeout of ${n}ms`),await i.timeoutPromise(this.createConnection(e,t),n,new o.ConnectionTimeoutError(`Could not establish connection in ${n}ms.`))):(this.trace.verbose("creating connection without a timeout"),await this.createConnection(e,t))},this.createConnection=async(e,t)=>{const{retries:n,retryDelay:s,performance:r=this.performance,trace:o=this.trace}=t,c=e,l=this.getConnectionId(c);try{this.trace.info("creating connection",t);const n=new this.connectionClass(o.createChild(`connection:${l}`),r.createGroup(`${o.name}:${i.hashString(l)}`),c,this.childConnectionHubs),s=new a.ConnectionHubRecord(this.trace.createChild("connection-record"),n,e,t,n.onConnectionChanged(this.onConnectionChanged.bind(this,l)));this.connections[l]=s;const u=await n.connect();return this.addToDisposables(s),i.defer(()=>{this.onConnectionEmitter.fire(u)},0),u}catch(r){if(this.trace.warning(`disposing connection "${l}" due to an error`,r),this.disposeConnection(l),n<1)throw r;this.trace.info(`connection failed, retrying ${n}`);const o=new i.Signal;return this.retrySignals[l]=o,await Promise.race([o.promise,i.wait(s)]),await this.createConnection(e,Object.assign(Object.assign({},t),{retries:n-1}))}}}get childHubs(){return[...this.childConnectionHubs]}getConnection(e){const t=this.getConnectionId(e),n=this.connections[t];if(n){const{connection:e}=n;return e}}async connect(e,t={}){const{trace:n=this.trace}=t;n.info("requested to connect",e,t);try{const i=this.getConnectionId(e),s=this.connections[i],r=n.createChild(`${i}`);if(r.info(`connection record: ${!!s}`),!s)return r.info("creating new connection"),await this.createConnectionWithTimeout(e,l(t));const{connection:o}=s;if(!o)return r.info("no connection on connection record, creating"),await this.createConnectionWithTimeout(e,l(t));if("disconnected"===o.status)return r.info("disposed, creating"),this.disposeConnection(i),await this.createConnectionWithTimeout(e,l(t));if("connected"===o.status)return r.info("return connected"),o;const{timeout:a=1/0}=t;return r.info(`connecting with timeout - ${a} ms`),await o.connectWithTimeout(a)}catch(e){throw n.warning("error during connection",e),c.errorToConnectionError(e)}}async disconnect(e,t){this.trace.info("requested disconnect",e);const n=this.getConnectionId(e),i=this.retrySignals[n];i&&(i.cancel(),this.retrySignals[n]=void 0);const s=this.connections[n];return!!s&&(await s.disconnect(t),this.connections[n]=void 0,!0)}async onConnectionChanged(e,t){const n=this.trace.createChild(`onConnectionChanged:${e}`),{status:i,previousStatus:s}=t;if(n.info(`${s} -> ${i}`),"disconnected"!==i)return;const r=this.connections[e];if(!r)return void n.info("no connection record found");if(n.info("disposing the connection"),this.disposeConnection(e),this.connections[e]=void 0,"connected"!==s)return;const{hubConnectionOptions:o,connectionOptions:a,connection:c}=r;if(o.shouldReconnect&&!c.isDisposing)return n.info("reconnecting.."),await this.connect(a,o);n.info("not reconnecting")}disposeConnection(e){try{this.trace.info(`disposing ${e} connection`);const t=this.connections[e];if(!t)return;t.dispose("connection record disposed by ConnectionHub"),this.connections[e]=void 0}catch(t){this.trace.warning(`error while disposing ${e} connection`,t)}}}t.ConnectionHub=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(465),s=n(8),r=n(6),o=n(1089),a=n(1090);class c{constructor(e,t,n="start"){this.name=e,this.groupId=t,this.pathString=n,this.groups=[],this.onAnyEventEmitter=new s.Emitter,this.onAnyEvent=this.onAnyEventEmitter.event,this.createGroup=(e,t=c.groupCount++)=>{const n=`${this.pathString}.${e}.${this.groupId}`,i=new c(e,t,n);return i.setMainPerformance(this.main),i.onAnyEvent(e=>{this.onAnyEventEmitter.fire(e)}),this.groups.push(i),i},this.markBlock=e=>(this.blocks.markBlock(e),this),this.markBlockStart=(e,t=!1)=>{try{this.blocks.markBlockStart(e)}catch(e){if(!t)throw e}return this},this.markBlockEnd=(e,t=!1)=>{try{this.blocks.markBlockEnd(e)}catch(e){if(!t)throw e}return this},this.measure=async(e,t)=>await this.blocks.measure(e,t),this.measureSync=(e,t)=>this.blocks.measureSync(e,t),this.getWaterfall=()=>{i.performance.measure(this.pathString,this.pathString);const[e]=i.performance.getEntriesByName(this.pathString);return new o.WaterfallNode(this.groupId,this.name,this.pathString,e,this.blocks.measures(),this.groups)},this.getBlockMeasure=(e,t)=>{if((t=null!=t?t:this.main.getWaterfall()).id===e)return t;for(let n of t.groups){const t=this.getBlockMeasure(e,n);if(t)return t}return null},this.getBlock=e=>this.blocks.getBlock(e),this.getBlockStartTime=e=>{const t=this.main.getBlockMeasure(e);if(!t)return null;const{measure:n}=t;return n.startTime},this.getBlockEndTime=e=>{const t=this.main.getBlockMeasure(e);if(!t)return null;const{measure:n}=t;return n.startTime+n.duration},this.getBlockDurationTime=e=>{const t=this.main.getBlockMeasure(e);if(!t)return null;const{measure:n}=t;return n.duration},this.blocks=new a.PerformanceBlocks(n),i.performance.mark(n),this.mainPerformanceReference=this,this.blocks.onAnyEvent(e=>{this.onAnyEventEmitter.fire(e)})}setMainPerformance(e){this.mainPerformanceReference=e}get main(){if(!this.mainPerformanceReference)throw new Error("No main performance found.");return this.mainPerformanceReference}onEvent(e,t){return this.blocks.onEvent(e,e=>{const{id:n,type:i}=e;if("start"===i)return t(e),this;const s=this.getBlockMeasure(n);if(!s)throw new Error(`Cannot find "${n}" block.`);t(e,s)}),this}onMeasure(e,t){return this.blocks.onEvent(e,e=>{const{id:n,type:i}=e;if("start"===i)return t(e),this;const s=this.getBlockMeasure(n);if(!s)throw new Error(`Cannot find "${n}" block.`);t(e,s)}),this}}t.Performance=c,c.groupCount=0,t.initializePerformanceInstance=(e,t=c)=>{const n=new t("start",e);return n.setMainPerformance(n),n},t.getOrCreatePerformance=r.onlyOnce(e=>t.initializePerformanceInstance(e),"extension:start")},function(e,t,n){"use strict";n.r(t),n.d(t,"PerformanceObserver",(function(){return i})),n.d(t,"performance",(function(){return s}));const{PerformanceObserver:i,performance:s}=globalThis},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(271),s=n(6),r=n(19);t.PerformanceMock=i.mocks.PerformanceMock,t.getRandomConnectionMockOptions=()=>({id:s.randomString(),someProp:s.randomString(),numericProp:s.randomInt(100)}),t.testTrace=new r.TraceSource("test-trace");const o=new t.PerformanceMock("test-performance","test-start");t.getConnectionMockOptions=(e={})=>{const{trace:n=t.testTrace}=e;return[n,o,Object.assign({},t.getRandomConnectionMockOptions())]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.ContactService=0]="ContactService",e[e.RelayService=1]="RelayService"}(t.HubProxyType||(t.HubProxyType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(469);t.HubStreamUtils=i.HubStreamUtils;var s=n(1123);t.HubProxyUtils=s.HubProxyUtils;var r=n(488);t.RelayHubProxyServer=r.RelayHubProxyServer;var o=n(1124);t.createRelayHubEventNotifier=o.createRelayHubEventNotifier;var a=n(1125);t.createRelayHubProxyServerProvider=a.createRelayHubProxyServerProvider;var c=n(1126);t.RpcUtils=c.RpcUtils;const l=n(106);t.constants=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(64),s=n(273),r=n(106),o=n(6);class a{static async createClientStream(e,t,n,c,l){c=c||a.getHostParticipant,await e.hubProxy.connect();const u=await e.joinHub(t,null,{}),d=c(u);null==l||l.verbose(`hub:${t} joined host:${d.id} self:${u.selfParticipant.id} participants:${JSON.stringify(u.participants)} on service:${u.serviceId} stamp:${u.stamp}`);const h=new s.HubStream(u,n||r.DATA_TYPE_LIVESHARE_HUB,d.id),f=(new Date).getTime(),p=new o.Signal,m=u.onReceiveData(async e=>{e.type===r.DATA_TYPE_JOINED_READY_ACK&&e.fromParticipant.id===d.id&&(null==l||l.verbose(`Ack received after:${(new Date).getTime()-f} ms`),p.resolve())});return await u.sendData(i.SendOption.None,[d.id],r.DATA_TYPE_JOINED_READY,null,void 0,i.HubMethodOption.Invoke),d.properties.hasOwnProperty(r.PARTICIPANT_PROPERTY_HOST_FLAGS)&&d.properties[r.PARTICIPANT_PROPERTY_HOST_FLAGS]&r.HostFlags.JoinReadAck&&(null==l||l.verbose(`Host join ready completed after:${(new Date).getTime()-f} ms`),await o.timeoutPromise(p.promise,3e4,new Error("Host acknowledge not received to initiate the hub stream"))),m.dispose(),h}static getHostParticipant(e){return a.getHostParticipantByProperty(e,r.PARTICIPANT_PROPERTY_IS_HOST)}static getHostParticipantByProperty(e,t){const n=e.participants.filter(e=>e.properties&&e.properties.hasOwnProperty(t));if(1!==n.length)throw new Error(n.length>1?"Multiple host participants":"No host participant found");return n[0]}}t.HubStreamUtils=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Send=0]="Send",e[e.Invoke=1]="Invoke"}(t.HubMethodOption||(t.HubMethodOption={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(59);class s{constructor(e,t,n){this.hubProxy=e,this.logger=t,this.hubName=n}toHubMethodName(e){return this.hubName?`${this.hubName}.${e}`:e}invoke(e,...t){return this.hubName?this.hubProxy.invoke(s.invokeHubMethodAsync,this.toHubMethodName(e),t):this.hubProxy.invoke(e,...t)}send(e,...t){return this.hubName?this.hubProxy.send(s.invokeHubMethodAsync,this.toHubMethodName(e),t):this.hubProxy.send(e,...t)}async invokeKeysToCamel(e,...t){return a(await this.invoke(e,...t))}}function r(e){return e.substr(0,1).toLowerCase()+e.substr(1)}function o(e){return e.substr(0,1).toUpperCase()+e.substr(1)}function a(e){return c(e,r)}function c(e,t){if(i.isArray(e))return e.map(e=>c(e,t));if(i.isObject(e)){const n={};return Object.keys(e).forEach(s=>{let r=e[s];i.isObject(r)&&(r=c(r,t)),n[t(s)]=r}),n}return e}t.HubProxyBase=s,s.invokeHubMethodAsync="InvokeHubMethodAsync",t.keysToCamel=a,t.keysToPascal=function(e){return c(e,o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Updated=3]="Updated"}(t.ParticipantChangeType||(t.ParticipantChangeType={})),function(e){e[e.None=0]="None",e[e.ExcludeSelf=1]="ExcludeSelf"}(t.SendOption||(t.SendOption={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(180);t.RelayDataHubProxy=class{constructor(e,t){this.receiveDataCallbacks=new i.CallbackContainer,this.eventDisposable=e.onReceiveData(e=>t(e)?this.processReceivedData(e):Promise.resolve())}dispose(){this.eventDisposable.dispose()}onReceiveData(e){return this.receiveDataCallbacks.add(e)}async fireReceivedData(e){for(const t of this.receiveDataCallbacks.items)await t(e)}processReceivedData(e){return this.fireReceivedData(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{static createMessageSequence(e){return{sequenceId:e}}static getMessageSequence(e){if(e&&e.hasOwnProperty(i.propertySequenceId))return Number(e[i.propertySequenceId])}}t.RelayHubMessageProperties=i,i.propertySequenceId="sequenceId",i.propertyAuditPrefixId="audit-",i.propertyAuditPerfTypeId="perfType"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectDisposedError=t.SshReconnectError=t.SshConnectionError=t.SshChannelError=t.BigInt=t.DerWriter=t.DerReader=t.formatBuffer=t.SshDataWriter=t.SshDataReader=t.ECDsa=t.Rsa=t.Encryption=t.HmacAlgorithm=t.EncryptionAlgorithm=t.PublicKeyAlgorithm=t.KeyExchangeAlgorithm=t.SshAlgorithms=t.CommandRequestMessage=t.ChannelRequestType=t.ChannelRequestMessage=t.ChannelOpenMessage=t.SshChannelOpenFailureReason=t.SshReconnectFailureReason=t.SshDisconnectReason=t.SessionRequestFailureMessage=t.SessionRequestSuccessMessage=t.DebugMessage=t.SessionRequestMessage=t.SshMessage=t.SshChannelClosedEventArgs=t.SshSessionClosedEventArgs=t.SshChannelOpeningEventArgs=t.SshRequestEventArgs=t.SshAuthenticatingEventArgs=t.SshAuthenticationType=t.serviceActivation=t.SshService=t.SshRpcMessageStream=t.WebSocketStream=t.NodeStream=t.BaseStream=t.SshStream=t.SshChannel=t.SshServerSession=t.SshClientSession=t.SshSession=t.SshVersionInfo=t.SshProtocolExtensionNames=t.SshSessionConfiguration=void 0,t.MultiChannelStream=t.SessionContour=t.ChannelMetrics=t.SessionMetrics=t.Queue=t.Semaphore=t.PromiseCompletionSource=t.CancellationError=t.CancellationTokenSource=t.CancellationToken=void 0;var i=n(140);Object.defineProperty(t,"SshSessionConfiguration",{enumerable:!0,get:function(){return i.SshSessionConfiguration}}),Object.defineProperty(t,"SshProtocolExtensionNames",{enumerable:!0,get:function(){return i.SshProtocolExtensionNames}});var s=n(482);Object.defineProperty(t,"SshVersionInfo",{enumerable:!0,get:function(){return s.SshVersionInfo}});var r=n(142);Object.defineProperty(t,"SshSession",{enumerable:!0,get:function(){return r.SshSession}});var o=n(1116);Object.defineProperty(t,"SshClientSession",{enumerable:!0,get:function(){return o.SshClientSession}});var a=n(1117);Object.defineProperty(t,"SshServerSession",{enumerable:!0,get:function(){return a.SshServerSession}});var c=n(281);Object.defineProperty(t,"SshChannel",{enumerable:!0,get:function(){return c.SshChannel}});var l=n(487);Object.defineProperty(t,"SshStream",{enumerable:!0,get:function(){return l.SshStream}});var u=n(1118);Object.defineProperty(t,"BaseStream",{enumerable:!0,get:function(){return u.BaseStream}}),Object.defineProperty(t,"NodeStream",{enumerable:!0,get:function(){return u.NodeStream}}),Object.defineProperty(t,"WebSocketStream",{enumerable:!0,get:function(){return u.WebSocketStream}});var d=n(1119);Object.defineProperty(t,"SshRpcMessageStream",{enumerable:!0,get:function(){return d.SshRpcMessageStream}});var h=n(183);Object.defineProperty(t,"SshService",{enumerable:!0,get:function(){return h.SshService}});var f=n(104);Object.defineProperty(t,"serviceActivation",{enumerable:!0,get:function(){return f.serviceActivation}});var p=n(285);Object.defineProperty(t,"SshAuthenticationType",{enumerable:!0,get:function(){return p.SshAuthenticationType}}),Object.defineProperty(t,"SshAuthenticatingEventArgs",{enumerable:!0,get:function(){return p.SshAuthenticatingEventArgs}});var m=n(282);Object.defineProperty(t,"SshRequestEventArgs",{enumerable:!0,get:function(){return m.SshRequestEventArgs}});var g=n(483);Object.defineProperty(t,"SshChannelOpeningEventArgs",{enumerable:!0,get:function(){return g.SshChannelOpeningEventArgs}});var y=n(486);Object.defineProperty(t,"SshSessionClosedEventArgs",{enumerable:!0,get:function(){return y.SshSessionClosedEventArgs}});var v=n(481);Object.defineProperty(t,"SshChannelClosedEventArgs",{enumerable:!0,get:function(){return v.SshChannelClosedEventArgs}});var S=n(105);Object.defineProperty(t,"SshMessage",{enumerable:!0,get:function(){return S.SshMessage}});var _=n(54);Object.defineProperty(t,"SessionRequestMessage",{enumerable:!0,get:function(){return _.SessionRequestMessage}}),Object.defineProperty(t,"DebugMessage",{enumerable:!0,get:function(){return _.DebugMessage}}),Object.defineProperty(t,"SessionRequestSuccessMessage",{enumerable:!0,get:function(){return _.SessionRequestSuccessMessage}}),Object.defineProperty(t,"SessionRequestFailureMessage",{enumerable:!0,get:function(){return _.SessionRequestFailureMessage}}),Object.defineProperty(t,"SshDisconnectReason",{enumerable:!0,get:function(){return _.SshDisconnectReason}}),Object.defineProperty(t,"SshReconnectFailureReason",{enumerable:!0,get:function(){return _.SshReconnectFailureReason}});var E=n(84);Object.defineProperty(t,"SshChannelOpenFailureReason",{enumerable:!0,get:function(){return E.SshChannelOpenFailureReason}}),Object.defineProperty(t,"ChannelOpenMessage",{enumerable:!0,get:function(){return E.ChannelOpenMessage}}),Object.defineProperty(t,"ChannelRequestMessage",{enumerable:!0,get:function(){return E.ChannelRequestMessage}}),Object.defineProperty(t,"ChannelRequestType",{enumerable:!0,get:function(){return E.ChannelRequestType}}),Object.defineProperty(t,"CommandRequestMessage",{enumerable:!0,get:function(){return E.CommandRequestMessage}});var w=n(103);Object.defineProperty(t,"SshAlgorithms",{enumerable:!0,get:function(){return w.SshAlgorithms}}),Object.defineProperty(t,"KeyExchangeAlgorithm",{enumerable:!0,get:function(){return w.KeyExchangeAlgorithm}}),Object.defineProperty(t,"PublicKeyAlgorithm",{enumerable:!0,get:function(){return w.PublicKeyAlgorithm}}),Object.defineProperty(t,"EncryptionAlgorithm",{enumerable:!0,get:function(){return w.EncryptionAlgorithm}}),Object.defineProperty(t,"HmacAlgorithm",{enumerable:!0,get:function(){return w.HmacAlgorithm}}),Object.defineProperty(t,"Encryption",{enumerable:!0,get:function(){return w.Encryption}}),Object.defineProperty(t,"Rsa",{enumerable:!0,get:function(){return w.Rsa}}),Object.defineProperty(t,"ECDsa",{enumerable:!0,get:function(){return w.ECDsa}});var b=n(37);Object.defineProperty(t,"SshDataReader",{enumerable:!0,get:function(){return b.SshDataReader}}),Object.defineProperty(t,"SshDataWriter",{enumerable:!0,get:function(){return b.SshDataWriter}}),Object.defineProperty(t,"formatBuffer",{enumerable:!0,get:function(){return b.formatBuffer}});var C=n(280);Object.defineProperty(t,"DerReader",{enumerable:!0,get:function(){return C.DerReader}}),Object.defineProperty(t,"DerWriter",{enumerable:!0,get:function(){return C.DerWriter}});var T=n(53);Object.defineProperty(t,"BigInt",{enumerable:!0,get:function(){return T.BigInt}});var M=n(47);Object.defineProperty(t,"SshChannelError",{enumerable:!0,get:function(){return M.SshChannelError}}),Object.defineProperty(t,"SshConnectionError",{enumerable:!0,get:function(){return M.SshConnectionError}}),Object.defineProperty(t,"SshReconnectError",{enumerable:!0,get:function(){return M.SshReconnectError}}),Object.defineProperty(t,"ObjectDisposedError",{enumerable:!0,get:function(){return M.ObjectDisposedError}});var A=n(86);Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return A.CancellationToken}}),Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return A.CancellationTokenSource}}),Object.defineProperty(t,"CancellationError",{enumerable:!0,get:function(){return A.CancellationError}});var k=n(85);Object.defineProperty(t,"PromiseCompletionSource",{enumerable:!0,get:function(){return k.PromiseCompletionSource}});var R=n(143);Object.defineProperty(t,"Semaphore",{enumerable:!0,get:function(){return R.Semaphore}});var P=n(182);Object.defineProperty(t,"Queue",{enumerable:!0,get:function(){return P.Queue}});var I=n(485);Object.defineProperty(t,"SessionMetrics",{enumerable:!0,get:function(){return I.SessionMetrics}});var N=n(480);Object.defineProperty(t,"ChannelMetrics",{enumerable:!0,get:function(){return N.ChannelMetrics}});var L=n(1120);Object.defineProperty(t,"SessionContour",{enumerable:!0,get:function(){return L.SessionContour}});var D=n(1121);Object.defineProperty(t,"MultiChannelStream",{enumerable:!0,get:function(){return D.MultiChannelStream}})},function(e){e.exports=JSON.parse('{"name":"@vs/vs-ssh","version":"3.4.14","description":"SSH library for Visual Studio tools","keywords":["SSH"],"dependencies":{"buffer":"^5.2.1","debug":"^4.1.1","diffie-hellman":"^5.0.3","vscode-jsonrpc":"^4.0.0"},"author":"Microsoft","main":"./index.js"}')},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeECDiffieHellman=t.NodeDiffieHellman=void 0;const i=n(28),s=n(3),r=n(274),o=n(279),a=n(53);class c extends r.KeyExchangeAlgorithm{constructor(e,t,n){super(e,t,n,o.NodeHmac.getHashDigestLength(n))}createKeyExchange(){return new l(this.keySizeInBits,o.NodeHmac.getNodeHashAlgorithmName(this.hashAlgorithmName),this.hashDigestLength)}}t.NodeDiffieHellman=c;class l{constructor(e,t,n){switch(this.hashAlgorithmName=t,this.digestLength=n,e){case 1024:this.dh=i.getDiffieHellman("modp2");break;case 2048:this.dh=i.getDiffieHellman("modp14");break;case 4096:this.dh=i.getDiffieHellman("modp16");break;default:throw new Error("Invalid DH bit length.")}}startKeyExchange(){const e=this.dh.generateKeys(),t=a.BigInt.fromBytes(e,{unsigned:!0}).toBytes();return Promise.resolve(t)}decryptKeyExchange(e){const t=this.dh.computeSecret(e),n=a.BigInt.fromBytes(t,{unsigned:!0}).toBytes();return Promise.resolve(n)}async sign(e){const t=i.createHash(this.hashAlgorithmName);return t.update(e),s.Buffer.from(t.digest())}dispose(){}}class u extends r.KeyExchangeAlgorithm{constructor(e,t,n){super(e,t,n,o.NodeHmac.getHashDigestLength(n))}createKeyExchange(){return new d(this.keySizeInBits,o.NodeHmac.getNodeHashAlgorithmName(this.hashAlgorithmName),this.hashDigestLength)}}t.NodeECDiffieHellman=u;class d{constructor(e,t,n){switch(this.hashAlgorithmName=t,this.digestLength=n,e){case 256:this.ecdh=i.createECDH("prime256v1");break;case 384:this.ecdh=i.createECDH("secp384r1");break;case 521:this.ecdh=i.createECDH("secp521r1");break;default:throw new Error("Invalid ECDH bit length.")}}startKeyExchange(){const e=this.ecdh.generateKeys();return Promise.resolve(e)}decryptKeyExchange(e){const t=this.ecdh.computeSecret(e),n=a.BigInt.fromBytes(t,{unsigned:!0}).toBytes();return Promise.resolve(n)}async sign(e){const t=i.createHash(this.hashAlgorithmName);return t.update(e),s.Buffer.from(t.digest())}dispose(){}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.Sec1KeyFormatter=t.Pkcs1KeyFormatter=t.parsePem=t.formatPem=void 0;const i=n(53),s=n(280),r=n(181);t.formatPem=function(e,t){return`-----BEGIN ${t}-----\n`+e.toString("base64").match(/.{1,64}/g).join("\n")+"\n"+`-----END ${t}-----\n`},t.parsePem=function(t){const n=t.replace(/-+[^-\n]+KEY-+/g,"").replace(/\s/g,"");return e.from(n,"base64")};t.Pkcs1KeyFormatter=class{static formatRsaPublic(t){const n=new s.DerWriter(e.alloc(1024));return n.writeInteger(t.modulus),n.writeInteger(t.exponent),n.toBuffer()}static formatRsaPrivate(t){if(!(t.d&&t.p&&t.q&&t.dp&&t.dq&&t.qi))throw new Error("Missing private key parameters.");const n=new s.DerWriter(e.alloc(2048));return n.writeInteger(i.BigInt.fromInt32(0)),n.writeInteger(t.modulus),n.writeInteger(t.exponent),n.writeInteger(t.d),n.writeInteger(t.p),n.writeInteger(t.q),n.writeInteger(t.dp),n.writeInteger(t.dq),n.writeInteger(t.qi),n.toBuffer()}static parseRsaPublic(e){const t=new s.DerReader(e);return{modulus:t.readInteger(),exponent:t.readInteger()}}static parseRsaPrivate(e){const t=new s.DerReader(e);t.readInteger();return{modulus:t.readInteger(),exponent:t.readInteger(),d:t.readInteger(),p:t.readInteger(),q:t.readInteger(),dp:t.readInteger(),dq:t.readInteger(),qi:t.readInteger()}}};class o{static formatECPublic(t){const n=r.curves.find(e=>e.oid===t.curve.oid),i=Math.ceil(n.keySize/8),a=new s.DerWriter(e.alloc(512)),c=new s.DerWriter(e.alloc(100));c.writeObjectIdentifier(o.ecPublicKeyOid),c.writeObjectIdentifier(t.curve.oid),a.writeSequence(c);const l=t.x.toBytes({unsigned:!0,length:i}),u=t.y.toBytes({unsigned:!0,length:i}),d=e.alloc(1+l.length+u.length);return d[0]=4,l.copy(d,1),u.copy(d,1+l.length),a.writeBitString(d),a.toBuffer()}static formatECPrivate(t){const n=r.curves.find(e=>e.oid===t.curve.oid),o=Math.ceil(n.keySize/8),a=new s.DerWriter(e.alloc(512));a.writeInteger(i.BigInt.fromInt32(1)),a.writeOctetString(t.d.toBytes({unsigned:!0,length:o}));const c=new s.DerWriter(e.alloc(100));c.writeObjectIdentifier(t.curve.oid),a.writeTagged(0,c);const l=t.x.toBytes({unsigned:!0,length:o}),u=t.y.toBytes({unsigned:!0,length:o}),d=e.alloc(1+l.length+u.length);d[0]=4,l.copy(d,1),u.copy(d,1+l.length);const h=new s.DerWriter(e.alloc(512));return h.writeBitString(d),a.writeTagged(1,h),a.toBuffer()}static parseECPublic(e){var t;const n=new s.DerReader(e),a=n.readSequence(),c=a.readObjectIdentifier();if(c!==o.ecPublicKeyOid)throw new Error(`Unexpected key type OID: ${c}`);const l=a.readObjectIdentifier(),u=null===(t=r.curves.find(e=>e.oid===l))||void 0===t?void 0:t.name,d=n.readBitString();if(d.length%2!=1)throw new Error(`Unexpected key data length: ${d.length}`);const h=i.BigInt.fromBytes(d.slice(1,1+(d.length-1)/2),{unsigned:!0}),f=i.BigInt.fromBytes(d.slice(1+(d.length-1)/2),{unsigned:!0});return{curve:{name:u,oid:l},x:h,y:f}}static parseECPrivate(e){var t;const n=new s.DerReader(e),o=n.readInteger().toInt32();if(1!==o)throw new Error(`Unsupported SEC1 format version: ${o}`);const a=i.BigInt.fromBytes(n.readOctetString(),{unsigned:!0}),c=n.tryReadTagged(0);if(!c)throw new Error("SEC1 curve info not found.");const l=c.readObjectIdentifier(),u=null===(t=r.curves.find(e=>e.oid===l))||void 0===t?void 0:t.name,d=n.tryReadTagged(1);if(!d)throw new Error("SEC1 public key data not found.");const h=d.readBitString();if(h.length%2!=1)throw new Error(`Unexpected key data length: ${h.length}`);const f=i.BigInt.fromBytes(h.slice(1,1+(h.length-1)/2),{unsigned:!0}),p=i.BigInt.fromBytes(h.slice(1+(h.length-1)/2),{unsigned:!0});return{curve:{name:u,oid:l},x:f,y:p,d:a}}}t.Sec1KeyFormatter=o,o.ecPublicKeyOid="1.2.840.10045.2.1"}).call(this,n(3).Buffer)},function(e,t,n){"use strict";var i,s=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.KeyExchangeService=void 0;const r=n(46),o=n(3),a=n(142),c=n(183),l=n(53),u=n(283),d=n(103),h=n(37),f=n(47),p=n(54),m=n(1115),g=n(8),y=n(104);class v{}let S=i=class extends c.SshService{constructor(e,t){super(e),this.isClientSession=t,this.isInitialExchange=!1,this.exchangeContext=null}get exchanging(){return!!this.exchangeContext}async startKeyExchange(e){this.isInitialExchange=e,this.exchangeContext=new v;const t=this.createKeyExchangeInitMessage();let n=null;return this.isClientSession?(e&&this.session.config.enableKeyExchangeGuess&&(n=await this.createKeyExchangeGuessMessage(),t.firstKexPacketFollows=!!n),this.exchangeContext.clientKexInitPayload=t.toBuffer()):this.exchangeContext.serverKexInitPayload=t.toBuffer(),[t,n]}finishKeyExchange(){const e=this.exchangeContext.newAlgorithms;return this.exchangeContext=null,e}abortKeyExchange(){this.exchangeContext=null}createKeyExchangeInitMessage(){const e=this.isClientSession?"ext-info-c":"ext-info-s",t=this.session.config,n=new u.KeyExchangeInitMessage;return n.keyExchangeAlgorithms=(0,d.algorithmNames)(t.keyExchangeAlgorithms).concat(e),n.serverHostKeyAlgorithms=this.getPublicKeyAlgorithms(),n.encryptionAlgorithmsClientToServer=n.encryptionAlgorithmsServerToClient=(0,d.algorithmNames)(t.encryptionAlgorithms),n.macAlgorithmsClientToServer=n.macAlgorithmsServerToClient=(0,d.algorithmNames)(t.hmacAlgorithms),n.compressionAlgorithmsClientToServer=n.compressionAlgorithmsServerToClient=(0,d.algorithmNames)(t.compressionAlgorithms),n.languagesClientToServer=[""],n.languagesServerToClient=[""],n.firstKexPacketFollows=!1,n.reserved=0,n}getPublicKeyAlgorithms(){var e,t;let n=[...this.session.config.publicKeyAlgorithms];if(n.length>1&&!this.isClientSession){const i=null===(t=null===(e=this.session.credentials)||void 0===e?void 0:e.publicKeys)||void 0===t?void 0:t.map(e=>e.keyAlgorithmName);i&&(n=n.filter(e=>e&&i.includes(e.keyAlgorithmName)))}return(0,d.algorithmNames)(n)}async createKeyExchangeGuessMessage(){if(!this.exchangeContext)throw new Error("Key exchange was not started.");const e=this.session.config.keyExchangeAlgorithms[0];if(!e)return null;this.exchangeContext.keyExchange=e.name,this.exchangeContext.exchange=e.createKeyExchange(),this.exchangeContext.exchangeValue=await this.exchangeContext.exchange.startKeyExchange();const t=new u.KeyExchangeDhInitMessage;return t.e=this.exchangeContext.exchangeValue,t}handleMessage(e,t){if(e instanceof u.KeyExchangeInitMessage)return this.handleInitMessage(e,t);if(e instanceof u.KeyExchangeDhInitMessage)return this.handleDhInitMessage(e,t);if(e instanceof u.KeyExchangeDhReplyMessage)return this.handleDhReplyMessage(e,t);throw new Error(`Message not implemented: ${e}`)}async handleInitMessage(e,t){var n,i,s,o,a;if(!this.exchangeContext)throw new Error("Key exchange was not started.");const c=this.session.config;if(this.exchangeContext.keyExchange=this.chooseAlgorithm("KeyExchange",(0,d.algorithmNames)(c.keyExchangeAlgorithms),e.keyExchangeAlgorithms),"none"===this.exchangeContext.keyExchange)return(0,r.trace)("Client and server negotiated no security. Cancelling key-exchange."),this.exchangeContext.newAlgorithms=new m.SshSessionAlgorithms,void await this.session.handleNewKeysMessage(new u.NewKeysMessage,t);let l;if(this.exchangeContext.publicKey=this.chooseAlgorithm("PublicKey",this.getPublicKeyAlgorithms(),e.serverHostKeyAlgorithms),this.exchangeContext.clientEncryption=this.chooseAlgorithm("ClientEncryption",(0,d.algorithmNames)(c.encryptionAlgorithms),e.encryptionAlgorithmsClientToServer),this.exchangeContext.serverEncryption=this.chooseAlgorithm("ServerEncryption",(0,d.algorithmNames)(c.encryptionAlgorithms),e.encryptionAlgorithmsServerToClient),this.exchangeContext.clientHmac=this.chooseAlgorithm("ClientHmac",(0,d.algorithmNames)(c.hmacAlgorithms),e.macAlgorithmsClientToServer),this.exchangeContext.serverHmac=this.chooseAlgorithm("ServerHmac",(0,d.algorithmNames)(c.hmacAlgorithms),e.macAlgorithmsServerToClient),this.exchangeContext.clientCompression=this.chooseAlgorithm("ClientCompression",(0,d.algorithmNames)(c.compressionAlgorithms),e.compressionAlgorithmsClientToServer),this.exchangeContext.serverCompression=this.chooseAlgorithm("ServerCompression",(0,d.algorithmNames)(c.compressionAlgorithms),e.compressionAlgorithmsServerToClient),this.isClientSession){this.exchangeContext.serverKexInitPayload=e.toBuffer();const i=!!this.exchangeContext.exchangeValue,s=this.exchangeContext.keyExchange===(null===(n=c.keyExchangeAlgorithms[0])||void 0===n?void 0:n.name);if(!i||!s){const e=c.getKeyExchangeAlgorithm(this.exchangeContext.keyExchange);this.exchangeContext.exchange=e.createKeyExchange(),this.exchangeContext.exchangeValue=await this.exchangeContext.exchange.startKeyExchange();const n=new u.KeyExchangeDhInitMessage;n.e=this.exchangeContext.exchangeValue,await this.session.sendMessage(n,t)}l="ext-info-s"}else{if(e.firstKexPacketFollows){const t=this.exchangeContext.keyExchange===(null===(i=e.keyExchangeAlgorithms)||void 0===i?void 0:i[0]),n=t?"correct":"incorrect";if((0,r.trace)(`Client's KeyExchange guess was ${n}.`),this.exchangeContext.discardGuessedInit=!t,t&&this.session.remoteVersion.isVsSsh&&(null===(s=this.session.remoteVersion.version)||void 0===s?void 0:s.startsWith("2."))){(null===(o=e.keyExchangeAlgorithms)||void 0===o?void 0:o[0])===(null===(a=c.keyExchangeAlgorithms[0])||void 0===a?void 0:a.name)||((0,r.trace)("Ignoring correct guess for compatibility with older client."),this.exchangeContext.discardGuessedInit=!0)}}this.exchangeContext.clientKexInitPayload=e.toBuffer(),l="ext-info-c"}this.isInitialExchange&&e.keyExchangeAlgorithms.includes(l)&&await this.session.sendExtensionInfo(t)}async handleDhInitMessage(e,t){var n,i,s,r,a,c,l;if(this.isClientSession)return;const d=this.session;if(!this.exchangeContext||!this.exchangeContext.keyExchange||!this.exchangeContext.publicKey)throw new f.SshConnectionError("Key exchange not started.",p.SshDisconnectReason.protocolError);if(this.exchangeContext.discardGuessedInit)return void(this.exchangeContext.discardGuessedInit=!1);const h=this.session.config.getKeyExchangeAlgorithm(this.exchangeContext.keyExchange);if(!h)throw new f.SshConnectionError("Key exchange not supported for algorithm: "+this.exchangeContext.keyExchange,p.SshDisconnectReason.keyExchangeFailed);const y=this.session.config.getPublicKeyAlgorithm(this.exchangeContext.publicKey);if(!y)throw new f.SshConnectionError("Public key algorithm not supported: "+this.exchangeContext.publicKey,p.SshDisconnectReason.keyExchangeFailed);let v=null;if(null===(n=d.credentials)||void 0===n?void 0:n.publicKeys){const e=d.credentials.publicKeys.find(e=>e.keyAlgorithmName===y.keyAlgorithmName);if(v=null!=e?e:null,!1===(null==v?void 0:v.hasPrivateKey)){if(!d.credentials.privateKeyProvider)throw new Error("A private key provider is required.");v=await d.credentials.privateKeyProvider(e,null!=t?t:g.CancellationToken.None)}}if(null==v)throw new f.SshConnectionError("Private key not found for algorithm: "+this.exchangeContext.publicKey,p.SshDisconnectReason.keyExchangeFailed);const S=this.session.config.getEncryptionAlgorithm(this.exchangeContext.clientEncryption),_=this.session.config.getEncryptionAlgorithm(this.exchangeContext.serverEncryption),E=this.session.config.getHmacAlgorithm(this.exchangeContext.serverHmac),w=this.session.config.getHmacAlgorithm(this.exchangeContext.clientHmac),b=h.createKeyExchange(),C=e.e||o.Buffer.alloc(0),T=await b.startKeyExchange(),M=await b.decryptKeyExchange(C),A=await v.getPublicKeyBytes(y.name);if(!A)throw new f.SshConnectionError("Public key not set.",p.SshDisconnectReason.keyExchangeFailed);const k=await this.computeExchangeHash(b,A,C,T,M);this.session.sessionId||(this.session.sessionId=k);const[R,P,I,N,L,D]=await this.computeKeys(b,M,k,S,_,w,E),x=null!==(i=await(null==_?void 0:_.createCipher(!0,N,P)))&&void 0!==i?i:null,O=null!==(s=await(null==S?void 0:S.createCipher(!1,I,R)))&&void 0!==s?s:null,F=null!==(r=await(null==E?void 0:E.createSigner(D)))&&void 0!==r?r:null,U=null!==(a=await(null==w?void 0:w.createVerifier(L)))&&void 0!==a?a:null,j=new m.SshSessionAlgorithms;j.publicKeyAlgorithmName=this.exchangeContext.publicKey,j.cipher=x,j.decipher=O,j.signer=F,j.verifier=U,j.messageSigner=(null===(c=x)||void 0===c?void 0:c.authenticatedEncryption)?x:F,j.messageVerifier=(null===(l=O)||void 0===l?void 0:l.authenticatedEncryption)?O:U,j.compressor=this.session.config.getCompressionAlgorithm(this.exchangeContext.serverCompression),j.decompressor=this.session.config.getCompressionAlgorithm(this.exchangeContext.clientCompression),this.exchangeContext.newAlgorithms=j,R&&R.fill(0),I&&I.fill(0),L&&L.fill(0),P&&P.fill(0),N&&N.fill(0),D&&D.fill(0);const H=y.createSigner(v);let B=await H.sign(k);B=y.createSignatureData(B);const Y=new u.KeyExchangeDhReplyMessage;Y.hostKey=A,Y.f=T,Y.signature=B,await this.session.sendMessage(Y,t),await this.session.sendMessage(new u.NewKeysMessage,t)}async handleDhReplyMessage(e,t){var n,i,s,o,a,c,l,d;if(!this.isClientSession)return;if(!this.exchangeContext)throw new f.SshConnectionError("Key exchange was not started.",p.SshDisconnectReason.protocolError);const h=this.session.config,g=this.exchangeContext.exchange,y=this.exchangeContext.publicKey,v=h.getPublicKeyAlgorithm(y),S=h.getEncryptionAlgorithm(this.exchangeContext.clientEncryption),_=h.getEncryptionAlgorithm(this.exchangeContext.serverEncryption),E=h.getHmacAlgorithm(this.exchangeContext.serverHmac),w=h.getHmacAlgorithm(this.exchangeContext.clientHmac),b=this.exchangeContext.exchangeValue,C=e.f;if(!g||!b)throw new f.SshConnectionError("Failed to initialize crypto after key exchange.",p.SshDisconnectReason.keyExchangeFailed);this.hostKey=v.createKeyPair(),await this.hostKey.setPublicKeyBytes(e.hostKey);const T=await g.decryptKeyExchange(C),M=e.hostKey,A=await this.computeExchangeHash(g,M,b,C,T),k=v.readSignatureData(e.signature),R=v.createVerifier(this.hostKey);let P;try{P=await R.verify(A,k)}catch(e){if(!(e instanceof Error))throw e;throw(0,r.trace)(`Server public key verification error: ${null!==(n=e.message)&&void 0!==n?n:e}`),new f.SshConnectionError("Server public key verification failed: "+(null!==(i=e.message)&&void 0!==i?i:e),p.SshDisconnectReason.hostKeyNotVerifiable)}if(!P)throw(0,r.trace)("Server public key verification failed."),new f.SshConnectionError("Server public key verification failed.",p.SshDisconnectReason.hostKeyNotVerifiable);(0,r.trace)("Server public key verification succeeded."),null==this.session.sessionId&&(this.session.sessionId=A);const[I,N,L,D,x,O]=await this.computeKeys(g,T,A,S,_,w,E),F=null!==(s=await(null==S?void 0:S.createCipher(!0,L,I)))&&void 0!==s?s:null,U=null!==(o=await(null==_?void 0:_.createCipher(!1,D,N)))&&void 0!==o?o:null,j=null!==(a=await(null==w?void 0:w.createSigner(x)))&&void 0!==a?a:null,H=null!==(c=await(null==E?void 0:E.createVerifier(O)))&&void 0!==c?c:null,B=new m.SshSessionAlgorithms;B.publicKeyAlgorithmName=y,B.cipher=F,B.decipher=U,B.signer=j,B.verifier=H,B.messageSigner=(null===(l=F)||void 0===l?void 0:l.authenticatedEncryption)?F:j,B.messageVerifier=(null===(d=U)||void 0===d?void 0:d.authenticatedEncryption)?U:H,B.compressor=h.getCompressionAlgorithm(this.exchangeContext.clientCompression),B.decompressor=h.getCompressionAlgorithm(this.exchangeContext.serverCompression),this.exchangeContext.newAlgorithms=B,I&&I.fill(0),L&&L.fill(0),x&&x.fill(0),N&&N.fill(0),D&&D.fill(0),O&&O.fill(0),await this.session.sendMessage(new u.NewKeysMessage,t)}chooseAlgorithm(e,t,n){var i;let s,o;this.isClientSession?(s=n||[],o=t):(s=t,o=n||[]);const a=`${e} negotiation: `+`Server (${s.join(", ")}) `+`Client (${o.join(", ")})`;if(this.session.remoteVersion.isVsSsh&&(null===(i=this.session.remoteVersion.version)||void 0===i?void 0:i.startsWith("2."))){const e=s;s=o,o=e}for(let e of o)for(let t of s)if(t===e){const e=t;return(0,r.trace)(`${a} => ${e}`),e}throw new Error(`Failed ${a}`)}async computeExchangeHash(e,t,n,i,s){if(!this.session.remoteVersion)throw new Error("Key exchange not completed.");const r=new h.SshDataWriter(o.Buffer.alloc(2048));return this.isClientSession?(r.writeString(a.SshSession.localVersion.toString(),"ascii"),r.writeString(this.session.remoteVersion.toString(),"ascii")):(r.writeString(this.session.remoteVersion.toString(),"ascii"),r.writeString(a.SshSession.localVersion.toString(),"ascii")),r.writeBinary(this.exchangeContext.clientKexInitPayload),r.writeBinary(this.exchangeContext.serverKexInitPayload),r.writeBinary(t),r.writeBigInt(l.BigInt.fromBytes(n,{unsigned:!0})),r.writeBigInt(l.BigInt.fromBytes(i,{unsigned:!0})),r.writeBigInt(l.BigInt.fromBytes(s,{unsigned:!0})),await e.sign(r.toBuffer())}async computeKeys(e,t,n,i,s,r,a){var c,l;const u=new h.SshDataWriter(o.Buffer.alloc(4+t.length+n.length+Math.max(1+(null!==(l=null===(c=this.session.sessionId)||void 0===c?void 0:c.length)&&void 0!==l?l:0),e.digestLength)));u.writeBinary(t),u.write(n);const d=u.position;return[i&&await this.computeKey(e,u,d,i.blockLength,"A"),s&&await this.computeKey(e,u,d,s.blockLength,"B"),i&&await this.computeKey(e,u,d,i.keyLength,"C"),s&&await this.computeKey(e,u,d,s.keyLength,"D"),r&&await this.computeKey(e,u,d,r.keyLength,"E"),a&&await this.computeKey(e,u,d,a.keyLength,"F")]}async computeKey(e,t,n,i,s){const r=o.Buffer.alloc(i);let a=0,c=0,l=null;if(!this.session.sessionId)throw new Error("Session ID not set.");for(;a<i;)t.position=n,l?t.write(l):(t.writeByte(s.charCodeAt(0)),t.write(this.session.sessionId)),l=await e.sign(t.toBuffer()),c=Math.min(l.length,i-a),l.copy(r,a),a+=c;return l&&l.fill(0),r}};S.serviceName="ssh-keyexchange",S=i=s([(0,y.serviceActivation)({serviceRequest:i.serviceName})],S),t.KeyExchangeService=S},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelMetrics=void 0;t.ChannelMetrics=class{constructor(){this.bytesSentSum=0,this.bytesReceivedSum=0}get bytesSent(){return this.bytesSentSum}get bytesReceived(){return this.bytesReceivedSum}addBytesSent(e){this.bytesSentSum+=e}addBytesReceived(e){this.bytesReceivedSum+=e}toString(){return`Bytes S/R: ${this.bytesSent} / ${this.bytesReceived}; `}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshChannelClosedEventArgs=void 0;t.SshChannelClosedEventArgs=class{constructor(e,t){"number"==typeof e?this.exitStatus=e:"string"==typeof e?(this.exitSignal=e,this.errorMessage=t):e instanceof Error&&(this.error=e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshVersionInfo=void 0;const i=n(476),s=i.name.replace(/^@\w+\//,""),r=i.version;class o{constructor(e,t,n,i){this.versionString=e,this.protocolVersion=t,this.name=n,this.version=i}static tryParse(e){if(!e)throw new TypeError("Version string expected.");if(!e.startsWith("SSH-"))return null;const t=e.indexOf("-",4);if(t<=0)return null;const n=e.substring(4,t);if(!/^\d+\.\d+$/.test(n))return null;let i,s;const r=e.substring(t+1),a=r.indexOf(" "),c=r.lastIndexOf("_",a>=0?a:r.length-1);if(c>=0){i=r.substring(0,c).replace(/_/g," "),s=r.substring(c+1);for(let e=0;e<s.length;e++){const t=s[e];if(!(t>="0"&&t<="9")&&"."!==t){s=s.substring(0,e);break}}/^\d+(\.\d+)*$/.test(s)||(s=null)}else i=r,s=null;return new o(e,n,i,s)}static getLocalVersion(){return new o(`SSH-2.0-${s}_${r}`,"2.0",s,r)}toString(){return this.versionString}get isVsSsh(){return this.isVsSshCS||this.isVsSshTS}get isVsSshCS(){return"Microsoft.VisualStudio.Ssh"===this.name}get isVsSshTS(){return"vs-ssh"===this.name}}t.SshVersionInfo=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshChannelOpeningEventArgs=void 0;const i=n(84);t.SshChannelOpeningEventArgs=class{constructor(e,t,n){if(this.request=e,this.channel=t,this.isRemoteRequest=n,this.failureReason=i.SshChannelOpenFailureReason.none,this.failureDescription=null,!e)throw new TypeError("A channel open message is required.");if(!t)throw new TypeError("A channel is required.")}toString(){return`${this.channel.toString()}${this.failureReason?" "+i.SshChannelOpenFailureReason[this.failureReason]:""}`}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationSuccessMessage=t.AuthenticationFailureMessage=t.PasswordRequestMessage=t.PublicKeyOKMessage=t.PublicKeyRequestMessage=t.AuthenticationRequestMessage=t.AuthenticationMessage=void 0;const i=n(105);class s extends i.SshMessage{}t.AuthenticationMessage=s;class r extends s{get messageType(){return 50}onRead(e){this.username=e.readString("utf8"),this.serviceName=e.readString("ascii"),this.methodName=e.readString("ascii")}onWrite(e){e.writeString(this.username||"","utf8"),e.writeString(this.serviceName||"","ascii"),e.writeString(this.validateField(this.methodName,"method name"),"ascii")}}t.AuthenticationRequestMessage=r;t.PublicKeyRequestMessage=class extends r{constructor(){super(),this.methodName="publickey"}get hasSignature(){return!!(this.signature&&this.signature.length>0)}onRead(e){super.onRead(e);const t=e.readBoolean();this.keyAlgorithmName=e.readString("ascii"),this.publicKey=e.readBinary(),t?(this.signature=e.readBinary(),this.payloadWithoutSignature=this.rawBytes.slice(0,this.rawBytes.length-this.signature.length-4)):this.signature=void 0}onWrite(t){var n,i;if(super.onWrite(t),!this.keyAlgorithmName)throw new Error("Key algorithm name not set.");if("hostbased"===this.methodName){if(t.writeString(this.keyAlgorithmName,"ascii"),t.writeBinary(this.publicKey||e.alloc(0)),t.writeString(null!==(n=this.clientHostname)&&void 0!==n?n:"","ascii"),t.writeString(null!==(i=this.clientUsername)&&void 0!==i?i:"","ascii"),!this.hasSignature)throw new Error("A signature is required for a host-based authentcation request.");t.writeBinary(this.signature)}else t.writeBoolean(this.hasSignature),t.writeString(this.keyAlgorithmName,"ascii"),t.writeBinary(this.publicKey||e.alloc(0)),this.hasSignature&&t.writeBinary(this.signature)}};t.PublicKeyOKMessage=class extends s{get messageType(){return 60}onRead(e){this.keyAlgorithmName=e.readString("ascii"),this.publicKey=e.readBinary()}onWrite(e){if(!this.keyAlgorithmName)throw new Error("Key algorithm name not set.");if(!this.publicKey)throw new Error("Public key not set.");e.writeString(this.keyAlgorithmName,"ascii"),e.writeBinary(this.publicKey)}};t.PasswordRequestMessage=class extends r{constructor(){super(),this.methodName="password"}onRead(e){super.onRead(e),e.readBoolean(),this.password=e.readString("utf8")}onWrite(e){super.onWrite(e),e.writeBoolean(!1),e.writeString(this.password||"","utf8")}};class o extends s{constructor(){super(...arguments),this.partialSuccess=!1}get messageType(){return 51}onRead(e){this.methodNames=e.readList("ascii"),this.partialSuccess=e.readBoolean()}onWrite(e){e.writeList(this.methodNames||[],"ascii"),e.writeBoolean(this.partialSuccess)}}t.AuthenticationFailureMessage=o;class a extends s{get messageType(){return 52}onRead(e){}onWrite(e){}}t.AuthenticationSuccessMessage=a,i.SshMessage.index.set(50,r),i.SshMessage.index.set(51,o),i.SshMessage.index.set(52,a)}).call(this,n(3).Buffer)},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SessionMetrics=void 0;const i=n(8);t.SessionMetrics=class{constructor(){this.startTime=0,this.messagesSentCount=0,this.messagesReceivedCount=0,this.bytesSentSum=0,this.bytesReceivedSum=0,this.reconnectionsCount=0,this.currentLatency=0,this.minLatency=0,this.maxLatency=0,this.latencySum=0,this.latencyCount=0,this.messageSentEmitter=new i.Emitter,this.onMessageSent=this.messageSentEmitter.event,this.messageReceivedEmitter=new i.Emitter,this.onMessageReceived=this.messageReceivedEmitter.event,this.latencyUpdatedEmitter=new i.Emitter,this.onLatencyUpdated=this.latencyUpdatedEmitter.event,this.sessionClosedEmitter=new i.Emitter,this.onSessionClosed=this.sessionClosedEmitter.event,"object"==typeof performance&&performance.now?Object.defineProperty(this,"time",{get:this.browserTime}):"object"==typeof e&&e.hrtime&&Object.defineProperty(this,"time",{get:this.nodejsTime}),this.startTime=this.time}get time(){return Date.now()-this.startTime}browserTime(){return performance.now()-this.startTime}nodejsTime(){const[t,n]=e.hrtime();return 1e3*t+n/1e6-this.startTime}get messagesSent(){return this.messagesSentCount}get messagesReceived(){return this.messagesReceivedCount}get bytesSent(){return this.bytesSentSum}get bytesReceived(){return this.bytesReceivedSum}get reconnections(){return this.reconnectionsCount}get latencyAverageMs(){return 0===this.latencyCount?0:this.latencySum/this.latencyCount}get latencyMinMs(){return this.minLatency}get latencyMaxMs(){return this.maxLatency}get latencyCurrentMs(){return this.currentLatency}addMessageSent(e){this.messagesSentCount++,this.bytesSentSum+=e,this.messageSentEmitter.fire({time:this.time,size:e})}addMessageReceived(e){this.messagesReceivedCount++,this.bytesReceivedSum+=e,this.messageReceivedEmitter.fire({time:this.time,size:e})}addReconnection(){this.reconnectionsCount++}updateLatency(e){if(e<0)throw new Error("Measured latency cannot be negative.");this.currentLatency=e,0!==e&&((0===this.minLatency||e<this.minLatency)&&(this.minLatency=e),(0===this.maxLatency||e>this.maxLatency)&&(this.maxLatency=e),this.latencySum+=e,this.latencyCount++,this.latencyUpdatedEmitter.fire({time:this.time,latency:e}))}close(){this.currentLatency=0,this.sessionClosedEmitter.fire()}toString(){let e=`Messages S/R: ${this.messagesSent} / ${this.messagesReceived}; `+`Bytes S/R: ${this.bytesSent} / ${this.bytesReceived}; `+`Reconnections: ${this.reconnections}; `;const t=this.minLatency>=10?1:this.minLatency>=1?10:100;if(this.maxLatency>0){e+=`Latency Min-Avg-Max: ${Math.round(this.minLatency*t)/t} - ${Math.round(this.latencySum/this.latencyCount*t)/t} - ${Math.round(this.maxLatency*t)/t} ms; `}if(this.currentLatency>0){e+=`Current Latency: ${Math.round(this.currentLatency*t)/t} ms; `}return e}}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshSessionClosedEventArgs=void 0;const i=n(54);t.SshSessionClosedEventArgs=class{constructor(e,t,n){if(this.reason=e,this.message=t,this.error=n,!t)throw new TypeError("A disconnect message is required.")}toString(){return`${i.SshDisconnectReason[this.reason]}: ${this.message}`}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SshStream=void 0;const i=n(85),s=n(34);class r extends s.Duplex{constructor(t){let n=null;super({async write(n,i,s){let r;try{let s;if("string"==typeof n)s=e.from(n,i);else{if(!(n instanceof e))throw new Error("Unsupported chunk type: "+typeof n);s=n}await t.send(s)}catch(e){if(!(e instanceof Error))throw e;r=e}s&&s(r)},async writev(n,i){let s;try{if(1===n.length)return this.write(n[0].chunk,n[0].encoding,i);{const i=n.reduce((function(t,n){if(n.chunk instanceof e)return t+n.chunk.length;throw new Error("Unsupported chunk type: "+typeof n.chunk)}),0),s=e.alloc(i);let r=0;for(let e=0;e<n.length;e++)n[e].chunk.copy(s,r),r+=n[e].chunk.length;await t.send(s)}}catch(e){if(!(e instanceof Error))throw e;s=e}i&&i(s)},async final(e){let n;try{await t.close()}catch(e){if(!(e instanceof Error))throw e;n=e}e&&e(n)},read(){n&&(n.resolve(),n=null)}});const s=this;t.onDataReceived(async r=>{const o=e.alloc(r.length);r.copy(o),s.push(o)||(n||(n=new i.PromiseCompletionSource),await n.promise),t.adjustWindow(o.length)}),t.onClosed(()=>{s.push(null)})}}t.SshStream=r}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(64),s=n(8),r=n(106);t.RelayHubProxyServer=class{constructor(e,t,n,i){this.relayServiceProxy=e,this.hubId=t,this.logger=n,this.hostProperties=i,this.onHubJoinedEmitter=new s.Emitter,this.onParticipantJoinedEmitter=new s.Emitter,this.onHubJoined=this.onHubJoinedEmitter.event,this.onParticipantJoined=this.onParticipantJoinedEmitter.event}async acceptConnections(e){const t=this.relayServiceProxy.hubProxy,n=async()=>{t.isConnected?await this.joinHubAndAcceptConnections():this.onHubJoinedEmitter.fire(null)},i=t.onConnectionStateChanged(async()=>{try{await n()}catch(e){this.logger.error(`Failed to join hub id:${this.hubId}`,e)}});e&&e.onCancellationRequested(()=>i.dispose()),await n()}async joinHubAndAcceptConnections(){const e=this.hostProperties||{[r.PARTICIPANT_PROPERTY_IS_HOST]:!0,[r.PARTICIPANT_PROPERTY_HOST_FLAGS]:r.HostFlags.JoinReadAck},t=await this.relayServiceProxy.joinHub(this.hubId,e,{createIfNotExists:!0});this.logger.verbose(`accept connections for hub:${this.hubId} host id:${t.selfParticipant.id} on service:${t.serviceId} stamp:${t.stamp}`),this.onHubJoinedEmitter.fire(t);const n=t.onReceiveData(async e=>{e.type===r.DATA_TYPE_JOINED_READY&&(this.logger.verbose(`participant:${e.fromParticipant.id} joined for hub:${this.hubId}`),this.onParticipantJoinedEmitter.fire({relayHubProxy:t,participant:e.fromParticipant}),await t.sendData(i.SendOption.None,[e.fromParticipant.id],r.DATA_TYPE_JOINED_READY_ACK,null))}),s=t.onDisconnected(()=>(n.dispose(),s.dispose(),Promise.resolve()));return s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(15),r=n(13);t.TextSearchService=class{constructor(e,t){this.pathManager=e,this.trace=t}async getTextSearchResultsAsync(e,t){return[]}async getTextSearchResultsWithProgressAsync(e,n,o){let a=t.toVscodeQuery(e),c=t.toVscodeOptions(e),l=0,u=0,d=new i.CancellationTokenSource,h=r.Settings.get(s.SettingKeys.textSearchResultsLimit)||1e4,f=r.Settings.get(s.SettingKeys.textSearchPreviewLimit)||200;if(i.workspace.findTextInFiles)try{await i.workspace.findTextInFiles(a,c,e=>{if(l>h)return;let t=this.toVslsResults(e);for(let e=0;e<t.length;++e){let i=t[e];if(i.path){if(l++,l===h&&(i.hitResultsLimit=!0),i.text.length>f){let e=i.text;const t=100;e=i.column<t?i.text.substr(0,f):i.text.substr(i.column-t,i.column-t+f),i.text=e}n.report(i)}else u++}},d.token),this.trace.info(`Results returned: ${l}, results excluded: ${u}`)}catch(e){this.trace.error(`Problem obtaining search results on host side: ${e.message}`)}}toVslsResults(e){let n=this.pathManager.localPathToRelativePath(e.uri);return t.toVersionedVslsResults(e,n)}},t.toVscodeQuery=e=>({pattern:e.pattern||"",isRegExp:e.isRegex||!1,isCaseSensitive:e.isCaseSensitive||!1,isWordMatch:e.isWordMatch}),t.toVscodeOptions=e=>({include:e.fileIncludes&&e.fileIncludes.length>0?`{${e.fileIncludes.join(",")}}`:"",exclude:e.fileExcludes&&e.fileExcludes.length>0?`{${e.fileExcludes.join(",")}}`:"",encoding:e.encoding,useIgnoreFiles:e.includeHiddenFiles,maxResults:r.Settings.get(s.SettingKeys.textSearchResultsLimit)||1e4}),t.toVersionedVslsResults=(e,t)=>{if(e.range){let n=e;return[{path:t,text:n.preview.text,line:n.range.start.line,column:n.range.start.character,length:n.range.end.character-n.range.start.character}]}let n=e;if(Array.isArray(n.ranges)){let e=n.ranges,i=n.preview.matches,s=new Array,r=e.map(e=>({line:e.start.line,column:e.start.character,endLine:e.end.line,endColumn:e.end.character})),o=i.map(e=>({line:e.start.line,column:e.start.character,endLine:e.end.line,endColumn:e.end.character})),a={path:t,text:n.preview.text,line:e[0].start.line,column:e[0].start.character,length:e[0].end.character-e[0].start.character,ranges:r,previewRanges:o};s.push(a);for(let i=1;i<e.length;++i){let r=e[i];s.push({path:t,text:n.preview.text,line:r.start.line,column:r.start.character,length:r.end.character-r.start.character})}return s}{let e=n.ranges,i=n.preview.matches,s=[{line:e.start.line,column:e.start.character,endLine:e.end.line,endColumn:e.end.character}],r=[{line:i.start.line,column:i.start.character,endLine:i.end.line,endColumn:i.end.character}];return[{path:t,text:n.preview.text,line:e.start.line,column:e.start.character,length:e.end.character-e.start.character,ranges:s,previewRanges:r}]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(1138))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1139);t.SshRpcServer=i.SshRpcServer;var s=n(1140);t.MultiChannelRpcServer=s.MultiChannelRpcServer;var r=n(492);t.createDuplexStreams=r.createDuplexStreams;var o=n(1141);t.createDuplexMultiChannelRpcClient=o.createDuplexMultiChannelRpcClient,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(493))},function(e,t,n){"use strict";(function(e){var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(43));t.createDuplexStreams=function(){return r.createStreams()};class r extends s.BaseStream{constructor(){super()}static createStreams(){const e=new r,t=new r;return e.other=t,t.other=e,[e,t]}async write(t,n){if(!t)throw new TypeError("Data is required.");this.other.onData(e.from(t))}async close(e,t){e?(this.onError(e),this.dispose(),this.other.onError(e),this.other.dispose()):(this.dispose(),this.other.onEnd(),this.other.dispose())}dispose(){super.dispose(),this.other.isDisposed||(this.other.onError(new Error("Stream disposed.")),this.other.dispose())}}}).call(this,n(3).Buffer)},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(43)),r=n(20);t.createMultiChannelRpcClient=async function(e,t,n=!0){const i=new s.MultiChannelStream(e),r=await i.openChannel(),a=new o(i,r,t);return a.addToDisposables(i,{dispose:()=>e.close()}),n&&a.rpcConnection.listen(),a};class o extends r.RpcClient{constructor(e,t,n){super({},n),this.multiChannelStream=e;const i=new s.SshRpcMessageStream(t);this.setConnection(this.createRpcConnection(i,n))}get rpcConnection(){return this.connection}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(4),r=n(5);t.SessionStateStatusProvider=class{constructor(){this.statusChangedEvent=new i.EventEmitter,this.lastStatus=this.status,s.sessionStateTracker.onStateChanged(async e=>{this.status!==this.lastStatus&&(this.lastStatus=this.status,this.statusChangedEvent.fire(this.status))})}get id(){return"liveshare-State"}get status(){return s.sessionStateTracker.State===s.SessionState.Joined||s.sessionStateTracker.State===s.SessionState.Shared?r.contactProtocol.PresenceStatus.DoNotDisturb:r.contactProtocol.PresenceStatus.Unknown}get priority(){return 50}get onStatusChanged(){return this.statusChangedEvent.event}reset(){}}},function(e,t,n){var i=n(1167),s=n(499);e.exports=function(e){return null!=e&&s(e.length)&&!i(e)}},function(e,t,n){var i=n(497),s="object"==typeof self&&self&&self.Object===Object&&self,r=i||s||Function("return this")();e.exports=r},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(27))},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t,n){var i=n(1174),s=/^\s+/;e.exports=function(e){return e?e.slice(0,i(e)+1).replace(s,""):e}},function(e,t,n){var i=n(146),s=n(147);e.exports=function(e){return"symbol"==typeof e||s(e)&&"[object Symbol]"==i(e)}},function(e,t){e.exports=function(e,t){for(var n=-1,i=null==e?0:e.length,s=Array(i);++n<i;)s[n]=t(e[n],n,e);return s}},function(e,t,n){var i=n(292),s=n(502),r=n(293),o=n(501),a=i?i.prototype:void 0,c=a?a.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(r(t))return s(t,e)+"";if(o(t))return c?c.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.callStarted=0]="callStarted",e[e.callDisconnected=1]="callDisconnected",e[e.participantsListChanged=2]="participantsListChanged",e[e.participantChanged=3]="participantChanged"}(t.CallChangedType||(t.CallChangedType={}));t.CallChanged=class{constructor(e,t){this.changeType=e,this.info=t}},function(e){e.startOrJoinCall="_liveshareweb.callingService.startOrJoinCall",e.getCallInfo="_liveshareweb.callingService.getCallInfoCommand",e.getDevices="_liveshareweb.callingService.getDevices",e.getSelectedDevices="_liveshareweb.callingService.getSelectedDevices",e.selectDevices="_liveshareweb.callingService.selectDevices",e.getParticipants="_liveshareweb.callingService.getParticipants",e.endCall="_liveshareweb.callingService.endCall",e.isMuted="_liveshareweb.callingService.isMuted",e.mute="_liveshareweb.callingService.mute",e.unmute="_liveshareweb.callingService.unmute",e.onCallChangedEvent="_liveshareweb.callingService.onCallChangedEvent"}(t.CallingServiceProxyCommands||(t.CallingServiceProxyCommands={}))},function(e,t,n){(function(e){t.fetch=a(e.fetch)&&a(e.ReadableStream),t.writableStream=a(e.WritableStream),t.abortController=a(e.AbortController),t.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),t.blobConstructor=!0}catch(e){}var n;function i(){if(void 0!==n)return n;if(e.XMLHttpRequest){n=new e.XMLHttpRequest;try{n.open("GET",e.XDomainRequest?"/":"https://example.com")}catch(e){n=null}}else n=null;return n}function s(e){var t=i();if(!t)return!1;try{return t.responseType=e,t.responseType===e}catch(e){}return!1}var r=void 0!==e.ArrayBuffer,o=r&&a(e.ArrayBuffer.prototype.slice);function a(e){return"function"==typeof e}t.arraybuffer=t.fetch||r&&s("arraybuffer"),t.msstream=!t.fetch&&o&&s("ms-stream"),t.mozchunkedarraybuffer=!t.fetch&&r&&s("moz-chunked-arraybuffer"),t.overrideMimeType=t.fetch||!!i()&&a(i().overrideMimeType),t.vbArray=a(e.VBArray),n=null}).call(this,n(27))},function(e,t,n){(function(e,i,s){var r=n(505),o=n(12),a=n(76),c=t.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},l=t.IncomingMessage=function(t,n,o,c){var l=this;if(a.Readable.call(l),l._mode=o,l.headers={},l.rawHeaders=[],l.trailers={},l.rawTrailers=[],l.on("end",(function(){e.nextTick((function(){l.emit("close")}))})),"fetch"===o){if(l._fetchResponse=n,l.url=n.url,l.statusCode=n.status,l.statusMessage=n.statusText,n.headers.forEach((function(e,t){l.headers[t.toLowerCase()]=e,l.rawHeaders.push(t,e)})),r.writableStream){var u=new WritableStream({write:function(e){return new Promise((function(t,n){l._destroyed?n():l.push(new i(e))?t():l._resumeFetch=t}))},close:function(){s.clearTimeout(c),l._destroyed||l.push(null)},abort:function(e){l._destroyed||l.emit("error",e)}});try{return void n.body.pipeTo(u).catch((function(e){s.clearTimeout(c),l._destroyed||l.emit("error",e)}))}catch(e){}}var d=n.body.getReader();!function e(){d.read().then((function(t){if(!l._destroyed){if(t.done)return s.clearTimeout(c),void l.push(null);l.push(new i(t.value)),e()}})).catch((function(e){s.clearTimeout(c),l._destroyed||l.emit("error",e)}))}()}else{if(l._xhr=t,l._pos=0,l.url=t.responseURL,l.statusCode=t.status,l.statusMessage=t.statusText,t.getAllResponseHeaders().split(/\r?\n/).forEach((function(e){var t=e.match(/^([^:]+):\s*(.*)/);if(t){var n=t[1].toLowerCase();"set-cookie"===n?(void 0===l.headers[n]&&(l.headers[n]=[]),l.headers[n].push(t[2])):void 0!==l.headers[n]?l.headers[n]+=", "+t[2]:l.headers[n]=t[2],l.rawHeaders.push(t[1],t[2])}})),l._charset="x-user-defined",!r.overrideMimeType){var h=l.rawHeaders["mime-type"];if(h){var f=h.match(/;\s*charset=([^;])(;|$)/);f&&(l._charset=f[1].toLowerCase())}l._charset||(l._charset="utf-8")}}};o(l,a.Readable),l.prototype._read=function(){var e=this._resumeFetch;e&&(this._resumeFetch=null,e())},l.prototype._onXHRProgress=function(){var e=this,t=e._xhr,n=null;switch(e._mode){case"text:vbarray":if(t.readyState!==c.DONE)break;try{n=new s.VBArray(t.responseBody).toArray()}catch(e){}if(null!==n){e.push(new i(n));break}case"text":try{n=t.responseText}catch(t){e._mode="text:vbarray";break}if(n.length>e._pos){var r=n.substr(e._pos);if("x-user-defined"===e._charset){for(var o=new i(r.length),a=0;a<r.length;a++)o[a]=255&r.charCodeAt(a);e.push(o)}else e.push(r,e._charset);e._pos=n.length}break;case"arraybuffer":if(t.readyState!==c.DONE||!t.response)break;n=t.response,e.push(new i(new Uint8Array(n)));break;case"moz-chunked-arraybuffer":if(n=t.response,t.readyState!==c.LOADING||!n)break;e.push(new i(new Uint8Array(n)));break;case"ms-stream":if(n=t.response,t.readyState!==c.LOADING)break;var l=new s.MSStreamReader;l.onprogress=function(){l.result.byteLength>e._pos&&(e.push(new i(new Uint8Array(l.result.slice(e._pos)))),e._pos=l.result.byteLength)},l.onload=function(){e.push(null)},l.readAsArrayBuffer(n)}e._xhr.readyState===c.DONE&&"ms-stream"!==e._mode&&e.push(null)}}).call(this,n(11),n(3).Buffer,n(27))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4);t.getCollaborators=function(){return i.SessionContext.collaboratorManager?Object.values(i.SessionContext.collaboratorManager.getCollaborators()):[]},t.formatUnreadLabel=function(e,t){return`${e} ${t>0?i.localize("chat.unreadLabel").replace("$(unread)",t.toLocaleString()):""}`}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(5),r=n(1227),o=n(64),a=n(4),c=n(17),l=n(1360);function u(e,t){return{log:(n,i)=>{(!t||n>=t)&&e.log(n+1,i)}}}class d{constructor(e,t,n,d){this.authCoreService=e,this.traceSource=n,this.connectionStateChangedEmitter=new i.EventEmitter,this.attemptStateChangedEmitter=new i.EventEmitter,this.onConnectionStateChanged=this.connectionStateChangedEmitter.event,this.onAttemptStateChanged=this.attemptStateChangedEmitter.event,this.proxies=new Map,this.proxyFactories=new Map;const h=u(n,c.LogLevel.Information);let f=(new c.HubConnectionBuilder).withUrl(t,{logger:d?u(n):void 0,accessTokenFactory:()=>this.accessToken()}).configureLogging(h);f=f.withHubProtocol(new l.MessagePackHubProtocol),this.hubClientInstance=r.HubClient.createWithHub(f.build(),h),this.hubClientInstance.onConnectionStateChanged(()=>(this.traceSource.verbose(`ConnectionStateChanged isConnected:${this.isConnected}`),this.connectionStateChangedEmitter.fire(),Promise.resolve())),this.authCoreService.onAuthenticationChanged(e=>{const t=new s.vsls.AuthenticatedUserInfo;t.accessToken=e.accessToken,t.userInfo=e.account,this.setAuthenticatedUserInfo(t)}),this.proxyFactories.set(a.HubProxyType.ContactService,()=>new o.ContactServiceProxy(this.hubClientInstance.hubProxy,u(n.withName("ContactServiceProxy")),!0)),this.proxyFactories.set(a.HubProxyType.RelayService,()=>new o.RelayServiceProxy(this.hubClientInstance.hubProxy,u(n.withName("RelayServiceProxy")),!0))}static async create(e,t,n){const i=new d(e,t,n),s=await e.getCurrentAuthenticatedUserAsync();return null!=s&&i.setAuthenticatedUserInfo(s),i}setEnabled(e){return this.enabled=e,Promise.resolve()}getOrCreateProxy(e){let t;if(this.proxies.has(e))t=this.proxies.get(e);else{if(!this.proxyFactories.has(e))throw new Error(`Type:${e} not supported`);t=this.proxyFactories.get(e)(),this.proxies.set(e,t)}return t}get hubClient(){return this.hubClientInstance}get hubConnection(){return this.hubClientInstance.hubConnection}get enabled(){return this.enabledFlag}set enabled(e){this.enabledFlag!==e&&(this.enabledFlag=e,this.updateHubClientConnection())}get isConnected(){return this.hubClientInstance.isConnected}get isAttempting(){return this.hubClientInstance.isRunning}get isConnectionEnabled(){return this.shouldConnect()}get currentUserInfo(){return this.currentUserInfoInstance}shouldConnect(){return this.accessToken()&&void 0!==this.currentUserInfoInstance.userInfo}accessToken(){if(this.currentUserInfoInstance)return this.currentUserInfoInstance.accessToken}setAuthenticatedUserInfo(e){this.traceSource.verbose("setAuthenticatedUserInfo"),this.currentUserInfoInstance=e,this.updateHubClientConnection()}updateHubClientConnection(){this.shouldConnect()&&this.enabledFlag?this.enabledFlag&&this.shouldConnect()&&!this.hubClientInstance.isRunning&&(this.traceSource.verbose("updateHubClientConnection->StartAsync"),this.hubClientInstance.start(),this.fireIsAttemptingChanged()):this.hubClientInstance.isRunning&&(this.traceSource.verbose("updateHubClientConnection->StopAsync"),this.hubClientInstance.stop(),this.fireIsAttemptingChanged())}fireIsAttemptingChanged(){this.attemptStateChangedEmitter.fire()}}t.HubConnectionService=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1238);t.JoinDebugManager=i.JoinDebugManager;var s=n(1239);t.JoinDebugAdapterDescriptorFactory=s.JoinDebugAdapterDescriptorFactory;var r=n(1245);t.BreakpointManager=r.BreakpointManager;var o=n(512);t.DebugUtil=o.DebugUtil},function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){e.done?s(e.value):new n((function(t){t(e.value)})).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(74),r=n(18),o=n(1243),a=n(296);var c;!function(e){e[e.Verbose=0]="Verbose",e[e.Log=1]="Log",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.Stop=4]="Stop"}(c=t.LogLevel||(t.LogLevel={}));class l{constructor(){this._pendingLogQ=[]}log(e,t=c.Log){e+="\n",this._write(e,t)}verbose(e){this.log(e,c.Verbose)}warn(e){this.log(e,c.Warn)}error(e){this.log(e,c.Error)}dispose(){if(this._currentLogger){const e=this._currentLogger.dispose();return this._currentLogger=null,e}return Promise.resolve()}_write(e,t=c.Log){e+="",this._pendingLogQ?this._pendingLogQ.push({msg:e,level:t}):this._currentLogger&&this._currentLogger.log(e,t)}setup(e,t,n=!0){const i="string"==typeof t?t:t&&this._logFilePathFromInit;if(this._currentLogger){const t={consoleMinLogLevel:e,logFilePath:i,prependTimestamp:n};this._currentLogger.setup(t).then(()=>{if(this._pendingLogQ){const e=this._pendingLogQ;this._pendingLogQ=null,e.forEach(e=>this._write(e.msg,e.level))}})}}init(e,t,n){this._pendingLogQ=this._pendingLogQ||[],this._currentLogger=new u(e,n),this._logFilePathFromInit=t}}t.Logger=l,t.logger=new l;class u{constructor(t,n){this.beforeExitCallback=()=>this.dispose(),this._logCallback=t,this._logToConsole=n,this._minLogLevel=c.Warn,this.disposeCallback=(t,n)=>{this.dispose(),n=n||2,n+=128,e.exit(n)}}setup(e){return i(this,void 0,void 0,(function*(){if(this._minLogLevel=e.consoleMinLogLevel,this._prependTimestamp=e.prependTimestamp,e.logFilePath)if(r.isAbsolute(e.logFilePath)){const n=t=>this.sendLog(`Error creating log file at path: ${e.logFilePath}. Error: ${t.toString()}\n`,c.Error);try{yield(t=r.dirname(e.logFilePath),new Promise((e,n)=>{o(t,t=>{t?n(t):e()})})),this.log("Verbose logs are written to:\n",c.Warn),this.log(e.logFilePath+"\n",c.Warn),this._logFileStream=s.createWriteStream(e.logFilePath),this.logDateTime(),this.setupShutdownListeners(),this._logFileStream.on("error",e=>{n(e)})}catch(e){n(e)}}else this.log(`logFilePath must be an absolute path: ${e.logFilePath}`,c.Error);var t}))}logDateTime(){let e=new Date;const t=e.getUTCFullYear()+"-"+`${e.getUTCMonth()+1}`+"-"+e.getUTCDate()+", "+f();this.log(t+"\n",c.Verbose,!1)}setupShutdownListeners(){e.addListener("beforeExit",this.beforeExitCallback),e.addListener("SIGTERM",this.disposeCallback),e.addListener("SIGINT",this.disposeCallback)}removeShutdownListeners(){e.removeListener("beforeExit",this.beforeExitCallback),e.removeListener("SIGTERM",this.disposeCallback),e.removeListener("SIGINT",this.disposeCallback)}dispose(){return new Promise(e=>{this.removeShutdownListeners(),this._logFileStream?(this._logFileStream.end(e),this._logFileStream=null):e()})}log(e,t,n=!0){if(this._minLogLevel!==c.Stop){if(t>=this._minLogLevel&&this.sendLog(e,t),this._logToConsole){const n=t===c.Error?console.error:t===c.Warn?console.warn:null;n&&n(h(e))}t===c.Error&&(e=`[${c[t]}] ${e}`),this._prependTimestamp&&n&&(e="["+f()+"] "+e),this._logFileStream&&this._logFileStream.write(e)}}sendLog(e,t){if(e.length>1500){const t=!!e.match(/(\n|\r\n)$/);e=e.substr(0,1500)+"[...]",t&&(e+="\n")}if(this._logCallback){const n=new d(e,t);this._logCallback(n)}}}class d extends a.OutputEvent{constructor(e,t){super(e,t===c.Error?"stderr":t===c.Warn?"console":"stdout")}}function h(e){return e.replace(/(\n|\r\n)$/,"")}function f(){let e=new Date;return p(2,String(e.getUTCHours()))+":"+p(2,String(e.getUTCMinutes()))+":"+p(2,String(e.getUTCSeconds()))+"."+p(3,String(e.getUTCMilliseconds()))+" UTC"}function p(e,t){return t.length>=e?t:String("0".repeat(e)+t).slice(-e)}t.LogOutputEvent=d,t.trimLastNewline=h}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5);!function(e){e[e.Go="go"]="Go",e[e.StepIn="stepIn"]="StepIn",e[e.StepOut="stepOut"]="StepOut",e[e.StepOver="stepOver"]="StepOver"}(t.ContinueReason||(t.ContinueReason={})),function(e){e[e.OutputString=1]="OutputString",e[e.MessageBox=2]="MessageBox",e[e.ReasonException=256]="ReasonException",e[e.ReasonTracepoint=512]="ReasonTracepoint"}(t.MessageType||(t.MessageType={}));class s extends i.vsls.EventArgs{}t.UIDebugEventArgs=s;t.InitializeDebugSessionRequest=class{};t.InitializeDebugSessionResponse=class{},t.DebugSessionHostService={name:"",methods:["continue","handleProtocolRequest","getCurrentStoppedEvent","initializeRequest"],events:["debugEvent","uIDebugEvent"]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DebugUtil=class{static getStackTrace(e,t,n){let i=void 0;const s=e.threadId.toString();if(t.stackFrames.hasOwnProperty(s)){const n=t.stackFrames[s];let r=e.startFrame?e.startFrame:0,o=r+(e.levels?e.levels:0);const a=t=>{if(!e.levels)return o=t.totalFrames,!0;t.totalFrames&&(r=Math.min(r,t.totalFrames),o=Math.min(o,t.totalFrames));const n=t.stackFrames.length;return r<=n&&o<=n},c=n.find(t=>(!e.format&&0===Object.keys(t.key).length||e.format&&JSON.stringify(e.format)===JSON.stringify(t.key))&&a(t.value));c&&(i={stackFrames:c.value.stackFrames.slice(r,o),totalFrames:o-r})}return i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1246);t.ServerManager=i.ServerManager;var s=n(514);t.guestServerControllerFactory=s.guestServerControllerFactory;var r=n(516);t.hostServerControllerFactory=r.hostServerControllerFactory;var o=n(1276);t.portForwardingService=o.portForwardingService;var a=n(1277);t.workspaceHubPortFowardingServiceFactory=a.workspaceHubPortFowardingServiceFactory},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(238),a=n(515),c=n(7),l=n(7),u=n(4);var d;!function(e){e[e.Ignore=0]="Ignore",e[e.Open=1]="Open"}(d||(d={})),t.guestServerControllerFactory=e=>{const{controllerDecorator:t,errorNotificationMethodDecorator:n,telemetryMethodDecorator:h}=e.methodDecorators();let f=class extends(c.Activatable(c.Disposable(Object))){constructor(e){super(),this.sessionSubscriptions=[],this.browseSourcePorts=new Set,this.browsePromptSemaphore=new o.default(1),this.sharingStarted=()=>this.checkForSharedServers(),this.sharingStopped=({server:{sourcePort:e}})=>{this.browseSourcePorts.delete(e),this.checkForSharedServers()},this.checkForSharedServers=async e=>{try{console.log("checking for servers"+this.portForwardingService);const t=await this.portForwardingService.getSharedServersAsync();console.log("found servers "+t.length),this.sessionContext.hasServersShared=t.length>0&&this.isActivated,e&&this.canBrowse&&t.forEach(this.startBrowser)}catch(e){c.traceSource.error("Checking for shared servers failed: "+e)}},this.browseSharingStarted=e=>this.startBrowser(e&&e.server),this.startBrowser=async({browseUrl:e,sourcePort:t,sessionName:n})=>{if(e&&this.canBrowse&&!this.browseSourcePorts.has(t)){this.browseSourcePorts.add(t),await this.browsePromptSemaphore.acquire();try{if(!this.browseSourcePorts.has(t)||!this.canBrowse)return;if(this.browseBehavior===d.Open)return void u.ExtensionUtil.openBrowser(e);const i=u.localize("guestServerController-promtHostSharedServer").replace("$(sessionName)",n),s=u.localize("guestServerController-yes"),r=u.localize("guestServerController-no");switch(await l.NotificationUtil.showInformationMessage(i,!1,s,r)){case r:this.browseBehavior=d.Ignore;break;case s:if(this.browseBehavior=d.Open,this.browseSourcePorts.has(t))this.isActivated&&u.ExtensionUtil.openBrowser(e);else{const e=u.localize("guestServerController-serverUnshared").replace("$(sessionName)",n);await l.NotificationUtil.showWarningMessage(e)}}}catch(e){this.trace.error(`Error starting browser for ${n}: ${e.message}`)}finally{this.browsePromptSemaphore.release()}}},this.sessionContext=e.sessionContext(),this.lazyPortForwardingService=e.portForwardingService,this.trace=e.trace().withName("GuestServerController")}get canBrowse(){return u.Settings.get(u.SettingKeys.openSharedServers)&&this.browseBehavior!==d.Ignore&&this.isActivated}get portForwardingService(){return this.lazyPortForwardingService()}async dispose(){await this.deactivate(),await super.dispose()}async activate(){return!!this.isActivated||(this.isActivated=!0,this.sessionSubscriptions.push(this.portForwardingService.onSharingStarted(this.sharingStarted),this.portForwardingService.onSharingStopped(this.sharingStopped),this.portForwardingService.onBrowseSharingStarted(this.browseSharingStarted)),u.ControllerHelper.register(this,this.sessionSubscriptions),this.checkForSharedServers(!0),await super.activate())}deactivate(){return this.sessionSubscriptions.splice(0).forEach(e=>e.dispose()),super.deactivate()}async getBrowseUrl(e){let t=e.browseUrl||`http://localhost:${e.destinationPort}`;return"function"==typeof r.env.asExternalUri&&(t=(await r.env.asExternalUri(r.Uri.parse(t))).toString()),t}async openServerInBrowser(e){if(!e||null==e.port)return;const t=(await this.portForwardingService.getSharedServersAsync()).find(t=>t.destinationPort===e.port);if(t){const e=await this.getBrowseUrl(t);u.ExtensionUtil.openBrowser(e)}}async copyServerURL(e){if(!e||null==e.port)return;const t=(await this.portForwardingService.getSharedServersAsync()).find(t=>t.destinationPort===e.port);if(t){const e=await this.getBrowseUrl(t);await(new u.ClipboardUtil).copyToClipboardAsync(e)?await l.NotificationUtil.showInformationMessage("The server URL was copied to the clipboard.",!1):await l.NotificationUtil.showInputBox({value:e})}}async listForwardedPorts(e){a.PortForwardingTelemetry.listSharedLocalServers(e);const t=await this.portForwardingService.getSharedServersAsync();if(0===t.length)return void await l.NotificationUtil.showInformationMessage("No ports are currently shared.",!1,{modal:!1});let n=-1;if(1===t.length)n=0;else{const e=t.map(e=>e.sessionName===`localhost:${e.destinationPort}`?e.sessionName:`${e.sessionName} mapped to localhost:${e.destinationPort}`),i=await l.NotificationUtil.showQuickPick(e,{placeHolder:"Select the port to copy to the clipboard."});if(!i)return;n=e.indexOf(i)}if(n>=0){const e=t[n],i=await this.getBrowseUrl(e),s=new u.ClipboardUtil;if(await s.copyToClipboardAsync(i)){await l.NotificationUtil.showInformationMessage("The server URL was copied to the clipboard.",!1,{},{title:"Copy again"})&&await s.copyToClipboardAsync(i)}else await l.NotificationUtil.showInputBox({value:i})}}};return i([n("Opening Server in Browser",u.TelemetryEventNames.BROWSE_SERVER_FAULT),h(u.TelemetryEventNames.BROWSE_SERVER,u.TelemetryEventNames.BROWSE_SERVER_FAULT,"OpenServerInBrowser"),u.commandBindingDecorator("liveshare.fileTreeExplorer.openServerInBrowser"),u.commandBindingDecorator("liveshare.activityBar.openServerInBrowser"),s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Promise)],f.prototype,"openServerInBrowser",null),i([n("Copying Server URL",u.TelemetryEventNames.COPY_URL_SERVER_FAULT),h(u.TelemetryEventNames.COPY_URL_SERVER,u.TelemetryEventNames.COPY_URL_SERVER_FAULT,"CopyServerURL"),u.commandBindingDecorator("liveshare.fileTreeExplorer.copyServerURL"),u.commandBindingDecorator("liveshare.activityBar.copyServerURL"),s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Promise)],f.prototype,"copyServerURL",null),i([n("Listing Servers",u.TelemetryEventNames.LIST_SERVERS_FAULT),h(u.TelemetryEventNames.LIST_SERVERS,u.TelemetryEventNames.LIST_SERVERS_FAULT,"ListServers"),u.commandBindingDecorator("liveshare.listServers"),s("design:type",Function),s("design:paramtypes",[Number]),s("design:returntype",Promise)],f.prototype,"listForwardedPorts",null),f=i([t,s("design:paramtypes",[Object])],f),new f(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(9),s=n(4);class r{static listSharedLocalServers(e){r.sendEvent(o.LIST_SHARED_LOCAL_SERVERS,e)}static shareServer(e,t){r.sendEvent(o.SHARE_SERVER,t,e)}static unshareServer(e,t){r.sendEvent(o.UNSHARE_SERVER,t,e)}static sendEvent(e,t,n){const s=new i.TelemetryEvent(e);n&&s.addProperty(a.SOURCE_PORT,n.toString()),s.send()}static configure(){r.configured||(r.configured=!0,i.Telemetry.addFilter(new i.SendOnceFilter(o.AUTO_DETECT_SERVER,[a.SOURCE_PORT])))}static autoDetectServer(e,t){const n=new i.TelemetryEvent(o.AUTO_DETECT_SERVER);n.addProperty(a.SOURCE_PORT,e.toString()),n.send()}}t.PortForwardingTelemetry=r,r.FEATURE_PREFIX="portforwarding/",r.PROPERTY_PREFIX=s.TelemetryPropertyNames.FEATURE_NAME+"portforwarding.",r.configured=!1;class o{}o.LIST_SHARED_LOCAL_SERVERS=r.FEATURE_PREFIX+"list-shareLocalServers",o.SHARE_SERVER=r.FEATURE_PREFIX+"share-server",o.UNSHARE_SERVER=r.FEATURE_PREFIX+"unshare-server",o.AUTO_DETECT_SERVER=r.FEATURE_PREFIX+"auto-detect-server";class a{}a.ORIGIN=r.PROPERTY_PREFIX+"Origin",a.SOURCE_PORT=r.PROPERTY_PREFIX+"SourcePort",a.SERVER_URL=r.PROPERTY_PREFIX+"ServerUrl"},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(32),a=n(515),c=n(7),l=n(517),u=n(4);function d(e){return void 0!==e&&void 0!==e.fullName}const h=/\b\w{2,20}:\/\/(?:localhost|127\.0\.0\.1|0\.0\.0\.0|:\d{2,5})[\w\-\.\~:\/\?\#[\]\@!\$&\(\)\*\+\,\;\=]*/gim;t.hostServerControllerFactory=e=>{var t;const{controllerDecorator:n,telemetryMethodDecorator:f,errorNotificationMethodDecorator:p}=e.methodDecorators();let m=t=class extends(c.Activatable(c.Disposable(Object))){constructor(e){super(),this.registrations=[],this.sessionSubscriptions=[],this.serverModels=new Map,this.deferredWork=Promise.resolve(!0),this.trace=c.traceSource.withName("HostServerController"),this.sessionContext=e.sessionContext(),this.serverSharingService=e.serverSharingService(),t.shouldAutoShareServers&&this.deferWork(()=>this.launchDataScraper()),r.workspace.onDidChangeConfiguration(e=>{e.affectsConfiguration("liveshare.autoShareServers")&&(t.shouldAutoShareServers?this.dataScraper||this.deferWork(()=>this.launchDataScraper()):this.dataScraper&&(this.dataScraper.dispose(),this.dataScraper=void 0))},this.registrations),a.PortForwardingTelemetry.configure()}static get shouldAutoShareServers(){return u.Settings.get(u.SettingKeys.autoShareServers)}async dispose(){await this.deferredWork,await this.deactivate(),this.registrations.splice(0).forEach(e=>e.dispose()),this.dataScraper&&this.dataScraper.dispose(),await super.dispose()}async activate(){if(this.isActivated)return!0;if(this.sessionSubscriptions.push(this.serverSharingService.onSharingStarted(e=>{const t=e.server;this.serverModels.set(t.sourcePort,{port:t.sourcePort,displayName:t.sessionName,browseUrl:t.browseUrl,isShared:!0}),this.deferWork(()=>this.checkForSharedServers())}),this.serverSharingService.onSharingStopped(e=>{const t=this.serverModels.get(e.server.sourcePort);t&&(t.isShared=!1),this.deferWork(()=>this.checkForSharedServers())})),u.ControllerHelper.register(this,this.sessionSubscriptions),t.shouldAutoShareServers){const e=[...this.serverModels.entries()].map(e=>{const[t,n]=e;return this.startSharingServer(t,n.displayName,n.browseUrl)});this.deferWork(()=>Promise.all(e))}return await super.activate()}async deactivate(){return await this.deferredWork,this.sessionSubscriptions.splice(0).forEach(e=>e.dispose()),this.serverModels.clear(),super.deactivate()}deferWork(e){this.deferredWork=this.deferredWork.then(e).catch(e=>{this.trace.error(e.message)})}async launchDataScraper(){if(!this.dataScraper)try{this.dataScraper=await c.launchUrlScraper(e=>{const t=[3e3,8080,4200,80,5e3,8e3,5500,3001,8081,4e3,9e3,8888,443,5001,8082,9090,7071];this.serverModels.has(e.port)||t.includes(e.port)&&(this.serverModels.set(e.port,e),this.isActivated&&this.deferWork(()=>this.startSharingServer(e.port,e.displayName,e.browseUrl))),a.PortForwardingTelemetry.autoDetectServer(e.port,e.browseUrl)})}catch(e){this.trace.warning(e.message)}}async checkForSharedServers(){try{const e=await this.serverSharingService.getSharedServersAsync();this.sessionContext.hasServersShared=e.length>0}catch(e){c.traceSource.error("Checking for shared servers failed: "+e)}}async shareServer(e,n){const i=await this.serverSharingService.getSharedServersAsync(),s=i.map(e=>e.sourcePort);if(d(e)){const{port:i,displayName:r,browseUrl:o}=u.Requires.NotNullOrUndefined(n,"server");if(u.Requires.Argument(!isNaN(i)&&Number.isInteger(i)&&i>0&&i<=65535,"port","The port number must be an integer in range 1 - 65535"),s.includes(i))return;let a;if(t.shouldAutoShareServers&&l.hasPermissionForExtension(e,"autoShareServers"))a=!0;else{const t=e.displayName||e.name,n={id:1,title:"Allow"},s=await c.NotificationUtil.showInformationMessage(`${t} would like to share port ${i}.`,!1,{},n);a=s&&s.id===n.id}a&&await this.serverSharingService.startSharingAsync(i,r,o)}else{const t=await c.NotificationUtil.showInputBox({prompt:"Enter the TCP port or server URL to share with guests.",ignoreFocusOut:!0,validateInput:function(e){if(!e)return null;const t="number"==typeof e?e:parseFloat(e);if(!isNaN(t)&&Number.isInteger(t)){if(t<=0||t>65535)return"The port number must be an integer in range 1 - 65535";const e=i.find(e=>e.sourcePort===t);return e?`Port ${t} is already being shared${e.sessionName===`localhost:${e.sourcePort}`?"":` as '${e.sessionName}'`}.`:null}if("string"==typeof e){const t=e.match(h);if(t&&t[0]&&t[0]===e){if(o.parse(t[0]))return null}return"The specified value must be a valid TCP port or server URL."}return null}});if(!t)return;let n,s;const r=t.match(h);if(r&&r[0]){const e=o.parse(r[0]);n=parseInt(e.port,10)||80,s=o.format(e)}else n=parseFloat(t);const l=await c.NotificationUtil.showInputBox({value:`localhost:${n}`,prompt:"[Optional] Provide a display name for the shared server.",ignoreFocusOut:!0});await this.startSharingServer(n,l||`localhost:${n}`,s),a.PortForwardingTelemetry.shareServer(n,e)}}async startSharingServer(e,t,n){const i=await this.serverSharingService.startSharingAsync(e,t,n),s=i.sessionName===`localhost:${e}`?"":` as '${i.sessionName}'`;return c.NotificationUtil.showInformationMessage(`Shared port ${e}${s}.`,!0,{modal:!1}),i}async unshareServer(e,t){const n=await this.serverSharingService.getSharedServersAsync(),i=e=>`localhost:${e.sourcePort}`+(e.sessionName===`localhost:${e.sourcePort}`?"":` shared as '${e.sessionName}'.`);let s;if(d(e))u.Requires.NotNullOrUndefined(t,"server"),s=n.find(e=>e.sourcePort===t.port);else{if(0===n.length)return void await c.NotificationUtil.showInformationMessage("No ports are currently shared.",!1,{modal:!1});if(1===n.length)s=n[0];else{const e=n.map(i);e.unshift("<All Shared Ports>");const t=await c.NotificationUtil.showQuickPick(e,{placeHolder:"Pick the port to stop sharing."});if(!t)return;const r=e.indexOf(t);if(r<0)return;s=r>0?n[r-1]:null}}if(s)await this.serverSharingService.stopSharingAsync(s.sourcePort),a.PortForwardingTelemetry.unshareServer(s.sourcePort,e),await c.NotificationUtil.showInformationMessage(`Stopped sharing port ${s.sourcePort}.`,!0,{modal:!1});else if(void 0!==s){for(s of n)await this.serverSharingService.stopSharingAsync(s.sourcePort),a.PortForwardingTelemetry.unshareServer(s.sourcePort,e);await c.NotificationUtil.showInformationMessage("Stopped sharing all ports.",!1,{modal:!1})}}async unshareServerBySourcePort(e){e&&null!=e.port&&(await this.serverSharingService.stopSharingAsync(e.port),await c.NotificationUtil.showInformationMessage(`Stopped sharing port ${e.port}.`,!0))}async openSharedServerInBrowser(e){if(!e||null==e.port)return;const t=(await this.serverSharingService.getSharedServersAsync()).find(t=>t.sourcePort===e.port);if(t){const e=t.browseUrl||`http://localhost:${t.sourcePort}`;u.ExtensionUtil.openBrowser(e)}}async copySharedServerURL(e){if(!e||null==e.port)return;const t=(await this.serverSharingService.getSharedServersAsync()).find(t=>t.sourcePort===e.port);if(t){const e=t.browseUrl||`http://localhost:${t.sourcePort}`;await(new u.ClipboardUtil).copyToClipboardAsync(e)?await c.NotificationUtil.showInformationMessage("The server URL was copied to the clipboard.",!1):await c.NotificationUtil.showInputBox({value:e})}}async listSharedPorts(e){a.PortForwardingTelemetry.listSharedLocalServers(e);const t=await this.serverSharingService.getSharedServersAsync();if(0===t.length)return void await c.NotificationUtil.showInformationMessage("No ports are currently shared.",!1,{modal:!1});const n=t.map(e=>`Port ${e.sourcePort}`+(e.sessionName===`localhost:${e.sourcePort}`?"":` shared as '${e.sessionName}'`));await c.NotificationUtil.showQuickPick(n,{placeHolder:"The following ports are shared."})}};return i([p("Sharing Server",u.TelemetryEventNames.SHARE_SERVER_FAULT),f(u.TelemetryEventNames.SHARE_SERVER,u.TelemetryEventNames.SHARE_SERVER_FAULT,"ShareServer"),u.commandBindingDecorator("liveshare.shareServer"),u.commandBindingDecorator("liveshare.fileTreeExplorer.shareServer"),u.commandBindingDecorator("liveshare.activityBar.shareServer"),s("design:type",Function),s("design:paramtypes",[Object,Object]),s("design:returntype",Promise)],m.prototype,"shareServer",null),i([p("Unsharing Server",u.TelemetryEventNames.UNSHARE_SERVER_FAULT),f(u.TelemetryEventNames.UNSHARE_SERVER,u.TelemetryEventNames.UNSHARE_SERVER_FAULT,"UnshareServer"),u.commandBindingDecorator("liveshare.unshareServer"),s("design:type",Function),s("design:paramtypes",[Object,Object]),s("design:returntype",Promise)],m.prototype,"unshareServer",null),i([p("Unsharing Server",u.TelemetryEventNames.UNSHARE_SERVER_FAULT),f(u.TelemetryEventNames.UNSHARE_SERVER,u.TelemetryEventNames.UNSHARE_SERVER_FAULT,"UnshareServer"),u.commandBindingDecorator("liveshare.fileTreeExplorer.unshareServer"),u.commandBindingDecorator("liveshare.activityBar.unshareServer"),s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Promise)],m.prototype,"unshareServerBySourcePort",null),i([p("Opening Server in Browser",u.TelemetryEventNames.BROWSE_SERVER_FAULT),f(u.TelemetryEventNames.BROWSE_SERVER,u.TelemetryEventNames.BROWSE_SERVER_FAULT,"OpenServerInBrowser"),u.commandBindingDecorator("liveshare.fileTreeExplorer.openServerInBrowser"),u.commandBindingDecorator("liveshare.activityBar.openServerInBrowser"),s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Promise)],m.prototype,"openSharedServerInBrowser",null),i([p("Copying Server URL",u.TelemetryEventNames.COPY_URL_SERVER_FAULT),f(u.TelemetryEventNames.COPY_URL_SERVER,u.TelemetryEventNames.COPY_URL_SERVER_FAULT,"CopyServerURL"),u.commandBindingDecorator("liveshare.fileTreeExplorer.copyServerURL"),u.commandBindingDecorator("liveshare.activityBar.copyServerURL"),s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Promise)],m.prototype,"copySharedServerURL",null),i([p("Listing Servers",u.TelemetryEventNames.LIST_SERVERS_FAULT),f(u.TelemetryEventNames.LIST_SERVERS,u.TelemetryEventNames.LIST_SERVERS_FAULT,"listServers"),u.commandBindingDecorator("liveshare.listServers"),s("design:type",Function),s("design:paramtypes",[Number]),s("design:returntype",Promise)],m.prototype,"listSharedPorts",null),m=t=i([n,s("design:paramtypes",[Object])],m),new m(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(518);t.hasPermissionForExtension=i.hasPermissionForExtension;var s=n(519);t.getPackageInfo=s.getPackageInfo;var r=n(298);t.ExtensionContributions=r.ExtensionContributions;var o=n(520);t.LiveShareExtensionApiBase=o.LiveShareExtensionApiBase,t.LiveShareApi=o.LiveShareApi;var a=n(521);t.SharedServiceApi=a.SharedServiceApi,t.SharedServiceResponseError=a.SharedServiceResponseError;const c=n(1274);t.LiveShareExtensionApi=c.LiveShareExtensionApi;var l=n(1275);t.StatusbarQuickPickItemsProvider=l.StatusbarQuickPickItemsProvider},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(62),r=n(4),o=new Set(["authStrategies"]);Object.defineProperty(o,"has",{configurable:!1,enumerable:!1,writable:!1,value:Set.prototype.has.bind(o)}),t.getPermissionsForExtension=e=>{const t=r.Settings.get(r.SettingKeys.extensionPermissions);return t?t[e.fullName]||t[`${e.publisher}.*`]:null};const a=(e,t=[])=>{null===t&&(t=[]);const n=o.has(e)?t.indexOf("**")>=0:t.indexOf("*")>=0||t.indexOf("**")>=0;return Array.isArray(t)&&(t.indexOf(e)>=0||n)};t.hasPermissionForExtension=(e,n)=>{const c=i.extensions.getExtension(s.extensionId).packageJSON.publisher;if(e.publisher===c)return!0;if(r.featureFlags.api)return!0;const l=t.getPermissionsForExtension(e);return"**"===l||(o.has(n)?a(n,l):"*"===l||a(n,l))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPackageInfo=function(e){return Object.freeze({fullName:`${e.publisher||"unknown"}.${e.name}`,name:e.name,displayName:e.displayName,version:e.version,publisher:e.publisher,contributes:e.contributes})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(67),s=n(0),r=n(4),o=n(5),a=n(62),c=n(9),l=n(4),u=n(107),d=n(521),h=n(1247),f=n(522),p=n(298),m=n(7),g=n(19),y=n(518),v=n(1248),S=n(1249),_=n(167);let E;class w{constructor(e){this.liveShareApis=[],this.supportedApiVersionRange=">=0.3.0 <1.1.0",E=e,w.trace||(w.trace=m.traceSource.withName(o.vsls.TraceSources.API))}async getApi(e,t){f.default(e,"requestedApiVersion","string");const n=v.default();E.apiPromise&&await E.apiPromise;const i=await this.getCallingPackage(n,t);return i?await this.getApiInternal(i,e):(w.trace.warning("Live Share API request failed because calling package could not be detected."),null)}getApiAsync(e){return this.getApi(e)}async getApiInternal(e,t){const n=s.extensions.getExtension(a.extensionId).packageJSON.version;if(!t.endsWith("-placeholder")&&!i.satisfies(t.split("-")[0],this.supportedApiVersionRange)&&!i.eq(t,n))return w.trace.warning(`Package ${e.fullName}@${e.version} requested`+` Live Share API version ${t} that is not supported.`),null;if("-"===y.getPermissionsForExtension(e))return w.trace.warning(`Package ${e.fullName} is blocked.`),null;const r=this.createLiveShareApi(e,t,w.trace,E.authStrategies);return this.liveShareApis.push(r),r}createLiveShareApi(e,t,n,i){return new b(e,t,n,i)}}t.LiveShareExtensionApiBase=w;class b{constructor(e,t,n,i){var o,c;this.callingPackage=e,this.apiVersion=t,this.trace=n,this.sessionChangeEmitter=new s.EventEmitter,this.currentPeers=[],this.peersChangeEmitter=new s.EventEmitter,this.presenceProviderRegisteredEmitter=new s.EventEmitter,this.activityEmitter=new s.EventEmitter,this.sharedServices={},this.serviceProxies={},f.default(e,"callingPackage","object"),f.default(t,"apiVersion","string"),Object.defineProperty(this,"callingPackage",{enumerable:!1,configurable:!1,writable:!1,value:this.callingPackage}),n.info(`Initializing Live Share API ${t} for `+`${e.fullName}@${e.version}`),this.sendActivatedTelemetryEvent();const d=l.workspaceSessionInfoTracker.workspaceSessionInfo;this.session={peerNumber:d?d.sessionNumber:0,user:null,role:b.getSessionRole(l.sessionStateTracker.State),access:b.getSessionAccess(l.sessionStateTracker.State),id:d?d.id:null,presentationMode:null!==(c=null===(o=null===l.workspaceSessionInfoTracker||void 0===l.workspaceSessionInfoTracker?void 0:l.workspaceSessionInfoTracker.workspaceSessionInfo)||void 0===o?void 0:o.isPresentation)&&void 0!==c&&c},this.onSignedIn(),l.sessionStateTracker.onStateChanged(e=>this.onSessionStateChanged(e.newState)),E.workspaceService.onServicesChanged(e=>this.onServicesChanged(e)),E.workspaceUserService.onWorkspaceSessionChanged(e=>this.onUserSessionChanged(e)),Object.defineProperty(this,"authStrategies",{enumerable:!1,configurable:!1,set:function(){},get:function(){if(this.hasPermission("authStrategies"))return i}}),u.ContactManager.addListener(l.ContactManagerEvents.ProviderAdded,e=>{this.presenceProviderRegisteredEmitter.fire({added:b.toPresenceProvider(e)})});const h=this;this.services={get guestChannelService(){if(h.session.role===a.Role.Guest)return E.guestChannelService},getRemoteServiceBroker:async()=>h.session.role!==a.Role.Guest?null:(h.hostServiceBroker||(h.hostServiceBroker=r.lazyLoad(()=>S.getRemoteServiceBrokerFromHost(E.client,E.guestChannelService,n))),await h.hostServiceBroker())},_.activitySource.onActivity(e=>{const t=Object.assign({},e);t.data&&("number"==typeof t.data.peer?t.data.peer=this.getPeer(t.data.peer):Array.isArray(t.data.peers)&&"number"==typeof t.data.peers[0]&&(t.data.peers=t.data.peers.map(e=>this.getPeer(e)))),this.activityEmitter.fire(t)})}async getPeerForTextDocumentChangeEvent(e){var t;const n=await(null===(t=l.SessionContext.coeditingClient)||void 0===t?void 0:t.getClientIdForTextDocumentChangeEvent(e));return void 0===n?this.session:this.getPeer(n)}getPeer(e){return e===this.session.peerNumber?this.session:this.peers.find(t=>t.peerNumber===e)||{peerNumber:e,user:void 0,role:void 0,access:void 0}}get onDidChangeSession(){return this.sessionChangeEmitter.event}get onActivity(){return this.activityEmitter.event}get peers(){return this.currentPeers.slice(0)}get presenceProviders(){return u.ContactManager.serviceProviders.map(e=>b.toPresenceProvider(e))}static toPresenceProvider(e){return{serviceId:e.serviceId,capabilites:e.capabilites,selfContact:e.selfUser?new h.ContactApi(E.contactManager,e.selfUser):null,provider:e.contactServiceProvider}}get onDidChangePeers(){return this.peersChangeEmitter.event}get onPresenceProviderRegistered(){return this.presenceProviderRegisteredEmitter.event}async share(e){if(this.session.role===a.Role.Guest)throw new Error("Cannot share while joined to another session.");if(this.session.role===a.Role.Host&&e&&e.access)throw new Error("Cannot change default access for an already shared session.");const t=e&&e.access===a.Access.ReadOnly?"liveshare.startReadOnly":"liveshare.start";return this.sendInvokeCommandTelemetryEvent(t,e),await s.commands.executeCommand(t,e)}async join(e,t){if(f.default(e,"link","uri"),this.session.role!==a.Role.None)throw new Error("A session is already active.");this.sendInvokeCommandTelemetryEvent("liveshare.join",t),await s.commands.executeCommand("liveshare.join",Object.assign(Object.assign({},t),{link:e}))}async end(){if(this.session.role===a.Role.Guest){const e="liveshare.leave";this.sendInvokeCommandTelemetryEvent(e),await s.commands.executeCommand(e)}else if(this.session.role===a.Role.Host){const e="liveshare.end";this.sendInvokeCommandTelemetryEvent(e),await s.commands.executeCommand(e)}}async shareServer(e){if(f.default(e,"server","object"),this.session.role!==a.Role.Host)throw new Error("Host collaboration session doesn't exist.");return this.sendInvokeCommandTelemetryEvent("liveshare.shareServer",e),await s.commands.executeCommand("liveshare.shareServer",this.callingPackage,e),new s.Disposable(()=>{this.sendInvokeCommandTelemetryEvent("liveshare.unshareServer",e),s.commands.executeCommand("liveshare.unshareServer",this.callingPackage,e)})}async shareService(e){f.default(e,"name","string");const t=this.hasPermission("shareServices");if(this.sendShareServiceTelemetryEvent(e,t),!t)return this.trace.warning(`shareService(${e}) not permitted.`),null;e=this.callingPackage.fullName+"."+e,this.trace.verbose(`shareService(${e})`);let n=this.sharedServices[e];if(!n){const t=await E.client.ensureConnectionAsync();if(n=new d.SharedServiceApi(e,t,this.trace),this.sharedServices[e]=n,this.session.role===a.Role.Host){try{await E.workspaceService.registerServicesAsync([e],o.vsls.CollectionChangeType.Add)}catch(e){throw this.trace.error(e),e}n._isServiceAvailable=!0,n._fireIsAvailableChange()}}return n}async unshareService(e){f.default(e,"name","string"),e=this.callingPackage.fullName+"."+e,this.trace.verbose(`unshareService(${e})`);const t=this.sharedServices[e];if(t&&t.isServiceAvailable){try{await E.workspaceService.registerServicesAsync([e],o.vsls.CollectionChangeType.Remove)}catch(e){throw this.trace.error(e),e}t._isServiceAvailable=!1,t._fireIsAvailableChange()}delete this.sharedServices[e]}async getSharedService(e){f.default(e,"name","string"),e.indexOf(".")<0&&(e=this.callingPackage.fullName+"."+e),this.trace.verbose(`getSharedService(${e})`);let t=this.serviceProxies[e];if(!t){const n=await E.client.ensureConnectionAsync();t=new d.SharedServiceApi(e,n,this.trace),this.serviceProxies[e]=t,this.session.role===a.Role.Guest&&E.workspaceServices.registeredServices.has(e)&&(t._isServiceAvailable=!0)}return t}convertLocalUriToShared(e){if(f.default(e,"localUri","uri"),this.session.role!==a.Role.Host)throw new Error("Only the host role can convert shared URIs.");const t=l.Settings.scheme;if(e.scheme===t)throw new Error(`URI is already a ${t} URI: ${e}`);const n=E.pathManager.code2protocolWorkspaceFilesOnly(e);if(!n)throw new Error(`URI was not part of a workspace: ${e}`);return n}convertSharedUriToLocal(e){if(f.default(e,"sharedUri","uri"),this.session.role!==a.Role.Host)throw new Error("Only the host role can convert shared URIs.");const t=l.Settings.scheme;if(e.scheme!==t)throw new Error(`Not a ${l.Settings.get(l.SettingKeys.shortName)} shared URI: ${e}`);return E.pathManager.protocolUri2CodeUriConverter(e)}registerCommand(e,t,n){return this.hasPermission("contributeCommands")?p.ExtensionContributions.getContributions(this.callingPackage,this.trace).registerCommand(e,t,n):(this.trace.warning(`registerCommand(${e}) not permitted.`),null)}registerTreeDataProvider(e,t){const n=E.treeViews[e];return n?n.registerTreeDataProvider(t):null}registerContactServiceProvider(e,t){this.trace.info(`Register contact service provier with name: ${e}`);const n=E.contactManager;return n?n.registerContactProvider(e,t):null}async registerPolicyProvider(e,t){return null}getContacts(e){return this.trace.info(`Request contacts for emails: ${e.map(g.TraceFormat.formatEmail).join()}`),h.ContactApi.getContacts(E.contactManager,e)}postActivity(e){_.activitySource.fire(e)}static getSessionRole(e){return e===l.SessionState.Shared?a.Role.Host:e===l.SessionState.Joined?a.Role.Guest:a.Role.None}static getSessionAccess(e){return e===l.SessionState.Shared?a.Access.Owner:e===l.SessionState.Joined?a.Access.ReadWrite:a.Access.None}async onSessionStateChanged(e){const t=b.getSessionRole(e);if(this.session.user||t===a.Role.None&&e!==l.SessionState.SignedIn?this.session.user&&e===l.SessionState.SignedOut&&this.onSignedOut():this.onSignedIn(),t===this.session.role)return;this.session.role=t;let n=null;const i=[];t===a.Role.Host?n=await this.onShared(i):t===a.Role.Guest?n=await this.onJoined(i):(n=await this.onEnded(i),this.hostServiceBroker=void 0),this.trace.verbose(`^onDidChangeSession(${a.Role[t]})`),this.sessionChangeEmitter.fire({session:this.session}),n&&(this.trace.verbose(`^onDidChangePeers(${b.formatPeersChangeEvent(n)})`),this.peersChangeEmitter.fire(n));for(const e of i)e._fireIsAvailableChange()}onSignedIn(){this.hasPermission("readUserProfile")&&(this.session.user=l.userAuthStateTracker.userInfo&&{displayName:l.userAuthStateTracker.userInfo.displayName,emailAddress:l.userAuthStateTracker.userInfo.emailAddress,userName:l.userAuthStateTracker.userInfo.userName,id:l.userAuthStateTracker.userInfo.id})}onSignedOut(){this.session.user=null}async onShared(e){var t;const n=Object.keys(this.sharedServices);if(n.length>0){try{await E.workspaceService.registerServicesAsync(n,o.vsls.CollectionChangeType.Add)}catch(e){this.trace.error(e)}for(let t of n)this.sharedServices[t]._isServiceAvailable=!0,e.push(this.sharedServices[t])}const i=l.workspaceSessionInfoTracker.workspaceSessionInfo,r=this.session;return r.peerNumber=i.sessionNumber,r.access=b.getSessionAccess(l.SessionState.Shared),r.id=i.id||null,this.activityEmitter.fire({timestamp:new Date,name:`${a.ActivityType.session}/share`,data:{peer:this.session,files:null===(t=s.workspace.workspaceFolders)||void 0===t?void 0:t.map(e=>e.uri)}}),null}async onJoined(e){var t;for(let t of Object.keys(this.serviceProxies))if(E.workspaceServices.registeredServices.has(t)){const n=this.serviceProxies[t];n._isServiceAvailable=!0,e.push(n)}const n=l.workspaceSessionInfoTracker.workspaceSessionInfo,i=this.session;i.peerNumber=n.sessionNumber,i.access=b.getSessionAccess(l.sessionStateTracker.State),i.id=n.id||null;const r=this.hasPermission("readUserProfile");if(n.sessions&&Object.keys(n.sessions).length>0){const e=[];for(let t of Object.keys(n.sessions)){const i=parseInt(t,10);if(i!==n.sessionNumber){const s=n.sessions[t],o=r?{displayName:s.name,emailAddress:s.email,userName:s.userName,id:s.id}:null;e.push({peerNumber:i,user:o,role:s.isHost?a.Role.Host:a.Role.Guest,access:s.isOwner?a.Access.Owner:a.Access.ReadWrite})}}if(this.activityEmitter.fire({timestamp:new Date,name:`${a.ActivityType.session}/join`,data:{peers:[this.session,...e],files:null===(t=s.workspace.workspaceFolders)||void 0===t?void 0:t.map(e=>e.uri)}}),e.length>0)return this.currentPeers.push(...e),{added:e,removed:[]}}return null}async onEnded(e){for(let t of Object.keys(this.serviceProxies)){const n=this.serviceProxies[t];n.isServiceAvailable&&(n._isServiceAvailable=!1,e.push(n))}for(let t of Object.keys(this.sharedServices)){const n=this.sharedServices[t];n.isServiceAvailable&&(n._isServiceAvailable=!1,e.push(n))}const t=this.session;return t.peerNumber=0,t.access=b.getSessionAccess(l.sessionStateTracker.State),t.id=null,this.currentPeers.length>0?{added:[],removed:this.currentPeers.splice(0,this.currentPeers.length)}:null}onServicesChanged(e){const t=e.serviceNames.filter(e=>e.indexOf(".")>=0);if(e.changeType===o.vsls.CollectionChangeType.Add)for(let e of t){const t=this.serviceProxies[e];t&&!t.isServiceAvailable&&this.session.role===a.Role.Guest&&(t._isServiceAvailable=!0,t._fireIsAvailableChange())}else if(e.changeType===o.vsls.CollectionChangeType.Remove)for(let e of t){const t=this.serviceProxies[e];t&&t.isServiceAvailable&&(t._isServiceAvailable=!1,t._fireIsAvailableChange())}}onUserSessionChanged(e){if(e.sessionNumber!==this.session.peerNumber)if(e.changeType===o.vsls.WorkspaceSessionChangeType.Joined){const t=this.hasPermission("readUserProfile")?{displayName:e.userProfile.name,emailAddress:e.userProfile.email,userName:e.userProfile.userName,id:e.userProfile.id}:null,n={peerNumber:e.sessionNumber,user:t,role:a.Role.Guest,access:a.Access.ReadWrite};this.currentPeers.push(n);const i={added:[n],removed:[]};this.trace.verbose(`^onDidChangePeers(${b.formatPeersChangeEvent(i)}`),this.peersChangeEmitter.fire(i),this.activityEmitter.fire({timestamp:new Date,name:`${a.ActivityType.session}/guestJoin`,data:{peer:n}})}else if(e.changeType===o.vsls.WorkspaceSessionChangeType.Unjoined){const t=this.currentPeers.findIndex(t=>t.peerNumber===e.sessionNumber);if(t>=0){const e=this.currentPeers.splice(t,1)[0],n={added:[],removed:[e]};this.trace.verbose(`^onDidChangePeers(${b.formatPeersChangeEvent(n)}`),this.peersChangeEmitter.fire(n),this.activityEmitter.fire({timestamp:new Date,name:`${a.ActivityType.session}/guestLeave`,data:{peer:e}})}}}static formatPeersChangeEvent(e){let t="";return e.added.length>0&&(t+="added: "+e.added.map(b.formatPeer).join(", ")),e.removed.length>0&&(t+=(t?"; ":"")+"removed: "+e.removed.map(b.formatPeer).join(", ")),t}static formatPeer(e){const t=e.user&&e.user.emailAddress;return`#${e.peerNumber} ${a.Role[e.role]}`+(t?" "+g.TraceFormat.formatEmail(t):"")}hasPermission(e){return y.hasPermissionForExtension(this.callingPackage,e)}sendActivatedTelemetryEvent(){c.Telemetry.sendTelemetryEvent(l.TelemetryEventNames.ACTIVATE_EXTENSION_API,{[l.TelemetryPropertyNames.EXTENSION_NAME]:this.callingPackage.fullName,[l.TelemetryPropertyNames.EXTENSION_VERSION]:this.callingPackage.version,[l.TelemetryPropertyNames.EXTENSION_REQUESTED_API_VERSION]:this.apiVersion})}sendInvokeCommandTelemetryEvent(e,t){c.Telemetry.sendTelemetryEvent(l.TelemetryEventNames.INVOKE_EXTENSION_COMMAND,{[l.TelemetryPropertyNames.EXTENSION_NAME]:this.callingPackage.fullName,[l.TelemetryPropertyNames.EXTENSION_VERSION]:this.callingPackage.version,[l.TelemetryPropertyNames.EXTENSION_INVOKED_COMMAND]:e})}sendShareServiceTelemetryEvent(e,t){c.Telemetry.sendTelemetryEvent(l.TelemetryEventNames.SHARE_EXTENSION_SERVICE,{[l.TelemetryPropertyNames.EXTENSION_NAME]:this.callingPackage.fullName,[l.TelemetryPropertyNames.EXTENSION_VERSION]:this.callingPackage.version,[l.TelemetryPropertyNames.EXTENSION_SERVICE_NAME]:e,[l.TelemetryPropertyNames.EXTENSION_SERVICE_PERMITTED]:t.toString()})}}t.LiveShareApi=b},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(8),r=n(522),o={connection:null};class a{constructor(e,t,n){this.name=e,this.trace=n,this.isAvailable=!1,this.isAvailableChange=new i.EventEmitter,r.default(t,"connection","object"),o.connection=t,Object.defineProperty(this,"name",{enumerable:!1,configurable:!1,writable:!1})}get isServiceAvailable(){return this.isAvailable}get onDidChangeIsServiceAvailable(){return this.isAvailableChange.event}set _isServiceAvailable(e){this.isAvailable=e}_fireIsAvailableChange(){this.trace.verbose(`^onDidChangeIsServiceAvailable(${this.name}, ${this.isAvailable})`),this.isAvailableChange.fire(this.isAvailable)}onRequest(e,t){r.default(e,"name","string"),r.default(t,"handler","function");const n=this.makeRpcName(e);this.trace.verbose(`onRequest(${n})`),o.connection.onRequest(n,(...e)=>{this.trace.verbose(`rpc.onRequest(${n})`),e.splice(0,1);const[i]=e.splice(e.length-1,1);try{return t(e,i)}catch(e){this.trace.warning(`Request handler (${n}) failed: `+e.message);let t=e.stack;return t&&(t=t.replace(new RegExp("\\s+at "+a.name+"(.*\n?)+"),"")),new s.ResponseError(s.ErrorCodes.UnknownErrorCode,e.message,t)}})}onNotify(e,t){r.default(e,"name","string"),r.default(t,"handler","function");const n=this.makeRpcName(e);this.trace.verbose(`onNotify(${n})`),o.connection.onNotification(n,(...e)=>{const i=e[0];this.trace.verbose(`rpc.onNotify(${n})`);try{t(i)}catch(e){this.trace.warning(`Notification handler (${n}) failed: `+e.message)}})}async request(e,t,n){r.default(e,"name","string"),r.default(t,"args","array");const i=this.makeRpcName(e);if(!this.isServiceAvailable)throw this.trace.warning(`request(${i}) - service not available`),new c("Service '"+this.name+"' is not available.");let s,a;this.trace.verbose(`request(${i})`);try{s=n?o.connection.sendRequest(i,t,n):o.connection.sendRequest(i,t)}catch(e){throw this.trace.warning(`request(${i}) failed: `+e.message),new c(e.message)}try{a=await s}catch(e){throw this.trace.warning(`request(${i}) failed: `+e.message),new l(e.message,e.data)}return this.trace.verbose(`request(${i}) succeeded`),a}notify(e,t){r.default(e,"name","string"),r.default(t,"args","object");const n=this.makeRpcName(e);if(this.isServiceAvailable){this.trace.verbose(`notify(${n})`);try{o.connection.sendNotification(n,[t])}catch(e){throw this.trace.warning(`notify(${n}) failed: `+e.message),new c(e.message)}}else this.trace.verbose(`notify(${n}) - service not available`)}makeRpcName(e){return this.name+"."+e}}t.SharedServiceApi=a;class c extends Error{constructor(e){super(e),this.name=c.name}}t.SharedServiceProxyError=c;class l extends Error{constructor(e,t){super(e),this.remoteStack=t,this.name=l.name}}t.SharedServiceResponseError=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);t.default=function(e,t,n){if(!e)throw new Error("Argument '"+t+"' is required.");if(n)if("array"===n){if(!Array.isArray(e))throw new Error("Argument '"+t+"' must be an array.")}else if("uri"===n){if(!(e instanceof i.Uri))throw new Error("Argument '"+t+"' must be a Uri object.")}else{if("object"===n&&Array.isArray(e))throw new Error("Argument '"+t+"' must be a a non-array object.");if(typeof e!==n)throw new Error("Argument '"+t+"' must be type '"+n+"'.")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FrameworkServices=void 0;const i=n(148),s=n(524),r=n(299);let o=(()=>{class e{}return e.remoteServiceBroker=Object.freeze(new s.ServiceJsonRpcDescriptor(r.ServiceMoniker.create("RemoteServiceBroker"),i.Formatters.Utf8,i.MessageDelimiters.HttpLikeHeaders)),e.authorization=Object.freeze(new s.ServiceJsonRpcDescriptor(r.ServiceMoniker.create("Microsoft.ServiceHub.Framework.AuthorizationService"),i.Formatters.Utf8,i.MessageDelimiters.HttpLikeHeaders)),e})();t.FrameworkServices=o},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.JsonRpcConnection=t.ServiceJsonRpcDescriptor=void 0;const i=n(8),s=n(148),r=n(299),o=n(525),a=n(526),c=n(1251),l=n(528);class u extends o.ServiceRpcDescriptor{constructor(t,n,r){let o,a;switch(super(t),this.formatter=n,this.messageDelimiter=r,this.protocol="json-rpc",n){case s.Formatters.Utf8:o=t=>Promise.resolve(e.from(JSON.stringify(t))),a=e=>JSON.parse(e.toString());break;case s.Formatters.MessagePack:o=e=>Promise.resolve(l.encode(e)),a=e=>l.decode(e);break;default:throw new Error(`Unsupported formatter: ${n}.`)}if(r===s.MessageDelimiters.HttpLikeHeaders){if(n!==s.Formatters.Utf8)throw new Error("Utf8 is the only formatter supported while using HttpLikeHeaders.");this.connectionFactory=e=>i.createMessageConnection(e,e)}else{if(r!==s.MessageDelimiters.BigEndianInt32LengthHeader)throw new Error(`Unsupported message delimiter: ${r}.`);this.connectionFactory=e=>i.createMessageConnection(new c.BE32MessageReader(e,a),new c.BE32MessageWriter(e,o))}}constructRpcConnection(e){return new f(a.constructMessageConnection(e,this.connectionFactory))}equals(e){return!!(e&&e instanceof u)&&(!!r.ServiceMoniker.equals(e.moniker,this.moniker)&&(this.formatter===e.formatter&&this.messageDelimiter===e.messageDelimiter))}}t.ServiceJsonRpcDescriptor=u;const d={get:(e,t)=>{switch(t.toString()){case"dispose":return function(){e.dispose()};case"then":return;default:return function(){const n=t.toString();let s;if(arguments.length>0){if(i.CancellationToken.is(arguments[arguments.length-1])){s=arguments[arguments.length-1];const t=h(Array.prototype.slice.call(arguments,0,arguments.length-1));return e.sendRequest(n,t,s)}if(void 0===arguments[arguments.length-1]){const t=h(Array.prototype.slice.call(arguments,0,arguments.length-1));return e.sendRequest(n,t)}}const r=h(Array.prototype.slice.call(arguments));return e.sendRequest(n,r)}}}};function h(e){for(let t=0;t<e.length;t++)if(void 0===e[t])throw new Error(`Argument at 0-based index ${t} is set as undefined, which is not a valid JSON value.`);return e}class f extends o.RpcConnection{constructor(e){super(),this.messageConnection=e}addLocalRpcTarget(e){function t(t,n,i){t.onRequest(n,(...t)=>i.apply(e,t)),t.onNotification(n,(...t)=>i.apply(e,t))}f.getInstanceMethodNames(e,Object.prototype).forEach(n=>{if("dispose"!==n){const i=e[n];t(this.messageConnection,n,i);const s="Async",r=n.endsWith(s)?n.substring(0,n.length-s.length):`${n}${s}`;t(this.messageConnection,r,i)}}),"function"==typeof e.dispose&&this.messageConnection.onDispose(()=>e.dispose())}constructRpcClient(){return new Proxy(this.messageConnection,d)}startListening(){var e;null===(e=this.messageConnection)||void 0===e||e.listen()}dispose(){}static isMethod(e,t){const n=Object.getOwnPropertyDescriptor(e,t);return!!n&&"function"==typeof n.value}static getInstanceMethodNames(e,t){const n=[];let i=Object.getPrototypeOf(e);for(;i&&i!==t;)Object.getOwnPropertyNames(i).forEach(e=>{"constructor"!==e&&f.isMethod(i,e)&&n.push(e)}),i=Object.getPrototypeOf(i);return n}}t.JsonRpcConnection=f}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RpcConnection=t.ServiceRpcDescriptor=void 0;const i=n(58);t.ServiceRpcDescriptor=class{constructor(e){this.moniker=e,i(e)}constructRpc(e,t){let n;if(t?n=e:t=e,void 0===t)throw new Error("No pipe supplied.");const i=this.constructRpcConnection(t);void 0!==n&&i.addLocalRpcTarget(n);const s=i.constructRpcClient();return i.startListening(),s}};t.RpcConnection=class{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IsReadWriteStream=t.constructMessageConnection=void 0;const i=n(58);function s(e){return"unshift"in e}t.constructMessageConnection=function(e,t){let n;return i(e),s(e)?(n=t(e),e.on("close",()=>{null==n||n.dispose()}),n.onDispose(()=>e.end()),n.onClose(()=>e.end())):(n=t(e.stream),e.completion.then(()=>{null==n||n.dispose()}),n.onDispose(()=>e.dispose()),n.onClose(()=>e.dispose())),n},t.IsReadWriteStream=s},function(e,t,n){"use strict";(function(e,n){class i{constructor(e){this.tasks=[],this.count=e}sched(){if(this.count>0&&this.tasks.length>0){this.count--;let e=this.tasks.shift();if(void 0===e)throw"Unexpected undefined value in tasks list";e()}}acquire(){return new Promise((t,i)=>{this.tasks.push(()=>{var e=!1;t(()=>{e||(e=!0,this.count++,this.sched())})}),e&&e.nextTick?e.nextTick(this.sched.bind(this)):n(this.sched.bind(this))})}use(e){return this.acquire().then(t=>e().then(e=>(t(),e)).catch(e=>{throw t(),e}))}}t.Semaphore=i;t.Mutex=class extends i{constructor(){super(1)}}}).call(this,n(11),n(57).setImmediate)},function(e,t,n){t.encode=n(529).encode,t.decode=n(533).decode,t.Encoder=n(1263).Encoder,t.Decoder=n(1264).Decoder,t.createCodec=n(1265).createCodec,t.codec=n(1266).codec},function(e,t,n){t.encode=function(e,t){var n=new i(t);return n.write(e),n.read()};var i=n(530).EncodeBuffer},function(e,t,n){t.EncodeBuffer=s;var i=n(300).preset;function s(e){if(!(this instanceof s))return new s(e);if(e&&(this.options=e,e.codec)){var t=this.codec=e.codec;t.bufferish&&(this.bufferish=t.bufferish)}}n(532).FlexEncoder.mixin(s.prototype),s.prototype.codec=i,s.prototype.write=function(e){this.codec.encode(this,e)}},function(e,t){for(var n=t.uint8=new Array(256),i=0;i<=255;i++)n[i]=s(i);function s(e){return function(t){var n=t.reserve(1);t.buffer[n]=e}}},function(e,t,n){t.FlexDecoder=s,t.FlexEncoder=r;var i=n(40);function s(){if(!(this instanceof s))return new s}function r(){if(!(this instanceof r))return new r}function o(){throw new Error("method not implemented: write()")}function a(){throw new Error("method not implemented: fetch()")}function c(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function l(e){(this.buffers||(this.buffers=[])).push(e)}function u(){return(this.buffers||(this.buffers=[])).shift()}function d(e){return function(t){for(var n in e)t[n]=e[n];return t}}s.mixin=d({bufferish:i,write:function(e){var t=this.offset?i.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=t?e?this.bufferish.concat([t,e]):t:e,this.offset=0},fetch:a,flush:function(){for(;this.offset<this.buffer.length;){var e,t=this.offset;try{e=this.fetch()}catch(e){if(e&&"BUFFER_SHORTAGE"!=e.message)throw e;this.offset=t;break}this.push(e)}},push:l,pull:u,read:c,reserve:function(e){var t=this.offset,n=t+e;if(n>this.buffer.length)throw new Error("BUFFER_SHORTAGE");return this.offset=n,t},offset:0}),s.mixin(s.prototype),r.mixin=d({bufferish:i,write:o,fetch:function(){var e=this.start;if(e<this.offset){var t=this.start=this.offset;return i.prototype.slice.call(this.buffer,e,t)}},flush:function(){for(;this.start<this.offset;){var e=this.fetch();e&&this.push(e)}},push:l,pull:function(){var e=this.buffers||(this.buffers=[]),t=e.length>1?this.bufferish.concat(e):e[0];return e.length=0,t},read:c,reserve:function(e){var t=0|e;if(this.buffer){var n=this.buffer.length,i=0|this.offset,s=i+t;if(s<n)return this.offset=s,i;this.flush(),e=Math.max(e,Math.min(2*n,this.maxBufferSize))}return e=Math.max(e,this.minBufferSize),this.buffer=this.bufferish.alloc(e),this.start=0,this.offset=t,0},send:function(e){var t=e.length;if(t>this.minBufferSize)this.flush(),this.push(e);else{var n=this.reserve(t);i.prototype.copy.call(e,this.buffer,n)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}),r.mixin(r.prototype)},function(e,t,n){t.decode=function(e,t){var n=new i(t);return n.write(e),n.read()};var i=n(534).DecodeBuffer},function(e,t,n){t.DecodeBuffer=s;var i=n(304).preset;function s(e){if(!(this instanceof s))return new s(e);if(e&&(this.options=e,e.codec)){var t=this.codec=e.codec;t.bufferish&&(this.bufferish=t.bufferish)}}n(532).FlexDecoder.mixin(s.prototype),s.prototype.codec=i,s.prototype.fetch=function(){return this.codec.decode(this)}},function(e,t,n){var i=n(196),s=n(303),r=s.Uint64BE,o=s.Int64BE;t.getReadFormat=function(e){var t=a.hasArrayBuffer&&e&&e.binarraybuffer,n=e&&e.int64;return{map:l&&e&&e.usemap?d:u,array:h,str:f,bin:t?m:p,ext:g,uint8:y,uint16:S,uint32:E,uint64:b(8,n?M:C),int8:v,int16:_,int32:w,int64:b(8,n?A:T),float32:b(4,k),float64:b(8,R)}},t.readUint8=y;var a=n(40),c=n(302),l="undefined"!=typeof Map;function u(e,t){var n,i={},s=new Array(t),r=new Array(t),o=e.codec.decode;for(n=0;n<t;n++)s[n]=o(e),r[n]=o(e);for(n=0;n<t;n++)i[s[n]]=r[n];return i}function d(e,t){var n,i=new Map,s=new Array(t),r=new Array(t),o=e.codec.decode;for(n=0;n<t;n++)s[n]=o(e),r[n]=o(e);for(n=0;n<t;n++)i.set(s[n],r[n]);return i}function h(e,t){for(var n=new Array(t),i=e.codec.decode,s=0;s<t;s++)n[s]=i(e);return n}function f(e,t){var n=e.reserve(t),i=n+t;return c.toString.call(e.buffer,"utf-8",n,i)}function p(e,t){var n=e.reserve(t),i=n+t,s=c.slice.call(e.buffer,n,i);return a.from(s)}function m(e,t){var n=e.reserve(t),i=n+t,s=c.slice.call(e.buffer,n,i);return a.Uint8Array.from(s).buffer}function g(e,t){var n=e.reserve(t+1),i=e.buffer[n++],s=n+t,r=e.codec.getExtUnpacker(i);if(!r)throw new Error("Invalid ext type: "+(i?"0x"+i.toString(16):i));return r(c.slice.call(e.buffer,n,s))}function y(e){var t=e.reserve(1);return e.buffer[t]}function v(e){var t=e.reserve(1),n=e.buffer[t];return 128&n?n-256:n}function S(e){var t=e.reserve(2),n=e.buffer;return n[t++]<<8|n[t]}function _(e){var t=e.reserve(2),n=e.buffer,i=n[t++]<<8|n[t];return 32768&i?i-65536:i}function E(e){var t=e.reserve(4),n=e.buffer;return 16777216*n[t++]+(n[t++]<<16)+(n[t++]<<8)+n[t]}function w(e){var t=e.reserve(4),n=e.buffer;return n[t++]<<24|n[t++]<<16|n[t++]<<8|n[t]}function b(e,t){return function(n){var i=n.reserve(e);return t.call(n.buffer,i,!0)}}function C(e){return new r(this,e).toNumber()}function T(e){return new o(this,e).toNumber()}function M(e){return new r(this,e)}function A(e){return new o(this,e)}function k(e){return i.read(this,e,!1,23,4)}function R(e){return i.read(this,e,!1,52,8)}},function(e,t,n){!function(t){e.exports=t;var n={on:function(e,t){return r(this,e).push(t),this},once:function(e,t){var n=this;return i.originalListener=t,r(n,e).push(i),n;function i(){s.call(n,e,i),t.apply(this,arguments)}},off:s,emit:function(e,t){var n=this,i=r(n,e,!0);if(!i)return!1;var s=arguments.length;if(1===s)i.forEach(a);else if(2===s)i.forEach(c);else{var o=Array.prototype.slice.call(arguments,1);i.forEach(l)}return!!i.length;function a(e){e.call(n)}function c(e){e.call(n,t)}function l(e){e.apply(n,o)}}};function i(e){for(var t in n)e[t]=n[t];return e}function s(e,t){var n,i=this;if(arguments.length){if(t){if(n=r(i,e,!0)){if(!(n=n.filter(o)).length)return s.call(i,e);i.listeners[e]=n}}else if((n=i.listeners)&&(delete n[e],!Object.keys(n).length))return s.call(i)}else delete i.listeners;return i;function o(e){return e!==t&&e.originalListener!==t}}function r(e,t,n){if(!n||e.listeners){var i=e.listeners||(e.listeners={});return i[t]||(i[t]=[])}}i(t.prototype),t.mixin=i}((
/**
 * event-lite.js - Light-weight EventEmitter (less than 1KB when gzipped)
 *
 * @copyright Yusuke Kawasaki
 * @license MIT
 * @constructor
 * @see https://github.com/kawanet/event-lite
 * @see http://kawanet.github.io/event-lite/EventLite.html
 * @example
 * var EventLite = require("event-lite");
 *
 * function MyClass() {...}             // your class
 *
 * EventLite.mixin(MyClass.prototype);  // import event methods
 *
 * var obj = new MyClass();
 * obj.on("foo", function() {...});     // add event listener
 * obj.once("bar", function() {...});   // add one-time event listener
 * obj.emit("foo");                     // dispatch event
 * obj.emit("bar");                     // dispatch another event
 * obj.off("foo");                      // remove event listener
 */
function e(){if(!(this instanceof e))return new e}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorizationServiceClient=void 0;const i=n(58),s=n(88);t.AuthorizationServiceClient=class{constructor(e,t=!0){this.authService=e,this.ownsAuthService=t,this.isDisposed=!1,i(e),this.authService=e}async getCredentials(e=s.default.CONTINUE){if(this.isDisposed)throw new Error("Object is disposed");return await this.authService.getCredentials(e)}async checkAuthorization(e,t=s.default.CONTINUE){if(i(e),this.isDisposed)throw new Error("Object is disposed");return await this.authService.checkAuthorization(e,t)}dispose(){this.isDisposed=!0,this.ownsAuthService&&this.authService.dispose()}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(88),s=n(34),r=n(539),o=n(187),a=n(305),c=n(306);class l{constructor(e){this._isDisposed=!1,this.id=e}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed=!0}}t.Channel=l;t.ChannelClass=class extends l{constructor(t,n,i,l){super(i),this._acceptance=new o.Deferred,this._completion=new o.Deferred,this.remoteWindowFilled=0;const u=this;this.name=l.name,n?this.localWindowSize=l.remoteWindowSize:this.remoteWindowSize=l.remoteWindowSize,this._multiplexingStream=t,this.remoteWindowHasCapacity=new o.Deferred,this._multiplexingStream.backpressureSupportEnabled&&!this.remoteWindowSize||this.remoteWindowHasCapacity.resolve(),this._duplex=new s.Duplex({async write(n,s,o){let l;try{let s=e.from(n);for(;s.length>0;){let e=Math.min(s.length,c.MultiplexingStream.framePayloadMaxLength);if(u._multiplexingStream.backpressureSupportEnabled){if(await u.remoteWindowHasCapacity.promise,!u.remoteWindowSize)throw new Error("Remote window size unknown.");e=Math.min(u.remoteWindowSize-u.remoteWindowFilled,e)}u.onTransmittingBytes(e);const n=new a.FrameHeader(r.ControlCode.Content,i);await t.sendFrameAsync(n,s.slice(0,e)),s=s.slice(e)}}catch(e){l=e}o&&o(l)},async final(e){let n;try{await t.onChannelWritingCompleted(u)}catch(e){n=e}e&&e(n)},read(){}})}get stream(){return this._duplex}get acceptance(){return this._acceptance.promise}get isAccepted(){return this._acceptance.isResolved}get isRejectedOrCanceled(){return this._acceptance.isRejected}get completion(){return this._completion.promise}tryAcceptOffer(e){return!!this._acceptance.resolve()&&(this.localWindowSize=void 0!==(null==e?void 0:e.channelReceivingWindowSize)?Math.max(this._multiplexingStream.defaultChannelReceivingWindowSize,null==e?void 0:e.channelReceivingWindowSize):this._multiplexingStream.defaultChannelReceivingWindowSize,!0)}tryCancelOffer(e){const t=new i.default.CancellationError(e);this._acceptance.reject(t),this._completion.reject(t)}onAccepted(e){return this._multiplexingStream.backpressureSupportEnabled&&(this.remoteWindowSize=e.remoteWindowSize,this.remoteWindowHasCapacity.resolve()),this._acceptance.resolve()}onContent(e){this._duplex.push(e),this._multiplexingStream.backpressureSupportEnabled&&e&&this._multiplexingStream.localContentExamined(this,e.length)}onContentProcessed(e){if(e<0)throw new Error("A non-negative number is required.");if(e>this.remoteWindowFilled)throw new Error("More bytes processed than we thought were in the window.");if(void 0===this.remoteWindowSize)throw new Error("Unexpected content processed message given we don't know the remote window size.");this.remoteWindowFilled-=e,this.remoteWindowFilled<this.remoteWindowSize&&this.remoteWindowHasCapacity.resolve()}dispose(){this.isDisposed||(super.dispose(),this._acceptance.reject(new i.default.CancellationError("disposed")),this._duplex.end(),this._duplex.push(null),this._completion.resolve(),this._multiplexingStream.onChannelDisposed(this))}onTransmittingBytes(e){if(this._multiplexingStream.backpressureSupportEnabled){if(e<0)throw new Error("Negative byte count transmitted.");this.remoteWindowFilled+=e,this.remoteWindowFilled==this.remoteWindowSize&&(this.remoteWindowHasCapacity=new o.Deferred)}}}}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Offer=0]="Offer",e[e.OfferAccepted=1]="OfferAccepted",e[e.Content=2]="Content",e[e.ContentWritingCompleted=3]="ContentWritingCompleted",e[e.ChannelTerminated=4]="ChannelTerminated",e[e.ContentProcessed=5]="ContentProcessed"}(t.ControlCode||(t.ControlCode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteServiceConnectionInfo=void 0,function(e){e.isEmpty=function(e){return!e.multiplexingChannelId&&!e.requestId},e.isOneOf=function(e,t){return!!e.multiplexingChannelId&&t.indexOf("multiplexing")>-1}}(t.RemoteServiceConnectionInfo||(t.RemoteServiceConnectionInfo={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(4);t.createPortForwardingService=function(){return new r};class r{constructor(){this.sharingStarted=new i.EventEmitter,this.sharingChanged=new i.EventEmitter,this.sharingStopped=new i.EventEmitter,this.browseSharingStarted=new i.EventEmitter,this.pipeSharingStarted=new i.EventEmitter,this.pipeSharingStopped=new i.EventEmitter,this.onSharingStarted=this.sharingStarted.event,this.onSharingChanged=this.sharingChanged.event,this.onSharingStopped=this.sharingStopped.event,this.onBrowseSharingStarted=this.browseSharingStarted.event,this.onPipeSharingStarted=this.pipeSharingStarted.event,this.onPipeSharingStopped=this.pipeSharingStopped.event,this.serviceSharingService=s.dependencies.serverSharingService(),this.serviceSharingService.onSharingStarted(e=>this.sharingStarted.fire(e)),this.serviceSharingService.onSharingChanged(e=>this.sharingChanged.fire(e)),this.serviceSharingService.onSharingStopped(e=>this.sharingStopped.fire(e)),this.serviceSharingService.onBrowseSharingStarted(e=>this.browseSharingStarted.fire(e)),this.serviceSharingService.onPipeSharingStarted(e=>this.pipeSharingStarted.fire(e)),this.serviceSharingService.onPipeSharingStopped(e=>this.pipeSharingStopped.fire(e))}async getSharedServersAsync(e){let t=await this.serviceSharingService.getSharedServersAsync(e);return t.forEach(e=>e.destinationPort=e.sourcePort),t}async getSharedPipesAsync(e){return await this.serviceSharingService.getSharedPipesAsync(e)}async getLastAccessTimeAsync(e){return 0}async setDestinationPortAsync(e,t,n){return null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4),s=n(5),r=n(0),o=n(309),a=n(8),c=n(189);class l{constructor(e){if(this.thread=e,this.commentId=0,!e.comments||!e.comments.length)throw new o.ResponseError(a.ErrorCodes.InvalidParams,"No comments on the comment thread parameter");if(e.comments.length>1)throw new o.ResponseError(a.ErrorCodes.InvalidParams,"Too many comments on the comment thread parameter. Only one is required.");const t=e.comments[0];if(!t)throw new o.ResponseError(a.ErrorCodes.InvalidParams,"The comment is undefined or missing on the comment thread parameter");t.parentId=-1,this.addComment(t,!0)}get isEmpty(){return 0===this.thread.comments.length}get lastCommentId(){return this.thread.comments[this.thread.comments.length-1].commentId}addComment(e,t){if(!e)throw new o.ResponseError(a.ErrorCodes.InvalidParams,"No comment parameter");if(!e.text)throw new o.ResponseError(a.ErrorCodes.InvalidParams,"No comment text.");if(!e.participantId)throw new o.ResponseError(a.ErrorCodes.InvalidParams,"No participant ID.");if(!t){const t=e.parentId;let n;if(-1===t)e.parentId=this.lastCommentId,n=this.thread.comments.length;else{if(n=this.thread.comments.findIndex(e=>e.parentId===t),n>=0)for(;n<this.thread.comments.length&&this.thread.comments[n].parentId===t;)n++;else if(n=this.thread.comments.findIndex(e=>e.commentId===t)+1,0===n)throw new o.ResponseError(a.ErrorCodes.InvalidParams,"Unknown parent comment ID");this.thread.comments.splice(n,0,e)}}const n=new Date;e.threadId=this.thread.threadId,e.commentId=this.commentId++,e.publishedDate=n,this.thread.lastUpdatedDate=n,this.thread.lastUpdatedSessionId=e.lastUpdatedSessionId,this.thread.publishedDate||(this.thread.publishedDate=n)}updateCommentText(e,t,n){if(!n)throw new o.ResponseError(a.ErrorCodes.InvalidParams,"Missing or empty newText parameter.");const{comment:i}=this.getComment(e);return i.text=n,this.updateLastUpdated(i,t),i}deleteComment(e,t){const{comment:n,index:i}=this.getComment(e);return this.thread.comments.splice(i,1),n.isDeleted=!0,this.updateLastUpdated(n,t),n}updateLastUpdated(e,t){const n=new Date;e.lastUpdatedSessionId=t,e.lastUpdatedDate=n,this.thread.lastUpdatedDate=n,this.thread.lastUpdatedSessionId=t}getComment(e){const t=this.thread.comments.findIndex(t=>t.commentId===e);if(-1===t)throw new o.ResponseError(a.ErrorCodes.InvalidParams,"Unknown comment ID parameter.");return{comment:this.thread.comments[t],index:t}}}t.HostCommentService=class{constructor(e){this.dependencies=e,this.commentThreadChanged=new r.EventEmitter,this.threadId=1,this.threads=new Map,this.disposables=[]}async init(){c.commentsSupported()&&await i.RpcServiceHelper.registerHostRpcService(this,s.vsls.CommentService,this.dependencies,this.disposables)}async dispose(){for(const e of this.disposables)e.dispose();this.threads.clear(),this.threadId=1,this.disposables=[]}updateThreadPosition(e,t,n){const{thread:i}=this.threads.get(e);if(!i)return;const{threadContext:s}=i;s.rightFileStart&&(s.rightFileStart=t,s.rightFileEnd=n)}async createCommentThreadAsync(e){if(!e)throw new o.ResponseError(a.ErrorCodes.InvalidParams,"No comment thread parameter");if(!e.threadContext)throw new o.ResponseError(a.ErrorCodes.InvalidParams,"Thread context is missing on the comment thread parameter");if(!e.threadContext.filePath)throw new o.ResponseError(a.ErrorCodes.InvalidParams,"File path is missing on the thread context of the comment thread parameter");e.threadId=this.threadId++,e.publishedDate=new Date,e.lastUpdatedDate=e.publishedDate;const t=new l(e);return this.threads.set(e.threadId,t),this.commentThreadChanged.fire({newThread:e}),e}async createCommentAsync(e){if(!e)throw new o.ResponseError(a.ErrorCodes.InvalidParams,"No comment parameter");return this.getThread(e.threadId).addComment(e),this.commentThreadChanged.fire({changedComment:e}),e}async updateCommentAsync(e,t,n,i){const s=this.getThread(e).updateCommentText(t,n,i);return this.commentThreadChanged.fire({changedComment:s}),s}async deleteCommentAsync(e,t,n){const i=this.getThread(e),s=i.deleteComment(t,n);return i.isEmpty&&this.threads.delete(e),this.commentThreadChanged.fire({changedComment:s}),s}getAllCommentThreadsAsync(){const e=[];for(const t of this.threads.values())e.push(t.thread);return Promise.resolve(e)}getCommentThreadPositionsAsync(e){let t=[];for(let n of e){let e=this.threads.get(n);if(!e)continue;let i=new s.vsls.CommentThreadLocation;i.threadId=e.thread.threadId,i.threadContext=e.thread.threadContext,t.push(i)}return Promise.resolve(t)}updateLikeAsync(e,t,n,i,s){return Promise.resolve()}get onCommentThreadChanged(){return this.commentThreadChanged.event}getThread(e){if(!e)throw new o.ResponseError(a.ErrorCodes.InvalidParams,"Comment thread ID is not defined.");const t=this.threads.get(e);if(!t)throw new o.ResponseError(a.ErrorCodes.InvalidParams,"Unknown comment thread.");return t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(30),r=n(71),o=n(544),a=n(545),c=n(546);t.createConverter=function(e){const t=e||(e=>e.toString());function n(e){return t(e)}function l(e){return{uri:t(e.uri)}}function u(e){return{uri:t(e.uri),version:e.version}}function d(e){switch(e){case i.TextDocumentSaveReason.Manual:return s.TextDocumentSaveReason.Manual;case i.TextDocumentSaveReason.AfterDelay:return s.TextDocumentSaveReason.AfterDelay;case i.TextDocumentSaveReason.FocusOut:return s.TextDocumentSaveReason.FocusOut}return s.TextDocumentSaveReason.Manual}function h(e){switch(e){case i.CompletionTriggerKind.TriggerCharacter:return s.CompletionTriggerKind.TriggerCharacter;case i.CompletionTriggerKind.TriggerForIncompleteCompletions:return s.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return s.CompletionTriggerKind.Invoked}}function f(e){return{line:e.line,character:e.character}}function p(e){if(void 0!==e)return null===e?null:{line:e.line,character:e.character}}function m(e){return null==e?e:{start:p(e.start),end:p(e.end)}}function g(e){switch(e){case i.DiagnosticSeverity.Error:return s.DiagnosticSeverity.Error;case i.DiagnosticSeverity.Warning:return s.DiagnosticSeverity.Warning;case i.DiagnosticSeverity.Information:return s.DiagnosticSeverity.Information;case i.DiagnosticSeverity.Hint:return s.DiagnosticSeverity.Hint}}function y(e){let t=s.Diagnostic.create(m(e.range),e.message);return r.number(e.severity)&&(t.severity=g(e.severity)),(r.number(e.code)||r.string(e.code))&&(t.code=e.code),e.source&&(t.source=e.source),t}function v(e){return null==e?e:e.map(y)}function S(e){return{range:m(e.range),newText:e.newText}}function _(e){let t=s.Command.create(e.title,e.command);return e.arguments&&(t.arguments=e.arguments),t}return{asUri:n,asTextDocumentIdentifier:l,asOpenTextDocumentParams:function(e){return{textDocument:{uri:t(e.uri),languageId:e.languageId,version:e.version,text:e.getText()}}},asChangeTextDocumentParams:function(e){if(function(e){let t=e;return!!t.uri&&!!t.version}(e)){return{textDocument:{uri:t(e.uri),version:e.version},contentChanges:[{text:e.getText()}]}}if(function(e){let t=e;return!!t.document&&!!t.contentChanges}(e)){let n=e.document;return{textDocument:{uri:t(n.uri),version:n.version},contentChanges:e.contentChanges.map(e=>{let t=e.range;return{range:{start:{line:t.start.line,character:t.start.character},end:{line:t.end.line,character:t.end.character}},rangeLength:e.rangeLength,text:e.text}})}}throw Error("Unsupported text document change parameter")},asCloseTextDocumentParams:function(e){return{textDocument:l(e)}},asSaveTextDocumentParams:function(e,t=!1){let n={textDocument:u(e)};return t&&(n.text=e.getText()),n},asWillSaveTextDocumentParams:function(e){return{textDocument:l(e.document),reason:d(e.reason)}},asTextDocumentPositionParams:function(e,t){return{textDocument:l(e),position:f(t)}},asCompletionParams:function(e,t,n){return{textDocument:l(e),position:f(t),context:{triggerKind:h(n.triggerKind),triggerCharacter:n.triggerCharacter}}},asWorkerPosition:f,asRange:m,asPosition:p,asDiagnosticSeverity:g,asDiagnostic:y,asDiagnostics:v,asCompletionItem:function(e){let t={label:e.label},n=e instanceof o.default?e:void 0;var a,c;return e.detail&&(t.detail=e.detail),e.documentation&&(n&&"$string"!==n.documentationFormat?t.documentation=function(e,t){switch(e){case"$string":return t;case s.MarkupKind.PlainText:return{kind:e,value:t};case s.MarkupKind.Markdown:return{kind:e,value:t.value};default:return`Unsupported Markup content received. Kind is: ${e}`}}(n.documentationFormat,e.documentation):t.documentation=e.documentation),e.filterText&&(t.filterText=e.filterText),function(e,t){let n,r=s.InsertTextFormat.PlainText,o=void 0;t.textEdit?(n=t.textEdit.newText,o=m(t.textEdit.range)):t.insertText instanceof i.SnippetString?(r=s.InsertTextFormat.Snippet,n=t.insertText.value):n=t.insertText;t.range&&(o=m(t.range));e.insertTextFormat=r,t.fromEdit&&n&&o?e.textEdit={newText:n,range:o}:e.insertText=n}(t,e),r.number(e.kind)&&(t.kind=(a=e.kind,void 0!==(c=n&&n.originalItemKind)?c:a+1)),e.sortText&&(t.sortText=e.sortText),e.additionalTextEdits&&(t.additionalTextEdits=function(e){if(null==e)return e;return e.map(S)}(e.additionalTextEdits)),e.commitCharacters&&(t.commitCharacters=e.commitCharacters.slice()),e.command&&(t.command=_(e.command)),!0!==e.preselect&&!1!==e.preselect||(t.preselect=e.preselect),n&&(void 0!==n.data&&(t.data=n.data),!0!==n.deprecated&&!1!==n.deprecated||(t.deprecated=n.deprecated)),t},asTextEdit:S,asReferenceParams:function(e,t,n){return{textDocument:l(e),position:f(t),context:{includeDeclaration:n.includeDeclaration}}},asCodeActionContext:function(e){return null==e?e:s.CodeActionContext.create(v(e.diagnostics),r.string(e.only)?[e.only]:void 0)},asCommand:_,asCodeLens:function(e){let t=s.CodeLens.create(m(e.range));return e.command&&(t.command=_(e.command)),e instanceof a.default&&e.data&&(t.data=e.data),t},asFormattingOptions:function(e){return{tabSize:e.tabSize,insertSpaces:e.insertSpaces}},asDocumentSymbolParams:function(e){return{textDocument:l(e)}},asCodeLensParams:function(e){return{textDocument:l(e)}},asDocumentLink:function(e){let t=s.DocumentLink.create(m(e.range));e.target&&(t.target=n(e.target));let i=e instanceof c.default?e:void 0;return i&&i.data&&(t.data=i.data),t},asDocumentLinkParams:function(e){return{textDocument:l(e)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);class s extends i.CompletionItem{constructor(e){super(e)}}t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);class s extends i.CodeLens{constructor(e){super(e)}}t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);class s extends i.DocumentLink{constructor(e,t){super(e,t)}}t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(4),r=n(5);let o;function a(e,n){const o=s.Settings.get(s.SettingKeys.diagnosticLogging);let a;switch(e.scope){case r.vsls.TaskScope.WorkspaceFolder:const t=parseInt(e.owningWorkspace,10);a=i.workspace.workspaceFolders[t];break;case r.vsls.TaskScope.Workspace:a=i.TaskScope.Workspace;break;case r.vsls.TaskScope.Global:a=i.TaskScope.Global;break;default:a=i.workspace.workspaceFolders[0]}const c={type:t.liveShareTaskType,taskUid:e.uniqueId};n&&(c.executionId=n.id);const l={onDidWrite:(new i.EventEmitter).event,open:()=>{},close:()=>{}},u=new i.CustomExecution(()=>Promise.resolve(l)),d=new i.Task(c,a,e.source&&"Workspace"!==e.source?`${e.source}:${e.name}`:e.name,"Shared",u);switch(e.kind){case"build":d.group=i.TaskGroup.Build;break;case"clean":d.group=i.TaskGroup.Clean;break;case"rebuild":d.group=i.TaskGroup.Rebuild;break;case"test":d.group=i.TaskGroup.Test}return d.presentationOptions={reveal:i.TaskRevealKind.Never,echo:o,focus:!1,panel:i.TaskPanelKind.Dedicated},d.isBackground=!0,d.problemMatchers=["$vsls"],d}t.liveShareTaskType="vsls",t.register=function(){return i.workspace.registerTaskProvider(t.liveShareTaskType,{provideTasks:()=>async function(){const e=[];if(!o)return e;const t=o.fetchTaskExecutions();if(t&&t.length)for(const[n,i]of t){const t=a(n,i);e.push(t)}else{const t=await o.fetchTasks();for(const n of t){const t=a(n);e.push(t)}}return e}(),resolveTask:()=>{}})},t.configure=function(e,t){return o={fetchTasks:e,fetchTaskExecutions:t,dispose:()=>{o=void 0}},o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1319);t.lspClientActivator=i.lspClientActivator;const s=n(549);t.lspClient=s;const r=n(551);t.lspServer=r;const o=n(313);t.commandHandler=o;var a=n(552);t.UniversalLanguageServerProvider=a.UniversalLanguageServerProvider;var c=n(191);t.LanguageServiceTelemetryEventNames=c.LanguageServiceTelemetryEventNames,t.LanuageServiceTelemetryPropertyNames=c.LanuageServiceTelemetryPropertyNames;var l=n(550);t.LSPClientStreamProvider=l.LSPClientStreamProvider},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(8),r=n(309),o=n(312),a=n(30),c=n(4),l=n(5),u=n(7),d=n(9),h=n(191),f=n(313),p=n(1322),m=n(550),g=n(551),y=n(20);let v;async function S(e,t,n,p){const S=[],E=t=>{e.subscriptions.push(t),S.push(t)},w={name:"languageServerProvider-"+n,methods:l.vsls.LanguageServerProvider.methods,events:l.vsls.LanguageServerProvider.events};let b=y.RpcProxy.create(w,t,u.traceSource.withName(l.vsls.TraceSources.ClientLSP)),C=new m.LSPClientStreamProvider(b,v);if("any"===n){const e=await b.requestAsync({method:a.InitializeRequest.type.method,params:{}},null);v=e.capabilities}const T=await b.getMetadataAsync(),M=c.Settings.scheme;let A=[];T.documentFilters?A=T.documentFilters.map(e=>({schemes:M,language:e.language?e.language:void 0,pattern:e.pattern?e.pattern:void 0})):A.push({scheme:M}),A.push({scheme:c.PathManager.vslsExternalScheme}),(void 0===p||p)&&A.forEach(e=>e.exclusive=!0);let k={documentSelector:A,revealOutputChannelOn:r.RevealOutputChannelOn.Never,initializationFailedHandler:e=>(R.error("Server initialization failed.",e),d.Telemetry.sendFault(h.LanguageServiceTelemetryEventNames.LSPSERVER_INIT_FAULT,d.FaultType.Unknown,`Server ${n} initialization failed - ${e}`),!1),middleware:{}},R=new r.LanguageClient("LiveShareGuest-"+n,"Guest-"+n,()=>Promise.resolve({reader:new s.StreamMessageReader(C.ReadStream),writer:new s.StreamMessageWriter(C.WriteStream)}),k),P=g.REMOTE_COMMAND_NAME,I=o.createConverter();if("any"===n)E(R.start()),i.workspace.onDidOpenTextDocument(async e=>{await _(R,e,I)},void 0,e.subscriptions);else{P=P.concat(".",n);let t=!1;S.push(i.workspace.onDidOpenTextDocument(async e=>((e.languageId===n||A.some(t=>t.language===e.languageId))&&(t||(t=!0,E(R.start())),await _(R,e,I)),!0),void 0,e.subscriptions))}let N=c.ExtensionUtil.registerCommand(P,async e=>{await f.handleLiveShareRemoteCommand(e,R,I)});return E(N),i.Disposable.from(...S)}async function _(e,t,n){if(t.uri.scheme!==c.Settings.scheme)return;await e.onReady();let i=await e.sendRequest("liveshare/diagnosticsDocument",{textDocument:{uri:t.uri.toString()}});i&&e.diagnostics&&e.diagnostics.set(t.uri,n.asDiagnostics(i))}t.activateAsync=async function(e,t,n,s){const r=n.filter(e=>e.startsWith("languageServerProvider-")).map(e=>e.substring("languageServerProvider-".length)),o=[],a=r.indexOf("any");a>=0&&(o.push(await S(e,t,"any",s)),r.splice(a,1));for(const n of r)o.push(await S(e,t,n,s));let l=new p.ExternalDocumentProvider(t,"languageServerProvider-"),u=i.workspace.registerTextDocumentContentProvider(c.PathManager.vslsExternalScheme,l);return e.subscriptions.push(u),i.Disposable.from(...o,u)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(34),s=n(30),r=n(8),o=n(20),a=n(4),c=n(5),l=n(7);class u{constructor(e,t=null){this.languageServerProviderClient=e,this.trace=l.traceSource.withName(c.vsls.TraceSources.ClientLSP),this.readStream=new i.Readable({read:()=>{}}),this.readStreamWriter=new i.Writable({write:(e,t,n)=>{this.readStream.push(e,t),n()}}),this.writeStreamReader=new i.Readable({read:()=>{}}),this.writeStream=new i.Writable({write:(e,t,n)=>{this.writeStreamReader.push(e,t),n()}});let n={info:this.trace.info,warn:this.trace.warning,error:this.trace.error,log:this.trace.verbose},d=r.createMessageConnection(new r.StreamMessageReader(this.writeStreamReader),new r.StreamMessageWriter(this.readStreamWriter),n);d.onRequest(async(n,i,r)=>{let c,l={highestLocalTextChange:a.SessionContext.coeditingClient.currentHighestLocalTextChange,serverVersion:a.SessionContext.coeditingClient.currentServerVersion,clientId:a.SessionContext.coeditingClient.clientID};u.modifyRequestParams(n,i);try{c=await e.requestAsync({method:n,params:i},l,r)}catch(e){throw e.code,o.RpcErrorCodes.RequestCancelled,e}switch(n){case s.InitializeRequest.type.method:const e=c;t&&e.capabilities&&u.modifyServerCapabilities(e,t)}return c}),d.onNotification((t,n,i)=>o.RpcProxy.notifyAsync(e,"notify",{method:t,params:n})),e.onNotified(e=>{const t=e.body;d.sendNotification(t.method,t.params)}),d.listen()}static modifyRequestParams(e,t){if(e===s.InitializeRequest.type.method){const e=t;if(e.capabilities&&e.capabilities.textDocument&&e.capabilities.textDocument.codeAction&&e.capabilities.textDocument.codeAction.codeActionLiteralSupport&&e.capabilities.textDocument.codeAction.codeActionLiteralSupport.codeActionKind&&e.capabilities.textDocument.codeAction.codeActionLiteralSupport.codeActionKind.valueSet){const t=e.capabilities.textDocument.codeAction.codeActionLiteralSupport.codeActionKind.valueSet,n=t.indexOf("");n>=0&&t.splice(n,1)}}}static modifyServerCapabilities(e,t){e.capabilities.codeActionProvider=!t.codeActionProvider&&e.capabilities.codeActionProvider,e.capabilities.colorProvider=!t.colorProvider&&e.capabilities.colorProvider,e.capabilities.declarationProvider=!t.declarationProvider&&e.capabilities.declarationProvider,e.capabilities.definitionProvider=!t.definitionProvider&&e.capabilities.definitionProvider,e.capabilities.documentFormattingProvider=!t.documentFormattingProvider&&e.capabilities.documentFormattingProvider,e.capabilities.documentHighlightProvider=!t.documentHighlightProvider&&e.capabilities.documentHighlightProvider,e.capabilities.documentRangeFormattingProvider=!t.documentRangeFormattingProvider&&e.capabilities.documentRangeFormattingProvider,e.capabilities.documentSymbolProvider=!t.documentSymbolProvider&&e.capabilities.documentSymbolProvider,e.capabilities.foldingRangeProvider=!t.foldingRangeProvider&&e.capabilities.foldingRangeProvider,e.capabilities.hoverProvider=!t.hoverProvider&&e.capabilities.hoverProvider,e.capabilities.implementationProvider=!t.implementationProvider&&e.capabilities.implementationProvider,e.capabilities.referencesProvider=!t.referencesProvider&&e.capabilities.referencesProvider,e.capabilities.renameProvider=!t.renameProvider&&e.capabilities.renameProvider,e.capabilities.typeDefinitionProvider=!t.typeDefinitionProvider&&e.capabilities.typeDefinitionProvider,e.capabilities.workspaceSymbolProvider=!t.workspaceSymbolProvider&&e.capabilities.workspaceSymbolProvider}get ReadStream(){return this.readStream}get WriteStream(){return this.writeStream}}t.LSPClientStreamProvider=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(313),r=n(543),o=n(312),a=n(30),c=n(4),l=n(9),u=n(1323),d=n(552),h=n(191);let f;t.REMOTE_COMMAND_NAME="_liveshare.remotecommand",t.CODE_ACTION_ITEM_RESOLVE_COUNT=Number.MAX_VALUE;const p=new l.SendOnceFilter(h.LanguageServiceTelemetryEventNames.GET_DIAGNOSTICS_FAULT);async function m(e,t){return c.Settings.get(c.SettingKeys.allowGuestCommandControl)||s.isSafeCommand(e.command)?(await i.commands.executeCommand(e.command,...t),!0):"_typescript.applyCodeActionCommand"===e.command}t.activateAsync=async function(e,t,n,i,s){l.Telemetry.addFilter(p),f=new d.UniversalLanguageServerProvider(e,i,t,s),await f.initAsync(),y(f,t,n)},t.dispose=async function(){p.reset(),f&&await f.dispose()};const g={name:c.WellKnownRestrictedOperations.CodeAction};function y(e,n,c){let d=e.createProtocolConnection(),f=o.createConverter(e=>n.protocol2CodeUriConverter(e)),p=r.createConverter(e=>n.code2ProtocolUriConverter(e)),y=u.createConverterExtension(p),v=!1;try{i.languages.onDidChangeDiagnostics(e=>{for(let t of e.uris)try{let e=i.languages.getDiagnostics(t),n={uri:p.asUri(t),diagnostics:p.asDiagnostics(e)};d.sendNotification(a.PublishDiagnosticsNotification.type.method,n)}catch(e){l.Telemetry.sendFault(h.LanguageServiceTelemetryEventNames.GET_DIAGNOSTICS_FAULT,l.FaultType.NonBlockingFault,"Unable to get diagnostics",e)}})}catch(e){}function S(e){return Array.isArray(e)&&e.length>0&&void 0!==e[0].targetUri?v?y.asDefinitionLinkResult(e):y.asDefinitionResultAlternate(e):y.asDefinitionResult(e)}d.onRequest(a.InitializeRequest.type,e=>(e.capabilities&&e.capabilities.textDocument.definition.linkSupport&&(v=!0),{capabilities:{hoverProvider:!0,definitionProvider:!0,typeDefinitionProvider:!0,referencesProvider:!0,implementationProvider:!0,completionProvider:{triggerCharacters:["."]},signatureHelpProvider:{triggerCharacters:["(",","]},documentSymbolProvider:!0,workspaceSymbolProvider:!0,codeActionProvider:!0,documentFormattingProvider:!0,documentRangeFormattingProvider:!0,documentOnTypeFormattingProvider:{firstTriggerCharacter:"}",moreTriggerCharacter:[";","\n"]},renameProvider:!0,documentLinkProvider:{resolveProvider:!1},colorProvider:!0,executeCommandProvider:{commands:[]},codeLensProvider:{resolveProvider:!0}}})),d.onCustomRequest("liveshare/externalDocument",async(e,t)=>{const s=e.textDocument.uri;return await async function(e,t,n){let s=e.getOriginalUri(t);return(await i.workspace.openTextDocument(s)).getText()}(n,s)}),d.onCustomRequest("liveshare/load",async e=>null),d.onCustomRequest("liveshare/diagnosticsDocument",async e=>{let t=e.textDocument.uri;return p.asDiagnostics(i.languages.getDiagnostics(f.asUri(t)))}),d.onRequest(a.HoverRequest.type,async e=>{let t=f.asUri(e.textDocument.uri),n=f.asPosition(e.position),s=await i.commands.executeCommand("vscode.executeHoverProvider",t,n);if(!s||0===s.length)return null;let r=s.map(e=>e.contents).reduce((e,t,n,i)=>e.concat(t)),o=new i.Hover(r,s[0].range);return y.asHover(o)}),d.onRequest(a.DefinitionRequest.type,async e=>{let t=f.asUri(e.textDocument.uri),n=f.asPosition(e.position);return S(await i.commands.executeCommand("vscode.executeDefinitionProvider",t,n))}),d.onRequest(a.TypeDefinitionRequest.type,async e=>{let t,n=f.asUri(e.textDocument.uri),s=f.asPosition(e.position);try{t=await i.commands.executeCommand("vscode.executeTypeDefinitionProvider",n,s)}catch(e){}return t?t.map(e=>y.asLocation(e)):null}),d.onRequest(a.ReferencesRequest.type,async e=>{let t=f.asUri(e.textDocument.uri),n=f.asPosition(e.position),s=await i.commands.executeCommand("vscode.executeReferenceProvider",t,n);return y.asReferences(s)}),d.onRequest(a.ImplementationRequest.type,async e=>{let t=f.asUri(e.textDocument.uri),n=f.asPosition(e.position);return S(await i.commands.executeCommand("vscode.executeImplementationProvider",t,n))}),d.onRequest(a.DocumentHighlightRequest.type,async e=>{let t=f.asUri(e.textDocument.uri),n=f.asPosition(e.position),s=await i.commands.executeCommand("vscode.executeDocumentHighlights",t,n);return y.asDocumentHighlights(s)}),d.onRequest(a.CompletionRequest.type,async e=>{let t=f.asUri(e.textDocument.uri),n=f.asPosition(e.position),s=await i.commands.executeCommand("vscode.executeCompletionItemProvider",t,n,e.context?e.context.triggerCharacter:void 0);if(s)return s.items.map(e=>(e.fromEdit=!0,e.range&&e.range.replacing&&(e.range=e.range.replacing),p.asCompletionItem(e)))}),d.onRequest(a.SignatureHelpRequest.type,async e=>{let t=f.asUri(e.textDocument.uri),n=f.asPosition(e.position),s=await i.commands.executeCommand("vscode.executeSignatureHelpProvider",t,n);return y.asSignatureHelp(s)}),d.onRequest(a.DocumentSymbolRequest.type,async e=>{let t=f.asUri(e.textDocument.uri),n=await i.commands.executeCommand("vscode.executeDocumentSymbolProvider",t);return y.asSymbolInformations(n,t)}),d.onRequest(a.WorkspaceSymbolRequest.type,async e=>{let t=await i.commands.executeCommand("vscode.executeWorkspaceSymbolProvider",e.query);return y.asSymbolInformations(t,void 0)}),d.onRequest(a.CodeActionRequest.type,async e=>{if(c&&!await c().canPerformOperation(e,g))return;let n=f.asUri(e.textDocument.uri),r=f.asRange(e.range),o=await i.commands.executeCommand("vscode.executeCodeActionProvider",n,r,void 0,t.CODE_ACTION_ITEM_RESOLVE_COUNT);return o?o.map(e=>{if("string"==typeof e.command)return s.wrapCodeActionCommand(e,n,r,p,y);{const t=e;return t.command=t.command?s.wrapCodeActionCommand(t.command,n,r,p,y):t.command,y.asCodeAction(t)}}):void 0}),d.onRequest(a.ExecuteCommandRequest.type,async e=>{if(c&&!await c().canPerformOperation(e,g))return;let n,r=e.arguments||[];return e.command.startsWith(t.REMOTE_COMMAND_NAME)?(n=r[0],r=n.arguments):n=e,r.length>0&&r[0]===s.REMOTE_CODE_ACTION_NAME?await async function(e,n,r){let o=await i.commands.executeCommand("vscode.executeCodeActionProvider",e,n,void 0,t.CODE_ACTION_ITEM_RESOLVE_COUNT);if(o)for(let e of o){const t="string"==typeof e.command?e:e.command;if(t&&s.hashCommand(t)===r)return await m(t,t.arguments)}}(f.asUri(r[2]),f.asRange(r[3]),r[1]):r.length>0&&r[0]===s.REMOTE_CODE_LENS_NAME?await async function(e,t){try{let n=await i.commands.executeCommand("vscode.executeCodeLensProvider",e,Number.MAX_VALUE);if(n)for(let e of n)if(e.command&&s.hashCommand(e.command)===t)return await m(e.command,e.command.arguments)}catch(e){}}(f.asUri(r[2]),r[1]):await m(n,r)}),d.onRequest(a.DocumentFormattingRequest.type,async e=>{let t=f.asUri(e.textDocument.uri),n=await i.commands.executeCommand("vscode.executeFormatDocumentProvider",t,e.options);if(n)return n.map(e=>p.asTextEdit(e))}),d.onRequest(a.DocumentRangeFormattingRequest.type,async e=>{let t=f.asUri(e.textDocument.uri),n=f.asRange(e.range),s=await i.commands.executeCommand("vscode.executeFormatRangeProvider",t,n,e.options);if(s)return s.map(e=>p.asTextEdit(e))}),d.onRequest(a.DocumentOnTypeFormattingRequest.type,async e=>{let t=f.asUri(e.textDocument.uri),n=f.asPosition(e.position),s=await i.commands.executeCommand("vscode.executeFormatOnTypeProvider",t,n,e.ch,e.options);if(s)return s.map(e=>p.asTextEdit(e))}),d.onRequest(a.RenameRequest.type,async e=>{let t=f.asUri(e.textDocument.uri),n=f.asPosition(e.position),s=await i.commands.executeCommand("vscode.executeDocumentRenameProvider",t,n,e.newName);return y.asWorkspaceEdit(s)}),d.onRequest(a.DocumentLinkRequest.type,async e=>{let t=f.asUri(e.textDocument.uri),n=await i.commands.executeCommand("vscode.executeLinkProvider",t);if(n)return n.map(e=>p.asDocumentLink(e))}),d.onRequest(a.DocumentColorRequest.type,async e=>{let t,n=f.asUri(e.textDocument.uri);try{t=await i.commands.executeCommand("vscode.executeDocumentColorProvider",n)}catch(e){}return t?t.map(e=>y.asColorInformation(e)):t}),d.onRequest(a.ColorPresentationRequest.type,async e=>{let t,n={uri:f.asUri(e.textDocument.uri),range:f.asRange(e.range)},s=new i.Color(e.color.red,e.color.green,e.color.blue,e.color.alpha);try{t=await i.commands.executeCommand("vscode.executeColorPresentationProvider",s,n)}catch(e){}return t?t.map(e=>y.asColorPresentation(e)):t}),d.onRequest(a.CodeLensRequest.type,async e=>{let t,n=f.asUri(e.textDocument.uri);try{t=await i.commands.executeCommand("vscode.executeCodeLensProvider",n,Number.MAX_VALUE)}catch(e){}return t?t.map(e=>(e.command&&(e.command=s.wrapCodeLensCommand(e.command,n,p,y)),p.asCodeLens(e))):t})}t.setupHandlers=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(30),s=n(191),r=n(5),o=n(7);class a{constructor(e,t,n,s){this.workspaceService=e,this.sessionContext=t,this.pathManager=n,this.rpcServiceHandler=s,this.requestHandlers=new Map,this.notificationHandlers=new Map,this.servicedRequests=0,this.rejectedRequests=0,this.unacknowledgedHostChangesRejects=0,this.rejectedRequestsDetails={},this.requestsThatDontNeedValidation=[i.InitializeRequest.type.method,i.ShutdownRequest.type.method,"liveshare/externalDocument","liveshare/load","liveshare/diagnosticsDocument"],this.trace=o.traceSource.withName(r.vsls.TraceSources.ClientLSP)}async initAsync(){await this.workspaceService.registerServicesAsync([a.SERVICE_NAME],r.vsls.CollectionChangeType.Add),this.rpcServiceHandler.addRequestMethod(a.SERVICE_NAME+".getMetadata",e=>({isLanguageClientProvider:!0,contentTypes:["any"]})),this.rpcServiceHandler.addRequestMethodWithContext(a.SERVICE_NAME+".request",async(e,t,n,i)=>await this.requestAsync(e,t,n,i)),this.notifyCookie=this.rpcServiceHandler.addNotificationHandler(a.SERVICE_NAME+".notify",async(e,t)=>{await this.notifyAsync(e,t)}),this.rpcServiceHandler.addRequestMethod(a.SERVICE_NAME+".load",e=>Promise.resolve())}async dispose(){s.summarizeLsRequests(this.servicedRequests,this.rejectedRequests,this.unacknowledgedHostChangesRejects,this.rejectedRequestsDetails),await this.workspaceService.registerServicesAsync([a.SERVICE_NAME],r.vsls.CollectionChangeType.Remove),this.rpcServiceHandler.removeRequestMethod(a.SERVICE_NAME+".request"),this.rpcServiceHandler.removeNotificationHandler(a.SERVICE_NAME+".notify",this.notifyCookie),this.rpcServiceHandler.removeRequestMethod(a.SERVICE_NAME+".load"),this.pathManager.dispose()}createProtocolConnection(){return{onRequest:(e,t)=>{this.requestHandlers.set(e.method,t)},onCustomRequest:(e,t)=>{this.requestHandlers.set(e,t)},onNotification:(e,t)=>{this.notificationHandlers.set(e.method,t)},sendNotification:(e,t)=>{const n={method:e,params:t};this.rpcServiceHandler.sendNotification(this.trace,a.SERVICE_NAME+".notified",{body:n})}}}async requestAsync(e,t,n,i){const s=e.method,r="textDocument/documentSymbol"===s?[]:null;if(t&&this.requestsThatDontNeedValidation.indexOf(s)<0){if(!this.canServiceRequest(t))return this.trace.info(`Rejected ${e.method} request`),this.rejectedRequests++,this.rejectedRequestsDetails[s]=this.rejectedRequestsDetails[s]?this.rejectedRequestsDetails[s]+1:1,r;this.servicedRequests++}let o=e.params;return this.requestHandlers.has(s)?(n&&(null==o?o={context:n}:"object"==typeof o&&(o.context=n)),await this.requestHandlers.get(s)(o,i)):r}canServiceRequest(e){if(this.sessionContext.coeditingClient.hasUnacknowledgedTextChanges)return this.unacknowledgedHostChangesRejects++,!1;let t=this.sessionContext.coeditingClient.textChangeHistory,n=t.length-1;if(n<0)return!0;if(-1===e.serverVersion)return!0;for(;n>=0&&t[n].changeServerVersion!==e.serverVersion;n--);if(n<0)return!1;for(n++;n<t.length;n++)if(t[n].clientId!==e.clientId)return!1;return!0}async notifyAsync(e,t){this.notificationHandlers.has(e.method)&&await this.notificationHandlers.get(e.method)(e.params)}}t.UniversalLanguageServerProvider=a,a.SERVICE_NAME="languageServerProvider-any"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isPromiseCanceledError=function(e){return e instanceof Error&&"Canceled"===e.name&&"Canceled"===e.message},t.canceled=function(){let e=new Error("Canceled");return e.name=e.message,e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(308),r=n(290),o=n(107),a=n(4),c=n(7);t.default=async function(e){const t=await r.CommunicationsManager.isChatEnabled(),n=await r.CommunicationsManager.isAudioEnabled(),l=(l,u)=>{const d=[],h=e=>{e&&d.push(e)},f=new a.ParticipantsTreeDataProvider(a.SessionContext,e.accessControlManager,o.ContactManager,u);if(d.push(f.registerCoEditing(a.SessionContext.coeditingClient)),h(l.registerTreeDataProvider(f)),a.sessionStateTracker.State===a.SessionState.Joined){const t=new a.TerminalsTreeDataProvider(e.sessionContext(),u,c.traceSource.withName("TerminalsTreeDataProvider"));d.push(t.registerTerminalService(e.terminalService())),h(l.registerTreeDataProvider(t))}if(a.ExtensionUtil.isNode()){const t=new a.ServerSharingTreeDataProvider(a.SessionContext,u,c.traceSource);t.registerServices(e.serverSharingService(),e.portForwardingService()),l.registerTreeDataProvider(t)}const p=new s.CommentsTreeDataProvider;if(d.push(p.registerService(s.reviewsDependencies.commentManager())),h(l.registerTreeDataProvider(p)),t){const e=new r.ChatTreeDataProvider;h(l.registerTreeDataProvider(e))}if(n){const t=new r.AudioTreeDataProvider(e.authService(),e.accessControlManager);h(l.registerTreeDataProvider(t))}return i.Disposable.from(...d)};return i.Disposable.from(l(e.activityBarProvider,!1),l(e.fileTreeExplorerProvider,!0))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4);t.initCoEditingContext=async function(e,t){const{userInfo:n}=await e.authService().getCurrentAuthenticatedUserAsync();return i.SessionContext.initCoEditingContext({joinCompleted:Promise.resolve(),isGuest:t,fileSystemService:e.fileService(),pathManager:e.pathManager(),sourceEventService:e.sourceEventService(),userInfo:n,clientAccessCheck:e.accessControlManager,fileSystemManager:e.fileSystemManager,syncService:e.syncService()})}},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(5),a=(n(314),n(7)),c=n(557),l=n(4);t.guestTerminalControllerFactory=e=>{const{controllerDecorator:t,telemetryMethodDecorator:n,errorNotificationMethodDecorator:u}=e.dependencies.methodDecorators();let d=class extends c.TerminalControllerBase{constructor(e){super(e.dependencies.terminalService,e.terminalEndpointBufferFactory,a.traceSource.withName("GuestTerminalController")),this.terminalsAwaitingWriteAccess=new Set,this.terminalsWithRejectedWriteAccess=new Set,this.isUserAskedToSignIn=!1,this.accessControlManager=e.accessControlManager}async activate(){if(this.isActivated)return!0;await super.activate(),l.ControllerHelper.register(this,this.sessionSubscriptions),this.sessionSubscriptions.push(this.terminalService.onTerminalStarted(this.onHostTerminalStarted,this),this.terminalService.onTerminalStopped(this.onHostTerminalStopped,this),this.accessControlManager().onDidRejectOperation(async e=>{if(e.operation.name===l.WellKnownRestrictedOperations.WriteToSharedTerminal){const t=e.operation;if(e.isReadOnlySession)return;e.isCurrentUserAnonymous?await this.terminalWriteAccessRejectedAnonymous(t.terminalId,t.isEscapeSequence):await this.terminalWriteAccessRejected(t.terminalId,t.isEscapeSequence)}}),this.accessControlManager().onDidChangeOperationAccess(async e=>{if(e.operation.name===l.WellKnownRestrictedOperations.WriteToSharedTerminal){const t=e.operation;await this.terminalWriteAccessChanged(t.terminalId,e.access)}})),this.deferredWork=this.deferredWork.then(()=>this.openSharedTerminalsOnJoin()).catch(e=>{this.trace.error(e.message)})}async terminalWriteAccessRejectedAnonymous(e,t){(await this.terminalService.getRunningTerminalsAsync()).find(t=>t.id===e)&&!this.isUserAskedToSignIn&&(this.isUserAskedToSignIn=!0,await l.askToSignInAndReload(l.localize("notification.CannotEditTheTerminal")),this.isUserAskedToSignIn=!1)}async terminalWriteAccessRejected(e,t){if(l.sessionStateTracker.State!==l.SessionState.Joined||this.terminalsAwaitingWriteAccess.has(e)||t)return;if(this.terminalsAwaitingWriteAccess.add(e),!(await this.terminalService.getRunningTerminalsAsync()).find(t=>t.id===e))return void this.terminalsAwaitingWriteAccess.delete(e);this.terminalsWithRejectedWriteAccess.delete(e);const n=await r.window.showInformationMessage("Cannot edit a read-only terminal.",{modal:!1},"Request read/write access");l.sessionStateTracker.State===l.SessionState.Joined?"Request read/write access"===n&&await this.accessControlManager().requestOperationAccess({name:l.WellKnownRestrictedOperations.WriteToSharedTerminal,sessionId:l.SessionContext.coeditingClient.clientID,terminalId:e}):this.terminalsAwaitingWriteAccess.delete(e)}async terminalWriteAccessChanged(e,t){if(!this.terminalsAwaitingWriteAccess.has(e))return;if(l.sessionStateTracker.State!==l.SessionState.Joined)return void this.terminalsAwaitingWriteAccess.delete(e);const n=t===o.vsls.RestrictedOperationAccess.Allowed;if(!n&&this.terminalsWithRejectedWriteAccess.has(e))return;const i=(await this.terminalService.getRunningTerminalsAsync()).find(t=>t.id===e);if(!i||l.sessionStateTracker.State!==l.SessionState.Joined)return this.terminalsAwaitingWriteAccess.delete(e),void this.terminalsWithRejectedWriteAccess.delete(e);n?(this.terminalsAwaitingWriteAccess.delete(e),this.terminalsWithRejectedWriteAccess.delete(e)):this.terminalsWithRejectedWriteAccess.add(e);const s=n?["Focus terminal"]:[];"Focus terminal"===await r.window.showInformationMessage(`The host ${n?"allowed":"didn't allow"} read/write access to '${i.options.name}' terminal.`,{modal:!1},...s)&&l.sessionStateTracker.State===l.SessionState.Joined&&await this.openTerminal({terminalId:e})}async openSharedTerminalsOnJoin(){try{const e=await this.updateSessionContext();await Promise.all(e.map(e=>this.createTerminal(e)))}catch(e){l.SessionContext.hasSharedTerminals=!1}}async listTerminals(){const e=await this.getRunningTerminalsAsync();if(0===e.length)return void await r.window.showInformationMessage("No terminals are currently shared in the collaboration session.",{modal:!1});let t=-1;if(1===e.length)t=0;else{const n=e.map((e,t)=>`${t+1}: ${e.options.name}`),i=await a.NotificationUtil.showQuickPick(n,{placeHolder:"Select shared terminal to open"});if(!i)return;t=n.indexOf(i)}return t>=0&&await this.createTerminal(e[t]),!0}async openTerminal(e){if(!e)return!1;const t=await this.terminalService.getRunningTerminalsAsync();for(const n of t.filter(t=>t.id===e.terminalId)){await this.createTerminal(n);break}return!0}async onHostTerminalStarted(e){await this.updateSessionContext(),await this.createTerminal(e.terminal)}async onHostTerminalStopped(){await this.updateSessionContext()}async updateSessionContext(){try{const e=await this.getRunningTerminalsAsync();return l.SessionContext.hasSharedTerminals=e.length>0,e}catch(e){this.trace.error("Checking for shared terminals failed: "+e)}}async getRunningTerminalsAsync(){try{return await this.terminalService.getRunningTerminalsAsync()}catch(e){if(-32601===e.code)return[];throw e}}};return i([u("Listing Terminals",l.TelemetryEventNames.LIST_TERMINALS_FAULT),n(l.TelemetryEventNames.LIST_TERMINALS,l.TelemetryEventNames.LIST_TERMINALS_FAULT,"ListTerminals"),l.commandBindingDecorator("liveshare.listTerminals"),s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",Promise)],d.prototype,"listTerminals",null),i([u("Opening Terminal",l.TelemetryEventNames.OPEN_TERMINAL_FAULT),n(l.TelemetryEventNames.OPEN_TERMINAL,l.TelemetryEventNames.OPEN_TERMINAL_FAULT,"OpenTerminal"),l.commandBindingDecorator("liveshare.fileTreeExplorer.openTerminal"),l.commandBindingDecorator("liveshare.activityBar.openTerminal"),s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Promise)],d.prototype,"openTerminal",null),d=i([t,s("design:paramtypes",[Object])],d),new d(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(7),r=n(314),o=n(4),a=n(1334);class c extends(s.Activatable(s.Disposable(Object))){constructor(e,t,n){super(),this.lazyTerminalService=e,this.terminalEndpointBufferFactory=t,this.trace=n,this.terminalCache=new r.TerminalCache,this.sessionSubscriptions=[],this.globalSubscriptions=[],this.deferredWork=Promise.resolve(),i.window.onDidCloseTerminal(e=>{this.terminalCache.remove(e)},null,this.globalSubscriptions)}get terminalService(){return this.lazyTerminalService()}async dispose(){await this.deferredWork,await this.deactivate(),this.globalSubscriptions.splice(0).forEach(e=>e.dispose()),this.terminalCache.clean(),o.SessionContext.hasSharedTerminals=!1,await super.dispose()}async deactivate(){await this.deferredWork,this.sessionSubscriptions.splice(0).forEach(e=>e.dispose()),this.terminalCache.clean(!0),await super.deactivate()}deferWork(e){this.deferredWork=this.deferredWork.then(e).catch(e=>{this.trace.error(e.message)})}createTerminal(e,t){return a.createJoinedTerminal({terminalService:this.terminalService,terminalCache:this.terminalCache,terminalEndpointBufferFactory:this.terminalEndpointBufferFactory,trace:this.trace},e,t)}}t.TerminalControllerBase=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4),s=n(556);t.GuestTerminalHandler=class{constructor(e){this.parameters=e,i.sessionStateTracker.State===i.SessionState.JoiningInProgress&&this.createGuestController()}async handleSessionStateChanged(e,t){switch(e){case i.SessionState.JoiningInProgress:this.createGuestController();break;case i.SessionState.Joined:await this.guestController.activate();break;default:this.guestController&&t===i.SessionState.Joined&&await this.guestController.deactivate()}}async dispose(){this.guestController&&await this.guestController.dispose()}createGuestController(){this.guestController=s.guestTerminalControllerFactory(this.parameters)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1337);t.NotebooksService=i.NotebooksService;var s=n(1338);t.HostNotebooksService=s.HostNotebooksService;var r=n(1339);t.GuestNotebooksService=r.GuestNotebooksService;var o=n(564);t.NotebookContentProvider=o.NotebookContentProvider;var a=n(560);t.HostCellManager=a.HostCellManager;var c=n(563);t.GuestCellManager=c.GuestCellManager},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(4),r=n(561);class o extends r.CellManager{constructor(e,t,n,i){super(e),this.pathManager=t,this.fileService=n,this.coediting=i,this.neighborOnDelete=new Map,this.changeQueue=Promise.resolve([]),this.init()}async init(){return this.initPromise||(this.initPromise=new Promise(async(e,t)=>{s.Settings.get(s.SettingKeys.shareExternalFiles)&&!i.workspace.getWorkspaceFolder(this.notebookDocument.uri)&&await this.fileService().registerExternalFilesAsync([this.notebookDocument.uri.toString()]);for(let e of this.notebookDocument.getCells()){await this.addIdToCell(e);const t=this.pathManager.localPathToRelativePath(e.document.uri);this.coediting.createSharedFileClient(t,e.document.getText(),!1,void 0,void 0,void 0,!0)}e()})),this.initPromise}async onDidChangeNotebookCells(e){return this.changeQueue=this.changeQueue.then(async()=>{const t=[];for(let n of e.changes){const e=n.start-1,i=s.getCellId(this.notebookDocument.getCells().find(t=>t.index===e)),r=n.deletedItems.map(e=>{const t=s.getCellId(e);return this.neighborOnDelete.set(t,i),t}),o=[];for(let e of n.items){this.isRemoteChange(e)||await this.addIdToCell(e);const t=this.pathManager.localPathToRelativePath(e.document.uri);this.coediting.createSharedFileClient(t,e.document.getText(),!1),o.push(s.getNotebookCellData(e))}const a=o.length>0?{idx:n.start,cells:o}:void 0;t.push({deletes:r,adds:a})}return t}),this.changeQueue}async applyChanges(e){for(let t of e){for(let e of t.deletes){const t=this.notebookDocument.getCells().find(t=>s.getCellId(t)===e);await this.deleteCell(t)}if(t.adds){let e=t.adds.insertAbove;for(;e&&this.neighborOnDelete.has(e);)e=this.neighborOnDelete.get(e);const n=e?this.notebookDocument.getCells().find(t=>s.getCellId(t)===e).index+1:0;await this.addCells(n,t.adds.cells)}}}}t.HostCellManager=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(49),r=n(4);t.CellManager=class{constructor(e){this.notebookDocument=e,this.remoteChanges=new Set}isRemoteChange(e){const t=r.getCellId(e);return!!t&&this.remoteChanges.has(t)}async addIdToCell(e){const t=r.getCellId(e);let n=t;if(t){this.notebookDocument.getCells().find(n=>n!==e&&r.getCellId(n)===t)&&(n=s())}else n=s();const o=new i.WorkspaceEdit,a=Object.assign({},e.metadata);a[r.NotebookConstants.cellIdPropertyName]=n,o.replaceNotebookCellMetadata(this.notebookDocument.uri,e.index,a),await i.workspace.applyEdit(o)}async deleteCell(e){const t=r.getCellId(e),n=new i.WorkspaceEdit,s=new i.NotebookRange(e.index,e.index+1);n.replaceNotebookCells(this.notebookDocument.uri,s,[]),this.remoteChanges.add(t),await i.workspace.applyEdit(n),this.remoteChanges.delete(t)}async addCells(e,t){const n=new i.WorkspaceEdit;t.forEach(e=>this.remoteChanges.add(r.getCellId(e)));const s=new i.NotebookRange(e,e);n.replaceNotebookCells(this.notebookDocument.uri,s,t),await i.workspace.applyEdit(n),t.forEach(e=>this.remoteChanges.delete(r.getCellId(e)))}async moveCell(e,t){const n=r.getNotebookCellData(e),s=r.getCellId(e),o=new i.WorkspaceEdit,a=new i.NotebookRange(t,t),c=new i.NotebookRange(e.index,e.index+1);o.replaceNotebookCells(this.notebookDocument.uri,a,[n]),o.replaceNotebookCells(this.notebookDocument.uri,c,[]),this.remoteChanges.add(s),await i.workspace.applyEdit(o),this.remoteChanges.delete(s)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(4);t.notebooksServiceBase=class{constructor(){this.cellLanguageMap={},this.disposables=[]}async dispose(){this.disposables.forEach(e=>e.dispose()),this.disposables=[]}init(){this.disposables.push(i.workspace.onDidCloseTextDocument(e=>this._onDidCloseTextDocument(e))),this.disposables.push(i.workspace.onDidOpenTextDocument(e=>this._onDidOpenTextDocument(e)))}_onDidCloseTextDocument(e){e.uri.scheme==s.PathManager.notebookCellScheme&&(this.cellLanguageMap[e.uri.toString()]=e.languageId)}_onDidOpenTextDocument(e){let t;const n=this.cellLanguageMap[e.uri.toString()];if(e.uri.scheme===s.PathManager.notebookCellScheme&&void 0!==n&&n!==e.languageId){const n=e.notebook.getCells().find(t=>t.document.uri.toString()===e.uri.toString());n&&(t=s.getCellId(n))}void 0!==t&&this.handleLanguageChange(e.notebook.uri,e.languageId,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4),s=n(561);class r extends s.CellManager{constructor(e,t,n){super(e),this.pathManager=t,this.coediting=n,this.hostNotebook=[],this.unacknowledgedChanges={deletes:[],adds:[]},this.hostNotebook=e.getCells().map(e=>Object.assign(Object.assign({},i.getNotebookCellData(e)),{index:e.index})),i.sortCells(this.hostNotebook),e.getCells().forEach(e=>this.createFileClient(e))}createFileClient(e){const t=this.pathManager.localPathToRelativePath(e.document.uri);this.coediting.createSharedFileClient(t,e.document.getText(),!1)}async onDidChangeNotebookCells(e){const t=[];for(let n of e.changes){const s=n.deletedItems.filter(e=>!this.isRemoteChange(e)).map(e=>i.getCellId(e));this.unacknowledgedChanges.deletes.push(...s);const r=[];for(let e of n.items)this.isRemoteChange(e)||(await this.addIdToCell(e),r.push(i.getNotebookCellData(e)),this.unacknowledgedChanges.adds.push(i.getCellId(e))),this.createFileClient(e);0===s.length&&0===r.length||t.push({deletes:s,adds:0===r.length?void 0:{insertAbove:0===n.start?void 0:i.getCellId(e.document.getCells().find(e=>e.index===n.start-1)),cells:r}})}return t}deleteHostCell(e){const t=this.hostNotebook.findIndex(t=>i.getCellId(t)===e);this.hostNotebook.splice(t,1);for(let e=t;e<this.hostNotebook.length;e++)this.hostNotebook[e].index--;const n=this.unacknowledgedChanges.deletes.findIndex(t=>t===e);n>=0&&this.unacknowledgedChanges.deletes.splice(n,1)}addHostCell(e,t){this.hostNotebook.splice(e,0,Object.assign(Object.assign({},t),{index:e}));for(let t=e+1;t<this.hostNotebook.length;t++)this.hostNotebook[t].index++;const n=i.getCellId(t),s=this.unacknowledgedChanges.adds.findIndex(e=>e===n);s>=0&&this.unacknowledgedChanges.adds.splice(s,1)}async onHostDidChangeNotebookCells(e){for(let t of e.changes){for(let e of t.deletes)this.deleteHostCell(e);if(t.adds)for(let e=0;e<t.adds.cells.length;e++)this.addHostCell(t.adds.idx+e,t.adds.cells[e])}const t=i.getNotebookHash(this.hostNotebook);i.assert(t===e.contentHash,"Guest representation of host notebook should match host notebook"),0===this.unacknowledgedChanges.deletes.length&&0===this.unacknowledgedChanges.adds.length&&await this.sync()}async sync(){const e=[];for(let t of this.notebookDocument.getCells()){const n=i.getCellId(t);this.hostNotebook.find(e=>i.getCellId(e)===n)?e.push(t):await this.deleteCell(t)}i.sortCells(e);for(let t=0,n=0;n<this.hostNotebook.length;t++,n++){const s=t<e.length?e[t]:void 0,r=this.hostNotebook[n];if(s){if(i.getCellId(s)!==i.getCellId(r)){const n=e.find(e=>i.getCellId(e)===i.getCellId(r));n?(await this.moveCell(n,r.index),e.splice(e.indexOf(n),1),t--):(await this.addCells(r.index,[r]),t--)}}else await this.addCells(r.index,[r])}this.checkSync()}checkSync(){const e=[...this.notebookDocument.getCells()];i.sortCells(e);const t=i.getNotebookHash(e),n=i.getNotebookHash(this.hostNotebook);i.assert(t===n,"Guest notebook should match host notebook after sync")}}t.GuestCellManager=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4);t.NotebookContentProvider=class{constructor(e,t){this.notebookType=e,this.notebooksService=t}async openNotebook(e){const t=await this.notebooksService.openNotebookAsync(e.path,this.notebookType);if(t.usedNotebookType)throw new Error(`${i.localize("notebooks.openWithDifferentNotebookTypeOnHost1")} ${t.usedNotebookType}. ${i.localize("notebooks.openWithDifferentNotebookTypeOnHost2")}`);return t}async saveNotebook(){}async saveNotebookAs(){}async backupNotebook(){return{id:"",delete:()=>{}}}}},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("af",{months:"Januarie_Februarie_Maart_April_Mei_Junie_Julie_Augustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mrt_Apr_Mei_Jun_Jul_Aug_Sep_Okt_Nov_Des".split("_"),weekdays:"Sondag_Maandag_Dinsdag_Woensdag_Donderdag_Vrydag_Saterdag".split("_"),weekdaysShort:"Son_Maa_Din_Woe_Don_Vry_Sat".split("_"),weekdaysMin:"So_Ma_Di_Wo_Do_Vr_Sa".split("_"),meridiemParse:/vm|nm/i,isPM:function(e){return/^nm$/i.test(e)},meridiem:function(e,t,n){return e<12?n?"vm":"VM":n?"nm":"NM"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Vandag om] LT",nextDay:"[Mre om] LT",nextWeek:"dddd [om] LT",lastDay:"[Gister om] LT",lastWeek:"[Laas] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oor %s",past:"%s gelede",s:"'n paar sekondes",ss:"%d sekondes",m:"'n minuut",mm:"%d minute",h:"'n uur",hh:"%d ure",d:"'n dag",dd:"%d dae",M:"'n maand",MM:"%d maande",y:"'n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},i=function(e){return 0===e?0:1===e?1:2===e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},s={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},r=function(e){return function(t,n,r,o){var a=i(t),c=s[e][i(t)];return 2===a&&(c=c[n?0:1]),c.replace(/%d/i,t)}},o=["","","","","","","","","","","",""];e.defineLocale("ar",{months:o,monthsShort:o,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:r("s"),ss:r("s"),m:r("m"),mm:r("m"),h:r("h"),hh:r("h"),d:r("d"),dd:r("d"),M:r("M"),MM:r("M"),y:r("y"),yy:r("y")},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]})).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]})).replace(/,/g,"")},week:{dow:6,doy:12}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t=function(e){return 0===e?0:1===e?1:2===e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},n={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},i=function(e){return function(i,s,r,o){var a=t(i),c=n[e][t(i)];return 2===a&&(c=c[s?0:1]),c.replace(/%d/i,i)}},s=["","","","","","","","","","","",""];e.defineLocale("ar-dz",{months:s,monthsShort:s,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:i("s"),ss:i("s"),m:i("m"),mm:i("m"),h:i("h"),hh:i("h"),d:i("d"),dd:i("d"),M:i("M"),MM:i("M"),y:i("y"),yy:i("y")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:0,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("ar-kw",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:0,doy:12}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",0:"0"},n=function(e){return 0===e?0:1===e?1:2===e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},i={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},s=function(e){return function(t,s,r,o){var a=n(t),c=i[e][n(t)];return 2===a&&(c=c[s?0:1]),c.replace(/%d/i,t)}},r=["","","","","","","","","","","",""];e.defineLocale("ar-ly",{months:r,monthsShort:r,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:s("s"),ss:s("s"),m:s("m"),mm:s("m"),h:s("h"),hh:s("h"),d:s("d"),dd:s("d"),M:s("M"),MM:s("M"),y:s("y"),yy:s("y")},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]})).replace(/,/g,"")},week:{dow:6,doy:12}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("ar-ma",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("ar-sa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]})).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]})).replace(/,/g,"")},week:{dow:0,doy:6}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("ar-tn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"-inci",5:"-inci",8:"-inci",70:"-inci",80:"-inci",2:"-nci",7:"-nci",20:"-nci",50:"-nci",3:"-nc",4:"-nc",100:"-nc",6:"-nc",9:"-uncu",10:"-uncu",30:"-uncu",60:"-nc",90:"-nc"};e.defineLocale("az",{months:"yanvar_fevral_mart_aprel_may_iyun_iyul_avqust_sentyabr_oktyabr_noyabr_dekabr".split("_"),monthsShort:"yan_fev_mar_apr_may_iyn_iyl_avq_sen_okt_noy_dek".split("_"),weekdays:"Bazar_Bazar ertsi_rnb axam_rnb_Cm axam_Cm_nb".split("_"),weekdaysShort:"Baz_BzE_Ax_r_CAx_Cm_n".split("_"),weekdaysMin:"Bz_BE_A__CA_C_".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[sabah saat] LT",nextWeek:"[gln hft] dddd [saat] LT",lastDay:"[dnn] LT",lastWeek:"[ken hft] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s vvl",s:"birne saniy",ss:"%d saniy",m:"bir dqiq",mm:"%d dqiq",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir il",yy:"%d il"},meridiemParse:/gec|shr|gndz|axam/,isPM:function(e){return/^(gndz|axam)$/.test(e)},meridiem:function(e,t,n){return e<4?"gec":e<12?"shr":e<17?"gndz":"axam"},dayOfMonthOrdinalParse:/\d{1,2}-(nc|inci|nci|nc|nc|uncu)/,ordinal:function(e){if(0===e)return e+"-nc";var n=e%10;return e+(t[n]||t[e%100-n]||t[e>=100?100:null])},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e,t,n){var i,s;return"m"===n?t?"":"":"h"===n?t?"":"":e+" "+(i=+e,s={ss:t?"__":"__",mm:t?"__":"__",hh:t?"__":"__",dd:"__",MM:"__",yy:"__"}[n].split("_"),i%10==1&&i%100!=11?s[0]:i%10>=2&&i%10<=4&&(i%100<10||i%100>=20)?s[1]:s[2])}e.defineLocale("be",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:{format:"______".split("_"),standalone:"______".split("_"),isFormat:/\[ ?[] ?(?:|)? ?\] ?dddd/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:function(){return"[] dddd [] LT"},lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:t,mm:t,h:t,hh:t,d:"",dd:t,M:"",MM:t,y:"",yy:t},meridiemParse:/|||/,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e,t,n){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(||)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":case"w":case"W":return e%10!=2&&e%10!=3||e%100==12||e%100==13?e+"-":e+"-";case"D":return e+"-";default:return e}},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("bg",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[] dddd [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||||)/,ordinal:function(e){var t=e%10,n=e%100;return 0===e?e+"-":0===n?e+"-":n>10&&n<20?e+"-":1===t?e+"-":2===t?e+"-":7===t||8===t?e+"-":e+"-"},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("bm",{months:"Zanwuyekalo_Fewuruyekalo_Marisikalo_Awirilikalo_Mkalo_Zuwnkalo_Zuluyekalo_Utikalo_Stanburukalo_kutburukalo_Nowanburukalo_Desanburukalo".split("_"),monthsShort:"Zan_Few_Mar_Awi_M_Zuw_Zul_Uti_St_ku_Now_Des".split("_"),weekdays:"Kari_Ntnn_Tarata_Araba_Alamisa_Juma_Sibiri".split("_"),weekdaysShort:"Kar_Nt_Tar_Ara_Ala_Jum_Sib".split("_"),weekdaysMin:"Ka_Nt_Ta_Ar_Al_Ju_Si".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"MMMM [tile] D [san] YYYY",LLL:"MMMM [tile] D [san] YYYY [lr] HH:mm",LLLL:"dddd MMMM [tile] D [san] YYYY [lr] HH:mm"},calendar:{sameDay:"[Bi lr] LT",nextDay:"[Sini lr] LT",nextWeek:"dddd [don lr] LT",lastDay:"[Kunu lr] LT",lastWeek:"dddd [tmnen lr] LT",sameElse:"L"},relativeTime:{future:"%s kn",past:"a b %s b",s:"sanga dama dama",ss:"sekondi %d",m:"miniti kelen",mm:"miniti %d",h:"lr kelen",hh:"lr %d",d:"tile kelen",dd:"tile %d",M:"kalo kelen",MM:"kalo %d",y:"san kelen",yy:"san %d"},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("bn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t&&e>=4||""===t&&e<5||""===t?e+12:e},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("bo",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShortRegex:/^(\d{1,2})/,monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[], LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t&&e>=4||""===t&&e<5||""===t?e+12:e},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e,t,n){return e+" "+function(e,t){return 2===t?function(e){var t={m:"v",b:"v",d:"z"};return void 0===t[e.charAt(0)]?e:t[e.charAt(0)]+e.substring(1)}(e):e}({mm:"munutenn",MM:"miz",dd:"devezh"}[n],e)}var n=[/^gen/i,/^c[\']hwe/i,/^meu/i,/^ebr/i,/^mae/i,/^(mez|eve)/i,/^gou/i,/^eos/i,/^gwe/i,/^her/i,/^du/i,/^ker/i],i=/^(genver|c[\']hwevrer|meurzh|ebrel|mae|mezheven|gouere|eost|gwengolo|here|du|kerzu|gen|c[\']hwe|meu|ebr|mae|eve|gou|eos|gwe|her|du|ker)/i,s=[/^Su/i,/^Lu/i,/^Me([^r]|$)/i,/^Mer/i,/^Ya/i,/^Gw/i,/^Sa/i];e.defineLocale("br",{months:"Genver_Chwevrer_Meurzh_Ebrel_Mae_Mezheven_Gouere_Eost_Gwengolo_Here_Du_Kerzu".split("_"),monthsShort:"Gen_Chwe_Meu_Ebr_Mae_Eve_Gou_Eos_Gwe_Her_Du_Ker".split("_"),weekdays:"Sul_Lun_Meurzh_Mercher_Yaou_Gwener_Sadorn".split("_"),weekdaysShort:"Sul_Lun_Meu_Mer_Yao_Gwe_Sad".split("_"),weekdaysMin:"Su_Lu_Me_Mer_Ya_Gw_Sa".split("_"),weekdaysParse:s,fullWeekdaysParse:[/^sul/i,/^lun/i,/^meurzh/i,/^merc[\']her/i,/^yaou/i,/^gwener/i,/^sadorn/i],shortWeekdaysParse:[/^Sul/i,/^Lun/i,/^Meu/i,/^Mer/i,/^Yao/i,/^Gwe/i,/^Sad/i],minWeekdaysParse:s,monthsRegex:i,monthsShortRegex:i,monthsStrictRegex:/^(genver|c[\']hwevrer|meurzh|ebrel|mae|mezheven|gouere|eost|gwengolo|here|du|kerzu)/i,monthsShortStrictRegex:/^(gen|c[\']hwe|meu|ebr|mae|eve|gou|eos|gwe|her|du|ker)/i,monthsParse:n,longMonthsParse:n,shortMonthsParse:n,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [a viz] MMMM YYYY",LLL:"D [a viz] MMMM YYYY HH:mm",LLLL:"dddd, D [a viz] MMMM YYYY HH:mm"},calendar:{sameDay:"[Hiziv da] LT",nextDay:"[Warchoazh da] LT",nextWeek:"dddd [da] LT",lastDay:"[Dech da] LT",lastWeek:"dddd [paset da] LT",sameElse:"L"},relativeTime:{future:"a-benn %s",past:"%s zo",s:"un nebeud segondenno",ss:"%d eilenn",m:"ur vunutenn",mm:t,h:"un eur",hh:"%d eur",d:"un devezh",dd:t,M:"ur miz",MM:t,y:"ur bloaz",yy:function(e){switch(function e(t){return t>9?e(t%10):t}(e)){case 1:case 3:case 4:case 5:case 9:return e+" bloaz";default:return e+" vloaz"}}},dayOfMonthOrdinalParse:/\d{1,2}(a|vet)/,ordinal:function(e){return e+(1===e?"a":"vet")},week:{dow:1,doy:4},meridiemParse:/a.m.|g.m./,isPM:function(e){return"g.m."===e},meridiem:function(e,t,n){return e<12?"a.m.":"g.m."}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e,t,n){var i=e+" ";switch(n){case"ss":return i+=1===e?"sekunda":2===e||3===e||4===e?"sekunde":"sekundi";case"m":return t?"jedna minuta":"jedne minute";case"mm":return i+=1===e?"minuta":2===e||3===e||4===e?"minute":"minuta";case"h":return t?"jedan sat":"jednog sata";case"hh":return i+=1===e?"sat":2===e||3===e||4===e?"sata":"sati";case"dd":return i+=1===e?"dan":"dana";case"MM":return i+=1===e?"mjesec":2===e||3===e||4===e?"mjeseca":"mjeseci";case"yy":return i+=1===e?"godina":2===e||3===e||4===e?"godine":"godina"}}e.defineLocale("bs",{months:"januar_februar_mart_april_maj_juni_juli_august_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._aug._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",ss:t,m:t,mm:t,h:t,hh:t,d:"dan",dd:t,M:"mjesec",MM:t,y:"godinu",yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("ca",{months:{standalone:"gener_febrer_mar_abril_maig_juny_juliol_agost_setembre_octubre_novembre_desembre".split("_"),format:"de gener_de febrer_de mar_d'abril_de maig_de juny_de juliol_d'agost_de setembre_d'octubre_de novembre_de desembre".split("_"),isFormat:/D[oD]?(\s)+MMMM/},monthsShort:"gen._febr._mar_abr._maig_juny_jul._ag._set._oct._nov._des.".split("_"),monthsParseExact:!0,weekdays:"diumenge_dilluns_dimarts_dimecres_dijous_divendres_dissabte".split("_"),weekdaysShort:"dg._dl._dt._dc._dj._dv._ds.".split("_"),weekdaysMin:"dg_dl_dt_dc_dj_dv_ds".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [de] YYYY",ll:"D MMM YYYY",LLL:"D MMMM [de] YYYY [a les] H:mm",lll:"D MMM YYYY, H:mm",LLLL:"dddd D MMMM [de] YYYY [a les] H:mm",llll:"ddd D MMM YYYY, H:mm"},calendar:{sameDay:function(){return"[avui a "+(1!==this.hours()?"les":"la")+"] LT"},nextDay:function(){return"[dem a "+(1!==this.hours()?"les":"la")+"] LT"},nextWeek:function(){return"dddd [a "+(1!==this.hours()?"les":"la")+"] LT"},lastDay:function(){return"[ahir a "+(1!==this.hours()?"les":"la")+"] LT"},lastWeek:function(){return"[el] dddd [passat a "+(1!==this.hours()?"les":"la")+"] LT"},sameElse:"L"},relativeTime:{future:"d'aqu %s",past:"fa %s",s:"uns segons",ss:"%d segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},dayOfMonthOrdinalParse:/\d{1,2}(r|n|t||a)/,ordinal:function(e,t){var n=1===e?"r":2===e?"n":3===e?"r":4===e?"t":"";return"w"!==t&&"W"!==t||(n="a"),e+n},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t="leden_nor_bezen_duben_kvten_erven_ervenec_srpen_z_jen_listopad_prosinec".split("_"),n="led_no_be_dub_kv_vn_vc_srp_z_j_lis_pro".split("_"),i=[/^led/i,/^no/i,/^be/i,/^dub/i,/^kv/i,/^(vn|erven$|ervna)/i,/^(vc|ervenec|ervence)/i,/^srp/i,/^z/i,/^j/i,/^lis/i,/^pro/i],s=/^(leden|nor|bezen|duben|kvten|ervenec|ervence|erven|ervna|srpen|z|jen|listopad|prosinec|led|no|be|dub|kv|vn|vc|srp|z|j|lis|pro)/i;function r(e){return e>1&&e<5&&1!=~~(e/10)}function o(e,t,n,i){var s=e+" ";switch(n){case"s":return t||i?"pr sekund":"pr sekundami";case"ss":return t||i?s+(r(e)?"sekundy":"sekund"):s+"sekundami";case"m":return t?"minuta":i?"minutu":"minutou";case"mm":return t||i?s+(r(e)?"minuty":"minut"):s+"minutami";case"h":return t?"hodina":i?"hodinu":"hodinou";case"hh":return t||i?s+(r(e)?"hodiny":"hodin"):s+"hodinami";case"d":return t||i?"den":"dnem";case"dd":return t||i?s+(r(e)?"dny":"dn"):s+"dny";case"M":return t||i?"msc":"mscem";case"MM":return t||i?s+(r(e)?"msce":"msc"):s+"msci";case"y":return t||i?"rok":"rokem";case"yy":return t||i?s+(r(e)?"roky":"let"):s+"lety"}}e.defineLocale("cs",{months:t,monthsShort:n,monthsRegex:s,monthsShortRegex:s,monthsStrictRegex:/^(leden|ledna|nora|nor|bezen|bezna|duben|dubna|kvten|kvtna|ervenec|ervence|erven|ervna|srpen|srpna|z|jen|jna|listopadu|listopad|prosinec|prosince)/i,monthsShortStrictRegex:/^(led|no|be|dub|kv|vn|vc|srp|z|j|lis|pro)/i,monthsParse:i,longMonthsParse:i,shortMonthsParse:i,weekdays:"nedle_pondl_ter_steda_tvrtek_ptek_sobota".split("_"),weekdaysShort:"ne_po_t_st_t_p_so".split("_"),weekdaysMin:"ne_po_t_st_t_p_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm",l:"D. M. YYYY"},calendar:{sameDay:"[dnes v] LT",nextDay:"[ztra v] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedli v] LT";case 1:case 2:return"[v] dddd [v] LT";case 3:return"[ve stedu v] LT";case 4:return"[ve tvrtek v] LT";case 5:return"[v ptek v] LT";case 6:return"[v sobotu v] LT"}},lastDay:"[vera v] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulou nedli v] LT";case 1:case 2:return"[minul] dddd [v] LT";case 3:return"[minulou stedu v] LT";case 4:case 5:return"[minul] dddd [v] LT";case 6:return"[minulou sobotu v] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"ped %s",s:o,ss:o,m:o,mm:o,h:o,hh:o,d:o,dd:o,M:o,MM:o,y:o,yy:o},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("cv",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"YYYY [] MMMM [] D[-]",LLL:"YYYY [] MMMM [] D[-], HH:mm",LLLL:"dddd, YYYY [] MMMM [] D[-], HH:mm"},calendar:{sameDay:"[] LT []",nextDay:"[] LT []",lastDay:"[] LT []",nextWeek:"[] dddd LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:function(e){return e+(/$/i.exec(e)?"":/$/i.exec(e)?"":"")},past:"%s ",s:"- ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-/,ordinal:"%d-",week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("cy",{months:"Ionawr_Chwefror_Mawrth_Ebrill_Mai_Mehefin_Gorffennaf_Awst_Medi_Hydref_Tachwedd_Rhagfyr".split("_"),monthsShort:"Ion_Chwe_Maw_Ebr_Mai_Meh_Gor_Aws_Med_Hyd_Tach_Rhag".split("_"),weekdays:"Dydd Sul_Dydd Llun_Dydd Mawrth_Dydd Mercher_Dydd Iau_Dydd Gwener_Dydd Sadwrn".split("_"),weekdaysShort:"Sul_Llun_Maw_Mer_Iau_Gwe_Sad".split("_"),weekdaysMin:"Su_Ll_Ma_Me_Ia_Gw_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Heddiw am] LT",nextDay:"[Yfory am] LT",nextWeek:"dddd [am] LT",lastDay:"[Ddoe am] LT",lastWeek:"dddd [diwethaf am] LT",sameElse:"L"},relativeTime:{future:"mewn %s",past:"%s yn l",s:"ychydig eiliadau",ss:"%d eiliad",m:"munud",mm:"%d munud",h:"awr",hh:"%d awr",d:"diwrnod",dd:"%d diwrnod",M:"mis",MM:"%d mis",y:"blwyddyn",yy:"%d flynedd"},dayOfMonthOrdinalParse:/\d{1,2}(fed|ain|af|il|ydd|ed|eg)/,ordinal:function(e){var t="";return e>20?t=40===e||50===e||60===e||80===e||100===e?"fed":"ain":e>0&&(t=["","af","il","ydd","ydd","ed","ed","ed","fed","fed","fed","eg","fed","eg","eg","fed","eg","eg","fed","eg","fed"][e]),e+t},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("da",{months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_man_tir_ons_tor_fre_lr".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd [d.] D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"p dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[i] dddd[s kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"f sekunder",ss:"%d sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en mned",MM:"%d mneder",y:"et r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e,t,n,i){var s={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],w:["eine Woche","einer Woche"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?s[n][0]:s[n][1]}e.defineLocale("de",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,w:t,ww:"%d Wochen",M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e,t,n,i){var s={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],w:["eine Woche","einer Woche"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?s[n][0]:s[n][1]}e.defineLocale("de-at",{months:"Jnner_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jn._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,w:t,ww:"%d Wochen",M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e,t,n,i){var s={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],w:["eine Woche","einer Woche"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?s[n][0]:s[n][1]}e.defineLocale("de-ch",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,w:t,ww:"%d Wochen",M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t=["","","","","","","","","","","",""],n=["","","","","","",""];e.defineLocale("dv",{months:t,monthsShort:t,weekdays:n,weekdaysShort:n,weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd LT",lastDay:"[] LT",lastWeek:"[] dddd LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"d% ",m:"",mm:" %d",h:"",hh:" %d",d:"",dd:" %d",M:"",MM:" %d",y:"",yy:" %d"},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:7,doy:12}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("el",{monthsNominativeEl:"___________".split("_"),monthsGenitiveEl:"___________".split("_"),months:function(e,t){return e?"string"==typeof t&&/D/.test(t.substring(0,t.indexOf("MMMM")))?this._monthsGenitiveEl[e.month()]:this._monthsNominativeEl[e.month()]:this._monthsNominativeEl},monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),meridiem:function(e,t,n){return e>11?n?"":"":n?"":""},isPM:function(e){return""===(e+"").toLowerCase()[0]},meridiemParse:/[]\.??\.?/i,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendarEl:{sameDay:"[ {}] LT",nextDay:"[ {}] LT",nextWeek:"dddd [{}] LT",lastDay:"[ {}] LT",lastWeek:function(){switch(this.day()){case 6:return"[ ] dddd [{}] LT";default:return"[ ] dddd [{}] LT"}},sameElse:"L"},calendar:function(e,t){var n,i=this._calendarEl[e],s=t&&t.hours();return n=i,("undefined"!=typeof Function&&n instanceof Function||"[object Function]"===Object.prototype.toString.call(n))&&(i=i.apply(t)),i.replace("{}",s%12==1?"":"")},relativeTime:{future:" %s",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("en-au",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:0,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("en-ca",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"YYYY-MM-DD",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("en-ie",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("en-il",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("en-in",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:0,doy:6}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("en-nz",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("en-sg",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("eo",{months:"januaro_februaro_marto_aprilo_majo_junio_julio_agusto_septembro_oktobro_novembro_decembro".split("_"),monthsShort:"jan_feb_mart_apr_maj_jun_jul_ag_sept_okt_nov_dec".split("_"),weekdays:"dimano_lundo_mardo_merkredo_ado_vendredo_sabato".split("_"),weekdaysShort:"dim_lun_mard_merk_a_ven_sab".split("_"),weekdaysMin:"di_lu_ma_me_a_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"[la] D[-an de] MMMM, YYYY",LLL:"[la] D[-an de] MMMM, YYYY HH:mm",LLLL:"dddd[n], [la] D[-an de] MMMM, YYYY HH:mm",llll:"ddd, [la] D[-an de] MMM, YYYY HH:mm"},meridiemParse:/[ap]\.t\.m/i,isPM:function(e){return"p"===e.charAt(0).toLowerCase()},meridiem:function(e,t,n){return e>11?n?"p.t.m.":"P.T.M.":n?"a.t.m.":"A.T.M."},calendar:{sameDay:"[Hodia je] LT",nextDay:"[Morga je] LT",nextWeek:"dddd[n je] LT",lastDay:"[Hiera je] LT",lastWeek:"[pasintan] dddd[n je] LT",sameElse:"L"},relativeTime:{future:"post %s",past:"anta %s",s:"kelkaj sekundoj",ss:"%d sekundoj",m:"unu minuto",mm:"%d minutoj",h:"unu horo",hh:"%d horoj",d:"unu tago",dd:"%d tagoj",M:"unu monato",MM:"%d monatoj",y:"unu jaro",yy:"%d jaroj"},dayOfMonthOrdinalParse:/\d{1,2}a/,ordinal:"%da",week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),n="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),i=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],s=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;e.defineLocale("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,i){return e?/-MMM-/.test(i)?n[e.month()]:t[e.month()]:t},monthsRegex:s,monthsShortRegex:s,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:i,longMonthsParse:i,shortMonthsParse:i,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4},invalidDate:"Fecha invalida"})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),n="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),i=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],s=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;e.defineLocale("es-do",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,i){return e?/-MMM-/.test(i)?n[e.month()]:t[e.month()]:t},monthsRegex:s,monthsShortRegex:s,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:i,longMonthsParse:i,shortMonthsParse:i,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY h:mm A",LLLL:"dddd, D [de] MMMM [de] YYYY h:mm A"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),n="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),i=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],s=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;e.defineLocale("es-us",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,i){return e?/-MMM-/.test(i)?n[e.month()]:t[e.month()]:t},monthsRegex:s,monthsShortRegex:s,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:i,longMonthsParse:i,shortMonthsParse:i,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"MM/DD/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY h:mm A",LLLL:"dddd, D [de] MMMM [de] YYYY h:mm A"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:0,doy:6}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e,t,n,i){var s={s:["mne sekundi","mni sekund","paar sekundit"],ss:[e+"sekundi",e+"sekundit"],m:["he minuti","ks minut"],mm:[e+" minuti",e+" minutit"],h:["he tunni","tund aega","ks tund"],hh:[e+" tunni",e+" tundi"],d:["he peva","ks pev"],M:["kuu aja","kuu aega","ks kuu"],MM:[e+" kuu",e+" kuud"],y:["he aasta","aasta","ks aasta"],yy:[e+" aasta",e+" aastat"]};return t?s[n][2]?s[n][2]:s[n][1]:i?s[n][0]:s[n][1]}e.defineLocale("et",{months:"jaanuar_veebruar_mrts_aprill_mai_juuni_juuli_august_september_oktoober_november_detsember".split("_"),monthsShort:"jaan_veebr_mrts_apr_mai_juuni_juuli_aug_sept_okt_nov_dets".split("_"),weekdays:"phapev_esmaspev_teisipev_kolmapev_neljapev_reede_laupev".split("_"),weekdaysShort:"P_E_T_K_N_R_L".split("_"),weekdaysMin:"P_E_T_K_N_R_L".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[Tna,] LT",nextDay:"[Homme,] LT",nextWeek:"[Jrgmine] dddd LT",lastDay:"[Eile,] LT",lastWeek:"[Eelmine] dddd LT",sameElse:"L"},relativeTime:{future:"%s prast",past:"%s tagasi",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:"%d peva",M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("eu",{months:"urtarrila_otsaila_martxoa_apirila_maiatza_ekaina_uztaila_abuztua_iraila_urria_azaroa_abendua".split("_"),monthsShort:"urt._ots._mar._api._mai._eka._uzt._abu._ira._urr._aza._abe.".split("_"),monthsParseExact:!0,weekdays:"igandea_astelehena_asteartea_asteazkena_osteguna_ostirala_larunbata".split("_"),weekdaysShort:"ig._al._ar._az._og._ol._lr.".split("_"),weekdaysMin:"ig_al_ar_az_og_ol_lr".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY[ko] MMMM[ren] D[a]",LLL:"YYYY[ko] MMMM[ren] D[a] HH:mm",LLLL:"dddd, YYYY[ko] MMMM[ren] D[a] HH:mm",l:"YYYY-M-D",ll:"YYYY[ko] MMM D[a]",lll:"YYYY[ko] MMM D[a] HH:mm",llll:"ddd, YYYY[ko] MMM D[a] HH:mm"},calendar:{sameDay:"[gaur] LT[etan]",nextDay:"[bihar] LT[etan]",nextWeek:"dddd LT[etan]",lastDay:"[atzo] LT[etan]",lastWeek:"[aurreko] dddd LT[etan]",sameElse:"L"},relativeTime:{future:"%s barru",past:"duela %s",s:"segundo batzuk",ss:"%d segundo",m:"minutu bat",mm:"%d minutu",h:"ordu bat",hh:"%d ordu",d:"egun bat",dd:"%d egun",M:"hilabete bat",MM:"%d hilabete",y:"urte bat",yy:"%d urte"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("fa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/  |  /,isPM:function(e){return/  /.test(e)},meridiem:function(e,t,n){return e<12?"  ":"  "},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[-]/g,(function(e){return n[e]})).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]})).replace(/,/g,"")},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:6,doy:12}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t="nolla yksi kaksi kolme nelj viisi kuusi seitsemn kahdeksan yhdeksn".split(" "),n=["nolla","yhden","kahden","kolmen","neljn","viiden","kuuden",t[7],t[8],t[9]];function i(e,i,s,r){var o="";switch(s){case"s":return r?"muutaman sekunnin":"muutama sekunti";case"ss":o=r?"sekunnin":"sekuntia";break;case"m":return r?"minuutin":"minuutti";case"mm":o=r?"minuutin":"minuuttia";break;case"h":return r?"tunnin":"tunti";case"hh":o=r?"tunnin":"tuntia";break;case"d":return r?"pivn":"piv";case"dd":o=r?"pivn":"piv";break;case"M":return r?"kuukauden":"kuukausi";case"MM":o=r?"kuukauden":"kuukautta";break;case"y":return r?"vuoden":"vuosi";case"yy":o=r?"vuoden":"vuotta"}return o=function(e,i){return e<10?i?n[e]:t[e]:e}(e,r)+" "+o}e.defineLocale("fi",{months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_keskuu_heinkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kes_hein_elo_syys_loka_marras_joulu".split("_"),weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"Do MMMM[ta] YYYY",LLL:"Do MMMM[ta] YYYY, [klo] HH.mm",LLLL:"dddd, Do MMMM[ta] YYYY, [klo] HH.mm",l:"D.M.YYYY",ll:"Do MMM YYYY",lll:"Do MMM YYYY, [klo] HH.mm",llll:"ddd, Do MMM YYYY, [klo] HH.mm"},calendar:{sameDay:"[tnn] [klo] LT",nextDay:"[huomenna] [klo] LT",nextWeek:"dddd [klo] LT",lastDay:"[eilen] [klo] LT",lastWeek:"[viime] dddd[na] [klo] LT",sameElse:"L"},relativeTime:{future:"%s pst",past:"%s sitten",s:i,ss:i,m:i,mm:i,h:i,hh:i,d:i,dd:i,M:i,MM:i,y:i,yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("fil",{months:"Enero_Pebrero_Marso_Abril_Mayo_Hunyo_Hulyo_Agosto_Setyembre_Oktubre_Nobyembre_Disyembre".split("_"),monthsShort:"Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"),weekdays:"Linggo_Lunes_Martes_Miyerkules_Huwebes_Biyernes_Sabado".split("_"),weekdaysShort:"Lin_Lun_Mar_Miy_Huw_Biy_Sab".split("_"),weekdaysMin:"Li_Lu_Ma_Mi_Hu_Bi_Sab".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"MM/D/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY HH:mm",LLLL:"dddd, MMMM DD, YYYY HH:mm"},calendar:{sameDay:"LT [ngayong araw]",nextDay:"[Bukas ng] LT",nextWeek:"LT [sa susunod na] dddd",lastDay:"LT [kahapon]",lastWeek:"LT [noong nakaraang] dddd",sameElse:"L"},relativeTime:{future:"sa loob ng %s",past:"%s ang nakalipas",s:"ilang segundo",ss:"%d segundo",m:"isang minuto",mm:"%d minuto",h:"isang oras",hh:"%d oras",d:"isang araw",dd:"%d araw",M:"isang buwan",MM:"%d buwan",y:"isang taon",yy:"%d taon"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("fo",{months:"januar_februar_mars_aprl_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sunnudagur_mnadagur_tsdagur_mikudagur_hsdagur_frggjadagur_leygardagur".split("_"),weekdaysShort:"sun_mn_ts_mik_hs_fr_ley".split("_"),weekdaysMin:"su_m_t_mi_h_fr_le".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D. MMMM, YYYY HH:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgin kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gjr kl.] LT",lastWeek:"[sstu] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"um %s",past:"%s sani",s:"f sekund",ss:"%d sekundir",m:"ein minuttur",mm:"%d minuttir",h:"ein tmi",hh:"%d tmar",d:"ein dagur",dd:"%d dagar",M:"ein mnaur",MM:"%d mnair",y:"eitt r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t=/(janv\.?|fvr\.?|mars|avr\.?|mai|juin|juil\.?|aot|sept\.?|oct\.?|nov\.?|dc\.?|janvier|fvrier|mars|avril|mai|juin|juillet|aot|septembre|octobre|novembre|dcembre)/i,n=[/^janv/i,/^fvr/i,/^mars/i,/^avr/i,/^mai/i,/^juin/i,/^juil/i,/^aot/i,/^sept/i,/^oct/i,/^nov/i,/^dc/i];e.defineLocale("fr",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsRegex:t,monthsShortRegex:t,monthsStrictRegex:/^(janvier|fvrier|mars|avril|mai|juin|juillet|aot|septembre|octobre|novembre|dcembre)/i,monthsShortStrictRegex:/(janv\.?|fvr\.?|mars|avr\.?|mai|juin|juil\.?|aot|sept\.?|oct\.?|nov\.?|dc\.?)/i,monthsParse:n,longMonthsParse:n,shortMonthsParse:n,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|)/,ordinal:function(e,t){switch(t){case"D":return e+(1===e?"er":"");default:case"M":case"Q":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("fr-ca",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(e,t){switch(t){default:case"M":case"Q":case"D":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("fr-ch",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(e,t){switch(t){default:case"M":case"Q":case"D":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t="jan._feb._mrt._apr._mai_jun._jul._aug._sep._okt._nov._des.".split("_"),n="jan_feb_mrt_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_");e.defineLocale("fy",{months:"jannewaris_febrewaris_maart_april_maaie_juny_july_augustus_septimber_oktober_novimber_desimber".split("_"),monthsShort:function(e,i){return e?/-MMM-/.test(i)?n[e.month()]:t[e.month()]:t},monthsParseExact:!0,weekdays:"snein_moandei_tiisdei_woansdei_tongersdei_freed_sneon".split("_"),weekdaysShort:"si._mo._ti._wo._to._fr._so.".split("_"),weekdaysMin:"Si_Mo_Ti_Wo_To_Fr_So".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[hjoed om] LT",nextDay:"[moarn om] LT",nextWeek:"dddd [om] LT",lastDay:"[juster om] LT",lastWeek:"[frne] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oer %s",past:"%s lyn",s:"in pear sekonden",ss:"%d sekonden",m:"ien mint",mm:"%d minuten",h:"ien oere",hh:"%d oeren",d:"ien dei",dd:"%d dagen",M:"ien moanne",MM:"%d moannen",y:"ien jier",yy:"%d jierren"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("ga",{months:["Eanir","Feabhra","Mrta","Aibren","Bealtaine","Meitheamh","Iil","Lnasa","Men Fmhair","Deireadh Fmhair","Samhain","Nollaig"],monthsShort:["Ean","Feabh","Mrt","Aib","Beal","Meith","Iil","Ln","M.F.","D.F.","Samh","Noll"],monthsParseExact:!0,weekdays:["D Domhnaigh","D Luain","D Mirt","D Cadaoin","Dardaoin","D hAoine","D Sathairn"],weekdaysShort:["Domh","Luan","Mirt","Cad","Dar","Aoine","Sath"],weekdaysMin:["Do","Lu","M","C","D","A","Sa"],longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Inniu ag] LT",nextDay:"[Amrach ag] LT",nextWeek:"dddd [ag] LT",lastDay:"[Inn ag] LT",lastWeek:"dddd [seo caite] [ag] LT",sameElse:"L"},relativeTime:{future:"i %s",past:"%s  shin",s:"cpla soicind",ss:"%d soicind",m:"nimad",mm:"%d nimad",h:"uair an chloig",hh:"%d uair an chloig",d:"l",dd:"%d l",M:"m",MM:"%d monna",y:"bliain",yy:"%d bliain"},dayOfMonthOrdinalParse:/\d{1,2}(d|na|mh)/,ordinal:function(e){return e+(1===e?"d":e%10==2?"na":"mh")},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("gd",{months:["Am Faoilleach","An Gearran","Am Mrt","An Giblean","An Citean","An t-gmhios","An t-Iuchar","An Lnastal","An t-Sultain","An Dmhair","An t-Samhain","An Dbhlachd"],monthsShort:["Faoi","Gear","Mrt","Gibl","Cit","gmh","Iuch","Ln","Sult","Dmh","Samh","Dbh"],monthsParseExact:!0,weekdays:["Didmhnaich","Diluain","Dimirt","Diciadain","Diardaoin","Dihaoine","Disathairne"],weekdaysShort:["Did","Dil","Dim","Dic","Dia","Dih","Dis"],weekdaysMin:["D","Lu","M","Ci","Ar","Ha","Sa"],longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[An-diugh aig] LT",nextDay:"[A-mireach aig] LT",nextWeek:"dddd [aig] LT",lastDay:"[An-d aig] LT",lastWeek:"dddd [seo chaidh] [aig] LT",sameElse:"L"},relativeTime:{future:"ann an %s",past:"bho chionn %s",s:"beagan diogan",ss:"%d diogan",m:"mionaid",mm:"%d mionaidean",h:"uair",hh:"%d uairean",d:"latha",dd:"%d latha",M:"mos",MM:"%d mosan",y:"bliadhna",yy:"%d bliadhna"},dayOfMonthOrdinalParse:/\d{1,2}(d|na|mh)/,ordinal:function(e){return e+(1===e?"d":e%10==2?"na":"mh")},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("gl",{months:"xaneiro_febreiro_marzo_abril_maio_xuo_xullo_agosto_setembro_outubro_novembro_decembro".split("_"),monthsShort:"xan._feb._mar._abr._mai._xu._xul._ago._set._out._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"domingo_luns_martes_mrcores_xoves_venres_sbado".split("_"),weekdaysShort:"dom._lun._mar._mr._xov._ven._sb.".split("_"),weekdaysMin:"do_lu_ma_m_xo_ve_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoxe "+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[ma "+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd ["+(1!==this.hours()?"s":"a")+"] LT"},lastDay:function(){return"[onte "+(1!==this.hours()?"":"a")+"] LT"},lastWeek:function(){return"[o] dddd [pasado "+(1!==this.hours()?"s":"a")+"] LT"},sameElse:"L"},relativeTime:{future:function(e){return 0===e.indexOf("un")?"n"+e:"en "+e},past:"hai %s",s:"uns segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"unha hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e,t,n,i){var s={s:[" "," "],ss:[e+" ",e+" "],m:[" "," "],mm:[e+" ",e+" "],h:[" "," "],hh:[e+" ",e+" "],d:[" "," "],dd:[e+" ",e+" "],M:[" "," "],MM:[e+" ",e+" "],y:[" "," "],yy:[e+" ",e+" "]};return i?s[n][0]:s[n][1]}e.defineLocale("gom-deva",{months:{standalone:"___________".split("_"),format:"___________".split("_"),isFormat:/MMMM(\s)+D[oD]?/},monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm []",LTS:"A h:mm:ss []",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY A h:mm []",LLLL:"dddd, MMMM Do, YYYY, A h:mm []",llll:"ddd, D MMM YYYY, A h:mm []"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd[,] LT",lastDay:"[] LT",lastWeek:"[] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}()/,ordinal:function(e,t){switch(t){case"D":return e+"";default:case"M":case"Q":case"DDD":case"d":case"w":case"W":return e}},week:{dow:1,doy:4},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>12?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<12?"":e<16?"":e<20?"":""}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e,t,n,i){var s={s:["thoddea sekondamni","thodde sekond"],ss:[e+" sekondamni",e+" sekond"],m:["eka mintan","ek minut"],mm:[e+" mintamni",e+" mintam"],h:["eka voran","ek vor"],hh:[e+" voramni",e+" voram"],d:["eka disan","ek dis"],dd:[e+" disamni",e+" dis"],M:["eka mhoinean","ek mhoino"],MM:[e+" mhoineamni",e+" mhoine"],y:["eka vorsan","ek voros"],yy:[e+" vorsamni",e+" vorsam"]};return i?s[n][0]:s[n][1]}e.defineLocale("gom-latn",{months:{standalone:"Janer_Febrer_Mars_Abril_Mai_Jun_Julai_Agost_Setembr_Otubr_Novembr_Dezembr".split("_"),format:"Janerachea_Febrerachea_Marsachea_Abrilachea_Maiachea_Junachea_Julaiachea_Agostachea_Setembrachea_Otubrachea_Novembrachea_Dezembrachea".split("_"),isFormat:/MMMM(\s)+D[oD]?/},monthsShort:"Jan._Feb._Mars_Abr._Mai_Jun_Jul._Ago._Set._Otu._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Aitar_Somar_Mongllar_Budhvar_Birestar_Sukrar_Son'var".split("_"),weekdaysShort:"Ait._Som._Mon._Bud._Bre._Suk._Son.".split("_"),weekdaysMin:"Ai_Sm_Mo_Bu_Br_Su_Sn".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm [vazta]",LTS:"A h:mm:ss [vazta]",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY A h:mm [vazta]",LLLL:"dddd, MMMM Do, YYYY, A h:mm [vazta]",llll:"ddd, D MMM YYYY, A h:mm [vazta]"},calendar:{sameDay:"[Aiz] LT",nextDay:"[Faleam] LT",nextWeek:"[Fuddlo] dddd[,] LT",lastDay:"[Kal] LT",lastWeek:"[Fattlo] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s adim",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}(er)/,ordinal:function(e,t){switch(t){case"D":return e+"er";default:case"M":case"Q":case"DDD":case"d":case"w":case"W":return e}},week:{dow:1,doy:4},meridiemParse:/rati|sokallim|donparam|sanje/,meridiemHour:function(e,t){return 12===e&&(e=0),"rati"===t?e<4?e:e+12:"sokallim"===t?e:"donparam"===t?e>12?e:e+12:"sanje"===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"rati":e<12?"sokallim":e<16?"donparam":e<20?"sanje":"rati"}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("gu",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("he",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D []MMMM YYYY",LLL:"D []MMMM YYYY HH:mm",LLLL:"dddd, D []MMMM YYYY HH:mm",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[ ]LT",nextDay:"[ ]LT",nextWeek:"dddd [] LT",lastDay:"[ ]LT",lastWeek:"[] dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:function(e){return 2===e?"":e+" "},d:"",dd:function(e){return 2===e?"":e+" "},M:"",MM:function(e){return 2===e?"":e+" "},y:"",yy:function(e){return 2===e?"":e%10==0&&10!==e?e+" ":e+" "}},meridiemParse:/"|"| | | ||/i,isPM:function(e){return/^("| |)$/.test(e)},meridiem:function(e,t,n){return e<5?" ":e<10?"":e<12?n?'"':" ":e<18?n?'"':" ":""}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("hi",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e,t,n){var i=e+" ";switch(n){case"ss":return i+=1===e?"sekunda":2===e||3===e||4===e?"sekunde":"sekundi";case"m":return t?"jedna minuta":"jedne minute";case"mm":return i+=1===e?"minuta":2===e||3===e||4===e?"minute":"minuta";case"h":return t?"jedan sat":"jednog sata";case"hh":return i+=1===e?"sat":2===e||3===e||4===e?"sata":"sati";case"dd":return i+=1===e?"dan":"dana";case"MM":return i+=1===e?"mjesec":2===e||3===e||4===e?"mjeseca":"mjeseci";case"yy":return i+=1===e?"godina":2===e||3===e||4===e?"godine":"godina"}}e.defineLocale("hr",{months:{format:"sijenja_veljae_oujka_travnja_svibnja_lipnja_srpnja_kolovoza_rujna_listopada_studenoga_prosinca".split("_"),standalone:"sijeanj_veljaa_oujak_travanj_svibanj_lipanj_srpanj_kolovoz_rujan_listopad_studeni_prosinac".split("_")},monthsShort:"sij._velj._ou._tra._svi._lip._srp._kol._ruj._lis._stu._pro.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"Do MMMM YYYY",LLL:"Do MMMM YYYY H:mm",LLLL:"dddd, Do MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:return"[prolu] [nedjelju] [u] LT";case 3:return"[prolu] [srijedu] [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",ss:t,m:t,mm:t,h:t,hh:t,d:"dan",dd:t,M:"mjesec",MM:t,y:"godinu",yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t="vasrnap htfn kedden szerdn cstrtkn pnteken szombaton".split(" ");function n(e,t,n,i){var s=e;switch(n){case"s":return i||t?"nhny msodperc":"nhny msodperce";case"ss":return s+(i||t)?" msodperc":" msodperce";case"m":return"egy"+(i||t?" perc":" perce");case"mm":return s+(i||t?" perc":" perce");case"h":return"egy"+(i||t?" ra":" rja");case"hh":return s+(i||t?" ra":" rja");case"d":return"egy"+(i||t?" nap":" napja");case"dd":return s+(i||t?" nap":" napja");case"M":return"egy"+(i||t?" hnap":" hnapja");case"MM":return s+(i||t?" hnap":" hnapja");case"y":return"egy"+(i||t?" v":" ve");case"yy":return s+(i||t?" v":" ve")}return""}function i(e){return(e?"":"[mlt] ")+"["+t[this.day()]+"] LT[-kor]"}e.defineLocale("hu",{months:"janur_februr_mrcius_prilis_mjus_jnius_jlius_augusztus_szeptember_oktber_november_december".split("_"),monthsShort:"jan_feb_mrc_pr_mj_jn_jl_aug_szept_okt_nov_dec".split("_"),weekdays:"vasrnap_htf_kedd_szerda_cstrtk_pntek_szombat".split("_"),weekdaysShort:"vas_ht_kedd_sze_cst_pn_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D. H:mm",LLLL:"YYYY. MMMM D., dddd H:mm"},meridiemParse:/de|du/i,isPM:function(e){return"u"===e.charAt(1).toLowerCase()},meridiem:function(e,t,n){return e<12?!0===n?"de":"DE":!0===n?"du":"DU"},calendar:{sameDay:"[ma] LT[-kor]",nextDay:"[holnap] LT[-kor]",nextWeek:function(){return i.call(this,!0)},lastDay:"[tegnap] LT[-kor]",lastWeek:function(){return i.call(this,!1)},sameElse:"L"},relativeTime:{future:"%s mlva",past:"%s",s:n,ss:n,m:n,mm:n,h:n,hh:n,d:n,dd:n,M:n,MM:n,y:n,yy:n},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("hy-am",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",lastDay:"[] LT",nextWeek:function(){return"dddd [ ] LT"},lastWeek:function(){return"[] dddd [ ] LT"},sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},meridiemParse:/|||/,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}|\d{1,2}-(|)/,ordinal:function(e,t){switch(t){case"DDD":case"w":case"W":case"DDDo":return 1===e?e+"-":e+"-";default:return e}},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("id",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Agt_Sep_Okt_Nov_Des".split("_"),weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|siang|sore|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"siang"===t?e>=11?e:e+12:"sore"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,n){return e<11?"pagi":e<15?"siang":e<19?"sore":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Besok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kemarin pukul] LT",lastWeek:"dddd [lalu pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",ss:"%d detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:0,doy:6}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e){return e%100==11||e%10!=1}function n(e,n,i,s){var r=e+" ";switch(i){case"s":return n||s?"nokkrar sekndur":"nokkrum sekndum";case"ss":return t(e)?r+(n||s?"sekndur":"sekndum"):r+"seknda";case"m":return n?"mnta":"mntu";case"mm":return t(e)?r+(n||s?"mntur":"mntum"):n?r+"mnta":r+"mntu";case"hh":return t(e)?r+(n||s?"klukkustundir":"klukkustundum"):r+"klukkustund";case"d":return n?"dagur":s?"dag":"degi";case"dd":return t(e)?n?r+"dagar":r+(s?"daga":"dgum"):n?r+"dagur":r+(s?"dag":"degi");case"M":return n?"mnuur":s?"mnu":"mnui";case"MM":return t(e)?n?r+"mnuir":r+(s?"mnui":"mnuum"):n?r+"mnuur":r+(s?"mnu":"mnui");case"y":return n||s?"r":"ri";case"yy":return t(e)?r+(n||s?"r":"rum"):r+(n||s?"r":"ri")}}e.defineLocale("is",{months:"janar_febrar_mars_aprl_ma_jn_jl_gst_september_oktber_nvember_desember".split("_"),monthsShort:"jan_feb_mar_apr_ma_jn_jl_g_sep_okt_nv_des".split("_"),weekdays:"sunnudagur_mnudagur_rijudagur_mivikudagur_fimmtudagur_fstudagur_laugardagur".split("_"),weekdaysShort:"sun_mn_ri_mi_fim_fs_lau".split("_"),weekdaysMin:"Su_M_r_Mi_Fi_F_La".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd, D. MMMM YYYY [kl.] H:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgun kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gr kl.] LT",lastWeek:"[sasta] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"eftir %s",past:"fyrir %s san",s:n,ss:n,m:n,mm:n,h:"klukkustund",hh:n,d:n,dd:n,M:n,MM:n,y:n,yy:n},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("it",{months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),weekdays:"domenica_luned_marted_mercoled_gioved_venerd_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:function(){return"[Oggi a"+(this.hours()>1?"lle ":0===this.hours()?" ":"ll'")+"]LT"},nextDay:function(){return"[Domani a"+(this.hours()>1?"lle ":0===this.hours()?" ":"ll'")+"]LT"},nextWeek:function(){return"dddd [a"+(this.hours()>1?"lle ":0===this.hours()?" ":"ll'")+"]LT"},lastDay:function(){return"[Ieri a"+(this.hours()>1?"lle ":0===this.hours()?" ":"ll'")+"]LT"},lastWeek:function(){switch(this.day()){case 0:return"[La scorsa] dddd [a"+(this.hours()>1?"lle ":0===this.hours()?" ":"ll'")+"]LT";default:return"[Lo scorso] dddd [a"+(this.hours()>1?"lle ":0===this.hours()?" ":"ll'")+"]LT"}},sameElse:"L"},relativeTime:{future:"tra %s",past:"%s fa",s:"alcuni secondi",ss:"%d secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("it-ch",{months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),weekdays:"domenica_luned_marted_mercoled_gioved_venerd_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:function(){switch(this.day()){case 0:return"[la scorsa] dddd [alle] LT";default:return"[lo scorso] dddd [alle] LT"}},sameElse:"L"},relativeTime:{future:function(e){return(/^[0-9].+$/.test(e)?"tra":"in")+" "+e},past:"%s fa",s:"alcuni secondi",ss:"%d secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("ja",{eras:[{since:"2019-05-01",offset:1,name:"",narrow:"",abbr:"R"},{since:"1989-01-08",until:"2019-04-30",offset:1,name:"",narrow:"",abbr:"H"},{since:"1926-12-25",until:"1989-01-07",offset:1,name:"",narrow:"",abbr:"S"},{since:"1912-07-30",until:"1926-12-24",offset:1,name:"",narrow:"",abbr:"T"},{since:"1873-01-01",until:"1912-07-29",offset:6,name:"",narrow:"",abbr:"M"},{since:"0001-01-01",until:"1873-12-31",offset:1,name:"",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"",narrow:"BC",abbr:"BC"}],eraYearOrdinalRegex:/(|\d+)/,eraYearOrdinalParse:function(e,t){return""===t[1]?1:parseInt(t[1]||e,10)},months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMD dddd HH:mm",l:"YYYY/MM/DD",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMD(ddd) HH:mm"},meridiemParse:/|/i,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:function(e){return e.week()!==this.week()?"[]dddd LT":"dddd LT"},lastDay:"[] LT",lastWeek:function(e){return this.week()!==e.week()?"[]dddd LT":"dddd LT"},sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e,t){switch(t){case"y":return 1===e?"":e+"";case"d":case"D":case"DDD":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d",m:"1",mm:"%d",h:"1",hh:"%d",d:"1",dd:"%d",M:"1",MM:"%d",y:"1",yy:"%d"}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("jv",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_Nopember_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nop_Des".split("_"),weekdays:"Minggu_Senen_Seloso_Rebu_Kemis_Jemuwah_Septu".split("_"),weekdaysShort:"Min_Sen_Sel_Reb_Kem_Jem_Sep".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sp".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/enjing|siyang|sonten|ndalu/,meridiemHour:function(e,t){return 12===e&&(e=0),"enjing"===t?e:"siyang"===t?e>=11?e:e+12:"sonten"===t||"ndalu"===t?e+12:void 0},meridiem:function(e,t,n){return e<11?"enjing":e<15?"siyang":e<19?"sonten":"ndalu"},calendar:{sameDay:"[Dinten puniko pukul] LT",nextDay:"[Mbenjang pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kala wingi pukul] LT",lastWeek:"dddd [kepengker pukul] LT",sameElse:"L"},relativeTime:{future:"wonten ing %s",past:"%s ingkang kepengker",s:"sawetawis detik",ss:"%d detik",m:"setunggal menit",mm:"%d menit",h:"setunggal jam",hh:"%d jam",d:"sedinten",dd:"%d dinten",M:"sewulan",MM:"%d wulan",y:"setaun",yy:"%d taun"},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("ka",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:{standalone:"______".split("_"),format:"______".split("_"),isFormat:/(|)/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[] LT[-]",nextDay:"[] LT[-]",lastDay:"[] LT[-]",nextWeek:"[] dddd LT[-]",lastWeek:"[] dddd LT-",sameElse:"L"},relativeTime:{future:function(e){return e.replace(/(|||||)(|)/,(function(e,t,n){return""===n?t+"":t+n+""}))},past:function(e){return/(||||)/.test(e)?e.replace(/(|)$/," ")://.test(e)?e.replace(/$/," "):e},s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/0|1-|-\d{1,2}|\d{1,2}-/,ordinal:function(e){return 0===e?e:1===e?e+"-":e<20||e<=100&&e%20==0||e%100==0?"-"+e:e+"-"},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};e.defineLocale("kk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"[ ] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(e){return e+(t[e]||t[e%10]||t[e>=100?100:null])},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("km",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("kn",{months:"___________".split("_"),monthsShort:"___________".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},dayOfMonthOrdinalParse:/\d{1,2}()/,ordinal:function(e){return e+""},week:{dow:0,doy:6}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("ko",{months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm",l:"YYYY.MM.DD.",ll:"YYYY MMMM D",lll:"YYYY MMMM D A h:mm",llll:"YYYY MMMM D dddd A h:mm"},calendar:{sameDay:" LT",nextDay:" LT",nextWeek:"dddd LT",lastDay:" LT",lastWeek:" dddd LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d",m:"1",mm:"%d",h:" ",hh:"%d",d:"",dd:"%d",M:" ",MM:"%d",y:" ",yy:"%d"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},i=[" ","","","","","","","",""," "," "," "];e.defineLocale("ku",{months:i,monthsShort:i,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return//.test(e)},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:" ",ss:" %d",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]})).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]})).replace(/,/g,"")},week:{dow:6,doy:12}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};e.defineLocale("ky",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"[ ] dddd [] [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||)/,ordinal:function(e){return e+(t[e]||t[e%10]||t[e>=100?100:null])},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e,t,n,i){var s={m:["eng Minutt","enger Minutt"],h:["eng Stonn","enger Stonn"],d:["een Dag","engem Dag"],M:["ee Mount","engem Mount"],y:["ee Joer","engem Joer"]};return t?s[n][0]:s[n][1]}function n(e){if(e=parseInt(e,10),isNaN(e))return!1;if(e<0)return!0;if(e<10)return 4<=e&&e<=7;if(e<100){var t=e%10;return n(0===t?e/10:t)}if(e<1e4){for(;e>=10;)e/=10;return n(e)}return n(e/=1e3)}e.defineLocale("lb",{months:"Januar_Februar_Merz_Abrll_Mee_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Abr._Mee_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonndeg_Mindeg_Dnschdeg_Mttwoch_Donneschdeg_Freideg_Samschdeg".split("_"),weekdaysShort:"So._M._D._M._Do._Fr._Sa.".split("_"),weekdaysMin:"So_M_D_M_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm [Auer]",LTS:"H:mm:ss [Auer]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm [Auer]",LLLL:"dddd, D. MMMM YYYY H:mm [Auer]"},calendar:{sameDay:"[Haut um] LT",sameElse:"L",nextDay:"[Muer um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gschter um] LT",lastWeek:function(){switch(this.day()){case 2:case 4:return"[Leschten] dddd [um] LT";default:return"[Leschte] dddd [um] LT"}}},relativeTime:{future:function(e){return n(e.substr(0,e.indexOf(" ")))?"a "+e:"an "+e},past:function(e){return n(e.substr(0,e.indexOf(" ")))?"viru "+e:"virun "+e},s:"e puer Sekonnen",ss:"%d Sekonnen",m:t,mm:"%d Minutten",h:t,hh:"%d Stonnen",d:t,dd:"%d Deeg",M:t,MM:"%d Mint",y:t,yy:"%d Joer"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("lo",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd[] LT",lastDay:"[] LT",lastWeek:"[]dddd[] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},dayOfMonthOrdinalParse:/()\d{1,2}/,ordinal:function(e){return""+e}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={ss:"sekund_sekundi_sekundes",m:"minut_minuts_minut",mm:"minuts_minui_minutes",h:"valanda_valandos_valand",hh:"valandos_valand_valandas",d:"diena_dienos_dien",dd:"dienos_dien_dienas",M:"mnuo_mnesio_mnes",MM:"mnesiai_mnesi_mnesius",y:"metai_met_metus",yy:"metai_met_metus"};function n(e,t,n,i){return t?s(n)[0]:i?s(n)[1]:s(n)[2]}function i(e){return e%10==0||e>10&&e<20}function s(e){return t[e].split("_")}function r(e,t,r,o){var a=e+" ";return 1===e?a+n(0,t,r[0],o):t?a+(i(e)?s(r)[1]:s(r)[0]):o?a+s(r)[1]:a+(i(e)?s(r)[1]:s(r)[2])}e.defineLocale("lt",{months:{format:"sausio_vasario_kovo_balandio_gegus_birelio_liepos_rugpjio_rugsjo_spalio_lapkriio_gruodio".split("_"),standalone:"sausis_vasaris_kovas_balandis_gegu_birelis_liepa_rugpjtis_rugsjis_spalis_lapkritis_gruodis".split("_"),isFormat:/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?|MMMM?(\[[^\[\]]*\]|\s)+D[oD]?/},monthsShort:"sau_vas_kov_bal_geg_bir_lie_rgp_rgs_spa_lap_grd".split("_"),weekdays:{format:"sekmadien_pirmadien_antradien_treiadien_ketvirtadien_penktadien_etadien".split("_"),standalone:"sekmadienis_pirmadienis_antradienis_treiadienis_ketvirtadienis_penktadienis_etadienis".split("_"),isFormat:/dddd HH:mm/},weekdaysShort:"Sek_Pir_Ant_Tre_Ket_Pen_e".split("_"),weekdaysMin:"S_P_A_T_K_Pn_".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY [m.] MMMM D [d.]",LLL:"YYYY [m.] MMMM D [d.], HH:mm [val.]",LLLL:"YYYY [m.] MMMM D [d.], dddd, HH:mm [val.]",l:"YYYY-MM-DD",ll:"YYYY [m.] MMMM D [d.]",lll:"YYYY [m.] MMMM D [d.], HH:mm [val.]",llll:"YYYY [m.] MMMM D [d.], ddd, HH:mm [val.]"},calendar:{sameDay:"[iandien] LT",nextDay:"[Rytoj] LT",nextWeek:"dddd LT",lastDay:"[Vakar] LT",lastWeek:"[Prajus] dddd LT",sameElse:"L"},relativeTime:{future:"po %s",past:"prie %s",s:function(e,t,n,i){return t?"kelios sekunds":i?"keli sekundi":"kelias sekundes"},ss:r,m:n,mm:r,h:n,hh:r,d:n,dd:r,M:n,MM:r,y:n,yy:r},dayOfMonthOrdinalParse:/\d{1,2}-oji/,ordinal:function(e){return e+"-oji"},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={ss:"sekundes_sekundm_sekunde_sekundes".split("_"),m:"mintes_mintm_minte_mintes".split("_"),mm:"mintes_mintm_minte_mintes".split("_"),h:"stundas_stundm_stunda_stundas".split("_"),hh:"stundas_stundm_stunda_stundas".split("_"),d:"dienas_dienm_diena_dienas".split("_"),dd:"dienas_dienm_diena_dienas".split("_"),M:"mnea_mneiem_mnesis_mnei".split("_"),MM:"mnea_mneiem_mnesis_mnei".split("_"),y:"gada_gadiem_gads_gadi".split("_"),yy:"gada_gadiem_gads_gadi".split("_")};function n(e,t,n){return n?t%10==1&&t%100!=11?e[2]:e[3]:t%10==1&&t%100!=11?e[0]:e[1]}function i(e,i,s){return e+" "+n(t[s],e,i)}function s(e,i,s){return n(t[s],e,i)}e.defineLocale("lv",{months:"janvris_februris_marts_aprlis_maijs_jnijs_jlijs_augusts_septembris_oktobris_novembris_decembris".split("_"),monthsShort:"jan_feb_mar_apr_mai_jn_jl_aug_sep_okt_nov_dec".split("_"),weekdays:"svtdiena_pirmdiena_otrdiena_trediena_ceturtdiena_piektdiena_sestdiena".split("_"),weekdaysShort:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysMin:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY.",LL:"YYYY. [gada] D. MMMM",LLL:"YYYY. [gada] D. MMMM, HH:mm",LLLL:"YYYY. [gada] D. MMMM, dddd, HH:mm"},calendar:{sameDay:"[odien pulksten] LT",nextDay:"[Rt pulksten] LT",nextWeek:"dddd [pulksten] LT",lastDay:"[Vakar pulksten] LT",lastWeek:"[Pagju] dddd [pulksten] LT",sameElse:"L"},relativeTime:{future:"pc %s",past:"pirms %s",s:function(e,t){return t?"daas sekundes":"dam sekundm"},ss:i,m:s,mm:i,h:s,hh:i,d:s,dd:i,M:s,MM:i,y:s,yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={words:{ss:["sekund","sekunda","sekundi"],m:["jedan minut","jednog minuta"],mm:["minut","minuta","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mjesec","mjeseca","mjeseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,n,i){var s=t.words[i];return 1===i.length?n?s[0]:s[1]:e+" "+t.correctGrammaticalCase(e,s)}};e.defineLocale("me",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sjutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){return["[prole] [nedjelje] [u] LT","[prolog] [ponedjeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srijede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"][this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"nekoliko sekundi",ss:t.translate,m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"dan",dd:t.translate,M:"mjesec",MM:t.translate,y:"godinu",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("mi",{months:"Kohi-tte_Hui-tanguru_Pout-te-rangi_Paenga-whwh_Haratua_Pipiri_Hngoingoi_Here-turi-kk_Mahuru_Whiringa--nuku_Whiringa--rangi_Hakihea".split("_"),monthsShort:"Kohi_Hui_Pou_Pae_Hara_Pipi_Hngoi_Here_Mahu_Whi-nu_Whi-ra_Haki".split("_"),monthsRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,2}/i,weekdays:"Rtapu_Mane_Trei_Wenerei_Tite_Paraire_Htarei".split("_"),weekdaysShort:"Ta_Ma_T_We_Ti_Pa_H".split("_"),weekdaysMin:"Ta_Ma_T_We_Ti_Pa_H".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [i] HH:mm",LLLL:"dddd, D MMMM YYYY [i] HH:mm"},calendar:{sameDay:"[i teie mahana, i] LT",nextDay:"[apopo i] LT",nextWeek:"dddd [i] LT",lastDay:"[inanahi i] LT",lastWeek:"dddd [whakamutunga i] LT",sameElse:"L"},relativeTime:{future:"i roto i %s",past:"%s i mua",s:"te hkona ruarua",ss:"%d hkona",m:"he meneti",mm:"%d meneti",h:"te haora",hh:"%d haora",d:"he ra",dd:"%d ra",M:"he marama",MM:"%d marama",y:"he tau",yy:"%d tau"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("mk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"e_o_____a".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"[] dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[] dddd [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||||)/,ordinal:function(e){var t=e%10,n=e%100;return 0===e?e+"-":0===n?e+"-":n>10&&n<20?e+"-":1===t?e+"-":2===t?e+"-":7===t||8===t?e+"-":e+"-"},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("ml",{months:"___________".split("_"),monthsShort:"._._._.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm -",LTS:"A h:mm:ss -",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm -",LLLL:"dddd, D MMMM YYYY, A h:mm -"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},meridiemParse:/|| ||/i,meridiemHour:function(e,t){return 12===e&&(e=0),""===t&&e>=4||" "===t||""===t?e+12:e},meridiem:function(e,t,n){return e<4?"":e<12?"":e<17?" ":e<20?"":""}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e,t,n,i){switch(n){case"s":return t?" ":" ";case"ss":return e+(t?" ":" ");case"m":case"mm":return e+(t?" ":" ");case"h":case"hh":return e+(t?" ":" ");case"d":case"dd":return e+(t?" ":" ");case"M":case"MM":return e+(t?" ":" ");case"y":case"yy":return e+(t?" ":" ");default:return e}}e.defineLocale("mn",{months:" _ _ _ _ _ _ _ _ _ _  _  ".split("_"),monthsShort:"1 _2 _3 _4 _5 _6 _7 _8 _9 _10 _11 _12 ".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY  MMMM D",LLL:"YYYY  MMMM D HH:mm",LLLL:"dddd, YYYY  MMMM D HH:mm"},meridiemParse:/|/i,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd LT",lastDay:"[] LT",lastWeek:"[] dddd LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2} /,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+" ";default:return e}}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};function i(e,t,n,i){var s="";if(t)switch(n){case"s":s=" ";break;case"ss":s="%d ";break;case"m":s=" ";break;case"mm":s="%d ";break;case"h":s=" ";break;case"hh":s="%d ";break;case"d":s=" ";break;case"dd":s="%d ";break;case"M":s=" ";break;case"MM":s="%d ";break;case"y":s=" ";break;case"yy":s="%d "}else switch(n){case"s":s=" ";break;case"ss":s="%d ";break;case"m":s=" ";break;case"mm":s="%d ";break;case"h":s=" ";break;case"hh":s="%d ";break;case"d":s=" ";break;case"dd":s="%d ";break;case"M":s=" ";break;case"MM":s="%d ";break;case"y":s=" ";break;case"yy":s="%d "}return s.replace(/%d/i,e)}e.defineLocale("mr",{months:"___________".split("_"),monthsShort:"._._._._._._._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:i,ss:i,m:i,mm:i,h:i,hh:i,d:i,dd:i,M:i,MM:i,y:i,yy:i},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t?e:""===t||""===t||""===t?e>=12?e:e+12:void 0},meridiem:function(e,t,n){return e>=0&&e<6?"":e<12?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("ms",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"tengahari"===t?e>=11?e:e+12:"petang"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,n){return e<11?"pagi":e<15?"tengahari":e<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",ss:"%d saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("ms-my",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"tengahari"===t?e>=11?e:e+12:"petang"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,n){return e<11?"pagi":e<15?"tengahari":e<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",ss:"%d saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("mt",{months:"Jannar_Frar_Marzu_April_Mejju_unju_Lulju_Awwissu_Settembru_Ottubru_Novembru_Diembru".split("_"),monthsShort:"Jan_Fra_Mar_Apr_Mej_un_Lul_Aww_Set_Ott_Nov_Di".split("_"),weekdays:"Il-add_It-Tnejn_It-Tlieta_L-Erbga_Il-amis_Il-imga_Is-Sibt".split("_"),weekdaysShort:"ad_Tne_Tli_Erb_am_im_Sib".split("_"),weekdaysMin:"a_Tn_Tl_Er_a_i_Si".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Illum fil-]LT",nextDay:"[Gada fil-]LT",nextWeek:"dddd [fil-]LT",lastDay:"[Il-biera fil-]LT",lastWeek:"dddd [li gadda] [fil-]LT",sameElse:"L"},relativeTime:{future:"f %s",past:"%s ilu",s:"ftit sekondi",ss:"%d sekondi",m:"minuta",mm:"%d minuti",h:"siega",hh:"%d siegat",d:"urnata",dd:"%d ranet",M:"xahar",MM:"%d xhur",y:"sena",yy:"%d sni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("my",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[.] LT []",nextDay:"[] LT []",nextWeek:"dddd LT []",lastDay:"[.] LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:" %s ",past:" %s ",s:".",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("nb",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan._feb._mars_apr._mai_juni_juli_aug._sep._okt._nov._des.".split("_"),monthsParseExact:!0,weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"s._ma._ti._on._to._fr._l.".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] HH:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[forrige] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"noen sekunder",ss:"%d sekunder",m:"ett minutt",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"en mned",MM:"%d mneder",y:"ett r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("ne",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"._._._._._._.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<3?"":e<12?"":e<16?"":e<20?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd[,] LT",lastDay:"[] LT",lastWeek:"[] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:0,doy:6}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),n="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),i=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],s=/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i;e.defineLocale("nl",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(e,i){return e?/-MMM-/.test(i)?n[e.month()]:t[e.month()]:t},monthsRegex:s,monthsShortRegex:s,monthsStrictRegex:/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:i,longMonthsParse:i,shortMonthsParse:i,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",ss:"%d seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),n="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),i=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],s=/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i;e.defineLocale("nl-be",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(e,i){return e?/-MMM-/.test(i)?n[e.month()]:t[e.month()]:t},monthsRegex:s,monthsShortRegex:s,monthsStrictRegex:/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:i,longMonthsParse:i,shortMonthsParse:i,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",ss:"%d seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("nn",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan._feb._mars_apr._mai_juni_juli_aug._sep._okt._nov._des.".split("_"),monthsParseExact:!0,weekdays:"sundag_mndag_tysdag_onsdag_torsdag_fredag_laurdag".split("_"),weekdaysShort:"su._m._ty._on._to._fr._lau.".split("_"),weekdaysMin:"su_m_ty_on_to_fr_la".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[I dag klokka] LT",nextDay:"[I morgon klokka] LT",nextWeek:"dddd [klokka] LT",lastDay:"[I gr klokka] LT",lastWeek:"[Fregande] dddd [klokka] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s sidan",s:"nokre sekund",ss:"%d sekund",m:"eit minutt",mm:"%d minutt",h:"ein time",hh:"%d timar",d:"ein dag",dd:"%d dagar",M:"ein mnad",MM:"%d mnader",y:"eit r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("oc-lnc",{months:{standalone:"genir_febrir_mar_abril_mai_junh_julhet_agost_setembre_octbre_novembre_decembre".split("_"),format:"de genir_de febrir_de mar_d'abril_de mai_de junh_de julhet_d'agost_de setembre_d'octbre_de novembre_de decembre".split("_"),isFormat:/D[oD]?(\s)+MMMM/},monthsShort:"gen._febr._mar_abr._mai_junh_julh._ago._set._oct._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"dimenge_diluns_dimars_dimcres_dijus_divendres_dissabte".split("_"),weekdaysShort:"dg._dl._dm._dc._dj._dv._ds.".split("_"),weekdaysMin:"dg_dl_dm_dc_dj_dv_ds".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [de] YYYY",ll:"D MMM YYYY",LLL:"D MMMM [de] YYYY [a] H:mm",lll:"D MMM YYYY, H:mm",LLLL:"dddd D MMMM [de] YYYY [a] H:mm",llll:"ddd D MMM YYYY, H:mm"},calendar:{sameDay:"[ui a] LT",nextDay:"[deman a] LT",nextWeek:"dddd [a] LT",lastDay:"[ir a] LT",lastWeek:"dddd [passat a] LT",sameElse:"L"},relativeTime:{future:"d'aqu %s",past:"fa %s",s:"unas segondas",ss:"%d segondas",m:"una minuta",mm:"%d minutas",h:"una ora",hh:"%d oras",d:"un jorn",dd:"%d jorns",M:"un mes",MM:"%d meses",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(r|n|t||a)/,ordinal:function(e,t){var n=1===e?"r":2===e?"n":3===e?"r":4===e?"t":"";return"w"!==t&&"W"!==t||(n="a"),e+n},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("pa-in",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t="stycze_luty_marzec_kwiecie_maj_czerwiec_lipiec_sierpie_wrzesie_padziernik_listopad_grudzie".split("_"),n="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_wrzenia_padziernika_listopada_grudnia".split("_");function i(e){return e%10<5&&e%10>1&&~~(e/10)%10!=1}function s(e,t,n){var s=e+" ";switch(n){case"ss":return s+(i(e)?"sekundy":"sekund");case"m":return t?"minuta":"minut";case"mm":return s+(i(e)?"minuty":"minut");case"h":return t?"godzina":"godzin";case"hh":return s+(i(e)?"godziny":"godzin");case"MM":return s+(i(e)?"miesice":"miesicy");case"yy":return s+(i(e)?"lata":"lat")}}e.defineLocale("pl",{months:function(e,i){return e?""===i?"("+n[e.month()]+"|"+t[e.month()]+")":/D MMMM/.test(i)?n[e.month()]:t[e.month()]:t},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_pa_lis_gru".split("_"),weekdays:"niedziela_poniedziaek_wtorek_roda_czwartek_pitek_sobota".split("_"),weekdaysShort:"ndz_pon_wt_r_czw_pt_sob".split("_"),weekdaysMin:"Nd_Pn_Wt_r_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Dzi o] LT",nextDay:"[Jutro o] LT",nextWeek:function(){switch(this.day()){case 0:return"[W niedziel o] LT";case 2:return"[We wtorek o] LT";case 3:return"[W rod o] LT";case 6:return"[W sobot o] LT";default:return"[W] dddd [o] LT"}},lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zesz niedziel o] LT";case 3:return"[W zesz rod o] LT";case 6:return"[W zesz sobot o] LT";default:return"[W zeszy] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",ss:s,m:s,mm:s,h:s,hh:s,d:"1 dzie",dd:"%d dni",M:"miesic",MM:s,y:"rok",yy:s},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("pt",{months:"janeiro_fevereiro_maro_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Do_2_3_4_5_6_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY HH:mm"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"h %s",s:"segundos",ss:"%d segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("pt-br",{months:"janeiro_fevereiro_maro_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),weekdays:"domingo_segunda-feira_tera-feira_quarta-feira_quinta-feira_sexta-feira_sbado".split("_"),weekdaysShort:"dom_seg_ter_qua_qui_sex_sb".split("_"),weekdaysMin:"do_2_3_4_5_6_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [s] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [s] HH:mm"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"h %s",s:"poucos segundos",ss:"%d segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d"})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e,t,n){var i=" ";return(e%100>=20||e>=100&&e%100==0)&&(i=" de "),e+i+{ss:"secunde",mm:"minute",hh:"ore",dd:"zile",MM:"luni",yy:"ani"}[n]}e.defineLocale("ro",{months:"ianuarie_februarie_martie_aprilie_mai_iunie_iulie_august_septembrie_octombrie_noiembrie_decembrie".split("_"),monthsShort:"ian._feb._mart._apr._mai_iun._iul._aug._sept._oct._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"duminic_luni_mari_miercuri_joi_vineri_smbt".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_Sm".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_S".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[azi la] LT",nextDay:"[mine la] LT",nextWeek:"dddd [la] LT",lastDay:"[ieri la] LT",lastWeek:"[fosta] dddd [la] LT",sameElse:"L"},relativeTime:{future:"peste %s",past:"%s n urm",s:"cteva secunde",ss:t,m:"un minut",mm:t,h:"o or",hh:t,d:"o zi",dd:t,M:"o lun",MM:t,y:"un an",yy:t},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e,t,n){var i,s;return"m"===n?t?"":"":e+" "+(i=+e,s={ss:t?"__":"__",mm:t?"__":"__",hh:"__",dd:"__",MM:"__",yy:"__"}[n].split("_"),i%10==1&&i%100!=11?s[0]:i%10>=2&&i%10<=4&&(i%100<10||i%100>=20)?s[1]:s[2])}var n=[/^/i,/^/i,/^/i,/^/i,/^[]/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i];e.defineLocale("ru",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:{format:"._._._.____._._._._.".split("_"),standalone:"._.__.____._._._._.".split("_")},weekdays:{standalone:"______".split("_"),format:"______".split("_"),isFormat:/\[ ?[] ?(?:||)? ?] ?dddd/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),monthsParse:n,longMonthsParse:n,shortMonthsParse:n,monthsRegex:/^([]|\.?|[]|?\.?|?|\.?|[]|\.?|[]|[]|\.?|[]|\.?|?|\.?|[]|?\.?|[]|\.?|[]|?\.?|[]|\.?)/i,monthsShortRegex:/^([]|\.?|[]|?\.?|?|\.?|[]|\.?|[]|[]|\.?|[]|\.?|?|\.?|[]|?\.?|[]|\.?|[]|?\.?|[]|\.?)/i,monthsStrictRegex:/^([]|[]|?|[]|[]|[]|[]|?|[]|[]|[]|[])/i,monthsShortStrictRegex:/^(\.|?\.|[.]|\.|[]|[.]|[.]|\.|?\.|\.|?\.|\.)/i,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., H:mm",LLLL:"dddd, D MMMM YYYY ., H:mm"},calendar:{sameDay:"[, ] LT",nextDay:"[, ] LT",lastDay:"[, ] LT",nextWeek:function(e){if(e.week()===this.week())return 2===this.day()?"[] dddd, [] LT":"[] dddd, [] LT";switch(this.day()){case 0:return"[ ] dddd, [] LT";case 1:case 2:case 4:return"[ ] dddd, [] LT";case 3:case 5:case 6:return"[ ] dddd, [] LT"}},lastWeek:function(e){if(e.week()===this.week())return 2===this.day()?"[] dddd, [] LT":"[] dddd, [] LT";switch(this.day()){case 0:return"[ ] dddd, [] LT";case 1:case 2:case 4:return"[ ] dddd, [] LT";case 3:case 5:case 6:return"[ ] dddd, [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:t,m:t,mm:t,h:"",hh:t,d:"",dd:t,M:"",MM:t,y:"",yy:t},meridiemParse:/|||/i,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e,t,n){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(||)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":return e+"-";case"D":return e+"-";case"w":case"W":return e+"-";default:return e}},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t=["","","","","","","","","","","",""],n=["","","","","","",""];e.defineLocale("sd",{months:t,monthsShort:t,weekdays:n,weekdaysShort:n,weekdaysMin:n,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd [  ] LT",lastDay:"[] LT",lastWeek:"[ ] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("se",{months:"oajagemnnu_guovvamnnu_njukamnnu_cuoomnnu_miessemnnu_geassemnnu_suoidnemnnu_borgemnnu_akamnnu_golggotmnnu_skbmamnnu_juovlamnnu".split("_"),monthsShort:"oj_guov_njuk_cuo_mies_geas_suoi_borg_ak_golg_skb_juov".split("_"),weekdays:"sotnabeaivi_vuossrga_maebrga_gaskavahkku_duorastat_bearjadat_lvvardat".split("_"),weekdaysShort:"sotn_vuos_ma_gask_duor_bear_lv".split("_"),weekdaysMin:"s_v_m_g_d_b_L".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"MMMM D. [b.] YYYY",LLL:"MMMM D. [b.] YYYY [ti.] HH:mm",LLLL:"dddd, MMMM D. [b.] YYYY [ti.] HH:mm"},calendar:{sameDay:"[otne ti] LT",nextDay:"[ihttin ti] LT",nextWeek:"dddd [ti] LT",lastDay:"[ikte ti] LT",lastWeek:"[ovddit] dddd [ti] LT",sameElse:"L"},relativeTime:{future:"%s geaes",past:"mait %s",s:"moadde sekunddat",ss:"%d sekunddat",m:"okta minuhta",mm:"%d minuhtat",h:"okta diimmu",hh:"%d diimmut",d:"okta beaivi",dd:"%d beaivvit",M:"okta mnnu",MM:"%d mnut",y:"okta jahki",yy:"%d jagit"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("si",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"a h:mm",LTS:"a h:mm:ss",L:"YYYY/MM/DD",LL:"YYYY MMMM D",LLL:"YYYY MMMM D, a h:mm",LLLL:"YYYY MMMM D [] dddd, a h:mm:ss"},calendar:{sameDay:"[] LT[]",nextDay:"[] LT[]",nextWeek:"dddd LT[]",lastDay:"[] LT[]",lastWeek:"[] dddd LT[]",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",ss:" %d",m:"",mm:" %d",h:"",hh:" %d",d:"",dd:" %d",M:"",MM:" %d",y:"",yy:" %d"},dayOfMonthOrdinalParse:/\d{1,2} /,ordinal:function(e){return e+" "},meridiemParse:/ | |.|../,isPM:function(e){return".."===e||" "===e},meridiem:function(e,t,n){return e>11?n?"..":" ":n?"..":" "}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t="janur_februr_marec_aprl_mj_jn_jl_august_september_oktber_november_december".split("_"),n="jan_feb_mar_apr_mj_jn_jl_aug_sep_okt_nov_dec".split("_");function i(e){return e>1&&e<5}function s(e,t,n,s){var r=e+" ";switch(n){case"s":return t||s?"pr seknd":"pr sekundami";case"ss":return t||s?r+(i(e)?"sekundy":"seknd"):r+"sekundami";case"m":return t?"minta":s?"mintu":"mintou";case"mm":return t||s?r+(i(e)?"minty":"mint"):r+"mintami";case"h":return t?"hodina":s?"hodinu":"hodinou";case"hh":return t||s?r+(i(e)?"hodiny":"hodn"):r+"hodinami";case"d":return t||s?"de":"dom";case"dd":return t||s?r+(i(e)?"dni":"dn"):r+"dami";case"M":return t||s?"mesiac":"mesiacom";case"MM":return t||s?r+(i(e)?"mesiace":"mesiacov"):r+"mesiacmi";case"y":return t||s?"rok":"rokom";case"yy":return t||s?r+(i(e)?"roky":"rokov"):r+"rokmi"}}e.defineLocale("sk",{months:t,monthsShort:n,weekdays:"nedea_pondelok_utorok_streda_tvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_t_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_t_pi_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm"},calendar:{sameDay:"[dnes o] LT",nextDay:"[zajtra o] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedeu o] LT";case 1:case 2:return"[v] dddd [o] LT";case 3:return"[v stredu o] LT";case 4:return"[vo tvrtok o] LT";case 5:return"[v piatok o] LT";case 6:return"[v sobotu o] LT"}},lastDay:"[vera o] LT",lastWeek:function(){switch(this.day()){case 0:return"[minul nedeu o] LT";case 1:case 2:return"[minul] dddd [o] LT";case 3:return"[minul stredu o] LT";case 4:case 5:return"[minul] dddd [o] LT";case 6:return"[minul sobotu o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"pred %s",s:s,ss:s,m:s,mm:s,h:s,hh:s,d:s,dd:s,M:s,MM:s,y:s,yy:s},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e,t,n,i){var s=e+" ";switch(n){case"s":return t||i?"nekaj sekund":"nekaj sekundami";case"ss":return s+=1===e?t?"sekundo":"sekundi":2===e?t||i?"sekundi":"sekundah":e<5?t||i?"sekunde":"sekundah":"sekund";case"m":return t?"ena minuta":"eno minuto";case"mm":return s+=1===e?t?"minuta":"minuto":2===e?t||i?"minuti":"minutama":e<5?t||i?"minute":"minutami":t||i?"minut":"minutami";case"h":return t?"ena ura":"eno uro";case"hh":return s+=1===e?t?"ura":"uro":2===e?t||i?"uri":"urama":e<5?t||i?"ure":"urami":t||i?"ur":"urami";case"d":return t||i?"en dan":"enim dnem";case"dd":return s+=1===e?t||i?"dan":"dnem":2===e?t||i?"dni":"dnevoma":t||i?"dni":"dnevi";case"M":return t||i?"en mesec":"enim mesecem";case"MM":return s+=1===e?t||i?"mesec":"mesecem":2===e?t||i?"meseca":"mesecema":e<5?t||i?"mesece":"meseci":t||i?"mesecev":"meseci";case"y":return t||i?"eno leto":"enim letom";case"yy":return s+=1===e?t||i?"leto":"letom":2===e?t||i?"leti":"letoma":e<5?t||i?"leta":"leti":t||i?"let":"leti"}}e.defineLocale("sl",{months:"januar_februar_marec_april_maj_junij_julij_avgust_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljek_torek_sreda_etrtek_petek_sobota".split("_"),weekdaysShort:"ned._pon._tor._sre._et._pet._sob.".split("_"),weekdaysMin:"ne_po_to_sr_e_pe_so".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danes ob] LT",nextDay:"[jutri ob] LT",nextWeek:function(){switch(this.day()){case 0:return"[v] [nedeljo] [ob] LT";case 3:return"[v] [sredo] [ob] LT";case 6:return"[v] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[v] dddd [ob] LT"}},lastDay:"[veraj ob] LT",lastWeek:function(){switch(this.day()){case 0:return"[prejnjo] [nedeljo] [ob] LT";case 3:return"[prejnjo] [sredo] [ob] LT";case 6:return"[prejnjo] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[prejnji] dddd [ob] LT"}},sameElse:"L"},relativeTime:{future:"ez %s",past:"pred %s",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("sq",{months:"Janar_Shkurt_Mars_Prill_Maj_Qershor_Korrik_Gusht_Shtator_Tetor_Nntor_Dhjetor".split("_"),monthsShort:"Jan_Shk_Mar_Pri_Maj_Qer_Kor_Gus_Sht_Tet_Nn_Dhj".split("_"),weekdays:"E Diel_E Hn_E Mart_E Mrkur_E Enjte_E Premte_E Shtun".split("_"),weekdaysShort:"Die_Hn_Mar_Mr_Enj_Pre_Sht".split("_"),weekdaysMin:"D_H_Ma_M_E_P_Sh".split("_"),weekdaysParseExact:!0,meridiemParse:/PD|MD/,isPM:function(e){return"M"===e.charAt(0)},meridiem:function(e,t,n){return e<12?"PD":"MD"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Sot n] LT",nextDay:"[Nesr n] LT",nextWeek:"dddd [n] LT",lastDay:"[Dje n] LT",lastWeek:"dddd [e kaluar n] LT",sameElse:"L"},relativeTime:{future:"n %s",past:"%s m par",s:"disa sekonda",ss:"%d sekonda",m:"nj minut",mm:"%d minuta",h:"nj or",hh:"%d or",d:"nj dit",dd:"%d dit",M:"nj muaj",MM:"%d muaj",y:"nj vit",yy:"%d vite"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={words:{ss:["sekunda","sekunde","sekundi"],m:["jedan minut","jedne minute"],mm:["minut","minute","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mesec","meseca","meseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,n,i){var s=t.words[i];return 1===i.length?n?s[0]:s[1]:e+" "+t.correctGrammaticalCase(e,s)}};e.defineLocale("sr",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljak_utorak_sreda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sre._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedelju] [u] LT";case 3:return"[u] [sredu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){return["[prole] [nedelje] [u] LT","[prolog] [ponedeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"][this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"pre %s",s:"nekoliko sekundi",ss:t.translate,m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"dan",dd:t.translate,M:"mesec",MM:t.translate,y:"godinu",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={words:{ss:["","",""],m:[" "," "],mm:["","",""],h:[" "," "],hh:["","",""],dd:["","",""],MM:["","",""],yy:["","",""]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,n,i){var s=t.words[i];return 1===i.length?n?s[0]:s[1]:e+" "+t.correctGrammaticalCase(e,s)}};e.defineLocale("sr-cyrl",{months:"___________".split("_"),monthsShort:"._._._.____._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:function(){switch(this.day()){case 0:return"[] [] [] LT";case 3:return"[] [] [] LT";case 6:return"[] [] [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},lastDay:"[ ] LT",lastWeek:function(){return["[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT"][this.day()]},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:t.translate,m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"",dd:t.translate,M:"",MM:t.translate,y:"",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("ss",{months:"Bhimbidvwane_Indlovana_Indlov'lenkhulu_Mabasa_Inkhwekhweti_Inhlaba_Kholwane_Ingci_Inyoni_Imphala_Lweti_Ingongoni".split("_"),monthsShort:"Bhi_Ina_Inu_Mab_Ink_Inh_Kho_Igc_Iny_Imp_Lwe_Igo".split("_"),weekdays:"Lisontfo_Umsombuluko_Lesibili_Lesitsatfu_Lesine_Lesihlanu_Umgcibelo".split("_"),weekdaysShort:"Lis_Umb_Lsb_Les_Lsi_Lsh_Umg".split("_"),weekdaysMin:"Li_Us_Lb_Lt_Ls_Lh_Ug".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Namuhla nga] LT",nextDay:"[Kusasa nga] LT",nextWeek:"dddd [nga] LT",lastDay:"[Itolo nga] LT",lastWeek:"dddd [leliphelile] [nga] LT",sameElse:"L"},relativeTime:{future:"nga %s",past:"wenteka nga %s",s:"emizuzwana lomcane",ss:"%d mzuzwana",m:"umzuzu",mm:"%d emizuzu",h:"lihora",hh:"%d emahora",d:"lilanga",dd:"%d emalanga",M:"inyanga",MM:"%d tinyanga",y:"umnyaka",yy:"%d iminyaka"},meridiemParse:/ekuseni|emini|entsambama|ebusuku/,meridiem:function(e,t,n){return e<11?"ekuseni":e<15?"emini":e<19?"entsambama":"ebusuku"},meridiemHour:function(e,t){return 12===e&&(e=0),"ekuseni"===t?e:"emini"===t?e>=11?e:e+12:"entsambama"===t||"ebusuku"===t?0===e?0:e+12:void 0},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("sv",{months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mndag_tisdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_mn_tis_ons_tor_fre_lr".split("_"),weekdaysMin:"s_m_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [kl.] HH:mm",LLLL:"dddd D MMMM YYYY [kl.] HH:mm",lll:"D MMM YYYY HH:mm",llll:"ddd D MMM YYYY HH:mm"},calendar:{sameDay:"[Idag] LT",nextDay:"[Imorgon] LT",lastDay:"[Igr] LT",nextWeek:"[P] dddd LT",lastWeek:"[I] dddd[s] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"fr %s sedan",s:"ngra sekunder",ss:"%d sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en mnad",MM:"%d mnader",y:"ett r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}(\:e|\:a)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?":e":1===t||2===t?":a":":e")},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("sw",{months:"Januari_Februari_Machi_Aprili_Mei_Juni_Julai_Agosti_Septemba_Oktoba_Novemba_Desemba".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ago_Sep_Okt_Nov_Des".split("_"),weekdays:"Jumapili_Jumatatu_Jumanne_Jumatano_Alhamisi_Ijumaa_Jumamosi".split("_"),weekdaysShort:"Jpl_Jtat_Jnne_Jtan_Alh_Ijm_Jmos".split("_"),weekdaysMin:"J2_J3_J4_J5_Al_Ij_J1".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"hh:mm A",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[leo saa] LT",nextDay:"[kesho saa] LT",nextWeek:"[wiki ijayo] dddd [saat] LT",lastDay:"[jana] LT",lastWeek:"[wiki iliyopita] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s baadaye",past:"tokea %s",s:"hivi punde",ss:"sekunde %d",m:"dakika moja",mm:"dakika %d",h:"saa limoja",hh:"masaa %d",d:"siku moja",dd:"siku %d",M:"mwezi mmoja",MM:"miezi %d",y:"mwaka mmoja",yy:"miaka %d"},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};e.defineLocale("ta",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, HH:mm",LLLL:"dddd, D MMMM YYYY, HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[ ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:" ",mm:"%d ",h:"  ",hh:"%d  ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e+""},preparse:function(e){return e.replace(/[]/g,(function(e){return n[e]}))},postformat:function(e){return e.replace(/\d/g,(function(e){return t[e]}))},meridiemParse:/|||||/,meridiem:function(e,t,n){return e<2?" ":e<6?" ":e<10?" ":e<14?" ":e<18?" ":e<22?" ":" "},meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<2?e:e+12:""===t||""===t||""===t&&e>=10?e:e+12},week:{dow:0,doy:6}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("te",{months:"___________".split("_"),monthsShort:"._.__.____._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("tet",{months:"Janeiru_Fevereiru_Marsu_Abril_Maiu_Juu_Jullu_Agustu_Setembru_Outubru_Novembru_Dezembru".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingu_Segunda_Tersa_Kuarta_Kinta_Sesta_Sabadu".split("_"),weekdaysShort:"Dom_Seg_Ters_Kua_Kint_Sest_Sab".split("_"),weekdaysMin:"Do_Seg_Te_Ku_Ki_Ses_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Ohin iha] LT",nextDay:"[Aban iha] LT",nextWeek:"dddd [iha] LT",lastDay:"[Horiseik iha] LT",lastWeek:"dddd [semana kotuk] [iha] LT",sameElse:"L"},relativeTime:{future:"iha %s",past:"%s liuba",s:"segundu balun",ss:"segundu %d",m:"minutu ida",mm:"minutu %d",h:"oras ida",hh:"oras %d",d:"loron ida",dd:"loron %d",M:"fulan ida",MM:"fulan %d",y:"tinan ida",yy:"tinan %d"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",12:"-",13:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};e.defineLocale("tg",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:"dddd[] [  ] LT",lastWeek:"dddd[] [  ] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=11?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<11?"":e<16?"":e<19?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(e){return e+(t[e]||t[e%10]||t[e>=100?100:null])},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("th",{months:"___________".split("_"),monthsShort:".._.._.._.._.._.._.._.._.._.._.._..".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"._._._._._._.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY  H:mm",LLLL:"dddd D MMMM YYYY  H:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd[ ] LT",lastDay:"[ ] LT",lastWeek:"[]dddd[ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"'inji",5:"'inji",8:"'inji",70:"'inji",80:"'inji",2:"'nji",7:"'nji",20:"'nji",50:"'nji",3:"'nji",4:"'nji",100:"'nji",6:"'njy",9:"'unjy",10:"'unjy",30:"'unjy",60:"'ynjy",90:"'ynjy"};e.defineLocale("tk",{months:"anwar_Fewral_Mart_Aprel_Ma_Iun_Iul_Awgust_Sentabr_Oktabr_Noabr_Dekabr".split("_"),monthsShort:"an_Few_Mar_Apr_Ma_In_Il_Awg_Sen_Okt_No_Dek".split("_"),weekdays:"ekenbe_Duenbe_Sienbe_arenbe_Penenbe_Anna_enbe".split("_"),weekdaysShort:"ek_Du_Si_ar_Pen_Ann_en".split("_"),weekdaysMin:"k_D_S_r_Pn_An_n".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn sagat] LT",nextDay:"[ertir sagat] LT",nextWeek:"[indiki] dddd [sagat] LT",lastDay:"[dn] LT",lastWeek:"[geen] dddd [sagat] LT",sameElse:"L"},relativeTime:{future:"%s so",past:"%s ",s:"birne sekunt",m:"bir minut",mm:"%d minut",h:"bir sagat",hh:"%d sagat",d:"bir gn",dd:"%d gn",M:"bir a",MM:"%d a",y:"bir yl",yy:"%d yl"},ordinal:function(e,n){switch(n){case"d":case"D":case"Do":case"DD":return e;default:if(0===e)return e+"'unjy";var i=e%10;return e+(t[i]||t[e%100-i]||t[e>=100?100:null])}},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("tl-ph",{months:"Enero_Pebrero_Marso_Abril_Mayo_Hunyo_Hulyo_Agosto_Setyembre_Oktubre_Nobyembre_Disyembre".split("_"),monthsShort:"Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"),weekdays:"Linggo_Lunes_Martes_Miyerkules_Huwebes_Biyernes_Sabado".split("_"),weekdaysShort:"Lin_Lun_Mar_Miy_Huw_Biy_Sab".split("_"),weekdaysMin:"Li_Lu_Ma_Mi_Hu_Bi_Sab".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"MM/D/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY HH:mm",LLLL:"dddd, MMMM DD, YYYY HH:mm"},calendar:{sameDay:"LT [ngayong araw]",nextDay:"[Bukas ng] LT",nextWeek:"LT [sa susunod na] dddd",lastDay:"LT [kahapon]",lastWeek:"LT [noong nakaraang] dddd",sameElse:"L"},relativeTime:{future:"sa loob ng %s",past:"%s ang nakalipas",s:"ilang segundo",ss:"%d segundo",m:"isang minuto",mm:"%d minuto",h:"isang oras",hh:"%d oras",d:"isang araw",dd:"%d araw",M:"isang buwan",MM:"%d buwan",y:"isang taon",yy:"%d taon"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t="pagh_wa_cha_wej_loS_vagh_jav_Soch_chorgh_Hut".split("_");function n(e,n,i,s){var r=function(e){var n=Math.floor(e%1e3/100),i=Math.floor(e%100/10),s=e%10,r="";return n>0&&(r+=t[n]+"vatlh"),i>0&&(r+=(""!==r?" ":"")+t[i]+"maH"),s>0&&(r+=(""!==r?" ":"")+t[s]),""===r?"pagh":r}(e);switch(i){case"ss":return r+" lup";case"mm":return r+" tup";case"hh":return r+" rep";case"dd":return r+" jaj";case"MM":return r+" jar";case"yy":return r+" DIS"}}e.defineLocale("tlh",{months:"tera jar wa_tera jar cha_tera jar wej_tera jar loS_tera jar vagh_tera jar jav_tera jar Soch_tera jar chorgh_tera jar Hut_tera jar wamaH_tera jar wamaH wa_tera jar wamaH cha".split("_"),monthsShort:"jar wa_jar cha_jar wej_jar loS_jar vagh_jar jav_jar Soch_jar chorgh_jar Hut_jar wamaH_jar wamaH wa_jar wamaH cha".split("_"),monthsParseExact:!0,weekdays:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysShort:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysMin:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[DaHjaj] LT",nextDay:"[waleS] LT",nextWeek:"LLL",lastDay:"[waHu] LT",lastWeek:"LLL",sameElse:"L"},relativeTime:{future:function(e){var t=e;return t=-1!==e.indexOf("jaj")?t.slice(0,-3)+"leS":-1!==e.indexOf("jar")?t.slice(0,-3)+"waQ":-1!==e.indexOf("DIS")?t.slice(0,-3)+"nem":t+" pIq"},past:function(e){var t=e;return t=-1!==e.indexOf("jaj")?t.slice(0,-3)+"Hu":-1!==e.indexOf("jar")?t.slice(0,-3)+"wen":-1!==e.indexOf("DIS")?t.slice(0,-3)+"ben":t+" ret"},s:"puS lup",ss:n,m:"wa tup",mm:n,h:"wa rep",hh:n,d:"wa jaj",dd:n,M:"wa jar",MM:n,y:"wa DIS",yy:n},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'nc",4:"'nc",100:"'nc",6:"'nc",9:"'uncu",10:"'uncu",30:"'uncu",60:"'nc",90:"'nc"};e.defineLocale("tr",{months:"Ocak_ubat_Mart_Nisan_Mays_Haziran_Temmuz_Austos_Eyll_Ekim_Kasm_Aralk".split("_"),monthsShort:"Oca_ub_Mar_Nis_May_Haz_Tem_Au_Eyl_Eki_Kas_Ara".split("_"),weekdays:"Pazar_Pazartesi_Sal_aramba_Perembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_ar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_a_Pe_Cu_Ct".split("_"),meridiem:function(e,t,n){return e<12?n?"":"":n?"s":"S"},meridiemParse:/||s|S/,isPM:function(e){return"s"===e||"S"===e},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[yarn saat] LT",nextWeek:"[gelecek] dddd [saat] LT",lastDay:"[dn] LT",lastWeek:"[geen] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s nce",s:"birka saniye",ss:"%d saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir yl",yy:"%d yl"},ordinal:function(e,n){switch(n){case"d":case"D":case"Do":case"DD":return e;default:if(0===e)return e+"'nc";var i=e%10;return e+(t[i]||t[e%100-i]||t[e>=100?100:null])}},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e,t,n,i){var s={s:["viensas secunds","'iensas secunds"],ss:[e+" secunds",e+" secunds"],m:["'n mut","'iens mut"],mm:[e+" muts",e+" muts"],h:["'n ora","'iensa ora"],hh:[e+" oras",e+" oras"],d:["'n ziua","'iensa ziua"],dd:[e+" ziuas",e+" ziuas"],M:["'n mes","'iens mes"],MM:[e+" mesen",e+" mesen"],y:["'n ar","'iens ar"],yy:[e+" ars",e+" ars"]};return i||t?s[n][0]:s[n][1]}e.defineLocale("tzl",{months:"Januar_Fevraglh_Mar_Avru_Mai_Gn_Julia_Guscht_Setemvar_Listopts_Noemvar_Zecemvar".split("_"),monthsShort:"Jan_Fev_Mar_Avr_Mai_Gn_Jul_Gus_Set_Lis_Noe_Zec".split("_"),weekdays:"Sladi_Lnei_Maitzi_Mrcuri_Xhadi_Vineri_Sturi".split("_"),weekdaysShort:"Sl_Ln_Mai_Mr_Xh_Vi_St".split("_"),weekdaysMin:"S_L_Ma_M_Xh_Vi_S".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"D. MMMM [dallas] YYYY",LLL:"D. MMMM [dallas] YYYY HH.mm",LLLL:"dddd, [li] D. MMMM [dallas] YYYY HH.mm"},meridiemParse:/d\'o|d\'a/i,isPM:function(e){return"d'o"===e.toLowerCase()},meridiem:function(e,t,n){return e>11?n?"d'o":"D'O":n?"d'a":"D'A"},calendar:{sameDay:"[oxhi ] LT",nextDay:"[dem ] LT",nextWeek:"dddd [] LT",lastDay:"[ieiri ] LT",lastWeek:"[sr el] dddd [lasteu ] LT",sameElse:"L"},relativeTime:{future:"osprei %s",past:"ja%s",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("tzm",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] LT",sameElse:"L"},relativeTime:{future:"   %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d o",M:"o",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("tzm-latn",{months:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),monthsShort:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),weekdays:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysShort:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysMin:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[asdkh g] LT",nextDay:"[aska g] LT",nextWeek:"dddd [g] LT",lastDay:"[assant g] LT",lastWeek:"dddd [g] LT",sameElse:"L"},relativeTime:{future:"dadkh s yan %s",past:"yan %s",s:"imik",ss:"%d imik",m:"minu",mm:"%d minu",h:"saa",hh:"%d tassain",d:"ass",dd:"%d ossan",M:"ayowr",MM:"%d iyyirn",y:"asgas",yy:"%d isgasn"},week:{dow:6,doy:12}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js language configuration
e.defineLocale("ug-cn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY-M-D-",LLL:"YYYY-M-D- HH:mm",LLLL:"dddd YYYY-M-D- HH:mm"},meridiemParse:/ || || |/,meridiemHour:function(e,t){return 12===e&&(e=0)," "===t||""===t||" "===t?e:" "===t||""===t?e+12:e>=11?e:e+12},meridiem:function(e,t,n){var i=100*e+t;return i<600?" ":i<900?"":i<1130?" ":i<1230?"":i<1800?" ":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"[] dddd [] LT",lastDay:"[] LT",lastWeek:"[] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}(-|-|-)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"-";case"w":case"W":return e+"-";default:return e}},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
function t(e,t,n){var i,s;return"m"===n?t?"":"":"h"===n?t?"":"":e+" "+(i=+e,s={ss:t?"__":"__",mm:t?"__":"__",hh:t?"__":"__",dd:"__",MM:"__",yy:"__"}[n].split("_"),i%10==1&&i%100!=11?s[0]:i%10>=2&&i%10<=4&&(i%100<10||i%100>=20)?s[1]:s[2])}function n(e){return function(){return e+""+(11===this.hours()?"":"")+"] LT"}}e.defineLocale("uk",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:function(e,t){var n={nominative:"______".split("_"),accusative:"______".split("_"),genitive:"______".split("_")};return!0===e?n.nominative.slice(1,7).concat(n.nominative.slice(0,1)):e?n[/(\[[]\]) ?dddd/.test(t)?"accusative":/\[?(?:|)? ?\] ?dddd/.test(t)?"genitive":"nominative"][e.day()]:n.nominative},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:n("[ "),nextDay:n("[ "),lastDay:n("[ "),nextWeek:n("[] dddd ["),lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return n("[] dddd [").call(this);case 1:case 2:case 4:return n("[] dddd [").call(this)}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:t,m:t,mm:t,h:"",hh:t,d:"",dd:t,M:"",MM:t,y:"",yy:t},meridiemParse:/|||/,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e,t,n){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":case"w":case"W":return e+"-";case"D":return e+"-";default:return e}},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
var t=["","","","","","","","","","","",""],n=["","","","","","",""];e.defineLocale("ur",{months:t,monthsShort:t,weekdays:n,weekdaysShort:n,weekdaysMin:n,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[  ] LT",lastWeek:"[] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("uz",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[ ] LT []",nextDay:"[] LT []",nextWeek:"dddd [ ] LT []",lastDay:"[ ] LT []",lastWeek:"[] dddd [ ] LT []",sameElse:"L"},relativeTime:{future:" %s ",past:"  %s ",s:"",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("uz-latn",{months:"Yanvar_Fevral_Mart_Aprel_May_Iyun_Iyul_Avgust_Sentabr_Oktabr_Noyabr_Dekabr".split("_"),monthsShort:"Yan_Fev_Mar_Apr_May_Iyun_Iyul_Avg_Sen_Okt_Noy_Dek".split("_"),weekdays:"Yakshanba_Dushanba_Seshanba_Chorshanba_Payshanba_Juma_Shanba".split("_"),weekdaysShort:"Yak_Dush_Sesh_Chor_Pay_Jum_Shan".split("_"),weekdaysMin:"Ya_Du_Se_Cho_Pa_Ju_Sha".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[Bugun soat] LT [da]",nextDay:"[Ertaga] LT [da]",nextWeek:"dddd [kuni soat] LT [da]",lastDay:"[Kecha soat] LT [da]",lastWeek:"[O'tgan] dddd [kuni soat] LT [da]",sameElse:"L"},relativeTime:{future:"Yaqin %s ichida",past:"Bir necha %s oldin",s:"soniya",ss:"%d soniya",m:"bir daqiqa",mm:"%d daqiqa",h:"bir soat",hh:"%d soat",d:"bir kun",dd:"%d kun",M:"bir oy",MM:"%d oy",y:"bir yil",yy:"%d yil"},week:{dow:1,doy:7}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("vi",{months:"thng 1_thng 2_thng 3_thng 4_thng 5_thng 6_thng 7_thng 8_thng 9_thng 10_thng 11_thng 12".split("_"),monthsShort:"Thg 01_Thg 02_Thg 03_Thg 04_Thg 05_Thg 06_Thg 07_Thg 08_Thg 09_Thg 10_Thg 11_Thg 12".split("_"),monthsParseExact:!0,weekdays:"ch nht_th hai_th ba_th t_th nm_th su_th by".split("_"),weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysParseExact:!0,meridiemParse:/sa|ch/i,isPM:function(e){return/^ch$/i.test(e)},meridiem:function(e,t,n){return e<12?n?"sa":"SA":n?"ch":"CH"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [nm] YYYY",LLL:"D MMMM [nm] YYYY HH:mm",LLLL:"dddd, D MMMM [nm] YYYY HH:mm",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[Hm nay lc] LT",nextDay:"[Ngy mai lc] LT",nextWeek:"dddd [tun ti lc] LT",lastDay:"[Hm qua lc] LT",lastWeek:"dddd [tun trc lc] LT",sameElse:"L"},relativeTime:{future:"%s ti",past:"%s trc",s:"vi giy",ss:"%d giy",m:"mt pht",mm:"%d pht",h:"mt gi",hh:"%d gi",d:"mt ngy",dd:"%d ngy",M:"mt thng",MM:"%d thng",y:"mt nm",yy:"%d nm"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("x-pseudo",{months:"J~~r_F~br~r_~Mrc~h_p~rl_~M_~J~_Jl~_~gst~_Sp~tmb~r_~ctb~r_~vm~br_~Dc~mbr".split("_"),monthsShort:"J~_~Fb_~Mr_~pr_~M_~J_~Jl_~g_~Sp_~ct_~v_~Dc".split("_"),monthsParseExact:!0,weekdays:"S~d~_M~d~_T~sd~_Wd~sd~_T~hrs~d_~Frd~_S~tr~d".split("_"),weekdaysShort:"S~_~M_~T_~Wd_~Th_~Fr_~St".split("_"),weekdaysMin:"S~_M~_T_~W_T~h_Fr~_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[T~d~ t] LT",nextDay:"[T~m~rr~w t] LT",nextWeek:"dddd [t] LT",lastDay:"[~st~rd~ t] LT",lastWeek:"[L~st] dddd [t] LT",sameElse:"L"},relativeTime:{future:"~ %s",past:"%s ~g",s:" ~fw ~sc~ds",ss:"%d s~c~ds",m:" ~m~t",mm:"%d m~~ts",h:"~ h~r",hh:"%d h~rs",d:" ~d",dd:"%d d~s",M:" ~m~th",MM:"%d m~t~hs",y:" ~r",yy:"%d ~rs"},dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("yo",{months:"Sr_Erele_rna_Igbe_Ebibi_Okudu_Agmo_Ogun_Owewe_wara_Belu_p".split("_"),monthsShort:"Sr_Erl_rn_Igb_Ebi_Oku_Ag_Ogu_Owe_wa_Bel_p".split("_"),weekdays:"Aiku_Aje_Isgun_jru_jb_ti_Abamta".split("_"),weekdaysShort:"Aik_Aje_Is_jr_jb_ti_Aba".split("_"),weekdaysMin:"Ai_Aj_Is_r_b_t_Ab".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Oni ni] LT",nextDay:"[la ni] LT",nextWeek:"dddd [s ton'b] [ni] LT",lastDay:"[Ana ni] LT",lastWeek:"dddd [s tol] [ni] LT",sameElse:"L"},relativeTime:{future:"ni %s",past:"%s kja",s:"isju aaya die",ss:"aaya %d",m:"isju kan",mm:"isju %d",h:"wakati kan",hh:"wakati %d",d:"j kan",dd:"j %d",M:"osu kan",MM:"osu %d",y:"dun kan",yy:"dun %d"},dayOfMonthOrdinalParse:/j\s\d{1,2}/,ordinal:"j %d",week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("zh-cn",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMDAhmm",LLLL:"YYYYMDddddAhmm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t||""===t?e:""===t||""===t?e+12:e>=11?e:e+12},meridiem:function(e,t,n){var i=100*e+t;return i<600?"":i<900?"":i<1130?"":i<1230?"":i<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:function(e){return e.week()!==this.week()?"[]dddLT":"[]dddLT"},lastDay:"[]LT",lastWeek:function(e){return this.week()!==e.week()?"[]dddLT":"[]dddLT"},sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},week:{dow:1,doy:4}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("zh-hk",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t||""===t?e:""===t?e>=11?e:e+12:""===t||""===t?e+12:void 0},meridiem:function(e,t,n){var i=100*e+t;return i<600?"":i<900?"":i<1200?"":1200===i?"":i<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("zh-mo",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm",l:"D/M/YYYY",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t||""===t?e:""===t?e>=11?e:e+12:""===t||""===t?e+12:void 0},meridiem:function(e,t,n){var i=100*e+t;return i<600?"":i<900?"":i<1130?"":i<1230?"":i<1800?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd LT",lastDay:"[] LT",lastWeek:"[]dddd LT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}})}(n(1))},function(e,t,n){!function(e){"use strict";
//! moment.js locale configuration
e.defineLocale("zh-tw",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t||""===t?e:""===t?e>=11?e:e+12:""===t||""===t?e+12:void 0},meridiem:function(e,t,n){var i=100*e+t;return i<600?"":i<900?"":i<1130?"":i<1230?"":i<1800?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd LT",lastDay:"[] LT",lastWeek:"[]dddd LT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}})}(n(1))},function(e,t,n){(function(e){var i=t.noop=function(){};function s(e,t,n){this.logFunction=n,this.identifier=e,this.uniqueID=t,this.buffer=[]}t.extend=function(e,t){for(var n in t)e[n]=t[n]},t.eventEmitterListenerCount=n(24).EventEmitter.listenerCount||function(e,t){return e.listeners(t).length},t.BufferingLogger=function(e,t){var r=n(1352)(e);if(r.enabled){var o=new s(e,t,r),a=o.log.bind(o);return a.printOutput=o.printOutput.bind(o),a.enabled=r.enabled,a}return r.printOutput=i,r},s.prototype.log=function(){return this.buffer.push([new Date,Array.prototype.slice.call(arguments)]),this},s.prototype.clear=function(){return this.buffer=[],this},s.prototype.printOutput=function(t){t||(t=this.logFunction);var n=this.uniqueID;this.buffer.forEach((function(i){var s=i[0].toLocaleString(),r=i[1].slice(),o=r[0];null!=o&&(o="%s - %s - "+o.toString(),r.splice(0,1,o,s,n),t.apply(e,r))}))}}).call(this,n(27))},function(e,t,n){(function(t){n(28);var i=n(59),s=n(32),r=n(24).EventEmitter,o=n(193).client,a=(n(193).connection,/,\s*/),c=/;\s*/,l=/[\r\n]/g,u=/,\s*/,d=["(",")","<",">","@",",",";",":","\\",'"',"/","[","]","?","=","{","}"," ",String.fromCharCode(9)],h=/[;,] */;function f(e,t,n,i){r.call(this),this.resource=e,this.address=e,this.id=t,this.httpRequest={headers:{}};for(var s=Object.keys(n),o=s.length;o;--o)this.httpRequest.headers[s[o-1].toLowerCase()]=n[s[o-1]];this.serverConfig=i,this._resolved=!1}i.inherits(f,r),f.prototype.readHandshake=function(){var e=this,t=this.httpRequest;if(this.resourceURL=s.parse(this.resource,!0),this.host=t.headers.host,!this.host)throw new Error("Client must provide a Host header.");if(this.key=t.headers["sec-websocket-key"],!this.key)throw new Error("Client must provide a value for Sec-WebSocket-Key.");if(this.webSocketVersion=parseInt(t.headers["sec-websocket-version"],10),!this.webSocketVersion||isNaN(this.webSocketVersion))throw new Error("Client must provide a value for Sec-WebSocket-Version.");var n=t.headers["sec-websocket-protocol"];(this.protocolFullCaseMap={},this.requestedProtocols=[],n)&&n.split(a).forEach((function(t){var n=t.toLocaleLowerCase();e.requestedProtocols.push(n),e.protocolFullCaseMap[n]=t}));if(!this.serverConfig.ignoreXForwardedFor&&t.headers["x-forwarded-for"]){var i=this.remoteAddress;this.remoteAddresses=t.headers["x-forwarded-for"].split(u),this.remoteAddresses.push(i),this.remoteAddress=this.remoteAddresses[0]}var r=t.headers["sec-websocket-extensions"];this.requestedExtensions=this.parseExtensions(r);var o=t.headers.cookie;this.cookies=this.parseCookies(o)},f.prototype.parseExtensions=function(e){if(!e||0===e.length)return[];var t=e.toLocaleLowerCase().split(a);return t.forEach((function(e,t,n){var i=e.split(c),s=i[0],r=i.slice(1);r.forEach((function(e,t,n){var i=e.split("="),s={name:i[0],value:i[1]};n.splice(t,1,s)}));var o={name:s,params:r};n.splice(t,1,o)})),t},f.prototype.parseCookies=function(e){if(!e||"string"!=typeof e)return[];var t=[];return e.split(h).forEach((function(e){var n=e.indexOf("=");if(-1!==n){var i=e.substr(0,n).trim(),s=e.substr(++n,e.length).trim();'"'===s[0]&&(s=s.slice(1,-1)),t.push({name:i,value:decodeURIComponent(s)})}else t.push({name:e,value:null})})),t},f.prototype.accept=function(e,t,n,i){var s=this,r=null;if(e?void 0===(r=this.protocolFullCaseMap[e.toLocaleLowerCase()])&&(r=e):r=e,this.protocolFullCaseMap=null,r){for(var a=0;a<r.length;a++){var c=r.charCodeAt(a),u=r.charAt(a);if(c<33||c>126||-1!==d.indexOf(u))throw this.reject(500),new Error('Illegal character "'+String.fromCharCode(u)+'" in subprotocol.')}if(-1===this.requestedProtocols.indexOf(e))throw this.reject(500),new Error("Specified protocol was not requested by the client.");r=r.replace(l,"")}this.requestedProtocols=null,this._resolved=!0,this.emit("requestResolved",this);var h=new o;h.connect(this.address,r),h.on("connect",(function(e){s.emit("requestAccepted",e),i&&i(e)})),h.on("error",(function(e){s.emit("requestRejected",e),i&&i(e)}))},f.prototype.reject=function(e,t,n,i){var s=new o,r=this.address+"&statusCode="+e+"&statusDescription="+encodeURIComponent(t);s.connect(r,null,null,n),s.on("error",(function(e){this.emit("requestRejected",e),i(e)}))},f.prototype._handleSocketCloseBeforeAccept=function(){this._socketIsClosing=!0,this._removeSocketCloseListeners()},f.prototype._removeSocketCloseListeners=function(){this.socket.removeListener("end",this._socketCloseHandler),this.socket.removeListener("close",this._socketCloseHandler)},f.prototype._verifyResolution=function(){if(this._resolved)throw new Error("HybridConnectionsWebSocketRequest may only be accepted or rejected one time.")},e.exports=f}).call(this,n(11))},function(e,t,n){"use strict";const{AbortController:i,AbortSignal:s}="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0;e.exports=i,e.exports.AbortSignal=s,e.exports.default=i},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var i=n(73),s=n(10),r=function(){function t(){}return t.prototype.writeHandshakeRequest=function(e){return i.a.write(JSON.stringify(e))},t.prototype.parseHandshakeResponse=function(t){var n,r;if(Object(s.i)(t)||void 0!==e&&t instanceof e){var o=new Uint8Array(t);if(-1===(c=o.indexOf(i.a.RecordSeparatorCode)))throw new Error("Message is incomplete.");var a=c+1;n=String.fromCharCode.apply(null,o.slice(0,a)),r=o.byteLength>a?o.slice(a).buffer:null}else{var c,l=t;if(-1===(c=l.indexOf(i.a.RecordSeparator)))throw new Error("Message is incomplete.");a=c+1;n=l.substring(0,a),r=l.length>a?l.substring(a):null}var u=i.a.parse(n),d=JSON.parse(u[0]);if(d.type)throw new Error("Expected a handshake response from the server.");return[r,d]},t}()}).call(this,n(3).Buffer)},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);n(703)({base:e+"/.."});const s=n(19),r=n(4),o=n(5),a=n(107),c=n(290),l=n(1226),u=n(7),d=n(9),h=n(509),f=n(513),p=n(491),m=n(20),g=n(1278),y=n(1341),v=n(1342),S=n(62),_=n(517),E=n(1357),w=n(1358);r.TimeTracker.initialize();const b=n(1359),C={ppe:["https://ppe.liveshare.vsengsaas.visualstudio.com/","https://signlr-ppe.core.vsengsaas.visualstudio.com/api/signalr/signalrhub"],dev:["https://ci.dev.liveshare.vsengsaas.visualstudio.com/","https://signlr.dev.core.vsengsaas.visualstudio.com/api/signalr/signalrhub"],"insiders-stg":["https://insiders-stg.liveshare.vsengsaas.visualstudio.com/",void 0]},T=new u.OptOutTelemetryFilter,M=/([0-9a-z]{36})/im;async function A(){await i.commands.executeCommand("liveshare.leave")}t.activate=async function(e){r.TimeTracker.start("extension:activate"),await r.ExtensionUtil.setCommandContext("liveshare:isWeb",!0),await r.Settings.settingsProvider.init(e,void 0),d.Telemetry.addFilter(T);let t=r.ExtensionUtil.getPackageExtension(r.constants.LIVESHARE_EXTENSION_ID);if(!t)throw new Error(`Failed to get package for extensionId:${r.constants.LIVESHARE_EXTENSION_ID}`);let g=!1;r.Settings.get(r.SettingKeys.firstActivationTime)||(r.Settings.save(r.SettingKeys.firstActivationTime,(new Date).getTime()),g=!0);const y=E.queryParameter("env");if(y&&C.hasOwnProperty(y)){const e=C[y];r.Settings.save(r.SettingKeys.serviceUri,e[0]),e[1]&&r.Settings.save(r.SettingKeys.signalRServiceUri,e[1])}const v=r.Settings.get(r.SettingKeys.canCollectPII)||E.optionQuery("canCollectPII"),R=r.Settings.get(r.SettingKeys.diagnosticLogging)||E.optionQuery("enableLogging"),P=r.ExtensionUtil.isNode(),I=()=>{if(P){const e=n(18),t=n(117);return e.join(t.tmpdir(),"VSFeedbackVSRTCLogs")}};await r.TimeTracker.timeIt("intialize commands",async()=>await u.vslsCommands.initialize({extensionPackage:t,extensionContext:e,telemetry:{featureName:"liveshare.",canSendSensistiveInformation:v},logging:{logFileEnabled:P,logFilePath:I(),logLevel:r.Settings.get(r.SettingKeys.diagnosticLoggingLevel),outputChannelName:r.Settings.get(r.SettingKeys.name),outputChannelTimestamp:r.Settings.get("outputChannelTimestamp"),filters:r.Settings.get("traceFilters"),diagnosticsLogging:{enable:R,focus:E.optionQuery("focusLogging")}}})),r.ExtensionTelemetry.setSettingsContextProperties();const N=w.detect();d.Telemetry.addContextProperty(r.TelemetryPropertyNames.BROWSER_VERSION,N&&N.version||"<unknown>"),d.Telemetry.addContextProperty(r.TelemetryPropertyNames.BROWSER_NAME,N&&N.name||"<unknown>"),await r.TimeTracker.timeIt("initExpServiceAsync",async()=>await r.initExpServiceAsync(e,!0)),s.LoggerSettings.disableObfuscation=v,u.traceSource.info(`Liveshare activated name:${t.name} version:${t.version}`),r.ExtensionUtil.init(e,{extensionName:r.Settings.get(r.SettingKeys.abbreviation),extensionVersion:t.version,applicationName:"VSCode",applicationVersion:i.version},r.constants.LIVESHARE_EXTENSION_ID);const L=d.Telemetry.startTimedEvent(r.TelemetryEventNames.ACTIVATE_EXTENSION),D=r.dependencies;D.enableCommands={},r.Settings.save(r.SettingKeys.runsInVSCodeDev,!0),r.Settings.save(r.SettingKeys.nativeAuthFlow,!0),D.authenticationProvider.value=new r.AuthenticationProviderBase(D.authService(),r.Settings.get(r.SettingKeys.nativeAuthFlow));const x=[r.liveshareGithubStrategy,r.liveshareAnonymousStrategy];await r.auth.init(e,r.constants.LIVESHARE_EXTENSION_ID,x,b),r.registerProtocolHandler(L),D.hubConnectionServiceFactory=new l.HubConnectionServiceFactory(D.authService(),r.Settings.get(r.SettingKeys.signalRServiceUri),a.ContactManager,u.traceSource.withName("HubConnectionServiceFactory"));const O=await D.hubConnectionServiceFactory.getOrCreate();D.agentRpcServer=new p.MultiChannelRpcServer(u.traceSource);const F=D.rpcClient.value=await p.createDuplexMultiChannelRpcClient(D.agentRpcServer,u.traceSource),U=new m.RpcProxyCache(F,u.traceSource.withName("RpcProxyCache")),j=new r.RpcServices(e=>U.getOrCreate(e),r.lazyLoad(()=>F));r.Dependencies.rpcServices=j,D.fileSystemManager().registerFileSystemProvider();let H=function(){if(i.workspace.workspaceFolders&&i.workspace.workspaceFolders.length>0){const e=i.workspace.workspaceFolders[0].uri;if("vsls"===e.scheme)return e.query}if(E.queries.length>0){const e=E.queryParameter("sessionId"),t=null==e?void 0:e.match(M);return e&&!t&&(u.traceSource.error("Activation: Invalid collaboration session URL"),i.window.showErrorMessage(r.localize("Joining collaboration session: Invalid collaboration session URL"),{modal:!0})),t?t[0]:""}}();H||(H=r.Settings.get(r.SettingKeys.joinWorkspaceId)),H&&D.fileSystemManager().workspaceProvider.createorUpdateWorkspaceFile(H,"");const B=U.getOrCreate(o.vsls.WorkspaceService);B.onConnectionStatusChanged(e=>async function(e){if(e.connectionStatus!==o.vsls.WorkspaceConnectionStatus.Disconnected&&e.connectionStatus!==o.vsls.WorkspaceConnectionStatus.Unavailable)return;if(e.disconnectedReason===o.vsls.WorkspaceDisconnectedReason.Requested)return;if(r.sessionStateTracker.State===r.SessionState.Joined||r.sessionStateTracker.State===r.SessionState.JoiningInProgress){let t,n=!1;switch(e.disconnectedReason){case o.vsls.WorkspaceDisconnectedReason.SessionEnded:t=r.localize("The host has ended the current collaboration session. Open folders and editors will now close.");break;case o.vsls.WorkspaceDisconnectedReason.SessionExpired:t=r.localize("The collaboration session expired. Please sign in and try again."),n=!0;break;case o.vsls.WorkspaceDisconnectedReason.UserRemoved:new d.TelemetryEvent(r.TelemetryEventNames.REMOVE_USER).send(),t=r.localize("You have been removed from the collaboration session.");break;case o.vsls.WorkspaceDisconnectedReason.UserBlocked:new d.TelemetryEvent(r.TelemetryEventNames.BLOCK_USER).send(),t=r.localize("You have been blocked from the collaboration session.");break;case o.vsls.WorkspaceDisconnectedReason.ConnectionLost:t=r.localize("You were disconnected from the collaboration session due to a connectivity problem or the host going offline."),n=!0;break;case o.vsls.WorkspaceDisconnectedReason.InternalError:default:t=r.localize("The collaboration session has ended due to an internal error."),n=!0}n?await i.window.showErrorMessage(t,{modal:!0}):await i.window.showInformationMessage(t,{modal:!0}),await A()}}(e)),B.onUserRemoved(async()=>{await i.window.showInformationMessage(r.localize("You have been removed from the collaboration session."),{modal:!0}),await A()}),B.onUserBlocked(async()=>{await i.window.showInformationMessage(r.localize("You have been blocked from the collaboration session."),{modal:!0}),await A()}),e.subscriptions.push(i.debug.registerDebugAdapterDescriptorFactory("vslsJoin",new h.JoinDebugAdapterDescriptorFactory(D.workspaceServices(),j.rpcFactory,u.traceSource.withName("JoinDebugAdapterDescriptorFactory"))));const Y=new k(D.commandRegistryProvider(),D);await Y.init(),r.TimeTracker.markTime("Initialize Commands"),new r.Commands(D).initialize(),r.ExtensionUtil.setCommandContext("liveshare:showExplorer",!0),r.ExtensionUtil.setCommandContext("liveshare:showHelpViewlet",!0);const W=await c.CommunicationsManager.isAudioEnabled();r.ExtensionUtil.setCommandContext("liveshare:isAudioEnabled",W);const q=await c.CommunicationsManager.isChatEnabled();if(r.ExtensionUtil.setCommandContext("liveshare:isChatEnabled",q),D.statusBarController.value=null,r.createSimpleStatusBar(),e.subscriptions.push(new f.ServerManager(D)),a.ContactManager.once(r.ContactManagerEvents.Ready,async()=>{r.TimeTracker.start("Contact Manager Ready");const e=new l.PresenceServiceProvider(O,u.traceSource.withName("PresenceServiceProvider"));await a.ContactManager.registerAndInitializeServiceProvider(r.constants.LIVESHARE_PRESENCE_PROVIDER_ID,e);const t=new a.ContactsProviderViewlet(r.SessionContext);i.window.registerTreeDataProvider("liveshare.contacts",t),a.isLivesharePresenceEnabled()&&await a.ContactManager.getServiceManager(r.constants.LIVESHARE_PRESENCE_PROVIDER_ID).signIn(),r.TimeTracker.stop("Contact Manager Ready")}),r.TimeTracker.markTime("Initialize Contact Manager"),a.ContactManager.initialize(D),r.initInviteLinkSupport(a.ContactManager),r.TimeTracker.markTime("Initialize Communications Manager"),await c.CommunicationsManager.initialize(D),H){r.userAuthStateTracker.completeDefaultAuthAttempt();const e={isActivate:!0,link:`${r.Settings.get(r.SettingKeys.serviceUri)}join?${H}`,isAllowAnonymous:!0};i.commands.executeCommand("liveshare.join",e)}else(async e=>{await i.commands.executeCommand("liveshare.signin",{isDefaultSignIn:e})})(!0);const V=(e,t)=>{const n=new r.SessionExplorerProvider(r.SessionContext);return t&&n.registerTreeDataProvider(new r.CollabActionTreeDataProvider(e)),n};r.TimeTracker.markTime("Create session explorers");const $=V(!1,!1),K=V(!0,!0),z={};z[S.View.ExplorerSession]=K,z[S.View.Session]=$,i.window.registerTreeDataProvider(S.View.ExplorerSession,K),i.window.registerTreeDataProvider(S.View.Session,$),i.window.registerTreeDataProvider(S.View.Help,new r.HelpViewletProvider),D.activityBarProvider=$,D.fileTreeExplorerProvider=K;const G=new _.LiveShareExtensionApi({client:F,workspaceService:D.workspaceService(),workspaceUserService:D.workspaceUserService(),workspaceServices:D.workspaceServices(),pathManager:D.pathManager(),contactManager:a.ContactManager,treeViews:z,authStrategies:[],apiPromise:r.Settings.settingsProvider.ready});return r.TimeTracker.stop("extension:activate"),L.end(d.TelemetryResult.Success,"Extension activation success.",!0),G},t.deactivate=function(){T.dispose()};class k extends r.ExtensionSetupBase{constructor(e,t){super(e,t)}get shareCommandBuilder(){return v.shareCommandBuilder}get joinCommandBuilder(){return g.joinCommandBuilder}registerCommands(){super.registerCommands(),a.registerContactCommands(this),c.registerCommunicationsCommands(this),this.register("liveshare.end",v.endCommandBuilder),this.register("liveshare.endFromFileTreeExplorer",v.endCommandBuilder),this.register("liveshare.endFromActivityBar",v.endCommandBuilder),this.register("liveshare.leave",g.leaveCommandBuilder),this.register("liveshare.leaveFromActivityBar",g.leaveCommandBuilder),this.register("liveshare.leaveFromFileTreeExplorer",g.leaveCommandBuilder),this.register("liveshare.workbench.dispose",g.leaveCommandBuilder),this.register("liveshare.signin.token",y.builder)}}}).call(this,"/")},function(e,t,n){"use strict";e.exports=function(e){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(705);t.BrowserConsoleTraceListener=i.BrowserConsoleTraceListener;var s=n(318);t.ConsoleTraceListener=s.ConsoleTraceListener;var r=n(724);t.OutputTraceListener=r.OutputTraceListener;var o=n(725);t.MemoryTraceListener=o.MemoryTraceListener},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(112),s=n(317),r=n(318);class o extends r.ConsoleTraceListener{constructor(e=new s.DebugConsoleLogger){super(e)}writeEvent(e,t,n,s,...r){switch(t){case i.LogLevel.Critical:case i.LogLevel.Error:return this.consoleReference.error(e,s,...r);case i.LogLevel.Warning:return this.consoleReference.warn(e,s,...r);case i.LogLevel.Debug:return this.consoleReference.debug?this.consoleReference.debug(e,s,...r):this.consoleReference.info(e,s,...r);default:return this.consoleReference.info(e,s,...r)}}}t.BrowserConsoleTraceListener=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(707);class s{constructor(e=globalThis.console){this.console=e,this.tracesCache={},this.createTrace=(e,t,n)=>{const s=`${e}:${t}`,r=this.tracesCache[s];if(r)return r;const o=i.default(s);return o.log=n,this.tracesCache[s]=o,o},this.log=(e,t,...n)=>this.info(e,t,...n),this.info=(e,t,...n)=>{this.createTrace(e,"info",this.console.info)(t,...n)},this.debug=(e,t,...n)=>{const i=this.console.debug?this.console.debug:this.console.log;this.createTrace(e,"trace",i)(t,...n)},this.warn=(e,t,...n)=>{this.createTrace(e,"warn",this.console.warn)(e,t,...n)},this.error=(e,t,...n)=>{this.createTrace(e,"error",this.console.error)(e,t,...n)}}}t.DebugConsoleLogger=s,s.enable=e=>{i.default.enable(e)}},function(e,t,n){(function(i){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let i=0,s=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(i++,"%c"===e&&(s=i))}),t.splice(s,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==i&&"env"in i&&(e=i.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(708)(t);const{formatters:s}=e.exports;s.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n(11))},function(e,t,n){e.exports=function(e){function t(e){let n,s=null;function r(...e){if(!r.enabled)return;const i=r,s=Number(new Date),o=s-(n||s);i.diff=o,i.prev=n,i.curr=s,n=s,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,s)=>{if("%%"===n)return"%";a++;const r=t.formatters[s];if("function"==typeof r){const t=e[a];n=r.call(i,t),e.splice(a,1),a--}return n}),t.formatArgs.call(i,e),(i.log||t.log).apply(i,e)}return r.namespace=e,r.useColors=t.useColors(),r.color=t.selectColor(e),r.extend=i,r.destroy=t.destroy,Object.defineProperty(r,"enabled",{enumerable:!0,configurable:!1,get:()=>null===s?t.enabled(e):s,set:e=>{s=e}}),"function"==typeof t.init&&t.init(r),r}function i(e,n){const i=t(this.namespace+(void 0===n?":":n)+e);return i.log=this.log,i}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(s),...t.skips.map(s).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.names=[],t.skips=[];const i=("string"==typeof e?e:"").split(/[\s,]+/),s=i.length;for(n=0;n<s;n++)i[n]&&("-"===(e=i[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,i;for(n=0,i=t.skips.length;n<i;n++)if(t.skips[n].test(e))return!1;for(n=0,i=t.names.length;n<i;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(709),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(n=>{t[n]=e[n]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},function(e,t){var n=1e3,i=6e4,s=60*i,r=24*s;function o(e,t,n,i){var s=t>=1.5*n;return Math.round(e/n)+" "+i+(s?"s":"")}e.exports=function(e,t){t=t||{};var a=typeof e;if("string"===a&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var o=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*r;case"hours":case"hour":case"hrs":case"hr":case"h":return o*s;case"minutes":case"minute":case"mins":case"min":case"m":return o*i;case"seconds":case"second":case"secs":case"sec":case"s":return o*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(e);if("number"===a&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=r)return o(e,t,r,"day");if(t>=s)return o(e,t,s,"hour");if(t>=i)return o(e,t,i,"minute");if(t>=n)return o(e,t,n,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=r)return Math.round(e/r)+"d";if(t>=s)return Math.round(e/s)+"h";if(t>=i)return Math.round(e/i)+"m";if(t>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){var i;!function(s){"use strict";var r,o,a,c=(r=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|"[^"]*"|'[^']*'/g,o=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,a=/[^-+\dA-Z]/g,function(e,t,n,i){if(1!==arguments.length||"string"!==h(e)||/\d/.test(e)||(t=e,e=void 0),(e=e||new Date)instanceof Date||(e=new Date(e)),isNaN(e))throw TypeError("Invalid date");var s=(t=String(c.masks[t]||t||c.masks.default)).slice(0,4);"UTC:"!==s&&"GMT:"!==s||(t=t.slice(4),n=!0,"GMT:"===s&&(i=!0));var f=n?"getUTC":"get",p=e[f+"Date"](),m=e[f+"Day"](),g=e[f+"Month"](),y=e[f+"FullYear"](),v=e[f+"Hours"](),S=e[f+"Minutes"](),_=e[f+"Seconds"](),E=e[f+"Milliseconds"](),w=n?0:e.getTimezoneOffset(),b=u(e),C=d(e),T={d:p,dd:l(p),ddd:c.i18n.dayNames[m],dddd:c.i18n.dayNames[m+7],m:g+1,mm:l(g+1),mmm:c.i18n.monthNames[g],mmmm:c.i18n.monthNames[g+12],yy:String(y).slice(2),yyyy:y,h:v%12||12,hh:l(v%12||12),H:v,HH:l(v),M:S,MM:l(S),s:_,ss:l(_),l:l(E,3),L:l(Math.round(E/10)),t:v<12?c.i18n.timeNames[0]:c.i18n.timeNames[1],tt:v<12?c.i18n.timeNames[2]:c.i18n.timeNames[3],T:v<12?c.i18n.timeNames[4]:c.i18n.timeNames[5],TT:v<12?c.i18n.timeNames[6]:c.i18n.timeNames[7],Z:i?"GMT":n?"UTC":(String(e).match(o)||[""]).pop().replace(a,""),o:(w>0?"-":"+")+l(100*Math.floor(Math.abs(w)/60)+Math.abs(w)%60,4),S:["th","st","nd","rd"][p%10>3?0:(p%100-p%10!=10)*p%10],W:b,N:C};return t.replace(r,(function(e){return e in T?T[e]:e.slice(1,e.length-1)}))});function l(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e}function u(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var n=new Date(t.getFullYear(),0,4);n.setDate(n.getDate()-(n.getDay()+6)%7+3);var i=t.getTimezoneOffset()-n.getTimezoneOffset();t.setHours(t.getHours()-i);var s=(t-n)/6048e5;return 1+Math.floor(s)}function d(e){var t=e.getDay();return 0===t&&(t=7),t}function h(e){return null===e?"null":void 0===e?"undefined":"object"!=typeof e?typeof e:Array.isArray(e)?"array":{}.toString.call(e).slice(8,-1).toLowerCase()}c.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},c.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},void 0===(i=function(){return c}.call(t,n,t,e))||(e.exports=i)}()},function(module,exports,__webpack_require__){(function(process,global){var __WEBPACK_AMD_DEFINE_RESULT__;
/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.9.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */!function(){"use strict";var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&"object"==typeof module&&module.exports,AMD=__webpack_require__(712),ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];!root.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(e,t){return function(n){return new Sha256(t,!0).update(n)[e]()}},createMethod=function(e){var t=createOutputMethod("hex",e);NODE_JS&&(t=nodeWrap(t,e)),t.create=function(){return new Sha256(e)},t.update=function(e){return t.create().update(e)};for(var n=0;n<OUTPUT_TYPES.length;++n){var i=OUTPUT_TYPES[n];t[i]=createOutputMethod(i,e)}return t},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(e){if("string"==typeof e)return crypto.createHash(algorithm).update(e,"utf8").digest("hex");if(null==e)throw new Error(ERROR);return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod},createHmacOutputMethod=function(e,t){return function(n,i){return new HmacSha256(n,t,!0).update(i)[e]()}},createHmacMethod=function(e){var t=createHmacOutputMethod("hex",e);t.create=function(t){return new HmacSha256(t,e)},t.update=function(e,n){return t.create(e).update(n)};for(var n=0;n<OUTPUT_TYPES.length;++n){var i=OUTPUT_TYPES[n];t[i]=createHmacOutputMethod(i,e)}return t};function Sha256(e,t){t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function HmacSha256(e,t,n){var i,s=typeof e;if("string"===s){var r,o=[],a=e.length,c=0;for(i=0;i<a;++i)(r=e.charCodeAt(i))<128?o[c++]=r:r<2048?(o[c++]=192|r>>6,o[c++]=128|63&r):r<55296||r>=57344?(o[c++]=224|r>>12,o[c++]=128|r>>6&63,o[c++]=128|63&r):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++i)),o[c++]=240|r>>18,o[c++]=128|r>>12&63,o[c++]=128|r>>6&63,o[c++]=128|63&r);e=o}else{if("object"!==s)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR)}e.length>64&&(e=new Sha256(t,!0).update(e).array());var l=[],u=[];for(i=0;i<64;++i){var d=e[i]||0;l[i]=92^d,u[i]=54^d}Sha256.call(this,t,n),this.update(u),this.oKeyPad=l,this.inner=!0,this.sharedMemory=n}Sha256.prototype.update=function(e){if(!this.finalized){var t,n=typeof e;if("string"!==n){if("object"!==n)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR);t=!0}for(var i,s,r=0,o=e.length,a=this.blocks;r<o;){if(this.hashed&&(this.hashed=!1,a[0]=this.block,a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),t)for(s=this.start;r<o&&s<64;++r)a[s>>2]|=e[r]<<SHIFT[3&s++];else for(s=this.start;r<o&&s<64;++r)(i=e.charCodeAt(r))<128?a[s>>2]|=i<<SHIFT[3&s++]:i<2048?(a[s>>2]|=(192|i>>6)<<SHIFT[3&s++],a[s>>2]|=(128|63&i)<<SHIFT[3&s++]):i<55296||i>=57344?(a[s>>2]|=(224|i>>12)<<SHIFT[3&s++],a[s>>2]|=(128|i>>6&63)<<SHIFT[3&s++],a[s>>2]|=(128|63&i)<<SHIFT[3&s++]):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++r)),a[s>>2]|=(240|i>>18)<<SHIFT[3&s++],a[s>>2]|=(128|i>>12&63)<<SHIFT[3&s++],a[s>>2]|=(128|i>>6&63)<<SHIFT[3&s++],a[s>>2]|=(128|63&i)<<SHIFT[3&s++]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.block=a[16],this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=EXTRA[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var e,t,n,i,s,r,o,a,c,l=this.h0,u=this.h1,d=this.h2,h=this.h3,f=this.h4,p=this.h5,m=this.h6,g=this.h7,y=this.blocks;for(e=16;e<64;++e)t=((s=y[e-15])>>>7|s<<25)^(s>>>18|s<<14)^s>>>3,n=((s=y[e-2])>>>17|s<<15)^(s>>>19|s<<13)^s>>>10,y[e]=y[e-16]+t+y[e-7]+n<<0;for(c=u&d,e=0;e<64;e+=4)this.first?(this.is224?(r=300032,g=(s=y[0]-1413257819)-150054599<<0,h=s+24177077<<0):(r=704751109,g=(s=y[0]-210244248)-1521486534<<0,h=s+143694565<<0),this.first=!1):(t=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),i=(r=l&u)^l&d^c,g=h+(s=g+(n=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&p^~f&m)+K[e]+y[e])<<0,h=s+(t+i)<<0),t=(h>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),i=(o=h&l)^h&u^r,m=d+(s=m+(n=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&f^~g&p)+K[e+1]+y[e+1])<<0,t=((d=s+(t+i)<<0)>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),i=(a=d&h)^d&l^o,p=u+(s=p+(n=(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7))+(m&g^~m&f)+K[e+2]+y[e+2])<<0,t=((u=s+(t+i)<<0)>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),i=(c=u&d)^u&h^a,f=l+(s=f+(n=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&m^~p&g)+K[e+3]+y[e+3])<<0,l=s+(t+i)<<0;this.h0=this.h0+l<<0,this.h1=this.h1+u<<0,this.h2=this.h2+d<<0,this.h3=this.h3+h<<0,this.h4=this.h4+f<<0,this.h5=this.h5+p<<0,this.h6=this.h6+m<<0,this.h7=this.h7+g<<0},Sha256.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,i=this.h3,s=this.h4,r=this.h5,o=this.h6,a=this.h7,c=HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[15&s]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o];return this.is224||(c+=HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a]),c},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,i=this.h3,s=this.h4,r=this.h5,o=this.h6,a=this.h7,c=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24&255,n>>16&255,n>>8&255,255&n,i>>24&255,i>>16&255,i>>8&255,255&i,s>>24&255,s>>16&255,s>>8&255,255&s,r>>24&255,r>>16&255,r>>8&255,255&r,o>>24&255,o>>16&255,o>>8&255,255&o];return this.is224||c.push(a>>24&255,a>>16&255,a>>8&255,255&a),c},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224,AMD&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}()}).call(this,__webpack_require__(11),__webpack_require__(27))},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(714);t.errorToString=function(e){if(!e)return null;let t=e.message||"Unknown error";const n=e.code;n&&(t+=" code:"+n);let s=null;if(e.vslsStack)try{s=e.vslsStack.map(e=>"  at "+i.wrapCallSite(e)).join("\n")}catch(e){}return s||(s=e.stack||null),s&&(t+="\n"+s),t}},function(e,t,n){(function(e){var i,s=n(715).SourceMapConsumer,r=n(18);try{(i=n(74)).existsSync&&i.readFileSync||(i=null)}catch(e){}var o=n(722),a=!1,c=!1,l=!1,u="auto",d={},h={},f=/^data:application\/json[^,]+base64,/,p=[],m=[];function g(){return"browser"===u||"node"!==u&&("undefined"!=typeof window&&"function"==typeof XMLHttpRequest&&!(window.require&&window.module&&window.process&&"renderer"===window.process.type))}function y(e){return function(t){for(var n=0;n<e.length;n++){var i=e[n](t);if(i)return i}return null}}var v=y(p);function S(e,t){if(!e)return t;var n=r.dirname(e),i=/^\w+:\/\/[^\/]*/.exec(n),s=i?i[0]:"",o=n.slice(s.length);return s&&/^\/\w\:/.test(o)?(s+="/")+r.resolve(n.slice(s.length),t).replace(/\\/g,"/"):s+r.resolve(n.slice(s.length),t)}p.push((function(e){if(e=e.trim(),/^file:/.test(e)&&(e=e.replace(/file:\/\/\/(\w:)?/,(function(e,t){return t?"":"/"}))),e in d)return d[e];var t="";try{if(i)i.existsSync(e)&&(t=i.readFileSync(e,"utf8"));else{var n=new XMLHttpRequest;n.open("GET",e,!1),n.send(null),4===n.readyState&&200===n.status&&(t=n.responseText)}}catch(e){}return d[e]=t}));var _=y(m);function E(e){var t=h[e.source];if(!t){var n=_(e.source);n?(t=h[e.source]={url:n.url,map:new s(n.map)}).map.sourcesContent&&t.map.sources.forEach((function(e,n){var i=t.map.sourcesContent[n];if(i){var s=S(t.url,e);d[s]=i}})):t=h[e.source]={url:null,map:null}}if(t&&t.map&&"function"==typeof t.map.originalPositionFor){var i=t.map.originalPositionFor(e);if(null!==i.source)return i.source=S(t.url,i.source),i}return e}function w(){var e,t="";if(this.isNative())t="native";else{!(e=this.getScriptNameOrSourceURL())&&this.isEval()&&(t=this.getEvalOrigin(),t+=", "),t+=e||"<anonymous>";var n=this.getLineNumber();if(null!=n){t+=":"+n;var i=this.getColumnNumber();i&&(t+=":"+i)}}var s="",r=this.getFunctionName(),o=!0,a=this.isConstructor();if(!(this.isToplevel()||a)){var c=this.getTypeName();"[object Object]"===c&&(c="null");var l=this.getMethodName();r?(c&&0!=r.indexOf(c)&&(s+=c+"."),s+=r,l&&r.indexOf("."+l)!=r.length-l.length-1&&(s+=" [as "+l+"]")):s+=c+"."+(l||"<anonymous>")}else a?s+="new "+(r||"<anonymous>"):r?s+=r:(s+=t,o=!1);return o&&(s+=" ("+t+")"),s}function b(e){var t={};return Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach((function(n){t[n]=/^(?:is|get)/.test(n)?function(){return e[n].call(e)}:e[n]})),t.toString=w,t}function C(t,n){if(void 0===n&&(n={nextPosition:null,curPosition:null}),t.isNative())return n.curPosition=null,t;var i=t.getFileName()||t.getScriptNameOrSourceURL();if(i){var s=t.getLineNumber(),r=t.getColumnNumber()-1,o=/^v(10\.1[6-9]|10\.[2-9][0-9]|10\.[0-9]{3,}|1[2-9]\d*|[2-9]\d|\d{3,}|11\.11)/.test(e.version)?0:62;1===s&&r>o&&!g()&&!t.isEval()&&(r-=o);var a=E({source:i,line:s,column:r});n.curPosition=a;var c=(t=b(t)).getFunctionName;return t.getFunctionName=function(){return null==n.nextPosition?c():n.nextPosition.name||c()},t.getFileName=function(){return a.source},t.getLineNumber=function(){return a.line},t.getColumnNumber=function(){return a.column+1},t.getScriptNameOrSourceURL=function(){return a.source},t}var l=t.isEval()&&t.getEvalOrigin();return l?(l=function e(t){var n=/^eval at ([^(]+) \((.+):(\d+):(\d+)\)$/.exec(t);if(n){var i=E({source:n[2],line:+n[3],column:n[4]-1});return"eval at "+n[1]+" ("+i.source+":"+i.line+":"+(i.column+1)+")"}return(n=/^eval at ([^(]+) \((.+)\)$/.exec(t))?"eval at "+n[1]+" ("+e(n[2])+")":t}(l),(t=b(t)).getEvalOrigin=function(){return l},t):t}function T(e,t){l&&(d={},h={});for(var n=(e.name||"Error")+": "+(e.message||""),i={nextPosition:null,curPosition:null},s=[],r=t.length-1;r>=0;r--)s.push("\n    at "+C(t[r],i)),i.nextPosition=i.curPosition;return i.curPosition=i.nextPosition=null,n+s.reverse().join("")}function M(e){var t=/\n    at [^(]+ \((.*):(\d+):(\d+)\)/.exec(e.stack);if(t){var n=t[1],s=+t[2],r=+t[3],o=d[n];if(!o&&i&&i.existsSync(n))try{o=i.readFileSync(n,"utf8")}catch(e){o=""}if(o){var a=o.split(/(?:\r\n|\r|\n)/)[s-1];if(a)return n+":"+s+"\n"+a+"\n"+new Array(r).join(" ")+"^"}}return null}function A(t){var n=M(t);e.stderr._handle&&e.stderr._handle.setBlocking&&e.stderr._handle.setBlocking(!0),n&&(console.error(),console.error(n)),console.error(t.stack),e.exit(1)}m.push((function(e){var t,n=function(e){var t;if(g())try{var n=new XMLHttpRequest;n.open("GET",e,!1),n.send(null),t=4===n.readyState?n.responseText:null;var i=n.getResponseHeader("SourceMap")||n.getResponseHeader("X-SourceMap");if(i)return i}catch(e){}t=v(e);for(var s,r,o=/(?:\/\/[@#][\s]*sourceMappingURL=([^\s'"]+)[\s]*$)|(?:\/\*[@#][\s]*sourceMappingURL=([^\s*'"]+)[\s]*(?:\*\/)[\s]*$)/gm;r=o.exec(t);)s=r;return s?s[1]:null}(e);if(!n)return null;if(f.test(n)){var i=n.slice(n.indexOf(",")+1);t=o(i,"base64").toString(),n=e}else n=S(e,n),t=v(n);return t?{url:n,map:t}:null}));var k=p.slice(0),R=m.slice(0);t.wrapCallSite=C,t.getErrorSource=M,t.mapSourcePosition=E,t.retrieveSourceMap=_,t.install=function(t){if((t=t||{}).environment&&(u=t.environment,-1===["node","browser","auto"].indexOf(u)))throw new Error("environment "+u+" was unknown. Available options are {auto, browser, node}");if(t.retrieveFile&&(t.overrideRetrieveFile&&(p.length=0),p.unshift(t.retrieveFile)),t.retrieveSourceMap&&(t.overrideRetrieveSourceMap&&(m.length=0),m.unshift(t.retrieveSourceMap)),t.hookRequire&&!g()){var i;try{i=n(74)}catch(e){}var s=i.prototype._compile;s.__sourceMapSupport||(i.prototype._compile=function(e,t){return d[t]=e,h[t]=void 0,s.call(this,e,t)},i.prototype._compile.__sourceMapSupport=!0)}var r;(l||(l="emptyCacheBetweenOperations"in t&&t.emptyCacheBetweenOperations),a||(a=!0,Error.prepareStackTrace=T),c)||(!("handleUncaughtExceptions"in t)||t.handleUncaughtExceptions)&&"object"==typeof e&&null!==e&&"function"==typeof e.on&&(c=!0,r=e.emit,e.emit=function(e){if("uncaughtException"===e){var t=arguments[1]&&arguments[1].stack,n=this.listeners(e).length>0;if(t&&!n)return A(arguments[1])}return r.apply(this,arguments)})},t.resetRetrieveHandlers=function(){p.length=0,m.length=0,p=k.slice(0),m=R.slice(0),_=y(m),v=y(p)}}).call(this,n(11))},function(e,t,n){t.SourceMapGenerator=n(322).SourceMapGenerator,t.SourceMapConsumer=n(718).SourceMapConsumer,t.SourceNode=n(721).SourceNode},function(e,t){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");t.encode=function(e){if(0<=e&&e<n.length)return n[e];throw new TypeError("Must be between 0 and 63: "+e)},t.decode=function(e){return 65<=e&&e<=90?e-65:97<=e&&e<=122?e-97+26:48<=e&&e<=57?e-48+52:43==e?62:47==e?63:-1}},function(e,t,n){var i=n(114);function s(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}s.prototype.unsortedForEach=function(e,t){this._array.forEach(e,t)},s.prototype.add=function(e){var t,n,s,r,o,a;t=this._last,n=e,s=t.generatedLine,r=n.generatedLine,o=t.generatedColumn,a=n.generatedColumn,r>s||r==s&&a>=o||i.compareByGeneratedPositionsInflated(t,n)<=0?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))},s.prototype.toArray=function(){return this._sorted||(this._array.sort(i.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},t.MappingList=s},function(e,t,n){var i=n(114),s=n(719),r=n(324).ArraySet,o=n(323),a=n(720).quickSort;function c(e,t){var n=e;return"string"==typeof e&&(n=i.parseSourceMapInput(e)),null!=n.sections?new d(n,t):new l(n,t)}function l(e,t){var n=e;"string"==typeof e&&(n=i.parseSourceMapInput(e));var s=i.getArg(n,"version"),o=i.getArg(n,"sources"),a=i.getArg(n,"names",[]),c=i.getArg(n,"sourceRoot",null),l=i.getArg(n,"sourcesContent",null),u=i.getArg(n,"mappings"),d=i.getArg(n,"file",null);if(s!=this._version)throw new Error("Unsupported version: "+s);c&&(c=i.normalize(c)),o=o.map(String).map(i.normalize).map((function(e){return c&&i.isAbsolute(c)&&i.isAbsolute(e)?i.relative(c,e):e})),this._names=r.fromArray(a.map(String),!0),this._sources=r.fromArray(o,!0),this._absoluteSources=this._sources.toArray().map((function(e){return i.computeSourceURL(c,e,t)})),this.sourceRoot=c,this.sourcesContent=l,this._mappings=u,this._sourceMapURL=t,this.file=d}function u(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}function d(e,t){var n=e;"string"==typeof e&&(n=i.parseSourceMapInput(e));var s=i.getArg(n,"version"),o=i.getArg(n,"sections");if(s!=this._version)throw new Error("Unsupported version: "+s);this._sources=new r,this._names=new r;var a={line:-1,column:0};this._sections=o.map((function(e){if(e.url)throw new Error("Support for url field in sections not implemented.");var n=i.getArg(e,"offset"),s=i.getArg(n,"line"),r=i.getArg(n,"column");if(s<a.line||s===a.line&&r<a.column)throw new Error("Section offsets must be ordered and non-overlapping.");return a=n,{generatedOffset:{generatedLine:s+1,generatedColumn:r+1},consumer:new c(i.getArg(e,"map"),t)}}))}c.fromSourceMap=function(e,t){return l.fromSourceMap(e,t)},c.prototype._version=3,c.prototype.__generatedMappings=null,Object.defineProperty(c.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),c.prototype.__originalMappings=null,Object.defineProperty(c.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),c.prototype._charIsMappingSeparator=function(e,t){var n=e.charAt(t);return";"===n||","===n},c.prototype._parseMappings=function(e,t){throw new Error("Subclasses must implement _parseMappings")},c.GENERATED_ORDER=1,c.ORIGINAL_ORDER=2,c.GREATEST_LOWER_BOUND=1,c.LEAST_UPPER_BOUND=2,c.prototype.eachMapping=function(e,t,n){var s,r=t||null;switch(n||c.GENERATED_ORDER){case c.GENERATED_ORDER:s=this._generatedMappings;break;case c.ORIGINAL_ORDER:s=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var o=this.sourceRoot;s.map((function(e){var t=null===e.source?null:this._sources.at(e.source);return{source:t=i.computeSourceURL(o,t,this._sourceMapURL),generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:null===e.name?null:this._names.at(e.name)}}),this).forEach(e,r)},c.prototype.allGeneratedPositionsFor=function(e){var t=i.getArg(e,"line"),n={source:i.getArg(e,"source"),originalLine:t,originalColumn:i.getArg(e,"column",0)};if(n.source=this._findSourceIndex(n.source),n.source<0)return[];var r=[],o=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",i.compareByOriginalPositions,s.LEAST_UPPER_BOUND);if(o>=0){var a=this._originalMappings[o];if(void 0===e.column)for(var c=a.originalLine;a&&a.originalLine===c;)r.push({line:i.getArg(a,"generatedLine",null),column:i.getArg(a,"generatedColumn",null),lastColumn:i.getArg(a,"lastGeneratedColumn",null)}),a=this._originalMappings[++o];else for(var l=a.originalColumn;a&&a.originalLine===t&&a.originalColumn==l;)r.push({line:i.getArg(a,"generatedLine",null),column:i.getArg(a,"generatedColumn",null),lastColumn:i.getArg(a,"lastGeneratedColumn",null)}),a=this._originalMappings[++o]}return r},t.SourceMapConsumer=c,l.prototype=Object.create(c.prototype),l.prototype.consumer=c,l.prototype._findSourceIndex=function(e){var t,n=e;if(null!=this.sourceRoot&&(n=i.relative(this.sourceRoot,n)),this._sources.has(n))return this._sources.indexOf(n);for(t=0;t<this._absoluteSources.length;++t)if(this._absoluteSources[t]==e)return t;return-1},l.fromSourceMap=function(e,t){var n=Object.create(l.prototype),s=n._names=r.fromArray(e._names.toArray(),!0),o=n._sources=r.fromArray(e._sources.toArray(),!0);n.sourceRoot=e._sourceRoot,n.sourcesContent=e._generateSourcesContent(n._sources.toArray(),n.sourceRoot),n.file=e._file,n._sourceMapURL=t,n._absoluteSources=n._sources.toArray().map((function(e){return i.computeSourceURL(n.sourceRoot,e,t)}));for(var c=e._mappings.toArray().slice(),d=n.__generatedMappings=[],h=n.__originalMappings=[],f=0,p=c.length;f<p;f++){var m=c[f],g=new u;g.generatedLine=m.generatedLine,g.generatedColumn=m.generatedColumn,m.source&&(g.source=o.indexOf(m.source),g.originalLine=m.originalLine,g.originalColumn=m.originalColumn,m.name&&(g.name=s.indexOf(m.name)),h.push(g)),d.push(g)}return a(n.__originalMappings,i.compareByOriginalPositions),n},l.prototype._version=3,Object.defineProperty(l.prototype,"sources",{get:function(){return this._absoluteSources.slice()}}),l.prototype._parseMappings=function(e,t){for(var n,s,r,c,l,d=1,h=0,f=0,p=0,m=0,g=0,y=e.length,v=0,S={},_={},E=[],w=[];v<y;)if(";"===e.charAt(v))d++,v++,h=0;else if(","===e.charAt(v))v++;else{for((n=new u).generatedLine=d,c=v;c<y&&!this._charIsMappingSeparator(e,c);c++);if(r=S[s=e.slice(v,c)])v+=s.length;else{for(r=[];v<c;)o.decode(e,v,_),l=_.value,v=_.rest,r.push(l);if(2===r.length)throw new Error("Found a source, but no line and column");if(3===r.length)throw new Error("Found a source and line, but no column");S[s]=r}n.generatedColumn=h+r[0],h=n.generatedColumn,r.length>1&&(n.source=m+r[1],m+=r[1],n.originalLine=f+r[2],f=n.originalLine,n.originalLine+=1,n.originalColumn=p+r[3],p=n.originalColumn,r.length>4&&(n.name=g+r[4],g+=r[4])),w.push(n),"number"==typeof n.originalLine&&E.push(n)}a(w,i.compareByGeneratedPositionsDeflated),this.__generatedMappings=w,a(E,i.compareByOriginalPositions),this.__originalMappings=E},l.prototype._findMapping=function(e,t,n,i,r,o){if(e[n]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[n]);if(e[i]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[i]);return s.search(e,t,r,o)},l.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var n=this._generatedMappings[e+1];if(t.generatedLine===n.generatedLine){t.lastGeneratedColumn=n.generatedColumn-1;continue}}t.lastGeneratedColumn=1/0}},l.prototype.originalPositionFor=function(e){var t={generatedLine:i.getArg(e,"line"),generatedColumn:i.getArg(e,"column")},n=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",i.compareByGeneratedPositionsDeflated,i.getArg(e,"bias",c.GREATEST_LOWER_BOUND));if(n>=0){var s=this._generatedMappings[n];if(s.generatedLine===t.generatedLine){var r=i.getArg(s,"source",null);null!==r&&(r=this._sources.at(r),r=i.computeSourceURL(this.sourceRoot,r,this._sourceMapURL));var o=i.getArg(s,"name",null);return null!==o&&(o=this._names.at(o)),{source:r,line:i.getArg(s,"originalLine",null),column:i.getArg(s,"originalColumn",null),name:o}}}return{source:null,line:null,column:null,name:null}},l.prototype.hasContentsOfAllSources=function(){return!!this.sourcesContent&&(this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some((function(e){return null==e})))},l.prototype.sourceContentFor=function(e,t){if(!this.sourcesContent)return null;var n=this._findSourceIndex(e);if(n>=0)return this.sourcesContent[n];var s,r=e;if(null!=this.sourceRoot&&(r=i.relative(this.sourceRoot,r)),null!=this.sourceRoot&&(s=i.urlParse(this.sourceRoot))){var o=r.replace(/^file:\/\//,"");if("file"==s.scheme&&this._sources.has(o))return this.sourcesContent[this._sources.indexOf(o)];if((!s.path||"/"==s.path)&&this._sources.has("/"+r))return this.sourcesContent[this._sources.indexOf("/"+r)]}if(t)return null;throw new Error('"'+r+'" is not in the SourceMap.')},l.prototype.generatedPositionFor=function(e){var t=i.getArg(e,"source");if((t=this._findSourceIndex(t))<0)return{line:null,column:null,lastColumn:null};var n={source:t,originalLine:i.getArg(e,"line"),originalColumn:i.getArg(e,"column")},s=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",i.compareByOriginalPositions,i.getArg(e,"bias",c.GREATEST_LOWER_BOUND));if(s>=0){var r=this._originalMappings[s];if(r.source===n.source)return{line:i.getArg(r,"generatedLine",null),column:i.getArg(r,"generatedColumn",null),lastColumn:i.getArg(r,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},t.BasicSourceMapConsumer=l,d.prototype=Object.create(c.prototype),d.prototype.constructor=c,d.prototype._version=3,Object.defineProperty(d.prototype,"sources",{get:function(){for(var e=[],t=0;t<this._sections.length;t++)for(var n=0;n<this._sections[t].consumer.sources.length;n++)e.push(this._sections[t].consumer.sources[n]);return e}}),d.prototype.originalPositionFor=function(e){var t={generatedLine:i.getArg(e,"line"),generatedColumn:i.getArg(e,"column")},n=s.search(t,this._sections,(function(e,t){var n=e.generatedLine-t.generatedOffset.generatedLine;return n||e.generatedColumn-t.generatedOffset.generatedColumn})),r=this._sections[n];return r?r.consumer.originalPositionFor({line:t.generatedLine-(r.generatedOffset.generatedLine-1),column:t.generatedColumn-(r.generatedOffset.generatedLine===t.generatedLine?r.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}},d.prototype.hasContentsOfAllSources=function(){return this._sections.every((function(e){return e.consumer.hasContentsOfAllSources()}))},d.prototype.sourceContentFor=function(e,t){for(var n=0;n<this._sections.length;n++){var i=this._sections[n].consumer.sourceContentFor(e,!0);if(i)return i}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')},d.prototype.generatedPositionFor=function(e){for(var t=0;t<this._sections.length;t++){var n=this._sections[t];if(-1!==n.consumer._findSourceIndex(i.getArg(e,"source"))){var s=n.consumer.generatedPositionFor(e);if(s)return{line:s.line+(n.generatedOffset.generatedLine-1),column:s.column+(n.generatedOffset.generatedLine===s.line?n.generatedOffset.generatedColumn-1:0)}}}return{line:null,column:null}},d.prototype._parseMappings=function(e,t){this.__generatedMappings=[],this.__originalMappings=[];for(var n=0;n<this._sections.length;n++)for(var s=this._sections[n],r=s.consumer._generatedMappings,o=0;o<r.length;o++){var c=r[o],l=s.consumer._sources.at(c.source);l=i.computeSourceURL(s.consumer.sourceRoot,l,this._sourceMapURL),this._sources.add(l),l=this._sources.indexOf(l);var u=null;c.name&&(u=s.consumer._names.at(c.name),this._names.add(u),u=this._names.indexOf(u));var d={source:l,generatedLine:c.generatedLine+(s.generatedOffset.generatedLine-1),generatedColumn:c.generatedColumn+(s.generatedOffset.generatedLine===c.generatedLine?s.generatedOffset.generatedColumn-1:0),originalLine:c.originalLine,originalColumn:c.originalColumn,name:u};this.__generatedMappings.push(d),"number"==typeof d.originalLine&&this.__originalMappings.push(d)}a(this.__generatedMappings,i.compareByGeneratedPositionsDeflated),a(this.__originalMappings,i.compareByOriginalPositions)},t.IndexedSourceMapConsumer=d},function(e,t){t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2,t.search=function(e,n,i,s){if(0===n.length)return-1;var r=function e(n,i,s,r,o,a){var c=Math.floor((i-n)/2)+n,l=o(s,r[c],!0);return 0===l?c:l>0?i-c>1?e(c,i,s,r,o,a):a==t.LEAST_UPPER_BOUND?i<r.length?i:-1:c:c-n>1?e(n,c,s,r,o,a):a==t.LEAST_UPPER_BOUND?c:n<0?-1:n}(-1,n.length,e,n,i,s||t.GREATEST_LOWER_BOUND);if(r<0)return-1;for(;r-1>=0&&0===i(n[r],n[r-1],!0);)--r;return r}},function(e,t){function n(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function i(e,t,s,r){if(s<r){var o=s-1;n(e,(u=s,d=r,Math.round(u+Math.random()*(d-u))),r);for(var a=e[r],c=s;c<r;c++)t(e[c],a)<=0&&n(e,o+=1,c);n(e,o+1,c);var l=o+1;i(e,t,s,l-1),i(e,t,l+1,r)}var u,d}t.quickSort=function(e,t){i(e,t,0,e.length-1)}},function(e,t,n){var i=n(322).SourceMapGenerator,s=n(114),r=/(\r?\n)/,o="$$$isSourceNode$$$";function a(e,t,n,i,s){this.children=[],this.sourceContents={},this.line=null==e?null:e,this.column=null==t?null:t,this.source=null==n?null:n,this.name=null==s?null:s,this[o]=!0,null!=i&&this.add(i)}a.fromStringWithSourceMap=function(e,t,n){var i=new a,o=e.split(r),c=0,l=function(){return e()+(e()||"");function e(){return c<o.length?o[c++]:void 0}},u=1,d=0,h=null;return t.eachMapping((function(e){if(null!==h){if(!(u<e.generatedLine)){var t=(n=o[c]||"").substr(0,e.generatedColumn-d);return o[c]=n.substr(e.generatedColumn-d),d=e.generatedColumn,f(h,t),void(h=e)}f(h,l()),u++,d=0}for(;u<e.generatedLine;)i.add(l()),u++;if(d<e.generatedColumn){var n=o[c]||"";i.add(n.substr(0,e.generatedColumn)),o[c]=n.substr(e.generatedColumn),d=e.generatedColumn}h=e}),this),c<o.length&&(h&&f(h,l()),i.add(o.splice(c).join(""))),t.sources.forEach((function(e){var r=t.sourceContentFor(e);null!=r&&(null!=n&&(e=s.join(n,e)),i.setSourceContent(e,r))})),i;function f(e,t){if(null===e||void 0===e.source)i.add(t);else{var r=n?s.join(n,e.source):e.source;i.add(new a(e.originalLine,e.originalColumn,r,t,e.name))}}},a.prototype.add=function(e){if(Array.isArray(e))e.forEach((function(e){this.add(e)}),this);else{if(!e[o]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);e&&this.children.push(e)}return this},a.prototype.prepend=function(e){if(Array.isArray(e))for(var t=e.length-1;t>=0;t--)this.prepend(e[t]);else{if(!e[o]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);this.children.unshift(e)}return this},a.prototype.walk=function(e){for(var t,n=0,i=this.children.length;n<i;n++)(t=this.children[n])[o]?t.walk(e):""!==t&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})},a.prototype.join=function(e){var t,n,i=this.children.length;if(i>0){for(t=[],n=0;n<i-1;n++)t.push(this.children[n]),t.push(e);t.push(this.children[n]),this.children=t}return this},a.prototype.replaceRight=function(e,t){var n=this.children[this.children.length-1];return n[o]?n.replaceRight(e,t):"string"==typeof n?this.children[this.children.length-1]=n.replace(e,t):this.children.push("".replace(e,t)),this},a.prototype.setSourceContent=function(e,t){this.sourceContents[s.toSetString(e)]=t},a.prototype.walkSourceContents=function(e){for(var t=0,n=this.children.length;t<n;t++)this.children[t][o]&&this.children[t].walkSourceContents(e);var i=Object.keys(this.sourceContents);for(t=0,n=i.length;t<n;t++)e(s.fromSetString(i[t]),this.sourceContents[i[t]])},a.prototype.toString=function(){var e="";return this.walk((function(t){e+=t})),e},a.prototype.toStringWithSourceMap=function(e){var t={code:"",line:1,column:0},n=new i(e),s=!1,r=null,o=null,a=null,c=null;return this.walk((function(e,i){t.code+=e,null!==i.source&&null!==i.line&&null!==i.column?(r===i.source&&o===i.line&&a===i.column&&c===i.name||n.addMapping({source:i.source,original:{line:i.line,column:i.column},generated:{line:t.line,column:t.column},name:i.name}),r=i.source,o=i.line,a=i.column,c=i.name,s=!0):s&&(n.addMapping({generated:{line:t.line,column:t.column}}),r=null,s=!1);for(var l=0,u=e.length;l<u;l++)10===e.charCodeAt(l)?(t.line++,t.column=0,l+1===u?(r=null,s=!1):s&&n.addMapping({source:i.source,original:{line:i.line,column:i.column},generated:{line:t.line,column:t.column},name:i.name})):t.column++})),this.walkSourceContents((function(e,t){n.setSourceContent(e,t)})),{code:t.code,map:n}},t.SourceNode=a},function(e,t,n){(function(t){var n=Object.prototype.toString,i="function"==typeof t.alloc&&"function"==typeof t.allocUnsafe&&"function"==typeof t.from;e.exports=function(e,s,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return o=e,"ArrayBuffer"===n.call(o).slice(8,-1)?function(e,n,s){n>>>=0;var r=e.byteLength-n;if(r<0)throw new RangeError("'offset' is out of bounds");if(void 0===s)s=r;else if((s>>>=0)>r)throw new RangeError("'length' is out of bounds");return i?t.from(e.slice(n,n+s)):new t(new Uint8Array(e.slice(n,n+s)))}(e,s,r):"string"==typeof e?function(e,n){if("string"==typeof n&&""!==n||(n="utf8"),!t.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');return i?t.from(e,n):new t(e,n)}(e,s):i?t.from(e):new t(e);var o}}).call(this,n(3).Buffer)},function(e,t,n){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){var t,n,i=l(e),o=i[0],a=i[1],c=new r(function(e,t,n){return 3*(t+n)/4-n}(0,o,a)),u=0,d=a>0?o-4:o;for(n=0;n<d;n+=4)t=s[e.charCodeAt(n)]<<18|s[e.charCodeAt(n+1)]<<12|s[e.charCodeAt(n+2)]<<6|s[e.charCodeAt(n+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;2===a&&(t=s[e.charCodeAt(n)]<<2|s[e.charCodeAt(n+1)]>>4,c[u++]=255&t);1===a&&(t=s[e.charCodeAt(n)]<<10|s[e.charCodeAt(n+1)]<<4|s[e.charCodeAt(n+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,s=n%3,r=[],o=0,a=n-s;o<a;o+=16383)r.push(u(e,o,o+16383>a?a:o+16383));1===s?(t=e[n-1],r.push(i[t>>2]+i[t<<4&63]+"==")):2===s&&(t=(e[n-2]<<8)+e[n-1],r.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return r.join("")};for(var i=[],s=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=o.length;a<c;++a)i[a]=o[a],s[o.charCodeAt(a)]=a;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,n){for(var s,r,o=[],a=t;a<n;a+=3)s=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(i[(r=s)>>18&63]+i[r>>12&63]+i[r>>6&63]+i[63&r]);return o.join("")}s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(113),s=n(151);class r extends s.TraceListener{constructor(e,t){super(),this.includeTimestamp=t,this.channel=null,this.channelName=e}writeTo(e){null!=this.channel&&this.channel.appendLine(e)}writeEvent(e,t,n,s,...r){const o=i.TraceFormat.formatEvent(this.includeTimestamp?new Date:null,e,t,n,s,...r);this.writeTo(o)}addOutputChannel(e){if(null!=this.channel)return;const t=n(0);this.channel=t.window.createOutputChannel(this.channelName),e&&this.channel.show(!0)}removeOutputChannel(){null!=this.channel&&(this.channel.clear(),this.channel.dispose(),this.channel=null)}}t.OutputTraceListener=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(113),s=n(151);class r extends s.TraceListener{constructor(e){super(),this.allLogs=[],this.logsByLevel=new Map,this.maxLogSize=e||128}getLogs(e){if(e){const t=this.logsByLevel.get(e);return t?t.map(e=>e):[]}return this.allLogs.map(e=>e)}writeTo(e){this.addLine(e)}addLine(e,t){if(this.allLogs.push(e),this.allLogs.length>this.maxLogSize&&this.allLogs.splice(0,1),t){const n=this.logsByLevel.get(t);n?(n.push(e),n.length>this.maxLogSize&&n.splice(0,1)):this.logsByLevel.set(t,[e])}}writeEvent(e,t,n,s,...r){const o=i.TraceFormat.formatEvent(new Date,e,t,n,s,...r);this.addLine(o,t)}}t.MemoryTraceListener=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(727);t.ConsoleLoggerMock=i.ConsoleLoggerMock},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={info:()=>{},log:()=>{},debug:()=>{},warn:()=>{},error:()=>{}};t.ConsoleLoggerMock=class{constructor(e={}){this.log=(...e)=>{throw new Error("The `log` method is not implemented")},this.info=(...e)=>{throw new Error("The `info` method is not implemented")},this.debug=(...e)=>{throw new Error("The `debug` method is not implemented")},this.warn=(...e)=>{throw new Error("The `warn` method is not implemented")},this.error=(...e)=>{throw new Error("The `error` method is not implemented")},this.optionsWithDefaults=Object.assign(Object.assign({},i),e),this.log=this.optionsWithDefaults.log,this.info=this.optionsWithDefaults.info,this.warn=this.optionsWithDefaults.warn,this.debug=this.optionsWithDefaults.debug,this.error=this.optionsWithDefaults.error}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(729),s=n(194);if(t.GlobPatternTraceFilter=class{constructor(e){this.globToVerbosity=e,this.traceSourceVerbosityCache=new Map}getTraceVerbosity(e){let t=this.traceSourceVerbosityCache.get(e);if(void 0===t){if(t=0,this.globToVerbosity)for(let n in this.globToVerbosity)i(e,n)&&(t=s.LogLevel[this.globToVerbosity[n]]);this.traceSourceVerbosityCache.set(e,t)}return t}shouldTrace(e,t,n){return this.getTraceVerbosity(e)<=t}},"function"==typeof Error.prepareStackTrace){const e=Error.prepareStackTrace;Error.prepareStackTrace=function(t,n){return t.vslsStack=n,e(t,n)}}},function(e,t,n){e.exports=u,u.Minimatch=d;var i={sep:"/"};try{i=n(18)}catch(e){}var s=u.GLOBSTAR=d.GLOBSTAR={},r=n(730),o={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},a="().*{}+?[]^$\\!".split("").reduce((function(e,t){return e[t]=!0,e}),{});var c=/\/+/;function l(e,t){e=e||{},t=t||{};var n={};return Object.keys(t).forEach((function(e){n[e]=t[e]})),Object.keys(e).forEach((function(t){n[t]=e[t]})),n}function u(e,t,n){if("string"!=typeof t)throw new TypeError("glob pattern string required");return n||(n={}),!(!n.nocomment&&"#"===t.charAt(0))&&(""===t.trim()?""===e:new d(t,n).match(e))}function d(e,t){if(!(this instanceof d))return new d(e,t);if("string"!=typeof e)throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),"/"!==i.sep&&(e=e.split(i.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function h(e,t){if(t||(t=this instanceof d?this.options:{}),void 0===(e=void 0===e?this.pattern:e))throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:r(e)}u.filter=function(e,t){return t=t||{},function(n,i,s){return u(n,e,t)}},u.defaults=function(e){if(!e||!Object.keys(e).length)return u;var t=u,n=function(n,i,s){return t.minimatch(n,i,l(e,s))};return n.Minimatch=function(n,i){return new t.Minimatch(n,l(e,i))},n},d.defaults=function(e){return e&&Object.keys(e).length?u.defaults(e).Minimatch:d},d.prototype.debug=function(){},d.prototype.make=function(){if(this._made)return;var e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();var n=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error);this.debug(this.pattern,n),n=this.globParts=n.map((function(e){return e.split(c)})),this.debug(this.pattern,n),n=n.map((function(e,t,n){return e.map(this.parse,this)}),this),this.debug(this.pattern,n),n=n.filter((function(e){return-1===e.indexOf(!1)})),this.debug(this.pattern,n),this.set=n},d.prototype.parseNegate=function(){var e=this.pattern,t=!1,n=this.options,i=0;if(n.nonegate)return;for(var s=0,r=e.length;s<r&&"!"===e.charAt(s);s++)t=!t,i++;i&&(this.pattern=e.substr(i));this.negate=t},u.braceExpand=function(e,t){return h(e,t)},d.prototype.braceExpand=h,d.prototype.parse=function(e,t){if(e.length>65536)throw new TypeError("pattern is too long");var n=this.options;if(!n.noglobstar&&"**"===e)return s;if(""===e)return"";var i,r="",c=!!n.nocase,l=!1,u=[],d=[],h=!1,p=-1,m=-1,g="."===e.charAt(0)?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",y=this;function v(){if(i){switch(i){case"*":r+="[^/]*?",c=!0;break;case"?":r+="[^/]",c=!0;break;default:r+="\\"+i}y.debug("clearStateChar %j %j",i,r),i=!1}}for(var S,_=0,E=e.length;_<E&&(S=e.charAt(_));_++)if(this.debug("%s\t%s %s %j",e,_,r,S),l&&a[S])r+="\\"+S,l=!1;else switch(S){case"/":return!1;case"\\":v(),l=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,_,r,S),h){this.debug("  in class"),"!"===S&&_===m+1&&(S="^"),r+=S;continue}y.debug("call clearStateChar %j",i),v(),i=S,n.noext&&v();continue;case"(":if(h){r+="(";continue}if(!i){r+="\\(";continue}u.push({type:i,start:_-1,reStart:r.length,open:o[i].open,close:o[i].close}),r+="!"===i?"(?:(?!(?:":"(?:",this.debug("plType %j %j",i,r),i=!1;continue;case")":if(h||!u.length){r+="\\)";continue}v(),c=!0;var w=u.pop();r+=w.close,"!"===w.type&&d.push(w),w.reEnd=r.length;continue;case"|":if(h||!u.length||l){r+="\\|",l=!1;continue}v(),r+="|";continue;case"[":if(v(),h){r+="\\"+S;continue}h=!0,m=_,p=r.length,r+=S;continue;case"]":if(_===m+1||!h){r+="\\"+S,l=!1;continue}if(h){var b=e.substring(m+1,_);try{RegExp("["+b+"]")}catch(e){var C=this.parse(b,f);r=r.substr(0,p)+"\\["+C[0]+"\\]",c=c||C[1],h=!1;continue}}c=!0,h=!1,r+=S;continue;default:v(),l?l=!1:!a[S]||"^"===S&&h||(r+="\\"),r+=S}h&&(b=e.substr(m+1),C=this.parse(b,f),r=r.substr(0,p)+"\\["+C[0],c=c||C[1]);for(w=u.pop();w;w=u.pop()){var T=r.slice(w.reStart+w.open.length);this.debug("setting tail",r,w),T=T.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(e,t,n){return n||(n="\\"),t+t+n+"|"})),this.debug("tail=%j\n   %s",T,T,w,r);var M="*"===w.type?"[^/]*?":"?"===w.type?"[^/]":"\\"+w.type;c=!0,r=r.slice(0,w.reStart)+M+"\\("+T}v(),l&&(r+="\\\\");var A=!1;switch(r.charAt(0)){case".":case"[":case"(":A=!0}for(var k=d.length-1;k>-1;k--){var R=d[k],P=r.slice(0,R.reStart),I=r.slice(R.reStart,R.reEnd-8),N=r.slice(R.reEnd-8,R.reEnd),L=r.slice(R.reEnd);N+=L;var D=P.split("(").length-1,x=L;for(_=0;_<D;_++)x=x.replace(/\)[+*?]?/,"");var O="";""===(L=x)&&t!==f&&(O="$"),r=P+I+L+O+N}""!==r&&c&&(r="(?=.)"+r);A&&(r=g+r);if(t===f)return[r,c];if(!c)return function(e){return e.replace(/\\(.)/g,"$1")}(e);var F=n.nocase?"i":"";try{var U=new RegExp("^"+r+"$",F)}catch(e){return new RegExp("$.")}return U._glob=e,U._src=r,U};var f={};u.makeRe=function(e,t){return new d(e,t||{}).makeRe()},d.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,n=t.noglobstar?"[^/]*?":t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",i=t.nocase?"i":"",r=e.map((function(e){return e.map((function(e){return e===s?n:"string"==typeof e?function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(e):e._src})).join("\\/")})).join("|");r="^(?:"+r+")$",this.negate&&(r="^(?!"+r+").*$");try{this.regexp=new RegExp(r,i)}catch(e){this.regexp=!1}return this.regexp},u.match=function(e,t,n){var i=new d(t,n=n||{});return e=e.filter((function(e){return i.match(e)})),i.options.nonull&&!e.length&&e.push(t),e},d.prototype.match=function(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var n=this.options;"/"!==i.sep&&(e=e.split(i.sep).join("/"));e=e.split(c),this.debug(this.pattern,"split",e);var s,r,o=this.set;for(this.debug(this.pattern,"set",o),r=e.length-1;r>=0&&!(s=e[r]);r--);for(r=0;r<o.length;r++){var a=o[r],l=e;if(n.matchBase&&1===a.length&&(l=[s]),this.matchOne(l,a,t))return!!n.flipNegate||!this.negate}return!n.flipNegate&&this.negate},d.prototype.matchOne=function(e,t,n){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var r=0,o=0,a=e.length,c=t.length;r<a&&o<c;r++,o++){this.debug("matchOne loop");var l,u=t[o],d=e[r];if(this.debug(t,u,d),!1===u)return!1;if(u===s){this.debug("GLOBSTAR",[t,u,d]);var h=r,f=o+1;if(f===c){for(this.debug("** at the end");r<a;r++)if("."===e[r]||".."===e[r]||!i.dot&&"."===e[r].charAt(0))return!1;return!0}for(;h<a;){var p=e[h];if(this.debug("\nglobstar while",e,h,t,f,p),this.matchOne(e.slice(h),t.slice(f),n))return this.debug("globstar found match!",h,a,p),!0;if("."===p||".."===p||!i.dot&&"."===p.charAt(0)){this.debug("dot detected!",e,h,t,f);break}this.debug("globstar swallow a segment, and continue"),h++}return!(!n||(this.debug("\n>>> no match, partial?",e,h,t,f),h!==a))}if("string"==typeof u?(l=i.nocase?d.toLowerCase()===u.toLowerCase():d===u,this.debug("string match",u,d,l)):(l=d.match(u),this.debug("pattern match",u,d,l)),!l)return!1}if(r===a&&o===c)return!0;if(r===a)return n;if(o===c)return r===a-1&&""===e[r];throw new Error("wtf?")}},function(e,t,n){var i=n(731),s=n(732);e.exports=function(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return function e(t,n){var r=[],o=s("{","}",t);if(!o||/\$$/.test(o.pre))return[t];var c,l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(o.body),d=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(o.body),g=l||d,y=o.body.indexOf(",")>=0;if(!g&&!y)return o.post.match(/,.*\}/)?(t=o.pre+"{"+o.body+a+o.post,e(t)):[t];if(g)c=o.body.split(/\.\./);else{if(1===(c=function e(t){if(!t)return[""];var n=[],i=s("{","}",t);if(!i)return t.split(",");var r=i.pre,o=i.body,a=i.post,c=r.split(",");c[c.length-1]+="{"+o+"}";var l=e(a);a.length&&(c[c.length-1]+=l.shift(),c.push.apply(c,l));return n.push.apply(n,c),n}(o.body)).length)if(1===(c=e(c[0],!1).map(h)).length)return(_=o.post.length?e(o.post,!1):[""]).map((function(e){return o.pre+c[0]+e}))}var v,S=o.pre,_=o.post.length?e(o.post,!1):[""];if(g){var E=u(c[0]),w=u(c[1]),b=Math.max(c[0].length,c[1].length),C=3==c.length?Math.abs(u(c[2])):1,T=p;w<E&&(C*=-1,T=m);var M=c.some(f);v=[];for(var A=E;T(A,w);A+=C){var k;if(d)"\\"===(k=String.fromCharCode(A))&&(k="");else if(k=String(A),M){var R=b-k.length;if(R>0){var P=new Array(R+1).join("0");k=A<0?"-"+P+k.slice(1):P+k}}v.push(k)}}else v=i(c,(function(t){return e(t,!1)}));for(var I=0;I<v.length;I++)for(var N=0;N<_.length;N++){var L=S+v[I]+_[N];(!n||g||L)&&r.push(L)}return r}(function(e){return e.split("\\\\").join(r).split("\\{").join(o).split("\\}").join(a).split("\\,").join(c).split("\\.").join(l)}(e),!0).map(d)};var r="\0SLASH"+Math.random()+"\0",o="\0OPEN"+Math.random()+"\0",a="\0CLOSE"+Math.random()+"\0",c="\0COMMA"+Math.random()+"\0",l="\0PERIOD"+Math.random()+"\0";function u(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function d(e){return e.split(r).join("\\").split(o).join("{").split(a).join("}").split(c).join(",").split(l).join(".")}function h(e){return"{"+e+"}"}function f(e){return/^-?0\d/.test(e)}function p(e,t){return e<=t}function m(e,t){return e>=t}},function(e,t){e.exports=function(e,t){for(var i=[],s=0;s<e.length;s++){var r=t(e[s],s);n(r)?i.push.apply(i,r):i.push(r)}return i};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";function i(e,t,n){e instanceof RegExp&&(e=s(e,n)),t instanceof RegExp&&(t=s(t,n));var i=r(e,t,n);return i&&{start:i[0],end:i[1],pre:n.slice(0,i[0]),body:n.slice(i[0]+e.length,i[1]),post:n.slice(i[1]+t.length)}}function s(e,t){var n=t.match(e);return n?n[0]:null}function r(e,t,n){var i,s,r,o,a,c=n.indexOf(e),l=n.indexOf(t,c+1),u=c;if(c>=0&&l>0){for(i=[],r=n.length;u>=0&&!a;)u==c?(i.push(u),c=n.indexOf(e,u+1)):1==i.length?a=[i.pop(),l]:((s=i.pop())<r&&(r=s,o=l),l=n.indexOf(t,u+1)),u=c<l&&c>=0?c:l;i.length&&(a=[r,o])}return a}e.exports=i,i.range=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VerbosityTraceFilter=class{constructor(e){this.verbosity=e}shouldTrace(e,t,n){return void 0===this.verbosity||this.verbosity<=t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(24),s=n(194);class r extends i.EventEmitter{constructor(e){super(),this.name=e}withName(e){const t=new r(e);return this.eventNames().forEach(e=>{this.listeners(e).forEach(n=>{t.on(e,n)})}),t}createChild(e){return this.withName(`${this.name}:${e}`)}addTraceListener(e){this.on(r.eventEventName,e.traceEvent.bind(e)),this.on(r.lineEventName,e.writeLine.bind(e)),e.flushEvents&&this.on(r.flushEventName,e.flushEvents.bind(e))}async flushEvents(){await Promise.all(this.listeners(r.flushEventName).map(e=>Promise.resolve(e())))}writeLine(e){this.emit(r.lineEventName,this.name,e)}log(e,t,...n){return this.traceEvent(e,0,t,...n),this}traceEvent(e,t,n,...i){this.emit(r.eventEventName,this.name,e,t,n,...i)}errorEvent(e,t,...n){this.traceEvent(s.LogLevel.Error,e,t,...n)}warningEvent(e,t,...n){this.traceEvent(s.LogLevel.Warning,e,t,...n)}infoEvent(e,t,...n){this.traceEvent(s.LogLevel.Info,e,t,...n)}error(e,...t){return this.traceEvent(s.LogLevel.Error,0,e,...t),this}warning(e,...t){return this.traceEvent(s.LogLevel.Warning,0,e,...t),this}info(e,...t){return this.traceEvent(s.LogLevel.Info,0,e,...t),this}verbose(e,...t){return this.traceEvent(s.LogLevel.Debug,0,e,...t),this}}t.TraceSource=r,r.lineEventName="line",r.eventEventName="event",r.flushEventName="flush"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TraceFilters=class{constructor(e=[]){this.filters=e}shouldTrace(e,t,n){return this.filters.every(i=>i.shouldTrace(e,t,n))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(112);class s{constructor(e){this.name=e}error(e,...t){return this.log(i.LogLevel.Error,e,...t),this}warning(e,...t){return this.log(i.LogLevel.Warning,e,...t),this}info(e,...t){return this.log(i.LogLevel.Info,e,...t),this}verbose(e,...t){return this.log(i.LogLevel.Debug,e,...t),this}createChild(e){return this.withName(this.name+":"+e)}}t.LoggerBase=s;class r extends s{constructor(e,t){super(e),this.logCallback=t}log(e,t,...n){return this.logCallback(e,t,...n),this}withName(e){return new r(e,this.logCallback)}}t.Logger=r},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var i,s,r,o,a,c=1,l={},u=!1,d=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){p(e.data)},i=function(e){r.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(s=d.documentElement,i=function(e){var t=d.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,s.removeChild(t),t=null},s.appendChild(t)}):i=function(e){setTimeout(p,0,e)}:(o="setImmediate$"+Math.random()+"$",a=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&p(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",a,!1):e.attachEvent("onmessage",a),i=function(t){e.postMessage(o+t,"*")}),h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var s={callback:e,args:t};return l[c]=s,i(c),c++},h.clearImmediate=f}function f(e){delete l[e]}function p(e){if(u)setTimeout(p,0,e);else{var t=l[e];if(t){u=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{f(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(27),n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(152),s=n(116);var r;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:i.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:i.Event.None}),e.is=function(t){let n=t;return n&&(n===e.None||n===e.Cancelled||s.boolean(n.isCancellationRequested)&&!!n.onCancellationRequested)}}(r=t.CancellationToken||(t.CancellationToken={}));const o=Object.freeze((function(e,t){let n=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(n)}}}));class a{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this._emitter=void 0))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?o:(this._emitter||(this._emitter=new i.Emitter),this._emitter.event)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new a),this._token}cancel(){this._token?this._token.cancel():this._token=r.Cancelled}dispose(){this.cancel()}}},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.None=0,e.First=1,e.Last=2}(i=t.Touch||(t.Touch={}));t.LinkedMap=class{constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}has(e){return this._map.has(e)}get(e){const t=this._map.get(e);if(t)return t.value}set(e,t,n=i.None){let s=this._map.get(e);if(s)s.value=t,n!==i.None&&this.touch(s,n);else{switch(s={key:e,value:t,next:void 0,previous:void 0},n){case i.None:this.addItemLast(s);break;case i.First:this.addItemFirst(s);break;case i.Last:default:this.addItemLast(s)}this._map.set(e,s),this._size++}}delete(e){const t=this._map.get(e);return!!t&&(this._map.delete(e),this.removeItem(t),this._size--,!0)}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._head;for(;n;)t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),n=n.next}forEachReverse(e,t){let n=this._tail;for(;n;)t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),n=n.previous}values(){let e=[],t=this._head;for(;t;)e.push(t.value),t=t.next;return e}keys(){let e=[],t=this._head;for(;t;)e.push(t.key),t=t.next;return e}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head)this._head=e.next;else if(e===this._tail)this._tail=e.previous;else{const t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===i.First||t===i.Last)if(t===i.First){if(e===this._head)return;const t=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(t.previous=n,n.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e}else if(t===i.Last){if(e===this._tail)return;const t=e.next,n=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=n,n.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e}}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(18),s=n(117),r=n(28),o=n(66),a=n(197),c=n(198);t.generateRandomPipeName=function(){const t=r.randomBytes(21).toString("hex");return"win32"===e.platform?`\\\\.\\pipe\\vscode-jsonrpc-${t}-sock`:i.join(s.tmpdir(),`vscode-${t}.sock`)},t.createClientPipeTransport=function(e,t="utf-8"){let n,i=new Promise((e,t)=>{n=e});return new Promise((s,r)=>{let l=o.createServer(e=>{l.close(),n([new a.SocketMessageReader(e,t),new c.SocketMessageWriter(e,t)])});l.on("error",r),l.listen(e,()=>{l.removeListener("error",r),s({onConnected:()=>i})})})},t.createServerPipeTransport=function(e,t="utf-8"){const n=o.createConnection(e);return[new a.SocketMessageReader(n,t),new c.SocketMessageWriter(n,t)]}}).call(this,n(11))},function(e,t){},function(e,t,n){"use strict";var i=n(200).Buffer,s=n(743);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return i.alloc(0);if(1===this.length)return this.head.data;for(var t,n,s,r=i.allocUnsafe(e>>>0),o=this.head,a=0;o;)t=o.data,n=r,s=a,t.copy(n,s),a+=o.data.length,o=o.next;return r},e}(),s&&s.inspect&&s.inspect.custom&&(e.exports.prototype[s.inspect.custom]=function(){var e=s.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t){},function(e,t,n){(function(t){function n(e){try{if(!t.localStorage)return!1}catch(e){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var i=!1;return function(){if(!i){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}}}).call(this,n(27))},function(e,t,n){"use strict";e.exports=r;var i=n(332),s=Object.create(n(119));function r(e){if(!(this instanceof r))return new r(e);i.call(this,e)}s.inherits=n(12),s.inherits(r,i),r.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){e.exports=n(201)},function(e,t,n){e.exports=n(77)},function(e,t,n){e.exports=n(76).Transform},function(e,t,n){e.exports=n(76).PassThrough},function(e,t,n){var i=n(12),s=n(90),r=n(14).Buffer,o=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function c(){this.init(),this._w=a,s.call(this,64,56)}function l(e){return e<<30|e>>>2}function u(e,t,n,i){return 0===e?t&n|~t&i:2===e?t&n|t&i|n&i:t^n^i}i(c,s),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(e){for(var t,n=this._w,i=0|this._a,s=0|this._b,r=0|this._c,a=0|this._d,c=0|this._e,d=0;d<16;++d)n[d]=e.readInt32BE(4*d);for(;d<80;++d)n[d]=n[d-3]^n[d-8]^n[d-14]^n[d-16];for(var h=0;h<80;++h){var f=~~(h/20),p=0|((t=i)<<5|t>>>27)+u(f,s,r,a)+c+n[h]+o[f];c=a,a=r,r=l(s),s=i,i=p}this._a=i+this._a|0,this._b=s+this._b|0,this._c=r+this._c|0,this._d=a+this._d|0,this._e=c+this._e|0},c.prototype._hash=function(){var e=r.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=c},function(e,t,n){var i=n(12),s=n(90),r=n(14).Buffer,o=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function c(){this.init(),this._w=a,s.call(this,64,56)}function l(e){return e<<5|e>>>27}function u(e){return e<<30|e>>>2}function d(e,t,n,i){return 0===e?t&n|~t&i:2===e?t&n|t&i|n&i:t^n^i}i(c,s),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(e){for(var t,n=this._w,i=0|this._a,s=0|this._b,r=0|this._c,a=0|this._d,c=0|this._e,h=0;h<16;++h)n[h]=e.readInt32BE(4*h);for(;h<80;++h)n[h]=(t=n[h-3]^n[h-8]^n[h-14]^n[h-16])<<1|t>>>31;for(var f=0;f<80;++f){var p=~~(f/20),m=l(i)+d(p,s,r,a)+c+n[f]+o[p]|0;c=a,a=r,r=u(s),s=i,i=m}this._a=i+this._a|0,this._b=s+this._b|0,this._c=r+this._c|0,this._d=a+this._d|0,this._e=c+this._e|0},c.prototype._hash=function(){var e=r.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=c},function(e,t,n){var i=n(12),s=n(333),r=n(90),o=n(14).Buffer,a=new Array(64);function c(){this.init(),this._w=a,r.call(this,64,56)}i(c,s),c.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},c.prototype._hash=function(){var e=o.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},e.exports=c},function(e,t,n){var i=n(12),s=n(334),r=n(90),o=n(14).Buffer,a=new Array(160);function c(){this.init(),this._w=a,r.call(this,128,112)}i(c,s),c.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},c.prototype._hash=function(){var e=o.allocUnsafe(48);function t(t,n,i){e.writeInt32BE(t,i),e.writeInt32BE(n,i+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},e.exports=c},function(e,t,n){"use strict";var i=n(12),s=n(14).Buffer,r=n(65),o=s.alloc(128);function a(e,t){r.call(this,"digest"),"string"==typeof t&&(t=s.from(t)),this._alg=e,this._key=t,t.length>64?t=e(t):t.length<64&&(t=s.concat([t,o],64));for(var n=this._ipad=s.allocUnsafe(64),i=this._opad=s.allocUnsafe(64),a=0;a<64;a++)n[a]=54^t[a],i[a]=92^t[a];this._hash=[n]}i(a,r),a.prototype._update=function(e){this._hash.push(e)},a.prototype._final=function(){var e=this._alg(s.concat(this._hash));return this._alg(s.concat([this._opad,e]))},e.exports=a},function(e,t,n){e.exports=n(337)},function(e,t,n){(function(t,i){var s,r=n(339),o=n(340),a=n(341),c=n(14).Buffer,l=t.crypto&&t.crypto.subtle,u={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},d=[];function h(e,t,n,i,s){return l.importKey("raw",e,{name:"PBKDF2"},!1,["deriveBits"]).then((function(e){return l.deriveBits({name:"PBKDF2",salt:t,iterations:n,hash:{name:s}},e,i<<3)})).then((function(e){return c.from(e)}))}e.exports=function(e,n,f,p,m,g){"function"==typeof m&&(g=m,m=void 0);var y=u[(m=m||"sha1").toLowerCase()];if(!y||"function"!=typeof t.Promise)return i.nextTick((function(){var t;try{t=a(e,n,f,p,m)}catch(e){return g(e)}g(null,t)}));if(r(e,n,f,p),"function"!=typeof g)throw new Error("No callback provided to pbkdf2");c.isBuffer(e)||(e=c.from(e,o)),c.isBuffer(n)||(n=c.from(n,o)),function(e,t){e.then((function(e){i.nextTick((function(){t(null,e)}))}),(function(e){i.nextTick((function(){t(e)}))}))}(function(e){if(t.process&&!t.process.browser)return Promise.resolve(!1);if(!l||!l.importKey||!l.deriveBits)return Promise.resolve(!1);if(void 0!==d[e])return d[e];var n=h(s=s||c.alloc(8),s,10,128,e).then((function(){return!0})).catch((function(){return!1}));return d[e]=n,n}(y).then((function(t){return t?h(e,n,f,p,y):a(e,n,f,p,m)})),g)}}).call(this,n(27),n(11))},function(e,t,n){var i=n(758),s=n(206),r=n(207),o=n(771),a=n(155);function c(e,t,n){if(e=e.toLowerCase(),r[e])return s.createCipheriv(e,t,n);if(o[e])return new i({key:t,iv:n,mode:e});throw new TypeError("invalid suite type")}function l(e,t,n){if(e=e.toLowerCase(),r[e])return s.createDecipheriv(e,t,n);if(o[e])return new i({key:t,iv:n,mode:e,decrypt:!0});throw new TypeError("invalid suite type")}t.createCipher=t.Cipher=function(e,t){var n,i;if(e=e.toLowerCase(),r[e])n=r[e].key,i=r[e].iv;else{if(!o[e])throw new TypeError("invalid suite type");n=8*o[e].key,i=o[e].iv}var s=a(t,!1,n,i);return c(e,s.key,s.iv)},t.createCipheriv=t.Cipheriv=c,t.createDecipher=t.Decipher=function(e,t){var n,i;if(e=e.toLowerCase(),r[e])n=r[e].key,i=r[e].iv;else{if(!o[e])throw new TypeError("invalid suite type");n=8*o[e].key,i=o[e].iv}var s=a(t,!1,n,i);return l(e,s.key,s.iv)},t.createDecipheriv=t.Decipheriv=l,t.listCiphers=t.getCiphers=function(){return Object.keys(o).concat(s.getCiphers())}},function(e,t,n){var i=n(65),s=n(759),r=n(12),o=n(14).Buffer,a={"des-ede3-cbc":s.CBC.instantiate(s.EDE),"des-ede3":s.EDE,"des-ede-cbc":s.CBC.instantiate(s.EDE),"des-ede":s.EDE,"des-cbc":s.CBC.instantiate(s.DES),"des-ecb":s.DES};function c(e){i.call(this);var t,n=e.mode.toLowerCase(),s=a[n];t=e.decrypt?"decrypt":"encrypt";var r=e.key;o.isBuffer(r)||(r=o.from(r)),"des-ede"!==n&&"des-ede-cbc"!==n||(r=o.concat([r,r.slice(0,8)]));var c=e.iv;o.isBuffer(c)||(c=o.from(c)),this._des=s.create({key:r,iv:c,type:t})}a.des=a["des-cbc"],a.des3=a["des-ede3-cbc"],e.exports=c,r(c,i),c.prototype._update=function(e){return o.from(this._des.update(e))},c.prototype._final=function(){return o.from(this._des.final())}},function(e,t,n){"use strict";t.utils=n(342),t.Cipher=n(205),t.DES=n(343),t.CBC=n(760),t.EDE=n(761)},function(e,t,n){"use strict";var i=n(38),s=n(12),r={};function o(e){i.equal(e.length,8,"Invalid IV length"),this.iv=new Array(8);for(var t=0;t<this.iv.length;t++)this.iv[t]=e[t]}t.instantiate=function(e){function t(t){e.call(this,t),this._cbcInit()}s(t,e);for(var n=Object.keys(r),i=0;i<n.length;i++){var o=n[i];t.prototype[o]=r[o]}return t.create=function(e){return new t(e)},t},r._cbcInit=function(){var e=new o(this.options.iv);this._cbcState=e},r._update=function(e,t,n,i){var s=this._cbcState,r=this.constructor.super_.prototype,o=s.iv;if("encrypt"===this.type){for(var a=0;a<this.blockSize;a++)o[a]^=e[t+a];r._update.call(this,o,0,n,i);for(a=0;a<this.blockSize;a++)o[a]=n[i+a]}else{r._update.call(this,e,t,n,i);for(a=0;a<this.blockSize;a++)n[i+a]^=o[a];for(a=0;a<this.blockSize;a++)o[a]=e[t+a]}}},function(e,t,n){"use strict";var i=n(38),s=n(12),r=n(205),o=n(343);function a(e,t){i.equal(t.length,24,"Invalid key length");var n=t.slice(0,8),s=t.slice(8,16),r=t.slice(16,24);this.ciphers="encrypt"===e?[o.create({type:"encrypt",key:n}),o.create({type:"decrypt",key:s}),o.create({type:"encrypt",key:r})]:[o.create({type:"decrypt",key:r}),o.create({type:"encrypt",key:s}),o.create({type:"decrypt",key:n})]}function c(e){r.call(this,e);var t=new a(this.type,this.options.key);this._edeState=t}s(c,r),e.exports=c,c.create=function(e){return new c(e)},c.prototype._update=function(e,t,n,i){var s=this._edeState;s.ciphers[0]._update(e,t,n,i),s.ciphers[1]._update(n,i,n,i),s.ciphers[2]._update(n,i,n,i)},c.prototype._pad=o.prototype._pad,c.prototype._unpad=o.prototype._unpad},function(e,t,n){var i=n(207),s=n(347),r=n(14).Buffer,o=n(348),a=n(65),c=n(154),l=n(155);function u(e,t,n){a.call(this),this._cache=new h,this._cipher=new c.AES(t),this._prev=r.from(n),this._mode=e,this._autopadding=!0}n(12)(u,a),u.prototype._update=function(e){var t,n;this._cache.add(e);for(var i=[];t=this._cache.get();)n=this._mode.encrypt(this,t),i.push(n);return r.concat(i)};var d=r.alloc(16,16);function h(){this.cache=r.allocUnsafe(0)}function f(e,t,n){var a=i[e.toLowerCase()];if(!a)throw new TypeError("invalid suite type");if("string"==typeof t&&(t=r.from(t)),t.length!==a.key/8)throw new TypeError("invalid key length "+t.length);if("string"==typeof n&&(n=r.from(n)),"GCM"!==a.mode&&n.length!==a.iv)throw new TypeError("invalid iv length "+n.length);return"stream"===a.type?new o(a.module,t,n):"auth"===a.type?new s(a.module,t,n):new u(a.module,t,n)}u.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return e=this._mode.encrypt(this,e),this._cipher.scrub(),e;if(!e.equals(d))throw this._cipher.scrub(),new Error("data not multiple of block length")},u.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},h.prototype.add=function(e){this.cache=r.concat([this.cache,e])},h.prototype.get=function(){if(this.cache.length>15){var e=this.cache.slice(0,16);return this.cache=this.cache.slice(16),e}return null},h.prototype.flush=function(){for(var e=16-this.cache.length,t=r.allocUnsafe(e),n=-1;++n<e;)t.writeUInt8(e,n);return r.concat([this.cache,t])},t.createCipheriv=f,t.createCipher=function(e,t){var n=i[e.toLowerCase()];if(!n)throw new TypeError("invalid suite type");var s=l(t,!1,n.key,n.iv);return f(e,s.key,s.iv)}},function(e,t){t.encrypt=function(e,t){return e._cipher.encryptBlock(t)},t.decrypt=function(e,t){return e._cipher.decryptBlock(t)}},function(e,t,n){var i=n(120);t.encrypt=function(e,t){var n=i(t,e._prev);return e._prev=e._cipher.encryptBlock(n),e._prev},t.decrypt=function(e,t){var n=e._prev;e._prev=t;var s=e._cipher.decryptBlock(t);return i(s,n)}},function(e,t,n){var i=n(14).Buffer,s=n(120);function r(e,t,n){var r=t.length,o=s(t,e._cache);return e._cache=e._cache.slice(r),e._prev=i.concat([e._prev,n?t:o]),o}t.encrypt=function(e,t,n){for(var s,o=i.allocUnsafe(0);t.length;){if(0===e._cache.length&&(e._cache=e._cipher.encryptBlock(e._prev),e._prev=i.allocUnsafe(0)),!(e._cache.length<=t.length)){o=i.concat([o,r(e,t,n)]);break}s=e._cache.length,o=i.concat([o,r(e,t.slice(0,s),n)]),t=t.slice(s)}return o}},function(e,t,n){var i=n(14).Buffer;function s(e,t,n){var s=e._cipher.encryptBlock(e._prev)[0]^t;return e._prev=i.concat([e._prev.slice(1),i.from([n?t:s])]),s}t.encrypt=function(e,t,n){for(var r=t.length,o=i.allocUnsafe(r),a=-1;++a<r;)o[a]=s(e,t[a],n);return o}},function(e,t,n){var i=n(14).Buffer;function s(e,t,n){for(var i,s,o=-1,a=0;++o<8;)i=t&1<<7-o?128:0,a+=(128&(s=e._cipher.encryptBlock(e._prev)[0]^i))>>o%8,e._prev=r(e._prev,n?i:s);return a}function r(e,t){var n=e.length,s=-1,r=i.allocUnsafe(e.length);for(e=i.concat([e,i.from([t])]);++s<n;)r[s]=e[s]<<1|e[s+1]>>7;return r}t.encrypt=function(e,t,n){for(var r=t.length,o=i.allocUnsafe(r),a=-1;++a<r;)o[a]=s(e,t[a],n);return o}},function(e,t,n){(function(e){var i=n(120);function s(e){return e._prev=e._cipher.encryptBlock(e._prev),e._prev}t.encrypt=function(t,n){for(;t._cache.length<n.length;)t._cache=e.concat([t._cache,s(t)]);var r=t._cache.slice(0,n.length);return t._cache=t._cache.slice(n.length),i(n,r)}}).call(this,n(3).Buffer)},function(e,t,n){var i=n(14).Buffer,s=i.alloc(16,0);function r(e){var t=i.allocUnsafe(16);return t.writeUInt32BE(e[0]>>>0,0),t.writeUInt32BE(e[1]>>>0,4),t.writeUInt32BE(e[2]>>>0,8),t.writeUInt32BE(e[3]>>>0,12),t}function o(e){this.h=e,this.state=i.alloc(16,0),this.cache=i.allocUnsafe(0)}o.prototype.ghash=function(e){for(var t=-1;++t<e.length;)this.state[t]^=e[t];this._multiply()},o.prototype._multiply=function(){for(var e,t,n,i=[(e=this.h).readUInt32BE(0),e.readUInt32BE(4),e.readUInt32BE(8),e.readUInt32BE(12)],s=[0,0,0,0],o=-1;++o<128;){for(0!=(this.state[~~(o/8)]&1<<7-o%8)&&(s[0]^=i[0],s[1]^=i[1],s[2]^=i[2],s[3]^=i[3]),n=0!=(1&i[3]),t=3;t>0;t--)i[t]=i[t]>>>1|(1&i[t-1])<<31;i[0]=i[0]>>>1,n&&(i[0]=i[0]^225<<24)}this.state=r(s)},o.prototype.update=function(e){var t;for(this.cache=i.concat([this.cache,e]);this.cache.length>=16;)t=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(t)},o.prototype.final=function(e,t){return this.cache.length&&this.ghash(i.concat([this.cache,s],16)),this.ghash(r([0,e,0,t])),this.state},e.exports=o},function(e,t,n){var i=n(347),s=n(14).Buffer,r=n(207),o=n(348),a=n(65),c=n(154),l=n(155);function u(e,t,n){a.call(this),this._cache=new d,this._last=void 0,this._cipher=new c.AES(t),this._prev=s.from(n),this._mode=e,this._autopadding=!0}function d(){this.cache=s.allocUnsafe(0)}function h(e,t,n){var a=r[e.toLowerCase()];if(!a)throw new TypeError("invalid suite type");if("string"==typeof n&&(n=s.from(n)),"GCM"!==a.mode&&n.length!==a.iv)throw new TypeError("invalid iv length "+n.length);if("string"==typeof t&&(t=s.from(t)),t.length!==a.key/8)throw new TypeError("invalid key length "+t.length);return"stream"===a.type?new o(a.module,t,n,!0):"auth"===a.type?new i(a.module,t,n,!0):new u(a.module,t,n)}n(12)(u,a),u.prototype._update=function(e){var t,n;this._cache.add(e);for(var i=[];t=this._cache.get(this._autopadding);)n=this._mode.decrypt(this,t),i.push(n);return s.concat(i)},u.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return function(e){var t=e[15];if(t<1||t>16)throw new Error("unable to decrypt data");var n=-1;for(;++n<t;)if(e[n+(16-t)]!==t)throw new Error("unable to decrypt data");if(16===t)return;return e.slice(0,16-t)}(this._mode.decrypt(this,e));if(e)throw new Error("data not multiple of block length")},u.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},d.prototype.add=function(e){this.cache=s.concat([this.cache,e])},d.prototype.get=function(e){var t;if(e){if(this.cache.length>16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t}else if(this.cache.length>=16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t;return null},d.prototype.flush=function(){if(this.cache.length)return this.cache},t.createDecipher=function(e,t){var n=r[e.toLowerCase()];if(!n)throw new TypeError("invalid suite type");var i=l(t,!1,n.key,n.iv);return h(e,i.key,i.iv)},t.createDecipheriv=h},function(e,t){t["des-ecb"]={key:8,iv:0},t["des-cbc"]=t.des={key:8,iv:8},t["des-ede3-cbc"]=t.des3={key:24,iv:8},t["des-ede3"]={key:24,iv:0},t["des-ede-cbc"]={key:16,iv:8},t["des-ede"]={key:16,iv:0}},function(e,t){},function(e,t){},function(e){e.exports=JSON.parse('{"modp1":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},"modp2":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},"modp5":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},"modp14":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},"modp15":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},"modp16":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},"modp17":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},"modp18":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}')},function(e,t,n){(function(t){var i=n(25),s=new(n(350)),r=new i(24),o=new i(11),a=new i(10),c=new i(3),l=new i(7),u=n(349),d=n(75);function h(e,n){return n=n||"utf8",t.isBuffer(e)||(e=new t(e,n)),this._pub=new i(e),this}function f(e,n){return n=n||"utf8",t.isBuffer(e)||(e=new t(e,n)),this._priv=new i(e),this}e.exports=m;var p={};function m(e,t,n){this.setGenerator(t),this.__prime=new i(e),this._prime=i.mont(this.__prime),this._primeLen=e.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,n?(this.setPublicKey=h,this.setPrivateKey=f):this._primeCode=8}function g(e,n){var i=new t(e.toArray());return n?i.toString(n):i}Object.defineProperty(m.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=function(e,t){var n=t.toString("hex"),i=[n,e.toString(16)].join("_");if(i in p)return p[i];var d,h=0;if(e.isEven()||!u.simpleSieve||!u.fermatTest(e)||!s.test(e))return h+=1,h+="02"===n||"05"===n?8:4,p[i]=h,h;switch(s.test(e.shrn(1))||(h+=2),n){case"02":e.mod(r).cmp(o)&&(h+=8);break;case"05":(d=e.mod(a)).cmp(c)&&d.cmp(l)&&(h+=8);break;default:h+=4}return p[i]=h,h}(this.__prime,this.__gen)),this._primeCode}}),m.prototype.generateKeys=function(){return this._priv||(this._priv=new i(d(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},m.prototype.computeSecret=function(e){var n=(e=(e=new i(e)).toRed(this._prime)).redPow(this._priv).fromRed(),s=new t(n.toArray()),r=this.getPrime();if(s.length<r.length){var o=new t(r.length-s.length);o.fill(0),s=t.concat([o,s])}return s},m.prototype.getPublicKey=function(e){return g(this._pub,e)},m.prototype.getPrivateKey=function(e){return g(this._priv,e)},m.prototype.getPrime=function(e){return g(this.__prime,e)},m.prototype.getGenerator=function(e){return g(this._gen,e)},m.prototype.setGenerator=function(e,n){return n=n||"utf8",t.isBuffer(e)||(e=new t(e,n)),this.__gen=e,this._gen=new i(e),this}}).call(this,n(3).Buffer)},function(e,t,n){(function(t){var i=n(118),s=n(34),r=n(12),o=n(777),a=n(809),c=n(337);function l(e){s.Writable.call(this);var t=c[e];if(!t)throw new Error("Unknown message digest");this._hashType=t.hash,this._hash=i(t.hash),this._tag=t.id,this._signType=t.sign}function u(e){s.Writable.call(this);var t=c[e];if(!t)throw new Error("Unknown message digest");this._hash=i(t.hash),this._tag=t.id,this._signType=t.sign}function d(e){return new l(e)}function h(e){return new u(e)}Object.keys(c).forEach((function(e){c[e].id=new t(c[e].id,"hex"),c[e.toLowerCase()]=c[e]})),r(l,s.Writable),l.prototype._write=function(e,t,n){this._hash.update(e),n()},l.prototype.update=function(e,n){return"string"==typeof e&&(e=new t(e,n)),this._hash.update(e),this},l.prototype.sign=function(e,t){this.end();var n=this._hash.digest(),i=o(n,e,this._hashType,this._signType,this._tag);return t?i.toString(t):i},r(u,s.Writable),u.prototype._write=function(e,t,n){this._hash.update(e),n()},u.prototype.update=function(e,n){return"string"==typeof e&&(e=new t(e,n)),this._hash.update(e),this},u.prototype.verify=function(e,n,i){"string"==typeof n&&(n=new t(n,i)),this.end();var s=this._hash.digest();return a(n,s,e,this._signType,this._tag)},e.exports={Sign:d,Verify:h,createSign:d,createVerify:h}}).call(this,n(3).Buffer)},function(e,t,n){(function(t){var i=n(335),s=n(210),r=n(211).ec,o=n(25),a=n(157),c=n(360);function l(e,n,s,r){if((e=new t(e.toArray())).length<n.byteLength()){var o=new t(n.byteLength()-e.length);o.fill(0),e=t.concat([o,e])}var a=s.length,c=function(e,n){e=(e=u(e,n)).mod(n);var i=new t(e.toArray());if(i.length<n.byteLength()){var s=new t(n.byteLength()-i.length);s.fill(0),i=t.concat([s,i])}return i}(s,n),l=new t(a);l.fill(1);var d=new t(a);return d.fill(0),d=i(r,d).update(l).update(new t([0])).update(e).update(c).digest(),l=i(r,d).update(l).digest(),{k:d=i(r,d).update(l).update(new t([1])).update(e).update(c).digest(),v:l=i(r,d).update(l).digest()}}function u(e,t){var n=new o(e),i=(e.length<<3)-t.bitLength();return i>0&&n.ishrn(i),n}function d(e,n,s){var r,o;do{for(r=new t(0);8*r.length<e.bitLength();)n.v=i(s,n.k).update(n.v).digest(),r=t.concat([r,n.v]);o=u(r,e),n.k=i(s,n.k).update(n.v).update(new t([0])).digest(),n.v=i(s,n.k).update(n.v).digest()}while(-1!==o.cmp(e));return o}function h(e,t,n,i){return e.toRed(o.mont(n)).redPow(t).fromRed().mod(i)}e.exports=function(e,n,i,f,p){var m=a(n);if(m.curve){if("ecdsa"!==f&&"ecdsa/rsa"!==f)throw new Error("wrong private key type");return function(e,n){var i=c[n.curve.join(".")];if(!i)throw new Error("unknown curve "+n.curve.join("."));var s=new r(i).keyFromPrivate(n.privateKey).sign(e);return new t(s.toDER())}(e,m)}if("dsa"===m.type){if("dsa"!==f)throw new Error("wrong private key type");return function(e,n,i){var s,r=n.params.priv_key,a=n.params.p,c=n.params.q,f=n.params.g,p=new o(0),m=u(e,c).mod(c),g=!1,y=l(r,c,e,i);for(;!1===g;)s=d(c,y,i),p=h(f,s,a,c),0===(g=s.invm(c).imul(m.add(r.mul(p))).mod(c)).cmpn(0)&&(g=!1,p=new o(0));return function(e,n){e=e.toArray(),n=n.toArray(),128&e[0]&&(e=[0].concat(e));128&n[0]&&(n=[0].concat(n));var i=[48,e.length+n.length+4,2,e.length];return i=i.concat(e,[2,n.length],n),new t(i)}(p,g)}(e,m,i)}if("rsa"!==f&&"ecdsa/rsa"!==f)throw new Error("wrong private key type");e=t.concat([p,e]);for(var g=m.modulus.byteLength(),y=[0,1];e.length+y.length+1<g;)y.push(255);y.push(0);for(var v=-1;++v<e.length;)y.push(e[v]);return s(y,m)},e.exports.getKey=l,e.exports.makeKey=d}).call(this,n(3).Buffer)},function(e){e.exports=JSON.parse('{"name":"elliptic","version":"6.5.4","description":"EC cryptography","main":"lib/elliptic.js","files":["lib"],"scripts":{"lint":"eslint lib test","lint:fix":"npm run lint -- --fix","unit":"istanbul test _mocha --reporter=spec test/index.js","test":"npm run lint && npm run unit","version":"grunt dist && git add dist/"},"repository":{"type":"git","url":"git@github.com:indutny/elliptic"},"keywords":["EC","Elliptic","curve","Cryptography"],"author":"Fedor Indutny <fedor@indutny.com>","license":"MIT","bugs":{"url":"https://github.com/indutny/elliptic/issues"},"homepage":"https://github.com/indutny/elliptic","devDependencies":{"brfs":"^2.0.2","coveralls":"^3.1.0","eslint":"^7.6.0","grunt":"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1","istanbul":"^0.4.5","mocha":"^8.0.1"},"dependencies":{"bn.js":"^4.11.9","brorand":"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1","inherits":"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}')},function(e,t,n){"use strict";var i=n(39),s=n(25),r=n(12),o=n(156),a=i.assert;function c(e){o.call(this,"short",e),this.a=new s(e.a,16).toRed(this.red),this.b=new s(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function l(e,t,n,i){o.BasePoint.call(this,e,"affine"),null===t&&null===n?(this.x=null,this.y=null,this.inf=!0):(this.x=new s(t,16),this.y=new s(n,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function u(e,t,n,i){o.BasePoint.call(this,e,"jacobian"),null===t&&null===n&&null===i?(this.x=this.curve.one,this.y=this.curve.one,this.z=new s(0)):(this.x=new s(t,16),this.y=new s(n,16),this.z=new s(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}r(c,o),e.exports=c,c.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var t,n;if(e.beta)t=new s(e.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);t=(t=i[0].cmp(i[1])<0?i[0]:i[1]).toRed(this.red)}if(e.lambda)n=new s(e.lambda,16);else{var r=this._getEndoRoots(this.n);0===this.g.mul(r[0]).x.cmp(this.g.x.redMul(t))?n=r[0]:(n=r[1],a(0===this.g.mul(n).x.cmp(this.g.x.redMul(t))))}return{beta:t,lambda:n,basis:e.basis?e.basis.map((function(e){return{a:new s(e.a,16),b:new s(e.b,16)}})):this._getEndoBasis(n)}}},c.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:s.mont(e),n=new s(2).toRed(t).redInvm(),i=n.redNeg(),r=new s(3).toRed(t).redNeg().redSqrt().redMul(n);return[i.redAdd(r).fromRed(),i.redSub(r).fromRed()]},c.prototype._getEndoBasis=function(e){for(var t,n,i,r,o,a,c,l,u,d=this.n.ushrn(Math.floor(this.n.bitLength()/2)),h=e,f=this.n.clone(),p=new s(1),m=new s(0),g=new s(0),y=new s(1),v=0;0!==h.cmpn(0);){var S=f.div(h);l=f.sub(S.mul(h)),u=g.sub(S.mul(p));var _=y.sub(S.mul(m));if(!i&&l.cmp(d)<0)t=c.neg(),n=p,i=l.neg(),r=u;else if(i&&2==++v)break;c=l,f=h,h=l,g=p,p=u,y=m,m=_}o=l.neg(),a=u;var E=i.sqr().add(r.sqr());return o.sqr().add(a.sqr()).cmp(E)>=0&&(o=t,a=n),i.negative&&(i=i.neg(),r=r.neg()),o.negative&&(o=o.neg(),a=a.neg()),[{a:i,b:r},{a:o,b:a}]},c.prototype._endoSplit=function(e){var t=this.endo.basis,n=t[0],i=t[1],s=i.b.mul(e).divRound(this.n),r=n.b.neg().mul(e).divRound(this.n),o=s.mul(n.a),a=r.mul(i.a),c=s.mul(n.b),l=r.mul(i.b);return{k1:e.sub(o).sub(a),k2:c.add(l).neg()}},c.prototype.pointFromX=function(e,t){(e=new s(e,16)).red||(e=e.toRed(this.red));var n=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(0!==i.redSqr().redSub(n).cmp(this.zero))throw new Error("invalid point");var r=i.fromRed().isOdd();return(t&&!r||!t&&r)&&(i=i.redNeg()),this.point(e,i)},c.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,n=e.y,i=this.a.redMul(t),s=t.redSqr().redMul(t).redIAdd(i).redIAdd(this.b);return 0===n.redSqr().redISub(s).cmpn(0)},c.prototype._endoWnafMulAdd=function(e,t,n){for(var i=this._endoWnafT1,s=this._endoWnafT2,r=0;r<e.length;r++){var o=this._endoSplit(t[r]),a=e[r],c=a._getBeta();o.k1.negative&&(o.k1.ineg(),a=a.neg(!0)),o.k2.negative&&(o.k2.ineg(),c=c.neg(!0)),i[2*r]=a,i[2*r+1]=c,s[2*r]=o.k1,s[2*r+1]=o.k2}for(var l=this._wnafMulAdd(1,i,s,2*r,n),u=0;u<2*r;u++)i[u]=null,s[u]=null;return l},r(l,o.BasePoint),c.prototype.point=function(e,t,n){return new l(this,e,t,n)},c.prototype.pointFromJSON=function(e,t){return l.fromJSON(this,e,t)},l.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var n=this.curve,i=function(e){return n.point(e.x.redMul(n.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(i)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(i)}}}return t}},l.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},l.fromJSON=function(e,t,n){"string"==typeof t&&(t=JSON.parse(t));var i=e.point(t[0],t[1],n);if(!t[2])return i;function s(t){return e.point(t[0],t[1],n)}var r=t[2];return i.precomputed={beta:null,doubles:r.doubles&&{step:r.doubles.step,points:[i].concat(r.doubles.points.map(s))},naf:r.naf&&{wnd:r.naf.wnd,points:[i].concat(r.naf.points.map(s))}},i},l.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},l.prototype.isInfinity=function(){return this.inf},l.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var n=t.redSqr().redISub(this.x).redISub(e.x),i=t.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,i)},l.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,n=this.x.redSqr(),i=e.redInvm(),s=n.redAdd(n).redIAdd(n).redIAdd(t).redMul(i),r=s.redSqr().redISub(this.x.redAdd(this.x)),o=s.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,o)},l.prototype.getX=function(){return this.x.fromRed()},l.prototype.getY=function(){return this.y.fromRed()},l.prototype.mul=function(e){return e=new s(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},l.prototype.mulAdd=function(e,t,n){var i=[this,t],s=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)},l.prototype.jmulAdd=function(e,t,n){var i=[this,t],s=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)},l.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},l.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var n=this.precomputed,i=function(e){return e.neg()};t.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(i)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(i)}}}return t},l.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},r(u,o.BasePoint),c.prototype.jpoint=function(e,t,n){return new u(this,e,t,n)},u.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),n=this.x.redMul(t),i=this.y.redMul(t).redMul(e);return this.curve.point(n,i)},u.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},u.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),n=this.z.redSqr(),i=this.x.redMul(t),s=e.x.redMul(n),r=this.y.redMul(t.redMul(e.z)),o=e.y.redMul(n.redMul(this.z)),a=i.redSub(s),c=r.redSub(o);if(0===a.cmpn(0))return 0!==c.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var l=a.redSqr(),u=l.redMul(a),d=i.redMul(l),h=c.redSqr().redIAdd(u).redISub(d).redISub(d),f=c.redMul(d.redISub(h)).redISub(r.redMul(u)),p=this.z.redMul(e.z).redMul(a);return this.curve.jpoint(h,f,p)},u.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),n=this.x,i=e.x.redMul(t),s=this.y,r=e.y.redMul(t).redMul(this.z),o=n.redSub(i),a=s.redSub(r);if(0===o.cmpn(0))return 0!==a.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=o.redSqr(),l=c.redMul(o),u=n.redMul(c),d=a.redSqr().redIAdd(l).redISub(u).redISub(u),h=a.redMul(u.redISub(d)).redISub(s.redMul(l)),f=this.z.redMul(o);return this.curve.jpoint(d,h,f)},u.prototype.dblp=function(e){if(0===e)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var n=this;for(t=0;t<e;t++)n=n.dbl();return n}var i=this.curve.a,s=this.curve.tinv,r=this.x,o=this.y,a=this.z,c=a.redSqr().redSqr(),l=o.redAdd(o);for(t=0;t<e;t++){var u=r.redSqr(),d=l.redSqr(),h=d.redSqr(),f=u.redAdd(u).redIAdd(u).redIAdd(i.redMul(c)),p=r.redMul(d),m=f.redSqr().redISub(p.redAdd(p)),g=p.redISub(m),y=f.redMul(g);y=y.redIAdd(y).redISub(h);var v=l.redMul(a);t+1<e&&(c=c.redMul(h)),r=m,a=v,l=y}return this.curve.jpoint(r,l.redMul(s),a)},u.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},u.prototype._zeroDbl=function(){var e,t,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),r=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(i).redISub(r);o=o.redIAdd(o);var a=i.redAdd(i).redIAdd(i),c=a.redSqr().redISub(o).redISub(o),l=r.redIAdd(r);l=(l=l.redIAdd(l)).redIAdd(l),e=c,t=a.redMul(o.redISub(c)).redISub(l),n=this.y.redAdd(this.y)}else{var u=this.x.redSqr(),d=this.y.redSqr(),h=d.redSqr(),f=this.x.redAdd(d).redSqr().redISub(u).redISub(h);f=f.redIAdd(f);var p=u.redAdd(u).redIAdd(u),m=p.redSqr(),g=h.redIAdd(h);g=(g=g.redIAdd(g)).redIAdd(g),e=m.redISub(f).redISub(f),t=p.redMul(f.redISub(e)).redISub(g),n=(n=this.y.redMul(this.z)).redIAdd(n)}return this.curve.jpoint(e,t,n)},u.prototype._threeDbl=function(){var e,t,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),r=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(i).redISub(r);o=o.redIAdd(o);var a=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),c=a.redSqr().redISub(o).redISub(o);e=c;var l=r.redIAdd(r);l=(l=l.redIAdd(l)).redIAdd(l),t=a.redMul(o.redISub(c)).redISub(l),n=this.y.redAdd(this.y)}else{var u=this.z.redSqr(),d=this.y.redSqr(),h=this.x.redMul(d),f=this.x.redSub(u).redMul(this.x.redAdd(u));f=f.redAdd(f).redIAdd(f);var p=h.redIAdd(h),m=(p=p.redIAdd(p)).redAdd(p);e=f.redSqr().redISub(m),n=this.y.redAdd(this.z).redSqr().redISub(d).redISub(u);var g=d.redSqr();g=(g=(g=g.redIAdd(g)).redIAdd(g)).redIAdd(g),t=f.redMul(p.redISub(e)).redISub(g)}return this.curve.jpoint(e,t,n)},u.prototype._dbl=function(){var e=this.curve.a,t=this.x,n=this.y,i=this.z,s=i.redSqr().redSqr(),r=t.redSqr(),o=n.redSqr(),a=r.redAdd(r).redIAdd(r).redIAdd(e.redMul(s)),c=t.redAdd(t),l=(c=c.redIAdd(c)).redMul(o),u=a.redSqr().redISub(l.redAdd(l)),d=l.redISub(u),h=o.redSqr();h=(h=(h=h.redIAdd(h)).redIAdd(h)).redIAdd(h);var f=a.redMul(d).redISub(h),p=n.redAdd(n).redMul(i);return this.curve.jpoint(u,f,p)},u.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr(),i=t.redSqr(),s=e.redAdd(e).redIAdd(e),r=s.redSqr(),o=this.x.redAdd(t).redSqr().redISub(e).redISub(i),a=(o=(o=(o=o.redIAdd(o)).redAdd(o).redIAdd(o)).redISub(r)).redSqr(),c=i.redIAdd(i);c=(c=(c=c.redIAdd(c)).redIAdd(c)).redIAdd(c);var l=s.redIAdd(o).redSqr().redISub(r).redISub(a).redISub(c),u=t.redMul(l);u=(u=u.redIAdd(u)).redIAdd(u);var d=this.x.redMul(a).redISub(u);d=(d=d.redIAdd(d)).redIAdd(d);var h=this.y.redMul(l.redMul(c.redISub(l)).redISub(o.redMul(a)));h=(h=(h=h.redIAdd(h)).redIAdd(h)).redIAdd(h);var f=this.z.redAdd(o).redSqr().redISub(n).redISub(a);return this.curve.jpoint(d,h,f)},u.prototype.mul=function(e,t){return e=new s(e,t),this.curve._wnafMul(this,e)},u.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),n=e.z.redSqr();if(0!==this.x.redMul(n).redISub(e.x.redMul(t)).cmpn(0))return!1;var i=t.redMul(this.z),s=n.redMul(e.z);return 0===this.y.redMul(s).redISub(e.y.redMul(i)).cmpn(0)},u.prototype.eqXToP=function(e){var t=this.z.redSqr(),n=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(n))return!0;for(var i=e.clone(),s=this.curve.redN.redMul(t);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(s),0===this.x.cmp(n))return!0}},u.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},u.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},function(e,t,n){"use strict";var i=n(25),s=n(12),r=n(156),o=n(39);function a(e){r.call(this,"mont",e),this.a=new i(e.a,16).toRed(this.red),this.b=new i(e.b,16).toRed(this.red),this.i4=new i(4).toRed(this.red).redInvm(),this.two=new i(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function c(e,t,n){r.BasePoint.call(this,e,"projective"),null===t&&null===n?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new i(t,16),this.z=new i(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}s(a,r),e.exports=a,a.prototype.validate=function(e){var t=e.normalize().x,n=t.redSqr(),i=n.redMul(t).redAdd(n.redMul(this.a)).redAdd(t);return 0===i.redSqrt().redSqr().cmp(i)},s(c,r.BasePoint),a.prototype.decodePoint=function(e,t){return this.point(o.toArray(e,t),1)},a.prototype.point=function(e,t){return new c(this,e,t)},a.prototype.pointFromJSON=function(e){return c.fromJSON(this,e)},c.prototype.precompute=function(){},c.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},c.fromJSON=function(e,t){return new c(e,t[0],t[1]||e.one)},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},c.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),n=e.redSub(t),i=e.redMul(t),s=n.redMul(t.redAdd(this.curve.a24.redMul(n)));return this.curve.point(i,s)},c.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.diffAdd=function(e,t){var n=this.x.redAdd(this.z),i=this.x.redSub(this.z),s=e.x.redAdd(e.z),r=e.x.redSub(e.z).redMul(n),o=s.redMul(i),a=t.z.redMul(r.redAdd(o).redSqr()),c=t.x.redMul(r.redISub(o).redSqr());return this.curve.point(a,c)},c.prototype.mul=function(e){for(var t=e.clone(),n=this,i=this.curve.point(null,null),s=[];0!==t.cmpn(0);t.iushrn(1))s.push(t.andln(1));for(var r=s.length-1;r>=0;r--)0===s[r]?(n=n.diffAdd(i,this),i=i.dbl()):(i=n.diffAdd(i,this),n=n.dbl());return i},c.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},c.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},function(e,t,n){"use strict";var i=n(39),s=n(25),r=n(12),o=n(156),a=i.assert;function c(e){this.twisted=1!=(0|e.a),this.mOneA=this.twisted&&-1==(0|e.a),this.extended=this.mOneA,o.call(this,"edwards",e),this.a=new s(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new s(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new s(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),a(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|e.c)}function l(e,t,n,i,r){o.BasePoint.call(this,e,"projective"),null===t&&null===n&&null===i?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new s(t,16),this.y=new s(n,16),this.z=i?new s(i,16):this.curve.one,this.t=r&&new s(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}r(c,o),e.exports=c,c.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},c.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},c.prototype.jpoint=function(e,t,n,i){return this.point(e,t,n,i)},c.prototype.pointFromX=function(e,t){(e=new s(e,16)).red||(e=e.toRed(this.red));var n=e.redSqr(),i=this.c2.redSub(this.a.redMul(n)),r=this.one.redSub(this.c2.redMul(this.d).redMul(n)),o=i.redMul(r.redInvm()),a=o.redSqrt();if(0!==a.redSqr().redSub(o).cmp(this.zero))throw new Error("invalid point");var c=a.fromRed().isOdd();return(t&&!c||!t&&c)&&(a=a.redNeg()),this.point(e,a)},c.prototype.pointFromY=function(e,t){(e=new s(e,16)).red||(e=e.toRed(this.red));var n=e.redSqr(),i=n.redSub(this.c2),r=n.redMul(this.d).redMul(this.c2).redSub(this.a),o=i.redMul(r.redInvm());if(0===o.cmp(this.zero)){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var a=o.redSqrt();if(0!==a.redSqr().redSub(o).cmp(this.zero))throw new Error("invalid point");return a.fromRed().isOdd()!==t&&(a=a.redNeg()),this.point(a,e)},c.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),n=e.y.redSqr(),i=t.redMul(this.a).redAdd(n),s=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(n)));return 0===i.cmp(s)},r(l,o.BasePoint),c.prototype.pointFromJSON=function(e){return l.fromJSON(this,e)},c.prototype.point=function(e,t,n,i){return new l(this,e,t,n,i)},l.fromJSON=function(e,t){return new l(e,t[0],t[1],t[2])},l.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},l.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},l.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var i=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),r=i.redAdd(t),o=r.redSub(n),a=i.redSub(t),c=s.redMul(o),l=r.redMul(a),u=s.redMul(a),d=o.redMul(r);return this.curve.point(c,l,d,u)},l.prototype._projDbl=function(){var e,t,n,i,s,r,o=this.x.redAdd(this.y).redSqr(),a=this.x.redSqr(),c=this.y.redSqr();if(this.curve.twisted){var l=(i=this.curve._mulA(a)).redAdd(c);this.zOne?(e=o.redSub(a).redSub(c).redMul(l.redSub(this.curve.two)),t=l.redMul(i.redSub(c)),n=l.redSqr().redSub(l).redSub(l)):(s=this.z.redSqr(),r=l.redSub(s).redISub(s),e=o.redSub(a).redISub(c).redMul(r),t=l.redMul(i.redSub(c)),n=l.redMul(r))}else i=a.redAdd(c),s=this.curve._mulC(this.z).redSqr(),r=i.redSub(s).redSub(s),e=this.curve._mulC(o.redISub(i)).redMul(r),t=this.curve._mulC(i).redMul(a.redISub(c)),n=i.redMul(r);return this.curve.point(e,t,n)},l.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},l.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),n=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),i=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),r=n.redSub(t),o=s.redSub(i),a=s.redAdd(i),c=n.redAdd(t),l=r.redMul(o),u=a.redMul(c),d=r.redMul(c),h=o.redMul(a);return this.curve.point(l,u,h,d)},l.prototype._projAdd=function(e){var t,n,i=this.z.redMul(e.z),s=i.redSqr(),r=this.x.redMul(e.x),o=this.y.redMul(e.y),a=this.curve.d.redMul(r).redMul(o),c=s.redSub(a),l=s.redAdd(a),u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(r).redISub(o),d=i.redMul(c).redMul(u);return this.curve.twisted?(t=i.redMul(l).redMul(o.redSub(this.curve._mulA(r))),n=c.redMul(l)):(t=i.redMul(l).redMul(o.redSub(r)),n=this.curve._mulC(c).redMul(l)),this.curve.point(d,t,n)},l.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},l.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},l.prototype.mulAdd=function(e,t,n){return this.curve._wnafMulAdd(1,[this,t],[e,n],2,!1)},l.prototype.jmulAdd=function(e,t,n){return this.curve._wnafMulAdd(1,[this,t],[e,n],2,!0)},l.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},l.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},l.prototype.getX=function(){return this.normalize(),this.x.fromRed()},l.prototype.getY=function(){return this.normalize(),this.y.fromRed()},l.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},l.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(t))return!0;for(var n=e.clone(),i=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(i),0===this.x.cmp(t))return!0}},l.prototype.toP=l.prototype.normalize,l.prototype.mixedAdd=l.prototype.add},function(e,t,n){"use strict";t.sha1=n(783),t.sha224=n(784),t.sha256=n(354),t.sha384=n(785),t.sha512=n(355)},function(e,t,n){"use strict";var i=n(48),s=n(122),r=n(353),o=i.rotl32,a=i.sum32,c=i.sum32_5,l=r.ft_1,u=s.BlockHash,d=[1518500249,1859775393,2400959708,3395469782];function h(){if(!(this instanceof h))return new h;u.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}i.inherits(h,u),e.exports=h,h.blockSize=512,h.outSize=160,h.hmacStrength=80,h.padLength=64,h.prototype._update=function(e,t){for(var n=this.W,i=0;i<16;i++)n[i]=e[t+i];for(;i<n.length;i++)n[i]=o(n[i-3]^n[i-8]^n[i-14]^n[i-16],1);var s=this.h[0],r=this.h[1],u=this.h[2],h=this.h[3],f=this.h[4];for(i=0;i<n.length;i++){var p=~~(i/20),m=c(o(s,5),l(p,r,u,h),f,n[i],d[p]);f=h,h=u,u=o(r,30),r=s,s=m}this.h[0]=a(this.h[0],s),this.h[1]=a(this.h[1],r),this.h[2]=a(this.h[2],u),this.h[3]=a(this.h[3],h),this.h[4]=a(this.h[4],f)},h.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},function(e,t,n){"use strict";var i=n(48),s=n(354);function r(){if(!(this instanceof r))return new r;s.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}i.inherits(r,s),e.exports=r,r.blockSize=512,r.outSize=224,r.hmacStrength=192,r.padLength=64,r.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h.slice(0,7),"big"):i.split32(this.h.slice(0,7),"big")}},function(e,t,n){"use strict";var i=n(48),s=n(355);function r(){if(!(this instanceof r))return new r;s.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}i.inherits(r,s),e.exports=r,r.blockSize=1024,r.outSize=384,r.hmacStrength=192,r.padLength=128,r.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h.slice(0,12),"big"):i.split32(this.h.slice(0,12),"big")}},function(e,t,n){"use strict";var i=n(48),s=n(122),r=i.rotl32,o=i.sum32,a=i.sum32_3,c=i.sum32_4,l=s.BlockHash;function u(){if(!(this instanceof u))return new u;l.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function d(e,t,n,i){return e<=15?t^n^i:e<=31?t&n|~t&i:e<=47?(t|~n)^i:e<=63?t&i|n&~i:t^(n|~i)}function h(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function f(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}i.inherits(u,l),t.ripemd160=u,u.blockSize=512,u.outSize=160,u.hmacStrength=192,u.padLength=64,u.prototype._update=function(e,t){for(var n=this.h[0],i=this.h[1],s=this.h[2],l=this.h[3],u=this.h[4],v=n,S=i,_=s,E=l,w=u,b=0;b<80;b++){var C=o(r(c(n,d(b,i,s,l),e[p[b]+t],h(b)),g[b]),u);n=u,u=l,l=r(s,10),s=i,i=C,C=o(r(c(v,d(79-b,S,_,E),e[m[b]+t],f(b)),y[b]),w),v=w,w=E,E=r(_,10),_=S,S=C}C=a(this.h[1],s,E),this.h[1]=a(this.h[2],l,w),this.h[2]=a(this.h[3],u,v),this.h[3]=a(this.h[4],n,S),this.h[4]=a(this.h[0],i,_),this.h[0]=C},u.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"little"):i.split32(this.h,"little")};var p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],m=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],g=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],y=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},function(e,t,n){"use strict";var i=n(48),s=n(38);function r(e,t,n){if(!(this instanceof r))return new r(e,t,n);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(i.toArray(t,n))}e.exports=r,r.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),s(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},r.prototype.update=function(e,t){return this.inner.update(e,t),this},r.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},function(e,t){e.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},function(e,t,n){"use strict";var i=n(25),s=n(790),r=n(39),o=n(212),a=n(209),c=r.assert,l=n(791),u=n(792);function d(e){if(!(this instanceof d))return new d(e);"string"==typeof e&&(c(Object.prototype.hasOwnProperty.call(o,e),"Unknown curve "+e),e=o[e]),e instanceof o.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}e.exports=d,d.prototype.keyPair=function(e){return new l(this,e)},d.prototype.keyFromPrivate=function(e,t){return l.fromPrivate(this,e,t)},d.prototype.keyFromPublic=function(e,t){return l.fromPublic(this,e,t)},d.prototype.genKeyPair=function(e){e||(e={});for(var t=new s({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||a(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),r=this.n.sub(new i(2));;){var o=new i(t.generate(n));if(!(o.cmp(r)>0))return o.iaddn(1),this.keyFromPrivate(o)}},d.prototype._truncateToN=function(e,t){var n=8*e.byteLength()-this.n.bitLength();return n>0&&(e=e.ushrn(n)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},d.prototype.sign=function(e,t,n,r){"object"==typeof n&&(r=n,n=null),r||(r={}),t=this.keyFromPrivate(t,n),e=this._truncateToN(new i(e,16));for(var o=this.n.byteLength(),a=t.getPrivate().toArray("be",o),c=e.toArray("be",o),l=new s({hash:this.hash,entropy:a,nonce:c,pers:r.pers,persEnc:r.persEnc||"utf8"}),d=this.n.sub(new i(1)),h=0;;h++){var f=r.k?r.k(h):new i(l.generate(this.n.byteLength()));if(!((f=this._truncateToN(f,!0)).cmpn(1)<=0||f.cmp(d)>=0)){var p=this.g.mul(f);if(!p.isInfinity()){var m=p.getX(),g=m.umod(this.n);if(0!==g.cmpn(0)){var y=f.invm(this.n).mul(g.mul(t.getPrivate()).iadd(e));if(0!==(y=y.umod(this.n)).cmpn(0)){var v=(p.getY().isOdd()?1:0)|(0!==m.cmp(g)?2:0);return r.canonical&&y.cmp(this.nh)>0&&(y=this.n.sub(y),v^=1),new u({r:g,s:y,recoveryParam:v})}}}}}},d.prototype.verify=function(e,t,n,s){e=this._truncateToN(new i(e,16)),n=this.keyFromPublic(n,s);var r=(t=new u(t,"hex")).r,o=t.s;if(r.cmpn(1)<0||r.cmp(this.n)>=0)return!1;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a,c=o.invm(this.n),l=c.mul(e).umod(this.n),d=c.mul(r).umod(this.n);return this.curve._maxwellTrick?!(a=this.g.jmulAdd(l,n.getPublic(),d)).isInfinity()&&a.eqXToP(r):!(a=this.g.mulAdd(l,n.getPublic(),d)).isInfinity()&&0===a.getX().umod(this.n).cmp(r)},d.prototype.recoverPubKey=function(e,t,n,s){c((3&n)===n,"The recovery param is more than two bits"),t=new u(t,s);var r=this.n,o=new i(e),a=t.r,l=t.s,d=1&n,h=n>>1;if(a.cmp(this.curve.p.umod(this.curve.n))>=0&&h)throw new Error("Unable to find sencond key candinate");a=h?this.curve.pointFromX(a.add(this.curve.n),d):this.curve.pointFromX(a,d);var f=t.r.invm(r),p=r.sub(o).mul(f).umod(r),m=l.mul(f).umod(r);return this.g.mulAdd(p,a,m)},d.prototype.getKeyRecoveryParam=function(e,t,n,i){if(null!==(t=new u(t,i)).recoveryParam)return t.recoveryParam;for(var s=0;s<4;s++){var r;try{r=this.recoverPubKey(e,t,s)}catch(e){continue}if(r.eq(n))return s}throw new Error("Unable to find valid recovery factor")}},function(e,t,n){"use strict";var i=n(213),s=n(351),r=n(38);function o(e){if(!(this instanceof o))return new o(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=s.toArray(e.entropy,e.entropyEnc||"hex"),n=s.toArray(e.nonce,e.nonceEnc||"hex"),i=s.toArray(e.pers,e.persEnc||"hex");r(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,n,i)}e.exports=o,o.prototype._init=function(e,t,n){var i=e.concat(t).concat(n);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(i),this._reseed=1,this.reseedInterval=281474976710656},o.prototype._hmac=function(){return new i.hmac(this.hash,this.K)},o.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},o.prototype.reseed=function(e,t,n,i){"string"!=typeof t&&(i=n,n=t,t=null),e=s.toArray(e,t),n=s.toArray(n,i),r(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(n||[])),this._reseed=1},o.prototype.generate=function(e,t,n,i){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof t&&(i=n,n=t,t=null),n&&(n=s.toArray(n,i||"hex"),this._update(n));for(var r=[];r.length<e;)this.V=this._hmac().update(this.V).digest(),r=r.concat(this.V);var o=r.slice(0,e);return this._update(n),this._reseed++,s.encode(o,t)}},function(e,t,n){"use strict";var i=n(25),s=n(39).assert;function r(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}e.exports=r,r.fromPublic=function(e,t,n){return t instanceof r?t:new r(e,{pub:t,pubEnc:n})},r.fromPrivate=function(e,t,n){return t instanceof r?t:new r(e,{priv:t,privEnc:n})},r.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},r.prototype.getPublic=function(e,t){return"string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub},r.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},r.prototype._importPrivate=function(e,t){this.priv=new i(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},r.prototype._importPublic=function(e,t){if(e.x||e.y)return"mont"===this.ec.curve.type?s(e.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||s(e.x&&e.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,t)},r.prototype.derive=function(e){return e.validate()||s(e.validate(),"public point not validated"),e.mul(this.priv).getX()},r.prototype.sign=function(e,t,n){return this.ec.sign(e,this,t,n)},r.prototype.verify=function(e,t){return this.ec.verify(e,t,this)},r.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},function(e,t,n){"use strict";var i=n(25),s=n(39),r=s.assert;function o(e,t){if(e instanceof o)return e;this._importDER(e,t)||(r(e.r&&e.s,"Signature without r or s"),this.r=new i(e.r,16),this.s=new i(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}function a(){this.place=0}function c(e,t){var n=e[t.place++];if(!(128&n))return n;var i=15&n;if(0===i||i>4)return!1;for(var s=0,r=0,o=t.place;r<i;r++,o++)s<<=8,s|=e[o],s>>>=0;return!(s<=127)&&(t.place=o,s)}function l(e){for(var t=0,n=e.length-1;!e[t]&&!(128&e[t+1])&&t<n;)t++;return 0===t?e:e.slice(t)}function u(e,t){if(t<128)e.push(t);else{var n=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|n);--n;)e.push(t>>>(n<<3)&255);e.push(t)}}e.exports=o,o.prototype._importDER=function(e,t){e=s.toArray(e,t);var n=new a;if(48!==e[n.place++])return!1;var r=c(e,n);if(!1===r)return!1;if(r+n.place!==e.length)return!1;if(2!==e[n.place++])return!1;var o=c(e,n);if(!1===o)return!1;var l=e.slice(n.place,o+n.place);if(n.place+=o,2!==e[n.place++])return!1;var u=c(e,n);if(!1===u)return!1;if(e.length!==u+n.place)return!1;var d=e.slice(n.place,u+n.place);if(0===l[0]){if(!(128&l[1]))return!1;l=l.slice(1)}if(0===d[0]){if(!(128&d[1]))return!1;d=d.slice(1)}return this.r=new i(l),this.s=new i(d),this.recoveryParam=null,!0},o.prototype.toDER=function(e){var t=this.r.toArray(),n=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&n[0]&&(n=[0].concat(n)),t=l(t),n=l(n);!(n[0]||128&n[1]);)n=n.slice(1);var i=[2];u(i,t.length),(i=i.concat(t)).push(2),u(i,n.length);var r=i.concat(n),o=[48];return u(o,r.length),o=o.concat(r),s.encode(o,e)}},function(e,t,n){"use strict";var i=n(213),s=n(212),r=n(39),o=r.assert,a=r.parseBytes,c=n(794),l=n(795);function u(e){if(o("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof u))return new u(e);e=s[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=i.sha512}e.exports=u,u.prototype.sign=function(e,t){e=a(e);var n=this.keyFromSecret(t),i=this.hashInt(n.messagePrefix(),e),s=this.g.mul(i),r=this.encodePoint(s),o=this.hashInt(r,n.pubBytes(),e).mul(n.priv()),c=i.add(o).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:r})},u.prototype.verify=function(e,t,n){e=a(e),t=this.makeSignature(t);var i=this.keyFromPublic(n),s=this.hashInt(t.Rencoded(),i.pubBytes(),e),r=this.g.mul(t.S());return t.R().add(i.pub().mul(s)).eq(r)},u.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return r.intFromLE(e.digest()).umod(this.curve.n)},u.prototype.keyFromPublic=function(e){return c.fromPublic(this,e)},u.prototype.keyFromSecret=function(e){return c.fromSecret(this,e)},u.prototype.makeSignature=function(e){return e instanceof l?e:new l(this,e)},u.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},u.prototype.decodePoint=function(e){var t=(e=r.parseBytes(e)).length-1,n=e.slice(0,t).concat(-129&e[t]),i=0!=(128&e[t]),s=r.intFromLE(n);return this.curve.pointFromY(s,i)},u.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},u.prototype.decodeInt=function(e){return r.intFromLE(e)},u.prototype.isPoint=function(e){return e instanceof this.pointClass}},function(e,t,n){"use strict";var i=n(39),s=i.assert,r=i.parseBytes,o=i.cachedProperty;function a(e,t){this.eddsa=e,this._secret=r(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=r(t.pub)}a.fromPublic=function(e,t){return t instanceof a?t:new a(e,{pub:t})},a.fromSecret=function(e,t){return t instanceof a?t:new a(e,{secret:t})},a.prototype.secret=function(){return this._secret},o(a,"pubBytes",(function(){return this.eddsa.encodePoint(this.pub())})),o(a,"pub",(function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())})),o(a,"privBytes",(function(){var e=this.eddsa,t=this.hash(),n=e.encodingLength-1,i=t.slice(0,e.encodingLength);return i[0]&=248,i[n]&=127,i[n]|=64,i})),o(a,"priv",(function(){return this.eddsa.decodeInt(this.privBytes())})),o(a,"hash",(function(){return this.eddsa.hash().update(this.secret()).digest()})),o(a,"messagePrefix",(function(){return this.hash().slice(this.eddsa.encodingLength)})),a.prototype.sign=function(e){return s(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},a.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},a.prototype.getSecret=function(e){return s(this._secret,"KeyPair is public only"),i.encode(this.secret(),e)},a.prototype.getPublic=function(e){return i.encode(this.pubBytes(),e)},e.exports=a},function(e,t,n){"use strict";var i=n(25),s=n(39),r=s.assert,o=s.cachedProperty,a=s.parseBytes;function c(e,t){this.eddsa=e,"object"!=typeof t&&(t=a(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),r(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof i&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}o(c,"S",(function(){return this.eddsa.decodeInt(this.Sencoded())})),o(c,"R",(function(){return this.eddsa.decodePoint(this.Rencoded())})),o(c,"Rencoded",(function(){return this.eddsa.encodePoint(this.R())})),o(c,"Sencoded",(function(){return this.eddsa.encodeInt(this.S())})),c.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},c.prototype.toHex=function(){return s.encode(this.toBytes(),"hex").toUpperCase()},e.exports=c},function(e,t,n){"use strict";var i=n(123);t.certificate=n(806);var s=i.define("RSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())}));t.RSAPrivateKey=s;var r=i.define("RSAPublicKey",(function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}));t.RSAPublicKey=r;var o=i.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(a),this.key("subjectPublicKey").bitstr())}));t.PublicKey=o;var a=i.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())})),c=i.define("PrivateKeyInfo",(function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(a),this.key("subjectPrivateKey").octstr())}));t.PrivateKey=c;var l=i.define("EncryptedPrivateKeyInfo",(function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())}));t.EncryptedPrivateKey=l;var u=i.define("DSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())}));t.DSAPrivateKey=u,t.DSAparam=i.define("DSAparam",(function(){this.int()}));var d=i.define("ECPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(h),this.key("publicKey").optional().explicit(1).bitstr())}));t.ECPrivateKey=d;var h=i.define("ECParameters",(function(){this.choice({namedCurve:this.objid()})}));t.signature=i.define("signature",(function(){this.seq().obj(this.key("r").int(),this.key("s").int())}))},function(e,t,n){var i=n(123),s=n(12);function r(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}t.define=function(e,t){return new r(e,t)},r.prototype._createNamed=function(e){var t;try{t=n(798).runInThisContext("(function "+this.name+"(entity) {\n  this._initNamed(entity);\n})")}catch(e){t=function(e){this._initNamed(e)}}return s(t,e),t.prototype._initNamed=function(t){e.call(this,t)},new t(this)},r.prototype._getDecoder=function(e){return e=e||"der",this.decoders.hasOwnProperty(e)||(this.decoders[e]=this._createNamed(i.decoders[e])),this.decoders[e]},r.prototype.decode=function(e,t,n){return this._getDecoder(t).decode(e,n)},r.prototype._getEncoder=function(e){return e=e||"der",this.encoders.hasOwnProperty(e)||(this.encoders[e]=this._createNamed(i.encoders[e])),this.encoders[e]},r.prototype.encode=function(e,t,n){return this._getEncoder(t).encode(e,n)}},function(module,exports){var indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},Object_keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)t.push(n);return t},forEach=function(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n++)t(e[n],n,e)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(e,t,n){Object.defineProperty(e,t,{writable:!0,enumerable:!1,configurable:!0,value:n})}}catch(e){return function(e,t,n){e[t]=n}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(e){if(!(this instanceof Script))return new Script(e);this.code=e};Script.prototype.runInContext=function(e){if(!(e instanceof Context))throw new TypeError("needs a 'context' argument.");var t=document.createElement("iframe");t.style||(t.style={}),t.style.display="none",document.body.appendChild(t);var n=t.contentWindow,i=n.eval,s=n.execScript;!i&&s&&(s.call(n,"null"),i=n.eval),forEach(Object_keys(e),(function(t){n[t]=e[t]})),forEach(globals,(function(t){e[t]&&(n[t]=e[t])}));var r=Object_keys(n),o=i.call(n,this.code);return forEach(Object_keys(n),(function(t){(t in e||-1===indexOf(r,t))&&(e[t]=n[t])})),forEach(globals,(function(t){t in e||defineProp(e,t,n[t])})),document.body.removeChild(t),o},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(e){var t=Script.createContext(e),n=this.runInContext(t);return e&&forEach(Object_keys(t),(function(n){e[n]=t[n]})),n},forEach(Object_keys(Script.prototype),(function(e){exports[e]=Script[e]=function(t){var n=Script(t);return n[e].apply(n,[].slice.call(arguments,1))}})),exports.isContext=function(e){return e instanceof Context},exports.createScript=function(e){return exports.Script(e)},exports.createContext=Script.createContext=function(e){var t=new Context;return"object"==typeof e&&forEach(Object_keys(e),(function(n){t[n]=e[n]})),t}},function(e,t,n){var i=n(12);function s(e){this._reporterState={obj:null,path:[],options:e||{},errors:[]}}function r(e,t){this.path=e,this.rethrow(t)}t.Reporter=s,s.prototype.isError=function(e){return e instanceof r},s.prototype.save=function(){var e=this._reporterState;return{obj:e.obj,pathLen:e.path.length}},s.prototype.restore=function(e){var t=this._reporterState;t.obj=e.obj,t.path=t.path.slice(0,e.pathLen)},s.prototype.enterKey=function(e){return this._reporterState.path.push(e)},s.prototype.exitKey=function(e){var t=this._reporterState;t.path=t.path.slice(0,e-1)},s.prototype.leaveKey=function(e,t,n){var i=this._reporterState;this.exitKey(e),null!==i.obj&&(i.obj[t]=n)},s.prototype.path=function(){return this._reporterState.path.join("/")},s.prototype.enterObject=function(){var e=this._reporterState,t=e.obj;return e.obj={},t},s.prototype.leaveObject=function(e){var t=this._reporterState,n=t.obj;return t.obj=e,n},s.prototype.error=function(e){var t,n=this._reporterState,i=e instanceof r;if(t=i?e:new r(n.path.map((function(e){return"["+JSON.stringify(e)+"]"})).join(""),e.message||e,e.stack),!n.options.partial)throw t;return i||n.errors.push(t),t},s.prototype.wrapResult=function(e){var t=this._reporterState;return t.options.partial?{result:this.isError(e)?null:e,errors:t.errors}:e},i(r,Error),r.prototype.rethrow=function(e){if(this.message=e+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,r),!this.stack)try{throw new Error(this.message)}catch(e){this.stack=e.stack}return this}},function(e,t,n){var i=n(124).Reporter,s=n(124).EncoderBuffer,r=n(124).DecoderBuffer,o=n(38),a=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],c=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(a);function l(e,t){var n={};this._baseState=n,n.enc=e,n.parent=t||null,n.children=null,n.tag=null,n.args=null,n.reverseArgs=null,n.choice=null,n.optional=!1,n.any=!1,n.obj=!1,n.use=null,n.useDecoder=null,n.key=null,n.default=null,n.explicit=null,n.implicit=null,n.contains=null,n.parent||(n.children=[],this._wrap())}e.exports=l;var u=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];l.prototype.clone=function(){var e=this._baseState,t={};u.forEach((function(n){t[n]=e[n]}));var n=new this.constructor(t.parent);return n._baseState=t,n},l.prototype._wrap=function(){var e=this._baseState;c.forEach((function(t){this[t]=function(){var n=new this.constructor(this);return e.children.push(n),n[t].apply(n,arguments)}}),this)},l.prototype._init=function(e){var t=this._baseState;o(null===t.parent),e.call(this),t.children=t.children.filter((function(e){return e._baseState.parent===this}),this),o.equal(t.children.length,1,"Root node can have only one child")},l.prototype._useArgs=function(e){var t=this._baseState,n=e.filter((function(e){return e instanceof this.constructor}),this);e=e.filter((function(e){return!(e instanceof this.constructor)}),this),0!==n.length&&(o(null===t.children),t.children=n,n.forEach((function(e){e._baseState.parent=this}),this)),0!==e.length&&(o(null===t.args),t.args=e,t.reverseArgs=e.map((function(e){if("object"!=typeof e||e.constructor!==Object)return e;var t={};return Object.keys(e).forEach((function(n){n==(0|n)&&(n|=0);var i=e[n];t[i]=n})),t})))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach((function(e){l.prototype[e]=function(){var t=this._baseState;throw new Error(e+" not implemented for encoding: "+t.enc)}})),a.forEach((function(e){l.prototype[e]=function(){var t=this._baseState,n=Array.prototype.slice.call(arguments);return o(null===t.tag),t.tag=e,this._useArgs(n),this}})),l.prototype.use=function(e){o(e);var t=this._baseState;return o(null===t.use),t.use=e,this},l.prototype.optional=function(){return this._baseState.optional=!0,this},l.prototype.def=function(e){var t=this._baseState;return o(null===t.default),t.default=e,t.optional=!0,this},l.prototype.explicit=function(e){var t=this._baseState;return o(null===t.explicit&&null===t.implicit),t.explicit=e,this},l.prototype.implicit=function(e){var t=this._baseState;return o(null===t.explicit&&null===t.implicit),t.implicit=e,this},l.prototype.obj=function(){var e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},l.prototype.key=function(e){var t=this._baseState;return o(null===t.key),t.key=e,this},l.prototype.any=function(){return this._baseState.any=!0,this},l.prototype.choice=function(e){var t=this._baseState;return o(null===t.choice),t.choice=e,this._useArgs(Object.keys(e).map((function(t){return e[t]}))),this},l.prototype.contains=function(e){var t=this._baseState;return o(null===t.use),t.contains=e,this},l.prototype._decode=function(e,t){var n=this._baseState;if(null===n.parent)return e.wrapResult(n.children[0]._decode(e,t));var i,s=n.default,o=!0,a=null;if(null!==n.key&&(a=e.enterKey(n.key)),n.optional){var c=null;if(null!==n.explicit?c=n.explicit:null!==n.implicit?c=n.implicit:null!==n.tag&&(c=n.tag),null!==c||n.any){if(o=this._peekTag(e,c,n.any),e.isError(o))return o}else{var l=e.save();try{null===n.choice?this._decodeGeneric(n.tag,e,t):this._decodeChoice(e,t),o=!0}catch(e){o=!1}e.restore(l)}}if(n.obj&&o&&(i=e.enterObject()),o){if(null!==n.explicit){var u=this._decodeTag(e,n.explicit);if(e.isError(u))return u;e=u}var d=e.offset;if(null===n.use&&null===n.choice){if(n.any)l=e.save();var h=this._decodeTag(e,null!==n.implicit?n.implicit:n.tag,n.any);if(e.isError(h))return h;n.any?s=e.raw(l):e=h}if(t&&t.track&&null!==n.tag&&t.track(e.path(),d,e.length,"tagged"),t&&t.track&&null!==n.tag&&t.track(e.path(),e.offset,e.length,"content"),s=n.any?s:null===n.choice?this._decodeGeneric(n.tag,e,t):this._decodeChoice(e,t),e.isError(s))return s;if(n.any||null!==n.choice||null===n.children||n.children.forEach((function(n){n._decode(e,t)})),n.contains&&("octstr"===n.tag||"bitstr"===n.tag)){var f=new r(s);s=this._getUse(n.contains,e._reporterState.obj)._decode(f,t)}}return n.obj&&o&&(s=e.leaveObject(i)),null===n.key||null===s&&!0!==o?null!==a&&e.exitKey(a):e.leaveKey(a,n.key,s),s},l.prototype._decodeGeneric=function(e,t,n){var i=this._baseState;return"seq"===e||"set"===e?null:"seqof"===e||"setof"===e?this._decodeList(t,e,i.args[0],n):/str$/.test(e)?this._decodeStr(t,e,n):"objid"===e&&i.args?this._decodeObjid(t,i.args[0],i.args[1],n):"objid"===e?this._decodeObjid(t,null,null,n):"gentime"===e||"utctime"===e?this._decodeTime(t,e,n):"null_"===e?this._decodeNull(t,n):"bool"===e?this._decodeBool(t,n):"objDesc"===e?this._decodeStr(t,e,n):"int"===e||"enum"===e?this._decodeInt(t,i.args&&i.args[0],n):null!==i.use?this._getUse(i.use,t._reporterState.obj)._decode(t,n):t.error("unknown tag: "+e)},l.prototype._getUse=function(e,t){var n=this._baseState;return n.useDecoder=this._use(e,t),o(null===n.useDecoder._baseState.parent),n.useDecoder=n.useDecoder._baseState.children[0],n.implicit!==n.useDecoder._baseState.implicit&&(n.useDecoder=n.useDecoder.clone(),n.useDecoder._baseState.implicit=n.implicit),n.useDecoder},l.prototype._decodeChoice=function(e,t){var n=this._baseState,i=null,s=!1;return Object.keys(n.choice).some((function(r){var o=e.save(),a=n.choice[r];try{var c=a._decode(e,t);if(e.isError(c))return!1;i={type:r,value:c},s=!0}catch(t){return e.restore(o),!1}return!0}),this),s?i:e.error("Choice not matched")},l.prototype._createEncoderBuffer=function(e){return new s(e,this.reporter)},l.prototype._encode=function(e,t,n){var i=this._baseState;if(null===i.default||i.default!==e){var s=this._encodeValue(e,t,n);if(void 0!==s&&!this._skipDefault(s,t,n))return s}},l.prototype._encodeValue=function(e,t,n){var s=this._baseState;if(null===s.parent)return s.children[0]._encode(e,t||new i);var r=null;if(this.reporter=t,s.optional&&void 0===e){if(null===s.default)return;e=s.default}var o=null,a=!1;if(s.any)r=this._createEncoderBuffer(e);else if(s.choice)r=this._encodeChoice(e,t);else if(s.contains)o=this._getUse(s.contains,n)._encode(e,t),a=!0;else if(s.children)o=s.children.map((function(n){if("null_"===n._baseState.tag)return n._encode(null,t,e);if(null===n._baseState.key)return t.error("Child should have a key");var i=t.enterKey(n._baseState.key);if("object"!=typeof e)return t.error("Child expected, but input is not object");var s=n._encode(e[n._baseState.key],t,e);return t.leaveKey(i),s}),this).filter((function(e){return e})),o=this._createEncoderBuffer(o);else if("seqof"===s.tag||"setof"===s.tag){if(!s.args||1!==s.args.length)return t.error("Too many args for : "+s.tag);if(!Array.isArray(e))return t.error("seqof/setof, but data is not Array");var c=this.clone();c._baseState.implicit=null,o=this._createEncoderBuffer(e.map((function(n){var i=this._baseState;return this._getUse(i.args[0],e)._encode(n,t)}),c))}else null!==s.use?r=this._getUse(s.use,n)._encode(e,t):(o=this._encodePrimitive(s.tag,e),a=!0);if(!s.any&&null===s.choice){var l=null!==s.implicit?s.implicit:s.tag,u=null===s.implicit?"universal":"context";null===l?null===s.use&&t.error("Tag could be omitted only for .use()"):null===s.use&&(r=this._encodeComposite(l,a,u,o))}return null!==s.explicit&&(r=this._encodeComposite(s.explicit,!1,"context",r)),r},l.prototype._encodeChoice=function(e,t){var n=this._baseState,i=n.choice[e.type];return i||o(!1,e.type+" not found in "+JSON.stringify(Object.keys(n.choice))),i._encode(e.value,t)},l.prototype._encodePrimitive=function(e,t){var n=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&n.args)return this._encodeObjid(t,n.reverseArgs[0],n.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,n.args&&n.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);if("objDesc"===e)return this._encodeStr(t,e);throw new Error("Unsupported tag: "+e)},l.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},l.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(e)}},function(e,t,n){var i=n(357);t.tagClass={0:"universal",1:"application",2:"context",3:"private"},t.tagClassByName=i._reverse(t.tagClass),t.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},t.tagByName=i._reverse(t.tag)},function(e,t,n){var i=t;i.der=n(358),i.pem=n(803)},function(e,t,n){var i=n(12),s=n(3).Buffer,r=n(358);function o(e){r.call(this,e),this.enc="pem"}i(o,r),e.exports=o,o.prototype.decode=function(e,t){for(var n=e.toString().split(/[\r\n]+/g),i=t.label.toUpperCase(),o=/^-----(BEGIN|END) ([^-]+)-----$/,a=-1,c=-1,l=0;l<n.length;l++){var u=n[l].match(o);if(null!==u&&u[2]===i){if(-1!==a){if("END"!==u[1])break;c=l;break}if("BEGIN"!==u[1])break;a=l}}if(-1===a||-1===c)throw new Error("PEM section not found for: "+i);var d=n.slice(a+1,c).join("");d.replace(/[^a-z0-9\+\/=]+/gi,"");var h=new s(d,"base64");return r.prototype.decode.call(this,h,t)}},function(e,t,n){var i=t;i.der=n(359),i.pem=n(805)},function(e,t,n){var i=n(12),s=n(359);function r(e){s.call(this,e),this.enc="pem"}i(r,s),e.exports=r,r.prototype.encode=function(e,t){for(var n=s.prototype.encode.call(this,e).toString("base64"),i=["-----BEGIN "+t.label+"-----"],r=0;r<n.length;r+=64)i.push(n.slice(r,r+64));return i.push("-----END "+t.label+"-----"),i.join("\n")}},function(e,t,n){"use strict";var i=n(123),s=i.define("Time",(function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})})),r=i.define("AttributeTypeValue",(function(){this.seq().obj(this.key("type").objid(),this.key("value").any())})),o=i.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())})),a=i.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(o),this.key("subjectPublicKey").bitstr())})),c=i.define("RelativeDistinguishedName",(function(){this.setof(r)})),l=i.define("RDNSequence",(function(){this.seqof(c)})),u=i.define("Name",(function(){this.choice({rdnSequence:this.use(l)})})),d=i.define("Validity",(function(){this.seq().obj(this.key("notBefore").use(s),this.key("notAfter").use(s))})),h=i.define("Extension",(function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())})),f=i.define("TBSCertificate",(function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(o),this.key("issuer").use(u),this.key("validity").use(d),this.key("subject").use(u),this.key("subjectPublicKeyInfo").use(a),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(h).optional())})),p=i.define("X509Certificate",(function(){this.seq().obj(this.key("tbsCertificate").use(f),this.key("signatureAlgorithm").use(o),this.key("signatureValue").bitstr())}));e.exports=p},function(e){e.exports=JSON.parse('{"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}')},function(e,t,n){var i=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r\+\/\=]+)[\n\r]+/m,s=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,r=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r\+\/\=]+)-----END \1-----$/m,o=n(155),a=n(206),c=n(14).Buffer;e.exports=function(e,t){var n,l=e.toString(),u=l.match(i);if(u){var d="aes"+u[1],h=c.from(u[2],"hex"),f=c.from(u[3].replace(/[\r\n]/g,""),"base64"),p=o(t,h.slice(0,8),parseInt(u[1],10)).key,m=[],g=a.createDecipheriv(d,p,h);m.push(g.update(f)),m.push(g.final()),n=c.concat(m)}else{var y=l.match(r);n=new c(y[2].replace(/[\r\n]/g,""),"base64")}return{tag:l.match(s)[1],data:n}}},function(e,t,n){(function(t){var i=n(25),s=n(211).ec,r=n(157),o=n(360);function a(e,t){if(e.cmpn(0)<=0)throw new Error("invalid sig");if(e.cmp(t)>=t)throw new Error("invalid sig")}e.exports=function(e,n,c,l,u){var d=r(c);if("ec"===d.type){if("ecdsa"!==l&&"ecdsa/rsa"!==l)throw new Error("wrong public key type");return function(e,t,n){var i=o[n.data.algorithm.curve.join(".")];if(!i)throw new Error("unknown curve "+n.data.algorithm.curve.join("."));var r=new s(i),a=n.data.subjectPrivateKey.data;return r.verify(t,e,a)}(e,n,d)}if("dsa"===d.type){if("dsa"!==l)throw new Error("wrong public key type");return function(e,t,n){var s=n.data.p,o=n.data.q,c=n.data.g,l=n.data.pub_key,u=r.signature.decode(e,"der"),d=u.s,h=u.r;a(d,o),a(h,o);var f=i.mont(s),p=d.invm(o);return 0===c.toRed(f).redPow(new i(t).mul(p).mod(o)).fromRed().mul(l.toRed(f).redPow(h.mul(p).mod(o)).fromRed()).mod(s).mod(o).cmp(h)}(e,n,d)}if("rsa"!==l&&"ecdsa/rsa"!==l)throw new Error("wrong public key type");n=t.concat([u,n]);for(var h=d.modulus.byteLength(),f=[1],p=0;n.length+f.length+2<h;)f.push(255),p++;f.push(0);for(var m=-1;++m<n.length;)f.push(n[m]);f=new t(f);var g=i.mont(d.modulus);e=(e=new i(e).toRed(g)).redPow(new i(d.publicExponent)),e=new t(e.fromRed().toArray());var y=p<8?1:0;for(h=Math.min(e.length,f.length),e.length!==f.length&&(y=1),m=-1;++m<h;)y|=e[m]^f[m];return 0===y}}).call(this,n(3).Buffer)},function(e,t,n){(function(t){var i=n(211),s=n(25);e.exports=function(e){return new o(e)};var r={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function o(e){this.curveType=r[e],this.curveType||(this.curveType={name:e}),this.curve=new i.ec(this.curveType.name),this.keys=void 0}function a(e,n,i){Array.isArray(e)||(e=e.toArray());var s=new t(e);if(i&&s.length<i){var r=new t(i-s.length);r.fill(0),s=t.concat([r,s])}return n?s.toString(n):s}r.p224=r.secp224r1,r.p256=r.secp256r1=r.prime256v1,r.p192=r.secp192r1=r.prime192v1,r.p384=r.secp384r1,r.p521=r.secp521r1,o.prototype.generateKeys=function(e,t){return this.keys=this.curve.genKeyPair(),this.getPublicKey(e,t)},o.prototype.computeSecret=function(e,n,i){return n=n||"utf8",t.isBuffer(e)||(e=new t(e,n)),a(this.curve.keyFromPublic(e).getPublic().mul(this.keys.getPrivate()).getX(),i,this.curveType.byteLength)},o.prototype.getPublicKey=function(e,t){var n=this.keys.getPublic("compressed"===t,!0);return"hybrid"===t&&(n[n.length-1]%2?n[0]=7:n[0]=6),a(n,e)},o.prototype.getPrivateKey=function(e){return a(this.keys.getPrivate(),e)},o.prototype.setPublicKey=function(e,n){return n=n||"utf8",t.isBuffer(e)||(e=new t(e,n)),this.keys._importPublic(e),this},o.prototype.setPrivateKey=function(e,n){n=n||"utf8",t.isBuffer(e)||(e=new t(e,n));var i=new s(e);return i=i.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(i),this}}).call(this,n(3).Buffer)},function(e,t,n){t.publicEncrypt=n(812),t.privateDecrypt=n(813),t.privateEncrypt=function(e,n){return t.publicEncrypt(e,n,!0)},t.publicDecrypt=function(e,n){return t.privateDecrypt(e,n,!0)}},function(e,t,n){var i=n(157),s=n(75),r=n(118),o=n(361),a=n(362),c=n(25),l=n(363),u=n(210),d=n(14).Buffer;e.exports=function(e,t,n){var h;h=e.padding?e.padding:n?1:4;var f,p=i(e);if(4===h)f=function(e,t){var n=e.modulus.byteLength(),i=t.length,l=r("sha1").update(d.alloc(0)).digest(),u=l.length,h=2*u;if(i>n-h-2)throw new Error("message too long");var f=d.alloc(n-i-h-2),p=n-u-1,m=s(u),g=a(d.concat([l,f,d.alloc(1,1),t],p),o(m,p)),y=a(m,o(g,u));return new c(d.concat([d.alloc(1),y,g],n))}(p,t);else if(1===h)f=function(e,t,n){var i,r=t.length,o=e.modulus.byteLength();if(r>o-11)throw new Error("message too long");i=n?d.alloc(o-r-3,255):function(e){var t,n=d.allocUnsafe(e),i=0,r=s(2*e),o=0;for(;i<e;)o===r.length&&(r=s(2*e),o=0),(t=r[o++])&&(n[i++]=t);return n}(o-r-3);return new c(d.concat([d.from([0,n?1:2]),i,d.alloc(1),t],o))}(p,t,n);else{if(3!==h)throw new Error("unknown padding");if((f=new c(t)).cmp(p.modulus)>=0)throw new Error("data too long for modulus")}return n?u(f,p):l(f,p)}},function(e,t,n){var i=n(157),s=n(361),r=n(362),o=n(25),a=n(210),c=n(118),l=n(363),u=n(14).Buffer;e.exports=function(e,t,n){var d;d=e.padding?e.padding:n?1:4;var h,f=i(e),p=f.modulus.byteLength();if(t.length>p||new o(t).cmp(f.modulus)>=0)throw new Error("decryption error");h=n?l(new o(t),f):a(t,f);var m=u.alloc(p-h.length);if(h=u.concat([m,h],p),4===d)return function(e,t){var n=e.modulus.byteLength(),i=c("sha1").update(u.alloc(0)).digest(),o=i.length;if(0!==t[0])throw new Error("decryption error");var a=t.slice(1,o+1),l=t.slice(o+1),d=r(a,s(l,o)),h=r(l,s(d,n-o-1));if(function(e,t){e=u.from(e),t=u.from(t);var n=0,i=e.length;e.length!==t.length&&(n++,i=Math.min(e.length,t.length));var s=-1;for(;++s<i;)n+=e[s]^t[s];return n}(i,h.slice(0,o)))throw new Error("decryption error");var f=o;for(;0===h[f];)f++;if(1!==h[f++])throw new Error("decryption error");return h.slice(f)}(f,h);if(1===d)return function(e,t,n){var i=t.slice(0,2),s=2,r=0;for(;0!==t[s++];)if(s>=t.length){r++;break}var o=t.slice(2,s-1);("0002"!==i.toString("hex")&&!n||"0001"!==i.toString("hex")&&n)&&r++;o.length<8&&r++;if(r)throw new Error("decryption error");return t.slice(s)}(0,h,n);if(3===d)return h;throw new Error("unknown padding")}},function(e,t,n){"use strict";(function(e,i){function s(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}var r=n(14),o=n(75),a=r.Buffer,c=r.kMaxLength,l=e.crypto||e.msCrypto,u=Math.pow(2,32)-1;function d(e,t){if("number"!=typeof e||e!=e)throw new TypeError("offset must be a number");if(e>u||e<0)throw new TypeError("offset must be a uint32");if(e>c||e>t)throw new RangeError("offset out of range")}function h(e,t,n){if("number"!=typeof e||e!=e)throw new TypeError("size must be a number");if(e>u||e<0)throw new TypeError("size must be a uint32");if(e+t>n||e>c)throw new RangeError("buffer too small")}function f(e,t,n,s){if(i.browser){var r=e.buffer,a=new Uint8Array(r,t,n);return l.getRandomValues(a),s?void i.nextTick((function(){s(null,e)})):e}if(!s)return o(n).copy(e,t),e;o(n,(function(n,i){if(n)return s(n);i.copy(e,t),s(null,e)}))}l&&l.getRandomValues||!i.browser?(t.randomFill=function(t,n,i,s){if(!(a.isBuffer(t)||t instanceof e.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if("function"==typeof n)s=n,n=0,i=t.length;else if("function"==typeof i)s=i,i=t.length-n;else if("function"!=typeof s)throw new TypeError('"cb" argument must be a function');return d(n,t.length),h(i,n,t.length),f(t,n,i,s)},t.randomFillSync=function(t,n,i){void 0===n&&(n=0);if(!(a.isBuffer(t)||t instanceof e.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');d(n,t.length),void 0===i&&(i=t.length-n);return h(i,n,t.length),f(t,n,i)}):(t.randomFill=s,t.randomFillSync=s)}).call(this,n(27),n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(66),s=n(197),r=n(198);t.createClientSocketTransport=function(e,t="utf-8"){let n,o=new Promise((e,t)=>{n=e});return new Promise((a,c)=>{let l=i.createServer(e=>{l.close(),n([new s.SocketMessageReader(e,t),new r.SocketMessageWriter(e,t)])});l.on("error",c),l.listen(e,"127.0.0.1",()=>{l.removeListener("error",c),a({onConnected:()=>o})})})},t.createServerSocketTransport=function(e,t="utf-8"){const n=i.createConnection(e,"127.0.0.1");return[new s.SocketMessageReader(n,t),new r.SocketMessageWriter(n,t)]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(817);t.withRetriesDecorator=i.withRetriesDecorator;var s=n(821);t.withHelperDecorator=s.withHelperDecorator},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(158),s=n(365),r=n(78);t.withRetriesDecorator=(e={})=>(t,n,o)=>{const{value:a}=o;r.assert(a instanceof Function,"This decorator works only on methods"),i.assertDefined(a,`The method "${n}" is not defined.`);return o.value=async function(...t){return await s.withRetries(async e=>await a.call(this,...t,e),e)},o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(125);class s extends i.BaseError{constructor(){super(...arguments),this.errorType="AggregateError",this.errorsReference=[]}get errors(){return[...this.errorsReference]}addErrors(...e){return this.errorsReference.push(...e),this}cloneWithErrors(...e){const t=new s;return t.addErrors(...this.errors,...e),t}get lastError(){const e=this.errorsReference.length-1;return this.errorsReference[e]}}t.AggregateError=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(91);class s extends i.BaseError{constructor(){super(...arguments),this.errorType="NotImplementedError"}}t.NotImplementedError=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(91);class s extends i.BaseError{constructor(){super(...arguments),this.errorType="AuthenticationError"}}t.AuthenticationError=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(158),s=n(78),r=new Map;t.withHelperDecorator=function(e,t){return function(n,o,a){const{value:c}=a;return s.assert(c instanceof Function,"This decorator works only on methods"),i.assertDefined(c,`The method "${o}" is not defined.`),a.value=async function(...n){const s=((e,t,n,s)=>{const o=r.get(s);if(o){const t=o.get(e);if(t)return t}else r.set(s,new Map);const a=t(e.bind(s),n),c=r.get(s);return i.assertDefined(c,"No helpers found."),c.set(e,a),a})(c,e,t,this);return await s.call(this,...n)},a}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(823);t.assertInstance=i.assertInstance;var s=n(158);t.assertDefined=s.assertDefined;var r=n(824);t.assertNever=r.assertNever;var o=n(78);t.assert=o.assert},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(78);t.assertInstance=(e,t,n)=>i.assert(e instanceof t,n)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(125);t.assertNever=(e,t)=>{throw"string"==typeof t?new i.AssertionError(t):t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.once=e=>{const t=Symbol();let n;return(...i)=>(e[t]||(e[t]=!0,n=e(...i)),n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onlyOnce=function e(t,...n){const i=Symbol();let s,r,o=0;return function(...a){if(0===a.length&&(a=n),t[i]){if(!function(e,t){if(!Array.isArray(e)||!Array.isArray(t))return!1;if(e===t)return!0;const n=Math.min(e.length,t.length);for(var i=0;i<n;i++)if(e[i]!==t[i])return!1;const s=e.length>n?e:t;for(i=n;i<s.length;i++)if(void 0!==s[i])return!1;return!0}(s,a))throw new Error(`Parameters must be the same as in the first call of ${e.name}(${t.name}).`)}else{let e;o++;try{if(e=t(...a),o>1)return e}finally{o--}t[i]=!0,s=a,r=e}return r}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(369),s=n(366);t.raceAsync=e=>{const t=new i.Signal,n=[];let r=e.length;return e.forEach(e=>{e.then(e=>{t.resolve(e)}).catch(e=>{r--,n.push(e),0===r&&t.reject(new s.PromiseRaceError(n,e))})}),t.promise}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8),s=n(215);t.DisposableClass=class{constructor(e){this.traceReference=e,this.disposablesReference=[],this.isDisposedReference=!1,this.onDisposeEmitter=new i.Emitter,this.onDisposeEvent=this.onDisposeEmitter.event,this.disposeObject=(e,t)=>{this.trace.verbose("disposing the object",t,e);try{e.dispose(t)}catch(n){this.trace.warning("Error from disposable",e,t,n)}finally{this.removeFromDisposables(e)}},this.removeFromDisposables=e=>{const t=this.disposablesReference.indexOf(e);return t<0||this.disposablesReference.splice(t,1),this},this.dispose=this.dispose.bind(this),this.onDispose=this.onDispose.bind(this)}get disposables(){return[...this.disposablesReference]}get trace(){return this.traceReference}get isDisposed(){return this.isDisposedReference}dispose(e){if(this.trace.verbose("disposing self"),this.isDisposed)return this.trace.verbose("already disposed"),this;this.isDisposedReference=!0;const t=()=>{var t;return e?"function"==typeof e?`${null===(t=e.constructor)||void 0===t?void 0:t.name}-${JSON.stringify(e)}`:String(e):"n/a"};try{const e=t();this.trace.verbose(`disposing reason: '${e}', disposing ${this.disposables.length} objects`),this.disposables.forEach((t,n)=>{if(t){if(!t.isDisposed)return this.disposeObject(t,`${e} $${n}`)}else this.trace.warning("disposable is not set in the disposables object")}),this.disposablesReference.length=0}catch(e){this.trace.warning("error while disposing an object",e)}return this.onDisposeEmitter.fire(this),this.onDisposeEmitter.dispose(),this}addToDisposables(...e){for(const t of e){if(s.assertDefined(t,"Disposable must be defined."),"onDispose"in t){const e=t.onDispose(()=>{this.disposeObject(e),this.removeFromDisposables(t)})}"dispose"in t&&this.disposablesReference.push(t)}return this}onDispose(e,t){return this.isDisposed?(this.trace.verbose("already disposed, calling callback immediately"),e.call(t,this),{dispose:()=>{}}):(this.trace.verbose("subscribing to onDispose event"),this.onDisposeEvent(e.bind(t,this)))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Mutex=class{constructor(){this.mutex=Promise.resolve()}async dispatch(e){const t=await this.lock();try{return await Promise.resolve(e())}finally{t()}}lock(){let e=e=>{};return this.mutex=this.mutex.then(()=>new Promise(e)),new Promise(t=>{e=t})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CallbackContainer=class{constructor(){this.callbacks=[]}clear(){this.callbacks.length=0}get items(){return this.callbacks}add(e){return e&&this.callbacks.push(e),{dispose:()=>{if(!e)return;const t=this.callbacks.indexOf(e);-1!==t&&this.callbacks.splice(t,1)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(158),s=n(216),r=n(217);t.withCache=e=>{let t;return async(...n)=>(t&&!t.isFulfilled||(t=new s.Signal,r.defer(async()=>{i.assertDefined(t,"No running signal is defined.");try{const i=await e(...n);t.resolve(i)}catch(e){t.reject(e)}},1)),await t.promise)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(216),s=n(370),r=n(217),o=(...e)=>e.map(e=>s.hashString(`${e}`)).join("::"),a={serializeArguments:o};t.withMutexByArguments=(e,t=a)=>{const n=new Map;return async(...s)=>{const{serializeArguments:a=o}=t,c=a(...s),l=n.get(c);if(l&&!l.isFulfilled)return await l.promise;const u=new i.Signal;return n.set(c,u),r.defer(async()=>{try{const t=await e(...s);u.resolve(t)}catch(e){u.reject(e)}finally{n.delete(c)}},1),await u.promise}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.idFunction=(...e)=>e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(371);t.connectEvents=(e,...t)=>{const n=t.map(t=>t(e.fire.bind(e)));return i.createDisposable(()=>{for(const e of n)null==e||e.dispose()})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(78);t.randomInt=(e,t=0)=>{i.assert(e>t,"the `max` param should be greater than the `min`"),i.assert(!isNaN(t),"the `min` is not a number"),i.assert(!isNaN(e),"the `max` is not a number");const n=(e-t)*Math.random();return Math.round(t+n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(373);t.randomString=(e=16,t="hex")=>i.randomBytes(e).toString(t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=(e,t)=>{let n;const i=(...i)=>{clearInterval(n),n=setInterval(()=>{e(...i)},t)};return i.stop=()=>{clearInterval(n)},i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=function(e,t){let n;return function(...i){if(n)return;const{interval:s}=t;return n=setTimeout(()=>{n&&(clearInterval(n),n=void 0)},s),e.call(this,...i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayUnique=e=>[...new Set(e)]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isThenable=e=>null!=e&&"function"==typeof e.then},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(367);t.timeoutPromise=async(e,t,n,s)=>{let r,o;const a=()=>{null==o||o.dispose(),clearTimeout(r)};return await Promise.race([e.finally(()=>{a()}),new Promise((e,c)=>{o=null==s?void 0:s.token.onCancellationRequested(()=>{a(),c(new i.CancellationError)}),r=setTimeout(()=>{a();const e=null!=n?n:new Error(`Promise rejected after ${t}ms.`);c(e)},t)})])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(374);t.errorToString=(e,t=!1)=>JSON.stringify(i.errorToObject(e,t),null,2)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notImplemented=function(){throw new Error("Method not implemented.")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDisposable=function(e,t){return{dispose:n=>(null==t||t.verbose(`Disposing reason:${n}`),e(n))}},t.createDisposablesAll=function(e,...t){return{dispose:n=>(null==e||e.verbose(`createDisposablesAll->dispose reason:${n}`),Promise.all(t.map(e=>e.dispose(n))))}},t.createDisposablesSeries=function(e,...t){return{dispose:async n=>{null==e||e.verbose(`createDisposablesSeries->dispose reason:${n}`);for(let i of t)try{await i.dispose(n)}catch(t){null==e||e.error("Failed to dispose",t)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promiseAny=async e=>Promise.all([...e].map(e=>new Promise((t,n)=>Promise.resolve(e).then(n,t)))).then(e=>Promise.reject(e),e=>Promise.resolve(e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toCamelCase=function(e){return e&&e.length>0?e.substring(0,1).toLowerCase()+e.substring(1):e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(19);!function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(848)),t.globalTrace=new i.TraceSource("vscs")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TIME_SECOND_MS=1e3,t.TIME_MINUTE_MS=60*t.TIME_SECOND_MS,t.TIME_HOUR_MS=60*t.TIME_MINUTE_MS,t.TIME_DAY_MS=24*t.TIME_HOUR_MS},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(850);t.DisposableClassMock=i.DisposableClassMock},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(19);t.DisposableClassMock=class{constructor(){this.trace=new i.TraceSource("test-logger"),this.addToDisposables=e=>this,this.isDisposed=!1,this.onDispose=(e,t)=>({dispose:()=>{}}),this.dispose=()=>this}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(376),s=n(214),r=n(218),o=n(6);class a extends s.RpcClientProxyBase{constructor(e,t){super(t),this.rpcClient=e}ensureConnectionAsync(){return this.rpcClient.ensureConnectionAsync()}}class c extends r.RpcServiceHandler{constructor(e,t){super(t),this.connectionFactory=e,this.connection=null,this.connectionFactoryMutex=new o.Mutex,this.rpcClientProxy=new a(this,t),e.dispose&&this.addToDisposables(e)}static fromRpcMessageStream(e,t,n){return new c({create:async n=>{const i=await e(),s=n.createRpcConnection(i,t);return s.listen(),s},dispose:()=>{n&&n()}},t)}sendRequest(e,t,n,i,...s){return this.rpcClientProxy.sendRequest(e,t,n,i,...s)}sendNotification(e,t,n){return this.rpcClientProxy.sendNotification(e,t,n)}async onConnect(e){await this.ensureConnectionAsync(),e()}async onClose(e){await this.ensureConnectionAsync(),this.connection.onClose(e)}async ensureConnectionInternal(){this.connection||await this.connectionFactoryMutex.dispatch(async()=>{this.connection||this.setConnection(await this.connectionFactory.create(this))})}async ensureConnectionAsync(){return await this.ensureConnectionInternal(),this.connection}setConnection(e){this.connection=e,e&&(this.attachConnection(e),this.addToDisposables(e))}attachConnection(e){e.onClose(()=>{this.trace.info(`RPC connection closed. disposed: "${this.isDisposed}"`),this.isDisposed||this.dispose(new i.RpcConnectionClosedError)}),e.onRequest((t,...n)=>this.onRequest(null,e,t,...n)),e.onNotification((t,...n)=>{this.onNotification(e,t,...n)})}}t.RpcClient=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(19),s=n(218),r=n(377),o=n(126);class a extends s.RpcServiceHandler{constructor(e,t){super(e),this.rpcSessionNumber=0,this.rpcConnections=[];this.notifyEventProvider=t||((t,n)=>{o.notifyConnections(this.rpcConnections,t,n,e)})}registerRemoteRpcService(e,t){this.trace.info(`adding remote rpc service:${e}`);const n=e+".";t.onNotification((e,...t)=>{e.startsWith(n)&&this.notifyEventProvider(e,t)});const i=this.onHandleNoneRequest(async(e,i,...s)=>{if(i.startsWith(n))return await r.sendRpcRequest(t,i,s,this.trace)});return t.onClose(()=>i.dispose()),t.onDispose(()=>i.dispose()),i}sendNotification(e,t,n){return this.notifyEventProvider(t,n),Promise.resolve()}acceptRpcMessageStream(e){const t=this.createRpcConnection(e,this.trace);return[t,this.attachConnection(t)]}attachConnection(e){this.rpcConnections.push(e);const t=++this.rpcSessionNumber;this.trace.verbose(`Rpc #${t} created`),e.onRequest((n,...s)=>this.onRequest(async(s,...r)=>{const o={connection:e,session:t};r.push(o);const a=await Promise.resolve(s(...r)),c=i.LoggerSettings.disableObfuscation?` => ${JSON.stringify(a)}`:"";return this.trace.verbose(`> #${t} ${n}()${c}`),a},e,n,...s)),e.onNotification((t,...n)=>{this.onNotification(e,t,...n)});const n=n=>{const i=this.rpcConnections.indexOf(e);-1!==i&&(this.trace.verbose(`Rpc #${t} removed event:${n}`),this.rpcConnections.splice(i,1))};return e.onClose(e=>{n("closed")}),e.onDispose(e=>{n("disposed")}),t}}t.RpcServer=a},function(e,t,n){"use strict";(function(e){var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(8));t.RpcMessageWriter=class{constructor(){this.onErrorEmitter=new s.Emitter,this.onCloseEmitter=new s.Emitter,this.onError=this.onErrorEmitter.event,this.onClose=this.onCloseEmitter.event}write(t){const n=JSON.stringify(t),i=e.from(n),s=e.from("Content-Length: "+i.length+"\r\n\r\n"),r=e.alloc(s.length+i.length);s.copy(r,0),i.copy(r,s.length),this.onSendCallback&&this.onSendCallback(r).catch(e=>{this.onErrorEmitter.fire([e,void 0,void 0])})}dispose(){}}}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Default="default"]="Default",e[e.Email="email"]="Email",e[e.Token="token"]="Token",e[e.Path="path"]="Path",e[e.Text="text"]="Text",e[e.Uri="uri"]="Uri",e[e.Omit="omit"]="Omit",e[e.OmitDefault="omitDefault"]="OmitDefault",e[e.Hide="hide"]="Hide",e[e.SingleMember="singleMember"]="SingleMember"}(t.DataFormat||(t.DataFormat={})),t.dataFormat=function(...e){return(t,n)=>{t.constructor.dataFormat||(t.constructor.dataFormat={}),t.constructor.dataFormat[n]=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(326);t.RpcProxyCache=class{constructor(e,t){this.clientProxy=e,this.logger=t,this.proxyMap=new Map}getOrCreate(e,t){let n=this.proxyMap.get(e.name);return n||(this.logger.info(`Creating proxy for ${e.name} service`),n=i.RpcProxy.create(e,this.clientProxy,t?this.logger.withName(t):this.logger),this.proxyMap.set(e.name,n)),n}}},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(8)),r=n(24);t.createDuplexRpcMessageStreams=function(){const e=new o,t=new a(e),n=new o,i=new a(n),r=new s.StreamMessageReader(e),c=new s.StreamMessageWriter(t),l=new s.StreamMessageReader(n);return[{reader:r,writer:new s.StreamMessageWriter(i)},{reader:l,writer:c}]};class o extends r.EventEmitter{}class a extends r.EventEmitter{constructor(e){super(),this.readableStream=e}write(e,t,n){return this.readableStream.emit("data",e),!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(117),s=n(219),r=n(127),o=n(858),a=n(864),c=n(865),l=n(866),u=n(867),d=n(220),h=n(868),f=n(9),p=n(869),m=n(382);class g{constructor(e){r.setExtensionContext(e.extensionContext),e.telemetry&&f.Telemetry.init(p.telemetryReporterFactory.create(e.extensionPackage),e.telemetry.featureName||"vscode-vsls-command.",e.telemetry.canSendSensistiveInformation,e.telemetry.faultSendCallbackParam)}async initLogging(e,t){t.logFileEnabled&&m.setLogLocation(t.logFilePath||s.join(i.tmpdir(),`${e.name}_logs`)),this.loggingUtil=new a.LoggingUtil(e.displayName,t),await this.loggingUtil.initLogging()}registerCommand(e,t,n={}){return o.commandRegistry.register(e,t,n),this}get clientLogsLocation(){return m.getLogLocation()}async getLastClientLogs(e){if(null!=m.getLogLocation()){const t=m.getLogLocation();return await h.getLastFiles(t,e)}return[]}getLogs(e){return this.loggingUtil.getLogs(e)}setDiagnosticLogging(e,t){this.loggingUtil.setDiagnosticLogging(e,t)}}let y;t.vslsCommands={isFirstActivation:l.isFirstActivation,isExtensionBeingUpdated:l.isExtensionBeingUpdated,get API(){return d.throwNotInitialized(y)},get abTester(){return d.throwNotInitialized(t.abTester)},get packageJSON(){return u.getPackageJSON()},async initialize(e){if(y)return y;y=new g(e),e.logging&&await y.initLogging(e.extensionPackage,e.logging),t.abTester=new c.ABTester(e.extensionContext.globalState,await l.isFirstActivation(e.extensionPackage)&&!await l.isExtensionBeingUpdated())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(128),s=n(859),r=n(159),o=n(9);class a{constructor(){this.disposables={},this.trace=i.traceSource.withName("CommandRegistry")}register(e,t,i={}){const a=new t,c=n(0).commands.registerCommand;this.disposables[e]=c(e,async(t={})=>{try{const n=s.CommandContextBuilder.build(a,e),r=Object.assign(Object.assign({},i),t);return await a.invoke(r,n)}catch(e){if(e&&!e.hasRecorded){const t=`Unhandled exception (command): ${e.message}`;this.trace.error(t),o.Telemetry.sendFault(r.TelemetryEventNames.UNHANDLED_COMMAND_ERROR_FAULT,o.FaultType.Error,t,e)}}})}dispose(e){const t=this.disposables[e];t&&t.dispose&&t.dispose()}disposeAll(){for(const e in this.disposables)e&&this.dispose(e)}}t.CommandRegistryProvider=a,t.commandRegistry=new a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(128);class s{constructor(){}build(e,t){return{trace:i.traceSource.withName(this.buildTrace(e)),commandText:t,commandName:""}}buildTrace(e){let t="";return e&&e.constructor&&e.constructor.name&&(t=e.constructor.name,t=t.replace("CommandDecorator","")),`Command:${t}`}}t.CommandContextBuilderClass=s,t.CommandContextBuilder=new s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(49),s=n(19),r=n(380),o=n(221),a=n(8),c=n(381);let l=0;class u{constructor(){this.telemetryEvents={},this.filters=[],this.canSendSensitiveFlag=!1}get reporter(){return this.telemetryReporter}get canSendSensitiveInformation(){return this.canSendSensitiveFlag}init(e,t,n,s){this.telemetryReporter=e,this.canSendSensitiveFlag=n,o.TelemetryPropertyNames.FEATURE_NAME=t||"",s&&(h=s),this.contextProperties={},this.addContextProperty(o.TelemetryPropertyNames.SESSION_ID,i())}addFilter(e){this.filters.push(e)}removeFilter(e){const t=this.filters.indexOf(e);t>=0&&this.filters.splice(t,1)}addContextProperties(e,t=!1){for(const[n,i]of Object.entries(e))this.addContextProperty(n,i,t);return this}addContextProperty(e,t,n=!1){if(void 0===t)return this;const i=String(t);return n&&!this.canSendSensitiveInformation?this.contextProperties[e]=s.Privacy.getShortHash(i):this.contextProperties[e]=i,this}removeContextProperty(e){delete this.contextProperties[e]}getContextProperty(e){return this.contextProperties[e]}addContextPropertiesToObject(e){return Object.assign({},this.contextProperties,e)}filterAndSendTelemetryEvent(e,t,n,i){if(!this.reporter)return;const s=Object.assign({},i),r=this.addContextPropertiesToObject(n);for(const t of this.filters)if(!t.shouldSend(e,r,s))return;s[o.TelemetryPropertyNames.SEQUENCE_NUMBER]=(l+=1,l),t(r,s)}sendTelemetryEvent(e,t,n){this.filterAndSendTelemetryEvent(e,(t,n)=>this.reporter.sendTelemetryEvent(e,t,n),t,n)}sendTelemetryErrorEvent(e,t,n,i){this.filterAndSendTelemetryEvent(e,(t,n)=>this.reporter.sendTelemetryErrorEvent(e,t,n,i),t,n)}sendFault(e,t,n,i,s){new p(e,t,n,i,s).send()}startTimedEvent(e,t=!1){const n=new m(e,t);return this.telemetryEvents[n.id]=n,n}setCorrelationEvent(e){this.correlationEvent=e}removeCorrelationEvent(e){this.correlationEvent===e&&(this.correlationEvent=void 0)}correlate(e){this.correlationEvent&&e.correlateWith(this.correlationEvent)}async endAllPendingEvents(){for(let e of Object.keys(this.telemetryEvents)){const t=this.telemetryEvents[e];await t.endIfNotSent(),delete this.telemetryEvents[e]}}async dispose(){await this.reporter.dispose()}}t.TelemetryClass=u;const d=new u;let h;t.Telemetry=d;class f{constructor(e,t=!1){this.isSent=!1,this.id=i(),this.eventName=e,this.properties={},this.measures={},this.correlationId=i(),t&&d.correlate(this)}static create(e,t){const n=!!t&&!!t.correlate,i=new f(e,n);return t.properties&&Object.keys(t.properties).forEach(e=>i.addProperty(o.TelemetryPropertyNames.FEATURE_NAME+e,t.properties[e])),t.measures&&Object.keys(t.measures).forEach(e=>i.addMeasure(o.TelemetryPropertyNames.FEATURE_NAME+e,t.measures[e])),i}addProperty(e,t,n=!1,i=!1){if(void 0===t)return this;const r=String(t);return n&&!d.canSendSensitiveInformation?this.properties[e]=s.Privacy.getHash(r,i):this.properties[e]=r,this}addProperties(e,t=!0){for(let[n,i]of Object.entries(e))this.addProperty(n,i,t);return this}addPropertyIfNotExists(e,t,n=!1,i=!1){return this.propertyExists(e)||this.addProperty(e,t,n,i),this}propertyExists(e){return e in this.properties}addMeasure(e,t){this.measures[e]=t}addMeasureIfNotExists(e,t){void 0===this.measures[e]&&this.addMeasure(e,t)}getCorrelationId(){return this.correlationId}correlateWith(e){return this.correlationId=e.getCorrelationId(),this}correlateWithId(e){return this.correlationId=e,this}addCommonProperties(){this.addProperty(o.TelemetryPropertyNames.EVENT_ID,this.id),this.addProperty(o.TelemetryPropertyNames.CORRELATION_ID,this.correlationId)}send(){this.addCommonProperties(),d.sendTelemetryEvent(this.eventName,this.properties,this.measures),this.isSent=!0}sendAsError(e){this.addCommonProperties(),d.sendTelemetryErrorEvent(this.eventName,this.properties,this.measures,e),this.isSent=!0}}t.TelemetryEvent=f;class p extends f{constructor(e,t,n,i,c){super(e),this.exception=i,this.addProperty(o.TelemetryPropertyNames.FAULT_TYPE,r.FaultType[t]),n&&this.addProperty(o.TelemetryPropertyNames.EVENT_MESSAGE,g(n));let l="";i&&i instanceof a.ResponseError&&(i.code&&"number"==typeof i.code&&this.addMeasure(o.TelemetryPropertyNames.EVENT_EXCEPTION_CODE,i.code),i.data&&"string"==typeof i.data&&(l+=g(i.data)+"\n   --- End of remote exception stack trace ---\n")),i&&i.stack&&"string"==typeof i.stack&&(l+=g(s.errorToString(i))),l||(l="No Stack"),this.addProperty(o.TelemetryPropertyNames.EVENT_EXCEPTION_STACK,l),c&&this.correlateWith(c)}async send(){let e=[];return h&&(e=await h(this)),super.sendAsError([...e,o.TelemetryPropertyNames.EVENT_MESSAGE,o.TelemetryPropertyNames.EVENT_EXCEPTION_STACK])}}t.Fault=p;class m extends f{constructor(e,t=!1,n=!1){if(super(e,t),this.startTime=(new Date).getTime(),this.lastMarkTime=this.startTime,m.scopeStack.push(this),this.addProperty(o.TelemetryPropertyNames.EVENT_CREATION_TIME,(new Date).toISOString()),this.addProperty(o.TelemetryPropertyNames.EVENT_TYPE,o.TelemetryPropertyValues.END),n){const t=new f(e);t.correlateWith(this),t.addProperty(o.TelemetryPropertyNames.EVENT_TYPE,o.TelemetryPropertyValues.START),t.send()}}markTime(e,t=!1){let n=(new Date).getTime(),i=t?n-this.startTime:n-this.lastMarkTime;return this.lastMarkTime=n,this.addMeasure(e,i),i}end(e,t,n=!0){this.addProperty(o.TelemetryPropertyNames.EVENT_RESULT,c.Result[e]),t&&this.addProperty(o.TelemetryPropertyNames.EVENT_MESSAGE,g(t));const i=this.markTime(o.TelemetryPropertyNames.EVENT_DURATION,!0);d.removeCorrelationEvent(this),n&&this.send();for(let e=m.scopeStack.length-1;e>=0;e--)m.scopeStack[e]===this&&m.scopeStack.splice(e,1);return i}async endIfNotSent(){this.isSent||await this.end(c.Result.Cancel,"Completing pending telemetry events.")}}function g(e){return e?function(e){return e.replace(/[\S]+@[\S]+/gi,"[EMAIL]")}(function(e,t=""){return e.replace(/([A-Za-z]:)?(\S*[\\\/])+\S*/gi,(e,n,i,s,r)=>{if(/^\d{1,4}\/\d{1,2}\/\d{1,4}$/.test(e))return e;{const s=(n?n.length:0)+i.length,r=e.substr(s);return t+r}})}(e,"[PATH]/")):e}t.TimedEvent=m,m.scopeStack=[],t.cleanSensitiveInformation=g,t.propagateOffsetMarkTime=(e,t)=>{for(let n=0;n<m.scopeStack.length;n++){const i=m.scopeStack[n];i!==t&&i.markTime(e)}}},function(e,t,n){var i,s,r=n(378),o=n(379),a=0,c=0;e.exports=function(e,t,n){var l=t&&n||0,u=t||[],d=(e=e||{}).node||i,h=void 0!==e.clockseq?e.clockseq:s;if(null==d||null==h){var f=r();null==d&&(d=i=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==h&&(h=s=16383&(f[6]<<8|f[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:c+1,g=p-a+(m-c)/1e4;if(g<0&&void 0===e.clockseq&&(h=h+1&16383),(g<0||p>a)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=p,c=m,s=h;var y=(1e4*(268435455&(p+=122192928e5))+m)%4294967296;u[l++]=y>>>24&255,u[l++]=y>>>16&255,u[l++]=y>>>8&255,u[l++]=255&y;var v=p/4294967296*1e4&268435455;u[l++]=v>>>8&255,u[l++]=255&v,u[l++]=v>>>24&15|16,u[l++]=v>>>16&255,u[l++]=h>>>8|128,u[l++]=255&h;for(var S=0;S<6;++S)u[l+S]=d[S];return t||o(u)}},function(e,t,n){var i=n(378),s=n(379);e.exports=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||i)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[r+a]=o[a];return t||s(o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(221);t.SendOnceFilter=class{constructor(e,t=[]){this.eventName=e,this.distinctProperties=t,this.sentEventsProperties=[]}shouldSend(e,t,n){if(e===this.eventName){for(const e of this.sentEventsProperties)if(this.propertySubsetsEqual(t,e))return!1;this.sentEventsProperties.push(this.createPropertySubset(t))}return!0}reset(){this.sentEventsProperties=[]}createPropertySubset(e){const t={};for(const n of this.distinctProperties)t[n]=e[n];return t}propertySubsetsEqual(e,t){for(const n of this.distinctProperties)if(e[n]!==t[n])return!1;return!0}};t.SamplingFilter=class{constructor(e){this.samplingConfig=e}shouldSend(e,t,n){if(!e)return!0;const s=this.samplingConfig[e];if("number"==typeof s&&!isNaN(s)){if(0===s||Math.random()*s>1)return!1;n[i.TelemetryPropertyNames.SAMPLE_RATE]=s}return!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(19),s=n(128),r=n(382);t.LoggingUtil=class{constructor(e,t={}){this.displayName=e,this.loggingOptions=t;const n=this.loggingOptions.outputChannelName||this.displayName;this.outputTraceListener=new i.OutputTraceListener(n,this.loggingOptions.outputChannelTimestamp),this.memoryTraceListener=new i.MemoryTraceListener(t.logMaxSize)}getLogs(e){return this.memoryTraceListener.getLogs(e)}async initLogging(){s.traceSource.addTraceListener(this.memoryTraceListener),s.traceSource.addTraceListener(this.outputTraceListener),this.loggingOptions.diagnosticsLogging&&this.setDiagnosticLogging(this.loggingOptions.diagnosticsLogging.enable,this.loggingOptions.diagnosticsLogging.focus),this.loggingOptions.logFileEnabled&&(this.logFileTraceListener=await r.createLogFileListener(),this.logFileTraceListener&&s.traceSource.addTraceListener(this.logFileTraceListener)),this.setLoggingFilters(this.loggingOptions.logLevel,this.loggingOptions.filters,this.loggingOptions.traceFilter),this.loggingOptions.obfuscateProperties&&Object.entries(this.loggingOptions.obfuscateProperties).forEach(e=>{i.LoggerSettings.obfuscateProperties[e[0]]=e[1]})}setLoggingFilters(e,t={},n){const s=new i.TraceFilters([new i.VerbosityTraceFilter(e?i.LogLevel[e]:void 0),new i.GlobPatternTraceFilter(t)]);n&&s.filters.push(n),this.outputTraceListener.filter=s,this.logFileTraceListener&&(this.logFileTraceListener.filter=s)}async setDiagnosticLogging(e=!0,t=!1){e?this.outputTraceListener.addOutputChannel(t):this.outputTraceListener.removeOutputChannel()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(9),s=n(159),r={shouldAllowConcurrentExperiments:!1},o="vscode-vsls-commands-ab-tests";t.ABTester=class{constructor(e,t){this.settingsStorage=e,this.isFirstInitialization=t}async initialize(e){this.options=e;const{settingsStorage:t,abTests:n,isFirstInitialization:i}=e;if(this.settingsStorage=t||this.settingsStorage,this.isFirstInitialization=null!=i?i:this.isFirstInitialization,!this.settingsStorage.get(o)){const e={currentTests:{},evaluatedTests:{}};await this.settingsStorage.update(o,e)}for(let e=0;e<n.length;e++)n[e]=Object.assign(Object.assign({},r),n[e]);await this.initializeTests(),await this.addTelemetry()}async addTelemetry(){const e=await this.isPartOfAnyExperiment();i.Telemetry.addContextProperty(s.TelemetryPropertyNames.CURRENT_AB_EXPERIMENT,e),i.Telemetry.addContextProperty(s.TelemetryPropertyNames.COUNT_OF_CONCURRENT_AB_EXPERIMENTS,await this.getCountOfCurrentExperiments()),i.Telemetry.addContextProperty(s.TelemetryPropertyNames.CURRENT_AB_EXPERIMENT_GROUP,await this.isPartOfExperiment(e))}async initializeTests(){for(let e of this.options.abTests)await this.isPartOfAnyExperiment()&&!e.shouldAllowConcurrentExperiments||await this.initializeTest(e)}cleanUpOldTest(e){const t=this.settingsStorage.get(o);t.evaluatedTests[e.name]&&delete t.evaluatedTests[e.name],t.currentTests[e.name]&&delete t.currentTests[e.name],this.settingsStorage.update(o,t)}async initializeTest(e){const{enabledTests:t}=this.options,n=t[e.name];if(n||this.cleanUpOldTest(e),e.shouldStartOnFirstRunOnly&&!this.isFirstInitialization)return;const i=this.settingsStorage.get(o),s=!await this.isPartOfAnyExperiment(),r=!i.evaluatedTests[e.name];if(s&&r&&n){const t=this.initializeGroupForTest(e,i);t&&(i.currentTests[e.name]={currentGroup:t}),this.settingsStorage.update(o,i)}}initializeGroupForTest(e,t){const n=Math.random();let i=0;for(let t of e.groups){let e=i+t.probability;if(n>i&&n<=e)return;i=e}t.evaluatedTests[e.name]=!0}async isPartOfExperiment(e){if(!e)return null;const t=this.settingsStorage.get(o).currentTests[e];return t?t.currentGroup:null}async isPartOfAnyExperiment(){const e=this.settingsStorage.get(o);return Object.keys(e.currentTests)[0]||null}async getCountOfCurrentExperiments(){const e=this.settingsStorage.get(o);return Object.keys(e.currentTests).length}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(219),s=n(129),r=n(222),o=n(159),a=n(127),c=n(220),l=n(9),u=(e,t)=>{const{source:n,name:o}=t,a=i.join(n,o),c=r.loadJSON(i.resolve(e,"./package.json"));return!!s.fileAccess.lstatSync(a).isDirectory()&&new RegExp(`^${c.publisher}\\.${c.name}-[0-9]`).test(o)},d=async()=>{c.throwNotInitialized(a.extensionContext);const e=a.extensionContext.extensionPath;return(await s.fileAccess.readdirAsync(e)).map(t=>({source:e,name:t})).filter(u.bind(null,e))};t.isExtensionBeingUpdated=async()=>{try{return(await d()).length>1}catch(e){return!1}},t.isFirstActivation=async e=>{c.throwNotInitialized(a.extensionContext);const{globalState:t}=a.extensionContext,n=`${e.name}-first-activation-flag`;let i=!1;return t.get(n)||(await t.update(n,e.version),i=!0),l.Telemetry.addContextProperty(o.TelemetryPropertyNames.IS_FIRST_ACTIVATION,i),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(219),s=n(222),r=n(127);let o;t.getPackageJSON=()=>{if(o)return o;const e=i.join(r.extensionContext.extensionPath,"./package.json");return o=s.loadJSON(e),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLastFiles=function(e,t){throw new Error("not implemented")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(870);t.telemetryReporterFactory=i.sharedTelemetryFactory},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sharedTelemetryFactory={create:e=>{const t=n(871).default,i=e,{name:s,version:r,aiKey:o}=i;if(!o)throw new Error("The `aiKey` property needs to be set in the `package.json`.");const a=new t(s,r,o);return{sendTelemetryEvent:(e,t,n)=>{a.sendTelemetryEvent(e,t,n)},sendTelemetryErrorEvent:(e,t,n,i)=>{a.sendTelemetryErrorEvent(e,t,n,i)},dispose:()=>a.dispose()}}}},function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"default",(function(){return Ho}));var i=n(0),s=Object.defineProperty,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,c=(e,t,n)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,l=(e,t)=>{for(var n in t||(t={}))o.call(t,n)&&c(e,n,t[n]);if(r)for(var n of r(t))a.call(t,n)&&c(e,n,t[n]);return e},u=2,d="function",h="object",f="undefined",p="prototype",m="hasOwnProperty",g=Object,y=g[p],v=g.assign,S=g.create,_=g.defineProperty,E=y[m];function w(){return typeof globalThis!==f&&globalThis?globalThis:typeof self!==f&&self?self:typeof window!==f&&window?window:typeof e!==f&&e?e:null}function b(e){throw new TypeError(e)}function C(e){if(S)return S(e);if(null==e)return{};var t=typeof e;function n(){}return t!==h&&t!==d&&b("Object prototype may only be an Object:"+e),n[p]=e,new n}(w()||{}).Symbol,(w()||{}).Reflect;var T=v||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])y[m].call(t,s)&&(e[s]=t[s]);return e},M=function(e,t){return(M=g.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[m](n)&&(e[n]=t[n])})(e,t)};function A(e,t){function n(){this.constructor=e}typeof t!==d&&null!==t&&b("Class extends value "+String(t)+" is not a constructor or null"),M(e,t),e[p]=null===t?C(t):(n[p]=t[p],new n)}var k="constructor",R="prototype",P="function",I="_dynInstFuncs",N="_isDynProxy",L="_dynClass",D="_dynInstChk",x=D,O="_dfOpts",F="_unknown_",U="useBaseInst",j="setInstFuncs",H=Object,B=H.getPrototypeOf,Y=0;function W(e,t){return e&&H[R].hasOwnProperty.call(e,t)}function q(e){return e&&(e===H[R]||e===Array[R])}function V(e){return q(e)||e===Function[R]}function $(e){if(e){if(B)return B(e);var t=e.__proto__||e[R]||(e[k]?e[k][R]:null);if(t)return t}return null}function K(e,t){var n=[],i=H.getOwnPropertyNames;if(i)n=i(e);else for(var s in e)"string"==typeof s&&W(e,s)&&n.push(s);if(n&&n.length>0)for(var r=0;r<n.length;r++)t(n[r])}function z(e,t,n){return t!==k&&typeof e[t]===P&&(n||W(e,t))}function G(e){throw new TypeError("DynamicProto: "+e)}function J(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function X(e,t,n,i){var s=null;if(e&&W(n,L)){var r=e[I]||{};if((s=(r[n[L]]||{})[t])||G("Missing ["+t+"] "+P),!s[D]&&!1!==r[x]){for(var o=!W(e,t),a=$(e),c=[];o&&a&&!V(a)&&!J(c,a);){var l=a[t];if(l){o=l===i;break}c.push(a),a=$(a)}try{o&&(e[t]=s),s[D]=1}catch(e){r[x]=!1}}}return s}function Z(e,t,n){var i=t[e];return i===n&&(i=$(t)[e]),typeof i!==P&&G("["+e+"] is not a "+P),i}function Q(e,t,n,i,s){if(!q(e)){var r=n[I]=n[I]||{},o=r[t]=r[t]||{};!1!==r[x]&&(r[x]=!!s),K(n,(function(t){z(n,t,!1)&&n[t]!==i[t]&&(o[t]=n[t],delete n[t],(!W(e,t)||e[t]&&!e[t][N])&&(e[t]=function(e,t){var n=function(){var i=X(this,t,e,n)||Z(t,e,n);return i.apply(this,arguments)};return n[N]=1,n}(e,t)))}))}}function ee(e,t){return W(e,R)?e.name||t||F:((e||{})[k]||{}).name||t||F}function te(e,t,n,i){W(e,R)||G("theClass is an invalid class definition.");var s=e[R];(function(e,t){if(B)for(var n=[],i=$(t);i&&!V(i)&&!J(n,i);){if(i===e)return!0;n.push(i),i=$(i)}return!1})(s,t)||G("["+ee(e)+"] is not in class hierarchy of ["+ee(t)+"]");var r=null;W(s,L)?r=s[L]:(r="_dynCls$"+ee(e,"_")+"$"+Y,Y++,s[L]=r);var o=te[O],a=!!o[U];a&&i&&void 0!==i[U]&&(a=!!i[U]);var c=function(e){var t={};return K(e,(function(n){!t[n]&&z(e,n,!1)&&(t[n]=e[n])})),t}(t);n(t,function(e,t,n,i){function s(e,t,n){var s=t[n];if(s[N]&&i){var r=e[I]||{};!1!==r[x]&&(s=(r[t[L]]||{})[n]||s)}return function(){return s.apply(e,arguments)}}var r={};K(n,(function(e){r[e]=s(t,n,e)}));for(var o=$(e),a=[];o&&!V(o)&&!J(a,o);)K(o,(function(e){!r[e]&&z(o,e,!B)&&(r[e]=s(t,o,e))})),a.push(o),o=$(o);return r}(s,t,c,a));var l=!!B&&!!o[j];l&&i&&(l=!!i[j]),Q(s,r,t,c,!1!==l)}te[O]={setInstFuncs:!0,useBaseInst:!0};var ne,ie,se=te;(ie=ne||(ne={}))[ie.CRITICAL=1]="CRITICAL",ie[ie.WARNING=2]="WARNING";var re=0,oe=1,ae=2,ce=3,le=4,ue=5,de=6,he=7,fe=8,pe=9,me=10,ge=11,ye=12,ve=13,Se=14,_e=15,Ee=16,we=17,be=18,Ce=19,Te=20,Me=22,Ae=23,ke=24,Re=25,Pe=26,Ie=27,Ne=28,Le=29,De=30,xe=31,Oe=32,Fe=33,Ue=35,je=36,He=37,Be=38,Ye=39,We=40,qe=41,Ve=42,$e=43,Ke=45,ze=46,Ge=47,Je=48,Xe=49,Ze=50,Qe=52,et=54,tt=55,nt=56,it=57,st=58,rt=60,ot=61,at=62,ct=63,lt=64,ut=66,dt=67,ht=68,ft=69,pt=70,mt=71,gt=72,yt=73,vt=74,St=100,_t="attachEvent",Et="addEventListener",wt="detachEvent",bt="removeEventListener",Ct=_;g.freeze,g.seal;function Tt(e){return y.toString.call(e)}function Mt(e){return void 0===e||typeof e===f}function At(e){return null===e||Mt(e)}function kt(e){return!At(e)}function Rt(e,t){return e&&E.call(e,t)}function Pt(e){return typeof e===h}function It(e){return typeof e===d}function Nt(e,t,n,i){void 0===i&&(i=!1);var s=!1;if(!At(e))try{At(e[Et])?At(e[_t])||(e[_t]("on"+t,n),s=!0):(e[Et](t,n,i),s=!0)}catch(e){}return s}function Lt(e,t,n,i){if(void 0===i&&(i=!1),!At(e))try{At(e[bt])?At(e[wt])||e[wt]("on"+t,n):e[bt](t,n,i)}catch(e){}}function Dt(e,t){if(e)for(var n in e)E.call(e,n)&&t.call(e,n,e[n])}function xt(e,t){return!(!e||!t)&&-1!==e.indexOf(t)}function Ot(e){return"[object Array]"===Tt(e)}function Ft(e){return"[object Error]"===Tt(e)}function Ut(e){return"string"==typeof e}function jt(e){return"number"==typeof e}function Ht(e){if(function(e){return"[object Date]"===Tt(e)}(e)){var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function Bt(e,t,n){for(var i=e.length,s=0;s<i&&(!(s in e)||-1!==t.call(n||e,e[s],s,e));s++);}function Yt(e,t,n){for(var i=e.length,s=n||0,r=Math.max(s>=0?s:i-Math.abs(s),0);r<i;r++)if(r in e&&e[r]===t)return r;return-1}function Wt(e,t,n){for(var i=e.length,s=n||e,r=new Array(i),o=0;o<i;o++)o in e&&(r[o]=t.call(s,e[o],e));return r}function qt(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"")}var Vt=!{toString:null}.propertyIsEnumerable("toString"),$t=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function Kt(e){var t=typeof e;t!==d&&(t!==h||null===e)&&b("objKeys called on non-object");var n=[];for(var i in e)e&&E.call(e,i)&&n.push(i);if(Vt)for(var s=$t.length,r=0;r<s;r++)e&&E.call(e,$t[r])&&n.push($t[r]);return n}function zt(e,t,n,i){if(Ct)try{var s={enumerable:!0,configurable:!0};return n&&(s.get=n),i&&(s.set=i),Ct(e,t,s),!0}catch(e){}return!1}function Gt(){var e=Date;return e.now?e.now():(new e).getTime()}function Jt(e){return Ft(e)?e.name:""}function Xt(e,t,n,i,s){var r=n;return e&&((r=e[t])!==n&&(!s||s(r))&&(!i||i(n))&&(r=n,e[t]=r)),r}function Zt(e,t,n){var i;return e?!(i=e[t])&&At(i)&&(i=Mt(n)?{}:n,e[t]=i):i=Mt(n)?{}:n,i}function Qt(e){return!e}function en(e){return!!e}function tn(e){throw new Error(e)}function nn(e){return e&&(e=g(v?v({},e):e)),e}var sn="msie",rn="trident/",on=null,an=null;function cn(e){var t=w();return t&&t[e]?t[e]:"window"===e&&ln()?window:null}function ln(){return Boolean(typeof window===h&&window)}function un(){return ln()?window:cn("window")}function dn(){return Boolean(typeof document===h&&document)}function hn(){return dn()?document:cn("document")}function fn(){return Boolean(typeof navigator===h&&navigator)?navigator:cn("navigator")}function pn(){return Boolean(typeof history===h&&history)?history:cn("history")}function mn(e){return typeof location===h&&location?location:cn("location")}function gn(){return cn("performance")}function yn(){return Boolean(typeof JSON===h&&JSON||null!==cn("JSON"))}function vn(){return yn()?JSON||cn("JSON"):null}function Sn(){var e=fn();if(e&&(e.userAgent!==an||null===on)){var t=((an=e.userAgent)||"").toLowerCase();on=xt(t,sn)||xt(t,rn)}return on}function _n(e){if(void 0===e&&(e=null),!e){var t=fn()||{};e=t?(t.userAgent||"").toLowerCase():""}var n=(e||"").toLowerCase();if(xt(n,sn))return parseInt(n.split(sn)[1]);if(xt(n,rn)){var i=parseInt(n.split(rn)[1]);if(i)return i+4}return null}function En(e){var t=Object[p].toString.call(e),n="";return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":yn()&&(n=vn().stringify(e)),t+n}function wn(e){return e?'"'+e.replace(/\"/g,"")+'"':""}var bn=function(){function e(e,t,n,i){void 0===n&&(n=!1);var s=this;s.messageId=e,s.message=(n?"AI: ":"AI (Internal): ")+e;var r="";yn()&&(r=vn().stringify(i));var o=(t?" message:"+wn(t):"")+(i?" props:"+wn(r):"");s.message+=o}return e.dataType="MessageData",e}();function Cn(e,t){return(e||{}).logger||new Tn(t)}var Tn=function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n=0,i={};se(e,this,(function(e){function s(e,n){var i=t[e];return At(i)?n:i}At(t)&&(t={}),e.consoleLoggingLevel=function(){return s("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return s("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return s("maxMessageLimit",25)},e.enableDebugExceptions=function(){return s("enableDebugExceptions",!1)},e.throwInternal=function(t,n,s,r,o){void 0===o&&(o=!1);var a=new bn(n,s,o,r);if(e.enableDebugExceptions())throw a;if(!Mt(a.message)){var c=e.consoleLoggingLevel();if(o){var l=+a.messageId;!i[l]&&c>=ne.WARNING&&(e.warnToConsole(a.message),i[l]=!0)}else c>=ne.WARNING&&e.warnToConsole(a.message);e.logInternalMessage(t,a)}},e.warnToConsole=function(e){var t=typeof console!==f?console:cn("console");if(t){var n="log";t.warn&&(n="warn"),It(t[n])&&t[n](e)}},e.resetInternalMessageCount=function(){n=0,i={}},e.logInternalMessage=function(t,s){if(!(n>=e.maxInternalMessageLimit())){var r=!0,o="AITR_"+s.messageId;if(i[o]?r=!1:i[o]=!0,r&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(s),n++),n===e.maxInternalMessageLimit())){var a="Internal events throttle limit per PageView reached for this app.",c=new bn(Ae,a,!1);e.queue.push(c),e.warnToConsole(a)}}}}))},Mn=function(){function e(t,n,i){var s,r=this,o=!1;(r.start=Gt(),r.name=t,r.isAsync=i,r.isChildEvt=function(){return!1},It(n))&&(o=zt(r,"payload",(function(){return!s&&It(n)&&(s=n(),n=null),s})));r.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?r[t]:(r.ctx||{})[t]:null},r.setCtx=function(t,n){if(t)if(t===e.ParentContextKey)r[t]||(r.isChildEvt=function(){return!0}),r[t]=n;else if(t===e.ChildrenContextKey)r[t]=n;else{(r.ctx=r.ctx||{})[t]=n}},r.complete=function(){var t=0,i=r.getCtx(e.ChildrenContextKey);if(Ot(i))for(var s=0;s<i.length;s++){var a=i[s];a&&(t+=a.time)}r.time=Gt()-r.start,r.exTime=r.time-t,r.complete=function(){},!o&&It(n)&&(r.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),An=function e(t){this.ctx={},se(e,this,(function(e){e.create=function(e,t,n){return new Mn(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e.ctx=e.ctx||{})[t]=n)},e.getCtx=function(t){return(e.ctx||{})[t]}}))},kn="CoreUtils.doPerf";function Rn(e,t,n,i,s){if(e){var r=e;if(It(r.getPerfMgr)&&(r=r.getPerfMgr()),r){var o=void 0,a=r.getCtx(kn);try{if(o=r.create(t(),i,s)){if(a&&o.setCtx&&(o.setCtx(Mn.ParentContextKey,a),a.getCtx&&a.setCtx)){var c=a.getCtx(Mn.ChildrenContextKey);c||(c=[],a.setCtx(Mn.ChildrenContextKey,c)),c.push(o)}return r.setCtx(kn,o),n(o)}}catch(e){o&&o.setCtx&&o.setCtx("exception",e)}finally{o&&r.fire(o),r.setCtx(kn,a)}}}return n()}var Pn=function(e,t){var n=this,i=null,s=It(e.processTelemetry),r=It(e.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return e},n.getNext=function(){return i},n.setNext=function(e){i=e},n.processTelemetry=function(o,a){a||(a=t);var c=e?e.identifier:"TelemetryPluginChain";Rn(a?a.core():null,(function(){return c+":processTelemetry"}),(function(){if(e&&s){n._hasRun=!0;try{a.setNext(i),r&&e.setNextPlugin(i),i&&(i._hasRun=!1),e.processTelemetry(o,a)}catch(n){var t=i&&i._hasRun;(!i||!t)&&a.diagLog().throwInternal(ne.CRITICAL,yt,"Plugin ["+e.identifier+"] failed during processTelemetry - "+n),i&&!t&&i.processTelemetry(o,a)}}else i&&(n._hasRun=!0,i.processTelemetry(o,a))}),(function(){return{item:o}}),!o.sync)}};function In(e,t){var n=[];if(e&&e.length>0)for(var i=null,s=0;s<e.length;s++){var r=e[s];if(r&&It(r.processTelemetry)){var o=new Pn(r,t);n.push(o),i&&i.setNext(o),i=o}}return n.length>0?n[0]:null}var Nn=function e(t,n,i,s){var r=this,o=null;null!==s&&(t&&It(t.getPlugin)?o=function(e,t,n){var i=[],s=!n;if(e)for(;e;){var r=e.getPlugin();(s||r===n)&&(s=!0,i.push(r)),e=e.getNext()}return s||i.push(n),In(i,t)}(t,r,s||t.getPlugin()):s?o=function(e,t,n){var i=e,s=!1;return n&&e&&(i=[],Bt(e,(function(e){(s||e===n)&&(s=!0,i.push(e))}))),n&&!s&&(i||(i=[]),i.push(n)),In(i,t)}(t,r,s):Mt(s)&&(o=In(t,r))),r.core=function(){return i},r.diagLog=function(){return Cn(i,n)},r.getCfg=function(){return n},r.getExtCfg=function(e,t){var i;if(void 0===t&&(t={}),n){var s=n.extensionConfig;s&&e&&(i=s[e])}return i||t},r.getConfig=function(e,t,i){void 0===i&&(i=!1);var s,o=r.getExtCfg(e,null);return o&&!At(o[t])?s=o[t]:n&&!At(n[t])&&(s=n[t]),At(s)?i:s},r.hasNext=function(){return null!=o},r.getNext=function(){return o},r.setNext=function(e){o=e},r.processNext=function(e){var t=o;t&&(o=t.getNext(),t.processTelemetry(e,r))},r.createNew=function(t,s){return void 0===t&&(t=null),new e(t||o,n,i,s)}},Ln="extensionConfig",Dn="getPlugin",xn=function(){function e(){var e=this,t=!1,n=null,i=null;e.core=null,e.diagLog=function(t){return e._getTelCtx(t).diagLog()},e.isInitialized=function(){return t},e.setInitialized=function(e){t=e},e.setNextPlugin=function(e){i=e},e.processNext=function(e,t){t?t.processNext(e):i&&It(i.processTelemetry)&&i.processTelemetry(e,null)},e._getTelCtx=function(t){void 0===t&&(t=null);var s=t;if(!s){var r=n||new Nn(null,{},e.core);s=i&&i[Dn]?r.createNew(null,i[Dn]):r.createNew(null,i)}return s},e._baseTelInit=function(s,r,o,a){s&&Xt(s,Ln,[],null,At),!a&&r&&(a=r.getProcessTelContext().getNext());var c=i;i&&i[Dn]&&(c=i[Dn]()),e.core=r,n=new Nn(a,s,r,c),t=!0}}return e.prototype.initialize=function(e,t,n,i){this._baseTelInit(e,t,n,i)},e}(),On="processTelemetry",Fn="priority",Un="setNextPlugin",jn="isInitialized";function Hn(e,t){for(var n=[],i=null,s=e.getNext();s;){var r=s.getPlugin();r&&(i&&It(i[Un])&&It(r[On])&&i[Un](r),(!It(r[jn])||!r[jn]())&&n.push(r),i=r,s=s.getNext())}Bt(n,(function(n){n.initialize(e.getCfg(),e.core(),t,e.getNext())}))}function Bn(e){return e.sort((function(e,t){var n=0,i=It(t[On]);return It(e[On])?n=i?e[Fn]-t[Fn]:1:i&&(n=-1),n}))}var Yn=function(e){function t(){var n,i=e.call(this)||this;function s(e){e&&e.length>0&&(function(e){Bt(e,(function(e){e.priority<500&&tn("Channel has invalid priority"+e.identifier)}))}(e=e.sort((function(e,t){return e.priority-t.priority}))),n.push(e))}return i.identifier="ChannelControllerPlugin",i.priority=500,se(t,i,(function(e,t){e.setNextPlugin=function(e){},e.processTelemetry=function(e,t){n&&Bt(n,(function(n){n.length>0&&i._getTelCtx(t).createNew(n).processNext(e)}))},e.getChannelControls=function(){return n},e.initialize=function(i,r,o){e.isInitialized()||(t.initialize(i,r,o),function(e,t){if(n=[],e&&Bt(e,(function(e){return s(e)})),t){var i=[];Bt(t,(function(e){e.priority>500&&i.push(e)})),s(i)}}((i||{}).channels,o),Bt(n,(function(e){return Hn(new Nn(e,i,r),o)})))}})),i}return A(t,e),t._staticInit=(zt(n=t.prototype,"ChannelControls",n.getChannelControls),void zt(n,"channelQueue",n.getChannelControls)),t;var n}(xn),Wn="toGMTString",qn="toUTCString",Vn="cookie",$n="expires",Kn="enabled",zn="isCookieUseDisabled",Gn="disableCookiesUsage",Jn="_ckMgr",Xn=null,Zn=null,Qn=null,ei=hn(),ti={},ni={};function ii(e){return!e||e.isEnabled()}function si(e,t){var n;if(e)n=e.getCookieMgr();else if(t){var i=t.cookieCfg;n=i[Jn]?i[Jn]:ri(t)}return n||(n=function(e,t){var n=ri[Jn]||ni[Jn];return n||(n=ri[Jn]=ri(e,t),ni[Jn]=n),n}(t,(e||{}).logger)),n}function ri(e,t){var n=function(e){var t=e.cookieCfg=e.cookieCfg||{};if(Xt(t,"domain",e.cookieDomain,kt,At),Xt(t,"path",e.cookiePath||"/",null,At),At(t[Kn])){var n=void 0;Mt(e[zn])||(n=!e[zn]),Mt(e[Gn])||(n=!e[Gn]),t[Kn]=n}return t}(e||ni),i=n.path||"/",s=n.domain,r=!1!==n[Kn],o={isEnabled:function(){var e=r&&oi(t),n=ni[Jn];return e&&n&&o!==n&&(e=ii(n)),e},setEnabled:function(e){r=!1!==e},set:function(e,t,r,a,c){if(ii(o)){var l={},u=qt(t||""),d=u.indexOf(";");if(-1!==d&&(u=qt(t.substring(0,d)),l=ai(t.substring(d+1))),Xt(l,"domain",a||s,en,Mt),!At(r)){var h=Sn();if(Mt(l[$n])){var f=Gt()+1e3*r;if(f>0){var p=new Date;p.setTime(f),Xt(l,$n,ci(p,h?Wn:qn)||ci(p,h?Wn:qn)||"",en)}}h||Xt(l,"max-age",""+r,null,Mt)}var m=mn();m&&"https:"===m.protocol&&(Xt(l,"secure",null,null,Mt),null===Zn&&(Zn=!function(e){return!!Ut(e)&&!!(xt(e,"CPU iPhone OS 12")||xt(e,"iPad; CPU OS 12")||xt(e,"Macintosh; Intel Mac OS X 10_14")&&xt(e,"Version/")&&xt(e,"Safari")||xt(e,"Macintosh; Intel Mac OS X 10_14")&&function(e,t){if(e&&t){var n=t.length,i=e.length;if(e===t)return!0;if(i>=n){for(var s=i-1,r=n-1;r>=0;r--){if(e[s]!=t[r])return!1;s--}return!0}}return!1}(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||xt(e,"Chrome/5")||xt(e,"Chrome/6")||xt(e,"UnrealEngine")&&!xt(e,"Chrome")||xt(e,"UCBrowser/12")||xt(e,"UCBrowser/11"))}((fn()||{}).userAgent)),Zn&&Xt(l,"SameSite","None",null,Mt)),Xt(l,"path",c||i,null,Mt),(n.setCookie||di)(e,li(u,l))}},get:function(e){var t="";return ii(o)&&(t=(n.getCookie||ui)(e)),t},del:function(e,t){ii(o)&&o.purge(e,t)},purge:function(e,i){if(oi(t)){var s=((r={}).path=i||"/",r[$n]="Thu, 01 Jan 1970 00:00:01 GMT",r);Sn()||(s["max-age"]="0"),(n.delCookie||di)(e,li("",s))}var r}};return o[Jn]=o,o}function oi(e){if(null===Xn){Xn=!1;try{Xn=void 0!==(ei||{})[Vn]}catch(t){e&&e.throwInternal(ne.WARNING,ht,"Cannot access document.cookie - "+Jt(t),{exception:En(t)})}}return Xn}function ai(e){var t={};e&&e.length&&Bt(qt(e).split(";"),(function(e){if(e=qt(e||"")){var n=e.indexOf("=");-1===n?t[e]=null:t[qt(e.substring(0,n))]=qt(e.substring(n+1))}}));return t}function ci(e,t){return It(e[t])?e[t]():null}function li(e,t){var n=e||"";return Dt(t,(function(e,t){n+="; "+e+(At(t)?"":"="+t)})),n}function ui(e){var t="";if(ei){var n=ei[Vn]||"";Qn!==n&&(ti=ai(n),Qn=n),t=qt(ti[e]||"")}return t}function di(e,t){ei&&(ei[Vn]=e+"="+t)}var hi="_notificationManager",fi=function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;se(e,this,(function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var n=Yt(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=Yt(e.listeners,t)},e.eventsSent=function(t){Bt(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(t)}),0)}))},e.eventsDiscarded=function(t,n){Bt(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(t,n)}),0)}))},e.eventsSendRequest=function(t,n){Bt(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(n)setTimeout((function(){return e.eventsSendRequest(t,n)}),0);else try{e.eventsSendRequest(t,n)}catch(e){}}))},e.perfEvent=function(t){t&&(n||!t.isChildEvt())&&Bt(e.listeners,(function(e){if(e&&e.perfEvent)if(t.isAsync)setTimeout((function(){return e.perfEvent(t)}),0);else try{e.perfEvent(t)}catch(e){}}))}}))},pi=function(e){function t(){var n=e.call(this)||this;return se(t,n,(function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],u)}e.initialize=function(e,n,i,s){t.initialize(e,n,i||new Tn(e),s||new fi(e))},e.track=function(i){Rn(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){null===i&&(n(i),tn("Invalid telemetry item")),function(e){if(At(e.name))throw n(e),Error("telemetry name required")}(i),t.track(i)}),(function(){return{item:i}}),!i.sync)},e.addNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.addNotificationListener(t)},e.removeNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.removeNotificationListener(t)},e.pollInternalLogs=function(t){var n=e.config.diagnosticLogInterval;return(!n||!(n>0))&&(n=1e4),setInterval((function(){var n=e.logger?e.logger.queue:[];Bt(n,(function(n){var i={name:t||"InternalMessageId: "+n.messageId,iKey:e.config.instrumentationKey,time:Ht(new Date),baseType:bn.dataType,baseData:{message:n.message}};e.track(i)})),n.length=0}),n)}})),n}return A(t,e),t}((function e(){var t,n,i,s,r,o=!1;se(e,this,(function(e){e._extensions=new Array,n=new Yn,e.logger=C({throwInternal:function(e,t,n,i,s){void 0===s&&(s=!1)},warnToConsole:function(e){},resetInternalMessageCount:function(){}}),t=[],e.isInitialized=function(){return o},e.initialize=function(t,s,r,a){e.isInitialized()&&tn("Core should not be initialized more than once"),(!t||At(t.instrumentationKey))&&tn("Please provide instrumentation key"),i=a,e[hi]=a,e.config=t||{},t.extensions=At(t.extensions)?[]:t.extensions,Zt(t,Ln).NotificationManager=a,r&&(e.logger=r);var c=[];c.push.apply(c,s.concat(t.extensions)),c=Bn(c);var l=[],u=[],d={};Bt(c,(function(e){(At(e)||At(e.initialize))&&tn("Extensions must provide callback to initialize");var t=e.priority,i=e.identifier;e&&t&&(At(d[t])?d[t]=i:r.warnToConsole("Two extensions have same priority #"+t+" - "+d[t]+", "+i)),!t||t<n.priority?l.push(e):u.push(e)})),c.push(n),l.push(n),c=Bn(c),e._extensions=c,Hn(new Nn([n],t,e),c),Hn(new Nn(l,t,e),c),e._extensions=l,0===e.getTransmissionControls().length&&tn("No channels available"),o=!0,e.releaseQueue()},e.getTransmissionControls=function(){return n.getChannelControls()},e.track=function(n){Xt(n,"iKey",e.config.instrumentationKey,null,Qt),Xt(n,"time",Ht(new Date),null,Qt),Xt(n,"ver","4.0",null,At),e.isInitialized()?e.getProcessTelContext().processNext(n):t.push(n)},e.getProcessTelContext=function(){var t=e._extensions,i=t;return(!t||0===t.length)&&(i=[n]),new Nn(i,e.config,e)},e.getNotifyMgr=function(){return i||(i=C({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){},eventsSendRequest:function(e,t){}}),e[hi]=i),i},e.getCookieMgr=function(){return r||(r=ri(e.config,e.logger)),r},e.setCookieMgr=function(e){r=e},e.getPerfMgr=function(){return s||e.config&&e.config.enablePerfMgr&&(s=new An(e.getNotifyMgr())),s},e.setPerfMgr=function(e){s=e},e.eventCnt=function(){return t.length},e.releaseQueue=function(){t.length>0&&(Bt(t,(function(t){e.getProcessTelContext().processNext(t)})),t=[])}}))})),mi=4294967296,gi=4294967295,yi=!1,vi=123456789,Si=987654321;function _i(){try{var e=2147483647&Gt();!function(e){e<0&&(e>>>=0),vi=123456789+e&gi,Si=987654321-e&gi,yi=!0}((Math.random()*mi^e)+e)}catch(e){}}function Ei(e){var t,n=cn("crypto")||cn("msCrypto");return n&&n.getRandomValues?t=n.getRandomValues(new Uint32Array(1))[0]&gi:Sn()?(yi||_i(),t=function(e){var t=((Si=36969*(65535&Si)+(Si>>16)&gi)<<16)+(65535&(vi=18e3*(65535&vi)+(vi>>16)&gi))>>>0&gi|0;return e||(t>>>=0),t}()&gi):t=Math.floor(mi*Math.random()|0),e||(t>>>=0),t}function wi(e,t){var n=!1,i=un();i&&(n=Nt(i,e,t),n=Nt(i.body,e,t)||n);var s=hn();return s&&(n=Ti.Attach(s,e,t)||n),n}function bi(e){void 0===e&&(e=22);for(var t=Ei()>>>0,n=0,i="";i.length<e;)n++,i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Ei()<<2&4294967295|3&t)>>>0,n=0);return i}function Ci(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n="",i=0;i<4;i++)n+=t[15&(e=Ei())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var s=t[8+(3&Ei())|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+s+n.substr(16,3)+n.substr(19,12)}var Ti={Attach:Nt,AttachEvent:Nt,Detach:Lt,DetachEvent:Lt},Mi="_aiHooks",Ai=["req","rsp","hkErr","fnErr"];function ki(e,t){if(e)for(var n=0;n<e.length&&!t(e[n],n);n++);}function Ri(e,t,n,i,s){s>=0&&s<=2&&ki(e,(function(e,r){var o=e.cbks,a=o[Ai[s]];if(a){t.ctx=function(){return i[r]=i[r]||{}};try{a.apply(t.inst,n)}catch(e){var c=t.err;try{var l=o[Ai[2]];l&&(t.err=e,l.apply(t.inst,n))}catch(e){}finally{t.err=c}}}}))}var Pi=Object.getPrototypeOf;function Ii(e,t,n){var i=null;return e&&(Rt(e,t)?i=e:n&&(i=Ii(function(e){if(e){if(Pi)return Pi(e);var t=e.__proto__||e[p]||e.constructor;if(t)return t}return null}(e),t,!1))),i}function Ni(e,t,n,i){if(void 0===i&&(i=!0),e&&t&&n){var s=Ii(e,t,i);if(s){var r=s[t];if(typeof r===d){var o=r[Mi];if(!o){var a=function(e){return function(){var t=this,n=arguments,i=e.h,s={name:e.n,inst:t,ctx:null,set:c},r=[],o=a([s],n);function a(e,t){return ki(t,(function(t){e.push(t)})),e}function c(e,t){(n=a([],n))[e]=t,o=a([s],n)}Ri(i,s,o,r,0);var l=e.f;try{s.rslt=l.apply(t,n)}catch(e){throw s.err=e,Ri(i,s,o,r,3),e}return Ri(i,s,o,r,1),s.rslt}}(o={i:0,n:t,f:r,h:[]});a[Mi]=o,s[t]=a}var c={id:o.i,cbks:n,rm:function(){var e=this.id;ki(o.h,(function(t,n){if(t.id===e)return o.h.splice(n,1),1}))}};return o.i++,o.h.push(c),c}}}return null}var Li="Request-Context",Di="appId",xi="appId=cid-v1:",Oi="Request-Id",Fi="traceparent",Ui="Sdk-Context",ji="appId",Hi="request-context";function Bi(e,t,n){var i=t.length,s=function(e,t){var n;return t&&(t=qt(t.toString())).length>150&&(n=t.substring(0,150),e.throwInternal(ne.WARNING,it,"name is too long.  It has been truncated to 150 characters.",{name:t},!0)),n||t}(e,t);if(s.length!==i){for(var r=0,o=s;void 0!==n[o];)r++,o=s.substring(0,147)+zi(r);s=o}return s}function Yi(e,t,n){var i;return void 0===n&&(n=1024),t&&(n=n||1024,(t=qt(t)).toString().length>n&&(i=t.toString().substring(0,n),e.throwInternal(ne.WARNING,ot,"string value is too long. It has been truncated to "+n+" characters.",{value:t},!0))),i||t}function Wi(e,t){return Ki(e,t,2048,ut)}function qi(e,t){var n;return t&&t.length>32768&&(n=t.substring(0,32768),e.throwInternal(ne.WARNING,nt,"message is too long, it has been truncated to 32768 characters.",{message:t},!0)),n||t}function Vi(e,t){if(t){var n={};Dt(t,(function(t,i){if(Pt(i)&&yn())try{i=vn().stringify(i)}catch(t){e.throwInternal(ne.WARNING,Xe,"custom property is not valid",{exception:t},!0)}i=Yi(e,i,8192),t=Bi(e,t,n),n[t]=i})),t=n}return t}function $i(e,t){if(t){var n={};Dt(t,(function(t,i){t=Bi(e,t,n),n[t]=i})),t=n}return t}function Ki(e,t,n,i){var s;return t&&((t=qt(t)).length>n&&(s=t.substring(0,n),e.throwInternal(ne.WARNING,i,"input is too long, it has been truncated to "+n+" characters.",{data:t},!0))),s||t}function zi(e){var t="00"+e;return t.substr(t.length-3)}function Gi(e){var t=null;if(It(Event))t=new Event(e);else{var n=hn();n&&n.createEvent&&(t=n.createEvent("Event")).initEvent(e,!0,!0)}return t}function Ji(e,t){return void 0===t&&(t=!1),null==e?t:"true"===e.toString().toLowerCase()}function Xi(e){(isNaN(e)||e<0)&&(e=0);var t=""+(e=Math.round(e))%1e3,n=""+Math.floor(e/1e3)%60,i=""+Math.floor(e/6e4)%60,s=""+Math.floor(e/36e5)%24,r=Math.floor(e/864e5);return t=1===t.length?"00"+t:2===t.length?"0"+t:t,n=n.length<2?"0"+n:n,i=i.length<2?"0"+i:i,(r>0?r+".":"")+(s=s.length<2?"0"+s:s)+":"+i+":"+n+"."+t}function Zi(){var e=fn();return"sendBeacon"in e&&e.sendBeacon}var Qi,es,ts="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",ns="sampleRate",is="ProcessLegacy",ss="http.method",rs="not_specified";!function(e){e[e.LocalStorage=0]="LocalStorage",e[e.SessionStorage=1]="SessionStorage"}(Qi||(Qi={})),function(e){e[e.AI=0]="AI",e[e.AI_AND_W3C=1]="AI_AND_W3C",e[e.W3C=2]="W3C"}(es||(es={}));var os=void 0,as=void 0;function cs(){return ds()?ls(Qi.LocalStorage):null}function ls(e){try{if(At(w()))return null;var t=new Date,n=cn(e===Qi.LocalStorage?"localStorage":"sessionStorage");n.setItem(t.toString(),t.toString());var i=n.getItem(t.toString())!==t.toString();if(n.removeItem(t.toString()),!i)return n}catch(e){}return null}function us(){return hs()?ls(Qi.SessionStorage):null}function ds(){return void 0===os&&(os=!!ls(Qi.LocalStorage)),os}function hs(){return void 0===as&&(as=!!ls(Qi.SessionStorage)),as}function fs(e,t){var n=us();if(null!==n)try{return n.getItem(t)}catch(t){as=!1,e.throwInternal(ne.WARNING,ae,"Browser failed read of session storage. "+Jt(t),{exception:En(t)})}return null}function ps(e,t,n){var i=us();if(null!==i)try{return i.setItem(t,n),!0}catch(t){as=!1,e.throwInternal(ne.WARNING,le,"Browser failed write to session storage. "+Jt(t),{exception:En(t)})}return!1}var ms=hn()||{},gs=0,ys=[null,null,null,null,null];function vs(e){var t=gs,n=ys,i=n[t];return ms.createElement?n[t]||(i=n[t]=ms.createElement("a")):i={host:Ss(e,!0)},i.href=e,++t>=n.length&&(t=0),gs=t,i}function Ss(e,t){var n=_s(e,t)||"";if(n){var i=n.match(/(www[0-9]?\.)?(.[^/:]+)(\:[\d]+)?/i);if(null!=i&&i.length>3&&Ut(i[2])&&i[2].length>0)return i[2]+(i[3]||"")}return n}function _s(e,t){var n=null;if(e){var i=e.match(/(\w*):\/\/(.[^/:]+)(\:[\d]+)?/i);if(null!=i&&i.length>2&&Ut(i[2])&&i[2].length>0&&(n=i[2]||"",t&&i.length>2)){var s=(i[1]||"").toLowerCase(),r=i[3]||"";("http"===s&&":80"===r||"https"===s&&":443"===r)&&(r=""),n+=r}}return n}var Es=["https://dc.services.visualstudio.com/v2/track","https://breeze.aimon.applicationinsights.io/v2/track","https://dc-int.services.visualstudio.com/v2/track"];function ws(e){return-1!==Es.indexOf(e.toLowerCase())}var bs={correlationIdPrefix:"cid-v1:",canIncludeCorrelationHeader:function(e,t,n){if(!t||e&&e.disableCorrelationHeaders)return!1;if(e&&e.correlationHeaderExcludePatterns)for(var i=0;i<e.correlationHeaderExcludePatterns.length;i++)if(e.correlationHeaderExcludePatterns[i].test(t))return!1;var s=vs(t).host.toLowerCase();if(s&&(-1!==s.indexOf(":443")||-1!==s.indexOf(":80"))&&(s=(_s(t,!0)||"").toLowerCase()),(!e||!e.enableCorsCorrelation)&&s&&s!==n)return!1;var r,o=e&&e.correlationHeaderDomains;if(o&&(Bt(o,(function(e){var t=new RegExp(e.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));r=r||t.test(s)})),!r))return!1;var a=e&&e.correlationHeaderExcludedDomains;if(!a||0===a.length)return!0;for(i=0;i<a.length;i++){if(new RegExp(a[i].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")).test(s))return!1}return s&&s.length>0},getCorrelationContext:function(e){if(e){var t=bs.getCorrelationContextValue(e,Di);if(t&&t!==bs.correlationIdPrefix)return t}},getCorrelationContextValue:function(e,t){if(e)for(var n=e.split(","),i=0;i<n.length;++i){var s=n[i].split("=");if(2===s.length&&s[0]===t)return s[1]}}};function Cs(){var e=gn();if(e&&e.now&&e.timing){var t=e.now()+e.timing.navigationStart;if(t>0)return t}return Gt()}function Ts(e,t){var n=null;return 0!==e&&0!==t&&!At(e)&&!At(t)&&(n=t-e),n}var Ms=function(e){function t(){return e.call(this)||this}return A(t,e),t}((function(){})),As=function(e){function t(t,n,i){var s=e.call(this)||this;return s.name=Yi(t,i)||rs,s.data=n,s.time=Ht(new Date),s.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return 100===s.sampleRate?4:1},tags:1,data:1},s}return A(t,e),t}((function(){this.ver=1,this.sampleRate=100,this.tags={}})),ks=function(){this.ver=2,this.properties={},this.measurements={}},Rs=function(e){function t(t,n,i,s){var r=e.call(this)||this;return r.aiDataContract={ver:1,name:1,properties:0,measurements:0},r.name=Yi(t,n)||rs,r.properties=Vi(t,i),r.measurements=$i(t,s),r}return A(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Event",t.dataType="EventData",t}(ks),Ps=function(){},Is=function(){this.hasFullStack=!0,this.parsedStack=[]},Ns="error",Ls="stack",Ds="stackDetails",xs="errorSrc",Os="message",Fs="description";function Us(e,t){var n=e;return n&&!Ut(n)&&(JSON&&JSON.stringify?(n=JSON.stringify(e),t&&(!n||"{}"===n)&&(n=It(e.toString)?e.toString():""+e)):n=e+" - (Missing JSON.stringify)"),n||""}function js(e,t){var n=e;return e&&((n=e[Os]||e[Fs]||"")&&!Ut(n)&&(n=Us(n,!0)),e.filename&&(n=n+" @"+(e.filename||"")+":"+(e.lineno||"?")+":"+(e.colno||"?"))),t&&"String"!==t&&"Object"!==t&&"Error"!==t&&-1===(n||"").indexOf(t)&&(n=t+": "+n),n||""}function Hs(e){return e&&e.src&&Ut(e.src)&&e.obj&&Ot(e.obj)}function Bs(e){var t=e||"";Ut(t)||(t=Ut(t[Ls])?t[Ls]:""+t);var n=t.split("\n");return{src:t,obj:n}}function Ys(e){var t=null;if(e)try{if(e[Ls])t=Bs(e[Ls]);else if(e[Ns]&&e[Ns][Ls])t=Bs(e[Ns][Ls]);else if(e.exception&&e.exception[Ls])t=Bs(e.exception[Ls]);else if(Hs(e))t=e;else if(Hs(e[Ds]))t=e[Ds];else if(window.opera&&e[Os])t=function(e){for(var t=[],n=e.split("\n"),i=0;i<n.length;i++){var s=n[i];n[i+1]&&(s+="@"+n[i+1],i++),t.push(s)}return{src:e,obj:t}}(e.message);else if(Ut(e))t=Bs(e);else{var n=e[Os]||e[Fs]||"";Ut(e[xs])&&(n&&(n+="\n"),n+=" from "+e[xs]),n&&(t=Bs(n))}}catch(e){t=Bs(e)}return t||{src:"",obj:null}}function Ws(e){var t="";if(e&&!(t=e.typeName||e.name||""))try{var n=/function (.{1,200})\(/.exec(e.constructor.toString());t=n&&n.length>1?n[1]:""}catch(e){}return t}function qs(e){if(e)try{if(!Ut(e)){var t=Ws(e),n=Us(e,!1);return(!n||"{}"===n)&&(e[Ns]&&(t=Ws(e=e[Ns])),n=Us(e,!0)),0!==n.indexOf(t)&&"String"!==t?t+":"+n:n}}catch(e){}return""+(e||"")}var Vs,$s=function(e){function t(t,n,i,s,r,o){var a=e.call(this)||this;return a.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0},function(e){return!!Pt(e)&&("ver"in e&&"exceptions"in e&&"properties"in e)}(n)?(a.exceptions=n.exceptions,a.properties=n.properties,a.measurements=n.measurements,n.severityLevel&&(a.severityLevel=n.severityLevel),n.id&&(a.id=n.id),n.problemGroup&&(a.problemGroup=n.problemGroup),a.ver=2,At(n.isManual)||(a.isManual=n.isManual)):(i||(i={}),a.exceptions=[new Ks(t,n,i)],a.properties=Vi(t,i),a.measurements=$i(t,s),r&&(a.severityLevel=r),o&&(a.id=o)),a}return A(t,e),t.CreateAutoException=function(e,t,n,i,s,r,o,a){var c=Ws(s||r||e);return{message:js(e,c),url:t,lineNumber:n,columnNumber:i,error:qs(s||r||e),evt:qs(r||e),typeName:c,stackDetails:Ys(o||s||r),errorSrc:a}},t.CreateFromInterface=function(e,n,i,s){var r=n.exceptions&&Wt(n.exceptions,(function(t){return Ks.CreateFromInterface(e,t)}));return new t(e,T({},n,{exceptions:r}),i,s)},t.prototype.toInterface=function(){var e=this,t=e.exceptions,n=e.properties,i=e.measurements,s=e.severityLevel,r=(e.ver,e.problemGroup),o=e.id,a=e.isManual;return{ver:"4.0",exceptions:t instanceof Array&&Wt(t,(function(e){return e.toInterface()}))||void 0,severityLevel:s,properties:n,measurements:i,problemGroup:r,id:o,isManual:a}},t.CreateSimpleException=function(e,t,n,i,s,r){return{exceptions:[{hasFullStack:!0,message:e,stack:s,typeName:t}]}},t.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",t.dataType="ExceptionData",t.formatError=qs,t}((function(){this.ver=2,this.exceptions=[],this.properties={},this.measurements={}})),Ks=function(e){function t(t,n,i){var s=e.call(this)||this;if(s.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2},function(e){return!!Pt(e)&&("hasFullStack"in e&&"typeName"in e)}(n))s.typeName=n.typeName,s.message=n.message,s[Ls]=n[Ls],s.parsedStack=n.parsedStack,s.hasFullStack=n.hasFullStack;else{var r=n,o=r&&r.evt;Ft(r)||(r=r[Ns]||o||r),s.typeName=Yi(t,Ws(r))||rs,s.message=qi(t,js(n||r,s.typeName))||rs;var a=n[Ds]||Ys(n);s.parsedStack=function(e){var t,n=e.obj;if(n&&n.length>0){t=[];var i=0,s=0;Bt(n,(function(e){var n=e.toString();if(zs.regex.test(n)){var r=new zs(n,i++);s+=r.sizeInBytes,t.push(r)}}));if(s>32768)for(var r=0,o=t.length-1,a=0,c=r,l=o;r<o;){if((a+=t[r].sizeInBytes+t[o].sizeInBytes)>32768){var u=l-c+1;t.splice(c,u);break}c=r,l=o,r++,o--}}return t}(a),s[Ls]=function(e,t){var n;if(t){var i=""+t;i.length>32768&&(n=i.substring(0,32768),e.throwInternal(ne.WARNING,Qe,"exception is too long, it has been truncated to 32768 characters.",{exception:t},!0))}return n||t}(t,function(e){var t="";return e&&(e.obj?Bt(e.obj,(function(e){t+=e+"\n"})):t=e.src||""),t}(a)),s.hasFullStack=Ot(s.parsedStack)&&s.parsedStack.length>0,i&&(i.typeName=i.typeName||s.typeName)}return s}return A(t,e),t.prototype.toInterface=function(){var e=this.parsedStack instanceof Array&&Wt(this.parsedStack,(function(e){return e.toInterface()}));return{id:this.id,outerId:this.outerId,typeName:this.typeName,message:this.message,hasFullStack:this.hasFullStack,stack:this[Ls],parsedStack:e||void 0}},t.CreateFromInterface=function(e,n){var i=n.parsedStack instanceof Array&&Wt(n.parsedStack,(function(e){return zs.CreateFromInterface(e)}))||n.parsedStack;return new t(e,T({},n,{parsedStack:i}))},t}(Is),zs=function(e){function t(n,i){var s=e.call(this)||this;if(s.sizeInBytes=0,s.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0},"string"==typeof n){var r=n;s.level=i,s.method="<no_method>",s.assembly=qt(r),s.fileName="",s.line=0;var o=r.match(t.regex);o&&o.length>=5&&(s.method=qt(o[2])||s.method,s.fileName=qt(o[4]),s.line=parseInt(o[5])||0)}else s.level=n.level,s.method=n.method,s.assembly=n.assembly,s.fileName=n.fileName,s.line=n.line,s.sizeInBytes=0;return s.sizeInBytes+=s.method.length,s.sizeInBytes+=s.fileName.length,s.sizeInBytes+=s.assembly.length,s.sizeInBytes+=t.baseSize,s.sizeInBytes+=s.level.toString().length,s.sizeInBytes+=s.line.toString().length,s}return A(t,e),t.CreateFromInterface=function(e){return new t(e,null)},t.prototype.toInterface=function(){return{level:this.level,method:this.method,assembly:this.assembly,fileName:this.fileName,line:this.line}},t.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,t.baseSize=58,t}(Ps),Gs=function(){this.ver=2,this.metrics=[],this.properties={},this.measurements={}};!function(e){e[e.Measurement=0]="Measurement",e[e.Aggregation=1]="Aggregation"}(Vs||(Vs={}));var Js,Xs=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},t}return A(t,e),t}((function(){this.kind=Vs.Measurement})),Zs=function(e){function t(t,n,i,s,r,o,a,c){var l=e.call(this)||this;l.aiDataContract={ver:1,metrics:1,properties:0};var u=new Xs;return u.count=s>0?s:void 0,u.max=isNaN(o)||null===o?void 0:o,u.min=isNaN(r)||null===r?void 0:r,u.name=Yi(t,n)||rs,u.value=i,l.metrics=[u],l.properties=Vi(t,a),l.measurements=$i(t,c),l}return A(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",t.dataType="MetricData",t}(Gs),Qs=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return A(t,e),t}(ks),er=function(e){function t(t,n,i,s,r,o,a){var c=e.call(this)||this;return c.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0},c.id=function(e,t){return t&&Ki(e,t,128,ft).toString()}(t,a),c.url=Wi(t,i),c.name=Yi(t,n)||rs,isNaN(s)||(c.duration=Xi(s)),c.properties=Vi(t,r),c.measurements=$i(t,o),c}return A(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",t.dataType="PageviewData",t}(Qs),tr=function(e){function t(t,n,i,s,r,o,a,c,l,u,d,h){void 0===l&&(l="Ajax");var f=e.call(this)||this;f.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0},f.id=n,f.duration=Xi(r),f.success=o,f.resultCode=a+"",f.type=Yi(t,l);var p=function(e,t,n,i){var s,r=i,o=i;if(t&&t.length>0){var a=vs(t);if(s=a.host,!r)if(null!=a.pathname){var c=0===a.pathname.length?"/":a.pathname;"/"!==c.charAt(0)&&(c="/"+c),o=a.pathname,r=Yi(e,n?n+" "+c:c)}else r=Yi(e,t)}else s=i,r=i;return{target:s,name:r,data:o}}(t,i,c,s);return f.data=Wi(t,s)||p.data,f.target=Yi(t,p.target),u&&(f.target=f.target+" | "+u),f.name=Yi(t,p.name),f.properties=Vi(t,d),f.measurements=$i(t,h),f}return A(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",t.dataType="RemoteDependencyData",t}((function(){this.ver=2,this.success=!0,this.properties={},this.measurements={}})),nr=function(e){function t(t,n,i,s,r){var o=e.call(this)||this;return o.aiDataContract={ver:1,message:1,severityLevel:0,properties:0},n=n||rs,o.message=qi(t,n),o.properties=Vi(t,s),o.measurements=$i(t,r),i&&(o.severityLevel=i),o}return A(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Message",t.dataType="MessageData",t}((function(){this.ver=2,this.properties={},this.measurements={}})),ir=function(e){function t(t,n,i,s,r,o,a){var c=e.call(this)||this;return c.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0},c.url=Wi(t,i),c.name=Yi(t,n)||rs,c.properties=Vi(t,r),c.measurements=$i(t,o),a&&(c.domProcessing=a.domProcessing,c.duration=a.duration,c.networkConnect=a.networkConnect,c.perfTotal=a.perfTotal,c.receivedResponse=a.receivedResponse,c.sentRequest=a.sentRequest),c}return A(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",t.dataType="PageviewPerformanceData",t}(function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return A(t,e),t}(Qs)),sr=function(e){function t(t,n){var i=e.call(this)||this;return i.aiDataContract={baseType:1,baseData:1},i.baseType=t,i.baseData=n,i}return A(t,e),t}(Ms);function rr(e){var t="ai."+e+".";return function(e){return t+e}}!function(e){e[e.Verbose=0]="Verbose",e[e.Information=1]="Information",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Critical=4]="Critical"}(Js||(Js={}));var or=rr("application"),ar=rr("device"),cr=rr("location"),lr=rr("operation"),ur=rr("session"),dr=rr("user"),hr=rr("cloud"),fr=rr("internal"),pr=function(e){function t(){return e.call(this)||this}return A(t,e),t}(function(e){return function(){var t=this;e&&Dt(e,(function(e,n){t[e]=n}))}}({applicationVersion:or("ver"),applicationBuild:or("build"),applicationTypeId:or("typeId"),applicationId:or("applicationId"),applicationLayer:or("layer"),deviceId:ar("id"),deviceIp:ar("ip"),deviceLanguage:ar("language"),deviceLocale:ar("locale"),deviceModel:ar("model"),deviceFriendlyName:ar("friendlyName"),deviceNetwork:ar("network"),deviceNetworkName:ar("networkName"),deviceOEMName:ar("oemName"),deviceOS:ar("os"),deviceOSVersion:ar("osVersion"),deviceRoleInstance:ar("roleInstance"),deviceRoleName:ar("roleName"),deviceScreenResolution:ar("screenResolution"),deviceType:ar("type"),deviceMachineName:ar("machineName"),deviceVMName:ar("vmName"),deviceBrowser:ar("browser"),deviceBrowserVersion:ar("browserVersion"),locationIp:cr("ip"),locationCountry:cr("country"),locationProvince:cr("province"),locationCity:cr("city"),operationId:lr("id"),operationName:lr("name"),operationParentId:lr("parentId"),operationRootId:lr("rootId"),operationSyntheticSource:lr("syntheticSource"),operationCorrelationVector:lr("correlationVector"),sessionId:ur("id"),sessionIsFirst:ur("isFirst"),sessionIsNew:ur("isNew"),userAccountAcquisitionDate:dr("accountAcquisitionDate"),userAccountId:dr("accountId"),userAgent:dr("userAgent"),userId:dr("id"),userStoreRegion:dr("storeRegion"),userAuthUserId:dr("authUserId"),userAnonymousUserAcquisitionDate:dr("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:dr("authUserAcquisitionDate"),cloudName:hr("name"),cloudRole:hr("role"),cloudRoleVer:hr("roleVer"),cloudRoleInstance:hr("roleInstance"),cloudEnvironment:hr("environment"),cloudLocation:hr("location"),cloudDeploymentUnit:hr("deploymentUnit"),internalNodeName:fr("nodeName"),internalSdkVersion:fr("sdkVersion"),internalAgentVersion:fr("agentVersion"),internalSnippet:fr("snippet"),internalSdkSrc:fr("sdkSrc")})),mr=function(){function e(){}return e.create=function(e,t,n,i,s,r){if(n=Yi(i,n)||rs,At(e)||At(t)||At(n))throw Error("Input doesn't contain all required fields");var o={name:n,time:Ht(new Date),iKey:"",ext:r||{},tags:[],data:{},baseType:t,baseData:e};return At(s)||Dt(s,(function(e,t){o.data[e]=t})),o},e}(),gr="user",yr="device",vr="trace",Sr="web",_r="app",Er="os",wr=new pr,br="AppInsightsPropertiesPlugin",Cr="AppInsightsChannelPlugin",Tr=function e(t,n,i,s){se(e,this,(function(e){var r,o=null,a=[],c=!1;function l(){i&&Bt(i.getTransmissionControls(),(function(e){Bt(e,(function(e){return e.flush(!0)}))}))}i&&(r=i.logger),e.trackPageView=function(e,i){var u=e.name;if(At(u)||"string"!=typeof u){var d=hn();u=e.name=d&&d.title||""}var h=e.uri;if(At(h)||"string"!=typeof h){var f=mn();h=e.uri=f&&f.href||""}if(!s.isPerformanceTimingSupported())return t.sendPageViewInternal(e,i),l(),void r.throwInternal(ne.WARNING,Re,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");var p,m,g=!1,y=s.getPerformanceTiming().navigationStart;y>0&&(p=Ts(y,+new Date),s.shouldCollectDuration(p)||(p=void 0)),!At(i)&&!At(i.duration)&&(m=i.duration),(n||!isNaN(m))&&(isNaN(m)&&(i||(i={}),i.duration=p),t.sendPageViewInternal(e,i),l(),g=!0),i||(i={}),function(e){a.push(e),o||(o=setInterval((function(){var e=a.slice(0),t=!1;a=[],Bt(e,(function(e){e()?t=!0:a.push(e)})),0===a.length&&(clearInterval(o),o=null),t&&l()}),100))}((function(){var n=!1;try{if(s.isPerformanceTimingDataReady()){n=!0;var o={name:u,uri:h};s.populatePageViewPerformanceEvent(o),o.isValid||g?(g||(i.duration=o.durationMs,t.sendPageViewInternal(e,i)),c||(t.sendPageViewPerformanceInternal(o,i),c=!0)):(i.duration=p,t.sendPageViewInternal(e,i))}else y>0&&Ts(y,+new Date)>6e4&&(n=!0,g||(i.duration=6e4,t.sendPageViewInternal(e,i)))}catch(e){r.throwInternal(ne.CRITICAL,Be,"trackPageView failed on page load calculation: "+Jt(e),{exception:En(e)})}return n}))}}))},Mr=function(){function e(e,t){this.prevPageVisitDataKeyName="prevPageVisitData",this.pageVisitTimeTrackingHandler=t,this._logger=e}return e.prototype.trackPreviousPageVisit=function(e,t){try{var n=this.restartPageVisitTimer(e,t);n&&this.pageVisitTimeTrackingHandler(n.pageName,n.pageUrl,n.pageVisitTime)}catch(e){this._logger.warnToConsole("Auto track page visit time failed, metric will not be collected: "+En(e))}},e.prototype.restartPageVisitTimer=function(e,t){try{var n=this.stopPageVisitTimer();return this.startPageVisitTimer(e,t),n}catch(e){return this._logger.warnToConsole("Call to restart failed: "+En(e)),null}},e.prototype.startPageVisitTimer=function(e,t){try{if(hs()){null!=fs(this._logger,this.prevPageVisitDataKeyName)&&tn("Cannot call startPageVisit consecutively without first calling stopPageVisit");var n=new Ar(e,t),i=vn().stringify(n);ps(this._logger,this.prevPageVisitDataKeyName,i)}}catch(e){this._logger.warnToConsole("Call to start failed: "+En(e))}},e.prototype.stopPageVisitTimer=function(){try{if(hs()){var e=Gt(),t=fs(this._logger,this.prevPageVisitDataKeyName);if(t&&yn()){var n=vn().parse(t);return n.pageVisitTime=e-n.pageVisitStartTime,function(e,t){var n=us();if(null!==n)try{return n.removeItem(t),!0}catch(t){as=!1,e.throwInternal(ne.WARNING,de,"Browser failed removal of session storage item. "+Jt(t),{exception:En(t)})}}(this._logger,this.prevPageVisitDataKeyName),n}return null}return null}catch(e){return this._logger.warnToConsole("Stop page visit timer failed: "+En(e)),null}},e}(),Ar=function(e,t){this.pageVisitStartTime=Gt(),this.pageName=e,this.pageUrl=t},kr=function(){function e(e){this.MAX_DURATION_ALLOWED=36e5,e&&(this._logger=e.logger)}return e.prototype.populatePageViewPerformanceEvent=function(e){e.isValid=!1;var t=this.getPerformanceNavigationTiming(),n=this.getPerformanceTiming(),i=0,s=0,r=0,o=0,a=0;(t||n)&&(t?(i=t.duration,s=0===t.startTime?t.connectEnd:Ts(t.startTime,t.connectEnd),r=Ts(t.requestStart,t.responseStart),o=Ts(t.responseStart,t.responseEnd),a=Ts(t.responseEnd,t.loadEventEnd)):(i=Ts(n.navigationStart,n.loadEventEnd),s=Ts(n.navigationStart,n.connectEnd),r=Ts(n.requestStart,n.responseStart),o=Ts(n.responseStart,n.responseEnd),a=Ts(n.responseEnd,n.loadEventEnd)),0===i?this._logger.throwInternal(ne.WARNING,me,"error calculating page view performance.",{total:i,network:s,request:r,response:o,dom:a}):this.shouldCollectDuration(i,s,r,o,a)?i<Math.floor(s)+Math.floor(r)+Math.floor(o)+Math.floor(a)?this._logger.throwInternal(ne.WARNING,fe,"client performance math error.",{total:i,network:s,request:r,response:o,dom:a}):(e.durationMs=i,e.perfTotal=e.duration=Xi(i),e.networkConnect=Xi(s),e.sentRequest=Xi(r),e.receivedResponse=Xi(o),e.domProcessing=Xi(a),e.isValid=!0):this._logger.throwInternal(ne.WARNING,Ke,"Invalid page load duration value. Browser perf data won't be sent.",{total:i,network:s,request:r,response:o,dom:a}))},e.prototype.getPerformanceTiming=function(){return this.isPerformanceTimingSupported()?gn().timing:null},e.prototype.getPerformanceNavigationTiming=function(){return this.isPerformanceNavigationTimingSupported()?gn().getEntriesByType("navigation")[0]:null},e.prototype.isPerformanceNavigationTimingSupported=function(){var e=gn();return e&&e.getEntriesByType&&e.getEntriesByType("navigation").length>0},e.prototype.isPerformanceTimingSupported=function(){var e=gn();return e&&e.timing},e.prototype.isPerformanceTimingDataReady=function(){var e=gn(),t=e?e.timing:0;return t&&t.domainLookupStart>0&&t.navigationStart>0&&t.responseStart>0&&t.requestStart>0&&t.loadEventEnd>0&&t.responseEnd>0&&t.connectEnd>0&&t.domLoading>0},e.prototype.shouldCollectDuration=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=fn()||{},i=["googlebot","adsbot-google","apis-google","mediapartners-google"],s=n.userAgent,r=!1;if(s)for(var o=0;o<i.length;o++)r=r||-1!==s.toLowerCase().indexOf(i[o]);if(r)return!1;for(o=0;o<e.length;o++)if(e[o]<0||e[o]>=this.MAX_DURATION_ALLOWED)return!1;return!0},e}(),Rr="duration",Pr="event";function Ir(e,t){e&&e.dispatchEvent&&t&&e.dispatchEvent(t)}var Nr=function(e){function t(){var n=e.call(this)||this;n.identifier="ApplicationInsightsAnalytics",n.priority=180,n.autoRoutePVDelay=500;var i,s,r,o,a;return se(t,n,(function(e,c){var l=mn();o=l&&l.href||"",e.getCookieMgr=function(){return si(e.core)},e.processTelemetry=function(t,n){Rn(e.core,(function(){return e.identifier+":processTelemetry"}),(function(){var i=!1,s=e._telemetryInitializers.length;n=e._getTelCtx(n);for(var r=0;r<s;++r){var o=e._telemetryInitializers[r];if(o)try{if(!1===o.apply(null,[t])){i=!0;break}}catch(e){n.diagLog().throwInternal(ne.CRITICAL,lt,"One of telemetry initializers failed, telemetry item will not be sent: "+Jt(e),{exception:En(e)},!0)}}i||e.processNext(t,n)}),(function(){return{item:t}}),!t.sync)},e.trackEvent=function(t,n){try{var i=mr.create(t,Rs.dataType,Rs.envelopeType,e.diagLog(),n);e.core.track(i)}catch(t){e.diagLog().throwInternal(ne.WARNING,Ye,"trackTrace failed, trace will not be collected: "+Jt(t),{exception:En(t)})}},e.startTrackEvent=function(t){try{i.start(t)}catch(t){e.diagLog().throwInternal(ne.CRITICAL,Le,"startTrackEvent failed, event will not be collected: "+Jt(t),{exception:En(t)})}},e.stopTrackEvent=function(t,n,s){try{i.stop(t,void 0,n)}catch(t){e.diagLog().throwInternal(ne.CRITICAL,De,"stopTrackEvent failed, event will not be collected: "+Jt(t),{exception:En(t)})}},e.trackTrace=function(t,n){try{var i=mr.create(t,nr.dataType,nr.envelopeType,e.diagLog(),n);e.core.track(i)}catch(t){e.diagLog().throwInternal(ne.WARNING,Ye,"trackTrace failed, trace will not be collected: "+Jt(t),{exception:En(t)})}},e.trackMetric=function(t,n){try{var i=mr.create(t,Zs.dataType,Zs.envelopeType,e.diagLog(),n);e.core.track(i)}catch(t){e.diagLog().throwInternal(ne.CRITICAL,je,"trackMetric failed, metric will not be collected: "+Jt(t),{exception:En(t)})}},e.trackPageView=function(t,n){try{var i=t||{};e._pageViewManager.trackPageView(i,T({},i.properties,i.measurements,n)),e.config.autoTrackPageVisitTime&&e._pageVisitTimeManager.trackPreviousPageVisit(i.name,i.uri)}catch(t){e.diagLog().throwInternal(ne.CRITICAL,He,"trackPageView failed, page view will not be collected: "+Jt(t),{exception:En(t)})}},e.sendPageViewInternal=function(t,n,i){var s=hn();s&&(t.refUri=void 0===t.refUri?s.referrer:t.refUri);var r=mr.create(t,er.dataType,er.envelopeType,e.diagLog(),n,i);e.core.track(r),0},e.sendPageViewPerformanceInternal=function(t,n,i){var s=mr.create(t,ir.dataType,ir.envelopeType,e.diagLog(),n,i);e.core.track(s)},e.trackPageViewPerformance=function(t,n){try{e._pageViewPerformanceManager.populatePageViewPerformanceEvent(t),e.sendPageViewPerformanceInternal(t,n)}catch(t){e.diagLog().throwInternal(ne.CRITICAL,He,"trackPageViewPerformance failed, page view will not be collected: "+Jt(t),{exception:En(t)})}},e.startTrackPage=function(t){try{if("string"!=typeof t){var n=hn();t=n&&n.title||""}s.start(t)}catch(t){e.diagLog().throwInternal(ne.CRITICAL,xe,"startTrackPage failed, page view may not be collected: "+Jt(t),{exception:En(t)})}},e.stopTrackPage=function(t,n,i,r){try{if("string"!=typeof t){var o=hn();t=o&&o.title||""}if("string"!=typeof n){var a=mn();n=a&&a.href||""}s.stop(t,n,i,r),e.config.autoTrackPageVisitTime&&e._pageVisitTimeManager.trackPreviousPageVisit(t,n)}catch(t){e.diagLog().throwInternal(ne.CRITICAL,Oe,"stopTrackPage failed, page view will not be collected: "+Jt(t),{exception:En(t)})}},e.sendExceptionInternal=function(t,n,i){var s=t.exception||t.error||new Error(rs),r=new $s(e.diagLog(),s,t.properties||n,t.measurements,t.severityLevel,t.id).toInterface(),o=mr.create(r,$s.dataType,$s.envelopeType,e.diagLog(),n,i);e.core.track(o)},e.trackException=function(t,n){try{e.sendExceptionInternal(t,n)}catch(t){e.diagLog().throwInternal(ne.CRITICAL,Ue,"trackException failed, exception will not be collected: "+Jt(t),{exception:En(t)})}},e._onerror=function(t){var n=t&&t.error,i=t&&t.evt;try{if(!i){var s=un();s&&(i=s[Pr])}var r=t&&t.url||(hn()||{}).URL,o=t.errorSrc||"window.onerror@"+r+":"+(t.lineNumber||0)+":"+(t.columnNumber||0),a={errorSrc:o,url:r,lineNumber:t.lineNumber||0,columnNumber:t.columnNumber||0,message:t.message};!function(e,t,n,i,s){return!s&&Ut(e)&&("Script error."===e||"Script error"===e)}(t.message,t.url,t.lineNumber,t.columnNumber,t.error)?(t.errorSrc||(t.errorSrc=o),e.trackException({exception:t,severityLevel:Js.Error},a)):function(t,n){var i=mr.create(t,$s.dataType,$s.envelopeType,e.diagLog(),n);e.core.track(i)}($s.CreateAutoException("Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",r,t.lineNumber||0,t.columnNumber||0,n,i,null,o),a)}catch(t){var c=n?n.name+", "+n.message:"null";e.diagLog().throwInternal(ne.CRITICAL,ge,"_onError threw exception while logging error, error will not be collected: "+Jt(t),{exception:En(t),errorString:c})}},e.addTelemetryInitializer=function(t){e._telemetryInitializers.push(t)},e.initialize=function(l,u,d,h){if(!e.isInitialized()){if(At(u))throw Error("Error initializing");c.initialize(l,u,d,h),e.setInitialized(!1);var f=e._getTelCtx(),p=e.identifier;e.config=f.getExtCfg(p);var m=t.getDefaultConfig(l);void 0!==m&&Dt(m,(function(t,n){e.config[t]=f.getConfig(p,t,n),void 0===e.config[t]&&(e.config[t]=n)})),e.config.isStorageUseDisabled&&(os=!1,as=!1);var g={instrumentationKey:function(){return l.instrumentationKey},accountId:function(){return e.config.accountId||l.accountId},sessionRenewalMs:function(){return e.config.sessionRenewalMs||l.sessionRenewalMs},sessionExpirationMs:function(){return e.config.sessionExpirationMs||l.sessionExpirationMs},sampleRate:function(){return e.config.samplingPercentage||l.samplingPercentage},sdkExtension:function(){return e.config.sdkExtension||l.sdkExtension},isBrowserLinkTrackingEnabled:function(){return e.config.isBrowserLinkTrackingEnabled||l.isBrowserLinkTrackingEnabled},appId:function(){return e.config.appId||l.appId}};e._pageViewPerformanceManager=new kr(e.core),e._pageViewManager=new Tr(n,e.config.overridePageViewDuration,e.core,e._pageViewPerformanceManager),e._pageVisitTimeManager=new Mr(e.diagLog(),(function(t,n,i){return function(t,n,i){var s={PageName:t,PageUrl:n};e.trackMetric({name:"PageVisitTime",average:i,max:i,min:i,sampleCount:1},s)}(t,n,i)})),e._telemetryInitializers=e._telemetryInitializers||[],function(t){if(!t.isBrowserLinkTrackingEnabled()){var n=["/browserLinkSignalR/","/__browserLink/"];!function(t){e._telemetryInitializers.push(t)}((function(e){if(e.baseType===tr.dataType){var t=e.baseData;if(t)for(var i=0;i<n.length;i++)if(t.target&&t.target.indexOf(n[i])>=0)return!1}return!0}))}}(g),(i=new Lr(e.diagLog(),"trackEvent")).action=function(t,n,i,s){s||(s={}),s[Rr]=i.toString(),e.trackEvent({name:t,properties:s})},(s=new Lr(e.diagLog(),"trackPageView")).action=function(t,n,i,s,r){At(s)&&(s={}),s[Rr]=i.toString();var o={name:t,uri:n,properties:s,measurements:r};e.sendPageViewInternal(o,s)};var y=un(),v=pn(),S=mn(),_=n;if(!1===e.config.disableExceptionTracking&&!e.config.autoExceptionInstrumented&&y){var E=y.onerror;y.onerror=function(e,t,n,i,s){var r=y[Pr],o=E&&E(e,t,n,i,s);return!0!==o&&_._onerror($s.CreateAutoException(e,t,n,i,s,r)),o},e.config.autoExceptionInstrumented=!0}if(!1===e.config.disableExceptionTracking&&!0===e.config.enableUnhandledPromiseRejectionTracking&&!e.config.autoUnhandledPromiseInstrumented&&y){var w="onunhandledrejection",b=y[w];y[w]=function(e){var t=y[Pr],n=b&&b.call(y,e);return!0!==n&&_._onerror($s.CreateAutoException(e.reason.toString(),S?S.href:"",0,0,e,t)),n},e.config.autoUnhandledPromiseInstrumented=!0}if(!0===e.config.enableAutoRouteTracking&&v&&It(v.pushState)&&It(v.replaceState)&&y&&"undefined"!=typeof Event){var C=n;Bt(d,(function(e){e.identifier===br&&(r=e)})),v.pushState=(T=v.pushState,function(){var e=T.apply(this,arguments);return Ir(y,Gi(C.config.namePrefix+"pushState")),Ir(y,Gi(C.config.namePrefix+"locationchange")),e}),v.replaceState=function(e){return function(){var t=e.apply(this,arguments);return Ir(y,Gi(C.config.namePrefix+"replaceState")),Ir(y,Gi(C.config.namePrefix+"locationchange")),t}}(v.replaceState),y.addEventListener&&(y.addEventListener(C.config.namePrefix+"popstate",(function(){Ir(y,Gi(C.config.namePrefix+"locationchange"))})),y.addEventListener(C.config.namePrefix+"locationchange",(function(){if(r&&r.context&&r.context.telemetryTrace){r.context.telemetryTrace.traceID=Ci();var e="_unknown_";S&&S.pathname&&(e=S.pathname+(S.hash||"")),r.context.telemetryTrace.name=e}a&&(o=a),a=S&&S.href||"",setTimeout(function(e){C.trackPageView({refUri:e,properties:{duration:0}})}.bind(n,o),C.autoRoutePVDelay)})))}e.setInitialized(!0)}var T}})),n}return A(t,e),t.getDefaultConfig=function(e){return e||(e={}),e.sessionRenewalMs=18e5,e.sessionExpirationMs=864e5,e.disableExceptionTracking=Ji(e.disableExceptionTracking),e.autoTrackPageVisitTime=Ji(e.autoTrackPageVisitTime),e.overridePageViewDuration=Ji(e.overridePageViewDuration),e.enableUnhandledPromiseRejectionTracking=Ji(e.enableUnhandledPromiseRejectionTracking),(isNaN(e.samplingPercentage)||e.samplingPercentage<=0||e.samplingPercentage>=100)&&(e.samplingPercentage=100),e.isStorageUseDisabled=Ji(e.isStorageUseDisabled),e.isBrowserLinkTrackingEnabled=Ji(e.isBrowserLinkTrackingEnabled),e.enableAutoRouteTracking=Ji(e.enableAutoRouteTracking),e.namePrefix=e.namePrefix||"",e.enableDebug=Ji(e.enableDebug),e.disableFlushOnBeforeUnload=Ji(e.disableFlushOnBeforeUnload),e.disableFlushOnUnload=Ji(e.disableFlushOnUnload,e.disableFlushOnBeforeUnload),e},t.Version="2.6.4",t}(xn),Lr=function(e,t){var n=this,i={};n.start=function(t){void 0!==i[t]&&e.throwInternal(ne.WARNING,at,"start was called more than once for this event without calling stop.",{name:t,key:t},!0),i[t]=+new Date},n.stop=function(t,s,r,o){var a=i[t];if(isNaN(a))e.throwInternal(ne.WARNING,ct,"stop was called without a corresponding start.",{name:t,key:t},!0);else{var c=Ts(a,+new Date);n.action(t,s,c,r,o)}delete i[t],i[t]=void 0}},Dr=function e(t){var n=[];se(e,this,(function(e){e.enqueue=function(e){n.push(e)},e.count=function(){return n.length},e.clear=function(){n.length=0},e.getItems=function(){return n.slice(0)},e.batchPayloads=function(e){return e&&e.length>0?t.emitLineDelimitedJson()?e.join("\n"):"["+e.join(",")+"]":null},e.markAsSent=function(t){e.clear()},e.clearSent=function(e){}}))},xr=function(){function e(t,n){var i,s=!1;se(e,this,(function(r){var o=l(e.BUFFER_KEY),a=l(e.SENT_BUFFER_KEY);function c(e,t){var n=[];return Bt(t,(function(t){!It(t)&&-1===Yt(e,t)&&n.push(t)})),n}function l(e){var i=e;try{i=n.namePrefix&&n.namePrefix()?n.namePrefix()+"_"+i:i;var s=fs(t,i);if(s){var r=vn().parse(s);if(Ut(r)&&(r=vn().parse(r)),r&&Ot(r))return r}}catch(e){t.throwInternal(ne.CRITICAL,Ve," storage key: "+i+", "+Jt(e),{exception:En(e)})}return[]}function u(e,i){var s=e;try{s=n.namePrefix&&n.namePrefix()?n.namePrefix()+"_"+s:s;var r=JSON.stringify(i);ps(t,s,r)}catch(e){ps(t,s,JSON.stringify([])),t.throwInternal(ne.WARNING,qe," storage key: "+s+", "+Jt(e)+". Buffer cleared",{exception:En(e)})}}(i=o.concat(a)).length>e.MAX_BUFFER_SIZE&&(i.length=e.MAX_BUFFER_SIZE),u(e.SENT_BUFFER_KEY,[]),u(e.BUFFER_KEY,i),r.enqueue=function(n){i.length>=e.MAX_BUFFER_SIZE?s||(t.throwInternal(ne.WARNING,dt,"Maximum buffer size reached: "+i.length,!0),s=!0):(i.push(n),u(e.BUFFER_KEY,i))},r.count=function(){return i.length},r.clear=function(){i=[],u(e.BUFFER_KEY,[]),u(e.SENT_BUFFER_KEY,[]),s=!1},r.getItems=function(){return i.slice(0)},r.batchPayloads=function(e){return e&&e.length>0?n.emitLineDelimitedJson()?e.join("\n"):"["+e.join(",")+"]":null},r.markAsSent=function(n){i=c(n,i),u(e.BUFFER_KEY,i);var s=l(e.SENT_BUFFER_KEY);s instanceof Array&&n instanceof Array&&((s=s.concat(n)).length>e.MAX_BUFFER_SIZE&&(t.throwInternal(ne.CRITICAL,dt,"Sent buffer reached its maximum size: "+s.length,!0),s.length=e.MAX_BUFFER_SIZE),u(e.SENT_BUFFER_KEY,s))},r.clearSent=function(t){var n=l(e.SENT_BUFFER_KEY);n=c(t,n),u(e.SENT_BUFFER_KEY,n)}}))}return e.BUFFER_KEY="AI_buffer",e.SENT_BUFFER_KEY="AI_sentBuffer",e.MAX_BUFFER_SIZE=2e3,e}(),Or="baseType",Fr="baseData",Ur="properties";function jr(e,t,n){return Xt(e,t,n,en)}var Hr=function(){function e(){}return e.extractPropsAndMeasurements=function(e,t,n){At(e)||Dt(e,(function(e,i){jt(i)?n[e]=i:Ut(i)?t[e]=i:yn()&&(t[e]=vn().stringify(i))}))},e.createEnvelope=function(t,n,i,s){var r=new As(t,s,n);jr(r,"sampleRate",i[ns]),(i[Fr]||{}).startTime&&(r.time=Ht(i[Fr].startTime)),r.iKey=i.iKey;var o=i.iKey.replace(/-/g,"");return r.name=r.name.replace("{0}",o),e.extractPartAExtensions(i,r),i.tags=i.tags||[],nn(r)},e.extractPartAExtensions=function(t,n){var i=n.tags=n.tags||{},s=t.ext=t.ext||{},r=t.tags=t.tags||[],o=s.user;o&&(jr(i,wr.userAuthUserId,o.authId),jr(i,wr.userId,o.id||o.localId));var a=s.app;a&&jr(i,wr.sessionId,a.sesId);var c=s.device;c&&(jr(i,wr.deviceId,c.id||c.localId),jr(i,wr.deviceType,c.deviceClass),jr(i,wr.deviceIp,c.ip),jr(i,wr.deviceModel,c.model),jr(i,wr.deviceType,c.deviceType));var l=t.ext.web;if(l){jr(i,wr.deviceLanguage,l.browserLang),jr(i,wr.deviceBrowserVersion,l.browserVer),jr(i,wr.deviceBrowser,l.browser);var u=n.data=n.data||{},d=u[Fr]=u[Fr]||{},h=d[Ur]=d[Ur]||{};jr(h,"domain",l.domain),jr(h,"isManual",l.isManual?"true":null),jr(h,"screenRes",l.screenRes),jr(h,"userConsent",l.userConsent?"true":null)}var f=s.os;f&&jr(i,wr.deviceOS,f.name);var p=s.trace;p&&(jr(i,wr.operationParentId,p.parentID),jr(i,wr.operationName,p.name),jr(i,wr.operationId,p.traceID));for(var m={},g=r.length-1;g>=0;g--){Dt(r[g],(function(e,t){m[e]=t})),r.splice(g,1)}Dt(r,(function(e,t){m[e]=t}));var y=T({},i,m);y[wr.internalSdkVersion]||(y[wr.internalSdkVersion]="javascript:"+e.Version),n.tags=nn(y)},e.prototype.Init=function(e,t){this._logger=e,At(t[Fr])&&this._logger.throwInternal(ne.CRITICAL,ze,"telemetryItem.baseData cannot be null.")},e.Version="2.6.4",e}(),Br=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var i=n[Fr].measurements||{},s=n[Fr][Ur]||{};Hr.extractPropsAndMeasurements(n.data,s,i);var r=n[Fr];if(At(r))return t.warnToConsole("Invalid input for dependency data"),null;var o=r[Ur]&&r[Ur][ss]?r[Ur][ss]:"GET",a=new tr(t,r.id,r.target,r.name,r.duration,r.success,r.responseCode,o,r.type,r.correlationContext,s,i),c=new sr(tr.dataType,a);return Hr.createEnvelope(t,tr.envelopeType,n,c)},t.DependencyEnvelopeCreator=new t,t}(Hr),Yr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var i={},s={};n[Or]!==Rs.dataType&&(i.baseTypeSource=n[Or]),n[Or]===Rs.dataType?(i=n[Fr][Ur]||{},s=n[Fr].measurements||{}):n[Fr]&&Hr.extractPropsAndMeasurements(n[Fr],i,s),Hr.extractPropsAndMeasurements(n.data,i,s);var r=n[Fr].name,o=new Rs(t,r,i,s),a=new sr(Rs.dataType,o);return Hr.createEnvelope(t,Rs.envelopeType,n,a)},t.EventEnvelopeCreator=new t,t}(Hr),Wr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var i=n[Fr].measurements||{},s=n[Fr][Ur]||{};Hr.extractPropsAndMeasurements(n.data,s,i);var r=n[Fr],o=$s.CreateFromInterface(t,r,s,i),a=new sr($s.dataType,o);return Hr.createEnvelope(t,$s.envelopeType,n,a)},t.ExceptionEnvelopeCreator=new t,t}(Hr),qr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var i=n[Fr],s=i[Ur]||{},r=i.measurements||{};Hr.extractPropsAndMeasurements(n.data,s,r);var o=new Zs(t,i.name,i.average,i.sampleCount,i.min,i.max,s,r),a=new sr(Zs.dataType,o);return Hr.createEnvelope(t,Zs.envelopeType,n,a)},t.MetricEnvelopeCreator=new t,t}(Hr),Vr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var i,s="duration",r=n[Fr];At(r)||At(r[Ur])||At(r[Ur][s])?!At(n.data)&&!At(n.data[s])&&(i=n.data[s],delete n.data[s]):(i=r[Ur][s],delete r[Ur][s]);var o,a=n[Fr];((n.ext||{}).trace||{}).traceID&&(o=n.ext.trace.traceID);var c=a.id||o,l=a.name,u=a.uri,d=a[Ur]||{},h=a.measurements||{};(At(a.refUri)||(d.refUri=a.refUri),At(a.pageType)||(d.pageType=a.pageType),At(a.isLoggedIn)||(d.isLoggedIn=a.isLoggedIn.toString()),At(a[Ur]))||Dt(a[Ur],(function(e,t){d[e]=t}));Hr.extractPropsAndMeasurements(n.data,d,h);var f=new er(t,l,u,i,d,h,c),p=new sr(er.dataType,f);return Hr.createEnvelope(t,er.envelopeType,n,p)},t.PageViewEnvelopeCreator=new t,t}(Hr),$r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var i=n[Fr],s=i.name,r=i.uri||i.url,o=i[Ur]||{},a=i.measurements||{};Hr.extractPropsAndMeasurements(n.data,o,a);var c=new ir(t,s,r,void 0,o,a,i),l=new sr(ir.dataType,c);return Hr.createEnvelope(t,ir.envelopeType,n,l)},t.PageViewPerformanceEnvelopeCreator=new t,t}(Hr),Kr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var i=n[Fr].message,s=n[Fr].severityLevel,r=n[Fr][Ur]||{},o=n[Fr].measurements||{};Hr.extractPropsAndMeasurements(n.data,r,o);var a=new nr(t,i,s,r,o),c=new sr(nr.dataType,a);return Hr.createEnvelope(t,nr.envelopeType,n,c)},t.TraceEnvelopeCreator=new t,t}(Hr),zr=function e(t){se(e,this,(function(e){function n(e,r){var o="__aiCircularRefCheck",a={};if(!e)return t.throwInternal(ne.CRITICAL,Je,"cannot serialize object because it is null or undefined",{name:r},!0),a;if(e[o])return t.throwInternal(ne.WARNING,Ze,"Circular reference detected while serializing object",{name:r},!0),a;if(!e.aiDataContract){if("measurements"===r)a=s(e,"number",r);else if("properties"===r)a=s(e,"string",r);else if("tags"===r)a=s(e,"string",r);else if(Ot(e))a=i(e,r);else{t.throwInternal(ne.WARNING,Xe,"Attempting to serialize an object which does not implement ISerializable",{name:r},!0);try{vn().stringify(e),a=e}catch(e){t.throwInternal(ne.CRITICAL,Je,e&&It(e.toString)?e.toString():"Error serializing object",null,!0)}}return a}return e[o]=!0,Dt(e.aiDataContract,(function(s,o){var c=It(o)?1&o():1&o,l=It(o)?4&o():4&o,u=2&o,d=void 0!==e[s],h=Pt(e[s])&&null!==e[s];if(!c||d||u){if(!l){var f=void 0;void 0!==(f=h?u?i(e[s],s):n(e[s],s):e[s])&&(a[s]=f)}}else t.throwInternal(ne.CRITICAL,ke,"Missing required field specification. The field is required but not present on source",{field:s,name:r})})),delete e[o],a}function i(e,i){var s;if(e)if(Ot(e)){s=[];for(var r=0;r<e.length;r++){var o=n(e[r],i+"["+r+"]");s.push(o)}}else t.throwInternal(ne.CRITICAL,et,"This field was specified as an array in the contract but the item is not an array.\r\n",{name:i},!0);return s}function s(e,n,i){var s;return e&&(s={},Dt(e,(function(e,r){if("string"===n)void 0===r?s[e]="undefined":null===r?s[e]="null":r.toString?s[e]=r.toString():s[e]="invalid field: toString() is not defined.";else if("number"===n)if(void 0===r)s[e]="undefined";else if(null===r)s[e]="null";else{var o=parseFloat(r);isNaN(o)?s[e]="NaN":s[e]=o}else s[e]="invalid field: "+i+" is of unknown type.",t.throwInternal(ne.CRITICAL,s[e],null,!0)}))),s}e.serialize=function(e){var i=n(e,"root");try{return vn().stringify(i)}catch(e){t.throwInternal(ne.CRITICAL,Je,e&&It(e.toString)?e.toString():"Error serializing object",null,!0)}}}))},Gr=function(){function e(){var t=un(),n=hn(),i=!1,s=!0;se(e,this,(function(e){try{if(t&&Ti.Attach(t,"online",a)&&(Ti.Attach(t,"offline",c),i=!0),n){var r=n.body||n;Mt(r.ononline)||(r.ononline=a,r.onoffline=c,i=!0)}if(i){var o=fn();o&&!At(o.onLine)&&(s=o.onLine)}}catch(e){i=!1}function a(){s=!0}function c(){s=!1}e.isListening=i,e.isOnline=function(){var e=!0,t=fn();return i?e=s:t&&!At(t.onLine)&&(e=t.onLine),e},e.isOffline=function(){return!e.isOnline()}}))}return e.Offline=new e,e}().Offline,Jr=function(){function e(){}return e.prototype.getHashCodeScore=function(t){return 100*(this.getHashCode(t)/e.INT_MAX_VALUE)},e.prototype.getHashCode=function(t){if(""===t)return 0;for(;t.length<e.MIN_INPUT_LENGTH;)t=t.concat(t);for(var n=5381,i=0;i<t.length;++i)n=(n<<5)+n+t.charCodeAt(i),n&=n;return Math.abs(n)},e.INT_MAX_VALUE=2147483647,e.MIN_INPUT_LENGTH=8,e}(),Xr=function(){function e(){this.hashCodeGeneragor=new Jr,this.keys=new pr}return e.prototype.getSamplingScore=function(e){return e.tags&&e.tags[this.keys.userId]?this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.userId]):e.ext&&e.ext.user&&e.ext.user.id?this.hashCodeGeneragor.getHashCodeScore(e.ext.user.id):e.tags&&e.tags[this.keys.operationId]?this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.operationId]):e.ext&&e.ext.telemetryTrace&&e.ext.telemetryTrace.traceID?this.hashCodeGeneragor.getHashCodeScore(e.ext.telemetryTrace.traceID):100*Math.random()},e}(),Zr=function(){function e(e,t){this.INT_MAX_VALUE=2147483647,this._logger=t||Cn(null),(e>100||e<0)&&(this._logger.throwInternal(ne.WARNING,st,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this.sampleRate=e,this.samplingScoreGenerator=new Xr}return e.prototype.isSampledIn=function(e){var t=this.sampleRate;return null==t||t>=100||e.baseType===Zs.dataType||this.samplingScoreGenerator.getSamplingScore(e)<t},e}();function Qr(e){try{return e.responseText}catch(e){}return null}var eo=function(e){function t(){var n=e.call(this)||this;n.priority=1001,n.identifier=Cr,n._XMLHttpRequestSupported=!1;var i,s,r,o,a,c={};return se(t,n,(function(e,l){function u(){tn("Method not implemented.")}function d(t,n,s,r,o,a){var c=null;if(e._appId||(c=y(a))&&c.appId&&(e._appId=c.appId),(t<200||t>=300)&&0!==t){if((301===t||307===t||308===t)&&!h(s))return void e._onError(n,o);!e._senderConfig.isRetryDisabled()&&_(t)?(v(n),e.diagLog().throwInternal(ne.WARNING,We,". Response code "+t+". Will retry to send "+n.length+" items.")):e._onError(n,o)}else if(Gr.isOffline()){if(!e._senderConfig.isRetryDisabled()){v(n,10),e.diagLog().throwInternal(ne.WARNING,We,". Offline - Response Code: "+t+". Offline status: "+Gr.isOffline()+". Will retry to send "+n.length+" items.")}}else h(s),206===t?(c||(c=y(a)),c&&!e._senderConfig.isRetryDisabled()?e._onPartialSuccess(n,c):e._onError(n,o)):(i=0,e._onSuccess(n,r))}function h(t){return!(a>=10)&&(!At(t)&&""!==t&&t!==e._senderConfig.endpointUrl()&&(e._senderConfig.endpointUrl=function(){return t},++a,!0))}function p(t,n){var i=e._senderConfig.endpointUrl(),s=e._buffer.batchPayloads(t),r=new Blob([s],{type:"text/plain;charset=UTF-8"});fn().sendBeacon(i,r)?(e._buffer.markAsSent(t),e._onSuccess(t,t.length)):(m(t,!0),e.diagLog().throwInternal(ne.WARNING,We,". Failed to send telemetry with Beacon API, retried with xhrSender."))}function m(t,n){var i=new XMLHttpRequest,s=e._senderConfig.endpointUrl();try{i[ts]=!0}catch(e){}i.open("POST",s,n),i.setRequestHeader("Content-type","application/json"),ws(s)&&i.setRequestHeader(Ui,ji),Bt(Kt(c),(function(e){i.setRequestHeader(e,c[e])})),i.onreadystatechange=function(){return e._xhrReadyStateChange(i,t,t.length)},i.onerror=function(n){return e._onError(t,E(i),n)};var r=e._buffer.batchPayloads(t);i.send(r),e._buffer.markAsSent(t)}function g(t,n){var i=e._senderConfig.endpointUrl(),s=e._buffer.batchPayloads(t),r=new Blob([s],{type:"text/plain;charset=UTF-8"}),o=new Headers;ws(i)&&o.append(Ui,ji),Bt(Kt(c),(function(e){o.append(e,c[e])}));var a=new Request(i,{method:"POST",headers:o,body:r});fetch(a).then((function(n){if(!n.ok)throw Error(n.statusText);n.text().then((function(e){d(n.status,t,n.url,t.length,n.statusText,e)})),e._buffer.markAsSent(t)})).catch((function(n){e._onError(t,n.message)}))}function y(t){try{if(t&&""!==t){var n=vn().parse(t);if(n&&n.itemsReceived&&n.itemsReceived>=n.itemsAccepted&&n.itemsReceived-n.itemsAccepted===n.errors.length)return n}}catch(n){e.diagLog().throwInternal(ne.CRITICAL,$e,"Cannot parse the response. "+Jt(n),{response:t})}return null}function v(t,n){if(void 0===n&&(n=1),t&&0!==t.length){e._buffer.clearSent(t),i++;for(var r=0,o=t;r<o.length;r++){var a=o[r];e._buffer.enqueue(a)}(function(e){var t;if(i<=1)t=10;else{var n=(Math.pow(2,i)-1)/2,r=Math.floor(Math.random()*n*10)+1;r*=e,t=Math.max(Math.min(r,3600),10)}var o=Gt()+1e3*t;s=o})(n),S()}}function S(){if(!r){var t=s?Math.max(0,s-Gt()):0,n=Math.max(e._senderConfig.maxBatchInterval(),t);r=setTimeout((function(){e.triggerSend(!0,null,1)}),n)}}function _(e){return 408===e||429===e||500===e||503===e}function E(e,t){return e?"XMLHttpRequest,Status:"+e.status+",Response:"+Qr(e)||!1:t}function w(t,n){var i=un(),s=new XDomainRequest;s.onload=function(){return e._xdrOnLoad(s,t)},s.onerror=function(n){return e._onError(t,b(s),n)};var r=i&&i.location&&i.location.protocol||"";if(0!==e._senderConfig.endpointUrl().lastIndexOf(r,0))return e.diagLog().throwInternal(ne.WARNING,We,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),void e._buffer.clear();var o=e._senderConfig.endpointUrl().replace(/^(https?:)/,"");s.open("POST",o);var a=e._buffer.batchPayloads(t);s.send(a),e._buffer.markAsSent(t)}function b(e,t){return e?"XDomainRequest,Response:"+Qr(e)||!1:t}e.pause=u,e.resume=u,e.flush=function(){try{e.triggerSend(!0,null,1)}catch(t){e.diagLog().throwInternal(ne.CRITICAL,Me,"flush failed, telemetry will not be collected: "+Jt(t),{exception:En(t)})}},e.onunloadFlush=function(){if(!1!==e._senderConfig.onunloadDisableBeacon()&&!1!==e._senderConfig.isBeaconApiDisabled()||!Zi())e.flush();else try{e.triggerSend(!0,p,2)}catch(t){e.diagLog().throwInternal(ne.CRITICAL,Te,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+Jt(t),{exception:En(t)})}},e.teardown=u,e.addHeader=function(e,t){c[e]=t},e.initialize=function(r,c,u,d){l.initialize(r,c,u,d);var h=e._getTelCtx(),y=e.identifier;o=new zr(c.logger),i=0,s=null,0,e._sender=null,a=0;var v=t._getDefaultAppInsightsChannelConfig();if(e._senderConfig=t._getEmptyAppInsightsChannelConfig(),Dt(v,(function(t,n){e._senderConfig[t]=function(){return h.getConfig(y,t,n())}})),e._buffer=e._senderConfig.enableSessionStorageBuffer()&&hs()?new xr(e.diagLog(),e._senderConfig):new Dr(e._senderConfig),e._sample=new Zr(e._senderConfig.samplingPercentage(),e.diagLog()),function(e){return!(At(e.disableInstrumentationKeyValidation)||!e.disableInstrumentationKeyValidation)||new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(e.instrumentationKey)}(r)||e.diagLog().throwInternal(ne.CRITICAL,St,"Invalid Instrumentation key "+r.instrumentationKey),!ws(e._senderConfig.endpointUrl())&&e._senderConfig.customHeaders()&&e._senderConfig.customHeaders().length>0&&Bt(e._senderConfig.customHeaders(),(function(e){n.addHeader(e.header,e.value)})),!e._senderConfig.isBeaconApiDisabled()&&Zi())e._sender=p;else{var S=cn("XMLHttpRequest");if(S)"withCredentials"in new S?(e._sender=m,e._XMLHttpRequestSupported=!0):typeof XDomainRequest!==f&&(e._sender=w);else cn("fetch")&&(e._sender=g)}},e.processTelemetry=function(n,i){i=e._getTelCtx(i);try{if(e._senderConfig.disableTelemetry())return;if(!n)return void i.diagLog().throwInternal(ne.CRITICAL,he,"Cannot send empty telemetry");if(n.baseData&&!n.baseType)return void i.diagLog().throwInternal(ne.CRITICAL,pt,"Cannot send telemetry without baseData and baseType");if(n.baseType||(n.baseType="EventData"),!e._sender)return void i.diagLog().throwInternal(ne.CRITICAL,Ne,"Sender was not initialized");if(!function(t){return e._sample.isSampledIn(t)}(n))return void i.diagLog().throwInternal(ne.WARNING,Fe,"Telemetry item was sampled out and not sent",{SampleRate:e._sample.sampleRate});n[ns]=e._sample.sampleRate;var s=t.constructEnvelope(n,e._senderConfig.instrumentationKey(),i.diagLog());if(!s)return void i.diagLog().throwInternal(ne.CRITICAL,Ge,"Unable to create an AppInsights envelope");var r=!1;if(n.tags&&n.tags[is]&&(Bt(n.tags[is],(function(e){try{e&&!1===e(s)&&(r=!0,i.diagLog().warnToConsole("Telemetry processor check returns false"))}catch(e){i.diagLog().throwInternal(ne.CRITICAL,lt,"One of telemetry initializers failed, telemetry item will not be sent: "+Jt(e),{exception:En(e)},!0)}})),delete n.tags[is]),r)return;var a=o.serialize(s),c=e._buffer.getItems(),l=e._buffer.batchPayloads(c);l&&l.length+a.length>e._senderConfig.maxBatchSizeInBytes()&&e.triggerSend(!0,null,10),e._buffer.enqueue(a),S()}catch(e){i.diagLog().throwInternal(ne.WARNING,ye,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+Jt(e),{exception:En(e)})}e.processNext(n,i)},e._xhrReadyStateChange=function(e,t,n){4===e.readyState&&d(e.status,t,e.responseURL,n,E(e),Qr(e)||e.response)},e.triggerSend=function(t,i,o){void 0===t&&(t=!0);try{if(e._senderConfig.disableTelemetry())e._buffer.clear();else{if(e._buffer.count()>0){var a=e._buffer.getItems();(function(t,n){var i=function(){var t="getNotifyMgr";return e.core[t]?e.core[t]():e.core._notificationManager}();if(i&&i.eventsSendRequest)try{i.eventsSendRequest(t,n)}catch(t){e.diagLog().throwInternal(ne.CRITICAL,vt,"send request notification failed: "+Jt(t),{exception:En(t)})}})(o||0,t),i?i.call(n,a,t):e._sender(a,t)}+new Date}clearTimeout(r),r=null,s=null}catch(t){var c=_n();(!c||c>9)&&e.diagLog().throwInternal(ne.CRITICAL,We,"Telemetry transmission failed, some telemetry will be lost: "+Jt(t),{exception:En(t)})}},e._onError=function(t,n,i){e.diagLog().throwInternal(ne.WARNING,Pe,"Failed to send telemetry.",{message:n}),e._buffer.clearSent(t)},e._onPartialSuccess=function(t,n){for(var i=[],s=[],r=0,o=n.errors.reverse();r<o.length;r++){var a=o[r],c=t.splice(a.index,1)[0];_(a.statusCode)?s.push(c):i.push(c)}t.length>0&&e._onSuccess(t,n.itemsAccepted),i.length>0&&e._onError(i,E(null,["partial success",n.itemsAccepted,"of",n.itemsReceived].join(" "))),s.length>0&&(v(s),e.diagLog().throwInternal(ne.WARNING,We,"Partial success. Delivered: "+t.length+", Failed: "+i.length+". Will retry to send "+s.length+" our of "+n.itemsReceived+" items"))},e._onSuccess=function(t,n){e._buffer.clearSent(t)},e._xdrOnLoad=function(t,n){var s=Qr(t);if(!t||s+""!="200"&&""!==s){var r=y(s);r&&r.itemsReceived&&r.itemsReceived>r.itemsAccepted&&!e._senderConfig.isRetryDisabled()?e._onPartialSuccess(n,r):e._onError(n,b(t))}else i=0,e._onSuccess(n,0)}})),n}return A(t,e),t.constructEnvelope=function(e,t,n){var i;switch((i=t===e.iKey||At(t)?e:T({},e,{iKey:t})).baseType){case Rs.dataType:return Yr.EventEnvelopeCreator.Create(n,i);case nr.dataType:return Kr.TraceEnvelopeCreator.Create(n,i);case er.dataType:return Vr.PageViewEnvelopeCreator.Create(n,i);case ir.dataType:return $r.PageViewPerformanceEnvelopeCreator.Create(n,i);case $s.dataType:return Wr.ExceptionEnvelopeCreator.Create(n,i);case Zs.dataType:return qr.MetricEnvelopeCreator.Create(n,i);case tr.dataType:return Br.DependencyEnvelopeCreator.Create(n,i);default:return Yr.EventEnvelopeCreator.Create(n,i)}},t._getDefaultAppInsightsChannelConfig=function(){return{endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){},namePrefix:function(){},samplingPercentage:function(){return 100},customHeaders:function(){}}},t._getEmptyAppInsightsChannelConfig=function(){return{endpointUrl:void 0,emitLineDelimitedJson:void 0,maxBatchInterval:void 0,maxBatchSizeInBytes:void 0,disableTelemetry:void 0,enableSessionStorageBuffer:void 0,isRetryDisabled:void 0,isBeaconApiDisabled:void 0,onunloadDisableBeacon:void 0,instrumentationKey:void 0,namePrefix:void 0,samplingPercentage:void 0,customHeaders:void 0}},t}(xn),to=function(){},no=function(){function e(t,n){var i,s,r=Cn(n),o=si(n);se(e,this,(function(n){t||(t={}),It(t.sessionExpirationMs)||(t.sessionExpirationMs=function(){return e.acquisitionSpan}),It(t.sessionRenewalMs)||(t.sessionRenewalMs=function(){return e.renewalSpan}),n.config=t;var a=n.config.sessionCookiePostfix&&n.config.sessionCookiePostfix()?n.config.sessionCookiePostfix():n.config.namePrefix&&n.config.namePrefix()?n.config.namePrefix():"";function c(e,t){var n=!1,i=", session will be reset",s=t.split("|");if(s.length>=2)try{var o=+s[1]||0,a=+s[2]||0;isNaN(o)||o<=0?r.throwInternal(ne.WARNING,Ie,"AI session acquisition date is 0"+i):isNaN(a)||a<=0?r.throwInternal(ne.WARNING,Ie,"AI session renewal date is 0"+i):s[0]&&(e.id=s[0],e.acquisitionDate=o,e.renewalDate=a,n=!0)}catch(e){r.throwInternal(ne.CRITICAL,pe,"Error parsing ai_session value ["+(t||"")+"]"+i+" - "+Jt(e),{exception:En(e)})}return n}function l(e,t){var r=e.acquisitionDate;e.renewalDate=t;var a=n.config,c=a.sessionRenewalMs(),l=r+a.sessionExpirationMs()-t,u=[e.id,r,t],d=0;d=l<c?l/1e3:c/1e3;var h=a.cookieDomain?a.cookieDomain():null;o.set(i(),u.join("|"),a.sessionExpirationMs()>0?d:null,h),s=t}i=function(){return"ai_session"+a},n.automaticSession=new to,n.update=function(){var t=Gt(),a=!1,u=n.automaticSession;u.id||(a=!function(e,t){var n=!1,s=o.get(i());if(s&&It(s.split))n=c(e,s);else{var a=function(e,t){var n=cs();if(null!==n)try{return n.getItem(t)}catch(t){os=!1,e.throwInternal(ne.WARNING,oe,"Browser failed read of local storage. "+Jt(t),{exception:En(t)})}return null}(r,i());a&&(n=c(e,a))}return n||!!e.id}(u));var d=n.config.sessionExpirationMs();if(!a&&d>0){var h=n.config.sessionRenewalMs(),f=t-u.acquisitionDate,p=t-u.renewalDate;a=(a=(a=f<0||p<0)||f>d)||p>h}a?function(e){var t=n.config||{},i=(t.getNewId?t.getNewId():null)||bi;n.automaticSession.id=i(t.idLength?t.idLength():22),n.automaticSession.acquisitionDate=e,l(n.automaticSession,e),ds()||r.throwInternal(ne.WARNING,re,"Browser does not support local storage. Session durations will be inaccurate.")}(t):(!s||t-s>e.cookieUpdateInterval)&&l(u,t)},n.backup=function(){var e=n.automaticSession;!function(e,t,n){!function(e,t,n){var i=cs();if(null!==i)try{return i.setItem(t,n),!0}catch(t){os=!1,e.throwInternal(ne.WARNING,ce,"Browser failed write to local storage. "+Jt(t),{exception:En(t)})}}(r,i(),[e,t,n].join("|"))}(e.id,e.acquisitionDate,e.renewalDate)}}))}return e.acquisitionSpan=864e5,e.renewalSpan=18e5,e.cookieUpdateInterval=6e4,e}(),io=function(){},so=function(){this.id="browser",this.deviceClass="Browser"},ro=function(e){this.sdkVersion=(e.sdkExtension&&e.sdkExtension()?e.sdkExtension()+"_":"")+"javascript:2.6.4"};function oo(e){return!("string"!=typeof e||!e||e.match(/,|;|=| |\|/))}var ao=function(){function e(t,n){this.isNewUser=!1;var i,s=Cn(n),r=si(n);se(e,this,(function(n){n.config=t;var o=n.config.userCookiePostfix&&n.config.userCookiePostfix()?n.config.userCookiePostfix():"";i=function(){return e.userCookieName+o};var a=r.get(i());if(a){n.isNewUser=!1;var c=a.split(e.cookieSeparator);c.length>0&&(n.id=c[0])}if(!n.id){var l=t||{},u=(l.getNewId?l.getNewId():null)||bi;n.id=u(l.idLength?t.idLength():22);var d=Ht(new Date);n.accountAcquisitionDate=d,n.isNewUser=!0;var h=[n.id,d];r.set(i(),h.join(e.cookieSeparator),31536e3);var f=t.namePrefix&&t.namePrefix()?t.namePrefix()+"ai_session":"ai_session";!function(e,t){var n=cs();if(null!==n)try{return n.removeItem(t),!0}catch(t){os=!1,e.throwInternal(ne.WARNING,ue,"Browser failed removal of local storage item. "+Jt(t),{exception:En(t)})}}(s,f)}n.accountId=t.accountId?t.accountId():void 0;var p=r.get(e.authUserCookieName);if(p){var m=(p=decodeURI(p)).split(e.cookieSeparator);m[0]&&(n.authenticatedId=m[0]),m.length>1&&m[1]&&(n.accountId=m[1])}n.setAuthenticatedUserContext=function(t,i,o){if(void 0===o&&(o=!1),!oo(t)||i&&!oo(i))s.throwInternal(ne.WARNING,rt,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);else{n.authenticatedId=t;var a=n.authenticatedId;i&&(n.accountId=i,a=[n.authenticatedId,n.accountId].join(e.cookieSeparator)),o&&r.set(e.authUserCookieName,encodeURI(a))}},n.clearAuthenticatedUserContext=function(){n.authenticatedId=null,n.accountId=null,r.del(e.authUserCookieName)}}))}return e.cookieSeparator="|",e.userCookieName="ai_user",e.authUserCookieName="ai_authUser",e}(),co=function(){},lo=function(e,t,n,i){var s=this;s.traceID=e||Ci(),s.parentID=t,s.name=n;var r=mn();!n&&r&&r.pathname&&(s.name=r.pathname),s.name=Yi(i,s.name)},uo="ext",ho="tags";function fo(e,t){e&&e[t]&&0===Kt(e[t]).length&&delete e[t]}var po=function e(t,n){var i=this,s=t.logger;this.appId=function(){return null},se(e,this,(function(e){e.application=new io,e.internal=new ro(n),ln()&&(e.sessionManager=new no(n,t),e.device=new so,e.location=new co,e.user=new ao(n,t),e.telemetryTrace=new lo(void 0,void 0,void 0,s),e.session=new to),e.applySessionContext=function(t,n){var i=e.session,s=e.sessionManager;i&&Ut(i.id)?Xt(Zt(t.ext,_r),"sesId",i.id):s&&s.automaticSession&&Xt(Zt(t.ext,_r),"sesId",s.automaticSession.id,Ut)},e.applyOperatingSystemContxt=function(t,n){Xt(t.ext,Er,e.os)},e.applyApplicationContext=function(t,n){var i=e.application;if(i){var s=Zt(t,ho);Xt(s,wr.applicationVersion,i.ver,Ut),Xt(s,wr.applicationBuild,i.build,Ut)}},e.applyDeviceContext=function(t,n){var i=e.device;if(i){var s=Zt(Zt(t,uo),yr);Xt(s,"localId",i.id,Ut),Xt(s,"ip",i.ip,Ut),Xt(s,"model",i.model,Ut),Xt(s,"deviceClass",i.deviceClass,Ut)}},e.applyInternalContext=function(t,n){var i=e.internal;if(i){var s=Zt(t,ho);Xt(s,wr.internalAgentVersion,i.agentVersion,Ut),Xt(s,wr.internalSdkVersion,i.sdkVersion,Ut),(t.baseType===bn.dataType||t.baseType===er.dataType)&&(Xt(s,wr.internalSnippet,i.snippetVer,Ut),Xt(s,wr.internalSdkSrc,i.sdkSrc,Ut))}},e.applyLocationContext=function(e,t){var n=i.location;n&&Xt(Zt(e,ho,[]),wr.locationIp,n.ip,Ut)},e.applyOperationContext=function(t,n){var i=e.telemetryTrace;if(i){var s=Zt(Zt(t,uo),vr,{traceID:void 0,parentID:void 0});Xt(s,"traceID",i.traceID,Ut),Xt(s,"name",i.name,Ut),Xt(s,"parentID",i.parentID,Ut)}},e.applyWebContext=function(e,t){var n=i.web;n&&Xt(Zt(e,uo),Sr,n)},e.applyUserContext=function(t,n){var i=e.user;if(i){Xt(Zt(t,ho,[]),wr.userAccountId,i.accountId,Ut);var s=Zt(Zt(t,uo),gr);Xt(s,"id",i.id,Ut),Xt(s,"authId",i.authenticatedId,Ut)}},e.cleanUp=function(e,t){var n=e.ext;n&&(fo(n,yr),fo(n,gr),fo(n,Sr),fo(n,Er),fo(n,_r),fo(n,vr))}}))},mo=function(e){function t(){var n,i,s=e.call(this)||this;return s.priority=110,s.identifier=br,se(t,s,(function(e,s){e.initialize=function(r,o,a,c){s.initialize(r,o,a,c);var l=e._getTelCtx(),u=e.identifier,d=t.getDefaultConfig();i=i||{},Dt(d,(function(e,t){i[e]=function(){return l.getConfig(u,e,t())}})),e.context=new po(o,i),n=function(e,t){var n=null;return Bt(e,(function(e){if(e.identifier===t)return n=e,-1})),n}(a,Cr),e.context.appId=function(){return n?n._appId:null},e._extConfig=i},e.processTelemetry=function(t,n){if(!At(t)){n=e._getTelCtx(n),t.name===er.envelopeType&&n.diagLog().resetInternalMessageCount();var i=e.context||{};if(i.session&&"string"!=typeof e.context.session.id&&i.sessionManager&&i.sessionManager.update(),function(t,n){Zt(t,"tags",[]),Zt(t,"ext",{});var i=e.context;i.applySessionContext(t,n),i.applyApplicationContext(t,n),i.applyDeviceContext(t,n),i.applyOperationContext(t,n),i.applyUserContext(t,n),i.applyOperatingSystemContxt(t,n),i.applyWebContext(t,n),i.applyLocationContext(t,n),i.applyInternalContext(t,n),i.cleanUp(t,n)}(t,n),i.user&&i.user.isNewUser){i.user.isNewUser=!1;var s=new bn(gt,(fn()||{}).userAgent||"");n.diagLog().logInternalMessage(ne.CRITICAL,s)}e.processNext(t,n)}}})),s}return A(t,e),t.getDefaultConfig=function(){return{instrumentationKey:function(){},accountId:function(){return null},sessionRenewalMs:function(){return 18e5},samplingPercentage:function(){return 100},sessionExpirationMs:function(){return 864e5},cookieDomain:function(){return null},sdkExtension:function(){return null},isBrowserLinkTrackingEnabled:function(){return!1},appId:function(){return null},namePrefix:function(){},sessionCookiePostfix:function(){},userCookiePostfix:function(){},idLength:function(){return 22},getNewId:function(){return null}}},t}(xn),go="properties";function yo(e,t,n){var i=0,s=e[t],r=e[n];return s&&r&&(i=Ts(s,r)),i}function vo(e,t,n,i,s){var r=0,o=yo(n,i,s);return o&&(r=So(e,t,Xi(o))),r}function So(e,t,n){var i="ajaxPerf",s=0;e&&t&&n&&((e[i]=e[i]||{})[t]=n,s=1);return s}var _o=function(){var e=this;e.openDone=!1,e.setRequestHeaderDone=!1,e.sendDone=!1,e.abortDone=!1,e.stateChangeAttached=!1},Eo=function e(t,n,i){var s=this,r=i,o="responseText";s.perfMark=null,s.completed=!1,s.requestHeadersSize=null,s.requestHeaders=null,s.responseReceivingDuration=null,s.callbackDuration=null,s.ajaxTotalDuration=null,s.aborted=0,s.pageUrl=null,s.requestUrl=null,s.requestSize=0,s.method=null,s.status=null,s.requestSentTime=null,s.responseStartedTime=null,s.responseFinishedTime=null,s.callbackFinishedTime=null,s.endTime=null,s.xhrMonitoringState=new _o,s.clientFailure=0,s.traceID=t,s.spanID=n,se(e,s,(function(e){e.getAbsoluteUrl=function(){return e.requestUrl?function(e){var t,n=vs(e);return n&&(t=n.href),t}(e.requestUrl):null},e.getPathName=function(){return e.requestUrl?Wi(r,function(e,t){return e?e.toUpperCase()+" "+t:t}(e.method,e.requestUrl)):null},e.CreateTrackItem=function(t,n,i){if(e.ajaxTotalDuration=Math.round(1e3*Ts(e.requestSentTime,e.responseFinishedTime))/1e3,e.ajaxTotalDuration<0)return null;var s,r=((s={id:"|"+e.traceID+"."+e.spanID,target:e.getAbsoluteUrl(),name:e.getPathName(),type:t,startTime:null,duration:e.ajaxTotalDuration,success:+e.status>=200&&+e.status<400,responseCode:+e.status,method:e.method})[go]={HttpMethod:e.method},s);if(e.requestSentTime&&(r.startTime=new Date,r.startTime.setTime(e.requestSentTime)),function(e,t){var n=e.perfTiming,i=t[go]||{},s=0,r="name",o="Start",a="End",c="domainLookup",l="connect",u="redirect",d="request",h="response",f="duration",p="startTime",m=l+a,g=d+o,y=h+a,v=u+o,S=u=a,_="transferSize",E="encodedBodySize",w="decodedBodySize",b="serverTiming";if(n){s|=vo(i,u,n,v,S),s|=vo(i,c,n,"domainLookupStart","domainLookupEnd"),s|=vo(i,l,n,"connectStart",m),s|=vo(i,d,n,g,"requestEnd"),s|=vo(i,h,n,"responseStart",y),s|=vo(i,"networkConnect",n,p,m),s|=vo(i,"sentRequest",n,g,y);var C=n[f];C||(C=yo(n,p,y)||0),s|=So(i,f,C),s|=So(i,"perfTotal",C);var T=n[b];if(T){var M={};Bt(T,(function(e,t){var n=function(e){var t=e,n=/([^\w\d_$])/g;return n.test(e)&&(t=e.replace(n,"_")),t}(e[r]||""+t),i=M[n]||{};Dt(e,(function(e,t){(e!==r&&Ut(t)||jt(t))&&(i[e]&&(t=i[e]+";"+t),(t||!Ut(t))&&(i[e]=t))})),M[n]=i})),s|=So(i,b,M)}s|=So(i,_,n[_]),s|=So(i,E,n[E]),s|=So(i,w,n[w])}else e.perfMark&&(s|=So(i,"missing",e.perfAttempts));s&&(t[go]=i)}(e,r),n&&Kt(e.requestHeaders).length>0&&(r[go]=r[go]||{},r[go].requestHeaders=e.requestHeaders),i){var a=i();if(a){var c=a.correlationContext;if(c&&(r.correlationContext=c),a.headerMap&&Kt(a.headerMap).length>0&&(r[go]=r[go]||{},r[go].responseHeaders=a.headerMap),e.status>=400){var l=a.type;r[go]=r[go]||{},(""===l||"text"===l)&&(r[go][o]=a[o]?a.statusText+" - "+a[o]:a.statusText),"json"===l&&(r[go][o]=a.response?a.statusText+" - "+JSON.stringify(a.response):a.statusText)}}}return r}}))},wo=(function(){function e(){}e.GetLength=function(e){var t=0;if(!At(e)){var n="";try{n=e.toString()}catch(e){}t=n.length,t=isNaN(t)?0:t}return t}}(),function(){function e(t,n){var i=this;i.traceFlag=e.DEFAULT_TRACE_FLAG,i.version=e.DEFAULT_VERSION,t&&e.isValidTraceId(t)?i.traceId=t:i.traceId=Ci(),n&&e.isValidSpanId(n)?i.spanId=n:i.spanId=Ci().substr(0,16)}return e.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&"00000000000000000000000000000000"!==e},e.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&"0000000000000000"!==e},e.prototype.toString=function(){var e=this;return e.version+"-"+e.traceId+"-"+e.spanId+"-"+e.traceFlag},e.DEFAULT_TRACE_FLAG="01",e.DEFAULT_VERSION="00",e}()),bo="ai.ajxmn.",Co="diagLog",To="ajaxData",Mo="throwInternal",Ao="fetch",ko=0;function Ro(e){var t="";try{!At(e)&&!At(e[To])&&!At(e[To].requestUrl)&&(t+="(url: '"+e[To].requestUrl+"')")}catch(e){}return t}function Po(e,t,n,i,s){e[Co]()[Mo](ne.CRITICAL,t,n,i,s)}function Io(e,t,n,i,s){e[Co]()[Mo](ne.WARNING,t,n,i,s)}function No(e,t,n){return function(i){Po(e,t,n,{ajaxDiagnosticsMessage:Ro(i.inst),exception:En(i.err)})}}function Lo(e,t){return e&&t?e.indexOf(t):-1}var Do,xo=function(e){function t(){var n=e.call(this)||this;n.identifier=t.identifier,n.priority=120;var i,s,r,o,a,c="trackDependencyDataInternal",l=mn(),u=!1,d=!1,h=l&&l.host&&l.host.toLowerCase(),m=t.getEmptyConfig(),g=!1,y=0,v=!1,S=0,_=!1,E=[],b={};return se(t,n,(function(e,n){function l(e){var t=!0;return(e||m.ignoreHeaders)&&Bt(m.ignoreHeaders,(function(n){if(n.toLowerCase()===e.toLowerCase())return t=!1,-1})),t}function C(e,t,n){E.push(function(e,t,n){return e?Ni(e[p],t,n,!1):null}(e,t,n))}function T(e,t,n){var i=!1,s=((Ut(t)?t:(t||{}).url||"")||"").toLowerCase();if(Bt(a,(function(e){var t=e;Ut(e)&&(t=new RegExp(e)),i||(i=t.test(s))})),i)return i;var r=Lo(s,"?"),o=Lo(s,"#");return(-1===r||-1!==o&&o<r)&&(r=o),-1!==r&&(s=s.substring(0,r)),At(e)?At(t)||(i="object"==typeof t&&!0===t[ts]||!!n&&!0===n[ts]):i=!0===e[ts]||!0===s[ts],i?b[s]||(b[s]=1):b[s]&&(i=!0),i}function M(e,t){var n=!0,i=d;return At(e)||(n=!0===t||!At(e[To])),i&&n}function A(e){try{var t=e.responseType;if(""===t||"text"===t)return e.responseText}catch(e){}return null}function k(t){try{var n=t.getAllResponseHeaders();if(null!==n)if(-1!==Lo(n.toLowerCase(),Hi)){var i=t.getResponseHeader(Li);return bs.getCorrelationContext(i)}}catch(n){Io(e,be,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{ajaxDiagnosticsMessage:Ro(t),exception:En(n)})}}function R(e,t){if(t.requestUrl&&o&&v){var n=gn();if(n&&It(n.mark)){ko++;var i=o+e+"#"+ko;n.mark(i);var s=n.getEntriesByName(i);s&&1===s.length&&(t.perfMark=s[0])}}}function P(e,t,n,i){var s=t.perfMark,r=gn(),o=m.maxAjaxPerfLookupAttempts,a=m.ajaxPerfLookupDelay,c=t.requestUrl,l=0;!function u(){try{if(r&&s){l++;for(var d=null,h=r.getEntries(),f=h.length-1;f>=0;f--){var p=h[f];if(p){if("resource"===p.entryType)p.initiatorType===e&&(-1!==Lo(p.name,c)||-1!==Lo(c,p.name))&&(d=p);else if("mark"===p.entryType&&p.name===s.name){t.perfTiming=d;break}if(p.startTime<s.startTime-1e3)break}}}!s||t.perfTiming||l>=o||!1===t.async?(s&&It(r.clearMarks)&&r.clearMarks(s.name),t.perfAttempts=l,n()):setTimeout(u,a)}catch(e){i(e)}}()}function I(t){var n="";try{At(t)||(n+="string"==typeof t?"(url: '"+t+"')":"(url: '"+t.url+"')")}catch(t){Po(e,_e,"Failed to grab failed fetch diagnostics message",{exception:En(t)})}return n}function N(t,n,i,s,r,o){function a(t,n,s){var r=s||{};r.fetchDiagnosticsMessage=I(i),n&&(r.exception=En(n)),Io(e,t,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",r)}s&&(s.responseFinishedTime=Cs(),s.status=n,P("fetch",s,(function(){var t=s.CreateTrackItem("Fetch",g,r);t?e[c](t):a(Se,null,{requestSentTime:s.requestSentTime,responseFinishedTime:s.responseFinishedTime})}),(function(e){a(be,e,null)})))}function L(t){if(t&&t.headers)try{var n=t.headers.get(Li);return bs.getCorrelationContext(n)}catch(n){Io(e,be,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{fetchDiagnosticsMessage:I(t),exception:En(n)})}}e.initialize=function(h,y,b,I){if(!e.isInitialized()){n.initialize(h,y,b,I);var D=e._getTelCtx();Dt(t.getDefaultConfig(),(function(e,n){m[e]=D.getConfig(t.identifier,e,n)}));var x=m.distributedTracingMode;if(g=m.enableRequestHeaderTracking,v=m.enableAjaxPerfTracking,S=m.maxAjaxCallsPerView,_=m.enableResponseHeaderTracking,a=m.excludeRequestFromAutoTrackingPatterns,r=x===es.AI||x===es.AI_AND_W3C,s=x===es.AI_AND_W3C||x===es.W3C,v){var O=h.instrumentationKey||"unkwn";o=O.length>5?bo+O.substring(O.length-5)+".":bo+O+"."}if(!1===m.disableAjaxTracking&&(function(e){var t=!1;if(typeof XMLHttpRequest!==f&&!At(XMLHttpRequest)){var n=XMLHttpRequest[p];t=!(At(n)||At(n.open)||At(n.send)||At(n.abort))}var i=_n();if(i&&i<9&&(t=!1),t)try{(new XMLHttpRequest)[To]={};var s=XMLHttpRequest[p].open;XMLHttpRequest[p].open=s}catch(n){t=!1,Po(e,_e,"Failed to enable XMLHttpRequest monitoring, extension is not supported",{exception:En(n)})}return t}(e)&&!d&&(C(XMLHttpRequest,"open",{req:function(t,n,s,r){var o=t.inst,a=o[To];!T(o,s)&&M(o,!0)&&(!a||!a.xhrMonitoringState.openDone)&&function(t,n,s,r){var o=i&&i.telemetryTrace&&i.telemetryTrace.traceID||Ci(),a=Ci().substr(0,16),u=new Eo(o,a,e[Co]());u.method=n,u.requestUrl=s,u.xhrMonitoringState.openDone=!0,u.requestHeaders={},u.async=r,t[To]=u,function(t){t[To].xhrMonitoringState.stateChangeAttached=Ti.Attach(t,"readystatechange",(function(){try{t&&4===t.readyState&&M(t)&&function(t){var n=t[To];function i(n,i){var s=i||{};s.ajaxDiagnosticsMessage=Ro(t),n&&(s.exception=En(n)),Io(e,Se,"Failed to calculate the duration of the ajax call, monitoring data for this ajax call won't be sent.",s)}n.responseFinishedTime=Cs(),n.status=t.status,P("xmlhttprequest",n,(function(){try{var s=n.CreateTrackItem("Ajax",g,(function(){var e={statusText:t.statusText,headerMap:null,correlationContext:k(t),type:t.responseType,responseText:A(t),response:t.response};if(_){var n=t.getAllResponseHeaders();if(n){var i=qt(n).split(/[\r\n]+/),s={};Bt(i,(function(e){var t=e.split(": "),n=t.shift(),i=t.join(": ");l(n)&&(s[n]=i)})),e.headerMap=s}}return e}));s?e[c](s):i(null,{requestSentTime:n.requestSentTime,responseFinishedTime:n.responseFinishedTime})}finally{try{t[To]=null}catch(e){}}}),(function(e){i(e,null)}))}(t)}catch(i){var n=En(i);(!n||-1===Lo(n.toLowerCase(),"c00c023f"))&&Po(e,Ee,"Failed to monitor XMLHttpRequest 'readystatechange' event handler, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Ro(t),exception:n})}}))}(t)}(o,n,s,r)},hkErr:No(e,_e,"Failed to monitor XMLHttpRequest.open, monitoring data for this ajax call may be incorrect.")}),C(XMLHttpRequest,"send",{req:function(t,n){var i=t.inst,s=i[To];M(i)&&!s.xhrMonitoringState.sendDone&&(R("xhr",s),s.requestSentTime=Cs(),e.includeCorrelationHeaders(s,void 0,void 0,i),s.xhrMonitoringState.sendDone=!0)},hkErr:No(e,we,"Failed to monitor XMLHttpRequest, monitoring data for this ajax call may be incorrect.")}),C(XMLHttpRequest,"abort",{req:function(e){var t=e.inst,n=t[To];M(t)&&!n.xhrMonitoringState.abortDone&&(n.aborted=1,n.xhrMonitoringState.abortDone=!0)},hkErr:No(e,ve,"Failed to monitor XMLHttpRequest.abort, monitoring data for this ajax call may be incorrect.")}),g&&C(XMLHttpRequest,"setRequestHeader",{req:function(e,t,n){var i=e.inst;M(i)&&l(t)&&(i[To].requestHeaders[t]=n)},hkErr:No(e,mt,"Failed to monitor XMLHttpRequest.setRequestHeader, monitoring data for this ajax call may be incorrect.")}),d=!0)),function(){var t=function(){var e=w();return!e||At(e.Request)||At(e.Request[p])||At(e[Ao])?null:e[Ao]}();if(t){var n=w(),s=t.polyfill;!1===m.disableFetchTracking?(E.push(Ni(n,Ao,{req:function(t,n,r){var o;if(u&&!T(null,n,r)&&(!s||!d)){var a=t.ctx();o=function(t,n){var s=i&&i.telemetryTrace&&i.telemetryTrace.traceID||Ci(),r=Ci().substr(0,16),o=new Eo(s,r,e[Co]());o.requestSentTime=Cs(),t instanceof Request?o.requestUrl=t?t.url:"":o.requestUrl=t;var a="GET";n&&n.method?a=n.method:t&&t instanceof Request&&(a=t.method),o.method=a;var c={};if(g){new Headers((n?n.headers:0)||t instanceof Request&&t.headers||{}).forEach((function(e,t){l(t)&&(c[t]=e)}))}return o.requestHeaders=c,R("fetch",o),o}(n,r);var c=e.includeCorrelationHeaders(o,n,r);c!==r&&t.set(1,c),a.data=o}},rsp:function(e,t){var n=e.ctx().data;n&&(e.rslt=e.rslt.then((function(t){return N(e,(t||{}).status,t,n,(function(){var e={statusText:t.statusText,headerMap:null,correlationContext:L(t)};if(_){var n={};t.headers.forEach((function(e,t){l(t)&&(n[t]=e)})),e.headerMap=n}return e})),t})).catch((function(i){throw N(e,0,t,n,null,{error:i.message}),i})))},hkErr:No(e,_e,"Failed to monitor Window.fetch, monitoring data for this fetch call may be incorrect.")})),u=!0):s&&E.push(Ni(n,Ao,{req:function(e,t,n){T(null,t,n)}})),s&&(n[Ao].polyfill=s)}}(),b.length>0&&b){for(var F=void 0,U=0;!F&&U<b.length;)b[U]&&b[U].identifier===br&&(F=b[U]),U++;F&&(i=F.context)}}},e.teardown=function(){Bt(E,(function(e){e.rm()})),E=[],u=!1,d=!1,e.setInitialized(!1)},e.trackDependencyData=function(t,n){e[c](t,n)},e.includeCorrelationHeaders=function(t,n,o,a){var c=e._currentWindowHost||h;if(n){if(bs.canIncludeCorrelationHeader(m,t.getAbsoluteUrl(),c)){if(o||(o={}),o.headers=new Headers(o.headers||n instanceof Request&&n.headers||{}),r){var l="|"+t.traceID+"."+t.spanID;o.headers.set(Oi,l),g&&(t.requestHeaders[Oi]=l)}if((d=m.appId||i&&i.appId())&&(o.headers.set(Li,xi+d),g&&(t.requestHeaders[Li]=xi+d)),s){var u=new wo(t.traceID,t.spanID);o.headers.set(Fi,u.toString()),g&&(t.requestHeaders[Fi]=u.toString())}}return o}if(a){if(bs.canIncludeCorrelationHeader(m,t.getAbsoluteUrl(),c)){if(r){l="|"+t.traceID+"."+t.spanID;a.setRequestHeader(Oi,l),g&&(t.requestHeaders[Oi]=l)}var d;if((d=m.appId||i&&i.appId())&&(a.setRequestHeader(Li,xi+d),g&&(t.requestHeaders[Li]=xi+d)),s){u=new wo(t.traceID,t.spanID);a.setRequestHeader(Fi,u.toString()),g&&(t.requestHeaders[Fi]=u.toString())}}return a}},e[c]=function(t,n,i){if(-1===S||y<S){(m.distributedTracingMode===es.W3C||m.distributedTracingMode===es.AI_AND_W3C)&&"string"==typeof t.id&&"."!==t.id[t.id.length-1]&&(t.id+="."),At(t.startTime)&&(t.startTime=new Date);var s=mr.create(t,tr.dataType,tr.envelopeType,e[Co](),n,i);e.core.track(s)}else y===S&&Po(e,tt,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++y}})),n}return A(t,e),t.getDefaultConfig=function(){return{maxAjaxCallsPerView:500,disableAjaxTracking:!1,disableFetchTracking:!0,excludeRequestFromAutoTrackingPatterns:void 0,disableCorrelationHeaders:!1,distributedTracingMode:es.AI_AND_W3C,correlationHeaderExcludedDomains:["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],correlationHeaderDomains:void 0,correlationHeaderExcludePatterns:void 0,appId:void 0,enableCorsCorrelation:!1,enableRequestHeaderTracking:!1,enableResponseHeaderTracking:!1,enableAjaxErrorStatusText:!1,enableAjaxPerfTracking:!1,maxAjaxPerfLookupAttempts:3,ajaxPerfLookupDelay:25,ignoreHeaders:["Authorization","X-API-Key","WWW-Authenticate"]}},t.getEmptyConfig=function(){var e=this.getDefaultConfig();return Dt(e,(function(t){e[t]=void 0})),e},t.prototype.processTelemetry=function(e,t){this.processNext(e,t)},t.identifier="AjaxDependencyPlugin",t}(xn),Oo=["snippet","dependencies","properties","_snippetVersion","appInsightsNew","getSKUDefaults"],Fo=function(){function e(e){var t=this;t._snippetVersion=""+(e.sv||e.version||""),e.queue=e.queue||[],e.version=e.version||2;var n=e.config||{};if(n.connectionString){var i=function(e){if(!e)return{};var t=function(e,t,n){var i,s=e.length,r=0;if(arguments.length>=3)i=arguments[2];else{for(;r<s&&!(r in e);)r++;i=e[r++]}for(;r<s;)r in e&&(i=t(i,e[r],r,e)),r++;return i}(e.split(";"),(function(e,t){var n=t.split("=");if(2===n.length){var i=n[0].toLowerCase(),s=n[1];e[i]=s}return e}),{});if(Kt(t).length>0){if(t.endpointsuffix){var n=t.location?t.location+".":"";t.ingestionendpoint=t.ingestionendpoint||"https://"+n+"dc."+t.endpointsuffix}t.ingestionendpoint=t.ingestionendpoint||"https://dc.services.visualstudio.com"}return t}(n.connectionString),s=i.ingestionendpoint;n.endpointUrl=s?s+"/v2/track":n.endpointUrl,n.instrumentationKey=i.instrumentationkey||n.instrumentationKey}t.appInsights=new Nr,t.properties=new mo,t.dependencies=new xo,t.core=new pi,t._sender=new eo,t.snippet=e,t.config=n,t.getSKUDefaults()}return e.prototype.getCookieMgr=function(){return this.appInsights.getCookieMgr()},e.prototype.trackEvent=function(e,t){this.appInsights.trackEvent(e,t)},e.prototype.trackPageView=function(e){var t=e||{};this.appInsights.trackPageView(t)},e.prototype.trackPageViewPerformance=function(e){var t=e||{};this.appInsights.trackPageViewPerformance(t)},e.prototype.trackException=function(e){e&&!e.exception&&e.error&&(e.exception=e.error),this.appInsights.trackException(e)},e.prototype._onerror=function(e){this.appInsights._onerror(e)},e.prototype.trackTrace=function(e,t){this.appInsights.trackTrace(e,t)},e.prototype.trackMetric=function(e,t){this.appInsights.trackMetric(e,t)},e.prototype.startTrackPage=function(e){this.appInsights.startTrackPage(e)},e.prototype.stopTrackPage=function(e,t,n,i){this.appInsights.stopTrackPage(e,t,n,i)},e.prototype.startTrackEvent=function(e){this.appInsights.startTrackEvent(e)},e.prototype.stopTrackEvent=function(e,t,n){this.appInsights.stopTrackEvent(e,t,n)},e.prototype.addTelemetryInitializer=function(e){return this.appInsights.addTelemetryInitializer(e)},e.prototype.setAuthenticatedUserContext=function(e,t,n){void 0===n&&(n=!1),this.properties.context.user.setAuthenticatedUserContext(e,t,n)},e.prototype.clearAuthenticatedUserContext=function(){this.properties.context.user.clearAuthenticatedUserContext()},e.prototype.trackDependencyData=function(e){this.dependencies.trackDependencyData(e)},e.prototype.flush=function(e){var t=this;void 0===e&&(e=!0),Rn(this.core,(function(){return"AISKU.flush"}),(function(){Bt(t.core.getTransmissionControls(),(function(t){Bt(t,(function(t){t.flush(e)}))}))}),null,e)},e.prototype.onunloadFlush=function(e){void 0===e&&(e=!0),Bt(this.core.getTransmissionControls(),(function(t){Bt(t,(function(t){t.onunloadFlush?t.onunloadFlush():t.flush(e)}))}))},e.prototype.loadAppInsights=function(e,t,n){var i=this;void 0===e&&(e=!1);var s=this;return e&&s.config.extensions&&s.config.extensions.length>0&&tn("Extensions not allowed in legacy mode"),Rn(s.core,(function(){return"AISKU.loadAppInsights"}),(function(){var r=[];r.push(s._sender),r.push(s.properties),r.push(s.dependencies),r.push(s.appInsights),s.core.initialize(s.config,r,t,n),s.context=s.properties.context,Do&&s.context&&(s.context.internal.sdkSrc=Do),function(t){if(t){var n="";At(s._snippetVersion)||(n+=s._snippetVersion),e&&(n+=".lg"),s.context&&s.context.internal&&(s.context.internal.snippetVer=n||"-"),Dt(s,(function(e,n){Ut(e)&&!It(n)&&e&&"_"!==e[0]&&-1===Oo.indexOf(e)&&(t[e]=n)}))}}(s.snippet),s.emptyQueue(),s.pollInternalLogs(),s.addHousekeepingBeforeUnload(i)})),s},e.prototype.updateSnippetDefinitions=function(e){!function(e,t,n){if(e&&t&&e!==t&&Pt(e)&&Pt(t)){var i=function(i){if(Ut(i)){var s=t[i];It(s)?(!n||n(i,!0,t,e))&&(e[i]=(r=i,function(){var e=arguments;return t[r].apply(t,e)})):(!n||n(i,!1,t,e))&&(Rt(e,i)&&delete e[i],zt(e,i,(function(){return t[i]}),(function(e){t[i]=e}))||(e[i]=s))}var r};for(var s in t)i(s)}}(e,this,(function(e){return e&&-1===Oo.indexOf(e)}))},e.prototype.emptyQueue=function(){var e=this;try{if(Ot(e.snippet.queue)){for(var t=e.snippet.queue.length,n=0;n<t;n++){(0,e.snippet.queue[n])()}e.snippet.queue=void 0,delete e.snippet.queue}}catch(e){e&&It(e.toString)&&e.toString()}},e.prototype.pollInternalLogs=function(){this.core.pollInternalLogs()},e.prototype.addHousekeepingBeforeUnload=function(e){if(ln()||dn()){var t=function(){e.onunloadFlush(!1),Bt(e.appInsights.core._extensions,(function(e){if(e.identifier===br)return e&&e.context&&e.context._sessionManager&&e.context._sessionManager.backup(),-1}))};if(!e.appInsights.config.disableFlushOnBeforeUnload){var n=wi("beforeunload",t);n=wi("unload",t)||n,n=wi("pagehide",t)||n,!(n=wi("visibilitychange",t)||n)&&!function(){var e=fn();return!(!e||!e.product)&&"ReactNative"===e.product}()&&e.appInsights.core.logger.throwInternal(ne.CRITICAL,Ce,"Could not add handler for beforeunload and pagehide")}e.appInsights.config.disableFlushOnUnload||(wi("pagehide",t),wi("visibilitychange",t))}},e.prototype.getSender=function(){return this._sender},e.prototype.getSKUDefaults=function(){var e=this;e.config.diagnosticLogInterval=e.config.diagnosticLogInterval&&e.config.diagnosticLogInterval>0?e.config.diagnosticLogInterval:1e4},e}();!function(){var e=null,t=["://js.monitor.azure.com/","://az416426.vo.msecnd.net/"];try{var n=(document||{}).currentScript;n&&(e=n.src)}catch(e){}if(e)try{var i=e.toLowerCase();if(i)for(var s="",r=0;r<t.length;r++)if(-1!==i.indexOf(t[r])){s="cdn"+(r+1),-1===i.indexOf("/scripts/")&&(-1!==i.indexOf("/next/")?s+="-next":-1!==i.indexOf("/beta/")&&(s+="-beta")),Do=s+"";break}}catch(e){}}();var Uo=class{constructor(e,t,n,s,r){this.extensionId=e,this.extensionVersion=t,this.telemetryAppender=n,this.osShim=s,this.firstParty=!1,this.userOptIn=!1,this.firstParty=!!r,this.updateUserOptStatus(),void 0!==i.env.onDidChangeTelemetryEnabled?this.optOutListener=i.env.onDidChangeTelemetryEnabled(()=>this.updateUserOptStatus()):this.optOutListener=i.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus())}updateUserOptStatus(){let e=i.workspace.getConfiguration(Uo.TELEMETRY_CONFIG_ID),t=void 0===i.env.isTelemetryEnabled?e.get(Uo.TELEMETRY_CONFIG_ENABLED_ID,!0):i.env.isTelemetryEnabled;this.userOptIn!==t&&(this.userOptIn=t)}cleanRemoteName(e){if(!e)return"none";let t="other";return["ssh-remote","dev-container","attached-container","wsl"].forEach(n=>{0===e.indexOf(`${n}+`)&&(t=n)}),t}get extension(){return void 0===this._extension&&(this._extension=i.extensions.getExtension(this.extensionId)),this._extension}cloneAndChange(e,t){if(null===e||"object"!=typeof e||"function"!=typeof t)return e;let n={};for(let i in e)n[i]=t(i,e[i]);return n}shouldSendErrorTelemetry(){return!this.firstParty||("other"!==this.cleanRemoteName(i.env.remoteName)||!(void 0===this.extension||this.extension.extensionKind===i.ExtensionKind.Workspace||i.env.uiKind===i.UIKind.Web))}getCommonProperties(){let e=Object.create(null);if(e["common.os"]=this.osShim.platform,e["common.platformversion"]=(this.osShim.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),e["common.extname"]=this.extensionId,e["common.extversion"]=this.extensionVersion,i&&i.env){switch(e["common.vscodemachineid"]=i.env.machineId,e["common.vscodesessionid"]=i.env.sessionId,e["common.vscodeversion"]=i.version,e["common.isnewappinstall"]=i.env.isNewAppInstall.toString(),i.env.uiKind){case i.UIKind.Web:e["common.uikind"]="web";break;case i.UIKind.Desktop:e["common.uikind"]="desktop";break;default:e["common.uikind"]="unknown"}e["common.remotename"]=this.cleanRemoteName(i.env.remoteName)}return e}anonymizeFilePaths(e,t){let n;if(null==e)return"";let s=[];""!==i.env.appRoot&&s.push(new RegExp(i.env.appRoot.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")),this.extension&&s.push(new RegExp(this.extension.extensionPath.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"));let r=e;if(t){let t=[];for(let i of s)for(;(n=i.exec(e))&&n;)t.push([n.index,i.lastIndex]);let i=/^[\\/]?(node_modules|node_modules\.asar)[\\/]/,o=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-._]+(\\\\|\\|\/))+[\w-._]*/g,a=0;for(r="";(n=o.exec(e))&&n;)n[0]&&!i.test(n[0])&&t.every(([e,t])=>n.index<e||n.index>=t)&&(r+=e.substring(a,n.index)+"<REDACTED: user-file-path>",a=o.lastIndex);a<e.length&&(r+=e.substr(a))}for(let e of s)r=r.replace(e,"");return r}removePropertiesWithPossibleUserInfo(e){if("object"!=typeof e)return;let t=Object.create(null);for(let n of Object.keys(e)){let i=e[n];if(!i)continue;let s=/@[a-zA-Z0-9-.]+/;/\S*(key|token|sig|password|passwd|pwd)[="':\s]+\S*/.test(i.toLowerCase())?t[n]="<REDACTED: secret>":s.test(i)?t[n]="<REDACTED: email>":t[n]=i}return t}sendTelemetryEvent(e,t,n){if(this.userOptIn&&""!==e){t=l(l({},t),this.getCommonProperties());let i=this.cloneAndChange(t,(e,t)=>this.anonymizeFilePaths(t,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${e}`,{properties:this.removePropertiesWithPossibleUserInfo(i),measurements:n})}}sendTelemetryErrorEvent(e,t,n,i){if(this.userOptIn&&""!==e){t=l(l({},t),this.getCommonProperties());let s=this.cloneAndChange(t,(e,t)=>this.shouldSendErrorTelemetry()?this.anonymizeFilePaths(t,this.firstParty):void 0===i||-1!==i.indexOf(e)?"REDACTED":this.anonymizeFilePaths(t,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${e}`,{properties:this.removePropertiesWithPossibleUserInfo(s),measurements:n})}}sendTelemetryException(e,t,n){if(this.shouldSendErrorTelemetry()&&this.userOptIn&&e){t=l(l({},t),this.getCommonProperties());let i=this.cloneAndChange(t,(e,t)=>this.anonymizeFilePaths(t,this.firstParty));e.stack&&(e.stack=this.anonymizeFilePaths(e.stack,this.firstParty)),this.telemetryAppender.logException(e,{properties:this.removePropertiesWithPossibleUserInfo(i),measurements:n})}}dispose(){return this.telemetryAppender.flush(),this.optOutListener.dispose()}},jo=Uo;jo.TELEMETRY_CONFIG_ID="telemetry",jo.TELEMETRY_CONFIG_ENABLED_ID="enableTelemetry";var Ho=class extends jo{constructor(e,t,n,s){let r=new class{constructor(e){let t;e&&0===e.indexOf("AIF-")&&(t="https://vortex.data.microsoft.com/collect/v1"),this._aiClient=new Fo({config:{instrumentationKey:e,endpointUrl:t,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!0,disableInstrumentationKeyValidation:!0}}),this._aiClient.loadAppInsights(),t&&i.env.isTelemetryEnabled&&fetch(t).catch(()=>this._aiClient=void 0)}logEvent(e,t){!this._aiClient||this._aiClient.trackEvent({name:e},l(l({},t.properties),t.measurements))}logException(e,t){!this._aiClient||this._aiClient.trackException({exception:e,properties:l(l({},t.properties),t.measurements)})}flush(){return this._aiClient&&(this._aiClient.flush(),this._aiClient=void 0),Promise.resolve(void 0)}}(n);n&&0===n.indexOf("AIF-")&&(s=!0),super(e,t,r,{release:navigator.appVersion,platform:"web"},s)}};
/*!
 * Microsoft Dynamic Proto Utility, 1.1.4
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */}.call(this,n(27))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(9),s=n(873),r=n(159),o=n(384);t.telemetryCommandDecorator=function(e,t,n,s=1,r){return new a(i.Telemetry,e,t,n,s,r).setup()};class a extends o.CommandDecoratorBase{constructor(e,t,n,i,s,r){super(),this.telemetry=e,this.telemetryEventName=t,this.telemetryFaultEventName=n,this.commandTitle=i,this.telemetryEventVersion=s,this.onError=r}async invoke(e,t,n){let o,a=void 0,c=this.telemetry.startTimedEvent(this.telemetryEventName),l=i.TelemetryResult.Success,u="";n.telemetryEvent=c,this.telemetry.setCorrelationEvent(c),c.addProperty(r.TelemetryPropertyNames.COMMAND_TEXT,n.commandText),c.addMeasure(r.TelemetryPropertyNames.TELEMETRY_EVENT_VERSION,this.telemetryEventVersion),this.addInvocationTelemetryProperties(c,t.telemetryProperties);try{o=await e(t,n),c.addProperty(i.TelemetryPropertyNames.EVENT_RESULT,i.TelemetryResult.Success)}catch(e){throw l=s.TelemetryUtil.DeriveTelemetryResult(e),u=s.TelemetryUtil.BuildTelemetryMessage(this.commandTitle,l,e.message),c.addProperty(i.TelemetryPropertyNames.EVENT_RESULT,l),this.onError&&this.onError(e,n,t),this.telemetry.sendFault(this.telemetryFaultEventName,s.TelemetryUtil.MapTelemetryResultToFaultType(l),u,e),a=e,e}finally{u=u||s.TelemetryUtil.BuildTelemetryMessage(this.commandTitle,i.TelemetryResult.Success);const e=c.end(l,u);n.trace.traceEvent(s.TelemetryUtil.MapTelemetryResultToTraceEventType(l),0,`Command [${n.commandName}]: ${u} (${e}ms)`),a&&(a.hasRecorded=!0)}return o}addInvocationTelemetryProperties(e,t={}){for(let n of Object.keys(t))e.addProperty(n,t[n])}}t.TelemetryCommandDecorator=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(19),s=n(92),r=n(9);t.TelemetryUtil=class{static DeriveTelemetryResult(e){return e instanceof s.CommandError?e.telemetryResult:r.TelemetryResult.Failure}static DeriveTelemetryTitle(e,t){let n="Success";return t===r.TelemetryResult.UserFailure?n="User Failure":t===r.TelemetryResult.Cancel?n="Cancelled":t===r.TelemetryResult.IndeterminateFailure?n="Indeterminate Failure":t===r.TelemetryResult.Failure?n="Failure":t===r.TelemetryResult.NonBlockingFailure?n="Non Blocking Failure":t===r.TelemetryResult.ByDesignFailure&&(n="By Design Failure"),`${e} ${n}`}static BuildTelemetryMessage(e,t,n){let i="";return void 0!==n&&(i=`: ${n}`),`${this.DeriveTelemetryTitle(e,t)}${i}`}static MapTelemetryResultToFaultType(e){switch(e){case r.TelemetryResult.UserFailure:return r.FaultType.User;case r.TelemetryResult.Cancel:return r.FaultType.UserCancelled;case r.TelemetryResult.Failure:return r.FaultType.Error;case r.TelemetryResult.NonBlockingFailure:return r.FaultType.NonBlockingFault;case r.TelemetryResult.ByDesignFailure:return r.FaultType.ByDesign;case r.TelemetryResult.IndeterminateFailure:default:return r.FaultType.Unknown}}static MapTelemetryResultToTraceEventType(e){return e===r.TelemetryResult.Success?i.LogLevel.Info:i.LogLevel.Error}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(384),s=n(385),r=n(386),o=n(387),a=n(388),c=n(389),l=n(9);t.errorNotificationCommandDecorator=function(e,t,n=!1,i){return new u(s.NotificationUtil,l.Telemetry,t,e,n,i).setup()};class u extends i.CommandDecoratorBase{constructor(e,t,n,i,s,r){super(),this.notificationUtil=e,this.telemetry=t,this.telemetryFaultEventName=n,this.title=i,this.isModalError=s,this.onError=r}async invoke(e,t,n){const{cancellationTokenSource:i}=n;let s;n.commandName=this.title;try{s=await e(t,n)}catch(e){try{const t=e.userMessage||e.message,n=t?`${this.title}: ${t}`:this.title;e instanceof a.CancellationError&&i&&!i.token.isCancellationRequested&&i.cancel();const s=e instanceof o.UserError||e instanceof a.CancellationError;e.isSuppressUserNotification||e instanceof a.CancellationError&&!t||(s?this.notificationUtil.showInformationMessage(n,!1):e instanceof r.ByDesignError?await this.notificationUtil.showErrorMessage(n,{modal:this.isModalError}):e instanceof c.NonBlockingError||await this.notificationUtil.showErrorMessage(n,{modal:this.isModalError}))}catch(t){e=t}if(e&&!e.hasRecorded){const t=`${this.title}: [unhandled exception (decorator)] ${e.message}`;n.trace.error(t),this.telemetry.sendFault(this.telemetryFaultEventName,l.FaultType.Error,t,e)}e&&this.onError&&await this.onError(e,n,t)}return s}}t.ErrorNotificationCommandDecorator=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CommandBase=class{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.LOCAL_DEPENDENCY="ERR_LOCAL_DEPENDENCY",e.NOT_SUPPORTED="ERR_NOT_SUPPORTED",e.REMOTE_DEPENDENCY="ERR_REMOTE_DEPENDENCY",e.UNAUTHORIZED="ERR_UNAUTHORIZED",e.FORBIDDEN_ANONYMOUS="ERR_FORBIDDEN_ANONYMOUS",e.NETWORK_ERROR="ERR_NETWORK",e.BAD_REQUEST="ERR_BAD_REQUEST"}(t.CommandErrorCode||(t.CommandErrorCode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.enableTelemetry=!0,this.updateUserOptIn(),this.configListener=i.vscode.workspace.onDidChangeConfiguration(()=>this.updateUserOptIn())}shouldSend(e,t,n){return this.enableTelemetry}updateUserOptIn(){const e=i.vscode.workspace.getConfiguration("telemetry");this.enableTelemetry=e.get("enableTelemetry",!0)}dispose(){return this.configListener.dispose()}static get vscode(){return n(0)}}t.OptOutTelemetryFilter=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(18),s=n(129),r=n(879),o=n(880),a=[".log",".blog"];t.LogZipExporter=class{static async createLogZipFileAsync(e,t){const n=(await r.findFilesAsync(t,t,e=>a.indexOf(i.extname(e))>=0)).sort(),c=new o.ZipFile;c.outputStream.pipe(s.fileAccess.createWriteStream(e)),n.forEach(e=>{c.addFile(i.join(t,e),e)}),c.end()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(18),s=n(129);t.readdirAsync=e=>new Promise((t,n)=>{s.fileAccess.readdir(e,(e,i)=>e?n(e):t(i))}),t.statAsync=e=>new Promise((t,n)=>{s.fileAccess.stat(e,(e,i)=>e?n(e):t(i))}),t.findFilesAsync=async(e,n,s)=>{let r=[],o=[];try{o=await t.readdirAsync(n)}catch(e){}for(let a of o){const o=i.join(n,a);let c;try{c=await t.statAsync(o)}catch(e){continue}if(c.isDirectory()){const n=await t.findFilesAsync(e,o,s);r=r.concat(n)}else{const t=i.relative(e,o);s&&!s(t)||r.push(t)}}return r}},function(e,t,n){(function(e,i){var s=n(74),r=n(34).Transform,o=n(34).PassThrough,a=n(881),c=n(59),l=n(24).EventEmitter,u=n(894);function d(){this.outputStream=new o,this.entries=[],this.outputStreamCursor=0,this.ended=!1,this.allDone=!1,this.forceZip64Eocd=!1}t.ZipFile=d,t.dateToDosDateTime=R,c.inherits(d,l),d.prototype.addFile=function(e,t,n){var i=this;t=S(t,!1),null==n&&(n={});var r=new E(t,!1,n);i.entries.push(r),s.stat(e,(function(t,o){return t?i.emit("error",t):o.isFile()?(r.uncompressedSize=o.size,null==n.mtime&&r.setLastModDate(o.mtime),null==n.mode&&r.setFileAttributesMode(o.mode),r.setFileDataPumpFunction((function(){var t=s.createReadStream(e);r.state=E.FILE_DATA_IN_PROGRESS,t.on("error",(function(e){i.emit("error",e)})),p(i,r,t)})),void m(i)):i.emit("error",new Error("not a file: "+e))}))},d.prototype.addReadStream=function(e,t,n){var i=this;null==n&&(n={});var s=new E(t=S(t,!1),!1,n);i.entries.push(s),s.setFileDataPumpFunction((function(){s.state=E.FILE_DATA_IN_PROGRESS,p(i,s,e)})),m(i)},d.prototype.addBuffer=function(t,n,i){var s=this;if(n=S(n,!1),t.length>1073741823)throw new Error("buffer too large: "+t.length+" > 1073741823");if(null==i&&(i={}),null!=i.size)throw new Error("options.size not allowed");var r=new E(n,!1,i);function o(t){r.compressedSize=t.length,r.setFileDataPumpFunction((function(){f(s,t),f(s,r.getDataDescriptor()),r.state=E.FILE_DATA_DONE,e((function(){m(s)}))})),m(s)}r.uncompressedSize=t.length,r.crc32=u.unsigned(t),r.crcAndFileSizeKnown=!0,s.entries.push(r),r.compress?a.deflateRaw(t,(function(e,t){o(t)})):o(t)},d.prototype.addEmptyDirectory=function(e,t){var n=this;if(e=S(e,!0),null==t&&(t={}),null!=t.size)throw new Error("options.size not allowed");if(null!=t.compress)throw new Error("options.compress not allowed");var i=new E(e,!0,t);n.entries.push(i),i.setFileDataPumpFunction((function(){f(n,i.getDataDescriptor()),i.state=E.FILE_DATA_DONE,m(n)})),m(n)};var h=O([80,75,5,6]);function f(e,t){e.outputStream.write(t),e.outputStreamCursor+=t.length}function p(e,t,n){var i=new N,s=new I,r=t.compress?new a.DeflateRaw:new o,c=new I;n.pipe(i).pipe(s).pipe(r).pipe(c).pipe(e.outputStream,{end:!1}),c.on("end",(function(){if(t.crc32=i.crc32,null==t.uncompressedSize)t.uncompressedSize=s.byteCount;else if(t.uncompressedSize!==s.byteCount)return e.emit("error",new Error("file data stream has unexpected number of bytes"));t.compressedSize=c.byteCount,e.outputStreamCursor+=t.compressedSize,f(e,t.getDataDescriptor()),t.state=E.FILE_DATA_DONE,m(e)}))}function m(e){if(!e.allDone){if(e.ended&&null!=e.finalSizeCallback){var t=function(e){for(var t=0,n=0,i=0;i<e.entries.length;i++){var s=e.entries[i];if(s.compress)return-1;if(s.state>=E.READY_TO_PUMP_FILE_DATA){if(null==s.uncompressedSize)return-1}else if(null==s.uncompressedSize)return null;s.relativeOffsetOfLocalHeader=t;var r=s.useZip64Format();t+=w+s.utf8FileName.length,t+=s.uncompressedSize,s.crcAndFileSizeKnown||(t+=r?M:T),n+=A+s.utf8FileName.length+s.fileComment.length,r&&(n+=k)}var o=0;(e.forceZip64Eocd||e.entries.length>=65535||n>=65535||t>=4294967295)&&(o+=g+y);return o+=v+e.comment.length,t+n+o}(e);null!=t&&(e.finalSizeCallback(t),e.finalSizeCallback=null)}var n=function(){for(var t=0;t<e.entries.length;t++){var n=e.entries[t];if(n.state<E.FILE_DATA_DONE)return n}return null}();if(null!=n){if(n.state<E.READY_TO_PUMP_FILE_DATA)return;if(n.state===E.FILE_DATA_IN_PROGRESS)return;n.relativeOffsetOfLocalHeader=e.outputStreamCursor;var s=n.getLocalFileHeader();f(e,s),n.doFileDataPump()}else e.ended&&(e.offsetOfStartOfCentralDirectory=e.outputStreamCursor,e.entries.forEach((function(t){var n=t.getCentralDirectoryRecord();f(e,n)})),f(e,function(e,t){var n=!1,s=e.entries.length;(e.forceZip64Eocd||e.entries.length>=65535)&&(s=65535,n=!0);var r=e.outputStreamCursor-e.offsetOfStartOfCentralDirectory,o=r;(e.forceZip64Eocd||r>=4294967295)&&(o=4294967295,n=!0);var a=e.offsetOfStartOfCentralDirectory;(e.forceZip64Eocd||e.offsetOfStartOfCentralDirectory>=4294967295)&&(a=4294967295,n=!0);if(t)return n?g+y+v:v;var c=x(v+e.comment.length);if(c.writeUInt32LE(101010256,0),c.writeUInt16LE(0,4),c.writeUInt16LE(0,6),c.writeUInt16LE(s,8),c.writeUInt16LE(s,10),c.writeUInt32LE(o,12),c.writeUInt32LE(a,16),c.writeUInt16LE(e.comment.length,20),e.comment.copy(c,22),!n)return c;var l=x(g);l.writeUInt32LE(101075792,0),P(l,g-12,4),l.writeUInt16LE(C,12),l.writeUInt16LE(b,14),l.writeUInt32LE(0,16),l.writeUInt32LE(0,20),P(l,e.entries.length,24),P(l,e.entries.length,32),P(l,r,40),P(l,e.offsetOfStartOfCentralDirectory,48);var u=x(y);return u.writeUInt32LE(117853008,0),u.writeUInt32LE(0,4),P(u,e.outputStreamCursor,8),u.writeUInt32LE(1,16),i.concat([l,u,c])}(e)),e.outputStream.end(),e.allDone=!0)}}d.prototype.end=function(e,t){if("function"==typeof e&&(t=e,e=null),null==e&&(e={}),!this.ended){if(this.ended=!0,this.finalSizeCallback=t,this.forceZip64Eocd=!!e.forceZip64Format,e.comment){if("string"==typeof e.comment?this.comment=function(e){if(/^[\x20-\x7e]*$/.test(e))return O(e,"utf-8");if(null==D){D={};for(var t=0;t<L.length;t++)D[L[t]]=t}var n=x(e.length);for(t=0;t<e.length;t++){var i=D[e[t]];if(null==i)throw new Error("character not encodable in CP437: "+JSON.stringify(e[t]));n[t]=i}return n}(e.comment):this.comment=e.comment,this.comment.length>65535)throw new Error("comment is too large");if(F(this.comment,h))throw new Error("comment contains end of central directory record signature")}else this.comment=_;m(this)}};var g=56,y=20,v=22;function S(e,t){if(""===e)throw new Error("empty metadataPath");if(e=e.replace(/\\/g,"/"),/^[a-zA-Z]:/.test(e)||/^\//.test(e))throw new Error("absolute path: "+e);if(-1!==e.split("/").indexOf(".."))throw new Error("invalid relative path: "+e);var n=/\/$/.test(e);if(t)n||(e+="/");else if(n)throw new Error("file path cannot end with '/': "+e);return e}var _=x(0);function E(e,t,n){if(this.utf8FileName=O(e),this.utf8FileName.length>65535)throw new Error("utf8 file name too long. "+utf8FileName.length+" > 65535");if(this.isDirectory=t,this.state=E.WAITING_FOR_METADATA,this.setLastModDate(null!=n.mtime?n.mtime:new Date),null!=n.mode?this.setFileAttributesMode(n.mode):this.setFileAttributesMode(t?16893:33204),t?(this.crcAndFileSizeKnown=!0,this.crc32=0,this.uncompressedSize=0,this.compressedSize=0):(this.crcAndFileSizeKnown=!1,this.crc32=null,this.uncompressedSize=null,this.compressedSize=null,null!=n.size&&(this.uncompressedSize=n.size)),t?this.compress=!1:(this.compress=!0,null!=n.compress&&(this.compress=!!n.compress)),this.forceZip64Format=!!n.forceZip64Format,n.fileComment){if("string"==typeof n.fileComment?this.fileComment=O(n.fileComment,"utf-8"):this.fileComment=n.fileComment,this.fileComment.length>65535)throw new Error("fileComment is too large")}else this.fileComment=_}E.WAITING_FOR_METADATA=0,E.READY_TO_PUMP_FILE_DATA=1,E.FILE_DATA_IN_PROGRESS=2,E.FILE_DATA_DONE=3,E.prototype.setLastModDate=function(e){var t=R(e);this.lastModFileTime=t.time,this.lastModFileDate=t.date},E.prototype.setFileAttributesMode=function(e){if((65535&e)!==e)throw new Error("invalid mode. expected: 0 <= "+e+" <= 65535");this.externalFileAttributes=e<<16>>>0},E.prototype.setFileDataPumpFunction=function(e){this.doFileDataPump=e,this.state=E.READY_TO_PUMP_FILE_DATA},E.prototype.useZip64Format=function(){return this.forceZip64Format||null!=this.uncompressedSize&&this.uncompressedSize>4294967294||null!=this.compressedSize&&this.compressedSize>4294967294||null!=this.relativeOffsetOfLocalHeader&&this.relativeOffsetOfLocalHeader>4294967294};var w=30,b=45,C=831;E.prototype.getLocalFileHeader=function(){var e=0,t=0,n=0;this.crcAndFileSizeKnown&&(e=this.crc32,t=this.compressedSize,n=this.uncompressedSize);var s=x(w),r=2048;return this.crcAndFileSizeKnown||(r|=8),s.writeUInt32LE(67324752,0),s.writeUInt16LE(20,4),s.writeUInt16LE(r,6),s.writeUInt16LE(this.getCompressionMethod(),8),s.writeUInt16LE(this.lastModFileTime,10),s.writeUInt16LE(this.lastModFileDate,12),s.writeUInt32LE(e,14),s.writeUInt32LE(t,18),s.writeUInt32LE(n,22),s.writeUInt16LE(this.utf8FileName.length,26),s.writeUInt16LE(0,28),i.concat([s,this.utf8FileName])};var T=16,M=24;E.prototype.getDataDescriptor=function(){return this.crcAndFileSizeKnown?_:this.useZip64Format()?((e=x(M)).writeUInt32LE(134695760,0),e.writeUInt32LE(this.crc32,4),P(e,this.compressedSize,8),P(e,this.uncompressedSize,16),e):((e=x(T)).writeUInt32LE(134695760,0),e.writeUInt32LE(this.crc32,4),e.writeUInt32LE(this.compressedSize,8),e.writeUInt32LE(this.uncompressedSize,12),e);var e};var A=46,k=28;function R(e){var t=0;t|=31&e.getDate(),t|=(e.getMonth()+1&15)<<5,t|=(e.getFullYear()-1980&127)<<9;var n=0;return n|=Math.floor(e.getSeconds()/2),n|=(63&e.getMinutes())<<5,{date:t,time:n|=(31&e.getHours())<<11}}function P(e,t,n){var i=Math.floor(t/4294967296),s=t%4294967296;e.writeUInt32LE(s,n),e.writeUInt32LE(i,n+4)}function I(e){r.call(this,e),this.byteCount=0}function N(e){r.call(this,e),this.crc32=0}E.prototype.getCentralDirectoryRecord=function(){var e=x(A),t=2048;this.crcAndFileSizeKnown||(t|=8);var n,s,r=this.compressedSize,o=this.uncompressedSize,a=this.relativeOffsetOfLocalHeader;return this.useZip64Format()?(r=4294967295,o=4294967295,a=4294967295,n=b,(s=x(k)).writeUInt16LE(1,0),s.writeUInt16LE(k-4,2),P(s,this.uncompressedSize,4),P(s,this.compressedSize,12),P(s,this.relativeOffsetOfLocalHeader,20)):(n=20,s=_),e.writeUInt32LE(33639248,0),e.writeUInt16LE(C,4),e.writeUInt16LE(n,6),e.writeUInt16LE(t,8),e.writeUInt16LE(this.getCompressionMethod(),10),e.writeUInt16LE(this.lastModFileTime,12),e.writeUInt16LE(this.lastModFileDate,14),e.writeUInt32LE(this.crc32,16),e.writeUInt32LE(r,20),e.writeUInt32LE(o,24),e.writeUInt16LE(this.utf8FileName.length,28),e.writeUInt16LE(s.length,30),e.writeUInt16LE(this.fileComment.length,32),e.writeUInt16LE(0,34),e.writeUInt16LE(0,36),e.writeUInt32LE(this.externalFileAttributes,38),e.writeUInt32LE(a,42),i.concat([e,this.utf8FileName,s,this.fileComment])},E.prototype.getCompressionMethod=function(){return this.compress?8:0},c.inherits(I,r),I.prototype._transform=function(e,t,n){this.byteCount+=e.length,n(null,e)},c.inherits(N,r),N.prototype._transform=function(e,t,n){this.crc32=u.unsigned(e,this.crc32),n(null,e)};var L="\0 !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~";if(256!==L.length)throw new Error("assertion failure");var D=null;function x(e){x=function(e){return i.allocUnsafe(e)};try{return x(e)}catch(t){return(x=function(e){return new i(e)})(e)}}function O(e,t){O=function(e,t){return i.from(e,t)};try{return O(e,t)}catch(n){return(O=function(e,t){return new i(e,t)})(e,t)}}function F(e,t){F=function(e,t){return e.includes(t)};try{return F(e,t)}catch(n){return(F=function(e,t){for(var n=0;n<=e.length-t.length;n++)for(var i=0;;i++){if(i===t.length)return!0;if(e[n+i]!==t[i])break}return!1})(e,t)}}}).call(this,n(57).setImmediate,n(3).Buffer)},function(e,t,n){"use strict";(function(e){var i=n(3).Buffer,s=n(34).Transform,r=n(882),o=n(59),a=n(58).ok,c=n(3).kMaxLength,l="Cannot create final Buffer. It would be larger than 0x"+c.toString(16)+" bytes";r.Z_MIN_WINDOWBITS=8,r.Z_MAX_WINDOWBITS=15,r.Z_DEFAULT_WINDOWBITS=15,r.Z_MIN_CHUNK=64,r.Z_MAX_CHUNK=1/0,r.Z_DEFAULT_CHUNK=16384,r.Z_MIN_MEMLEVEL=1,r.Z_MAX_MEMLEVEL=9,r.Z_DEFAULT_MEMLEVEL=8,r.Z_MIN_LEVEL=-1,r.Z_MAX_LEVEL=9,r.Z_DEFAULT_LEVEL=r.Z_DEFAULT_COMPRESSION;for(var u=Object.keys(r),d=0;d<u.length;d++){var h=u[d];h.match(/^Z/)&&Object.defineProperty(t,h,{enumerable:!0,value:r[h],writable:!1})}for(var f={Z_OK:r.Z_OK,Z_STREAM_END:r.Z_STREAM_END,Z_NEED_DICT:r.Z_NEED_DICT,Z_ERRNO:r.Z_ERRNO,Z_STREAM_ERROR:r.Z_STREAM_ERROR,Z_DATA_ERROR:r.Z_DATA_ERROR,Z_MEM_ERROR:r.Z_MEM_ERROR,Z_BUF_ERROR:r.Z_BUF_ERROR,Z_VERSION_ERROR:r.Z_VERSION_ERROR},p=Object.keys(f),m=0;m<p.length;m++){var g=p[m];f[f[g]]=g}function y(e,t,n){var s=[],r=0;function o(){for(var t;null!==(t=e.read());)s.push(t),r+=t.length;e.once("readable",o)}function a(){var t,o=null;r>=c?o=new RangeError(l):t=i.concat(s,r),s=[],e.close(),n(o,t)}e.on("error",(function(t){e.removeListener("end",a),e.removeListener("readable",o),n(t)})),e.on("end",a),e.end(t),o()}function v(e,t){if("string"==typeof t&&(t=i.from(t)),!i.isBuffer(t))throw new TypeError("Not a string or buffer");var n=e._finishFlushFlag;return e._processChunk(t,n)}function S(e){if(!(this instanceof S))return new S(e);A.call(this,e,r.DEFLATE)}function _(e){if(!(this instanceof _))return new _(e);A.call(this,e,r.INFLATE)}function E(e){if(!(this instanceof E))return new E(e);A.call(this,e,r.GZIP)}function w(e){if(!(this instanceof w))return new w(e);A.call(this,e,r.GUNZIP)}function b(e){if(!(this instanceof b))return new b(e);A.call(this,e,r.DEFLATERAW)}function C(e){if(!(this instanceof C))return new C(e);A.call(this,e,r.INFLATERAW)}function T(e){if(!(this instanceof T))return new T(e);A.call(this,e,r.UNZIP)}function M(e){return e===r.Z_NO_FLUSH||e===r.Z_PARTIAL_FLUSH||e===r.Z_SYNC_FLUSH||e===r.Z_FULL_FLUSH||e===r.Z_FINISH||e===r.Z_BLOCK}function A(e,n){var o=this;if(this._opts=e=e||{},this._chunkSize=e.chunkSize||t.Z_DEFAULT_CHUNK,s.call(this,e),e.flush&&!M(e.flush))throw new Error("Invalid flush flag: "+e.flush);if(e.finishFlush&&!M(e.finishFlush))throw new Error("Invalid flush flag: "+e.finishFlush);if(this._flushFlag=e.flush||r.Z_NO_FLUSH,this._finishFlushFlag=void 0!==e.finishFlush?e.finishFlush:r.Z_FINISH,e.chunkSize&&(e.chunkSize<t.Z_MIN_CHUNK||e.chunkSize>t.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<t.Z_MIN_WINDOWBITS||e.windowBits>t.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<t.Z_MIN_LEVEL||e.level>t.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<t.Z_MIN_MEMLEVEL||e.memLevel>t.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=t.Z_FILTERED&&e.strategy!=t.Z_HUFFMAN_ONLY&&e.strategy!=t.Z_RLE&&e.strategy!=t.Z_FIXED&&e.strategy!=t.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!i.isBuffer(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new r.Zlib(n);var a=this;this._hadError=!1,this._handle.onerror=function(e,n){k(a),a._hadError=!0;var i=new Error(e);i.errno=n,i.code=t.codes[n],a.emit("error",i)};var c=t.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(c=e.level);var l=t.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(l=e.strategy),this._handle.init(e.windowBits||t.Z_DEFAULT_WINDOWBITS,c,e.memLevel||t.Z_DEFAULT_MEMLEVEL,l,e.dictionary),this._buffer=i.allocUnsafe(this._chunkSize),this._offset=0,this._level=c,this._strategy=l,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!o._handle},configurable:!0,enumerable:!0})}function k(t,n){n&&e.nextTick(n),t._handle&&(t._handle.close(),t._handle=null)}function R(e){e.emit("close")}Object.defineProperty(t,"codes",{enumerable:!0,value:Object.freeze(f),writable:!1}),t.Deflate=S,t.Inflate=_,t.Gzip=E,t.Gunzip=w,t.DeflateRaw=b,t.InflateRaw=C,t.Unzip=T,t.createDeflate=function(e){return new S(e)},t.createInflate=function(e){return new _(e)},t.createDeflateRaw=function(e){return new b(e)},t.createInflateRaw=function(e){return new C(e)},t.createGzip=function(e){return new E(e)},t.createGunzip=function(e){return new w(e)},t.createUnzip=function(e){return new T(e)},t.deflate=function(e,t,n){return"function"==typeof t&&(n=t,t={}),y(new S(t),e,n)},t.deflateSync=function(e,t){return v(new S(t),e)},t.gzip=function(e,t,n){return"function"==typeof t&&(n=t,t={}),y(new E(t),e,n)},t.gzipSync=function(e,t){return v(new E(t),e)},t.deflateRaw=function(e,t,n){return"function"==typeof t&&(n=t,t={}),y(new b(t),e,n)},t.deflateRawSync=function(e,t){return v(new b(t),e)},t.unzip=function(e,t,n){return"function"==typeof t&&(n=t,t={}),y(new T(t),e,n)},t.unzipSync=function(e,t){return v(new T(t),e)},t.inflate=function(e,t,n){return"function"==typeof t&&(n=t,t={}),y(new _(t),e,n)},t.inflateSync=function(e,t){return v(new _(t),e)},t.gunzip=function(e,t,n){return"function"==typeof t&&(n=t,t={}),y(new w(t),e,n)},t.gunzipSync=function(e,t){return v(new w(t),e)},t.inflateRaw=function(e,t,n){return"function"==typeof t&&(n=t,t={}),y(new C(t),e,n)},t.inflateRawSync=function(e,t){return v(new C(t),e)},o.inherits(A,s),A.prototype.params=function(n,i,s){if(n<t.Z_MIN_LEVEL||n>t.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+n);if(i!=t.Z_FILTERED&&i!=t.Z_HUFFMAN_ONLY&&i!=t.Z_RLE&&i!=t.Z_FIXED&&i!=t.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+i);if(this._level!==n||this._strategy!==i){var o=this;this.flush(r.Z_SYNC_FLUSH,(function(){a(o._handle,"zlib binding closed"),o._handle.params(n,i),o._hadError||(o._level=n,o._strategy=i,s&&s())}))}else e.nextTick(s)},A.prototype.reset=function(){return a(this._handle,"zlib binding closed"),this._handle.reset()},A.prototype._flush=function(e){this._transform(i.alloc(0),"",e)},A.prototype.flush=function(t,n){var s=this,o=this._writableState;("function"==typeof t||void 0===t&&!n)&&(n=t,t=r.Z_FULL_FLUSH),o.ended?n&&e.nextTick(n):o.ending?n&&this.once("end",n):o.needDrain?n&&this.once("drain",(function(){return s.flush(t,n)})):(this._flushFlag=t,this.write(i.alloc(0),"",n))},A.prototype.close=function(t){k(this,t),e.nextTick(R,this)},A.prototype._transform=function(e,t,n){var s,o=this._writableState,a=(o.ending||o.ended)&&(!e||o.length===e.length);return null===e||i.isBuffer(e)?this._handle?(a?s=this._finishFlushFlag:(s=this._flushFlag,e.length>=o.length&&(this._flushFlag=this._opts.flush||r.Z_NO_FLUSH)),void this._processChunk(e,s,n)):n(new Error("zlib binding closed")):n(new Error("invalid input"))},A.prototype._processChunk=function(e,t,n){var s=e&&e.length,r=this._chunkSize-this._offset,o=0,u=this,d="function"==typeof n;if(!d){var h,f=[],p=0;this.on("error",(function(e){h=e})),a(this._handle,"zlib binding closed");do{var m=this._handle.writeSync(t,e,o,s,this._buffer,this._offset,r)}while(!this._hadError&&v(m[0],m[1]));if(this._hadError)throw h;if(p>=c)throw k(this),new RangeError(l);var g=i.concat(f,p);return k(this),g}a(this._handle,"zlib binding closed");var y=this._handle.write(t,e,o,s,this._buffer,this._offset,r);function v(c,l){if(this&&(this.buffer=null,this.callback=null),!u._hadError){var h=r-l;if(a(h>=0,"have should not go down"),h>0){var m=u._buffer.slice(u._offset,u._offset+h);u._offset+=h,d?u.push(m):(f.push(m),p+=m.length)}if((0===l||u._offset>=u._chunkSize)&&(r=u._chunkSize,u._offset=0,u._buffer=i.allocUnsafe(u._chunkSize)),0===l){if(o+=s-c,s=c,!d)return!0;var g=u._handle.write(t,e,o,s,u._buffer,u._offset,u._chunkSize);return g.callback=v,void(g.buffer=e)}if(!d)return!1;n()}}y.buffer=e,y.callback=v},o.inherits(S,A),o.inherits(_,A),o.inherits(E,A),o.inherits(w,A),o.inherits(b,A),o.inherits(C,A),o.inherits(T,A)}).call(this,n(11))},function(e,t,n){"use strict";(function(e,i){var s=n(58),r=n(886),o=n(887),a=n(890),c=n(893);for(var l in c)t[l]=c[l];t.NONE=0,t.DEFLATE=1,t.INFLATE=2,t.GZIP=3,t.GUNZIP=4,t.DEFLATERAW=5,t.INFLATERAW=6,t.UNZIP=7;function u(e){if("number"!=typeof e||e<t.DEFLATE||e>t.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=e,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}u.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,s(this.init_done,"close before init"),s(this.mode<=t.UNZIP),this.mode===t.DEFLATE||this.mode===t.GZIP||this.mode===t.DEFLATERAW?o.deflateEnd(this.strm):this.mode!==t.INFLATE&&this.mode!==t.GUNZIP&&this.mode!==t.INFLATERAW&&this.mode!==t.UNZIP||a.inflateEnd(this.strm),this.mode=t.NONE,this.dictionary=null)},u.prototype.write=function(e,t,n,i,s,r,o){return this._write(!0,e,t,n,i,s,r,o)},u.prototype.writeSync=function(e,t,n,i,s,r,o){return this._write(!1,e,t,n,i,s,r,o)},u.prototype._write=function(n,r,o,a,c,l,u,d){if(s.equal(arguments.length,8),s(this.init_done,"write before init"),s(this.mode!==t.NONE,"already finalized"),s.equal(!1,this.write_in_progress,"write already in progress"),s.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,s.equal(!1,void 0===r,"must provide flush value"),this.write_in_progress=!0,r!==t.Z_NO_FLUSH&&r!==t.Z_PARTIAL_FLUSH&&r!==t.Z_SYNC_FLUSH&&r!==t.Z_FULL_FLUSH&&r!==t.Z_FINISH&&r!==t.Z_BLOCK)throw new Error("Invalid flush value");if(null==o&&(o=e.alloc(0),c=0,a=0),this.strm.avail_in=c,this.strm.input=o,this.strm.next_in=a,this.strm.avail_out=d,this.strm.output=l,this.strm.next_out=u,this.flush=r,!n)return this._process(),this._checkError()?this._afterSync():void 0;var h=this;return i.nextTick((function(){h._process(),h._after()})),this},u.prototype._afterSync=function(){var e=this.strm.avail_out,t=this.strm.avail_in;return this.write_in_progress=!1,[t,e]},u.prototype._process=function(){var e=null;switch(this.mode){case t.DEFLATE:case t.GZIP:case t.DEFLATERAW:this.err=o.deflate(this.strm,this.flush);break;case t.UNZIP:switch(this.strm.avail_in>0&&(e=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===e)break;if(31!==this.strm.input[e]){this.mode=t.INFLATE;break}if(this.gzip_id_bytes_read=1,e++,1===this.strm.avail_in)break;case 1:if(null===e)break;139===this.strm.input[e]?(this.gzip_id_bytes_read=2,this.mode=t.GUNZIP):this.mode=t.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case t.INFLATE:case t.GUNZIP:case t.INFLATERAW:for(this.err=a.inflate(this.strm,this.flush),this.err===t.Z_NEED_DICT&&this.dictionary&&(this.err=a.inflateSetDictionary(this.strm,this.dictionary),this.err===t.Z_OK?this.err=a.inflate(this.strm,this.flush):this.err===t.Z_DATA_ERROR&&(this.err=t.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===t.GUNZIP&&this.err===t.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=a.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},u.prototype._checkError=function(){switch(this.err){case t.Z_OK:case t.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===t.Z_FINISH)return this._error("unexpected end of file"),!1;break;case t.Z_STREAM_END:break;case t.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},u.prototype._after=function(){if(this._checkError()){var e=this.strm.avail_out,t=this.strm.avail_in;this.write_in_progress=!1,this.callback(t,e),this.pending_close&&this.close()}},u.prototype._error=function(e){this.strm.msg&&(e=this.strm.msg),this.onerror(e,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},u.prototype.init=function(e,n,i,r,o){s(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),s(e>=8&&e<=15,"invalid windowBits"),s(n>=-1&&n<=9,"invalid compression level"),s(i>=1&&i<=9,"invalid memlevel"),s(r===t.Z_FILTERED||r===t.Z_HUFFMAN_ONLY||r===t.Z_RLE||r===t.Z_FIXED||r===t.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(n,e,i,r,o),this._setDictionary()},u.prototype.params=function(){throw new Error("deflateParams Not supported")},u.prototype.reset=function(){this._reset(),this._setDictionary()},u.prototype._init=function(e,n,i,s,c){switch(this.level=e,this.windowBits=n,this.memLevel=i,this.strategy=s,this.flush=t.Z_NO_FLUSH,this.err=t.Z_OK,this.mode!==t.GZIP&&this.mode!==t.GUNZIP||(this.windowBits+=16),this.mode===t.UNZIP&&(this.windowBits+=32),this.mode!==t.DEFLATERAW&&this.mode!==t.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new r,this.mode){case t.DEFLATE:case t.GZIP:case t.DEFLATERAW:this.err=o.deflateInit2(this.strm,this.level,t.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case t.INFLATE:case t.GUNZIP:case t.INFLATERAW:case t.UNZIP:this.err=a.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==t.Z_OK&&this._error("Init error"),this.dictionary=c,this.write_in_progress=!1,this.init_done=!0},u.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=t.Z_OK,this.mode){case t.DEFLATE:case t.DEFLATERAW:this.err=o.deflateSetDictionary(this.strm,this.dictionary)}this.err!==t.Z_OK&&this._error("Failed to set dictionary")}},u.prototype._reset=function(){switch(this.err=t.Z_OK,this.mode){case t.DEFLATE:case t.DEFLATERAW:case t.GZIP:this.err=o.deflateReset(this.strm);break;case t.INFLATE:case t.INFLATERAW:case t.GUNZIP:this.err=a.inflateReset(this.strm)}this.err!==t.Z_OK&&this._error("Failed to reset stream")},t.Zlib=u}).call(this,n(3).Buffer,n(11))},function(e,t,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var i=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(e){i[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,a,c=o(e),l=1;l<arguments.length;l++){for(var u in n=Object(arguments[l]))s.call(n,u)&&(c[u]=n[u]);if(i){a=i(n);for(var d=0;d<a.length;d++)r.call(n,a[d])&&(c[a[d]]=n[a[d]])}}return c}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(e,t,n){"use strict";var i,s=n(160),r=n(888),o=n(390),a=n(391),c=n(889);function l(e,t){return e.msg=c[t],t}function u(e){return(e<<1)-(e>4?9:0)}function d(e){for(var t=e.length;--t>=0;)e[t]=0}function h(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(s.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function f(e,t){r._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,h(e.strm)}function p(e,t){e.pending_buf[e.pending++]=t}function m(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function g(e,t){var n,i,s=e.max_chain_length,r=e.strstart,o=e.prev_length,a=e.nice_match,c=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,l=e.window,u=e.w_mask,d=e.prev,h=e.strstart+258,f=l[r+o-1],p=l[r+o];e.prev_length>=e.good_match&&(s>>=2),a>e.lookahead&&(a=e.lookahead);do{if(l[(n=t)+o]===p&&l[n+o-1]===f&&l[n]===l[r]&&l[++n]===l[r+1]){r+=2,n++;do{}while(l[++r]===l[++n]&&l[++r]===l[++n]&&l[++r]===l[++n]&&l[++r]===l[++n]&&l[++r]===l[++n]&&l[++r]===l[++n]&&l[++r]===l[++n]&&l[++r]===l[++n]&&r<h);if(i=258-(h-r),r=h-258,i>o){if(e.match_start=t,o=i,i>=a)break;f=l[r+o-1],p=l[r+o]}}}while((t=d[t&u])>c&&0!=--s);return o<=e.lookahead?o:e.lookahead}function y(e){var t,n,i,r,c,l,u,d,h,f,p=e.w_size;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=p+(p-262)){s.arraySet(e.window,e.window,p,p,0),e.match_start-=p,e.strstart-=p,e.block_start-=p,t=n=e.hash_size;do{i=e.head[--t],e.head[t]=i>=p?i-p:0}while(--n);t=n=p;do{i=e.prev[--t],e.prev[t]=i>=p?i-p:0}while(--n);r+=p}if(0===e.strm.avail_in)break;if(l=e.strm,u=e.window,d=e.strstart+e.lookahead,h=r,f=void 0,(f=l.avail_in)>h&&(f=h),n=0===f?0:(l.avail_in-=f,s.arraySet(u,l.input,l.next_in,f,d),1===l.state.wrap?l.adler=o(l.adler,u,f,d):2===l.state.wrap&&(l.adler=a(l.adler,u,f,d)),l.next_in+=f,l.total_in+=f,f),e.lookahead+=n,e.lookahead+e.insert>=3)for(c=e.strstart-e.insert,e.ins_h=e.window[c],e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+3-1])&e.hash_mask,e.prev[c&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=c,c++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)}function v(e,t){for(var n,i;;){if(e.lookahead<262){if(y(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-262&&(e.match_length=g(e,n)),e.match_length>=3)if(i=r._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(f(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(f(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(f(e,!1),0===e.strm.avail_out)?1:2}function S(e,t){for(var n,i,s;;){if(e.lookahead<262){if(y(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-262&&(e.match_length=g(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-3,i=r._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=s&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(f(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=r._tr_tally(e,0,e.window[e.strstart-1]))&&f(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=r._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(f(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(f(e,!1),0===e.strm.avail_out)?1:2}function _(e,t,n,i,s){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=s}function E(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(1146),this.dyn_dtree=new s.Buf16(122),this.bl_tree=new s.Buf16(78),d(this.dyn_ltree),d(this.dyn_dtree),d(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(16),this.heap=new s.Buf16(573),d(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(573),d(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function w(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=0,r._tr_init(t),0):l(e,-2)}function b(e){var t,n=w(e);return 0===n&&((t=e.state).window_size=2*t.w_size,d(t.head),t.max_lazy_match=i[t.level].max_lazy,t.good_match=i[t.level].good_length,t.nice_match=i[t.level].nice_length,t.max_chain_length=i[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n}function C(e,t,n,i,r,o){if(!e)return-2;var a=1;if(-1===t&&(t=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),r<1||r>9||8!==n||i<8||i>15||t<0||t>9||o<0||o>4)return l(e,-2);8===i&&(i=9);var c=new E;return e.state=c,c.strm=e,c.wrap=a,c.gzhead=null,c.w_bits=i,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=r+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+3-1)/3),c.window=new s.Buf8(2*c.w_size),c.head=new s.Buf16(c.hash_size),c.prev=new s.Buf16(c.w_size),c.lit_bufsize=1<<r+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new s.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=o,c.method=n,b(e)}i=[new _(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(y(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,f(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-262&&(f(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(f(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(f(e,!1),e.strm.avail_out),1)})),new _(4,4,8,4,v),new _(4,5,16,8,v),new _(4,6,32,32,v),new _(4,4,16,16,S),new _(8,16,32,32,S),new _(8,16,128,128,S),new _(8,32,128,256,S),new _(32,128,258,1024,S),new _(32,258,258,4096,S)],t.deflateInit=function(e,t){return C(e,t,8,15,8,0)},t.deflateInit2=C,t.deflateReset=b,t.deflateResetKeep=w,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?-2:(e.state.gzhead=t,0):-2},t.deflate=function(e,t){var n,s,o,c;if(!e||!e.state||t>5||t<0)return e?l(e,-2):-2;if(s=e.state,!e.output||!e.input&&0!==e.avail_in||666===s.status&&4!==t)return l(e,0===e.avail_out?-5:-2);if(s.strm=e,n=s.last_flush,s.last_flush=t,42===s.status)if(2===s.wrap)e.adler=0,p(s,31),p(s,139),p(s,8),s.gzhead?(p(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),p(s,255&s.gzhead.time),p(s,s.gzhead.time>>8&255),p(s,s.gzhead.time>>16&255),p(s,s.gzhead.time>>24&255),p(s,9===s.level?2:s.strategy>=2||s.level<2?4:0),p(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(p(s,255&s.gzhead.extra.length),p(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=a(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69):(p(s,0),p(s,0),p(s,0),p(s,0),p(s,0),p(s,9===s.level?2:s.strategy>=2||s.level<2?4:0),p(s,3),s.status=113);else{var g=8+(s.w_bits-8<<4)<<8;g|=(s.strategy>=2||s.level<2?0:s.level<6?1:6===s.level?2:3)<<6,0!==s.strstart&&(g|=32),g+=31-g%31,s.status=113,m(s,g),0!==s.strstart&&(m(s,e.adler>>>16),m(s,65535&e.adler)),e.adler=1}if(69===s.status)if(s.gzhead.extra){for(o=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>o&&(e.adler=a(e.adler,s.pending_buf,s.pending-o,o)),h(e),o=s.pending,s.pending!==s.pending_buf_size));)p(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>o&&(e.adler=a(e.adler,s.pending_buf,s.pending-o,o)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=73)}else s.status=73;if(73===s.status)if(s.gzhead.name){o=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>o&&(e.adler=a(e.adler,s.pending_buf,s.pending-o,o)),h(e),o=s.pending,s.pending===s.pending_buf_size)){c=1;break}c=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,p(s,c)}while(0!==c);s.gzhead.hcrc&&s.pending>o&&(e.adler=a(e.adler,s.pending_buf,s.pending-o,o)),0===c&&(s.gzindex=0,s.status=91)}else s.status=91;if(91===s.status)if(s.gzhead.comment){o=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>o&&(e.adler=a(e.adler,s.pending_buf,s.pending-o,o)),h(e),o=s.pending,s.pending===s.pending_buf_size)){c=1;break}c=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,p(s,c)}while(0!==c);s.gzhead.hcrc&&s.pending>o&&(e.adler=a(e.adler,s.pending_buf,s.pending-o,o)),0===c&&(s.status=103)}else s.status=103;if(103===s.status&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&h(e),s.pending+2<=s.pending_buf_size&&(p(s,255&e.adler),p(s,e.adler>>8&255),e.adler=0,s.status=113)):s.status=113),0!==s.pending){if(h(e),0===e.avail_out)return s.last_flush=-1,0}else if(0===e.avail_in&&u(t)<=u(n)&&4!==t)return l(e,-5);if(666===s.status&&0!==e.avail_in)return l(e,-5);if(0!==e.avail_in||0!==s.lookahead||0!==t&&666!==s.status){var v=2===s.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(y(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(f(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(f(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(f(e,!1),0===e.strm.avail_out)?1:2}(s,t):3===s.strategy?function(e,t){for(var n,i,s,o,a=e.window;;){if(e.lookahead<=258){if(y(e),e.lookahead<=258&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=a[s=e.strstart-1])===a[++s]&&i===a[++s]&&i===a[++s]){o=e.strstart+258;do{}while(i===a[++s]&&i===a[++s]&&i===a[++s]&&i===a[++s]&&i===a[++s]&&i===a[++s]&&i===a[++s]&&i===a[++s]&&s<o);e.match_length=258-(o-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=r._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(f(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(f(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(f(e,!1),0===e.strm.avail_out)?1:2}(s,t):i[s.level].func(s,t);if(3!==v&&4!==v||(s.status=666),1===v||3===v)return 0===e.avail_out&&(s.last_flush=-1),0;if(2===v&&(1===t?r._tr_align(s):5!==t&&(r._tr_stored_block(s,0,0,!1),3===t&&(d(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),h(e),0===e.avail_out))return s.last_flush=-1,0}return 4!==t?0:s.wrap<=0?1:(2===s.wrap?(p(s,255&e.adler),p(s,e.adler>>8&255),p(s,e.adler>>16&255),p(s,e.adler>>24&255),p(s,255&e.total_in),p(s,e.total_in>>8&255),p(s,e.total_in>>16&255),p(s,e.total_in>>24&255)):(m(s,e.adler>>>16),m(s,65535&e.adler)),h(e),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?0:1)},t.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?l(e,-2):(e.state=null,113===t?l(e,-3):0):-2},t.deflateSetDictionary=function(e,t){var n,i,r,a,c,l,u,h,f=t.length;if(!e||!e.state)return-2;if(2===(a=(n=e.state).wrap)||1===a&&42!==n.status||n.lookahead)return-2;for(1===a&&(e.adler=o(e.adler,t,f,0)),n.wrap=0,f>=n.w_size&&(0===a&&(d(n.head),n.strstart=0,n.block_start=0,n.insert=0),h=new s.Buf8(n.w_size),s.arraySet(h,t,f-n.w_size,n.w_size,0),t=h,f=n.w_size),c=e.avail_in,l=e.next_in,u=e.input,e.avail_in=f,e.next_in=0,e.input=t,y(n);n.lookahead>=3;){i=n.strstart,r=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+3-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++}while(--r);n.strstart=i,n.lookahead=2,y(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=l,e.input=u,e.avail_in=c,n.wrap=a,0},t.deflateInfo="pako deflate (from Nodeca project)"},function(e,t,n){"use strict";var i=n(160);function s(e){for(var t=e.length;--t>=0;)e[t]=0}var r=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],o=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],c=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],l=new Array(576);s(l);var u=new Array(60);s(u);var d=new Array(512);s(d);var h=new Array(256);s(h);var f=new Array(29);s(f);var p,m,g,y=new Array(30);function v(e,t,n,i,s){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=s,this.has_stree=e&&e.length}function S(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function _(e){return e<256?d[e]:d[256+(e>>>7)]}function E(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function w(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,E(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function b(e,t,n){w(e,n[2*t],n[2*t+1])}function C(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function T(e,t,n){var i,s,r=new Array(16),o=0;for(i=1;i<=15;i++)r[i]=o=o+n[i-1]<<1;for(s=0;s<=t;s++){var a=e[2*s+1];0!==a&&(e[2*s]=C(r[a]++,a))}}function M(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function A(e){e.bi_valid>8?E(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function k(e,t,n,i){var s=2*t,r=2*n;return e[s]<e[r]||e[s]===e[r]&&i[t]<=i[n]}function R(e,t,n){for(var i=e.heap[n],s=n<<1;s<=e.heap_len&&(s<e.heap_len&&k(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!k(t,i,e.heap[s],e.depth));)e.heap[n]=e.heap[s],n=s,s<<=1;e.heap[n]=i}function P(e,t,n){var i,s,a,c,l=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],s=e.pending_buf[e.l_buf+l],l++,0===i?b(e,s,t):(b(e,(a=h[s])+256+1,t),0!==(c=r[a])&&w(e,s-=f[a],c),b(e,a=_(--i),n),0!==(c=o[a])&&w(e,i-=y[a],c))}while(l<e.last_lit);b(e,256,t)}function I(e,t){var n,i,s,r=t.dyn_tree,o=t.stat_desc.static_tree,a=t.stat_desc.has_stree,c=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<c;n++)0!==r[2*n]?(e.heap[++e.heap_len]=l=n,e.depth[n]=0):r[2*n+1]=0;for(;e.heap_len<2;)r[2*(s=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[s]=0,e.opt_len--,a&&(e.static_len-=o[2*s+1]);for(t.max_code=l,n=e.heap_len>>1;n>=1;n--)R(e,r,n);s=c;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],R(e,r,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,r[2*s]=r[2*n]+r[2*i],e.depth[s]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,r[2*n+1]=r[2*i+1]=s,e.heap[1]=s++,R(e,r,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,i,s,r,o,a,c=t.dyn_tree,l=t.max_code,u=t.stat_desc.static_tree,d=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(r=0;r<=15;r++)e.bl_count[r]=0;for(c[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(r=c[2*c[2*(i=e.heap[n])+1]+1]+1)>p&&(r=p,m++),c[2*i+1]=r,i>l||(e.bl_count[r]++,o=0,i>=f&&(o=h[i-f]),a=c[2*i],e.opt_len+=a*(r+o),d&&(e.static_len+=a*(u[2*i+1]+o)));if(0!==m){do{for(r=p-1;0===e.bl_count[r];)r--;e.bl_count[r]--,e.bl_count[r+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(r=p;0!==r;r--)for(i=e.bl_count[r];0!==i;)(s=e.heap[--n])>l||(c[2*s+1]!==r&&(e.opt_len+=(r-c[2*s+1])*c[2*s],c[2*s+1]=r),i--)}}(e,t),T(r,l,e.bl_count)}function N(e,t,n){var i,s,r=-1,o=t[1],a=0,c=7,l=4;for(0===o&&(c=138,l=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)s=o,o=t[2*(i+1)+1],++a<c&&s===o||(a<l?e.bl_tree[2*s]+=a:0!==s?(s!==r&&e.bl_tree[2*s]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,r=s,0===o?(c=138,l=3):s===o?(c=6,l=3):(c=7,l=4))}function L(e,t,n){var i,s,r=-1,o=t[1],a=0,c=7,l=4;for(0===o&&(c=138,l=3),i=0;i<=n;i++)if(s=o,o=t[2*(i+1)+1],!(++a<c&&s===o)){if(a<l)do{b(e,s,e.bl_tree)}while(0!=--a);else 0!==s?(s!==r&&(b(e,s,e.bl_tree),a--),b(e,16,e.bl_tree),w(e,a-3,2)):a<=10?(b(e,17,e.bl_tree),w(e,a-3,3)):(b(e,18,e.bl_tree),w(e,a-11,7));a=0,r=s,0===o?(c=138,l=3):s===o?(c=6,l=3):(c=7,l=4)}}s(y);var D=!1;function x(e,t,n,s){w(e,0+(s?1:0),3),function(e,t,n,s){A(e),s&&(E(e,n),E(e,~n)),i.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}t._tr_init=function(e){D||(!function(){var e,t,n,i,s,c=new Array(16);for(n=0,i=0;i<28;i++)for(f[i]=n,e=0;e<1<<r[i];e++)h[n++]=i;for(h[n-1]=i,s=0,i=0;i<16;i++)for(y[i]=s,e=0;e<1<<o[i];e++)d[s++]=i;for(s>>=7;i<30;i++)for(y[i]=s<<7,e=0;e<1<<o[i]-7;e++)d[256+s++]=i;for(t=0;t<=15;t++)c[t]=0;for(e=0;e<=143;)l[2*e+1]=8,e++,c[8]++;for(;e<=255;)l[2*e+1]=9,e++,c[9]++;for(;e<=279;)l[2*e+1]=7,e++,c[7]++;for(;e<=287;)l[2*e+1]=8,e++,c[8]++;for(T(l,287,c),e=0;e<30;e++)u[2*e+1]=5,u[2*e]=C(e,5);p=new v(l,r,257,286,15),m=new v(u,o,0,30,15),g=new v(new Array(0),a,0,19,7)}(),D=!0),e.l_desc=new S(e.dyn_ltree,p),e.d_desc=new S(e.dyn_dtree,m),e.bl_desc=new S(e.bl_tree,g),e.bi_buf=0,e.bi_valid=0,M(e)},t._tr_stored_block=x,t._tr_flush_block=function(e,t,n,i){var s,r,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),I(e,e.l_desc),I(e,e.d_desc),o=function(e){var t;for(N(e,e.dyn_ltree,e.l_desc.max_code),N(e,e.dyn_dtree,e.d_desc.max_code),I(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*c[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),s=e.opt_len+3+7>>>3,(r=e.static_len+3+7>>>3)<=s&&(s=r)):s=r=n+5,n+4<=s&&-1!==t?x(e,t,n,i):4===e.strategy||r===s?(w(e,2+(i?1:0),3),P(e,l,u)):(w(e,4+(i?1:0),3),function(e,t,n,i){var s;for(w(e,t-257,5),w(e,n-1,5),w(e,i-4,4),s=0;s<i;s++)w(e,e.bl_tree[2*c[s]+1],3);L(e,e.dyn_ltree,t-1),L(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),P(e,e.dyn_ltree,e.dyn_dtree)),M(e),i&&A(e)},t._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(h[n]+256+1)]++,e.dyn_dtree[2*_(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){w(e,2,3),b(e,256,l),function(e){16===e.bi_valid?(E(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},function(e,t,n){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(e,t,n){"use strict";var i=n(160),s=n(390),r=n(391),o=n(891),a=n(892);function c(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function l(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function u(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(852),t.distcode=t.distdyn=new i.Buf32(592),t.sane=1,t.back=-1,0):-2}function d(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,u(e)):-2}function h(e,t){var n,i;return e&&e.state?(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,d(e))):-2}function f(e,t){var n,i;return e?(i=new l,e.state=i,i.window=null,0!==(n=h(e,t))&&(e.state=null),n):-2}var p,m,g=!0;function y(e){if(g){var t;for(p=new i.Buf32(512),m=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(a(1,e.lens,0,288,p,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;a(2,e.lens,0,32,m,0,e.work,{bits:5}),g=!1}e.lencode=p,e.lenbits=9,e.distcode=m,e.distbits=5}function v(e,t,n,s){var r,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new i.Buf8(o.wsize)),s>=o.wsize?(i.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((r=o.wsize-o.wnext)>s&&(r=s),i.arraySet(o.window,t,n-s,r,o.wnext),(s-=r)?(i.arraySet(o.window,t,n-s,s,0),o.wnext=s,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0}t.inflateReset=d,t.inflateReset2=h,t.inflateResetKeep=u,t.inflateInit=function(e){return f(e,15)},t.inflateInit2=f,t.inflate=function(e,t){var n,l,u,d,h,f,p,m,g,S,_,E,w,b,C,T,M,A,k,R,P,I,N,L,D=0,x=new i.Buf8(4),O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(n=e.state).mode&&(n.mode=13),h=e.next_out,u=e.output,p=e.avail_out,d=e.next_in,l=e.input,f=e.avail_in,m=n.hold,g=n.bits,S=f,_=p,I=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;g<16;){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}if(2&n.wrap&&35615===m){n.check=0,x[0]=255&m,x[1]=m>>>8&255,n.check=r(n.check,x,2,0),m=0,g=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&m)<<8)+(m>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&m)){e.msg="unknown compression method",n.mode=30;break}if(g-=4,P=8+(15&(m>>>=4)),0===n.wbits)n.wbits=P;else if(P>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<P,e.adler=n.check=1,n.mode=512&m?10:12,m=0,g=0;break;case 2:for(;g<16;){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}if(n.flags=m,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=m>>8&1),512&n.flags&&(x[0]=255&m,x[1]=m>>>8&255,n.check=r(n.check,x,2,0)),m=0,g=0,n.mode=3;case 3:for(;g<32;){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}n.head&&(n.head.time=m),512&n.flags&&(x[0]=255&m,x[1]=m>>>8&255,x[2]=m>>>16&255,x[3]=m>>>24&255,n.check=r(n.check,x,4,0)),m=0,g=0,n.mode=4;case 4:for(;g<16;){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}n.head&&(n.head.xflags=255&m,n.head.os=m>>8),512&n.flags&&(x[0]=255&m,x[1]=m>>>8&255,n.check=r(n.check,x,2,0)),m=0,g=0,n.mode=5;case 5:if(1024&n.flags){for(;g<16;){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}n.length=m,n.head&&(n.head.extra_len=m),512&n.flags&&(x[0]=255&m,x[1]=m>>>8&255,n.check=r(n.check,x,2,0)),m=0,g=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((E=n.length)>f&&(E=f),E&&(n.head&&(P=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,l,d,E,P)),512&n.flags&&(n.check=r(n.check,l,E,d)),f-=E,d+=E,n.length-=E),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===f)break e;E=0;do{P=l[d+E++],n.head&&P&&n.length<65536&&(n.head.name+=String.fromCharCode(P))}while(P&&E<f);if(512&n.flags&&(n.check=r(n.check,l,E,d)),f-=E,d+=E,P)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===f)break e;E=0;do{P=l[d+E++],n.head&&P&&n.length<65536&&(n.head.comment+=String.fromCharCode(P))}while(P&&E<f);if(512&n.flags&&(n.check=r(n.check,l,E,d)),f-=E,d+=E,P)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;g<16;){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}if(m!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}m=0,g=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;g<32;){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}e.adler=n.check=c(m),m=0,g=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=h,e.avail_out=p,e.next_in=d,e.avail_in=f,n.hold=m,n.bits=g,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){m>>>=7&g,g-=7&g,n.mode=27;break}for(;g<3;){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}switch(n.last=1&m,g-=1,3&(m>>>=1)){case 0:n.mode=14;break;case 1:if(y(n),n.mode=20,6===t){m>>>=2,g-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}m>>>=2,g-=2;break;case 14:for(m>>>=7&g,g-=7&g;g<32;){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}if((65535&m)!=(m>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&m,m=0,g=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(E=n.length){if(E>f&&(E=f),E>p&&(E=p),0===E)break e;i.arraySet(u,l,d,E,h),f-=E,d+=E,p-=E,h+=E,n.length-=E;break}n.mode=12;break;case 17:for(;g<14;){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}if(n.nlen=257+(31&m),m>>>=5,g-=5,n.ndist=1+(31&m),m>>>=5,g-=5,n.ncode=4+(15&m),m>>>=4,g-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;g<3;){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}n.lens[O[n.have++]]=7&m,m>>>=3,g-=3}for(;n.have<19;)n.lens[O[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,N={bits:n.lenbits},I=a(0,n.lens,0,19,n.lencode,0,n.work,N),n.lenbits=N.bits,I){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;T=(D=n.lencode[m&(1<<n.lenbits)-1])>>>16&255,M=65535&D,!((C=D>>>24)<=g);){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}if(M<16)m>>>=C,g-=C,n.lens[n.have++]=M;else{if(16===M){for(L=C+2;g<L;){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}if(m>>>=C,g-=C,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}P=n.lens[n.have-1],E=3+(3&m),m>>>=2,g-=2}else if(17===M){for(L=C+3;g<L;){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}g-=C,P=0,E=3+(7&(m>>>=C)),m>>>=3,g-=3}else{for(L=C+7;g<L;){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}g-=C,P=0,E=11+(127&(m>>>=C)),m>>>=7,g-=7}if(n.have+E>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;E--;)n.lens[n.have++]=P}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,N={bits:n.lenbits},I=a(1,n.lens,0,n.nlen,n.lencode,0,n.work,N),n.lenbits=N.bits,I){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,N={bits:n.distbits},I=a(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,N),n.distbits=N.bits,I){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(f>=6&&p>=258){e.next_out=h,e.avail_out=p,e.next_in=d,e.avail_in=f,n.hold=m,n.bits=g,o(e,_),h=e.next_out,u=e.output,p=e.avail_out,d=e.next_in,l=e.input,f=e.avail_in,m=n.hold,g=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;T=(D=n.lencode[m&(1<<n.lenbits)-1])>>>16&255,M=65535&D,!((C=D>>>24)<=g);){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}if(T&&0==(240&T)){for(A=C,k=T,R=M;T=(D=n.lencode[R+((m&(1<<A+k)-1)>>A)])>>>16&255,M=65535&D,!(A+(C=D>>>24)<=g);){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}m>>>=A,g-=A,n.back+=A}if(m>>>=C,g-=C,n.back+=C,n.length=M,0===T){n.mode=26;break}if(32&T){n.back=-1,n.mode=12;break}if(64&T){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&T,n.mode=22;case 22:if(n.extra){for(L=n.extra;g<L;){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}n.length+=m&(1<<n.extra)-1,m>>>=n.extra,g-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;T=(D=n.distcode[m&(1<<n.distbits)-1])>>>16&255,M=65535&D,!((C=D>>>24)<=g);){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}if(0==(240&T)){for(A=C,k=T,R=M;T=(D=n.distcode[R+((m&(1<<A+k)-1)>>A)])>>>16&255,M=65535&D,!(A+(C=D>>>24)<=g);){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}m>>>=A,g-=A,n.back+=A}if(m>>>=C,g-=C,n.back+=C,64&T){e.msg="invalid distance code",n.mode=30;break}n.offset=M,n.extra=15&T,n.mode=24;case 24:if(n.extra){for(L=n.extra;g<L;){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}n.offset+=m&(1<<n.extra)-1,m>>>=n.extra,g-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===p)break e;if(E=_-p,n.offset>E){if((E=n.offset-E)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}E>n.wnext?(E-=n.wnext,w=n.wsize-E):w=n.wnext-E,E>n.length&&(E=n.length),b=n.window}else b=u,w=h-n.offset,E=n.length;E>p&&(E=p),p-=E,n.length-=E;do{u[h++]=b[w++]}while(--E);0===n.length&&(n.mode=21);break;case 26:if(0===p)break e;u[h++]=n.length,p--,n.mode=21;break;case 27:if(n.wrap){for(;g<32;){if(0===f)break e;f--,m|=l[d++]<<g,g+=8}if(_-=p,e.total_out+=_,n.total+=_,_&&(e.adler=n.check=n.flags?r(n.check,u,_,h-_):s(n.check,u,_,h-_)),_=p,(n.flags?m:c(m))!==n.check){e.msg="incorrect data check",n.mode=30;break}m=0,g=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;g<32;){if(0===f)break e;f--,m+=l[d++]<<g,g+=8}if(m!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}m=0,g=0}n.mode=29;case 29:I=1;break e;case 30:I=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=h,e.avail_out=p,e.next_in=d,e.avail_in=f,n.hold=m,n.bits=g,(n.wsize||_!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&v(e,e.output,e.next_out,_-e.avail_out)?(n.mode=31,-4):(S-=e.avail_in,_-=e.avail_out,e.total_in+=S,e.total_out+=_,n.total+=_,n.wrap&&_&&(e.adler=n.check=n.flags?r(n.check,u,_,e.next_out-_):s(n.check,u,_,e.next_out-_)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===S&&0===_||4===t)&&0===I&&(I=-5),I)},t.inflateEnd=function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},t.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?-2:(n.head=t,t.done=!1,0):-2},t.inflateSetDictionary=function(e,t){var n,i=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?-2:11===n.mode&&s(1,t,i,0)!==n.check?-3:v(e,t,i,i)?(n.mode=31,-4):(n.havedict=1,0):-2},t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,n){"use strict";e.exports=function(e,t){var n,i,s,r,o,a,c,l,u,d,h,f,p,m,g,y,v,S,_,E,w,b,C,T,M;n=e.state,i=e.next_in,T=e.input,s=i+(e.avail_in-5),r=e.next_out,M=e.output,o=r-(t-e.avail_out),a=r+(e.avail_out-257),c=n.dmax,l=n.wsize,u=n.whave,d=n.wnext,h=n.window,f=n.hold,p=n.bits,m=n.lencode,g=n.distcode,y=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;e:do{p<15&&(f+=T[i++]<<p,p+=8,f+=T[i++]<<p,p+=8),S=m[f&y];t:for(;;){if(f>>>=_=S>>>24,p-=_,0===(_=S>>>16&255))M[r++]=65535&S;else{if(!(16&_)){if(0==(64&_)){S=m[(65535&S)+(f&(1<<_)-1)];continue t}if(32&_){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}E=65535&S,(_&=15)&&(p<_&&(f+=T[i++]<<p,p+=8),E+=f&(1<<_)-1,f>>>=_,p-=_),p<15&&(f+=T[i++]<<p,p+=8,f+=T[i++]<<p,p+=8),S=g[f&v];n:for(;;){if(f>>>=_=S>>>24,p-=_,!(16&(_=S>>>16&255))){if(0==(64&_)){S=g[(65535&S)+(f&(1<<_)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(w=65535&S,p<(_&=15)&&(f+=T[i++]<<p,(p+=8)<_&&(f+=T[i++]<<p,p+=8)),(w+=f&(1<<_)-1)>c){e.msg="invalid distance too far back",n.mode=30;break e}if(f>>>=_,p-=_,w>(_=r-o)){if((_=w-_)>u&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(b=0,C=h,0===d){if(b+=l-_,_<E){E-=_;do{M[r++]=h[b++]}while(--_);b=r-w,C=M}}else if(d<_){if(b+=l+d-_,(_-=d)<E){E-=_;do{M[r++]=h[b++]}while(--_);if(b=0,d<E){E-=_=d;do{M[r++]=h[b++]}while(--_);b=r-w,C=M}}}else if(b+=d-_,_<E){E-=_;do{M[r++]=h[b++]}while(--_);b=r-w,C=M}for(;E>2;)M[r++]=C[b++],M[r++]=C[b++],M[r++]=C[b++],E-=3;E&&(M[r++]=C[b++],E>1&&(M[r++]=C[b++]))}else{b=r-w;do{M[r++]=M[b++],M[r++]=M[b++],M[r++]=M[b++],E-=3}while(E>2);E&&(M[r++]=M[b++],E>1&&(M[r++]=M[b++]))}break}}break}}while(i<s&&r<a);i-=E=p>>3,f&=(1<<(p-=E<<3))-1,e.next_in=i,e.next_out=r,e.avail_in=i<s?s-i+5:5-(i-s),e.avail_out=r<a?a-r+257:257-(r-a),n.hold=f,n.bits=p}},function(e,t,n){"use strict";var i=n(160),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,n,c,l,u,d,h){var f,p,m,g,y,v,S,_,E,w=h.bits,b=0,C=0,T=0,M=0,A=0,k=0,R=0,P=0,I=0,N=0,L=null,D=0,x=new i.Buf16(16),O=new i.Buf16(16),F=null,U=0;for(b=0;b<=15;b++)x[b]=0;for(C=0;C<c;C++)x[t[n+C]]++;for(A=w,M=15;M>=1&&0===x[M];M--);if(A>M&&(A=M),0===M)return l[u++]=20971520,l[u++]=20971520,h.bits=1,0;for(T=1;T<M&&0===x[T];T++);for(A<T&&(A=T),P=1,b=1;b<=15;b++)if(P<<=1,(P-=x[b])<0)return-1;if(P>0&&(0===e||1!==M))return-1;for(O[1]=0,b=1;b<15;b++)O[b+1]=O[b]+x[b];for(C=0;C<c;C++)0!==t[n+C]&&(d[O[t[n+C]]++]=C);if(0===e?(L=F=d,v=19):1===e?(L=s,D-=257,F=r,U-=257,v=256):(L=o,F=a,v=-1),N=0,C=0,b=T,y=u,k=A,R=0,m=-1,g=(I=1<<A)-1,1===e&&I>852||2===e&&I>592)return 1;for(;;){S=b-R,d[C]<v?(_=0,E=d[C]):d[C]>v?(_=F[U+d[C]],E=L[D+d[C]]):(_=96,E=0),f=1<<b-R,T=p=1<<k;do{l[y+(N>>R)+(p-=f)]=S<<24|_<<16|E|0}while(0!==p);for(f=1<<b-1;N&f;)f>>=1;if(0!==f?(N&=f-1,N+=f):N=0,C++,0==--x[b]){if(b===M)break;b=t[n+d[C]]}if(b>A&&(N&g)!==m){for(0===R&&(R=A),y+=T,P=1<<(k=b-R);k+R<M&&!((P-=x[k+R])<=0);)k++,P<<=1;if(I+=1<<k,1===e&&I>852||2===e&&I>592)return 1;l[m=N&g]=A<<24|k<<16|y-u|0}}return 0!==N&&(l[y+N]=b-R<<24|64<<16|0),h.bits=A,0}},function(e,t,n){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,n){var i=n(3).Buffer,s=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];function r(e){if(i.isBuffer(e))return e;var t="function"==typeof i.alloc&&"function"==typeof i.from;if("number"==typeof e)return t?i.alloc(e):new i(e);if("string"==typeof e)return t?i.from(e):new i(e);throw new Error("input must be buffer, number, or string, received "+typeof e)}function o(e){var t=r(4);return t.writeInt32BE(e,0),t}function a(e,t){e=r(e),i.isBuffer(t)&&(t=t.readUInt32BE(0));for(var n=-1^~~t,o=0;o<e.length;o++)n=s[255&(n^e[o])]^n>>>8;return-1^n}function c(){return o(a.apply(null,arguments))}"undefined"!=typeof Int32Array&&(s=new Int32Array(s)),c.signed=function(){return a.apply(null,arguments)},c.unsigned=function(){return a.apply(null,arguments)>>>0},e.exports=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(127);t.getExtensionUri=function(e,t){const s=n(0);return t=t||i.getExtensionContext(),s.Uri.joinPath(t.extensionUri,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(32),s=n(224),r=n(225),o=/\b\w{2,20}:\/\/(?:localhost|127\.0\.0\.1|0\.0\.0\.0|:\d{2,5})[\w\-\.\~:\/\?\#[\]\@!\$&\(\)\*\+\,\;\=]*/gim;class a extends(s.Inittable(s.Disposable(Object))){constructor(){super(...arguments),this.eventEmitter=new(n(0).EventEmitter)}get onDidMatchLocalUrl(){return this.eventEmitter.event}processData(e){((e=e.replace(a.terminalCodesRegex,"")).match(o)||[]).forEach(e=>{const t=i.parse(e);if(t){const e=parseFloat(t.port);!isNaN(e)&&Number.isInteger(e)&&e>0&&e<=65535&&(t.hostname="localhost",t.host=`${t.hostname}:${e}`,this.eventEmitter.fire({port:e,serverUrl:t}))}})}}a.terminalCodesRegex=/(?:\u001B|\u009B)[\[\]()#;?]*(?:(?:(?:[a-zA-Z0-9]*(?:;[a-zA-Z0-9]*)*)?\u0007)|(?:(?:\d{1,4}(?:;\d{0,4})*)?[0-9A-PR-TZcf-ntqry=><~]))/g,t.launchUrlScraper=async function(e){return await r.DataScrapingManager.Instance.registerDataScraper("local-url-scraper",()=>{const t=new a;return t.onDidMatchLocalUrl(t=>{const{port:n,serverUrl:s}=t,r={port:n,browseUrl:i.format(s),displayName:s.host};e(r)}),t})}},function(e,t,n){(function(e,i){var s;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(r){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof i&&i;o.global!==o&&o.window!==o&&o.self;var a,c=2147483647,l=/^xn--/,u=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,p=String.fromCharCode;function m(e){throw new RangeError(h[e])}function g(e,t){for(var n=e.length,i=[];n--;)i[n]=t(e[n]);return i}function y(e,t){var n=e.split("@"),i="";return n.length>1&&(i=n[0]+"@",e=n[1]),i+g((e=e.replace(d,".")).split("."),t).join(".")}function v(e){for(var t,n,i=[],s=0,r=e.length;s<r;)(t=e.charCodeAt(s++))>=55296&&t<=56319&&s<r?56320==(64512&(n=e.charCodeAt(s++)))?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),s--):i.push(t);return i}function S(e){return g(e,(function(e){var t="";return e>65535&&(t+=p((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=p(e)})).join("")}function _(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function E(e,t,n){var i=0;for(e=n?f(e/700):e>>1,e+=f(e/t);e>455;i+=36)e=f(e/35);return f(i+36*e/(e+38))}function w(e){var t,n,i,s,r,o,a,l,u,d,h,p=[],g=e.length,y=0,v=128,_=72;for((n=e.lastIndexOf("-"))<0&&(n=0),i=0;i<n;++i)e.charCodeAt(i)>=128&&m("not-basic"),p.push(e.charCodeAt(i));for(s=n>0?n+1:0;s<g;){for(r=y,o=1,a=36;s>=g&&m("invalid-input"),((l=(h=e.charCodeAt(s++))-48<10?h-22:h-65<26?h-65:h-97<26?h-97:36)>=36||l>f((c-y)/o))&&m("overflow"),y+=l*o,!(l<(u=a<=_?1:a>=_+26?26:a-_));a+=36)o>f(c/(d=36-u))&&m("overflow"),o*=d;_=E(y-r,t=p.length+1,0==r),f(y/t)>c-v&&m("overflow"),v+=f(y/t),y%=t,p.splice(y++,0,v)}return S(p)}function b(e){var t,n,i,s,r,o,a,l,u,d,h,g,y,S,w,b=[];for(g=(e=v(e)).length,t=128,n=0,r=72,o=0;o<g;++o)(h=e[o])<128&&b.push(p(h));for(i=s=b.length,s&&b.push("-");i<g;){for(a=c,o=0;o<g;++o)(h=e[o])>=t&&h<a&&(a=h);for(a-t>f((c-n)/(y=i+1))&&m("overflow"),n+=(a-t)*y,t=a,o=0;o<g;++o)if((h=e[o])<t&&++n>c&&m("overflow"),h==t){for(l=n,u=36;!(l<(d=u<=r?1:u>=r+26?26:u-r));u+=36)w=l-d,S=36-d,b.push(p(_(d+w%S,0))),l=f(w/S);b.push(p(_(l,0))),r=E(n,y,i==s),n=0,++i}++n,++t}return b.join("")}a={version:"1.4.1",ucs2:{decode:v,encode:S},decode:w,encode:b,toASCII:function(e){return y(e,(function(e){return u.test(e)?"xn--"+b(e):e}))},toUnicode:function(e){return y(e,(function(e){return l.test(e)?w(e.slice(4).toLowerCase()):e}))}},void 0===(s=function(){return a}.call(t,n,t,e))||(e.exports=s)}()}).call(this,n(121)(e),n(27))},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,r){t=t||"&",n=n||"=";var o={};if("string"!=typeof e||0===e.length)return o;var a=/\+/g;e=e.split(t);var c=1e3;r&&"number"==typeof r.maxKeys&&(c=r.maxKeys);var l=e.length;c>0&&l>c&&(l=c);for(var u=0;u<l;++u){var d,h,f,p,m=e[u].replace(a,"%20"),g=m.indexOf(n);g>=0?(d=m.substr(0,g),h=m.substr(g+1)):(d=m,h=""),f=decodeURIComponent(d),p=decodeURIComponent(h),i(o,f)?s(o[f])?o[f].push(p):o[f]=[o[f],p]:o[f]=p}return o};var s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?r(o(e),(function(o){var a=encodeURIComponent(i(o))+n;return s(e[o])?r(e[o],(function(e){return a+encodeURIComponent(i(e))})).join(t):a+encodeURIComponent(i(e[o]))})).join(t):a?encodeURIComponent(i(a))+n+encodeURIComponent(i(e)):""};var s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function r(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n}var o=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(67);t.createTerminalRenderer=function(e){const t=n(0);return i.gte(i.coerce(t.version),"1.37.0")?new s(e):t.window.createTerminalRenderer?t.window.createTerminalRenderer(e):null};class s{constructor(e){this.name=e;const t=n(0);this.acceptInputEmitter=new t.EventEmitter,this.changeMaximumDimensionsEmitter=new t.EventEmitter,this.writeEmitter=new t.EventEmitter,this.overrideDimensionsEmitter=new t.EventEmitter,this.terminal=t.window.createTerminal({name:e,pty:{onDidWrite:this.writeEmitter.event,onDidOverrideDimensions:this.overrideDimensionsEmitter.event,handleInput:e=>this.acceptInputEmitter.fire(e),setDimensions:e=>this.setPtyDimensions(e),open:e=>this.openPty(e),close:()=>{}}})}get dimensions(){return this.terminalDimensions}set dimensions(e){e&&(this.terminalDimensions&&this.terminalDimensions.columns===e.columns&&this.terminalDimensions.rows===e.rows||(this.terminalDimensions=e,this.isStarted&&(this.isOverrideDimensionsFired=!0,this.overrideDimensionsEmitter.fire(e))))}get maximumDimensions(){return this.terminalMaximumDimensions}write(e){this.isStarted?this.writeEmitter.fire(e):this.writeBuffer=(this.writeBuffer||"")+e}get onDidAcceptInput(){return this.acceptInputEmitter.event}get onDidChangeMaximumDimensions(){return this.changeMaximumDimensionsEmitter.event}setPtyDimensions(e){e&&(this.terminalDimensions?this.terminalDimensions={columns:Math.min(this.terminalDimensions.columns,e.columns),rows:Math.min(this.terminalDimensions.rows,e.rows)}:this.terminalDimensions=e,this.terminalMaximumDimensions=e,this.changeMaximumDimensionsEmitter.fire(e),this.terminalDimensions.columns===e.columns&&this.terminalDimensions.rows===e.rows||this.isOverrideDimensionsFired||(this.isOverrideDimensionsFired=!0,this.overrideDimensionsEmitter.fire(this.terminalDimensions)))}openPty(e){this.isStarted=!0,this.setPtyDimensions(e),this.writeBuffer&&(this.writeEmitter.fire(this.writeBuffer),this.writeBuffer=void 0)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(129);t.fileAccessInstance=i.fileAccess},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8),s=n(392),r=n(394);class o extends s.VscodeActivityProvider{constructor(e,t){super(e.createChild("session-status-provider")),this.activityTimeout=t,this.statusChangedEvent=new i.Emitter,this.currentActivityStatus=!1,this.resetStatusTimerId=null,this.onActivity()}get sessionStatus(){return this.currentActivityStatus?r.VscodeSessionStatus.Active:r.VscodeSessionStatus.Idle}get onSessionStatusChanged(){return this.statusChangedEvent.event}reset(){this.currentActivityStatus||(this.currentActivityStatus=!0,this.statusChangedEvent.fire(r.VscodeSessionStatus.Active)),this.resetStatusTimerId&&(clearTimeout(this.resetStatusTimerId),this.resetStatusTimerId=null),this.resetStatusTimerId=setTimeout(()=>{this.currentActivityStatus=!1,this.statusChangedEvent.fire(r.VscodeSessionStatus.Idle)},this.activityTimeout)}async onActivity(){this.statusChangedEvent&&this.reset()}}t.VscodeSessionStatusProvider=o},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});const r=n(20);class o{}t.EventArgs=o;t.NotifyContactServiceEventArgs=class extends o{},function(e){e[e.Unknown="unknown"]="Unknown",e[e.Available="available"]="Available",e[e.Busy="busy"]="Busy",e[e.DoNotDisturb="doNotDisturb"]="DoNotDisturb",e[e.Away="away"]="Away",e[e.Invisible="invisible"]="Invisible",e[e.Offline="offline"]="Offline"}(t.PresenceStatus||(t.PresenceStatus={})),function(e){e[e.DisplayName="displayName"]="DisplayName",e[e.Email="email"]="Email",e[e.AvatarUri="avatarUri"]="AvatarUri",e[e.Status="status"]="Status"}(t.ContactProperty||(t.ContactProperty={}));class a{}t.Contact=a;t.EmptyRequest=class{};t.EmptyResponse=class{};class c{}t.PublishPresenceRequest=c;class l{}i([r.dataFormat(c),s("design:type",c)],l.prototype,"publishPresence",void 0),t.InitializeRequest=l;t.WorkspaceFolder=class{};t.WorkspaceUri=class{};class u{}t.Capabilities=u;class d{}i([r.dataFormat(u),s("design:type",u)],d.prototype,"capabilities",void 0),i([r.dataFormat(a),s("design:type",a)],d.prototype,"selfContact",void 0),t.InitializeResponse=d,function(e){e[e.None="none"]="None",e[e.SignedOut="signedOut"]="SignedOut",e[e.SigningIn="signingIn"]="SigningIn",e[e.SignedIn="signedIn"]="SignedIn"}(t.SignedStatus||(t.SignedStatus={}));class h{}t.ContactPresenceUpdate=h;class f{}i([r.dataFormat(h),s("design:type",Array)],f.prototype,"changes",void 0),t.PresenceChangedNotification=f;t.ContactPropertyValueChanged=class{};t.ContactChangedNotification=class{};t.ContactPropertiesChangedNotification=class{};t.InviteRequest=class{};class p{}i([r.dataFormat(a),s("design:type",a)],p.prototype,"fromContact",void 0),t.InviteReceivedNotification=p;class m{}i([r.dataFormat(a),s("design:type",a)],m.prototype,"contact",void 0),t.SelfContactNotification=m;class g{}i([r.dataFormat(a),s("design:type",Array)],g.prototype,"contacts",void 0),t.ContactsNotification=g;t.SuggestedContactsNotification=class extends g{};class y{}i([r.dataFormat(a),s("design:type",Array)],y.prototype,"contacts",void 0),t.ContactPresenceRequest=y;class v{}i([r.dataFormat(a),s("design:type",a)],v.prototype,"contact",void 0),t.ContactResponse=v;class S{}i([r.dataFormat(v),s("design:type",Array)],S.prototype,"contacts",void 0),t.ContactPresenceResponse=S;t.ContactPresenceDisposeRequest=class{};class _{}t.SearchContactProperty=_;class E{}i([r.dataFormat(_),s("design:type",Array)],E.prototype,"queryOptions",void 0),t.SearchContactsRequest=E;class w{}i([r.dataFormat(a),s("design:type",Array)],w.prototype,"results",void 0),t.SearchContactsResponse=w;class b{}t.MessagePayload=b;t.SendMessageRequest=class extends b{};t.MessageReceivedNotification=class extends b{};t.SignInRequest=class{};t.SignedStateChangedNotification=class{};t.AuthenticationRequiredNotification=class{},function(e){e.RequestInitializeName="initialize",e.RequestDisposeName="dispose",e.RequestInviteName="inviteLink",e.RequestPublishPresenceName="publishPresence",e.RequestContactPresenceName="contactPresenceRequest",e.RequestContactPresenceDisposeName="contactPresenceDispose",e.RequestSearchContactsName="searchContacts",e.RequestSendMessageName="sendMessageRequest",e.RequestSignInName="signIn",e.RequestSignOutName="signOut",e.NotifyPresenceChangedName="presenceChanged",e.NotifySelfContactName="selfContact",e.NotifyAvailableUsersName="availableUsers",e.NotifyAvailableUsersAddedName="availableUsersAdded",e.NotifyAvailableUsersRemovedName="availableUsersRemoved",e.NotifyInviteReceivedName="inviteLinkReceived",e.NotifyContactChangedName="contactChanged",e.NotifyContactPropertiesChangedName="contactPropertiesChanged",e.NotifySuggestedUsersName="suggestedUsers",e.NotifyCapabilitiesUpdateName="capabilitiesUpdate",e.NotifyMessageReceivedName="messageReceived",e.NotifySignedStateChangedName="signedStateChanged",e.NotifyAuthenticationRequiredName="authenticationRequired"}(t.Methods||(t.Methods={})),t.ContactServiceProvider={methods:["request"],events:["notified"]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(21),s=n(31),r=()=>s.userAuthStateTracker.IsSignedIn?i.SessionState.SignedIn:i.SessionState.SignedOut;t.sessionMachine={[i.SessionState.Initializing]:{[i.SessionAction.AttemptSharing]:i.SessionState.SharingInProgress,[i.SessionAction.AttemptJoining]:i.SessionState.JoiningInProgress,[i.SessionAction.AttemptSignIn]:i.SessionState.SigningIn,[i.SessionAction.SignOut]:i.SessionState.SignedOut},[i.SessionState.ExternallySigningIn]:{[i.SessionAction.AwaitExternalSignIn]:i.SessionState.ExternallySigningIn,[i.SessionAction.AttemptSignIn]:i.SessionState.SigningIn,[i.SessionAction.SignInSuccess]:i.SessionState.SignedIn,[i.SessionAction.SignInError]:i.SessionState.SignedOut,[i.SessionAction.SignOut]:i.SessionState.SignedOut,[i.SessionAction.SharingError]:i.SessionState.SignedOut,[i.SessionAction.JoiningError]:i.SessionState.SignedOut},[i.SessionState.SigningIn]:{[i.SessionAction.AwaitExternalSignIn]:i.SessionState.ExternallySigningIn,[i.SessionAction.SignInSuccess]:i.SessionState.SignedIn,[i.SessionAction.SignInError]:i.SessionState.SignedOut,[i.SessionAction.SignOut]:i.SessionState.SignedOut,[i.SessionAction.SharingError]:i.SessionState.SignedOut,[i.SessionAction.JoiningError]:i.SessionState.SignedOut},[i.SessionState.SignedIn]:{[i.SessionAction.AttemptSharing]:i.SessionState.SharingInProgress,[i.SessionAction.AttemptJoining]:i.SessionState.JoiningInProgress,[i.SessionAction.SignOut]:i.SessionState.SignedOut},[i.SessionState.SignedOut]:{[i.SessionAction.AttemptSignIn]:i.SessionState.SigningIn,[i.SessionAction.AwaitExternalSignIn]:i.SessionState.ExternallySigningIn,[i.SessionAction.SignInSuccess]:i.SessionState.SignedIn,[i.SessionAction.AttemptSharing]:i.SessionState.SharingInProgress,[i.SessionAction.SharingError]:i.SessionState.SignedOut,[i.SessionAction.JoiningError]:i.SessionState.SignedOut},[i.SessionState.SharingInProgress]:{[i.SessionAction.SharingError]:r,[i.SessionAction.SharingSuccess]:i.SessionState.Shared,[i.SessionAction.SignOut]:i.SessionState.SignedOut,[i.SessionAction.AttemptSignIn]:i.SessionState.SigningIn,[i.SessionAction.AwaitExternalSignIn]:i.SessionState.ExternallySigningIn,[i.SessionAction.SignInSuccess]:i.SessionState.SignedIn},[i.SessionState.Shared]:{[i.SessionAction.EndSharing]:i.SessionState.SignedIn,[i.SessionAction.SignOut]:i.SessionState.SignedOut},[i.SessionState.JoiningInProgress]:{[i.SessionAction.JoiningError]:r,[i.SessionAction.JoiningPendingReload]:i.SessionState.SignedIn,[i.SessionAction.JoiningSuccess]:i.SessionState.Joined,[i.SessionAction.SignOut]:i.SessionState.SignedOut,[i.SessionAction.AttemptSharing]:i.SessionState.SharingInProgress},[i.SessionState.Joined]:{[i.SessionAction.Unjoin]:i.SessionState.SignedIn,[i.SessionAction.SignOut]:i.SessionState.SignedOut}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(907),r=n(162),o=n(908),a=n(32),c=n(227),l=[r.SettingKeys.commandPrefix,r.SettingKeys.serviceUri,r.SettingKeys.signalRServiceUri,r.SettingKeys.scheme,r.SettingKeys.authority,r.SettingKeys.canCollectPII,r.SettingKeys.desyncReload,r.SettingKeys.userEmail,r.SettingKeys.isInternal,r.SettingKeys.isCloudEnvironment,r.SettingKeys.name,r.SettingKeys.shortName,r.SettingKeys.abbreviation,r.SettingKeys.licenseUrl,r.SettingKeys.privacyUrl,r.SettingKeys.hasUsed,r.SettingKeys.configName,r.SettingKeys.activityTimeout,r.SettingKeys.customAccountAuthReloadFlag,r.SettingKeys.anonymousAuthReloadFlag,r.SettingKeys.nativeAuthFlow,r.SettingKeys.authenticationProvider,r.SettingKeys.useClientFileService,r.SettingKeys.remoteSettingsUri,r.SettingKeys.remoteSettingsUpdateMinutes,r.SettingKeys.runsInVSCodeDev],u=[r.SettingKeys.anonymousUserName,r.SettingKeys.microphoneId,r.SettingKeys.speakerId,r.SettingKeys.newChatDisplayDate,r.SettingKeys.newAudioDisplayDate,r.SettingKeys.sessionCount,r.SettingKeys.dontRequestFeedback,r.SettingKeys.dontRequestAdditionalFeedback,r.SettingKeys.surveyShownDate,r.SettingKeys.firstActivationTime];function d(e){return l.indexOf(e)>=0}function h(e){return u.indexOf(e)>=0}function f(e){if(s.defaultSettings.hasOwnProperty(e))return s.defaultSettings[e]}t.DefaultSettingsProvider=class{constructor(){this.userSettings={}}async init(e,t){this.mementoConfigInstance=new p(e),this.userSettings=await c.readUserSettings();const n=f(r.SettingKeys.remoteSettingsUri);if(n){const i=f(r.SettingKeys.remoteSettingsUpdateMinutes);await o.RemoteConfig.init(e,a.parse(n),i,t)}}get mementoConfig(){return this.mementoConfigInstance}get ready(){return o.RemoteConfig.waitForUpdate}get(e){if(this.userSettings.hasOwnProperty(e))return this.userSettings[e];if(d(e)||h(e)){const t=f(e);return void 0===t&&h(e)?this.mementoConfigInstance.get(e):t}const t=i.workspace.getConfiguration(f(r.SettingKeys.configName)),n=o.RemoteConfig.getDefault(e);if(void 0!==n){const i=t.inspect(e);if(i){if(void 0!==i.workspaceFolderValue)return i.workspaceFolderValue;if(void 0!==i.workspaceValue)return i.workspaceValue;if(void 0!==i.globalValue)return i.globalValue}return n}return t.get(e)}save(e,t,n){if(d(e))return s.defaultSettings[e]=t;if(h(e))return this.mementoConfigInstance.save(e,t);return i.workspace.getConfiguration(f(r.SettingKeys.configName)).update(e,t,n)}};class p{constructor(e){this.globalState=e.globalState}get(e){return this.globalState.get(e)}async save(e,t){await this.globalState.update(e,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSettings={name:"Visual Studio Live Share",configName:"liveshare",serviceUri:"https://prod.liveshare.vsengsaas.visualstudio.com/",signalRServiceUri:"https://signlr-prod.core.vsengsaas.visualstudio.com/api/signalr/signalrhub",abbreviation:"VSLS",scheme:"vsls",authority:"vsls",canCollectPII:!1,activityTimeout:3e5,commandPrefix:"liveshare",featureSet:"stable",remoteSettingsUri:"https://az700632.vo.msecnd.net/pub/VSLiveShare/VSCode/",remoteSettingsUpdateMinutes:"60",textSearchResultsLimit:1e4,textSearchPreviewLimit:200}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(32),s=n(6),r=n(228),o=n(406),a=n(67),c=n(0),l=n(407),u=n(408);class d{constructor(){this.settings=null,this.updated=!1,this.updateSignal=new s.Signal}static get Instance(){return d.singleton||(d.singleton=new d),d.singleton}async init(e,t,n,s){if(!t)throw new Error("A settings URI is required.");this.settingsFileUri=i.parse(i.resolve(t.href,"remoteSettings.json")),this.settingsFileUri.path=(t.path+"/remoteSettings.json").replace("//","/"),this.extensionVersion=r.ExtensionUtil.getExtensionVersion(o.LIVESHARE_EXTENSION_ID,!1),this.settings=await l.loadFilefromCache(this.settingsFileUri.href),null==s||s.verbose(`Downloading remote settings from ${this.settingsFileUri.href}`);const a=await l.initRemoteFileSubscribe(e,this.settingsFileUri.href,e=>{this.loadDownloadedSettings(e)},n,s);e&&e.subscriptions.push(a)}loadDownloadedSettings(e){this.settings=e,this.updated||(this.updated=!0,this.updateSignal.resolve())}get waitForUpdate(){if(!this.settingsFileUri)throw new Error("Not initialized.");return this.updateSignal.promise}getDefault(e){return this.getSettingValue(e,"default")}getOverride(e){return this.getSettingValue(e,"override")}getSettingValue(e,t){if(!this.settings)return;let n=this.settings[e];if(n){Array.isArray(n)||(n=[n]);for(let e of n){if((e.priority||"default")===t&&this.evaluateConditions(e.conditions))return e.value}}}evaluateConditions(e){if(!e)return!0;if(e.os){const t=u.getPlatform().replace("win32","win").replace("darwin","mac");if(!(e.os===t||Array.isArray(e.os)&&e.os.indexOf(t)>=0))return!1}return!(e.extensionVersion&&!a.satisfies(this.extensionVersion,e.extensionVersion))&&!(e.ideVersion&&!a.satisfies(c.version,e.ideVersion))}}const h=d.Instance;t.RemoteConfig=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(49),r=n(9),o=n(229),a=n(395),c=n(228);var l;!function(e){e.readOnly="readOnly",e.readWrite="readWrite"}(l=t.AnonymousAccessLevel||(t.AnonymousAccessLevel={}));t.workspaceSessionInfoTracker=new class{constructor(){this._workspaceSessionInfo=null,this.plannedWorkspaceList=null,this.isReadOnlyPrivate=!1,this.isPlannedSessionsChangedPrivate=!1,this.anonymousAccessMap=new Map,this.readOnlyChangedEmitter=new i.EventEmitter,this.onReadOnlyChanged=this.readOnlyChangedEmitter.event,this.plannedSessionsChangedEmitter=new i.EventEmitter,this.onPlannedSessionsChanged=this.plannedSessionsChangedEmitter.event,this.anonymousAccessLevelChangedInSessionEmitter=new i.EventEmitter,this.onAccessLevelChangedInSession=this.anonymousAccessLevelChangedInSessionEmitter.event}get workspaceSessionInfo(){return this._workspaceSessionInfo}set workspaceSessionInfo(e){var t;this._workspaceSessionInfo=e,(null===(t=this._workspaceSessionInfo)||void 0===t?void 0:t.id)&&c.ExtensionUtil.getCommandContext("liveshare:isWeb")&&(this._workspaceSessionInfo.joinUri=`https://vscode.dev/liveshare/${this._workspaceSessionInfo.id}`),(null==e?void 0:e.conversationId)&&(r.Telemetry.addContextProperty(o.TelemetryPropertyNames.CONVERSATION_ID,e.conversationId),r.Telemetry.addContextProperty(o.TelemetryPropertyNames.SESSION_ID,s()))}get isReadOnly(){return this.isReadOnlyPrivate}set isReadOnly(e){e!==t.workspaceSessionInfoTracker.isReadOnly&&(e?r.Telemetry.addContextProperty(o.TelemetryPropertyNames.IS_READONLY_SESSION,!0,!1):r.Telemetry.removeContextProperty(o.TelemetryPropertyNames.IS_READONLY_SESSION),t.workspaceSessionInfoTracker.isReadOnlyPrivate=e,this.readOnlyChangedEmitter.fire(e))}get isPlannedSessionsChanged(){return this.isPlannedSessionsChangedPrivate}set isPlannedSessionsChanged(e){e!==t.workspaceSessionInfoTracker.isPlannedSessionsChanged&&(t.workspaceSessionInfoTracker.isPlannedSessionsChangedPrivate=e,this.plannedSessionsChangedEmitter.fire(e)),t.workspaceSessionInfoTracker.isPlannedSessionsChangedPrivate=!1}async setAnonymousAccess(e,t){const n=new r.TelemetryEvent(o.TelemetryEventNames.RESPOND_ANONYMOUS_JOIN_REQUEST);switch(t){case a.localize("notification.AcceptReadOnly"):case a.localize("notification.Accept"):case a.localize("notification.AlwaysAcceptAnonymous"):this.anonymousAccessMap.set(e,l.readOnly),n.addProperty(o.TelemetryPropertyNames.READONLY,!0),n.addProperty(o.TelemetryPropertyNames.ACCEPTED,!0);break;case a.localize("notification.AcceptReadWrite"):this.anonymousAccessMap.set(e,l.readWrite),n.addProperty(o.TelemetryPropertyNames.READONLY,!1),n.addProperty(o.TelemetryPropertyNames.ACCEPTED,!0);break;case a.localize("notification.Reject"):n.addProperty(o.TelemetryPropertyNames.ACCEPTED,!1)}n.send()}async updateAnonymousAccess(e,t){const n=new r.TelemetryEvent(o.TelemetryEventNames.UPDATE_ANONYMOUS_GUEST_ACCESS_LEVEL),i=e.participantId,s=e.sessionId;t?(this.anonymousAccessMap.set(i,l.readOnly),this.anonymousAccessLevelChangedInSessionEmitter.fire(),this.anonymousUserId=s,n.addProperty(o.TelemetryPropertyNames.IS_ANONYMOUS_ELEVATED,!1)):(this.anonymousAccessMap.set(i,l.readWrite),this.anonymousAccessLevelChangedInSessionEmitter.fire(),this.anonymousUserId=s,n.addProperty(o.TelemetryPropertyNames.IS_ANONYMOUS_ELEVATED,!0)),n.send()}getAnonymousAccess(e){return this.anonymousAccessMap.get(e)}getAnonymousAccessMapHasTheProfile(e){const t=e.participantId;return this.anonymousAccessMap.has(t)}clearAnonymousAccessMap(){this.anonymousAccessMap.clear()}getAccessLevelChangedUserID(){return this.anonymousUserId}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(396),s=n(9),r=n(228),o=n(406),a=n(163);class c{setSharedProperty(e,t){s.Telemetry.addContextProperty(e,t)}postEvent(e,t){const n=new s.TelemetryEvent(e);for(let[e,i]of t)n.addProperty(e,i);n.send()}}let l;t.getExpService=function(){return l},t.initAsync=async function(e,t){const n=`${o.LIVESHARE_EXTENSION_ID}${t?"-web":""}`,s=r.ExtensionUtil.getExtensionVersion(o.LIVESHARE_EXTENSION_ID);l=await i.getExperimentationServiceAsync(n,s,a.Settings.isVSLSTeamMember?i.TargetPopulation.Team:a.Settings.isInternalFeatureSet?i.TargetPopulation.Internal:a.Settings.isInsidersFeatureSet?i.TargetPopulation.Insiders:i.TargetPopulation.Public,new c,e.globalState)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(397),s=n(912),r=n(0),o=n(940),a=n(941);function c(e,t,n,c,l,...u){if(!l)throw new Error("Memento storage was not provided.");const d=r.workspace.getConfiguration("telemetry");if(!(void 0===r.env.isTelemetryEnabled?d.get("enableTelemetry",!0):r.env.isTelemetryEnabled))return new a.default;const h=[new i.VSCodeFilterProvider(e,t,n),...u],f=new o.MementoKeyValueStorage(l);return new s.ExperimentationService({filterProviders:h,telemetry:c,storageKey:"VSCode.ABExp.FeatureData",keyValueStorage:f,featuresTelemetryPropertyName:"VSCode.ABExp.Features",assignmentContextTelemetryPropertyName:"abexp.assignmentcontext",telemetryEventName:"query-expfeature",endpoint:"https://default.exp-tas.com/vscode/ab",refetchInterval:18e5})}t.getExperimentationService=c,t.getExperimentationServiceAsync=async function(e,t,n,i,s,...r){const o=c(e,t,n,i,s,...r);return await o.initializePromise,o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(913);t.ExperimentationService=i.ExperimentationService},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(914),s=n(917),r=n(936);class o extends r.ExperimentationServiceAutoPolling{constructor(e){super(e.telemetry,e.filterProviders||[],null!=e.refetchInterval?e.refetchInterval:0,e.featuresTelemetryPropertyName,e.assignmentContextTelemetryPropertyName,e.telemetryEventName,e.storageKey,e.keyValueStorage),this.options=e,this.invokeInit()}init(){this.featureProviders=[],this.addFeatureProvider(new i.TasApiFeatureProvider(new s.AxiosHttpClient(this.options.endpoint),this.telemetry,this.filterProviders)),super.init()}}t.ExperimentationService=o,o.REFRESH_RATE_IN_MINUTES=30},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(915);class s extends i.FilteredFeatureProvider{constructor(e,t,n){super(t,n),this.httpClient=e,this.telemetry=t,this.filterProviders=n}async fetch(){let e=this.getFilters(),t={};for(let n of e.keys()){const i=e.get(n);t[n]=i}let n=await this.httpClient.get({headers:t});e.keys.length>0&&this.PostEventToTelemetry(t);let i=n.data,s=i.Configs,r=[];for(let e of s)if(e.Parameters)for(let t of Object.keys(e.Parameters)){const n=t+(e.Parameters[t]?"":"cf");r.includes(n)||r.push(n)}return{features:r,assignmentContext:i.AssignmentContext,configs:s}}}t.TasApiFeatureProvider=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(916);class s extends i.BaseFeatureProvider{constructor(e,t){super(e),this.telemetry=e,this.filterProviders=t,this.cachedTelemetryEvents=[]}getFilters(){let e=new Map;for(let t of this.filterProviders){let n=t.getFilters();for(let t of n.keys()){let i=n.get(t);e.set(t,i)}}return e}PostEventToTelemetry(e){if(this.cachedTelemetryEvents.includes(e))return;const t=JSON.stringify(e);this.telemetry.postEvent("report-headers",new Map([["ABExp.headers",t]])),this.cachedTelemetryEvents.push(e)}}t.FilteredFeatureProvider=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BaseFeatureProvider=class{constructor(e){this.telemetry=e,this.isFetching=!1}async getFeatures(){if(this.isFetching&&this.fetchPromise)return this.fetchPromise;this.fetchPromise=this.fetch();let e=await this.fetchPromise;return this.isFetching=!1,this.fetchPromise=void 0,e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(164);t.AxiosHttpClient=class{constructor(e){this.endpoint=e}get(e){return i.default.get(this.endpoint,Object.assign(Object.assign({},e),{proxy:!1}))}}},function(e,t,n){"use strict";var i=n(35),s=n(398),r=n(919),o=n(404);function a(e){var t=new r(e),n=s(r.prototype.request,t);return i.extend(n,r.prototype,t),i.extend(n,t),n}var c=a(n(230));c.Axios=r,c.create=function(e){return a(o(c.defaults,e))},c.Cancel=n(405),c.CancelToken=n(933),c.isCancel=n(403),c.all=function(e){return Promise.all(e)},c.spread=n(934),c.isAxiosError=n(935),e.exports=c,e.exports.default=c},function(e,t,n){"use strict";var i=n(35),s=n(399),r=n(920),o=n(921),a=n(404),c=n(931),l=c.validators;function u(e){this.defaults=e,this.interceptors={request:new r,response:new r}}u.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&c.assertOptions(t,{silentJSONParsing:l.transitional(l.boolean,"1.0.0"),forcedJSONParsing:l.transitional(l.boolean,"1.0.0"),clarifyTimeoutError:l.transitional(l.boolean,"1.0.0")},!1);var n=[],i=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(i=i&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var s,r=[];if(this.interceptors.response.forEach((function(e){r.push(e.fulfilled,e.rejected)})),!i){var u=[o,void 0];for(Array.prototype.unshift.apply(u,n),u=u.concat(r),s=Promise.resolve(e);u.length;)s=s.then(u.shift(),u.shift());return s}for(var d=e;n.length;){var h=n.shift(),f=n.shift();try{d=h(d)}catch(e){f(e);break}}try{s=o(d)}catch(e){return Promise.reject(e)}for(;r.length;)s=s.then(r.shift(),r.shift());return s},u.prototype.getUri=function(e){return e=a(this.defaults,e),s(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},i.forEach(["delete","get","head","options"],(function(e){u.prototype[e]=function(t,n){return this.request(a(n||{},{method:e,url:t,data:(n||{}).data}))}})),i.forEach(["post","put","patch"],(function(e){u.prototype[e]=function(t,n,i){return this.request(a(i||{},{method:e,url:t,data:n}))}})),e.exports=u},function(e,t,n){"use strict";var i=n(35);function s(){this.handlers=[]}s.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},s.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},s.prototype.forEach=function(e){i.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=s},function(e,t,n){"use strict";var i=n(35),s=n(922),r=n(403),o=n(230);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=s.call(e,e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),i.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||o.adapter)(e).then((function(t){return a(e),t.data=s.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return r(t)||(a(e),t&&t.response&&(t.response.data=s.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,n){"use strict";var i=n(35),s=n(230);e.exports=function(e,t,n){var r=this||s;return i.forEach(n,(function(n){e=n.call(r,e,t)})),e}},function(e,t,n){"use strict";var i=n(35);e.exports=function(e,t){i.forEach(e,(function(n,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[i])}))}},function(e,t,n){"use strict";var i=n(402);e.exports=function(e,t,n){var s=n.config.validateStatus;n.status&&s&&!s(n.status)?t(i("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";var i=n(35);e.exports=i.isStandardBrowserEnv()?{write:function(e,t,n,s,r,o){var a=[];a.push(e+"="+encodeURIComponent(t)),i.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),i.isString(s)&&a.push("path="+s),i.isString(r)&&a.push("domain="+r),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var i=n(927),s=n(928);e.exports=function(e,t){return e&&!i(t)?s(e,t):t}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var i=n(35),s=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,r,o={};return e?(i.forEach(e.split("\n"),(function(e){if(r=e.indexOf(":"),t=i.trim(e.substr(0,r)).toLowerCase(),n=i.trim(e.substr(r+1)),t){if(o[t]&&s.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([n]):o[t]?o[t]+", "+n:n}})),o):o}},function(e,t,n){"use strict";var i=n(35);e.exports=i.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function s(e){var i=e;return t&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=s(window.location.href),function(t){var n=i.isString(t)?s(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var i=n(932),s={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){s[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var r={},o=i.version.split(".");function a(e,t){for(var n=t?t.split("."):o,i=e.split("."),s=0;s<3;s++){if(n[s]>i[s])return!0;if(n[s]<i[s])return!1}return!1}s.transitional=function(e,t,n){var s=t&&a(t);function o(e,t){return"[Axios v"+i.version+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,i,a){if(!1===e)throw new Error(o(i," has been removed in "+t));return s&&!r[i]&&(r[i]=!0,console.warn(o(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,a)}},e.exports={isOlderVersion:a,assertOptions:function(e,t,n){if("object"!=typeof e)throw new TypeError("options must be an object");for(var i=Object.keys(e),s=i.length;s-- >0;){var r=i[s],o=t[r];if(o){var a=e[r],c=void 0===a||o(a,r,e);if(!0!==c)throw new TypeError("option "+r+" must be "+c)}else if(!0!==n)throw Error("Unknown option "+r)}},validators:s}},function(e){e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')},function(e,t,n){"use strict";var i=n(405);function s(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new i(e),t(n.reason))}))}s.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},s.source=function(){var e;return{token:new s((function(t){e=t})),cancel:e}},e.exports=s},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(937),s=n(939);class r extends i.ExperimentationServiceBase{constructor(e,t,n,i,r,o,a,c){if(super(e,i,r,o,a,c),this.telemetry=e,this.filterProviders=t,this.refreshRateMs=n,this.featuresTelemetryPropertyName=i,this.assignmentContextTelemetryPropertyName=r,this.telemetryEventName=o,this.storageKey=a,this.storage=c,n<1e3&&0!==n)throw new Error("The minimum refresh rate for polling is 1000 ms (1 second). If you wish to deactivate this auto-polling use value of 0.");n>0&&(this.pollingService=new s.PollingService(n),this.pollingService.OnPollTick(async()=>{await super.getFeaturesAsync()}))}init(){this.pollingService?this.pollingService.StartPolling(!0):super.getFeaturesAsync()}async getFeaturesAsync(e=!1){if(this.pollingService){this.pollingService.StopPolling();let t=await super.getFeaturesAsync(e);return this.pollingService.StartPolling(),t}return await super.getFeaturesAsync(e)}}t.ExperimentationServiceAutoPolling=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(938);t.ExperimentationServiceBase=class{constructor(e,t,n,s,r,o){this.telemetry=e,this.featuresTelemetryPropertyName=t,this.assignmentContextTelemetryPropertyName=n,this.telemetryEventName=s,this.storageKey=r,this.storage=o,this.featuresConsumed=!1,this.cachedTelemetryEvents=[],this._features={features:[],assignmentContext:"",configs:[]},this.storageKey||(this.storageKey="ABExp.Features"),this.storage||(o=new i.MemoryKeyValueStorage),this.loadCachePromise=this.loadCachedFeatureData(),this.initializePromise=this.loadCachePromise,this.initialFetch=new Promise((e,t)=>{this.resolveInitialFetchPromise=e})}get features(){return this._features}set features(e){this._features=e,this.telemetry&&(this.telemetry.setSharedProperty(this.featuresTelemetryPropertyName,this.features.features.join(";")),this.telemetry.setSharedProperty(this.assignmentContextTelemetryPropertyName,this.features.assignmentContext))}async getFeaturesAsync(e=!1){if(null!=this.fetchPromise){try{await this.fetchPromise}catch(e){}return this.features}if(!this.featureProviders||0===this.featureProviders.length)return Promise.resolve({features:[],assignmentContext:"",configs:[]});this.fetchPromise=Promise.all(this.featureProviders.map(async e=>await e.getFeatures()));try{const t=await this.fetchPromise;this.updateFeatures(t,e)}catch(e){}return this.fetchPromise=void 0,this.resolveInitialFetchPromise&&(this.resolveInitialFetchPromise(),this.resolveInitialFetchPromise=void 0),this.features}updateFeatures(e,t=!1){let n={features:[],assignmentContext:"",configs:[]};for(let t of e){for(let e of t.features)n.features.includes(e)||n.features.push(e);for(let e of t.configs){const t=n.configs.find(t=>t.Id===e.Id);t?t.Parameters=Object.assign(Object.assign({},t.Parameters),e.Parameters):n.configs.push(e)}n.assignmentContext+=t.assignmentContext}!t&&this.featuresConsumed||(this.features=n),this.storage&&this.storage.setValue(this.storageKey,n)}async loadCachedFeatureData(){let e;this.storage&&(e=await this.storage.getValue(this.storageKey),void 0!==e&&void 0===e.configs&&(e.configs=[])),0===this.features.features.length&&(this.features=e||{features:[],assignmentContext:"",configs:[]})}isFlightEnabled(e){return this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isCachedFlightEnabled(e){return await this.loadCachePromise,this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isFlightEnabledAsync(e){const t=await this.getFeaturesAsync(!0);return this.featuresConsumed=!0,this.PostEventToTelemetry(e),t.features.includes(e)}getTreatmentVariable(e,t){var n;return this.featuresConsumed=!0,this.PostEventToTelemetry(`${e}.${t}`),null===(n=this.features.configs.find(t=>t.Id===e))||void 0===n?void 0:n.Parameters[t]}async getTreatmentVariableAsync(e,t,n){if(n){const n=this.featuresConsumed,i=this.getTreatmentVariable(e,t);if(void 0!==i)return i;this.featuresConsumed=n}return await this.getFeaturesAsync(!0),this.getTreatmentVariable(e,t)}PostEventToTelemetry(e){this.cachedTelemetryEvents.includes(e)||(this.telemetry.postEvent(this.telemetryEventName,new Map([["ABExp.queriedFeature",e]])),this.cachedTelemetryEvents.push(e))}invokeInit(){this.init()}addFeatureProvider(...e){if(null!=e&&null!=this.featureProviders)for(let t of e)this.featureProviders.push(t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MemoryKeyValueStorage=class{constructor(){this.storage=new Map}async getValue(e,t){return this.storage.has(e)?await Promise.resolve(this.storage.get(e)):await Promise.resolve(t||void 0)}setValue(e,t){this.storage.set(e,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PollingService=class{constructor(e){this.fetchInterval=e}StopPolling(){clearInterval(this.intervalHandle),this.intervalHandle=void 0}OnPollTick(e){this.onTick=e}StartPolling(e=!1){this.intervalHandle&&this.StopPolling(),null!=this.onTick&&(e&&this.onTick().then(()=>{}).catch(()=>{}),this.intervalHandle=setInterval(async()=>{await this.onTick()},this.fetchInterval),this.intervalHandle.unref&&this.intervalHandle.unref())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MementoKeyValueStorage=class{constructor(e){this.mementoGlobalStorage=e}async getValue(e,t){return await this.mementoGlobalStorage.get(e)||t}setValue(e,t){this.mementoGlobalStorage.update(e,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.initializePromise=Promise.resolve(),this.initialFetch=Promise.resolve()}isFlightEnabled(e){return!1}isCachedFlightEnabled(e){return Promise.resolve(!1)}isFlightEnabledAsync(e){return Promise.resolve(!1)}getTreatmentVariable(e,t){}getTreatmentVariableAsync(e,t){return Promise.resolve(void 0)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(943),s=n(7),r=n(944),o=n(5),a=n(946);function c(e){return t=>e+t+"[0m"}t.assert=function(e,t,n,c){e||(i.checkDebugging(),s.traceSource.withName(o.vsls.TraceSources.ClientCoEditing).error(`Assertion Violation: ${t}`),r.CoauthoringTelemetry.ReportFailedAssertion(n||t,c),a.showDiagnosticErrorMessage(`Coediting Assertion Violation: ${t}`))},function(e){e.black=c("[30m"),e.red=c("[31m"),e.green=c("[32m"),e.yellow=c("[33m"),e.blue=c("[34m"),e.magenta=c("[35m"),e.cyan=c("[36m"),e.white=c("[37m")}(t.colorize||(t.colorize={}));class l{constructor(){this.indentValue=0}indent(){this.indentValue++}reset(){this.indentValue=0}unindent(){this.indentValue--}logTrace(e,...t){this.logInternal(e.verbose.bind(e),...t)}log(...e){this.logInternal(console.log,...e)}logInternal(e,...t){let n="";for(let e=0;e<this.indentValue;e++)n+="|   ";e(n+t.join(""))}}t.LoggerImpl=l,t.logger=new l},function(e,t,n){"use strict";(function(e){var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.Yes=1]="Yes",e[e.No=2]="No"}(n||(n={}));let i=n.Unknown;t.checkDebugging=function(){if(i===n.Unknown){i=n.No;for(let t of e.execArgv)if(t.startsWith("--inspect-brk")||t.startsWith("--debug")){i=n.Yes;break}}return i===n.Yes}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(19),s=n(9),r=n(945),o=n(229);class a{static init(){s.Telemetry.addFilter(new s.SendOnceFilter(d.ASSERTION_FAILED,[o.TelemetryPropertyNames.EVENT_MESSAGE])),s.Telemetry.addFilter(new s.SendOnceFilter(d.COEDITING_ERROR,[o.TelemetryPropertyNames.EVENT_MESSAGE])),s.Telemetry.addFilter(new s.SendOnceFilter(d.DESYNC)),s.Telemetry.addFilter(new s.SendOnceFilter(d.SYNC_CHECK)),s.Telemetry.addFilter(new s.SendOnceFilter(d.SYNC_CHECK_LOCAL)),s.Telemetry.addFilter(new s.SendOnceFilter(d.SYNC_CHECK_FOR_VERSION)),s.Telemetry.addFilter(new s.SendOnceFilter(d.SLOW_SYNC_CHECK)),s.Telemetry.addFilter(new s.SendOnceFilter(d.DROPPED_MESSAGE,[h.ID_TYPE,h.WITH_DELAY])),s.Telemetry.addFilter(new s.SendOnceFilter("block-coeditattempt",["liveshare.BlockReason"])),s.Telemetry.addFilter(new s.SendOnceFilter(o.TelemetryEventNames.ADD_EXTERNAL_FILE)),s.Telemetry.addFilter(new s.SendOnceFilter(d.SLOW_PING)),this.coeditingLogs=new i.MemoryTraceListener(50)}static ReportMetrics(e){let t=new s.TelemetryEvent(d.REPORT_METRICS);for(let n of e)n.AttachToEvent(t);t.send()}static get logListener(){return a.coeditingLogs}static getLogs(){return this.coeditingLogs.getLogs().reverse().join("\n")}static addLogs(e){let t=this.getLogs();t=t.replace(/[\\|\/]/gi,"-"),e.addProperty(h.LOGS,t)}static BufferClosed(e,t,n,i,r,o,a,c,l,u,f,p,m){const g=new s.TelemetryEvent(d.BUFFER_CLOSED);g.addProperty(h.CONTENT_TYPE,e),g.addMeasure(h.NUMBER_OF_LOCAL_EDITS,t),g.addMeasure(h.NUMBER_OF_REMOTE_EDITS,n),g.addProperty(h.NUMBER_OF_HIGH_DENSITY_EDITS,JSON.stringify(i)),g.addMeasure(h.NUMBER_OF_LOCAL_UNDOS,r),g.addMeasure(h.NUMBER_OF_REMOTE_UNDOS,o),g.addMeasure(h.NUMBER_OF_SIMULTANEOUS_EDITS,l),g.addMeasure(h.LINE_DIFF_COUNT,u),g.addMeasure(h.LINE_DIFF_SUM,f),g.addMeasure(h.NUMBER_OF_VISIBLE_EDITS,p),g.addMeasure(h.NUMBER_OF_INVISIBLE_EDITS,m),g.send()}static AddSessionClosedEventAugmenter(e){this.sessionClosedEventAugmenters.push(e)}static SessionClosed(e,t,n,i,r,o,a,c,l,u){const f=new s.TelemetryEvent(d.SESSION_CLOSED);this.sessionClosedEventAugmenters.forEach(e=>e(f)),this.sessionClosedEventAugmenters=[],f.addMeasure(h.NUMBER_OF_JUMP_TOS,e),f.addMeasure(h.NUMBER_OF_FAILED_JUMP_TOS,t),f.addMeasure(h.NUMBER_OF_PINS,n),f.addMeasure(h.NUMBER_OF_EXPLICIT_UNPINS,i),f.addMeasure(h.NUMBER_OF_AUTOMATIC_UNPINS,r),f.addMeasure(h.NUMBER_OF_SYNC_CHECKS,o),f.addMeasure(h.NUMBER_OF_FAILED_SYNC_CHECKS,a),f.addMeasure(h.NUMBER_OF_SLOW_SYNC_CHECKS,c),f.addMeasure(h.NUMBER_OF_OPEN_DIFFS,l),f.addMeasure(h.NUMBER_OF_CLOSED_DIFFS,u),f.send()}static ReportNonFunctionalNavigation(e){const t=new s.TelemetryEvent(d.NON_FUNCTIONAL_NAVIGATION);t.addProperty(h.NON_FUNCTIONAL_NAVIGATION,l[e]),t.send()}static ReportDesync(e,t,n,i=!1){const r=new s.TelemetryEvent(d.DESYNC);r.addProperty(h.DESYNC_REASON,u[e]),r.addProperty(h.FILE_EXTENSION,t),r.addProperty(h.MONIKER,n),r.addProperty(h.DESYNC_RECOVERY,i),this.addLogs(r),r.send()}static ReportDesyncReload(){new s.TelemetryEvent(d.DESYNC_RELOAD).send()}static ReportFuzzyDesync(e,t,n){const i=new s.TelemetryEvent(d.FUZZY_DESYNC);i.addProperty(h.FILE_EXTENSION,e),i.addProperty(h.MONIKER,t),i.addProperty(h.AUTO_SAVE,n),this.addLogs(i),i.send()}static ReportFalseDesync(){new s.TelemetryEvent(d.FALSE_DESYNC).send()}static ReportSyncCheck(){new s.TelemetryEvent(d.SYNC_CHECK).send()}static ReportLocalSyncCheck(){new s.TelemetryEvent(d.SYNC_CHECK_LOCAL).send()}static ReportSyncCheckForVersion(e){const t=new s.TelemetryEvent(d.SYNC_CHECK_FOR_VERSION);t.addProperty(h.SENDING_SYNC_CHECK,e),t.send()}static ReportSlowSyncCheck(){new s.TelemetryEvent(d.SLOW_SYNC_CHECK).send()}static ReportFailedAssertion(e,t){const n=new s.Fault(d.ASSERTION_FAILED,s.FaultType.Error,e,new Error("Assertion Failed"));if(t){const e=t.split("."),i=e.length>1?e.pop():"NA",s=r.PathUtil.getMonikerFromRelativePath(t).moniker||"None";n.addProperty(h.FILE_EXTENSION,i),n.addProperty(h.MONIKER,s)}this.addLogs(n),n.send()}static ReportCoeditingError(e,t){new s.Fault(d.COEDITING_ERROR,s.FaultType.Error,e,t).send()}static ReportDroppedMessage(e,t,n,i){const r=new s.TelemetryEvent(d.DROPPED_MESSAGE);r.addMeasure(h.EXPECTED_ID,e),r.addMeasure(h.ACTUAL_ID,t),r.addProperty(h.ID_TYPE,n),r.addProperty(h.WITH_DELAY,i),r.send()}static ReportCaseSensitiveFileSystem(){new s.TelemetryEvent(d.REPORT_CASE_SENSITIVE_FILE_SYSTEM).send()}}t.CoauthoringTelemetry=a,a.FEATURE_PREFIX="Coauthoring/",a.PROPERTY_PREFIX=o.TelemetryPropertyNames.FEATURE_NAME+"Coauthoring.",a.sessionClosedEventAugmenters=[];t.TimeTelemetry=class{constructor(e,t){this.total=0,this.canceled=0,this.failed=0,this.buckets=[new c(25),new c(50),new c(100),new c(250),new c(500),new c(1e3),new c(2e3),new c(Math.max())],this.name=e,a.AddSessionClosedEventAugmenter(e=>{t&&t(),this.AttachToEvent(e)})}RecordTime(e){this.total++;for(let t=0;t<this.buckets.length;t++)if(this.buckets[t].max>=e)return void this.buckets[t].count++}AttachToEvent(e){this.buckets.forEach(t=>{e.addMeasure(`${a.PROPERTY_PREFIX}${this.name}.${t.name}`,t.count)}),e.addMeasure(`${a.PROPERTY_PREFIX}${this.name}.count`,this.total),e.addMeasure(`${a.PROPERTY_PREFIX}${this.name}.canceled`,this.canceled),e.addMeasure(`${a.PROPERTY_PREFIX}${this.name}.failed`,this.failed)}RecordCancel(){this.canceled++,this.total++}RecordFailed(){this.failed++,this.total++}};class c{constructor(e){this.max=0,this.count=0,this.max=e,this.name="bucket."+(this.max===Math.max()?"max":this.max.toString())}}var l,u;t.Bucket=c,function(e){e[e.FindInFiles=0]="FindInFiles"}(l=t.NonFunctionalNavigation||(t.NonFunctionalNavigation={})),function(e){e[e.Unknown=0]="Unknown",e[e.MessagesOutOfOrder=1]="MessagesOutOfOrder"}(u=t.DesyncReason||(t.DesyncReason={}));class d{}t.Event=d,d.NON_FUNCTIONAL_NAVIGATION=a.FEATURE_PREFIX+"navigate-nonfunctional",d.BUFFER_CLOSED=a.FEATURE_PREFIX+"close-buffer",d.SESSION_CLOSED=a.FEATURE_PREFIX+"close-session",d.REPORT_METRICS=a.FEATURE_PREFIX+"report-timingmetrics",d.DESYNC=a.FEATURE_PREFIX+"desync-coediting",d.DESYNC_RELOAD=a.FEATURE_PREFIX+"desync-reload",d.FUZZY_DESYNC=a.FEATURE_PREFIX+"desync-fuzzy",d.FALSE_DESYNC=a.FEATURE_PREFIX+"desync-falsealarm",d.SYNC_CHECK=a.FEATURE_PREFIX+"sync-check",d.SYNC_CHECK_LOCAL=a.FEATURE_PREFIX+"sync-checklocal",d.SYNC_CHECK_FOR_VERSION=a.FEATURE_PREFIX+"sync-checkforversion",d.SLOW_SYNC_CHECK=a.FEATURE_PREFIX+"sync-checkslow",d.COEDITING_ERROR=a.FEATURE_PREFIX+"coedit-processing-error",d.DROPPED_MESSAGE=a.FEATURE_PREFIX+"drop-message",d.DROPPED_HOST_MESSAGE_FAULT=o.TelemetryEventNames.FAULT_PREFIX+"drop-hostmessage-fault",d.ASSERTION_FAILED=o.TelemetryEventNames.FAULT_PREFIX+"assert-coediting-fault",d.ADD_UNTITLED_FILE=a.FEATURE_PREFIX+"add-untitledfile",d.RECEIVE_UNTITLED_FILE=a.FEATURE_PREFIX+"receive-untitledfile",d.CLOSE_UNTITLED_FILE=a.FEATURE_PREFIX+"close-untitledfile",d.SAVE_UNTITLED_FILE=a.FEATURE_PREFIX+"save-untitledfile",d.REPORT_CASE_SENSITIVE_FILE_SYSTEM=a.FEATURE_PREFIX+"report-casesensitivefilesystem",d.SLOW_PING="ping-slow",d.RESYNC_DOCUMENT="resync-document";class h{}h.CONTENT_TYPE=a.PROPERTY_PREFIX+"ContentType",h.NUMBER_OF_LOCAL_EDITS=a.PROPERTY_PREFIX+"NumberOfLocalEdits",h.NUMBER_OF_REMOTE_EDITS=a.PROPERTY_PREFIX+"NumberOfRemoteEdits",h.NUMBER_OF_HIGH_DENSITY_EDITS=a.PROPERTY_PREFIX+"NumberOfHighDensityEdits",h.NUMBER_OF_LOCAL_UNDOS=a.PROPERTY_PREFIX+"NumberOfLocalUndos",h.NUMBER_OF_REMOTE_UNDOS=a.PROPERTY_PREFIX+"NumberOfRemoteUndos",h.NUMBER_OF_HIGHLIGHTS=a.PROPERTY_PREFIX+"NumberOfHighlights",h.AVERAGE_LATENCY=a.PROPERTY_PREFIX+"AverageLatency",h.NUMBER_OF_JUMP_TOS=a.PROPERTY_PREFIX+"NumberOfJumpTos",h.NUMBER_OF_FAILED_JUMP_TOS=a.PROPERTY_PREFIX+"NumberOfFailedJumpTos",h.NUMBER_OF_PINS=a.PROPERTY_PREFIX+"NumberOfPins",h.NUMBER_OF_EXPLICIT_UNPINS=a.PROPERTY_PREFIX+"NumberOfExplicitUnpins",h.NUMBER_OF_AUTOMATIC_UNPINS=a.PROPERTY_PREFIX+"NumberOfAutomaticUnpins",h.NUMBER_OF_SYNC_CHECKS=a.PROPERTY_PREFIX+"NumberOfSyncChecks",h.SENDING_SYNC_CHECK=a.PROPERTY_PREFIX+"SendingSyncCheck",h.NUMBER_OF_FAILED_SYNC_CHECKS=a.PROPERTY_PREFIX+"NumberOfFailedSyncChecks",h.NUMBER_OF_SLOW_SYNC_CHECKS=a.PROPERTY_PREFIX+"NumberOfSlowSyncChecks",h.NON_FUNCTIONAL_NAVIGATION=a.PROPERTY_PREFIX+"NonFunctionalNavigation",h.DESYNC_REASON=a.PROPERTY_PREFIX+"DesyncReason",h.FILE_EXTENSION=a.PROPERTY_PREFIX+"FileExtension",h.MONIKER=a.PROPERTY_PREFIX+"Moniker",h.AUTO_SAVE=a.PROPERTY_PREFIX+"AutoSave",h.NUMBER_OF_SIMULTANEOUS_EDITS=a.PROPERTY_PREFIX+"NumSimultaneousEdits",h.LINE_DIFF_SUM=a.PROPERTY_PREFIX+"LineDiffSum",h.LINE_DIFF_COUNT=a.PROPERTY_PREFIX+"LineDiffCount",h.NUMBER_OF_VISIBLE_EDITS=a.PROPERTY_PREFIX+"NumVisibleEdits",h.NUMBER_OF_INVISIBLE_EDITS=a.PROPERTY_PREFIX+"NumInvisibleEdits",h.DESYNC_RECOVERY=a.PROPERTY_PREFIX+"DesyncRecovery",h.NUMBER_OF_OPEN_DIFFS=a.PROPERTY_PREFIX+"NumOpenDiff",h.NUMBER_OF_CLOSED_DIFFS=a.PROPERTY_PREFIX+"NumClosedDiff",h.ID_TYPE=a.PROPERTY_PREFIX+"IdType",h.EXPECTED_ID=a.PROPERTY_PREFIX+"ExpectedEventId",h.ACTUAL_ID=a.PROPERTY_PREFIX+"ActualEventId",h.WITH_DELAY=a.PROPERTY_PREFIX+"WithDelay",h.LOGS=a.PROPERTY_PREFIX+"Logs"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(18),r=n(163);let o,a;function c(){return a||(a=new RegExp('"'+r.Settings.scheme+':([^"]*)"',"g")),a}class l{static replaceSchemeWithPath(e,t){return(t.endsWith("/")||t.endsWith("\\"))&&(t=t.substr(0,t.length-1)),e.replace((o||(o=new RegExp(r.Settings.scheme+":","g")),o),t)}static getMonikerFromUri(e){if(e.scheme!==r.Settings.scheme)throw new Error(`Invalid scheme: '${e.scheme}', expected: '${r.Settings.scheme}'`);return l.getMonikerFromRelativePath(e.path)}static getMonikerFromRelativePath(e){const t=e.indexOf("/",1);if(t<3||"~"!==e[1])return{moniker:"",relativePath:e};const n=(t>1?t:e.length)-2;return{moniker:e.substr(2,n),relativePath:e.substr(2+n)}}static getRelativePathFromPrefixedPath(e){const{moniker:t,relativePath:n}=l.getMonikerFromRelativePath(e);return"0"!==t?e:n}static getPrefixedRoot(e){return"0"!==e&&e?`/~${e}`:"/"}static replaceSchemeWithPathInLine(e,t){let n=e.replace(c(),e=>l.convertToForwardSlashesIfNeeded(e,t));return l.replaceSchemeWithPath(n,t)}static replacePathWithScheme(e,t){(t.endsWith("/")||t.endsWith("\\"))&&(t=t.substr(0,t.length-1));let n=new RegExp(t.replace(/[\/\\]+/g,"[\\/\\\\]+"),"gi");return e.replace(n,r.Settings.scheme+":")}static replacePathWithSchemeInLine(e,t){return l.replacePathWithScheme(e,t).replace(c(),e=>e.replace(/[\/\\]+/g,"/"))}static removeRootFromFileSystemPath(e,t){(t.endsWith("/")||t.endsWith("\\"))&&(t=t.substr(0,t.length-1));let n=new RegExp(t.replace(/[\/\\]+/g,"[\\/\\\\]+"),"gi");return e.replace(n,"")}static convertToForwardSlashes(e){return e.replace(/\\\\/g,"/").replace(/\\/g,"/")}static convertToForwardSlashesIfNeeded(e,t){return"/"===t[0]?l.convertToForwardSlashes(e):e}static removeLeadingSlash(e){return e.startsWith("/")?e.substring(1):e}static removeFinalSlash(e){return e.endsWith("/")?e.substring(0,e.length-1):e}static normalizePath(e){return this.removeFinalSlash(this.convertToForwardSlashes(e))}static EscapeBackslash(e){return e.replace(/\\/g,"\\\\")}static removePath(e,t=""){return e.replace(/([A-Za-z]:)?(\S*[\\\/])+\S*/gi,(e,n,i,s,r)=>{if(/^\d{1,4}\/\d{1,2}\/\d{1,4}$/.test(e))return e;{const s=(n?n.length:0)+i.length,r=e.substr(s);return t+r}})}static getWorkspaceName(e){return(s.basename(e)||e).replace(/:[\\|\/]?|\\|\//g,"$")}static getPrimaryWorkspaceFileSystemPath(){if(i.workspace.workspaceFolders&&i.workspace.workspaceFolders.length)return i.workspace.workspaceFolders[0].uri.fsPath}}t.PathUtil=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(163),s=n(162),r=n(7);t.showDiagnosticErrorMessage=function(e){i.Settings.get(s.SettingKeys.diagnosticMode)&&r.NotificationUtil.showErrorMessage(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);t.MemoryFile=class{constructor(e,t){this.uri=e,this.name=t,this.type=i.FileType.File,this.ctime=Date.now(),this.mtime=Date.now(),this.size=0,this.name=t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6),s=n(8);t.FileServiceCache=class{constructor(e,t){let n=0,i=0,o=0;const a=e=>{++i,++o,5===o&&(t.verbose(`totalCaches:${i} totalBatches:${n}`),o=0)};this.listServiceCache=new r((t,i,s)=>(n+=t.length,e.listAsync(t,i,s)),a,t.createChild("list"));let c=!0;const l=(t,n,i)=>Promise.all(t.map(t=>e.readTextAsync(t,n,i)));this.readTextCache=new r(async(t,i,r)=>{if(n+=t.length,!c)return await l(t,i,r);try{let n=[];const s={report:e=>{n=n.concat(e.results)}};let r=await e.readTextWithProgressAsync(t,i,s);if(r=r.concat(n),r.length!==t.length)throw new Error("Invalid results -> readTextWithProgressAsync");return r}catch(e){if(e.code===s.ErrorCodes.MethodNotFound)return c=!1,await l(t,i,r);throw e}},a,t.createChild("readText")),e.onFilesChanged(e=>{e.changes.forEach(e=>{let t=e.path;t.startsWith("/")||(t="/"+t),this.invalidateCache(t)})})}invalidateCache(e){this.listServiceCache.invalidateCache(e),this.readTextCache.invalidateCache(e)}listAsync(e,t,n,i){return this.listServiceCache.query(e,t,n,i)}readTextAsync(e,t,n,i){return this.readTextCache.query(e,t,n,i)}};class r{constructor(e,t,n){this.serviceCallback=e,this.onQueryCached=t,this.trace=n,this.cacheInfos=new Map,this.queryCache=new Map}invalidateCache(e){const t=Array.from(this.cacheInfos.keys()).filter(t=>t.startsWith(e));t.length>0&&(this.trace.verbose(`invalidate cache for path:${e} count:${t.length}`),t.forEach(e=>{const t=this.cacheInfos.get(e);t&&(t.resultSignal.isFulfilled?this.cacheInfos.delete(e):t.invalidated=!0)}))}async query(e,t,n,s){const r=[],a=Date.now(),c=n?a+n:void 0;let l=e.map(e=>{const n=o(e,t),i=this.cacheInfos.get(n);if(i&&!(i.expiredTime&&a>i.expiredTime))return this.onQueryCached(e),i;r.push(e)});if(r.length>0){let e=0;l=l.map(n=>{if(!n){n={resultSignal:new i.Signal,expiredTime:c};const s=o(r[e++],t);this.cacheInfos.set(s,n)}return n});const n=JSON.stringify(t);let a=this.queryCache.get(n);if(a)a.numberOfQueries++,a.queryPaths.push(...r);else{a={queryPaths:r,numberOfQueries:1},this.queryCache.set(n,a),await i.wait(5),this.queryCache.delete(n);try{this.trace.verbose(`flush query paths count:${r.length} numberOfQueries:${a.numberOfQueries}`);const n=await this.serviceCallback(r,t,s);e=0,n.forEach(n=>{const i=o(r[e++],t),s=this.cacheInfos.get(i);s&&(s.resultSignal.resolve(n),s.invalidated&&this.cacheInfos.delete(i))})}catch(e){r.forEach(n=>{const i=o(n,t),s=this.cacheInfos.get(i);s&&(s.resultSignal.reject(e),this.cacheInfos.delete(i))})}}}const u=await Promise.all(l.map(e=>e.resultSignal.promise));return n&&i.wait(n).then(()=>{this.removeExpiredCacheInfos()}),u}removeExpiredCacheInfos(){const e=Date.now(),t=Array.from(this.cacheInfos.entries()).filter(t=>t[1].expiredTime&&e>t[1].expiredTime&&t[1].resultSignal.isFulfilled).map(e=>e[0]);if(t.length>0){this.trace.verbose(`removing expired caches count:${t.length}`);for(const e of t)this.cacheInfos.delete(e)}}}function o(e,t){return`${e}-${JSON.stringify(t)}`}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5);t.HostSyncService=class{constructor(e,t,n,s){this.workspaceService=e,this.session=t,this.rpcServiceHandler=n,this.trace=s,this.disposables=[],this.serviceInfo=i.vsls.SyncService}async init(){await this.workspaceService.registerServicesAsync([i.vsls.SyncService.name],i.vsls.CollectionChangeType.Add),this.disposables.push(await this.rpcServiceHandler.registerRpcService(this,this.serviceInfo))}async dispose(){for(const e of this.disposables)e.dispose();this.disposables=[]}async checkSyncAsync(e,t,n){return await this.session.coeditingClient.isFileSynced(e,t)}async checkSyncForVersionAsync(e,t,n,i){return(await this.session.coeditingClient.isFileSyncedForVersion(e,void 0,t,n)).isSynced}async checkSyncForVersion2Async(e,t,n,i,s){return await this.session.coeditingClient.isFileSyncedForVersion(e,t,n,i)}}},function(e,t,n){var i=n(951),s=n(952),r={};for(var o in i)i.hasOwnProperty(o)&&(r[i[o]]=o);var a=e.exports={to:{},get:{}};function c(e,t,n){return Math.min(Math.max(t,e),n)}function l(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}a.get=function(e){var t,n;switch(e.substring(0,3).toLowerCase()){case"hsl":t=a.get.hsl(e),n="hsl";break;case"hwb":t=a.get.hwb(e),n="hwb";break;default:t=a.get.rgb(e),n="rgb"}return t?{model:n,value:t}:null},a.get.rgb=function(e){if(!e)return null;var t,n,s,r=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(s=t[2],t=t[1],n=0;n<3;n++){var o=2*n;r[n]=parseInt(t.slice(o,o+2),16)}s&&(r[3]=Math.round(parseInt(s,16)/255*100)/100)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(s=(t=t[1])[3],n=0;n<3;n++)r[n]=parseInt(t[n]+t[n],16);s&&(r[3]=Math.round(parseInt(s+s,16)/255*100)/100)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(n=0;n<3;n++)r[n]=parseInt(t[n+1],0);t[4]&&(r[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(t=e.match(/(\D+)/))?"transparent"===t[1]?[0,0,0,0]:(r=i[t[1]])?(r[3]=1,r):null:null;for(n=0;n<3;n++)r[n]=Math.round(2.55*parseFloat(t[n+1]));t[4]&&(r[3]=parseFloat(t[4]))}for(n=0;n<3;n++)r[n]=c(r[n],0,255);return r[3]=c(r[3],0,1),r},a.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])+360)%360,c(parseFloat(t[2]),0,100),c(parseFloat(t[3]),0,100),c(isNaN(n)?1:n,0,1)]}return null},a.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,c(parseFloat(t[2]),0,100),c(parseFloat(t[3]),0,100),c(isNaN(n)?1:n,0,1)]}return null},a.to.hex=function(){var e=s(arguments);return"#"+l(e[0])+l(e[1])+l(e[2])+(e[3]<1?l(Math.round(255*e[3])):"")},a.to.rgb=function(){var e=s(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},a.to.rgb.percent=function(){var e=s(arguments),t=Math.round(e[0]/255*100),n=Math.round(e[1]/255*100),i=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+n+"%, "+i+"%)":"rgba("+t+"%, "+n+"%, "+i+"%, "+e[3]+")"},a.to.hsl=function(){var e=s(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},a.to.hwb=function(){var e=s(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},a.to.keyword=function(e){return r[e.slice(0,3)]}},function(e,t,n){"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(e,t,n){"use strict";var i=n(953),s=Array.prototype.concat,r=Array.prototype.slice,o=e.exports=function(e){for(var t=[],n=0,o=e.length;n<o;n++){var a=e[n];i(a)?t=s.call(t,r.call(a)):t.push(a)}return t};o.wrap=function(e){return function(){return e(o(arguments))}}},function(e,t){e.exports=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(18),r=n(49),o=n(19),a=n(7),c=n(238),l=n(167),u=n(6),d=n(7),h=n(5),f=n(79),p=n(24),m=n(412),g=n(237),y=n(68),v=n(22),S=n(166),_=n(957),E=n(959),w=n(234),b=n(93),C=n(161),T=n(21),M=n(233),A=n(23),k=n(60),R=n(20),P=n(26),I=n(13),N=n(15),L=n(960),D=n(9),x=n(16),O=n(42),F=n(168),U=n(50),j=n(961),H=n(231),B=n(95),Y=n(29),W=n(169),q=o.TraceFormat.formatPath;let V=new WeakMap;function $(e){return V.has(e)||V.set(e,r()),V.get(e)}function K(t,n,s,r,o){return new Promise((a,c)=>{const l=s.version;i.commands.executeCommand(`default:${t}`).then(()=>{let i=s.getText(),c=s.version;i===n||l===c?(l===c&&r.verbose("Undo: Performing undo didn't actually make changes"),o?o():a()):e(()=>{K(t,n,s,r,o||a)})})})}function z(e,t,n,i){n.delete(t),t!==e&&(n.add(e),setTimeout(()=>{n.has(e)&&(n.delete(e),b.CoauthoringTelemetry.ReportDroppedMessage(e,t,i,!0))},5e3),b.CoauthoringTelemetry.ReportDroppedMessage(e,t,i,!1),H.showDiagnosticErrorMessage(`Dropped coediting message. Expected ID: ${e}. Actual ID: ${t}. ID Type: ${i}.`))}var G;!function(e){e[e.SendBucket=0]="SendBucket",e[e.ReceivedBucket=1]="ReceivedBucket"}(G=t.BucketType||(t.BucketType={}));class J{constructor(e){var t,n,s;this.coEditorsJoinedEventName="coEditorSwitchedFile",this.onPinEventName="onPin",this.onFollowedEventName="onFollowed",this.onUnfollowedEventName="onUnfollowed",this.onUnpinEventName="onUnpin",this.onUpdateCoEditorPositionEventName="onUpdateCoEditorPosition",this.onUpdateCoEditorVisibleRangesEventName="onUpdateCoEditorVisibleRanges",this.coEditorsJoinedEvent=new p.EventEmitter,this.onPinEvent=new p.EventEmitter,this.onUnpinEvent=new p.EventEmitter,this.onFollowedEvent=new p.EventEmitter,this.onUnfollowedEvent=new p.EventEmitter,this.onUpdateCoEditorPositionEvent=new p.EventEmitter,this.onUpdateCoEditorVisibleRangesEvent=new p.EventEmitter,this.vscodeEventSubscriptions=[],this.isDisposed=!1,this.sharedFileClients={},this.pendingRenames=[],this.lastActiveEditor=null,this.lastEditTimeForDoc=new Map,this.openUntitledFiles=new Map,this.untitledPrefix="/~untitled",this.nextDocumentChangeListener=new X,this.highestReceivedEventId=-1,this.highestSendId={},this.messageProcessQueue=Promise.resolve(),this.unprocessedMessages={},this.isGuest=!1,this.trackedMessages=new Map,this.textDocumentChangeEventMessageData=new WeakMap,this.textDocumentChangeEventMessageDataRequests=new WeakMap,this.serverVersion=-1,this.highestLocalTextChange=-1,this.textChangeEventHistory=[],this.textChangeEventHistoryMaxSize=1e3,this.unacknowledgedTextChangeIds={},this.clientDecoratorManagers={},this.positionTracker=new E.PositionTracker,this.clientVisibileRanges={},this.currentVisibleEditors={},this.recentlyScrolled={},this.followingMe=new Map,this.joiningInitialFiles={},this.justChangedDocumentTimeout=null,this.pendingFileHandshakeCallbacks={},this.pendingFileSync={},this.savingFiles={},this.fileSaveRequestsPaused=!1,this.shouldCheckSync=!1,this.desyncedFiles=new Set,this.shouldCheckSyncForVersion=!0,this.jumpCount=0,this.failedJumpCount=0,this.pinCount=0,this.unpinCount=0,this.autoUnpinCount=0,this.syncCheckCount=0,this.failedSyncCheckCount=0,this.slowSyncCheckCount=0,this.openDiffCount=0,this.closedDiffCount=0,this.droppedEventIds=new Set,this.droppedSendIds=new Set,this.summoningParticipants=null,this.settingsCallbacks={},this.initialPinIdToOwner=-1,this.activeEditorsChangedTimeout=null,this.receivedBuckets=new Map([[h.vsls.MessageType.LayoutScroll,new b.TimeTelemetry("ReceivedScroll")],[h.vsls.MessageType.SelectionChange,new b.TimeTelemetry("ReceivedSelection")],[h.vsls.MessageType.TextChange,new b.TimeTelemetry("ReceivedTextChange")]]),this.sendBuckets=new Map([[h.vsls.MessageType.LayoutScroll,new b.TimeTelemetry("SendScroll")],[h.vsls.MessageType.SelectionChange,new b.TimeTelemetry("SendSelection")],[h.vsls.MessageType.TextChange,new b.TimeTelemetry("SendTextChange")]]),this.onAccessLevelChanged=()=>{const e=f.MessageFactory.AnonymousAccessLevelChangeMessage(this.clientID);this.postMessage(e)},this.updateNametagVisibilitySetting=()=>{const e=I.Settings.get(N.SettingKeys.nameTagVisibility),t=S.NameTagVisibility[e||""];this.nameTagVisibility=t||S.NameTagVisibility.Activity,Object.keys(this.clientDecoratorManagers).forEach(e=>{this.clientDecoratorManagers[e]&&(this.clientDecoratorManagers[e].nameTagVisibility=this.nameTagVisibility,this.clientDecoratorManagers[e].updateDecorators())})},this.updateDiagnosticLoggingSetting=()=>{a.vslsCommands.API.setDiagnosticLogging(!0)},this.updateDiagnosticModeSetting=()=>{const e=I.Settings.get(N.SettingKeys.diagnosticMode);v.ExtensionUtil.setCommandContext("liveshare:diagnosticModeEnabled",!!e),e?this.diagnosticOutputTraceListener.addOutputChannel(!1):this.diagnosticOutputTraceListener.removeOutputChannel()},this.updateShowReadOnlyUsersInEditorSetting=()=>{if("always"===I.Settings.get(N.SettingKeys.showReadOnlyUsersInEditor))for(let e of this.collaboratorManager.getCollaboratorSessionIds())!this.clientDecoratorManagers[e]&&this.clientAccessCheck().isClientReadOnly(e)&&this.updateDecorators(e);else Object.keys(this.clientDecoratorManagers).forEach(e=>{const t=this.clientDecoratorManagers[e],n=parseInt(e,10);t&&NaN!==n&&this.clientAccessCheck().isClientReadOnly(e)&&!this.isPinned(n)&&(t.dispose(),delete this.clientDecoratorManagers[e])})},this._presenterIdToClear=-1,this.isGuest=e.isGuest,this.sourceEventService=e.sourceEventService,this.clientID=e.clientID,this.fileService=e.fileService,this.pathManager=e.pathManager,this.clientAccessCheck=e.clientAccessCheck,this.collaboratorManager=e.collaboratorManager,this.joinCompleted=e.joinCompleted;const r=parseInt(Object.keys(this.collaboratorManager.getCollaborators()).find(e=>this.collaboratorManager.getCollaborators()[e].isHost));this.presentationManager=new j.PresentationManager(r,null!==(t=e.presentationMode)&&void 0!==t&&t),this.presentationManager.onPresenterUpdate.on("onPresenterUpdate",()=>this.presenterDidChange());const l=I.Settings.get(N.SettingKeys.nameTagVisibility),u=S.NameTagVisibility[l||""];this.nameTagVisibility=u||S.NameTagVisibility.Activity,this.coEditingTrace=a.traceSource.withName(h.vsls.TraceSources.ClientCoEditing),this.vsCodeEventTrace=a.traceSource.withName(h.vsls.TraceSources.ClientCoEditingVSCodeEvent),this.bufferManagerTrace=a.traceSource.withName(h.vsls.TraceSources.ClientCoEditingBufferManager),this.summonsSemaphore=new c.default(1),this.fileSystemManager=e.fileSystemManager,this.syncService=e.syncService,this.diagnosticOutputTraceListener=new o.OutputTraceListener("Visual Studio Live Share Coediting"),this.updateDiagnosticModeSetting(),this.diffViewCoEditing=new L.DiffView(this.pathManager),this.diffViewCoEditing.onDidOpenDiffView((e,t)=>this.onDiffViewOpen(e,t)),this.diffViewCoEditing.onDidCloseDiffView((e,t)=>this.onDiffViewClosed(e,t)),this.diffViewCoEditing.onDidOpenNewGitDocument(e=>this.onNewGitDocument(e)),this.vscodeEventSubscriptions.push(this.diffViewCoEditing),this.coEditingTrace.info(`Name tag behavior: ${this.nameTagVisibility}`),this.captureVisibleEditorInformation(i.window.visibleTextEditors),this.followingLabelDecoratorManager=new _.FollowingLabelDecoratorManager(this,this.collaboratorManager),this.vscodeEventSubscriptions.push(i.workspace.onDidChangeTextDocument(e=>{try{this._onDidChangeTextDocument(e)}catch(e){b.CoauthoringTelemetry.ReportCoeditingError("onDidChangeTextDocument error",e)}})),this.vscodeEventSubscriptions.push(i.window.onDidChangeTextEditorSelection(e=>this._onDidChangeTextEditorSelection(e)));try{"function"==typeof i.window.onDidChangeNotebookEditorSelection&&this.vscodeEventSubscriptions.push(i.window.onDidChangeNotebookEditorSelection(e=>this._onDidChangeNotebookEditorSelection(e))),"function"==typeof(null===(n=i.notebooks)||void 0===n?void 0:n.onDidSaveNotebookDocument)&&this.vscodeEventSubscriptions.push(null===(s=i.notebooks)||void 0===s?void 0:s.onDidSaveNotebookDocument(e=>this._onDidSaveNotebookDocument(e))),"function"==typeof i.window.onDidChangeNotebookEditorVisibleRanges&&this.vscodeEventSubscriptions.push(i.window.onDidChangeNotebookEditorVisibleRanges(e=>this._onDidChangeNotebookEditorVisibleRanges(e)))}catch(e){}this.vscodeEventSubscriptions.push(i.window.onDidChangeVisibleTextEditors(async e=>await this._onDidChangeVisibleTextEditors(e))),this.vscodeEventSubscriptions.push(i.window.onDidChangeActiveTextEditor(e=>this._onDidChangeActiveTextEditor(e))),this.vscodeEventSubscriptions.push(i.workspace.onDidCloseTextDocument(e=>this.onDidCloseTextDocument(e))),this.vscodeEventSubscriptions.push(i.workspace.onDidOpenTextDocument(e=>this.onDidOpenTextDocument(e))),this.vscodeEventSubscriptions.push(i.workspace.onDidSaveTextDocument(e=>this._onDidSaveTextDocument(e))),this.vscodeEventSubscriptions.push(i.workspace.onDidChangeConfiguration(e=>this._onDidChangeConfiguration(e))),"function"==typeof i.window.onDidChangeTextEditorVisibleRanges&&this.vscodeEventSubscriptions.push(i.window.onDidChangeTextEditorVisibleRanges(e=>this._onDidChangeTextEditorVisibleRanges(e))),this.vscodeEventSubscriptions.push(v.ExtensionUtil.registerCommand("liveshare.getCoeditingInformation",this.copyCoeditingInformationToClipboard,this)),this.settingsCallbacks["liveshare.nameTagVisibility"]=this.updateNametagVisibilitySetting,this.settingsCallbacks["liveshare.diagnosticLogging"]=this.updateDiagnosticLoggingSetting,this.settingsCallbacks["liveshare.showReadOnlyUsersInEditor"]=this.updateShowReadOnlyUsersInEditorSetting,this.settingsCallbacks["liveshare.diagnosticMode"]=this.updateDiagnosticModeSetting,Y.workspaceSessionInfoTracker.onAccessLevelChangedInSession(this.onAccessLevelChanged)}get isHost(){return!this.isGuest}get isReadOnlyGuest(){return this.isGuest&&this.clientAccessCheck().isReadOnly}init(){if(this.sourceEventService.onEvent(e=>{this.trackMessage(e),this.messageProcessQueue=this.messageProcessQueue.then(()=>this._onMessage(e))},null,this.vscodeEventSubscriptions),this.fileService.onFilesChanged(e=>this.fileServiceFilesChanged(e)),this.isGuest){this.joiningInitialFiles={};const e=f.MessageFactory.JoinRequestMessage(this.clientID);this.postMessage(e),this.sendPing(),this.shouldCheckSync=!0,setTimeout(()=>this.checkSync(),1e4),i.workspace.textDocuments.length>0&&i.workspace.textDocuments.forEach(e=>{var t;const n=null===(t=this.pathManager.localPathToRelativePath(e.uri))||void 0===t?void 0:t.toLowerCase();n&&(this.savingFiles[n]=!0,e.save())})}this.onPin(e=>{if(e>0){const t=f.MessageFactory.FollowChangeMessage(this.clientID,e,!0);this.postMessage(t)}}),this.onUnpin(e=>{if(e>0){const t=f.MessageFactory.FollowChangeMessage(this.clientID,e,!1);this.postMessage(t)}}),this.shareActiveDocumentIfHost(),this.updatePinIconFromActiveEditor(),this._listenForUserInitiatedUndoRedo(),b.CoauthoringTelemetry.init(),this.coEditingTrace.addTraceListener(b.CoauthoringTelemetry.logListener),this.vsCodeEventTrace.addTraceListener(b.CoauthoringTelemetry.logListener),this.bufferManagerTrace.addTraceListener(b.CoauthoringTelemetry.logListener)}resetLanguageServicesDataStructures(){this.textChangeEventHistory=[],this.unacknowledgedTextChangeIds={}}get currentServerVersion(){return this.serverVersion}get currentHighestLocalTextChange(){return this.highestLocalTextChange}get textChangeHistory(){return this.textChangeEventHistory}get hasUnacknowledgedTextChanges(){return this.removeOldUnacknowledgedTextChanges(),0!==Object.keys(this.unacknowledgedTextChangeIds).length}removeOldUnacknowledgedTextChanges(){const e=(new Date).getTime();for(const t in this.unacknowledgedTextChangeIds)e-this.unacknowledgedTextChangeIds[t]>5e3&&(delete this.unacknowledgedTextChangeIds[t],D.Telemetry.sendFault(b.Event.DROPPED_HOST_MESSAGE_FAULT,D.FaultType.NonBlockingFault,"Did not receive acknowledgement of host message"))}recordIntoBucket(e,t,n){if(void 0!==e&&this.trackedMessages.has(e)){const i=this.trackedMessages.get(e);if("number"!=typeof i.receivedTime)return;if(t===G.SendBucket){this.sendBuckets.get(n).RecordTime(Date.now()-i.receivedTime)}else if(t===G.ReceivedBucket){this.receivedBuckets.get(n).RecordTime(Date.now()-i.receivedTime)}}}postMessage(e){if(this.isDisposed)return;e.sendId=J.sendId++;const t=e.trackingId;e.messageType===h.vsls.MessageType.TextChange?(this.highestLocalTextChange=e.sendId,this.unacknowledgedTextChangeIds[e.sendId]=(new Date).getTime(),this.recordIntoBucket(t,G.SendBucket,e.messageType)):e.messageType!==h.vsls.MessageType.LayoutScroll&&e.messageType!==h.vsls.MessageType.SelectionChange||this.recordIntoBucket(t,G.SendBucket,e.messageType),this.diagnosticOutputTraceListener.writeLine("coediting",`Post message: ${JSON.stringify(e)}`,!0),this.sourceEventService.fireEventAsync(f.CoauthoringService.SERVICE,JSON.stringify(e))}dispose(){this.isDisposed=!0,clearTimeout(this.pingTimeout),this.clientDecoratorManagers&&Object.keys(this.clientDecoratorManagers).forEach(e=>{this.clientDecoratorManagers[e].dispose()}),this.coEditorsJoinedEvent.removeAllListeners(),this.vscodeEventSubscriptions.forEach(e=>{e.dispose()}),this.nextDocumentChangeListener.dispose(),this.positionTracker.dispose(),this.updatePinableCommandStatus(!1),this.setPinned(!1),this.summoningParticipants=null,b.CoauthoringTelemetry.SessionClosed(this.jumpCount,this.failedJumpCount,this.pinCount,this.unpinCount,this.autoUnpinCount,this.syncCheckCount,this.failedSyncCheckCount,this.slowSyncCheckCount,this.openDiffCount,this.closedDiffCount),Object.keys(this.sharedFileClients).forEach(e=>{this.sharedFileClients[e].dispose()}),this.followingLabelDecoratorManager.dispose(),this.onFollowedEvent.removeAllListeners(),this.onUnfollowedEvent.removeAllListeners(),this.onPinEvent.removeAllListeners(),this.onUnpinEvent.removeAllListeners(),this.onUpdateCoEditorPositionEvent.removeAllListeners(),this.onUpdateCoEditorVisibleRangesEvent.removeAllListeners(),this.shouldCheckSync=!1;const e=new Map([...this.receivedBuckets,...this.sendBuckets]);b.CoauthoringTelemetry.ReportMetrics(e.values())}_listenForUserInitiatedUndoRedo(){I.featureFlags.localUndo&&(this.vscodeEventSubscriptions.push(v.ExtensionUtil.registerCommand("undo",this.performUserInitiatedUndo,this)),this.vscodeEventSubscriptions.push(v.ExtensionUtil.registerCommand("redo",this.performUserInitiatedRedo,this)))}trackMessage(e){const t=r();e.trackingId=t;const n={receivedTime:Date.now()};return this.trackedMessages.set(t,n),setTimeout(()=>this.trackedMessages.delete(t),6e4),t}getTrackedMessageData(e){return this.trackedMessages.get(e)}async getClientIdForTextDocumentChangeEvent(e){const t=await this.getTextDocumentChangeEventMessageData(e);return null==t?void 0:t.clientId}async getTextDocumentChangeEventMessageData(e){if(this.textDocumentChangeEventMessageData.has(e))return this.textDocumentChangeEventMessageData.get(e);if(!this.textDocumentChangeEventMessageDataRequests.has(e)){let t;const n=new Promise((e,n)=>{t=e}),i=new Promise((e,t)=>{setTimeout(()=>e(void 0),1e3)}),s=Promise.race([n,i]);this.textDocumentChangeEventMessageDataRequests.set(e,{result:s,resolve:t})}return await this.textDocumentChangeEventMessageDataRequests.get(e).result}_onDidChangeTextDocument(e){const t=Object.assign({},e);this.trackMessage(t);const n=this.pathManager.localPathToRelativePath(t.document.uri);if(null===n)return;this.lastEditTimeForDoc.set(n,(new Date).getTime()),this.vsCodeEventTrace.verbose(`onDidChangeTextDocument for ${q(n)}: ${JSON.stringify(e.contentChanges.map(e=>({range:e.range,rangeLength:e.rangeLength,rangeOffset:e.rangeOffset,text:e.text.length})))}`);const i=this.getSharedFileClient(n);if(!i)return void this.coEditingTrace.warning(`Edited a shared document that did not have a file client opened (${q(n)})`);const s=i.getBufferManagerStatus();if(t.contentChanges.length>0&&0===s.localChangesQueue&&s.collabBufferText===t.document.getText())return this.resyncSignal&&this.resyncSignal.resolve(),void this.coEditingTrace.verbose(`Ignoring onDidChangeTextDocument for ${q(n)}`);this.vsCodeEventTrace.verbose(`Handling onDidChangeTextDocument for ${q(n)}`);let r=!1;if(this.isHost&&(r=i.updateDirtyState(t.document.isDirty)),0===t.contentChanges.length)return void this.vsCodeEventTrace.verbose("onDidChangeTextDocument: Document dirty state changes");const o=i.onDidChangeTextDocument(t);this.textDocumentChangeEventMessageData.set(e,o),this.textDocumentChangeEventMessageDataRequests.has(e)&&this.textDocumentChangeEventMessageDataRequests.get(e).resolve(o),this.positionTracker.onDidChangeTextDocument(n,t),!i.waitingForRemoteEditsToBeApplied()&&r&&(t.document.uri.scheme===U.PathManager.notebookCellScheme?this.postNotebookSaveMessageToOtherParticipants(t.document.fileName):this.postSaveMessageToOtherParticipants(i.fileName))}_onDidChangeTextEditorVisibleRanges(e){const t=Object.assign({},e);let n=this.trackMessage(t);if(!e.textEditor||!e.textEditor.document)return;const i=this.pathManager.localPathToRelativePath(e.textEditor.document.uri);if(!i)return;const s=$(e.textEditor);this.recentlyScrolled[s]||(this.vsCodeEventTrace.verbose(`onDidChangeTextEditorVisibleRanges (${q(i)}): ${JSON.stringify(e.visibleRanges)}`),this.sendLayoutChangeMessage(i,s,e.visibleRanges,n))}_onDidChangeNotebookEditorVisibleRanges(e){if(!e.notebookEditor||!e.notebookEditor.document)return;const t=this.pathManager.localPathToRelativePath(e.notebookEditor.document.uri);if(!t)return;if(this.recentlyScrolled[$(e.notebookEditor)])return;this.vsCodeEventTrace.verbose(`onDidChangeNotebookEditorVisibleRanges (${q(t)}): ${JSON.stringify(e.visibleRanges)}`);let n=e.visibleRanges;if(n.length<1)return;const i=n[0],s=f.MessageFactory.NotebookScrollMessage(this.clientID,t,i.start,i.end);this.postMessage(s)}_onDidChangeTextEditorSelection(e){const t=Object.assign({},e);let n=this.trackMessage(t);if(this.justChangedDocumentTimeout&&(clearTimeout(this.justChangedDocumentTimeout),this.justChangedDocumentTimeout=null),!e.textEditor||!e.textEditor.document)return;const i=e.textEditor.document,s=this.pathManager.localPathToRelativePath(i.uri);s&&this.vsCodeEventTrace.verbose(`onDidChangeTextEditorSelection (${q(s)}): ${JSON.stringify(e.selections)}`),this.sendSelectionChangeMessage(i,e.selections,e.kind,void 0,n)}_onDidChangeNotebookEditorSelection(e){if(!e.notebookEditor||!e.notebookEditor.document)return;const t=this.pathManager.localPathToRelativePath(e.notebookEditor.document.uri);if(e.selections[0]){const n=f.MessageFactory.NotebookSelectionChangeMessage(this.clientID,t,e.selections[0].start);this.postMessage(n)}}async _onDidChangeActiveTextEditor(e){var t;if(e&&e.document&&A.sessionStateTracker.State===T.SessionState.Shared&&I.Settings.get(N.SettingKeys.shareExternalFiles)&&!i.workspace.getWorkspaceFolder(e.document.uri)&&"output"!==(null===(t=e.document.uri)||void 0===t?void 0:t.scheme)&&(await this.fileService.registerExternalFilesAsync([e.document.uri.toString()]),new D.TelemetryEvent(x.TelemetryEventNames.ADD_EXTERNAL_FILE).send()),this.updatePinIconFromActiveEditor(),!e||!e.document)return void this.updatePinableCommandStatus(!1);const n=e.document,s=this.pathManager.localPathToRelativePath(n.uri);null!==s&&(this.vsCodeEventTrace.info(`onDidChangeActiveTextEditor (${q(s)})`),this.shareActiveDocumentIfHost(),this.justChangedDocumentTimeout=setTimeout(()=>this.sendCurrentSelectionMessage(),500),Object.keys(this.clientDecoratorManagers).forEach(e=>{this.clientDecoratorManagers[e].updateDecorators()}))}async _onDidChangeVisibleTextEditors(e){this.vsCodeEventTrace.verbose(`onDidChangeVisibleTextEditors (new active viewcolumns: ${e.map(e=>e.viewColumn).join(", ")})`),this.onDidChangeVisibleRanges(),this.diffViewCoEditing.onEditorsChanged(e,this.isHost,this.clientID);let t=e=e.filter(e=>{var t,n;return void 0!==e.viewColumn||[U.PathManager.fileScheme,U.PathManager.gitScheme,U.PathManager.vslsSccScheme,U.PathManager.rawScheme].includes(null===(n=null===(t=null==e?void 0:e.document)||void 0===t?void 0:t.uri)||void 0===n?void 0:n.scheme)});try{t=t.concat(i.window.visibleNotebookEditors)}catch(e){}this.activeEditorsChangedTimeout&&(clearTimeout(this.activeEditorsChangedTimeout),this.activeEditorsChangedTimeout=null),this.activeEditorsChangedTimeout=setTimeout(()=>{this.activeEditorsChangedTimeout=null,this.captureVisibleEditorInformation(t),this.presentationManager.isStrictFollowEnabled&&this.presentationManager.currentPresenterId!=this.clientID&&!this.isPinned(this.presentationManager.currentPresenterId)&&this.pin(null,this.presentationManager.currentPresenterId,!0)},1)}onDiffViewOpen(e,t){this.postDiffViewOpenMessageToOtherParticipants(e,t)}onDiffViewClosed(e,t){this.postDiffViewClosedMessageToOtherParticipants(e,t)}onNewGitDocument(e){let t=this.pathManager.localPathToRelativePath(e.uri);this.getSharedFileClient(t)||this.performFileOpenHandshake(t,e.getText())}onDidChangeVisibleRanges(){const e=[];for(let t of i.window.visibleTextEditors){const n=this.pathManager.localPathToRelativePath(t.document.uri),i=this.getSharedFileClient(n);i?e.push(Object.assign({editorId:$(t),fileVersion:i.version},i.getEditorVisibleRanges(t.visibleRanges))):e.push({editorId:$(t),fileVersion:-1,fileName:n})}const t=f.MessageFactory.VisibleRangesChangeMessage(this.clientID,e);this.postMessage(t)}_addPinnedInfoForEditor(e,t,n=-1){const i=$(e),s=this.currentVisibleEditors[i];let r=s?s.pinnedClient:-1;n>-1&&(r=n);const o={pinnedClient:r,column:e.viewColumn||1,id:i};t[$(e)]=o}getEditorInfoForClient(e){let t=null;return Object.keys(this.currentVisibleEditors).some(n=>{const i=this.currentVisibleEditors[n];return i.pinnedClient===e&&(t=i,!0)}),t}getColumnForPinnedClient(e){const t=this.getEditorInfoForClient(e);return null==t?i.ViewColumn.Active:t.column}getClientIdIfEditorIsPinned(e){if(!e)return-1;const t=$(e),n=this.currentVisibleEditors[t];return n?n.pinnedClient:-1}captureVisibleEditorInformation(e){let t={};e.forEach(e=>this._addPinnedInfoForEditor(e,t)),this.currentVisibleEditors=t,this.updatePinIconFromActiveEditor()}getClientVisibleRanges(e){return this.clientVisibileRanges[e]}async onDidOpenTextDocument(e){const t=this.pathManager.localPathToRelativePath(e.uri);this.coEditingTrace.verbose(`onDidOpenTextDocument ${q(t)}`),e.isUntitled&&this.isHost&&this.postUntitledFileOpenedMessageToOtherParticipants(t)}async onDidCloseTextDocument(e){let t=this.pathManager.localPathToRelativePath(e.uri);this.coEditingTrace.verbose(`onDidCloseTextDocument ${q(t)}`);let n=this.getSharedFileClient(t);if(!n)return;n.clearUndoStateDueToDocumentClosing();let i=this.getNewNameFromRename(n.fileName);if(i)this.renameSharedFileClient(n,i);else{if(e.isUntitled&&this.isHost){this.postUntitledFileClosedMessageToOtherParticipants(t);const e=this.pathManager.getFromVslsPathsToLocalPaths(t);e&&(this.pathManager.deleteFromLocalPathsToVslsPaths(e),this.pathManager.deleteFromVslsPathsToLocalPaths(t))}!this.isGuest&&await d.fileAccess.existsAsync(e.fileName)}}getNewNameFromRename(e){const t=this.pendingRenames.filter(t=>t.oldName===e)[0];if(!t)return null;const n=this.pendingRenames.indexOf(t);return this.pendingRenames.splice(n,1),t.newName}saveDocument(e,t){if(!e)return;const n=this.pathManager.localPathToRelativePath(e.uri);if(!n)return;if(this.fileSaveRequestsPaused)return;if(this.vsCodeEventTrace.info(`onDidSaveDocument (${q(n)})`),this.isHost){const t=this.getSharedFileClient(n);t&&(t.takeSnapshot(),t.updateDirtyState(e.isDirty))}const i=n.toLowerCase();this.savingFiles[i]?delete this.savingFiles[i]:(this.vsCodeEventTrace.info(`onDidSaveDocument (${q(n)})`),t(n),this.activeFileName&&this.activeFileName.startsWith(this.untitledPrefix)&&this.isHost&&new D.TelemetryEvent(b.Event.SAVE_UNTITLED_FILE).send())}_onDidSaveNotebookDocument(e){this.saveDocument(e,e=>this.postNotebookSaveMessageToOtherParticipants(e))}_onDidSaveTextDocument(e){this.saveDocument(e,e=>this.postSaveMessageToOtherParticipants(e))}postSaveMessageToOtherParticipants(e){const t=f.MessageFactory.SaveFileMessage(this.clientID,e);this.postMessage(t)}postNotebookSaveMessageToOtherParticipants(e){const t=f.MessageFactory.SaveNotebookMessage(this.clientID,e);this.postMessage(t)}postUntitledFileOpenedMessageToOtherParticipants(e){const t=f.MessageFactory.UntitledFileOpenedMessage(this.clientID,e);this.postMessage(t),new D.TelemetryEvent(b.Event.ADD_UNTITLED_FILE).send()}postUntitledFileClosedMessageToOtherParticipants(e){const t=f.MessageFactory.UntitledFileClosedMessage(this.clientID,e);this.postMessage(t),new D.TelemetryEvent(b.Event.CLOSE_UNTITLED_FILE).send()}postDiffViewOpenMessageToOtherParticipants(e,t){const n=f.MessageFactory.DiffViewOpenMessage(this.clientID,e,t);this.postMessage(n),this.openDiffCount++}postDiffViewClosedMessageToOtherParticipants(e,t){const n=f.MessageFactory.DiffViewClosedMessage(this.clientID,e,t);this.postMessage(n),this.closedDiffCount++}_onDidChangeConfiguration(e){C.ExtensionTelemetry.reportChangedSetting(),Object.keys(this.settingsCallbacks).forEach(t=>{e.affectsConfiguration(t)&&this.settingsCallbacks[t]()})}pauseProcessingFileSaveRequests(){this.fileSaveRequestsPaused=!0}resumeProcessingFileSaveRequests(){this.fileSaveRequestsPaused=!1}fileServiceFilesChanged(e){e.changes.forEach(async e=>{if(!e.fullPath)return;const t=y.PathUtil.getRelativePathFromPrefixedPath(e.fullPath),n=this.getSharedFileClient(t);if(this.coEditingTrace.verbose(`fileServiceFilesChanged for ${q(t)} Change type: ${e.changeType}`),e.changeType!==h.vsls.FileChangeType.Added&&e.changeType!==h.vsls.FileChangeType.Updated||this.isHost&&n&&!i.workspace.textDocuments.find(e=>{var t;return(null===(t=this.pathManager.localPathToRelativePath(e.uri))||void 0===t?void 0:t.toLowerCase())===n.fileName.toLowerCase()})&&this.resetFileClient(n.fileName),e.changeType===h.vsls.FileChangeType.Added){const e=i.workspace.textDocuments.find(e=>this.pathManager.localPathToRelativePath(e.uri)===t);if(this.isGuest&&e&&e.isDirty&&!n&&O.getExpService().getTreatmentVariable("vscode","saveDirtyDocOnReadd")){this.savingFiles[t.toLowerCase()]=!0;let n=!1;try{n=await e.save()}catch(e){}k.assert(n,"Document should save successfully"),this.fileSystemManager().workspaceProvider.fireFilesChanged([{type:i.FileChangeType.Changed,uri:this.pathManager.relativePathToLocalPath(t)}])}}n&&e.changeType===h.vsls.FileChangeType.Deleted&&this.removeSharedFileClient(n)})}async _onMessage(e){if(this.diagnosticOutputTraceListener.writeLine("coediting",`Receive message: ${JSON.stringify(e)}`,!0),this.isDisposed)return;if(e.sourceId!==f.CoauthoringService.SERVICE)return;if(-1!==this.highestReceivedEventId){z(this.highestReceivedEventId+1,e.eventId,this.droppedEventIds,"eventId")}e.eventId<=this.highestReceivedEventId?this.coEditingTrace.error(`Message out of order: received ${e.eventId}, highest received is ${this.highestReceivedEventId}`):this.highestReceivedEventId=e.eventId;let t=JSON.parse(e.jsonContent);t=f.MessageFactory.CoauthoringMessage(t);const n=e.trackingId;t.trackingId=n,void 0!==n&&this.trackedMessages.has(n)&&(this.trackedMessages.get(n).clientId=t.clientId),this.recordActivity(t),t.messageType!==h.vsls.MessageType.TextChange&&t.messageType!==h.vsls.MessageType.SelectionChange&&t.messageType!==h.vsls.MessageType.LayoutScroll&&t.messageType!==h.vsls.MessageType.VisibleRangesChange&&t.messageType!==h.vsls.MessageType.NotebookScroll&&t.messageType!==h.vsls.MessageType.NotebookSelectionChange||W.SessionTelemetry.recordActivity();try{const n=t.clientId;if(t.messageType===h.vsls.MessageType.TextChange){let e=t;e.clientId===this.clientID&&void 0!==e.sendId&&delete this.unacknowledgedTextChangeIds[e.sendId],void 0!==e.changeServerVersion&&(this.serverVersion=e.changeServerVersion,this.textChangeEventHistory.length>=this.textChangeEventHistoryMaxSize&&this.textChangeEventHistory.shift(),this.textChangeEventHistory.push(e))}if(void 0===n)return;if("number"==typeof t.sendId&&t.sendId>0){if("number"!=typeof this.highestSendId[n]&&(this.highestSendId[n]=-1),-1!==this.highestSendId[n]){z(this.highestSendId[n]+1,t.sendId,this.droppedSendIds,"sendId")}t.sendId<=this.highestSendId[n]?this.coEditingTrace.error(`Message from client #${n} out of order: received ${t.sendId}, highest received is ${this.highestSendId[n]}`):this.highestSendId[n]=t.sendId}if(n===this.clientID&&t.messageType!==h.vsls.MessageType.TextChange&&t.messageType!==h.vsls.MessageType.AnonymousAccessLevelChange&&t.messageType!==h.vsls.MessageType.Ping&&t.messageType!==h.vsls.MessageType.JoinAcknowledge)return;let s=t.fileName,r=this.getSharedFileClient(s);if(f.IsFileContentMessage(t)&&!r){if(s)switch(t.messageType){case h.vsls.MessageType.TextChange:this.coEditingTrace.info(`The file client does not exist yet; queuing file message for ${q(s)}: ${t.messageType}`),this.unprocessedMessages[s]||(this.unprocessedMessages[s]=[]),this.unprocessedMessages[s].push(new m.MessageAndVersionNumber(t,e.eventId));break;case h.vsls.MessageType.SelectionChange:this.coEditingTrace.info(`Processing a selection change for a file client that does not exist yet (${q(s)})`),this.updateCoEditorPosition(t)}return}switch(this.coEditingTrace.verbose(`Received ${t.messageType} message for (${q(s)})`),t.messageType){case h.vsls.MessageType.TextChange:case h.vsls.MessageType.SelectionChange:const s=t.fileVersion;r&&r.onIncomingMessage(t,e.eventId,s);break;case h.vsls.MessageType.NotebookSelectionChange:this.updateNotebookCellSelection(t);break;case h.vsls.MessageType.VisibleRangesChange:this.updateCoEditorVisibleRanges(t);break;case h.vsls.MessageType.LayoutScroll:this.updateCoEditorScrollPosition(t);break;case h.vsls.MessageType.NotebookScroll:this.updateCoEditorNotebookScrollPosition(t);break;case h.vsls.MessageType.AnonymousAccessLevelChange:const o=Y.workspaceSessionInfoTracker.getAccessLevelChangedUserID();this.updateDecorators(o);break;case h.vsls.MessageType.JoinRequest:if(this.fireCoEditorsJoined([n]),!this.isHost)break;const a=this.collaboratorManager.getCollaboratorSessionIds();a.unshift(this.clientID);const c=this.activeFileName,l=[];Object.keys(this.sharedFileClients).forEach(e=>{const t=this.sharedFileClients[e].fileName;t===c?l.unshift(t):l.push(t)}),this.postMessage(f.MessageFactory.JoinAcknowledgeMessage(this.clientID,n,a,l)),this.isHost&&this.presentationManager.presentationMode&&this.sendPresenterUpdateMessage(this.presentationManager.currentPresenterId);break;case h.vsls.MessageType.JoinAcknowledge:const u=t;u.joinerId===this.clientID?(this.initialPinIdToOwner=u.clientId,this.fireCoEditorsJoined(u.clientIds||[]),(u.files||[]).forEach((e,t)=>{const n=e.toLowerCase();this.joiningInitialFiles[n]=!0;const i=0===t;this.requestOpenSharedFile(e,i)})):this.isGuest&&this.sendCurrentSelectionMessage(),setTimeout(()=>this.onDidChangeVisibleRanges(),500);break;case h.vsls.MessageType.PresenterUpdate:const d=t;if(d.newPresenterId<0)return;this.presentationManager.presentationMode=!0,this._presenterIdToClear=this.presentationManager.currentPresenterId,this.presentationManager.updatePresenterId(d.newPresenterId);break;case h.vsls.MessageType.FollowChange:const p=t;if(p.followedClient!==this.clientID)return;this.followingMe.set(p.clientId,p.follow),p.follow?this.onFollowedEvent.emit(this.onFollowedEventName):this.onUnfollowedEvent.emit(this.onUnfollowedEventName);case h.vsls.MessageType.SaveFile:const m=t;this.onSaveFileMessage(m);try{const e=await this.pathManager.openRelativePath(m.fileName);await e.save()}catch(e){}break;case h.vsls.MessageType.SaveNotebook:const g=t,y=this.onSaveFileMessage(g);if(!y)break;try{const e=await this.pathManager.relativePathToLocalPath(y);(await i.workspace.openNotebookDocument(e)).save()}catch(e){}break;case h.vsls.MessageType.UntitledFileOpened:const v=t;if(v.fileName){const e=this.pathManager.relativePathToLocalPath(v.fileName);this.openUntitledFiles.has(e.path)||(this.openUntitledFiles.set(e.path,{type:i.FileType.File,ctime:(new Date).getTime(),mtime:(new Date).getTime(),size:0}),this.fileSystemManager().workspaceProvider.fireFilesChanged([{type:i.FileChangeType.Created,uri:e}]),this.fileSystemManager().workspaceProvider.fireFilesChanged([{type:i.FileChangeType.Changed,uri:e}]))}break;case h.vsls.MessageType.UntitledFileClosed:const S=t;if(S.fileName){const e=this.pathManager.relativePathToLocalPath(S.fileName);this.openUntitledFiles.delete(e.path),this.pathManager.deleteFromLocalPathsToVslsPaths(S.fileName),this.fileSystemManager().workspaceProvider.fireFilesChanged([{type:i.FileChangeType.Deleted,uri:e}]);const t=this.getSharedFileClient(e.path);t&&this.removeSharedFileClient(t)}break;case h.vsls.MessageType.DiffViewOpen:{const e=t;let n=this.pathManager.relativePathToLocalPath(e.leftFile),i=this.pathManager.relativePathToLocalPath(e.rightFile);this.diffViewCoEditing.saveDiffViewInformation(t.clientId,n,i);break}case h.vsls.MessageType.DiffViewClosed:{const e=t;let n=this.pathManager.relativePathToLocalPath(e.leftFile),i=this.pathManager.relativePathToLocalPath(e.rightFile);this.diffViewCoEditing.removeDiffViewInformation(t.clientId,n,i);break}case h.vsls.MessageType.FileOpenAcknowledge:const _=t;if(_.joinerId===this.clientID&&_.fileName){const e=_.fileName.toLowerCase();this.pendingFileHandshakeCallbacks[e]?this.pendingFileHandshakeCallbacks[e](_):this.coEditingTrace.warning(`Received unrequested fileOpenAcknowledge message for ${q(_.fileName)}`)}else this.isGuest&&_.fileName===this.activeFileName&&this.sendCurrentSelectionMessage();break;case h.vsls.MessageType.FileOpenRequest:const E=t,w=E.fileName;if(!w)break;if(this.isGuest){if(!this.getSharedFileClient(w))if(w.startsWith(U.PathManager.gitPrefix)){let e;e=await i.workspace.openTextDocument(this.pathManager.relativePathToLocalPath(w)),this.performFileOpenHandshake(w,e.getText())}else this.requestOpenSharedFile(w);break}let b=this.getSharedFileClient(w);if(!b){let e;try{e=await this.pathManager.openRelativePath(w)}catch(e){const t=f.MessageFactory.FileOpenAcknowledgeMessage(this.clientID,w,0,n,0,0,[],"Unable to open this file -- only text documents are supported",[],!0,!0);this.postMessage(t);break}b=this.createSharedFileClient(w,e.getText(),e.isDirty,0,e.languageId)}let C=b.getSavedSnapshotOrFallback(E.hashCode||NaN);const T=b.getCurrentHistory(),M=T.shift(),A=f.MessageFactory.FileOpenAcknowledgeMessage(this.clientID,w,b.version,n,C.serverVersionNumber,M.serverVersionNumber,C.changes,C.fallbackText,T,!1,!1);this.postMessage(A),E.sendJumpTo&&E.fileName===this.activeFileName&&this.sendCurrentSelectionMessage(n);break;case h.vsls.MessageType.ResetFileClient:if(this.isHost||!r)break;this.removeSharedFileClient(r);const k=i.workspace.textDocuments.find(e=>{var t;return(null===(t=this.pathManager.localPathToRelativePath(e.uri))||void 0===t?void 0:t.toLowerCase())===r.fileName.toLowerCase()});k&&k.save().then(()=>{this.fileSystemManager().workspaceProvider.fireFilesChanged([{type:i.FileChangeType.Changed,uri:this.pathManager.relativePathToLocalPath(r.fileName)}])});break;case h.vsls.MessageType.Handshake:const R=t;r&&r.onHandshake(R);break;case h.vsls.MessageType.Summon:const P=t;this.summoningParticipants||(this.summoningParticipants=new Set),void 0!==P.recipientId&&P.recipientId===this.clientID&&(this.summoningParticipants.add(t.clientId),this.RespondToSummonsAsync(t.clientId)),this.summoningParticipants.has(t.clientId)||null!=P.recipientId||(this.summoningParticipants.add(t.clientId),this.RespondToSummonsAsync(t.clientId));break;case h.vsls.MessageType.Ping:t.clientId===this.clientID&&this.receivePing();break;default:this.coEditingTrace.warning(`Received unknown message type: ${t.messageType}`)}}catch(e){const n=`Rejected promise while processing a coauthoring message of type ${t.messageType}`;this.coEditingTrace.error(`${n}`),b.CoauthoringTelemetry.ReportCoeditingError(n,e)}}onSaveFileMessage(e){if(this.isReadOnlyGuest||!e.fileName)return;const t=e.fileName.toLowerCase();return this.savingFiles[t]=!0,t}recordActivity(e){switch(e.messageType){case h.vsls.MessageType.SaveFile:{const t=e;l.activitySource.fire({timestamp:new Date,name:`${l.ActivityType.workspace}/saveFile`,data:{peer:t.clientId,file:this.pathManager.relativePathToLocalPath(t.fileName)}});break}case h.vsls.MessageType.FileOpenRequest:{const t=e;l.activitySource.fire({timestamp:new Date,name:`${l.ActivityType.workspace}/openFile`,data:{peer:t.clientId,file:this.pathManager.relativePathToLocalPath(t.fileName)}});break}}}async RespondToSummonsAsync(e){if(await this.summonsSemaphore.acquire(),!this.positionTracker.getClientPosition(e))return this.summoningParticipants.delete(e),void this.summonsSemaphore.release();if("accept"===I.Settings.get(N.SettingKeys.focusBehavior)){let t=P.localize("notification.FocusAccept");t=t.replace("$(userId)",this.collaboratorManager.getDisplayName(e)),i.window.showInformationMessage(t),this.pin(this.activeEditor,e)}else{let t=P.localize("notification.FocusRequest");t=t.replace("$(userId)",this.collaboratorManager.getDisplayName(e));const n="Follow",s="Ignore";await i.window.showInformationMessage(t,n,s)===n&&this.pin(this.activeEditor,e)}this.summoningParticipants.delete(e),this.summonsSemaphore.release()}getSharedFileClientFromEditor(e){if(!e||!e.document)return null;const t=this.pathManager.localPathToRelativePath(e.document.uri);return this.getSharedFileClient(t)}getSharedFileClient(e){if("string"!=typeof e)return null;const t=e.toLowerCase();return this.sharedFileClients[t]||null}createSharedFileClient(e,t,n,i=0,s,r=!1,o=!1){const a=this.getSharedFileClient(e);if(a){if(!r)return this.coEditingTrace.warning(`Attempted to re-create an existing file client for ${q(e)}`),a;i=a.version+1}this.coEditingTrace.info(`Creating file client for ${q(e)}`);const c=this.pathManager.relativePathToLocalPath(e),l=e.toLowerCase(),u=new Z(this,e,c,t,this.bufferManagerTrace,n,i);return a&&this.removeSharedFileClient(a),this.sharedFileClients[l]=u,s&&u.setLanguageId(s),u.takeSnapshot(),o&&this.postMessage(f.MessageFactory.FileOpenRequestMessage(this.clientID,e,0,!1)),u}renameSharedFileClient(e,t){const n=e.fileName.toLowerCase();delete this.sharedFileClients[n],e.updateFileName(t),this.sharedFileClients[t.toLowerCase()]=e}removeSharedFileClient(e){this.coEditingTrace.verbose(`removeSharedFileClient ${q(e.fileName)}`),delete this.sharedFileClients[e.fileName.toLowerCase()],e.dispose()}shareActiveDocumentIfHost(){if(this.isGuest)return;const e=this.activeFileName;if(!e||this.getSharedFileClient(e))return;const t=this.activeEditor,n=t&&t.document;n&&(this.createSharedFileClient(e,n.getText(),n.isDirty,0,n.languageId),this.postMessage(f.MessageFactory.FileOpenRequestMessage(this.clientID,e,0,!1)))}async requestOpenSharedFile(e,t=!1){if(this.isHost)return;let n;try{n=await this.pathManager.openRelativePath(e,t)}catch(e){return}const i=this.getSharedFileClient(e);i&&(i.setLanguageId(n.languageId),i.drainMessageQueue())}async performFileOpenHandshake(e,t){if(this.isHost)return!0;const n=e.toLowerCase();if(this.pendingFileSync[n])return this.pendingFileSync[n];const s=this.getSharedFileClient(e);return s?s.getBufferContent():this.pendingFileSync[n]=new Promise(async(s,r)=>{const o=await new Promise((i,s)=>{this.pendingFileHandshakeCallbacks[n]=i;const r=g.calculateFileHash(t),o=!!this.joiningInitialFiles[n];delete this.joiningInitialFiles[n];const a=f.MessageFactory.FileOpenRequestMessage(this.clientID,e,r,o||-1!==this.initialPinIdToOwner);this.postMessage(a)});delete this.pendingFileHandshakeCallbacks[n],o.wasUnableToOpen&&s(!1);const a=o.fallbackText?o.fallbackText:t,c=new w.CollabBuffer(a,this.coEditingTrace);(o.changes||[]).forEach(t=>{this.coEditingTrace.verbose(`Applying file open acknowledge message change for ${q(e)}`),c.applyRemoteEdits(t.filter(e=>void 0!==e.start&&void 0!==e.length).map(e=>({position:e.start,length:e.length,text:e.newText||""})))});const l=this.createSharedFileClient(e,c.getContent(),!1,o.fileVersion);l.initializeHistory(o),this.unprocessedMessages[e]&&(this.unprocessedMessages[e].forEach(e=>{l.onIncomingMessage(e.message,e.serverVersionNumber,e.message.fileVersion,m.CoeditingIncomingMessageBehavior.Queue),l.updateInitialHistoryHighWatermark(e.serverVersionNumber)}),delete this.unprocessedMessages[e]);const u=i.workspace.textDocuments.find(e=>{var t;return(null===(t=this.pathManager.localPathToRelativePath(e.uri))||void 0===t?void 0:t.toLowerCase())===n});u&&(l.queueMessages(),this.savingFiles[n]=!0,u.save().then(()=>{this.fileSystemManager().workspaceProvider.fireFilesChanged([{type:i.FileChangeType.Changed,uri:u.uri}]),setTimeout(()=>l.processMessages(),1e3)})),s(l.getBufferContent()),delete this.pendingFileSync[n]})}uriToFileName(e){return this.pathManager.localPathToRelativePath(e)}async updateNotebookCellSelection(e){const t=e.clientId;if(void 0===t||t===this.clientID||!e.fileName||void 0===e.index)return;const n=await this.pathManager.openRelativePath(e.fileName);let s=new i.Position(e.index,0),r=new i.Range(s,s);this.positionTracker.setNotebookPosition(t,e.fileName,n,r,!1),this.updateDecorators(t);const o=this.getColumnForPinnedClient(t);o&&o!==i.ViewColumn.Active&&this.jumpTo(t),this.initialPinIdToOwner=-1}async updateCoEditorPosition(e){const t=e.clientId;if(void 0===t||t===this.clientID||!e.fileName||void 0===e.start||void 0===e.length)return;let n;try{n=await this.pathManager.openRelativePath(e.fileName)}catch(e){return}const s=this.getSharedFileClient(e.fileName);if(!s)return;const r=e.fileName,o=s.toVSCodeDocumentPos(e.start),a=s.toVSCodeDocumentPos(e.start+e.length),c=new i.Range(o,a);if(this.positionTracker.setClientPosition(t,r,n,c,e.isReversed||!1),!await this.clientAccessCheck().isClientReadOnly(t)||this.isPinned(t)||"always"===I.Settings.get(N.SettingKeys.showReadOnlyUsersInEditor)){this.updateDecorators(t),e.forceJumpForClientId===this.clientID&&this.joinCompleted.then(()=>{-1!==this.initialPinIdToOwner?(this.initialPinIdToOwner=-1,i.window.visibleTextEditors.length>0?this.jumpTo(t,i.window.visibleTextEditors[0].viewColumn):this.jumpTo(t)):this.jumpTo(t)});const n=this.getColumnForPinnedClient(t);if(n&&n!==i.ViewColumn.Active)this.jumpTo(t,n,!1,!0);else{let e=this.getEditorInfoForClient(t);e&&void 0===e.column&&this.jumpTo(t)}}this.onUpdateCoEditorPositionEvent.emit(this.onUpdateCoEditorPositionEventName,{clientId:t,fileName:r,document:n,range:c,isReversed:e.isReversed||!1,kind:e.kind})}updateDecorators(e){const t=this.collaboratorManager.getDisplayName(e);this.clientDecoratorManagers[e]||(this.clientDecoratorManagers[e]=new S.ClientDecoratorManager(e,t,this.nameTagVisibility,this.positionTracker)),this.clientDecoratorManagers[e].updateNameTag(t),this.clientDecoratorManagers[e].updateDecorators()}updateCoEditorVisibleRanges(e){const t=[];for(let n of e.clientVisibleRanges){const i=this.getSharedFileClient(n.fileName);if(i&&i.version===n.fileVersion){const s=i.transformVisibleRanges(e.clientId,n).visibleRanges.map(e=>i.vslsRangeToVSCodeRange(e));t.push({fileName:n.fileName,editorId:n.editorId,visibleRanges:s})}else t.push({fileName:n.fileName,editorId:n.editorId,visibleRanges:[]})}this.clientVisibileRanges[e.clientId]=t,this.onUpdateCoEditorVisibleRangesEvent.emit(this.onUpdateCoEditorVisibleRangesEventName,{clientId:e.clientId,reason:M.UpdateCoEditorVisibleRangesReason.EDITORS})}updateCoEditorScrollPosition(e){let t=null;const n=this.getSharedFileClient(e.fileName);if(n&&(t=n.transformScrollSelectionToCurrent(e)),!t||!n)return;this.clientVisibileRanges[e.clientId]||(this.clientVisibileRanges[e.clientId]=[]);const s={fileName:e.fileName,editorId:e.editorId,visibleRanges:t.visibleRanges.map(e=>n.vslsRangeToVSCodeRange(e))};let r=this.clientVisibileRanges[e.clientId].findIndex(e=>e.editorId===s.editorId);r>=0&&this.clientVisibileRanges[e.clientId].splice(r,1),this.clientVisibileRanges[e.clientId].push(s),this.onUpdateCoEditorVisibleRangesEvent.emit(this.onUpdateCoEditorVisibleRangesEventName,{clientId:e.clientId,fileName:e.fileName,editorId:e.editorId,reason:M.UpdateCoEditorVisibleRangesReason.SCROLL});const o=n.vslsRangeToVSCodeRange(t),a=this.getEditorInfoFromScrollMessage(e);if(!a)return;const c=i.window.visibleTextEditors.find(e=>$(e)===(null==a?void 0:a.id));if(!c)return;c.revealRange(o,i.TextEditorRevealType.Default);const l=e.trackingId;this.recordIntoBucket(l,G.ReceivedBucket,h.vsls.MessageType.LayoutScroll),this.updateRecentlyScrolled(a.id)}updateCoEditorNotebookScrollPosition(e){const t=this.getEditorInfoFromScrollMessage(e);if(!t)return;let n;try{n=i.window.visibleNotebookEditors.find(e=>$(e)===(null==t?void 0:t.id))}catch(e){}if(!n)return;const s=new i.NotebookRange(e.start,e.end);n.revealRange(s,i.NotebookEditorRevealType.AtTop)}getEditorInfoFromScrollMessage(e){if(e.clientId===this.clientID)return;return this.getEditorInfoForClient(e.clientId||NaN)}updateRecentlyScrolled(e){const t=this.recentlyScrolled[e];t&&clearTimeout(t),this.recentlyScrolled[e]=setTimeout(()=>{delete this.recentlyScrolled[e]},J.recentlyScrolledTimeout)}async jumpToNotebook(e,t,n,s=!1,r){const o=i.workspace.notebookDocuments.find(e=>e.uri.toString()===t.documentUri.toString()),a=await i.window.showNotebookDocument(o);if(r){let e=i.window.visibleTextEditors;try{e=e.concat(i.window.visibleNotebookEditors),this.captureVisibleEditorInformation(e)}catch(e){}}if(this._addPinnedInfoForEditor(a,this.currentVisibleEditors,e),this.updatePinIconFromActiveEditor(),!r){const e=t.range.start.line,n=new i.NotebookRange(e,e);a.revealRange(n,i.NotebookEditorRevealType.AtTop)}}async jumpTo(e,t,n=!1,r){let o=this.positionTracker.getClientPosition(e);if(n&&++this.jumpCount,!o)return void(n&&(++this.failedJumpCount,this.showJumpFailedNotification()));if(o.notebookPosition)return await this.jumpToNotebook(e,o.notebookPosition,t,n,r);if(o.documentPosition&&o.documentPosition.documentUri.toString().startsWith(U.PathManager.notebookCellScheme))return await this.jumpToNotebook(e,o.documentPosition,t,n,r);const a=o.documentPosition;if(!a)return void(n&&(++this.failedJumpCount,this.showJumpFailedNotification()));const c=await this.pathManager.openRelativePath(a.fileName);let l;const u=this.pathManager.relativePathToLocalPath(a.fileName);let d=this.diffViewCoEditing.findDiffViewInformation(e,u);if(d){let e=s.basename(d.leftFile.path);await i.commands.executeCommand("vscode.diff",d.leftFile,d.rightFile,e,{});let t=i.window.visibleTextEditors.filter(e=>e.document.uri.toString()===u.toString());l=t[0]}else l=await async function(e,t=3){for(let n=0;n<t-1;n++)try{return await e()}catch(e){}return e()}(()=>i.window.showTextDocument(c,t,!0));this._addPinnedInfoForEditor(l,this.currentVisibleEditors,e),this.updatePinIconFromActiveEditor(),void 0===l.visibleRanges[0].intersection(a.range)&&(await i.commands.executeCommand("editor.unfold",{selectionLines:[a.range.start.line],levels:Number.MAX_VALUE,direction:"up"}),l.revealRange(a.range,i.TextEditorRevealType.Default))}pin(e,t,n){if(D.Telemetry.sendTelemetryEvent(x.TelemetryEventNames.PIN),++this.pinCount,!this.positionTracker.getClientPosition(t))return++this.failedJumpCount,void this.showJumpFailedNotification();e&&this._addPinnedInfoForEditor(e,this.currentVisibleEditors,t);let s=e?e.viewColumn:i.ViewColumn.Active;!n&&s||(s=-2),v.ExtensionUtil.setCommandContext("liveshare:isFollowing",!0),this.jumpTo(t,s).then(()=>this.updateDecorators(t)),this.onPinEvent.emit(this.onPinEventName,t)}getUsersBeingFollowed(){const e={};for(let t of Object.keys(this.currentVisibleEditors)){e[this.currentVisibleEditors[t].pinnedClient]=!0}return e}getUsersFollowingYou(){return this.followingMe}unpinByEditor(e,{explicit:t=!1}){const n=$(e),i=this.currentVisibleEditors[n];i&&-1!==i.pinnedClient&&(t?++this.unpinCount:++this.autoUnpinCount,this.unpin(i))}unpinByClient(e,{explicit:t=!1}){const n=this.getEditorInfoForClient(e);if(!n)return;t&&++this.unpinCount,this.unpin(n);const i=f.MessageFactory.FollowChangeMessage(this.clientID,e,!1);this.postMessage(i),this.onUnpinEvent.emit(this.onUnpinEventName,e)}unpin(e){if(this.presentationManager.isStrictFollowEnabled&&this.presentationManager.currentPresenterId!=this.clientID&&e.id==this.getEditorInfoForClient(this.presentationManager.currentPresenterId).id)return;const t=e.pinnedClient;!async function(e){try{await e.clientAccessCheck().isClientReadOnly(t)&&e.clientDecoratorManagers[t]&&"always"!==I.Settings.get(N.SettingKeys.showReadOnlyUsersInEditor)&&(e.clientDecoratorManagers[t].dispose(),delete e.clientDecoratorManagers[t])}catch(t){e.coEditingTrace.error("Error unpinning read-only participant")}}(this),e.pinnedClient=-1;const n=this.activeEditor;n&&$(n)===e.id&&this.setPinned(!1)}isPinned(e){return null!==this.getEditorInfoForClient(e)}updatePinableCommandStatus(e){v.ExtensionUtil.setCommandContext("liveshare:isFollowable",e)}setPinned(e,t=-1){e?this.onPinEvent.emit(this.onPinEventName,t):this.onUnpinEvent.emit(this.onUnpinEventName,t),v.ExtensionUtil.setCommandContext("liveshare:isFollowing",e)}updatePinIconFromActiveEditor(){if(null===this.activeFileName)return void this.updatePinableCommandStatus(!1);this.updatePinableCommandStatus(!0);const e=this.activeEditor,t=e?this.currentVisibleEditors[$(e)]:null;t&&t.pinnedClient>-1?this.setPinned(!0,t.pinnedClient):this.setPinned(!1)}sendPresenterUpdateMessage(e){const t=f.MessageFactory.PresenterUpdateMessage(this.clientID,e);this.postMessage(t)}presenterDidChange(){if(this.isHost)this.sendPresenterUpdateMessage(this.presentationManager.currentPresenterId),this.presentationManager.currentPresenterId!==this.clientID&&this.pin(null,this.presentationManager.currentPresenterId,!0);else{const e=this.getColumnForPinnedClient(this._presenterIdToClear);this.pin(null,this.presentationManager.currentPresenterId,e!==i.ViewColumn.One),this._presenterIdToClear=this.presentationManager.currentPresenterId}}lastKnownFileForClient(e){var t,n;const i=this.positionTracker.getClientPosition(e),s=(null===(t=null==i?void 0:i.documentPosition)||void 0===t?void 0:t.fileName)||(null===(n=null==i?void 0:i.notebookPosition)||void 0===n?void 0:n.fileName);return null==s?void 0:s.replace(/^\/*/,"")}onCoEditorSwitchedFile(e){this.positionTracker.onCoEditorSwitchedFile(e)}onCoEditorsJoined(e){this.coEditorsJoinedEvent.addListener(this.coEditorsJoinedEventName,e)}onFollowed(e){return this.onFollowedEvent.addListener(this.onFollowedEventName,e),new i.Disposable(()=>{this.onFollowedEvent.removeListener(this.onFollowedEventName,e)})}onUnfollowed(e){return this.onUnfollowedEvent.addListener(this.onUnfollowedEventName,e),new i.Disposable(()=>{this.onUnfollowedEvent.removeListener(this.onUnfollowedEventName,e)})}onPin(e){return this.onPinEvent.addListener(this.onPinEventName,e),new i.Disposable(()=>{this.onPinEvent.removeListener(this.onPinEventName,e)})}onUnpin(e){return this.onUnpinEvent.addListener(this.onUnpinEventName,e),new i.Disposable(()=>{this.onUnpinEvent.removeListener(this.onUnpinEventName,e)})}onUpdateCoEditorPosition(e){return this.onUpdateCoEditorPositionEvent.addListener(this.onUpdateCoEditorPositionEventName,e),new i.Disposable(()=>{this.onUpdateCoEditorPositionEvent.removeListener(this.onUpdateCoEditorPositionEventName,e)})}onUpdateCoEditorVisibleRanges(e){this.onUpdateCoEditorVisibleRangesEvent.addListener(this.onUpdateCoEditorVisibleRangesEventName,e)}async onWorkspaceSessionChanged(e){const t=e.sessionNumber;e.changeType===h.vsls.WorkspaceSessionChangeType.Unjoined&&this.collaboratorManager.wasCoEditor(t)&&(this.clientDecoratorManagers[t]&&(this.clientDecoratorManagers[t].dispose(),delete this.clientDecoratorManagers[t]),"number"==typeof this.highestSendId[t]&&delete this.highestSendId[t],this.unpinByClient(t,{explicit:!1}))}async performUserInitiatedUndo(e){let t=this.getSharedFileClientFromEditor(this.activeEditor);!!t&&t.undoLastLocalEdit()||i.commands.executeCommand("default:undo",e)}async performUserInitiatedRedo(e){let t=this.getSharedFileClientFromEditor(this.activeEditor);!!t&&t.redoLastLocalEdit()||i.commands.executeCommand("default:redo",e)}sendCurrentSelectionMessage(e){const t=this.activeEditor;if(!t)return;const n=t.document;let s=t.selections;if((!s||!s.length)&&n){const e=n.positionAt(0);s.push(new i.Selection(e,e))}this.sendSelectionChangeMessage(n,s,void 0,e,void 0)}get activeDocument(){return this.activeEditor?this.activeEditor.document:null}get activeFileName(){return this.fileNameForEditor(this.activeEditor)}get activeEditor(){const e=i.window.activeTextEditor;return e&&(this.lastActiveEditor=e),this.lastActiveEditor}fileNameForEditor(e){if(!e||!e.document)return null;const t=e.document.uri;return this.pathManager.localPathToRelativePath(t)}sendLayoutChangeMessage(e,t,n,i){const s=this.getSharedFileClient(e);e&&s&&s.onDidChangeTextEditorVisibleRange(e,t,n,i)}sendSelectionChangeMessage(e,t,n,i,s){const r=this.pathManager.localPathToRelativePath(e.uri),o=this.getSharedFileClient(r);r&&o&&o.onDidChangeTextEditorSelection(t,r,n,i,s)}fireCoEditorsJoined(e){this.collaboratorManager.coEditorsJoined(e),this.coEditorsJoinedEvent.emit(this.coEditorsJoinedEventName,e)}showJumpFailedNotification(){i.window.showInformationMessage("The target participant is not currently editing a shared document")}async resyncDocument(e){return this.isGuest?this.resyncDocumentGuest(e):this.resyncDocumentHost(e)}async resyncDocumentGuest(e){const t=await i.workspace.openTextDocument(e),n=this.pathManager.localPathToRelativePath(e),s=this.getSharedFileClient(n);let r=s.getBufferManagerStatus();if(g.removeLineEndings(r.collabBufferText)===g.removeLineEndings(t.getText()))return;new D.TelemetryEvent(b.Event.RESYNC_DOCUMENT).send();let o=!1;await u.withRetries(async()=>{o=t.isDirty,this.savingFiles[n]=!0;let e=!1;try{e=await t.save()}catch(e){}if(k.assert(e,"resyncDocument: document should save successfully"),r=s.getBufferManagerStatus(),g.removeLineEndings(r.collabBufferText)===g.removeLineEndings(t.getText()))return;k.assert(void 0===this.resyncSignal,"Should only be one resync in progress at a time"),this.resyncSignal=new u.Signal;const a=new u.Signal;if(setTimeout(()=>a.resolve(!0),5e3),this.fileSystemManager().workspaceProvider.fireFilesChanged([{type:i.FileChangeType.Changed,uri:t.uri}]),await Promise.race([this.resyncSignal.promise,a.promise]),this.resyncSignal=void 0,g.removeLineEndings(r.collabBufferText)!==g.removeLineEndings(t.getText()))throw new Error("Did not resync document successfully")}),s.clearLocalChangesQueue()}async resyncDocumentHost(e){const t=await i.workspace.openTextDocument(e),n=this.pathManager.localPathToRelativePath(e),s=this.getSharedFileClient(n),r=s.getBufferManagerStatus();g.removeLineEndings(r.collabBufferText)!==g.removeLineEndings(t.getText())&&(new D.TelemetryEvent(b.Event.RESYNC_DOCUMENT).send(),await u.withRetries(async()=>{const n=t.validateRange(new i.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER)),s=new i.WorkspaceEdit;if(s.replace(e,n,r.collabBufferText),!await i.workspace.applyEdit(s)||g.removeLineEndings(r.collabBufferText)!==g.removeLineEndings(t.getText()))throw new Error("Did not resync document successfully")}),s.clearLocalChangesQueue())}sendPing(){this.pingTimeout||(this.postMessage(f.MessageFactory.PingMessage(this.clientID)),this.pingTimeout=setTimeout(()=>{new D.TelemetryEvent(b.Event.SLOW_PING).send(),H.showDiagnosticErrorMessage("Slow Live Share connection")},1e4))}receivePing(){clearTimeout(this.pingTimeout),this.pingTimeout=void 0,setTimeout(()=>this.sendPing(),1e4)}async getFileHash(e,t=!0){const n=i.workspace.textDocuments.filter(t=>this.pathManager.localPathToRelativePath(t.uri)===e);if(0===n.length&&t){return await this.pathManager.openRelativePath(e),await this.getFileHash(e,!1)}return k.assert(1===n.length,`One and only one document should match file name. Actual: ${n.length}`),g.calculateFileHash(g.removeLineEndings(n[0].getText()))}checkFuzzyDesync(e,t){if(t)this.desyncedFiles.has(e)&&(this.desyncedFiles.delete(e),b.CoauthoringTelemetry.ReportFalseDesync());else if(!this.desyncedFiles.has(e)){this.desyncedFiles.add(e);const t=e.split("."),n=t.length>1?t.pop():"NA",s=y.PathUtil.getMonikerFromRelativePath(e).moniker||"None",r=i.workspace.getConfiguration().files.autoSave;b.CoauthoringTelemetry.ReportFuzzyDesync(n,s,r),H.showDiagnosticErrorMessage("Desync Detected!")}}async isFileSynced(e,t){if((new Date).getTime()-(this.lastEditTimeForDoc.get(e)||0)<=J.syncTime)return!0;const n=await this.getFileHash(e)===t;return this.checkFuzzyDesync(e,n),n}async checkSync(){if(this.shouldCheckSync){if(this.activeDocument){const e=this.pathManager.localPathToRelativePath(this.activeDocument.uri);if(e){if((new Date).getTime()-(this.lastEditTimeForDoc.get(e)||0)>J.syncTime)try{const t=(new Date).getTime(),n=await this.syncService.checkSyncAsync(e,g.calculateFileHash(g.removeLineEndings(this.activeDocument.getText()))),i=(new Date).getTime()-t>J.slowSyncCheckTime;i&&(this.slowSyncCheckCount++,b.CoauthoringTelemetry.ReportSlowSyncCheck()),this.syncCheckCount++,b.CoauthoringTelemetry.ReportSyncCheck(),n?this.checkFuzzyDesync(e,n):i||(this.failedSyncCheckCount++,this.checkFuzzyDesync(e,n))}catch(e){if(e.code===R.RpcErrorCodes.ServiceNotAvailable)return void(this.shouldCheckSync=!1);this.coEditingTrace.error("Failed to check sync status")}}}setTimeout(()=>this.checkSync(),J.syncTime)}}async checkSyncForVersion(e,t,n,i){if(this.shouldCheckSyncForVersion)try{const s=await this.syncService.checkSyncForVersion2Async(e,t,n,i);b.CoauthoringTelemetry.ReportSyncCheckForVersion(!0),k.assert(s.isSynced,"File should be in sync on guest")}catch(e){e.code!==R.RpcErrorCodes.ServiceNotAvailable&&e.code!==R.RpcErrorCodes.MethodNotFound||(this.shouldCheckSyncForVersion=!1),this.coEditingTrace.error("Failed to check sync for version.")}}async isFileSyncedForVersion(e,t,n,i){b.CoauthoringTelemetry.ReportSyncCheckForVersion(!1);const s=this.getSharedFileClient(e);if(!e||!s)return k.assert(!1,"Host should have a file client for file guest is trying to check sync of"),Promise.resolve({isSynced:!1,fileVersion:0});let r=!0;return void 0!==t&&s.version!==t||(r=await s.isFileSyncedForVersion(n,i),k.assert(r,"File should be in sync on host")),{isSynced:r,fileVersion:s.version}}getCoeditingInformation(){return i.window.visibleTextEditors.map(e=>e.document).filter(e=>e.uri.scheme!==U.PathManager.outputScheme).map(e=>this.getCoeditingInformationForDocument(e)).join("\n\n")}getCoeditingInformationForDocument(e){const t=this.pathManager.localPathToRelativePath(e.uri),n=this.getSharedFileClient(t);let i=`Document URI: ${e.uri.toString()}\nRelative path: ${t}\nHas file client: ${!!n}`;if(n){const t=e.getText()===n.getBufferContent(),s=n.getBufferManagerStatus();delete s.collabBufferText,i+=`\nBuffer contents match document contents: ${t}\nBuffer manager status: ${JSON.stringify(s,null,2)}`}return i}async copyCoeditingInformationToClipboard(){const e=this.getCoeditingInformation();await(new B.ClipboardUtil).copyToClipboardAsync(e),i.window.showInformationMessage(P.localize("notification.CoeditingInformationCopiedToClipboard"))}async resetFileClient(e){if(!this.isHost)return;if(!this.getSharedFileClient(e))return;let t;try{t=await this.pathManager.openRelativePath(e)}catch(e){return void k.assert(!1,"Should be able to open document that is being reset")}const n=this.createSharedFileClient(e,t.getText(),t.isDirty,void 0,t.languageId,!0);this.postMessage(f.MessageFactory.ResetFileClientMessage(this.clientID,n.fileName))}}t.CoEditing=J,J.sendId=0,J.recentlyScrolledTimeout=250,J.syncTime=5e3,J.slowSyncCheckTime=1e4;class X{constructor(){this.listeningTo=new Set,this.changeEvents={},this.listener=i.workspace.onDidChangeTextDocument(e=>{const t=e.document.uri.toString();this.listeningTo.has(t)&&(this.changeEvents[t]=e,this.listeningTo.delete(t))})}dispose(){this.listener.dispose()}startListening(e){const t=e.toString();this.changeEvents[t]&&delete this.changeEvents[t],this.listeningTo.add(t)}stopListening(e){return this.changeEvents[e.toString()]}}class Z{constructor(e,t,n,s,r,o,a=0){this.client=e,this.wasDirty=o,this.lastLocalEdit=null,this.simultaneousEdits=0,this.lineDiffCount=0,this.lineDiffSum=0,this.visibleEdits=0,this.invisibleEdits=0,this.remoteEdits=0,this.localEdits=0,this.wasLastEditRemote=!1,this.isMarkedReadOnlyByOwner=!1,this.queueBehavior=m.CoeditingIncomingMessageBehavior.QueueAndProcess,this.editTransitionCounts=[0,0,0],this.currentFileName=t,this._version=a;const c=this,l=new class{constructor(){this.clientID=e.clientID,this.clientCount=10,this.trace=r}async applyEdit(s,r){var o,a;const l="string"==typeof r?e.getTrackedMessageData(r):void 0,u=new i.WorkspaceEdit;u.set(n,s),c.editMessageData=l,e.nextDocumentChangeListener.startListening(n),this.trace.verbose(`vscode.workspace.applyEdit for ${q(t)}: ${JSON.stringify(s.map(e=>({range:e.range,newText:e.newText.length,newEol:e.newEol})))}`);const d=await i.workspace.applyEdit(u);this.trace.verbose(`vscode.workspace.applyEdit result for ${q(t)}: ${d}`);const f=null===(o=e.nextDocumentChangeListener.stopListening(n))||void 0===o?void 0:o.contentChanges;return c.editMessageData=void 0,d&&l&&void 0!==l.receivedTime&&e.recordIntoBucket(r,G.ReceivedBucket,h.vsls.MessageType.TextChange),d?f&&function(e,t){if(e.length!==t.length)return!1;t=[...t];for(let n of e){const e=t.findIndex(e=>n.range.isEqual(e.range)&&n.newText===e.text);if(e<0)return!1;t.splice(e,1)}return!0}(s,f)?M.ApplyEditResult.SUCCESSFUL:(null===(a=O.getExpService())||void 0===a?void 0:a.getTreatmentVariable(F.TreatmentVariables.VSCodeConfig,F.TreatmentVariables.ResyncOnMisappliedEdit))?M.ApplyEditResult.MODIFIED:M.ApplyEditResult.SUCCESSFUL:M.ApplyEditResult.FAILED}resync(){return e.resyncDocument(n)}checkSync(e){b.CoauthoringTelemetry.ReportLocalSyncCheck();const s=i.workspace.textDocuments.filter(e=>n.toString()===e.uri.toString());if(k.assert(s.length>0,"Document should be open if performing sync check"),s.length>0){const n=s[0].getText();for(let e of s)k.assert(e.getText()===n,"All documents for the same file should have the same text");k.assert(n===e,"Buffer contents - with line endings - should match VS Code document text",void 0,t),k.assert(g.removeLineEndings(n)===g.removeLineEndings(e),"Buffer contents should match VS Code document text",void 0,t)}}checkHostSync(n,i){e.checkSyncForVersion(t,a,n,i)}postMessage(t){f.IsFileContentMessage(t)&&(t.fileVersion=a),e.postMessage(t)}updateClientPosition(t){e.updateCoEditorPosition(t)}async undoBufferToMatchContents(e){const t=i.window.activeTextEditor;if(!t)return"";let n=t.document;const s=n.getText();return await K("undo",e,n,this.trace),s}async redoUntilNoMoreToRedo(t,n){const s=i.window.activeTextEditor;if(!s)return;const r=s.document,o=r.uri.toString(),a=i.workspace.onDidChangeTextDocument(t=>{t=Object.assign({},t),e.trackMessage(t),t.document.uri.toString()===o&&n(t)});await K("redo",t,r,this.trace),a.dispose()}performSingleUndo(){const e=i.window.activeTextEditor;if(!e)return Promise.resolve({edits:[],contents:""});const t=e.document;return new Promise(e=>{const n=[],s=t.uri;let r=i.workspace.onDidChangeTextDocument(e=>{e.document.uri.toString()===s.toString()&&n.push(...e.contentChanges)});i.commands.executeCommand("default:undo",null).then(()=>{e({edits:n,contents:t.getText()}),r.dispose()})})}performSingleRedo(){const e=i.window.activeTextEditor;if(!e)return Promise.resolve("");const t=e.document;return new Promise(e=>{i.commands.executeCommand("default:redo",null).then(()=>{e(t.getText())})})}};this.bufferManager=new m.VSCodeBufferManager(l,t,s,e.isHost)}get version(){return this._version}queueMessages(){this.queueBehavior=m.CoeditingIncomingMessageBehavior.Queue}processMessages(){this.queueBehavior!==m.CoeditingIncomingMessageBehavior.QueueAndProcess&&(this.queueBehavior=m.CoeditingIncomingMessageBehavior.QueueAndProcess,this.drainMessageQueue())}clearLocalChangesQueue(){this.bufferManager.clearLocalChangesQueue()}onDidChangeTextDocument(e){if(!this.isMarkedReadOnlyByOwner)return this.updateEditTelemetry(e,this.waitingForRemoteEditsToBeApplied()),this.bufferManager.onDidChangeTextDocument(e),this.editMessageData}onDidChangeTextEditorSelection(e,t,n,i,s){this.isMarkedReadOnlyByOwner||this.bufferManager.onDidChangeTextEditorSelection(e,t,n,i,s)}onDidChangeTextEditorVisibleRange(e,t,n,i){this.bufferManager.onDidChangeTextEditorVisibleRanges(e,this.version,t,n,i)}getEditorVisibleRanges(e){return this.bufferManager.getEditorVisibleRanges(e)}transformVisibleRanges(e,t){return this.bufferManager.transformVisibleRangesToCurrent(e,t)}onIncomingMessage(e,t,n,i){"number"==typeof n&&this.version!==n||this.bufferManager.onIncomingMessage(e,t,i||this.queueBehavior)}isFileSyncedForVersion(e,t){return this.bufferManager.isFileSyncedForVersion(e,t)}onHandshake(e){this.bufferManager.onHandshake(e)}getBufferManagerStatus(){return this.bufferManager.getBufferManagerStatus()}waitingForRemoteEditsToBeApplied(){return this.bufferManager.getBufferManagerStatus().waitingForRemoteEditsToBeApplied}getBufferContent(){return this.bufferManager.getBufferManagerStatus().collabBufferText}updateDirtyState(e){let t=!1;return this.wasDirty||e||(t=!0),this.wasDirty=e,t}takeSnapshot(){this.bufferManager.takeSnapshot()}getSavedSnapshotOrFallback(e){return this.bufferManager.getSavedSnapshotOrFallback(e)}getCurrentHistory(){return this.bufferManager.getCurrentHistory()}undoLastLocalEdit(){return this.bufferManager.undoLastLocalEdit()}redoLastLocalEdit(){return this.bufferManager.redoLastLocalEdit()}clearUndoStateDueToDocumentClosing(){this.bufferManager.clearUndoStateDueToDocumentClosing()}get fileName(){return this.currentFileName}updateFileName(e){this.currentFileName=e,this.bufferManager.updateFileName(this.currentFileName)}initializeHistory(e){this.bufferManager.initializeHistory(e),this.isMarkedReadOnlyByOwner=e.isReadOnly||!1}updateInitialHistoryHighWatermark(e){this.bufferManager.updateInitialHistoryHighWatermark(e)}drainMessageQueue(){this.bufferManager.processQueuedMessages()}transformScrollSelectionToCurrent(e){return void 0!==e.fileVersion&&this.version!==e.fileVersion?null:this.bufferManager.transformScrollSelectionToCurrent(e)}toVSCodeDocumentPos(e){return this.bufferManager.toVSCodeDocumentPos(e)}vslsRangeToVSCodeRange(e){const t=this.toVSCodeDocumentPos(e.start),n=this.toVSCodeDocumentPos(e.start+e.length);return new i.Range(t,n)}dispose(){b.CoauthoringTelemetry.BufferClosed(this.languageId||"",this.localEdits,this.remoteEdits,this.editTransitionCounts,this.bufferManager.numberOfLocalUndos,this.bufferManager.numberOfRemoteUndos,0,0,this.simultaneousEdits,this.lineDiffCount,this.lineDiffSum,this.visibleEdits,this.invisibleEdits)}setLanguageId(e){this.languageId=e}updateEditTelemetry(e,t){if(t?this.remoteEdits+=1:(this.localEdits+=1,this.lastLocalEdit=e),this.wasLastEditRemote===t)return;if(this.wasLastEditRemote=t,this.remoteEdits+this.localEdits===1)return;const n=this.timeOfLastEdit,i=(this.timeOfLastEdit=Date.now())-n;i>Z.slowEditTransitionTime?this.editTransitionCounts[2]+=1:i<Z.quickEditTransitionTime?this.editTransitionCounts[0]+=1:this.editTransitionCounts[1]+=1,t&&i<Z.slowEditTransitionTime&&this.updateSimultaneousEditingTelemetry(e)}updateSimultaneousEditingTelemetry(e){this.simultaneousEdits++;const t=Z.getDocumentChangeLineDiff(this.lastLocalEdit,e);void 0!==t&&(this.lineDiffCount++,this.lineDiffSum+=t);const n=Z.isDocumentChangeVisible(e);!0===n?this.visibleEdits++:!1===n&&this.invisibleEdits++}static getDocumentChangeLineDiff(e,t){if(e&&1===e.contentChanges.length&&1===t.contentChanges.length){let n=e.contentChanges[0].range,i=t.contentChanges[0].range;return n.start.line<=i.start.line?i.start.line-n.end.line:n.start.line-i.end.line}}static isDocumentChangeVisible(e){if(1!==e.contentChanges.length)return;const t=i.window.activeTextEditor;if(!t||e.document!==t.document)return!1;for(let n of t.visibleRanges)if(n.contains(e.contentChanges[0].range))return!0;return!1}}t.ClientFileData=Z,Z.quickEditTransitionTime=1e3,Z.slowEditTransitionTime=5e3}).call(this,n(57).setImmediate)},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0;var r=function(e){function t(){return e.call(this,1)||this}return s(t,e),t}(n(417).default);t.Lock=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);class s{}t.ActivityType=s,s.session="session",s.workspace="workspace",s.debug="debug",s.terminal="terminal";class r{constructor(){this.activityEmitter=new i.EventEmitter}get onActivity(){return this.activityEmitter.event}fire(e){this.activityEmitter.fire(e)}}t.ActivitySource=r,t.activitySource=new r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(958),r=n(166),o=n(42),a=n(168);class c{constructor(e,t,n){this.textEditor=e,this.coediting=t,this.collaboratorManager=n,this.disposables=[],this.updateDecorator(),this.disposables.push(this.coediting.onPin(()=>this.updateDecorator())),this.disposables.push(this.coediting.onUnpin(()=>this.updateDecorator()))}createTextEditorLabelDecorator(){const e=this.getClientName(this.followedClientId),t=r.SharedColors.requestColor(this.followedClientId);this.textEditorLabelDecorator=new s.TextEditorLabelDecorator(this.textEditor,`Following ${e}`,r.DecoratorUtils.toCssColor(t.backgroundColor),r.DecoratorUtils.toCssColor(t.textColor))}updateDecorator(){var e;this.updateFollowedClient()&&(this.textEditorLabelDecorator&&this.removeTextEditorLabelDecorator(),void 0!==this.followedClientId&&(this.textEditorLabelDecorator||(null===(e=o.getExpService())||void 0===e?void 0:e.getTreatmentVariable(a.TreatmentVariables.VSCodeConfig,a.TreatmentVariables.FollowIndicator))&&this.createTextEditorLabelDecorator()))}removeTextEditorLabelDecorator(){var e;null===(e=this.textEditorLabelDecorator)||void 0===e||e.dispose(),this.textEditorLabelDecorator=void 0}dispose(){this.disposables.forEach(e=>e.dispose()),this.removeTextEditorLabelDecorator()}updateFollowedClient(){const e=this.followedClientId;return this.followedClientId=this.coediting.getClientIdIfEditorIsPinned(this.textEditor),this.followedClientId<0&&(this.followedClientId=void 0),e!==this.followedClientId}getClientName(e){const t=this.collaboratorManager.getCollaborators()[e];return(null==t?void 0:t.name)||(null==t?void 0:t.userName)||(null==t?void 0:t.email)}}t.FollowingLabelDecoratorManager=class{constructor(e,t){this.coediting=e,this.collaboratorManager=t,this.followingLabelDecorators=new Map,this.disposables=[],this.updateFollowingLabelDecorators(),this.disposables.push(i.window.onDidChangeVisibleTextEditors(()=>this.updateFollowingLabelDecorators()))}updateFollowingLabelDecorators(){const e=Array.from(this.followingLabelDecorators.keys());e.filter(e=>i.window.visibleTextEditors.indexOf(e)<0).forEach(e=>{const t=this.followingLabelDecorators.get(e);this.followingLabelDecorators.delete(e),t.dispose()}),i.window.visibleTextEditors.filter(t=>e.indexOf(t)<0).forEach(e=>{this.followingLabelDecorators.set(e,new c(e,this.coediting,this.collaboratorManager))})}dispose(){for(let e of this.followingLabelDecorators.values())e.dispose();this.disposables.forEach(e=>e.dispose())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(166),r=new i.ThemeColor("statusBar.foreground"),o=new i.ThemeColor("statusBar.background");t.TextEditorLabelDecorator=class{constructor(e,t,n,s){this.textEditor=e,this.label=t,this.backgroundColor=n,this.textColor=s,this.disposables=[],this.setInitialLongestLine(),this.createDecoration(),this.render(),this.disposables.push(i.window.onDidChangeTextEditorVisibleRanges(e=>{e.textEditor===this.textEditor&&this.render()})),this.disposables.push(i.workspace.onDidChangeTextDocument(e=>{if(e.document.uri.toString()!==this.textEditor.document.uri.toString())return;const t=this.longestLine;e.contentChanges.forEach(e=>{for(let t=e.range.start.line;t<=e.range.end.line;t++)this.updateLongestLine(t)}),this.longestLine!==t&&(this.createDecoration(),this.render())}))}createDecoration(){this.decoration&&this.decoration.dispose(),this.decoration=function(e,t,n,a){const c=s.DecoratorUtils.stringifyCssProperties({"--scroll-signal":`calc(max(100%, ${t+15}ch) - 100%)`,"--amplified-scroll-signal":"calc(1000000000*var(--scroll-signal))","--right-for-scroll":"calc(100% - 50vw)","--right":"min(var(--amplified-scroll-signal), var(--right-for-scroll))",position:"absolute",padding:"0ch 4ch 0ch 4ch","border-radius":".5ch",top:"0ch",right:"var(--right)","pointer-events":"none","z-index":1}),l={rangeBehavior:i.DecorationRangeBehavior.ClosedClosed,after:{contentText:e,textDecoration:`none; ${c}`,backgroundColor:n||o,color:a||r}};return i.window.createTextEditorDecorationType(l)}(this.label,this.longestLine,this.backgroundColor,this.textColor),this.disposables.push(this.decoration)}setInitialLongestLine(){this.longestLine=0;for(let e=0;e<this.textEditor.document.lineCount;e++)this.updateLongestLine(e)}updateLongestLine(e){this.longestLine=Math.max(this.longestLine,this.textEditor.document.lineAt(e).text.replace(/\t/g,"    ").length)}render(){const e=Math.min(...this.textEditor.visibleRanges.map(e=>e.start.line)),t=new i.Position(e,0),n=new i.Range(t,t);this.textEditor.setDecorations(this.decoration,[n])}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(24);class r{constructor(){this.coEditorSwitchedFileEventName="coEditorSwitchedFile",this.namedPositionsChangedEventName="namedPositionsChanged",this.namedPositionsChanged=new s.EventEmitter,this.namedPositions={},this.clientPositions={},this.coEditorSwitchedFileEvent=new s.EventEmitter}dispose(){this.coEditorSwitchedFileEvent.removeAllListeners(),this.namedPositionsChanged.removeAllListeners(),this.namedPositions={}}onCoEditorSwitchedFile(e){this.coEditorSwitchedFileEvent.addListener(this.coEditorSwitchedFileEventName,e)}onNamedPositionsChanged(e){this.namedPositionsChanged.addListener(this.namedPositionsChangedEventName,e)}setClientPosition(e,t,n,i,s){var o;const a=this.getClientPosition(e),c=r.createPosition(t,n,i,s);this.clientPositions[e]=a||{},this.clientPositions[e].documentPosition=c,(null===(o=null==a?void 0:a.notebookPosition)||void 0===o?void 0:o.documentUri.path)!==n.uri.path&&(this.clientPositions[e].notebookPosition=void 0),r.isDifferentPosition(null==a?void 0:a.documentPosition,c)&&this.coEditorSwitchedFileEvent.emit(this.coEditorSwitchedFileEventName,e,t)}setNotebookPosition(e,t,n,i,s,o){var a;const c=this.getClientPosition(e),l=r.createNotebookPosition(t,n,i);this.clientPositions[e]=c||{},this.clientPositions[e].notebookPosition=l,(null===(a=null==c?void 0:c.documentPosition)||void 0===a?void 0:a.documentUri.path)!==n.uri.path&&(this.clientPositions[e].documentPosition=void 0)}setNamedPosition(e,t,n,i,s){const o=this.getNamedPosition(e),a=Object.assign({name:e},r.createPosition(t,n,i,s));this.namedPositions[e]=a,r.isDifferentPosition(o,a)&&this.namedPositionsChanged.emit(this.namedPositionsChangedEventName,[a])}static createPosition(e,t,n,i){return{fileName:e,documentUri:t.uri,range:n,isReversed:i,startOffset:t.offsetAt(n.start),endOffset:t.offsetAt(n.end)}}static createNotebookPosition(e,t,n){return{fileName:e,documentUri:t.uri,range:n}}static isDifferentPosition(e,t){return e!==t&&(!e||!t||e.fileName!==t.fileName||e.range.start!==t.range.start||e.range.end!==t.range.end)}onDidChangeTextDocument(e,t){const n=t.document;Object.keys(this.clientPositions).forEach(i=>{var s;const o=null===(s=this.clientPositions[i])||void 0===s?void 0:s.documentPosition;if(o&&o.fileName===e){let e=o;t.contentChanges.forEach(t=>{e=r.trackForSingleEdit(e,n,t)}),this.clientPositions[i]={notebookPosition:this.clientPositions[i].notebookPosition,documentPosition:e}}});const i=[];Object.keys(this.namedPositions).forEach(s=>{const o=this.namedPositions[s];if(o&&o.fileName===e){let e=o;t.contentChanges.forEach(t=>{e=r.trackForSingleEdit(e,n,t)});const a=Object.assign({name:o.name},e);this.namedPositions[s]=a,r.isDifferentPosition(o,a)&&i.push(a)}}),i.length&&this.namedPositionsChanged.emit(this.namedPositionsChangedEventName,i)}getClientPosition(e){return this.clientPositions[e]}getNamedPosition(e){return this.namedPositions[e]}static trackForSingleEdit(e,t,n){const s=r.translateOffset(e.range.start,e.startOffset,t,n),o=r.translateOffset(e.range.end,e.endOffset,t,n),a=Object.assign({},e),c=t.positionAt(s),l=t.positionAt(o),u=new i.Range(c,l);return a.startOffset=s,a.endOffset=o,a.range=u,a}static translateOffset(e,t,n,i){if(i.range.start.isAfter(e))return t;if(i.range.end.isBeforeOrEqual(e)){return t+(i.text.length-i.rangeLength)}return n.offsetAt(i.range.start)+i.text.length}}t.PositionTracker=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(50),s=n(24);class r extends s.EventEmitter{constructor(e){super(),this.onDiffViewOpenEventName="onDiffViewOpen",this.onDiffViewClosedEventName="onDiffViewClosed",this.onNewGitDocumentEventName="onNewGitDocument",this.currentVisibleDiffViews={},this.pathManager=e}saveDiffViewInformation(e,t,n){if(t&&n){let i={leftFile:t,rightFile:n},s=this.currentVisibleDiffViews[e];s||(s=[],this.currentVisibleDiffViews[e]=s),s.push(i)}}findDiffViewInformation(e,t){let n=this.currentVisibleDiffViews[e];return n?n.find(e=>t.toString()===e.leftFile.toString()||t.toString()===e.rightFile.toString()):null}removeDiffViewInformation(e,t,n){let i=this.currentVisibleDiffViews[e];i&&(i=i.filter(e=>t.toString()!==e.leftFile.toString()||n.toString()!==e.rightFile.toString()),this.currentVisibleDiffViews[e]=i)}notifyDiffViewsClosed(e,t){let n=this.currentVisibleDiffViews[e];n&&(n=n.filter(e=>{if(t.filter(t=>{var n,i,s,r;return void 0===t.viewColumn&&(e.leftFile.toString()===(null===(i=null===(n=t.document)||void 0===n?void 0:n.uri)||void 0===i?void 0:i.toString())||e.rightFile.toString()===(null===(r=null===(s=t.document)||void 0===s?void 0:s.uri)||void 0===r?void 0:r.toString()))}).length>=2)return!0;{let t=this.pathManager.localPathToRelativePath(e.leftFile),n=this.pathManager.localPathToRelativePath(e.rightFile);return this.emit(this.onDiffViewClosedEventName,t,n),!1}}),this.currentVisibleDiffViews[e]=n)}onHostEditorsChanged(e,t){let n=e.filter(e=>{var t,n;return void 0===e.viewColumn&&[i.PathManager.fileScheme,i.PathManager.gitScheme].includes(null===(n=null===(t=null==e?void 0:e.document)||void 0===t?void 0:t.uri)||void 0===n?void 0:n.scheme)});if(n.length>=2)for(var s=0;s<n.length;s++)for(var r=s+1;r<n.length;r++){var o=n[s],a=n[r];if(o.document.uri.fsPath===a.document.uri.fsPath){let e=this.pathManager.localPathToRelativePath(o.document.uri),n=this.pathManager.localPathToRelativePath(a.document.uri);e&&n&&(this.saveDiffViewInformation(t,o.document.uri,a.document.uri),this.emit(this.onDiffViewOpenEventName,e,n))}}}onGuestEditorsChanged(e,t){let n=e.filter(e=>{var t,n;return void 0===e.viewColumn&&[i.PathManager.vslsSccScheme,i.PathManager.rawScheme].includes(null===(n=null===(t=null==e?void 0:e.document)||void 0===t?void 0:t.uri)||void 0===n?void 0:n.scheme)});if(n.length>=2)for(var s=0;s<n.length;s++)for(var r=s+1;r<n.length;r++){var o=n[s].document.uri,a=n[r].document.uri,c=this.getRawUriFromGuestEditorUri(o),l=this.getRawUriFromGuestEditorUri(a);if(c.toString()===l.toString()){let e=this.pathManager.localPathToRelativePath(o),n=this.pathManager.localPathToRelativePath(a);this.saveDiffViewInformation(t,o,a),this.emit(this.onDiffViewOpenEventName,e,n)}}}initGuestGitDocuments(e){e.filter(e=>{var t,n;return(null===(n=null===(t=null==e?void 0:e.document)||void 0===t?void 0:t.uri)||void 0===n?void 0:n.scheme)===i.PathManager.vslsSccScheme}).forEach(e=>{this.emit(this.onNewGitDocumentEventName,e.document)})}onEditorsChanged(e,t,n){e.length>=2&&(t?this.onHostEditorsChanged(e,n):(this.onGuestEditorsChanged(e,n),this.initGuestGitDocuments(e))),this.notifyDiffViewsClosed(n,e)}onDidOpenDiffView(e){this.addListener(this.onDiffViewOpenEventName,e)}onDidCloseDiffView(e){this.addListener(this.onDiffViewClosedEventName,e)}onDidOpenNewGitDocument(e){this.addListener(this.onNewGitDocumentEventName,e)}dispose(){return this.removeAllListeners(),Promise.resolve()}getRawUriFromGuestEditorUri(e){return e.scheme===i.PathManager.vslsSccScheme?this.pathManager.resourceUriFromLiveShareSourceControlUri(e):e}}t.DiffView=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(42),s=n(22),r=n(24),o=n(13),a=n(15);t.PresentationManager=class{constructor(e,t){this.onPresenterUpdate=new r.EventEmitter,this.isPresentationModeExperimentEnabled=!1,this.presenterId=e,this.presentationMode=t;const n=i.getExpService();null==n||n.isCachedFlightEnabled("strictFollow").then(e=>{this.isPresentationModeExperimentEnabled=e}),s.ExtensionUtil.setCommandContext("liveshare:isPresentation",this.presentationMode)}get currentPresenterId(){return this.presenterId}get isStrictFollowEnabled(){const e=o.Settings.get(a.SettingKeys.alwaysFollowHost);return this.isPresentationModeExperimentEnabled&&(e||this.presentationMode)}updatePresenterId(e){this.presenterId!=e&&(this.presenterId=e,this.onPresenterUpdate.emit("onPresenterUpdate"))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);t.clipboard={writeAsync:async e=>{await i.env.clipboard.writeText(e)},readAsync:async()=>await i.env.clipboard.readText()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(5),r=n(69),o=n(31),a=n(29),c=n(42);t.CollaboratorManager=class{constructor(e,t){this.sessionContext=e,this.userIdBySessionIdHistory={},this.coEditorsHistory={},this.coEditors={},this.coEditorsIDE={},this.coEditorCount=0,this.profiles={},this.profileByUserIdHistory={},this.profileByUserId={},this.collaboratorChangedEmitter=new i.EventEmitter,this.onCollaboratorChanged=this.collaboratorChangedEmitter.event,this.collaboratorsJoinedEmitter=new i.EventEmitter,this.onCollaboratorsJoined=this.collaboratorsJoinedEmitter.event,this.localUserInfo=o.userAuthStateTracker.userInfo,this.profiles=t||{};for(let e of Object.keys(t)){const n=t[e];this.userIdBySessionIdHistory[e]=n.id}}onWorkspaceSessionChanged(e){const t=!!this.profileByUserIdHistory[e.userProfile.id],n=this.localUserInfo.id===e.userProfile.id,i=!!this.sessionContext.hasCollaborators;e.changeType===s.vsls.WorkspaceSessionChangeType.Joined?(this.profiles[e.sessionNumber]=e.userProfile,this.userIdBySessionIdHistory[e.sessionNumber]=e.userProfile.id,this.profileByUserIdHistory[e.userProfile.id]=e.userProfile,this.profileByUserId[e.userProfile.id]=e.userProfile,this.coEditorsIDE[e.sessionNumber]=e.applicationName):e.changeType===s.vsls.WorkspaceSessionChangeType.Unjoined&&(delete this.coEditors[e.sessionNumber],delete this.profiles[e.sessionNumber],delete this.profileByUserId[e.userProfile.id],this.coEditorCount>0&&--this.coEditorCount),this.coEditorCount<=0&&(this.sessionContext.hasCollaborators=!1),this.collaboratorChangedEmitter.fire({userProfile:e.userProfile,changeType:e.changeType,applicationName:e.applicationName,disconnectedReason:e.disconnectedReason,sessionNumber:e.sessionNumber,collaboratorSessionHash:this.getProfileIndex(e.userProfile.id),previouslyJoined:t,isHost:n,hasCollaborators:i})}getDisplayName(e){const t=this.profiles[e],n=a.workspaceSessionInfoTracker.getAnonymousAccess(t.id)===a.AnonymousAccessLevel.readWrite;return t?t.isAnonymous?this.isReadWriteAnonymousEnabled()&&n?`${t.name} (${r.READ_WRITE_LABEL})`:`${t.name} (${r.READ_ONLY_LABEL})`:t.name||t.userName||t.email:this.sessionContext.coeditingClient&&e===this.sessionContext.coeditingClient.clientID?this.localUserInfo.displayName||this.localUserInfo.emailAddress:`Collaborator ${e}`}isReadWriteAnonymousEnabled(){var e;return null===(e=c.getExpService())||void 0===e?void 0:e.getTreatmentVariable("vscode","readWriteAnonymous")}getUserId(e){const t=this.profiles[e];return t&&t.id}getEmailOrUsername(e){const t=this.profiles[e];if(t)return t.email||t.userName||""}getProfileIndex(e){return Object.keys(this.profileByUserIdHistory).findIndex(t=>t===e)}getIDEs(){return new Set(this.getCollaboratorSessionIds().map(e=>this.coEditorsIDE[e]))}getCollaboratorCount(){return this.coEditorCount}getCollaboratorCountByIDE(e){return this.getCollaboratorEmailsOrUsernamesByIDE(e).length}getDistinctCollaboratorCount(){return new Set(this.getCollaboratorEmailsOrUsernames()).size}getDistinctCollaboratorCountByIDE(e){return new Set(this.getCollaboratorEmailsOrUsernamesByIDE(e).filter(e=>e!==this.localUserInfo.emailAddress&&e!==this.localUserInfo.userName)).size}getCollaboratorSessionIds(){return Object.keys(this.coEditors).map(e=>parseInt(e,10))}getCollaboratorEmailsOrUsernames(){return this.getCollaboratorSessionIds().map(e=>this.getEmailOrUsername(e))}getCollaboratorEmailsOrUsernamesByIDE(e){return this.getCollaboratorSessionIds().filter(t=>this.coEditorsIDE[t]===e).map(e=>this.getEmailOrUsername(e))}coEditorsJoined(e){e.forEach(e=>{e!==this.sessionContext.coeditingClient.clientID&&(this.coEditorsHistory[e]=!0,this.coEditors[e]=!0,++this.coEditorCount)}),this.coEditorCount>0&&(this.sessionContext.hasCollaborators=!0),this.collaboratorsJoinedEmitter.fire()}wasCoEditor(e){return void 0!==this.coEditorsHistory[e]}getCollaborators(){return Object.assign({},this.profiles)}dispose(){this.collaboratorChangedEmitter.dispose(),this.collaboratorsJoinedEmitter.dispose(),this.sessionContext.hasCollaborators=!1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(9);t.CollaboratorsTelemetry=class{static endSession(){this.activeEvent&&this.activeEvent.end(i.TelemetryResult.Success)}static resetActiveEvent(e){this.activeEvent=i.Telemetry.startTimedEvent(s.HAS_COLLABORATORS_CHANGED),this.activeEvent.addProperty(r.HAS_COLLABORATORS,e)}static sendChangeCollaboratorsEvent(e){i.Telemetry.sendTelemetryEvent(s.COLLABORATORS_CHANGED,{[r.HAS_COLLABORATORS]:e.hasCollaborators.toString(),[r.COLLABORATOR_SESSION_HASH]:e.collaboratorSessionHash.toString(),[r.PREVIOUSLY_JOINED]:e.previouslyJoined.toString(),[r.IS_HOST]:e.isHost.toString(),[r.CHANGE_TYPE]:e.changeType.toString(),[r.APPLICATION_NAME]:e.applicationName,[r.DISCONNECTED_REASON]:e.disconnectedReason&&e.disconnectedReason.toString()||""})}};class s{}s.HAS_COLLABORATORS_CHANGED="change-hascollaborators",s.COLLABORATORS_CHANGED="change-collaborators";class r{}r.HAS_COLLABORATORS=i.TelemetryPropertyNames.FEATURE_NAME+"HasCollaborators",r.COLLABORATOR_SESSION_HASH=i.TelemetryPropertyNames.FEATURE_NAME+"CollaboratorSessionHash",r.PREVIOUSLY_JOINED=i.TelemetryPropertyNames.FEATURE_NAME+"PreviouslyJoined",r.IS_HOST=i.TelemetryPropertyNames.FEATURE_NAME+"IsHost",r.CHANGE_TYPE=i.TelemetryPropertyNames.FEATURE_NAME+"ChangeType",r.APPLICATION_NAME=i.TelemetryPropertyNames.FEATURE_NAME+"ApplicationName",r.DISCONNECTED_REASON=i.TelemetryPropertyNames.FEATURE_NAME+"DisconnectedReason"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ContextUtil=class{scrubPrefix(e){return e?e.replace("liveshare.",""):e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(67),r=n(7),o=n(5),a=n(21),c=n(23),l=n(31),u=n(22),d=n(13),h=n(15),f=n(26);class p{constructor(e,t,n){this.contextUtil=e,this.workspaceService=t,this.trace=n}async create(e,t,n){const o=p.correlationIndex++;this.trace.info(`Progress notifier opened: ${o}.`);const l=s.gte(s.coerce(i.version),"1.22.0")?i.ProgressLocation.Notification:i.ProgressLocation.Window;return await r.NotificationUtil.withProgress({title:f.localize("notification.ProgressNotifiers").replace("$(options.title)",e.title),cancellable:!0,location:l},async(e,i)=>{const s=d.Settings.get(h.SettingKeys.diagnosticLogging),r=t=>{const n=this.generateMessage(t.newStatus);e.report({message:n})},l=c.sessionStateTracker.onStateChanged(t=>{const n=this.generateMessage(a.SessionState[t.newState]);e.report({message:n})});let u;s&&(u=c.sessionStateTracker.onStatusChanged(r));const f=()=>{l&&l.dispose(),u&&u.dispose()};i&&i.onCancellationRequested(()=>{this.trace.info(`Progress notifier cancelled: ${o}.`),f()}),t&&t.onCancellationRequested(()=>{this.trace.info(`Progress notifier cancelled by command: ${o}.`),f()}),this.workspaceService.onProgressUpdated(this.onWorkspaceProgressUpdated.bind(this,e));const p=await n(i);return this.trace.info(`Progress notifier finished: ${o}.`),f(),p})}onWorkspaceProgressUpdated(e,t){switch(t.progress){case o.vsls.WorkspaceProgress.WaitingForHost:{const n=u.ExtensionUtil.getWaitingForHostProgressUpdateString(t.progress,l.userAuthStateTracker.userInfo);e.report({message:n});break}case o.vsls.WorkspaceProgress.OpeningRemoteSession:case o.vsls.WorkspaceProgress.JoiningRemoteSession:e.report({message:u.ExtensionUtil.getProgressUpdateString(t.progress)})}}generateMessage(e){return e===a.SessionState[a.SessionState.ExternallySigningIn]?"Sign in to proceed.":e!==a.SessionState[a.SessionState.SharingInProgress]&&e!==a.SessionState[a.SessionState.JoiningInProgress]?e?this.contextUtil.scrubPrefix(e).match(p.statusTextGeneratorRegex).slice(0,-1).join(" "):e:void 0}}t.ProgressNotifierUtil=p,p.statusTextGeneratorRegex=/([A-Z]?[^A-Z]*)/g,p.correlationIndex=0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(33);t.CommandContextBuilder=class{constructor(e){this.trace=e}build(e,t,n){return{trace:this.trace.withName(n||this.buildTrace(e,t)),commandText:t,commandName:""}}buildTrace(e,t){let n="";return(e=i.DecoratorHelper.getCoreCommand(e))&&e.constructor&&e.constructor.name&&(n=e.constructor.name,n=n.replace("CommandDecorator","")),`Command:${"Object"===n?t:n}`}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(130);t.MetaProfilingCommandDecorator=class{constructor(e,t){this.command=e,this.next=t,this.friendlyName=(this.next&&this.next.constructor&&this.next.constructor.name).replace("CommandDecorator","")}async invoke(e,t){let n=void 0,s=!1;i.TimeTracker.start(this.friendlyName,"Decorator:"),t.trace.info(`Decorator: ${this.friendlyName} Starting`);try{n=await this.next.invoke(e,t)}catch(e){throw s=!0,e}finally{const e=s?"Failed":"Success";i.TimeTracker.stop(this.friendlyName,"Decorator:",e),t.trace.info(`Decorator: ${this.friendlyName} Completed ${e}`)}return n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(9),r=n(16);t.CommandRegistryProvider=class{constructor(e,t,n){this.commandContextBuilder=e,this.telemetry=t,this.trace=n,this.disposables={}}register(e,t){this.disposables[e]=i.commands.registerCommand(e,async(n,i)=>{try{n=n||{};const s=t();return i=i||this.commandContextBuilder.build(s,e),await s.invoke(n,i)}catch(e){if(e&&!e.hasRecorded){const t=`Unhandled exception (command): ${e.message}`;this.trace.error(t),this.telemetry.sendFault(r.TelemetryEventNames.UNHANDLED_COMMAND_ERROR_FAULT,s.FaultType.Error,t,e)}}})}dispose(e){const t=this.disposables[e];t&&t.dispose()}disposeAll(){for(const e in this.disposables)e&&this.dispose(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6),s=n(7),r=n(23),o=n(21),a=n(16),c=n(96),l=n(240),u=n(31),d=n(69),h=n(26),f=n(9);t.AuthenticationFlow=class{constructor(e,t){this.authenticationProvider=e,this.trace=t}async attemptAuthenticationCheckFlow(e,t){const{cancellationTokenSource:n}=t,i=n&&n.token;let s,o=!1;r.sessionStateTracker.point(a.TelemetryPropertyNames.SIGNIN_CHECK_STARTING);try{o=await this.attemptAuthenticationCheckFlowCore(e,t)}catch(e){s=e}const c={successPoint:a.TelemetryPropertyNames.SIGNIN_CHECK_COMPLETED,cancelPoint:a.TelemetryPropertyNames.SIGNIN_CHECK_COMPLETED_CANCEL,errorPoint:a.TelemetryPropertyNames.SIGNIN_CHECK_COMPLETED_ERROR,neutralPoint:a.TelemetryPropertyNames.SIGNIN_CHECK_COMPLETED,telemetryEventName:a.TelemetryEventNames.AUTH_SILENT_CHECK,isAuthenticated:o,error:s,cancellationToken:i,allowsNeutralOutcome:!0,isNative:e.isNativeAuth};return await this.processAuthResult(c),o}async attemptPromptedUserLoginFlow(e,t){if(e&&e.shouldPromptForAuth){const e={title:"Launch Sign In"};t.telemetryEvent.addProperty(a.TelemetryPropertyNames.COMMAND_AUTH_PROMPT_OPENED,!0),r.sessionStateTracker.point(a.TelemetryPropertyNames.SIGNIN_PROMPT_STARTING);const n=await s.NotificationUtil.showInformationMessage(h.localize("notification.YouNeedToSignInBeforeJoin"),!1,{},e);if(r.sessionStateTracker.point(a.TelemetryPropertyNames.SIGNIN_PROMPT_COMPLETED),t.telemetryEvent.addProperty(a.TelemetryPropertyNames.COMMAND_AUTH_PROMPT_QUESTION_RESULT,n&&n.title),!(n&&n.title===e.title))throw new i.CancellationError("Operation cancelled @ sign in again.")}await this.attemptLoginFlow(e,t)}async attemptPromptedUserAnonymousLoginFlow(e,t){const{token:n}=t.cancellationTokenSource;if(!0===n.isCancellationRequested)throw t.telemetryEvent.addProperty(a.TelemetryPropertyNames.AUTH_CANCEL_ANONYMOUS_LOGIN_FLOW,!0),new i.CancellationError;const o=h.localize("generic.SignIn"),c=h.localize("generic.ContinueAsAnonymous");t.telemetryEvent.addProperty(a.TelemetryPropertyNames.COMMAND_AUTH_PROMPT_OPENED,!0),r.sessionStateTracker.point(a.TelemetryPropertyNames.SIGNIN_PROMPT_STARTING);const l=await s.NotificationUtil.showInformationMessage(h.localize("notification.SignIntoJoin"),!1,c,o);if(r.sessionStateTracker.point(a.TelemetryPropertyNames.SIGNIN_PROMPT_COMPLETED),t.telemetryEvent.addProperty(a.TelemetryPropertyNames.COMMAND_AUTH_PROMPT_QUESTION_RESULT,l),!l)throw t.telemetryEvent.addProperty(a.TelemetryPropertyNames.AUTH_CANCEL_NO_ANON_AUTH,!0),new i.CancellationError;if(l===c){t.telemetryEvent.addProperty(a.TelemetryPropertyNames.USER_OPTED_OUT_TO_AUTH_ON_JOIN,!0);const e=await this.authenticationProvider.askForUserName();return t.telemetryEvent.addProperty(a.TelemetryPropertyNames.USER_PICKED_NAME_LENGTH,e.length),t.telemetryEvent.addProperty(a.TelemetryPropertyNames.USER_PICKED_DEFAULT_NAME,e===d.DEFAULT_ANONYMOUS_USER_NAME),!!u.userAuthStateTracker.isCurrentUserAnonymous()||await this.attemptAnonymousLoginFlow(t)}return!1}async attemptAnonymousLoginFlow(e){const{cancellationTokenSource:t}=e;if(t&&t.token.isCancellationRequested)return;r.sessionStateTracker.point(a.TelemetryPropertyNames.SIGNIN_STARTING);const n=await this.authenticationProvider.attemptAnonymousLoginVSCodeAccount(void 0,t.token);return r.sessionStateTracker.point(a.TelemetryPropertyNames.SIGNIN_COMPLETED),n&&r.sessionStateTracker.transition(o.SessionAction.SignInSuccess),n}async attemptLoginFlow(e,t){const{cancellationTokenSource:n}=t,i=n&&n.token;let s,c=!1;r.sessionStateTracker.point(a.TelemetryPropertyNames.SIGNIN_STARTING);try{e.isNativeAuth?(r.sessionStateTracker.transition(o.SessionAction.AttemptSignIn),c=await this.authenticationProvider.attemptPromptedNativeLogin(t)):c=await this.attemptLoginFlowCoreBrowserVSCodeAccount(t)}catch(e){s=e}const l={successPoint:a.TelemetryPropertyNames.SIGNIN_COMPLETED,cancelPoint:a.TelemetryPropertyNames.SIGNIN_COMPLETED_CANCEL,errorPoint:a.TelemetryPropertyNames.SIGNIN_COMPLETED_ERROR,telemetryEventName:a.TelemetryEventNames.AUTH_PROMPTED_SIGNIN,isAuthenticated:c,error:s,cancellationToken:i,allowsNeutralOutcome:!1,isNative:e.isNativeAuth};await this.processAuthResult(l)}async processAuthResult(e){var t;let n=!1;try{if(e.isAuthenticated)return r.sessionStateTracker.point(e.successPoint),void r.sessionStateTracker.transition(o.SessionAction.SignInSuccess);if((null===(t=e.cancellationToken)||void 0===t?void 0:t.isCancellationRequested)||e.error instanceof i.CancellationError)throw r.sessionStateTracker.point(e.cancelPoint),r.sessionStateTracker.transition(o.SessionAction.SignInError),n=!0,e.error||new i.CancellationError;if(e.error||!e.allowsNeutralOutcome)throw r.sessionStateTracker.point(e.errorPoint),r.sessionStateTracker.transition(o.SessionAction.SignInError),e.error||new Error(h.localize("error.UnexpectedAuthenticationError"));r.sessionStateTracker.point(e.neutralPoint),r.sessionStateTracker.transition(o.SessionAction.SignOut)}finally{const t=new f.TelemetryEvent(e.telemetryEventName);t.addProperty(a.TelemetryPropertyNames.LOGIN_IS_NATIVE,e.isNative),t.addProperty(a.TelemetryPropertyNames.LOGIN_RESULT,e.isAuthenticated),t.addProperty(a.TelemetryPropertyNames.LOGIN_IS_CANCELED,n),t.send()}}async attemptAuthenticationCheckFlowCore(e,t){const{cancellationTokenSource:n}=t,i=n&&n.token;let s=this.authenticationProvider.isAuthenticated();return s||(r.sessionStateTracker.transition(o.SessionAction.AttemptSignIn),s=e.isNativeAuth?await this.authenticationProvider.attemptSilentNativeLogin(e,t):await this.authenticationProvider.attemptDefaultLoginVSCodeAccount(e,i)),s}async attemptLoginFlowCoreBrowserVSCodeAccount(e){const{cancellationTokenSource:t}=e,n=t&&t.token;r.sessionStateTracker.transition(o.SessionAction.AwaitExternalSignIn),r.sessionStateTracker.point(a.TelemetryPropertyNames.EXTERNAL_SIGNIN_STARTING);const s=await c.auth.API.askToSignIn({shouldSkipQuestion:!0,strategies:[c.auth.API.defaultStrategy,l.liveshareGithubStrategy]});if(e.telemetryEvent.addProperty(a.TelemetryPropertyNames.EXTERNAL_SIGNIN_USER_COMPLETE_FLOW_TOKEN_SET,!!s),r.sessionStateTracker.point(a.TelemetryPropertyNames.EXTERNAL_SIGNIN_USER_COMPLETE_FLOW),n.isCancellationRequested)throw r.sessionStateTracker.transition(o.SessionAction.SignOut),e.telemetryEvent.addProperty(a.TelemetryPropertyNames.AUTH_CANCEL_NO_TOKEN_USER_CANCELLED,!0),new i.CancellationError;if(!s)throw new i.CancellationError("Authentication incomplete.");return r.sessionStateTracker.point(a.TelemetryPropertyNames.EXTERNAL_SIGNIN_COMPLETE),r.sessionStateTracker.transition(o.SessionAction.AttemptSignIn),await this.authenticationProvider.attemptLoginVSCodeAccount(s,n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(972),s=n(419),r=n(422),o=n(171),a=n(990),c=n(991);t.activateInternal=async(e,t,n,a=[],c)=>(o.Constants.extensionName=t,r.keytarService.init(c),s.registeredStrategies.push(...a),new i.VSCodeLoginHelper(e,n).api),t.activate=async function(e){const n=await t.activateInternal(e,"ms-vsliveshare.vscode-account",new a.FakeTelemetryReporter);return new c.ProtocolHandler(n,e)},t.deactivate=function(){}},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(0)),r=n(0),o=n(6),a=n(973),c=n(974),l=n(975),u=n(976),d=n(419),h=n(418),f=n(422),p=n(171),m=n(988),g=n(989),y=n(421),v=n(420);class S{constructor(e,t){this.context=e,this.reporter=t,this.onStatusChanged=new r.EventEmitter,this.onTokensChanged=new r.EventEmitter,this.initialLoginAttemptSignal=new o.Signal,this.api={status:"Initializing",defaultStrategy:d.defaultStrategy,onStatusChanged:this.onStatusChanged.event,waitForLogin:()=>this.waitForLogin(),waitForInitialLogin:this.initialLoginAttemptSignal.promise,get tokens(){return[...S.tokensInternal]},onSessionsChanged:this.onTokensChanged.event,getTokensOrAskToSignIn:(e={})=>this.getTokenOrAskToSignIn(e),askToSignIn:e=>this.askForLogin(e),getCachedTokens:async(e={})=>await this.getCachedToken(e),logOut:e=>this.logout(e),authCallback:async e=>{await this.handleAuthCallback(e)},getRedirectUri:e=>y.getRedirectUri(e),fetchPost:(e,t,n)=>v.fetchPost(e,t,n),CancellationError:h.CancellationError},this.getTokenOrAskToSignIn=async(e={})=>{e=this.getOptionsWithDefaults(e);const{strategies:t,notificationOptions:n}=e,i=await this.getCachedToken(e);if(i&&i.length)return i;if(e.shouldSkipQuestion)try{const e=await this.login("login",t,n);return e?[e]:[]}catch(e){}const s=await this.askForLogin(e);return s?[s]:[]},this.updateAllTokensInternal=async e=>(await Promise.all(e.map(e=>c.reflectPromise(this.getTokenForStrategy(e))))).filter(e=>e.status===c.ReflectedPromiseStatus.resolved).map(e=>e.value),this.updateAllTokens=g.throttle(this.updateAllTokensInternal,p.Constants.UPDATE_TOKENS_THROTTLE_PERIOD_MS);const n=this.context.subscriptions;try{n.push(r.commands.registerCommand("vscode-account.login",e=>this.login("login",e).catch(console.error))),n.push(r.commands.registerCommand("vscode-account.logout",()=>this.logout().catch(console.error))),n.push(r.commands.registerCommand("vscode-account.askForLogin",()=>this.askForLogin().catch(console.error)))}catch(e){console.log("VSCode Account: the extension commands already exist.")}this.initialize("activation").catch(console.error)}async handleAuthCallback(e){for(let t of d.registeredStrategies){if(await t.receiveProtocolHandlerCallback(e))return}await s.window.showErrorMessage("Failed to find the entity that initialized this sign-in request. Please try again.")}getOptionsWithDefaults(e={}){const t=d.registeredStrategies.length?void 0:[d.defaultStrategy];return Object.assign({strategies:t,shouldSkipQuestion:!1,message:"Sign in to proceed."},e)}async getCachedToken(e){await this.initialLoginAttemptSignal.promise;const t=e.strategies||d.registeredStrategies;let n=S.tokensInternal.filter((function(n){const i=t.indexOf(n.strategy),s=-1!==i;let r=e.minExpiration||0;r=s&&t[i].minExpiration||r;const o=m.getExpirationTimeMS(n);return s&&o>=1e3*r}));if(n.length)return this.updateAllTokens(t),n;return await this.updateAllTokens(t)}createQuickPick(e){return e.map(e=>{const{publicName:t,prefixLabel:n="Sign in with"}=e,{description:i=`Use your default browser to ${n.toLowerCase()} ${t}`}=e;return{strategy:e,label:`${n} ${t}`,description:"",detail:i,enabled:()=>!0}})}async login(e,t,n){const i=t||d.registeredStrategies;let o=i[0];if(i.length>1){const e=await s.window.showQuickPick(this.createQuickPick(i));if(!e)return;o=e.strategy}let c="newLogin",f="uninitialized";const p=new r.CancellationTokenSource;try{f=o.name,this.beginLoggingIn(),c="newLoginCodeFlow";const t=async t=>{const n=new a.CancellableTask(async()=>{const t=await o.getAccessToken();if(!t)return void this.sendLoginTelemetry(e,c,f,"failure");const n=await this.handleTokenResponse(t,o);return this.sendLoginTelemetry(e,c,f,"success"),n},t);return await n.run()},i="Signing in...";if(n){return n.progress.report({message:i}),await t(n.cancellationToken)}const s={title:i,location:r.ProgressLocation.Notification,cancellable:!0};return await r.window.withProgress(s,async(e,n)=>await t(n))}catch(t){if(t instanceof l.VSCodeLoginError&&t.reason?this.sendLoginTelemetry(e,c,f,"error",u.getErrorMessage(t.reason)||u.getErrorMessage(t)):t instanceof h.CancellationError?this.sendLoginTelemetry(e,c,f,"cancel",u.getErrorMessage(t)):this.sendLoginTelemetry(e,c,f,"failure",u.getErrorMessage(t)),!(t instanceof h.CancellationError))throw t}finally{p.cancel(),p.dispose(),this.updateStatus()}}async handleTokenResponse(e,t){return await f.keytarService.storeAccessTokenToKeytar(t,e.accessToken),e.refreshToken&&await f.keytarService.storeRefreshTokenToKeytar(t,e.refreshToken),await this.updateSingleToken(t,e),{accessToken:e.accessToken,refreshToken:e.refreshToken,expiresOn:e.expiresOn,tokenType:e.tokenType,strategy:t}}sendLoginTelemetry(e,t,n,i,s){const r={trigger:e,path:t,cloud:n,outcome:i};s&&(r.message=s),this.reporter.sendTelemetryEvent("login",r)}async logout(e=d.registeredStrategies){await this.api.waitForLogin();for(const t of e)await f.keytarService.deleteAccessTokenFromKeytar(t),await f.keytarService.deleteRefreshTokenFromKeytar(t);await this.clearTokensForStrategies(e),this.updateStatus()}async getTokenForStrategy(e){const t=await f.keytarService.getRefreshTokenFromkeytar(e);if(t)try{const n=await e.refreshToken(t);if(n){return await this.handleTokenResponse(n,e)}}catch(e){}const n=await f.keytarService.getAccessTokenFromKeytar(e);if(!n)throw new l.VSCodeLoginError(`Could not find access token for the strategy "${e.name}".`);if(e.parseTokenPayloadFromAccessToken){const t=e.parseTokenPayloadFromAccessToken(n);if(!t)throw new l.VSCodeLoginError(`Could not parse accessToken for the strategy "${e.name}".`);return await this.handleTokenResponse(t,e)}throw new l.VSCodeLoginError(`Could not refresh nor access token for the strategy "${e.name}".`)}async initialize(e){this.beginLoggingIn();const t=d.registeredStrategies.map(t=>this.initializeStrategy(t,e));await Promise.all(t),this.updateStatus(),"activation"===e&&this.initialLoginAttemptSignal.resolve("LoggedIn"===this.api.status)}async initializeStrategy(e,t){try{e.onTokenUpdated&&e.onTokenUpdated(async t=>{await this.handleTokenResponse(t,e)}),await this.getTokenForStrategy(e),this.sendLoginTelemetry(t,"tryExisting","uninitialized","success")}catch(n){await this.clearTokensForStrategies([e]),n instanceof l.VSCodeLoginError&&n.reason?this.sendLoginTelemetry(t,"tryExisting","uninitialized","error",u.getErrorMessage(n.reason)||u.getErrorMessage(n)):this.sendLoginTelemetry(t,"tryExisting","uninitialized","failure",u.getErrorMessage(n))}}beginLoggingIn(){"LoggedIn"!==this.api.status&&(this.api.status="LoggingIn",this.onStatusChanged.fire(this.api.status))}updateStatus(){const e=S.tokensInternal.length?"LoggedIn":"LoggedOut";this.api.status!==e&&(this.api.status=e,this.onStatusChanged.fire(this.api.status))}async updateSingleToken(e,t){const n=S.tokensInternal.findIndex((function(t){return e===t.strategy}));-1!==n?S.tokensInternal.splice(n,1,t):S.tokensInternal.push(t),this.onTokensChanged.fire()}clearTokensForStrategies(e=d.registeredStrategies){for(let t of e)this.clearTokenForStrategy(t)}clearTokenForStrategy(e){const t=S.tokensInternal.length;S.tokensInternal=S.tokensInternal.filter(t=>t.strategy!==e),t!==S.tokensInternal.length&&this.onTokensChanged.fire()}async askForLogin(e={}){let t=!1;if((e=this.getOptionsWithDefaults(e)).shouldSkipQuestion)t=!0;else{const n={title:"Sign In"};t=await r.window.showInformationMessage(e.message,n)===n}if(t){return await this.login("login",e.strategies,e.notificationOptions)}}async waitForLogin(){switch(this.api.status){case"LoggedIn":return!0;case"LoggedOut":return!1;case"Initializing":case"LoggingIn":return new Promise(e=>{const t=this.api.onStatusChanged(()=>{t.dispose(),e(this.waitForLogin())})});default:const e=this.api.status;throw new Error(`Unexpected status '${e}'`)}}}t.VSCodeLoginHelper=S,S.tokensInternal=[],t.listAll=async function(e,t){const n=[];for(let i=await t;i.length||i.nextLink;i=i.nextLink?await e.listNext(i.nextLink):[])n.push(...i);return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(418),s=n(6);t.CancellableTask=class{constructor(e,t){this.task=e,this.cancellationToken=t,this.signal=new s.Signal}async run(){return this.task().then(this.signal.resolve.bind(this.signal)).catch(this.signal.reject.bind(this.signal)),this.cancellationToken.onCancellationRequested(e=>{this.signal.reject(new i.CancellationError(e||"Cancelled."))}),this.signal.promise}}},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.pending="pending",e.resolved="resolved",e.rejected="rejected"}(i=t.ReflectedPromiseStatus||(t.ReflectedPromiseStatus={})),t.reflectPromise=e=>e.then(e=>({status:i.resolved,value:e}),e=>({status:i.rejected,reason:e}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e,t){super(e),this.reason=t}}t.VSCodeLoginError=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorMessage=function(e){if(!e)return;if(e.message&&"string"==typeof e.message)return e.message;if(e.stack&&"string"==typeof e.stack)return e.stack.split("\n")[0];const t=String(e);if(!t||"[object Object]"===t){const t=e.constructor;if(t&&t.name&&"string"==typeof t.name)return t.name}return t}},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=n(0),r=i(n(978)),o=i(n(170)),a=n(6),c=n(984),l=n(171),u=n(985),d=n(420),h=n(421),f=["online.dev.core.vsengsaas.visualstudio.com","online-ppe.core.vsengsaas.visualstudio.com","online.visualstudio.com"];t.AADv2Strategy=class{constructor(){this.name="AADv2",this.publicName="Microsoft",this.endpointUrl="https://login.microsoftonline.com/",this.scope="email openid offline_access api://9db1d849-f699-4cfb-8160-64bed3335c72/All",this.clientId="a3037261-2c94-4a2e-b53f-090f6cdd712a",this.tenantId="common",this.activeRequests=new Map,this.minExpiration=0,this.getAccessToken=async()=>{try{const e=await this.getRedirectUri(),t=new URLSearchParams(e.query),n=u.guid(),i=`${this.endpointUrl}${this.tenantId}/oauth2/v2.0/authorize`,o=s.Uri.parse(i),l=t.get("state")||n;if(!l)throw new Error("No state param found.");const d=decodeURIComponent(e.with({query:""}).toString()),h={response_type:"code",scope:this.scope,client_id:this.clientId,redirect_uri:d,response_mode:"query",nonce:n,state:l,prompt:"select_account"},f=new a.Signal,p={strategy:this,redirect_uri:d,signal:f};this.activeRequests.set(l,p);const m=`${o}?${r.stringify(h).toString()}`;return c.isRunningIntegrationTest()?s.window.showInformationMessage("[SIGNIN] "+m):await s.env.openExternal(s.Uri.parse(m)),f.promise}catch(e){throw new Error(e)}},this.exchangeAuthorizationCode=async(e,t)=>{const n={client_id:this.clientId,scope:this.scope,redirect_uri:t.redirect_uri,grant_type:"authorization_code",code:e},i=await this.getRedirectUri(),o=f.indexOf(i.authority),a=f[o],c=r.stringify(n),l=a&&s.env.uiKind===s.UIKind.Web?`https://${a}/aad-code-grant-v2/${this.tenantId}/oauth2/v2.0/token`:`${this.endpointUrl}${this.tenantId}/oauth2/v2.0/token`,u=await d.fetchPost(l,c);if(u.error_description)throw new Error(u.error_description);return this.jsonToToken(u)},this.parseTokenPayloadFromAccessToken=e=>{const t=1e3*o.default(e).exp;return new Date(t).getTime()-Date.now()<=this.minExpiration?null:{accessToken:e,expiresOn:t,tokenType:"aadv2-vcode-account",strategy:this}}}getRedirectUri(){return h.getRedirectUri(l.Constants.extensionName)}async receiveProtocolHandlerCallback(e){const t=r.parse(e.query),{state:n}=t;if(!n||"string"!=typeof n)return!1;const i=decodeURIComponent(n),s=this.activeRequests.get(i);if(!s)return!1;this.activeRequests.delete(i);const o=t.error;if(o)return console.log(o),s.signal.resolve(null),!0;const a=t.code;if(!a||"string"!=typeof a)return console.log('No "code" query param found.'),s.signal.resolve(null),!0;try{const e=await this.exchangeAuthorizationCode(a,s);s.signal.resolve(e)}catch(e){console.log(e),s.signal.resolve(null)}finally{return!0}}async refreshToken(e){const t=r.stringify({client_id:this.clientId,scope:this.scope,refresh_token:e,grant_type:"refresh_token"}),n=await this.getRedirectUri(),i=f.indexOf(n.authority),o=f[i],a=o&&s.env.uiKind===s.UIKind.Web?`https://${o}/aad-code-grant-v2`:`${this.endpointUrl}${this.tenantId}/oauth2/v2.0/token`,c=await d.fetchPost(a,t);if(c.error_description)throw new Error(c.error_description);return this.jsonToToken(c)}jsonToToken(e){return{accessToken:e.access_token,refreshToken:e.refresh_token,expiresOn:Date.now()+1e3*(e.expires_in-10),tokenType:e.token_type,strategy:this}}}},function(e,t,n){"use strict";const i=n(979),s=n(980),r=n(981);function o(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function a(e,t){return t.encode?t.strict?i(e):encodeURIComponent(e):e}function c(e,t){return t.decode?s(e):e}function l(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function u(e){const t=(e=l(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function d(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function h(e,t){o((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const s="string"==typeof n&&n.split("").indexOf(e.arrayFormatSeparator)>-1?n.split(e.arrayFormatSeparator).map(t=>c(t,e)):null===n?n:c(n,e);i[t]=s};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),i=Object.create(null);if("string"!=typeof e)return i;if(!(e=e.trim().replace(/^[?#&]/,"")))return i;for(const s of e.split("&")){let[e,o]=r(t.decode?s.replace(/\+/g," "):s,"=");o=void 0===o?null:"comma"===t.arrayFormat?o:c(o,t),n(c(e,t),o,i)}for(const e of Object.keys(i)){const n=i[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=d(n[e],t);else i[e]=d(n,t)}return!1===t.sort?i:(!0===t.sort?Object.keys(i).sort():Object.keys(i).sort(t.sort)).reduce((e,t)=>{const n=i[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(n):e[t]=n,e},Object.create(null))}t.extract=u,t.parse=h,t.stringify=(e,t)=>{if(!e)return"";o((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=function(e){switch(e.arrayFormat){case"index":return t=>(n,i)=>{const s=n.length;return void 0===i||e.skipNull&&null===i?n:null===i?[...n,[a(t,e),"[",s,"]"].join("")]:[...n,[a(t,e),"[",a(s,e),"]=",a(i,e)].join("")]};case"bracket":return t=>(n,i)=>void 0===i||e.skipNull&&null===i?n:null===i?[...n,[a(t,e),"[]"].join("")]:[...n,[a(t,e),"[]=",a(i,e)].join("")];case"comma":case"separator":return t=>(n,i)=>null==i||0===i.length?n:0===n.length?[[a(t,e),"=",a(i,e)].join("")]:[[n,a(i,e)].join(e.arrayFormatSeparator)];default:return t=>(n,i)=>void 0===i||e.skipNull&&null===i?n:null===i?[...n,a(t,e)]:[...n,[a(t,e),"=",a(i,e)].join("")]}}(t),i=Object.assign({},e);if(t.skipNull)for(const e of Object.keys(i))void 0!==i[e]&&null!==i[e]||delete i[e];const s=Object.keys(i);return!1!==t.sort&&s.sort(t.sort),s.map(i=>{const s=e[i];return void 0===s?"":null===s?a(i,t):Array.isArray(s)?s.reduce(n(i),[]).join("&"):a(i,t)+"="+a(s,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>({url:l(e).split("?")[0]||"",query:h(u(e),t)}),t.stringifyUrl=(e,n)=>{const i=l(e.url).split("?")[0]||"",s=t.extract(e.url),r=t.parse(s),o=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url),a=Object.assign(r,e.query);let c=t.stringify(a,n);return c&&(c=`?${c}`),`${i}${c}${o}`}},function(e,t,n){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`)},function(e,t,n){"use strict";var i=new RegExp("%[a-f0-9]{2}","gi"),s=new RegExp("(%[a-f0-9]{2})+","gi");function r(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),i=e.slice(t);return Array.prototype.concat.call([],r(n),r(i))}function o(e){try{return decodeURIComponent(e)}catch(s){for(var t=e.match(i),n=1;n<t.length;n++)t=(e=r(t,n).join("")).match(i);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"","%FF%FE":""},n=s.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var i=o(n[0]);i!==n[0]&&(t[n[0]]=i)}n=s.exec(e)}t["%C2"]="";for(var r=Object.keys(t),a=0;a<r.length;a++){var c=r[a];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}},function(e,t,n){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}},function(e,t,n){var i=n(983);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(i(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(t)}catch(e){return i(t)}}},function(e,t){function n(e){this.message=e}n.prototype=new Error,n.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,s,r=0,o=0,a="";s=t.charAt(o++);~s&&(i=r%4?64*i+s:s,r++%4)?a+=String.fromCharCode(255&i>>(-2*r&6)):0)s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(s);return a}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(171);t.isRunningIntegrationTest=function(){return!(e.env.VSONLINE_TEST_MODE!==i.Constants.VSONLINE_INTEGRATION_TEST)}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.guid=()=>"xxxxxxxxxxxxxxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFunction=e=>"function"==typeof e},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(0));t.getKeytar=()=>function(e){const t=require;try{return t(`${s.env.appRoot}/node_modules.asar/${e}`)}catch(e){}try{return t(`${s.env.appRoot}/node_modules/${e}`)}catch(e){}}("keytar")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExpirationTimeMS=e=>new Date(e.expiresOn).getTime()-Date.now()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=(e,t)=>{let n;return(...i)=>{if(n)return n;if(n=e(...i),setTimeout(()=>{n=void 0},t),!n)throw new Error("Throttle function does not have the running promise.");return n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FakeTelemetryReporter=class{sendTelemetryEvent(e,t){}dispose(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);t.ProtocolHandler=class{constructor(e,t){this.api=e,"function"==typeof i.window.registerUriHandler&&t.subscriptions.push(i.window.registerUriHandler(this))}async handleUri(e){const{path:t}=e;switch(t.split("?")[0]){case"/signin":await this.api.authCallback(e)}}dispose(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(423);class s extends i.LiveShareStrategyBase{}t.LiveShareGithubStrategy=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(26),s=n(423),r=n(96);class o extends s.LiveShareStrategyBase{constructor(){super(...arguments),this.name="LiveShareAnonymous",this.publicName=i.localize("anonymousAuthStrategy.readOnlyUser"),this.prefixLabel=i.localize("anonymousAuthStrategy.continueAs"),this.description=i.localize("anonymousAuthStrategy.continueAsDescription"),this.getAccessToken=async()=>await this.getAnonymousToken()}async getAnonymousToken(){const e=await r.auth.API.fetchPost(`${this.endpointUrl()}auth/anonymous-token`,void 0,{"Content-Type":"application/json"});if(e.error_description)throw new Error(e.error_description);return this.parseTokenPayloadFromAccessToken(e.access_token)}async refreshToken(e){return await this.getAnonymousToken()}}t.LiveShareAnonymousStrategy=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(9),r=n(16),o=n(22),a=n(60),c=n(79),l=n(13),u=n(15),d=n(7);function h(e,t){t.coeditingClient.unpinByClient(e,{explicit:!0}),t.coeditingClient.pin(null,e,!0)}t.CoEditingCommands=class{constructor(e){this.sessionContext=e}async init(){await o.ExtensionUtil.tryRegisterCommand("liveshare.follow",this.pinWithParticipantPrompt,this,!1),await o.ExtensionUtil.tryRegisterCommand("liveshare.followToTheSide",this.followToTheSide,this,!1),await o.ExtensionUtil.tryRegisterCommand("liveshare.followToTheSideFromActivityBar",this.followToTheSideSpecificUser,this,!1),await o.ExtensionUtil.tryRegisterCommand("liveshare.followToTheSideFromTreeExplorer",this.followToTheSideSpecificUser,this,!1),await o.ExtensionUtil.tryRegisterCommand("liveshare.followFromFileTreeExplorer",this.followSpecificUser,this,!1),await o.ExtensionUtil.tryRegisterCommand("liveshare.followFromActivityBar",this.followSpecificUser,this,!1),await o.ExtensionUtil.tryRegisterCommand("liveshare.listParticipants",this.listParticipants,this,!1),await o.ExtensionUtil.tryRegisterCommand("liveshare.focusParticipantFromActivityBar",this.focusParticipant,this,!1),await o.ExtensionUtil.tryRegisterCommand("liveshare.focusParticipantFromFileTreeExplorer",this.focusParticipant,this,!1),await o.ExtensionUtil.tryRegisterCommand("liveshare.unfollow",this.unpinEditorCommandHandler,this,!0),await o.ExtensionUtil.tryRegisterCommand("liveshare.unfollowFromFileTreeExplorer",this.unpinClientCommandHandler,this,!1),await o.ExtensionUtil.tryRegisterCommand("liveshare.unfollowFromActivityBar",this.unpinClientCommandHandler,this,!1),await o.ExtensionUtil.tryRegisterCommand("liveshare.changePresenter",this.changePresenter,this,!1)}async dispose(){o.ExtensionUtil.disposeCommand("liveshare.follow"),o.ExtensionUtil.disposeCommand("liveshare.followFromFileTreeExplorer"),o.ExtensionUtil.disposeCommand("liveshare.followFromActivityBar"),o.ExtensionUtil.disposeCommand("liveshare.unfollow"),o.ExtensionUtil.disposeCommand("liveshare.unfollowFromFileTreeExplorer"),o.ExtensionUtil.disposeCommand("liveshare.unfollowFromActivityBar")}async followToTheSide(){if(!this.getCollaboratorsIfWeHaveSome())return;if(!i.window.activeTextEditor)return this.pinWithParticipantPrompt(!1);let e=this.sessionContext.coeditingClient.getClientIdIfEditorIsPinned(i.window.activeTextEditor);-1===e&&(e=await this.promptForParticipantsToFollow(!1)),-1!==e&&h(e,this.sessionContext)}followToTheSideSpecificUser(e){h(null==e?void 0:e.sessionId,this.sessionContext)}async followSpecificUser(e){if(void 0===e){let e="";const t=[].slice.call(arguments);return t.forEach(t=>e+=` ${null===t?null:typeof t}`),s.Telemetry.sendFault(r.TelemetryEventNames.FOLLOW_USER_FAILURE,s.FaultType.Error,`User is undefined. Args length: ${t.length}. Args types: ${e}`),void await this.pinWithParticipantPrompt(!0)}await this.sessionContext.coeditingClient.pin(null,e.sessionId)}async changePresenter(e){const t=e||await this.promptForParticipantToPresent();t<0||this.sessionContext.coeditingClient.presentationManager.updatePresenterId(t)}async pinWithParticipantPrompt(e){const t=this.getCollaboratorsIfWeHaveSome();if(!t)return;let n=!1;"boolean"==typeof e&&(n=e);let i=t[0];(t.length>1||n)&&(i=await this.promptForParticipantsToFollow(n)),-1!==i&&await this.sessionContext.coeditingClient.pin(null,i)}async promptForParticipantToPresent(){const e=[this.sessionContext.coeditingClient.clientID].concat(this.sessionContext.collaboratorManager.getCollaboratorSessionIds()).map(e=>{let t=this.sessionContext.collaboratorManager.getDisplayName(e);return this.sessionContext.coeditingClient.presentationManager.currentPresenterId==e&&(t=`${t} (Current Presenter)`),{description:t,label:"$(person)",targetSessionId:e}}),t=await i.window.showQuickPick(e,{placeHolder:"Select a new presenter or press 'Escape' to cancel."});return t?t.targetSessionId:-1}async promptForParticipantsToFollow(e){const t=this.getCollaboratorsIfWeHaveSome();if(!t)return-1;const n=e?t.length+" participant location(s) listed below. Select one to follow or press 'Escape' when done.":"Select a participant to follow",s=t.map(e=>{const t=this.sessionContext.collaboratorManager.getDisplayName(e),n=this.sessionContext.coeditingClient.lastKnownFileForClient(e);return{description:t,detail:n?`Currently editing ${n}`:"Not currently editing a shared document",label:"$(file-symlink-file)",targetSessionId:e}}),r=await i.window.showQuickPick(s,{placeHolder:n});return r?r.targetSessionId:-1}async unpinClientCommandHandler(e){var t,n;if(void 0===e){const{coeditingClient:e}=this.sessionContext,n=e.getUsersBeingFollowed(),i=Object.keys(n)[0];return a.assert(Object.keys(n).length<=1,"User is following more than one person."),a.assert(Object.keys(n).length>=1,"User is following less than one person."),null==i?void s.Telemetry.sendFault(r.TelemetryEventNames.UNFOLLOW_USER_FAILURE,s.FaultType.Error,`User parameter is undefined. Cannot find followed user from getUsersBeingFollowed(): ${n}.`):void(null===(t=this.sessionContext.coeditingClient)||void 0===t||t.unpinByClient(Number(i),{explicit:!0}))}null===(n=this.sessionContext.coeditingClient)||void 0===n||n.unpinByClient(e.sessionId,{explicit:!0})}async unpinEditorCommandHandler(e,t,n){var i;null===(i=this.sessionContext.coeditingClient)||void 0===i||i.unpinByEditor(e,{explicit:!0})}getCollaboratorsIfWeHaveSome(){if(!this.sessionContext.coeditingClient||!this.sessionContext.collaboratorManager)return;const e=this.sessionContext.collaboratorManager.getCollaboratorSessionIds();return e.length<1?void 0:e}async listParticipants(){await this.pinWithParticipantPrompt(!0)}async focusParticipant(e){s.Telemetry.sendTelemetryEvent(r.TelemetryEventNames.FOCUS_PARTICIPANT),this.sessionContext.coeditingClient.postMessage(c.MessageFactory.SummonMessage(this.sessionContext.coeditingClient.clientID,e.sessionId));const t=!!l.Settings.get(u.SettingKeys.showVerboseNotifications);await d.NotificationUtil.showInformationMessage("Focus request sent.",t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(7),s=n(23);class r extends(i.Inittable(i.Disposable(Object))){constructor(){super(),this.handlers=[],this.stateChangedRegistration=s.sessionStateTracker.onStateChanged(e=>this.handleSessionStateChanged(e.newState,e.oldState))}registerHandler(e){this.handlers.push(e)}async dispose(){this.stateChangedRegistration.dispose(),await Promise.all(this.handlers.map(e=>e.dispose?e.dispose():Promise.resolve())),await super.dispose()}async handleSessionStateChanged(e,t){await Promise.all(this.handlers.map(n=>n.handleSessionStateChanged(e,t)))}}t.SessionStateManager=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(425),s=n(33);t.errorNotificationCommandDecoratorFactory=(e,t,n,r,o=!1,a)=>new i.ErrorNotificationCommandDecorator(s.DecoratorHelper.getCoreCommand(e),e,t.telemetry(),n,r,o,a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(426),s=n(33);t.telemetryCommandDecoratorFactory=(e,t,n,r,o,a,c)=>new i.TelemetryCommandDecorator(s.DecoratorHelper.getCoreCommand(e),e,t.workspaceService(),t.telemetry(),n,r,o,a||1,c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e,t){super(e),this.code=t}}t.IndeterminateError=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(432),s=n(7),r=n(97),o=n(13),a=n(15);class c extends i.VsCodeNativeAuthTokenProvider{constructor(e){e=null!=e?e:s.traceSource.withName(r.SupportedAuthProviders.GitHub);const t=o.Settings.get(a.SettingKeys.runsInVSCodeDev)?["read:user","user:email","repo"]:["read:user","user:email"];super(r.SupportedAuthProviders.GitHub,t,e)}}t.GitHubAuthTokenProvider=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebECDiffieHellman=t.WebDiffieHellman=void 0;const i=n(3),s=n(208),r=n(247),o=n(250),a=n(51),c=n(251);class l extends r.KeyExchangeAlgorithm{constructor(e,t,n){super(e,t,n,o.WebHmac.getHashDigestLength(n))}createKeyExchange(){return new u(this.keySizeInBits,o.WebHmac.getWebHashAlgorithmName(this.hashAlgorithmName),this.hashDigestLength)}}t.WebDiffieHellman=l;class u{constructor(e,t,n){switch(this.hashAlgorithmName=t,this.digestLength=n,e){case 1024:this.dh=(0,s.getDiffieHellman)("modp2");break;case 2048:this.dh=(0,s.getDiffieHellman)("modp14");break;case 4096:this.dh=(0,s.getDiffieHellman)("modp16");break;default:throw new Error("Invalid DH bit length.")}}startKeyExchange(){const e=this.dh.generateKeys(),t=a.BigInt.fromBytes(e,{unsigned:!0}).toBytes();return Promise.resolve(t)}decryptKeyExchange(e){const t=this.dh.computeSecret(e),n=a.BigInt.fromBytes(t,{unsigned:!0}).toBytes();return Promise.resolve(n)}async sign(e){const t=await crypto.subtle.digest(this.hashAlgorithmName,e);return i.Buffer.from(t)}dispose(){}}class d extends r.KeyExchangeAlgorithm{constructor(e,t,n){super(e,t,n,o.WebHmac.getHashDigestLength(n))}createKeyExchange(){return new h(this.keySizeInBits,o.WebHmac.getWebHashAlgorithmName(this.hashAlgorithmName),this.hashDigestLength)}}t.WebECDiffieHellman=d;class h{constructor(e,t,n){this.bitLength=e,this.hashAlgorithmName=t,this.digestLength=n,this.algorithm={name:"ECDH",namedCurve:"P-"+e}}async startKeyExchange(){this.keyPair||(this.keyPair=await crypto.subtle.generateKey(this.algorithm,!0,["deriveBits"]));const e=await crypto.subtle.exportKey("jwk",this.keyPair.publicKey),t=c.JsonWebKeyFormatter.parseEC(e),n=Math.ceil(this.bitLength/8),s=i.Buffer.alloc(1+2*n);return s[0]=4,t.x.toBytes({unsigned:!0,length:n}).copy(s,1),t.y.toBytes({unsigned:!0,length:n}).copy(s,1+n),i.Buffer.from(s)}async decryptKeyExchange(e){if(!this.keyPair)throw new Error("Key exchange not started.");const t=e,n=c.JsonWebKeyFormatter.formatEC({curve:{name:this.algorithm.namedCurve},x:a.BigInt.fromBytes(t.slice(1,1+(t.length-1)/2),{unsigned:!0}),y:a.BigInt.fromBytes(t.slice(1+(t.length-1)/2),{unsigned:!0})}),s=await crypto.subtle.importKey("jwk",n,this.algorithm,!1,[]),r=i.Buffer.from(await crypto.subtle.deriveBits(Object.assign(Object.assign({},this.algorithm),{public:s}),this.keyPair.privateKey,8*Math.ceil(this.bitLength/8)));return a.BigInt.fromBytes(r,{unsigned:!0}).toBytes()}async sign(e){const t=await crypto.subtle.digest(this.hashAlgorithmName,e);return i.Buffer.from(t)}dispose(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebRsa=void 0;const i=n(3),s=n(132),r=n(250),o=n(36),a=n(251);class c{constructor(e){this.hashAlgorithm=e,this.comment=null}get hasPublicKey(){return!!this.publicKey}get hasPrivateKey(){return!!this.privateKey}get keyAlgorithmName(){return l.keyAlgorithmName}async generate(e){e=null!=e?e:c.defaultKeySize;try{const t={name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:this.hashAlgorithm}},n=await crypto.subtle.generateKey(t,!0,["sign","verify"]);this.publicKey=n.publicKey,this.privateKey=n.privateKey}catch(e){throw new Error("Failed to generate RSA key pair: "+e)}}async setPublicKeyBytes(e){if(!e)throw new TypeError("Buffer is required.");const t=new o.SshDataReader(e),n=t.readString("ascii");if(n!==this.keyAlgorithmName&&n!==l.rsaWithSha256&&n!==l.rsaWithSha512)throw new Error(`Invalid RSA key algorithm: ${n}`);const i=t.readBigInt(),s=t.readBigInt(),r=a.JsonWebKeyFormatter.formatRsa({modulus:s,exponent:i},!1);r.alg="RS"+this.hashAlgorithm.replace("SHA-",""),r.key_ops=["verify"];try{const e={name:"RSASSA-PKCS1-v1_5",hash:{name:this.hashAlgorithm}};this.publicKey=await crypto.subtle.importKey("jwk",r,e,!0,["verify"])}catch(e){throw new Error("Failed to import RSA public key: "+e)}}async getPublicKeyBytes(e){if(!this.publicKey)return null;let t;e||(e=this.keyAlgorithmName);try{t=await crypto.subtle.exportKey("jwk",this.publicKey)}catch(e){throw new Error("Failed to export RSA public key: "+e)}const{modulus:n,exponent:s}=a.JsonWebKeyFormatter.parseRsa(t,!1),r=i.Buffer.alloc(512),c=new o.SshDataWriter(r);return c.writeString(e,"ascii"),c.writeBigInt(s),c.writeBigInt(n),c.toBuffer()}async importParameters(e){const t=e.d?a.JsonWebKeyFormatter.formatRsa(e,!0):null,n=a.JsonWebKeyFormatter.formatRsa(e,!1),i={name:"RSASSA-PKCS1-v1_5",hash:{name:this.hashAlgorithm}};try{this.publicKey=await crypto.subtle.importKey("jwk",n,i,!0,["verify"]),this.privateKey=t?await crypto.subtle.importKey("jwk",t,i,!0,["sign"]):void 0}catch(e){if(!(e instanceof Error))throw e;throw new Error("Failed to import RSA key pair: "+e.message)}}async exportParameters(){var e;if(!this.publicKey)throw new Error("Public key not set.");let t;try{t=await crypto.subtle.exportKey("jwk",null!==(e=this.privateKey)&&void 0!==e?e:this.publicKey)}catch(e){if(!(e instanceof Error))throw e;throw new Error("Failed to export RSA public key: "+e.message)}return a.JsonWebKeyFormatter.parseRsa(t,!!this.privateKey)}dispose(){}}c.defaultKeySize=2048;class l extends s.PublicKeyAlgorithm{constructor(e,t){super(e,l.keyAlgorithmName,t)}createKeyPair(){const e=l.convertHashAlgorithmName(this.hashAlgorithmName);return new c(e)}async generateKeyPair(e){const t=l.convertHashAlgorithmName(this.hashAlgorithmName),n=new c(t);return await n.generate(e),n}createSigner(e){if(!(e instanceof c))throw new TypeError("RSA key pair object expected.");const t=l.convertHashAlgorithmName(this.hashAlgorithmName);return new u(e,t,r.WebHmac.getHashDigestLength(this.hashAlgorithmName))}createVerifier(e){if(!(e instanceof c))throw new TypeError("RSA key pair object expected.");const t=l.convertHashAlgorithmName(this.hashAlgorithmName);return new u(e,t,r.WebHmac.getHashDigestLength(this.hashAlgorithmName))}static convertHashAlgorithmName(e){return e.replace("SHA2-","SHA-")}}t.WebRsa=l,l.keyAlgorithmName="ssh-rsa",l.rsaWithSha256="rsa-sha2-256",l.rsaWithSha512="rsa-sha2-512",l.KeyPair=c;class u{constructor(e,t,n){this.keyPair=e,this.hashAlgorithm=t,this.digestLength=n}async sign(e){if(!this.keyPair.privateKey)throw new Error("Private key not set.");return await this.convertKeyHashAlgorithm(),i.Buffer.from(await crypto.subtle.sign("RSASSA-PKCS1-v1_5",this.keyPair.privateKey,e))}async verify(e,t){if(!this.keyPair.publicKey)throw new Error("Public key not set.");return await this.convertKeyHashAlgorithm(),await crypto.subtle.verify("RSASSA-PKCS1-v1_5",this.keyPair.publicKey,t,e)}async convertKeyHashAlgorithm(){if(this.keyPair.hashAlgorithm!==this.hashAlgorithm){const e=await this.keyPair.exportParameters();this.keyPair=new c(this.hashAlgorithm),await this.keyPair.importParameters(e)}}dispose(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebECDsa=void 0;const i=n(3),s=n(132),r=n(36),o=n(172),a=n(51),c=n(251);class l{constructor(e){this.comment=null,e&&(this.algorithmName=e)}get hasPublicKey(){return!!this.publicKey}get hasPrivateKey(){return!!this.privateKey}get keyAlgorithmName(){return this.algorithmName}get algorithmName(){return this.algorithm}set algorithmName(e){const t=e.split("-")[2];if(this.curve=o.curves.find(e=>e.name===t),!this.curve)throw new Error("Invalid or unsupported ECDSA algorithm: "+e);this.algorithm=e}async generate(){try{const e={name:"ECDSA",namedCurve:this.curve.shortName},t=await crypto.subtle.generateKey(e,!0,["sign","verify"]);this.publicKey=t.publicKey,this.privateKey=t.privateKey}catch(e){throw new Error("Failed to generate RSA key pair: "+e)}}async setPublicKeyBytes(e,t){if(!e)throw new TypeError("Buffer is required.");const n=new r.SshDataReader(e),i=n.readString("ascii");if(this.algorithmName=t||i,n.readString("ascii")!==this.curve.name)throw new Error("EC curve name does not match.");const s=n.readBinary(),o=Math.ceil(this.curve.keySize/8),l=a.BigInt.fromBytes(s.slice(1,1+o),{unsigned:!0}),u=a.BigInt.fromBytes(s.slice(1+o,s.length),{unsigned:!0}),d=c.JsonWebKeyFormatter.formatEC({curve:{name:this.curve.shortName,oid:this.curve.oid},x:l,y:u});try{const e={name:"ECDSA",namedCurve:this.curve.shortName};this.publicKey=await crypto.subtle.importKey("jwk",d,e,!0,["verify"])}catch(e){throw new Error("Failed to import EC public key: "+e)}}async getPublicKeyBytes(e){if(!this.publicKey)return null;let t;try{t=await crypto.subtle.exportKey("jwk",this.publicKey)}catch(e){throw new Error("Failed to export ECDSA public key: "+e)}const n=i.Buffer.from(t.x,"base64"),s=i.Buffer.from(t.y,"base64"),o=Math.ceil(this.curve.keySize/8);if(n.length!==o||s.length!==o)throw new Error("Unexpected key length.");e=e||this.algorithmName||this.keyAlgorithmName;const a=i.Buffer.alloc(e.length+n.length+s.length+10),c=new r.SshDataWriter(a);return c.writeString(e,"ascii"),c.writeString(this.curve.name,"ascii"),c.writeUInt32(1+n.length+s.length),c.writeByte(4),c.write(n),c.write(s),c.toBuffer()}async importParameters(e){if(!e.curve)throw new TypeError("A curve is required.");let t;if(e.curve.oid){if(t=o.curves.find(t=>t.oid===e.curve.oid),!t)throw new Error(`Unsupported curve OID: ${e.curve.oid}`)}else{if(!e.curve.name)throw new TypeError("A curve OID or name is required.");if(t=o.curves.find(t=>t.name===e.curve.name),!t)throw new Error(`Unsupported curve: ${e.curve.name}`)}this.algorithmName="ecdsa-sha2-"+t.name;const n={name:"ECDSA",namedCurve:this.curve.shortName},i=c.JsonWebKeyFormatter.formatEC(e);i.crv=this.curve.shortName;try{i.d?(this.privateKey=await crypto.subtle.importKey("jwk",i,n,!0,["sign"]),i.d=void 0):this.privateKey=void 0,this.publicKey=await crypto.subtle.importKey("jwk",i,n,!0,["verify"])}catch(e){throw new Error("Failed to import ECDSA key pair: "+e)}}async exportParameters(){var e;const t=null!==(e=this.privateKey)&&void 0!==e?e:this.publicKey;if(!t)throw new Error("Key not present.");let n;try{n=await crypto.subtle.exportKey("jwk",t)}catch(e){throw new Error("Failed to export ECDSA key pair: "+e)}const i=c.JsonWebKeyFormatter.parseEC(n);return i.curve={name:this.curve.name,oid:this.curve.oid},i}dispose(){}}class u extends s.PublicKeyAlgorithm{constructor(e,t){super(e,e,t)}createKeyPair(){return new l(this.name)}async generateKeyPair(){const e=new l(this.name);return await e.generate(),e}createSigner(e){if(!(e instanceof l))throw new TypeError("ECDSA key pair object expected.");const t=u.convertHashAlgorithmName(this.hashAlgorithmName);return new d(e,t)}createVerifier(e){if(!(e instanceof l))throw new TypeError("ECDSA key pair object expected.");const t=u.convertHashAlgorithmName(this.hashAlgorithmName);return new d(e,t)}static convertHashAlgorithmName(e){return e.replace("SHA2-","SHA-")}static getSignatureLength(e){return 2*(5+Math.ceil(e/8))}}t.WebECDsa=u,u.ecdsaSha2Nistp256="ecdsa-sha2-nistp256",u.ecdsaSha2Nistp384="ecdsa-sha2-nistp384",u.ecdsaSha2Nistp521="ecdsa-sha2-nistp521",u.curves=o.curves,u.KeyPair=l;class d{constructor(e,t){this.keyPair=e,this.hashAlgorithm=t}get digestLength(){const e=this.keyPair.curve;return e?u.getSignatureLength(e.keySize):0}async sign(e){if(!this.keyPair.privateKey)throw new Error("Private key not set.");let t=i.Buffer.from(await crypto.subtle.sign({name:"ECDSA",hash:{name:this.hashAlgorithm}},this.keyPair.privateKey,e));const n=Math.ceil(this.keyPair.curve.keySize/8);if(t.length!==2*n)throw new Error(`Unexpected signature length: ${t.length}`);const s=a.BigInt.fromBytes(t.slice(0,n),{unsigned:!0}),o=a.BigInt.fromBytes(t.slice(n,t.length),{unsigned:!0}),c=new r.SshDataWriter(i.Buffer.alloc(this.digestLength));return c.writeBinary(s.toBytes({unsigned:!0,length:n+1})),c.writeBinary(o.toBytes({unsigned:!0,length:n+1})),t=c.toBuffer(),t}async verify(e,t){if(!this.keyPair.publicKey)throw new Error("Public key not set.");const n=new r.SshDataReader(t),s=n.readBigInt(),o=n.readBigInt(),a=Math.ceil(this.keyPair.curve.keySize/8);return t=i.Buffer.alloc(2*a),s.toBytes({unsigned:!0,length:a}).copy(t,0),o.toBytes({unsigned:!0,length:a}).copy(t,a),await crypto.subtle.verify({name:"ECDSA",hash:{name:this.hashAlgorithm}},this.keyPair.publicKey,t,e)}dispose(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebEncryption=void 0;const i=n(44),s=n(3),r=n(248);class o extends r.EncryptionAlgorithm{constructor(e,t,n,i){super(e),this.algorithmName=t,this.cipherMode=n,this.keySizeInBits=i,this.blockSizeInBits=o.getBlockSize(t)}get keyLength(){return this.keySizeInBits/8}get blockLength(){return this.blockSizeInBits/8}async createCipher(e,t,n){const i=new a(e,this.algorithmName,this.cipherMode,this.keySizeInBits,this.blockSizeInBits);return await i.init(t,n),i}static getBlockSize(e){if("AES"===e)return 128;throw new Error(`Unsupported encryption algorithm: ${e}`)}}t.WebEncryption=o;class a{constructor(e,t,n,i,r){if(this.isEncryption=e,this.algorithmName=t,this.cipherMode=n,this.keySizeInBits=i,this.blockSizeInBits=r,this.tag=null,"AES"===this.algorithmName&&"CTR"===this.cipherMode)this.transform=this.aesCtr.bind(this,e);else if("AES"===this.algorithmName&&"CBC"===this.cipherMode)this.transform=this.aesCbc.bind(this,e);else{if("AES"!==this.algorithmName||"GCM"!==this.cipherMode)throw new Error(`Unsupported encryption algorithm: ${this.algorithmName}-${this.cipherMode}`);this.transform=this.aesGcm.bind(this,e),this.associatedData=s.Buffer.alloc(4),this.decryptBuffer=s.Buffer.alloc(4*this.blockLength)}}get blockLength(){return this.blockSizeInBits/8}async init(e,t){try{const t=`${this.algorithmName}-${this.cipherMode}`;this.key=await crypto.subtle.importKey("raw",e,{name:t,length:this.keySizeInBits},!1,this.isEncryption?["encrypt"]:["decrypt"])}catch(e){throw new Error("Failed to initialize AES: "+e)}"GCM"===this.cipherMode?this.iv=s.Buffer.from(t.slice(0,12)):this.iv=s.Buffer.from(t)}async aesCtr(e,t){if(t.length%this.blockLength!=0){const e="Encrypt/decrypt input has invalid length "+`${t.length}, not a multiple of block size ${this.blockLength}.`;throw(0,i.trace)("Error: "+e),new Error(e)}let n;if(n=e?s.Buffer.from(await crypto.subtle.encrypt({name:"AES-CTR",counter:this.iv,length:this.blockSizeInBits},this.key,t)):s.Buffer.from(await crypto.subtle.decrypt({name:"AES-CTR",counter:this.iv,length:this.blockSizeInBits},this.key,t)),n.length!==t.length){const e="Result from encrypt/decrypt has invalid length "+`${n.length}, expected ${t.length}.`;throw(0,i.trace)("Error: "+e),new Error(e)}const r=t.length/this.blockLength;for(let e=0;e<r;e++)for(let e=this.iv.length-1;e>=0&&(this.iv[e]=this.iv[e]+1,!this.iv[e]);e--);return n}async aesCbc(e,t){if(e){let e=s.Buffer.from(await crypto.subtle.encrypt({name:"AES-CBC",iv:this.iv},this.key,t));return e=e.slice(0,t.length),e}return s.Buffer.from(await crypto.subtle.decrypt({name:"AES-CBC",iv:this.iv},this.key,t))}async aesGcm(e,t){if(t.length%this.blockLength!=0){const e="Encrypt/decrypt input has invalid length "+`${t.length}, not a multiple of block size ${this.blockLength}.`;throw(0,i.trace)("Error: "+e),new Error(e)}const n=t.length;let r;if(this.associatedData[0]=n>>>24,this.associatedData[1]=n>>>16,this.associatedData[2]=n>>>8,this.associatedData[3]=n,e)r=s.Buffer.from(await crypto.subtle.encrypt({name:"AES-GCM",iv:this.iv,additionalData:this.associatedData,tagLength:8*this.digestLength},this.key,t)),this.tag=r.slice(r.length-this.digestLength),r=r.slice(0,r.length-this.digestLength);else{if(!this.tag)throw new Error("AES-GCM tag was not set before decrypting.");const e=t.length+this.digestLength;if(this.decryptBuffer.length<e){let t=2*this.decryptBuffer.length;for(;t<e;)t*=2;this.decryptBuffer=s.Buffer.alloc(t)}const n=this.decryptBuffer.slice(0,e);t.copy(n,0),this.tag.copy(n,t.length),r=s.Buffer.from(await crypto.subtle.decrypt({name:"AES-GCM",iv:this.iv,additionalData:this.associatedData,tagLength:8*this.digestLength},this.key,n))}if(r.length!==t.length){const e="Result from encrypt/decrypt has invalid length "+`${r.length}, expected ${t.length}.`;throw(0,i.trace)("Error: "+e),new Error(e)}let o=12;for(;--o>=4&&(this.iv[o]++,0===this.iv[o]););return r}get digestLength(){return 16}get authenticatedEncryption(){return"GCM"===this.cipherMode}async sign(e){if(!this.tag)throw new Error("AES-GCM tag was not obtained by encrypting.");return this.tag}async verify(e,t){if(t.length!==this.digestLength)throw new Error("Incorrect AES-GCM tag length.");return this.tag=t,!0}dispose(){}}},function(e,t,n){e.exports=function(e){function t(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return i.colors[Math.abs(t)%i.colors.length]}function i(e){let n;function o(...e){if(!o.enabled)return;const t=o,s=Number(new Date),r=s-(n||s);t.diff=r,t.prev=n,t.curr=s,n=s,e[0]=i.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,s)=>{if("%%"===n)return n;a++;const r=i.formatters[s];if("function"==typeof r){const i=e[a];n=r.call(t,i),e.splice(a,1),a--}return n}),i.formatArgs.call(t,e),(t.log||i.log).apply(t,e)}return o.namespace=e,o.enabled=i.enabled(e),o.useColors=i.useColors(),o.color=t(e),o.destroy=s,o.extend=r,"function"==typeof i.init&&i.init(o),i.instances.push(o),o}function s(){const e=i.instances.indexOf(this);return-1!==e&&(i.instances.splice(e,1),!0)}function r(e,t){const n=i(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return i.debug=i,i.default=i,i.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},i.disable=function(){const e=[...i.names.map(o),...i.skips.map(o).map(e=>"-"+e)].join(",");return i.enable(""),e},i.enable=function(e){let t;i.save(e),i.names=[],i.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),s=n.length;for(t=0;t<s;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?i.skips.push(new RegExp("^"+e.substr(1)+"$")):i.names.push(new RegExp("^"+e+"$")));for(t=0;t<i.instances.length;t++){const e=i.instances[t];e.enabled=i.enabled(e.namespace)}},i.enabled=function(e){if("*"===e[e.length-1])return!0;let t,n;for(t=0,n=i.skips.length;t<n;t++)if(i.skips[t].test(e))return!1;for(t=0,n=i.names.length;t<n;t++)if(i.names[t].test(e))return!0;return!1},i.humanize=n(1005),Object.keys(e).forEach(t=>{i[t]=e[t]}),i.instances=[],i.names=[],i.skips=[],i.formatters={},i.selectColor=t,i.enable(i.load()),i}},function(e,t){var n=1e3,i=6e4,s=60*i,r=24*s;function o(e,t,n,i){var s=t>=1.5*n;return Math.round(e/n)+" "+i+(s?"s":"")}e.exports=function(e,t){t=t||{};var a=typeof e;if("string"===a&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var o=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*r;case"hours":case"hour":case"hrs":case"hr":case"h":return o*s;case"minutes":case"minute":case"mins":case"min":case"m":return o*i;case"seconds":case"second":case"secs":case"sec":case"s":return o*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(e);if("number"===a&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=r)return o(e,t,r,"day");if(t>=s)return o(e,t,s,"hour");if(t>=i)return o(e,t,i,"minute");if(t>=n)return o(e,t,n,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=r)return Math.round(e/r)+"d";if(t>=s)return Math.round(e/s)+"h";if(t>=i)return Math.round(e/i)+"m";if(t>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebRandom=void 0;t.WebRandom=class{getBytes(e){crypto.getRandomValues(e)}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.NodeRsa=void 0;const i=n(28),s=n(3),r=n(132),o=n(36),a=n(253),c=n(435),l=e.versions.node.split(".").map(e=>parseInt(e,10)),u=l[0]>10||10===l[0]&&l[1]>=12,d=l[0]>11||11===l[0]&&l[1]>=6;class h{constructor(){this.comment=null}get hasPublicKey(){return!!this.publicKey}get hasPrivateKey(){return!!this.privateKey}get keyAlgorithmName(){return f.keyAlgorithmName}generate(e){return e=null!=e?e:h.defaultKeySize,u&&d?this.generateNodeKeyPairObjects(e):u?this.generateNodeKeyPairBuffers(e):this.generateExternalKeyPair(e)}async generateNodeKeyPairObjects(e){[this.publicKey,this.privateKey]=await new Promise((t,n)=>{const s={modulusLength:e};try{i.generateKeyPair("rsa",s,(e,i,s)=>{e?n(e):t([i,s])})}catch(e){n(e)}})}async generateNodeKeyPairBuffers(e){[this.publicKey,this.privateKey]=await new Promise((t,n)=>{const s={modulusLength:e,publicKeyEncoding:{type:"pkcs1",format:"pem"},privateKeyEncoding:{type:"pkcs1",format:"pem",cipher:void 0,passphrase:void 0}};try{i.generateKeyPair("rsa",s,(e,i,s)=>{e?n(e):t([i,s])})}catch(e){n(e)}})}async generateExternalKeyPair(e){const t=new(await Promise.resolve().then(()=>n(66)))({b:e});this.publicKey=t.exportKey("pkcs1-public-pem"),this.privateKey=t.exportKey("pkcs1-private-pem"),this.publicKey.endsWith("\n")||(this.publicKey+="\n"),this.privateKey.endsWith("\n")||(this.privateKey+="\n")}async setPublicKeyBytes(e){if(!e)throw new TypeError("Buffer is required.");const t=new o.SshDataReader(e),n=t.readString("ascii");if(n!==this.keyAlgorithmName&&n!==f.rsaWithSha256&&n!==f.rsaWithSha512)throw new Error(`Invalid RSA key algorithm: ${n}`);const s=t.readBigInt(),r=t.readBigInt();e=c.Pkcs1KeyFormatter.formatRsaPublic({modulus:r,exponent:s}),this.publicKey=d?i.createPublicKey({key:e,type:"pkcs1",format:"der"}):(0,c.formatPem)(e,"RSA PUBLIC KEY")}async getPublicKeyBytes(e){if(!this.publicKey)return null;let t;e||(e=this.keyAlgorithmName),t="string"==typeof this.publicKey?(0,c.parsePem)(this.publicKey):this.publicKey.export({type:"pkcs1",format:"der"});const n=c.Pkcs1KeyFormatter.parseRsaPublic(t),i=s.Buffer.alloc(512),r=new o.SshDataWriter(i);return r.writeString(e,"ascii"),r.writeBigInt(n.exponent),r.writeBigInt(n.modulus),t=r.toBuffer(),t}async importParameters(e){if(d)this.publicKey=i.createPublicKey({key:c.Pkcs1KeyFormatter.formatRsaPublic(e),format:"der",type:"pkcs1"}),e.d?this.privateKey=i.createPrivateKey({key:c.Pkcs1KeyFormatter.formatRsaPrivate(e),format:"der",type:"pkcs1"}):this.privateKey=void 0;else{const t=c.Pkcs1KeyFormatter.formatRsaPublic(e);if(this.publicKey=(0,c.formatPem)(t,"RSA PUBLIC KEY"),e.d){const t=c.Pkcs1KeyFormatter.formatRsaPrivate(e);this.privateKey=(0,c.formatPem)(t,"RSA PRIVATE KEY")}}}async exportParameters(){var e,t;if(!this.publicKey)throw new Error("Public key not set.");let n;return n=d?(null!==(e=this.privateKey)&&void 0!==e?e:this.publicKey).export({format:"der",type:"pkcs1"}):(0,c.parsePem)(null!==(t=this.privateKey)&&void 0!==t?t:this.publicKey),this.privateKey?c.Pkcs1KeyFormatter.parseRsaPrivate(n):c.Pkcs1KeyFormatter.parseRsaPublic(n)}dispose(){this.publicKey=void 0,this.privateKey=void 0}}h.defaultKeySize=2048;class f extends r.PublicKeyAlgorithm{constructor(e,t){super(e,f.keyAlgorithmName,t)}createKeyPair(){return new h}async generateKeyPair(e){const t=new h;return await t.generate(e),t}createSigner(e){if(!(e instanceof h))throw new TypeError("RSA key pair object expected.");return new p(e,f.convertHashAlgorithmName(this.hashAlgorithmName),a.NodeHmac.getHashDigestLength(this.hashAlgorithmName))}createVerifier(e){if(!(e instanceof h))throw new TypeError("RSA key pair object expected.");return new p(e,f.convertHashAlgorithmName(this.hashAlgorithmName),a.NodeHmac.getHashDigestLength(this.hashAlgorithmName))}static convertHashAlgorithmName(e){return e.replace("SHA2-","SHA")}}t.NodeRsa=f,f.keyAlgorithmName="ssh-rsa",f.rsaWithSha256="rsa-sha2-256",f.rsaWithSha512="rsa-sha2-512",f.KeyPair=h;class p{constructor(e,t,n){this.keyPair=e,this.hashAlgorithmName=t,this.digestLength=n}async sign(e){if(!this.keyPair.privateKey)throw new Error("Private key not set.");const t=i.createSign(this.hashAlgorithmName);return t.update(e),t.sign(this.keyPair.privateKey)}async verify(e,t){if(!this.keyPair.publicKey)throw new Error("Public key not set.");const n=i.createVerify(this.hashAlgorithmName);return n.update(e),n.verify(this.keyPair.publicKey,t)}dispose(){}}}).call(this,n(11))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.NodeECDsa=void 0;const i=n(28),s=n(3),r=n(132),o=n(172),a=n(51),c=n(254),l=n(36),u=n(435),d=e.versions.node.split(".").map(e=>parseInt(e,10)),h=d[0]>10||10===d[0]&&d[1]>=12,f=d[0]>11||11===d[0]&&d[1]>=6;class p{constructor(e){this.comment=null,e&&(this.algorithmName=e)}get hasPublicKey(){return!!this.publicKey}get hasPrivateKey(){return!!this.privateKey}get keyAlgorithmName(){return this.algorithmName}get algorithmName(){return this.algorithm}set algorithmName(e){const t=e.split("-")[2];if(this.curve=o.curves.find(e=>e.name===t),!this.curve)throw new Error("Invalid or unsupported ECDSA algorithm: "+e);this.algorithm=e}generate(){return h&&f?this.generateNodeKeyPairObjects():h?this.generateNodeKeyPairBuffers():this.generateExternalKeyPair()}async generateNodeKeyPairObjects(){[this.publicKey,this.privateKey]=await new Promise((e,t)=>{const n={namedCurve:this.curve.shortName};try{i.generateKeyPair("ec",n,(n,i,s)=>{n?t(n):e([i,s])})}catch(e){t(e)}})}async generateNodeKeyPairBuffers(){[this.publicKey,this.privateKey]=await new Promise((e,t)=>{const n={namedCurve:this.curve.shortName,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"sec1",format:"pem",cipher:void 0,passphrase:void 0}};try{i.generateKeyPair("ec",n,(n,i,s)=>{n?t(n):e([i,s])})}catch(e){t(e)}})}async generateExternalKeyPair(){throw new Error("This version of node does not support generating key pairs. Use node >= 10.12.")}async setPublicKeyBytes(e,t){if(!e)throw new TypeError("Buffer is required.");const n=new l.SshDataReader(e),s=n.readString("ascii");this.algorithmName=t||s;const r=n.readString("ascii");this.algorithmName=`ecdsa-sha2-${r}`;const o=n.readBinary(),c=a.BigInt.fromBytes(o.slice(1,1+(o.length-1)/2),{unsigned:!0}),d=a.BigInt.fromBytes(o.slice(1+(o.length-1)/2),{unsigned:!0}),h=u.Sec1KeyFormatter.formatECPublic({curve:{name:this.curve.name,oid:this.curve.oid},x:c,y:d});this.publicKey=f?i.createPublicKey({key:h,type:"spki",format:"der"}):(0,u.formatPem)(h,"PUBLIC KEY")}async getPublicKeyBytes(e){if(!this.publicKey)return null;let t;t="string"==typeof this.publicKey?(0,u.parsePem)(this.publicKey):this.publicKey.export({type:"spki",format:"der"});const n=u.Sec1KeyFormatter.parseECPublic(t);e=e||this.algorithmName||this.keyAlgorithmName;const i=new l.SshDataWriter(s.Buffer.alloc(512));i.writeString(e,"ascii"),i.writeString(this.curve.name,"ascii");const r=Math.ceil(this.curve.keySize/8),o=n.x.toBytes({unsigned:!0,length:r}),a=n.y.toBytes({unsigned:!0,length:r});return i.writeUInt32(1+o.length+a.length),i.writeByte(4),i.write(o),i.write(a),i.toBuffer()}async importParameters(e){if(!e.curve)throw new TypeError("A curve is required.");let t;if(e.curve.oid){if(t=o.curves.find(t=>t.oid===e.curve.oid),!t)throw new Error(`Unsupported curve OID: ${e.curve.oid}`)}else{if(!e.curve.name)throw new TypeError("A curve OID or name is required.");if(t=o.curves.find(t=>t.name===e.curve.name),!t)throw new Error(`Unsupported curve: ${e.curve.name}`)}this.algorithmName="ecdsa-sha2-"+t.name;const n=u.Sec1KeyFormatter.formatECPublic(e);if(this.publicKey=f?i.createPublicKey({key:n,type:"spki",format:"der"}):(0,u.formatPem)(n,"EC PUBLIC KEY"),e.d){const t=u.Sec1KeyFormatter.formatECPrivate(e);this.privateKey=f?i.createPrivateKey({key:t,type:"sec1",format:"der"}):(0,u.formatPem)(t,"EC PRIVATE KEY")}else this.privateKey=void 0}async exportParameters(){var e,t;if(!this.publicKey)throw new Error("Key is not present.");let n;return n="string"==typeof this.publicKey?(0,u.parsePem)(null!==(e=this.privateKey)&&void 0!==e?e:this.publicKey):(null!==(t=this.privateKey)&&void 0!==t?t:this.publicKey).export({type:this.privateKey?"sec1":"spki",format:"der"}),this.privateKey?u.Sec1KeyFormatter.parseECPrivate(n):u.Sec1KeyFormatter.parseECPublic(n)}dispose(){}}class m extends r.PublicKeyAlgorithm{constructor(e,t){super(e,e,t)}createKeyPair(){return new p(this.name)}async generateKeyPair(){const e=new p(this.name);return await e.generate(),e}createSigner(e){if(!(e instanceof p))throw new TypeError("ECDSA key pair object expected.");return new g(e,m.convertHashAlgorithmName(this.hashAlgorithmName))}createVerifier(e){if(!(e instanceof p))throw new TypeError("ECDSA key pair object expected.");return new g(e,m.convertHashAlgorithmName(this.hashAlgorithmName))}static convertHashAlgorithmName(e){return e.replace("SHA2-","SHA")}static getSignatureLength(e){return 2*(5+Math.ceil(e/8))}}t.NodeECDsa=m,m.ecdsaSha2Nistp256="ecdsa-sha2-nistp256",m.ecdsaSha2Nistp384="ecdsa-sha2-nistp384",m.ecdsaSha2Nistp521="ecdsa-sha2-nistp521",m.curves=o.curves,m.KeyPair=p;class g{constructor(e,t){this.keyPair=e,this.hashAlgorithmName=t}get digestLength(){const e=this.keyPair.curve;return e?m.getSignatureLength(e.keySize):0}async sign(e){if(!this.keyPair.privateKey)throw new Error("Private key not set.");const t=i.createSign(this.hashAlgorithmName);t.update(e);let n=t.sign(this.keyPair.privateKey);const r=new c.DerReader(n),o=r.readInteger(),a=r.readInteger(),u=Math.ceil(this.keyPair.curve.keySize/8),d=new l.SshDataWriter(s.Buffer.alloc(this.digestLength));return d.writeBinary(o.toBytes({unsigned:!0,length:u+1})),d.writeBinary(a.toBytes({unsigned:!0,length:u+1})),n=d.toBuffer(),n}async verify(e,t){if(!this.keyPair.publicKey)throw new Error("Public key not set.");const n=new l.SshDataReader(t),r=n.readBigInt(),o=n.readBigInt(),a=new c.DerWriter(s.Buffer.alloc(t.length));a.writeInteger(r),a.writeInteger(o),t=a.toBuffer();const u=i.createVerify(this.hashAlgorithmName);return u.update(e),u.verify(this.keyPair.publicKey,t)}dispose(){}}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeEncryption=void 0;const i=n(28),s=n(3),r=n(248),o=n(44);class a extends r.EncryptionAlgorithm{constructor(e,t,n,i){if(super(e),this.algorithmName=t,this.cipherMode=n,this.keySizeInBits=i,"AES"!==t)throw new Error(`Unsupported encryption algorithm: ${t}`);this.blockSizeInBits=a.getBlockSize(t)}get keyLength(){return this.keySizeInBits/8}get blockLength(){return this.blockSizeInBits/8}async createCipher(e,t,n){let i;if("CTR"===this.cipherMode||"CBC"===this.cipherMode)i=new c(e,this.keySizeInBits,this.blockSizeInBits,t,n,this.cipherMode);else{if("GCM"!==this.cipherMode)throw new Error(`Unsupported cipher mode: ${this.cipherMode}`);i=new l(e,this.keySizeInBits,this.blockSizeInBits,t,n)}return i}static getBlockSize(e){if("AES"===e)return 128;throw new Error(`Unsupported encryption algorithm: ${e}`)}}t.NodeEncryption=a;class c{constructor(e,t,n,s,r,o){this.isEncryption=e,this.keySizeInBits=t,this.blockSizeInBits=n;const a=`AES-${this.keySizeInBits}-${o}`;this.cipher=this.isEncryption?i.createCipheriv(a,s,r):i.createDecipheriv(a,s,r),this.cipher.setAutoPadding(!1)}get blockLength(){return this.blockSizeInBits/8}transform(e){const t=this.cipher.update(e);if(t.length!==e.length){const n="Result from encrypt/decrypt has invalid length "+`${t.length}, expected ${e.length}.`;throw(0,o.trace)("Error: "+n),new Error(n)}return Promise.resolve(t)}dispose(){}}class l{constructor(e,t,n,i,r){this.isEncryption=e,this.keySizeInBits=t,this.blockSizeInBits=n,this.tag=null,this.algorithmName=`aes-${this.keySizeInBits}-gcm`,this.key=s.Buffer.alloc(i.length),i.copy(this.key),this.nonce=s.Buffer.alloc(12),r.copy(this.nonce,0,0,12),this.associatedData=s.Buffer.alloc(4)}get blockLength(){return this.blockSizeInBits/8}get digestLength(){return 16}get authenticatedEncryption(){return!0}transform(e){if(e.length%this.blockLength!=0){const t="Encrypt/decrypt input has invalid length "+`${e.length}, not a multiple of block size ${this.blockLength}.`;throw(0,o.trace)("Error: "+t),new Error(t)}const t=this.isEncryption?i.createCipheriv(this.algorithmName,this.key,this.nonce):i.createDecipheriv(this.algorithmName,this.key,this.nonce),n=e.length;if(this.associatedData[0]=n>>>24,this.associatedData[1]=n>>>16,this.associatedData[2]=n>>>8,this.associatedData[3]=n,t.setAAD(this.associatedData),!this.isEncryption){if(!this.tag)throw new Error("AES-GCM tag was not set before decrypting.");t.setAuthTag(this.tag)}const s=t.update(e);if(s.length!==e.length){const t="Result from encrypt/decrypt has invalid length "+`${s.length}, expected ${e.length}.`;throw(0,o.trace)("Error: "+t),new Error(t)}t.final(),this.isEncryption?this.tag=t.getAuthTag():this.tag=null;let r=12;for(;--r>=4&&(this.nonce[r]++,0===this.nonce[r]););return Promise.resolve(s)}async sign(e){if(!this.tag)throw new Error("AES-GCM tag was not obtained by encrypting.");return this.tag}async verify(e,t){if(t.length!==this.digestLength)throw new Error("Incorrect AES-GCM tag length.");return this.tag=t,!0}dispose(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeRandom=void 0;const i=n(28);t.NodeRandom=class{getBytes(e){i.randomBytes(e.length).copy(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshProtocol=void 0;const i=n(44),s=n(3),r=n(173),o=n(134),a=n(100),c=n(36),l=n(52),u=n(257),d=n(80),h=n(45);class f{constructor(e,t){this.sequence=e,this.message=t}}class p{constructor(e,t,n){this.config=t,this.metrics=n,this.sessionSemaphore=new o.Semaphore(1),this.inboundPacketSequence=0,this.outboundPacketSequence=0,this.inboundFlow=0,this.outboundFlow=0,this.recentSentMessages=new r.Queue,this.sendWriter=new c.SshDataWriter(s.Buffer.alloc(1024)),this.receiveWriter=new c.SshDataWriter(s.Buffer.alloc(1024)),this.extensions=null,this.kexService=null,this.algorithms=null,this.outgoingMessagesHaveLatencyInfo=!1,this.incomingMessagesHaveLatencyInfo=!1,this.outgoingMessagesHaveReconnectInfo=!1,this.incomingMessagesHaveReconnectInfo=!1,this.stream=e}get lastIncomingSequence(){return this.inboundPacketSequence-1}getSentMessages(e){if(e===this.outboundPacketSequence+1)return[];if(this.recentSentMessages.size>0&&e<this.recentSentMessages.peek().sequence)return null;const t=new Array;for(let n of this.recentSentMessages)if(n.sequence>=e){const e=n.message;e instanceof u.KeyExchangeMessage||e instanceof l.DisconnectMessage||t.push(e)}return t}async writeProtocolVersion(e,t){const n=this.stream;if(!n)throw new Error("SSH session disconnected.");const i=s.Buffer.from(e+"\r\n");return await n.write(i,t),this.metrics.addMessageSent(i.length),Promise.resolve()}async readProtocolVersion(e){const t=this.stream;if(!t)throw new Error("SSH session disconnected.");const n=s.Buffer.alloc(255);let i=0;for(let s=0;s<n.length;s++){const r=await t.read(1,e);if(!r)break;n[s]=r[0];const o=13,a=10;if(s>0&&n[s-1]===o&&n[s]===a){const e=n.toString("utf8",0,s-1);if(e.startsWith("SSH-"))return this.metrics.addMessageReceived(s+1),e;if(i>20)break;i++,s=-1}}throw new h.SshConnectionError("Failed to read the protocol version",l.SshDisconnectReason.protocolError)}async handleNewKeys(e){try{await this.sessionSemaphore.wait(e),this.inboundFlow=0,this.outboundFlow=0,this.algorithms=this.kexService.finishKeyExchange()}finally{this.sessionSemaphore.release()}}async read(e,t){const n=this.stream;if(!n)return!1;let s=0;do{let r;try{r=await n.read(e.length-s,t)}catch(e){if(!(e instanceof Error))throw e;if(n.isDisposed)return!1;throw n.dispose(),this.stream=null,(0,i.trace)("Error reading from stream: "+e.message),new h.SshConnectionError("Error reading from stream: "+e.message,l.SshDisconnectReason.connectionLost)}if(!r)return!1;r.copy(e,s),s+=r.length}while(s<e.length);return!0}async write(e,t){const n=this.stream;if(!n)return!1;try{await n.write(e,t)}catch(e){if(!(e instanceof Error))throw e;if(n.isDisposed)return!1;throw n.dispose(),this.stream=null,(0,i.trace)("Error writing to stream: "+e.message),new h.SshConnectionError("Error writing to stream: "+e.message,l.SshDisconnectReason.connectionLost)}return!0}async considerReExchange(e,t){const n=this.kexService;if(!n)return;let i=null,s=null;!n.exchanging&&(e||this.inboundFlow+this.outboundFlow>this.config.keyRotationThreshold)&&([i,s]=await n.startKeyExchange(e)),i&&(await this.sendMessage(i,t),s&&await this.sendMessage(s,t))}async computeHmac(e,t,n){const i=new c.SshDataWriter(s.Buffer.alloc(4+t.length));return i.writeUInt32(n),i.write(t),await e.sign(i.toBuffer())}async verifyHmac(e,t,n,i){const r=new c.SshDataWriter(s.Buffer.alloc(4+t.length));return r.writeUInt32(n),r.write(t),await e.verify(r.toBuffer(),i)}async readAndVerifyHmac(e,t,n,i){if(!await this.read(n,i))return!1;if(!await this.verifyHmac(e,t,this.inboundPacketSequence,n))throw new h.SshConnectionError("Invalid MAC",l.SshDisconnectReason.macError);return!0}async sendMessage(e,t){var n;const r=this.algorithms,o=null==r?void 0:r.compressor,a=null==r?void 0:r.cipher,c=null==r?void 0:r.messageSigner;let l;await this.sessionSemaphore.wait(t);try{const r=a?Math.max(8,a.blockLength):8,u=p.packetLengthSize+p.paddingLengthSize;if(this.sendWriter.position=u,e.write(this.sendWriter),this.outgoingMessagesHaveReconnectInfo&&(this.sendWriter.writeUInt64(this.lastIncomingSequence),this.outgoingMessagesHaveLatencyInfo)){const e=Math.min(4294967295,Math.round(1e3*(this.metrics.time-this.lastIncomingTimestamp)));this.sendWriter.writeUInt32(e)}let h=this.sendWriter.toBuffer().slice(u);null!=o&&(h=o.compress(h));let m=r-((!((null==c?void 0:c.encryptThenMac)||(null==c?void 0:c.authenticatedEncryption))?p.packetLengthSize:0)+p.paddingLengthSize+h.length)%r;m<4&&(m+=r);const g=p.paddingLengthSize+h.length+m;this.sendWriter.position=0,this.sendWriter.writeUInt32(g),this.sendWriter.writeByte(m),null!=o?this.sendWriter.write(h):this.sendWriter.position+=h.length,this.sendWriter.writeRandom(m),h=this.sendWriter.toBuffer();let y=null;if((null==c?void 0:c.encryptThenMac)&&a){const e=h.slice(p.packetLengthSize,h.length);(await a.transform(e)).copy(e),y=await this.computeHmac(c,h,this.outboundPacketSequence)}else if(null==c?void 0:c.authenticatedEncryption){let e=h.slice(p.packetLengthSize,h.length);(await a.transform(e)).copy(e),y=await c.sign(e)}else c&&(y=await this.computeHmac(c,h,this.outboundPacketSequence)),a&&(h=await a.transform(h));if(e instanceof d.ChannelDataMessage?i.traceData.enabled&&(0,i.traceData)(`Sending #${this.outboundPacketSequence} ${e}`):(0,i.trace)(`Sending #${this.outboundPacketSequence} ${e}`),this.incomingMessagesHaveReconnectInfo){const t=new f(this.outboundPacketSequence,e);t.sentTime=this.metrics.time,this.recentSentMessages.enqueue(t)}if(this.outboundPacketSequence++,this.outboundFlow+=g,y){const e=s.Buffer.concat([h,y],h.length+y.length);l=await this.write(e,t)}else l=await this.write(h,t);this.metrics.addMessageSent(p.packetLengthSize+g+(null!==(n=null==c?void 0:c.digestLength)&&void 0!==n?n:0))}finally{this.sessionSemaphore.release()}return await this.considerReExchange(!1,t),l}async receiveMessage(e){var t;const n=this.algorithms,s=null==n?void 0:n.decipher,r=null==n?void 0:n.messageVerifier,o=null==n?void 0:n.decompressor,u=!((null==r?void 0:r.encryptThenMac)||(null==r?void 0:r.authenticatedEncryption)),f=u?s?Math.max(8,s.blockLength):8:p.packetLengthSize;this.receiveWriter.position=f;let m=this.receiveWriter.toBuffer();if(!await this.read(m,e))return null;this.lastIncomingTimestamp=this.metrics.time,s&&u&&(m=await s.transform(m),this.receiveWriter.position=0,this.receiveWriter.write(m));const g=new c.SshDataReader(m).readUInt32();if(g>p.maxPacketLength)throw(0,i.trace)("Invalid packet length."),new h.SshConnectionError("Invalid packet length.",l.SshDisconnectReason.protocolError);const y=p.packetLengthSize+g;y>f&&this.receiveWriter.skip(y-f),r&&this.receiveWriter.skip(r.digestLength);const v=this.receiveWriter.toBuffer(),S=v.slice(0,y),_=v.slice(y);let E=S.slice(f,y);if(E.length>0){if(!await this.read(E,e))return null;if((null==r?void 0:r.encryptThenMac)&&!await this.readAndVerifyHmac(r,S,_,e))return null;if(s){if(null==r?void 0:r.authenticatedEncryption){if(!await this.read(_,e))return null;await r.verify(E,_)}try{E=await s.transform(E)}catch(e){throw(null==r?void 0:r.authenticatedEncryption)?new h.SshConnectionError("Invalid MAC",l.SshDisconnectReason.macError):e}this.receiveWriter.position=f,this.receiveWriter.write(E)}}if(r&&!r.encryptThenMac&&!r.authenticatedEncryption&&!await this.readAndVerifyHmac(r,S,_,e))return null;const w=S[p.packetLengthSize];let b=S.slice(p.packetLengthSize+p.paddingLengthSize,p.packetLengthSize+(g-w));if(o&&(b=o.decompress(b)),this.incomingMessagesHaveReconnectInfo){let e,t;if(this.incomingMessagesHaveLatencyInfo){const n=new c.SshDataReader(b.slice(b.length-12,b.length));e=n.readUInt64(),t=n.readUInt32()/1e3,b=b.slice(0,b.length-12)}else{e=new c.SshDataReader(b.slice(b.length-8,b.length)).readUInt64(),t=0,b=b.slice(0,b.length-8)}for(;this.recentSentMessages.size>0;){const n=this.recentSentMessages.peek();if(n.sequence>e)break;if(this.stream&&this.incomingMessagesHaveLatencyInfo&&n.sequence===e){const e=this.lastIncomingTimestamp-n.sentTime-t;this.metrics.updateLatency(e)}this.recentSentMessages.dequeue()}}const C=b[0];let T=a.SshMessage.create(C,b);if(!T){const e=new l.UnimplementedMessage;e.sequenceNumber=this.inboundPacketSequence,e.unimplementedMessageType=C,T=e}return T instanceof d.ChannelDataMessage?i.traceData.enabled&&(0,i.traceData)(`Receiving #${this.inboundPacketSequence} ${T}`):(0,i.trace)(`Receiving #${this.inboundPacketSequence} ${T}`),await this.sessionSemaphore.wait(e),this.inboundPacketSequence++,this.inboundFlow+=g,this.sessionSemaphore.release(),this.metrics.addMessageReceived(p.packetLengthSize+g+(null!==(t=null==r?void 0:r.digestLength)&&void 0!==t?t:0)),await this.considerReExchange(!1,e),T}dispose(){try{this.stream&&this.stream.close().catch(e=>{(0,i.trace)("Error closing stream: "+e.message)})}catch(e){if(!(e instanceof Error))throw e;(0,i.trace)("Error closing stream: "+e.message)}this.stream=null,this.metrics.updateLatency(0),this.algorithms&&this.algorithms.dispose()}}t.SshProtocol=p,p.maxPacketLength=1048576,p.packetLengthSize=4,p.paddingLengthSize=1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshSessionAlgorithms=void 0;t.SshSessionAlgorithms=class{dispose(){this.cipher&&this.cipher.dispose(),this.decipher&&this.decipher.dispose(),this.signer&&this.signer.dispose(),this.verifier&&this.verifier.dispose()}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SshClientSession=void 0;const i=n(44),s=n(133),r=n(52),o=n(259),a=n(81),c=n(82),l=n(131),u=n(258),d=n(135),h=n(45);class f extends s.SshSession{constructor(e){super(e,!0),this.serviceRequests=new Map,this.clientAuthCompletion=null}async authenticate(e,t){return!!await this.authenticateServer(t)&&!!await this.authenticateClient(e,t)}async authenticateServer(e){if(!this.kexService||!this.kexService.hostKey)throw new Error("Encrypt the session before authenticating.");try{this.principal=await this.raiseAuthenticatingEvent(new o.SshAuthenticatingEventArgs(o.SshAuthenticationType.serverPublicKey,{publicKey:this.kexService.hostKey},e))}catch(e){if(!(e instanceof Error))throw e;throw(0,i.trace)("Error while authenticating server: "+e.message),e}return this.principal?((0,i.trace)(`${this} server authenticated.`),!0):(await this.close(r.SshDisconnectReason.hostKeyNotVerifiable,"Server authentication failed."),(0,i.trace)(`${this} server authentication failed.`),!1)}authenticateClient(e,t,n){if(!e)throw new TypeError("A credentials object is required.");return"function"==typeof t?this.authenticateClientWithCompletion(e,t,n):new Promise(async(n,i)=>{await this.authenticateClientWithCompletion(e,(e,t)=>{e?i(e):n(t)},t)})}async authenticateClientWithCompletion(e,t,n){if(this.clientAuthCompletion=new a.PromiseCompletionSource,this.clientAuthCompletion.promise.then(e=>t(void 0,e),e=>t(e)),n){if(n.isCancellationRequested)throw new c.CancellationError;n.onCancellationRequested(e=>{this.clientAuthCompletion&&this.clientAuthCompletion.reject(new c.CancellationError)})}let i=this.getService(u.AuthenticationService);if(!i){const e=new r.ServiceRequestMessage;e.serviceName=u.AuthenticationService.serviceName,await this.sendMessage(e,n),i=this.activateService(u.AuthenticationService)}await i.authenticateClient(e,n)}onAuthenticationComplete(e){e?(0,i.trace)(`${this} client authenticated.`):(0,i.trace)(`${this} client authentication failed.`),this.clientAuthCompletion&&(this.clientAuthCompletion.resolve(e),this.clientAuthCompletion=null)}async requestService(e,t){let n=!1,i=this.serviceRequests.get(e);if(i||(i=new a.PromiseCompletionSource,this.serviceRequests.set(e,i),n=!0),n){const n=new r.ServiceRequestMessage;n.serviceName=e,await this.sendMessage(n,t)}await i.promise}async handleServiceAcceptMessage(e,t){const n=this.serviceRequests.get(e.serviceName);null==n||n.resolve(!0)}async openChannel(e,t,n){if(!this.connectionService){const e=new r.ServiceRequestMessage;e.serviceName=d.ConnectionService.serviceName,await this.sendMessage(e,n)}return await super.openChannel(e,t,n)}handleDisconnected(){return this.reconnecting?(this.reconnecting=!1,!1):super.handleDisconnected()}async reconnect(e,t){if(this.isClosed)throw new h.ObjectDisposedError(this);if(this.isConnected)throw new Error("Already connected.");if(!this.protocol)throw new Error("The session was never previously connected.");if(this.reconnecting)throw new Error("Already reconnecting.");this.reconnecting=!0;try{await this.reconnectInternal(e,t)}finally{this.reconnecting=!1}}async reconnectInternal(t,n){var s,o,a,c,u,d;const f=this.sessionId,p=this.protocol,m=null===(s=this.kexService)||void 0===s?void 0:s.hostKey;if(!(f&&p&&this.kexService&&m&&(null===(o=p.extensions)||void 0===o?void 0:o.has(l.SshProtocolExtensionNames.sessionReconnect))))throw new Error("Reconnect was not enabled for this session.");let g;try{if(this.sessionId=null,await this.connect(t,n),!this.sessionId||!this.algorithms||!this.algorithms.signer)throw new Error("Session is not encrypted.");const e=this.kexService.hostKey,s=e?await e.getPublicKeyBytes():null,o=await m.getPublicKeyBytes();if(!s||!o||!s.equals(o)){const e="The server host key is different.";throw(0,i.trace)(`Reconnection failed: ${e}`),new h.SshReconnectError(e,r.SshReconnectFailureReason.differentServerHostKey)}g=this.sessionId}catch(e){throw this.protocol=p,super.handleDisconnected(),e}finally{this.sessionId=f,this.kexService.hostKey=m}const y=await this.createReconnectToken(f,g),v=new r.SessionReconnectRequestMessage;v.requestType="session-reconnect@microsoft.com",v.clientReconnectToken=y,v.lastReceivedSequenceNumber=p.lastIncomingSequence,v.wantReply=!0;const S=await this.requestResponse(v,r.SessionReconnectResponseMessage,r.SessionReconnectFailureMessage,n);if(S instanceof r.SessionReconnectFailureMessage){const e=null!==(a=S.reasonCode)&&void 0!==a?a:r.SshReconnectFailureReason.unknownServerFailure,t=null!==(c=S.description)&&void 0!==c?c:"The server rejected the reconnect request.";throw(0,i.trace)(`Reconnection failed: ${t}`),this.protocol=p,new h.SshReconnectError(t,e)}if(!this.verifyReconnectToken(f,g,null!==(u=S.serverReconnectToken)&&void 0!==u?u:e.alloc(0))){const e="The reconnect token provided by the server was invalid.";throw(0,i.trace)(`Reconnection failed: ${e}`),new h.SshReconnectError(e,r.SshReconnectFailureReason.invalidServerReconnectToken)}(0,i.trace)("Reconnect request was accepted by the server.");const _=p.getSentMessages((null!==(d=S.lastReceivedSequenceNumber)&&void 0!==d?d:0)+1);if(!_){const e="Client is unable to re-send messages requested by the server.";throw(0,i.trace)(`Reconnection failed: ${e}`),new h.SshReconnectError(e,r.SshReconnectFailureReason.clientDroppedMessages)}let E=0;for(let e of _)await this.sendMessage(e,n),E++;p.dispose(),this.metrics.addReconnection(),(0,i.trace)(`Reconnected. Re-sent ${E} dropped messages.`)}dispose(){this.clientAuthCompletion&&this.clientAuthCompletion.reject(new h.ObjectDisposedError(this)),super.dispose()}}t.SshClientSession=f}).call(this,n(3).Buffer)},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SshServerSession=void 0;const i=n(133),s=n(8),r=n(52),o=n(45),a=n(131),c=n(44);class l extends i.SshSession{constructor(e,t){super(e,!1),this.reconnectedEmitter=new s.Emitter,this.onReconnected=this.reconnectedEmitter.event,this.credentials={publicKeys:[]};const n=e.protocolExtensions.includes(a.SshProtocolExtensionNames.sessionReconnect);if(n&&!t)throw new Error("When reconnect is enabled, server sessions require a reference to a shared collection to track reconnectable sessions.");if(!n&&t)throw new Error("When reconnect is not enabled, the reconnectable sessions collection is not applicable.");this.reconnectableSessions=t}async handleServiceRequestMessage(e,t){if(!this.activateService(e.serviceName))throw new o.SshConnectionError(`Service "${e.serviceName}" not available.`,r.SshDisconnectReason.serviceNotAvailable);{const n=new r.ServiceAcceptMessage;n.serviceName=e.serviceName,await this.sendMessage(n,t)}}async handleRequestMessage(e,t){var n;if("session-reconnect@microsoft.com"===e.requestType&&(null===(n=this.config.protocolExtensions)||void 0===n?void 0:n.includes(a.SshProtocolExtensionNames.sessionReconnect))){const n=e.convertTo(new r.SessionReconnectRequestMessage);await this.reconnect(n,t)}else await super.handleRequestMessage(e,t)}async enableReconnect(e){await super.enableReconnect(e),this.reconnectableSessions.includes(this)||this.reconnectableSessions.push(this)}handleDisconnected(){return!!this.reconnecting||super.handleDisconnected()}async reconnect(t,n){var i,s,o;if(!this.reconnectableSessions)throw new Error("Disconnected sessions collection should have been initialied when reconnect is enabled.");let a;for(let n of this.reconnectableSessions)if(n!==this&&await this.verifyReconnectToken(n.sessionId,this.sessionId,null!==(i=t.clientReconnectToken)&&void 0!==i?i:e.alloc(0))){a=n,this.reconnectableSessions.splice(this.reconnectableSessions.indexOf(a),1);break}if(!a||a.isClosed){const e="Requested reconnect session was not found or the reconnect token provided by the client was invalid.";(0,c.trace)(`Reconnect failed: ${e}`);const t=new r.SessionReconnectFailureMessage;return t.reasonCode=r.SshReconnectFailureReason.sessionNotFound,t.description=e,void await this.sendMessage(t,n)}const l=a.protocol.getSentMessages((null!==(s=t.lastReceivedSequenceNumber)&&void 0!==s?s:0)+1);if(!l){this.reconnectableSessions.push(a);const e="Server is unable to re-send messages requested by the client.";(0,c.trace)(`Reconnect failed: ${e}`);const t=new r.SessionReconnectFailureMessage;return t.reasonCode=r.SshReconnectFailureReason.serverDroppedMessages,t.description=e,void await this.sendMessage(t,n)}const u=new r.SessionReconnectResponseMessage;u.serverReconnectToken=await this.createReconnectToken(a.sessionId,this.sessionId),u.lastReceivedSequenceNumber=a.protocol.lastIncomingSequence,await this.sendMessage(u,n);try{for(a.reconnecting=!0,null===(o=a.protocol)||void 0===o||o.dispose();a.isConnected;)await new Promise(e=>setTimeout(()=>e(),5));a.protocol=this.protocol,a.protocol.kexService=a.kexService,this.protocol=void 0;for(let e of l)await a.sendMessage(e,n);this.dispose()}finally{a.reconnecting=!1}this.reconnectableSessions.push(a),a.metrics.addReconnection(),a.processMessages().catch(e=>{(0,c.trace)(`Unhandled error processing messages: ${e.message||JSON.stringify(e)}`)}),(0,c.trace)(`Session reconnected. Re-sent ${l.length} dropped messages.`),a.reconnectedEmitter.fire()}dispose(){if(this.reconnectableSessions){const e=this.reconnectableSessions.indexOf(this);e>=0&&this.reconnectableSessions.splice(e,1)}super.dispose()}}t.SshServerSession=l}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketStream=t.NodeStream=t.BaseStream=void 0;const i=n(3),s=n(8),r=n(82),o=n(45);function a(e,t){t&&(t.isCancellationRequested?e(new r.CancellationError):t.onCancellationRequested(()=>{e(new r.CancellationError)}))}class c{constructor(){this.incomingData=[],this.pendingReads=[],this.error=null,this.disposed=!1,this.closedEmitter=new s.Emitter,this.closed=this.closedEmitter.event}onData(e){for(;this.pendingReads.length>0;){const t=this.pendingReads.shift();if(t.count>=e.length)return void t.resolve(e);{const n=e.slice(0,t.count);e=e.slice(t.count),t.resolve(n)}}this.incomingData.push(e)}onEnd(){for(;this.pendingReads.length>0;){this.pendingReads.shift().resolve(null)}this.incomingData.push(i.Buffer.alloc(0))}onError(e){for(this.error||(this.error=e);this.pendingReads.length>0;){this.pendingReads.shift().reject(e)}}async read(e,t){if(this.disposed)throw new o.ObjectDisposedError(this);if(this.incomingData.length>0){let t=this.incomingData[0];return 0===t.length?null:(e>=t.length?this.incomingData.shift():(this.incomingData[0]=t.slice(e),t=t.slice(0,e)),t)}if(this.error)throw this.error;return await new Promise((n,i)=>{if(t){if(t.isCancellationRequested)return void i(new r.CancellationError);t.onCancellationRequested(()=>{for(let e=0;e<this.pendingReads.length;e++)if(Object.is(t,this.pendingReads[e].cancellation)){this.pendingReads.splice(e--,1)[0].reject(new r.CancellationError)}})}this.pendingReads.push({count:e,resolve:n,reject:i,cancellation:t})})}dispose(){if(!this.disposed){this.disposed=!0;const e=new o.ObjectDisposedError(this);this.onError(e),this.fireOnClose(e)}}fireOnClose(e){this.closedEmitter.fire({error:e})}get isDisposed(){return this.disposed}}t.BaseStream=c;t.NodeStream=class extends c{constructor(e,t){if(super(),!e)throw new TypeError("Duplex or Readable/Writable stream are required.");this.readStream=e,this.writeStream=t||e,this.readStream.on("data",this.onData.bind(this)),this.readStream.on("end",this.onEnd.bind(this)),this.readStream.on("error",this.onError.bind(this)),this.readStream.on("close",()=>{this.onEnd(),this.fireOnClose()})}async write(e,t){if(!e)throw new TypeError("Data is required.");if(this.disposed)throw new o.ObjectDisposedError(this);return new Promise((n,i)=>{a(i,t),this.writeStream.write(e,e=>{e?i(e):n()})})}async close(e,t){if(this.disposed)throw new o.ObjectDisposedError(this);await new Promise((e,n)=>{a(n,t),this.writeStream.end(e)}),this.disposed=!0,this.onError(e||new o.ObjectDisposedError(this)),this.closedEmitter.fire({error:e})}dispose(){if(!this.disposed){const e=new o.ObjectDisposedError(this);this.readStream.destroy(e),this.writeStream.destroy(e)}super.dispose()}};t.WebSocketStream=class extends c{constructor(e){if(super(),this.websocket=e,!e)throw new TypeError("WebSocket is required.");if("string"==typeof e.binaryType&&"arraybuffer"!==e.binaryType)throw new Error("WebSocket must use arraybuffer binary type.");e.onmessage=e=>{this.onData(i.Buffer.from(e.data))},e.onclose=e=>{if(e.wasClean)this.onEnd();else{const t=new Error(e.reason);t.code=e.code,this.onError(t)}}}async write(e,t){if(!e)throw new TypeError("Data is required.");if(this.disposed)throw new o.ObjectDisposedError(this);if("readyState"in this.websocket&&(2===this.websocket.readyState||3===this.websocket.readyState))throw new DOMException("WebSocket is already in CLOSING or CLOSED state.","InvalidStateError");this.websocket.send(e)}async close(e,t){if(this.disposed)throw new o.ObjectDisposedError(this);if(e){const t="number"==typeof e.code?e.code:void 0;this.websocket.close(t,e.message)}else this.websocket.close();this.disposed=!0,this.closedEmitter.fire({error:e}),this.onError(e||new Error("Stream closed."))}dispose(){this.disposed||this.websocket.close(),super.dispose()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshRpcMessageStream=void 0;const i=n(8),s=n(3),r=n(36);class o{constructor(e){this.channel=e,this.errorEmitter=new i.Emitter,this.closeEmitter=new i.Emitter,this.partialMessageEmitter=new i.Emitter,this.callback=null,this.messageBuffer=new r.SshDataWriter(s.Buffer.alloc(1024)),this.headersLength=null,this.messageLength=null,this.onError=this.errorEmitter.event,this.onClose=this.closeEmitter.event,this.onPartialMessage=this.partialMessageEmitter.event,this.eventRegistration=this.channel.onDataReceived(this.onDataReceived.bind(this)),this.channel.onClosed(e=>{e.error&&this.errorEmitter.fire(e.error),this.closeEmitter.fire()})}listen(e){this.callback=e}dispose(){this.eventRegistration&&this.eventRegistration.dispose()}onDataReceived(e){if(this.messageBuffer.write(e),this.channel.adjustWindow(e.length),e=this.messageBuffer.toBuffer(),null===this.messageLength){const t=e.indexOf("\r\n\r\n");if(t<0)return;const n=e.slice(0,t).toString();if(!n.startsWith("Content-Length: "))throw new Error(`Message does not start with JSON-RPC headers.\n${n}`);this.headersLength=t+"\r\n\r\n".length,this.messageLength=parseInt(n.substr("Content-Length: ".length,t-"Content-Length: ".length),10)}const t=this.messageBuffer.position,n=this.headersLength+this.messageLength;if(t>=n){if(this.callback){const t=e.slice(this.headersLength,n).toString();let i;try{i=JSON.parse(t)}catch(e){if(!(e instanceof Error))throw e;throw new Error(`Failed to parse JSON-RPC message: ${e.message}\n${t}`)}this.callback(i)}this.messageLength=null,this.messageBuffer.position=0,t>n&&this.onDataReceived(e.slice(n))}}}class a{constructor(e){this.channel=e,this.errorEmitter=new i.Emitter,this.closeEmitter=new i.Emitter,this.onError=this.errorEmitter.event,this.onClose=this.closeEmitter.event,this.channel.onClosed(e=>{e.error&&this.errorEmitter.fire([e.error,e.errorMessage&&{jsonrpc:e.errorMessage}||void 0,e.exitStatus]),this.closeEmitter.fire()})}write(e){const t=JSON.stringify(e),n=s.Buffer.from(t),i=s.Buffer.from("Content-Length: "+n.length+"\r\n\r\n"),r=s.Buffer.alloc(i.length+n.length);i.copy(r,0),n.copy(r,i.length),this.channel.send(r).catch(e=>{this.errorEmitter.fire([e,void 0,void 0])})}dispose(){}}t.SshRpcMessageStream=class{constructor(e){this.reader=new o(e),this.writer=new a(e)}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SessionContour=void 0;const i=n(45),s=n(173),r=n(134);class o{constructor(e=256){if(this.intervalMs=o.initialInterval,this.count=0,this.updateQueue=new s.Queue,this.updateSemaphore=new r.Semaphore(0),this.disposed=!1,e<2||0!=(e&e-1))throw new Error("Contour intervals must be a power of two.");this.maxIntervals=e,this.intervalBytesSent=new Array(e),this.intervalBytesReceived=new Array(e),this.intervalLatencyMin=new Array(e),this.intervalLatencyMax=new Array(e),this.intervalLatencySum=new Array(e),this.intervalLatencyCount=new Array(e),this.intervalLatencyAvg=new Array(e),this.intervalBytesSent.fill(0),this.intervalBytesReceived.fill(0),this.intervalLatencyMin.fill(0),this.intervalLatencyMax.fill(0),this.intervalLatencySum.fill(0),this.intervalLatencyCount.fill(0),this.intervalLatencyAvg.fill(0)}get intervalCount(){return this.count}get interval(){return this.intervalMs}get bytesSent(){return this.intervalBytesSent.slice(0,this.count)}get bytesReceived(){return this.intervalBytesReceived.slice(0,this.count)}get latencyMinMs(){return this.intervalLatencyMin.slice(0,this.count)}get latencyMaxMs(){return this.intervalLatencyMax.slice(0,this.count)}get latencyAverageMs(){return this.intervalLatencyAvg.slice(0,this.count)}onMessageSent(e){this.updateQueue.enqueue({time:e.time,bytesSent:e.size}),this.updateSemaphore.tryRelease()}onMessageReceived(e){this.updateQueue.enqueue({time:e.time,bytesReceived:e.size}),this.updateSemaphore.tryRelease()}onLatencyUpdated(e){this.updateQueue.enqueue(e),this.updateSemaphore.tryRelease()}onSessionClosed(){this.updateSemaphore.tryRelease()}async collectMetrics(e,t){if(!e)throw new TypeError("A session metrics object is required.");if(this.disposed)throw new i.ObjectDisposedError(this);const n=[];n.push(e.onMessageSent(this.onMessageSent.bind(this))),n.push(e.onMessageReceived(this.onMessageReceived.bind(this))),n.push(e.onLatencyUpdated(this.onLatencyUpdated.bind(this))),n.push(e.onSessionClosed(this.onSessionClosed.bind(this)));try{for(;!(null==t?void 0:t.isCancellationRequested);){try{await this.updateSemaphore.wait(t)}catch(e){break}const e=this.updateQueue.dequeue();if(!e)break;const n=this.updateInterval(e.time);e.bytesSent&&(this.intervalBytesSent[n]+=e.bytesSent),e.bytesReceived&&(this.intervalBytesReceived[n]+=e.bytesReceived);const i=e.latency;i&&((!this.intervalLatencyMin[n]||i<this.intervalLatencyMin[n])&&(this.intervalLatencyMin[n]=i),(!this.intervalLatencyMax[n]||i>this.intervalLatencyMax[n])&&(this.intervalLatencyMax[n]=i),this.intervalLatencySum[n]+=i,this.intervalLatencyCount[n]++,this.intervalLatencyAvg[n]=this.intervalLatencySum[n]/this.intervalLatencyCount[n])}this.disposed&&this.updateSemaphore.dispose()}finally{for(let e of n)e.dispose()}}updateInterval(e){let t=Math.floor(e/this.intervalMs);if(t>=this.intervalCount){for(;t>=this.maxIntervals;)this.expandIntervals(),t=Math.floor(e/this.intervalMs);this.count=t+1}return t}expandIntervals(){const e=(e,t,n)=>0===e?t:0===t?e:n(e,t),t=this.maxIntervals/2;for(let n=0;n<t;n++){const t=2*n,i=2*n+1;this.intervalBytesSent[n]=this.intervalBytesSent[t]+this.intervalBytesSent[i],this.intervalBytesReceived[n]=this.intervalBytesReceived[t]+this.intervalBytesReceived[i],this.intervalLatencyMin[n]=e(this.intervalLatencyMin[t],this.intervalLatencyMin[i],Math.min),this.intervalLatencyMax[n]=e(this.intervalLatencyMax[t],this.intervalLatencyMax[i],Math.max),this.intervalLatencySum[n]=this.intervalLatencySum[t]+this.intervalLatencySum[i];const s=this.intervalLatencyCount[t]+this.intervalLatencyCount[i];this.intervalLatencyCount[n]=s,this.intervalLatencyAvg[n]=0===s?0:this.intervalLatencySum[n]/this.intervalLatencyCount[n]}this.intervalBytesSent.fill(0,t,this.maxIntervals),this.intervalBytesReceived.fill(0,t,this.maxIntervals),this.intervalLatencyMin.fill(0,t,this.maxIntervals),this.intervalLatencyMax.fill(0,t,this.maxIntervals),this.intervalLatencySum.fill(0,t,this.maxIntervals),this.intervalLatencyCount.fill(0,t,this.maxIntervals),this.intervalLatencyAvg.fill(0,t,this.maxIntervals),this.intervalMs*=2}dispose(){this.disposed=!0,this.updateSemaphore.tryRelease()}export(){const t=e=>Math.max(0,Math.ceil(Math.log2(Math.max(...e)/255))),n=(e,t)=>Math.round(e/Math.pow(2,t)),i=e.alloc(3+5*(2+this.intervalCount)),s=Math.log2(this.interval/o.initialInterval);i[0]=1,i[1]=5,i[2]=s,i[3]=t(this.latencyMinMs),i[4]=t(this.latencyMaxMs),i[5]=t(this.latencyAverageMs),i[6]=t(this.bytesSent),i[7]=t(this.bytesReceived),i[8]=a.latencyMin,i[9]=a.latencyMax,i[10]=a.latencyAverage,i[11]=a.bytesSent,i[12]=a.bytesReceived;for(let e=0;e<this.intervalCount;e++){const t=13+5*e;i[t+0]=n(this.intervalLatencyMin[e],i[3]),i[t+1]=n(this.intervalLatencyMax[e],i[4]),i[t+2]=n(this.intervalLatencyAvg[e],i[5]),i[t+3]=n(this.intervalBytesSent[e],i[6]),i[t+4]=n(this.intervalBytesReceived[e],i[7])}return i.toString("base64")}static import(t){const n=e.from(t,"base64");if(n.length<3)throw new Error("Invalid session contour string.");const i=n[0],s=n[1],r=n[2];if(1!==i)throw new Error(`Unsupported session contour version: ${i}`);const c=(n.length-3)/s-2;if(c<1||n.length!==3+s*(c+2))throw new Error("Incomplete session contour string.");const l=Math.pow(2,Math.ceil(Math.log2(c))),u=new o(l);u.intervalMs=Math.pow(2,r)*o.initialInterval,u.count=c;const d=new Array(s);for(let e=0;e<s;e++)d[e]=Math.pow(2,n[3+e]);const h=new Array(s);for(let e=0;e<s;e++)h[e]=n[3+s+e];for(let e=0;e<c;e++){const t=3+(2+e)*s;for(let i=0;i<s;i++)switch(h[i]){case a.latencyMin:u.intervalLatencyMin[e]=n[t+i]*d[i];break;case a.latencyMax:u.intervalLatencyMax[e]=n[t+i]*d[i];break;case a.latencyAverage:u.intervalLatencyAvg[e]=u.intervalLatencySum[e]=n[t+i]*d[i],u.intervalLatencyCount[e]=0===n[t+i]?0:1;break;case a.bytesSent:u.intervalBytesSent[e]=n[t+i]*d[i];break;case a.bytesReceived:u.intervalBytesReceived[e]=n[t+i]*d[i]}}return u}}var a;t.SessionContour=o,o.initialInterval=1e3,function(e){e[e.none=0]="none",e[e.latencyMin=1]="latencyMin",e[e.latencyMax=2]="latencyMax",e[e.latencyAverage=3]="latencyAverage",e[e.bytesSent=11]="bytesSent",e[e.bytesReceived=12]="bytesReceived"}(a||(a={}))}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultiChannelStream=void 0;const i=n(8),s=n(44),r=n(444),o=n(133),a=n(131),c=n(52),l=n(135);t.MultiChannelStream=class{constructor(e){if(this.transportStream=e,this.disposed=!1,this.disposables=[],this.closedEmitter=new i.Emitter,this.onClosed=this.closedEmitter.event,this.channelOpeningEmitter=new i.Emitter,!e)throw new TypeError("transportStream is required.");const t=new a.SshSessionConfiguration(!1);this.session=new o.SshSession(t),this.session.onClosed(this.onSessionClosed,this,this.disposables),this.session.onChannelOpening(this.onSessionChannelOpening,this,this.disposables)}get isClosed(){return this.disposed||this.session.isClosed}get onChannelOpening(){return this.isClosed||this.session.activateService(l.ConnectionService),this.channelOpeningEmitter.event}async connect(e){await this.session.connect(this.transportStream,e)}async acceptChannel(e,t){return await this.session.connect(this.transportStream,t),await this.session.acceptChannel(e,t)}async acceptStream(e,t){return new r.SshStream(await this.acceptChannel(e,t))}async openChannel(e,t){return await this.session.connect(this.transportStream,t),await this.session.openChannel(null!=e?e:null,t)}async openStream(e,t){return new r.SshStream(await this.openChannel(e,t))}async connectAndRunUntilClosed(e){const t=[],n=new Promise((n,i)=>{null==e||e.onCancellationRequested(i,null,t),this.session.onClosed(n,null,t)});try{await this.connect(e),await n}finally{t.forEach(e=>e.dispose()),await this.close()}}dispose(){if(!this.disposed){this.disposed=!0,this.session.dispose(),this.unsubscribe();try{this.transportStream&&this.transportStream.close().catch(e=>{(0,s.trace)("Error closing transport stream: "+e.message)})}catch(e){if(!(e instanceof Error))throw e;(0,s.trace)("Error closing transport stream: "+e.message)}}}async close(){this.disposed||(this.disposed=!0,await this.session.close(c.SshDisconnectReason.none,"SshSession disposed"),this.session.dispose(),this.unsubscribe(),await this.transportStream.close())}onSessionClosed(e){this.unsubscribe(),this.closedEmitter.fire(e)}onSessionChannelOpening(e){this.channelOpeningEmitter.fire(e)}unsubscribe(){this.disposables.forEach(e=>e.dispose()),this.disposables=[]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(432),s=n(7),r=n(97),o=n(170),a=["email","openid","offline_access","9bd5ab7f-4031-4045-ace9-6bebbad202f6/all"];class c extends i.VsCodeNativeAuthTokenProvider{constructor(e){e=null!=e?e:s.traceSource.withName(r.SupportedAuthProviders.Microsoft),super(r.SupportedAuthProviders.Microsoft,a,e)}async getAccessToken(){if(this.cascadeTokenIsValid())return this.cascadeToken;await this.tryLoadSession(!1);const e=this.session;if(!e)return;let t=void 0;if(e.idToken){const n=o(e.idToken);t=n.altsecid||n.puid?e.idToken:e.accessToken}else t=e.accessToken;return t?(this.cascadeToken=await this.tokenExchangeService.exchange(this.providerId,t),this.cascadeToken):void 0}}t.MicrosoftAuthTokenProvider=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSettings={name:"Visual Studio Live Share",configName:"liveshare",serviceUri:"https://prod.liveshare.vsengsaas.visualstudio.com/",signalRServiceUri:"https://signlr-prod.core.vsengsaas.visualstudio.com/api/signalr/signalrhub",abbreviation:"VSLS",scheme:"vsls",authority:"vsls",canCollectPII:!1,activityTimeout:3e5,commandPrefix:"liveshare",featureSet:"stable",remoteSettingsUri:"https://az700632.vo.msecnd.net/pub/VSLiveShare/VSCode/",remoteSettingsUpdateMinutes:"60",textSearchResultsLimit:1e4,textSearchPreviewLimit:200}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),s=n(239);t.RpcServices=class{constructor(e,t){this.rpcFactory=e,this.rpcServiceHandler=t,this.workspaceService=s.lazyLoad(()=>this.rpcFactory(i.vsls.WorkspaceService,i.vsls.TraceSources.ClientRpcWorkspace)),this.sourceEventService=s.lazyLoad(()=>this.rpcFactory(i.vsls.SourceEventService,i.vsls.TraceSources.ClientRpcSourceEvent)),this.workspaceAccessControlService=s.lazyLoad(()=>this.rpcFactory(i.vsls.WorkspaceAccessControlService,i.vsls.TraceSources.ClientWorkspaceAccessControl)),this.fileService=s.lazyLoad(()=>this.rpcFactory(i.vsls.FileService,i.vsls.TraceSources.ClientRpcFile)),this.accessControlService=s.lazyLoad(()=>this.rpcFactory(i.vsls.AccessControlService,i.vsls.TraceSources.ClientAccessControl)),this.syncService=s.lazyLoad(()=>this.rpcFactory(i.vsls.SyncService,"SyncService")),this.workspaceUserService=s.lazyLoad(()=>this.rpcFactory(i.vsls.WorkspaceUserService,i.vsls.TraceSources.ClientRpcWorkspaceUser)),this.serverSharingService=s.lazyLoad(()=>this.rpcFactory(i.vsls.ServerSharingService,i.vsls.TraceSources.ClientRpcServerSharing)),this.portForwardingService=s.lazyLoad(()=>this.rpcFactory(i.vsls.PortForwardingService,i.vsls.TraceSources.ClientRpcPortForwarding)),this.streamManagerService=s.lazyLoad(()=>this.rpcFactory(i.vsls.StreamManagerService,i.vsls.TraceSources.ClientRpcStreamManager)),this.streamService=s.lazyLoad(()=>this.rpcFactory(i.vsls.StreamService,i.vsls.TraceSources.ClientRpcStream)),this.chatService=s.lazyLoad(()=>this.rpcFactory(i.vsls.ChatService,i.vsls.TraceSources.ClientRpcChat)),this.terminalService=s.lazyLoad(()=>this.rpcFactory(i.vsls.TerminalService,i.vsls.TraceSources.ClientRpcTerminal))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(23),s=n(21);function r(e){return e===s.SessionState.SharingInProgress||e===s.SessionState.Shared}function o(e){return e===s.SessionState.JoiningInProgress||e===s.SessionState.Joined}t.stateLazyLoad=function(e){let t,n;return()=>{return t&&(s=n,a=i.sessionStateTracker.State,r(s)&&r(a)||o(s)&&o(a))||(t=r(i.sessionStateTracker.State)?e.host?e.host():e.default():o(i.sessionStateTracker.State)&&e.guest?e.guest():e.default(),n=i.sessionStateTracker.State),t;var s,a}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(13),r=n(15),o=n(7),a=n(22);t.askToSignInAndReload=async function(e,t){const n=t;if(n){if(a.ExtensionUtil.context.globalState.get(n))return}const c=["Sign In"];n&&c.push("Don't show again");const l=await o.NotificationUtil.showInformationMessage(e,!1,...c);"Sign In"===l&&await i.commands.executeCommand(`${s.Settings.get(r.SettingKeys.commandPrefix)}.signInAndReload`),"Don't show again"===l&&a.ExtensionUtil.context&&await a.ExtensionUtil.context.globalState.update(n,!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.welcomePage='<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta http-equiv="Content-Security-Policy"\n        content="default-src \'none\'; font-src \'self\' data:; img-src vscode-resource: https:; script-src \'nonce-${nonce}\'; style-src \'nonce-${nonce}\'">\n    <link rel="stylesheet" href="${styleUri}" nonce="${nonce}">\n</head>\n<body>\n    \x3c!-- The following empty script tag is used to inject variables --\x3e\n    <script nonce="${nonce}"><\/script>\n    <div class="vsliveshare-welcome-page-main">\n        <header>\n            <img class="vsls-icon" src="https://aka.ms/vsls-icon" />\n            <div>\n                <h1 data-loc-id="158957f7">Visual Studio Live Share</h1>\n                <h2 data-loc-id="ea0c1d8a">Real-time Collaborative Development</h2>\n            </div>\n        </header>\n        <div class="js-liveshare-simple-share-full">\n            <separator></separator>\n            <p id="simple-page-text">Start your first collaboration session using Live Share</p>\n            <img id="simple-page-icon" src="https://aka.ms/vsls-developer-icon"/>\n            <button class="js-share-now-button">Share now</button>\n            <div id="simple-page-bottom-buttons">\n                <a class="simple-page-bottom-button" href="https://docs.microsoft.com/en-us/visualstudio/liveshare/use/vscode">User guide</a> \n                <a class="simple-page-bottom-button" href="http://aka.ms/vsls-troubleshooting">Help</a>\n                <a class="simple-page-bottom-button" href="https://github.com/MicrosoftDocs/live-share/issues">Feedback</a>\n            </div>\n        </div>\n        <div class="js-liveshare-share-full">\n            <separator></separator>\n            <p data-loc-id="0d9f3218">Welcome to Visual Studio Live Share! Get your team started with collaborative editing and debugging in\n                just a few simple steps:</p>\n            <div class="js-liveshare-action-signin clearfix">\n                <button class="sign-in-button js-sign-in-button" data-loc-id="3f1c30e2">Launch Sign In</button>\n                <details class="why-details">\n                    <summary><a id="why-sign-in" class="pointer" data-loc-id="bc546aef">Why sign in?</a></summary>\n                    <p data-loc-id="cf2f9959">When collaborating, it\'s important that others can identify who you are, in order to be confident\n                        with sharing access to their code and development environment. To make it easy to get started,\n                        you can sign in using an existing GitHub or Microsoft account.</p>\n                </details>\n                <p class="step-heading separator" data-loc-id="8ab2ea50">After signing in:</p>\n                <div class="spacer"></div>\n            </div>\n            <div class="js-liveshare-share-pre">\n                <section class="features-section">\n                    <div class="features-section__icon">\n                        <span class="ms-Icon ms-Icon--Share">\n                    </div>\n                    <div class="features-section__body">\n                        <h3 class="section-heads" data-loc-id="a01698c9">Share</h3>\n                        <p data-loc-id="355c621a">Click the <i>Live Share</i> button in your status bar, which will share your project,\n                            and copy a unique session URL to your clipboard.</p>\n                        <img src="https://aka.ms/vsls/quickstart/share" width="136px" height="57px" left="78px"\n                            top="98px" alt="Visual Studio Code share status bar item" />\n                        <p data-loc-id="9b33da5c">You\'ll be asked to sign in the first time you share (using a GitHub or Microsoft\n                            account), which allows others to identify you when collaborating.</p>\n                        <blockquote>\n                            <p data-loc-id="d8d8a4a9">On Windows, you may be asked to allow Live Share to open a firewall port, in\n                                order to enable peer-to-peer connections.</p>\n                        </blockquote>\n                    </div>\n                </section>\n            </div>\n\n            <section class="features-section">\n                <div class="features-section__icon">\n                    <span class="ms-Icon ms-Icon--ChatInviteFriend">\n                </div>\n                <div class="features-section__body">\n                    <h3 class="section-heads" data-loc-id="963c8400">Invite</h3>\n                    <p data-loc-id="0b30f81c">Send the session URL to the developers you\'d like to collaborate with (up to 30!), using\n                        e-mail, Skype, Slack, etc. <a id="security-info-link" href="https://aka.ms/vsls-security" data-loc-id="2278f11a">View\n                            security info</a> to understand more about\n                        secure sharing.</p>\n                    <div class="liveshare-share-post clearfix js-liveshare-action-post">\n                        <blockquote id="js-share-with-yourself-blockquote">\n                            <p data-loc-id="b4832819">Want to evaluate VS Live Share but don\'t have anyone to collaborate with? No problem!\n                                You can\n                                actually join your own session from another instance of VS Code.</p>\n                        </blockquote>\n                        <p id="js-join-uri" data-loc-id="d02e6362">Collaboration session URL: <p class="box js-liveshare-join-uri-button">\n                                ${joinUri}</p>\n                        </p>\n                        <button class="copy-invite-button js-liveshare-join-uri-button" data-loc-id="c98e64e5">Copy invite link</button>\n                        <button class="try-joinin-yourself-button js-liveshare-join-self-button" data-loc-id="6f05d343">Try joining\n                            yourself</button>\n                    </div>\n                </div>\n\n            </section>\n            <div class="step-heading-Collaborate">\n                <section class="features-section">\n                    <div class="features-section__icon">\n                        <span class="ms-Icon ms-Icon--People">\n                    </div>\n                    <div class="features-section__body">\n                        <h3 class="section-heads" data-loc-id="479e98d8">Collaborate</h3>\n                        <p data-loc-id="85f5992f">That\'s it! Once an invited "guest" joins, you\'ll get a notification, and will see their\n                            cursor appear in your currently opened file. All guests will start out <a\n                                id="follow-guest-link1" href="https://aka.ms/vsls-docs/vscode#following" data-loc-id="56ed9b91" aria-label="following - to follow a guest">"following"</a>\n                            you, which means\n                            that as you scroll or navigate between files, they will track those actions as well.\n                            This makes it easy to orient them with the issue/question/task you\'re about to start\n                            collaborating on.</p>\n                        <div class="step-heading-Collaborate_details">\n                            <div>\n                                <p data-loc-id="cc31088b">Additionally, to get the most out of Live Share, open up the <em>Session Details</em> view (shown to the right) and try out the following things:</p>\n                                <ul>\n                                    <li data-loc-id="2de7ba6c">Move your cursor, edit and highlight text, and watch guests do the same</li>\n                                    <li data-loc-id="d971c713"><a id="follow-guest-link2" href="https://aka.ms/vsls-docs/vscode#following" data-loc-id="02e07150">Follow a\n                                            guest</a>, and have them scroll and/or navigate to other files</li>\n                                    <li data-loc-id="a439566f"><a id="share-debug-session-link"\n                                                                href="https://aka.ms/vsls-docs/vscode#co-debugging" data-loc-id="33fa59be">Share a debug\n                                            session</a>, by pressing F5, then stepping together in real time</li>\n                                    <li data-loc-id="b9915c7f"><a id="share-server-link" href="https://aka.ms/vsls-docs/vscode#share-a-server" data-loc-id="bb9ef18d">Share a\n                                            server</a>, so\n                                        guests can view a locally running web app, database, etc.</li>\n                                    <li data-loc-id="4f10551a"><a id="share-terminal-link"\n                                                                href="https://aka.ms/vsls-docs/vscode#share-a-terminal" data-loc-id="f0ca3085">Share a terminal</a> and\n                                        run commands collaboratively</li>\n                                    <li data-loc-id="2744afe4"><a id="start-voice-call-link" href="https://aka.ms/vsls-audio" data-loc-id="4c8e870f">Start a voice\n                                            call</a> using the VS Live Share Audio extension</li>\n                                </ul>\n                            </div>\n                            <img src="https://aka.ms/vsls-vscode-viewlet" />\n                        </div>\n                    </div>\n                </section>\n            </div>\n        </div>\n\n        <div class="js-liveshare-join-full">\n            <separator></separator>\n            <p data-loc-id="50d7cc6a">Welcome to Visual Studio Live Share! Youve joined into a collaboration session and can begin editing and debugging in real-time.</p>\n            <div class="js-liveshare-action-signin clearfix">\n                <button class="sign-in-button js-sign-in-button" data-loc-id="d0a95743">Launch Sign In</button>\n                <details class="why-details">\n                    <summary><a id="join-why-sign-in" class="pointer" data-loc-id="0deadd51">Why sign in?</a></summary>\n                    <p data-loc-id="dd7df3a2">When collaborating, it\'s important that others can identify who you are, in order to be confident\n                        with sharing access to their code and development environment. To make it easy to get started,\n                        you can sign in using an existing GitHub or Microsoft account.</p>\n                </details>\n                <p class="step-heading separator" data-loc-id="0293ad40">After signing in:</p>\n                <div class="spacer"></div>\n            </div>\n            <div class="step-heading-edit">\n                <section class="features-section">\n                    <div class="features-section__icon">\n                        <span class="ms-Icon ms-Icon--Edit">\n                    </div>\n                    <div class="features-section__body">\n                        <h3 class="section-heads" data-loc-id="8d9ee863">Edit</h3>\n                        <div class="step-heading-Collaborate_details">\n                            <div>\n                                <p data-loc-id="d48e2fbb">Move your cursor around, edit, and highlight text. You\'ll be able to see other participants doing\n                                    the same. You can also navigate to other files, since you have access to the entire shared project.</p>\n                                <p data-loc-id="9bf70ecd">Additionally, to get the most out of Live Share, open up the <em>Session Details</em> view (shown to the right) and try out the following things:</p>\n                                <ul>\n                                    <li data-loc-id="63be0ba1">\n                                        <a href="https://aka.ms/vsls-docs/vscode#following">Follow a participant</a>, by clicking their name under the <em>Participants</em> list\n                                    </li>\n                                    <li data-loc-id="f44edc67">\n                                        <a href="https://aka.ms/vsls-docs/vscode#focusing">Focus a participant</a>, to call their attention to the code you\'re looking at\n                                    </li>\n                                    <li data-loc-id="406e1451">\n                                        <a id="start-voice-call-link" href="https://aka.ms/vsls-audio">Join a voice call</a>, using the Live Share Audio extension\n                                    </li>\n                                </ul>\n                            </div>\n                            <img src="https://aka.ms/vsls-vscode-viewlet" alt="Visual Studio Code command viewlet" />\n                        </div>\n                    </div>\n                </section>\n            </div>\n\n            <div class="step-heading-debug">\n                <section class="features-section">\n                    <div class="features-section__icon">\n                        <span class="ms-Icon ms-Icon--Bug">\n                    </div>\n                    <div class="features-section__body">\n                        <h3 class="section-heads" data-loc-id="10ee5256">Debug</h3>\n                        <p data-loc-id="90400e31"> Work through an issue/question/task with your team in\n                            real-time, using the following collaborative debugging capabilities:</p>\n                        <ul>\n                            <li data-loc-id="1f48f4a3">\n                                    <a href="https://aka.ms/vsls-docs/vscode#co-debugging">Debug together</a>, by starting a debug session, setting breakpoints and then stepping\n                            </li>\n                            <li data-loc-id="b7ab71e4">\n                                <a href="https://aka.ms/vsls-docs/vscode#share-a-server">View shared severs</a>, to browser web apps, REST APIs, etc. running on the host\'s machine\n                            </li>\n                            <li data-loc-id="0b9ac20d">\n                                <a href="https://aka.ms/vsls-docs/vscode#share-a-terminal">View shared terminals</a>, to view build output, run commands, etc.\n                            </li>\n                        </ul>\n                    </div>\n                </section>\n            </div>\n\n        </div>\n        <div class = "bottom-text">\n        <p data-loc-id="f9283848">If you run into any problems, see our <a id="troubleshooting-link"\n                                    href="http://aka.ms/vsls-troubleshooting" data-loc-id="90ef1fca">troubleshooting documentation</a> for potential workarounds.\n            Additionally, if you have any questions and/or feedback, please don\'t hesitate to reach out to the team on\n            <a id="github-link" href="http://github.com/microsoft/live-share">GitHub</a>. </p>\n       </div>\n    </div>\n\n    <div class="vsliveshare-dynamic-welcome-page">\n        <header id="dynamic-welcome-page-header">\n            <img class="vsls-icon" src="https://aka.ms/vsls-icon" />\n            <div>\n                <h1 data-loc-id="158957f7">Visual Studio Live Share</h1>\n                <h2 data-loc-id="ea0c1d8a">Real-time Collaborative Development</h2>\n            </div>\n        </header>\n        \n        <div id="vsliveshare-dynamic-welcome-page-main">\n            <separator></separator>\n            <p id="dynamic-welcome-page-title">Start collaborating in 3 simple steps</p>\n            <div id="dynamic-welcome-page-content">\n                <div id="dynamic-welcome-page-start-session">\n                    <img id="dynamic-page-share-icon" class="dynamic-welcome-page-icon" src="https://aka.ms/vsls-share-gray-icon"/>\n                    <button class="dynamic-welcome-page-button dynamic-welcome-page-start-button vsls-blue-button">Share</button>\n                    <div class="dynamic-welcome-page-content-element-text content-element-share">\n                        <p>\n                            To share in the future:\n                        </p>\n                        <ol>\n                            <li>Go to Live Share from your side pane.</li>\n                            <li>Click on \'Start collaboration session\' under \'Session Details.</li>\n                        </ol>\n                        <img src="https://aka.ms/vsls-start-collaboration-session" width="60%" height="auto"/>\n                    </div>\n                </div>\n                <div id="dynamic-welcome-page-authenticate">\n                    <img id="dynamic-page-authenticate-icon" class="dynamic-welcome-page-icon" src="https://aka.ms/vsls-authenticate-gray-icon"/>\n                    <p id="dynamic-page-authenticate-button" class="dynamic-welcome-page-button-outline vsls-gray-button-outline">Follow steps to authenticate</p>\n                    <p class="dynamic-welcome-page-content-element-text">\n                        Authentication only happens once.\n                        <br>\n                        Once authenticated using Github or Microsoft you don\'t need to authenticate again, unless you sign-out explicitly.\n                    </p>\n                </div>\n                <div id="dynamic-welcome-page-share-session">\n                    <div>\n                        <div id="dynamic-welcome-page-invite-others">\n                            <img id="dynamic-page-invite-icon" class="dynamic-welcome-page-icon" src="https://aka.ms/vsls-invite-gray-icon"/>\n                            <p id="dynamic-page-invite-button" class="dynamic-welcome-page-button-outline vsls-gray-button-outline">Invite others</p>\n                        </div>\n                        \x3c!-- OR --\x3e\n                        <div id="dynamic-welcome-page-invite-join-yourself">\n                            <img id="dynamic-page-join-yourself-icon" class="dynamic-welcome-page-icon" src="https://aka.ms/vsls-join-yourself-gray-icon"/>\n                            <button id="dynamic-page-join-yourself-button" class="dynamic-welcome-page-button">Join yourself to learn</button>\n                        </div>\n                    </div>\n                    <p class="dynamic-welcome-page-content-element-text" id="share-session-content-element-text">\n                        Inviting others to your session.\n                        <br>\n                        You can invite others to a session you start by sharing the session URL with them. This session link is automatically copied to your clipboard when you start a session.\n                        <br>\n                        You can always access the session URL from the \'Session Details\' bar. <img src="https://aka.ms/vsls-session-details-img" width="30%" height="auto"/>\n                    </p>\n                </div>\n            </div>\n        </div>\n\n        <div id="liveshare-collaboration-details">\n            <header id="collaboration-header">\n                <img class="vsls-icon" src="https://aka.ms/vsls-collaboration-white-icon"/>\n                <div>\n                    <h1>Collaborate</h1>\n                    <h2>Deep Dive into Live Shares features</h2>\n                </div>\n            </header>\n            <p>\n                Once your guest has joined your live Share session, they will start <span class="bold-text">"following"</span> you. You can now start with the primary feature of co-editing using Live Share. \n                Scroll through your code and navigate between files as you guest follows along. But you can do so much more.\n            </p>\n            <table>\n                <tr>\n                    <td>\n                        <div>\n                            <p>\n                                Additionally, to get the most out of Live Share, open up the <em>Session Details</em> view (shown to the right) and try out the following things:\n                            </p>\n                            <ul>\n                                <li>\n                                    Move your cursor, edit and highlight text, and watch guests do the same\n                                </li>\n                                <li >\n                                    <a id="follow-guest-link2" href="https://aka.ms/vsls-docs/vscode#following">Follow a guest</a>, and have them scroll and/or navigate to other files\n                                </li>\n                                <li>\n                                    <a id="share-debug-session-link" href="https://aka.ms/vsls-docs/vscode#co-debugging">Share a debug session</a>, by pressing F5, then stepping together in real time\n                                </li>\n                                <li>\n                                    <a id="share-server-link" href="https://aka.ms/vsls-docs/vscode#share-a-server">Share a server</a>, so guests can view a locally running web app, database, etc.\n                                </li>\n                                <li>\n                                    <a id="share-terminal-link" href="https://aka.ms/vsls-docs/vscode#share-a-terminal">Share a terminal</a> and run commands collaboratively\n                                </li>\n                                <li>\n                                    <a id="start-voice-call-link" href="https://aka.ms/vsls-audio">Start a voice call</a> using the VS Live Share Audio extension\n                                </li>\n                            </ul>\n                        </div>\n                    </td>\n                    <td>\n                        <img src="https://aka.ms/vsls-vscode-viewlet" />\n                    </td>\n                </tr>\n            </table>\n        </div>\n        <div class="dynamic-page-bottom-text">\n            <p>\n                If you run into any problems, see our <a id="troubleshooting-link" href="http://aka.ms/vsls-troubleshooting">troubleshooting documentation</a> \n                for potential workarounds. Additionally, if you have any questions and/or feedback, please don\'t hesitate to reach out to the team on\n                <a id="github-link" href="http://github.com/microsoft/live-share">GitHub</a>.\n            </p>\n        </div>\n    </div>\n    <script nonce="${nonce}" src="${mainScriptUri}"><\/script>\n</body>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(29),s=n(95);t.copyInvitationLinkToClipboard=async function(){const e=i.workspaceSessionInfoTracker.workspaceSessionInfo.joinUri;return await(new s.ClipboardUtil).copyToClipboardAsync(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(16),s=n(7);t.SamplingFilter=class{constructor(e){this.samplingConfig=e}shouldSend(e,t,n){if(!e)return!0;const s=this.samplingConfig[e];if("number"==typeof s&&!isNaN(s)){if(0===s||Math.random()*s>1)return!1;n[i.TelemetryPropertyNames.SAMPLE_RATE]=s}return!0}};t.MissingConversationIdFilter=class{shouldSend(e,t,n){return e!==i.TelemetryEventNames.SHARE_WORKSPACE||"Success"!==t[i.TelemetryPropertyNames.EVENT_RESULT]||t[i.TelemetryPropertyNames.CONVERSATION_ID]||s.NotificationUtil.showErrorMessage("A share happened, but conversationId was not set. Please email mowillia@microsoft.com so she can reproduce this with your steps!"),!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1028),s=n(327),r=n(169),o=n(9),a=n(16);class c{constructor(){this.numMessages=0,this.firstMessage=0,this.maxMessage=0,this.minMessage=0,this.metricTotal=0}get averageMessage(){return 0===this.numMessages?0:this.metricTotal/this.numMessages}addMessage(e){0===this.numMessages?this.firstMessage=this.maxMessage=this.minMessage=e:(this.maxMessage=Math.max(e,this.maxMessage),this.minMessage=Math.min(e,this.minMessage)),this.numMessages++,this.metricTotal+=e}}class l{constructor(){this.latencySummary=new c,this.processingSummary=new c,this.combinedSummary=new c}}class u{static updateTelemetry(e,t,n,i){u.requestSummaries.has(e)||u.requestSummaries.set(e,new l);const s=u.requestSummaries.get(e);s.latencySummary.addMessage(t),s.processingSummary.addMessage(n),s.combinedSummary.addMessage(i)}static postRequestSummaries(){for(const[e,t]of u.requestSummaries){const n=new o.TelemetryEvent(m.SUMMARIZE_RPC_REQUEST_TIMES);n.addProperty(g.METHOD_NAME,e),n.addMeasure(g.NUMBER_OF_MESSAGES,t.latencySummary.numMessages),n.addProperty(g.FIRST_MESSAGE,JSON.stringify([t.latencySummary.firstMessage,t.processingSummary.firstMessage,t.combinedSummary.firstMessage])),n.addProperty(g.MAX_MESSAGE,JSON.stringify([t.latencySummary.maxMessage,t.processingSummary.maxMessage,t.combinedSummary.maxMessage])),n.addProperty(g.MIN_MESSAGE,JSON.stringify([t.latencySummary.minMessage,t.processingSummary.minMessage,t.combinedSummary.minMessage])),n.addProperty(g.AVERAGE_MESSAGE,JSON.stringify([t.latencySummary.averageMessage,t.processingSummary.averageMessage,t.combinedSummary.averageMessage])),n.send()}u.requestSummaries.clear()}}t.RpcTimingTelemetry=u,u.requestSummaries=new Map;class d{static updateTelemetry(e,t,n){d.methodSummaries.has(e)||d.methodSummaries.set(e,new Map);const i=d.methodSummaries.get(e);i.has(t)||i.set(t,new c),i.get(t).addMessage(n)}static postMethodSummaries(){for(const[e,t]of d.methodSummaries)for(const[n,i]of t){const t=new o.TelemetryEvent(m.SUMMARIZE_RPC_METHOD_SIZES);t.addProperty(g.METHOD_NAME,e),t.addProperty(g.METHOD_TYPE,n),t.addMeasure(g.NUMBER_OF_MESSAGES,i.numMessages),t.addMeasure(g.FIRST_MESSAGE,i.firstMessage),t.addMeasure(g.MAX_MESSAGE,i.maxMessage),t.addMeasure(g.MIN_MESSAGE,i.minMessage),t.addMeasure(g.AVERAGE_MESSAGE,i.averageMessage),t.send()}d.methodSummaries.clear()}}t.RpcSizeTelemetry=d,d.methodSummaries=new Map;t.LanguageServiceRpcMethodNameProvider=class{constructor(){this.serviceNames=["languageServerProvider-any","languageServerProvider-Roslyn"]}getMethod(e){if(e.params&&(e.params.length>0&&e.params[0].method||e.params.length>1&&e.params[1].method)){return`${e.method.split(".")[0]}.${e.params[0].method?e.params[0].method:e.params[1].method}`}}};class h{constructor(e){this.requestMessage=e,this.constructedTime=(new Date).getTime()}}class f{constructor(...e){this.requestMessages=new Map,this.methodNameProviders=new Map;for(const t of e)this.addMethodNameProvider(t)}addMethodNameProvider(e){for(const t of e.serviceNames)this.methodNameProviders.set(t,e)}cacheRequestMessage(e){if(s.isRequestMessage(e)){const t=e;this.requestMessages.set(t.id,new h(t))}}getModifiedMethodName(e,t){const n=e.split(".")[0],i=this.methodNameProviders.get(n);if(i){const e=i.getMethod(t);if(e)return e}return e}getRequestMessage(e){const t="number"==typeof e?e:e.id;if(null!==t&&this.requestMessages.has(t)){const e=this.requestMessages.get(t).requestMessage;if(this.requestMessages.delete(t),e.method){return{requestMsg:e,methodName:this.getModifiedMethodName(e.method,e)}}}}}class p extends f{constructor(...e){super(...e),r.SessionTelemetry.sessionEvent.on(r.SessionTelemetry.sessionEndEventName,()=>{this.reportExpiredRequests(),this.requestMessages.clear()})}readWriteFilter(e){return this.cacheRequestMessage(e),this.checkForError(e),this.checkForCancellation(e),e}checkForError(e){if(s.isResponseMessage(e)){const t=e,n=this.getRequestMessage(e);if(t.error){const t=n?n.methodName:"";p.reportRpcError(t,e.error)}}}checkForCancellation(e){if(s.isNotificationMessage(e)&&"$/cancelRequest"===e.method){const t=e.params.id,n=this.getRequestMessage(t);p.reportCancelledRequest(n?n.methodName:"NA")}}static reportRpcError(e,t){const n=new o.Fault(m.RECEIVE_RPC_FAULT,o.FaultType.Error,t.message);n.addProperty(g.METHOD_NAME,e),n.addProperty(g.ERROR_CODE,t.code),n.addProperty(g.ERROR_DATA,JSON.stringify(t.data)),n.sendAsError([g.ERROR_DATA])}static reportCancelledRequest(e){const t=new o.TelemetryEvent(m.CANCEL_RPC_REQUEST);t.addProperty(g.METHOD_NAME,e),t.send()}getExpiredRequests(){const e=(new Date).getTime(),t=new Map;for(let[,n]of this.requestMessages)if(e-n.constructedTime>6e4){const e=this.getModifiedMethodName(n.requestMessage.method,n.requestMessage),i=t.get(e)||0;t.set(e,i+1)}return t}reportExpiredRequests(){const e=this.getExpiredRequests();for(const[t,n]of e){const e=new o.TelemetryEvent(m.EXPIRE_RPC_REQUESTS);e.addProperty(g.METHOD_NAME,t),e.addMeasure(g.NUMBER_OF_MESSAGES,n),e.send()}}}t.TelemetryRpcErrorFilter=p;t.TelemetryRpcFilter=class extends f{constructor(...e){super(...e),r.SessionTelemetry.sessionEvent.on(r.SessionTelemetry.sessionEndEventName,()=>{u.postRequestSummaries(),d.postMethodSummaries()})}writeFilter(e){return this.cacheRequestMessage(e),e}readFilter(e){if(s.isRequestMessage(e)||s.isNotificationMessage(e)){const t=this.getModifiedMethodName(e.method,e);void 0!==e.size&&d.updateTelemetry(t,s.isRequestMessage(e)?"request":"notification",e.size)}else if(s.isResponseMessage(e)&&void 0!==e.id&&this.requestMessages.has(e.id)){const t=this.getRequestMessage(e),n=t?t.methodName:"";void 0!==e.size&&d.updateTelemetry(n,"response",e.size),void 0!==e.times&&u.updateTelemetry(n,i.TimedRpcMessageUtils.getLatency(e.times),i.TimedRpcMessageUtils.getProcessingTime(e.times),i.TimedRpcMessageUtils.getTotalTime(e.times))}return e}};class m{}t.RpcTelemetryEventNames=m,m.SUMMARIZE_RPC_REQUEST_TIMES="summarize-rpcrequesttimes",m.SUMMARIZE_RPC_METHOD_SIZES="summarize-rpcmethodsizes",m.RECEIVE_RPC_FAULT=a.TelemetryEventNames.FAULT_PREFIX+"receive-rpc-fault",m.EXPIRE_RPC_REQUESTS="expire-rpcrequests",m.CANCEL_RPC_REQUEST="cancel-rpcrequest";class g{}t.RpcTelemetryPropertyNames=g,g.METHOD_NAME=a.TelemetryPropertyNames.FEATURE_NAME+"MethodName",g.METHOD_TYPE=a.TelemetryPropertyNames.FEATURE_NAME+"MethodType",g.NUMBER_OF_MESSAGES=a.TelemetryPropertyNames.FEATURE_NAME+"NumberOfMessages",g.FIRST_MESSAGE=a.TelemetryPropertyNames.FEATURE_NAME+"FirstMessage",g.MAX_MESSAGE=a.TelemetryPropertyNames.FEATURE_NAME+"MaxMessage",g.MIN_MESSAGE=a.TelemetryPropertyNames.FEATURE_NAME+"MinMessage",g.AVERAGE_MESSAGE=a.TelemetryPropertyNames.FEATURE_NAME+"AverageMessage",g.ERROR_CODE=a.TelemetryPropertyNames.FEATURE_NAME+"ErrorCode",g.ERROR_DATA=a.TelemetryPropertyNames.FEATURE_NAME+"ErrorData"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WrappedMessageReader=class{constructor(e,t){this.messageReader=e,this.messageTransformer=t,this.onError=this.messageReader.onError,this.onClose=this.messageReader.onClose,this.onPartialMessage=this.messageReader.onPartialMessage}listen(e){this.messageReader.listen(t=>{e(this.messageTransformer(t))})}dispose(){this.messageReader.dispose()}};t.WrappedMessageWriter=class{constructor(e,t){this.messageWriter=e,this.messageTransformer=t,this.onError=this.messageWriter.onError,this.onClose=this.messageWriter.onClose}write(e){this.messageWriter.write(this.messageTransformer(e))}dispose(){this.messageWriter.dispose()}};t.TimingFilter=class{constructor(){this.times=new Map}filter(e,t){if("number"!=typeof t.id)return t;if(this.times.has(t.id)){const n=Date.now()-this.times.get(t.id);this.times.delete(t.id),(e||void 0!==t.times)&&(t.times=i.addTime(t.times,n))}else this.times.set(t.id,Date.now());return t}};class i{static addTime(e,t){void 0===e&&(e=[]);const n=t-i.getTotalTime(e);return e.push(n>0?n:0),e}static getLatency(e){let t=0;if(e)for(let n=1;n<e.length;n+=2)t+=e[n];return t}static getProcessingTime(e){let t=0;if(e)for(let n=0;n<e.length;n+=2)t+=e[n];return t}static getTotalTime(e){return i.getLatency(e)+i.getProcessingTime(e)}}t.TimedRpcMessageUtils=i,t.AddContextToRpcMessage=function(e){if(!e)return e;const t=e.context,n=e.params;return"object"!=typeof t||"object"!=typeof n||Array.isArray(n)||n.context?e:Object.assign({},e,{params:Object.assign({context:t},n)})};t.RpcRequestsWithContext=class{constructor(){this.methods=new Set,this.readFilter=this.filterMessage.bind(this)}add(e){e&&this.methods.add(e)}filterMessage(e){const t=e;if(!t.method||!this.methods.has(t.method))return e;const n=e.context||{};return t.params?Array.isArray(t.params)&&t.params.push(n):t.params=[n],t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),s=n(0);t.RpcServiceHelper=class{static async registerHostRpcService(e,t,n,r){if(!e)throw new Error("service argument is missing or undefined");if(!t)throw new Error("serviceInfo argument is missing or undefined");if(!n)throw new Error("dependencies argument is missing or undefined");const o=t.name;if(!o)throw new Error("serviceInfo.serviceName is empty or undefined");const a=n.workspaceService(),c=n.sessionContext(),l=n.rpcServiceHandler().registerRpcService(e,t);try{await a.registerServicesAsync([o],i.vsls.CollectionChangeType.Add)}catch(e){throw l.dispose(),e}const u=new s.Disposable(async()=>{if(l.dispose(),c.isStartingCollaboration||c.isCollaborating)try{await a.registerServicesAsync([o],i.vsls.CollectionChangeType.Remove)}catch(e){}});return r&&r.push(u),u}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(70),r=n(101),o=n(136),a=n(20),c=n(29),l=n(23),u=n(21);function d(e){const t=e===u.SessionState.Shared,n=e===u.SessionState.Joined;return{isSharedState:t,isJoinedState:n,isSharingState:e===u.SessionState.SharingInProgress,isJoiningState:e===u.SessionState.JoiningInProgress,notSharedOrJoined:!t&&!n}}function h(e,t){return!e.supportedContext&&!t.notSharedOrJoined||e.supportedContext===r.TreeDataProviderContext.Joined&&t.isJoinedState||e.supportedContext===r.TreeDataProviderContext.Sharing&&t.isSharedState||e.supportedContext===r.TreeDataProviderContext.SharedOrJoined&&!t.notSharedOrJoined||e.supportedContext===r.TreeDataProviderContext.NotSharedOrJoined&&t.notSharedOrJoined}t.SessionExplorerProvider=class{constructor(e){this.sessionContext=e,this.extensionItemProviders=new Map,this.extensionProviders=[],this.changeEventEmitter=new i.EventEmitter,this.onDidChangeTreeData=this.changeEventEmitter.event,l.sessionStateTracker.onStateChanged(e=>this.forceRefreshState(e.oldState,e.newState)),c.workspaceSessionInfoTracker.onReadOnlyChanged(()=>this.forceRefresh()),this.sessionContext.onAccessControlChanged(()=>this.forceRefresh())}getExtensionTreeDataProvider(e){const t=this.extensionProviders.find(t=>t.id===e);if(t)return t}registerTreeDataProvider(e){if(this.extensionProviders.indexOf(e)>=0)return null;let t=void 0;return e.onDidChangeTreeData&&(t=e.onDidChangeTreeData(e=>{this.refresh(e)})),this.extensionProviders.push(e),this.refresh(),new i.Disposable(()=>{const n=this.extensionProviders.indexOf(e);n<0||(t&&(t.dispose(),t=void 0),this.extensionProviders.splice(n,1),this.refresh())})}refresh(e){this.changeEventEmitter.fire(e)}getTreeItem(e){const t=this.extensionItemProviders.get(e);return t?t.getTreeItem(e):e}async getChildren(e){try{return e?await this.getElementChildren(e):await this.getDefaultRootChildren()}catch(e){if(e instanceof a.RpcConnectionShutdownError)return[];throw e}}forceRefresh(){this.extensionProviders.forEach(e=>{e.refreshItems&&e.refreshItems()}),this.refresh()}forceRefreshState(e,t){const n=d(e),i=d(t);for(const e of this.extensionProviders)if(h(e,n)!==h(e,i))return void this.forceRefresh()}async getDefaultRootChildren(){const e=l.sessionStateTracker.State,t=d(e);if(t.isSharingState||t.isJoiningState)return[new s.TreeViewItem({type:"loading",label:t.isSharingState?"Starting collaboration session...":"Joining collaboration session...",iconPath:o.TreeDataProviderBase.getThemeIconPath("loading")})];let n=[];this.extensionItemProviders.clear();for(const e of this.extensionProviders)if(h(e,t)){const t=await e.getChildren();if(t&&t.length>0){for(let n of t)this.extensionItemProviders.set(n,e);n=n.concat(t)}}return l.sessionStateTracker.State!==e?await this.getDefaultRootChildren():n}async getElementChildren(e){const t=this.extensionItemProviders.get(e);if(t){const n=await t.getChildren(e);for(let e of n)this.extensionItemProviders.set(e,t);return n}return[]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(18),r=n(101),o=n(136),a=n(70),c=n(29),l=n(5),u=n(26),d=n(22),h=n(50),f=n(42),p=n(168),m=n(62),g=n(1034);var y,v;!function(e){e.readOnly="readOnly",e.readWrite="readWrite"}(y=t.AnonymousAccessLevel||(t.AnonymousAccessLevel={}));class S extends a.TreeViewItem{constructor(e){super(e),this.options=e,this.sessionId=e.sessionId,this.participantId=e.participantId}}function _(e){switch(e){case l.vsls.InviteContactStatus.Invited:return u.localize("inviteContactStatus.invited");case l.vsls.InviteContactStatus.Dismissed:return u.localize("inviteContactStatus.dismissed");case l.vsls.InviteContactStatus.Joining:return u.localize("inviteContactStatus.joining")}}t.ParticipantSessionExplorerItem=S,function(e){e.Participants="participants",e.InvitedContact="contacts.invited",e.CurrentUser="participants.currentuser",e.Guest="participants.guest",e.FollowedGuest="participants.guest.followed",e.Participant="participants.participant",e.FollowedParticipant="participants.participant.followed",e.GuestAnonymous="participants.guest.anonymous",e.FollowedGuestAnonymous="participants.guest.followed.anonymous",e.GuestElevated="participants.guest.elevated",e.FollowedGuestElevated="participants.guest.followed.elevated",e.GuestElevatedAnonymous="participants.guest.elevated.anonymous",e.FollowedGuestElevatedAnonymous="participants.guest.followed.elevated.anonymous"}(v=t.ParticipantsViewItem||(t.ParticipantsViewItem={}));const E=new Map([[h.PathManager.notebookCellScheme,()=>""]]);class w extends o.TreeDataProviderBase{constructor(e,t,n,i){super(v.Participants,r.TreeDataProviderContext.SharedOrJoined),this.sessionContext=e,this.clientAccessCheck=t,this.contactManager=n,this.isSessionExplorer=i,this.sessionContext.onCollaboratorChanged(e=>{e&&e.changeType===l.vsls.WorkspaceSessionChangeType.Unjoined&&this.forceRefreshItems()}),this.sessionContext.onCollaboratorsJoined(()=>{this.forceRefreshItems()}),this.sessionContext.onAccessControlChanged(()=>this.forceRefreshItems()),n.onInviteStatusChanged(()=>this.forceRefreshItems())}registerCoEditing(e){const t=[];return t.push(e.onPin(()=>this.forceRefreshItems())),t.push(e.onUnpin(()=>this.forceRefreshItems())),t.push(e.onFollowed(()=>this.forceRefreshItems())),t.push(e.onUnfollowed(()=>this.forceRefreshItems())),t.push(e.onUpdateCoEditorPosition(()=>this.forceRefreshItems())),i.Disposable.from(...t)}getRootItem(){const e=this.getApprovedParticipants(),t=new a.TreeViewItem({type:v.Participants,collapsibleState:i.TreeItemCollapsibleState.Expanded,label:`Participants (${e.length})`});return Promise.resolve(t)}async getChildrenItems(e){const t=[];if(!this.sessionContext.collaboratorManager)return t;let n=0;const i=this.getApprovedParticipants();for(let e of i){const{sessionId:i,participant:s}=e;t.push(await this.getParticipantRow(n++,i,s))}const s=this.contactManager.invitedContacts;return t.push(...s.map(e=>new S({sessionId:void 0,contactId:e.id,type:v.InvitedContact,label:`${e.contact.displayName} (${_(e.inviteStatus)})`,iconPath:o.TreeDataProviderBase.getThemeIconPath("loading")}))),0===t.length?this.getDefaultParticipantsActions():t}getDefaultParticipantsActions(){return[new a.TreeViewItem({type:m.ViewItem.Other,collapsibleState:i.TreeItemCollapsibleState.None,label:"Invite participants...",command:{title:"Invite participants...",command:this.isSessionExplorer?"liveshare.collaboration.link.copyFromFileTreeExplorer":"liveshare.collaboration.link.copyFromActivityBar"}})]}getApprovedParticipants(){const e=[],t=this.sessionContext.collaboratorManager.getCollaborators(),n=this.sessionContext.collaboratorManager.getCollaboratorSessionIds();for(let i of n){const n=t[i],s=i;!n||s===this.sessionContext.coeditingClient.clientID||n.isHost&&n.isOnlineUser||e.push({sessionId:s,participant:n})}return e}async getParticipantRow(e,t,n){var i;const r=n.name||n.userName||n.email,{positionTracker:o}=this.sessionContext.coeditingClient,a=o.getClientPosition(t),c=(null==a?void 0:a.documentPosition)||(null==a?void 0:a.notebookPosition);let l="",u="";if(c&&c.fileName){const e=c.range;let t="";t=E.has(c.documentUri.scheme)?E.get(c.documentUri.scheme)(e):e&&e.start?`:${e.start.line+1}`:"",l=`   ${s.basename(c.documentUri.path)}${t}`,u=`  ${c.documentUri.path}${t}`}const{coeditingClient:h}=this.sessionContext,m=h.getUsersBeingFollowed()[t],y=await g.getIconPathForUser(e,t,m),_=await this.getUserTreeItemType(t),w=_||"",b=w.startsWith(v.FollowedGuest)||w.startsWith(v.FollowedParticipant),C=b?"Unfollow Participant":"Follow Participant",T=`${b?"liveshare.unfollow":"liveshare.follow"}${this.isSessionExplorer?"FromFileTreeExplorer":"FromActivityBar"}`;let M=await d.ExtensionUtil.getAnonymousReadOnlyLabel(this.clientAccessCheck(),n,t),A="";if(!0===(null===(i=f.getExpService())||void 0===i?void 0:i.getTreatmentVariable(p.TreatmentVariables.VSCodeConfig,p.TreatmentVariables.FollowIndicators))){const e=h.getUsersFollowingYou().get(t);m&&e?l="  following each other":m?l="   following":e&&(l="  following you"),A=M,M=""}return new S({sessionId:t,participantId:n.id,type:_,label:`${r}${M} ${l}`,tooltip:`${r}${M} ${u}`,description:A,iconPath:y,command:{title:C,command:T,arguments:[{sessionId:t}]}})}isReadWriteAnonymousEnabled(){var e;return null===(e=f.getExpService())||void 0===e?void 0:e.getTreatmentVariable("vscode","readWriteAnonymous")}async getUserTreeItemType(e){const{coeditingClient:t}=this.sessionContext,{workspaceSessionInfo:n}=c.workspaceSessionInfoTracker,{sessions:i}=n,s=t.getUsersBeingFollowed()[e],r=i[e],o=await this.clientAccessCheck().isClientExplicitlyReadWrite(e);if(r.isAnonymous){const t=c.workspaceSessionInfoTracker.getAnonymousAccess(r.id),n=this.isReadWriteAnonymousEnabled()&&t===y.readWrite;return this.getUserTreeItemTypeAnonymous(e,n)}if(s){const e=o?v.FollowedGuestElevated:v.FollowedGuest;return t.isHost?e:v.FollowedParticipant}const a=o?v.GuestElevated:v.Guest;return t.isHost?a:v.Participant}getUserTreeItemTypeAnonymous(e,t){const{coeditingClient:n}=this.sessionContext;if(n.getUsersBeingFollowed()[e]){const e=t?v.FollowedGuestElevatedAnonymous:v.FollowedGuestAnonymous;return n.isHost?e:v.FollowedParticipant}const i=t?v.GuestElevatedAnonymous:v.GuestAnonymous;return n.isHost?i:v.Participant}}t.ParticipantsTreeDataProvider=w},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(1033).version;async function r(e){const n=i.extensions.getExtension(t.extensionId);if(!n)return null;const r=n.isActive?n.exports:await n.activate();return r?r.getApi?r.getApi(s,e):r.getApiAsync(s):null}t.extensionId="ms-vsliveshare.vsliveshare",t.getApi=r,t.getApiAsync=function(){return r()},function(e){e.AllowGuestDebugControl="allowGuestDebugControl",e.AllowGuestTaskControl="allowGuestTaskControl",e.AutoShareServers="autoShareServers",e.AnonymousGuestApproval="anonymousGuestApproval",e.ConnectionMode="connectionMode",e.AllowedDomains="allowedDomains",e.AllowReadWriteTerminals="allowReadWriteTerminals"}(t.PolicySetting||(t.PolicySetting={})),function(e){e[e.None=0]="None",e[e.Host=1]="Host",e[e.Guest=2]="Guest"}(t.Role||(t.Role={})),function(e){e[e.None=0]="None",e[e.ReadOnly=1]="ReadOnly",e[e.ReadWrite=3]="ReadWrite",e[e.Owner=255]="Owner"}(t.Access||(t.Access={})),function(e){e.Session="liveshare.session",e.ExplorerSession="liveshare.session.explorer",e.PlannedSessions="liveshare.plannedSessions",e.Contacts="liveshare.contacts",e.Help="liveshare.help"}(t.View||(t.View={})),function(e){e.Participants="participants",e.Servers="servers",e.Terminals="terminals",e.Comments="comments",e.Chat="chat",e.CurrentUser="participants.currentuser",e.Guest="participants.guest",e.FollowedGuest="participants.guest.followed",e.Participant="participants.participant",e.FollowedParticipant="participants.participant.followed",e.GuestAnonymous="participants.guest.anonymous",e.FollowedGuestAnonymous="participants.guest.followed.anonymous",e.GuestElevated="participants.guest.elevated",e.FollowedGuestElevated="participants.guest.followed.elevated",e.GuestElevatedAnonymous="participants.guest.elevated.anonymous",e.FollowedGuestElevatedAnonymous="participants.guest.followed.elevated.anonymous",e.LocalServer="servers.local",e.RemoteServer="servers.remote",e.LocalTerminalReadOnly="terminals.local.readonly",e.LocalTerminalReadWrite="terminals.local.readwrite",e.RemoteTerminal="terminals.remote",e.SuggestedContacts="contacts.suggested",e.AvailableContacts="contacts.available",e.ContactsProvider="contacts.provider",e.SelfContact="contacts.selfContact",e.Contact="contacts.contact",e.ContactInvited="contacts.contact.invited",e.ContactOffline="contacts.contact.offline",e.RecentContact="contacts.recentContact",e.RecentContactOffline="contacts.recentContact.offline",e.RecentContactInvited="contacts.recentContact.invited",e.NoContact="contacts.noContact",e.RecentContacts="contacts.RecentContacts",e.NoSuggestedContacts="contacts.NoSuggestedUsers",e.NoRecentContacts="contacts.NoRecentContacts",e.InvitedContact="contacts.invited",e.SessionFeedbackQuestion="help.sessionFeedback",e.ReportAProblem="help.reportAProblem",e.TweetUsYourFeedback="help.tweetUsYourFeedback",e.Survey="help.survey",e.GoodFeedback="help.goodFeedback",e.BadFeedback="help.badFeedback",e.DontAskAgain="help.dontAskAgain",e.Thankyou="help.thankyou",e.MoreInfo="help.moreinfo",e.ConfigureSettings="help.configureSettings",e.Loading="loading",e.Other="other"}(t.ViewItem||(t.ViewItem={}));class o{}t.ActivityType=o,o.session="session",o.workspace="workspace",o.debug="debug",o.terminal="terminal"},function(e){e.exports=JSON.parse('{"name":"vsls","displayName":"VS Live Share extension API","description":"Enables VS Code extensions to access Live Share capabilities.","version":"0.0.0-placeholder","publisher":"ms-vsliveshare","main":"vscode.js","preview":true,"license":"SEE LICENSE IN LICENSE.txt","homepage":"https://aka.ms/vsls","bugs":{"url":"https://aka.ms/vsls-issues","email":"vsls-feedback@microsoft.com"},"author":{"name":"Microsoft"},"keywords":["Live Share"],"categories":["Other"],"repository":{"url":"https://github.com/MicrosoftDocs/live-share"},"dependencies":{"@microsoft/servicehub-framework":"^2.6.74"}}')},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(7);t.getIconPathForUser=async function(e,t,n){const s=`images/participants/participant_${e%3+1}${n?"_follow":""}.svg`;return Promise.resolve(i.getExtensionUri(s))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(101),r=n(136),o=n(70),a=n(29),c=n(20);class l extends o.TreeViewItem{constructor(e){super(e),this.options=e,this.terminalId=e.terminalId}}var u;t.TerminalSessionExplorerItem=l,function(e){e.Terminals="terminals",e.LocalTerminalReadOnly="terminals.local.readonly",e.LocalTerminalReadWrite="terminals.local.readwrite",e.RemoteTerminal="terminals.remote",e.Other="other"}(u=t.TerminalsViewItem||(t.TerminalsViewItem={}));class d extends r.TreeDataProviderBase{constructor(e,t,n){super(u.Terminals,s.TreeDataProviderContext.SharedOrJoined),this.sessionContext=e,this.isSessionExplorer=t,this.trace=n}refreshItems(){super.refreshItems(),this.sharedTerminals=void 0}registerTerminalService(e){this.terminalService=e;const t=[];return t.push(e.onTerminalStarted(()=>this.forceRefreshItems())),t.push(e.onTerminalStopped(()=>this.forceRefreshItems())),t.push(e.onTerminalReadOnlyChanged(()=>this.forceRefreshItems())),i.Disposable.from(...t)}async getRootItem(){return await this.refreshSharedTerminals(),new o.TreeViewItem({type:u.Terminals,collapsibleState:i.TreeItemCollapsibleState.Expanded,label:`Shared Terminals (${this.sharedTerminals.length})`})}async getChildrenItems(e){const t=[];if(!this.terminalService)return t;await this.refreshSharedTerminals();for(const e of this.sharedTerminals)t.push(await this.getTerminalRow(e,this.sessionContext.coeditingClient.isHost));return 0===t.length?this.getDefaultTerminalsActions():t}getDefaultTerminalsActions(){return this.sessionContext.coeditingClient.isHost?[new o.TreeViewItem({type:u.Other,collapsibleState:i.TreeItemCollapsibleState.None,label:"Share terminal...",command:{title:"Share terminal...",command:this.isSessionExplorer?"liveshare.fileTreeExplorer.shareTerminal":"liveshare.activityBar.shareTerminal"}})]:[new o.TreeViewItem({type:u.Other,collapsibleState:i.TreeItemCollapsibleState.None,label:"No terminals shared"})]}async refreshSharedTerminals(){if(!this.sharedTerminals)try{this.sharedTerminals=await this.terminalService.getRunningTerminalsAsync()}catch(e){e.code!==c.RpcErrorCodes.ServiceNotAvailable&&this.trace.error("Could not get running terminals",e),this.sharedTerminals=[]}}async getTerminalRow(e,t){const n=e.options.readOnlyForGuests||a.workspaceSessionInfoTracker.isReadOnly,i=(e.options.name||"").replace("[Shared]","");return new l({label:`${i.trim()} (${n?"Read-only":"Read/write"})`,terminalId:e.id,type:t?e.options.readOnlyForGuests?u.LocalTerminalReadOnly:u.LocalTerminalReadWrite:u.RemoteTerminal,iconPath:r.TreeDataProviderBase.getThemeIconPath("terminal"),command:{title:"Focus terminal",command:this.isSessionExplorer?"liveshare.fileTreeExplorer.openTerminal":"liveshare.activityBar.openTerminal",arguments:[{terminalId:e.id}]}})}}t.TerminalsTreeDataProvider=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(101),r=n(136),o=n(70),a=n(20);class c extends o.TreeViewItem{constructor(e){super(e),this.options=e,this.port=e.port}}var l;t.ServerSessionExplorerItem=c,function(e){e.Servers="servers",e.LocalServer="servers.local",e.RemoteServer="servers.remote",e.Other="other"}(l=t.ServerSharingViewItem||(t.ServerSharingViewItem={}));class u extends r.TreeDataProviderBase{constructor(e,t,n){super(l.Servers,s.TreeDataProviderContext.SharedOrJoined),this.sessionContext=e,this.isSessionExplorer=t,this.trace=n}registerServices(e,t){this.serverSharingService=e,this.portForwardingService=t,e.onSharingChanged(()=>this.forceRefreshItems()),e.onSharingStarted(()=>this.forceRefreshItems()),e.onSharingStopped(()=>this.forceRefreshItems()),t.onSharingChanged(()=>this.forceRefreshItems()),t.onSharingStarted(()=>this.forceRefreshItems()),t.onSharingStopped(()=>this.forceRefreshItems())}refreshItems(){super.refreshItems(),this.sharedServers=void 0}async getRootItem(){return await this.refreshSharedServers(),new o.TreeViewItem({type:l.Servers,collapsibleState:i.TreeItemCollapsibleState.Expanded,label:`Shared Servers (${this.sharedServers.length})`})}async getChildrenItems(e){const t=[];if(!this.serverSharingService)return t;await this.refreshSharedServers();for(let e of this.sharedServers)t.push(await this.getServerRow(e,this.sessionContext.coeditingClient.isHost));return 0===t.length?this.getDefaultServersActions():t}getDefaultServersActions(){return this.sessionContext.coeditingClient.isHost?[new o.TreeViewItem({type:l.Other,collapsibleState:i.TreeItemCollapsibleState.None,label:"Share server...",command:{title:"Share server...",command:this.isSessionExplorer?"liveshare.fileTreeExplorer.shareServer":"liveshare.activityBar.shareServer"}})]:[new o.TreeViewItem({type:l.Other,collapsibleState:i.TreeItemCollapsibleState.None,label:"No servers shared"})]}async refreshSharedServers(){if(!this.sharedServers)try{this.sharedServers=this.sessionContext.coeditingClient.isHost?await this.serverSharingService.getSharedServersAsync():await this.portForwardingService.getSharedServersAsync()}catch(e){e.code!==a.RpcErrorCodes.ServiceNotAvailable&&this.trace.error("Could not get shared servers",e),this.sharedServers=[]}}async getServerRow(e,t){const n=t?e.sourcePort:e.destinationPort;return new c({port:n,type:t?l.LocalServer:l.RemoteServer,label:e.sessionName,iconPath:r.TreeDataProviderBase.getThemeIconPath("server"),tooltip:`${e.sessionName} (port ${n})`,command:{title:"Open Server in Browser",command:this.isSessionExplorer?"liveshare.fileTreeExplorer.openServerInBrowser":"liveshare.activityBar.openServerInBrowser",arguments:[{port:n}]}})}}t.ServerSharingTreeDataProvider=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(57),r=n(260),o=n(70),a=n(9),c=n(22),l=n(175),u=n(21),d=n(23),h=n(16),f=n(13),p=n(15),m=n(62);var g;!function(e){e[e.Question=0]="Question",e[e.Survey=1]="Survey",e[e.ThankYou=2]="ThankYou",e[e.Default=3]="Default"}(g||(g={}));t.HelpViewletProvider=class{constructor(){this.changeEventEmitter=new i.EventEmitter,this.onDidChangeTreeData=this.changeEventEmitter.event,this.state=g.Default,this.onStateChanged=e=>{e.newState!==u.SessionState.Shared&&e.newState!==u.SessionState.Joined||this.setState(g.Default),e.newState!==u.SessionState.SignedIn||e.oldState!==u.SessionState.Shared&&e.oldState!==u.SessionState.Joined||this.sessionEnd()},this.refresh=()=>this.changeEventEmitter.fire(void 0),this.getTreeItem=e=>e,d.sessionStateTracker.onStateChanged(this.onStateChanged),c.ExtensionUtil.registerCommand("liveshare.provideFeedback",this.provideFeedback,this),c.ExtensionUtil.registerCommand("liveshare.openLink",this.openLink),c.ExtensionUtil.registerCommand("liveshare.reportAProblem",this.reportAProblem),c.ExtensionUtil.registerCommand("liveshare.moreInfo",this.moreInfo),c.ExtensionUtil.registerCommand("liveshare.configureSettings",this.configureSettings)}async sessionEnd(){await this.showSurvey()?this.setState(g.Survey):await f.Settings.get(p.SettingKeys.dontRequestFeedback)||this.getSessionNumber()%5!=0||this.setState(g.Question)}setState(e){this.state=e,this.refresh()}async getChildren(e){return await(e?this.getElementChildren(e):this.getDefaultRootChildren())}async getElementChildren(e){return await this.getFeedbackChildren()}async provideFeedback(e){const t=e.name;a.TelemetryEvent.create(h.TelemetryEventNames.FEEDBACK,{properties:{feedback:t}}).send(),t===m.ViewItem.DontAskAgain&&await f.Settings.save(p.SettingKeys.dontRequestFeedback,!0),this.feedbackReceived()}async feedbackReceived(){this.setState(g.ThankYou),s.setTimeout(()=>{this.setState(g.Default)},5e3)}async openLink(e){a.TelemetryEvent.create(h.TelemetryEventNames.OPEN_LINK,{properties:{url:e}}).send(),c.ExtensionUtil.openBrowser(e)}async reportAProblem(){c.ExtensionUtil.reportIssue()}async moreInfo(){await l.showWelcomePage(l.WelcomePageSource.Help)}async configureSettings(){const{name:e,publisher:t}=c.ExtensionUtil.getPackage();await i.commands.executeCommand("workbench.action.openSettings",`@ext:${t}.${e}`)}async getFeedbackChildren(){let e=[];return this.state===g.Question?e=[new o.TreeViewItem({type:m.ViewItem.GoodFeedback,collapsibleState:i.TreeItemCollapsibleState.None,label:" It was great!",command:{title:"It was great!",command:"liveshare.provideFeedback",arguments:[{name:m.ViewItem.GoodFeedback}]}}),new o.TreeViewItem({type:m.ViewItem.BadFeedback,collapsibleState:i.TreeItemCollapsibleState.None,label:" Needs improvement",command:{title:"Needs improvement",command:"liveshare.provideFeedback",arguments:[{name:m.ViewItem.BadFeedback}]}}),new o.TreeViewItem({type:m.ViewItem.DontAskAgain,collapsibleState:i.TreeItemCollapsibleState.None,label:" Don't ask again",command:{title:"Don't ask again",command:"liveshare.provideFeedback",arguments:[{name:m.ViewItem.DontAskAgain}]}})]:this.state===g.ThankYou&&(e=[new o.TreeViewItem({type:m.ViewItem.Thankyou,collapsibleState:i.TreeItemCollapsibleState.None,label:"Thank you for your feedback!"})]),e}getSessionNumber(){return f.Settings.get(p.SettingKeys.sessionCount)+1}async showSurvey(){const e=await f.Settings.get(p.SettingKeys.surveyShownDate)||0;return Date.now()-e>=7776e6&&Math.random()<=.01}async saveSurveyShownDate(){const e=Date.now();await f.Settings.save(p.SettingKeys.surveyShownDate,e)}async showSurveyToast(){await i.window.showInformationMessage("We'd love to hear about your Live Share experience! Do you mind taking a quick feedback survey?",{title:"Take Survey"})?c.ExtensionUtil.openBrowser("https://aka.ms/vsls-nps"):new a.TelemetryEvent(h.TelemetryEventNames.DISMISS_SURVEY).send()}async getDefaultRootChildren(){let e=[];this.state===g.Survey?(this.showSurveyToast(),e.push(new o.TreeViewItem({type:m.ViewItem.Survey,collapsibleState:i.TreeItemCollapsibleState.None,label:"Take a feedback survey",command:{title:"Take a feedback survey",command:"liveshare.openLink",arguments:["https://aka.ms/vsls-nps"]},iconPath:{dark:c.ExtensionUtil.getExtensionUri("images/dark/survey-dark.svg"),light:c.ExtensionUtil.getExtensionUri("images/light/survey-light.svg")}})),this.saveSurveyShownDate()):this.state!==g.Question&&this.state!==g.ThankYou||e.push(new o.TreeViewItem({type:m.ViewItem.SessionFeedbackQuestion,collapsibleState:i.TreeItemCollapsibleState.Expanded,label:"How was your collaboration session?",iconPath:{dark:c.ExtensionUtil.getExtensionUri("images/dark/survey-dark.svg"),light:c.ExtensionUtil.getExtensionUri("images/light/survey-light.svg")}})),e.push(new o.TreeViewItem({type:m.ViewItem.TweetUsYourFeedback,collapsibleState:i.TreeItemCollapsibleState.None,label:"Tweet us your feedback",command:{title:"Tweet us your feedback",command:"liveshare.openLink",arguments:["https://aka.ms/vsls/TwitterFeedback"]},iconPath:{dark:c.ExtensionUtil.getExtensionUri("images/twitter.svg"),light:c.ExtensionUtil.getExtensionUri("images/twitter.svg")}})),e.push(new o.TreeViewItem({type:m.ViewItem.ReportAProblem,collapsibleState:i.TreeItemCollapsibleState.None,label:"Report a problem",command:{title:"Report a problem",command:"liveshare.reportAProblem"},iconPath:{dark:c.ExtensionUtil.getExtensionUri("images/dark/github-dark.svg"),light:c.ExtensionUtil.getExtensionUri("images/light/github-light.svg")}})),e.push(new o.TreeViewItem({type:m.ViewItem.ConfigureSettings,collapsibleState:i.TreeItemCollapsibleState.None,label:"Configure Settings",command:{title:"Configure Settings",command:"liveshare.configureSettings"},iconPath:{dark:c.ExtensionUtil.getExtensionUri("images/dark/settings.svg"),light:c.ExtensionUtil.getExtensionUri("images/light/settings.svg")}})),e.push(new o.TreeViewItem({type:m.ViewItem.MoreInfo,collapsibleState:i.TreeItemCollapsibleState.None,label:"More Info",command:{title:"More Info",command:"liveshare.moreInfo"},iconPath:{dark:c.ExtensionUtil.getExtensionUri("images/dark/info-dark.svg"),light:c.ExtensionUtil.getExtensionUri("images/light/info-light.svg")}}));const t=await r.getLabelAndLinkTreeViewItems("HelpViewlet");return e.push(...t),e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(62),r=n(101),o=n(260),a=n(70),c=n(26);t.CollabActionTreeDataProvider=class{constructor(e){this.isInFileTreeExplorer=e}get supportedContext(){return r.TreeDataProviderContext.NotSharedOrJoined}getTreeItem(e){return e}async getChildren(e){const t=this.isInFileTreeExplorer?"liveshare.startFromFileTreeExplorer":"liveshare.startFromActivityBar",n=this.isInFileTreeExplorer?"liveshare.joinFromFileTreeExplorer":"liveshare.joinFromActivityBar",r=c.localize("startCollaborationSession");let l=[new a.TreeViewItem({type:s.ViewItem.Other,collapsibleState:i.TreeItemCollapsibleState.None,label:c.localize("joinCollaborationSession"),command:{title:"Join collaboration session...",command:n}}),new a.TreeViewItem({type:s.ViewItem.Other,collapsibleState:i.TreeItemCollapsibleState.None,label:r,command:{title:r,command:t}})];const u={access:s.Access.ReadOnly},d=this.isInFileTreeExplorer?"liveshare.startReadOnlyFromFileTreeExplorer":"liveshare.startReadOnlyFromActivityBar";l.push(new a.TreeViewItem({type:s.ViewItem.Other,collapsibleState:i.TreeItemCollapsibleState.None,label:c.localize("startReadOnlyCollaborationSession"),command:{title:"Start read-only collaboration session..",command:d,arguments:[u]}}));const h=await o.getLabelAndLinkTreeViewItems("SessionExplorer");return l.push(...h),Promise.resolve(l)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(244),s=n(9);function r(e){return(t,n,i)=>{let s=null,r=null;if("function"==typeof i.value?(s="value",r=i.value):"function"==typeof i.get&&(s="get",r=i.get),!r||!s)throw new Error("not supported");i[s]=e(r,n,t)}}function o(e){return e.then(()=>{})}t.decorate=r,t.debounce=function(e){return r((t,n)=>{const i=`$debounce$${n}`;return function(...n){clearTimeout(this[i]),this[i]=setTimeout(()=>t.apply(this,n),e)}})},t.throttle=r((function(e,t){const n=`$throttle$current$${t}`,i=`$throttle$next$${t}`,s=function(...t){if(this[i])return this[i];if(this[n])return this[i]=o(this[n]).then(()=>(this[i]=void 0,s.apply(this,t))),this[i];this[n]=e.apply(this,t);const r=()=>this[n]=void 0;return o(this[n]).then(r,r),this[n]};return s})),t.done=o,t.memoize=r((function(e,t){const n=`$memoize$${t}`;return function(...t){return this.hasOwnProperty(n)||Object.defineProperty(this,n,{configurable:!1,enumerable:!1,writable:!1,value:e.apply(this,t)}),this[n]}})),t.instrumented=function({telemetryEventName:e,telemetryFaultEventName:t,telemetryProperties:n,onError:o}){return r((r,a,c)=>function(...l){const u=n=>{const r=c&&c.constructor&&c.constructor.name?`${c.constructor.name}.${a}`:a,l=i.TelemetryUtil.DeriveTelemetryResult(n),u=i.TelemetryUtil.BuildTelemetryMessage(r,l,n.message);if(s.Telemetry.sendFault(t||e+"-fault",i.TelemetryUtil.MapTelemetryResultToFaultType(l),u,n),this.trace&&this.trace.traceEvent&&this.trace.traceEvent(i.TelemetryUtil.MapTelemetryResultToTraceEventType(l),0,`[${r}]: ${u}`),"function"==typeof o)return o.apply(this,n);if(void 0!==o)return o;throw n},d=t=>{const i=void 0===n?void 0:"function"==typeof n?n.apply(this,t):n;return s.Telemetry.sendTelemetryEvent(e,i),t};try{const e=r.apply(this,l);return e&&"function"==typeof e.then?e.then(e=>d(e),e=>u(e)):d(e)}catch(e){return u(e)}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(33);t.singleInvocationCommandDecorator=function(e){return i.DecoratorHelper.setupDecorator(t=>new r(e,t))};const s={numInvocations:0,maxInvocations:1};class r{constructor(e,t){this.commandId=e,this.next=t,r.commandInvocations[e]||(r.commandInvocations[e]=Object.assign({},s))}get numInvocations(){return r.commandInvocations[this.commandId].numInvocations}set numInvocations(e){r.commandInvocations[this.commandId].numInvocations=e}get maxInvocations(){return r.commandInvocations[this.commandId].maxInvocations}async invoke(e,t){if(!(this.numInvocations>=this.maxInvocations)){this.numInvocations++;try{return await this.next.invoke(e,t)}catch(e){throw e}finally{this.numInvocations--}}}}t.SingleInvocationCommandDecorator=r,r.commandInvocations={}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(15),s=n(13),r=n(62),o=n(451),a=n(1046),c=n(1047),l=n(1048);t.ExtensionSetupBase=class{constructor(e,t){this.commandRegistryProvider=e,this.dependencies=t,this.didInit=!1,this.commandFiles={}}async init(){this.registerCommands(),Object.keys(this.commandFiles).forEach(e=>{this.commandRegistryProvider.register(e,this.getCommandBuilder(this.commandFiles[e]))}),this.didInit=!0}registerCommands(){o.registerCommands(this),this.registerJoinCommands(),this.registerShareCommands(),this.registerUserElevationCommand(),this.registerCreateInvitationLinkCommand(),this.registerCreateSessionCommand()}register(e,t,n){const r={builder:t,options:n};this.commandFiles[(e=>{const t=`${s.Settings.get(i.SettingKeys.commandPrefix)}.`;return e.startsWith(t)?e:`${t}${e}`})(e)]=r}async dispose(){this.didInit&&this.commandRegistryProvider.disposeAll()}getCommandBuilder(e){return()=>{const{builder:t}=e,n=t(this.dependencies);return{invoke:(t,i)=>n.invoke(Object.assign(Object.assign({},e.options),t),i)}}}registerJoinCommands(){const e=["join","joinFromFileTreeExplorer","joinFromActivityBar","joinFromWelcomeContent"];for(let t of e)this.register(t,this.joinCommandBuilder,{isAllowAnonymous:!0})}registerShareCommands(){const e=["start","startFromFileTreeExplorer","startFromActivityBar","startFromWelcomeContent","startFromWelcomePage"];for(let t of e)this.register(t,this.shareCommandBuilder);const t=["startReadOnly","startReadOnlyFromFileTreeExplorer","startReadOnlyFromActivityBar","startReadOnlyFromWelcomeContent"];for(let e of t)this.register(e,this.shareCommandBuilder,{access:r.Access.ReadOnly});this.register("startPresentation",this.shareCommandBuilder,{isPresentation:!0})}registerUserElevationCommand(){const e=["liveshare.activityBar.user.elevate","liveshare.fileTreeExplorer.user.elevate"],t=["liveshare.activityBar.user.decrease","liveshare.fileTreeExplorer.user.decrease"];for(let t of e)this.register(t,a.builder,{isReadOnly:!1});for(let e of t)this.register(e,a.builder,{isReadOnly:!0})}registerCreateInvitationLinkCommand(){this.register("createInvitationLink",c.builder)}registerCreateSessionCommand(){this.register("createSession",l.builder)}}},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const s=n(261),r=n(177),o=n(262),a=n(137),c=n(102),l=n(176),u=n(178),d=n(21),h=n(16);t.builder=function(){return new p};const f={statusPostAuth:d.SessionAction.AttemptSignIn,authAttemptMax:1};let p=class{async invoke(e,t){return!1}};p=i([u.cancellationDecorator(),a.errorNotificationCommandDecorator("Signing in",h.TelemetryEventNames.SIGN_IN_FAULT_EXPLICIT),c.telemetryCommandDecorator(h.TelemetryEventNames.SIGN_IN_EXPLICIT,h.TelemetryEventNames.SIGN_IN_FAULT_EXPLICIT,"ExplicitSignIn"),l.telemetryStatusCommandDecorator(),o.validationCommandDecorator(),s.sessionStateTransitionsCommandDecorator(d.SessionAction.AttemptSignIn,d.SessionAction.SignInSuccess,d.SessionAction.SignInError),r.authenticationCommandDecorator(f)],p),t.SignInCommand=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(23),r=n(21),o=n(31),a=n(22);t.builder=function(e){return new c(e)};class c{constructor(e){this.dependencies=e}async invoke(e,t){if(s.sessionStateTracker.State!==r.SessionState.Joined&&s.sessionStateTracker.State!==r.SessionState.Shared)if(o.userAuthStateTracker.IsSignedIn){if(!this.dependencies.sessionContext().isStartingCollaboration)return a.ExtensionUtil.runWithProgress(()=>this.dependencies.authenticationProvider().signOut(),{title:"Signing Out"});await a.ExtensionUtil.showErrorAsync("Cannot sign out while collaboration is starting.")}else await i.window.showInformationMessage("Not signed in.")}}},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(7),a=n(261),c=n(177),l=n(262),u=n(137),d=n(102),h=n(176),f=n(178),p=n(450),m=n(16),g=n(21),y=n(22);t.builder=function(e){return new S(e.fileSystemManager())};const v={statusPostAuth:g.SessionAction.AttemptJoining,authAttemptMax:2};let S=class extends o.CommandBase{constructor(e){super(),this.fileSystemManager=e}async invoke(e,t){const{cancellationTokenSource:n}=t;if(!n||!n.token.isCancellationRequested)return await this.fileSystemManager.registerFileSystemProvider(!1),this.fileSystemManager.disposeWorkspaceProvider(),await r.workspace.saveAll(!1),await y.ExtensionUtil.setTransientWorkspace(!1),await r.commands.executeCommand("workbench.action.reloadWindow"),!0}};S=i([f.cancellationDecorator(),u.errorNotificationCommandDecorator("Signing in",m.TelemetryEventNames.JOIN_FAULT),d.telemetryCommandDecorator(m.TelemetryEventNames.WORKSPACE_SIGNIN_RELOAD,m.TelemetryEventNames.JOIN_FAULT,"SignInToElevate",1),h.telemetryStatusCommandDecorator(),l.validationCommandDecorator(),p.progressCommandDecorator(),a.sessionStateTransitionsCommandDecorator(null,g.SessionAction.JoiningSuccess,g.SessionAction.JoiningError),c.authenticationCommandDecorator(v),s("design:paramtypes",[Object])],S),t.SignInAndReloadCommand=S},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(7),s=n(79),r=n(13),o=n(15),a=n(9),c=n(16);t.builder=function(e){return new l(e)};class l{constructor(e){this.dependencies=e}async invoke(e,t){if(a.Telemetry.sendTelemetryEvent(c.TelemetryEventNames.FOCUS_PARTICIPANTS),!this.dependencies.sessionContext().coeditingClient)return;this.dependencies.sessionContext().coeditingClient.postMessage(s.MessageFactory.SummonMessage(this.dependencies.sessionContext().coeditingClient.clientID));const n=!!r.Settings.get(o.SettingKeys.showVerboseNotifications);await i.NotificationUtil.showInformationMessage("Focus request sent.",n)}}t.FocusParticipantsCommand=l},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});const r=n(102),o=n(137),a=n(16),c=n(29);t.builder=function(e){return new l(e.workspaceAccessControlManager())};let l=class{constructor(e){this.workspaceAccessControlManager=e}async invoke(e,t){if(!e||"number"!=typeof e.sessionId||isNaN(e.sessionId))return;c.workspaceSessionInfoTracker.getAnonymousAccessMapHasTheProfile(e)&&await c.workspaceSessionInfoTracker.updateAnonymousAccess(e,e.isReadOnly),await this.workspaceAccessControlManager.setUserReadOnly(e.isReadOnly,e.sessionId)}};l=i([o.errorNotificationCommandDecorator("Changing user permissions",a.TelemetryEventNames.USER_ELEVATION_TOGGLE_COMMAND_FAULT),r.telemetryCommandDecorator(a.TelemetryEventNames.USER_ELEVATION_TOGGLE_COMMAND,a.TelemetryEventNames.USER_ELEVATION_TOGGLE_COMMAND_FAULT,"Toggle user read/write access",1),s("design:paramtypes",[Object])],l)},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});const r=n(263),o=n(16),a=n(102);n(5);t.builder=function(e){return new c(e.workspaceService())};let c=class extends r.LiveShareCommandBase{constructor(e){super(),this.workspaceService=e}async invoke(e,t){const{cancellationTokenSource:n}=t;return t.telemetryEvent.addProperty(o.TelemetryPropertyNames.CREATE_INVITATION_LINK,!0),await this.workspaceService.createInvitationLinkAsync(e,n&&n.token)}};c=i([a.telemetryCommandDecorator(o.TelemetryEventNames.CREATE_INVITATION_LINK,o.TelemetryEventNames.CREATE_INVITATION_LINK_FAULT,"CreateInvitationLink",1),s("design:paramtypes",[Object])],c),t.CreateInvitationLinkCommand=c},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=(n(5),n(263)),a=n(102),c=n(176),l=n(137),u=n(178),d=n(177),h=n(16),f=n(29),p=n(21),m=n(1049),g=n(26);t.builder=function(e){return new v(e.workspaceService(),e.workspaceAccessControlManager())};const y={statusPostAuth:p.SessionAction.Create};let v=class extends o.LiveShareCommandBase{constructor(e,t){super(),this.workspaceService=e,this.workspaceAccessControlManager=t}async invoke(e,t){const{cancellationTokenSource:n}=t;try{let e;await r.window.withProgress({location:r.ProgressLocation.Notification,title:g.localize("CreateLinkProgress")},async()=>{e=await this.workspaceService.createPersistentWorkspaceAsync(null,!0,n&&n.token)}),f.workspaceSessionInfoTracker.workspaceSessionInfo=e,await m.showReusableLink(this.workspaceAccessControlManager,e,t),t.telemetryEvent.addProperty(h.TelemetryPropertyNames.CREATE_WORKSPACE,!0)}catch(e){throw t.trace.error(`Failed to create a Reusable Session link. ${e}`),new Error(g.localize("CannotCreatePersistentSession"))}}};v=i([u.cancellationDecorator(),l.errorNotificationCommandDecorator("Creating a Reusable Session link",h.TelemetryEventNames.CREATE_FAULT),a.telemetryCommandDecorator(h.TelemetryEventNames.CREATE_WORKSPACE,h.TelemetryEventNames.CREATE_FAULT,"Create",1),c.telemetryStatusCommandDecorator(),d.authenticationCommandDecorator(y),s("design:paramtypes",[Object,Object])],v),t.CreateSessionCommand=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(95),r=n(446),o=n(16),a=n(26);t.showReusableLink=async function(e,t,n,c){const l=t.joinUri.toString(),u=t.id,d=await(new s.ClipboardUtil).copyToClipboardAsync(l),h={id:1,title:a.localize("generic.MoreInfo")},f={id:2,title:d?a.localize("generic.CopyAgain"):a.localize("generic.CopyLink")},p={id:3,title:a.localize("generic.StartSharing")};let m=[h,f,p];const g=await i.window.showInformationMessage(d?a.localize("notification.ReusableInvitationLinkCopied"):a.localize("notification.ReusableInvitationLinkCreated"),!0,...m);if(g)switch(g.id){case f.id:n.telemetryEvent.addProperty(o.TelemetryPropertyNames.COPYLINK_FROM_CREATE_WORKSPACE,!0),await r.showInvitationLink(e,l,!d,!1);break;case h.id:n.telemetryEvent.addProperty(o.TelemetryPropertyNames.MOREINFO_FROM_CREATE_WORKSPACE,!0),i.commands.executeCommand("vscode.open",i.Uri.parse("https://aka.ms/vsls-reusable"));break;case p.id:const t="liveshare.start";n.telemetryEvent.addProperty(o.TelemetryPropertyNames.SHARE_FROM_CREATE_WORKSPACE,!0),await i.commands.executeCommand(t,{sessionId:u})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(13),r=n(15),o=n(16),a=n(69),c=n(5),l=n(94),u=n(21),d=n(31),h=n(29),f=n(23),p=n(22),m=n(26);var g;function y(e=!1){switch(s.Settings.get(r.SettingKeys.showInStatusBar)){case g.WhileCollaborating:return!!(l.SessionContext.isCollaborating||l.SessionContext.isStartingCollaboration||e);case g.Never:return e;case g.Always:default:return!0}return!0}!function(e){e.Always="always",e.WhileCollaborating="whileCollaborating",e.Never="never"}(g||(g={}));const v=()=>{const e=s.Settings.isInsidersFeatureSet||s.Settings.isInternalFeatureSet?" ":"";let t=s.Settings.isVSLSTeamMember?" ":"";return t=s.Settings.get(r.SettingKeys.nativeAuthFlow)?" ":t,`${e}${t}`},S=()=>{const e=r.FeatureSet[s.Settings.get(r.SettingKeys.featureSet)];return s.Settings.get(r.SettingKeys.isInternal)?" (Internal User)":e===r.FeatureSet.insiders?" (Insider)":""};t.StatusBarController=class{constructor(e,t){this.commandEnabledCallback=e,this.quickPickItemsProvider=t,this.updateStatusBarPromise=Promise.resolve(),this.userStatusBarItem=i.window.createStatusBarItem(i.StatusBarAlignment.Left,4),this.userStatusBarItem.hide(),this.collabStatusBarItem=i.window.createStatusBarItem(i.StatusBarAlignment.Left,3),this.collabStatusBarItem.hide(),this.updateStatusBar(new E),l.SessionContext.onCoeditingClientChanged(e=>{e&&this.registerClientListeners(e)}),f.sessionStateTracker.onStateChanged(async e=>await this.onSessionStateChanged(e.newState)),h.workspaceSessionInfoTracker.onReadOnlyChanged(async()=>{f.sessionStateTracker.State!==u.SessionState.Joined&&f.sessionStateTracker.State!==u.SessionState.Shared||await this.onSessionStateChanged(f.sessionStateTracker.State)})}refresh(){this.updateStatusBar(this.currentState)}async onSessionStateChanged(e){let t=this.getStatusBarState(e);this.updateStatusBarPromise=this.updateStatusBarPromise.then(async()=>{await this.updateStatusBar(t)})}getStatusBarState(e){switch(e){case u.SessionState.Initializing:return new E;case u.SessionState.SigningIn:return new b;case u.SessionState.ExternallySigningIn:return new w;case u.SessionState.SignedIn:return new C(this.quickPickItemsProvider);case u.SessionState.SharingInProgress:return d.userAuthStateTracker.IsSignedIn?new T(this.quickPickItemsProvider):new b;case u.SessionState.Shared:return new k(this.quickPickItemsProvider);case u.SessionState.JoiningInProgress:return d.userAuthStateTracker.IsSignedIn?new M(this.quickPickItemsProvider):new b;case u.SessionState.Joined:return new R(this.commandEnabledCallback,this.quickPickItemsProvider);default:case u.SessionState.SignedOut:return new w}}async updateStatusBar(e){this.disposed||(this.currentState=e,y()?(await e.updateUserStatusBarItem(this.userStatusBarItem),await e.updateCollabStatusBarItem(this.collabStatusBarItem)):(this.userStatusBarItem.hide(),this.collabStatusBarItem.hide()))}registerClientListeners(e){e.onCoEditorSwitchedFile(async(e,t)=>{f.sessionStateTracker.State!==u.SessionState.Joined&&f.sessionStateTracker.State!==u.SessionState.Shared||await this.currentState.onCoEditorSwitchedFile(e,t,this.collabStatusBarItem)}),e.onCoEditorsJoined(async e=>{f.sessionStateTracker.State!==u.SessionState.Joined&&f.sessionStateTracker.State!==u.SessionState.Shared||await this.currentState.onCoEditorsJoined(e,this.collabStatusBarItem)})}async onWorkspaceSessionChanged(e){this.currentState instanceof A&&e.changeType===c.vsls.WorkspaceSessionChangeType.Unjoined&&await this.currentState.onCoEditorLeft(e.sessionNumber,this.collabStatusBarItem)}dispose(){this.updateStatusBar(new E),this.disposed=!0}};class _{hideItem(e){e.hide(),e.text=void 0,e.command=void 0,e.tooltip=void 0}}t.StatusBarState=_;class E extends _{async updateUserStatusBarItem(e){this.hideItem(e)}async updateCollabStatusBarItem(e){this.hideItem(e)}}t.InitialState=E;class w extends _{async updateUserStatusBarItem(e){const t=i.workspace.workspaceFolders&&i.workspace.workspaceFolders[0],n=t&&t.uri.scheme===s.Settings.get(r.SettingKeys.scheme);if(f.sessionStateTracker.State===u.SessionState.ExternallySigningIn&&n)return e.text="$(person) Sign in",e.command=`${s.Settings.get(r.SettingKeys.commandPrefix)}.signin`,e.tooltip=`Sign in to enable ${s.Settings.get(r.SettingKeys.name)} collaboration.`,void e.show();e.text="$(live-share) Live Share",e.command=`${s.Settings.get(r.SettingKeys.commandPrefix)}.start`,e.tooltip=`Share the workspace with ${s.Settings.get(r.SettingKeys.name)}.`,e.show()}async updateCollabStatusBarItem(e){this.hideItem(e)}}t.SignedOutState=w;class b extends _{async updateUserStatusBarItem(e){e.hide()}async updateCollabStatusBarItem(e){this.hideItem(e)}}t.SigningInState=b;class C extends _{constructor(e){super(),this.quickPickItemsProvider=e}get userInfo(){return d.userAuthStateTracker.userInfo}get isCurrentUserAnonymous(){return d.userAuthStateTracker.isCurrentUserAnonymous()}get currentUserQuickPickItems(){const e=[{label:"$(live-share) "+m.localize("statusbar.StartSession"),description:"",detail:m.localize("statusbar.StartSessionMessage"),command:"liveshare.start",enabled:()=>!0},{label:"$(live-share) "+m.localize("statusbar.StartReadOnly"),description:"",detail:m.localize("statusbar.StartReadOnlyMessage"),command:"liveshare.startReadOnly",enabled:()=>!0},{label:"$(organization) "+m.localize("statusbar.JoinSession"),description:"",detail:m.localize("statusbar.JoinSessionMessage"),command:"liveshare.join",enabled:()=>!0}];return s.Settings.get(r.SettingKeys.nativeAuthFlow)||e.push({label:`$(sign-out) Sign Out (${this.userInfo.userName||this.userInfo.emailAddress} via ${this.userInfo.providerName})`,description:"",detail:`Sign out of your ${s.Settings.get(r.SettingKeys.name)} account.`,command:`${s.Settings.get(r.SettingKeys.commandPrefix)}.signout`,enabled:()=>!0}),e}async updateUserStatusBarItem(e){await p.ExtensionUtil.tryRegisterCommand("_liveshare.showSignedInUserOptions",()=>this.showQuickPick(this.currentUserQuickPickItems,{placeHolder:m.localize("statusbar.SignedUserPlaceholder")}).then(e=>e&&i.commands.executeCommand(e.command,e.commandArg))),this.isCurrentUserAnonymous?e.hide():(e.text=`$(person) ${this.signedInName}${v()}`,e.command="_liveshare.showSignedInUserOptions",e.tooltip=`Signed in to ${s.Settings.get(r.SettingKeys.name)}${this.signedInInfo}${S()}`,e.show())}async updateCollabStatusBarItem(e){e.text="$(live-share) Live Share",e.command="liveshare.start",e.tooltip=m.localize("statusbar.StartCollaboration"),e.show()}showQuickPick(e,t){const n=this.quickPickItemsProvider.getQuickPickItems(f.sessionStateTracker.State),s=e.length>1?e.length-1:0,r=e.slice(0);r.splice(s,0,...n);const o=r.filter(e=>e.enabled());return i.window.showQuickPick(o,t)}get signedInName(){if(!this.userInfo)return"";const{displayName:e="",emailAddress:t,userName:n}=this.userInfo;if(e){return e.replace(/ .*$/,"")}return n||t||"Signed In"}get signedInInfo(){return this.userInfo.isAnonymous?` as ${s.Settings.get(r.SettingKeys.anonymousUserName)} (${a.READ_ONLY_LABEL})`:this.userInfo.displayName?" as "+this.userInfo.displayName+(this.userInfo.emailAddress?" <"+this.userInfo.emailAddress+">":" <"+this.userInfo.userName+">")+" ("+this.userInfo.providerName+")":" as "+(this.userInfo.emailAddress?this.userInfo.emailAddress:this.userInfo.userName)+" ("+this.userInfo.providerName+")"}}t.SignedInState=C;class T extends C{async updateCollabStatusBarItem(e){e.hide()}async updateUserStatusBarItem(e){await super.updateUserStatusBarItem(e),e.command=void 0}}t.SharingInProgressState=T;class M extends C{async updateCollabStatusBarItem(e){e.hide()}async updateUserStatusBarItem(e){await super.updateUserStatusBarItem(e),e.command=void 0}}t.JoiningState=M;class A extends C{async updateCollabStatusBarItem(e){return this.innerUpdateCollabStatusBarItem(e,!1)}async onCoEditorSwitchedFile(e,t,n){if(1===l.SessionContext.collaboratorManager.getCollaboratorCount())return this.innerUpdateCollabStatusBarItem(n,!0)}async onCoEditorsJoined(e,t){const n=l.SessionContext.collaboratorManager.getCollaboratorCount()-e.length;return this.innerUpdateCollabStatusBarItem(t,n>=1)}onCoEditorLeft(e,t){if(!l.SessionContext.collaboratorManager.wasCoEditor(e))return;const n=l.SessionContext.collaboratorManager.getCollaboratorCount()>0;return this.innerUpdateCollabStatusBarItem(t,n)}async innerUpdateCollabStatusBarItem(e,t){const n=f.sessionStateTracker.State;if(n!==u.SessionState.Joined&&n!==u.SessionState.Shared||!y())return;const i=l.SessionContext.collaboratorManager.getCollaboratorCount(),s=n===u.SessionState.Shared&&h.workspaceSessionInfoTracker.isReadOnly?` (${a.READ_ONLY_LABEL})`:"";if(e.text=`$(organization) ${i}${s}`,i>0){const n=l.SessionContext.collaboratorManager.getCollaboratorSessionIds();if(1===i){const t=n[0],i=l.SessionContext.collaboratorManager.getDisplayName(t),s=l.SessionContext.coeditingClient.lastKnownFileForClient(t);e.tooltip=s?`Follow ${i} (currently editing ${s})`:`${i} (not currently editing a shared document)`}else e.tooltip="Follow a participant's cursor.";t||(e.command="liveshare.listParticipants")}else e.command=null,e.tooltip="There are no participants (to invite others, start by clicking on your name in the status bar)";e.show()}}t.CollaborationState=A;class k extends A{constructor(e){super(e),this.sharingQuickPickItems=[{label:"$(clippy) "+m.localize("statusbar.InviteOthers"),description:"",detail:m.localize("statusbar.InviteOthersMessage"),command:"liveshare.collaboration.link.copy",enabled:()=>!0},{label:"$(megaphone) "+m.localize("statusbar.FocusParticipants"),description:"",detail:m.localize("statusbar.FocusParticipantsMessage"),command:"liveshare.focusParticipants",enabled:()=>l.SessionContext.collaboratorManager.getCollaboratorCount()>0},{label:"$(terminal) "+`${h.workspaceSessionInfoTracker.isReadOnly?m.localize("statusbar.ShareReadOnlyTerminal"):m.localize("statusbar.ShareTerminal")}`,description:"",detail:m.localize("statusbar.ShareTerminalMessage"),command:"liveshare.shareTerminal",commandArg:o.TelemetryEventOrigin.StatusBar,enabled:()=>!0},{label:"$(plug) "+m.localize("statusbar.ShareServer"),description:"",detail:m.localize("statusbar.ShareServerMessage"),command:"liveshare.shareServer",commandArg:o.TelemetryEventOrigin.StatusBar,enabled:()=>!0},{label:"$(plug) "+m.localize("statusbar.ShowSharedServers"),description:"",detail:m.localize("statusbar.ShowSharedServersMessage"),command:"liveshare.listServers",commandArg:o.TelemetryEventOrigin.StatusBar,enabled:()=>l.SessionContext.hasServersShared},{label:"$(plug) "+m.localize("statusbar.StopSharingServer"),description:"",detail:m.localize("statusbar.StopSharingServerMessage"),command:"liveshare.unshareServer",commandArg:o.TelemetryEventOrigin.StatusBar,enabled:()=>l.SessionContext.hasServersShared},{label:"$(circle-slash) "+m.localize("statusbar.StopCollaborationSession"),description:"",detail:m.localize("statusbar.StopCollaborationSessionMessage"),command:"liveshare.end",enabled:()=>!0}]}async updateUserStatusBarItem(e){const t="_liveshare.showSharedUserOptions";await p.ExtensionUtil.tryRegisterCommand(t,()=>this.showQuickPick(this.sharingQuickPickItems,{placeHolder:m.localize("statusbar.placeHolder")}).then(e=>e&&i.commands.executeCommand(e.command,e.commandArg)),void 0,!1,!0),e.text=`$(broadcast) ${this.signedInName}${v()}`,e.command=t,e.tooltip=`Sharing via ${s.Settings.get(r.SettingKeys.name)}${this.signedInInfo}${S()}`,e.show()}}t.SharedState=k;class R extends A{constructor(e,t){super(t),this.commandEnabledCallback=e,this.collaboratorQuickPickItems=[{label:"$(person) "+m.localize("generic.SignIn"),description:"",detail:m.localize("statusbar.SignInMessage"),command:"liveshare.signInAndReload",enabled:()=>d.userAuthStateTracker.isCurrentUserAnonymous()},{label:"$(megaphone) "+m.localize("statusbar.FocusParticipants"),description:"",detail:m.localize("statusbar.FocusParticipantsMessage"),command:"liveshare.focusParticipants",enabled:()=>l.SessionContext.collaboratorManager.getCollaboratorCount()>0},{label:"$(bug) "+m.localize("statusbar.AttachSharedDebuggingSession"),description:"",detail:m.localize("statusbar.AttachSharedDebuggingSessionMessage"),command:"liveshare.debug",enabled:()=>this.commandEnabledCallback("liveshare.debug")},{label:"$(terminal) "+m.localize("statusbar.AccessSharedTerminal"),description:"",detail:m.localize("statusbar.AccessSharedTerminalMessage"),command:"liveshare.listTerminals",commandArg:o.TelemetryEventOrigin.StatusBar,enabled:()=>l.SessionContext.hasSharedTerminals},{label:"$(plug) "+m.localize("statusbar.AccessSharedServer"),description:"",detail:m.localize("statusbar.AccessSharedServerMessage"),command:"liveshare.listServers",commandArg:o.TelemetryEventOrigin.StatusBar,enabled:()=>l.SessionContext.hasServersShared},{label:"$(circle-slash) "+m.localize("statusbar.LeaveCollaborationSession"),description:"",detail:m.localize("statusbar.LeaveCollaborationSessionMessage"),command:"liveshare.leave",enabled:()=>!0}]}async updateUserStatusBarItem(e){const t="_liveshare.showCollaboratorOptions";await p.ExtensionUtil.tryRegisterCommand(t,()=>this.showQuickPick(this.collaboratorQuickPickItems,{placeHolder:m.localize("statusbar.placeHolder")}).then(e=>e&&i.commands.executeCommand(e.command,e.commandArg)));const n=h.workspaceSessionInfoTracker.isReadOnly?` (${a.READ_ONLY_LABEL})`:"",o=this.userInfo.isAnonymous?s.Settings.get(r.SettingKeys.anonymousUserName):this.signedInName;e.text=`$(broadcast) ${o}${n}${v()}`,e.command=t,e.tooltip=`Collaborating via ${s.Settings.get(r.SettingKeys.name)}${this.signedInInfo}${S()}`,e.show()}}t.JoinedState=R},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(13),r=n(15),o=n(21),a=n(23),c=n(26),l=[o.SessionState.ExternallySigningIn,o.SessionState.Initializing,o.SessionState.SignedIn,o.SessionState.SignedOut,o.SessionState.SigningIn];t.createSimpleStatusBar=function(){const e=i.window.createStatusBarItem(i.StatusBarAlignment.Left,3);e.text="$(live-share) Live Share",e.command="liveshare.start",e.tooltip=c.localize("statusbar.StartCollaboration");const t=()=>{"always"===s.Settings.get(r.SettingKeys.showInStatusBar)&&e.show()};t(),a.sessionStateTracker.onStateChanged(n=>{l.indexOf(n.newState)>=0?t():e.hide()})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(9),r=n(16),o=n(22),a=n(21),c=n(23),l=n(13),u=n(15),d=n(96),h=n(7),f=n(448),p=n(19);t.registerProtocolHandler=e=>{"function"==typeof i.window.registerUriHandler&&o.ExtensionUtil.context.subscriptions.push(i.window.registerUriHandler(new m(e)))};class m{constructor(e){this.telemetryEvent=e}async handleUri(e){const{path:t}=e,n=t.split("?")[0];switch(h.traceSource.verbose(`handleUri => uri:${p.TraceFormat.formatText(e.toString())}`),n){case"/join":return this.join(e);case"/signin":await d.auth.API.authCallback(e)}}join(e){const t=function(e){const t={},n=(e="?"===e[0]?e.substr(1):e).split("&");for(let e=0;e<n.length;e++){const i=n[e].split("="),s=decodeURIComponent(i[0]),r=decodeURIComponent(i[1]||"");t[s]=r}return t}(e.query),{vslsLink:n,correlationId:i}=t,s=e.with({query:`workspaceId=censored&correlationId=${i}`});if(this.reportInvocationToTelemetry(s),!n)throw new Error("VSCode protocol handler passed a link with unknown format.");{const e=`${l.Settings.get(u.SettingKeys.commandPrefix)}.join`,t=decodeURIComponent(n),s=c.sessionStateTracker.State===a.SessionState.Joined||c.sessionStateTracker.State===a.SessionState.Shared;h.traceSource.verbose(`VSLSProtocolHandler join => link:${t} correlationId:${i}`);const r={correlationId:i,link:t,newWindow:s};f.executeNextCommand(e,r)}}reportInvocationToTelemetry(e){new s.TelemetryEvent(r.TelemetryEventNames.INVOKE_NEWPROTOCOLHANDLER).addProperty(r.TelemetryPropertyNames.URI,e.toString()).correlateWith(this.telemetryEvent).send()}dispose(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(6),r=n(7),o=n(31),a=n(69),c=n(13),l=n(15),u=n(7),d=n(23),h=n(16),f=n(21),p=n(96),m=n(130),g=n(240),y=n(97),v=n(26);function S(e,t){if(1===e.length)return e[0];for(let n of e)if(n.strategy!==t)return n}t.AuthenticationProvider=class{constructor(e,t){this.authService=e,this.shouldClearCache=!1,t&&(this.nativeAuth=new y.NativeAuthProvider,this.nativeAuth.onSignOut(this.handleOnDidSignOut.bind(this)))}isAuthenticated(){return o.userAuthStateTracker.IsSignedIn}async clearCache(e){o.userAuthStateTracker.userInfo=void 0,this.shouldClearCache=!0}async handleOnDidSignOut(){d.sessionStateTracker.State===f.SessionState.Shared?await i.commands.executeCommand("liveshare.end"):d.sessionStateTracker.State===f.SessionState.Joined&&await i.commands.executeCommand("liveshare.leave"),await this.signOut()}async getUsernameFromInput(){const e=c.Settings.get(l.SettingKeys.anonymousUserName);const t=(await u.NotificationUtil.showInputBox({prompt:"Enter the name to display to other participants",ignoreFocusOut:!0,value:e||a.DEFAULT_ANONYMOUS_USER_NAME})||"").trim();return t?t.slice(0,50):a.DEFAULT_ANONYMOUS_USER_NAME}async askForUserName(){const e=await this.getUsernameFromInput();return e&&await c.Settings.save(l.SettingKeys.anonymousUserName,e),e}async attemptLoginVSCodeAccount(e,t){this.shouldClearCache=!1,d.sessionStateTracker.point(h.TelemetryPropertyNames.ATTEMPT_LOGIN_STARTING);const n=async()=>{await p.auth.API.logOut([e.strategy])};try{let i=void 0;const s=e.strategy.publicName.toLowerCase();i="vsls"!==e.tokenType?await this.authService.loginWithExternalTokenAsync({providerName:s},{token:e.accessToken},{cache:!1,cacheDefault:!1},null,t):await this.authService.loginAsync({token:e.accessToken},{cache:!1,cacheDefault:!1},null,t),i?i.providerName||(i.providerName=s):await n(),o.userAuthStateTracker.userInfo=i}catch(e){throw await n(),e}return o.userAuthStateTracker.isCustomAccount=!1,d.sessionStateTracker.point(h.TelemetryPropertyNames.ATTEMPT_LOGIN_COMPLETE),!!o.userAuthStateTracker.userInfo}async attemptSilentNativeLogin(e,t){var n,i,s,a;if(!this.nativeAuth)return r.traceSource.info("Attempt to use silent native auth when it's turned off."),!1;let u;if(d.sessionStateTracker.point(h.TelemetryPropertyNames.SILENT_NATIVE_LOGIN_STARTING),t){const{cancellationTokenSource:e}=t;u=e&&e.token}this.shouldClearCache=!1,o.userAuthStateTracker.isCustomAccount=!1;let f=!1;await p.auth.API.waitForInitialLogin;const g=c.Settings.get(l.SettingKeys.authenticationProvider);let v=y.SupportedAuthProviders[g];v||(v=y.SupportedAuthProviders.GitHub);const S=await m.TimeTracker.timeIt("getCachedToken",async()=>await this.nativeAuth.getCachedToken(v));S&&(r.traceSource.info(`Attempt to log in with ${v} auth provider.`),f=await m.TimeTracker.timeIt("attemptLoginWithNativeToken",async()=>await this.attemptLoginWithNativeToken(S,u)),f?(r.traceSource.info(`Authenticated with "${v}" auth provider.`),d.sessionStateTracker.point(h.TelemetryPropertyNames.SILENT_NATIVE_LOGIN_SIGNED_IN_WITH_NATIVE_PROVIDER),null===(n=null==t?void 0:t.telemetryEvent)||void 0===n||n.addProperty(h.TelemetryPropertyNames.SILENT_NATIVE_LOGIN_AUTH_PROVIDER,v)):this.nativeAuth.resetAccessTokenCache(v));const _=this.anonymousAuthStrategy;if(!f&&e.isAllowAnonymous&&_){d.sessionStateTracker.point(h.TelemetryPropertyNames.SILENT_NATIVE_LOGIN_ATTEMPTING_ANONYMOUS_STRATEGY);const e=await _.getAccessToken();null===(i=null==t?void 0:t.telemetryEvent)||void 0===i||i.addProperty(h.TelemetryPropertyNames.SILENT_NATIVE_LOGIN_IS_ANONYMOUS_TOKEN_SET,!!e),e&&(r.traceSource.info("Attempt to log in as anonymous with previously acquired token."),f=await this.attemptLoginWithNativeToken(e.accessToken,u)),f&&(r.traceSource.info("Authenticated as anonymous."),null===(s=null==t?void 0:t.telemetryEvent)||void 0===s||s.addProperty(h.TelemetryPropertyNames.SILENT_NATIVE_LOGIN_AUTH_PROVIDER,_.name),d.sessionStateTracker.point(h.TelemetryPropertyNames.SILENT_NATIVE_LOGIN_SIGNED_IN_AS_ANONYMOUS))}return null===(a=null==t?void 0:t.telemetryEvent)||void 0===a||a.addProperty(h.TelemetryPropertyNames.SILENT_NATIVE_LOGIN_RESULT,f),f}async attemptPromptedNativeLogin(e){if(!this.nativeAuth)return r.traceSource.info("Attempt to use prompted native auth when it's turned off."),!1;let t;d.sessionStateTracker.point(h.TelemetryPropertyNames.PROMPTED_NATIVE_LOGIN_STARTING);const n=Object.entries(y.SupportedAuthProviders).map(([e,t])=>({label:e,description:v.localize("authentication.SignInPrompt").replace("${key}",e),id:t}));r.traceSource.info("Present auth provider picker.");const o=await i.window.showQuickPick(n,{ignoreFocusOut:!0,placeHolder:v.localize("authentication.SignInPromptPlaceholder")});if(!o)throw r.traceSource.info("Auth provider picker has been cancelled by the user."),new s.CancellationError;t=o.id,c.Settings.save(l.SettingKeys.authenticationProvider,o.label);const{cancellationTokenSource:a}=e,u=a&&a.token;if(u&&u.isCancellationRequested)throw r.traceSource.info("Auth has been cancelled via cancellationToken before we've got an auth token."),d.sessionStateTracker.point(h.TelemetryPropertyNames.PROMPTED_NATIVE_LOGIN_CANCELED_VIA_CANCELLATION_TOKEN),new s.CancellationError;if(!t)throw r.traceSource.info("Auth has been cancelled by the user before we've got a token."),d.sessionStateTracker.point(h.TelemetryPropertyNames.PROMPTED_NATIVE_LOGIN_THE_USER_CANCELED_AUTH_PROVIDER_PICK),new s.CancellationError;e.telemetryEvent.addProperty(h.TelemetryPropertyNames.PROMPTED_NATIVE_LOGIN_SELECTED_AUTH_PROVIDER,t),r.traceSource.info(`Attempt to log in with ${t} auth provider.`);const f=await this.nativeAuth.getCachedTokenOrLogin(t,e);if(u&&u.isCancellationRequested)throw r.traceSource.info("Auth cancelled after we've got a token."),d.sessionStateTracker.point(h.TelemetryPropertyNames.PROMPTED_NATIVE_LOGIN_CANCELED_VIA_CANCELLATION_TOKEN),new s.CancellationError;if(!f)throw d.sessionStateTracker.point(h.TelemetryPropertyNames.PROMPTED_NATIVE_LOGIN_FAILED_TO_ACQUIRE_AUTH_TOKEN),new Error(`Auth token returned by ${t} provider is empty.`);const p=await this.attemptLoginWithNativeToken(f,u);return p?r.traceSource.info(`Authenticated with "${t}" auth provider.`):this.nativeAuth.resetAccessTokenCache(t),e.telemetryEvent.addProperty(h.TelemetryPropertyNames.PROMPTED_NATIVE_LOGIN_RESULT,p),p}async attemptLoginWithNativeToken(e,t){return o.userAuthStateTracker.userInfo=await this.authService.loginAsync({token:e},{cache:!1,cacheDefault:!1},null,t),!!o.userAuthStateTracker.userInfo}async attemptAnonymousLoginVSCodeAccount(e,t){this.shouldClearCache=!1,d.sessionStateTracker.point(h.TelemetryPropertyNames.ATTEMPT_ANONYMOUS_LOGIN_STARTING);const n=this.anonymousAuthStrategy;if(!n)throw new Error("Anonymous login not supported");const i=await p.auth.API.getTokensOrAskToSignIn({shouldSkipQuestion:!0,strategies:[n]});return!!i.length&&(await this.attemptLoginVSCodeAccount(i[0],t),d.sessionStateTracker.point(h.TelemetryPropertyNames.ATTEMPT_ANONYMOUS_LOGIN_COMPLETE),!!o.userAuthStateTracker.userInfo)}async attemptDefaultLoginVSCodeAccount(e,t){this.shouldClearCache=!1,d.sessionStateTracker.point(h.TelemetryPropertyNames.ATTEMPT_DEFAULT_LOGIN_STARTING),o.userAuthStateTracker.isCustomAccount=!1;const n=await this.getDefaultStrategies(),i=this.anonymousAuthStrategy;e.isAllowAnonymous&&i&&n.push(i),await p.auth.API.waitForInitialLogin;let s=await p.auth.API.getCachedTokens({strategies:n});if(!s.length)return!1;await this.waitForAuthenticateService();for(let e=0;e<s.length;e++){const n=S(s.slice(e),i);if(!n)return!1;if(await this.attemptLoginVSCodeAccount(n,t)){r.traceSource.info(`Authenticated with "${n.strategy.name}" strategy.`);break}}return d.sessionStateTracker.point(h.TelemetryPropertyNames.ATTEMPT_DEFAULT_LOGIN_COMPLETE),!!o.userAuthStateTracker.userInfo}async attemptLogin(e,t,n){this.shouldClearCache=!1,d.sessionStateTracker.point(h.TelemetryPropertyNames.ATTEMPT_LOGIN_STARTING),o.userAuthStateTracker.userInfo=await this.authService.loginAsync({code:e},{cache:!0,cacheDefault:!0},null,n);let i=c.Settings.get(l.SettingKeys.account),s=c.Settings.get(l.SettingKeys.accountProvider);return o.userAuthStateTracker.isCustomAccount=!(!i&&!s),d.sessionStateTracker.point(h.TelemetryPropertyNames.ATTEMPT_LOGIN_COMPLETE),!!o.userAuthStateTracker.userInfo}async signOut(){if(!this.isAuthenticated())return;const e=await this.getDefaultStrategies();await p.auth.API.logOut(e),await this.authService.logoutAsync({cache:!0}),o.userAuthStateTracker.userInfo=void 0,d.sessionStateTracker.transition(f.SessionAction.SignOut)}get anonymousAuthStrategy(){return g.liveshareAnonymousStrategy}async getDefaultStrategies(){return[p.auth.API.defaultStrategy,g.liveshareGithubStrategy]}waitForAuthenticateService(){return Promise.resolve()}async waitForAuthenticatedUserToken(){let e,t=await this.authService.getCurrentAuthenticatedUserAsync();return t&&t.accessToken?t.accessToken:await new Promise(t=>e=this.authService.onAuthenticationChanged(n=>{n.accessToken&&(e.dispose(),t(n.accessToken))}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(5),r=n(16),o=n(7),a=n(26),c=n(13),l=n(6),u=n(42),d=n(264),h=n(447),f={"extensions.ignoreRecommendations":!0,"editor.detectIndentation":!0,"editor.formatOnSave":!1,"files.hotExit":"off","files.autoSave":"off","files.trimTrailingWhitespace":!1,"files.insertFinalNewline":!1,"files.trimFinalNewlines":!1,"typescript.tsc.autoDetect":"off","jake.autoDetect":"off","grunt.autoDetect":"off","gulp.autoDetect":"off","npm.autoDetect":"off","debug.allowBreakpointsEverywhere":!0,"html.autoClosingTags":!1};class p{static async finishInviteLinkJoining(e,t){const n=p.getInviteLinkJoining(t);if(!n)return;const i=()=>e.fireInviteStatusChanged(n.targetContactId,n.fromContactId,s.vsls.InviteContactStatus.None);e.hasSendMessageProvider?await i():new Promise(t=>{e.once(d.ContactManagerEvents.ProviderCapabilitiesChanged,()=>{e.hasSendMessageProvider&&t(null)})}).then(i)}static extractLiveshareWorkspaceId(e=""){const{linkMatch:t,linkEncodedMatch:n,vscodeDevLinkMatch:i,cascadeMatch:s}=p.getLiveshareLinkMatch(e);return t?t[3]:n?n[3]:i?i[1]:s?s[1]:void 0}static extractLiveshareLink(e=""){const{linkMatch:t,linkEncodedMatch:n,vscodeDevLinkMatch:i,cascadeMatch:s}=p.getLiveshareLinkMatch(e);return t?`https://${t[0]}`:n?`https://${decodeURIComponent(n[0])}`:i?`https://${i[0]}`:s?s[0]:void 0}static async applyGuestSettingsToWorkspace(e){const t=i.workspace.getConfiguration();for(const n of Object.keys(f))try{const s=t.get(n),r=f[n];r!==s&&(o.traceSource.verbose(`settingName:${n} old:${s} new:${r}`),await t.update(n,r,e||i.ConfigurationTarget.Workspace))}catch(e){o.traceSource.info(`[applying guest workspace settings]: Failed to set the "${n}" setting on the workspace.`)}}static getBaseWorkspaceSettings(){return Object.assign({},f)}static async showInformationMessage(e,t,...i){if(!t)return(await Promise.resolve().then(()=>n(0))).window.showInformationMessage(e,...i)}static async showWaitingForHostProgressBar(e,t,n,i){let s=!1;const{cancellationTokenSource:o,telemetryEvent:a}=i,c=o&&o.token;return await e.progressNotifierUtil().create({title:"Waiting for the host to start the session..."},c,async e=>new Promise(async(i,o)=>{const c=()=>{s=!0,a.addProperty(r.TelemetryPropertyNames.RETRY_JOIN,"True"),o(new l.CancellationError("The operation was cancelled."))};e&&(e.isCancellationRequested?c():e.onCancellationRequested(async()=>{c()}));try{const e=new Date;let r;for(e.setMinutes(e.getMinutes()+n);new Date<e&&!s;)await l.wait(1e3),r=await t(),r||i(!1),!0===r.isHostConnected&&i(!0);i(!1)}catch(e){o(e)}}))}static addAdditionalRootsFromFileServiceToWorkspace(e,t){const n=e=>i.Uri.parse(`${c.Settings.scheme}:${e.path}`);e.listRootsAsync({enableMultipleRoots:!0}).then(async e=>{try{const s=i.workspace.workspaceFolders&&i.workspace.workspaceFolders.length>0?i.workspace.workspaceFolders[0].uri:n(e[0]);if(await function(e,t){var n;if(i.workspace.workspaceFolders&&e&&!(i.workspace.workspaceFolders.length>0&&i.workspace.workspaceFolders[0].name===e.name)&&!(i.workspace.workspaceFolders.length<=0&&!t&&(null===(n=u.getExpService())||void 0===n?void 0:n.getTreatmentVariable("vscode","joinFailureUriOfUndefined"))))return t?h.updateWorkspaceFolders(0,i.workspace.workspaceFolders.length,{uri:t,name:e.name||a.localize("emptyWorkspace.liveShareWorkspace")}):void 0}(t,s),e.length<2)return;const r=e.slice(1).map((e,t)=>({uri:n(e),name:e.friendlyName||`Workspace ${t+1}`}));if(!await h.updateWorkspaceFolders(1,0,...r))throw new Error("Unable to add non-primary workspace folders")}catch(e){o.traceSource.error("Failed to update workspace folders",e)}})}static async restoreLiveshareWorkspaceState(e,t="Loading file tree..."){const n=i.workspace.getConfiguration();await n.update("vsliveshare.join.reload.workspaceId",e,i.ConfigurationTarget.Workspace),await p.applyGuestSettingsToWorkspace();let s=`${c.Settings.scheme}:/`;await h.updateWorkspaceFolders(0,null,{uri:i.Uri.parse(s),name:t})}static isLiveshareWorkspaceName(e){return"Visual Studio Live Share (Workspace)"===(null==e?void 0:e.name)}static async getLiveShareWorkspaceFile(e){if(p.isLiveshareWorkspaceName(e)){const t=e.workspaceFile;if(t&&"file"===t.scheme)return t.fsPath}}static isBrokenLiveshareWorkspaceFile(e){return p.isLiveshareWorkspaceName(e)&&p.isEmptyWorkspace(e)}static isEmptyWorkspace(e){return!e.workspaceFolders||0===e.workspaceFolders.length}static async setInviteLinkJoining(e,t,n){var i;t.inviteLinkJoining&&(null===(i=n.telemetryEvent)||void 0===i||i.addProperty(r.TelemetryPropertyNames.JOIN_FROM_INVITE_LINK,"True"),await c.Settings.saveMemento(e,t.inviteLinkJoining))}static getInviteLinkJoining(e){const t=c.Settings.getMemento(e);return t&&c.Settings.saveMemento(e,null),t}static getLiveshareLinkMatch(e=""){return{linkMatch:e.match(this.joinLinkRegex),linkEncodedMatch:e.match(this.joinLinkEncodedRegex),vscodeDevLinkMatch:e.match(this.vscodeDevJoinLinkRegex),cascadeMatch:e.match(this.vslsLinkRegex)}}}t.JoinCommandUtilities=p,p.vslsLinkRegex=new RegExp(`${c.Settings.scheme}:?.*join.*workspaceId=([0-9A-Z-]+)`,"i"),p.joinLinkRegex=/([a-z|\-]+\.)+liveshare.*\/join(\/)?\?([0-9a-z]{36})/im,p.joinLinkEncodedRegex=/([^\dF][a-z|\-]+\.)+liveshare.*\%2Fjoin(\%2F)?\%3F([0-9a-z]{36})/im,p.vscodeDevJoinLinkRegex=/vscode.dev\/liveshare\/([0-9a-z]{36})/im},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(453),r=n(50),o=n(26),a=n(13),c=n(15);t.ShareCommandUtilities=class{static buildShareInfo(){const e=(a.Settings.get(c.SettingKeys.anonymousGuestApproval)||"").toLowerCase(),t=s.getAllRootFileSystemPaths(),n=t.foundUnsupportedSchemes?i.workspace.workspaceFolders.filter(e=>(null==e?void 0:e.uri.scheme.toLowerCase())===r.PathManager.fileScheme):i.workspace.workspaceFolders,l=n&&n.length>0&&n[0]?n[0].name:o.localize("emptyWorkspace.liveShareWorkspace");return[{rootDirectories:t.paths,name:l,connectionMode:a.Settings.get(c.SettingKeys.connectionMode),areAnonymousGuestsAllowed:"reject"!==e},t]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(22),r=n(29),o=n(95),a=n(23),c=n(21),l=n(5),u=n(7),d=n(15),h=n(13),f=n(175);t.Commands=class{constructor(e){this.coreDependencies=e,this.getWorkspaceSessionInfo=()=>{if(this.coreDependencies.sessionContext())return r.workspaceSessionInfoTracker.workspaceSessionInfo},this.removeUserCommandHandler=async e=>{if(!e||void 0===e.sessionId)return;const{sessionId:t}=e;!t||t<1||await this.workspaceUserService.removeUserAsync(t,l.vsls.WorkspaceDisconnectedReason.UserRemoved)},this.blockUserCommandHandler=async e=>{if(!e||void 0===e.sessionId)return;const{sessionId:t}=e;!t||t<1||await this.workspaceUserService.removeUserAsync(t,l.vsls.WorkspaceDisconnectedReason.UserBlocked)},this.openInVSCodeCommandHandler=()=>{const e=this.getWorkspaceSessionInfo();if(e)return i.env.openExternal(i.Uri.parse(`vscode://ms-vsliveshare.vsliveshare/join?vslsLink=${encodeURI(e.joinUri)}`)),Promise.resolve()},this.openInVSCommandHandler=()=>{const e=this.getWorkspaceSessionInfo();if(e)return i.env.openExternal(i.Uri.parse(`vsls:?action=join&workspaceId=${e.id}`)),Promise.resolve()}}initialize(){this.register(s.ExtensionUtil.context),this.initializeEvents(),h.Settings.get(d.SettingKeys.diagnosticLogging)?s.ExtensionUtil.setCommandContext("liveshare:logsEnabled",!0):s.ExtensionUtil.setCommandContext("liveshare:logsEnabled",!1)}get workspaceUserService(){return this.coreDependencies.workspaceUserService()}get sessionContext(){return this.coreDependencies.sessionContext()}get statusBarController(){return this.coreDependencies.statusBarController()}get workspaceAccessControlManager(){return this.coreDependencies.workspaceAccessControlManager()}register(e){e.subscriptions.push(s.ExtensionUtil.registerCommand("liveshare.collaboration.link.copy",this.copyCollaborationLinkCommandHandler,this)),e.subscriptions.push(s.ExtensionUtil.registerCommand("liveshare.collaboration.link.copyFromFileTreeExplorer",this.copyCollaborationLinkCommandHandler,this)),e.subscriptions.push(s.ExtensionUtil.registerCommand("liveshare.collaboration.link.copyFromActivityBar",this.copyCollaborationLinkCommandHandler,this)),e.subscriptions.push(s.ExtensionUtil.registerCommand("liveshare.removeParticipant",this.removeUserCommandHandler,this)),e.subscriptions.push(s.ExtensionUtil.registerCommand("liveshare.removeParticipantFromFileTreeExplorer",this.removeUserCommandHandler,this)),e.subscriptions.push(s.ExtensionUtil.registerCommand("liveshare.removeParticipantFromActivityBar",this.removeUserCommandHandler,this)),e.subscriptions.push(s.ExtensionUtil.registerCommand("liveshare.blockParticipant",this.blockUserCommandHandler,this)),e.subscriptions.push(s.ExtensionUtil.registerCommand("liveshare.blockParticipantFromFileTreeExplorer",this.blockUserCommandHandler,this)),e.subscriptions.push(s.ExtensionUtil.registerCommand("liveshare.blockParticipantFromActivityBar",this.blockUserCommandHandler,this)),e.subscriptions.push(s.ExtensionUtil.registerCommand("liveshare.help",()=>f.showWelcomePage(f.WelcomePageSource.Help))),e.subscriptions.push(s.ExtensionUtil.registerCommand("liveshare.openInVSCode",this.openInVSCodeCommandHandler,this)),e.subscriptions.push(s.ExtensionUtil.registerCommand("liveshare.openInVS",this.openInVSCommandHandler,this))}initializeEvents(){this.workspaceUserService.onWorkspaceSessionChanged(this.onWorkspaceSessionChanged,this)}async onWorkspaceSessionChanged(e){try{this.sessionContext.collaboratorManager&&this.sessionContext.collaboratorManager.onWorkspaceSessionChanged(e),this.statusBarController&&this.statusBarController.onWorkspaceSessionChanged(e),this.sessionContext.coeditingClient&&this.sessionContext.coeditingClient.onWorkspaceSessionChanged(e),a.sessionStateTracker.State===c.SessionState.Shared&&await this.workspaceAccessControlManager.onWorkspaceSessionChanged(e)}catch(e){u.traceSource.error("onWorkspaceSessionChanged error",e)}}async copyCollaborationLinkCommandHandler(){const e=this.getWorkspaceSessionInfo();if(!e)return;const t=e.joinUri;await(new o.ClipboardUtil).copyToClipboardAsync(t)?await i.window.showInformationMessage("Invite link copied to clipboard! Send it to anyone you trust."):await i.window.showInputBox({prompt:"Copy Live Share invitation link",value:t,ignoreFocusOut:!0})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1058),s=n(179),r=n(130),o=n(1098),a=n(61),c=n(6),l=n(271),u=n(7);class d extends i.LiveShareConnection{get type(){return i.TConnectionTypes.WorkspaceHub}async createWorkspaceClient(){return h(this.trace)}}function h(e){return new s.WorkspaceClient(e,async(e,t)=>await r.TimeTracker.timeIt("openStream",()=>o.openWorkspaceConnection(e,t,a.dependencies.hubConnectionServiceFactory)),{enabled:!0,retryTimeout:250,maxTimeReconnect:1e4})}t.createLocalWorkspaceClient=h,t.initLocalConnectionHub=c.once((e,t)=>new i.ConnectionHub((e||u.traceSource).createChild("localConnectionHub"),l.getOrCreatePerformance().createGroup("LocalConnectionHub"),t||d)),t.joinWithLocalConnectionHub=(e,n,i)=>t.initLocalConnectionHub(e,i).connectOnce(n)},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var s=n(138);t.Connection=s.Connection;var r=n(267);t.LiveShareConnection=r.LiveShareConnection;var o=n(1075);t.VSCodeConnection=o.VSCodeConnection;var a=n(1077);t.CodespaceConnection=a.CodespaceConnection;var c=n(1078);t.LiveShareJointConnection=c.LiveShareJointConnection;var l=n(1079);t.VSCodeJointConnection=l.VSCodeJointConnection;var u=n(463);t.ConnectionHub=u.ConnectionHub;var d=n(139);t.errorToConnectionError=d.errorToConnectionError;var h=n(462);t.getVSCodeServerSessionName=h.getVSCodeServerSessionName;var f=n(1082);t.isVSCodeServerSession=f.isVSCodeServerSession;var p=n(461);t.vscodeServerHostRPCService=p.vscodeServerHostRPCService;var m=n(459);t.TConnectionTypes=m.TConnectionTypes,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(1083));const g=i(n(1084));t.mocks=g;var y=n(268);t.PerformanceEventIds=y.PerformanceEventIds;var v=n(460);t.PerformanceGroupIds=v.PerformanceGroupIds;var S=n(269);t.VSCODE_SERVER_PORT_NAME=S.VSCODE_SERVER_PORT_NAME},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Reconnecting=1]="Reconnecting",e[e.Reconnected=2]="Reconnected",e[e.Closed=3]="Closed"}(t.ConnectedState||(t.ConnectedState={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Auto="auto",e.Direct="direct",e.Relay="relay",e.Local="local",e.SignalR="signalR"}(t.ConnectionMode||(t.ConnectionMode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LatencyMetrics=class{constructor(e,t,n,i){this.current=e,this.average=t,this.min=n,this.max=i}}},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=n(19),r=n(315),o=n(6),a=i(n(43)),c=n(5);class l{constructor(e,t,n){this.serviceUri=e,this.tokenProvider=t,this.logger=n,this.getRequestHeaders=()=>({Authorization:`Bearer ${this.tokenProvider()}`,"Cache-Control":"no-cache","Content-Type":"application/json"}),o.assertDefined(e,"service uri needs to be defined");let i=e;i.endsWith("/")||(i+="/"),i.includes("api/v1.2")||(i+="api/v1.2"),this.baseUri=this.removeTrailingSlash(i),this.httpClient=new r.HttpClient(n)}static async getWorkspaceSessionInfo(e,t,n){n.info(`getWorkspaceSessionInfo -> workspaceId:${e}`);const i=new l(t.liveShareEndpoint,()=>t.token,n),[s,r]=await Promise.all([i.getWorkspaceAccess(e),i.getWorkspaceInfo(e)]),a=Object.assign(Object.assign({},s),r);return o.assertDefined(r,"Cannot get LiveShare workspace info."),o.assertDefined(s,"Cannot get LiveShare workspace access."),o.assertDefined(r.relaySas,"No RelaySas token found."),a}async deleteWorkspace(e){o.assertDefined(e,"Cannot get Live Share workspaceId"),e=e.toUpperCase();const t=`${this.baseUri}/workspace/${e}`;this.logger.log(s.LogLevel.Debug,`delete workspace -> ${t}`),await this.httpClient.delete(t,{headers:this.getRequestHeaders()})}async getWorkspaceInfo(e){o.assertDefined(e,"Cannot get Live Share workspaceId"),e=e.toUpperCase();const t=`${this.baseUri}/workspace/${e}`;return this.logger.log(s.LogLevel.Debug,`get workspace info -> ${t}`),await this.httpClient.get(t,{headers:this.getRequestHeaders()}).value()}async getWorkspaceAccess(e){o.assertDefined(e,"Cannot get Live Share workspaceId"),e=e.toUpperCase();const t=`${this.baseUri}/workspace/${e}/user`;return this.logger.log(s.LogLevel.Debug,`get workspace access -> ${t}`),await this.httpClient.put(t,{headers:this.getRequestHeaders()}).value()}async postWorkspaceInfo(e){const t=`${this.baseUri}/workspace`;return this.logger.log(s.LogLevel.Debug,`post workspace info -> ${t}`),await this.httpClient.post(t,{headers:this.getRequestHeaders(),body:JSON.stringify(e)}).value()}async createInvitationLink(e){const t=`${this.baseUri}/workspace/${e.workspaceId}/link`;return await this.httpClient.put(t,{headers:this.getRequestHeaders(),body:JSON.stringify(e)}).value()}async getWorkspaceUserProfile(e,t){var n;o.assertDefined(e,"Cannot get Live Share workspaceId"),e=e.toUpperCase();const i=`${this.baseUri}/workspace/${e}/user`;this.logger.log(s.LogLevel.Debug,`get workspace user profile -> ${i}`);const r=await this.httpClient.get(i,{headers:Object.assign(Object.assign({},this.getRequestHeaders()),{"User-Session-Token":t})}).value();return(null===(n=r)||void 0===n?void 0:n.username)&&(r.userName=r.username),r}static async createSshKeys(){const e=a.SshAlgorithms.publicKey.rsaWithSha512,t=await e.generateKeyPair(),n=(await t.getPublicKeyBytes(t.keyAlgorithmName)).toString("base64");return[t,n]}async createSharedWorkspace(e){const t=await l.createSshKeys(),n={name:e.name,connectionMode:c.vsls.ConnectionMode.Relay,areAnonymousGuestsAllowed:e.areAnonymousGuestsAllowed,hostPublicKeys:[t[1]]},i=await this.postWorkspaceInfo(n);return{workspaceInfo:i,hostPrivateKeys:[t[0]],getWorkspaceUserProfile:e=>this.getWorkspaceUserProfile(i.id,e)}}removeTrailingSlash(e){return e.endsWith("/")?e.substr(0,e.length-1):e}}t.WorkspaceApi=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.workspaceServiceClient={name:"workspaceServiceClient",methods:["getSessionInfo","join","disconnect","openStreamingChannel","keepAlive","checkConnection","setCheckConnectionOptions"],events:["hostConnectionChanged","workspaceMetricsUpdated"]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e){super(`Host not connected to workspace:${e}`),this.workspaceId=e}}t.NoHostConnectedError=i,function(e){e[e.ConnectionError=1]="ConnectionError",e[e.SasInvalid=2]="SasInvalid",e[e.EndpointNotFound=3]="EndpointNotFound",e[e.ListenerOffline=4]="ListenerOffline",e[e.ServerError=5]="ServerError"}(t.RelayErrorType||(t.RelayErrorType={}));class s extends Error{constructor(e,t){super(e),this.errorContext=t}}t.RelayConnectionError=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RPC_ERR_NO_HOST_NOT_CONNECTED=270,t.RPC_ERR_RELAY_CONNECTIONY_SSH=271},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.TelemetryEventNames=i,i.WORKSPACE_RECONNECT="workspace-reconnect";class s{}t.TelemetryPropertyNames=s,s.RECONNECT_SUCCEEDED="reconnect-succeeded",s.RECONNECT_ELAPSED="reconnect-elapsed",s.RECONNECT_RETRY_COUNT="reconnect-retry-count",s.RECONNECT_ERROR_MESSAGE="reconnect-error-message",s.RECONNECT_ERROR_REASON="reconnect-error-reason"},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(8)),r=n(6),o=n(456),a=n(20);class c extends r.DisposableClass{constructor(e,t){super(t),this.rcpClientInstance=e,this.onHostConnectionChangedEmitter=new s.Emitter,this.onHostConnectionChanged=this.onHostConnectionChangedEmitter.event,this.onWorkspaceMetricsUpdatedEmitter=new s.Emitter,this.onWorkspaceMetricsUpdated=this.onWorkspaceMetricsUpdatedEmitter.event,this.rpcProxyCache=new a.RpcProxyCache(this.rcpClientInstance,t),this.addToDisposables(r.createDisposable(()=>{this.stopCheckConnection("disposed")}))}get rpcClient(){return this.rcpClientInstance}getServiceProxy(e,t){return this.rpcProxyCache.getOrCreate(e,t)}setCheckConnectionOptions(e){return e.enabled&&void 0===this.checkConnectionDisposable&&!this.isDisposed?(this.ensureIsJoined(),this.checkConnectionDisposable=o.checkWorkspaceClient(this,this.trace,e.metricsTimeout,e.checkConnectionTimeout,()=>this.canCheckConnection())):e.enabled||this.stopCheckConnection("connection options"),Promise.resolve()}ensureIsJoined(){}canCheckConnection(){return!0}stopCheckConnection(e){this.trace.info(`stopCheckConnection reason:'${e}'`),void 0!==this.checkConnectionDisposable&&(this.checkConnectionDisposable.dispose(),this.checkConnectionDisposable=void 0)}}t.WorkspaceClientBase=c},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(43)),r=n(6),o=n(20),a=n(83),c=n(5),l=n(1069),u=n(9);class d extends a.WorkspaceClientBase{constructor(e,t,n){super(new o.RpcClient({create:e=>this.rpcConnected.promise},e),e),this.socketStreamFactory=t,this.sshReconnectOptions=n,this.checkConnectionMutex=new r.Mutex,this.rpcConnected=new r.Signal}async join(e){var t;const n=null!==(t=e.performance)&&void 0!==t?t:{measure:(e,t)=>t()};r.assertDefined(e.connectionInfo||e.sessionInfoFactory||0!==e.liveShareEndpoint.length,"join connect options expected");const i=await this.getSessionInfo(e,n);if(!1===i.isHostConnected)throw new a.NoHostConnectedError(e.workspaceId);this.sshWorkspaceSession=await this.createWorkspaceSession(n,i),n.measure({id:"ssh-auth-completion",name:"Ssh auth completion"},()=>this.sshWorkspaceSession.authCompletion).catch(e=>{this.trace.error("auth failed")}),this.addToDisposables(this.sshWorkspaceSession);const s=this.sshWorkspaceSession.sshSession,o=(e,t,n)=>{this.onWorkspaceMetricsUpdatedEmitter.fire({bytesIn:e,bytesOut:t,latency:n})};null==s||s.metrics.onMessageReceived(()=>{o(s.metrics.bytesReceived,void 0,void 0)}),null==s||s.metrics.onMessageSent(()=>{o(void 0,s.metrics.bytesSent,void 0)}),null==s||s.metrics.onLatencyUpdated(()=>{const e=new a.LatencyMetrics(s.metrics.latencyCurrentMs,s.metrics.latencyAverageMs,s.metrics.latencyMinMs,s.metrics.latencyMaxMs);o(void 0,void 0,e)}),this.trace.info("join started");const{clientVersionInfo:c,workspaceJoinInfo:l,clientCapabilities:u}=e,d=n.measure({id:"join-internal",name:"Joining the workspace"},()=>this.joinInternal(i,null!=c?c:{},l,u));return await Promise.all([this.sshWorkspaceSession.authCompletion,d]),this.onWorkspaceSessionConnectionChange(e),e.checkConnectionOptions&&await this.setCheckConnectionOptions(e.checkConnectionOptions),this.workspaceSessionInfo}ensureIsJoined(){r.assertDefined(this.sshWorkspaceSession,"Ssh session not initiated yet")}canCheckConnection(){var e;return!1===(null===(e=this.sshWorkspaceSession)||void 0===e?void 0:e.isReconnecting)}async createWorkspaceSession(e,t){return await e.measure({id:"createSshWorkspaceSession",name:"Creating the ssh workspace session"},()=>l.SshWorkspaceSessionFactory.createSshWorkspaceSession(t,this.trace,this.socketStreamFactory,this.sshReconnectOptions))}onWorkspaceSessionConnectionChange(e){var t;const n=(t,n)=>{var i;const r=new u.TelemetryEvent(a.TelemetryEventNames.WORKSPACE_RECONNECT),o=e.telemetryProperties;if(o&&Object.keys(o).forEach(e=>r.addProperty(e,o[e])),r.addProperty(u.TelemetryPropertyNames.FEATURE_NAME+a.TelemetryPropertyNames.RECONNECT_SUCCEEDED,void 0===n.error),r.addProperty(u.TelemetryPropertyNames.FEATURE_NAME+a.TelemetryPropertyNames.RECONNECT_ELAPSED,t),r.addProperty(u.TelemetryPropertyNames.FEATURE_NAME+a.TelemetryPropertyNames.RECONNECT_RETRY_COUNT,n.retryCount),void 0!==n.error){if(n.error instanceof s.SshReconnectError){const e=null!==(i=n.error.reason)&&void 0!==i?i:s.SshReconnectFailureReason.unknownClientFailure;r.addProperty(u.TelemetryPropertyNames.FEATURE_NAME+a.TelemetryPropertyNames.RECONNECT_ERROR_REASON,e)}r.addProperty(u.TelemetryPropertyNames.FEATURE_NAME+a.TelemetryPropertyNames.RECONNECT_ERROR_MESSAGE,n.error.message)}r.send()};let i;null===(t=this.sshWorkspaceSession)||void 0===t||t.onConnectedStateChanged(e=>{const t=i?Date.now()-i:0;e.state===a.ConnectedState.Reconnecting?i=Date.now():(e.state===a.ConnectedState.Reconnected||e.state===a.ConnectedState.Closed)&&(i&&n(t,e),i=void 0),this.onHostConnectionChangedEmitter.fire({state:e.state,duration:t})}),this.trace.info("join completed")}async disconnect(){if(this.workspaceSessionInfo){const e=this.workspaceSessionInfo;this.workspaceSessionInfo=void 0,this.trace.info("unjoing"),await this.getServiceProxy(c.vsls.WorkspaceService).unjoinWorkspaceAsync(e.id),this.dispose("disconnect")}}async getSessionInfo(e,t){return e.connectionInfo?e.connectionInfo:e.sessionInfoFactory?await e.sessionInfoFactory(e.workspaceId):await t.measure({id:"workspaceApi-getWorkspaceSessionInfo",name:"get workspace session info from liveshare"},()=>a.WorkspaceApi.getWorkspaceSessionInfo(e.workspaceId,e,this.trace.createChild("WorkspaceApi")))}async joinInternal(e,t,n,i){const s=await this.sshWorkspaceSession.createRpcMessageStream(),r=[],o=s.reader.listen.bind(s.reader);let a;s.reader.listen=e=>{a=e,o(t=>{!this.rpcConnected.isFulfilled&&t.hasOwnProperty("method")&&r.push(t),e(t)})};const l=this.rcpClientInstance.createRpcConnection(s,this.trace);l.listen();const u=this.getServiceProxyWithConnection(l,c.vsls.ConfigurationService),d=await u.exchangeVersionsAsync({},t);this.trace.info("Host version: "+JSON.stringify(d)),i||((i=new c.vsls.ClientCapabilities).isNonInteractive=!1);let h={id:e.id,connectionMode:c.vsls.ConnectionMode.Local,joiningUserSessionToken:e.sessionToken,clientCapabilities:i};n&&(h=Object.assign(Object.assign({},h),n));const f=this.getServiceProxyWithConnection(l,{name:c.vsls.WorkspaceService.name,methods:c.vsls.WorkspaceService.methods,voidMethods:c.vsls.WorkspaceService.voidMethods,events:[]});this.workspaceSessionInfo=await f.joinWorkspaceAsync(h),this.rpcConnected.resolve(l),r.forEach(e=>{a(e)}),this.trace.info(`joinWorkspace -> session:${this.workspaceSessionInfo.sessionNumber} conversation:${this.workspaceSessionInfo.conversationId} join messages count:${r.length}`)}getServiceProxyWithConnection(e,t){return o.RpcProxy.createWithConnection(t,e,this.trace)}async openStreamingChannel(e,t){return r.assertDefined(this.sshWorkspaceSession,"Ssh session not initiated yet"),this.trace.info(`openStreamingChannel -> streamId:${e}`),await this.sshWorkspaceSession.openStreamingChannel(e,t)}async checkConnection(e){r.assertDefined(this.sshWorkspaceSession,"Ssh session not initiated yet"),this.trace.verbose("checking ssh connection");const t=this.sshWorkspaceSession.sshSession;r.assert(!t.isClosed,"ssh session is closed");const n=new s.SessionRequestMessage("ping-check-connection",!0);await this.checkConnectionMutex.dispatch(()=>t.request(n,e))}}t.WorkspaceClient=d},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(43)),o=n(6),a=n(457),c=n(1074),l=s(n(252)),u=60*o.TIME_SECOND_MS,d=5*o.TIME_SECOND_MS,h=5*o.TIME_SECOND_MS;t.SshWorkspaceSessionFactory=class{static async createSshWorkspaceSession(e,t,n,i){const s=n||a.SshHelpers.openConnection,f=t.createChild("ssh");l.default.enable(l.default.disable()+",vs-ssh"),"object"==typeof l.default.inspectOpts&&(l.default.inspectOpts.hideDate=!0);const p=l.default.log;l.default.log=function(...e){"vs-ssh"===this.namespace?f.info(e[0],...e.slice(1)):p()};const m=i||{enabled:!0};let g=await s(e,t);const y=await a.SshHelpers.createSshClientSession(),v=new r.PromiseCompletionSource;return t.verbose("authenticating..."),await a.SshHelpers.authenticate(y,e,e,g,v),new c.SshWorkspaceSession(y,v.promise,t.createChild("SshWorkspaceSession"),m.enabled?async()=>{const n=m.maxTimeReconnect||u,i=m.retryTimeout||d;t.info(`reconnect started maxTimeReconnect:${n} retryTimeout:${i}`);const a=Date.now();let c,l=1;for(;Date.now()-a<=n&&!y.isClosed;){try{g=await s(e,t),t.info(`reconnecting ssh session retryCount:${l}`),await o.timeoutPromise(y.reconnect(g),h,new Error("timeout on ssh reconnection")),t.info(`ssh session successfully reconnected on retryCount:${l} time:${(Date.now()-a).toFixed(1)}`),c=void 0;break}catch(e){if(c=e,e instanceof r.SshReconnectError){t.error(`failed to reconnect ssh session: ${e.message}`);break}t.verbose(`failed to reconnect ssh session retryCount:${l} error:${e}`),await o.wait(i)}++l}return c&&(t.error(`unable to reconnect ssh session -> retryCount:${l}`),y.dispose()),{retryCount:l,error:c}}:void 0)}}},function(e,t,n){var i;if("object"==typeof globalThis)i=globalThis;else try{i=n(458)}catch(e){}finally{if(i||"undefined"==typeof window||(i=window),!i)throw new Error("Could not determine global this")}var s=i.WebSocket||i.MozWebSocket,r=n(1071);function o(e,t){return t?new s(e,t):new s(e)}s&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(o,e,{get:function(){return s[e]}})})),e.exports={w3cwebsocket:s?o:null,version:r}},function(e,t,n){e.exports=n(1072).version},function(e){e.exports=JSON.parse('{"name":"websocket","description":"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.","keywords":["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],"author":"Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)","contributors":["Iaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],"version":"1.0.34","repository":{"type":"git","url":"https://github.com/theturtle32/WebSocket-Node.git"},"homepage":"https://github.com/theturtle32/WebSocket-Node","engines":{"node":">=4.0.0"},"dependencies":{"bufferutil":"^4.0.1","debug":"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2","yaeti":"^0.0.6"},"devDependencies":{"buffer-equal":"^1.0.0","gulp":"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1","jshint":"^2.0.0","tape":"^4.9.1"},"config":{"verbose":false},"scripts":{"test":"tape test/unit/*.js","gulp":"gulp"},"main":"index","directories":{"lib":"./lib"},"browser":"lib/browser.js","license":"Apache-2.0"}')},function(e){e.exports=JSON.parse('{"error.relayConnectionError":"Failed to connect to the codespace.","error.relayEndpointNotFound":"The relay endpoint for the codespace is invalid or no longer exists.","error.relayListenerOffline":"The codespace is currently offline.","error.relaySasInvalid":"Failed to connect to the codespace through the relay: invalid relay SAS.","error.relayServerError":"Failed to connect to the codespace due to an unknown relay error."}')},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=n(8),r=i(n(43)),o=n(83),a=n(6);class c extends a.DisposableClass{constructor(e,t,n,i){super(n),this.sshSession=e,this.authCompletion=t,this.onConnectedStateChangedEmitter=new s.Emitter,this.isReconnectingFlag=!1,this.onConnectedStateChanged=this.onConnectedStateChangedEmitter.event,this.addToDisposables(e,e.onDisconnected(e=>{i?(this.isReconnectingFlag=!0,this.onConnectedStateChangedEmitter.fire({state:o.ConnectedState.Reconnecting,retryCount:0}),i().then(e=>{this.isReconnectingFlag=!1,this.onConnectedStateChangedEmitter.fire({state:void 0===e.error?o.ConnectedState.Reconnected:o.ConnectedState.Closed,retryCount:e.retryCount,error:e.error})}).catch(e=>{this.isReconnectingFlag=!1})):(this.isReconnectingFlag=!1,this.onConnectedStateChangedEmitter.fire({state:o.ConnectedState.Closed,retryCount:0}),this.dispose("auto reconnect disabled"))}))}get isReconnecting(){return this.isReconnectingFlag}async createRpcMessageStream(){const e=new r.ChannelRequestMessage;e.requestType="json-rpc",e.wantReply=!0;const t=await this.sshSession.openChannel(null,e);return new r.SshRpcMessageStream(t)}async openStreamingChannel(e,t){if(!this.sshSession)throw new Error("Ssh session not initiated yet");const n=await this.sshSession.openChannel(),i=`stream-transport-${e}`;if(!await n.request(new r.ChannelRequestMessage(i),t))throw new Error(`Failed to create stream transport channel with streamId - ${e}`);return n}}t.SshWorkspaceSession=c},function(e,t,n){"use strict";(function(e){var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});const r=n(6),o=n(8),a=n(5),c=n(268),l=n(460),u=n(139),d=n(63),h=n(1076),f=n(138),p=n(461),m=n(6),g=n(462);t.DEFAULT_FORWARDING_HOST="127.0.0.1";class y extends f.Connection{constructor(e,t,n,i){super(e.createChild("vscode"),t),this.performance=t,this.options=n,this.connectionHubs=i,this.onVSCodeServerStartedEmitter=new o.Emitter,this.onVSCodeServerStarted=this.onVSCodeServerStartedEmitter.event,this.forecastChannels=[],this.vscodeServerHostClientReference=null,this.sharedServerReference=null,this.liveshareConnectionReference=null,this.serverSharingServiceReference=null,this.remotePortReference=null}getId(e){const{workspaceId:t,environmentId:n,vsCodeQuality:i,vsCodeCommit:s}=e;return`${t}_${n}_${i}_${s}`}getRpcService(e){return this.workspaceClient.getServiceProxy(e)}get workspaceClient(){r.assertDefined(this.liveshareConnection,"No LiveShare connection found.");const{workspaceClient:e}=this.liveshareConnection;return r.assertDefined(e,"No WorkspaceClient found."),e}get vscodeServerHostClient(){return r.assertDefined(this.vscodeServerHostClientReference,"No VSCodeServerHostClient defined."),this.vscodeServerHostClientReference}get serverSharingService(){return r.assertDefined(this.serverSharingServiceReference,"No ServerSharing service found."),this.serverSharingServiceReference}get liveshareConnection(){return r.assertDefined(this.liveshareConnectionReference,"No LiveShare connection found."),this.liveshareConnectionReference}async createConnection(){const[e]=this.connectionHubs;r.assertDefined(e,"LiveShareConnectionHub not found.");try{this.initializeConnection(),this.trace.info("get LS connection"),this.liveshareConnectionReference=await this.performance.measure({name:"liveshare connection"},async()=>await e.connectOnce(this.options,{performance:this.performance.createGroup("liveshare connection")})),this.liveshareConnectionReference.addToDisposables(this),this.addToDisposables(this.liveshareConnectionReference.onConnectionChanged(e=>{const{previousStatus:t,status:n}=e;this.trace.info(`LiveShareConnection status changed: "${t}" -> "${n}"`),this.dispose("LiveShareConnection disconnected")}),this.liveshareConnectionReference.onDispose(e=>{this.trace.info("LiveShareConnection disposed"),this.dispose("LiveShareConnection disposed")}));const{workspaceClient:t}=this.liveshareConnectionReference;await this.getVSCodeSharedServer(t);for(let e=0;e<y.channelForecast;e++)this.forecastChannels.push(this.openChannel(this.performance,!1));return this.onConnectionChangedHandler("connected"),this}catch(e){throw this.handleConnectionError(e),u.errorToConnectionError(e)}}get sharedServer(){return r.assertDefined(this.sharedServerReference,"No SharedServer found."),this.sharedServerReference}async getVSCodeSharedServer(e){const t=this.performance.createGroup("share vscode server",l.PerformanceGroupIds.VSCodeServerStartup);this.serverSharingServiceReference=e.getServiceProxy(a.vsls.ServerSharingService);const n=await t.measure({name:"start vscode server",id:c.PerformanceEventIds.VSCodeServerStartupServerStart},async()=>await this.startVSCodeServer(e));return r.assertDefined(n,new d.ConnectionError(`VSCode Server port is "${n}"`)),this.trace.info(`forwarding the VSCode Server port "${n}".`),this.addToDisposables(this.serverSharingService.onSharingStopped(e=>{const{server:t}=e;this.trace.verbose("serverSharingService onSharingStopped:",t),t.sourcePort===n&&(this.trace.info("serverSharingService closed.",t),this.onConnectionChangedHandler("disconnected",new d.ConnectionError("Port closed.")))})),this.sharedServerReference=await t.measure({name:"share vscode server TCP port",id:c.PerformanceEventIds.VSCodeServerStartupServerTcpPortForwarding},async()=>{const{clientId:e}=this.options;return await this.serverSharingService.startSharingAsync(n,g.getVSCodeServerSessionName(e),"")}),this.trace.info(`VSCode Server port "${n}" forwarded.`),this.sharedServerReference}async getSharedServers(){try{const e=await r.timeoutPromise(this.serverSharingService.getSharedServersAsync(),2*r.TIME_SECOND_MS,new d.ConnectionError("Getting shared servers timed out."));return this.trace.verbose("got shared servers list",e),e}catch(e){throw this.trace.error("getting shared servers failed: ",e),this.liveshareConnection.dispose(`disposed by vscode connection: "${e.message}"`),e}}async startVSCodeServer(e){const{shouldReuseExistingServers:t=!1,clientId:n}=this.options;if(this.trace.info("starting vscode server..",this.options),this.vscodeServerHostClientReference=e.getServiceProxy(p.vscodeServerHostRPCService),t){this.trace.info("checking if existing vscode server can be reused");const e=await this.getSharedServers();this.trace.info("checking already running ports",e);const t=e.reverse().find(e=>e.sessionName===g.getVSCodeServerSessionName(n));if(t)return this.remotePortReference=t.sourcePort,this.trace.info(`reusing already shared port ${this.remotePortReference}`),this.onVSCodeServerStartedEmitter.fire({port:this.remotePort,connectionToken:this.options.vsCodeCommit}),this.remotePortReference}return this.trace.info("vscode started, forwarding the server port"),this.remotePortReference=await this.vscodeServerHostClient.startRemoteServerAsync(Object.assign(Object.assign({},this.options),{quality:this.options.vsCodeQuality})),this.trace.info(`the server port forwarded, port number is ${this.remotePortReference}`),this.trace.info("vscode server startup complete"),this.onVSCodeServerStartedEmitter.fire({port:this.remotePort,connectionToken:this.options.vsCodeCommit}),this.remotePort}get remotePort(){return r.assertDefined(this.remotePortReference,"No remote port found."),this.remotePortReference}async startForwardingPort(e,n=t.DEFAULT_FORWARDING_HOST){this.trace.info(`start sharing the port "${e}"`);const i=await this.getSharedServers();return await this.startForwardingPortCore(i,e,n)}async startForwardingPortWithVisibility(e,n,i=t.DEFAULT_FORWARDING_HOST){const s=await this.getSharedServers(),r=await this.startForwardingPortCore(s,e,i);return await this.updateForwardedPortCore(r,e,n),r}async updateForwardedPortVisibility(e,t){this.trace.info(`updating visibility of "${e}" to "${t}"`);const n=await this.getSharedServers(),i=h.findSourcePort(n,e);return r.assertDefined(i,`No port "${e}" found.`),await this.updateForwardedPortCore(i,e,t)}async updateForwardedPortProtocol(e,t){this.trace.info(`updating protocol of "${e}" to "${t}"`);const n=await this.getSharedServers(),i=h.findSourcePort(n,e);return r.assertDefined(i,`No port "${e}" found.`),await this.updateForwardedPortProtocolCore(i,e,t)}async updateForwardedPortPrivacy(e,t){this.trace.info(`updating privacy of "${e}" to "${t}"`);const n=await this.getSharedServers(),i=h.findSourcePort(n,e);return r.assertDefined(i,`No port "${e}" found.`),await this.updateForwardedPortPrivacyCore(i,e,t)}async stopForwardingPort(e){const t=this.workspaceClient.getServiceProxy(a.vsls.ServerSharingService);return await t.stopSharingAsync(e),this}async openChannel(e=this.performance,t=!0){if(t){const e=this.forecastChannels.shift();if(e)return await e}const n=this.getRpcService(a.vsls.StreamManagerService),i=await e.measure({name:"get stream Id",id:r.randomString()},async()=>(r.assertDefined(this.sharedServer,"No SharedServer found."),await n.getStreamAsync(this.sharedServer.streamName,this.sharedServer.streamCondition)));return await e.measure({name:`open streaming channel "${i}"`},async()=>await this.workspaceClient.openStreamingChannel(i))||null}async sendHandshakeRequest(t){const n=new r.Signal;try{this.trace.info("opening ssh channel");const i=await this.openChannel();r.assertDefined(i,"Cannot open a channel.");const s=i.onDataReceived(e=>{s.dispose(),this.trace.info(`response: \n${e.toString()}\n`),i.adjustWindow(e.length),n.resolve(i)});this.addToDisposables(s),this.trace.info(`sending the request: \n${t}\n`),await i.send(e.from(t)),this.trace.info(" connected")}catch(e){this.trace.info("failed to send request"),n.reject(e)}return await n.promise}async disconnect(e){if(this.trace.info(`disconnecting with reason: "${e}"`),this.isDisconnected)return this.trace.info("already disconnected"),this;try{this.remotePortReference&&this.serverSharingServiceReference&&(this.trace.info(`stop sharing vscode server port "${this.remotePortReference}"`),await this.serverSharingService.stopSharingAsync(this.remotePortReference)),await this.vscodeServerHostClient.shutDownRemoteServerAsync()}catch(e){this.trace.warning("error while disconnecting",e)}finally{this.remotePortReference=null,this.vscodeServerHostClientReference=null}return super.disconnect(e)}async startForwardingPortCore(e,n,i=t.DEFAULT_FORWARDING_HOST){const s=h.findSourcePort(e,n);return s?(this.trace.info(`port ${n} is already forwarded.`),s):await this.serverSharingService.startSharingAsync(n,i,"")}async updateForwardedPortCore(e,t,n){return e.isPublic===n?(this.trace.info(`port ${t} visibility is already ${n?"public":"private"}.`),this):(await this.serverSharingService.updateSharedServerVisibilityAsync(t,n),this.trace.info(`port ${t} visibility updated to ${n?"public":"private"}.`),this)}async updateForwardedPortProtocolCore(e,t,n){return e.hasTLSHandshakePassed===n?(this.trace.info(`port ${t} protocol is already ${n?"https":"http"}.`),this):(await this.serverSharingService.updateSharedServerProtocolAsync(t,n),this.trace.info(`port ${t} protocol updated to ${n?"https":"http"}.`),this)}async updateForwardedPortPrivacyCore(e,t,n){return e.privacy===n?(this.trace.info(`port ${t} privacy is already ${n}.`),this):(await this.serverSharingService.updateSharedServerPrivacyAsync(t,n),this.trace.info(`port ${t} privacy updated to ${n}.`),this)}dispose(e){return null==this.remotePortReference||(this.trace.info(`stopping remote port "${this.remotePortReference}"`),this.stopForwardingPort(this.remotePortReference).catch(e=>{this.trace.warning("failed to stop forwarding vscode server port")})),super.dispose(e)}}y.channelForecast=2,i([m.withHelperDecorator(r.withMutexByArguments,{serializeArguments:(e,n,i=t.DEFAULT_FORWARDING_HOST)=>`${n}_${i}`}),s("design:type",Function),s("design:paramtypes",[Array,Number,String]),s("design:returntype",Promise)],y.prototype,"startForwardingPortCore",null),t.VSCodeConnection=y}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findSourcePort=(e,t,n)=>e.find(e=>{const{sourcePort:i,sessionName:s}=e,r=i===t;return n?r&&s===n:r})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6),s=n(267);class r extends s.LiveShareConnection{setWorkspaceSessionInfo(e){this.trace.verbose("setWorkspaceSessionInfo",e);const{ownerId:t,sessionNumber:n,sessions:s}=e;i.assertDefined(t,"No owner id defined."),this.trace.info(`ownerId: "${t}"`),i.assert(!t.startsWith("vm_"),"Session host is not updated to the user, retrying..."),i.assertDefined(s,"Workspace sessions not defined.");const r=s[n];i.assertDefined(r,`Session #${n} not defined.`),i.assert(r.isOwner,"Session does not have owner permissions"),super.setWorkspaceSessionInfo(e)}}t.CodespaceConnection=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6),s=n(267);class r extends s.LiveShareConnection{constructor(e,t,n,i){super(e.createChild("liveshare-joint"),t,n),this.performance=t,this.options=n,this.connectionHubs=i,this.connectionReference=null}get type(){return i.assertDefined(this.connectionReference,""),this.connectionReference.type}get workspaceSessionInfo(){if(this.connectionReference)return this.connectionReference.workspaceSessionInfo}get connection(){return this.connectionReference}async createConnection(){try{this.trace.info("creating connection"),this.connectionSignal=new i.Signal,this.addToDisposables(this.connectionSignal),this.onConnectionChangedHandler("connecting");const e=this.connectionHubs.map((e,t)=>e.connectOnce(this.options,{performance:this.performance.createGroup(`connection #${t}`)})),t=await i.raceAsync(e);return t.addToDisposables(this),i.assertDefined(this.connectionSignal,"No connection signal found."),this.connectionReference=t,this.workspaceClientReference=t.workspaceClient,this.addToDisposables(t),this.addToDisposables(t.onConnectionChanged(this.onConnectionChangedEventEmitter.fire.bind(t))),this.onConnectionChangedHandler("connected"),this}catch(e){throw this.handleConnectionError(e),e}}}t.LiveShareJointConnection=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6),s=n(138);class r extends s.Connection{constructor(e,t,n,i){super(e.createChild("vscode-joint"),t),this.performance=t,this.options=n,this.connectionHubs=i,this.connectionReference=null}getSharedServers(){throw new i.NotImplementedError("Method not implemented.")}get vscodeServerHostClient(){return i.assertDefined(this.connectionReference,"No connection found."),this.connectionReference.vscodeServerHostClient}get serverSharingService(){return i.assertDefined(this.connectionReference,"No connection found."),this.connectionReference.serverSharingService}getRpcService(e){throw new Error("Method not implemented.")}get connection(){return i.assertDefined(this.connectionReference,"No connection found."),this.connectionReference}get workspaceClient(){i.assertDefined(this.connectionReference,"No connection found.");const{liveshareConnection:e}=this.connectionReference;return i.assertDefined(e,"No LiveShare connection found."),e.workspaceClient}get liveshareConnection(){var e,t;return i.assertDefined(null===(e=this.connectionReference)||void 0===e?void 0:e.liveshareConnection,"No LiveShare conneciton found."),null===(t=this.connectionReference)||void 0===t?void 0:t.liveshareConnection}get sharedServer(){return this.connection.sharedServer}async openChannel(e){var t;const n=await(null===(t=this.connectionReference)||void 0===t?void 0:t.openChannel(e));return null!=n?n:null}get onVSCodeServerStarted(){return this.connection.onVSCodeServerStarted}get remotePort(){return i.assertDefined(this.connectionReference,"No connection found."),this.connectionReference.remotePort}async startForwardingPort(e){return await this.connection.startForwardingPort(e)}async startForwardingPortWithVisibility(e,t){return await this.connection.startForwardingPortWithVisibility(e,t)}async updateForwardedPortVisibility(e,t){return await this.connection.updateForwardedPortVisibility(e,t),this}async updateForwardedPortProtocol(e,t){return await this.connection.updateForwardedPortProtocol(e,t),this}async updateForwardedPortPrivacy(e,t){return await this.connection.updateForwardedPortPrivacy(e,t),this}async stopForwardingPort(e){var t;return await(null===(t=this.connection)||void 0===t?void 0:t.stopForwardingPort(e)),this}async sendHandshakeRequest(e){return await this.connection.sendHandshakeRequest(e)}async createConnectionMock(){try{this.trace.info("creating connection"),this.connectionSignal=new i.Signal,this.addToDisposables(this.connectionSignal);const[e,t]=this.connectionHubs;i.assertDefined(e,"No VSCode ConnectionHub found."),i.assertDefined(t,"No Remote VSCode ConnectionHub found."),this.onConnectionChangedHandler("connecting");const n=await i.raceAsync([e.connectOnce(this.options,{performance:this.performance.createGroup("main-thread")}),t.connectOnce(this.options,{performance:this.performance.createGroup("service-worker")})]);return i.assertDefined(this.connectionSignal,"No connection signal found."),i.assertDefined(n.liveshareConnection,"Connected but no LiveShare connection found."),this.connectionReference=n,this.addToDisposables(n),this.addToDisposables(n.onConnectionChanged(this.onConnectionChangedEventEmitter.fire.bind(n))),this.connectionSignal.resolve(this),i.defer(()=>{this.onConnectionChangedHandler("connected")}),this}catch(e){throw this.handleConnectionError(e),e}}}t.VSCodeJointConnection=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HUB_CONNECTION_DEFAULT_OPTIONS={retries:3,retryDelay:0,timeout:1/0,shouldReconnect:!0},t.HUB_NO_RETRY_OPTIONS=Object.assign(Object.assign({},t.HUB_CONNECTION_DEFAULT_OPTIONS),{retries:0,shouldReconnect:!1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6);class s extends i.DisposableClass{constructor(e,t,n,i,s){super(e),this.connectionArg=t,this.connectionOptionsArg=n,this.hubConnectionOptionsArg=i,this.eventHandlerArg=s,this.addToDisposables(s,t)}get connection(){return this.connectionArg}get connectionOptions(){return this.connectionOptionsArg}get hubConnectionOptions(){return this.hubConnectionOptionsArg}get eventHandler(){return this.eventHandlerArg}async disconnect(e){return await this.connection.disconnect(e),super.dispose(e)}}t.ConnectionHubRecord=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(269);t.isVSCodeServerSession=e=>e.startsWith(i.VSCODE_SERVER_PORT_NAME)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(63);t.ConnectionError=i.ConnectionError;var s=n(266);t.ConnectionTimeoutError=s.ConnectionTimeoutError;var r=n(454);t.ConnectionStateError=r.ConnectionStateError;var o=n(265);t.ConnectionCancellationError=o.ConnectionCancellationError},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1085);t.VSCodeConnectionMock=i.VSCodeConnectionMock;var s=n(1086);t.ConnectionHubMock=s.ConnectionHubMock;var r=n(270);t.ConnectionMock=r.ConnectionMock,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(1087))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8),s=n(270);class r extends s.ConnectionMock{constructor(){super(...arguments),this.onVSCodeServerStarted=(new i.Emitter).event}startForwardingPortWithVisibility(e,t){return Promise.resolve({})}get workspaceClient(){return{}}get liveshareConnection(){return{}}get vscodeServerHostClient(){return{}}sendHandshakeRequest(e){return{}}openChannel(e){return Promise.resolve(null)}startForwardingPort(e){return Promise.resolve({})}stopForwardingPort(e){return Promise.resolve(this)}updateForwardedPortVisibility(e,t){return Promise.resolve(this)}updateForwardedPortProtocol(e,t){return Promise.resolve(this)}updateForwardedPortPrivacy(e,t){return Promise.resolve(this)}get serverSharingService(){return{}}get sharedServer(){return{}}get remotePort(){return 0}getSharedServers(){throw new Error("Method not implemented.")}getRpcService(e){throw new Error("Method not implemented.")}}t.VSCodeConnectionMock=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6),s=n(463);class r extends s.ConnectionHub{constructor(){super(...arguments),this.mockCreateConnectionFail=(e,t=1)=>{this.createConnection=async()=>{throw await i.wait(t),e}}}getConnectionIdMock(e){return this.getConnectionId(e)}getConnectionMock(e){const t=this.getConnectionId(e),n=this.connections[t];return n?n.connection:void 0}getConnectionRecordMock(e){const t=this.getConnectionId(e);return this.connections[t]}}t.ConnectionHubMock=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1088);t.getConnectionHubMockOptions=i.getConnectionHubMockOptions;var s=n(466);t.getConnectionMockOptions=s.getConnectionMockOptions;var r=n(1097);t.getLiveShareConnectionMockOptions=r.getLiveShareConnectionMockOptions},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(271),s=n(19),r=n(270);t.testTrace=new s.TraceSource("test-trace"),t.performance=i.initializePerformanceInstance("test:start"),t.getConnectionHubMockOptions=(e={})=>{const{trace:n=t.testTrace,childHubs:i}=e;return[n,t.performance,r.ConnectionMock,i]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WaterfallNode=class{constructor(e,t,n,i,s,r){this.id=e,this.name=t,this.path=n,this.rawMeasure=i,this.perfGoups=r,this.groups=[],this.getTotalDuration=()=>{let e=0;for(let t of this.groups){const n=t.measure.startTime+t.measure.duration;n>e&&(e=n)}return e},this.measure={name:i.name,duration:i.duration,startTime:i.startTime,entryType:i.entryType};for(let e of s)this.groups.push(Object.assign(Object.assign({},e),{groups:[]}));for(let e of this.perfGoups)this.groups.push(e.getWaterfall());const o=this.getTotalDuration()-this.measure.startTime;this.measure=Object.assign(Object.assign({},this.measure),{duration:o})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8),s=n(465);class r{constructor(e){this.pathString=e,this.blocks={},this.onAnyEventEmitter=new i.Emitter,this.onAnyEvent=this.onAnyEventEmitter.event,this.markBlock=e=>{const{id:t,name:n,type:i}=e,r=`${this.pathString}.block: ${null!=t?t:n}`,o=`${r}-${i}`;if(this.blocks[r]&&this.blocks[r][i])throw new Error(`The event "${o}" already marked in this group.`);s.performance.mark(o);const[a]=s.performance.getEntriesByName(o),c=this.blocks[r]||{path:r,id:"start"===i?t:void 0,name:"start"===i?n:void 0};if(c[e.type]=Object.assign(Object.assign({},e),{path:o}),this.blocks[r]=c,t&&void 0!==a){const e={id:t,name:n,type:i,measure:a};if("end"===i){const[n]=s.performance.getEntriesByName(`${r}-start`);if(!n)throw new Error(`No start block found for event ${t}`);e.measure=Object.assign(Object.assign({},a),{duration:a.startTime-n.startTime})}this.onAnyEventEmitter.fire(e),this.invokeBlock(e)}return this},this.markBlockStart=e=>this.markBlock(Object.assign({type:"start"},e)),this.markBlockEnd=e=>this.markBlock(Object.assign({type:"end"},e)),this.getBlock=e=>{const t=`${this.pathString}.block: ${e}`,n=this.blocks[t];if(n)return n},this.measure=async(e,t)=>{this.markBlock(Object.assign(Object.assign({},e),{type:"start"}));try{return await t()}finally{this.markBlock(Object.assign(Object.assign({},e),{type:"end"}))}},this.measureSync=(e,t)=>{this.markBlock(Object.assign(Object.assign({},e),{type:"start"}));try{return t()}finally{this.markBlock(Object.assign(Object.assign({},e),{type:"end"}))}},this.measures=()=>{const e=[];for(let[t,n]of Object.entries(this.blocks)){const{start:i,end:r}=n;if(!i||!r)continue;s.performance.measure(n.path,`${i.path}`,`${r.path}`);const[o]=s.performance.getEntriesByName(n.path);if(!o)throw new Error(`No measure found in Performance API for "${t}".`);e.push({id:n.id,name:n.name,measure:o})}return e},this.invokeBlock=e=>{const t=this.getBlockCallbackId(e),n=r.onEventEmitters[t];n&&n.fire(e)},this.getBlockCallbackId=e=>{const{id:t,type:n}=e;return`${t}-${n}`},this.onEvent=(e,t)=>{const n=this.getBlockCallbackId(e);let s=r.onEventEmitters[n];return s||(s=new i.Emitter,r.onEventEmitters[n]=s),s.event(t),this}}}t.PerformanceBlocks=r,r.onEventEmitters={}},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(1092)),r=n(1094),o=(e,t,n,i,r)=>{const o=`[${n}ms - ${n+i}ms]`;console[e]([`${t}:`,s.default.cyan(`${i}ms`),s.default.magenta(`+${n-r}ms`),s.default.gray(o)].join(" "))},a=(e,t)=>{const{name:n,measure:i}=e,{startTime:s,duration:r}=i;((e,t,n,i)=>{o("log",e,t,n,i)})(n,Math.round(s),Math.round(r),t)};t.logPerformanceWaterfall=(e,n)=>{const{measure:i,name:s}=e,{startTime:c,duration:l}=i,u=Math.round(c);n=null!=n?n:Math.round(c),((e,t,n,i)=>{o("groupCollapsed",e,t,n,i)})(s,u,Math.round(l),n);for(let i of r.sortByStartTime([...e.groups]))i.groups.length?t.logPerformanceWaterfall(i,n):a(i,n);console.groupEnd()}},function(e,t,n){"use strict";
/*!
 * ansi-colors <https://github.com/doowb/ansi-colors>
 *
 * Copyright (c) 2015-2017, Brian Woodward.
 * Released under the MIT License.
 */var i=n(1093);t.bgblack=function(e){return i(40,49,e)},t.bgblue=function(e){return i(44,49,e)},t.bgcyan=function(e){return i(46,49,e)},t.bggreen=function(e){return i(42,49,e)},t.bgmagenta=function(e){return i(45,49,e)},t.bgred=function(e){return i(41,49,e)},t.bgwhite=function(e){return i(47,49,e)},t.bgyellow=function(e){return i(43,49,e)},t.black=function(e){return i(30,39,e)},t.blue=function(e){return i(34,39,e)},t.bold=function(e){return i(1,22,e)},t.cyan=function(e){return i(36,39,e)},t.dim=function(e){return i(2,22,e)},t.gray=function(e){return i(90,39,e)},t.green=function(e){return i(32,39,e)},t.grey=function(e){return i(90,39,e)},t.hidden=function(e){return i(8,28,e)},t.inverse=function(e){return i(7,27,e)},t.italic=function(e){return i(3,23,e)},t.magenta=function(e){return i(35,39,e)},t.red=function(e){return i(31,39,e)},t.reset=function(e){return i(0,0,e)},t.strikethrough=function(e){return i(9,29,e)},t.underline=function(e){return i(4,24,e)},t.white=function(e){return i(37,39,e)},t.yellow=function(e){return i(33,39,e)}},function(e,t,n){"use strict";e.exports=function(e,t,n){return"["+e+"m"+n+"["+t+"m"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sortByStartTime=e=>[...e].sort((e,t)=>e.measure.startTime-t.measure.startTime)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1096);t.PerformanceMock=i.PerformanceMock},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(464);class s extends i.Performance{get groupsMock(){return this.groups}}t.PerformanceMock=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(19),s=n(6),r=n(466);t.testTrace=new i.TraceSource(s.randomString()),t.getRandomLiveShareMockOptions=()=>({liveShareEndpoint:"mock-liveshare-endpoint",workspaceId:"mock-id",connectionInfo:{id:"mock-connection-id",relayLink:"sb://test-namespace.servicebus.windows.net/anyEndpointId",relaySas:"mock-relay",hostPublicKeys:["mock-host-public-key"],sessionToken:"mock-session-token"},token:"mock-token",id:"mock-id",someProp:"mock-prop",numericProp:12345}),t.getLiveShareConnectionMockOptions=(e={})=>{const{trace:n=t.testTrace}=e;return[n,new r.PerformanceMock("test-performance","test-start","test-path-string"),Object.assign({},t.getRandomLiveShareMockOptions())]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),s=n(83),r=n(6),o=n(179),a=n(243),c=n(15),l=n(13),u=n(467),d=n(1099),h=n(468),f=["usw2","use","euw","asse"];t.openWorkspaceConnection=async function(e,t,n){let o=l.Settings.get(c.SettingKeys.connectionMode);const u=("number"==typeof e.connectionMode?s.ConnectionMode[e.connectionMode]:"string"==typeof e.connectionMode?r.toCamelCase(e.connectionMode):void 0)||s.ConnectionMode.Auto;if(u!==o)if(o===s.ConnectionMode.Auto)o=u;else{if(o===s.ConnectionMode.Direct&&u===s.ConnectionMode.Relay)throw new a.ByDesignError('The host does not allow direct connections. Switch to "Auto" or "Relay" mode and retry.',i.vsls.ErrorCodes.DirectConnectionNotEnabled);if(o===s.ConnectionMode.Relay&&u===s.ConnectionMode.Direct)throw new a.ByDesignError('Unable to connect since the host does not allow relayed connections. Switch to "Auto" or "Direct" mode and retry.',i.vsls.ErrorCodes.RelayConnectionNotEnabled)}if(o===s.ConnectionMode.Local||o===s.ConnectionMode.SignalR&&!n)throw new Error(`Unsupported workspace connection mode '${o}'.`);const h=e.connectLinks&&e.connectLinks.length;if(o===s.ConnectionMode.Auto&&!e.relayLink&&!h&&!n)throw new Error("Workspace does not have relay or direct connection info.");if(o===s.ConnectionMode.Direct&&!h)throw new Error("Workspace does not have direct connection info.");const f=[];let g;o!==s.ConnectionMode.Auto&&o!==s.ConnectionMode.Relay||!e.relayLink||f.push(m(e,t)),o!==s.ConnectionMode.Auto&&o!==s.ConnectionMode.Relay&&o!==s.ConnectionMode.SignalR||!n||f.push(p(n,e,t)),o!==s.ConnectionMode.Auto&&o!==s.ConnectionMode.Direct||!h||f.push(...e.connectLinks.map(e=>d.openDirectConnection(e,t))),r.assert(f.length>0,"Cannot connect to workspace. Workspace does not have sufficient connection info.");try{if(g=await r.promiseAny(f),!g)throw new Error("Cannot connect to workspace. Workspace does not have sufficient connection info.");return t.verbose(`Successfully connected using connection mode: ${g[1]}`),g[0]}finally{f.forEach(e=>e.then(e=>{e&&e!==g&&e[0].dispose()},()=>{}))}};const p=async(e,t,n)=>{const i=l.Settings.get("hubCrossRegionEnabled")?void 0:t.relayLink?function(e){for(let t of f)if(-1!==e.indexOf(t))return t}(t.relayLink):void 0,r=await e.getOrCreate(i);await r.setEnabled(!0);const o=r.getOrCreateProxy(u.HubProxyType.RelayService);return l.Settings.get("traceHubData")&&(o.traceHubData=!0),[await h.HubStreamUtils.createClientStream(o,t.id,void 0,void 0,n),s.ConnectionMode.SignalR]},m=async(e,t)=>[await o.SshHelpers.openConnection(e,t),s.ConnectionMode.Relay]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openDirectConnection=async function(e,t){throw new Error("Direct connection not supported on the browser.")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(471),s=n(180),r=n(272);class o extends i.HubProxyBase{constructor(e,t,n){super(e,t,n?"presenceServiceHub":void 0),this.updatePropertiesCallbacks=new s.CallbackContainer,this.receiveMessageCallbacks=new s.CallbackContainer,this.connectionChangedCallbacks=new s.CallbackContainer,e.on(this.toHubMethodName("updateValues"),(e,t,n)=>this.updateValues(i.keysToCamel(e),t,n)),e.on(this.toHubMethodName("receiveMessage"),(e,t,n,s)=>this.receiveMessage(i.keysToCamel(e),i.keysToCamel(t),n,s)),e.on(this.toHubMethodName("connectionChanged"),(e,t)=>this.connectionChanged(i.keysToCamel(e),t))}onUpdateProperties(e){return this.updatePropertiesCallbacks.add(e)}onMessageReceived(e){return this.receiveMessageCallbacks.add(e)}onConnectionChanged(e){return this.connectionChangedCallbacks.add(e)}async registerSelfContact(e,t){return await this.invoke("RegisterSelfContactAsync",e,t)}publishProperties(e){return this.send("PublishPropertiesAsync",e)}sendMessage(e,t,n){return this.send("SendMessageAsync",e,t,n)}async addSubcriptions(e,t){return this.invoke("AddSubcriptionsAsync",e,t)}requestSubcriptions(e,t,n){return this.invoke("RequestSubcriptionsAsync",e,t,n)}removeSubscription(e){return this.send("RemoveSubscription",e)}unregisterSelfContact(){return this.send("UnregisterSelfContactAsync")}updateValues(e,t,n){this.logger&&this.logger.log(r.LogLevel.Debug,`ContactServiceProxy.updateValues contact:${JSON.stringify(e)} properties:${JSON.stringify(t)}`),this.updatePropertiesCallbacks.items.forEach(i=>i(e,t,n))}receiveMessage(e,t,n,i){this.logger&&this.logger.log(r.LogLevel.Debug,`ContactServiceProxy.receiveMessage targetContact:${JSON.stringify(e)} fromContact:${JSON.stringify(t)} messageType:${n} body:${JSON.stringify(i)}`),this.receiveMessageCallbacks.items.forEach(s=>s(e,t,n,i))}connectionChanged(e,t){this.logger&&this.logger.log(r.LogLevel.Debug,`ContactServiceProxy.connectionChanged contact:${JSON.stringify(e)} changeType:${t}`),this.connectionChangedCallbacks.items.forEach(n=>n(e,t))}}t.ContactServiceProxy=o},function(e,t,n){"use strict";(function(e,i){Object.defineProperty(t,"__esModule",{value:!0});const s=n(472),r=n(471),o=n(470),a=n(180),c=n(272);var l;!function(e){e.ReceiveData="receiveData",e.ParticipantChanged="participantChanged",e.HubDeleted="hubDeleted",e.CreateHub="CreateHubAsync",e.DeleteHub="DeleteHubAsync",e.JoinHub="JoinHubAsync",e.SendDataHubEx="SendDataHubExAsync",e.LeaveHub="LeaveHubAsync",e.Update="UpdateAsync"}(l||(l={}));class u extends r.HubProxyBase{constructor(t,n,s){super(t,n,s?"relayServiceHub":void 0),this.relayHubs=new Map,this.traceHubData=!1;const r=void 0!==e&&void 0!==e.release&&"node"===e.release.name;t.onConnectionStateChanged(async()=>{t.isConnected||(await Promise.all(Array.from(this.relayHubs.values()).map(e=>e._OnDisconnected())),this.relayHubs.clear())}),t.on(this.toHubMethodName(l.ReceiveData),async(e,t,n,s,o,a)=>{let l;l="string"==typeof o?r?i.from(o,"base64"):h.decode(o):o,this.logger&&this.traceHubData&&this.logger.log(c.LogLevel.Debug,`receiveData -> hubId:${e} fromParticipantId:${t} type:${s} length:${l?l.length:0} crc:${l?p(l):"n/a"} properties:${JSON.stringify(a)}`);const u=this.relayHubs.get(e);u&&await u._OnReceiveData(t,n,s,l,a)}),t.on(this.toHubMethodName(l.ParticipantChanged),async(e,t,n,i)=>{this.logger&&this.logger.log(c.LogLevel.Debug,`participantChanged -> hubId:${e} participantId:${t} properties:${JSON.stringify(n)} changeType:${i}`);const s=this.relayHubs.get(e);s&&await s._OnParticipantChanged(t,n,i)}),t.on(this.toHubMethodName(l.HubDeleted),async e=>{this.logger&&this.logger.log(c.LogLevel.Debug,`hubDeleted -> hubId:${e}`);const t=this.relayHubs.get(e);t&&(this.relayHubs.delete(e),await t._OnDeleted())})}createHub(e){return this.invoke(l.CreateHub,e)}async joinHub(e,t,n){let i=this.relayHubs.get(e);return i?i.isDisconnected&&await i.rejoin(n):i=await this._joinHubInternal(t=>new d(this,e,t),e,t,n),i}async deleteHub(e){await this.invoke(l.DeleteHub,e)}async _joinHubInternal(e,t,n,i){const s=e(await this.invokeKeysToCamel(l.JoinHub,t,n,r.keysToPascal(i)));return this.relayHubs.set(t,s),s}}t.RelayServiceProxy=u;class d{constructor(e,t,n){this.relayServiceProxy=e,this.id=t,this.receiveDataCallbacks=new a.CallbackContainer,this.participantChangedCallbacks=new a.CallbackContainer,this.hubDeletedCallbacks=new a.CallbackContainer,this.hubDisconnectedCallbacks=new a.CallbackContainer,this.joinHubInfo=null,this.selfParticipantInstance=null,this.hubParticipants=new Map,this.isDisconnected=!1,this.setJoinHubInfo(n)}setJoinHubInfo(e){this.hubParticipants.clear(),e.participants.forEach(t=>{const n={id:t.id,properties:t.properties};e.participantId===t.id&&(this.selfParticipantInstance=n),this.hubParticipants.set(t.id,n)}),this.joinHubInfo=e}get serviceId(){return this.joinHubInfo.serviceId}get stamp(){return this.joinHubInfo.stamp}get selfParticipant(){return this.selfParticipantInstance}get participants(){return Array.from(this.hubParticipants.values())}onReceiveData(e){return this.receiveDataCallbacks.add(e)}onParticipantChanged(e){return this.participantChangedCallbacks.add(e)}onDeleted(e){return this.hubDeletedCallbacks.add(e)}onDisconnected(e){return this.hubDisconnectedCallbacks.add(e)}async rejoin(e){if(!this.isDisconnected)throw new Error(`Relay hub:${this.id} is connected`);await this.relayServiceProxy._joinHubInternal(e=>(this.setJoinHubInfo(e),this),this.id,this.selfParticipant.properties,e||{})}async sendData(e,t,n,i,s,a){const u=this.relayServiceProxy.logger;u&&this.relayServiceProxy.traceHubData&&u.log(c.LogLevel.Debug,`sendData -> hubId:${this.id} option:${e} target:${JSON.stringify(t)} type:${n} length:${i?i.length:0} crc:${i?p(i):"n/a"} properties:${JSON.stringify(s)}`);const d=i?Array.from(i):null,h={hubId:this.id,sendOption:e,targetParticipantIds:t||null,type:n},f=r.keysToPascal(h);return f.MessageProperties=s,a===o.HubMethodOption.Invoke?await this.relayServiceProxy.invoke(l.SendDataHubEx,f,d):(await this.relayServiceProxy.send(l.SendDataHubEx,f,d),0)}async update(e){await this.relayServiceProxy.invoke(l.Update,this.id,e)}async dispose(){const e=this.relayServiceProxy.logger;e&&e.log(c.LogLevel.Debug,`leaving -> hubId:${this.id}`),await this.relayServiceProxy.send(l.LeaveHub,this.id),this._OnDisconnected()}async _OnDeleted(){for(const e of this.hubDeletedCallbacks.items)await e()}async _OnDisconnected(){this.isDisconnected=!0;for(const e of this.hubDisconnectedCallbacks.items)await e()}async _OnReceiveData(e,t,n,i,s){const r=this.hubParticipants.get(e);if(r){const e={fromParticipant:r,uniqueId:t,type:n,data:i,properties:s};for(const t of this.receiveDataCallbacks.items)await t(e)}}async _OnParticipantChanged(e,t,n){let i;if(n===s.ParticipantChangeType.Added?(i={id:e,properties:t},this.hubParticipants.set(e,i)):n===s.ParticipantChangeType.Removed?(i=this.hubParticipants.get(e),this.hubParticipants.delete(e)):n===s.ParticipantChangeType.Updated&&(i=this.hubParticipants.get(e),i&&(i.properties=t)),i){const e={participant:i,changeType:n};for(const t of this.participantChangedCallbacks.items)await t(e)}}}const h={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeArrayBuffer:function(e){var t=parseInt(e.length/4*3,10),n=new ArrayBuffer(t);return this.decode(e,n),n},removePaddingChars:function(e){return 64==this._keyStr.indexOf(e.charAt(e.length-1))?e.substring(0,e.length-1):e},decode:function(e,t){e=this.removePaddingChars(e);var n,i,s,r,o,a,c,l=(e=this.removePaddingChars(e)).length/4*3,u=0,d=0;for(n=t?new Uint8Array(t):new Uint8Array(l),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),u=0;u<l;u+=3)i=this._keyStr.indexOf(e.charAt(d++))<<2|(o=this._keyStr.indexOf(e.charAt(d++)))>>4,s=(15&o)<<4|(a=this._keyStr.indexOf(e.charAt(d++)))>>2,r=(3&a)<<6|(c=this._keyStr.indexOf(e.charAt(d++))),n[u]=i,64!=a&&(n[u+1]=s),64!=c&&(n[u+2]=r);return n}};let f;function p(e){f||(f=function(){let e;const t=[];for(let n=0;n<256;n++){e=n;for(let t=0;t<8;t++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}());let t=-1;for(let n=0;n<e.length;n++)t=t>>>8^f[255&(t^e[n])];return(((-1^t)>>>0)+4294967296).toString(16).substr(-8).toUpperCase()}}).call(this,n(11),n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(473),s=n(474);class r extends i.RelayDataHubProxy{constructor(e,t,n){super(e,t),this.receiveDataBuffer=new Map,this.currentSequence=n||0,this.totalEvents=0}static createForTypeAndParticipant(e,t,n,i){return new r(e,e=>e.type===t&&e.fromParticipant.id===n,i)}async processReceivedData(e){const t=s.RelayHubMessageProperties.getMessageSequence(e.properties);if(t&&-1!==t)if(-1===this.currentSequence||this.currentSequence+1===t)for(this.currentSequence=t,await this.fireReceivedData(e);;){const e=this.tryRemove(this.currentSequence+1);if(!e)break;await this.fireReceivedData(e),++this.currentSequence}else t>this.currentSequence&&t-this.currentSequence>10&&console.debug(`###-----\x3e sequence/current:${t}/${this.currentSequence}`),this.receiveDataBuffer.set(t,e),++this.totalEvents;else await this.fireReceivedData(e)}tryRemove(e){const t=this.receiveDataBuffer.get(e);if(t)return this.receiveDataBuffer.delete(e),t}}t.SequenceRelayDataHubProxy=r},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(475),s=n(64);class r extends i.BaseStream{constructor(t,n,i){super(),this.relayHubProxy=t,this.streamId=n,this.targetParticipant=i,this.nextSequence=0,this.disposables=[];const r=s.SequenceRelayDataHubProxy.createForTypeAndParticipant(t,this.streamId,i);this.disposables.push(r),this.disposables.push(r.onReceiveData(t=>(this.onData(e.from(t.data)),Promise.resolve()))),this.disposables.push(t.onParticipantChanged(e=>(e.changeType===s.ParticipantChangeType.Removed&&e.participant.id===this.targetParticipant&&this.close(new Error(`participant id:${e.participant.id} removed`)),Promise.resolve())));const o=t.relayServiceProxy.hubProxy;this.disposables.push(o.onConnectionStateChanged(()=>(o.isConnected||this.close(new Error("hub proxy was disconnected")),Promise.resolve())))}async write(e,t){if(!e)throw new TypeError("Data is required.");if(this.disposed)throw new Error("HubStream diposed");await this.relayHubProxy.sendData(s.SendOption.ExcludeSelf,[this.targetParticipant],this.streamId,e,s.RelayHubMessageProperties.createMessageSequence(++this.nextSequence))}close(e,t){return this.disposables.forEach(e=>e.dispose()),this.disposables=[],this.onError(e||new Error("Stream closed.")),this.closedEmitter.fire({error:e}),Promise.resolve()}}t.HubStream=r}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebECDiffieHellman=t.WebDiffieHellman=void 0;const i=n(3),s=n(208),r=n(274),o=n(277),a=n(53),c=n(278);class l extends r.KeyExchangeAlgorithm{constructor(e,t,n){super(e,t,n,o.WebHmac.getHashDigestLength(n))}createKeyExchange(){return new u(this.keySizeInBits,o.WebHmac.getWebHashAlgorithmName(this.hashAlgorithmName),this.hashDigestLength)}}t.WebDiffieHellman=l;class u{constructor(e,t,n){switch(this.hashAlgorithmName=t,this.digestLength=n,e){case 1024:this.dh=(0,s.getDiffieHellman)("modp2");break;case 2048:this.dh=(0,s.getDiffieHellman)("modp14");break;case 4096:this.dh=(0,s.getDiffieHellman)("modp16");break;default:throw new Error("Invalid DH bit length.")}}startKeyExchange(){const e=this.dh.generateKeys(),t=a.BigInt.fromBytes(e,{unsigned:!0}).toBytes();return Promise.resolve(t)}decryptKeyExchange(e){const t=this.dh.computeSecret(e),n=a.BigInt.fromBytes(t,{unsigned:!0}).toBytes();return Promise.resolve(n)}async sign(e){const t=await crypto.subtle.digest(this.hashAlgorithmName,e);return i.Buffer.from(t)}dispose(){}}class d extends r.KeyExchangeAlgorithm{constructor(e,t,n){super(e,t,n,o.WebHmac.getHashDigestLength(n))}createKeyExchange(){return new h(this.keySizeInBits,o.WebHmac.getWebHashAlgorithmName(this.hashAlgorithmName),this.hashDigestLength)}}t.WebECDiffieHellman=d;class h{constructor(e,t,n){this.bitLength=e,this.hashAlgorithmName=t,this.digestLength=n,this.algorithm={name:"ECDH",namedCurve:"P-"+e}}async startKeyExchange(){this.keyPair||(this.keyPair=await crypto.subtle.generateKey(this.algorithm,!0,["deriveBits"]));const e=await crypto.subtle.exportKey("jwk",this.keyPair.publicKey),t=c.JsonWebKeyFormatter.parseEC(e),n=Math.ceil(this.bitLength/8),s=i.Buffer.alloc(1+2*n);return s[0]=4,t.x.toBytes({unsigned:!0,length:n}).copy(s,1),t.y.toBytes({unsigned:!0,length:n}).copy(s,1+n),i.Buffer.from(s)}async decryptKeyExchange(e){if(!this.keyPair)throw new Error("Key exchange not started.");const t=e,n=c.JsonWebKeyFormatter.formatEC({curve:{name:this.algorithm.namedCurve},x:a.BigInt.fromBytes(t.slice(1,1+(t.length-1)/2),{unsigned:!0}),y:a.BigInt.fromBytes(t.slice(1+(t.length-1)/2),{unsigned:!0})}),s=await crypto.subtle.importKey("jwk",n,this.algorithm,!1,[]),r=i.Buffer.from(await crypto.subtle.deriveBits(Object.assign(Object.assign({},this.algorithm),{public:s}),this.keyPair.privateKey,8*Math.ceil(this.bitLength/8)));return a.BigInt.fromBytes(r,{unsigned:!0}).toBytes()}async sign(e){const t=await crypto.subtle.digest(this.hashAlgorithmName,e);return i.Buffer.from(t)}dispose(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebRsa=void 0;const i=n(3),s=n(141),r=n(277),o=n(37),a=n(278);class c{constructor(e){this.hashAlgorithm=e,this.comment=null}get hasPublicKey(){return!!this.publicKey}get hasPrivateKey(){return!!this.privateKey}get keyAlgorithmName(){return l.keyAlgorithmName}async generate(e){e=null!=e?e:c.defaultKeySize;try{const t={name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:this.hashAlgorithm}},n=await crypto.subtle.generateKey(t,!0,["sign","verify"]);this.publicKey=n.publicKey,this.privateKey=n.privateKey}catch(e){throw new Error("Failed to generate RSA key pair: "+e)}}async setPublicKeyBytes(e){if(!e)throw new TypeError("Buffer is required.");const t=new o.SshDataReader(e),n=t.readString("ascii");if(n!==this.keyAlgorithmName&&n!==l.rsaWithSha256&&n!==l.rsaWithSha512)throw new Error(`Invalid RSA key algorithm: ${n}`);const i=t.readBigInt(),s=t.readBigInt(),r=a.JsonWebKeyFormatter.formatRsa({modulus:s,exponent:i},!1);r.alg="RS"+this.hashAlgorithm.replace("SHA-",""),r.key_ops=["verify"];try{const e={name:"RSASSA-PKCS1-v1_5",hash:{name:this.hashAlgorithm}};this.publicKey=await crypto.subtle.importKey("jwk",r,e,!0,["verify"])}catch(e){throw new Error("Failed to import RSA public key: "+e)}}async getPublicKeyBytes(e){if(!this.publicKey)return null;let t;e||(e=this.keyAlgorithmName);try{t=await crypto.subtle.exportKey("jwk",this.publicKey)}catch(e){throw new Error("Failed to export RSA public key: "+e)}const{modulus:n,exponent:s}=a.JsonWebKeyFormatter.parseRsa(t,!1),r=i.Buffer.alloc(512),c=new o.SshDataWriter(r);return c.writeString(e,"ascii"),c.writeBigInt(s),c.writeBigInt(n),c.toBuffer()}async importParameters(e){const t=e.d?a.JsonWebKeyFormatter.formatRsa(e,!0):null,n=a.JsonWebKeyFormatter.formatRsa(e,!1),i={name:"RSASSA-PKCS1-v1_5",hash:{name:this.hashAlgorithm}};try{this.publicKey=await crypto.subtle.importKey("jwk",n,i,!0,["verify"]),this.privateKey=t?await crypto.subtle.importKey("jwk",t,i,!0,["sign"]):void 0}catch(e){if(!(e instanceof Error))throw e;throw new Error("Failed to import RSA key pair: "+e.message)}}async exportParameters(){var e;if(!this.publicKey)throw new Error("Public key not set.");let t;try{t=await crypto.subtle.exportKey("jwk",null!==(e=this.privateKey)&&void 0!==e?e:this.publicKey)}catch(e){if(!(e instanceof Error))throw e;throw new Error("Failed to export RSA public key: "+e.message)}return a.JsonWebKeyFormatter.parseRsa(t,!!this.privateKey)}dispose(){}}c.defaultKeySize=2048;class l extends s.PublicKeyAlgorithm{constructor(e,t){super(e,l.keyAlgorithmName,t)}createKeyPair(){const e=l.convertHashAlgorithmName(this.hashAlgorithmName);return new c(e)}async generateKeyPair(e){const t=l.convertHashAlgorithmName(this.hashAlgorithmName),n=new c(t);return await n.generate(e),n}createSigner(e){if(!(e instanceof c))throw new TypeError("RSA key pair object expected.");const t=l.convertHashAlgorithmName(this.hashAlgorithmName);return new u(e,t,r.WebHmac.getHashDigestLength(this.hashAlgorithmName))}createVerifier(e){if(!(e instanceof c))throw new TypeError("RSA key pair object expected.");const t=l.convertHashAlgorithmName(this.hashAlgorithmName);return new u(e,t,r.WebHmac.getHashDigestLength(this.hashAlgorithmName))}static convertHashAlgorithmName(e){return e.replace("SHA2-","SHA-")}}t.WebRsa=l,l.keyAlgorithmName="ssh-rsa",l.rsaWithSha256="rsa-sha2-256",l.rsaWithSha512="rsa-sha2-512",l.KeyPair=c;class u{constructor(e,t,n){this.keyPair=e,this.hashAlgorithm=t,this.digestLength=n}async sign(e){if(!this.keyPair.privateKey)throw new Error("Private key not set.");return await this.convertKeyHashAlgorithm(),i.Buffer.from(await crypto.subtle.sign("RSASSA-PKCS1-v1_5",this.keyPair.privateKey,e))}async verify(e,t){if(!this.keyPair.publicKey)throw new Error("Public key not set.");return await this.convertKeyHashAlgorithm(),await crypto.subtle.verify("RSASSA-PKCS1-v1_5",this.keyPair.publicKey,t,e)}async convertKeyHashAlgorithm(){if(this.keyPair.hashAlgorithm!==this.hashAlgorithm){const e=await this.keyPair.exportParameters();this.keyPair=new c(this.hashAlgorithm),await this.keyPair.importParameters(e)}}dispose(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebECDsa=void 0;const i=n(3),s=n(141),r=n(37),o=n(181),a=n(53),c=n(278);class l{constructor(e){this.comment=null,e&&(this.algorithmName=e)}get hasPublicKey(){return!!this.publicKey}get hasPrivateKey(){return!!this.privateKey}get keyAlgorithmName(){return this.algorithmName}get algorithmName(){return this.algorithm}set algorithmName(e){const t=e.split("-")[2];if(this.curve=o.curves.find(e=>e.name===t),!this.curve)throw new Error("Invalid or unsupported ECDSA algorithm: "+e);this.algorithm=e}async generate(){try{const e={name:"ECDSA",namedCurve:this.curve.shortName},t=await crypto.subtle.generateKey(e,!0,["sign","verify"]);this.publicKey=t.publicKey,this.privateKey=t.privateKey}catch(e){throw new Error("Failed to generate RSA key pair: "+e)}}async setPublicKeyBytes(e,t){if(!e)throw new TypeError("Buffer is required.");const n=new r.SshDataReader(e),i=n.readString("ascii");if(this.algorithmName=t||i,n.readString("ascii")!==this.curve.name)throw new Error("EC curve name does not match.");const s=n.readBinary(),o=Math.ceil(this.curve.keySize/8),l=a.BigInt.fromBytes(s.slice(1,1+o),{unsigned:!0}),u=a.BigInt.fromBytes(s.slice(1+o,s.length),{unsigned:!0}),d=c.JsonWebKeyFormatter.formatEC({curve:{name:this.curve.shortName,oid:this.curve.oid},x:l,y:u});try{const e={name:"ECDSA",namedCurve:this.curve.shortName};this.publicKey=await crypto.subtle.importKey("jwk",d,e,!0,["verify"])}catch(e){throw new Error("Failed to import EC public key: "+e)}}async getPublicKeyBytes(e){if(!this.publicKey)return null;let t;try{t=await crypto.subtle.exportKey("jwk",this.publicKey)}catch(e){throw new Error("Failed to export ECDSA public key: "+e)}const n=i.Buffer.from(t.x,"base64"),s=i.Buffer.from(t.y,"base64"),o=Math.ceil(this.curve.keySize/8);if(n.length!==o||s.length!==o)throw new Error("Unexpected key length.");e=e||this.algorithmName||this.keyAlgorithmName;const a=i.Buffer.alloc(e.length+n.length+s.length+10),c=new r.SshDataWriter(a);return c.writeString(e,"ascii"),c.writeString(this.curve.name,"ascii"),c.writeUInt32(1+n.length+s.length),c.writeByte(4),c.write(n),c.write(s),c.toBuffer()}async importParameters(e){if(!e.curve)throw new TypeError("A curve is required.");let t;if(e.curve.oid){if(t=o.curves.find(t=>t.oid===e.curve.oid),!t)throw new Error(`Unsupported curve OID: ${e.curve.oid}`)}else{if(!e.curve.name)throw new TypeError("A curve OID or name is required.");if(t=o.curves.find(t=>t.name===e.curve.name),!t)throw new Error(`Unsupported curve: ${e.curve.name}`)}this.algorithmName="ecdsa-sha2-"+t.name;const n={name:"ECDSA",namedCurve:this.curve.shortName},i=c.JsonWebKeyFormatter.formatEC(e);i.crv=this.curve.shortName;try{i.d?(this.privateKey=await crypto.subtle.importKey("jwk",i,n,!0,["sign"]),i.d=void 0):this.privateKey=void 0,this.publicKey=await crypto.subtle.importKey("jwk",i,n,!0,["verify"])}catch(e){throw new Error("Failed to import ECDSA key pair: "+e)}}async exportParameters(){var e;const t=null!==(e=this.privateKey)&&void 0!==e?e:this.publicKey;if(!t)throw new Error("Key not present.");let n;try{n=await crypto.subtle.exportKey("jwk",t)}catch(e){throw new Error("Failed to export ECDSA key pair: "+e)}const i=c.JsonWebKeyFormatter.parseEC(n);return i.curve={name:this.curve.name,oid:this.curve.oid},i}dispose(){}}class u extends s.PublicKeyAlgorithm{constructor(e,t){super(e,e,t)}createKeyPair(){return new l(this.name)}async generateKeyPair(){const e=new l(this.name);return await e.generate(),e}createSigner(e){if(!(e instanceof l))throw new TypeError("ECDSA key pair object expected.");const t=u.convertHashAlgorithmName(this.hashAlgorithmName);return new d(e,t)}createVerifier(e){if(!(e instanceof l))throw new TypeError("ECDSA key pair object expected.");const t=u.convertHashAlgorithmName(this.hashAlgorithmName);return new d(e,t)}static convertHashAlgorithmName(e){return e.replace("SHA2-","SHA-")}static getSignatureLength(e){return 2*(5+Math.ceil(e/8))}}t.WebECDsa=u,u.ecdsaSha2Nistp256="ecdsa-sha2-nistp256",u.ecdsaSha2Nistp384="ecdsa-sha2-nistp384",u.ecdsaSha2Nistp521="ecdsa-sha2-nistp521",u.curves=o.curves,u.KeyPair=l;class d{constructor(e,t){this.keyPair=e,this.hashAlgorithm=t}get digestLength(){const e=this.keyPair.curve;return e?u.getSignatureLength(e.keySize):0}async sign(e){if(!this.keyPair.privateKey)throw new Error("Private key not set.");let t=i.Buffer.from(await crypto.subtle.sign({name:"ECDSA",hash:{name:this.hashAlgorithm}},this.keyPair.privateKey,e));const n=Math.ceil(this.keyPair.curve.keySize/8);if(t.length!==2*n)throw new Error(`Unexpected signature length: ${t.length}`);const s=a.BigInt.fromBytes(t.slice(0,n),{unsigned:!0}),o=a.BigInt.fromBytes(t.slice(n,t.length),{unsigned:!0}),c=new r.SshDataWriter(i.Buffer.alloc(this.digestLength));return c.writeBinary(s.toBytes({unsigned:!0,length:n+1})),c.writeBinary(o.toBytes({unsigned:!0,length:n+1})),t=c.toBuffer(),t}async verify(e,t){if(!this.keyPair.publicKey)throw new Error("Public key not set.");const n=new r.SshDataReader(t),s=n.readBigInt(),o=n.readBigInt(),a=Math.ceil(this.keyPair.curve.keySize/8);return t=i.Buffer.alloc(2*a),s.toBytes({unsigned:!0,length:a}).copy(t,0),o.toBytes({unsigned:!0,length:a}).copy(t,a),await crypto.subtle.verify({name:"ECDSA",hash:{name:this.hashAlgorithm}},this.keyPair.publicKey,t,e)}dispose(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebEncryption=void 0;const i=n(46),s=n(3),r=n(275);class o extends r.EncryptionAlgorithm{constructor(e,t,n,i){super(e),this.algorithmName=t,this.cipherMode=n,this.keySizeInBits=i,this.blockSizeInBits=o.getBlockSize(t)}get keyLength(){return this.keySizeInBits/8}get blockLength(){return this.blockSizeInBits/8}async createCipher(e,t,n){const i=new a(e,this.algorithmName,this.cipherMode,this.keySizeInBits,this.blockSizeInBits);return await i.init(t,n),i}static getBlockSize(e){if("AES"===e)return 128;throw new Error(`Unsupported encryption algorithm: ${e}`)}}t.WebEncryption=o;class a{constructor(e,t,n,i,r){if(this.isEncryption=e,this.algorithmName=t,this.cipherMode=n,this.keySizeInBits=i,this.blockSizeInBits=r,this.tag=null,"AES"===this.algorithmName&&"CTR"===this.cipherMode)this.transform=this.aesCtr.bind(this,e);else if("AES"===this.algorithmName&&"CBC"===this.cipherMode)this.transform=this.aesCbc.bind(this,e);else{if("AES"!==this.algorithmName||"GCM"!==this.cipherMode)throw new Error(`Unsupported encryption algorithm: ${this.algorithmName}-${this.cipherMode}`);this.transform=this.aesGcm.bind(this,e),this.associatedData=s.Buffer.alloc(4),this.decryptBuffer=s.Buffer.alloc(4*this.blockLength)}}get blockLength(){return this.blockSizeInBits/8}async init(e,t){try{const t=`${this.algorithmName}-${this.cipherMode}`;this.key=await crypto.subtle.importKey("raw",e,{name:t,length:this.keySizeInBits},!1,this.isEncryption?["encrypt"]:["decrypt"])}catch(e){throw new Error("Failed to initialize AES: "+e)}"GCM"===this.cipherMode?this.iv=s.Buffer.from(t.slice(0,12)):this.iv=s.Buffer.from(t)}async aesCtr(e,t){if(t.length%this.blockLength!=0){const e="Encrypt/decrypt input has invalid length "+`${t.length}, not a multiple of block size ${this.blockLength}.`;throw(0,i.trace)("Error: "+e),new Error(e)}let n;if(n=e?s.Buffer.from(await crypto.subtle.encrypt({name:"AES-CTR",counter:this.iv,length:this.blockSizeInBits},this.key,t)):s.Buffer.from(await crypto.subtle.decrypt({name:"AES-CTR",counter:this.iv,length:this.blockSizeInBits},this.key,t)),n.length!==t.length){const e="Result from encrypt/decrypt has invalid length "+`${n.length}, expected ${t.length}.`;throw(0,i.trace)("Error: "+e),new Error(e)}const r=t.length/this.blockLength;for(let e=0;e<r;e++)for(let e=this.iv.length-1;e>=0&&(this.iv[e]=this.iv[e]+1,!this.iv[e]);e--);return n}async aesCbc(e,t){if(e){let e=s.Buffer.from(await crypto.subtle.encrypt({name:"AES-CBC",iv:this.iv},this.key,t));return e=e.slice(0,t.length),e}return s.Buffer.from(await crypto.subtle.decrypt({name:"AES-CBC",iv:this.iv},this.key,t))}async aesGcm(e,t){if(t.length%this.blockLength!=0){const e="Encrypt/decrypt input has invalid length "+`${t.length}, not a multiple of block size ${this.blockLength}.`;throw(0,i.trace)("Error: "+e),new Error(e)}const n=t.length;let r;if(this.associatedData[0]=n>>>24,this.associatedData[1]=n>>>16,this.associatedData[2]=n>>>8,this.associatedData[3]=n,e)r=s.Buffer.from(await crypto.subtle.encrypt({name:"AES-GCM",iv:this.iv,additionalData:this.associatedData,tagLength:8*this.digestLength},this.key,t)),this.tag=r.slice(r.length-this.digestLength),r=r.slice(0,r.length-this.digestLength);else{if(!this.tag)throw new Error("AES-GCM tag was not set before decrypting.");const e=t.length+this.digestLength;if(this.decryptBuffer.length<e){let t=2*this.decryptBuffer.length;for(;t<e;)t*=2;this.decryptBuffer=s.Buffer.alloc(t)}const n=this.decryptBuffer.slice(0,e);t.copy(n,0),this.tag.copy(n,t.length),r=s.Buffer.from(await crypto.subtle.decrypt({name:"AES-GCM",iv:this.iv,additionalData:this.associatedData,tagLength:8*this.digestLength},this.key,n))}if(r.length!==t.length){const e="Result from encrypt/decrypt has invalid length "+`${r.length}, expected ${t.length}.`;throw(0,i.trace)("Error: "+e),new Error(e)}let o=12;for(;--o>=4&&(this.iv[o]++,0===this.iv[o]););return r}get digestLength(){return 16}get authenticatedEncryption(){return"GCM"===this.cipherMode}async sign(e){if(!this.tag)throw new Error("AES-GCM tag was not obtained by encrypting.");return this.tag}async verify(e,t){if(t.length!==this.digestLength)throw new Error("Incorrect AES-GCM tag length.");return this.tag=t,!0}dispose(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebRandom=void 0;t.WebRandom=class{getBytes(e){crypto.getRandomValues(e)}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.NodeRsa=void 0;const i=n(28),s=n(3),r=n(141),o=n(37),a=n(279),c=n(478),l=e.versions.node.split(".").map(e=>parseInt(e,10)),u=l[0]>10||10===l[0]&&l[1]>=12,d=l[0]>11||11===l[0]&&l[1]>=6;class h{constructor(){this.comment=null}get hasPublicKey(){return!!this.publicKey}get hasPrivateKey(){return!!this.privateKey}get keyAlgorithmName(){return f.keyAlgorithmName}generate(e){return e=null!=e?e:h.defaultKeySize,u&&d?this.generateNodeKeyPairObjects(e):u?this.generateNodeKeyPairBuffers(e):this.generateExternalKeyPair(e)}async generateNodeKeyPairObjects(e){[this.publicKey,this.privateKey]=await new Promise((t,n)=>{const s={modulusLength:e};try{i.generateKeyPair("rsa",s,(e,i,s)=>{e?n(e):t([i,s])})}catch(e){n(e)}})}async generateNodeKeyPairBuffers(e){[this.publicKey,this.privateKey]=await new Promise((t,n)=>{const s={modulusLength:e,publicKeyEncoding:{type:"pkcs1",format:"pem"},privateKeyEncoding:{type:"pkcs1",format:"pem",cipher:void 0,passphrase:void 0}};try{i.generateKeyPair("rsa",s,(e,i,s)=>{e?n(e):t([i,s])})}catch(e){n(e)}})}async generateExternalKeyPair(e){const t=new(await Promise.resolve().then(()=>n(66)))({b:e});this.publicKey=t.exportKey("pkcs1-public-pem"),this.privateKey=t.exportKey("pkcs1-private-pem"),this.publicKey.endsWith("\n")||(this.publicKey+="\n"),this.privateKey.endsWith("\n")||(this.privateKey+="\n")}async setPublicKeyBytes(e){if(!e)throw new TypeError("Buffer is required.");const t=new o.SshDataReader(e),n=t.readString("ascii");if(n!==this.keyAlgorithmName&&n!==f.rsaWithSha256&&n!==f.rsaWithSha512)throw new Error(`Invalid RSA key algorithm: ${n}`);const s=t.readBigInt(),r=t.readBigInt();e=c.Pkcs1KeyFormatter.formatRsaPublic({modulus:r,exponent:s}),this.publicKey=d?i.createPublicKey({key:e,type:"pkcs1",format:"der"}):(0,c.formatPem)(e,"RSA PUBLIC KEY")}async getPublicKeyBytes(e){if(!this.publicKey)return null;let t;e||(e=this.keyAlgorithmName),t="string"==typeof this.publicKey?(0,c.parsePem)(this.publicKey):this.publicKey.export({type:"pkcs1",format:"der"});const n=c.Pkcs1KeyFormatter.parseRsaPublic(t),i=s.Buffer.alloc(512),r=new o.SshDataWriter(i);return r.writeString(e,"ascii"),r.writeBigInt(n.exponent),r.writeBigInt(n.modulus),t=r.toBuffer(),t}async importParameters(e){if(d)this.publicKey=i.createPublicKey({key:c.Pkcs1KeyFormatter.formatRsaPublic(e),format:"der",type:"pkcs1"}),e.d?this.privateKey=i.createPrivateKey({key:c.Pkcs1KeyFormatter.formatRsaPrivate(e),format:"der",type:"pkcs1"}):this.privateKey=void 0;else{const t=c.Pkcs1KeyFormatter.formatRsaPublic(e);if(this.publicKey=(0,c.formatPem)(t,"RSA PUBLIC KEY"),e.d){const t=c.Pkcs1KeyFormatter.formatRsaPrivate(e);this.privateKey=(0,c.formatPem)(t,"RSA PRIVATE KEY")}}}async exportParameters(){var e,t;if(!this.publicKey)throw new Error("Public key not set.");let n;return n=d?(null!==(e=this.privateKey)&&void 0!==e?e:this.publicKey).export({format:"der",type:"pkcs1"}):(0,c.parsePem)(null!==(t=this.privateKey)&&void 0!==t?t:this.publicKey),this.privateKey?c.Pkcs1KeyFormatter.parseRsaPrivate(n):c.Pkcs1KeyFormatter.parseRsaPublic(n)}dispose(){this.publicKey=void 0,this.privateKey=void 0}}h.defaultKeySize=2048;class f extends r.PublicKeyAlgorithm{constructor(e,t){super(e,f.keyAlgorithmName,t)}createKeyPair(){return new h}async generateKeyPair(e){const t=new h;return await t.generate(e),t}createSigner(e){if(!(e instanceof h))throw new TypeError("RSA key pair object expected.");return new p(e,f.convertHashAlgorithmName(this.hashAlgorithmName),a.NodeHmac.getHashDigestLength(this.hashAlgorithmName))}createVerifier(e){if(!(e instanceof h))throw new TypeError("RSA key pair object expected.");return new p(e,f.convertHashAlgorithmName(this.hashAlgorithmName),a.NodeHmac.getHashDigestLength(this.hashAlgorithmName))}static convertHashAlgorithmName(e){return e.replace("SHA2-","SHA")}}t.NodeRsa=f,f.keyAlgorithmName="ssh-rsa",f.rsaWithSha256="rsa-sha2-256",f.rsaWithSha512="rsa-sha2-512",f.KeyPair=h;class p{constructor(e,t,n){this.keyPair=e,this.hashAlgorithmName=t,this.digestLength=n}async sign(e){if(!this.keyPair.privateKey)throw new Error("Private key not set.");const t=i.createSign(this.hashAlgorithmName);return t.update(e),t.sign(this.keyPair.privateKey)}async verify(e,t){if(!this.keyPair.publicKey)throw new Error("Public key not set.");const n=i.createVerify(this.hashAlgorithmName);return n.update(e),n.verify(this.keyPair.publicKey,t)}dispose(){}}}).call(this,n(11))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.NodeECDsa=void 0;const i=n(28),s=n(3),r=n(141),o=n(181),a=n(53),c=n(280),l=n(37),u=n(478),d=e.versions.node.split(".").map(e=>parseInt(e,10)),h=d[0]>10||10===d[0]&&d[1]>=12,f=d[0]>11||11===d[0]&&d[1]>=6;class p{constructor(e){this.comment=null,e&&(this.algorithmName=e)}get hasPublicKey(){return!!this.publicKey}get hasPrivateKey(){return!!this.privateKey}get keyAlgorithmName(){return this.algorithmName}get algorithmName(){return this.algorithm}set algorithmName(e){const t=e.split("-")[2];if(this.curve=o.curves.find(e=>e.name===t),!this.curve)throw new Error("Invalid or unsupported ECDSA algorithm: "+e);this.algorithm=e}generate(){return h&&f?this.generateNodeKeyPairObjects():h?this.generateNodeKeyPairBuffers():this.generateExternalKeyPair()}async generateNodeKeyPairObjects(){[this.publicKey,this.privateKey]=await new Promise((e,t)=>{const n={namedCurve:this.curve.shortName};try{i.generateKeyPair("ec",n,(n,i,s)=>{n?t(n):e([i,s])})}catch(e){t(e)}})}async generateNodeKeyPairBuffers(){[this.publicKey,this.privateKey]=await new Promise((e,t)=>{const n={namedCurve:this.curve.shortName,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"sec1",format:"pem",cipher:void 0,passphrase:void 0}};try{i.generateKeyPair("ec",n,(n,i,s)=>{n?t(n):e([i,s])})}catch(e){t(e)}})}async generateExternalKeyPair(){throw new Error("This version of node does not support generating key pairs. Use node >= 10.12.")}async setPublicKeyBytes(e,t){if(!e)throw new TypeError("Buffer is required.");const n=new l.SshDataReader(e),s=n.readString("ascii");this.algorithmName=t||s;const r=n.readString("ascii");this.algorithmName=`ecdsa-sha2-${r}`;const o=n.readBinary(),c=a.BigInt.fromBytes(o.slice(1,1+(o.length-1)/2),{unsigned:!0}),d=a.BigInt.fromBytes(o.slice(1+(o.length-1)/2),{unsigned:!0}),h=u.Sec1KeyFormatter.formatECPublic({curve:{name:this.curve.name,oid:this.curve.oid},x:c,y:d});this.publicKey=f?i.createPublicKey({key:h,type:"spki",format:"der"}):(0,u.formatPem)(h,"PUBLIC KEY")}async getPublicKeyBytes(e){if(!this.publicKey)return null;let t;t="string"==typeof this.publicKey?(0,u.parsePem)(this.publicKey):this.publicKey.export({type:"spki",format:"der"});const n=u.Sec1KeyFormatter.parseECPublic(t);e=e||this.algorithmName||this.keyAlgorithmName;const i=new l.SshDataWriter(s.Buffer.alloc(512));i.writeString(e,"ascii"),i.writeString(this.curve.name,"ascii");const r=Math.ceil(this.curve.keySize/8),o=n.x.toBytes({unsigned:!0,length:r}),a=n.y.toBytes({unsigned:!0,length:r});return i.writeUInt32(1+o.length+a.length),i.writeByte(4),i.write(o),i.write(a),i.toBuffer()}async importParameters(e){if(!e.curve)throw new TypeError("A curve is required.");let t;if(e.curve.oid){if(t=o.curves.find(t=>t.oid===e.curve.oid),!t)throw new Error(`Unsupported curve OID: ${e.curve.oid}`)}else{if(!e.curve.name)throw new TypeError("A curve OID or name is required.");if(t=o.curves.find(t=>t.name===e.curve.name),!t)throw new Error(`Unsupported curve: ${e.curve.name}`)}this.algorithmName="ecdsa-sha2-"+t.name;const n=u.Sec1KeyFormatter.formatECPublic(e);if(this.publicKey=f?i.createPublicKey({key:n,type:"spki",format:"der"}):(0,u.formatPem)(n,"EC PUBLIC KEY"),e.d){const t=u.Sec1KeyFormatter.formatECPrivate(e);this.privateKey=f?i.createPrivateKey({key:t,type:"sec1",format:"der"}):(0,u.formatPem)(t,"EC PRIVATE KEY")}else this.privateKey=void 0}async exportParameters(){var e,t;if(!this.publicKey)throw new Error("Key is not present.");let n;return n="string"==typeof this.publicKey?(0,u.parsePem)(null!==(e=this.privateKey)&&void 0!==e?e:this.publicKey):(null!==(t=this.privateKey)&&void 0!==t?t:this.publicKey).export({type:this.privateKey?"sec1":"spki",format:"der"}),this.privateKey?u.Sec1KeyFormatter.parseECPrivate(n):u.Sec1KeyFormatter.parseECPublic(n)}dispose(){}}class m extends r.PublicKeyAlgorithm{constructor(e,t){super(e,e,t)}createKeyPair(){return new p(this.name)}async generateKeyPair(){const e=new p(this.name);return await e.generate(),e}createSigner(e){if(!(e instanceof p))throw new TypeError("ECDSA key pair object expected.");return new g(e,m.convertHashAlgorithmName(this.hashAlgorithmName))}createVerifier(e){if(!(e instanceof p))throw new TypeError("ECDSA key pair object expected.");return new g(e,m.convertHashAlgorithmName(this.hashAlgorithmName))}static convertHashAlgorithmName(e){return e.replace("SHA2-","SHA")}static getSignatureLength(e){return 2*(5+Math.ceil(e/8))}}t.NodeECDsa=m,m.ecdsaSha2Nistp256="ecdsa-sha2-nistp256",m.ecdsaSha2Nistp384="ecdsa-sha2-nistp384",m.ecdsaSha2Nistp521="ecdsa-sha2-nistp521",m.curves=o.curves,m.KeyPair=p;class g{constructor(e,t){this.keyPair=e,this.hashAlgorithmName=t}get digestLength(){const e=this.keyPair.curve;return e?m.getSignatureLength(e.keySize):0}async sign(e){if(!this.keyPair.privateKey)throw new Error("Private key not set.");const t=i.createSign(this.hashAlgorithmName);t.update(e);let n=t.sign(this.keyPair.privateKey);const r=new c.DerReader(n),o=r.readInteger(),a=r.readInteger(),u=Math.ceil(this.keyPair.curve.keySize/8),d=new l.SshDataWriter(s.Buffer.alloc(this.digestLength));return d.writeBinary(o.toBytes({unsigned:!0,length:u+1})),d.writeBinary(a.toBytes({unsigned:!0,length:u+1})),n=d.toBuffer(),n}async verify(e,t){if(!this.keyPair.publicKey)throw new Error("Public key not set.");const n=new l.SshDataReader(t),r=n.readBigInt(),o=n.readBigInt(),a=new c.DerWriter(s.Buffer.alloc(t.length));a.writeInteger(r),a.writeInteger(o),t=a.toBuffer();const u=i.createVerify(this.hashAlgorithmName);return u.update(e),u.verify(this.keyPair.publicKey,t)}dispose(){}}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeEncryption=void 0;const i=n(28),s=n(3),r=n(275),o=n(46);class a extends r.EncryptionAlgorithm{constructor(e,t,n,i){if(super(e),this.algorithmName=t,this.cipherMode=n,this.keySizeInBits=i,"AES"!==t)throw new Error(`Unsupported encryption algorithm: ${t}`);this.blockSizeInBits=a.getBlockSize(t)}get keyLength(){return this.keySizeInBits/8}get blockLength(){return this.blockSizeInBits/8}async createCipher(e,t,n){let i;if("CTR"===this.cipherMode||"CBC"===this.cipherMode)i=new c(e,this.keySizeInBits,this.blockSizeInBits,t,n,this.cipherMode);else{if("GCM"!==this.cipherMode)throw new Error(`Unsupported cipher mode: ${this.cipherMode}`);i=new l(e,this.keySizeInBits,this.blockSizeInBits,t,n)}return i}static getBlockSize(e){if("AES"===e)return 128;throw new Error(`Unsupported encryption algorithm: ${e}`)}}t.NodeEncryption=a;class c{constructor(e,t,n,s,r,o){this.isEncryption=e,this.keySizeInBits=t,this.blockSizeInBits=n;const a=`AES-${this.keySizeInBits}-${o}`;this.cipher=this.isEncryption?i.createCipheriv(a,s,r):i.createDecipheriv(a,s,r),this.cipher.setAutoPadding(!1)}get blockLength(){return this.blockSizeInBits/8}transform(e){const t=this.cipher.update(e);if(t.length!==e.length){const n="Result from encrypt/decrypt has invalid length "+`${t.length}, expected ${e.length}.`;throw(0,o.trace)("Error: "+n),new Error(n)}return Promise.resolve(t)}dispose(){}}class l{constructor(e,t,n,i,r){this.isEncryption=e,this.keySizeInBits=t,this.blockSizeInBits=n,this.tag=null,this.algorithmName=`aes-${this.keySizeInBits}-gcm`,this.key=s.Buffer.alloc(i.length),i.copy(this.key),this.nonce=s.Buffer.alloc(12),r.copy(this.nonce,0,0,12),this.associatedData=s.Buffer.alloc(4)}get blockLength(){return this.blockSizeInBits/8}get digestLength(){return 16}get authenticatedEncryption(){return!0}transform(e){if(e.length%this.blockLength!=0){const t="Encrypt/decrypt input has invalid length "+`${e.length}, not a multiple of block size ${this.blockLength}.`;throw(0,o.trace)("Error: "+t),new Error(t)}const t=this.isEncryption?i.createCipheriv(this.algorithmName,this.key,this.nonce):i.createDecipheriv(this.algorithmName,this.key,this.nonce),n=e.length;if(this.associatedData[0]=n>>>24,this.associatedData[1]=n>>>16,this.associatedData[2]=n>>>8,this.associatedData[3]=n,t.setAAD(this.associatedData),!this.isEncryption){if(!this.tag)throw new Error("AES-GCM tag was not set before decrypting.");t.setAuthTag(this.tag)}const s=t.update(e);if(s.length!==e.length){const t="Result from encrypt/decrypt has invalid length "+`${s.length}, expected ${e.length}.`;throw(0,o.trace)("Error: "+t),new Error(t)}t.final(),this.isEncryption?this.tag=t.getAuthTag():this.tag=null;let r=12;for(;--r>=4&&(this.nonce[r]++,0===this.nonce[r]););return Promise.resolve(s)}async sign(e){if(!this.tag)throw new Error("AES-GCM tag was not obtained by encrypting.");return this.tag}async verify(e,t){if(t.length!==this.digestLength)throw new Error("Incorrect AES-GCM tag length.");return this.tag=t,!0}dispose(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeRandom=void 0;const i=n(28);t.NodeRandom=class{getBytes(e){i.randomBytes(e.length).copy(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshProtocol=void 0;const i=n(46),s=n(3),r=n(182),o=n(143),a=n(105),c=n(37),l=n(54),u=n(283),d=n(84),h=n(47);class f{constructor(e,t){this.sequence=e,this.message=t}}class p{constructor(e,t,n){this.config=t,this.metrics=n,this.sessionSemaphore=new o.Semaphore(1),this.inboundPacketSequence=0,this.outboundPacketSequence=0,this.inboundFlow=0,this.outboundFlow=0,this.recentSentMessages=new r.Queue,this.sendWriter=new c.SshDataWriter(s.Buffer.alloc(1024)),this.receiveWriter=new c.SshDataWriter(s.Buffer.alloc(1024)),this.extensions=null,this.kexService=null,this.algorithms=null,this.outgoingMessagesHaveLatencyInfo=!1,this.incomingMessagesHaveLatencyInfo=!1,this.outgoingMessagesHaveReconnectInfo=!1,this.incomingMessagesHaveReconnectInfo=!1,this.stream=e}get lastIncomingSequence(){return this.inboundPacketSequence-1}getSentMessages(e){if(e===this.outboundPacketSequence+1)return[];if(this.recentSentMessages.size>0&&e<this.recentSentMessages.peek().sequence)return null;const t=new Array;for(let n of this.recentSentMessages)if(n.sequence>=e){const e=n.message;e instanceof u.KeyExchangeMessage||e instanceof l.DisconnectMessage||t.push(e)}return t}async writeProtocolVersion(e,t){const n=this.stream;if(!n)throw new Error("SSH session disconnected.");const i=s.Buffer.from(e+"\r\n");return await n.write(i,t),this.metrics.addMessageSent(i.length),Promise.resolve()}async readProtocolVersion(e){const t=this.stream;if(!t)throw new Error("SSH session disconnected.");const n=s.Buffer.alloc(255);let i=0;for(let s=0;s<n.length;s++){const r=await t.read(1,e);if(!r)break;n[s]=r[0];const o=13,a=10;if(s>0&&n[s-1]===o&&n[s]===a){const e=n.toString("utf8",0,s-1);if(e.startsWith("SSH-"))return this.metrics.addMessageReceived(s+1),e;if(i>20)break;i++,s=-1}}throw new h.SshConnectionError("Failed to read the protocol version",l.SshDisconnectReason.protocolError)}async handleNewKeys(e){try{await this.sessionSemaphore.wait(e),this.inboundFlow=0,this.outboundFlow=0,this.algorithms=this.kexService.finishKeyExchange()}finally{this.sessionSemaphore.release()}}async read(e,t){const n=this.stream;if(!n)return!1;let s=0;do{let r;try{r=await n.read(e.length-s,t)}catch(e){if(!(e instanceof Error))throw e;if(n.isDisposed)return!1;throw n.dispose(),this.stream=null,(0,i.trace)("Error reading from stream: "+e.message),new h.SshConnectionError("Error reading from stream: "+e.message,l.SshDisconnectReason.connectionLost)}if(!r)return!1;r.copy(e,s),s+=r.length}while(s<e.length);return!0}async write(e,t){const n=this.stream;if(!n)return!1;try{await n.write(e,t)}catch(e){if(!(e instanceof Error))throw e;if(n.isDisposed)return!1;throw n.dispose(),this.stream=null,(0,i.trace)("Error writing to stream: "+e.message),new h.SshConnectionError("Error writing to stream: "+e.message,l.SshDisconnectReason.connectionLost)}return!0}async considerReExchange(e,t){const n=this.kexService;if(!n)return;let i=null,s=null;!n.exchanging&&(e||this.inboundFlow+this.outboundFlow>this.config.keyRotationThreshold)&&([i,s]=await n.startKeyExchange(e)),i&&(await this.sendMessage(i,t),s&&await this.sendMessage(s,t))}async computeHmac(e,t,n){const i=new c.SshDataWriter(s.Buffer.alloc(4+t.length));return i.writeUInt32(n),i.write(t),await e.sign(i.toBuffer())}async verifyHmac(e,t,n,i){const r=new c.SshDataWriter(s.Buffer.alloc(4+t.length));return r.writeUInt32(n),r.write(t),await e.verify(r.toBuffer(),i)}async readAndVerifyHmac(e,t,n,i){if(!await this.read(n,i))return!1;if(!await this.verifyHmac(e,t,this.inboundPacketSequence,n))throw new h.SshConnectionError("Invalid MAC",l.SshDisconnectReason.macError);return!0}async sendMessage(e,t){var n;const r=this.algorithms,o=null==r?void 0:r.compressor,a=null==r?void 0:r.cipher,c=null==r?void 0:r.messageSigner;let l;await this.sessionSemaphore.wait(t);try{const r=a?Math.max(8,a.blockLength):8,u=p.packetLengthSize+p.paddingLengthSize;if(this.sendWriter.position=u,e.write(this.sendWriter),this.outgoingMessagesHaveReconnectInfo&&(this.sendWriter.writeUInt64(this.lastIncomingSequence),this.outgoingMessagesHaveLatencyInfo)){const e=Math.min(4294967295,Math.round(1e3*(this.metrics.time-this.lastIncomingTimestamp)));this.sendWriter.writeUInt32(e)}let h=this.sendWriter.toBuffer().slice(u);null!=o&&(h=o.compress(h));let m=r-((!((null==c?void 0:c.encryptThenMac)||(null==c?void 0:c.authenticatedEncryption))?p.packetLengthSize:0)+p.paddingLengthSize+h.length)%r;m<4&&(m+=r);const g=p.paddingLengthSize+h.length+m;this.sendWriter.position=0,this.sendWriter.writeUInt32(g),this.sendWriter.writeByte(m),null!=o?this.sendWriter.write(h):this.sendWriter.position+=h.length,this.sendWriter.writeRandom(m),h=this.sendWriter.toBuffer();let y=null;if((null==c?void 0:c.encryptThenMac)&&a){const e=h.slice(p.packetLengthSize,h.length);(await a.transform(e)).copy(e),y=await this.computeHmac(c,h,this.outboundPacketSequence)}else if(null==c?void 0:c.authenticatedEncryption){let e=h.slice(p.packetLengthSize,h.length);(await a.transform(e)).copy(e),y=await c.sign(e)}else c&&(y=await this.computeHmac(c,h,this.outboundPacketSequence)),a&&(h=await a.transform(h));if(e instanceof d.ChannelDataMessage?i.traceData.enabled&&(0,i.traceData)(`Sending #${this.outboundPacketSequence} ${e}`):(0,i.trace)(`Sending #${this.outboundPacketSequence} ${e}`),this.incomingMessagesHaveReconnectInfo){const t=new f(this.outboundPacketSequence,e);t.sentTime=this.metrics.time,this.recentSentMessages.enqueue(t)}if(this.outboundPacketSequence++,this.outboundFlow+=g,y){const e=s.Buffer.concat([h,y],h.length+y.length);l=await this.write(e,t)}else l=await this.write(h,t);this.metrics.addMessageSent(p.packetLengthSize+g+(null!==(n=null==c?void 0:c.digestLength)&&void 0!==n?n:0))}finally{this.sessionSemaphore.release()}return await this.considerReExchange(!1,t),l}async receiveMessage(e){var t;const n=this.algorithms,s=null==n?void 0:n.decipher,r=null==n?void 0:n.messageVerifier,o=null==n?void 0:n.decompressor,u=!((null==r?void 0:r.encryptThenMac)||(null==r?void 0:r.authenticatedEncryption)),f=u?s?Math.max(8,s.blockLength):8:p.packetLengthSize;this.receiveWriter.position=f;let m=this.receiveWriter.toBuffer();if(!await this.read(m,e))return null;this.lastIncomingTimestamp=this.metrics.time,s&&u&&(m=await s.transform(m),this.receiveWriter.position=0,this.receiveWriter.write(m));const g=new c.SshDataReader(m).readUInt32();if(g>p.maxPacketLength)throw(0,i.trace)("Invalid packet length."),new h.SshConnectionError("Invalid packet length.",l.SshDisconnectReason.protocolError);const y=p.packetLengthSize+g;y>f&&this.receiveWriter.skip(y-f),r&&this.receiveWriter.skip(r.digestLength);const v=this.receiveWriter.toBuffer(),S=v.slice(0,y),_=v.slice(y);let E=S.slice(f,y);if(E.length>0){if(!await this.read(E,e))return null;if((null==r?void 0:r.encryptThenMac)&&!await this.readAndVerifyHmac(r,S,_,e))return null;if(s){if(null==r?void 0:r.authenticatedEncryption){if(!await this.read(_,e))return null;await r.verify(E,_)}try{E=await s.transform(E)}catch(e){throw(null==r?void 0:r.authenticatedEncryption)?new h.SshConnectionError("Invalid MAC",l.SshDisconnectReason.macError):e}this.receiveWriter.position=f,this.receiveWriter.write(E)}}if(r&&!r.encryptThenMac&&!r.authenticatedEncryption&&!await this.readAndVerifyHmac(r,S,_,e))return null;const w=S[p.packetLengthSize];let b=S.slice(p.packetLengthSize+p.paddingLengthSize,p.packetLengthSize+(g-w));if(o&&(b=o.decompress(b)),this.incomingMessagesHaveReconnectInfo){let e,t;if(this.incomingMessagesHaveLatencyInfo){const n=new c.SshDataReader(b.slice(b.length-12,b.length));e=n.readUInt64(),t=n.readUInt32()/1e3,b=b.slice(0,b.length-12)}else{e=new c.SshDataReader(b.slice(b.length-8,b.length)).readUInt64(),t=0,b=b.slice(0,b.length-8)}for(;this.recentSentMessages.size>0;){const n=this.recentSentMessages.peek();if(n.sequence>e)break;if(this.stream&&this.incomingMessagesHaveLatencyInfo&&n.sequence===e){const e=this.lastIncomingTimestamp-n.sentTime-t;this.metrics.updateLatency(e)}this.recentSentMessages.dequeue()}}const C=b[0];let T=a.SshMessage.create(C,b);if(!T){const e=new l.UnimplementedMessage;e.sequenceNumber=this.inboundPacketSequence,e.unimplementedMessageType=C,T=e}return T instanceof d.ChannelDataMessage?i.traceData.enabled&&(0,i.traceData)(`Receiving #${this.inboundPacketSequence} ${T}`):(0,i.trace)(`Receiving #${this.inboundPacketSequence} ${T}`),await this.sessionSemaphore.wait(e),this.inboundPacketSequence++,this.inboundFlow+=g,this.sessionSemaphore.release(),this.metrics.addMessageReceived(p.packetLengthSize+g+(null!==(t=null==r?void 0:r.digestLength)&&void 0!==t?t:0)),await this.considerReExchange(!1,e),T}dispose(){try{this.stream&&this.stream.close().catch(e=>{(0,i.trace)("Error closing stream: "+e.message)})}catch(e){if(!(e instanceof Error))throw e;(0,i.trace)("Error closing stream: "+e.message)}this.stream=null,this.metrics.updateLatency(0),this.algorithms&&this.algorithms.dispose()}}t.SshProtocol=p,p.maxPacketLength=1048576,p.packetLengthSize=4,p.paddingLengthSize=1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshSessionAlgorithms=void 0;t.SshSessionAlgorithms=class{dispose(){this.cipher&&this.cipher.dispose(),this.decipher&&this.decipher.dispose(),this.signer&&this.signer.dispose(),this.verifier&&this.verifier.dispose()}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SshClientSession=void 0;const i=n(46),s=n(142),r=n(54),o=n(285),a=n(85),c=n(86),l=n(140),u=n(284),d=n(144),h=n(47);class f extends s.SshSession{constructor(e){super(e,!0),this.serviceRequests=new Map,this.clientAuthCompletion=null}async authenticate(e,t){return!!await this.authenticateServer(t)&&!!await this.authenticateClient(e,t)}async authenticateServer(e){if(!this.kexService||!this.kexService.hostKey)throw new Error("Encrypt the session before authenticating.");try{this.principal=await this.raiseAuthenticatingEvent(new o.SshAuthenticatingEventArgs(o.SshAuthenticationType.serverPublicKey,{publicKey:this.kexService.hostKey},e))}catch(e){if(!(e instanceof Error))throw e;throw(0,i.trace)("Error while authenticating server: "+e.message),e}return this.principal?((0,i.trace)(`${this} server authenticated.`),!0):(await this.close(r.SshDisconnectReason.hostKeyNotVerifiable,"Server authentication failed."),(0,i.trace)(`${this} server authentication failed.`),!1)}authenticateClient(e,t,n){if(!e)throw new TypeError("A credentials object is required.");return"function"==typeof t?this.authenticateClientWithCompletion(e,t,n):new Promise(async(n,i)=>{await this.authenticateClientWithCompletion(e,(e,t)=>{e?i(e):n(t)},t)})}async authenticateClientWithCompletion(e,t,n){if(this.clientAuthCompletion=new a.PromiseCompletionSource,this.clientAuthCompletion.promise.then(e=>t(void 0,e),e=>t(e)),n){if(n.isCancellationRequested)throw new c.CancellationError;n.onCancellationRequested(e=>{this.clientAuthCompletion&&this.clientAuthCompletion.reject(new c.CancellationError)})}let i=this.getService(u.AuthenticationService);if(!i){const e=new r.ServiceRequestMessage;e.serviceName=u.AuthenticationService.serviceName,await this.sendMessage(e,n),i=this.activateService(u.AuthenticationService)}await i.authenticateClient(e,n)}onAuthenticationComplete(e){e?(0,i.trace)(`${this} client authenticated.`):(0,i.trace)(`${this} client authentication failed.`),this.clientAuthCompletion&&(this.clientAuthCompletion.resolve(e),this.clientAuthCompletion=null)}async requestService(e,t){let n=!1,i=this.serviceRequests.get(e);if(i||(i=new a.PromiseCompletionSource,this.serviceRequests.set(e,i),n=!0),n){const n=new r.ServiceRequestMessage;n.serviceName=e,await this.sendMessage(n,t)}await i.promise}async handleServiceAcceptMessage(e,t){const n=this.serviceRequests.get(e.serviceName);null==n||n.resolve(!0)}async openChannel(e,t,n){if(!this.connectionService){const e=new r.ServiceRequestMessage;e.serviceName=d.ConnectionService.serviceName,await this.sendMessage(e,n)}return await super.openChannel(e,t,n)}handleDisconnected(){return this.reconnecting?(this.reconnecting=!1,!1):super.handleDisconnected()}async reconnect(e,t){if(this.isClosed)throw new h.ObjectDisposedError(this);if(this.isConnected)throw new Error("Already connected.");if(!this.protocol)throw new Error("The session was never previously connected.");if(this.reconnecting)throw new Error("Already reconnecting.");this.reconnecting=!0;try{await this.reconnectInternal(e,t)}finally{this.reconnecting=!1}}async reconnectInternal(t,n){var s,o,a,c,u,d;const f=this.sessionId,p=this.protocol,m=null===(s=this.kexService)||void 0===s?void 0:s.hostKey;if(!(f&&p&&this.kexService&&m&&(null===(o=p.extensions)||void 0===o?void 0:o.has(l.SshProtocolExtensionNames.sessionReconnect))))throw new Error("Reconnect was not enabled for this session.");let g;try{if(this.sessionId=null,await this.connect(t,n),!this.sessionId||!this.algorithms||!this.algorithms.signer)throw new Error("Session is not encrypted.");const e=this.kexService.hostKey,s=e?await e.getPublicKeyBytes():null,o=await m.getPublicKeyBytes();if(!s||!o||!s.equals(o)){const e="The server host key is different.";throw(0,i.trace)(`Reconnection failed: ${e}`),new h.SshReconnectError(e,r.SshReconnectFailureReason.differentServerHostKey)}g=this.sessionId}catch(e){throw this.protocol=p,super.handleDisconnected(),e}finally{this.sessionId=f,this.kexService.hostKey=m}const y=await this.createReconnectToken(f,g),v=new r.SessionReconnectRequestMessage;v.requestType="session-reconnect@microsoft.com",v.clientReconnectToken=y,v.lastReceivedSequenceNumber=p.lastIncomingSequence,v.wantReply=!0;const S=await this.requestResponse(v,r.SessionReconnectResponseMessage,r.SessionReconnectFailureMessage,n);if(S instanceof r.SessionReconnectFailureMessage){const e=null!==(a=S.reasonCode)&&void 0!==a?a:r.SshReconnectFailureReason.unknownServerFailure,t=null!==(c=S.description)&&void 0!==c?c:"The server rejected the reconnect request.";throw(0,i.trace)(`Reconnection failed: ${t}`),this.protocol=p,new h.SshReconnectError(t,e)}if(!this.verifyReconnectToken(f,g,null!==(u=S.serverReconnectToken)&&void 0!==u?u:e.alloc(0))){const e="The reconnect token provided by the server was invalid.";throw(0,i.trace)(`Reconnection failed: ${e}`),new h.SshReconnectError(e,r.SshReconnectFailureReason.invalidServerReconnectToken)}(0,i.trace)("Reconnect request was accepted by the server.");const _=p.getSentMessages((null!==(d=S.lastReceivedSequenceNumber)&&void 0!==d?d:0)+1);if(!_){const e="Client is unable to re-send messages requested by the server.";throw(0,i.trace)(`Reconnection failed: ${e}`),new h.SshReconnectError(e,r.SshReconnectFailureReason.clientDroppedMessages)}let E=0;for(let e of _)await this.sendMessage(e,n),E++;p.dispose(),this.metrics.addReconnection(),(0,i.trace)(`Reconnected. Re-sent ${E} dropped messages.`)}dispose(){this.clientAuthCompletion&&this.clientAuthCompletion.reject(new h.ObjectDisposedError(this)),super.dispose()}}t.SshClientSession=f}).call(this,n(3).Buffer)},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SshServerSession=void 0;const i=n(142),s=n(8),r=n(54),o=n(47),a=n(140),c=n(46);class l extends i.SshSession{constructor(e,t){super(e,!1),this.reconnectedEmitter=new s.Emitter,this.onReconnected=this.reconnectedEmitter.event,this.credentials={publicKeys:[]};const n=e.protocolExtensions.includes(a.SshProtocolExtensionNames.sessionReconnect);if(n&&!t)throw new Error("When reconnect is enabled, server sessions require a reference to a shared collection to track reconnectable sessions.");if(!n&&t)throw new Error("When reconnect is not enabled, the reconnectable sessions collection is not applicable.");this.reconnectableSessions=t}async handleServiceRequestMessage(e,t){if(!this.activateService(e.serviceName))throw new o.SshConnectionError(`Service "${e.serviceName}" not available.`,r.SshDisconnectReason.serviceNotAvailable);{const n=new r.ServiceAcceptMessage;n.serviceName=e.serviceName,await this.sendMessage(n,t)}}async handleRequestMessage(e,t){var n;if("session-reconnect@microsoft.com"===e.requestType&&(null===(n=this.config.protocolExtensions)||void 0===n?void 0:n.includes(a.SshProtocolExtensionNames.sessionReconnect))){const n=e.convertTo(new r.SessionReconnectRequestMessage);await this.reconnect(n,t)}else await super.handleRequestMessage(e,t)}async enableReconnect(e){await super.enableReconnect(e),this.reconnectableSessions.includes(this)||this.reconnectableSessions.push(this)}handleDisconnected(){return!!this.reconnecting||super.handleDisconnected()}async reconnect(t,n){var i,s,o;if(!this.reconnectableSessions)throw new Error("Disconnected sessions collection should have been initialied when reconnect is enabled.");let a;for(let n of this.reconnectableSessions)if(n!==this&&await this.verifyReconnectToken(n.sessionId,this.sessionId,null!==(i=t.clientReconnectToken)&&void 0!==i?i:e.alloc(0))){a=n,this.reconnectableSessions.splice(this.reconnectableSessions.indexOf(a),1);break}if(!a||a.isClosed){const e="Requested reconnect session was not found or the reconnect token provided by the client was invalid.";(0,c.trace)(`Reconnect failed: ${e}`);const t=new r.SessionReconnectFailureMessage;return t.reasonCode=r.SshReconnectFailureReason.sessionNotFound,t.description=e,void await this.sendMessage(t,n)}const l=a.protocol.getSentMessages((null!==(s=t.lastReceivedSequenceNumber)&&void 0!==s?s:0)+1);if(!l){this.reconnectableSessions.push(a);const e="Server is unable to re-send messages requested by the client.";(0,c.trace)(`Reconnect failed: ${e}`);const t=new r.SessionReconnectFailureMessage;return t.reasonCode=r.SshReconnectFailureReason.serverDroppedMessages,t.description=e,void await this.sendMessage(t,n)}const u=new r.SessionReconnectResponseMessage;u.serverReconnectToken=await this.createReconnectToken(a.sessionId,this.sessionId),u.lastReceivedSequenceNumber=a.protocol.lastIncomingSequence,await this.sendMessage(u,n);try{for(a.reconnecting=!0,null===(o=a.protocol)||void 0===o||o.dispose();a.isConnected;)await new Promise(e=>setTimeout(()=>e(),5));a.protocol=this.protocol,a.protocol.kexService=a.kexService,this.protocol=void 0;for(let e of l)await a.sendMessage(e,n);this.dispose()}finally{a.reconnecting=!1}this.reconnectableSessions.push(a),a.metrics.addReconnection(),a.processMessages().catch(e=>{(0,c.trace)(`Unhandled error processing messages: ${e.message||JSON.stringify(e)}`)}),(0,c.trace)(`Session reconnected. Re-sent ${l.length} dropped messages.`),a.reconnectedEmitter.fire()}dispose(){if(this.reconnectableSessions){const e=this.reconnectableSessions.indexOf(this);e>=0&&this.reconnectableSessions.splice(e,1)}super.dispose()}}t.SshServerSession=l}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketStream=t.NodeStream=t.BaseStream=void 0;const i=n(3),s=n(8),r=n(86),o=n(47);function a(e,t){t&&(t.isCancellationRequested?e(new r.CancellationError):t.onCancellationRequested(()=>{e(new r.CancellationError)}))}class c{constructor(){this.incomingData=[],this.pendingReads=[],this.error=null,this.disposed=!1,this.closedEmitter=new s.Emitter,this.closed=this.closedEmitter.event}onData(e){for(;this.pendingReads.length>0;){const t=this.pendingReads.shift();if(t.count>=e.length)return void t.resolve(e);{const n=e.slice(0,t.count);e=e.slice(t.count),t.resolve(n)}}this.incomingData.push(e)}onEnd(){for(;this.pendingReads.length>0;){this.pendingReads.shift().resolve(null)}this.incomingData.push(i.Buffer.alloc(0))}onError(e){for(this.error||(this.error=e);this.pendingReads.length>0;){this.pendingReads.shift().reject(e)}}async read(e,t){if(this.disposed)throw new o.ObjectDisposedError(this);if(this.incomingData.length>0){let t=this.incomingData[0];return 0===t.length?null:(e>=t.length?this.incomingData.shift():(this.incomingData[0]=t.slice(e),t=t.slice(0,e)),t)}if(this.error)throw this.error;return await new Promise((n,i)=>{if(t){if(t.isCancellationRequested)return void i(new r.CancellationError);t.onCancellationRequested(()=>{for(let e=0;e<this.pendingReads.length;e++)if(Object.is(t,this.pendingReads[e].cancellation)){this.pendingReads.splice(e--,1)[0].reject(new r.CancellationError)}})}this.pendingReads.push({count:e,resolve:n,reject:i,cancellation:t})})}dispose(){if(!this.disposed){this.disposed=!0;const e=new o.ObjectDisposedError(this);this.onError(e),this.fireOnClose(e)}}fireOnClose(e){this.closedEmitter.fire({error:e})}get isDisposed(){return this.disposed}}t.BaseStream=c;t.NodeStream=class extends c{constructor(e,t){if(super(),!e)throw new TypeError("Duplex or Readable/Writable stream are required.");this.readStream=e,this.writeStream=t||e,this.readStream.on("data",this.onData.bind(this)),this.readStream.on("end",this.onEnd.bind(this)),this.readStream.on("error",this.onError.bind(this)),this.readStream.on("close",()=>{this.onEnd(),this.fireOnClose()})}async write(e,t){if(!e)throw new TypeError("Data is required.");if(this.disposed)throw new o.ObjectDisposedError(this);return new Promise((n,i)=>{a(i,t),this.writeStream.write(e,e=>{e?i(e):n()})})}async close(e,t){if(this.disposed)throw new o.ObjectDisposedError(this);await new Promise((e,n)=>{a(n,t),this.writeStream.end(e)}),this.disposed=!0,this.onError(e||new o.ObjectDisposedError(this)),this.closedEmitter.fire({error:e})}dispose(){if(!this.disposed){const e=new o.ObjectDisposedError(this);this.readStream.destroy(e),this.writeStream.destroy(e)}super.dispose()}};t.WebSocketStream=class extends c{constructor(e){if(super(),this.websocket=e,!e)throw new TypeError("WebSocket is required.");if("string"==typeof e.binaryType&&"arraybuffer"!==e.binaryType)throw new Error("WebSocket must use arraybuffer binary type.");e.onmessage=e=>{this.onData(i.Buffer.from(e.data))},e.onclose=e=>{if(e.wasClean)this.onEnd();else{const t=new Error(e.reason);t.code=e.code,this.onError(t)}}}async write(e,t){if(!e)throw new TypeError("Data is required.");if(this.disposed)throw new o.ObjectDisposedError(this);if("readyState"in this.websocket&&(2===this.websocket.readyState||3===this.websocket.readyState))throw new DOMException("WebSocket is already in CLOSING or CLOSED state.","InvalidStateError");this.websocket.send(e)}async close(e,t){if(this.disposed)throw new o.ObjectDisposedError(this);if(e){const t="number"==typeof e.code?e.code:void 0;this.websocket.close(t,e.message)}else this.websocket.close();this.disposed=!0,this.closedEmitter.fire({error:e}),this.onError(e||new Error("Stream closed."))}dispose(){this.disposed||this.websocket.close(),super.dispose()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshRpcMessageStream=void 0;const i=n(8),s=n(3),r=n(37);class o{constructor(e){this.channel=e,this.errorEmitter=new i.Emitter,this.closeEmitter=new i.Emitter,this.partialMessageEmitter=new i.Emitter,this.callback=null,this.messageBuffer=new r.SshDataWriter(s.Buffer.alloc(1024)),this.headersLength=null,this.messageLength=null,this.onError=this.errorEmitter.event,this.onClose=this.closeEmitter.event,this.onPartialMessage=this.partialMessageEmitter.event,this.eventRegistration=this.channel.onDataReceived(this.onDataReceived.bind(this)),this.channel.onClosed(e=>{e.error&&this.errorEmitter.fire(e.error),this.closeEmitter.fire()})}listen(e){this.callback=e}dispose(){this.eventRegistration&&this.eventRegistration.dispose()}onDataReceived(e){if(this.messageBuffer.write(e),this.channel.adjustWindow(e.length),e=this.messageBuffer.toBuffer(),null===this.messageLength){const t=e.indexOf("\r\n\r\n");if(t<0)return;const n=e.slice(0,t).toString();if(!n.startsWith("Content-Length: "))throw new Error(`Message does not start with JSON-RPC headers.\n${n}`);this.headersLength=t+"\r\n\r\n".length,this.messageLength=parseInt(n.substr("Content-Length: ".length,t-"Content-Length: ".length),10)}const t=this.messageBuffer.position,n=this.headersLength+this.messageLength;if(t>=n){if(this.callback){const t=e.slice(this.headersLength,n).toString();let i;try{i=JSON.parse(t)}catch(e){if(!(e instanceof Error))throw e;throw new Error(`Failed to parse JSON-RPC message: ${e.message}\n${t}`)}this.callback(i)}this.messageLength=null,this.messageBuffer.position=0,t>n&&this.onDataReceived(e.slice(n))}}}class a{constructor(e){this.channel=e,this.errorEmitter=new i.Emitter,this.closeEmitter=new i.Emitter,this.onError=this.errorEmitter.event,this.onClose=this.closeEmitter.event,this.channel.onClosed(e=>{e.error&&this.errorEmitter.fire([e.error,e.errorMessage&&{jsonrpc:e.errorMessage}||void 0,e.exitStatus]),this.closeEmitter.fire()})}write(e){const t=JSON.stringify(e),n=s.Buffer.from(t),i=s.Buffer.from("Content-Length: "+n.length+"\r\n\r\n"),r=s.Buffer.alloc(i.length+n.length);i.copy(r,0),n.copy(r,i.length),this.channel.send(r).catch(e=>{this.errorEmitter.fire([e,void 0,void 0])})}dispose(){}}t.SshRpcMessageStream=class{constructor(e){this.reader=new o(e),this.writer=new a(e)}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SessionContour=void 0;const i=n(47),s=n(182),r=n(143);class o{constructor(e=256){if(this.intervalMs=o.initialInterval,this.count=0,this.updateQueue=new s.Queue,this.updateSemaphore=new r.Semaphore(0),this.disposed=!1,e<2||0!=(e&e-1))throw new Error("Contour intervals must be a power of two.");this.maxIntervals=e,this.intervalBytesSent=new Array(e),this.intervalBytesReceived=new Array(e),this.intervalLatencyMin=new Array(e),this.intervalLatencyMax=new Array(e),this.intervalLatencySum=new Array(e),this.intervalLatencyCount=new Array(e),this.intervalLatencyAvg=new Array(e),this.intervalBytesSent.fill(0),this.intervalBytesReceived.fill(0),this.intervalLatencyMin.fill(0),this.intervalLatencyMax.fill(0),this.intervalLatencySum.fill(0),this.intervalLatencyCount.fill(0),this.intervalLatencyAvg.fill(0)}get intervalCount(){return this.count}get interval(){return this.intervalMs}get bytesSent(){return this.intervalBytesSent.slice(0,this.count)}get bytesReceived(){return this.intervalBytesReceived.slice(0,this.count)}get latencyMinMs(){return this.intervalLatencyMin.slice(0,this.count)}get latencyMaxMs(){return this.intervalLatencyMax.slice(0,this.count)}get latencyAverageMs(){return this.intervalLatencyAvg.slice(0,this.count)}onMessageSent(e){this.updateQueue.enqueue({time:e.time,bytesSent:e.size}),this.updateSemaphore.tryRelease()}onMessageReceived(e){this.updateQueue.enqueue({time:e.time,bytesReceived:e.size}),this.updateSemaphore.tryRelease()}onLatencyUpdated(e){this.updateQueue.enqueue(e),this.updateSemaphore.tryRelease()}onSessionClosed(){this.updateSemaphore.tryRelease()}async collectMetrics(e,t){if(!e)throw new TypeError("A session metrics object is required.");if(this.disposed)throw new i.ObjectDisposedError(this);const n=[];n.push(e.onMessageSent(this.onMessageSent.bind(this))),n.push(e.onMessageReceived(this.onMessageReceived.bind(this))),n.push(e.onLatencyUpdated(this.onLatencyUpdated.bind(this))),n.push(e.onSessionClosed(this.onSessionClosed.bind(this)));try{for(;!(null==t?void 0:t.isCancellationRequested);){try{await this.updateSemaphore.wait(t)}catch(e){break}const e=this.updateQueue.dequeue();if(!e)break;const n=this.updateInterval(e.time);e.bytesSent&&(this.intervalBytesSent[n]+=e.bytesSent),e.bytesReceived&&(this.intervalBytesReceived[n]+=e.bytesReceived);const i=e.latency;i&&((!this.intervalLatencyMin[n]||i<this.intervalLatencyMin[n])&&(this.intervalLatencyMin[n]=i),(!this.intervalLatencyMax[n]||i>this.intervalLatencyMax[n])&&(this.intervalLatencyMax[n]=i),this.intervalLatencySum[n]+=i,this.intervalLatencyCount[n]++,this.intervalLatencyAvg[n]=this.intervalLatencySum[n]/this.intervalLatencyCount[n])}this.disposed&&this.updateSemaphore.dispose()}finally{for(let e of n)e.dispose()}}updateInterval(e){let t=Math.floor(e/this.intervalMs);if(t>=this.intervalCount){for(;t>=this.maxIntervals;)this.expandIntervals(),t=Math.floor(e/this.intervalMs);this.count=t+1}return t}expandIntervals(){const e=(e,t,n)=>0===e?t:0===t?e:n(e,t),t=this.maxIntervals/2;for(let n=0;n<t;n++){const t=2*n,i=2*n+1;this.intervalBytesSent[n]=this.intervalBytesSent[t]+this.intervalBytesSent[i],this.intervalBytesReceived[n]=this.intervalBytesReceived[t]+this.intervalBytesReceived[i],this.intervalLatencyMin[n]=e(this.intervalLatencyMin[t],this.intervalLatencyMin[i],Math.min),this.intervalLatencyMax[n]=e(this.intervalLatencyMax[t],this.intervalLatencyMax[i],Math.max),this.intervalLatencySum[n]=this.intervalLatencySum[t]+this.intervalLatencySum[i];const s=this.intervalLatencyCount[t]+this.intervalLatencyCount[i];this.intervalLatencyCount[n]=s,this.intervalLatencyAvg[n]=0===s?0:this.intervalLatencySum[n]/this.intervalLatencyCount[n]}this.intervalBytesSent.fill(0,t,this.maxIntervals),this.intervalBytesReceived.fill(0,t,this.maxIntervals),this.intervalLatencyMin.fill(0,t,this.maxIntervals),this.intervalLatencyMax.fill(0,t,this.maxIntervals),this.intervalLatencySum.fill(0,t,this.maxIntervals),this.intervalLatencyCount.fill(0,t,this.maxIntervals),this.intervalLatencyAvg.fill(0,t,this.maxIntervals),this.intervalMs*=2}dispose(){this.disposed=!0,this.updateSemaphore.tryRelease()}export(){const t=e=>Math.max(0,Math.ceil(Math.log2(Math.max(...e)/255))),n=(e,t)=>Math.round(e/Math.pow(2,t)),i=e.alloc(3+5*(2+this.intervalCount)),s=Math.log2(this.interval/o.initialInterval);i[0]=1,i[1]=5,i[2]=s,i[3]=t(this.latencyMinMs),i[4]=t(this.latencyMaxMs),i[5]=t(this.latencyAverageMs),i[6]=t(this.bytesSent),i[7]=t(this.bytesReceived),i[8]=a.latencyMin,i[9]=a.latencyMax,i[10]=a.latencyAverage,i[11]=a.bytesSent,i[12]=a.bytesReceived;for(let e=0;e<this.intervalCount;e++){const t=13+5*e;i[t+0]=n(this.intervalLatencyMin[e],i[3]),i[t+1]=n(this.intervalLatencyMax[e],i[4]),i[t+2]=n(this.intervalLatencyAvg[e],i[5]),i[t+3]=n(this.intervalBytesSent[e],i[6]),i[t+4]=n(this.intervalBytesReceived[e],i[7])}return i.toString("base64")}static import(t){const n=e.from(t,"base64");if(n.length<3)throw new Error("Invalid session contour string.");const i=n[0],s=n[1],r=n[2];if(1!==i)throw new Error(`Unsupported session contour version: ${i}`);const c=(n.length-3)/s-2;if(c<1||n.length!==3+s*(c+2))throw new Error("Incomplete session contour string.");const l=Math.pow(2,Math.ceil(Math.log2(c))),u=new o(l);u.intervalMs=Math.pow(2,r)*o.initialInterval,u.count=c;const d=new Array(s);for(let e=0;e<s;e++)d[e]=Math.pow(2,n[3+e]);const h=new Array(s);for(let e=0;e<s;e++)h[e]=n[3+s+e];for(let e=0;e<c;e++){const t=3+(2+e)*s;for(let i=0;i<s;i++)switch(h[i]){case a.latencyMin:u.intervalLatencyMin[e]=n[t+i]*d[i];break;case a.latencyMax:u.intervalLatencyMax[e]=n[t+i]*d[i];break;case a.latencyAverage:u.intervalLatencyAvg[e]=u.intervalLatencySum[e]=n[t+i]*d[i],u.intervalLatencyCount[e]=0===n[t+i]?0:1;break;case a.bytesSent:u.intervalBytesSent[e]=n[t+i]*d[i];break;case a.bytesReceived:u.intervalBytesReceived[e]=n[t+i]*d[i]}}return u}}var a;t.SessionContour=o,o.initialInterval=1e3,function(e){e[e.none=0]="none",e[e.latencyMin=1]="latencyMin",e[e.latencyMax=2]="latencyMax",e[e.latencyAverage=3]="latencyAverage",e[e.bytesSent=11]="bytesSent",e[e.bytesReceived=12]="bytesReceived"}(a||(a={}))}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultiChannelStream=void 0;const i=n(8),s=n(46),r=n(487),o=n(142),a=n(140),c=n(54),l=n(144);t.MultiChannelStream=class{constructor(e){if(this.transportStream=e,this.disposed=!1,this.disposables=[],this.closedEmitter=new i.Emitter,this.onClosed=this.closedEmitter.event,this.channelOpeningEmitter=new i.Emitter,!e)throw new TypeError("transportStream is required.");const t=new a.SshSessionConfiguration(!1);this.session=new o.SshSession(t),this.session.onClosed(this.onSessionClosed,this,this.disposables),this.session.onChannelOpening(this.onSessionChannelOpening,this,this.disposables)}get isClosed(){return this.disposed||this.session.isClosed}get onChannelOpening(){return this.isClosed||this.session.activateService(l.ConnectionService),this.channelOpeningEmitter.event}async connect(e){await this.session.connect(this.transportStream,e)}async acceptChannel(e,t){return await this.session.connect(this.transportStream,t),await this.session.acceptChannel(e,t)}async acceptStream(e,t){return new r.SshStream(await this.acceptChannel(e,t))}async openChannel(e,t){return await this.session.connect(this.transportStream,t),await this.session.openChannel(null!=e?e:null,t)}async openStream(e,t){return new r.SshStream(await this.openChannel(e,t))}async connectAndRunUntilClosed(e){const t=[],n=new Promise((n,i)=>{null==e||e.onCancellationRequested(i,null,t),this.session.onClosed(n,null,t)});try{await this.connect(e),await n}finally{t.forEach(e=>e.dispose()),await this.close()}}dispose(){if(!this.disposed){this.disposed=!0,this.session.dispose(),this.unsubscribe();try{this.transportStream&&this.transportStream.close().catch(e=>{(0,s.trace)("Error closing transport stream: "+e.message)})}catch(e){if(!(e instanceof Error))throw e;(0,s.trace)("Error closing transport stream: "+e.message)}}}async close(){this.disposed||(this.disposed=!0,await this.session.close(c.SshDisconnectReason.none,"SshSession disposed"),this.session.dispose(),this.unsubscribe(),await this.transportStream.close())}onSessionClosed(e){this.unsubscribe(),this.closedEmitter.fire(e)}onSessionChannelOpening(e){this.channelOpeningEmitter.fire(e)}unsubscribe(){this.disposables.forEach(e=>e.dispose()),this.disposables=[]}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(64),s=n(8),r=n(475);t.createSshRpcMessageStream=function(e,t,n,s,a){const c=new o(e,t,n,a||i.SequenceRelayDataHubProxy.createForTypeAndParticipant(e,t,n),s);return new r.SshRpcMessageStream(c)};class o{constructor(t,n,r,o,a){this.relayHubProxy=t,this.streamId=n,this.targetParticipant=r,this.closeOnError=a,this.dataReceivedEmitter=new s.Emitter,this.nextSequence=0,this.disposables=[],this.onDataReceived=this.dataReceivedEmitter.event,this.closedEmitter=new s.Emitter,this.onClosed=this.closedEmitter.event,this.disposables.push(o),this.disposables.push(o.onReceiveData(t=>(this.dataReceivedEmitter.fire(e.from(t.data)),Promise.resolve()))),this.disposables.push(t.onParticipantChanged(e=>(e.changeType===i.ParticipantChangeType.Removed&&e.participant.id===this.targetParticipant&&this.fireError(new Error(`participant id:${e.participant.id} removed`)),Promise.resolve()))),this.disposables.push(t.onDisconnected(async()=>(this.fireError(new Error("hub proxy disconnected")),Promise.resolve())))}dispose(){this.disposables.forEach(e=>e.dispose()),this.disposables=[]}async send(e,t){await this.relayHubProxy.sendData(i.SendOption.ExcludeSelf,[this.targetParticipant],this.streamId,e,i.RelayHubMessageProperties.createMessageSequence(++this.nextSequence))}adjustWindow(e){}fireError(e){this.closedEmitter.fire({error:e}),this.closeOnError&&this.closedEmitter.fire({})}}}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6);t.HubProxyUtils=class{static async waitForConnection(e,t){if(!e.isConnected){const n=new i.Signal(t),s=e.onConnectionStateChanged(()=>(e.isConnected&&n.resolve(!0),Promise.resolve()));await n.promise,s.dispose()}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(20),s=n(64),r=n(8),o=n(106);t.createRelayHubEventNotifier=function(e,t){let n=0;const a=t||o.DATA_TYPE_LIVESHARE_HUB,c=new i.RpcMessageWriter;e.onHubJoined(e=>{e?c.onSendCallback=async t=>{await e.sendData(s.SendOption.None,null,`${a}${o.POST_FIX_NOTIFY}`,t,s.RelayHubMessageProperties.createMessageSequence(++n))}:(n=0,c.onSendCallback=null)});const l=r.createMessageConnection({},c);return(e,t)=>l.sendNotification(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8),s=n(273),r=n(488),o=n(106),a=n(6);t.createRelayHubProxyServerProvider=function(e,t,n,c){const l=new i.Emitter,u=new r.RelayHubProxyServer(e,t,n),d=u.onParticipantJoined(e=>{const t=new s.HubStream(e.relayHubProxy,c||o.DATA_TYPE_LIVESHARE_HUB,e.participant.id);l.fire(t)});let h=new a.Signal;const f={name:"signalR",ready:h.promise,onRpcStreamJoined:l.event,acceptConnections:e=>u.acceptConnections(e),dispose:async()=>{if(d.dispose(),p.dispose(),e.hubProxy.isConnected){n.info(`deleting hub:${t}`);try{await e.deleteHub(t)}catch(e){n.error(`Failed to delete hub id:${t}`,e)}}}},p=u.onHubJoined(e=>{e?h.resolve():(h=new a.Signal,f.ready=h.promise)});return f}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(20),s=n(64),r=n(8),o=n(273),a=n(469),c=n(106);t.RpcUtils=class{static createRpcClient(e,t,n,l,u){return u=u||a.HubStreamUtils.getHostParticipant,new i.RpcClient({create:async i=>{await e.hubProxy.connect();const a=await e.joinHub(t,null,{}),d=u(a).id,h=l||c.DATA_TYPE_LIVESHARE_HUB,f=s.SequenceRelayDataHubProxy.createForTypeAndParticipant(a,h,d);s.SequenceRelayDataHubProxy.createForTypeAndParticipant(a,`${h}${c.POST_FIX_NOTIFY}`,d,-1).onReceiveData(e=>f.fireReceivedData(e));const p=o.createSshRpcMessageStream(a,h,d,!0,f),m=r.createMessageConnection(p.reader,p.writer);return m.listen(),await a.sendData(s.SendOption.None,[d],c.DATA_TYPE_JOINED_READY,null),n.verbose(`successfully joined rpc session on hubId:${t} host id:${d}`),m}},n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startLocalWorkspaceHubService=async function(e,t){throw new Error("Local workspace hub service not supported on the browser")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e,t){super(e),this.argumentName=t}}t.ArgumentError=i;t.Requires=class{static Argument(e,t,n){if(!e)throw new i(n,t)}static NotNullOrUndefined(e,t){if(!e)throw new i("Parameter "+t+" is required",t);return e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(67),s=n(0),r=n(7),o=n(1130),a=n(8),c=n(6),l=n(9),u=n(5),d=n(68),h=n(26);t.SearchProvider=class{constructor(e){this.fileservice=e.fileService(),this.fileSearchOptionsMap=new Map,this.fileListMap=new Map,this.fileservice.onFilesChanged(e=>this.onFilesChanged(e)),this.trace=r.traceSource.withName(u.vsls.TraceSources.AgentFile),this.pathManager=e.pathManager()}async onFilesChanged(e){for(let t of e.changes)await this.updateList(t)}async updateList(e){if(!e.fullPath)return;const{moniker:t}=d.PathUtil.getMonikerFromRelativePath(e.fullPath),n=d.PathUtil.getRelativePathFromPrefixedPath(e.fullPath),i=d.PathUtil.getPrefixedRoot(t);let s=await this.getCachedList(i);switch(s||(s=[]),e.changeType){case u.vsls.FileChangeType.Deleted:let e=s?s.indexOf(n):-1;if(-1===e)break;s.splice(e,1);break;case u.vsls.FileChangeType.Added:const t=this.fileSearchOptionsMap.get(i);if(!t)break;let r={excludePatterns:t.excludes,enableMultipleRoots:!0};await this.fileservice.isExcludedAsync(n,r)||s.push(n)}this.fileListMap.set(i,Promise.resolve(s))}async getFiles(e,t){try{const n=[e.folder.path],i={excludePatterns:e.excludes,enableMultipleRoots:!0,includePatterns:n},s=await this.fileservice.getFilesAsync(i,t);return o.FileSearchTelemetry.sendFindFileDiagnostics(s.length,!!e.useIgnoreFiles),s}catch(e){this.trace.error(e),l.Telemetry.sendFault(o.SearchServiceTelemetryEventNames.FIND_FILE_FAULT,l.FaultType.Error,"Failed to get files from host",e)}}getCachedList(e){const t=this.fileListMap.get(e);if(t)return t}async getFileResults(e,t){const n=e.folder.path;let i;const s=this.fileListMap.get(n);if(s&&(i=await s),!i||!this.fileSearchOptionsMap.has(n)){const s=new c.Signal;try{this.fileListMap.set(n,s.promise),i=await this.getFiles(e,t),s.resolve(i)}catch(e){throw this.fileListMap.delete(n),s.reject(e),e}this.fileSearchOptionsMap.set(n,e)}return i}async provideFileSearchResults(e,t,n){const i=await this.getFileResults(e,n);i&&i.forEach(e=>t.report(e))}async provideFileIndex(e,t){const n=await this.getFileResults(e,t);if(n){return n.map(e=>this.pathManager.relativePathToLocalPath(e))}return[]}toVsCodeTextSearchResult1(e){return{uri:this.pathManager.relativePathToLocalPath(e.path),ranges:e.ranges?e.ranges.map(e=>new s.Range(e.line,e.column,e.endLine,e.endColumn)):[],preview:{text:e.text,matches:e.previewRanges?e.previewRanges.map(e=>new s.Range(e.line,e.column,e.endLine,e.endColumn)):[]}}}toVsCodeTextSearchResult2(e){return{uri:this.pathManager.relativePathToLocalPath(e.path),ranges:[new s.Range(e.line,e.column,e.line,e.column+e.length)],preview:{text:e.text,matches:[new s.Range(0,e.column,0,e.column+e.length)]}}}toVsCodeTextSearchResult3(e){return{uri:this.pathManager.relativePathToLocalPath(e.path),range:new s.Range(e.line,e.column,e.line,e.column+e.length),preview:{text:e.text,match:new s.Range(0,e.column,0,e.column+e.length)}}}toVslsTextSearchOptions(e,t){return{pattern:e.pattern,isRegex:e.isRegExp,isCaseSensitive:e.isCaseSensitive,isWordMatch:e.isWordMatch,includeHiddenFiles:t.useIgnoreFiles,encoding:t.encoding,fileIncludes:t.includes,fileExcludes:t.excludes}}async provideTextSearchResults(e,t,n,r){let c=this.toVslsTextSearchOptions(e,t);const l=new o.TextSearchTelemetry;l.startTextSearch();let u=[],d=!1,f=0,p=!1,m=!1,g={report:e=>{d||(d=!0,l.saveFirstResultTime());try{i.gte(s.version,"1.29.0")?e.ranges&&e.previewRanges?(m=!0,n.report(this.toVsCodeTextSearchResult1(e))):m||n.report(this.toVsCodeTextSearchResult2(e)):i.gte(s.version,"1.26.0")&&n.report(this.toVsCodeTextSearchResult3(e)),f++}catch(e){}!0===e.hitResultsLimit&&(p=!0)}};try{try{await this.fileservice.getTextSearchResultsWithProgressAsync(c,g,r),l.saveTextSearchResults(f)}catch(e){e.code===a.ErrorCodes.MethodNotFound&&(u=await this.fileservice.getTextSearchResultsAsync(c,r),i.gte(s.version,"1.29.0")?u.forEach(e=>{n.report(this.toVsCodeTextSearchResult1(e))}):i.gte(s.version,"1.26.0")&&u.forEach(e=>{n.report(this.toVsCodeTextSearchResult3(e))})),u.length>0&&u[u.length-1].hitResultsLimit&&(p=!0),l.saveTextSearchResults(u.length)}}catch(e){return{limitHit:p}}return l.send(),i.gte(s.version,"1.28.0")||p&&s.window.showInformationMessage(h.localize("info.SearchResultsLimited")),{limitHit:p}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(9),s=n(16);class r{static sendFindFileDiagnostics(e,t){const n=new i.TelemetryEvent(a.FIND_FILE);n.addMeasure(c.FILE_COUNT,e),n.addProperty(c.USE_IGNORE_FILES,t),n.send()}}t.FileSearchTelemetry=r,r.PROPERTY_PREFIX=s.TelemetryPropertyNames.FEATURE_NAME+"Search.";class o{startTextSearch(){this.textSearchEvent=i.Telemetry.startTimedEvent(a.TEXT_SEARCH)}saveFirstResultTime(){this.textSearchEvent.markTime(c.FIRST_RESULT_TIME)}saveTextSearchResults(e){this.textSearchEvent.addMeasure(c.RESULTS_COUNT,e),this.textSearchEvent.markTime(c.RESULTS_RECEIVED_TIME)}send(){this.textSearchEvent.send()}}t.TextSearchTelemetry=o,o.PROPERTY_PREFIX=s.TelemetryPropertyNames.FEATURE_NAME+"Search.";class a{}t.SearchServiceTelemetryEventNames=a,a.FIND_FILE_FAULT="find-file-fault",a.FIND_FILE="find-file",a.TEXT_SEARCH="find-text";class c{}c.FILE_COUNT=r.PROPERTY_PREFIX+"FileCount",c.USE_IGNORE_FILES=r.PROPERTY_PREFIX+"UseIgnoreFiles",c.RESULTS_RECEIVED_TIME=o.PROPERTY_PREFIX+"ResultsReceivedTime",c.RESULTS_COUNT=o.PROPERTY_PREFIX+"ResultsCount",c.FIRST_RESULT_TIME=o.PROPERTY_PREFIX+"FirstResultTime"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6),s=n(9),r=n(22),o=n(16),a=n(5);let c;t.reconnectHostCallback=function(e,t){if(e){c.resolve();const e=new s.TelemetryEvent(o.TelemetryEventNames.REPORT_AGENTPROGRESS,!0);e.addProperty(o.TelemetryPropertyNames.EVENT_MESSAGE,a.vsls.WorkspaceProgress.ReconnectedToHost),e.addMeasure(o.TelemetryPropertyNames.PROGRESS_DURATION,t),e.send()}else{c=new i.Signal,r.ExtensionUtil.runWithProgress(async()=>{await c.promise},{title:r.ExtensionUtil.getProgressUpdateString(a.vsls.WorkspaceProgress.ReconnectingToHost)});const e=new s.TelemetryEvent(o.TelemetryEventNames.REPORT_AGENTPROGRESS,!0);e.addProperty(o.TelemetryPropertyNames.EVENT_MESSAGE,a.vsls.WorkspaceProgress.ReconnectingToHost),e.addMeasure(o.TelemetryPropertyNames.PROGRESS_DURATION,t),e.send()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(167),s=[];t.recordTerminalActivities=function(e){s.push(e.onTerminalStarted(e=>{i.activitySource.fire({timestamp:new Date,name:`${i.ActivityType.terminal}/share`,data:{name:e.terminal.options.name,readOnly:e.terminal.options.readOnlyForGuests}})})),s.push(e.onTerminalStopped(e=>{i.activitySource.fire({timestamp:new Date,name:`${i.ActivityType.terminal}/unshare`,data:{name:e.terminal.options.name,readOnly:e.terminal.options.readOnlyForGuests}})})),s.push(e.onTerminalReadOnlyChanged(e=>{i.activitySource.fire({timestamp:new Date,name:`${i.ActivityType.terminal}/changeAccess`,data:{name:e.terminal.options.name,readOnly:e.terminal.options.readOnlyForGuests}})}))},t.disposeActivityListeners=function(){for(let e of s)e.dispose()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(5),r=n(29),o=n(264),a=n(13),c=n(15),l=n(16),u=n(9),d=n(7);t.initInviteLinkSupport=function(e){e.addListener(o.ContactManagerEvents.InviteLinkReceived,async t=>{await async function(e,t,n){var o;if(r.workspaceSessionInfoTracker.workspaceSessionInfo&&r.workspaceSessionInfoTracker.workspaceSessionInfo.joinUri===t.link)return void(null==n||n.verbose(`Invite link received for uri:${t.link} but already joined`));const d=async n=>{await e.fireInviteStatusChanged(t.originator.contact.id,t.provider.selfUserId,n)},h=t.originator.contact.id===t.provider.selfUserId;if(e.isDoNotDisturbState&&!h)return void await d(s.vsls.InviteContactStatus.Dismissed);await d(s.vsls.InviteContactStatus.Invited);const f=new u.TelemetryEvent(l.TelemetryEventNames.SHOW_LINK_INVITE_TOAST);f.send();const p={id:1,title:"Accept"};let m=[p];const g=null===(o=t.originator)||void 0===o?void 0:o.contact,y=g.displayName||g.DisplayName||"Unknown User",v=await i.window.showInformationMessage(`${y} invited you to join a collaboration session`,...m),S=new u.TelemetryEvent(l.TelemetryEventNames.RESPOND_TOAST);if(S.correlateWith(f),S.addProperty(l.TelemetryPropertyNames.TOAST_RESULT,null==v?void 0:v.title),S.send(),v&&v.id===p.id){await d(s.vsls.InviteContactStatus.Joining);const e={targetContactId:t.originator.contact.id,fromContactId:t.provider.selfUserId},n={newWindow:!1,link:t.link,inviteLinkJoining:e};await i.commands.executeCommand(`${a.Settings.get(c.SettingKeys.commandPrefix)}.join`,n)}else await d(s.vsls.InviteContactStatus.Dismissed)}(e,t,d.traceSource)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(489));var i=n(1135);t.FileService=i.FileService;var s=n(1136);t.SourceEventService=s.SourceEventService;var r=n(1137);t.WorkspaceService=r.WorkspaceService;var o=n(1142);t.WorkspaceUserService=o.WorkspaceUserService;var a=n(1143);t.WorkspaceAccessControlService=a.WorkspaceAccessControlService;var c=n(1144);t.AccessControlService=c.AccessControlService},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(49),r=n(5),o=n(20),a=n(50),c=n(68),l=n(489);function u(e){const t=(e=i.Uri.parse(e).path).substr(e.lastIndexOf("/")+1);return`${a.PathManager.externalPrefix}/${s()}/${t}`}class d extends l.TextSearchService{constructor(e,t,n,s,o,a){super(n,o),this.rpcServiceHandler=e,this.workspaceService=t,this.clientAccessCheck=s,this.hostSessionId=a,this.disposables=[],this.localPathsToVslsPaths=new Map,this.vslsPathsToLocalPaths=new Map,this.serviceInfo=r.vsls.FileService,this.contextMethods=["registerExternalFiles","writeText","createDirectory","delete","move"],this.onFilesChangedEmitter=new i.EventEmitter,this.onFilesChanged=this.onFilesChangedEmitter.event,this.onRootsChangedEmitter=new i.EventEmitter,this.onRootsChanged=this.onRootsChangedEmitter.event,this.onExternalFilesChangedEmitter=new i.EventEmitter,this.onExternalFilesChanged=this.onExternalFilesChangedEmitter.event}getLocalUri(e){let t;if(function(e){return e.startsWith(a.PathManager.externalPrefix)&&e.length>a.PathManager.externalPrefix.length+1}(e)){if(!this.vslsPathsToLocalPaths.has(e))throw new Error("External file has not been registered");const n=this.vslsPathsToLocalPaths.get(e);t=i.Uri.parse(n)}else t=i.Uri.joinPath(i.workspace.workspaceFolders[0].uri,e);return t}async init(){await this.workspaceService.registerServicesAsync([r.vsls.FileService.name],r.vsls.CollectionChangeType.Add),this.disposables.push(this.rpcServiceHandler.registerRpcService(this,this.serviceInfo,this.contextMethods))}async registerExternalFilesAsync(e,t,n,i){if(this.hostSessionId&&(null==i?void 0:i.session)!==this.hostSessionId)throw new Error("Invalid rpc request. This method is allowed only by the host session");if(void 0===this.hostSessionId&&t)throw new Error("Cannot register external files");const s=[],o=[];for(let t of e)if(!this.localPathsToVslsPaths.has(t)){const e=c.PathUtil.normalizePath(t),n=u(e);this.localPathsToVslsPaths.set(t,n),this.vslsPathsToLocalPaths.set(n,t),s.push(e),o.push(n)}return s.length>0&&this.onExternalFilesChangedEmitter.fire({changeType:r.vsls.CollectionChangeType.Add,localPaths:s,vslsPaths:o}),e.map(e=>this.localPathsToVslsPaths.get(e))}async listRootsAsync(e,t){const n=[];if(void 0!==i.workspace.workspaceFolders)for(const e of i.workspace.workspaceFolders){const t={fullPath:e.uri.toString(),path:"/",friendlyName:e.name};n.push(t)}return n}async listAsync(e,t,n){const s=[];for(const t of e){const e=this.getLocalUri(t);let n;try{n=await i.workspace.fs.stat(e)}catch(e){}const r=[];if((null==n?void 0:n.type)===i.FileType.Directory){const t=await i.workspace.fs.readDirectory(e);for(const n of t){const t={path:i.Uri.joinPath(e,n[0]).path,exists:!0,isDirectory:n[1]===i.FileType.Directory};r.push(t)}}const o={path:t,exists:void 0!==n,isDirectory:(null==n?void 0:n.type)===i.FileType.Directory,hasChildren:0!==r.length,children:r};s.push(o)}return s}async readTextAsync(e,t,n){try{const t=this.getLocalUri(e);return{path:e,text:(await i.workspace.fs.readFile(t)).toString()}}catch(t){if("FileNotFound"===(null==t?void 0:t.code))return{path:e,exists:!1};throw t}}async readTextWithProgressAsync(e,t,n,i){const s=await Promise.all(e.map(e=>this.readTextAsync(e,t,i))),r=[];let a=0,c=0,l=[];const u=()=>{l.length>0&&n.report({results:l})};return s.forEach(e=>{var t,n;0===a?r.push(e):l.push(e),c+=null!==(n=null===(t=e.text)||void 0===t?void 0:t.length)&&void 0!==n?n:0,c>o.rpcMaxMessageSize&&(++a,u(),c=0,l=[])}),u(),r}async writeTextAsync(e,t,n,s,r){if(await this.clientAccessCheck().isClientReadOnly(s))throw new Error("Read-only clients cannot create files");const o=this.pathManager.relativePathToLocalPath(e);return await i.workspace.fs.writeFile(o,(new TextEncoder).encode(t)),{path:e}}async createDirectoryAsync(e,t,n){if(await this.clientAccessCheck().isClientReadOnly(t))throw new Error("Read-only clients cannot create directories");const s=this.pathManager.relativePathToLocalPath(e);return await i.workspace.fs.createDirectory(s),{path:e}}async deleteAsync(e,t,n,s){if(await this.clientAccessCheck().isClientReadOnly(n))throw new Error("Read-only clients cannot delete files");const r=this.pathManager.relativePathToLocalPath(e);try{await i.workspace.fs.delete(r,{useTrash:t.useTrash})}catch(e){await i.workspace.fs.delete(r)}}copyAsync(e,t,n,i){throw new Error("Method not implemented.")}async moveAsync(e,t,n,s,r){if(await this.clientAccessCheck().isClientReadOnly(s))throw new Error("Read-only clients cannot move files");const o=this.pathManager.relativePathToLocalPath(e),a=this.pathManager.relativePathToLocalPath(t);return await i.workspace.fs.rename(o,a,{overwrite:n.overwrite}),{path:t}}async getFilesAsync(e,t){return(await i.workspace.findFiles("**/*","{**/.git,**/.svn,**/.hg,**/CVS,**/.DS_Store,**/node_modules,**/bower_components,**/*.code-search}")).map(e=>this.pathManager.localPathToRelativePath(e))}async isExcludedAsync(e,t,n){return!1}async findFilesAsync(e,t,n){return[]}async clearRootsAsync(e){}addRootAsync(e,t){throw new Error("Method not implemented.")}removeRootAsync(e,t){throw new Error("Method not implemented.")}replaceRootAsync(e,t){throw new Error("Method not implemented.")}async dispose(){await this.workspaceService.registerServicesAsync([r.vsls.FileService.name],r.vsls.CollectionChangeType.Remove);for(const e of this.disposables)e.dispose();this.disposables=[]}}t.FileService=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(5);t.SourceEventService=class{constructor(){this.eventIds=new Map,this.sourceData=new Map,this.eventEmitter=new i.EventEmitter,this.serviceInfo=s.vsls.SourceEventService,this.onEvent=this.eventEmitter.event}async fireEventAsync(e,t,n){let i=1;if(this.eventIds.has(e)){i=this.eventIds.get(e)+1}this.eventIds.set(e,i);const s={eventId:i,sourceId:e,jsonContent:t};this.eventEmitter.fire(s)}setSourceDataAsync(e,t,n,i){return this.sourceData.set(e,t),n?this.fireEventAsync(e,t,i):Promise.resolve()}async getSourceDataAsync(e,t){return this.sourceData.get(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8),s=n(5),r=n(490),o=n(6);t.WorkspaceService=class{constructor(e,t,n,o,a){this.workspaceServer=e,this.workspaceUserService=t,this.workspaceAccessControlService=n,this.workspaceApi=o,this.logger=a,this.registerServiceNames=new Set,this.onServicesChangedEmitter=new i.Emitter,this.onConnectionStatusChangedEmitter=new i.Emitter,this.onProgressUpdatedEmitter=new i.Emitter,this.onUserRemovedEmitter=new i.Emitter,this.onUserBlockedEmitter=new i.Emitter,this.onWorkspaceReadyForConnectionEmitter=new i.Emitter,this.serviceInfo=s.vsls.WorkspaceService,this.onServicesChanged=this.onServicesChangedEmitter.event,this.onConnectionStatusChanged=this.onConnectionStatusChangedEmitter.event,this.onProgressUpdated=this.onProgressUpdatedEmitter.event,this.onUserRemoved=this.onUserRemovedEmitter.event,this.onUserBlocked=this.onUserBlockedEmitter.event,this.onWorkspaceReadyForConnection=this.onWorkspaceReadyForConnectionEmitter.event,e.onUserProfileChanged(e=>{if(e.changeType===r.UserProfileChangeType.Closed||e.changeType===r.UserProfileChangeType.Removed){const t=e.changeType===r.UserProfileChangeType.Removed?s.vsls.WorkspaceDisconnectedReason.Requested:void 0;this.workspaceUserService.notifyUserUnjoinedWorkspaceSession(e.sessionNumber,e.userProfile,t)}})}async registerServicesAsync(e,t,n){e.forEach(e=>{t===s.vsls.CollectionChangeType.Add?this.registerServiceNames.add(e):t===s.vsls.CollectionChangeType.Add&&this.registerServiceNames.delete(e)}),this.fireServicesChanged(e,t)}notiyServicesChanged(e,t){const n=new Set([...this.workspaceServer.serviceNames,...Array.from(this.registerServiceNames)]);n.delete(s.vsls.WorkspaceService.name),e.connection.sendNotification("workspace.servicesChanged",{serviceNames:[...n],changeType:t})}async joinWorkspaceAsync(e,t,n){o.assertDefined(n,"rpc request expected"),this.logger.info(`joinWorkspace joinInfo:${JSON.stringify(e)}`);const i=await this.workspaceServer.sharedWorkspace.getWorkspaceUserProfile(e.joiningUserSessionToken);i.clientCapabilities={extensionReadOnlySupport:!0,clientReadOnlySupport:!0},i.isAnonymous&&e.anonymousUserName&&(i.name=e.anonymousUserName);const r=n.session,a=n.connection;this.workspaceServer.addUserProfile(i,n),await this.workspaceUserService.addGuestOrThrowRejectionAsync(r,i,e.id,a),this.notiyServicesChanged(n,s.vsls.CollectionChangeType.Add);const c=this.workspaceServer.sharedWorkspace.workspaceInfo;return{sessionNumber:r,id:c.id,name:c.name,conversationId:c.conversationId,joinUri:c.joinLink,connectionMode:s.vsls.ConnectionMode.Relay,sessions:this.workspaceServer.joinedProfiles,accessControl:this.workspaceAccessControlService.accessControl}}unjoinWorkspaceAsync(e,t,n){o.assertDefined(n,"rpc request expected"),this.logger.info(`unjoinWorkspace workspaceId:${e}`),this.notiyServicesChanged(n,s.vsls.CollectionChangeType.Remove);const i=n.connection;return o.defer(async()=>{this.workspaceServer.removeUserProfile(i,r.UserProfileChangeType.Removed);try{await this.workspaceServer.closeSshSession(i)}catch(e){}},250),Promise.resolve()}getWorkspaceAsync(e,t){o.notImplemented()}listWorkspacesAsync(e,t){o.notImplemented()}createPersistentWorkspaceAsync(e,t,n){o.notImplemented()}deleteWorkspaceAsync(e,t){o.notImplemented()}renameWorkspaceAsync(e,t,n){o.notImplemented()}shareWorkspaceAsync(e,t){o.notImplemented()}async createInvitationLinkAsync(e,t){return(await this.workspaceApi.createInvitationLink(e)).joinLink}getInvitationLinksAsync(e,t){o.notImplemented()}unshareWorkspaceAsync(e,t){o.notImplemented()}beginJoinWorkspaceAsync(e,t){o.notImplemented()}canUserShareWorkspaceAsync(e,t){o.notImplemented()}canUserHostWorkspaceAsync(e,t){o.notImplemented()}createPublicInviteLinkAsync(e,t){o.notImplemented()}disconnectGuestAsync(e,t,n){o.notImplemented()}unjoinOnlineEnvironmentsGuestsAsync(e,t){o.notImplemented()}setWorkspaceReadyForConnectionAsync(e,t){o.notImplemented()}updateWorkspaceOwnerAsync(e,t,n,i){o.notImplemented()}fireServicesChanged(e,t){this.onServicesChangedEmitter.fire({serviceNames:e,changeType:t})}fireConnectionStatusChanged(e,t){this.onConnectionStatusChangedEmitter.fire({connectionStatus:e,disconnectedReason:t})}}},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=n(5),r=i(n(8)),o=n(491),a=n(6);var c;!function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Closed=3]="Closed"}(c=t.UserProfileChangeType||(t.UserProfileChangeType={}));class l extends o.SshRpcServer{constructor(e,t,...n){super(e.hostPrivateKeys,t),this.sharedWorkspace=e,this.joinedProfiles={},this.joinedRpcSessions=new Map,this.onUserProfileChangedEmitter=new r.Emitter,this.onUserProfileChanged=this.onUserProfileChangedEmitter.event,this.onUserAuthenticate(async n=>{let i=null;try{i=await e.getWorkspaceUserProfile(n)}catch(e){t.error("Failed to get user profile",e)}return i}),this.onSessionClosed(e=>this.removeUserProfile(e,c.Closed));const i=e.workspaceInfo,o={joinWorkspaceAsync:async(t,n,r)=>{a.assertDefined(r,"rpc request expected");const o=await e.getWorkspaceUserProfile(t.joiningUserSessionToken),c=r.session;return this.addUserProfile(o,r),{sessionNumber:c,id:i.id,name:i.name,conversationId:i.conversationId,joinUri:i.joinLink,connectionMode:s.vsls.ConnectionMode.Relay,sessions:this.joinedProfiles,accessControl:{defaultAccessControl:{isReadOnly:!1},userAccessControl:{}}}},unjoinWorkspaceAsync:(e,t,n)=>{const i=n.connection;return a.defer(async()=>{await this.closeSshSession(i)},5),Promise.resolve()}};this.registerRpcService(o,s.vsls.WorkspaceService,void 0,!1);const l={exchangeVersionsAsync:(e,t,n)=>Promise.resolve({version:"1.0"})};this.registerRpcService(l,s.vsls.ConfigurationService,void 0,!1),n.forEach(e=>this.registerRpcService(e[0],e[1]))}get userProfiles(){return this.joinedProfiles}addUserProfile(e,t){const n=t.session;this.trace.info(`Adding user name:'${e.userName}' with session number ${n}`),this.joinedRpcSessions.set(t.connection,n),this.joinedProfiles[n]=e,this.onUserProfileChangedEmitter.fire({sessionNumber:n,changeType:c.Added,userProfile:e})}removeUserProfile(e,t){const n=this.joinedRpcSessions.get(e);if(n)return this.joinedRpcSessions.delete(e),[n,this.removeJoinedProfile(n,t)]}removeJoinedProfile(e,t){const n=this.joinedProfiles[e];if(n)return this.trace.info(`Removing user ${n.name} with session number ${e}`),delete this.joinedProfiles[e],this.onUserProfileChangedEmitter.fire({sessionNumber:e,changeType:t,userProfile:n}),n}}t.WorkspaceServer=l},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=n(20),r=n(6),o=i(n(43)),a=n(6),c=i(n(8));class l extends s.RpcServer{constructor(e,t){super(t),this.sshPrivateKeys=e,this.rpcServerProviders=[],this.reconnectableSessions=[],this.rpcSessions=new Map,this.onSessionClosedEmitter=new c.Emitter,this.onUserAuthenticateCallbacks=new a.CallbackContainer,this.sshServerSessionNumber=0,this.onSessionClosed=this.onSessionClosedEmitter.event}dispose(e){return this.reconnectableSessions.forEach(e=>e.dispose()),super.dispose(e)}async acceptConnections(e){await Promise.all(this.rpcServerProviders.map(t=>t.acceptConnections(e)))}registerRpcServerProvider(e){this.rpcServerProviders.push(e);const t=e.onRpcStreamJoined(t=>{this.acceptRpcStream(e.name,t).catch(e=>{this.trace.error("Failed to accept rpc stream",e)})});return{dispose:async()=>{this.trace.info(`unregister rpc server provider:${e.name}`),t.dispose();const n=this.rpcServerProviders.indexOf(e);-1!==n&&this.rpcServerProviders.splice(n,1),"function"==typeof e.dispose&&(this.trace.verbose(`dispose rpc server provider:${e.name}`),await e.dispose())}}}onUserAuthenticate(e){return this.onUserAuthenticateCallbacks.add(e)}async closeSshSession(e){const t=this.rpcSessions.get(e);t&&await t.close(o.SshDisconnectReason.byApplication)}async acceptRpcStream(e,t){const n=await async function(e,t,n,i,s){n.verbose("Created socket stream");const r=await function(e){const t=new o.SshSessionConfiguration;return t.keyExchangeAlgorithms.splice(0),t.keyExchangeAlgorithms.push(o.SshAlgorithms.keyExchange.ecdhNistp384Sha384),t.keyExchangeAlgorithms.push(o.SshAlgorithms.keyExchange.ecdhNistp256Sha256),t.keyExchangeAlgorithms.push(o.SshAlgorithms.keyExchange.dhGroup14Sha256),t.protocolExtensions.push(o.SshProtocolExtensionNames.sessionReconnect),t.protocolExtensions.push(o.SshProtocolExtensionNames.sessionLatency),new o.SshServerSession(t,e)}(s);n.verbose("created SSH server session"),r.credentials={publicKeys:t},r.onAuthenticating(e=>{const t=e.password;n.verbose("authenticating request"),null!==t&&(e.authenticationPromise=i(t))}),r.onChannelOpening(e=>{void 0===r.principal&&(n.error("unauthenticated request"),e.failureReason=o.SshChannelOpenFailureReason.administrativelyProhibited,e.failureDescription="Not authenticated")});const a=r.onChannelOpening(e=>{e.channel.onRequest(e=>{e.isAuthorized="json-rpc"===e.requestType,n.info("rpc channel opening request "+e.requestType),a.dispose()})});await r.connect(e),n.verbose("connected to server session");const c=await r.acceptChannel();return n.verbose(`opened channel ${c.channelId}`),c}(t,this.sshPrivateKeys,this.trace,async e=>{for(const t of this.onUserAuthenticateCallbacks.items){const n=await t(e);if(void 0!==n)return n}},this.reconnectableSessions),i=++this.sshServerSessionNumber;this.trace.verbose(`Created ssh server session:${i} for provider:${e}`);const s=n.session;let a;const c=e=>{this.trace.verbose(`ssh server session:${i} closed reason:${e}`),this.onSessionClosedEmitter.fire(a),this.rpcSessions.delete(a)};s.onDisconnected(async e=>{this.trace.info(`Disconnected server session:${i} waiting to reconnect.`);let t=!1;s.onReconnected(e=>{this.trace.info(`Reconnected server session:${i}`),t=!0}),await r.wait(6e4),t||(this.trace.info(`Closing disconnected server session:${i} because the client `+"has not reconnected within the timeout."),await s.close(o.SshDisconnectReason.connectionLost),c(o.SshDisconnectReason.connectionLost))});const l=new o.SshRpcMessageStream(n);a=this.acceptRpcMessageStream(l)[0],a.listen(),this.rpcSessions.set(a,s),s.onClosed(e=>c(e.reason))}}t.SshRpcServer=l},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=n(20),r=i(n(43)),o=i(n(8));class a extends s.RpcServer{constructor(){super(...arguments),this.acceptedStreams=new Map,this.onRpcConnectionDisposedEmitter=new o.Emitter,this.onRpcConnectionDisposed=this.onRpcConnectionDisposedEmitter.event}async acceptStream(e){const t=new r.MultiChannelStream(e),n=await t.acceptChannel(),i=new r.SshRpcMessageStream(n),s=this.acceptRpcMessageStream(i),o=s[0];this.acceptedStreams.set(o,t);const a=e.closed(()=>{a.dispose(),o.dispose()});return o.onDispose(async t=>{a.dispose(),this.acceptedStreams.delete(o),this.onRpcConnectionDisposedEmitter.fire(o),e.isDisposed||await e.close()}),s}getMultiChannelStream(e){return this.acceptedStreams.get(e)}}t.MultiChannelRpcServer=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(492),s=n(493);t.createDuplexMultiChannelRpcClient=async function(e,t){const[n,r]=i.createDuplexStreams(),o=e.acceptStream(n),a=s.createMultiChannelRpcClient(r,t),[c,l]=await Promise.all([o,a]);return c[0].listen(),l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8),s=n(5),r=n(6);class o{constructor(e,t,n,i,s){this.rpcSession=e,this.userProfile=t,this.joinId=n,this.resolveRequestPromise=i,this.rejectRequestPromise=s,this.blocked=!1,this.removed=!1,this.rejected=!1}block(){this.blocked=!0}remove(){this.removed=!0}reject(){this.rejected=!0}get isBlocked(){return this.blocked}get isRemoved(){return this.removed}get isRejected(){return this.rejected}}var a;!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.REJECTED=1]="REJECTED",e[e.CANCELLED=2]="CANCELLED"}(a||(a={}));function c(e,t,n){return e.isAnonymous?e.id===n.userProfile.id&&t==n.joinId:e.name==n.userProfile.name&&e.email==n.userProfile.email&&t==n.joinId}t.WorkspaceUserService=class{constructor(e){this.disconnect=e,this.onWorkspaceSessionChangedEmitter=new i.Emitter,this.serviceInfo=s.vsls.WorkspaceUserService,this.onWorkspaceSessionChanged=this.onWorkspaceSessionChangedEmitter.event,this.guestSessions=new Map}fireWorkspaceSessionChanged(e,t,n,i="VS Code",s){this.onWorkspaceSessionChangedEmitter.fire({changeType:e,sessionNumber:t,userProfile:n,applicationName:i,disconnectedReason:s})}acceptOrRejectGuestAsync(e,t,n){const s=this.guestSessions.get(e);return s&&(t.accept||"number"!=typeof t.errorCode||0===t.errorCode||s.rejectRequestPromise(new i.ResponseError(t.errorCode,t.message)),s.resolveRequestPromise(t.accept?a.SUCCESS:a.REJECTED)),Promise.resolve()}autoAcceptGuestsAsync(e,t){r.notImplemented()}removeUserAsync(e,t,n){const i=this.guestSessions.get(e);if(i){if(t==s.vsls.WorkspaceDisconnectedReason.SessionEnded){const e={connectionStatus:s.vsls.WorkspaceConnectionStatus.Disconnected,disconnectedReason:s.vsls.WorkspaceDisconnectedReason.SessionEnded};i.rpcSession.sendNotification(`${s.vsls.WorkspaceService.name}.connectionStatusChanged`,e)}else t==s.vsls.WorkspaceDisconnectedReason.UserBlocked?(i.block(),i.rpcSession.sendNotification(`${s.vsls.WorkspaceService.name}.userBlocked`)):(i.remove(),i.rpcSession.sendNotification(`${s.vsls.WorkspaceService.name}.userRemoved`));setTimeout(()=>this.disconnect(i.rpcSession),1e3)}}removeAllInteractiveUsersAsync(e){r.notImplemented()}fireProgressUpdatedToGuestAsync(e,t,n){const i=this.guestSessions.get(t);if(i){const t={progress:e,duration:0};i.rpcSession.sendNotification(`${s.vsls.WorkspaceService.name}.progressUpdated`,t)}return Promise.resolve()}getCountOfGuestsWithSameAccountAsync(e,t,n){r.notImplemented()}createGuestDisplayNameAsync(e,t){r.notImplemented()}getCachedGuestDisplayNameAsync(e,t){r.notImplemented()}getGuestUserProfileAsync(e,t){r.notImplemented()}getCountOfInteractiveGuestsAsync(e){r.notImplemented()}notifyUserUnjoinedWorkspaceSession(e,t,n){this.guestSessions.has(e)&&this.fireWorkspaceSessionChanged(s.vsls.WorkspaceSessionChangeType.Unjoined,e,t,"",n)}async addGuestOrThrowRejectionAsync(e,t,n,r){let c,l;const u=new Promise((e,t)=>{c=e,l=t}),d=new o(r,t,n,c,l);let h;this.guestSessions.set(e,d),this.throwIfUserIsBlocked(t,n),this.fireWorkspaceSessionChanged(s.vsls.WorkspaceSessionChangeType.Requested,e,t);try{h=await u}catch(n){throw this.cancelGuestJoin(e,t),n}if(h===a.REJECTED)throw d.reject(),new i.ResponseError(s.vsls.ErrorCodes.CollaborationSessionGuestRejected,"Rejected by host");if(h===a.CANCELLED)throw this.cancelGuestJoin(e,t),new i.ResponseError(s.vsls.ErrorCodes.CollaborationSessionGuestCanceled,"Join request canceled");h===a.SUCCESS&&this.fireWorkspaceSessionChanged(s.vsls.WorkspaceSessionChangeType.Joined,e,t)}cancelGuestJoin(e,t){this.fireWorkspaceSessionChanged(s.vsls.WorkspaceSessionChangeType.Canceled,e,t),this.guestSessions.delete(e)}throwIfUserIsBlocked(e,t){for(let n of this.guestSessions.values())if(c(e,t,n)&&(n.isBlocked||n.isRejected))throw new i.ResponseError(s.vsls.ErrorCodes.CollaborationSessionGuestBlocked,"Already blocked by host")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8),s=n(5),r=n(6),o=n(16),a=n(9),c=n(245),l={name:"setWorkspaceAccessControl",enabledInReadOnlySession:!0,ownerOnly:!0},u={name:"rejectRestrictedOperation",enabledInReadOnlySession:!0,ownerOnly:!0},d={name:"setRestrictedOperationAccess",enabledInReadOnlySession:!0,ownerOnly:!0};t.WorkspaceAccessControlService=class{constructor(e){this.userAccessControl={},this.defaultAccessControl={isReadOnly:!1},this.onAccessControlChangedEmitter=new i.Emitter,this.onOperationRejectedEmitter=new i.Emitter,this.onOperationAccessChangedEmitter=new i.Emitter,this.onOpeationAccessRequestedEmitter=new i.Emitter,this.serviceInfo=s.vsls.WorkspaceAccessControlService,this.onAccessControlChanged=this.onAccessControlChangedEmitter.event,this.onOperationRejected=this.onOperationRejectedEmitter.event,this.onOperationAccessChanged=this.onOperationAccessChangedEmitter.event,this.onOpeationAccessRequested=this.onOpeationAccessRequestedEmitter.event,this.operationAccessCheck=new h(this,e)}async setAccessControlAsync(e,t,n){r.assertDefined(n,"rpc request expected"),this.operationAccessCheck.verifyCanPerformOperation(n.session,l),this.userAccessControl=e.userAccessControl,this.defaultAccessControl=e.defaultAccessControl,this.onAccessControlChangedEmitter.fire({accessControl:e})}async requestOperationAccessAsync(e,t,n){new a.TelemetryEvent(o.TelemetryEventNames.REQUEST_RESTRICTED_OPERATION).addProperty(o.TelemetryPropertyNames.OPERATION_NAME,e.name).send(),this.onOpeationAccessRequestedEmitter.fire({sessionId:n.session,operation:e})}async setOperationAccessAsync(e,t,n,i){r.assertDefined(i,"rpc request expected"),this.operationAccessCheck.verifyCanPerformOperation(i.session,d),new a.TelemetryEvent(o.TelemetryEventNames.SET_RESTRICTED_OPERATION_ACCESS).addProperty(o.TelemetryPropertyNames.OPERATION_NAME,e.name).addProperty(o.TelemetryPropertyNames.OPERATION_ACCESS,t).send(),this.onOperationAccessChangedEmitter.fire({operation:e,access:t})}async rejectOperationAsync(e,t,n,i){r.assertDefined(i,"rpc request expected"),this.operationAccessCheck.verifyCanPerformOperation(i.session,u),this.onOperationRejectedEmitter.fire({operation:e,access:t})}get accessControl(){return{defaultAccessControl:this.defaultAccessControl,userAccessControl:this.userAccessControl}}async getAccessControlAsync(e){return this.accessControl}};class h extends c.ClientAccessCheck{get isReadOnly(){return!1}logRejectedOperation(e,t){return Promise.resolve()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(5),r=n(31),o=n(29),a=n(42);t.AccessControlService=class{constructor(e){var t,n;this.accessControlChangedEmitter=new i.EventEmitter,this.onAccessControlChanged=this.accessControlChangedEmitter.event,this.serviceInfo=s.vsls.AccessControlService;const c=o.workspaceSessionInfoTracker.workspaceSessionInfo;if(!c)throw Error("workspaceSessionInfoTracker.workspaceSessionInfo is not set");const l=null===(t=a.getExpService())||void 0===t?void 0:t.getTreatmentVariable("vscode","readWriteAnonymous"),u=l&&function(){const t=e.sessionContext().collaboratorManager;if(!t)return;const n=Object.values(null==t?void 0:t.getCollaborators()).find(e=>{var t;return e.id===(null===(t=r.userAuthStateTracker.userInfo)||void 0===t?void 0:t.id)});if(!n)return;return o.workspaceSessionInfoTracker.getAnonymousAccess(n.id)}()===o.AnonymousAccessLevel.readOnly,d=!l&&(null===(n=r.userAuthStateTracker.userInfo)||void 0===n?void 0:n.isAnonymous),h=c.accessControl,f=h.defaultAccessControl&&h.defaultAccessControl.isReadOnly,p=!!(d||f||u);this.sessionNumber=c.sessionNumber,this.accessControl=h.userAccessControl[c.sessionNumber]||{isReadOnly:p},this.setAccessControl(this.accessControl),e.workspaceAccessControlService().onAccessControlChanged(this.sessionAcs_AccessControlChanged,this)}getAccessControlAsync(){return Promise.resolve(this.accessControl)}setAccessControl(e){e.isReadOnly!=this.accessControl.isReadOnly&&(this.accessControl=e,this.accessControlChangedEmitter.fire({accessControl:e}))}sessionAcs_AccessControlChanged(e){const t=this.getUserAccessControl(e.accessControl);this.setAccessControl(t)}getUserAccessControl(e){return e.userAccessControl[this.sessionNumber]||e.defaultAccessControl}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(32),s=n(6),r=n(22),o=n(69),a=n(67),c=n(0),l=n(407),u=n(408);class d{constructor(){this.settings=null,this.updated=!1,this.updateSignal=new s.Signal}static get Instance(){return d.singleton||(d.singleton=new d),d.singleton}async init(e,t,n,s){if(!t)throw new Error("A settings URI is required.");this.settingsFileUri=i.parse(i.resolve(t.href,"remoteSettings.json")),this.settingsFileUri.path=(t.path+"/remoteSettings.json").replace("//","/"),this.extensionVersion=r.ExtensionUtil.getExtensionVersion(o.LIVESHARE_EXTENSION_ID,!1),this.settings=await l.loadFilefromCache(this.settingsFileUri.href),null==s||s.verbose(`Downloading remote settings from ${this.settingsFileUri.href}`);const a=await l.initRemoteFileSubscribe(e,this.settingsFileUri.href,e=>{this.loadDownloadedSettings(e)},n,s);e&&e.subscriptions.push(a)}loadDownloadedSettings(e){this.settings=e,this.updated||(this.updated=!0,this.updateSignal.resolve())}get waitForUpdate(){if(!this.settingsFileUri)throw new Error("Not initialized.");return this.updateSignal.promise}getDefault(e){return this.getSettingValue(e,"default")}getOverride(e){return this.getSettingValue(e,"override")}getSettingValue(e,t){if(!this.settings)return;let n=this.settings[e];if(n){Array.isArray(n)||(n=[n]);for(let e of n){if((e.priority||"default")===t&&this.evaluateConditions(e.conditions))return e.value}}}evaluateConditions(e){if(!e)return!0;if(e.os){const t=u.getPlatform().replace("win32","win").replace("darwin","mac");if(!(e.os===t||Array.isArray(e.os)&&e.os.indexOf(t)>=0))return!1}return!(e.extensionVersion&&!a.satisfies(this.extensionVersion,e.extensionVersion))&&!(e.ideVersion&&!a.satisfies(c.version,e.ideVersion))}}const h=d.Instance;t.RemoteConfig=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(288);t.registerGitProvider=function(e,t){try{const t=i.extensions.getExtension("vscode.git");if(t){const n=t.exports.getAPI(1);e("git",new r(n))}}catch(e){t.error(`Failed to register Git provider error:${e}`)}};class r extends s.ProviderBase{constructor(e){super(),this.api=e;const t=e._model.git;if("function"!=typeof t.exec)throw new Error("Missing Git exec function");this.gitPrivate=t}async requestInitialize(e){if(this.gitPrivate){const e=this.api.repositories;e.length>0?this.notifyRepoSuggestedUsers(e[0]):this.api.onDidOpenRepository(async e=>{this.notifyRepoSuggestedUsers(e)})}return{description:"Git",capabilities:{supportsDispose:!1,supportsInviteLink:!1,supportsPresence:!1,supportsContactPresenceRequest:!1,supportsPublishPresence:!1}}}async notifyRepoSuggestedUsers(e){this.getAuthors(e).then(e=>{this.notifySuggestedUsers(e.map(e=>({id:e.email,displayName:e.author,email:e.email})))})}async getAuthors(e){const t=new Date,n=new Set,i=[],s=(await this.gitExec(e,["config","--global","user.email"])).trim(),r=(await this.gitExec(e,["config","--global","user.name"])).trim();let o=0;if(await e.status(),e.state&&e.state.HEAD){const a=async c=>{if(!c||o>75||n.size>10)return;const l=await this.getAuthorInfo(e,c);if(l.timestamp){const e=Math.abs(t.getTime()-l.timestamp.getTime());if(Math.ceil(e/864e5)>30)return}l.email===s||l.author===r||!l.email||n.has(l.email)||l.email.includes("@users.noreply.github.com")||(n.add(l.email),i.push(l)),++o;const{parents:u}=await e.getCommit(c);u.length>0&&await Promise.all(u.map(e=>a(e)))};await a(e.state.HEAD.commit)}return i}async getAuthorInfo(e,t){const n=await this.gitExec(e,["show","-s","--format=%an <%ae> [%ai]",t]),i=n.substr(0,n.indexOf("<")).trim();let s=void 0;const r=n.match(/\<(.*?)\>/);r&&(s=r[1]);let o=void 0;const a=n.match(/\[(.*?)\]/);return a&&2===a.length&&(o=new Date(a[1])),{email:s,author:i,timestamp:o}}async gitExec(e,t){const n=this.gitPrivate.exec(e.rootUri.fsPath,t);try{return(await n).stdout}catch(e){throw console.error(`gitExec:err:${e}`),e}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(288),s=n(4);t.registerSelfInviteProvider=function(e,t,n){t("selfInvite",new r(e,n))};class r extends i.ProviderBase{constructor(e,t){super(),s.sessionStateTracker.onStateChanged(async n=>{n.newState!==s.SessionState.SignedOut&&n.newState!==s.SessionState.SignedIn||this.notifySelfSuggestion(e,n.newState===s.SessionState.SignedIn,t)}),s.sessionStateTracker.State===s.SessionState.SignedIn&&this.notifySelfSuggestion(e,!0,t)}async requestInitialize(e){return{description:"Self invite provider",capabilities:{supportsDispose:!1,supportsInviteLink:!1,supportsPresence:!1,supportsContactPresenceRequest:!1,supportsPublishPresence:!1}}}async notifySelfSuggestion(e,t,n){const i=[];if(t){const t=await e.getCurrentUserAsync();t&&i.push({id:t.id,displayName:t.displayName,email:t.emailAddress})}n.verbose(`SelfInviteProvider-> status:${i.length>0}`),this.notifySuggestedUsers(i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(7),r=n(4),o=n(5);class a extends s.VscodeSessionStatusProvider{constructor(e,t){super(e.createChild("idle-status-provider"),t),this.presenseStatusChangedEvent=new i.EventEmitter,r.sessionStateTracker.onStateChanged(async e=>{this.reset()}),this.onSessionStatusChanged(e=>{e===s.VscodeSessionStatus.Active?this.presenseStatusChangedEvent.fire(o.contactProtocol.PresenceStatus.Available):e===s.VscodeSessionStatus.Idle&&this.presenseStatusChangedEvent.fire(o.contactProtocol.PresenceStatus.Away)})}get id(){return"idle"}get status(){switch(this.sessionStatus){case s.VscodeSessionStatus.Idle:return o.contactProtocol.PresenceStatus.Away;default:return o.contactProtocol.PresenceStatus.Available}}get priority(){return 10}get onStatusChanged(){return this.presenseStatusChangedEvent.event}reset(){super.reset()}}t.IdlePresenceStatus=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1150),s=n(1151),r=n(1152),o=n(1153),a=n(1154),c=n(1155),l=n(1156),u=n(1157),d=n(1158),h=n(1159),f=n(1160);t.registerCommands=e=>{e.register("inviteUserJoin",i.builder),e.register("inviteUserJoinByEmail",s.builder),e.register("inviteNoUserJoinByEmail",r.builder),e.register("removeRecentContact",o.builder),e.register("inviteAvailableContacts",a.builder),e.register("selectPresenceProvider",c.builder),e.register("inviteSearchContacts",l.builder),e.register("changeSelfPresenceFromAvailable",u.builder),e.register("changeSelfPresenceFromAway",u.builder),e.register("changeSelfPresenceFromBusy",u.builder),e.register("changeSelfPresenceFromDoNotDisturb",u.builder),e.register("signInPresence",h.builder),e.register("signOutPresence",f.builder),e.register("changePresenceAvailable",d.builder),e.register("changePresenceBusy",d.builder),e.register("changePresenceDoNotDisturb",d.builder),e.register("changePresenceAway",d.builder),e.register("changePresenceInvisible",d.builder)}},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const s=n(108),r=n(4);t.builder=function(){return new o};let o=class{async invoke(e,t){return t.telemetryEvent.addProperty(r.TelemetryPropertyNames.INVITE_CONTACT_TYPE,e.options.type),s.ContactCommandUtilities.inviteHelper(e.contactModel)}};o=i([r.telemetryCommandDecorator(r.TelemetryEventNames.INVITE_CONTACT,r.TelemetryEventNames.INVITE_CONTACT_FAULT,"InviteContact",1)],o)},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const s=n(108),r=n(4);t.builder=function(){return new o};let o=class{async invoke(e,t){return s.ContactCommandUtilities.inviteByEmail(e.contactModel.contact.email,e.contactModel.contact.displayName)}};o=i([r.telemetryCommandDecorator(r.TelemetryEventNames.INVITE_CONTACT_BY_EMAIL,r.TelemetryEventNames.INVITE_CONTACT_BY_EMAIL_FAULT,"InviteContactByEmail",1)],o)},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const s=n(108),r=n(4);t.builder=function(){return new o};let o=class{async invoke(e,t){return s.ContactCommandUtilities.inviteByEmail("","")}};o=i([r.telemetryCommandDecorator(r.TelemetryEventNames.INVITE_NO_CONTACT_BY_EMAIL,r.TelemetryEventNames.INVITE_NO_CONTACT_BY_EMAIL_FAULT,"InviteNoContactByEmail",1)],o)},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const s=n(4),r=n(55);t.builder=function(){return new o};let o=class{async invoke(e,t){return await r.ContactManager.removeRecentContact(e.contactModel)}};o=i([s.telemetryCommandDecorator(s.TelemetryEventNames.REMOVE_RECENT_CONTACT,s.TelemetryEventNames.REMOVE_RECENT_CONTACT_FAULT,"RemoveRecentContact",1)],o)},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const s=n(0),r=n(4),o=n(5),a=n(184),c=n(55),l=n(145),u=n(108);t.builder=function(){return new d};let d=class{async invoke(e,t){const n=c.ContactManager.getAllAvailableContacts(e=>e.contact.status!==o.contactProtocol.PresenceStatus.Unknown&&e.contact.status!==o.contactProtocol.PresenceStatus.Offline).sort(a.defaultCompareContacts),i=n.map(e=>`${e.contact.displayName?e.contact.displayName:e.contact.id} (${l.ContactsProviderViewlet.getPresenceStatusName(e)})`),r=await s.window.showQuickPick(i,{placeHolder:"Select a contact to invite:"});if(!r)return;const d=n[i.indexOf(r)];return await u.ContactCommandUtilities.inviteHelper(d)}};d=i([r.telemetryCommandDecorator(r.TelemetryEventNames.INVITE_AVAILABLE_CONTACTS,r.TelemetryEventNames.INVITE_AVAILABLE_CONTACTS_FAULT,"InviteAvailableContacts",1)],d)},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const s=n(0),r=n(4),o=n(55);t.builder=function(){return new a};let a=class{async invoke(e){const t=o.ContactManager.serviceProviders.filter(e=>e.capabilites.supportsContactPresenceRequest).sort((e,t)=>e.priority>t.priority?-1:e.priority<t.priority?1:0);if(t.length>0){const e=o.ContactManager.selectedPreferedProviderId,n=t.map(t=>(t.serviceId===e?"$(check) ":"")+t.descriptionName),i=await s.window.showQuickPick(n,{placeHolder:r.localize("selectPresenceProviderCommand.placeHolder")});if(i){const e=t[n.indexOf(i)];o.ContactManager.setPreferedPresenceProvider(e)}}}};a=i([r.telemetryCommandDecorator(r.TelemetryEventNames.SELECT_PRESENCE_PROVIDER,r.TelemetryEventNames.SELECT_PRESENCE_PROVIDER_FAULT,"SelectPresenceProvider",1)],a)},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const s=n(0),r=n(108),o=n(4),a=n(5),c=n(55),l=n(184),u=n(145);t.builder=function(){return new d};let d=class{async invoke(){const e=[];try{return await new Promise((t,n)=>{const i=s.window.createQuickPick();i.placeholder=o.localize("searchContacts.placeholder");let u=null;e.push(i.onDidChangeValue(e=>{u&&u.cancel(),e?(i.busy=!0,u=new s.CancellationTokenSource,c.ContactManager.searchContacts([{property:a.contactProtocol.ContactProperty.DisplayName,expression:`^${e}`,options:1}],100,u.token).then(e=>{i.items=e.sort(l.defaultCompareContacts).map(e=>new h(e)),i.busy=!1})):i.items=[]}),i.onDidChangeSelection(e=>{const n=e[0];n instanceof h&&(r.ContactCommandUtilities.inviteHelper(n.IContactModel).then(e=>t(e)),i.hide())}),i.onDidHide(()=>{u&&u.cancel(),t(!1),i.dispose()})),i.show()})}finally{e.forEach(e=>e.dispose())}}};d=i([o.telemetryCommandDecorator(o.TelemetryEventNames.INVITE_SEARCH_CONTACTS,o.TelemetryEventNames.INVITE_SEARCH_CONTACTS_FAULT,"InviteSearchContactsCommand",1)],d);class h{constructor(e){this.IContactModel=e,this.label=`${e.contact.displayName} (${u.ContactsProviderViewlet.getPresenceStatusName(e)})`,this.description=e.contact.email}}},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const s=n(0),r=n(289),o=n(4),a=n(5),c=n(55),l=n(145);t.builder=function(){return new u};let u=class{async invoke(e,t){const n=c.ContactManager.presenceStatus,i=c.ContactManager.supportedPresenceStatus.slice(0),o=c.ContactManager.signedStatus===a.contactProtocol.SignedStatus.SignedIn;o&&-1===i.findIndex(e=>e===a.contactProtocol.PresenceStatus.Offline)&&i.push(a.contactProtocol.PresenceStatus.Offline);const u=i.map(e=>(n===e?"$(check) ":"")+l.ContactsProviderViewlet.toPresenceStatusName(e)),d=await s.window.showQuickPick(u,{placeHolder:"Specify your status:"});if(!d)return;let h=i[u.indexOf(d)];o&&h===a.contactProtocol.PresenceStatus.Offline?(await r.setLivesharePresenceEnabled(!1),await c.ContactManager.signOut()):await c.ContactManager.publishPresence(h)}};u=i([o.telemetryCommandDecorator(o.TelemetryEventNames.CHANGE_SELF_PRESENCE,o.TelemetryEventNames.CHANGE_SELF_PRESENCE_FAULT,"ChangeSelfPresence",1)],u)},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const s=n(4);t.builder=function(){return new r};let r=class{async invoke(e,t){let n=t.commandText.substr("liveshare.changePresence".length);n=n.charAt(0).toLowerCase()+n.slice(1);const i=n;await e.contactServiceManager.publishPresence(i,{})}};r=i([s.telemetryCommandDecorator(s.TelemetryEventNames.CHANGE_SELF_PRESENCE_STATUS,s.TelemetryEventNames.CHANGE_SELF_PRESENCE_STATUS_FAULT,"ChangeSelfPresenceStatus",1)],r)},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const s=n(0),r=n(289),o=n(4),a=n(5),c=n(55),l=n(145);t.builder=function(){return new u};let u=class{async invoke(e,t){const n=o.localize("generic.SignIn");if(await s.window.showWarningMessage(o.localize("presence.signInMessage"),{modal:!0},n)!==n)return;const i=c.ContactManager.supportedPresenceStatus.slice(0);i.push(a.contactProtocol.PresenceStatus.Offline);const u=i.map(e=>(e===a.contactProtocol.PresenceStatus.Offline?"$(check) ":"")+l.ContactsProviderViewlet.toPresenceStatusName(e)),d=await s.window.showQuickPick(u,{placeHolder:"Specify your status:"});if(!d||d===u[u.length-1])return;const h=async e=>{if(e!==a.contactProtocol.SignedStatus.SignedIn&&e!==a.contactProtocol.SignedStatus.SignedOut||c.ContactManager.removeListener(o.ContactManagerEvents.SignedStateChanged,h),e===a.contactProtocol.SignedStatus.SignedIn){const e=i[u.indexOf(d)];await c.ContactManager.publishPresence(e)}};c.ContactManager.addListener(o.ContactManagerEvents.SignedStateChanged,h),await r.setLivesharePresenceEnabled(!0),await c.ContactManager.signIn()}};u=i([o.telemetryCommandDecorator(o.TelemetryEventNames.SIGN_IN_PRESENCE,o.TelemetryEventNames.SIGN_IN_PRESENCE_FAULT,"SignInPresence",1)],u)},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const s=n(4),r=n(55);t.builder=function(){return new o};let o=class{async invoke(e,t){await r.ContactManager.signOut()}};o=i([s.telemetryCommandDecorator(s.TelemetryEventNames.SIGN_OUT_PRESENCE,s.TelemetryEventNames.SIGN_OUT_PRESENCE_FAULT,"SignOutPresence",1)],o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(1162),r=n(1204),o=n(1205),a=n(87),c=n(9),l=n(4),u=n(5),d=n(1206),h=n(1207),f=n(7),p=n(109),m=n(1208),g=n(226);t.ChatViewController=class{constructor(e,t,n,i,s){this.authCoreService=e,this.clientAccessCheck=t,this.rpcServices=n,this.trace=s,this.tracePrefix="[Chat View Controller]",this.messages={},this.users={},this.isUIReady=!1,this.typingTimers={},this.unreadWindowCounts={},this.authCoreService.onAuthenticationChanged(async e=>{var t;await this.updateUser(null===(t=e.account)||void 0===t?void 0:t.id)}),l.workspaceSessionInfoTracker.onReadOnlyChanged(async()=>{await this.updateUser()}),l.sessionStateTracker.onStateChanged(async e=>{switch(e.newState){case l.SessionState.Shared:await this.initialize(),await this.chatServiceProxy.sendMessage(l.localize("chat.sessionStarted"));break;case l.SessionState.Joined:await this.initialize(),(await this.chatServiceProxy.getMessageHistory()).forEach(async e=>{await this.onMessageReceived({message:e})}),await this.chatServiceProxy.sendMessage(l.localize("chat.sessionJoined"));break}}),l.SessionContext.onCollaboratorChanged(async e=>{if(e&&e.changeType===u.vsls.WorkspaceSessionChangeType.Unjoined){const t={type:g.ChatMessageType.Text,fromId:e.sessionNumber.toString(),body:{text:l.localize("chat.sessionLeft"),timestamp:new Date}};await this.onMessageReceived({message:t})}}),this.rpcServices.workspaceService().onConnectionStatusChanged(async e=>{e.disconnectedReason===u.vsls.WorkspaceDisconnectedReason.SessionEnded&&l.sessionStateTracker.State===l.SessionState.Shared&&await this.chatServiceProxy.sendMessage(l.localize("chat.sessionEnded"))}),this.chatViewChanged=i,this.chatStatusBarItem=new o.ChatStatusBarItem}async initialize(){this.trace.info(`${this.tracePrefix} initialize`),this.users={},await this.createChatWindow(),this.chatServiceProxy=new m.ChatServiceProxy(this.rpcServices.chatService(),async e=>await this.onMessageReceived({message:e})),await this.updateUser(),this.clearMessages()}async onMessageReceived(e){var t;let{type:n,fromId:i,body:s}=e.message;this.trace.info(`${this.tracePrefix} notify. type:${n}, from:${i}`);const r=null===(t=null===l.workspaceSessionInfoTracker||void 0===l.workspaceSessionInfoTracker?void 0:l.workspaceSessionInfoTracker.workspaceSessionInfo)||void 0===t?void 0:t.sessionNumber.toString();if(r&&r!==i)switch(void 0===i&&(i=r),this.users[i]||await this.prepareContactForDisplay(i),n){case g.ChatMessageType.Text:const{text:e,timestamp:t}=s;c.Telemetry.sendTelemetryEvent(l.TelemetryEventNames.CHAT_NOTIFY,{[l.TelemetryPropertyNames.CHAT_NOTIFY_TYPE]:g.ChatMessageType.Text.toString()});const r=(("string"==typeof t?new Date(t):t).getTime()/1e3).toString();let o={};o[r]=this.toWebviewMessage(e,r,i),await this.updateMessages(o);break;case g.ChatMessageType.Typing:await this.updateWebview(i);const a=`${i}`;this.typingTimers[a]&&(clearTimeout(this.typingTimers[a]),this.typingTimers[a]=void 0);const u=setTimeout(async()=>{await this.updateWebview()},500);this.typingTimers[a]=u;break;default:const d=`Unsupported chat message type: ${n}`;throw c.Telemetry.sendFault(l.TelemetryEventNames.CHAT_FAULT,c.FaultType.Error,d),new Error(d)}}async openSessionChat(e){this.trace.info(`${this.tracePrefix} open session chat: ${a.VSLS_CHAT_WINDOW.id}`),c.Telemetry.sendTelemetryEvent(h.CommunicationsTelemetryEventNames.OPEN_CHAT_WINDOW,{[h.CommunicationsTelemetryPropertyNames.CHAT_EVENT_SOURCE]:e}),await i.commands.executeCommand("workbench.action.focusLastEditorGroup"),this.loadUi(),await this.updateWebview(),await this.updateChatUI()}chatWindowInfo(){return{contact:a.VSLS_CHAT_WINDOW,unread:this.getUnreadCount()}}static isUnsupportedChatExtensionInstalled(e){const t=i.extensions.all.find(e=>"karigari.chat"===e.id);if(!t)return!1;const n=[0,33],s=t.packageJSON.version;if(s){const t=s.split(".");if((null==t?void 0:t.length)>1){const i=parseInt(t[0],10),s=parseInt(t[1],10);if(i>n[0]||s>n[1])return!1;e&&f.NotificationUtil.showErrorMessage(l.localize("chat.legacyExtensionUnsupported"))}}return!0}static getCurrentUserId(){var e;const t=null===(e=l.SessionContext.coeditingClient)||void 0===e?void 0:e.clientID;return"number"==typeof t?l.SessionContext.collaboratorManager.getUserId(t):void 0}async sendToExtension(e){const{type:t,body:n}=e;switch(this.trace.info(`${this.tracePrefix} Sending to extension (${t})`),t){case d.MessageType.ready:this.isUIReady=!0,this.pendingMessage&&await this.sendToUI(this.pendingMessage);break;case d.MessageType.command:await this.handleCommand(n);break;case d.MessageType.focus:await this.onFocus();break;case d.MessageType.text:await this.chatServiceProxy.sendMessage(n);break;case d.MessageType.typing:await this.chatServiceProxy.sendTyping()}}async handleCommand(e){switch(e.toLowerCase().trim()){case d.CommandType.clear:c.Telemetry.sendTelemetryEvent(l.TelemetryEventNames.CHAT_COMMAND_INVOKED,{[l.TelemetryPropertyNames.CHAT_COMMAND]:d.CommandType.clear}),this.clearMessages();break;case d.CommandType.end:c.Telemetry.sendTelemetryEvent(l.TelemetryEventNames.CHAT_COMMAND_INVOKED,{[l.TelemetryPropertyNames.CHAT_COMMAND]:d.CommandType.end}),l.sessionStateTracker.State===l.SessionState.Shared?await i.commands.executeCommand("liveshare.end"):l.sessionStateTracker.State===l.SessionState.Joined&&await i.commands.executeCommand("liveshare.leave");break;default:c.Telemetry.sendTelemetryEvent(l.TelemetryEventNames.CHAT_COMMAND_INVOKED,{[l.TelemetryPropertyNames.CHAT_COMMAND]:"unknown"}),await this.chatServiceProxy.sendMessage(e)}}async clearMessages(){const e=this.messages[a.VSLS_CHAT_WINDOW.id]||{},t={};Object.keys(e).forEach(e=>{t[e]=void 0}),await this.updateMessages(t)}loadUi(){this.webview?this.webview.reveal():(this.webview=new r.default(()=>{this.webview=void 0,this.isUIReady=!1}),this.webview.setMessageHandler(async e=>await this.sendToExtension(e)))}async sendToUI(e){if(this.isUIReady){const{messages:t}=e,n=Object.keys(t).length;this.trace.info(`${this.tracePrefix} Sending to webview: ${n} messages`),this.webview&&(this.webview.update(e),this.pendingMessage=void 0,this.webview.isVisible()&&await this.updateReadMarker())}else this.pendingMessage=e}async updateUser(e){var t;if(null===(t=null===l.workspaceSessionInfoTracker||void 0===l.workspaceSessionInfoTracker?void 0:l.workspaceSessionInfoTracker.workspaceSessionInfo)||void 0===t?void 0:t.sessions)if(e){for(const t in l.workspaceSessionInfoTracker.workspaceSessionInfo.sessions)if(l.workspaceSessionInfoTracker.workspaceSessionInfo.sessions[t].id===e){await this.prepareContactForDisplay(t);break}}else{const e=l.workspaceSessionInfoTracker.workspaceSessionInfo.sessionNumber.toString();this.currentUser=await this.prepareContactForDisplay(e)}}async onFocus(){await this.updateReadMarker(),await this.updateChatUI()}getUnreadCount(){const{readTimestamp:e}=this.chatWindow,t=this.currentUser;if(!t)return 0;const n=this.messages[a.VSLS_CHAT_WINDOW.id]||{};return Object.keys(n).filter(i=>n[i].userId!==t.id&&(!!e&&+i>+e)).length}updateStatusBarItem(){const e=this.getUnreadCount();this.chatStatusBarItem.updateCount(e)}async updateChatUI(){if(!await p.CommunicationsManager.isChatEnabled())return;const e=this.getUnreadCount();this.unreadWindowCounts[a.VSLS_CHAT_WINDOW.id]!==e&&(this.unreadWindowCounts[a.VSLS_CHAT_WINDOW.id]=e,this.updateStatusBarItem(),this.chatViewChanged.fire())}async updateReadMarker(){const e=this.getLastTimestamp();if(this.chatWindow&&e){const{readTimestamp:t}=this.chatWindow;if(!t||+t<+e){const t=(+e+1).toString(),n=this.markChatWindow(t);n&&(this.chatWindow=n)}}}markChatWindow(e){return Object.assign(Object.assign({},this.chatWindow),{readTimestamp:e,unreadCount:0})}getLastTimestamp(){const e=this.messages[a.VSLS_CHAT_WINDOW.id]||{},t=Object.keys(e).map(e=>+e);if(t.length>0)return Math.max(...t).toString()}async prepareContactForDisplay(e){var t;if(l.sessionStateTracker.State!==l.SessionState.Joined&&l.sessionStateTracker.State!==l.SessionState.Shared)return;let n=(await this.chatServiceProxy.getParticipants()).find(t=>t.id===e);if(!n)return;const i=null===(t=null===l.workspaceSessionInfoTracker||void 0===l.workspaceSessionInfoTracker?void 0:l.workspaceSessionInfoTracker.workspaceSessionInfo)||void 0===t?void 0:t.sessions[e],s=n.email&&"anonymous"!==n.email?n.email:`anonymous${e}`,r=(null==i?void 0:i.avatarUri)||this.defaultAvatar(s),o=i?await l.ExtensionUtil.getAnonymousReadOnlyLabel(this.clientAccessCheck(),i):"",a={id:e,displayName:`${n.name}${o}`,avatarUri:r,email:s};return this.users[e]=a,a}defaultAvatar(e){return s.imageUrl({email:e,parameters:{size:"200",d:"retro"},secure:!0})}async updateWebview(e){if(this.currentUser&&this.chatWindow){const t=this.users,n=this.messages[a.VSLS_CHAT_WINDOW.id]||{};let s;e&&(s=t[e]);const{fontFamily:r,fontSize:o}=i.workspace.getConfiguration("editor");let c="";s&&(c=l.localize("chat.typingStatus").replace("$(username)",s.displayName));let u={fontFamily:r,fontSize:o,provider:"",messages:n,users:t,currentUser:this.currentUser,window:this.chatWindow,statusText:c};await this.sendToUI(u)}}async createChatWindow(){let e=this.chatWindow;if(!e){const t=+new Date/1e3-60;e={id:a.VSLS_CHAT_WINDOW.id,name:a.VSLS_CHAT_WINDOW.displayName,type:"im",isDisabled:!1,readTimestamp:t.toString(),unreadCount:0},this.chatWindow=e}return e}async updateMessages(e){const t=this.messages[a.VSLS_CHAT_WINDOW.id]||{},n=Object.keys(e).filter(t=>void 0===e[t]),i={};Object.keys(t).forEach(e=>{n.indexOf(e)>=0||(i[e]=t[e])}),Object.keys(e).forEach(t=>{const n=e[t];n&&(i[t]=n)}),this.messages[a.VSLS_CHAT_WINDOW.id]=i,Object.keys(this.messages[a.VSLS_CHAT_WINDOW.id]).forEach(e=>{void 0===this.messages[a.VSLS_CHAT_WINDOW.id][e]&&delete this.messages[a.VSLS_CHAT_WINDOW.id][e]}),await this.updateWebview(),this.updateChatUI()}toWebviewMessage(e,t,n){return{text:e,timestamp:t,content:void 0,reactions:[],replies:{},userId:n}}}},function(e,t,n){var i=n(223),s={includes:n(1163),trim:n(1193)},r=n(1203),o={},a=function(e){var t="",n=i.stringify(e);return""!==n&&(t="?"+n),t},c=function(e){var t="http://www.gravatar.com/";return e&&(t="https://secure.gravatar.com/"),t},l=function(e){return e.email=e.email||"",e.type=s.trim(e.type),e.$emailHash=r(e.email.toLowerCase().trim()),e};o.imageUrl=function(e){e=l(e);var t=c(e.secure)+"avatar/",n=a(e.parameters);return t+e.$emailHash+n},o.getProfileUrl=function(e){e=l(e);var t=c(e.secure);s.includes(["json","xml","qr","php","vcf"],e.type)||(e.type="json");var n=a(e.parameters);return t+e.$emailHash+"."+e.type+n},e.exports=o},function(e,t,n){var i=n(291),s=n(495),r=n(1170),o=n(1171),a=n(1175),c=Math.max;e.exports=function(e,t,n,l){e=s(e)?e:a(e),n=n&&!l?o(n):0;var u=e.length;return n<0&&(n=c(u+n,0)),r(e)?n<=u&&e.indexOf(t,n)>-1:!!u&&i(e,t,n)>-1}},function(e,t){e.exports=function(e,t,n,i){for(var s=e.length,r=n+(i?1:-1);i?r--:++r<s;)if(t(e[r],r,e))return r;return-1}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,n){for(var i=n-1,s=e.length;++i<s;)if(e[i]===t)return i;return-1}},function(e,t,n){var i=n(146),s=n(498);e.exports=function(e){if(!s(e))return!1;var t=i(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,n){var i=n(292),s=Object.prototype,r=s.hasOwnProperty,o=s.toString,a=i?i.toStringTag:void 0;e.exports=function(e){var t=r.call(e,a),n=e[a];try{e[a]=void 0;var i=!0}catch(e){}var s=o.call(e);return i&&(t?e[a]=n:delete e[a]),s}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var i=n(146),s=n(293),r=n(147);e.exports=function(e){return"string"==typeof e||!s(e)&&r(e)&&"[object String]"==i(e)}},function(e,t,n){var i=n(1172);e.exports=function(e){var t=i(e),n=t%1;return t==t?n?t-n:t:0}},function(e,t,n){var i=n(1173);e.exports=function(e){return e?(e=i(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},function(e,t,n){var i=n(500),s=n(498),r=n(501),o=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(r(e))return NaN;if(s(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=s(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=i(e);var n=a.test(e);return n||c.test(e)?l(e.slice(2),n?2:8):o.test(e)?NaN:+e}},function(e,t){var n=/\s/;e.exports=function(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t}},function(e,t,n){var i=n(1176),s=n(1177);e.exports=function(e){return null==e?[]:i(e,s(e))}},function(e,t,n){var i=n(502);e.exports=function(e,t){return i(t,(function(t){return e[t]}))}},function(e,t,n){var i=n(1178),s=n(1189),r=n(495);e.exports=function(e){return r(e)?i(e):s(e)}},function(e,t,n){var i=n(1179),s=n(1180),r=n(293),o=n(1182),a=n(1184),c=n(1185),l=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=r(e),u=!n&&s(e),d=!n&&!u&&o(e),h=!n&&!u&&!d&&c(e),f=n||u||d||h,p=f?i(e.length,String):[],m=p.length;for(var g in e)!t&&!l.call(e,g)||f&&("length"==g||d&&("offset"==g||"parent"==g)||h&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||a(g,m))||p.push(g);return p}},function(e,t){e.exports=function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}},function(e,t,n){var i=n(1181),s=n(147),r=Object.prototype,o=r.hasOwnProperty,a=r.propertyIsEnumerable,c=i(function(){return arguments}())?i:function(e){return s(e)&&o.call(e,"callee")&&!a.call(e,"callee")};e.exports=c},function(e,t,n){var i=n(146),s=n(147);e.exports=function(e){return s(e)&&"[object Arguments]"==i(e)}},function(e,t,n){(function(e){var i=n(496),s=n(1183),r=t&&!t.nodeType&&t,o=r&&"object"==typeof e&&e&&!e.nodeType&&e,a=o&&o.exports===r?i.Buffer:void 0,c=(a?a.isBuffer:void 0)||s;e.exports=c}).call(this,n(121)(e))},function(e,t){e.exports=function(){return!1}},function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var i=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==i||"symbol"!=i&&n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,n){var i=n(1186),s=n(1187),r=n(1188),o=r&&r.isTypedArray,a=o?s(o):i;e.exports=a},function(e,t,n){var i=n(146),s=n(499),r=n(147),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,e.exports=function(e){return r(e)&&s(e.length)&&!!o[i(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,n){(function(e){var i=n(497),s=t&&!t.nodeType&&t,r=s&&"object"==typeof e&&e&&!e.nodeType&&e,o=r&&r.exports===s&&i.process,a=function(){try{var e=r&&r.require&&r.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=a}).call(this,n(121)(e))},function(e,t,n){var i=n(1190),s=n(1191),r=Object.prototype.hasOwnProperty;e.exports=function(e){if(!i(e))return s(e);var t=[];for(var n in Object(e))r.call(e,n)&&"constructor"!=n&&t.push(n);return t}},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t,n){var i=n(1192)(Object.keys,Object);e.exports=i},function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},function(e,t,n){var i=n(503),s=n(500),r=n(1194),o=n(1196),a=n(1197),c=n(1198),l=n(1202);e.exports=function(e,t,n){if((e=l(e))&&(n||void 0===t))return s(e);if(!e||!(t=i(t)))return e;var u=c(e),d=c(t),h=a(u,d),f=o(u,d)+1;return r(u,h,f).join("")}},function(e,t,n){var i=n(1195);e.exports=function(e,t,n){var s=e.length;return n=void 0===n?s:n,!t&&n>=s?e:i(e,t,n)}},function(e,t){e.exports=function(e,t,n){var i=-1,s=e.length;t<0&&(t=-t>s?0:s+t),(n=n>s?s:n)<0&&(n+=s),s=t>n?0:n-t>>>0,t>>>=0;for(var r=Array(s);++i<s;)r[i]=e[i+t];return r}},function(e,t,n){var i=n(291);e.exports=function(e,t){for(var n=e.length;n--&&i(t,e[n],0)>-1;);return n}},function(e,t,n){var i=n(291);e.exports=function(e,t){for(var n=-1,s=e.length;++n<s&&i(t,e[n],0)>-1;);return n}},function(e,t,n){var i=n(1199),s=n(1200),r=n(1201);e.exports=function(e){return s(e)?r(e):i(e)}},function(e,t){e.exports=function(e){return e.split("")}},function(e,t){var n=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return n.test(e)}},function(e,t){var n="[\\ud800-\\udfff]",i="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",s="\\ud83c[\\udffb-\\udfff]",r="[^\\ud800-\\udfff]",o="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",c="(?:"+i+"|"+s+")"+"?",l="[\\ufe0e\\ufe0f]?"+c+("(?:\\u200d(?:"+[r,o,a].join("|")+")[\\ufe0e\\ufe0f]?"+c+")*"),u="(?:"+[r+i+"?",i,o,a,n].join("|")+")",d=RegExp(s+"(?="+s+")|"+u+l,"g");e.exports=function(e){return e.match(d)||[]}},function(e,t,n){var i=n(503);e.exports=function(e){return null==e?"":i(e)}},function(e,t,n){var i;!function(s){"use strict";function r(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function o(e,t,n,i,s,o){return r((a=r(r(t,e),r(i,o)))<<(c=s)|a>>>32-c,n);var a,c}function a(e,t,n,i,s,r,a){return o(t&n|~t&i,e,t,s,r,a)}function c(e,t,n,i,s,r,a){return o(t&i|n&~i,e,t,s,r,a)}function l(e,t,n,i,s,r,a){return o(t^n^i,e,t,s,r,a)}function u(e,t,n,i,s,r,a){return o(n^(t|~i),e,t,s,r,a)}function d(e,t){var n,i,s,o,d;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var h=1732584193,f=-271733879,p=-1732584194,m=271733878;for(n=0;n<e.length;n+=16)i=h,s=f,o=p,d=m,h=a(h,f,p,m,e[n],7,-680876936),m=a(m,h,f,p,e[n+1],12,-389564586),p=a(p,m,h,f,e[n+2],17,606105819),f=a(f,p,m,h,e[n+3],22,-1044525330),h=a(h,f,p,m,e[n+4],7,-176418897),m=a(m,h,f,p,e[n+5],12,1200080426),p=a(p,m,h,f,e[n+6],17,-1473231341),f=a(f,p,m,h,e[n+7],22,-45705983),h=a(h,f,p,m,e[n+8],7,1770035416),m=a(m,h,f,p,e[n+9],12,-1958414417),p=a(p,m,h,f,e[n+10],17,-42063),f=a(f,p,m,h,e[n+11],22,-1990404162),h=a(h,f,p,m,e[n+12],7,1804603682),m=a(m,h,f,p,e[n+13],12,-40341101),p=a(p,m,h,f,e[n+14],17,-1502002290),h=c(h,f=a(f,p,m,h,e[n+15],22,1236535329),p,m,e[n+1],5,-165796510),m=c(m,h,f,p,e[n+6],9,-1069501632),p=c(p,m,h,f,e[n+11],14,643717713),f=c(f,p,m,h,e[n],20,-373897302),h=c(h,f,p,m,e[n+5],5,-701558691),m=c(m,h,f,p,e[n+10],9,38016083),p=c(p,m,h,f,e[n+15],14,-660478335),f=c(f,p,m,h,e[n+4],20,-405537848),h=c(h,f,p,m,e[n+9],5,568446438),m=c(m,h,f,p,e[n+14],9,-1019803690),p=c(p,m,h,f,e[n+3],14,-187363961),f=c(f,p,m,h,e[n+8],20,1163531501),h=c(h,f,p,m,e[n+13],5,-1444681467),m=c(m,h,f,p,e[n+2],9,-51403784),p=c(p,m,h,f,e[n+7],14,1735328473),h=l(h,f=c(f,p,m,h,e[n+12],20,-1926607734),p,m,e[n+5],4,-378558),m=l(m,h,f,p,e[n+8],11,-2022574463),p=l(p,m,h,f,e[n+11],16,1839030562),f=l(f,p,m,h,e[n+14],23,-35309556),h=l(h,f,p,m,e[n+1],4,-1530992060),m=l(m,h,f,p,e[n+4],11,1272893353),p=l(p,m,h,f,e[n+7],16,-155497632),f=l(f,p,m,h,e[n+10],23,-1094730640),h=l(h,f,p,m,e[n+13],4,681279174),m=l(m,h,f,p,e[n],11,-358537222),p=l(p,m,h,f,e[n+3],16,-722521979),f=l(f,p,m,h,e[n+6],23,76029189),h=l(h,f,p,m,e[n+9],4,-640364487),m=l(m,h,f,p,e[n+12],11,-421815835),p=l(p,m,h,f,e[n+15],16,530742520),h=u(h,f=l(f,p,m,h,e[n+2],23,-995338651),p,m,e[n],6,-198630844),m=u(m,h,f,p,e[n+7],10,1126891415),p=u(p,m,h,f,e[n+14],15,-1416354905),f=u(f,p,m,h,e[n+5],21,-57434055),h=u(h,f,p,m,e[n+12],6,1700485571),m=u(m,h,f,p,e[n+3],10,-1894986606),p=u(p,m,h,f,e[n+10],15,-1051523),f=u(f,p,m,h,e[n+1],21,-2054922799),h=u(h,f,p,m,e[n+8],6,1873313359),m=u(m,h,f,p,e[n+15],10,-30611744),p=u(p,m,h,f,e[n+6],15,-1560198380),f=u(f,p,m,h,e[n+13],21,1309151649),h=u(h,f,p,m,e[n+4],6,-145523070),m=u(m,h,f,p,e[n+11],10,-1120210379),p=u(p,m,h,f,e[n+2],15,718787259),f=u(f,p,m,h,e[n+9],21,-343485551),h=r(h,i),f=r(f,s),p=r(p,o),m=r(m,d);return[h,f,p,m]}function h(e){var t,n="",i=32*e.length;for(t=0;t<i;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function f(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;var i=8*e.length;for(t=0;t<i;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function p(e){var t,n,i="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),i+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return i}function m(e){return unescape(encodeURIComponent(e))}function g(e){return function(e){return h(d(f(e),8*e.length))}(m(e))}function y(e,t){return function(e,t){var n,i,s=f(e),r=[],o=[];for(r[15]=o[15]=void 0,s.length>16&&(s=d(s,8*e.length)),n=0;n<16;n+=1)r[n]=909522486^s[n],o[n]=1549556828^s[n];return i=d(r.concat(f(t)),512+8*t.length),h(d(o.concat(i),640))}(m(e),m(t))}function v(e,t,n){return t?n?y(t,e):p(y(t,e)):n?g(e):p(g(e))}void 0===(i=function(){return v}.call(t,n,t,e))||(e.exports=i)}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(4);t.default=class{constructor(e){this.onDidDispose=e;let t=s.ExtensionUtil.getExtensionUri("webview");const n=[t];var r;s.ExtensionUtil.isNode()&&(t=t.with({scheme:"vscode-resource"})),this.panel=i.window.createWebviewPanel("chatPanel","Chat",i.ViewColumn.Beside,{enableScripts:!0,retainContextWhenHidden:!0,localResourceRoots:n}),this.panel.webview.html=`<!DOCTYPE html>\n  <html lang="en">\n  <head>\n      <meta charset="UTF-8">\n      <meta name="viewport" content="width=device-width, initial-scale=1.0">\n      <title>Chat</title>\n\n      <link href="${r=t.toString()}/css/app.css" rel="preload" as="style">\n      <link href="${r}/js/chunk-vendors.js" rel="preload" as="script">\n      <link href="${r}/js/app.js" rel="preload" as="script">\n      <link href="${r}/css/app.css" rel="stylesheet">\n  </head>\n  <body>\n      <div id="app"> </div>\n      <script src="${r}/js/chunk-vendors.js"> <\/script>\n      <script src="${r}/js/app.js"> <\/script>\n  </body>\n  </html>`,this.panel.onDidDispose(()=>{this.panel=null,this.onDidDispose()})}setMessageHandler(e){this.panel.webview.onDidReceiveMessage(t=>e(t))}update(e){const{messages:t,users:n,window:i,currentUser:s}=e,r=this.getAnnotatedMessages(t,i,s),o=this.getMessageGroups(r,n);this.panel.webview.postMessage(Object.assign(Object.assign({},e),{messages:o})),this.panel.title=i?i.name:""}reveal(){this.panel.reveal()}isVisible(){return this.panel.visible}getAnnotatedMessages(e,t,n){if(t){const{readTimestamp:i}=t;let s={};return Object.keys(e).forEach(t=>{const r=e[t],o=r.userId!==n.id,a=!!i&&o&&+t>+i;s[t]=Object.assign(Object.assign({},r),{isUnread:a})}),s}return e}getMessageGroups(e,t){let n={};return Object.keys(e).forEach(t=>{const i=new Date(1e3*+t),s=this.toDateString(i);s in n||(n[s]={}),n[s][t]=e[t]}),Object.keys(n).sort((e,t)=>e.localeCompare(t)).map(e=>{const i=n[e];return{groups:this.getMessageGroupsForDate(i,t),date:e}})}toDateString(e){let t=(e.getMonth()+1).toString(),n=e.getDate().toString();return 1===t.length&&(t=`0${t}`),1===n.length&&(n=`0${n}`),`${e.getFullYear()}-${t}-${n}`}getMessageGroupsForDate(e,t){const n=Object.keys(e).sort((e,t)=>+e-+t).reduce((n,i)=>{const{current:s,groups:r}=n,o=e[i],a=!!s.userId&&o.userId===s.userId,c=!!s.ts&&+i-+s.ts<300;if(a&&c)return{groups:r,current:Object.assign(Object.assign({},s),{ts:i,messages:[...s.messages,o]})};{const e={messages:[o],userId:o.userId,user:t[o.userId],minTimestamp:i,ts:i,key:i};return{groups:s.ts?[...r,s]:[...r],current:e}}},{current:{},groups:[]}),i=n.current,s=n.groups;return i.ts?[...s,i]:s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(4);t.ChatStatusBarItem=class{constructor(){this.chatIcon="$(comment-discussion)",this.unreadCount=0,this.isVisible=!1,this.item=i.window.createStatusBarItem(i.StatusBarAlignment.Left);const e="extension.liveshare.chatStatusBar";this.disposableCommand=i.commands.registerCommand(e,()=>i.commands.executeCommand("liveshare.openSessionChat")),this.item.command=e}updateCount(e){return this.unreadCount=e,this.item.text=`${this.chatIcon} `+s.localize("chat.statusBarText").replace("$(unreads)",e.toLocaleString()),this.unreadCount>0?this.show():this.hide()}show(){this.isVisible||(this.item.show(),this.isVisible=!0)}hide(){this.isVisible&&(this.item.hide(),this.isVisible=!1)}dispose(){this.item.dispose(),this.disposableCommand.dispose()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.text="text",e.typing="typing",e.thread_reply="thread_reply",e.command="command",e.link="link",e.focus="is_focused",e.ready="is_ready",e.fetch_replies="fetch_replies"}(t.MessageType||(t.MessageType={})),function(e){e.clear="/clear",e.share="/share",e.end="/end"}(t.CommandType||(t.CommandType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4);class s{}t.CommunicationsTelemetryEventNames=s,s.OPEN_CHAT_WINDOW="open-chat-window";class r{}t.CommunicationsTelemetryPropertyNames=r,r.CHAT_EVENT_SOURCE=i.TelemetryPropertyNames.FEATURE_NAME+"ChatEventSource",r.CHAT_TYPE=i.TelemetryPropertyNames.FEATURE_NAME+"ChatType",r.CHAT_FAILURE=i.TelemetryPropertyNames.FEATURE_NAME+"ChatFailure"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(226);t.ChatServiceProxy=class{constructor(e,t){this.chatRpcService=e,this.updateWebviewCallback=t,this.chatRpcService.onMessageReceived(e=>this.updateWebviewCallback(e.message))}async getMessageHistory(){return await this.chatRpcService.getMessageHistoryAsync()}async getParticipants(){return await this.chatRpcService.getParticipantsAsync()}async sendMessage(e){const t={timestamp:new Date,text:e},n={type:i.ChatMessageType.Text,body:t};await this.updateWebviewCallback(n),await this.chatRpcService.sendMessageAsync(n)}async sendTyping(){const e={type:i.ChatMessageType.Typing};await this.chatRpcService.sendMessageAsync(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(504),r=n(4),o=n(1210),a=n(7),c=n(87),l=n(9),u=n(294),d=n(1217),h=n(1218),f=n(1219);t.CallingServiceManager=class{constructor(e,t,n,s){this.authCoreService=e,this.rpcClient=t,this.registeredServicesCallback=n,this.trace=s,this.newCallEventEmitter=new i.EventEmitter,this.onNewAudioCallAvailable=this.newCallEventEmitter.event,this.muteChangedEventEmitter=new i.EventEmitter,this.onMuteChanged=this.muteChangedEventEmitter.event,this.participantsListChangedEventEmitter=new i.EventEmitter,this.onParticipantsListChanged=this.participantsListChangedEventEmitter.event,this.participantChangedEventEmitter=new i.EventEmitter,this.onParticipantChanged=this.participantChangedEventEmitter.event,this.onNotify=async e=>{switch(e.callingEventType){case c.CallingEventType.CallStarted:e.callId&&(l.Telemetry.sendTelemetryEvent(r.TelemetryEventNames.AUDIO_CALL_STARTED_NOTIFICATION),this.newCallEventEmitter.fire(),this.trackedCalls.has(e.callId)||(this.trackedCalls.set(e.callId,!0),await this.callingServiceProxy.getCallInfo()||await this.promptToJoinCall()));break;case c.CallingEventType.CallInformationRequest:if(this.isCallStarted){const e=await this.getCallInfo();e&&"Connected"===e.state&&(l.Telemetry.sendTelemetryEvent(r.TelemetryEventNames.AUDIO_CALL_INFO_NOTIFICATION),this.sendCallStartedNotification(e))}break;default:throw l.Telemetry.sendTelemetryEvent(r.TelemetryEventNames.AUDIO_CALL_UNEXPECTED_NOTIFICATION),new Error(`Unexpected call event type: ${e.callingEventType}`)}},this.callingServiceProxy=new d.CallingServiceProxy,this.audioStatusBarController=new h.AudioStatusBarController(this,this.trace),r.sessionStateTracker.onStateChanged(async e=>{e.newState===r.SessionState.Joined&&u.AudioSessionContext.transition(u.AudioSessionAction.LiveShareSessionStarted)}),u.AudioSessionContext.transition(u.AudioSessionAction.InitializeDone)}async initialize(){this.trackedCalls=new Map,this.messagingService=new f.MessagingService(c.MESSAGE_SERVICE_NAME,this.rpcClient,this.registeredServicesCallback,this.trace),await this.messagingService.initialize(),this.messagingService.onNotify(this.onNotify),await this.registerCommands(),await this.callingServiceProxy.initialize(e=>this.onCallChanged(e))}async commandStartOrJoinCall(){if(this.isConnecting)return void this.trace.warning("Attempt to start or join a call that is already connecting.");this.isConnecting=!0;const e=l.Telemetry.startTimedEvent(r.TelemetryEventNames.AUDIO_CONNECT_CALL);try{u.AudioSessionContext.transition(u.AudioSessionAction.AttemptConnectAudio);const e=r.workspaceSessionInfoTracker.workspaceSessionInfo.id;await r.ExtensionUtil.runWithProgress(async()=>await this.connectToCall(e),{title:r.localize("calling.connectingAudio")}),u.AudioSessionContext.transition(u.AudioSessionAction.AudioConnected)}catch(t){if(t instanceof a.CancellationError)return this.trace.warning(`startOrJoinCall: cancellation on connect to audio: ${t.message}`),u.AudioSessionContext.transition(u.AudioSessionAction.AudioConnectionFailed),void e.end(l.TelemetryResult.Cancel);throw this.trace.error(`startOrJoinCall: Caught error while trying to connect to audio: ${t.message} ${t.stack}`),u.AudioSessionContext.transition(u.AudioSessionAction.AudioConnectionFailed),e.end(l.TelemetryResult.Failure,t.message),t}finally{this.isConnecting=!1}e.end(l.TelemetryResult.Success)}async promptToJoinCall(){const e=r.localize("calling.joinButton"),t=await i.window.showInformationMessage(r.localize("calling.joinInformationMessage"),e);t===e&&await this.commandStartOrJoinCall(),l.Telemetry.sendTelemetryEvent(r.TelemetryEventNames.JOIN_PROMPT_DISPLAYED,{[r.TelemetryPropertyNames.SELECTED_ACTION]:t})}async getCallInfo(){if(this.isCallStarted)return await this.callingServiceProxy.getCallInfo()}checkIfCallIsAvailable(){this.trace.info("checkIfCallIsAvailable");const e={callingEventType:c.CallingEventType.CallInformationRequest};this.messagingService.notify(e)}async getSelectedDevices(){return this.isCallStarted?(l.Telemetry.sendTelemetryEvent(r.TelemetryEventNames.AUDIO_GET_SELECTED_DEVICES),await this.callingServiceProxy.getSelectedDevices()):{}}async getParticipants(){if(!this.isCallStarted)return[];return l.Telemetry.sendTelemetryEvent(r.TelemetryEventNames.AUDIO_GET_PARTICIPANTS),await this.callingServiceProxy.getParticipants()||[]}async endCall(){this.isCallStarted&&(l.Telemetry.sendTelemetryEvent(r.TelemetryEventNames.AUDIO_END_CALL),await this.callingServiceProxy.endCall(),this.isCallStarted=!1)}async enumerateDevices(){return this.isCallStarted?(l.Telemetry.sendTelemetryEvent(r.TelemetryEventNames.AUDIO_ENUMERATE_DEVICES),await this.callingServiceProxy.getDevices()):[]}async isMuted(){return!!this.isCallStarted&&await this.callingServiceProxy.isMuted()}async onLiveShareSessionEnded(){try{await this.endCall(),await this.dispose()}catch(e){this.trace.error(`Failed to clean up call: ${e.message} ${e.stack}`)}}async mute(e){this.isCallStarted&&(l.Telemetry.sendTelemetryEvent(r.TelemetryEventNames.AUDIO_MUTE),await this.callingServiceProxy.mute(e),e||(await r.ExtensionUtil.setCommandContext("liveshare:audioIsMuted","true"),this.muteChangedEventEmitter.fire(void 0)))}async unmute(e){this.isCallStarted&&(l.Telemetry.sendTelemetryEvent(r.TelemetryEventNames.AUDIO_UNMUTE),await this.callingServiceProxy.unmute(e),e||(await r.ExtensionUtil.setCommandContext("liveshare:audioIsMuted","false"),this.muteChangedEventEmitter.fire(void 0)))}async setDevice(e,t){if(!this.isCallStarted)return;const n=await this.getSelectedDevices();let i;switch(t){case"Microphone":i=r.SettingKeys.microphoneId,n.microphone=e;break;case"Speaker":i=r.SettingKeys.speakerId,n.speaker=e;break;default:return}l.Telemetry.sendTelemetryEvent(r.TelemetryEventNames.AUDIO_SELECT_DEVICE,{[r.TelemetryPropertyNames.AUDIO_DEVICE_TYPE]:t}),await this.callingServiceProxy.selectDevices(n),await r.Settings.save(i,e)}async dispose(){this.isDisposed||(this.isDisposed=!0,this.isCallStarted=!1,this.currentTokenInfo=null)}async connectToCall(e){try{this.isCallStarted=!1;const t=`99:${e}`;let n;const i=await this.authCoreService.getCurrentUserAsync();i&&(n=i.displayName||i.userName||i.emailAddress),n=n||"Unknown user";const s=await this.getVSLSToken();await this.callingServiceProxy.startOrJoinCall(t,n,s),this.isCallStarted=!0,await this.setUserPreferences()}catch(e){if(!this.isDisposed)throw this.trace.error(`Failed to connect call: ${e.message} ${e.stack}`),e;throw new a.CancellationError(e.message)}}async registerCommands(){await r.ExtensionUtil.tryRegisterCommand(c.CallingServiceCommands.startOrJoinCall,async()=>await this.commandStartOrJoinCall()),await r.ExtensionUtil.tryRegisterCommand(c.CallingServiceCommands.endCall,async()=>await this.leaveCall()),await r.ExtensionUtil.tryRegisterCommand(c.CallingServiceCommands.muteSelf,async()=>await this.mute()),await r.ExtensionUtil.tryRegisterCommand(c.CallingServiceCommands.unmuteSelf,async()=>await this.unmute()),await r.ExtensionUtil.tryRegisterCommand(c.CallingServiceCommands.muteOrUnmute,async()=>await this.muteOrUnmute()),await r.ExtensionUtil.tryRegisterCommand(c.CallingServiceCommands.selectMicrophone,async()=>await this.selectMicrophone()),await r.ExtensionUtil.tryRegisterCommand(c.CallingServiceCommands.selectSpeaker,async()=>await this.selectSpeaker()),await r.ExtensionUtil.tryRegisterCommand(c.CallingServiceCommands.setMicrophone,async e=>await this.setDevice(e,"Microphone")),await r.ExtensionUtil.tryRegisterCommand(c.CallingServiceCommands.setSpeaker,async e=>await this.setDevice(e,"Speaker")),await r.ExtensionUtil.tryRegisterCommand(c.CallingServiceCommands.viewParticipants,async()=>await this.viewParticipants())}async muteOrUnmute(){await this.isMuted()?await this.unmute():await this.mute()}async leaveCall(){try{u.AudioSessionContext.transition(u.AudioSessionAction.AttemptDisconnectAudio),await r.ExtensionUtil.runWithProgress(async()=>await this.endCall(),{title:r.localize("calling.disconnectingAudio")}),u.AudioSessionContext.transition(u.AudioSessionAction.AudioDisconnected)}catch(e){throw this.trace.error(`leaveAudio: Caught error: ${e.message} ${e.stack}`),u.AudioSessionContext.transition(u.AudioSessionAction.AudioConnectionFailed),e}}async viewParticipants(){const e=(await this.callingServiceProxy.getParticipants()).map(e=>({label:"",description:e.displayName}));return i.window.showQuickPick(e,{placeHolder:r.localize("calling.viewParticipantsQuickPickPlaceholder")})}async selectMicrophone(){const e=await this.buildDeviceList("Microphone");return this.showEnabledQuickPick(e,{placeHolder:r.localize("calling.selectMicrophoneQuickPickPlaceholder")}).then(e=>e&&i.commands.executeCommand(e.command,e.commandArg))}async selectSpeaker(){const e=await this.buildDeviceList("Speaker");return this.showEnabledQuickPick(e,{placeHolder:r.localize("calling.selectSpeakersQuickPickPlaceholder")}).then(e=>e&&i.commands.executeCommand(e.command,e.commandArg))}async buildDeviceList(e){const t=await this.enumerateDevices(),n=await this.getSelectedDevices();return t.filter(t=>t.type===e).map(t=>({command:`liveshare.callingService.setDevice.${e.toLowerCase()}`,commandArg:t.id,label:`${this.isSelectedDevice(t,n)?"$(check)":"   "} ${t.name}`,enabled:()=>!0}))}isSelectedDevice(e,t){if(!e)return!1;switch(e.type){case"Camera":return t.camera&&e.id===t.camera;case"Microphone":return t.microphone&&e.id===t.microphone;case"Speaker":return t.speaker&&e.id===t.speaker;default:return!1}}showEnabledQuickPick(e,t){return i.window.showQuickPick(e.filter(e=>e.enabled()),t)}async setUserPreferences(){const e=r.Settings.get(r.SettingKeys.microphoneId);e&&await this.setDevice(e,"Microphone");const t=r.Settings.get(r.SettingKeys.speakerId);t&&await this.setDevice(t,"Speaker")}async onCallChanged(e){switch(this.trace.info(`Call changed event received from calling service: ${e.changeType}`),e.changeType){case s.CallChangedType.callStarted:const t=e.info;this.sendCallStartedNotification(t);break;case s.CallChangedType.callDisconnected:u.AudioSessionContext.transition(u.AudioSessionAction.AudioDisconnected),this.checkIfCallIsAvailable();break;case s.CallChangedType.participantsListChanged:this.participantsListChangedEventEmitter.fire();break;case s.CallChangedType.participantChanged:const n=e.info;this.participantChangedEventEmitter.fire(n);break;default:throw new Error(`Unexpected call change type: ${e.changeType}`)}}sendCallStartedNotification(e){const t={callingEventType:c.CallingEventType.CallStarted,groupContext:e.callId,callId:e.callId};this.messagingService.notify(t)}async getVSLSToken(){return this.currentTokenInfo&&(new Date).getTime()<this.currentTokenInfo.expiresIn-36e5||(this.currentTokenInfo=await o.getVSLSTokenFromAuthService(this.trace)),this.currentTokenInfo}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(1211),s=n(49),r=n(87);class o{constructor(){let e,t;this.promise=new Promise((n,i)=>{e=n,t=i}),this.deferredReject=t,this.deferredResolve=e}resolve(e){this.deferredResolve(e)}reject(e){this.deferredReject(e)}}t.DeferredPromise=o,t.getVSLSTokenFromAuthService=async function(t){const n={hostname:"authsvc-server.teams.microsoft.com",port:443,path:"/v1.0/authz/visitor",method:"POST",headers:{"Content-Type":"application/json","x-ms-request-id":s(),"x-ms-client-type":"ms-vsliveshare.vsliveshare"}},a=JSON.stringify({tenantId:r.AUTH_TOKEN_TENANT_ID});let c;const l=new o;let u="";const d=i.request(n,e=>{200===e.statusCode?(e.setEncoding("utf8"),e.on("data",e=>{u+=e}),e.on("end",(function(){const e=JSON.parse(u);c=e.tokens,l.resolve()}))):l.reject(`Expected 200 status code to get SkypeToken. status code: ${e.statusCode}`)});if(d.on("error",e=>{l.reject(`HTTPS request failed for SkypeToken: ${e.message}`)}),d.write(a),d.end(),await l.promise.catch(e=>{throw new Error(e)}),!c)throw new Error("Error retrieving SkypeToken");return c.skypeId=function(t){try{const n=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),i=JSON.parse(e.from(n,"base64").toString("ascii"));if(!i.skypeid)throw new Error("skypeid claim not found");return i.skypeid}catch(e){throw new Error(`Cannot retrieve skypeid from token: ${e.message}`)}}(c.skypeToken),c}}).call(this,n(3).Buffer)},function(e,t,n){var i=n(1212),s=n(32),r=e.exports;for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o]);function a(e){if("string"==typeof e&&(e=s.parse(e)),e.protocol||(e.protocol="https:"),"https:"!==e.protocol)throw new Error('Protocol "'+e.protocol+'" not supported. Expected "https:"');return e}r.request=function(e,t){return e=a(e),i.request.call(this,e,t)},r.get=function(e,t){return e=a(e),i.get.call(this,e,t)}},function(e,t,n){(function(e){var i=n(1213),s=n(506),r=n(1215),o=n(1216),a=n(32),c=t;c.request=function(t,n){t="string"==typeof t?a.parse(t):r(t);var s=-1===e.location.protocol.search(/^https?:$/)?"http:":"",o=t.protocol||s,c=t.hostname||t.host,l=t.port,u=t.path||"/";c&&-1!==c.indexOf(":")&&(c="["+c+"]"),t.url=(c?o+"//"+c:"")+(l?":"+l:"")+u,t.method=(t.method||"GET").toUpperCase(),t.headers=t.headers||{};var d=new i(t);return n&&d.on("response",n),d},c.get=function(e,t){var n=c.request(e,t);return n.end(),n},c.ClientRequest=i,c.IncomingMessage=s.IncomingMessage,c.Agent=function(){},c.Agent.defaultMaxSockets=4,c.globalAgent=new c.Agent,c.STATUS_CODES=o,c.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this,n(27))},function(e,t,n){(function(t,i,s){var r=n(505),o=n(12),a=n(506),c=n(76),l=n(1214),u=a.IncomingMessage,d=a.readyStates;var h=e.exports=function(e){var n,i=this;c.Writable.call(i),i._opts=e,i._body=[],i._headers={},e.auth&&i.setHeader("Authorization","Basic "+new t(e.auth).toString("base64")),Object.keys(e.headers).forEach((function(t){i.setHeader(t,e.headers[t])}));var s=!0;if("disable-fetch"===e.mode||"requestTimeout"in e&&!r.abortController)s=!1,n=!0;else if("prefer-streaming"===e.mode)n=!1;else if("allow-wrong-content-type"===e.mode)n=!r.overrideMimeType;else{if(e.mode&&"default"!==e.mode&&"prefer-fast"!==e.mode)throw new Error("Invalid value for opts.mode");n=!0}i._mode=function(e,t){return r.fetch&&t?"fetch":r.mozchunkedarraybuffer?"moz-chunked-arraybuffer":r.msstream?"ms-stream":r.arraybuffer&&e?"arraybuffer":r.vbArray&&e?"text:vbarray":"text"}(n,s),i._fetchTimer=null,i.on("finish",(function(){i._onFinish()}))};o(h,c.Writable),h.prototype.setHeader=function(e,t){var n=e.toLowerCase();-1===f.indexOf(n)&&(this._headers[n]={name:e,value:t})},h.prototype.getHeader=function(e){var t=this._headers[e.toLowerCase()];return t?t.value:null},h.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},h.prototype._onFinish=function(){var e=this;if(!e._destroyed){var n=e._opts,o=e._headers,a=null;"GET"!==n.method&&"HEAD"!==n.method&&(a=r.arraybuffer?l(t.concat(e._body)):r.blobConstructor?new i.Blob(e._body.map((function(e){return l(e)})),{type:(o["content-type"]||{}).value||""}):t.concat(e._body).toString());var c=[];if(Object.keys(o).forEach((function(e){var t=o[e].name,n=o[e].value;Array.isArray(n)?n.forEach((function(e){c.push([t,e])})):c.push([t,n])})),"fetch"===e._mode){var u=null;if(r.abortController){var h=new AbortController;u=h.signal,e._fetchAbortController=h,"requestTimeout"in n&&0!==n.requestTimeout&&(e._fetchTimer=i.setTimeout((function(){e.emit("requestTimeout"),e._fetchAbortController&&e._fetchAbortController.abort()}),n.requestTimeout))}i.fetch(e._opts.url,{method:e._opts.method,headers:c,body:a||void 0,mode:"cors",credentials:n.withCredentials?"include":"same-origin",signal:u}).then((function(t){e._fetchResponse=t,e._connect()}),(function(t){i.clearTimeout(e._fetchTimer),e._destroyed||e.emit("error",t)}))}else{var f=e._xhr=new i.XMLHttpRequest;try{f.open(e._opts.method,e._opts.url,!0)}catch(t){return void s.nextTick((function(){e.emit("error",t)}))}"responseType"in f&&(f.responseType=e._mode.split(":")[0]),"withCredentials"in f&&(f.withCredentials=!!n.withCredentials),"text"===e._mode&&"overrideMimeType"in f&&f.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in n&&(f.timeout=n.requestTimeout,f.ontimeout=function(){e.emit("requestTimeout")}),c.forEach((function(e){f.setRequestHeader(e[0],e[1])})),e._response=null,f.onreadystatechange=function(){switch(f.readyState){case d.LOADING:case d.DONE:e._onXHRProgress()}},"moz-chunked-arraybuffer"===e._mode&&(f.onprogress=function(){e._onXHRProgress()}),f.onerror=function(){e._destroyed||e.emit("error",new Error("XHR error"))};try{f.send(a)}catch(t){return void s.nextTick((function(){e.emit("error",t)}))}}}},h.prototype._onXHRProgress=function(){(function(e){try{var t=e.status;return null!==t&&0!==t}catch(e){return!1}})(this._xhr)&&!this._destroyed&&(this._response||this._connect(),this._response._onXHRProgress())},h.prototype._connect=function(){var e=this;e._destroyed||(e._response=new u(e._xhr,e._fetchResponse,e._mode,e._fetchTimer),e._response.on("error",(function(t){e.emit("error",t)})),e.emit("response",e._response))},h.prototype._write=function(e,t,n){this._body.push(e),n()},h.prototype.abort=h.prototype.destroy=function(){this._destroyed=!0,i.clearTimeout(this._fetchTimer),this._response&&(this._response._destroyed=!0),this._xhr?this._xhr.abort():this._fetchAbortController&&this._fetchAbortController.abort()},h.prototype.end=function(e,t,n){"function"==typeof e&&(n=e,e=void 0),c.Writable.prototype.end.call(this,e,t,n)},h.prototype.flushHeaders=function(){},h.prototype.setTimeout=function(){},h.prototype.setNoDelay=function(){},h.prototype.setSocketKeepAlive=function(){};var f=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this,n(3).Buffer,n(27),n(11))},function(e,t,n){var i=n(3).Buffer;e.exports=function(e){if(e instanceof Uint8Array){if(0===e.byteOffset&&e.byteLength===e.buffer.byteLength)return e.buffer;if("function"==typeof e.buffer.slice)return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}if(i.isBuffer(e)){for(var t=new Uint8Array(e.length),n=e.length,s=0;s<n;s++)t[s]=e[s];return t.buffer}throw new Error("Argument must be a Buffer")}},function(e,t){e.exports=function(){for(var e={},t=0;t<arguments.length;t++){var i=arguments[t];for(var s in i)n.call(i,s)&&(e[s]=i[s])}return e};var n=Object.prototype.hasOwnProperty},function(e,t){e.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(504),r=n(4);t.CallingServiceProxy=class{async initialize(e){await r.ExtensionUtil.tryRegisterCommand(s.CallingServiceProxyCommands.onCallChangedEvent,async t=>await e(t))}async getCallInfo(){return await i.commands.executeCommand(s.CallingServiceProxyCommands.getCallInfo)}async startOrJoinCall(e,t,n){return await i.commands.executeCommand(s.CallingServiceProxyCommands.startOrJoinCall,e,t,n)}async getDevices(){return await i.commands.executeCommand(s.CallingServiceProxyCommands.getDevices)}async getSelectedDevices(){return await i.commands.executeCommand(s.CallingServiceProxyCommands.getSelectedDevices)}async selectDevices(e){return await i.commands.executeCommand(s.CallingServiceProxyCommands.selectDevices,e)}async getParticipants(){return await i.commands.executeCommand(s.CallingServiceProxyCommands.getParticipants)}async endCall(){return await i.commands.executeCommand(s.CallingServiceProxyCommands.endCall)}async isMuted(){return await i.commands.executeCommand(s.CallingServiceProxyCommands.isMuted)}async mute(e){return await i.commands.executeCommand(s.CallingServiceProxyCommands.mute,e)}async unmute(e){return await i.commands.executeCommand(s.CallingServiceProxyCommands.unmute,e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(294),r=n(4),o=n(87);t.AudioStatusBarController=class{constructor(e,t){this.callingServiceManager=e,this.trace=t,this.updateStatusBarPromise=Promise.resolve(),this.audioConnectedStatusBarItem=i.window.createStatusBarItem(i.StatusBarAlignment.Left,2),this.audioConnectedStatusBarItem.hide(),this.updateStatusBar(new c),s.AudioSessionContext.addListener(s.AudioSessionEvents.StateChanged,async(e,t)=>await this.onSessionStateChanged(e)),this.callingServiceManager.onMuteChanged(async()=>await this.onMuteChanged())}async onMuteChanged(){const e=await this.callingServiceManager.isMuted();this.trace.info(`mute changed isMuted:${e}`),this.audioConnectedStatusBarItem.text=e?"$(mute)":"$(unmute)"}updateStatusBar(e){const t=this.currentState;this.currentState=e,t&&t.dispose(),e.updateAudioConnectedStatusBarItem(this.audioConnectedStatusBarItem)}async onSessionStateChanged(e){let t=this.getStatusBarState(e);this.updateStatusBarPromise=this.updateStatusBarPromise.then(async()=>{this.updateStatusBar(t),await r.ExtensionUtil.setCommandContext("liveshare:audioSessionState",e.toString())})}getStatusBarState(e){switch(e){case s.AudioSessionState.LiveShareWithAudio:return new l(this.callingServiceManager);default:return new c}}};class a{constructor(){this.disposed=!1}updateStatusBarItem(e){this.hideItem(e)}updateAudioConnectedStatusBarItem(e){this.hideItem(e)}hideItem(e){e.hide(),e.text=void 0,e.command=void 0,e.tooltip=void 0}showQuickPick(e,t){return i.window.showQuickPick(e.filter(e=>e.enabled()),t)}dispose(){this.disposed=!0}}t.StatusBarState=a;class c extends a{}t.NoAudioState=c;class l extends a{constructor(e){super(),this.callingService=e}async updateAudioConnectedStatusBarItem(e){const t=o.CallingServiceCommands.callSettings;await r.ExtensionUtil.tryRegisterCommand(t,async()=>this.showQuickPick(await this.connectedQuickPickItems(),{placeHolder:r.localize("calling.quickPickConnectedPlaceholder")}).then(e=>e&&i.commands.executeCommand(e.command,e.commandArg))),e.text=await this.callingService.isMuted()?"$(mute)":"$(unmute)",e.command=t,e.show()}async connectedQuickPickItems(){let e=await this.callingService.isMuted();return[{label:r.localize("calling.quickPickDisconnectLabel"),description:"",detail:r.localize("calling.quickPickDisconnectDetail"),command:o.CallingServiceCommands.endCall,enabled:()=>!0},{label:e?r.localize("calling.quickPickUnmuteYourselfLabel"):r.localize("calling.quickPickMuteYourselfLabel"),description:"",detail:e?r.localize("calling.quickPickUnmuteYourselfDetail"):r.localize("calling.quickPickMuteYourselfDetail"),command:o.CallingServiceCommands.muteOrUnmute,enabled:()=>!0},{label:r.localize("calling.quickPickViewParticipantsLabel"),description:"",detail:r.localize("calling.quickPickViewParticipantsDetail"),command:o.CallingServiceCommands.viewParticipants,enabled:()=>!0},{label:r.localize("calling.quickPickConfigureSpeakersLabel"),description:"",detail:r.localize("calling.quickPickConfigureSpeakersDetail"),command:o.CallingServiceCommands.selectSpeaker,enabled:()=>!0},{label:r.localize("calling.quickPickConfigureMicrophoneLabel"),description:"",detail:r.localize("calling.quickPickConfigureMicrophoneDetail"),command:o.CallingServiceCommands.selectMicrophone,enabled:()=>!0}]}}t.LiveShareWithAudioState=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(87);t.MessagingService=class{constructor(e,t,n,i){this.name=e,this.rpcClient=t,this.registeredServicesCallback=n,this.trace=i}async initialize(){this.name=`${i.MESSAGE_SERVICE_NAME}.${i.MESSAGE_SERVICE_NOTIFICATION_EVENT_NAME}`,this.connection=await this.rpcClient.ensureConnectionAsync();const e=await this.registeredServicesCallback();(null==e?void 0:e.includes(i.MESSAGE_SERVICE_NAME))&&(this.isServiceAvailable=!0)}onNotify(e){this.trace.verbose(`onNotify(${this.name})`),this.connection.onNotification(this.name,(...t)=>{const n=t[0];this.trace.verbose(`onNotify(${this.name})`);try{e(n)}catch(e){this.trace.warning(`Notification handler (${this.name}) failed: `+e.message)}})}notify(e){if(this.isServiceAvailable){this.trace.verbose(`notify(${this.name})`);try{this.connection.sendNotification(this.name,[e])}catch(e){this.trace.warning(`notify(${this.name}) failed: `+e.message)}}else this.trace.verbose(`notify(${this.name}) - service not available`)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(87),s=n(4),r=n(109),o=n(507);t.chatViewItem="chat";class a extends s.TreeDataProviderBase{constructor(){super(t.chatViewItem,s.TreeDataProviderContext.SharedOrJoined),r.CommunicationsManager.onChatViewChanged(()=>this.forceRefreshItems())}async getChildrenItems(e){}async getRootItem(){var e;const n=null===(e=r.CommunicationsManager.chatViewController)||void 0===e?void 0:e.chatWindowInfo();if(!n)return;let a=o.formatUnreadLabel(s.localize("chat.sessionChatLabel"),n.unread);return new s.TreeViewItem({type:t.chatViewItem,label:a,tooltip:a,command:{title:s.localize("chat.openSessionChatWindow"),command:"liveshare.openSessionChat",arguments:[i.VSLS_CHAT_WINDOW]}})}}t.ChatTreeDataProvider=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(4),r=n(294),o=n(109),a=n(87),c=n(507);var l;t.audioViewItem="audio",function(e){e.Disconnected="audio.disconnected",e.StartOrJoin="audio.startOrJoin",e.Connecting="audio.connecting",e.Disconnecting="audio.disconnecting",e.ParticipantsList="audio.participants",e.Participant="audio.participant",e.ParticipantMuted="audio.participant.muted",e.Self="audio.self",e.SelfMuted="audio.self.muted"}(l||(l={}));class u extends s.TreeViewItem{constructor(e){super(e),this.options=e,this.participantId=e.participantId}}class d extends s.TreeDataProviderBase{constructor(e,n){super(t.audioViewItem,s.TreeDataProviderContext.SharedOrJoined),this.authCoreService=e,this.clientAccessCheck=n,this.isCallAvailable=!1,this.isChildItemCacheDisabled=!0,this.initialize()}initialize(){this.callingService=o.CommunicationsManager.callingServiceManager,this.participantsListItem=new u({type:l.ParticipantsList,label:s.localize("calling.treeAudioCallParticipantsInitial"),collapsibleState:i.TreeItemCollapsibleState.Expanded,contextValue:l.ParticipantsList}),this.participantItems=new Map,this.selfItem=new u({type:l.Self,label:"",contextValue:l.Self}),r.AudioSessionContext.addListener(r.AudioSessionEvents.StateChanged,async e=>await this.onSessionStateChanged(e)),this.sessionState=r.AudioSessionState.LiveShareWithoutAudio,this.callingService.onNewAudioCallAvailable(()=>{this.isCallAvailable=!0,this.refresh()}),this.callingService.onMuteChanged(async e=>await this.onMuteChanged(e)),this.callingService.onParticipantsListChanged(async()=>this.refresh(await this.updateParticipantsListItem())),this.callingService.onParticipantChanged(e=>this.onParticipantChanged(e)),this.callingService.checkIfCallIsAvailable()}async getChildrenItems(e){let t;switch(e.contextValue){case l.Disconnected:switch(this.sessionState){case r.AudioSessionState.LiveShareWithoutAudio:return t=this.isCallAvailable?s.localize("calling.treeJoinAudioCall"):s.localize("calling.treeStartAudioCall"),[new u({type:l.StartOrJoin,label:t,command:{title:t,command:a.CallingServiceCommands.startOrJoinCall}})];case r.AudioSessionState.AudioConnecting:return t=this.isCallAvailable?s.localize("calling.treeJoiningAudioCall"):s.localize("calling.treeStartingAudioCall"),[new u({type:l.Connecting,label:t,iconPath:s.TreeDataProviderBase.getThemeIconPath("loading")})];default:return[]}case l.ParticipantsList:switch(this.sessionState){case r.AudioSessionState.AudioDisconnecting:return[new u({type:l.Disconnecting,label:s.localize("calling.treeEndingAudioCall"),iconPath:s.TreeDataProviderBase.getThemeIconPath("loading")})];default:return this.isCallAvailable=!1,await this.getCallParticipants()}default:return[]}}async getRootItem(){let e=void 0;switch(this.sessionState){case r.AudioSessionState.LiveShareWithoutAudio:case r.AudioSessionState.AudioConnecting:e=new u({type:l.Disconnected,label:s.localize("calling.treeAudioCallLabel"),collapsibleState:i.TreeItemCollapsibleState.Expanded});break;case r.AudioSessionState.AudioDisconnecting:e=new u({type:l.ParticipantsList,label:s.localize("calling.treeAudioCallLabel"),collapsibleState:i.TreeItemCollapsibleState.Expanded,contextValue:l.ParticipantsList});break;case r.AudioSessionState.LiveShareWithAudio:const t=1+(await this.callingService.getParticipants()).length;this.participantsListItem.label=s.localize("calling.treeAudioCallParticipantsCount").replace("$(participantCount)",t.toString()),e=this.participantsListItem;break;default:return}return e}async getCallParticipants(){const e=[],t=await this.callingService.getParticipants();for(let n of t)this.createOrUpdateTreeItemForParticipant(n),e.push(n.id);for(let t of Array.from(this.participantItems.keys()))e.indexOf(t)<0&&this.participantItems.delete(t);return[this.selfItem].concat(Array.from(this.participantItems.values()))}onParticipantChanged(e){this.refresh(this.createOrUpdateTreeItemForParticipant(e))}async updateParticipantsListItem(){return await this.getRootItem(),this.participantsListItem}createOrUpdateTreeItemForParticipant(e){const t=e.isMuted,n=!t&&e.isSpeaking,i=t?l.ParticipantMuted:l.Participant,r=s.TreeDataProviderBase.getThemeIconPath(t?"speaker-mute":n?"speaker-sound":"speaker");let o=this.participantItems.get(e.id);return o?(o.label=e.displayName,o.contextValue=i,o.iconPath=r):(o=new u({type:i,label:e.displayName,iconPath:r}),o.id=e.id,this.participantItems.set(e.id,o)),o}async onSessionStateChanged(e){this.sessionState=e,e===r.AudioSessionState.LiveShareWithAudio&&await this.updateTreeItemForSelf(),this.refresh()}async onMuteChanged(e){if(e){let t=this.participantItems.get(e.id);t&&this.refresh(t)}else await this.updateTreeItemForSelf(),this.refresh()}async updateTreeItemForSelf(){const e=await this.callingService.isMuted(),t=await this.authCoreService.getCurrentUserAsync();let n=t?t.displayName||t.userName||t.emailAddress:s.localize("calling.treeUnknownUser");const i=c.getCollaborators().find(e=>e.id===t.id);if(i){const e=await s.ExtensionUtil.getAnonymousReadOnlyLabel(this.clientAccessCheck(),i);n=`${i.name||n}${e}`}this.selfItem.label=s.localize("calling.treeSelfItem").replace("$(displayName)",n),this.selfItem.contextValue=e?l.SelfMuted:l.Self,this.selfItem.iconPath=s.TreeDataProviderBase.getThemeIconPath(e?"speaker-mute":"speaker")}async dispose(){for(;this.providerRegistrations.length>0;){const e=this.providerRegistrations.pop();await e.dispose()}}}t.AudioTreeDataProvider=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1223),s=n(1224);t.registerCommands=e=>{e.register("openSessionChat",i.builder),e.register("startOrJoinCall",s.StartOrJoinCallCommandBuilder)}},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const s=n(109),r=n(4);t.builder=function(){return new o};let o=class{async invoke(e,t){return await s.CommunicationsManager.openSessionChat("command_palette")}};o=i([r.telemetryCommandDecorator(r.TelemetryEventNames.CHAT_OPEN_SESSION,r.TelemetryEventNames.CHAT_OPEN_SESSION_FAULT,"OpenSessionChat",1)],o)},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const s=n(109),r=n(4);t.StartOrJoinCallCommandBuilder=function(){return new o};let o=class{async invoke(e,t){const n=s.CommunicationsManager.callingServiceManager;return await(null==n?void 0:n.commandStartOrJoinCall())}};o=i([r.telemetryCommandDecorator(r.TelemetryEventNames.START_OR_JOIN_AUDIO,r.TelemetryEventNames.START_OR_JOIN_AUDIO_FAULT,"StartOrJoinCall",1)],o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(5),r=n(4);t.ChatService=class{constructor(e){this.eventEmitter=new i.EventEmitter,this.messageHistory=[],this.participants=new Map,this.disposables=[],this.serviceInfo=s.vsls.ChatService,this.onMessageReceived=this.eventEmitter.event,this.disposables.push(e.workspaceUserService().onWorkspaceSessionChanged(e=>this.onUserSessionChanged(e)));const t=r.workspaceSessionInfoTracker.workspaceSessionInfo;if(!t)throw Error("workspaceSessionInfoTracker.workspaceSessionInfo is not set");const n=t.sessions[t.sessionNumber];this.addOrUpdateParticipant(n,t.sessionNumber)}async getMessageHistoryAsync(){return this.messageHistory}async getParticipantsAsync(){return Array.from(this.participants.values())}async sendMessageAsync(e,t,n){e.fromId=n.session.toString(),e.type===s.vsls.ChatMessageType.Text&&(200===this.messageHistory.length&&this.messageHistory.shift(),this.messageHistory.push(e)),this.eventEmitter.fire({message:e})}dispose(){for(const e of this.disposables)e.dispose();this.disposables=[]}async disposeAsync(){this.dispose()}onUserSessionChanged(e){this.addOrUpdateParticipant(e.userProfile,e.sessionNumber)}addOrUpdateParticipant(e,t){const n={name:e.name||e.userName,email:e.email,id:t.toString()};this.participants.set(t,n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(508);t.HubConnectionService=i.HubConnectionService;var s=n(1236);t.HubConnectionServiceFactory=s.HubConnectionServiceFactory;var r=n(1237);t.PresenceServiceProvider=r.PresenceServiceProvider},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1228);t.HubClient=i.HubClient},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(17),s=n(1229),r=n(64),o=n(1231),a=n(1232);class c{constructor(e,t){this.hubConnection=e,this.logger=t,this.isRunningFlag=!1,this.attemptConnectionCallbacks=new r.CallbackContainer,this.connectionStateCallbacks=new r.CallbackContainer,this.connectSleepCancellation=new a.CancellationToken,e.onclose(e=>this.onClosed(e)),this.hubProxyInstance=new o.HubProxy(this)}static createWithHub(e,t){return new c(e,t)}static create(e,t,n){return n&&n.log(i.LogLevel.Debug,`createWithOptions url:${e}`),new c((new i.HubConnectionBuilder).withUrl(e,t).build(),n)}get hubProxy(){return this.hubProxyInstance}start(){return this.isRunning||(this.log(i.LogLevel.Debug,"HubClient.start"),this.isRunningFlag=!0,this.state===i.HubConnectionState.Connected)?Promise.resolve():this.attemptConnect()}async stop(){this.isRunning&&(this.log(i.LogLevel.Debug,"HubClient.stop"),this.isRunningFlag=!1,await this.hubConnection.stop())}connect(){return this.state===i.HubConnectionState.Connected?Promise.resolve():new Promise((e,t)=>{const n=this.onAttemptConnection((s,r,o)=>(this.log(i.LogLevel.Debug,`connect err:${o}`),n.dispose(),o?t(o):e(),Promise.resolve()));this.isRunning?this.connectSleepCancellation.cancel():this.start()})}get state(){return this.hubConnection.state}get isConnected(){return this.state===i.HubConnectionState.Connected}get isRunning(){return this.isRunningFlag}onAttemptConnection(e){return this.attemptConnectionCallbacks.add(e)}onConnectionStateChanged(e){return this.connectionStateCallbacks.add(e)}async attemptConnect(){this.log(i.LogLevel.Debug,"attemptConnect"),await this.fireAttemptConnection(0,0,void 0),await s.connect(this.hubConnection,async(e,t,n)=>this.isRunningFlag?(await this.fireAttemptConnection(e,t,n),void 0!==t?t:0):-1,-1,5e3,6e4,this.logger?this.logger:i.NullLogger.instance,this.connectSleepCancellation),this.isConnected&&await this.fireConnectionStateChanged()}async onClosed(e){this.log(i.LogLevel.Debug,`onClosed error:${e}`),await this.fireConnectionStateChanged(),this.isRunning&&this.attemptConnect()}log(e,t){this.logger&&this.logger.log(e,t)}async fireConnectionStateChanged(){for(const e of this.connectionStateCallbacks.items)await e()}async fireAttemptConnection(e,t,n){for(const i of this.attemptConnectionCallbacks.items)await i(e,t,n)}}t.HubClient=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(17),s=n(1230);function r(e,t){return new Promise(n=>{let i;const s=()=>{i&&i.dispose(),n()},r=setTimeout(()=>{s()},e);i=t.onCancellationRequest(()=>{clearTimeout(r),s()})})}t.connect=async function(e,t,n,o,a,c,l){const u=new s.ExponentialBackoff(n,o,a);for(;;)try{c.log(i.LogLevel.Debug,`hubConnection.start -> retries:${u.retriesCount}`),await e.start(),await t(u.retriesCount),c.log(i.LogLevel.Debug,"Succesfully connected...");break}catch(e){let n=u.nextDelayMilliseconds();if(c.log(i.LogLevel.Error,`Failed to connect-> delay:${n} err:${JSON.stringify(e)}`),n=await t(u.retriesCount,n,e),-1===n)break;await r(n,l)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ExponentialBackoff=class{constructor(e,t,n){this.maxRetries=e,this.delayMilliseconds=t,this.maxDelayMilliseconds=n,this.retries=0,this.pow=1}get retriesCount(){return this.retries}nextDelayMilliseconds(){if(-1!==this.maxRetries&&this.retries===this.maxRetries)throw new Error("Max retry attempts exceeded.");return++this.retries,this.retries<31&&(this.pow=this.pow<<1),Math.min(this.delayMilliseconds*(this.pow-1)/2,this.maxDelayMilliseconds)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.HubProxy=class{constructor(e){this.hubClient=e}get hubConnection(){return this.hubClient.hubConnection}get isConnected(){return this.hubClient.isConnected}connect(){return this.hubClient.connect()}onConnectionStateChanged(e){return this.hubClient.onConnectionStateChanged(e)}send(e,...t){return this.hubConnection.send(e,...t)}invoke(e,...t){return this.hubConnection.invoke(e,...t)}on(e,t){return this.hubConnection.on(e,t),{dispose:()=>this.hubConnection.off(e)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(64);t.CancellationToken=class{constructor(){this.cancellationRequestCallbacks=new i.CallbackContainer}onCancellationRequest(e){return this.cancellationRequestCallbacks.add(e)}cancel(){for(const e of this.cancellationRequestCallbacks.items)e()}}},function(e,t,n){"use strict";var i=n(76).Transform,s=n(12),r=n(186);function o(e){(e=e||{}).objectMode=!0,e.highWaterMark=16,i.call(this,e),this._msgpack=e.msgpack}function a(e){if(!(this instanceof a))return(e=e||{}).msgpack=this,new a(e);o.call(this,e),this._wrap="wrap"in e&&e.wrap}function c(e){if(!(this instanceof c))return(e=e||{}).msgpack=this,new c(e);o.call(this,e),this._chunks=r(),this._wrap="wrap"in e&&e.wrap}s(o,i),s(a,o),a.prototype._transform=function(e,t,n){var i=null;try{i=this._msgpack.encode(this._wrap?e.value:e).slice(0)}catch(e){return this.emit("error",e),n()}this.push(i),n()},s(c,o),c.prototype._transform=function(e,t,n){e&&this._chunks.append(e);try{var i=this._msgpack.decode(this._chunks);this._wrap&&(i={value:i}),this.push(i)}catch(e){return void(e instanceof this._msgpack.IncompleteBufferError?n():this.emit("error",e))}this._chunks.length>0?this._transform(null,t,n):n()},e.exports.decoder=c,e.exports.encoder=a},function(e,t,n){"use strict";var i=n(186);function s(e){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=e||"unable to decode"}n(59).inherits(s,Error),e.exports=function(e,t){return function(e){e instanceof i||(e=i().append(e));var t=o(e);if(t)return e.consume(t.bytesConsumed),t.value;throw new s};function n(e,t,n){return t>=n+e}function r(e,t){return{value:e,bytesConsumed:t}}function o(e,t){t=void 0===t?0:t;var i=e.length-t;if(i<=0)return null;var s,o,d,h=e.readUInt8(t),f=0;if(!function(e,t){var n=function(e){switch(e){case 196:return 2;case 197:return 3;case 198:return 5;case 199:return 3;case 200:return 4;case 201:return 6;case 202:return 5;case 203:return 9;case 204:return 2;case 205:return 3;case 206:return 5;case 207:return 9;case 208:return 2;case 209:return 3;case 210:return 5;case 211:return 9;case 212:return 3;case 213:return 4;case 214:return 6;case 215:return 10;case 216:return 18;case 217:return 2;case 218:return 3;case 219:return 5;case 222:return 3;default:return-1}}(e);return!(-1!==n&&t<n)}(h,i))return null;switch(h){case 192:return r(null,1);case 194:return r(!1,1);case 195:return r(!0,1);case 204:return r(f=e.readUInt8(t+1),2);case 205:return r(f=e.readUInt16BE(t+1),3);case 206:return r(f=e.readUInt32BE(t+1),5);case 207:for(d=7;d>=0;d--)f+=e.readUInt8(t+d+1)*Math.pow(2,8*(7-d));return r(f,9);case 208:return r(f=e.readInt8(t+1),2);case 209:return r(f=e.readInt16BE(t+1),3);case 210:return r(f=e.readInt32BE(t+1),5);case 211:return r(f=function(e,t){var n=128==(128&e[t]);if(n)for(var i=1,s=t+7;s>=t;s--){var r=(255^e[s])+i;e[s]=255&r,i=r>>8}var o=e.readUInt32BE(t+0),a=e.readUInt32BE(t+4);return(4294967296*o+a)*(n?-1:1)}(e.slice(t+1,t+9),0),9);case 202:return r(f=e.readFloatBE(t+1),5);case 203:return r(f=e.readDoubleBE(t+1),9);case 217:return n(s=e.readUInt8(t+1),i,2)?r(f=e.toString("utf8",t+2,t+2+s),2+s):null;case 218:return n(s=e.readUInt16BE(t+1),i,3)?r(f=e.toString("utf8",t+3,t+3+s),3+s):null;case 219:return n(s=e.readUInt32BE(t+1),i,5)?r(f=e.toString("utf8",t+5,t+5+s),5+s):null;case 196:return n(s=e.readUInt8(t+1),i,2)?r(f=e.slice(t+2,t+2+s),2+s):null;case 197:return n(s=e.readUInt16BE(t+1),i,3)?r(f=e.slice(t+3,t+3+s),3+s):null;case 198:return n(s=e.readUInt32BE(t+1),i,5)?r(f=e.slice(t+5,t+5+s),5+s):null;case 220:return i<3?null:(s=e.readUInt16BE(t+1),a(e,t,s,3));case 221:return i<5?null:(s=e.readUInt32BE(t+1),a(e,t,s,5));case 222:return s=e.readUInt16BE(t+1),c(e,t,s,3);case 223:return s=e.readUInt32BE(t+1),c(e,t,s,5);case 212:return l(e,t,1);case 213:return l(e,t,2);case 214:return l(e,t,4);case 215:return l(e,t,8);case 216:return l(e,t,16);case 199:return s=e.readUInt8(t+1),o=e.readUInt8(t+2),n(s,i,3)?u(e,t,o,s,3):null;case 200:return s=e.readUInt16BE(t+1),o=e.readUInt8(t+3),n(s,i,4)?u(e,t,o,s,4):null;case 201:return s=e.readUInt32BE(t+1),o=e.readUInt8(t+5),n(s,i,6)?u(e,t,o,s,6):null}if(144==(240&h))return a(e,t,s=15&h,1);if(128==(240&h))return c(e,t,s=15&h,1);if(160==(224&h))return n(s=31&h,i,1)?r(f=e.toString("utf8",t+1,t+s+1),s+1):null;if(h>=224)return r(f=h-256,1);if(h<128)return r(h,1);throw new Error("not implemented yet")}function a(e,t,n,i){var s,a=[],c=0;for(t+=i,s=0;s<n;s++){var l=o(e,t);if(!l)return null;a.push(l.value),t+=l.bytesConsumed,c+=l.bytesConsumed}return r(a,i+c)}function c(e,n,i,s){var a,c,l={},u=0;for(n+=s,c=0;c<i;c++){var d=o(e,n);if(!d)return null;var h=o(e,n+=d.bytesConsumed);if(!h)return null;if("__proto__"===(a=d.value)){if("error"===t.protoAction)throw new SyntaxError("Object contains forbidden prototype property");if("remove"===t.protoAction)continue}l[a]=h.value,n+=h.bytesConsumed,u+=d.bytesConsumed+h.bytesConsumed}return r(l,s+u)}function l(e,t,n){var i=e.readInt8(t+1);return u(e,t,i,n,2)}function u(t,n,i,s,o){var a,c;if(n+=o,i<0)switch(i){case-1:return function(e,t,n){var i,s=0;switch(t){case 4:i=e.readUInt32BE(0);break;case 8:var o=e.readUInt32BE(0),a=e.readUInt32BE(4);s=o/4,i=(3&o)*Math.pow(2,32)+a;break;case 12:throw new Error("timestamp 96 is not yet implemented")}var c=1e3*i+Math.round(s/1e6);return r(new Date(c),t+n)}(c=t.slice(n,n+s),s,o)}for(a=0;a<e.length;a++){if(i===e[a].type)return c=t.slice(n,n+s),r(e[a].decode(c),o+s)}throw new Error("unable to find ext type "+i)}},e.exports.IncompleteBufferError=s},function(e,t,n){"use strict";var i=n(14).Buffer,s=n(186);function r(e,t){var n,s=!0;return Math.fround&&(s=Math.fround(e)!==e),t&&(s=!0),s?((n=i.allocUnsafe(9))[0]=203,n.writeDoubleBE(e,1)):((n=i.allocUnsafe(5))[0]=202,n.writeFloatBE(e,1)),n}e.exports=function(e,t,n,o){function a(c,l){var u,d,h;if(void 0===c)throw new Error("undefined is not encodable in msgpack!");if((h=c)!=h&&"number"==typeof h)throw new Error("NaN is not encodable in msgpack!");if(null===c)(u=i.allocUnsafe(1))[0]=192;else if(!0===c)(u=i.allocUnsafe(1))[0]=195;else if(!1===c)(u=i.allocUnsafe(1))[0]=194;else if("string"==typeof c)(d=i.byteLength(c))<32?((u=i.allocUnsafe(1+d))[0]=160|d,d>0&&u.write(c,1)):d<=255&&!n?((u=i.allocUnsafe(2+d))[0]=217,u[1]=d,u.write(c,2)):d<=65535?((u=i.allocUnsafe(3+d))[0]=218,u.writeUInt16BE(d,1),u.write(c,3)):((u=i.allocUnsafe(5+d))[0]=219,u.writeUInt32BE(d,1),u.write(c,5));else if(c&&(c.readUInt32LE||c instanceof Uint8Array))c instanceof Uint8Array&&(c=i.from(c)),c.length<=255?((u=i.allocUnsafe(2))[0]=196,u[1]=c.length):c.length<=65535?((u=i.allocUnsafe(3))[0]=197,u.writeUInt16BE(c.length,1)):((u=i.allocUnsafe(5))[0]=198,u.writeUInt32BE(c.length,1)),u=s([u,c]);else if(Array.isArray(c))c.length<16?(u=i.allocUnsafe(1))[0]=144|c.length:c.length<65536?((u=i.allocUnsafe(3))[0]=220,u.writeUInt16BE(c.length,1)):((u=i.allocUnsafe(5))[0]=221,u.writeUInt32BE(c.length,1)),u=c.reduce((function(e,t){return e.append(a(t,!0)),e}),s().append(u));else{if(!o&&"function"==typeof c.getDate)return function(e){var t,n=1*e,r=Math.floor(n/1e3),o=1e6*(n-1e3*r);if(o||r>4294967295){(t=i.allocUnsafe(10))[0]=215,t[1]=-1;var a=4*o,c=r/Math.pow(2,32),l=a+c&4294967295,u=4294967295&r;t.writeInt32BE(l,2),t.writeInt32BE(u,6)}else(t=i.allocUnsafe(6))[0]=214,t[1]=-1,t.writeUInt32BE(Math.floor(n/1e3),2);return s().append(t)}(c);if("object"==typeof c)u=function(t){var n,r,o,a=[];for(n=0;n<e.length;n++)if(e[n].check(t)){r=e[n].encode(t);break}if(!r)return null;1===(o=r.length-1)?a.push(212):2===o?a.push(213):4===o?a.push(214):8===o?a.push(215):16===o?a.push(216):o<256?(a.push(199),a.push(o)):o<65536?(a.push(200),a.push(o>>8),a.push(255&o)):(a.push(201),a.push(o>>24),a.push(o>>16&255),a.push(o>>8&255),a.push(255&o));return s().append(i.from(a)).append(r)}(c)||function(e){var t,n,r=[],o=0;for(t in e)e.hasOwnProperty(t)&&void 0!==e[t]&&"function"!=typeof e[t]&&(++o,r.push(a(t,!0)),r.push(a(e[t],!0)));o<16?(n=i.allocUnsafe(1))[0]=128|o:o<65535?((n=i.allocUnsafe(3))[0]=222,n.writeUInt16BE(o,1)):((n=i.allocUnsafe(5))[0]=223,n.writeUInt32BE(o,1));return r.unshift(n),r.reduce((function(e,t){return e.append(t)}),s())}(c);else if("number"==typeof c){if(function(e){return e%1!=0}(c))return r(c,t);if(c>=0)if(c<128)(u=i.allocUnsafe(1))[0]=c;else if(c<256)(u=i.allocUnsafe(2))[0]=204,u[1]=c;else if(c<65536)(u=i.allocUnsafe(3))[0]=205,u.writeUInt16BE(c,1);else if(c<=4294967295)(u=i.allocUnsafe(5))[0]=206,u.writeUInt32BE(c,1);else{if(!(c<=9007199254740991))return r(c,!0);(u=i.allocUnsafe(9))[0]=207,function(e,t){for(var n=7;n>=0;n--)e[n+1]=255&t,t/=256}(u,c)}else if(c>=-32)(u=i.allocUnsafe(1))[0]=256+c;else if(c>=-128)(u=i.allocUnsafe(2))[0]=208,u.writeInt8(c,1);else if(c>=-32768)(u=i.allocUnsafe(3))[0]=209,u.writeInt16BE(c,1);else if(c>-214748365)(u=i.allocUnsafe(5))[0]=210,u.writeInt32BE(c,1);else{if(!(c>=-9007199254740991))return r(c,!0);(u=i.allocUnsafe(9))[0]=211,function(e,t,n){var i=n<0;i&&(n=Math.abs(n));var s=n%4294967296,r=n/4294967296;if(e.writeUInt32BE(Math.floor(r),t+0),e.writeUInt32BE(s,t+4),i)for(var o=1,a=t+7;a>=t;a--){var c=(255^e[a])+o;e[a]=255&c,o=c>>8}}(u,1,c)}}}if(!u)throw new Error("not implemented yet");return l?u:u.slice()}return a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(508),r=n(4),o=n(6),a=n(315);t.HubConnectionServiceFactory=class{constructor(e,t,n,r){this.authCoreService=e,this.signalRServiceUri=t,this.contactManager=n,this.logger=r,this.serviceMap=new Map,this.defaultHubConnectionServiceFactory=o.once(()=>(this.logger.verbose(`Creating default hub connection using uri:${t}`),s.HubConnectionService.create(e,t,r.createChild("default"))));const a=i.Uri.parse(t);a.scheme,a.authority,a.path.substring(0,a.path.lastIndexOf("/"));this.defaultStampRequest=o.once(()=>this.requestDefaultStamp())}async getOrCreate(e){if(!e||await this.getDefaultStamp()===e)return await this.defaultHubConnectionServiceFactory();let t=this.serviceMap.get(e);if(!t){this.logger.verbose(`Creating hub connection for stamp:${e}`);const n=i.Uri.parse(this.signalRServiceUri),r=`${n.scheme}://${e}-${n.authority}${n.path}`;t=await s.HubConnectionService.create(this.authCoreService,r,this.logger.createChild(`${e}`)),this.serviceMap.set(e,t)}return t}async requestDefaultStamp(){const e=i.Uri.parse(this.signalRServiceUri),t=`${e.scheme}://${e.authority}${e.path.substring(0,e.path.lastIndexOf("/"))}/status`,n=(new Date).getTime(),s=(await new a.HttpClient(this.logger.createChild("HttpClient")).get(t).value()).AppSettings.Stamp;return this.logger.verbose(`Request default stamp:${s} t:${(new Date).getTime()-n} ms`),s}async getDefaultStamp(){var e;const t=(new Date).getTime(),n=null===(e=this.contactManager)||void 0===e?void 0:e.getServiceManager(r.constants.LIVESHARE_PRESENCE_PROVIDER_ID),i=()=>{var e;return null===(e=null==n?void 0:n.selfUser)||void 0===e?void 0:e.properties.stamp};let s=i();const a=()=>{this.logger.verbose(`Default stamp:${s} from self contact t:${(new Date).getTime()-t} ms`)};if(s)return a(),s;const c=new o.Signal;return n&&n.once(r.ContactServiceEvents.SelfContactChanged,()=>{s=i(),s&&(a(),c.resolve(s))}),await Promise.race([this.defaultStampRequest(),c.promise])}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),s=n(107),r=n(4);var o;!function(e){e.email="email",e.displayName="name",e.status="status",e.avatarUri="avatarUri",e.contactId="contactId",e.idReserved="_Id"}(o||(o={}));const a=[o.email,o.displayName,o.status,o.avatarUri],c=e=>void 0!==a.find(t=>e===t),l=[i.contactProtocol.PresenceStatus.Unknown,i.contactProtocol.PresenceStatus.Available,i.contactProtocol.PresenceStatus.Busy,i.contactProtocol.PresenceStatus.DoNotDisturb,i.contactProtocol.PresenceStatus.Away,i.contactProtocol.PresenceStatus.Invisible,i.contactProtocol.PresenceStatus.Offline];class u extends s.ProviderBase{constructor(e,t){super(),this.hubConnectionService=e,this.traceSource=t,this.currentSubscriptions=new Map,this.contactServiceProxy=e.getOrCreateProxy(r.HubProxyType.ContactService),this.contactServiceProxy.onUpdateProperties((e,t,n)=>this.onUpdateProperties(e,t,n)),this.contactServiceProxy.onMessageReceived((e,t,n,i)=>this.onMessageReceived(e,t,n,i)),e.onAttemptStateChanged(()=>this.onAttemptStateChanged()),e.onConnectionStateChanged(()=>this.onConnectionStateChanged())}async requestAsync(e,t,n){if(e===i.contactProtocol.Methods.RequestInitializeName)return super.requestAsync(e,t,n);let s=null;switch(e){case i.contactProtocol.Methods.RequestSendMessageName:await this.requestSendMessage(t);break;case i.contactProtocol.Methods.RequestInviteName:await this.requestInvite(t);break;case i.contactProtocol.Methods.RequestPublishPresenceName:await this.requestPublishPresence(t);break;case i.contactProtocol.Methods.RequestContactPresenceName:s=await this.requestContactPresence(t);break;case i.contactProtocol.Methods.RequestContactPresenceDisposeName:await this.requestContactPresenceDispose(t);break;case i.contactProtocol.Methods.RequestSignInName:await this.requestSignIn(t);break;case i.contactProtocol.Methods.RequestSignOutName:await this.requestSignOut();break;default:throw new Error(`type:${e} not supported`)}return s}async requestInitialize(e){this.enablePublish=e.enablePublish,this.publishPresence=e.publishPresence;let t=null;this.isServiceConnected&&(t=u.userInfoToContact(this.userInfo));const n=new i.contactProtocol.InitializeResponse;return n.description="Live Share",n.capabilities=u.createCapabilites(this.capabilitiesEnabled),n.selfContact=t,n.signedState=this.isServiceConnected?i.contactProtocol.SignedStatus.SignedIn:this.isAttempting?i.contactProtocol.SignedStatus.SigningIn:i.contactProtocol.SignedStatus.SignedOut,n.providerPriority=0,n}get capabilitiesEnabled(){return this.isServiceConnected&&this.isAuthorizedUser}get isAuthorizedUser(){return!r.userAuthStateTracker.isCurrentUserAnonymous()}async requestSendMessage(e){await this.contactServiceProxy.sendMessage({id:e.targetContactId},e.type,e.body)}async requestInvite(e){const t={Link:e.link,Contact:{id:this.userInfo.id,email:this.userInfo.emailAddress,displayName:this.userInfo.displayName}};await this.contactServiceProxy.sendMessage({id:e.targetContactId},"inviteLink",t)}async requestPublishPresence(e){if(this.isPublishEnabled){this.publishPresence=e;const t={};e.status!==i.contactProtocol.PresenceStatus.Unknown&&(t[o.status]=e.status),e.properties&&Object.assign(t,e.properties),this.capabilitiesEnabled&&await this.contactServiceProxy.publishProperties(t)}}async requestContactPresence(e){const t=[],n=[],s=e=>{t.push({contactId:e.id,contact:e})};if(e.contacts.forEach(e=>{if((i=e.id)&&i.length>=36)if(this.currentSubscriptions.has(e.id)){const n=this.currentSubscriptions.get(e.id);n.addSubscriptionCount(),t.push(u.createContactResponse(e,n))}else{const t={};t[o.idReserved]=e.id,n.push({contact:e,properties:t})}else if(e.email&&e.email.length>0){const i=this.findContactSunscriptionByEmail(e.email);if(i)i.addSubscriptionCount(),t.push(u.createContactResponse(e,i));else{const t={};t[o.email]=e.email,n.push({contact:e,properties:t})}}else s(e);var i}),n.length>0){const e=await this.contactServiceProxy.requestSubcriptions(n.map(e=>e.properties),["*"],!0);for(let r=0;r<e.length;++r){const a=n[r].contact,l=e[r];if(l){const e=new d;e.id=h(l,o.idReserved),e.email=h(l,o.email),e.displayName=h(l,o.displayName),e.avatarUri=h(l,o.avatarUri);const n=h(l,o.status);e.status=n?u.toPresenceStatus(n):i.contactProtocol.PresenceStatus.Unknown,Array.from(Object.keys(l)).forEach(t=>{c(t)||(e.properties[t]=l[t])}),t.push(u.createContactResponse(a,e)),this.currentSubscriptions.set(e.id,e)}else s(a)}}return{contacts:t}}async requestContactPresenceDispose(e){if(!this.isServiceConnected)return;const t=this.userInfoId,n=e.contactIds.filter(e=>e!==t);if(n.length>0){const e=[];if(n.forEach(t=>{this.currentSubscriptions.has(t)&&this.currentSubscriptions.get(t).removeSubscriptionCount()&&(e.push(t),this.traceSource.verbose(`Remove subscription for contact Id:${t}`),this.currentSubscriptions.delete(t))}),e.length>0){const t=e.map(e=>({id:e}));await this.contactServiceProxy.removeSubscription(t)}}}async requestSignIn(e){this.traceSource.verbose("reguestSignIn"),this.signInRequested=!0,this.hubConnectionService.enabled=!0,this.hubConnectionService.isConnected?await this.signIn():this.hubConnectionService.isConnectionEnabled||this.notify(i.contactProtocol.Methods.NotifyAuthenticationRequiredName,{})}async requestSignOut(){this.traceSource.verbose("reguestSignOut"),this.signInRequested=!1,await this.contactServiceProxy.unregisterSelfContact(),this.signOut(),this.notifySignedOut()}onUpdateProperties(e,t,n){this.traceSource.verbose(`onUpdateProperties -> contact Id:${e.id}`);const i=Array.from(Object.keys(t)).filter(e=>!c(e));if(this.currentSubscriptions.has(e.id)){const n=this.currentSubscriptions.get(e.id);let s;s=h(t,o.email),s&&(n.email=s),s=h(t,o.displayName),s&&(n.displayName=s),s=h(t,o.avatarUri),s&&(n.avatarUri=s),s=h(t,o.status),s&&(n.status=s),i.forEach(e=>n.properties[e]=t[e])}t.hasOwnProperty(o.status)&&this.notifyPresenceChanged(e.id,u.toPresenceStatus(t[o.status]));const s=Array.from(Object.keys(t)).filter(e=>e!==o.status&&c(e)).map(e=>({property:u.toContactProperty(e),value:t[e]}));if(s.length>0&&this.notifyContactChanged(e.id,s),i.length>0){const n={};i.forEach(e=>n[e]=t[e]),this.notifyContactPropertiesChanged(e.id,n)}}onMessageReceived(e,t,n,s){if("inviteLink"===n){const e=s,n=new i.contactProtocol.InviteReceivedNotification;n.fromContactId=t.id,n.link=e.Link,n.fromContact=e.Contact,this.notify(i.contactProtocol.Methods.NotifyInviteReceivedName,n)}else{const e=new i.contactProtocol.MessageReceivedNotification;e.fromContactId=t.id,e.body=s,e.type=n,this.notify(i.contactProtocol.Methods.NotifyMessageReceivedName,e)}}async publishUserInfo(e){this.traceSource.verbose(`publishUserInfo -> id:${e.id} email:${e.emailAddress}`);let t={};t[o.email]=e.emailAddress,t[o.displayName]=e.displayName,t[o.status]=i.contactProtocol.PresenceStatus.Available,t[o.avatarUri]=e.avatarUri,this.publishPresence&&(t[o.status]=this.publishPresence.status,this.publishPresence.properties&&Object.assign(t,this.publishPresence.properties)),this.isPublishEnabled||(t={});const n=await this.contactServiceProxy.registerSelfContact(e.id,t);this.notify(i.contactProtocol.Methods.NotifySelfContactName,{contact:u.userInfoToContact(e),registrationInfo:n})}get userInfo(){const e=this.hubConnectionService.currentUserInfo;if(e)return e.userInfo}get userInfoId(){const e=this.userInfo;if(e)return e.id}get isServiceConnected(){return this.hubConnectionService.isConnected}get isAttempting(){return this.hubConnectionService.isAttempting}get isPublishEnabled(){return!this.enablePublish||!0===this.enablePublish}findContactSunscriptionByEmail(e){return Array.from(this.currentSubscriptions.values()).find(t=>t.email===e)}notifyCurrentCapabilites(e){this.notify(i.contactProtocol.Methods.NotifyCapabilitiesUpdateName,u.createCapabilites(void 0===e?this.capabilitiesEnabled:e))}onAttemptStateChanged(){this.isAttempting?this.signInRequested&&this.notifySigningIn():this.notifySignedOut()}notifySigningIn(){this.notifySignedStateChanged(i.contactProtocol.SignedStatus.SigningIn)}notifySignedIn(){this.notifySignedStateChanged(i.contactProtocol.SignedStatus.SignedIn)}notifySignedOut(){this.notifySignedStateChanged(i.contactProtocol.SignedStatus.SignedOut)}async onConnectionStateChanged(){this.hubConnectionService.isConnected?this.signInRequested&&await this.signIn():(this.signOut(),this.notifySignedStateChanged(this.isAttempting&&this.signInRequested?i.contactProtocol.SignedStatus.SigningIn:i.contactProtocol.SignedStatus.SignedOut))}async signIn(){this.isAuthorizedUser&&await this.publishUserInfo(this.userInfo),this.notifyCurrentCapabilites(),this.notifySignedIn()}signOut(){this.currentSubscriptions.clear(),this.notifyCurrentCapabilites(!1),this.notifyPresenceChanged(this.userInfoId,i.contactProtocol.PresenceStatus.Offline)}static toContactProperty(e){switch(e){case o.email:return i.contactProtocol.ContactProperty.Email;case o.displayName:return i.contactProtocol.ContactProperty.DisplayName;case o.status:return i.contactProtocol.ContactProperty.Status;case o.avatarUri:return i.contactProtocol.ContactProperty.AvatarUri;default:throw new Error("Invaild property")}}static createCapabilites(e){const t=new i.contactProtocol.Capabilities;return t.supportsDispose=e,t.supportsPresence=e,t.supportsPublishPresence=e,t.supportsInviteLink=e,t.supportsSelfContact=e,t.supportsContactPresenceRequest=e,t.supportsMessageRequest=e,t.supportedPresenceStatus=[i.contactProtocol.PresenceStatus.Available,i.contactProtocol.PresenceStatus.DoNotDisturb,i.contactProtocol.PresenceStatus.Away],t.supportsSignedStateRequest=!0,t}static userInfoToContact(e){const t=new i.contactProtocol.Contact;return t.id=e.id,t.email=e.emailAddress,t.displayName=e.displayName,t.status=i.contactProtocol.PresenceStatus.Available,t.avatarUri=e.avatarUri,t}static createContactResponse(e,t){return{contactId:e.id,contact:{id:t.id,email:e.email?e.email:t.email,displayName:e.displayName?e.displayName:t.displayName,avatarUri:e.avatarUri?e.avatarUri:t.avatarUri,status:t.status},properties:t.properties}}static toPresenceStatus(e){return Number.isInteger(e)?l[e]:e}}t.PresenceServiceProvider=u;class d extends i.contactProtocol.Contact{constructor(){super(),this.counter=1,this.properties={}}addSubscriptionCount(){++this.counter}removeSubscriptionCount(){return--this.counter,0===this.counter}}function h(e,t){if(e.hasOwnProperty(t))return e[t]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(49),r=n(383),o=n(8),a=n(4),c=n(5),l=n(9),u=n(20),d=n(167);var h;!function(e){e.Automatic="Automatic",e.Manual="Manual",e.Prompt="Prompt"}(h=t.JoinDebugSessionOption||(t.JoinDebugSessionOption={}));class f{constructor(e,t,n,i,r,o){this.debuggerHostService=e,this.sessionContext=t,this.fileSystemManager=n,this.pathManager=i,this.clientAccessCheck=r,this.trace=o,this.activeJoinedDebugSessions=new Map,this.sharedDebugSessions=[],this.delayedStartDebugSessions=[],this.unmodifiedLaunchConfigurations=new Map,this.eventRegistrations=[],this.joinUniqueId=s()}async init(){this.debuggerHostService.onDebugSessionChanged(this.onDebugSessionChanged,this,this.eventRegistrations),this.debuggerHostService.onLaunchConfigurationsChanged(this.onLaunchConfigurationsChanged,this,this.eventRegistrations),i.debug.registerDebugConfigurationProvider("*",this),i.debug.onDidStartDebugSession(this.onDidStartDebugSession,this,this.eventRegistrations),i.debug.onDidTerminateDebugSession(this.onDidTerminateDebugSession,this,this.eventRegistrations);const e=l.Telemetry.startTimedEvent(a.TelemetryEventNames.INITIALIZE_DEBUGGING,!0);try{this.sharedDebugSessions=await this.debuggerHostService.getCurrentDebugSessionsAsync()}catch(e){if(e.code!==u.RpcErrorCodes.ServiceNotAvailable)throw e;this.sharedDebugSessions=[]}if(e.addMeasure(a.TelemetryPropertyNames.NUM_DEBUGGING_PROCESSES,this.sharedDebugSessions?this.sharedDebugSessions.length:0),this.sharedDebugSessions&&this.sharedDebugSessions.length>0){const t=this.sharedDebugSessions.slice(0),n=()=>{const e=t.map(e=>this.isDebugSessionValid(e)?this.joinDebugSession(e):null);return Promise.all(e)};if(e.addProperty(a.TelemetryPropertyNames.DEBUG_PROMPT,(this.joinDebugSessionOptionValue===h.Prompt).toString()),this.joinDebugSessionOptionValue===h.Automatic)n();else if(this.joinDebugSessionOptionValue===h.Prompt){await i.window.showInformationMessage("The host is already in a collaborative debugging session that you can join",{title:"Join session now"})&&n()}}try{this.setLaunchConfigurations(await this.debuggerHostService.getLaunchConfigurationsAsync())}catch(e){if(e.code!==u.RpcErrorCodes.MethodNotFound&&e.code!==u.RpcErrorCodes.ServiceNotAvailable)throw e;this.setLaunchConfigurations(null)}const t=this.fileSystemManager.workspaceProvider;t&&(t.registerWorkspaceProvider(this),this.fireLaunchConfigurationsChanged(t)),e.end(l.TelemetryResult.Success),this.isInited=!0}dispose(){return this.eventRegistrations.forEach(e=>e.dispose()),Promise.resolve()}async resolveDebugConfiguration(e,t,n){if("vslsJoin"===t.type&&t.joinUniqueId)return t;if("vslsJoin"!==t.type)return"vslsShare"===t.type&&(t=t.adapterProxy.configuration),await this.launchRemoteDebugConfiguration(e,t);if(!t.debugSession){const n=this.sharedDebugSessions.find(e=>(e.configurationProperties&&e.configurationProperties.name?e.configurationProperties.name:e.name)===t.name);if(!n||n.configurationProperties&&n.configurationProperties.launchUniqueId)return await this.launchRemoteDebugConfiguration(e,t);t=this.toDebugConfiguration(n)}return t.joinUniqueId=this.joinUniqueId,await this.setupDebugConfiguration(t),t}getAvailableDebugSessions(){return this.sharedDebugSessions.filter(e=>!this.activeJoinedDebugSessions.has(e.sessionId))}async joinDebugSession(e){var t;const n=i.workspace.workspaceFolders;d.activitySource.fire({timestamp:new Date,name:`${d.ActivityType.debug}/join`});let s=void 0;const r=null===(t=null==e?void 0:e.configurationProperties)||void 0===t?void 0:t.__parentId;if(r){const t=this.activeJoinedDebugSessions.get(r);if(!t)return void this.delayedStartDebugSessions.push(e);s={parentSession:t,compact:!0}}await i.debug.startDebugging(n?n[0]:void 0,this.toDebugConfiguration(e),s)}async onReadFile(e){const{moniker:t}=a.PathUtil.getMonikerFromRelativePath(e.path);if("0"!==t&&t)return;if(!this.isLaunchConfigurationsExists()||e.path!==f.vscodeLaunchPath)return;e.exists=!0;const n="string"==typeof this.rawLaunchConfigurationData;e.text=n?this.rawLaunchConfigurationData.toString():JSON.stringify(this.rawLaunchConfigurationData,null,4),e.attributes=n?void 0:c.vsls.FileAttributes.Hidden}async onReadDirectory(e){if(e.length<1||!this.isLaunchConfigurationsExists())return;const t=e[0],{moniker:n}=a.PathUtil.getMonikerFromRelativePath(t.path);if("0"!==n&&n)return;if("/"===t.path&&!t.children.some(e=>e.path===f.vscodePath))return void t.children.push({path:f.vscodePath,isDirectory:!0,hasChildren:!0});if(t.path!==f.vscodePath||t.children&&t.children.find(e=>e.path===f.vscodeLaunchPath))return;t.exists=!0,t.isDirectory=!0;const i={path:f.vscodeLaunchPath,isDirectory:!1,hasChildren:!1};t.children||(t.children=[]),t.children.push(i)}async onStat(e){const t=e[0];if(!t||t.exists||!this.isLaunchConfigurationsExists())return;const{moniker:n}=a.PathUtil.getMonikerFromRelativePath(t.path);"0"!==n&&n||t.path!==f.vscodePath&&t.path!==f.vscodeLaunchPath||(t.exists=!0,t.mtime=new Date(0),t.isDirectory=t.path===f.vscodePath)}canAttach(){return this.getAvailableDebugSessions().length>0}async attach(){if(a.sessionStateTracker.State!==a.SessionState.Joined)throw new Error("Not currently in a collaboration session.");let e=this.getAvailableDebugSessions();if(0!==e.length)if(1===e.length)await a.ExtensionUtil.runWithProgress(()=>this.joinDebugSession(e[0]),{title:"Joining Debug Session..."});else{let t=[];e.forEach(e=>{t.push({label:e.name})});let n=await i.window.showQuickPick(t,{placeHolder:"Select the debug session"});if(n){let t=e.filter(e=>e.name===n.label)[0];await a.ExtensionUtil.runWithProgress(()=>this.joinDebugSession(t),{title:"Joining Debug Session..."})}}else await i.window.showInformationMessage("No debug session available to join")}setupDebugConfiguration(e){return Promise.resolve()}async launchRemoteDebugConfiguration(e,t){const n=this.sessionContext.coeditingClient.clientID;await this.clientAccessCheck.verifyCanPerformOperation(n,f.launchDebugOperation);const s=this.unmodifiedLaunchConfigurations.get(e?e.index.toString():"0");if(!s)return null;let r=s.find(e=>e.name===t.name);if(!r)return null;{const n={};Object.assign(n,r),n.launchUniqueId=this.joinUniqueId,t.noDebug&&(n.noDebug=!0),e&&(n.__workspaceIndex=e.index);try{await this.debuggerHostService.launchDebugSessionAsync(n)}catch(e){if(!(e instanceof o.ResponseError&&e.code===c.vsls.ErrorCodes.RemoteLaunchNotEnabled))throw e;await i.window.showInformationMessage(a.ExtensionUtil.getErrorString(c.vsls.ErrorCodes.RemoteLaunchNotEnabled))}}}async onDidStartDebugSession(e){if("vslsJoin"===e.type){this.trace.info(`Starting joined debug session:${e.id} name:${e.name}`);let t=(await e.customRequest("debugSessionId")).Id;this.activeJoinedDebugSessions.set(t,e);let n=!0;this.sharedDebugSessions.find(e=>e.sessionId===t)||(this.trace.verbose(`Terminate ${e.id} due to removed shared debug session id:${t}`),e.customRequest("forceTerminate"),n=!1),this.delayedStartDebugSessions=this.delayedStartDebugSessions.filter(e=>e.configurationProperties.__parentId!=t||(n&&this.joinDebugSession(e),!1))}}onDidTerminateDebugSession(e){if("vslsJoin"===e.type){this.trace.info(`Terminate joined debug session:${e.id}`);for(let[t,n]of this.activeJoinedDebugSessions)if(n.id===e.id){this.activeJoinedDebugSessions.delete(t),this.sharedDebugSessions.forEach(e=>{if(e.configurationProperties.__parentId==t){this.activeJoinedDebugSessions.get(e.sessionId).customRequest("forceTerminate")}});const e=this.sharedDebugSessions.findIndex(e=>e.configurationProperties&&e.sessionId===t&&e.configurationProperties.launchUniqueId===this.joinUniqueId);e>=0&&this.sharedDebugSessions.splice(e);break}}}get joinDebugSessionOptionValue(){const e=a.Settings.get(a.SettingKeys.joinDebugSessionOption);return h[e]}toDebugConfiguration(e){const t=e.configurationProperties&&e.configurationProperties.launchUniqueId===this.joinUniqueId,n=e.configurationProperties&&e.configurationProperties.noDebug;return{type:"vslsJoin",request:t?"launch":"attach",name:e.name,noDebug:n,debugSession:e,debugServer:a.Settings.get("debugAdapter"),enableMultipleRoots:!0}}async onDebugSessionChanged(e){if(e.changeType===c.vsls.DebugSessionChangeType.Add){if(this.trace.info(`Host debug session started:${e.debugSession.sessionId}`),this.sharedDebugSessions.push(e.debugSession),this.joinDebugSessionOptionValue===h.Automatic)await this.joinDebugSession(e.debugSession);else if(this.joinDebugSessionOptionValue===h.Prompt){await i.window.showInformationMessage(`The host has started a collaborative debugging session ('${e.debugSession.name}') that you can join`,{title:"Join session now"})&&this.isDebugSessionValid(e.debugSession)&&await this.joinDebugSession(e.debugSession)}}else if(e.changeType===c.vsls.DebugSessionChangeType.Remove){const t=e.debugSession.sessionId;this.trace.info(`Host debug session removed:${t}`);const n=this.sharedDebugSessions.findIndex(e=>e.sessionId===t);n>=0&&this.sharedDebugSessions.splice(n,1),this.activeJoinedDebugSessions.has(e.debugSession.sessionId)&&(this.trace.verbose(`Attempt to terminate joined debug session:${e.debugSession.sessionId}`),await this.activeJoinedDebugSessions.get(e.debugSession.sessionId).customRequest("forceTerminate"))}}isDebugSessionValid(e){return void 0!==this.sharedDebugSessions.find(t=>t.sessionId===e.sessionId)}setLaunchConfigurations(e){if(this.unmodifiedLaunchConfigurations=new Map,this.rawLaunchConfigurationData=e,!e)return;let t=e;if("string"==typeof e)try{t=JSON.parse(r(e))}catch(e){return}if(this.unmodifiedLaunchConfigurations.set("0",t.configurations instanceof Array?t.configurations:[]),!t.configurationsByRoot)return;const n=t.configurationsByRoot,i=Object.keys(n);for(let e of i){const t=n[e];t&&t.configurations instanceof Array&&this.unmodifiedLaunchConfigurations.set(e,t.configurations)}}isLaunchConfigurationsExists(){return null!=this.rawLaunchConfigurationData}onLaunchConfigurationsChanged(e){this.setLaunchConfigurations(e.launchConfigurations);const t=this.fileSystemManager.workspaceProvider;t&&this.fireLaunchConfigurationsChanged(t)}fireLaunchConfigurationsChanged(e){const t={type:i.FileChangeType.Changed,uri:this.pathManager.relativePathToLocalPath(f.vscodeLaunchPath)};e.fireFilesChanged([t])}}t.JoinDebugManager=f,f.vscodePath="/.vscode",f.vscodeLaunchPath=`${f.vscodePath}/launch.json`,f.launchDebugOperation={name:a.WellKnownRestrictedOperations.LaunchDebug}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(1240),r=n(511);t.JoinDebugAdapterDescriptorFactory=class{constructor(e,t,n){this.workspaceServices=e,this.rpcFactory=t,this.trace=n}createDebugAdapterDescriptor(e,t){const n=e.configuration.debugSession;this.trace.verbose(`creating JoinDebugSession for id:${e.id} sessionId:${n.sessionId}`);const o=`DebugSessionHostService-${n.sessionId}`,a={name:o,methods:r.DebugSessionHostService.methods,events:r.DebugSessionHostService.events},c=this.rpcFactory(a,a.name),l=new s.JoinDebugSession(c,n,this.trace.withName(`JoinDebugSession-${n.sessionId}`)),u=this.workspaceServices.onServiceRemoved(e=>{e===o&&(this.trace.verbose(`force terminate sessionId:${n.sessionId}`),l.forceTerminate(),u.dispose())});return new i.DebugAdapterInlineImplementation(l)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(295),s=n(295),r=n(511),o=n(295),a=n(20),c=n(512);class l extends i.DebugSession{constructor(e,t,n){super(),this.debugSessionHostService=e,this.debugSession=t,this.trace=n,this.seq=0,this.stoppedEvent=void 0,this.terminateOnDisconnect=!1}forceTerminate(){this.sendEvent(new s.TerminatedEvent)}get isStopped(){return void 0!==this.stoppedEvent}async initializeRequest(e,t){e.body=this.debugSession.capabilities,this.sendResponse(e),this.sendEvent(new s.InitializedEvent),await this.initializeHostRequest()}async customRequest(e,t,n,i){switch(e){case"debugSessionId":t.body={Id:this.debugSession.sessionId};break;case"forceTerminate":this.forceTerminate()}this.sendResponse(t)}configurationDoneRequest(e,t){super.configurationDoneRequest(e,t)}launchRequest(e,t,n){this.terminateOnDisconnect=!0,this.attachToEvents(),this.sendResponse(e)}attachRequest(e,t,n){this.attachToEvents(),this.sendResponse(e)}async stackTraceRequest(e,t,n){if(this.isStopped){let i=c.DebugUtil.getStackTrace(t,this.stoppedEvent,n);e.body=i||await this.handleProtocolRequest(n.command,t)}this.sendResponse(e)}async scopesRequest(e,t,n){if(this.isStopped){const i=t.frameId.toString();this.stoppedEvent.scopes.hasOwnProperty(i)?e.body={scopes:this.stoppedEvent.scopes[i]}:e.body=await this.handleProtocolRequest(n.command,t)}this.sendResponse(e)}async variablesRequest(e,t,n){this.isStopped&&(e.body=await this.handleProtocolRequest(n.command,t)),this.sendResponse(e)}async sourceRequest(e,t,n){if(this.isStopped){let i=t.source.sourceReference?t.source.sourceReference.toString():void 0;this.stoppedEvent.sourceReferenceContent&&i&&this.stoppedEvent.sourceReferenceContent.hasOwnProperty(i)?e.body=this.stoppedEvent.sourceReferenceContent[i]:e.body=await this.handleProtocolRequest(n.command,t)}this.sendResponse(e)}async setBreakPointsRequest(e,t,n){const i=t.source.path;e.body=await this.handleProtocolRequest(n.command,t),e.body.breakpoints.forEach(e=>{e.source&&(e.source.path=i)}),this.sendResponse(e)}async setVariableRequest(e,t,n){e.body=await this.handleProtocolRequest(n.command,t),this.sendResponse(e)}async setExpressionRequest(e,t,n){e.body=await this.handleProtocolRequest(n.command,t),this.sendResponse(e)}async evaluateRequest(e,t,n){e.body=await this.handleProtocolRequest(n.command,t),this.sendResponse(e)}async threadsRequest(e,t){this.isStopped&&(e.body={threads:this.stoppedEvent.threads}),this.sendResponse(e)}async disconnectRequest(e,t,n){this.sendResponse(e),this.shutdown(),this.terminateOnDisconnect&&await this.handleProtocolRequest("terminate")}async continueRequest(e,t,n){await this.continue(r.ContinueReason.Go,t.threadId),this.sendResponse(e)}async nextRequest(e,t,n){await this.continue(r.ContinueReason.StepOver,t.threadId),this.sendResponse(e)}async stepInRequest(e,t,n){await this.continue(r.ContinueReason.StepIn,t.threadId),this.sendResponse(e)}async stepOutRequest(e,t,n){await this.continue(r.ContinueReason.StepOut,t.threadId),this.sendResponse(e)}async restartRequest(e,t,n){e.body=await this.handleProtocolRequest(n.command,t),this.sendResponse(e)}async pauseRequest(e,t,n){e.body=await this.handleProtocolRequest(n.command,t),this.sendResponse(e)}async loadedSourcesRequest(e,t,n){e.body=await this.handleProtocolRequest(n.command,t),this.sendResponse(e)}attachToEvents(){this.debugSessionHostService.onDebugEvent(this.onDebugEvent,this),this.debugSessionHostService.onUIDebugEvent(this.onUIDebugEvent,this)}onDebugEvent(e){let t={seq:this.seq++,type:"event",event:e.body.type,body:e.body};if(this.trace.verbose(`onDebugEvent event:${t.event}`),"uiStopped"===t.event){const e=t;this.continueReason=void 0;const n=e.body,i=n.threads?n.threads:n.Threads,r=n.stackFrames?n.stackFrames:n.StackFrames,o=n.scopes?n.scopes:n.Scopes,a=n.sourceReferenceContent?n.sourceReferenceContent:n.SourceReferenceContent;this.stoppedEvent={threads:i,stackFrames:r,scopes:o,sourceReferenceContent:a},this.trace.verbose(`onDebugEvent:stoppedEvent -> reason:${e.body.reason}`),t=new s.StoppedEvent(e.body.reason,e.body.threadId)}this.sendEvent(t)}onUIDebugEvent(e){if(this.trace.verbose(`onUIDebugEvent event:${e.body.type}`),"enterRunMode"===e.body.type&&void 0===this.continueReason){const t=e.body;2!==t.Reason&&8!==t.Reason||(this.trace.verbose(`onUIDebugEvent::EnterRunMode threadId:${t.ThreadId} reason:${t.Reason}`),this.stoppedEvent=void 0,this.sendEvent(new o.ContinuedEvent(t.ThreadId)))}}async handleProtocolRequest(e,t){try{return await this.debugSessionHostService.handleProtocolRequestAsync(e,t)}catch(t){throw this.trace.error(`Failed to handleProtocolRequest for type:${e}. Error:${t}`),t}}async continue(e,t){this.stoppedEvent=void 0,this.continueReason=e,this.trace.verbose(`Continue->reason:${e}`);try{await this.debugSessionHostService.continueAsync(e,t),this.trace.verbose("Continue <---")}catch(e){e.code===a.RpcErrorCodes.ServiceNotAvailable&&this.trace.verbose("Continue <---disconnected")}}async initializeHostRequest(){const e=!0===this.debugSession.capabilities.SupportsModulesRequest;let t;try{const n=new r.InitializeDebugSessionRequest;n.includeModules=e,t=await this.debugSessionHostService.initializeRequestAsync(n)}catch(e){if(e.code!==a.RpcErrorCodes.MethodNotFound){if(e.code===a.RpcErrorCodes.ServiceNotAvailable)return void this.sendEvent(new s.TerminatedEvent);throw e}{const e=await this.debugSessionHostService.getCurrentStoppedEventAsync();t=new r.InitializeDebugSessionResponse,t.stoppedEvent=e,t.outputEvents=[],t.replayEvents=[]}}if(null!=t.stoppedEvent){const e={body:t.stoppedEvent};e.body.type="uiStopped",this.trace.verbose(`initializeHostRequest -> stoppedEvent reason:${e.body.reason}`),"entry"===e.body.reason&&(e.body.reason="breakpoint"),this.onDebugEvent(e)}}}t.JoinDebugSession=l},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(24),s=n(297);class r{get event(){return this._event||(this._event=(e,t)=>{let n;return this._listener=e,this._this=t,n={dispose:()=>{this._listener=void 0,this._this=void 0}},n}),this._event}fire(e){if(this._listener)try{this._listener.call(this._this,e)}catch(e){}}hasListener(){return!!this._listener}dispose(){this._listener=void 0,this._this=void 0}}class o extends i.EventEmitter{constructor(){super(),this._sendMessage=new r,this._pendingRequests=new Map,this.onDidSendMessage=this._sendMessage.event}dispose(){}handleMessage(e){if("request"===e.type)this.dispatchRequest(e);else if("response"===e.type){const t=e,n=this._pendingRequests.get(t.request_seq);n&&(this._pendingRequests.delete(t.request_seq),n(t))}}_isRunningInline(){return this._sendMessage&&this._sendMessage.hasListener()}start(t,n){this._sequence=1,this._writableStream=n,this._rawData=new e(0),t.on("data",e=>this._handleData(e)),t.on("close",()=>{this._emitEvent(new s.Event("close"))}),t.on("error",e=>{this._emitEvent(new s.Event("error","inStream error: "+(e&&e.message)))}),n.on("error",e=>{this._emitEvent(new s.Event("error","outStream error: "+(e&&e.message)))}),t.resume()}stop(){this._writableStream&&this._writableStream.end()}sendEvent(e){this._send("event",e)}sendResponse(e){e.seq>0?console.error(`attempt to send more than one response for command ${e.command}`):this._send("response",e)}sendRequest(e,t,n,i){const r={command:e};if(t&&Object.keys(t).length>0&&(r.arguments=t),this._send("request",r),i){this._pendingRequests.set(r.seq,i);const e=setTimeout(()=>{clearTimeout(e);const t=this._pendingRequests.get(r.seq);t&&(this._pendingRequests.delete(r.seq),t(new s.Response(r,"timeout")))},n)}}dispatchRequest(e){}_emitEvent(e){this.emit(e.event,e)}_send(t,n){if(n.type=t,n.seq=this._sequence++,this._writableStream){const t=JSON.stringify(n);this._writableStream.write(`Content-Length: ${e.byteLength(t,"utf8")}\r\n\r\n${t}`,"utf8")}this._sendMessage.fire(n)}_handleData(t){for(this._rawData=e.concat([this._rawData,t]);;){if(this._contentLength>=0){if(this._rawData.length>=this._contentLength){const e=this._rawData.toString("utf8",0,this._contentLength);if(this._rawData=this._rawData.slice(this._contentLength),this._contentLength=-1,e.length>0)try{let t=JSON.parse(e);this.handleMessage(t)}catch(e){this._emitEvent(new s.Event("error","Error handling data: "+(e&&e.message)))}continue}}else{const e=this._rawData.indexOf(o.TWO_CRLF);if(-1!==e){const t=this._rawData.toString("utf8",0,e).split("\r\n");for(let e=0;e<t.length;e++){const n=t[e].split(/: +/);"Content-Length"==n[0]&&(this._contentLength=+n[1])}this._rawData=this._rawData.slice(e+o.TWO_CRLF.length);continue}}break}}}o.TWO_CRLF="\r\n\r\n",t.ProtocolServer=o}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(510),s=i.logger,r=n(296);class o extends r.DebugSession{constructor(e,t,n){super(t,n),this.obsolete_logFilePath=e,this.on("error",e=>{s.error(e.body)})}start(e,t){super.start(e,t),s.init(e=>this.sendEvent(e),this.obsolete_logFilePath,this._isServer)}sendEvent(e){if(!(e instanceof i.LogOutputEvent)){let t=e;e instanceof r.OutputEvent&&e.body&&e.body.data&&e.body.data.doNotLogOutput&&(delete e.body.data.doNotLogOutput,t=Object.assign({},e),t.body=Object.assign({},e.body,{output:"<output not logged>"})),s.verbose(`To client: ${JSON.stringify(t)}`)}super.sendEvent(e)}sendRequest(e,t,n,i){s.verbose(`To client: ${JSON.stringify(e)}(${JSON.stringify(t)}), timeout: ${n}`),super.sendRequest(e,t,n,i)}sendResponse(e){s.verbose(`To client: ${JSON.stringify(e)}`),super.sendResponse(e)}dispatchRequest(e){s.verbose(`From client: ${e.command}(${JSON.stringify(e.arguments)})`),super.dispatchRequest(e)}}t.LoggingDebugSession=o},function(e,t,n){(function(t){var i=n(18),s=n(74),r=parseInt("0777",8);function o(e,n,a,c){"function"==typeof n?(a=n,n={}):n&&"object"==typeof n||(n={mode:n});var l=n.mode,u=n.fs||s;void 0===l&&(l=r&~t.umask()),c||(c=null);var d=a||function(){};e=i.resolve(e),u.mkdir(e,l,(function(t){if(!t)return d(null,c=c||e);switch(t.code){case"ENOENT":if(i.dirname(e)===e)return d(t);o(i.dirname(e),n,(function(t,i){t?d(t,i):o(e,n,d,i)}));break;default:u.stat(e,(function(e,n){e||!n.isDirectory()?d(t,c):d(null,c)}))}}))}e.exports=o.mkdirp=o.mkdirP=o,o.sync=function e(n,o,a){o&&"object"==typeof o||(o={mode:o});var c=o.mode,l=o.fs||s;void 0===c&&(c=r&~t.umask()),a||(a=null),n=i.resolve(n);try{l.mkdirSync(n,c),a=a||n}catch(t){switch(t.code){case"ENOENT":a=e(i.dirname(n),o,a),e(n,o,a);break;default:var u;try{u=l.statSync(n)}catch(e){throw t}if(!u.isDirectory())throw t}}return a}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Handles=class{constructor(e){this.START_HANDLE=1e3,this._handleMap=new Map,this._nextHandle="number"==typeof e?e:this.START_HANDLE}reset(){this._nextHandle=this.START_HANDLE,this._handleMap=new Map}create(e){var t=this._nextHandle++;return this._handleMap.set(t,e),t}get(e,t){return this._handleMap.get(e)||t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(4),r=n(5),o=n(7);class a{constructor(e,t,n){this.isSharing=e,this.sourceEventService=t,this.pathManager=n,this.ignoreChangeBreakpoints=!1,this.onDidChangeBreakpoints=async e=>{if(this.ignoreChangeBreakpoints)return;let t=!1;if(e.added.length>0){const n=this.toSourceBreakpoints(e.added);this.logBreakpoints("Local breakpoints added:",n),n.length>0&&(t=!0,await this.sourceEventService.fireEventAsync(a.debugBreakpointsAddId,a.toJson(n)))}else if(e.removed.length>0){const n=this.toSourceBreakpoints(e.removed);this.logBreakpoints("Local breakpoints removed:",n),n.length>0&&(t=!0,await this.sourceEventService.fireEventAsync(a.debugBreakpointsRemoveId,a.toJson(n)))}else if(e.changed.length>0){const n=this.toSourceBreakpoints(e.changed);this.logBreakpoints("Local breakpoints changed:",n),n.length>0&&(t=!0,await this.sourceEventService.fireEventAsync(a.debugBreakpointsChangeId,a.toJson(n)))}this.isSharing&&t&&await this.updateCollaborationBreakpoints()},this.onSourceEvent=async e=>{let t=!1;if(e.sourceId===a.debugBreakpointsAddId){const n=a.toBreakpoints(e.jsonContent);this.logBreakpoints("Remote breakpoints added:",n);const i=this.toVSCodeBreakpoints(n);i.length>0&&(t=this.addLocalBreakpoints(i))}else if(e.sourceId===a.debugBreakpointsRemoveId){const n=a.toBreakpoints(e.jsonContent);this.logBreakpoints("Remote breakpoints removed:",n);const i=this.toVSCodeBreakpoints(n);i.length>0&&(t=this.removeLocalBreakpoints(i))}else if(e.sourceId===a.debugBreakpointsChangeId){const n=a.toBreakpoints(e.jsonContent);this.logBreakpoints("Remote breakpoints updated:",n);const i=this.toVSCodeBreakpoints(n);i.length>0&&(t=this.updateLocalBreakpoints(i))}this.isSharing&&t&&await this.updateCollaborationBreakpoints()},this.trace=o.traceSource.withName(r.vsls.TraceSources.BreakpointManager),this.sourceEventService.onEvent(this.onSourceEvent)}static hasVSCodeSupport(){return"function"==typeof i.debug.addBreakpoints}async init(){if(this.trace.verbose("initialize"),this.onDidChangeBreakpointsEvt=i.debug.onDidChangeBreakpoints(this.onDidChangeBreakpoints,this),this.isSharing)await this.updateCollaborationBreakpoints();else{const e=await this.getCollaborationBreakpoints(),t=this.toVSCodeBreakpoints(e);this.removeLocalBreakpoints(i.debug.breakpoints),this.addLocalBreakpoints(t)}}async dispose(){this.onDidChangeBreakpointsEvt.dispose()}addLocalBreakpoints(e){if((e=e.filter(e=>"location"in e&&!this.sourceBreakpointExists(e))).length>0){e.forEach(e=>{const t=e;this.trace.verbose(`addBreakpoint srcBkpt uri:${t.location.uri.path} line:${t.location.range.start.line} character:${t.location.range.start.character}`)});try{this.ignoreChangeBreakpoints=!0,i.debug.addBreakpoints(e)}finally{this.ignoreChangeBreakpoints=!1}return!0}return!1}removeLocalBreakpoints(e){if((e=e.map(e=>"location"in e&&this.findSourceBreakpoint(e)).filter(e=>void 0!==e)).length>0){e.forEach(e=>{const t=e;this.trace.verbose(`removeBreakpoint srcBkpt uri:${t.location.uri.path} line:${t.location.range.start.line} character:${t.location.range.start.character}`)});try{this.ignoreChangeBreakpoints=!0,i.debug.removeBreakpoints(e)}finally{this.ignoreChangeBreakpoints=!1}return!0}return!1}updateLocalBreakpoints(e){return e=e.filter(e=>{if(!("location"in e))return!1;const t=e,n=this.findSourceBreakpoint(t);return n&&(n.enabled!==t.enabled||n.condition!==t.condition||n.hitCondition!==t.hitCondition)}),!!this.removeLocalBreakpoints(e)&&this.addLocalBreakpoints(e)}async updateCollaborationBreakpoints(){const e=this.getCurrentBreakpoints();this.trace.verbose(`updateCollaborationBreakpoints total:${e.length}`),await this.sourceEventService.setSourceDataAsync(a.debugBreakpointsSourceId,a.toJson(e),!1)}async getCollaborationBreakpoints(){const e=await this.sourceEventService.getSourceDataAsync(a.debugBreakpointsSourceId);return a.toBreakpoints(e)}getCurrentBreakpoints(){return this.toSourceBreakpoints(i.debug.breakpoints)}logBreakpoints(e,t){let n=void 0;t.forEach(async t=>{n||(n=e),n+="\n"+a.toString(t)}),n&&this.trace.verbose(n)}toSourceBreakpoints(e){return e.filter(e=>this.isLiveShareSourceBreakpoint(e)).map(e=>this.toBreakpoint(e))}static toString(e){return`Path:${e.source.path} Line:${e.line} Column:${e.column} EndColumn:${e.endColumn}`}static toBreakpoints(e){return e?JSON.parse(e):[]}static toJson(e){return JSON.stringify(e)}findSourceBreakpoint(e){return i.debug.breakpoints.find(t=>{if(!("location"in t))return!1;const n=t,i=n.location.uri.toString()===e.location.uri.toString(),s=n.location.range.start.line===e.location.range.start.line;return i&&s})}sourceBreakpointExists(e){return void 0!==this.findSourceBreakpoint(e)}toBreakpoint(e){const t=e.location.uri,n={path:this.pathManager.localPathToRelativePath(t)};return{condition:e.condition,enabled:e.enabled,hitCondition:e.hitCondition,verified:!1,source:n,line:e.location.range.start.line+1,column:e.location.range.start.character+1,endLine:e.location.range.end.line+1,endColumn:e.location.range.end.character+1}}toVSCodeBreakpoint(e){let t=e.source.path;(null==t?void 0:t.startsWith(this.pathManager.scheme))&&(t=t.substring(this.pathManager.scheme.length));const n=this.pathManager.relativePathToLocalPath(t),s=a.toVSCodePosition(e.line,void 0),r=(a.toVSCodePosition(e.line,e.column),new i.Location(n,new i.Range(s,s))),o=parseInt(e.hitCondition,10)?e.hitCondition:void 0;return new i.SourceBreakpoint(r,e.enabled,e.condition,o)}toVSCodeBreakpoints(e){return e.map(e=>this.toVSCodeBreakpoint(e))}isLiveShareSourceBreakpoint(e){if(!("location"in e))return!1;const t=e.location.uri;return this.isSharing?!!i.workspace.getWorkspaceFolder(t):t.scheme===s.Settings.scheme}static toVSCodePosition(e,t){return new i.Position(e?e-1:0,t?t-1:0)}}t.BreakpointManager=a,a.debugBreakpointsSourceId="debugBreakpoints",a.debugBreakpointsAddId="debugBreakpointsAdd",a.debugBreakpointsRemoveId="debugBreakpointsRemove",a.debugBreakpointsChangeId="debugBreakpointsChange"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(7),s=n(514),r=n(516),o=n(4);class a extends(i.Inittable(i.Disposable(Object))){constructor(e){super(),this.dependencies=e,this.hostController=r.hostServerControllerFactory(this.dependencies),this.stateChangedRegistration=o.sessionStateTracker.onStateChanged(e=>this.handleSessionStateChanged(e.newState,e.oldState))}async dispose(){this.stateChangedRegistration.dispose(),this.hostController&&await this.hostController.dispose(),this.guestController&&await this.guestController.dispose(),await super.dispose()}async handleSessionStateChanged(e,t){switch(e){case o.SessionState.Shared:await this.hostController.activate();break;case o.SessionState.JoiningInProgress:this.hostController.dispose(),this.guestController=s.guestServerControllerFactory(this.dependencies);break;case o.SessionState.Joined:await this.guestController.activate();break;default:t===o.SessionState.Shared&&await this.hostController.deactivate(),this.guestController&&t===o.SessionState.Joined&&await this.guestController.deactivate()}}}t.ServerManager=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(107);class r{constructor(e,t){this.contactManager=e,this.onDidChangePropertyEmitter=new i.EventEmitter,this.attachContactModel(t)}get onDidChange(){return this.onDidChangePropertyEmitter.event}get id(){return this.contact.id}get email(){return this.contact.email}get displayName(){return this.contact.displayName}get status(){return this.contact.status.toString()}get avatarUri(){return this.contact.avatarUri}get isRecentContact(){return this.contactManager.isRecentContat(this.contactModel)}get isSuggestedContact(){return this.contactManager.isSuggestedContat(this.contactModel)}get allowInvites(){return this.contactModel.properties.allowInvites}get contact(){return this.contactModel.contact}invite(e){return e&&e.useEmail?s.ContactCommandUtilities.inviteByEmail(this.email,this.displayName):s.ContactCommandUtilities.inviteHelper(this.contactModel)}attachContactModel(e){this.onDidChangePropertyDisposable&&(this.onDidChangePropertyDisposable.dispose(),this.onDidChangePropertyDisposable=null),this.contactModel=e,this.onDidChangePropertyDisposable=e.onDidChangeProperty(e=>{this.onDidChangePropertyEmitter.fire(e)})}static async getContacts(e,t){const n={},i=await s.ContactManager.requestContacts(t);i.contactModels.forEach(t=>{n[t.contact.email]=new r(e,t)});const o=i.onContactsChanged(()=>{i.contactModels.forEach(e=>{const t=n[e.contact.email];t&&(t.attachContactModel(e),t.onDidChangePropertyEmitter.fire([]))})});return{contacts:n,dispose:()=>(o.dispose(),i.dispose())}}}t.ContactApi=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){if(!Error.captureStackTrace)return null;const t=new Error,n=Error.prepareStackTrace;Error.prepareStackTrace=(e,t)=>t,Error.captureStackTrace(t,e);const i=t.stack;return Error.prepareStackTrace=n,Array.isArray(i)?i.map(e=>{const t=e.getTypeName(),n=e.getMethodName();return{functionName:t&&n?t+"."+n:e.getFunctionName(),fileName:e.getFileName()}}):null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1250),s=n(88),r=n(4),o=n(5),a=n(20),c=n(0);t.getRemoteServiceBrokerFromHost=async function(e,t,n,d){var h;if(!r.Settings.isInsidersFeatureSet)return null;let f=!1;if(null===(h=null===r.workspaceSessionInfoTracker||void 0===r.workspaceSessionInfoTracker?void 0:r.workspaceSessionInfoTracker.workspaceSessionInfo)||void 0===h?void 0:h.sessions)for(const e in r.workspaceSessionInfoTracker.workspaceSessionInfo.sessions)if(r.workspaceSessionInfoTracker.workspaceSessionInfo.sessions.hasOwnProperty(e)){const t=parseInt(e,10);if(r.workspaceSessionInfoTracker.workspaceSessionInfo.sessionNumber===t){f=r.workspaceSessionInfoTracker.workspaceSessionInfo.sessions[t].isOwner;break}}f?u.TrustedServer:u.UntrustedServer;const p=a.RpcProxy.create(l,e,n.withName(o.vsls.TraceSources.RemoteServiceBroker)),m={protocolVersion:"3.0",availableServices:[]},g=await p.checkCompatibilityAsync(m,d);if(!g)return n.warning("The host is not sharing its remote service broker."),null;if(!g.protocolVersion)return n.error("The host did not disclose its protocol version."),null;const y=g.protocolVersion.split("."),v="3.0".split(".");if(y[0]!==v[0])return n.error(`Incompatible service broker on host. Local version 3.0, remote version ${g.protocolVersion}.`),null;n.info("Service broker on host is active and compatible. Connecting...");const S=await t.connectToChannel("IServiceBroker-3",d);if(!S)return null;let _;try{const e=s.default.create();_=null==d?void 0:d.onCancellationRequested(t=>e.cancel(t));const t=await i.RemoteServiceBroker.connectToMultiplexingDuplex(S,{protocolMajorVersion:2},e.token);return t.defaultClientCulture=c.env.language,t.defaultClientUICulture=c.env.language,t}catch(e){throw S.end(e),e}finally{null==_||_.dispose()}};const l={name:"ServiceBrokerHost",methods:["checkCompatibility"],events:[]};var u;!function(e){e[e.SameProcess=0]="SameProcess",e[e.OtherProcessOnSameMachine=1]="OtherProcessOnSameMachine",e[e.TrustedServer=2]="TrustedServer",e[e.UntrustedServer=3]="UntrustedServer",e[e.NexusServer=4]="NexusServer",e[e.NexusClient=5]="NexusClient"}(u||(u={}))},function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(148);Object.defineProperty(t,"Formatters",{enumerable:!0,get:function(){return r.Formatters}}),Object.defineProperty(t,"MessageDelimiters",{enumerable:!0,get:function(){return r.MessageDelimiters}}),Object.defineProperty(t,"RemoteServiceConnections",{enumerable:!0,get:function(){return r.RemoteServiceConnections}}),s(n(523),t);var o=n(537);Object.defineProperty(t,"AuthorizationServiceClient",{enumerable:!0,get:function(){return o.AuthorizationServiceClient}});var a=n(1267);Object.defineProperty(t,"ProtectedOperation",{enumerable:!0,get:function(){return a.ProtectedOperation}});var c=n(1268);Object.defineProperty(t,"RemoteServiceBroker",{enumerable:!0,get:function(){return c.RemoteServiceBroker}});var l=n(540);Object.defineProperty(t,"RemoteServiceConnectionInfo",{enumerable:!0,get:function(){return l.RemoteServiceConnectionInfo}});var u=n(524);Object.defineProperty(t,"ServiceJsonRpcDescriptor",{enumerable:!0,get:function(){return u.ServiceJsonRpcDescriptor}}),Object.defineProperty(t,"JsonRpcConnection",{enumerable:!0,get:function(){return u.JsonRpcConnection}});var d=n(299);Object.defineProperty(t,"ServiceMoniker",{enumerable:!0,get:function(){return d.ServiceMoniker}});var h=n(525);Object.defineProperty(t,"ServiceRpcDescriptor",{enumerable:!0,get:function(){return h.ServiceRpcDescriptor}})},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.BE32MessageWriter=t.BE32MessageReader=void 0;const i=n(8),s=n(88),r=n(34),o=n(527),a=n(149);t.BE32MessageReader=class{constructor(e,t){this.readable=e,this.decoder=t,this.errorEmitter=new i.Emitter,this.closeEmitter=new i.Emitter,this.partialMessageEmitter=new i.Emitter}get onError(){return this.errorEmitter.event}get onClose(){return this.closeEmitter.event}get onPartialMessage(){return this.partialMessageEmitter.event}listen(e){this.readable.on("error",e=>this.errorEmitter.fire(e));const t=s.default.create();return(async()=>{try{for(;;){const n=await a.getBufferFrom(this.readable,4,!0,t.token);if(!n)return void this.closeEmitter.fire();const i=n.readInt32BE(0),s=await a.getBufferFrom(this.readable,i,!1,t.token),r=await this.decoder(s);e(r)}}catch(e){this.errorEmitter.fire(e)}})(),i.Disposable.create(()=>t.cancel())}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}};function c(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${"string"==typeof e.message?e.message:"unknown"}`)}t.BE32MessageWriter=class{constructor(t,n){this.writable=t,this.encoder=n,this.errorEmitter=new i.Emitter,this.closeEmitter=new i.Emitter,this.semaphore=new o.Semaphore(1),this.headerBuffer=e.alloc(4),this.errorCount=0,t.on("error",e=>this.errorEmitter.fire([e,void 0,void 0])),t.once("close",()=>this.closeEmitter.fire())}get onError(){return this.errorEmitter.event}get onClose(){return this.closeEmitter.event}async write(e){await this.semaphore.use(async()=>{try{const t=await this.encoder(e);this.headerBuffer.writeInt32BE(t.byteLength,0),this.writable instanceof r.Writable&&this.writable.cork();const n=Promise.all([a.writeAsync(this.writable,this.headerBuffer),a.writeAsync(this.writable,t)]);this.writable instanceof r.Writable&&this.writable.uncork(),await n}catch(e){this.errorCount++,this.errorEmitter.fire([c(e),void 0,this.errorCount])}})}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}}}).call(this,n(3).Buffer)},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=function(){},o=function(){function e(e,t){this._isCancelled=e,this.canBeCancelled=t,this._callbacks=new Set}return Object.defineProperty(e.prototype,"isCancelled",{get:function(){return this._isCancelled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){if(this.isCancelled)return this._reason;throw new Error("This token is not cancelled.")},enumerable:!0,configurable:!0}),e.prototype.racePromise=function(t){var n=this;return this.canBeCancelled?new Promise((function(i,s){var r=n.onCancelled((function(t){return s(new e.CancellationError(t))}));t.then((function(e){i(e),r()}),(function(e){s(e),r()}))})):t},e.prototype.throwIfCancelled=function(){if(this._isCancelled)throw new e.CancellationError(this._reason)},e.prototype.onCancelled=function(e){var t=this;return this.canBeCancelled?this.isCancelled?(e(this.reason),r):(this._callbacks.add(e),function(){return t._callbacks&&t._callbacks.delete(e)}):r},e.create=function(){var t=new e(!1,!0);return{token:t,cancel:function(e){t._isCancelled||(t._isCancelled=!0,t._reason=e,t._callbacks.forEach((function(t){return t(e)})),delete t._callbacks)}}},e.timeout=function(t){var n=e.create(),i=n.token,s=n.cancel,r=setTimeout((function(){return s(e.timeout)}),t);return{token:i,cancel:function(e){i._isCancelled||(clearTimeout(r),s(e))}}},e.all=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(t.some((function(e){return!e.canBeCancelled})))return e.CONTINUE;var i=e.create(),s=t.length,r=function(){if(0==--s){var e=t.map((function(e){return e._reason}));i.cancel(e)}};return t.forEach((function(e){return e.onCancelled(r)})),i.token},e.race=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var i=0,s=t;i<s.length;i++){var r=s[i];if(r._isCancelled)return r}var o,a=e.create(),c=function(e){o.forEach((function(e){return e()})),a.cancel(e)};return o=t.map((function(e){return e.onCancelled(c)})),a.token},e.CANCELLED=new e(!0,!0),e.CONTINUE=new e(!1,!1),e}();!function(e){var t=function(e){function t(n){var i=e.call(this,"Operation cancelled")||this;return i.reason=n,Object.setPrototypeOf(i,t.prototype),i}return s(t,e),t}(Error);e.CancellationError=t}(o||(o={})),t.default=o},function(e,t,n){(function(t){function n(e){return e&&e.isBuffer&&e}e.exports=n(void 0!==t&&t)||n(this.Buffer)||n("undefined"!=typeof window&&window.Buffer)||this.Buffer}).call(this,n(3).Buffer)},function(e,t,n){var i=n(40);function s(e){return new Array(e)}(t=e.exports=s(0)).alloc=s,t.concat=i.concat,t.from=function(e){if(!i.isBuffer(e)&&i.isView(e))e=i.Uint8Array.from(e);else if(i.isArrayBuffer(e))e=new Uint8Array(e);else{if("string"==typeof e)return i.from.call(t,e);if("number"==typeof e)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(e)}},function(e,t,n){var i=n(40),s=i.global;function r(e){return new s(e)}(t=e.exports=i.hasBuffer?r(0):[]).alloc=i.hasBuffer&&s.alloc||r,t.concat=i.concat,t.from=function(e){if(!i.isBuffer(e)&&i.isView(e))e=i.Uint8Array.from(e);else if(i.isArrayBuffer(e))e=new Uint8Array(e);else{if("string"==typeof e)return i.from.call(t,e);if("number"==typeof e)throw new TypeError('"value" argument must not be a number')}return s.from&&1!==s.from.length?s.from(e):new s(e)}},function(e,t,n){var i=n(40);function s(e){return new Uint8Array(e)}(t=e.exports=i.hasArrayBuffer?s(0):[]).alloc=s,t.concat=i.concat,t.from=function(e){if(i.isView(e)){var n=e.byteOffset,s=e.byteLength;(e=e.buffer).byteLength!==s&&(e.slice?e=e.slice(n,n+s):(e=new Uint8Array(e)).byteLength!==s&&(e=Array.prototype.slice.call(e,n,n+s)))}else{if("string"==typeof e)return i.from.call(t,e);if("number"==typeof e)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(e)}},function(e,t){t.copy=function(e,t,n,i){var s;n||(n=0);i||0===i||(i=this.length);t||(t=0);var r=i-n;if(e===this&&n<t&&t<i)for(s=r-1;s>=0;s--)e[s+t]=this[s+n];else for(s=0;s<r;s++)e[s+t]=this[s+n];return r},t.toString=function(e,t,n){var i=0|t;n||(n=this.length);var s="",r=0;for(;i<n;)(r=this[i++])<128?s+=String.fromCharCode(r):(192==(224&r)?r=(31&r)<<6|63&this[i++]:224==(240&r)?r=(15&r)<<12|(63&this[i++])<<6|63&this[i++]:240==(248&r)&&(r=(7&r)<<18|(63&this[i++])<<12|(63&this[i++])<<6|63&this[i++]),r>=65536?(r-=65536,s+=String.fromCharCode(55296+(r>>>10),56320+(1023&r))):s+=String.fromCharCode(r));return s},t.write=function(e,t){var n=t||(t|=0),i=e.length,s=0,r=0;for(;r<i;)(s=e.charCodeAt(r++))<128?this[n++]=s:s<2048?(this[n++]=192|s>>>6,this[n++]=128|63&s):s<55296||s>57343?(this[n++]=224|s>>>12,this[n++]=128|s>>>6&63,this[n++]=128|63&s):(s=65536+(s-55296<<10|e.charCodeAt(r++)-56320),this[n++]=240|s>>>18,this[n++]=128|s>>>12&63,this[n++]=128|s>>>6&63,this[n++]=128|63&s);return n-t}},function(e,t,n){t.setExtPackers=function(e){e.addExtPacker(14,Error,[d,c]),e.addExtPacker(1,EvalError,[d,c]),e.addExtPacker(2,RangeError,[d,c]),e.addExtPacker(3,ReferenceError,[d,c]),e.addExtPacker(4,SyntaxError,[d,c]),e.addExtPacker(5,TypeError,[d,c]),e.addExtPacker(6,URIError,[d,c]),e.addExtPacker(10,RegExp,[u,c]),e.addExtPacker(11,Boolean,[l,c]),e.addExtPacker(12,String,[l,c]),e.addExtPacker(13,Date,[Number,c]),e.addExtPacker(15,Number,[l,c]),"undefined"!=typeof Uint8Array&&(e.addExtPacker(17,Int8Array,o),e.addExtPacker(18,Uint8Array,o),e.addExtPacker(19,Int16Array,o),e.addExtPacker(20,Uint16Array,o),e.addExtPacker(21,Int32Array,o),e.addExtPacker(22,Uint32Array,o),e.addExtPacker(23,Float32Array,o),"undefined"!=typeof Float64Array&&e.addExtPacker(24,Float64Array,o),"undefined"!=typeof Uint8ClampedArray&&e.addExtPacker(25,Uint8ClampedArray,o),e.addExtPacker(26,ArrayBuffer,o),e.addExtPacker(29,DataView,o));s.hasBuffer&&e.addExtPacker(27,r,s.from)};var i,s=n(40),r=s.global,o=s.Uint8Array.from,a={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function c(e){return i||(i=n(529).encode),i(e)}function l(e){return e.valueOf()}function u(e){(e=RegExp.prototype.toString.call(e).split("/")).shift();var t=[e.pop()];return t.unshift(e.join("/")),t}function d(e){var t={};for(var n in a)t[n]=e[n];return t}},function(e,t,n){var i=n(115),s=n(303),r=s.Uint64BE,o=s.Int64BE,a=n(40),c=n(302),l=n(1260),u=n(531).uint8,d=n(301).ExtBuffer,h="undefined"!=typeof Uint8Array,f="undefined"!=typeof Map,p=[];p[1]=212,p[2]=213,p[4]=214,p[8]=215,p[16]=216,t.getWriteType=function(e){var t=l.getWriteToken(e),n=e&&e.useraw,s=h&&e&&e.binarraybuffer,m=s?a.isArrayBuffer:a.isBuffer,g=s?function(e,t){E(e,new Uint8Array(t))}:E,y=f&&e&&e.usemap?function(e,n){if(!(n instanceof Map))return w(e,n);var i=n.size;t[i<16?128+i:i<=65535?222:223](e,i);var s=e.codec.encode;n.forEach((function(t,n,i){s(e,n),s(e,t)}))}:w;return{boolean:function(e,n){t[n?195:194](e,n)},function:_,number:function(e,n){var i,s=0|n;if(n!==s)return void t[i=203](e,n);i=-32<=s&&s<=127?255&s:0<=s?s<=255?204:s<=65535?205:206:-128<=s?208:-32768<=s?209:210;t[i](e,s)},object:n?function(e,n){if(m(n))return function(e,n){var i=n.length;t[i<32?160+i:i<=65535?218:219](e,i),e.send(n)}(e,n);S(e,n)}:S,string:(v=n?function(e){return e<32?1:e<=65535?3:5}:function(e){return e<32?1:e<=255?2:e<=65535?3:5},function(e,n){var i=n.length,s=5+3*i;e.offset=e.reserve(s);var r=e.buffer,o=v(i),a=e.offset+o;i=c.write.call(r,n,a);var l=v(i);if(o!==l){var u=a+l-o,d=a+i;c.copy.call(r,r,u,a,d)}t[1===l?160+i:l<=3?215+l:219](e,i),e.offset+=i}),symbol:_,undefined:_};var v;function S(e,n){if(null===n)return _(e,n);if(m(n))return g(e,n);if(i(n))return function(e,n){var i=n.length;t[i<16?144+i:i<=65535?220:221](e,i);for(var s=e.codec.encode,r=0;r<i;r++)s(e,n[r])}(e,n);if(r.isUint64BE(n))return function(e,n){t[207](e,n.toArray())}(e,n);if(o.isInt64BE(n))return function(e,n){t[211](e,n.toArray())}(e,n);var s=e.codec.getExtPacker(n);if(s&&(n=s(n)),n instanceof d)return function(e,n){var i=n.buffer,s=i.length,r=p[s]||(s<255?199:s<=65535?200:201);t[r](e,s),u[n.type](e),e.send(i)}(e,n);y(e,n)}function _(e,n){t[192](e,n)}function E(e,n){var i=n.length;t[i<255?196:i<=65535?197:198](e,i),e.send(n)}function w(e,n){var i=Object.keys(n),s=i.length;t[s<16?128+s:s<=65535?222:223](e,s);var r=e.codec.encode;i.forEach((function(t){r(e,t),r(e,n[t])}))}}},function(e,t,n){var i=n(196),s=n(303),r=s.Uint64BE,o=s.Int64BE,a=n(531).uint8,c=n(40),l=c.global,u=c.hasBuffer&&"TYPED_ARRAY_SUPPORT"in l&&!l.TYPED_ARRAY_SUPPORT,d=c.hasBuffer&&l.prototype||{};function h(){var e=a.slice();return e[196]=f(196),e[197]=p(197),e[198]=m(198),e[199]=f(199),e[200]=p(200),e[201]=m(201),e[202]=g(202,4,d.writeFloatBE||S,!0),e[203]=g(203,8,d.writeDoubleBE||_,!0),e[204]=f(204),e[205]=p(205),e[206]=m(206),e[207]=g(207,8,y),e[208]=f(208),e[209]=p(209),e[210]=m(210),e[211]=g(211,8,v),e[217]=f(217),e[218]=p(218),e[219]=m(219),e[220]=p(220),e[221]=m(221),e[222]=p(222),e[223]=m(223),e}function f(e){return function(t,n){var i=t.reserve(2),s=t.buffer;s[i++]=e,s[i]=n}}function p(e){return function(t,n){var i=t.reserve(3),s=t.buffer;s[i++]=e,s[i++]=n>>>8,s[i]=n}}function m(e){return function(t,n){var i=t.reserve(5),s=t.buffer;s[i++]=e,s[i++]=n>>>24,s[i++]=n>>>16,s[i++]=n>>>8,s[i]=n}}function g(e,t,n,i){return function(s,r){var o=s.reserve(t+1);s.buffer[o++]=e,n.call(s.buffer,r,o,i)}}function y(e,t){new r(this,t,e)}function v(e,t){new o(this,t,e)}function S(e,t){i.write(this,e,t,!1,23,4)}function _(e,t){i.write(this,e,t,!1,52,8)}t.getWriteToken=function(e){return e&&e.uint8array?((t=h())[202]=g(202,4,S),t[203]=g(203,8,_),t):u||c.hasBuffer&&e&&e.safe?function(){var e=a.slice();return e[196]=g(196,1,l.prototype.writeUInt8),e[197]=g(197,2,l.prototype.writeUInt16BE),e[198]=g(198,4,l.prototype.writeUInt32BE),e[199]=g(199,1,l.prototype.writeUInt8),e[200]=g(200,2,l.prototype.writeUInt16BE),e[201]=g(201,4,l.prototype.writeUInt32BE),e[202]=g(202,4,l.prototype.writeFloatBE),e[203]=g(203,8,l.prototype.writeDoubleBE),e[204]=g(204,1,l.prototype.writeUInt8),e[205]=g(205,2,l.prototype.writeUInt16BE),e[206]=g(206,4,l.prototype.writeUInt32BE),e[207]=g(207,8,y),e[208]=g(208,1,l.prototype.writeInt8),e[209]=g(209,2,l.prototype.writeInt16BE),e[210]=g(210,4,l.prototype.writeInt32BE),e[211]=g(211,8,v),e[217]=g(217,1,l.prototype.writeUInt8),e[218]=g(218,2,l.prototype.writeUInt16BE),e[219]=g(219,4,l.prototype.writeUInt32BE),e[220]=g(220,2,l.prototype.writeUInt16BE),e[221]=g(221,4,l.prototype.writeUInt32BE),e[222]=g(222,2,l.prototype.writeUInt16BE),e[223]=g(223,4,l.prototype.writeUInt32BE),e}():h();var t}},function(e,t,n){t.setExtUnpackers=function(e){e.addExtUnpacker(14,[a,l(Error)]),e.addExtUnpacker(1,[a,l(EvalError)]),e.addExtUnpacker(2,[a,l(RangeError)]),e.addExtUnpacker(3,[a,l(ReferenceError)]),e.addExtUnpacker(4,[a,l(SyntaxError)]),e.addExtUnpacker(5,[a,l(TypeError)]),e.addExtUnpacker(6,[a,l(URIError)]),e.addExtUnpacker(10,[a,c]),e.addExtUnpacker(11,[a,u(Boolean)]),e.addExtUnpacker(12,[a,u(String)]),e.addExtUnpacker(13,[a,u(Date)]),e.addExtUnpacker(15,[a,u(Number)]),"undefined"!=typeof Uint8Array&&(e.addExtUnpacker(17,u(Int8Array)),e.addExtUnpacker(18,u(Uint8Array)),e.addExtUnpacker(19,[d,u(Int16Array)]),e.addExtUnpacker(20,[d,u(Uint16Array)]),e.addExtUnpacker(21,[d,u(Int32Array)]),e.addExtUnpacker(22,[d,u(Uint32Array)]),e.addExtUnpacker(23,[d,u(Float32Array)]),"undefined"!=typeof Float64Array&&e.addExtUnpacker(24,[d,u(Float64Array)]),"undefined"!=typeof Uint8ClampedArray&&e.addExtUnpacker(25,u(Uint8ClampedArray)),e.addExtUnpacker(26,d),e.addExtUnpacker(29,[d,u(DataView)]));s.hasBuffer&&e.addExtUnpacker(27,u(r))};var i,s=n(40),r=s.global,o={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function a(e){return i||(i=n(533).decode),i(e)}function c(e){return RegExp.apply(null,e)}function l(e){return function(t){var n=new e;for(var i in o)n[i]=t[i];return n}}function u(e){return function(t){return new e(t)}}function d(e){return new Uint8Array(e).buffer}},function(e,t,n){var i=n(535);function s(e){var t,n=new Array(256);for(t=0;t<=127;t++)n[t]=r(t);for(t=128;t<=143;t++)n[t]=a(t-128,e.map);for(t=144;t<=159;t++)n[t]=a(t-144,e.array);for(t=160;t<=191;t++)n[t]=a(t-160,e.str);for(n[192]=r(null),n[193]=null,n[194]=r(!1),n[195]=r(!0),n[196]=o(e.uint8,e.bin),n[197]=o(e.uint16,e.bin),n[198]=o(e.uint32,e.bin),n[199]=o(e.uint8,e.ext),n[200]=o(e.uint16,e.ext),n[201]=o(e.uint32,e.ext),n[202]=e.float32,n[203]=e.float64,n[204]=e.uint8,n[205]=e.uint16,n[206]=e.uint32,n[207]=e.uint64,n[208]=e.int8,n[209]=e.int16,n[210]=e.int32,n[211]=e.int64,n[212]=a(1,e.ext),n[213]=a(2,e.ext),n[214]=a(4,e.ext),n[215]=a(8,e.ext),n[216]=a(16,e.ext),n[217]=o(e.uint8,e.str),n[218]=o(e.uint16,e.str),n[219]=o(e.uint32,e.str),n[220]=o(e.uint16,e.array),n[221]=o(e.uint32,e.array),n[222]=o(e.uint16,e.map),n[223]=o(e.uint32,e.map),t=224;t<=255;t++)n[t]=r(t-256);return n}function r(e){return function(){return e}}function o(e,t){return function(n){var i=e(n);return t(n,i)}}function a(e,t){return function(n){return t(n,e)}}t.getReadToken=function(e){var t=i.getReadFormat(e);return e&&e.useraw?function(e){var t,n=s(e).slice();for(n[217]=n[196],n[218]=n[197],n[219]=n[198],t=160;t<=191;t++)n[t]=a(t-160,e.bin);return n}(t):s(t)}},function(e,t,n){t.Encoder=r;var i=n(536),s=n(530).EncodeBuffer;function r(e){if(!(this instanceof r))return new r(e);s.call(this,e)}r.prototype=new s,i.mixin(r.prototype),r.prototype.encode=function(e){this.write(e),this.emit("data",this.read())},r.prototype.end=function(e){arguments.length&&this.encode(e),this.flush(),this.emit("end")}},function(e,t,n){t.Decoder=r;var i=n(536),s=n(534).DecodeBuffer;function r(e){if(!(this instanceof r))return new r(e);s.call(this,e)}r.prototype=new s,i.mixin(r.prototype),r.prototype.decode=function(e){arguments.length&&this.write(e),this.flush()},r.prototype.push=function(e){this.emit("data",e)},r.prototype.end=function(e){this.decode(e),this.emit("end")}},function(e,t,n){n(304),n(300),t.createCodec=n(188).createCodec},function(e,t,n){n(304),n(300),t.codec={preset:n(188).preset}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProtectedOperation=void 0;const i=n(58);!function(e){e.create=function(e,t){return Object.freeze({operationMoniker:e,requiredTrustLevel:t})},e.isSupersetOf=function(e,t){return i(e),i(t),e.operationMoniker===t.operationMoniker&&(e.requiredTrustLevel===t.requiredTrustLevel||!!e.requiredTrustLevel&&!!t.requiredTrustLevel&&e.requiredTrustLevel>t.requiredTrustLevel)},e.equals=function(e,t){return e===t||!(!e||!t)&&(e.operationMoniker===t.operationMoniker&&e.requiredTrustLevel===t.requiredTrustLevel)}}(t.ProtectedOperation||(t.ProtectedOperation={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteServiceBroker=void 0;const i=n(58),s=n(88),r=n(24),o=n(1269),a=n(537),c=n(148),l=n(523),u=n(1273),d=n(540),h=n(526);class f extends r.EventEmitter{constructor(e,t,n){super(),this.serviceBroker=e,this.multiplexingStream=n,this.isDisposed=!1,this.ownsMxStream=!1,this.defaultClientCulture="en-US",this.defaultClientUICulture="en-US",i(e),i(t),(t.supportedConnections&c.RemoteServiceConnections.Multiplexing)===c.RemoteServiceConnections.Multiplexing&&i(n),this.serviceBroker=e,this.serviceBroker.on("availabilityChanged",e=>{this.emit("availabilityChanged",e)}),this.multiplexingStream=n}static async connectToDuplex(e,t=s.default.CONTINUE){i(e);const n=l.FrameworkServices.remoteServiceBroker.constructRpcConnection(e),r=new u.ProxyForIRemoteServiceBroker(n.messageConnection);return await f.initializeBrokerConnection(r,t)}static async connectToRemoteServiceBroker(e,t=s.default.CONTINUE){return i(e),await f.initializeBrokerConnection(e,t)}static async connectToMultiplexingDuplex(e,t,n=s.default.CONTINUE){i(e);const r=await o.MultiplexingStream.CreateAsync(e,t,n),a=await r.acceptChannelAsync("",void 0,n),c=l.FrameworkServices.remoteServiceBroker.constructRpcConnection(a),d=new u.ProxyForIRemoteServiceBroker(c.messageConnection),h=await this.connectToMultiplexingRemoteServiceBroker(d,r,n);return h.ownsMxStream=!0,h}static async connectToMultiplexingRemoteServiceBroker(e,t,n=s.default.CONTINUE){i(e),i(t);const r={supportedConnections:c.RemoteServiceConnections.Multiplexing},o=await f.initializeBrokerConnection(e,n,r,t);return o.ownsMxStream=!1,o}static async initializeBrokerConnection(e,t=s.default.CONTINUE,n,i){n=n||{supportedConnections:c.RemoteServiceConnections.None};try{await e.handshake(n,t)}catch(t){const n=e;throw null==n||n.dispose(),t}return new f(e,n,i)}setAuthorizationService(e){var t;i(e),null===(t=this.authorizationClient)||void 0===t||t.dispose(),this.authorizationClient=new a.AuthorizationServiceClient(e)}async getProxy(e,t,n=s.default.CONTINUE){let r,a;i(e),t=t||{clientCulture:this.defaultClientCulture,clientUICulture:this.defaultClientUICulture},t=await this.applyAuthorization(t,n);let c={};try{if(c=await this.serviceBroker.requestServiceChannel(e.moniker,t,n),!c||d.RemoteServiceConnectionInfo.isEmpty(c))return null;if(!c.multiplexingChannelId||!this.multiplexingStream)throw c.pipeName?new Error("Cannot connect to named pipe"):new Error("Unsupported connection type");a=await this.multiplexingStream.acceptChannel(c.multiplexingChannelId),r=e.constructRpc(null==t?void 0:t.clientRpcTarget,a)}catch(e){throw null==r||r.dispose(),h.IsReadWriteStream(a)?a.end():a instanceof o.Channel&&a.dispose(),!a&&(null==c?void 0:c.requestId)&&await this.serviceBroker.cancelServiceRequest(c.requestId,n),e}return r}async getPipe(e,t,n=s.default.CONTINUE){if(i(e),t=t||{clientCulture:"en-US",clientUICulture:"en-US"},(t=await this.applyAuthorization(t,n)).clientRpcTarget)throw new Error("Cannot connect pipe to service with client RPC target");let r={},o=null,a=null;try{if(r=await this.serviceBroker.requestServiceChannel(e,t,n),!r||d.RemoteServiceConnectionInfo.isEmpty(r))return null;if(!r.multiplexingChannelId||!this.multiplexingStream)throw r.pipeName?new Error("Cannot connect to named pipe"):new Error("Unsupported connection type");return a=await this.multiplexingStream.acceptChannelAsync("",void 0,n),o=a.stream,o}catch(e){throw null==a||a.dispose(),null==o||o.end(),!o&&(null==r?void 0:r.requestId)&&await this.serviceBroker.cancelServiceRequest(r.requestId,n),e}}dispose(){var e;this.isDisposed=!0,this.serviceBroker.removeAllListeners(c.availabilityChangedEvent);const t=this.serviceBroker;null==t||t.dispose(),null===(e=this.authorizationClient)||void 0===e||e.dispose(),this.multiplexingStream&&this.ownsMxStream&&this.multiplexingStream.dispose()}async applyAuthorization(e,t){return this.authorizationClient&&!e.clientCredentials&&(e.clientCredentials=await this.authorizationClient.getCredentials(t)),e}}t.RemoteServiceBroker=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(538);t.Channel=i.Channel;var s=n(1272);t.FullDuplexStream=s.FullDuplexStream;var r=n(306);t.MultiplexingStream=r.MultiplexingStream;var o=n(307);t.MultiplexingStreamOptions=o.MultiplexingStreamOptions;var a=n(149);t.writeSubstream=a.writeSubstream,t.readSubstream=a.readSubstream},function(e,t,n){"use strict";var i;e.exports=(i=()=>{},e=>(e.catch(i),e))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(306),s=n(28),r=n(149),o=n(528),a=n(187),c=n(305);class l{static getIsOddRandomData(){return s.randomBytes(16)}static isOdd(e,t){let n;for(let i=0;i<e.length;i++){const s=e[i],r=t[i];if(s>r){n=!0;break}if(s<r){n=!1;break}}if(void 0===n)throw new Error("Unable to determine even/odd party.");return n}}t.MultiplexingStreamFormatter=l;class u extends l{constructor(e){super(),this.stream=e}end(){this.stream.end()}async writeHandshakeAsync(){const t=l.getIsOddRandomData(),n=e.concat([u.protocolMagicNumber,t]);return await r.writeAsync(this.stream,n),t}async readHandshakeAsync(e,t){const n=e,i=await r.getBufferFrom(this.stream,u.protocolMagicNumber.length+16,!1,t);for(let e=0;e<u.protocolMagicNumber.length;e++){const t=u.protocolMagicNumber[e],n=i.readUInt8(e);if(t!==n)throw new Error(`Protocol magic number mismatch. Expected ${t} but was ${n}.`)}return{isOdd:l.isOdd(n,i.slice(u.protocolMagicNumber.length)),protocolVersion:{major:1,minor:0}}}async writeFrameAsync(t,n){const i=new e(7);i.writeInt8(t.code,0),i.writeUInt32BE(t.channelId||0,1),i.writeUInt16BE((null==n?void 0:n.length)||0,5),await r.writeAsync(this.stream,i),n&&n.length>0&&await r.writeAsync(this.stream,n)}async readFrameAsync(e){const t=await r.getBufferFrom(this.stream,7,!0,e);if(null===t)return null;const n=new c.FrameHeader(t.readInt8(0),t.readUInt32BE(1)),i=t.readUInt16BE(5);return{header:n,payload:await r.getBufferFrom(this.stream,i)}}serializeOfferParameters(t){const n=new e(t.name,i.MultiplexingStream.ControlFrameEncoding);if(n.length>i.MultiplexingStream.framePayloadMaxLength)throw new Error("Name is too long.");return n}deserializeOfferParameters(e){return{name:e.toString(i.MultiplexingStream.ControlFrameEncoding)}}serializerAcceptanceParameters(t){return new e([])}deserializerAcceptanceParameters(e){return{}}serializeContentProcessed(e){throw new Error("Not supported in the V1 protocol.")}deserializeContentProcessed(e){throw new Error("Not supported in the V1 protocol.")}}t.MultiplexingStreamV1Formatter=u,u.protocolMagicNumber=new e([47,223,29,80]);class d extends l{constructor(e){super(),this.reader=o.createDecodeStream(),e.pipe(this.reader),this.writer=e}end(){this.writer.end()}async writeHandshakeAsync(){const e=l.getIsOddRandomData(),t=[[d.ProtocolVersion.major,d.ProtocolVersion.minor],e];return await r.writeAsync(this.writer,o.encode(t)),e}async readHandshakeAsync(e,t){const n=await this.readMessagePackAsync(t);if(null===n)throw new Error("No data received during handshake.");return{isOdd:l.isOdd(e,n[1]),protocolVersion:{major:n[0][0],minor:n[0][1]}}}async writeFrameAsync(e,t){const n=[e.code];(e.channelId||t&&t.length>0)&&(n.push(e.channelId),t&&t.length>0&&n.push(t)),await r.writeAsync(this.writer,o.encode(n))}async readFrameAsync(t){const n=await this.readMessagePackAsync(t);return null===n?null:{header:new c.FrameHeader(n[0],n.length>1?n[1]:void 0),payload:n[2]||e.from([])}}serializeOfferParameters(e){const t=[e.name];return e.remoteWindowSize&&t.push(e.remoteWindowSize),o.encode(t)}deserializeOfferParameters(e){const t=o.decode(e);return{name:t[0],remoteWindowSize:t[1]}}serializerAcceptanceParameters(e){const t=[];return e.remoteWindowSize&&t.push(e.remoteWindowSize),o.encode(t)}deserializerAcceptanceParameters(e){return{remoteWindowSize:o.decode(e)[0]}}serializeContentProcessed(e){return o.encode([e])}deserializeContentProcessed(e){return o.decode(e)[0]}async readMessagePackAsync(e){const t=new a.Deferred;for(;;){const n=this.reader.read();if(null===n){const n=new a.Deferred;this.reader.once("readable",n.resolve.bind(n)),this.reader.once("end",t.resolve.bind(t));const i=Promise.race([n.promise,t.promise]);if(await(e?e.racePromise(i):i),n.isCompleted)continue;return null}return n}}}t.MultiplexingStreamV2Formatter=d,d.ProtocolVersion={major:2,minor:0}}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(34);class s{static CreatePair(){const e=new i.PassThrough,t=new i.PassThrough;return{first:s.Splice(e,t),second:s.Splice(t,e)}}static Splice(e,t){const n=new i.Duplex({write(e,n,i){t.write(e,n,i)},final(e){t.end(e)}});return n.read=e.read.bind(e),n.on=e.on.bind(e),n}}t.FullDuplexStream=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyForIRemoteServiceBroker=void 0;const i=n(58),s=n(88),r=n(24),o=n(148);class a extends r.EventEmitter{constructor(e){super(),this.rpc=e,this.isDisposedRpc=!1,i(e),this.rpc.onDispose(()=>{this.isDisposedRpc=!0,this.dispose()}),this.rpc.onNotification(o.availabilityChangedEvent,e=>{this.emit("availabilityChanged",e)}),e.listen()}async handshake(e,t=s.default.CONTINUE){if(!this.isDisposedRpc)return await this.rpc.sendRequest("handshake",[e])}async requestServiceChannel(e,t,n=s.default.CONTINUE){if(!this.isDisposedRpc){return await this.rpc.sendRequest("requestServiceChannel",[e,t])}return{}}async cancelServiceRequest(e,t=s.default.CONTINUE){this.isDisposedRpc||await this.rpc.sendRequest("cancelServiceRequest",[e])}dispose(){this.isDisposedRpc||(this.rpc.dispose(),this.isDisposedRpc=!0)}}t.ProxyForIRemoteServiceBroker=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(520),r=n(519);class o extends s.LiveShareExtensionApiBase{async getCallingPackage(e,t){if(!t)throw new Error("callingExtensionId must be specified");const n=i.extensions.getExtension(t);if(!n)throw new Error(`extension not found for id:${t}`);return r.getPackageInfo(n.packageJSON)}}t.LiveShareExtensionApi=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(298);t.StatusbarQuickPickItemsProvider=class{getQuickPickItems(e){return i.ExtensionContributions.getQuickPickItems()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(541),s=n(4);t.portForwardingService=s.lazyLoad(()=>i.createPortForwardingService())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),s=n(541);t.workspaceHubPortFowardingServiceFactory=function(e,t){const n=s.createPortForwardingService();return Object.assign(Object.assign({},n),{serviceInfo:i.vsls.PortForwardingService,init:()=>Promise.resolve(),dispose:()=>Promise.resolve()})}},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const s=n(0),r=n(7),o=n(4),a=n(5),c=n(308),l=n(83),u=n(1315),d=n(548),h=n(1324),f=n(315),p=n(6),m=n(18),g=n(1330),y=n(554),v=n(1331),S=n(1332),_=n(555),E=n(1333),w=n(107),b=n(20),C=n(513),T=n(559);o.ExtensionUtil.isNode()||(m.posix={join:(...e)=>m.join(...e)});const M=async(e,t)=>{const n=await o.JoinCommandUtilities.showInformationMessage(o.localize(e),!1,o.localize("Sign in"));n===o.localize("Sign in")?(await s.commands.executeCommand("liveshare.signin"),await s.commands.executeCommand("liveshare.join",t)):n||s.commands.executeCommand("_liveshareweb.gotoSessionPage")},A={statusPostAuth:o.SessionAction.AttemptJoining,authAttemptMax:1};t.joinCommandBuilder=function(e){return new R(e,[g.default,y.default,P,I,N])},t.leaveCommandBuilder=function(e){return new L(e)};let k=p.createDisposable(()=>{throw new Error("Invalid operation")}),R=class extends r.CommandBase{constructor(e,t){super(),this.dependencies=e,this.initializers=t}async invoke(e,t){var n;if(void 0===e.link||""===e.link){let t="";try{t=await(new o.ClipboardUtil).pasteFromClipboardAsync(),t=t.trim()}catch(e){}const n=e=>o.JoinCommandUtilities.extractLiveshareWorkspaceId(e.trim())?void 0:"Invalid collaboration session URL";if(e.link=await s.window.showInputBox({prompt:"Enter the URL of the collaboration session to join",ignoreFocusOut:!0,value:o.JoinCommandUtilities.extractLiveshareLink(t),validateInput:n}),!e.link)throw new p.CancellationError("Operation cancelled @ getcollaboration session URL dialog.")}const i=o.JoinCommandUtilities.extractLiveshareWorkspaceId(null===(n=e.link)||void 0===n?void 0:n.toString());if(o.JoinCommandUtilities.setInviteLinkJoining(i,e,t),e.isActivate||!await S.joinWorkspace(i,e.newWindow))try{await this.join(i,t)}finally{await o.JoinCommandUtilities.finishInviteLinkJoining(w.ContactManager,i)}}async onCancellationRequested(e,t){}async join(e,t){o.TimeTracker.start("join");const n=[],i=o.Settings.get(o.SettingKeys.serviceUri),u=(await this.dependencies.authService().getCurrentAuthenticatedUserAsync()).accessToken,h=new l.WorkspaceApi(i,()=>u,r.traceSource.withName("WorkspaceApi")),m=e=>h.getWorkspaceAccess(e),g=r.traceSource.withName("WorkspaceClient"),y=await(async e=>{let n;try{n=await m(e)}catch(e){if(e instanceof f.HttpClientAuthenticationError){const t=await e.response.text();let n=` ${t} failed with status: ${e.response.status}`;if(403===e.response.status&&t.includes("Anonymous")){const e=r.CommandErrorCode.FORBIDDEN_ANONYMOUS,t=new r.CommandError({message:n,code:e});throw t.isSuppressUserNotification=!0,t}}throw e}if(!1===n.isHostConnected&&(r.traceSource.verbose("Waiting for host..."),!await o.JoinCommandUtilities.showWaitingForHostProgressBar(this.dependencies,async()=>(n=await m(e),n),15,t)))throw new Error("time out waiting for host");return n})(e),S=await o.joinWithLocalConnectionHub(g,{workspaceId:e,liveShareEndpoint:"",token:"",connectionInfo:y,clientVersionInfo:{extensionVersion:v.version,extensionName:v.name,applicationName:"VSCode",applicationVersion:s.version},workspaceJoinInfo:{anonymousUserName:o.Settings.get(o.SettingKeys.anonymousUserName)},clientCapabilities:{extensionReadOnlySupport:!0,clientReadOnlySupport:!0,isNonInteractive:!1}}),w=S.workspaceClient,C=S.workspaceSessionInfo,M=this.dependencies.agentRpcServer;M.onHandleNoneRequest(async(e,t,...n)=>{const[i,s]=b.normalizeRpcParameters(n);return await w.rpcClient.sendRequest(g,t,{report:(e,t)=>{M.sendNotification(r.traceSource,b.methodProgress,[{id:i,value:e}])}},s,...n)}),M.onHandleNoneNotification((e,t,...n)=>{w.rpcClient.sendNotification(g,t,n)}),w.rpcClient.onHandleNoneNotification((e,t,...n)=>{M.sendNotification(r.traceSource,t,n)});const A=w.getServiceProxy(a.vsls.WorkspaceService);n.push(b.rpcUtils.onAllEvents(A,a.vsls.WorkspaceService.events,(e,t)=>{M.sendNotification(r.traceSource,`${a.vsls.WorkspaceService.name}.${e}`,[t])})),n.push(p.createDisposable(async()=>{try{await p.timeoutPromise(w.disconnect(),250)}catch(t){g.error(`Failed to unjoin from workspace:${e}`,t),w.dispose()}})),o.workspaceSessionInfoTracker.workspaceSessionInfo=C;const R=Object.entries(C.sessions).find(([e,t])=>!!t.isHost);this.dependencies.hostSessionId.value=Number(R[0]);const P=new o.AccessControlService(this.dependencies);M.registerRpcService(P,P.serviceInfo),o.TimeTracker.markTime("pathManager init"),await this.dependencies.pathManager().init(),o.TimeTracker.markTime("workspaceProvider init"),this.dependencies.fileSystemManager().workspaceProvider.init(),o.TimeTracker.markTime("createorUpdateWorkspaceFile"),o.dependencies.fileSystemManager().workspaceProvider.createorUpdateWorkspaceFile(e,C.name),o.TimeTracker.markTime("accessControlManager init"),await this.dependencies.accessControlManager().init(),n.push(await _.initCoEditingContext(this.dependencies,!0)),o.TimeTracker.markTime("registerGuestTerminalHandler"),E.registerGuestTerminalHandler(o.dependencies,w),o.SessionContext.joined(),await o.TimeTracker.timeIt("applyGuestSettingsToWorkspace",async()=>await o.JoinCommandUtilities.applyGuestSettingsToWorkspace(s.ConfigurationTarget.Workspace));const I=async t=>{try{const i=await t(this.dependencies,S,e);i&&n.push(i)}catch(e){r.traceSource.error(`failed to invoke initializer:${t.name} reason:${e}`)}},N=async e=>{await e.init(),n.push(e)};o.TimeTracker.markTime("coEditingCommands"),await N(this.dependencies.coEditingCommands()),o.TimeTracker.markTime("commentManager"),await N(c.reviewsDependencies.commentManager());const L=new T.GuestNotebooksService(this.dependencies,b.RpcProxy.create(T.NotebooksService,this.dependencies.rpcClient(),r.traceSource.withName("Notebooks")));try{L.init()}catch(e){}n.push(await o.TimeTracker.timeIt("activate lsp",async()=>await d.lspClient.activateAsync(o.ExtensionUtil.context,w.rpcClient,[...o.dependencies.workspaceServices().registeredServices]))),o.TimeTracker.markTime("addAdditionalRootsFromFileServiceToWorkspace"),o.JoinCommandUtilities.addAdditionalRootsFromFileServiceToWorkspace(this.dependencies.fileService(),C),await o.TimeTracker.timeIt("initializers",async()=>await Promise.all(this.initializers.map(e=>I(e)))),o.TimeTracker.markTime("guestSourceControlManager"),await N(c.reviewsDependencies.guestSourceControlManager()),k=p.createDisposablesSeries(g,...n);const D={};let x=0;const O=w.onWorkspaceMetricsUpdated(e=>{e.bytesIn&&void 0===D.bytesIn&&(x|=1,D.bytesIn=e.bytesIn),e.bytesOut&&void 0===D.bytesOut&&(x|=2,D.bytesOut=e.bytesOut),e.latency&&void 0===D.latency&&(x|=4,D.latency=e.latency),7===x&&(g.info(`join metrics:${JSON.stringify(D)}`),O.dispose())});o.TimeTracker.stop("join")}};function P(e){const t=new o.SearchProvider(e);o.ExtensionUtil.context.subscriptions.push(s.workspace.registerTextSearchProvider(o.Settings.scheme,t)),o.ExtensionUtil.context.subscriptions.push(s.workspace.registerFileSearchProvider(o.Settings.scheme,new h.CachedSearchProvider(t)))}async function I(e,t){const n=new u.WorkspaceTaskClient(e,e.accessControlManager(),async n=>{const i=await e.streamManagerService().getStreamAsync(n.name,n.condition);return await t.workspaceClient.openStreamingChannel(i)});await n.init(),o.ExtensionUtil.context.subscriptions.push(u.registerTaskProvider())}async function N(e,t,n){if(o.ExtensionUtil.isNode()){const i=await o.startLocalWorkspaceHubService(o.initLocalConnectionHub(),r.traceSource),s=C.workspaceHubPortFowardingServiceFactory({hubPipeName:i[1],workspaceId:n,workspaceConnectionPromise:Promise.resolve(t.workspaceClient)},r.traceSource.withName("hubPortFowardingService"));return e.agentRpcServer.registerRpcService(s,s.serviceInfo),await s.init(),{dispose:async()=>{await s.dispose(),await i[0].stop()}}}}R=i([o.cancellationDecorator(),o.errorNotificationCommandDecorator("Joining collaboration session",o.TelemetryEventNames.JOIN_FAULT,!0,async(e,t,n)=>{switch(e.code){case r.CommandErrorCode.FORBIDDEN_ANONYMOUS:const e=o.localize("The Host doesn't allow anonymous users in the session. Consider signing in so they know who you are.");await M(`${t.commandName}: ${e}`,n);break;case a.vsls.ErrorCodes.CollaborationSessionGuestRejected:s.commands.executeCommand("_liveshareweb.gotoSessionPage")}},async(e,t,n)=>{if(e instanceof f.HttpClientError)return o.localize("The collaboration session is no longer active.")}),o.telemetryCommandDecorator(o.TelemetryEventNames.JOIN_WORKSPACE,o.TelemetryEventNames.JOIN_FAULT,"Join",1,(e,t)=>{}),o.telemetryStatusCommandDecorator(),o.validationCommandDecorator(),o.sessionStateTransitionsCommandDecorator(o.SessionAction.AttemptJoining,o.SessionAction.JoiningSuccess,o.SessionAction.JoiningError),o.authenticationCommandDecorator(A),o.progressCommandDecorator()],R);class L extends r.CommandBase{constructor(e){super(),this.dependencies=e}async invoke(e,t){this.dependencies.agentRpcServer.clear(),await k.dispose(),o.sessionStateTracker.transition(o.SessionAction.Unjoin),await S.leaveCollaboration()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(150);var s;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.serverErrorStart=-32099,e.serverErrorEnd=-32e3,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.RequestCancelled=-32800,e.ContentModified=-32801,e.MessageWriteError=1,e.MessageReadError=2}(s=t.ErrorCodes||(t.ErrorCodes={}));class r extends Error{constructor(e,t,n){super(t),this.code=i.number(e)?e:s.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,r.prototype)}toJson(){return{code:this.code,message:this.message,data:this.data}}}t.ResponseError=r;class o{constructor(e,t){this._method=e,this._numberOfParams=t}get method(){return this._method}get numberOfParams(){return this._numberOfParams}}t.AbstractMessageType=o;t.RequestType0=class extends o{constructor(e){super(e,0)}};t.RequestType=class extends o{constructor(e){super(e,1)}};t.RequestType1=class extends o{constructor(e){super(e,1)}};t.RequestType2=class extends o{constructor(e){super(e,2)}};t.RequestType3=class extends o{constructor(e){super(e,3)}};t.RequestType4=class extends o{constructor(e){super(e,4)}};t.RequestType5=class extends o{constructor(e){super(e,5)}};t.RequestType6=class extends o{constructor(e){super(e,6)}};t.RequestType7=class extends o{constructor(e){super(e,7)}};t.RequestType8=class extends o{constructor(e){super(e,8)}};t.RequestType9=class extends o{constructor(e){super(e,9)}};t.NotificationType=class extends o{constructor(e){super(e,1),this._=void 0}};t.NotificationType0=class extends o{constructor(e){super(e,0)}};t.NotificationType1=class extends o{constructor(e){super(e,1)}};t.NotificationType2=class extends o{constructor(e){super(e,2)}};t.NotificationType3=class extends o{constructor(e){super(e,3)}};t.NotificationType4=class extends o{constructor(e){super(e,4)}};t.NotificationType5=class extends o{constructor(e){super(e,5)}};t.NotificationType6=class extends o{constructor(e){super(e,6)}};t.NotificationType7=class extends o{constructor(e){super(e,7)}};t.NotificationType8=class extends o{constructor(e){super(e,8)}};t.NotificationType9=class extends o{constructor(e){super(e,9)}},t.isRequestMessage=function(e){let t=e;return t&&i.string(t.method)&&(i.string(t.id)||i.number(t.id))},t.isNotificationMessage=function(e){let t=e;return t&&i.string(t.method)&&void 0===e.id},t.isResponseMessage=function(e){let t=e;return t&&(void 0!==t.result||!!t.error)&&(i.string(t.id)||i.number(t.id)||null===t.id)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(190),s=n(150);var r;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:i.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:i.Event.None}),e.is=function(t){let n=t;return n&&(n===e.None||n===e.Cancelled||s.boolean(n.isCancellationRequested)&&!!n.onCancellationRequested)}}(r=t.CancellationToken||(t.CancellationToken={}));const o=Object.freeze((function(e,t){let n=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(n)}}}));class a{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?o:(this._emitter||(this._emitter=new i.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new a),this._token}cancel(){this._token?this._token.cancel():this._token=r.Cancelled}dispose(){this._token?this._token instanceof a&&this._token.dispose():this._token=r.None}}},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.None=0,e.First=1,e.Last=2}(i=t.Touch||(t.Touch={}));t.LinkedMap=class{constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}has(e){return this._map.has(e)}get(e){const t=this._map.get(e);if(t)return t.value}set(e,t,n=i.None){let s=this._map.get(e);if(s)s.value=t,n!==i.None&&this.touch(s,n);else{switch(s={key:e,value:t,next:void 0,previous:void 0},n){case i.None:this.addItemLast(s);break;case i.First:this.addItemFirst(s);break;case i.Last:default:this.addItemLast(s)}this._map.set(e,s),this._size++}}delete(e){const t=this._map.get(e);return!!t&&(this._map.delete(e),this.removeItem(t),this._size--,!0)}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._head;for(;n;)t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),n=n.next}forEachReverse(e,t){let n=this._tail;for(;n;)t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),n=n.previous}values(){let e=[],t=this._head;for(;t;)e.push(t.value),t=t.next;return e}keys(){let e=[],t=this._head;for(;t;)e.push(t.key),t=t.next;return e}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head)this._head=e.next;else if(e===this._tail)this._tail=e.previous;else{const t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===i.First||t===i.Last)if(t===i.First){if(e===this._head)return;const t=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(t.previous=n,n.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e}else if(t===i.Last){if(e===this._tail)return;const t=e.next,n=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=n,n.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e}}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(18),s=n(117),r=n(28),o=n(66),a=n(310),c=n(311);t.generateRandomPipeName=function(){const t=r.randomBytes(21).toString("hex");return"win32"===e.platform?`\\\\.\\pipe\\vscode-jsonrpc-${t}-sock`:i.join(s.tmpdir(),`vscode-${t}.sock`)},t.createClientPipeTransport=function(e,t="utf-8"){let n,i=new Promise((e,t)=>{n=e});return new Promise((s,r)=>{let l=o.createServer(e=>{l.close(),n([new a.SocketMessageReader(e,t),new c.SocketMessageWriter(e,t)])});l.on("error",r),l.listen(e,()=>{l.removeListener("error",r),s({onConnected:()=>i})})})},t.createServerPipeTransport=function(e,t="utf-8"){const n=o.createConnection(e);return[new a.SocketMessageReader(n,t),new c.SocketMessageWriter(n,t)]}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(66),s=n(310),r=n(311);t.createClientSocketTransport=function(e,t="utf-8"){let n,o=new Promise((e,t)=>{n=e});return new Promise((a,c)=>{let l=i.createServer(e=>{l.close(),n([new s.SocketMessageReader(e,t),new r.SocketMessageWriter(e,t)])});l.on("error",c),l.listen(e,"127.0.0.1",()=>{l.removeListener("error",c),a({onConnected:()=>o})})})},t.createServerSocketTransport=function(e,t="utf-8"){const n=i.createConnection(e,"127.0.0.1");return[new s.SocketMessageReader(n,t),new r.SocketMessageWriter(n,t)]}},function(e,t,n){"use strict";var i,s,r,o,a,c,l,u,d,h,f,p,m,g,y,v,S,_,E,w;n.r(t),n.d(t,"Position",(function(){return i})),n.d(t,"Range",(function(){return s})),n.d(t,"Location",(function(){return r})),n.d(t,"LocationLink",(function(){return o})),n.d(t,"Color",(function(){return a})),n.d(t,"ColorInformation",(function(){return c})),n.d(t,"ColorPresentation",(function(){return l})),n.d(t,"FoldingRangeKind",(function(){return u})),n.d(t,"FoldingRange",(function(){return d})),n.d(t,"DiagnosticRelatedInformation",(function(){return h})),n.d(t,"DiagnosticSeverity",(function(){return f})),n.d(t,"DiagnosticTag",(function(){return p})),n.d(t,"Diagnostic",(function(){return m})),n.d(t,"Command",(function(){return g})),n.d(t,"TextEdit",(function(){return y})),n.d(t,"TextDocumentEdit",(function(){return v})),n.d(t,"CreateFile",(function(){return S})),n.d(t,"RenameFile",(function(){return _})),n.d(t,"DeleteFile",(function(){return E})),n.d(t,"WorkspaceEdit",(function(){return w})),n.d(t,"WorkspaceChange",(function(){return X})),n.d(t,"TextDocumentIdentifier",(function(){return b})),n.d(t,"VersionedTextDocumentIdentifier",(function(){return C})),n.d(t,"TextDocumentItem",(function(){return T})),n.d(t,"MarkupKind",(function(){return M})),n.d(t,"MarkupContent",(function(){return A})),n.d(t,"CompletionItemKind",(function(){return k})),n.d(t,"InsertTextFormat",(function(){return R})),n.d(t,"CompletionItemTag",(function(){return P})),n.d(t,"CompletionItem",(function(){return I})),n.d(t,"CompletionList",(function(){return N})),n.d(t,"MarkedString",(function(){return L})),n.d(t,"Hover",(function(){return D})),n.d(t,"ParameterInformation",(function(){return x})),n.d(t,"SignatureInformation",(function(){return O})),n.d(t,"DocumentHighlightKind",(function(){return F})),n.d(t,"DocumentHighlight",(function(){return U})),n.d(t,"SymbolKind",(function(){return j})),n.d(t,"SymbolTag",(function(){return H})),n.d(t,"SymbolInformation",(function(){return B})),n.d(t,"DocumentSymbol",(function(){return Y})),n.d(t,"CodeActionKind",(function(){return W})),n.d(t,"CodeActionContext",(function(){return q})),n.d(t,"CodeAction",(function(){return V})),n.d(t,"CodeLens",(function(){return $})),n.d(t,"FormattingOptions",(function(){return K})),n.d(t,"DocumentLink",(function(){return z})),n.d(t,"SelectionRange",(function(){return G})),n.d(t,"EOL",(function(){return Q})),n.d(t,"TextDocument",(function(){return Z})),function(e){e.create=function(e,t){return{line:e,character:t}},e.is=function(e){var t=e;return ee.objectLiteral(t)&&ee.number(t.line)&&ee.number(t.character)}}(i||(i={})),function(e){e.create=function(e,t,n,s){if(ee.number(e)&&ee.number(t)&&ee.number(n)&&ee.number(s))return{start:i.create(e,t),end:i.create(n,s)};if(i.is(e)&&i.is(t))return{start:e,end:t};throw new Error("Range#create called with invalid arguments["+e+", "+t+", "+n+", "+s+"]")},e.is=function(e){var t=e;return ee.objectLiteral(t)&&i.is(t.start)&&i.is(t.end)}}(s||(s={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){var t=e;return ee.defined(t)&&s.is(t.range)&&(ee.string(t.uri)||ee.undefined(t.uri))}}(r||(r={})),function(e){e.create=function(e,t,n,i){return{targetUri:e,targetRange:t,targetSelectionRange:n,originSelectionRange:i}},e.is=function(e){var t=e;return ee.defined(t)&&s.is(t.targetRange)&&ee.string(t.targetUri)&&(s.is(t.targetSelectionRange)||ee.undefined(t.targetSelectionRange))&&(s.is(t.originSelectionRange)||ee.undefined(t.originSelectionRange))}}(o||(o={})),function(e){e.create=function(e,t,n,i){return{red:e,green:t,blue:n,alpha:i}},e.is=function(e){var t=e;return ee.number(t.red)&&ee.number(t.green)&&ee.number(t.blue)&&ee.number(t.alpha)}}(a||(a={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){var t=e;return s.is(t.range)&&a.is(t.color)}}(c||(c={})),function(e){e.create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},e.is=function(e){var t=e;return ee.string(t.label)&&(ee.undefined(t.textEdit)||y.is(t))&&(ee.undefined(t.additionalTextEdits)||ee.typedArray(t.additionalTextEdits,y.is))}}(l||(l={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(u||(u={})),function(e){e.create=function(e,t,n,i,s){var r={startLine:e,endLine:t};return ee.defined(n)&&(r.startCharacter=n),ee.defined(i)&&(r.endCharacter=i),ee.defined(s)&&(r.kind=s),r},e.is=function(e){var t=e;return ee.number(t.startLine)&&ee.number(t.startLine)&&(ee.undefined(t.startCharacter)||ee.number(t.startCharacter))&&(ee.undefined(t.endCharacter)||ee.number(t.endCharacter))&&(ee.undefined(t.kind)||ee.string(t.kind))}}(d||(d={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){var t=e;return ee.defined(t)&&r.is(t.location)&&ee.string(t.message)}}(h||(h={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(f||(f={})),function(e){e.Unnecessary=1,e.Deprecated=2}(p||(p={})),function(e){e.create=function(e,t,n,i,s,r){var o={range:e,message:t};return ee.defined(n)&&(o.severity=n),ee.defined(i)&&(o.code=i),ee.defined(s)&&(o.source=s),ee.defined(r)&&(o.relatedInformation=r),o},e.is=function(e){var t=e;return ee.defined(t)&&s.is(t.range)&&ee.string(t.message)&&(ee.number(t.severity)||ee.undefined(t.severity))&&(ee.number(t.code)||ee.string(t.code)||ee.undefined(t.code))&&(ee.string(t.source)||ee.undefined(t.source))&&(ee.undefined(t.relatedInformation)||ee.typedArray(t.relatedInformation,h.is))}}(m||(m={})),function(e){e.create=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var s={title:e,command:t};return ee.defined(n)&&n.length>0&&(s.arguments=n),s},e.is=function(e){var t=e;return ee.defined(t)&&ee.string(t.title)&&ee.string(t.command)}}(g||(g={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){var t=e;return ee.objectLiteral(t)&&ee.string(t.newText)&&s.is(t.range)}}(y||(y={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){var t=e;return ee.defined(t)&&C.is(t.textDocument)&&Array.isArray(t.edits)}}(v||(v={})),function(e){e.create=function(e,t){var n={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(n.options=t),n},e.is=function(e){var t=e;return t&&"create"===t.kind&&ee.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||ee.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||ee.boolean(t.options.ignoreIfExists)))}}(S||(S={})),function(e){e.create=function(e,t,n){var i={kind:"rename",oldUri:e,newUri:t};return void 0===n||void 0===n.overwrite&&void 0===n.ignoreIfExists||(i.options=n),i},e.is=function(e){var t=e;return t&&"rename"===t.kind&&ee.string(t.oldUri)&&ee.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||ee.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||ee.boolean(t.options.ignoreIfExists)))}}(_||(_={})),function(e){e.create=function(e,t){var n={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(n.options=t),n},e.is=function(e){var t=e;return t&&"delete"===t.kind&&ee.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||ee.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||ee.boolean(t.options.ignoreIfNotExists)))}}(E||(E={})),function(e){e.is=function(e){var t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((function(e){return ee.string(e.kind)?S.is(e)||_.is(e)||E.is(e):v.is(e)})))}}(w||(w={}));var b,C,T,M,A,k,R,P,I,N,L,D,x,O,F,U,j,H,B,Y,W,q,V,$,K,z,G,J=function(){function e(e){this.edits=e}return e.prototype.insert=function(e,t){this.edits.push(y.insert(e,t))},e.prototype.replace=function(e,t){this.edits.push(y.replace(e,t))},e.prototype.delete=function(e){this.edits.push(y.del(e))},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e}(),X=function(){function e(e){var t=this;this._textEditChanges=Object.create(null),e&&(this._workspaceEdit=e,e.documentChanges?e.documentChanges.forEach((function(e){if(v.is(e)){var n=new J(e.edits);t._textEditChanges[e.textDocument.uri]=n}})):e.changes&&Object.keys(e.changes).forEach((function(n){var i=new J(e.changes[n]);t._textEditChanges[n]=i})))}return Object.defineProperty(e.prototype,"edit",{get:function(){return this._workspaceEdit},enumerable:!0,configurable:!0}),e.prototype.getTextEditChange=function(e){if(C.is(e)){if(this._workspaceEdit||(this._workspaceEdit={documentChanges:[]}),!this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var t=e;if(!(i=this._textEditChanges[t.uri])){var n={textDocument:t,edits:s=[]};this._workspaceEdit.documentChanges.push(n),i=new J(s),this._textEditChanges[t.uri]=i}return i}if(this._workspaceEdit||(this._workspaceEdit={changes:Object.create(null)}),!this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");var i;if(!(i=this._textEditChanges[e])){var s=[];this._workspaceEdit.changes[e]=s,i=new J(s),this._textEditChanges[e]=i}return i},e.prototype.createFile=function(e,t){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(S.create(e,t))},e.prototype.renameFile=function(e,t,n){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(_.create(e,t,n))},e.prototype.deleteFile=function(e,t){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(E.create(e,t))},e.prototype.checkDocumentChanges=function(){if(!this._workspaceEdit||!this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.")},e}();!function(e){e.create=function(e){return{uri:e}},e.is=function(e){var t=e;return ee.defined(t)&&ee.string(t.uri)}}(b||(b={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return ee.defined(t)&&ee.string(t.uri)&&(null===t.version||ee.number(t.version))}}(C||(C={})),function(e){e.create=function(e,t,n,i){return{uri:e,languageId:t,version:n,text:i}},e.is=function(e){var t=e;return ee.defined(t)&&ee.string(t.uri)&&ee.string(t.languageId)&&ee.number(t.version)&&ee.string(t.text)}}(T||(T={})),function(e){e.PlainText="plaintext",e.Markdown="markdown"}(M||(M={})),function(e){e.is=function(t){var n=t;return n===e.PlainText||n===e.Markdown}}(M||(M={})),function(e){e.is=function(e){var t=e;return ee.objectLiteral(e)&&M.is(t.kind)&&ee.string(t.value)}}(A||(A={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(k||(k={})),function(e){e.PlainText=1,e.Snippet=2}(R||(R={})),function(e){e.Deprecated=1}(P||(P={})),function(e){e.create=function(e){return{label:e}}}(I||(I={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(N||(N={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){var t=e;return ee.string(t)||ee.objectLiteral(t)&&ee.string(t.language)&&ee.string(t.value)}}(L||(L={})),function(e){e.is=function(e){var t=e;return!!t&&ee.objectLiteral(t)&&(A.is(t.contents)||L.is(t.contents)||ee.typedArray(t.contents,L.is))&&(void 0===e.range||s.is(e.range))}}(D||(D={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(x||(x={})),function(e){e.create=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var s={label:e};return ee.defined(t)&&(s.documentation=t),ee.defined(n)?s.parameters=n:s.parameters=[],s}}(O||(O={})),function(e){e.Text=1,e.Read=2,e.Write=3}(F||(F={})),function(e){e.create=function(e,t){var n={range:e};return ee.number(t)&&(n.kind=t),n}}(U||(U={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(j||(j={})),function(e){e.Deprecated=1}(H||(H={})),function(e){e.create=function(e,t,n,i,s){var r={name:e,kind:t,location:{uri:i,range:n}};return s&&(r.containerName=s),r}}(B||(B={})),function(e){e.create=function(e,t,n,i,s,r){var o={name:e,detail:t,kind:n,range:i,selectionRange:s};return void 0!==r&&(o.children=r),o},e.is=function(e){var t=e;return t&&ee.string(t.name)&&ee.number(t.kind)&&s.is(t.range)&&s.is(t.selectionRange)&&(void 0===t.detail||ee.string(t.detail))&&(void 0===t.deprecated||ee.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))}}(Y||(Y={})),function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"}(W||(W={})),function(e){e.create=function(e,t){var n={diagnostics:e};return null!=t&&(n.only=t),n},e.is=function(e){var t=e;return ee.defined(t)&&ee.typedArray(t.diagnostics,m.is)&&(void 0===t.only||ee.typedArray(t.only,ee.string))}}(q||(q={})),function(e){e.create=function(e,t,n){var i={title:e};return g.is(t)?i.command=t:i.edit=t,void 0!==n&&(i.kind=n),i},e.is=function(e){var t=e;return t&&ee.string(t.title)&&(void 0===t.diagnostics||ee.typedArray(t.diagnostics,m.is))&&(void 0===t.kind||ee.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||g.is(t.command))&&(void 0===t.isPreferred||ee.boolean(t.isPreferred))&&(void 0===t.edit||w.is(t.edit))}}(V||(V={})),function(e){e.create=function(e,t){var n={range:e};return ee.defined(t)&&(n.data=t),n},e.is=function(e){var t=e;return ee.defined(t)&&s.is(t.range)&&(ee.undefined(t.command)||g.is(t.command))}}($||($={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){var t=e;return ee.defined(t)&&ee.number(t.tabSize)&&ee.boolean(t.insertSpaces)}}(K||(K={})),function(e){e.create=function(e,t,n){return{range:e,target:t,data:n}},e.is=function(e){var t=e;return ee.defined(t)&&s.is(t.range)&&(ee.undefined(t.target)||ee.string(t.target))}}(z||(z={})),function(e){e.create=function(e,t){return{range:e,parent:t}},e.is=function(t){var n=t;return void 0!==n&&s.is(n.range)&&(void 0===n.parent||e.is(n.parent))}}(G||(G={}));var Z,Q=["\n","\r\n","\r"];!function(e){e.create=function(e,t,n,i){return new te(e,t,n,i)},e.is=function(e){var t=e;return!!(ee.defined(t)&&ee.string(t.uri)&&(ee.undefined(t.languageId)||ee.string(t.languageId))&&ee.number(t.lineCount)&&ee.func(t.getText)&&ee.func(t.positionAt)&&ee.func(t.offsetAt))},e.applyEdits=function(e,t){for(var n=e.getText(),i=function e(t,n){if(t.length<=1)return t;var i=t.length/2|0,s=t.slice(0,i),r=t.slice(i);e(s,n),e(r,n);var o=0,a=0,c=0;for(;o<s.length&&a<r.length;){var l=n(s[o],r[a]);t[c++]=l<=0?s[o++]:r[a++]}for(;o<s.length;)t[c++]=s[o++];for(;a<r.length;)t[c++]=r[a++];return t}(t,(function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),s=n.length,r=i.length-1;r>=0;r--){var o=i[r],a=e.offsetAt(o.range.start),c=e.offsetAt(o.range.end);if(!(c<=s))throw new Error("Overlapping edit");n=n.substring(0,a)+o.newText+n.substring(c,n.length),s=a}return n}}(Z||(Z={}));var ee,te=function(){function e(e,t,n,i){this._uri=e,this._languageId=t,this._version=n,this._content=i,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!0,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0},e.prototype.getLineOffsets=function(){if(void 0===this._lineOffsets){for(var e=[],t=this._content,n=!0,i=0;i<t.length;i++){n&&(e.push(i),n=!1);var s=t.charAt(i);n="\r"===s||"\n"===s,"\r"===s&&i+1<t.length&&"\n"===t.charAt(i+1)&&i++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,s=t.length;if(0===s)return i.create(0,e);for(;n<s;){var r=Math.floor((n+s)/2);t[r]>e?s=r:n=r+1}var o=n-1;return i.create(o,e-t[o])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!0,configurable:!0}),e}();!function(e){var t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(ee||(ee={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1286),s=n(56),r=n(41),o=n(1287);t.ImplementationRequest=o.ImplementationRequest;const a=n(1288);t.TypeDefinitionRequest=a.TypeDefinitionRequest;const c=n(1289);t.WorkspaceFoldersRequest=c.WorkspaceFoldersRequest,t.DidChangeWorkspaceFoldersNotification=c.DidChangeWorkspaceFoldersNotification;const l=n(1290);t.ConfigurationRequest=l.ConfigurationRequest;const u=n(1291);t.DocumentColorRequest=u.DocumentColorRequest,t.ColorPresentationRequest=u.ColorPresentationRequest;const d=n(1292);t.FoldingRangeRequest=d.FoldingRangeRequest;const h=n(1293);t.DeclarationRequest=h.DeclarationRequest;const f=n(1294);t.SelectionRangeRequest=f.SelectionRangeRequest;const p=n(1295);var m,g;t.WorkDoneProgress=p.WorkDoneProgress,t.WorkDoneProgressCreateRequest=p.WorkDoneProgressCreateRequest,t.WorkDoneProgressCancelNotification=p.WorkDoneProgressCancelNotification,function(e){e.is=function(e){const t=e;return i.string(t.language)||i.string(t.scheme)||i.string(t.pattern)}}(m=t.DocumentFilter||(t.DocumentFilter={})),function(e){e.is=function(e){if(!Array.isArray(e))return!1;for(let t of e)if(!i.string(t)&&!m.is(t))return!1;return!0}}(g=t.DocumentSelector||(t.DocumentSelector={})),function(e){e.type=new r.ProtocolRequestType("client/registerCapability")}(t.RegistrationRequest||(t.RegistrationRequest={})),function(e){e.type=new r.ProtocolRequestType("client/unregisterCapability")}(t.UnregistrationRequest||(t.UnregistrationRequest={})),function(e){e.Create="create",e.Rename="rename",e.Delete="delete"}(t.ResourceOperationKind||(t.ResourceOperationKind={})),function(e){e.Abort="abort",e.Transactional="transactional",e.TextOnlyTransactional="textOnlyTransactional",e.Undo="undo"}(t.FailureHandlingKind||(t.FailureHandlingKind={})),function(e){e.hasId=function(e){const t=e;return t&&i.string(t.id)&&t.id.length>0}}(t.StaticRegistrationOptions||(t.StaticRegistrationOptions={})),function(e){e.is=function(e){const t=e;return t&&(null===t.documentSelector||g.is(t.documentSelector))}}(t.TextDocumentRegistrationOptions||(t.TextDocumentRegistrationOptions={})),function(e){e.is=function(e){const t=e;return i.objectLiteral(t)&&(void 0===t.workDoneProgress||i.boolean(t.workDoneProgress))},e.hasWorkDoneProgress=function(e){const t=e;return t&&i.boolean(t.workDoneProgress)}}(t.WorkDoneProgressOptions||(t.WorkDoneProgressOptions={})),function(e){e.type=new r.ProtocolRequestType("initialize")}(t.InitializeRequest||(t.InitializeRequest={})),function(e){e.unknownProtocolVersion=1}(t.InitializeError||(t.InitializeError={})),function(e){e.type=new r.ProtocolNotificationType("initialized")}(t.InitializedNotification||(t.InitializedNotification={})),function(e){e.type=new r.ProtocolRequestType0("shutdown")}(t.ShutdownRequest||(t.ShutdownRequest={})),function(e){e.type=new r.ProtocolNotificationType0("exit")}(t.ExitNotification||(t.ExitNotification={})),function(e){e.type=new r.ProtocolNotificationType("workspace/didChangeConfiguration")}(t.DidChangeConfigurationNotification||(t.DidChangeConfigurationNotification={})),function(e){e.Error=1,e.Warning=2,e.Info=3,e.Log=4}(t.MessageType||(t.MessageType={})),function(e){e.type=new r.ProtocolNotificationType("window/showMessage")}(t.ShowMessageNotification||(t.ShowMessageNotification={})),function(e){e.type=new r.ProtocolRequestType("window/showMessageRequest")}(t.ShowMessageRequest||(t.ShowMessageRequest={})),function(e){e.type=new r.ProtocolNotificationType("window/logMessage")}(t.LogMessageNotification||(t.LogMessageNotification={})),function(e){e.type=new r.ProtocolNotificationType("telemetry/event")}(t.TelemetryEventNotification||(t.TelemetryEventNotification={})),function(e){e.None=0,e.Full=1,e.Incremental=2}(t.TextDocumentSyncKind||(t.TextDocumentSyncKind={})),function(e){e.method="textDocument/didOpen",e.type=new r.ProtocolNotificationType(e.method)}(t.DidOpenTextDocumentNotification||(t.DidOpenTextDocumentNotification={})),function(e){e.method="textDocument/didChange",e.type=new r.ProtocolNotificationType(e.method)}(t.DidChangeTextDocumentNotification||(t.DidChangeTextDocumentNotification={})),function(e){e.method="textDocument/didClose",e.type=new r.ProtocolNotificationType(e.method)}(t.DidCloseTextDocumentNotification||(t.DidCloseTextDocumentNotification={})),function(e){e.method="textDocument/didSave",e.type=new r.ProtocolNotificationType(e.method)}(t.DidSaveTextDocumentNotification||(t.DidSaveTextDocumentNotification={})),function(e){e.Manual=1,e.AfterDelay=2,e.FocusOut=3}(t.TextDocumentSaveReason||(t.TextDocumentSaveReason={})),function(e){e.method="textDocument/willSave",e.type=new r.ProtocolNotificationType(e.method)}(t.WillSaveTextDocumentNotification||(t.WillSaveTextDocumentNotification={})),function(e){e.method="textDocument/willSaveWaitUntil",e.type=new r.ProtocolRequestType(e.method)}(t.WillSaveTextDocumentWaitUntilRequest||(t.WillSaveTextDocumentWaitUntilRequest={})),function(e){e.type=new r.ProtocolNotificationType("workspace/didChangeWatchedFiles")}(t.DidChangeWatchedFilesNotification||(t.DidChangeWatchedFilesNotification={})),function(e){e.Created=1,e.Changed=2,e.Deleted=3}(t.FileChangeType||(t.FileChangeType={})),function(e){e.Create=1,e.Change=2,e.Delete=4}(t.WatchKind||(t.WatchKind={})),function(e){e.type=new r.ProtocolNotificationType("textDocument/publishDiagnostics")}(t.PublishDiagnosticsNotification||(t.PublishDiagnosticsNotification={})),function(e){e.Invoked=1,e.TriggerCharacter=2,e.TriggerForIncompleteCompletions=3}(t.CompletionTriggerKind||(t.CompletionTriggerKind={})),function(e){e.method="textDocument/completion",e.type=new r.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.CompletionRequest||(t.CompletionRequest={})),function(e){e.method="completionItem/resolve",e.type=new r.ProtocolRequestType(e.method)}(t.CompletionResolveRequest||(t.CompletionResolveRequest={})),function(e){e.method="textDocument/hover",e.type=new r.ProtocolRequestType(e.method)}(t.HoverRequest||(t.HoverRequest={})),function(e){e.Invoked=1,e.TriggerCharacter=2,e.ContentChange=3}(t.SignatureHelpTriggerKind||(t.SignatureHelpTriggerKind={})),function(e){e.method="textDocument/signatureHelp",e.type=new r.ProtocolRequestType(e.method)}(t.SignatureHelpRequest||(t.SignatureHelpRequest={})),function(e){e.method="textDocument/definition",e.type=new r.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.DefinitionRequest||(t.DefinitionRequest={})),function(e){e.method="textDocument/references",e.type=new r.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.ReferencesRequest||(t.ReferencesRequest={})),function(e){e.method="textDocument/documentHighlight",e.type=new r.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.DocumentHighlightRequest||(t.DocumentHighlightRequest={})),function(e){e.method="textDocument/documentSymbol",e.type=new r.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.DocumentSymbolRequest||(t.DocumentSymbolRequest={})),function(e){e.method="textDocument/codeAction",e.type=new r.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.CodeActionRequest||(t.CodeActionRequest={})),function(e){e.method="workspace/symbol",e.type=new r.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.WorkspaceSymbolRequest||(t.WorkspaceSymbolRequest={})),function(e){e.type=new r.ProtocolRequestType("textDocument/codeLens"),e.resultType=new s.ProgressType}(t.CodeLensRequest||(t.CodeLensRequest={})),function(e){e.type=new r.ProtocolRequestType("codeLens/resolve")}(t.CodeLensResolveRequest||(t.CodeLensResolveRequest={})),function(e){e.method="textDocument/documentLink",e.type=new r.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.DocumentLinkRequest||(t.DocumentLinkRequest={})),function(e){e.type=new r.ProtocolRequestType("documentLink/resolve")}(t.DocumentLinkResolveRequest||(t.DocumentLinkResolveRequest={})),function(e){e.method="textDocument/formatting",e.type=new r.ProtocolRequestType(e.method)}(t.DocumentFormattingRequest||(t.DocumentFormattingRequest={})),function(e){e.method="textDocument/rangeFormatting",e.type=new r.ProtocolRequestType(e.method)}(t.DocumentRangeFormattingRequest||(t.DocumentRangeFormattingRequest={})),function(e){e.method="textDocument/onTypeFormatting",e.type=new r.ProtocolRequestType(e.method)}(t.DocumentOnTypeFormattingRequest||(t.DocumentOnTypeFormattingRequest={})),function(e){e.method="textDocument/rename",e.type=new r.ProtocolRequestType(e.method)}(t.RenameRequest||(t.RenameRequest={})),function(e){e.method="textDocument/prepareRename",e.type=new r.ProtocolRequestType(e.method)}(t.PrepareRenameRequest||(t.PrepareRenameRequest={})),function(e){e.type=new r.ProtocolRequestType("workspace/executeCommand")}(t.ExecuteCommandRequest||(t.ExecuteCommandRequest={})),function(e){e.type=new r.ProtocolRequestType("workspace/applyEdit")}(t.ApplyWorkspaceEditRequest||(t.ApplyWorkspaceEditRequest={}))},function(e,t,n){"use strict";function i(e){return"string"==typeof e||e instanceof String}function s(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=function(e){return!0===e||!1===e},t.string=i,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=s,t.stringArray=function(e){return s(e)&&e.every(e=>i(e))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.objectLiteral=function(e){return null!==e&&"object"==typeof e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(56),s=n(41);!function(e){e.method="textDocument/implementation",e.type=new s.ProtocolRequestType(e.method),e.resultType=new i.ProgressType}(t.ImplementationRequest||(t.ImplementationRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(56),s=n(41);!function(e){e.method="textDocument/typeDefinition",e.type=new s.ProtocolRequestType(e.method),e.resultType=new i.ProgressType}(t.TypeDefinitionRequest||(t.TypeDefinitionRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(41);!function(e){e.type=new i.ProtocolRequestType0("workspace/workspaceFolders")}(t.WorkspaceFoldersRequest||(t.WorkspaceFoldersRequest={})),function(e){e.type=new i.ProtocolNotificationType("workspace/didChangeWorkspaceFolders")}(t.DidChangeWorkspaceFoldersNotification||(t.DidChangeWorkspaceFoldersNotification={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(41);!function(e){e.type=new i.ProtocolRequestType("workspace/configuration")}(t.ConfigurationRequest||(t.ConfigurationRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(56),s=n(41);!function(e){e.method="textDocument/documentColor",e.type=new s.ProtocolRequestType(e.method),e.resultType=new i.ProgressType}(t.DocumentColorRequest||(t.DocumentColorRequest={})),function(e){e.type=new s.ProtocolRequestType("textDocument/colorPresentation")}(t.ColorPresentationRequest||(t.ColorPresentationRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(56),s=n(41);!function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(t.FoldingRangeKind||(t.FoldingRangeKind={})),function(e){e.method="textDocument/foldingRange",e.type=new s.ProtocolRequestType(e.method),e.resultType=new i.ProgressType}(t.FoldingRangeRequest||(t.FoldingRangeRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(56),s=n(41);!function(e){e.method="textDocument/declaration",e.type=new s.ProtocolRequestType(e.method),e.resultType=new i.ProgressType}(t.DeclarationRequest||(t.DeclarationRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(56),s=n(41);!function(e){e.method="textDocument/selectionRange",e.type=new s.ProtocolRequestType(e.method),e.resultType=new i.ProgressType}(t.SelectionRangeRequest||(t.SelectionRangeRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(56),s=n(41);!function(e){e.type=new i.ProgressType}(t.WorkDoneProgress||(t.WorkDoneProgress={})),function(e){e.type=new s.ProtocolRequestType("window/workDoneProgress/create")}(t.WorkDoneProgressCreateRequest||(t.WorkDoneProgressCreateRequest={})),function(e){e.type=new s.ProtocolNotificationType("window/workDoneProgress/cancel")}(t.WorkDoneProgressCancelNotification||(t.WorkDoneProgressCancelNotification={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(41);!function(e){e.method="textDocument/prepareCallHierarchy",e.type=new i.ProtocolRequestType(e.method)}(t.CallHierarchyPrepareRequest||(t.CallHierarchyPrepareRequest={})),function(e){e.method="callHierarchy/incomingCalls",e.type=new i.ProtocolRequestType(e.method)}(t.CallHierarchyIncomingCallsRequest||(t.CallHierarchyIncomingCallsRequest={})),function(e){e.method="callHierarchy/outgoingCalls",e.type=new i.ProtocolRequestType(e.method)}(t.CallHierarchyOutgoingCallsRequest||(t.CallHierarchyOutgoingCallsRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(41);!function(e){e.comment="comment",e.keyword="keyword",e.string="string",e.number="number",e.regexp="regexp",e.operator="operator",e.namespace="namespace",e.type="type",e.struct="struct",e.class="class",e.interface="interface",e.enum="enum",e.typeParameter="typeParameter",e.function="function",e.member="member",e.property="property",e.macro="macro",e.variable="variable",e.parameter="parameter",e.label="label"}(t.SemanticTokenTypes||(t.SemanticTokenTypes={})),function(e){e.documentation="documentation",e.declaration="declaration",e.definition="definition",e.reference="reference",e.static="static",e.abstract="abstract",e.deprecated="deprecated",e.async="async",e.volatile="volatile",e.readonly="readonly"}(t.SemanticTokenModifiers||(t.SemanticTokenModifiers={})),function(e){e.is=function(e){const t=e;return void 0!==t&&(void 0===t.resultId||"string"==typeof t.resultId)&&Array.isArray(t.data)&&(0===t.data.length||"number"==typeof t.data[0])}}(t.SemanticTokens||(t.SemanticTokens={})),function(e){e.method="textDocument/semanticTokens",e.type=new i.ProtocolRequestType(e.method)}(t.SemanticTokensRequest||(t.SemanticTokensRequest={})),function(e){e.method="textDocument/semanticTokens/edits",e.type=new i.ProtocolRequestType(e.method)}(t.SemanticTokensEditsRequest||(t.SemanticTokensEditsRequest={})),function(e){e.method="textDocument/semanticTokens/range",e.type=new i.ProtocolRequestType(e.method)}(t.SemanticTokensRangeRequest||(t.SemanticTokensRangeRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Delayer=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(e=>{this.onSuccess=e}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var e=this.task();return this.task=void 0,e})),(t>=0||void 0===this.timeout)&&(this.timeout=setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return void 0!==this.timeout}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){void 0!==this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(111),s=n(71),r=n(0),o=n(30),a=n(110);function c(e,t){return void 0===e[t]&&(e[t]={}),e[t]}class l extends a.TextDocumentFeature{constructor(e){super(e,o.DocumentColorRequest.type)}fillClientCapabilities(e){c(c(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){if(!e.colorProvider)return;const n=e.colorProvider,r=s.string(n.id)&&n.id.length>0?n.id:i.generateUuid(),o=n.documentSelector||t;o&&this.register(this.messages,{id:r,registerOptions:Object.assign({},{documentSelector:o})})}registerLanguageProvider(e){let t=this._client,n=(e,n,i)=>{const s={color:e,textDocument:t.code2ProtocolConverter.asTextDocumentIdentifier(n.document),range:t.code2ProtocolConverter.asRange(n.range)};return t.sendRequest(o.ColorPresentationRequest.type,s,i).then(this.asColorPresentations.bind(this),e=>(t.logFailedRequest(o.ColorPresentationRequest.type,e),Promise.resolve(null)))},i=(e,n)=>{const i={textDocument:t.code2ProtocolConverter.asTextDocumentIdentifier(e)};return t.sendRequest(o.DocumentColorRequest.type,i,n).then(this.asColorInformations.bind(this),e=>(t.logFailedRequest(o.ColorPresentationRequest.type,e),Promise.resolve(null)))},s=t.clientOptions.middleware;return r.languages.registerColorProvider(e.documentSelector,{provideColorPresentations:(e,t,i)=>s.provideColorPresentations?s.provideColorPresentations(e,t,i,n):n(e,t,i),provideDocumentColors:(e,t)=>s.provideDocumentColors?s.provideDocumentColors(e,t,i):i(e,t)})}asColor(e){return new r.Color(e.red,e.green,e.blue,e.alpha)}asColorInformations(e){return Array.isArray(e)?e.map(e=>new r.ColorInformation(this._client.protocol2CodeConverter.asRange(e.range),this.asColor(e.color))):[]}asColorPresentations(e){return Array.isArray(e)?e.map(e=>{let t=new r.ColorPresentation(e.label);return t.additionalTextEdits=this._client.protocol2CodeConverter.asTextEdits(e.additionalTextEdits),t.textEdit=this._client.protocol2CodeConverter.asTextEdit(e.textEdit),t}):[]}}t.ColorProviderFeature=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(30);t.ConfigurationFeature=class{constructor(e){this._client=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(s.ConfigurationRequest.type,(t,n)=>{let i=e=>{let t=[];for(let n of e.items){let e=void 0!==n.scopeUri&&null!==n.scopeUri?this._client.protocol2CodeConverter.asUri(n.scopeUri):void 0;t.push(this.getConfiguration(e,null!==n.section?n.section:void 0))}return t},s=e.clientOptions.middleware.workspace;return s&&s.configuration?s.configuration(t,n,i):i(t)})}getConfiguration(e,t){let n=null;if(t){let s=t.lastIndexOf(".");if(-1===s)n=i.workspace.getConfiguration(void 0,e).get(t);else{let e=i.workspace.getConfiguration(t.substr(0,s));e&&(n=e.get(t.substr(s+1)))}}else{let t=i.workspace.getConfiguration(void 0,e);n={};for(let e of Object.keys(t))t.has(e)&&(n[e]=t.get(e))}return n||null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(111),s=n(71),r=n(0),o=n(30),a=n(110);function c(e,t){return void 0===e[t]&&(e[t]={}),e[t]}class l extends a.TextDocumentFeature{constructor(e){super(e,o.ImplementationRequest.type)}fillClientCapabilities(e){c(c(e,"textDocument"),"implementation").dynamicRegistration=!0}initialize(e,t){if(e.implementationProvider)if(!0===e.implementationProvider){if(!t)return;this.register(this.messages,{id:i.generateUuid(),registerOptions:Object.assign({},{documentSelector:t})})}else{const n=e.implementationProvider,r=s.string(n.id)&&n.id.length>0?n.id:i.generateUuid(),o=n.documentSelector||t;o&&this.register(this.messages,{id:r,registerOptions:Object.assign({},{documentSelector:o})})}}registerLanguageProvider(e){let t=this._client,n=(e,n,i)=>t.sendRequest(o.ImplementationRequest.type,t.code2ProtocolConverter.asTextDocumentPositionParams(e,n),i).then(t.protocol2CodeConverter.asDefinitionResult,e=>(t.logFailedRequest(o.ImplementationRequest.type,e),Promise.resolve(null))),i=t.clientOptions.middleware;return r.languages.registerImplementationProvider(e.documentSelector,{provideImplementation:(e,t,s)=>i.provideImplementation?i.provideImplementation(e,t,s,n):n(e,t,s)})}}t.ImplementationFeature=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(111),s=n(71),r=n(0),o=n(30),a=n(110);function c(e,t){return void 0===e[t]&&(e[t]={}),e[t]}class l extends a.TextDocumentFeature{constructor(e){super(e,o.TypeDefinitionRequest.type)}fillClientCapabilities(e){c(c(e,"textDocument"),"typeDefinition").dynamicRegistration=!0}initialize(e,t){if(e.typeDefinitionProvider)if(!0===e.typeDefinitionProvider){if(!t)return;this.register(this.messages,{id:i.generateUuid(),registerOptions:Object.assign({},{documentSelector:t})})}else{const n=e.typeDefinitionProvider,r=s.string(n.id)&&n.id.length>0?n.id:i.generateUuid(),o=n.documentSelector||t;o&&this.register(this.messages,{id:r,registerOptions:Object.assign({},{documentSelector:o})})}}registerLanguageProvider(e){let t=this._client,n=(e,n,i)=>t.sendRequest(o.TypeDefinitionRequest.type,t.code2ProtocolConverter.asTextDocumentPositionParams(e,n),i).then(t.protocol2CodeConverter.asDefinitionResult,e=>(t.logFailedRequest(o.TypeDefinitionRequest.type,e),Promise.resolve(null))),i=t.clientOptions.middleware;return r.languages.registerTypeDefinitionProvider(e.documentSelector,{provideTypeDefinition:(e,t,s)=>i.provideTypeDefinition?i.provideTypeDefinition(e,t,s,n):n(e,t,s)})}}t.TypeDefinitionFeature=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(111),s=n(0),r=n(30);function o(e,t){if(void 0!==e)return e[t]}t.WorkspaceFoldersFeature=class{constructor(e){this._client=e,this._listeners=new Map}get messages(){return r.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=s.workspace.workspaceFolders;e.workspaceFolders=void 0===t?null:t.map(e=>this.asProtocol(e))}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(r.WorkspaceFoldersRequest.type,e=>{let n=()=>{let e=s.workspace.workspaceFolders;return void 0===e?null:e.map(e=>this.asProtocol(e))},i=t.clientOptions.middleware.workspace;return i&&i.workspaceFolders?i.workspaceFolders(e,n):n()});let n,a=o(o(o(e,"workspace"),"workspaceFolders"),"changeNotifications");"string"==typeof a?n=a:!0===a&&(n=i.generateUuid()),n&&this.register(this.messages,{id:n,registerOptions:void 0})}register(e,t){let n=t.id,i=this._client,o=s.workspace.onDidChangeWorkspaceFolders(e=>{let t=e=>{let t={event:{added:e.added.map(e=>this.asProtocol(e)),removed:e.removed.map(e=>this.asProtocol(e))}};this._client.sendNotification(r.DidChangeWorkspaceFoldersNotification.type,t)},n=i.clientOptions.middleware.workspace;n&&n.didChangeWorkspaceFolders?n.didChangeWorkspaceFolders(e,t):t(e)});this._listeners.set(n,o)}unregister(e){let t=this._listeners.get(e);void 0!==t&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return void 0===e?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(111),s=n(71),r=n(0),o=n(30),a=n(110);function c(e,t){return void 0===e[t]&&(e[t]={}),e[t]}class l extends a.TextDocumentFeature{constructor(e){super(e,o.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=c(c(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0}initialize(e,t){if(!e.foldingRangeProvider)return;const n=e.foldingRangeProvider,r=s.string(n.id)&&n.id.length>0?n.id:i.generateUuid(),o=n.documentSelector||t;o&&this.register(this.messages,{id:r,registerOptions:Object.assign({},{documentSelector:o})})}registerLanguageProvider(e){let t=this._client,n=(e,n,i)=>{const s={textDocument:t.code2ProtocolConverter.asTextDocumentIdentifier(e)};return t.sendRequest(o.FoldingRangeRequest.type,s,i).then(this.asFoldingRanges.bind(this),e=>(t.logFailedRequest(o.FoldingRangeRequest.type,e),Promise.resolve(null)))},i=t.clientOptions.middleware;return r.languages.registerFoldingRangeProvider(e.documentSelector,{provideFoldingRanges:(e,t,s)=>i.provideFoldingRanges?i.provideFoldingRanges(e,t,s,n):n(e,0,s)})}asFoldingRangeKind(e){if(e)switch(e){case o.FoldingRangeKind.Comment:return r.FoldingRangeKind.Comment;case o.FoldingRangeKind.Imports:return r.FoldingRangeKind.Imports;case o.FoldingRangeKind.Region:return r.FoldingRangeKind.Region}}asFoldingRanges(e){return Array.isArray(e)?e.map(e=>new r.FoldingRange(e.startLine,e.endLine,this.asFoldingRangeKind(e.kind))):[]}}t.FoldingRangeFeature=l},function(e,t,n){"use strict";(function(e,i){Object.defineProperty(t,"__esModule",{value:!0});const s=n(18),r=n(117),o=n(66),a=n(185);function c(){let t="vscode-lang-"+function(e){let t=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],n="";for(let i=0;i<e;i++){n+=t[Math.floor(t.length*Math.random())]}return n}(40);return"win32"===e.platform?"\\\\.\\pipe\\"+t+"-sock":s.join(r.tmpdir(),t+".sock")}t.fork=function(t,n,r,l){let u,d=!1,h=e=>{d||(d=!0,l(e,void 0))},f=c(),p=c(),m=function(e,t,n){let i={};for(let t in e)i[t]=e[t];return i.STDIN_PIPE_NAME=t,i.STDOUT_PIPE_NAME=n,i.ATOM_SHELL_INTERNAL_RUN_AS_NODE="1",i.ELECTRON_RUN_AS_NODE="1",i}(r.env||e.env,f,p),g=o.createServer(e=>{e.once("data",t=>{var n;u.stdin=o.connect(f),u.stdout=e,n=u,d||(d=!0,l(void 0,n))})});g.listen(p);let y=!1,v=()=>{y||(y=!0,e.removeListener("exit",v),g.close())},S=s.join(i,"electronForkStart");u=a.fork(S,[t].concat(n),{silent:!0,cwd:r.cwd,env:m,execArgv:r.execArgv}),u.once("error",e=>{v(),h(e)}),u.once("exit",e=>{v(),h(e)}),e.once("exit",v)}}).call(this,n(11),"/")},function(e,t,n){"use strict";(function(e,i){Object.defineProperty(t,"__esModule",{value:!0});const s=n(185),r=n(18),o="win32"===e.platform,a="darwin"===e.platform,c="linux"===e.platform;t.terminate=function(e,t){if(o)try{let n={stdio:["pipe","pipe","ignore"]};return t&&(n.cwd=t),s.execFileSync("taskkill",["/T","/F","/PID",e.pid.toString()],n),!0}catch(e){return!1}else{if(!c&&!a)return e.kill("SIGKILL"),!0;try{var n=r.join(i,"terminateProcess.sh");return!s.spawnSync(n,[e.pid.toString()]).error}catch(e){return!1}}}}).call(this,n(11),"/")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(1308),r=n(189),o=n(4);t.CommentsViewItem="comments";const a=s.loadMessageBundle();class c extends o.TreeDataProviderBase{constructor(){super(t.CommentsViewItem,o.TreeDataProviderContext.SharedOrJoined)}registerService(e){return this.commentManager=e,e.onCommentCountChanged(()=>this.forceRefreshItems())}getChildrenItems(e){return Promise.resolve([])}getRootItem(){let e;if(r.commentsSupported()){const n=a("SessionExplorer.CommentsLabel","Comments ({0})",this.commentManager.commentCount);e=new o.TreeViewItem({type:t.CommentsViewItem,collapsibleState:i.TreeItemCollapsibleState.None,label:n,command:{title:"Focus comment panel...",command:"workbench.action.focusCommentsPanel"}})}return Promise.resolve(e)}}t.CommentsTreeDataProvider=c},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i,s,r,o,a,c,l=n(18),u=n(74),d=Object.prototype.toString;function h(e){return void 0!==e}function f(e){return"[object Number]"===d.call(e)}function p(e){return"[object String]"===d.call(e)}function m(e){return JSON.parse(u.readFileSync(e,"utf8"))}function g(e,t){return c&&(e=""+e.replace(/[aouei]/g,"$&$&")+""),0===t.length?e:e.replace(/\{(\d+)\}/g,(function(e,n){var i=n[0],s=t[i],r=e;return"string"==typeof s?r=s:"number"!=typeof s&&"boolean"!=typeof s&&null!=s||(r=String(s)),r}))}function y(e){return function(t,n){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];return f(t)?t>=e.length?void console.error("Broken localize call found. Index out of bounds. Stacktrace is\n: "+new Error("").stack):g(e[t],i):p(n)?(console.warn("Message "+n+" didn't get externalized correctly."),g(n,i)):void console.error("Broken localize call found. Stacktrace is\n: "+new Error("").stack)}}function v(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return g(t,n)}function S(e,t){return o[e]=t,t}function _(e,t){var n,i,s,r=l.join(a.cacheRoot,e.id+"-"+e.hash+".json"),o=!1,c=!1;try{return n=JSON.parse(u.readFileSync(r,{encoding:"utf8",flag:"r"})),i=r,s=new Date,u.utimes(i,s,s,(function(){})),n}catch(e){if("ENOENT"===e.code)c=!0;else{if(!(e instanceof SyntaxError))throw e;console.log("Syntax error parsing message bundle: "+e.message+"."),u.unlink(r,(function(e){e&&console.error("Deleting corrupted bundle "+r+" failed.")})),o=!0}}if(!(n=function(e,t){var n=a.translationsConfig[e.id];if(n){var i=m(n).contents,s=m(l.join(t,"nls.metadata.json")),r=Object.create(null);for(var o in s){var c=s[o],u=i[e.outDir+"/"+o];if(u){for(var d=[],h=0;h<c.keys.length;h++){var f=c.keys[h],g=u[p(f)?f:f.key];void 0===g&&(g=c.messages[h]),d.push(g)}r[o]=d}else r[o]=c.messages}return r}}(e,t))||o)return n;if(c)try{u.writeFileSync(r,JSON.stringify(n),{encoding:"utf8",flag:"wx"})}catch(e){if("EEXIST"===e.code)return n;throw e}return n}function E(e){try{return function(e){var t=m(l.join(e,"nls.metadata.json")),n=Object.create(null);for(var i in t){var s=t[i];n[i]=s.messages}return n}(e)}catch(e){return void console.log("Generating default bundle from meta data failed.",e)}}function w(e,t){var n;if(!0===a.languagePackSupport&&void 0!==a.cacheRoot&&void 0!==a.languagePackId&&void 0!==a.translationsConfigFile&&void 0!==a.translationsConfig)try{n=_(e,t)}catch(e){console.log("Load or create bundle failed ",e)}if(!n){if(a.languagePackSupport)return E(t);var i=function(e){for(var t=a.language;t;){var n=l.join(e,"nls.bundle."+t+".json");if(u.existsSync(n))return n;var i=t.lastIndexOf("-");t=i>0?t.substring(0,i):void 0}if(void 0===t){n=l.join(e,"nls.bundle.json");if(u.existsSync(n))return n}}(t);if(i)try{return m(i)}catch(e){console.log("Loading in the box message bundle failed.",e)}n=E(t)}return n}function b(e){if(!e)return v;var t=l.extname(e);if(t&&(e=e.substr(0,e.length-t.length)),a.messageFormat===i.both||a.messageFormat===i.bundle){var n=function(e){for(var t,n=l.dirname(e);t=l.join(n,"nls.metadata.header.json"),!u.existsSync(t);){var i=l.dirname(n);if(i===n){t=void 0;break}n=i}return t}(e);if(n){var s=l.dirname(n),r=o[s];if(void 0===r)try{var d=JSON.parse(u.readFileSync(n,"utf8"));try{var f=w(d,s);r=S(s,f?{header:d,nlsBundle:f}:null)}catch(e){console.error("Failed to load nls bundle",e),r=S(s,null)}}catch(e){console.error("Failed to read header file",e),r=S(s,null)}if(r){var p=e.substr(s.length+1).replace(/\\/g,"/"),g=r.nlsBundle[p];return void 0===g?(console.error("Messages for file "+e+" not found. See console for details."),function(){return"Messages not found."}):y(g)}}}if(a.messageFormat===i.both||a.messageFormat===i.file)try{var _=m(function(e){var t;if(a.cacheLanguageResolution&&t)t=t;else{if(c||!a.language)t=".nls.json";else for(var n=a.language;n;){var i=".nls."+n+".json";if(u.existsSync(e+i)){t=i;break}var s=n.lastIndexOf("-");s>0?n=n.substring(0,s):(t=".nls.json",n=null)}a.cacheLanguageResolution&&(t=t)}return e+t}(e));return Array.isArray(_)?y(_):h(_.messages)&&h(_.keys)?y(_.messages):(console.error("String bundle '"+e+"' uses an unsupported format."),function(){return"File bundle has unsupported format. See console for details"})}catch(e){"ENOENT"!==e.code&&console.error("Failed to load single file bundle",e)}return console.error("Failed to load message bundle for file "+e),function(){return"Failed to load message bundle. See console for details."}}!function(e){e.file="file",e.bundle="bundle",e.both="both"}(i=t.MessageFormat||(t.MessageFormat={})),function(e){e.standalone="standalone",e.languagePack="languagePack"}(s=t.BundleFormat||(t.BundleFormat={})),function(e){e.is=function(e){var t=e;return t&&h(t.key)&&h(t.comment)}}(r||(r={})),function(){if(a={locale:void 0,language:void 0,languagePackSupport:!1,cacheLanguageResolution:!0,messageFormat:i.bundle},p(e.env.VSCODE_NLS_CONFIG))try{var t=JSON.parse(e.env.VSCODE_NLS_CONFIG),n=void 0;if(t.availableLanguages){var s=t.availableLanguages["*"];p(s)&&(n=s)}if(p(t.locale)&&(a.locale=t.locale.toLowerCase()),void 0===n?a.language=a.locale:"en"!==n&&(a.language=n),function(e){return!0===e||!1===e}(t._languagePackSupport)&&(a.languagePackSupport=t._languagePackSupport),p(t._cacheRoot)&&(a.cacheRoot=t._cacheRoot),p(t._languagePackId)&&(a.languagePackId=t._languagePackId),p(t._translationsConfigFile)){a.translationsConfigFile=t._translationsConfigFile;try{a.translationsConfig=m(a.translationsConfigFile)}catch(e){if(t._corruptedFile){var r=l.dirname(t._corruptedFile);u.exists(r,(function(e){e&&u.writeFile(t._corruptedFile,"corrupted","utf8",(function(e){console.error(e)}))}))}}}}catch(e){}c="pseudo"===a.locale,void 0,o=Object.create(null)}(),t.loadMessageBundle=b,t.config=function(e){return e&&(p(e.locale)&&(a.locale=e.locale.toLowerCase(),a.language=a.locale,void 0,o=Object.create(null)),void 0!==e.messageFormat&&(a.messageFormat=e.messageFormat),e.bundleFormat===s.standalone&&!0===a.languagePackSupport&&(a.languagePackSupport=!1)),c="pseudo"===a.locale,b}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(4),r=n(4),o=n(5);t.HostCoauthorCommitMessageUpdater=class{constructor(e,t){this.disposables=[],this.coauthors=[],this.sourceControl=t,this.sessionContext=e.sessionContext(),this.workspaceUserService=e.workspaceUserService()}async init(){this.workspaceUserService.onWorkspaceSessionChanged(this.onWorkspaceSessionChanged,this,this.disposables),i.workspace.onDidChangeConfiguration(e=>{e.affectsConfiguration("liveshare.populateGitCoAuthors")&&this.updateCommitMessageIfEnabled()},this.disposables)}async dispose(){this.disposables.forEach(e=>e.dispose()),this.disposables=[],this.coauthors=[]}onWorkspaceSessionChanged({changeType:e,userProfile:t}){e===o.vsls.WorkspaceSessionChangeType.Joined&&this.addCoauthor(t)}addCoauthor(e){if(!e||e.isOwner||!e.name||!e.email||e.isAnonymous)return;const t=`Co-authored-by: ${e.name} <${e.email}>`;this.coauthors.includes(t)||this.coauthors.push(t),this.updateCommitMessageIfEnabled()}updateCommitMessageIfEnabled(){"always"!==s.Settings.get(s.SettingKeys.populateGitCoAuthors)||r.workspaceSessionInfoTracker.isReadOnly||this.sourceControl.updateCommitMessage(this.updateCoauthorsInCommitMessage.bind(this))}updateCoauthorsInCommitMessage(e){if(this.coauthors.length){(e=e||"").includes("Co-authored-by: ")||(e+="\n");for(const t of this.coauthors)e.includes(t)||(e+="\n"+t)}return e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1311),s=n(4),r=n(5),o={name:s.WellKnownRestrictedOperations.CodeAction};t.HostSourceControlService=class{constructor(e,t){this.providers=new Map,this.disposables=[],this.rpcServiceHandler=e.rpcServiceHandler(),this.workspaceService=e.workspaceService(),this.clientAccessCheck=t,this.fileService=e.fileService,this.session=e.sessionContext(),this.trace=e.trace().withName("SourceControl"),this.pathManager=e.pathManager()}async init(){this.isActive||(this.isActive=!0,this.addProvider(new i.HostGitSourceControlProvider(this.fileService(),this.pathManager)),this.rpcServiceHandler.addRequestMethod(`${r.vsls.SourceControlService.name}.getAllSourceControls`,e=>this.getSourceControls(null,null,e)),this.rpcServiceHandler.addRequestMethod(`${r.vsls.SourceControlService.name}.getSourceControls`,(e,t)=>this.getSourceControls(e,null,t)),this.rpcServiceHandler.addRequestMethod(`${r.vsls.SourceControlService.name}.getSourceControl`,(e,t)=>this.getSourceControl(e,t)),this.rpcServiceHandler.addRequestMethod(`${r.vsls.SourceControlService.name}.getRecentVersions`,(e,t)=>this.getRecentVersions(e,t)),this.rpcServiceHandler.addRequestMethod(`${r.vsls.SourceControlService.name}.getRecentVersionsTillMergeVersion`,(e,t)=>this.getRecentVersionsTillMergeVersion(e,t)),this.rpcServiceHandler.addRequestMethod(`${r.vsls.SourceControlService.name}.getCurrentVersionName`,(e,t)=>this.getCurrentVersionName(e,t)),this.rpcServiceHandler.addRequestMethod(`${r.vsls.SourceControlService.name}.getRemoteVersionsNames`,(e,t)=>this.getRemoteVersionsNames(e,t)),this.rpcServiceHandler.addRequestMethod(`${r.vsls.SourceControlService.name}.getMergeVersion`,(e,t,n)=>this.getMergeVersion(e,t,n)),this.rpcServiceHandler.addRequestMethod(`${r.vsls.SourceControlService.name}.getDiffsForVersion`,(e,t,n)=>this.getDiffsForVersion(e,t,n)),this.rpcServiceHandler.addRequestMethod(`${r.vsls.SourceControlService.name}.getDiffForResource`,(e,t)=>this.getDiffForResource(e,t)),this.rpcServiceHandler.addRequestMethod(`${r.vsls.SourceControlService.name}.getResource`,(e,t)=>this.getResource(e,t)),this.rpcServiceHandler.addRequestMethodWithContext(`${r.vsls.SourceControlService.name}.cleanResources`,(e,t,n)=>this.cleanResources(e,t,n)),await this.workspaceService.registerServicesAsync([`${r.vsls.SourceControlService.name}`],r.vsls.CollectionChangeType.Add))}async dispose(){await this.close()}async close(){if(this.isActive){if(this.isActive=!1,this.session.isStartingCollaboration||this.session.isCollaborating)try{await this.workspaceService.registerServicesAsync([`${r.vsls.SourceControlService.name}`],r.vsls.CollectionChangeType.Remove)}catch(e){}this.disposables.forEach(e=>e.dispose()),this.providers.forEach(e=>e.dispose()),this.providers.clear()}}addProvider(e){if(!e)throw new Error("provider is not defined");if(!this.isActive||this.providers.has(e.sourceControlId))return;this.providers.set(e.sourceControlId,e);const t=()=>{this.isActive&&(e.onResourceChanged(this.resourceChanged,this,this.disposables),e.onSourceControlChanged(this.sourceControlChanged,this,this.disposables),this.sourceControlChanged({change:r.vsls.SourceControlChange.Added,sourceControl:{sourceControlId:e.sourceControlId,instanceId:null}}))};e.isActive?t():e.activate().then(t,t=>{this.providers.delete(e.sourceControlId),this.providerActivationFailed(e,t)})}updateCommitMessage(e){if(e&&this.isActive)for(const t of this.providers.values())t.updateCommitMessages(e)}sourceControlChanged(e){this.isActive&&this.rpcServiceHandler.sendNotification(this.trace,`${r.vsls.SourceControlService.name}.sourceControlChanged`,e)}resourceChanged(e){this.isActive&&this.rpcServiceHandler.sendNotification(this.trace,`${r.vsls.SourceControlService.name}.resourceChanged`,e)}providerActivationFailed(e,t){this.trace.error(`'${e.sourceControlId}' host source control provider activation failed: ${t?t.message||t:"no reason provided"}`)}async getSourceControl(e,t){const{sourceControlId:n,instanceId:i}=e,[s]=await this.getSourceControls(n,i,t);return s||null}async getSourceControls(e,t,n){if(!this.isActive)return[];const i=[];this.providers.forEach(s=>s.isActive&&(!e||s.sourceControlId===e)&&i.push(s.getSourceControls(t,n)));const s=await Promise.all(i);return this.isActive?[].concat(...s):[]}async getRecentVersions(e,t){if(!e||!this.isActive)return[];const{sourceControlId:n,instanceId:i}=e,s=this.providers.get(n);return s?await s.getRecentVersions(i,t):[]}async getRecentVersionsTillMergeVersion(e,t,n){if(!t||!this.isActive)return[];const{sourceControlId:i,instanceId:s}=t,r=this.providers.get(i);return r?await r.getRecentVersionsTillMergeVersion(e,s,n):[]}async getMergeVersion(e,t,n){if(!e||!this.isActive)return null;const{sourceControlId:i,instanceId:s}=e,r=this.providers.get(i);return r?await r.getMergeVersion(s,t,n):null}getRemoteVersionsNames(e,t){if(!e||!this.isActive)return Promise.resolve([]);const{sourceControlId:n,instanceId:i}=e,s=this.providers.get(n);return s?Promise.resolve(s.getRemoteVersionsNames(i)):Promise.resolve([])}getCurrentVersionName(e,t){if(!e||!this.isActive)return Promise.resolve("");const{sourceControlId:n,instanceId:i}=e,s=this.providers.get(n);return s?Promise.resolve(s.getCurrentVersionName(i)):Promise.resolve("")}async getDiffsForVersion(e,t,n){if(!e||!this.isActive)return[];const{sourceControlId:i,instanceId:s}=e,r=this.providers.get(i);return r?await r.getDiffsForVersion(s,t,n):[]}async getDiffForResource(e,t){if(!e||!this.isActive)return null;const n=this.providers.get(e.sourceControlId);return n?await n.getDiffForResource(e,t):null}async getResource(e,t){if(!e||!this.isActive)return"";let n;const i=e.sourceControlId;if(i)n=this.providers.get(i);else{let t;switch(e.type){case r.vsls.SourceControlResourceType.Workspace:case r.vsls.SourceControlResourceType.WorkspaceWithSpecificVersion:t=s.VSLS_SCHEME;break;case r.vsls.SourceControlResourceType.External:t=s.VSLS_EXTERNAL_SCHEME}if(t){const i=this.pathManager.protocol2CodeUriConverter(t+":"+e.path);for(const e of this.providers.values())if(e.isSourceControlled(i)){n=e;break}}}return n?await n.getResource(e,t):""}async cleanResources(e,t,n){if(!e||!e.length||!this.isActive)return;if(this.clientAccessCheck&&!await this.clientAccessCheck().canPerformOperation(t,o))return;const i=new Map;for(const t of e){const{sourceControlId:e}=t,n=i.get(e);n?n.push(t):this.providers.has(e)&&i.set(e,[t])}const s=[];for(const[e,t]of i)s.push(this.providers.get(e).cleanResources(t,n));await Promise.all(s)}}},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=(n(1312),n(18)),a=n(18),c=n(0),l=n(4),u=n(7),d=n(4),h=n(5),f=n(57),p=["image/png","image/gif","image/jpeg","image/webp","image/tiff","image/bmp"];function m(e,t){if(!e||!e.path)return;let n=e.path;switch(e.type){case h.vsls.SourceControlResourceType.SpecificVerision:break;case h.vsls.SourceControlResourceType.Workspace:case h.vsls.SourceControlResourceType.WorkspaceWithSpecificVersion:n=t.protocolUri2CodeUriConverter(c.Uri.parse(`${d.VSLS_SCHEME}:${n}`)).fsPath;break;case h.vsls.SourceControlResourceType.External:if(n.startsWith("http:")||n.startsWith("https:"))return;n=t.protocolUri2CodeUriConverter(c.Uri.parse(n.startsWith(d.VSLS_SCHEME+":")||n.startsWith(d.VSLS_EXTERNAL_SCHEME+":")?n:`${d.VSLS_EXTERNAL_SCHEME}:${n}`)).fsPath;break;default:return}const i=e.version?JSON.parse(e.version):{ref:""};return i.path=n,i}function g(e,t,n,i){if(e){if(void 0===n&&void 0===i)return y(e,t);if("file"===e.scheme)return{type:h.vsls.SourceControlResourceType.SpecificVerision,path:e.fsPath,version:JSON.stringify({ref:n,submoduleOf:i})}}}function y(e,t){if(!e)return;const n=t.code2protocolWorkspaceFilesOnly(e);return n?{type:h.vsls.SourceControlResourceType.Workspace,path:n.path}:void 0}function v(e){switch(e){case 10:return h.vsls.SourceControlChangeType.AddByThem;case 9:return h.vsls.SourceControlChangeType.AddByUs;case 13:return h.vsls.SourceControlChangeType.AddBoth;case 14:return h.vsls.SourceControlChangeType.DeleteBoth;case 15:return h.vsls.SourceControlChangeType.Conflict;case 6:return h.vsls.SourceControlChangeType.Delete;case 12:return h.vsls.SourceControlChangeType.DeleteByThem;case 11:return h.vsls.SourceControlChangeType.DeleteByUs;case 8:return h.vsls.SourceControlChangeType.Ignored;case 1:return h.vsls.SourceControlChangeType.Add;case 4:return h.vsls.SourceControlChangeType.IndexCopy;case 2:return h.vsls.SourceControlChangeType.IndexDelete;case 0:return h.vsls.SourceControlChangeType.IndexEdit;case 3:return h.vsls.SourceControlChangeType.Rename;case 5:return h.vsls.SourceControlChangeType.Edit;case 7:return h.vsls.SourceControlChangeType.Untracked;default:return}}function S(e,t){return e===t||(e.charAt(e.length-1)!==a.sep&&(e+=a.sep),/^[a-zA-Z]:\\/.test(e)&&(e=e.toLowerCase(),t=t.toLowerCase()),t.startsWith(e))}t.getChangeType=v;class _{constructor(e,t){this.fileService=e,this.pathManager=t,this.instanceCount=0,this.rootUriToInstanceId=new Map,this.sourceControlChanged=new r.EventEmitter,this.sourceControlResourceChanged=new r.EventEmitter,this.disposables=[],this.changedInstances=new Set,this.resourceCache=new Map,this.isDisposed=!1,this.subscribedToRepoChanges=!1,this.sourceControlId="git",this.gitExtension=r.extensions.getExtension("vscode.git"),this.isActive&&(this.documentUriCacheCleanupTimer=f.setInterval(()=>this.cleanupDocumentUriCache(),3e5))}get gitApi(){try{return this.gitExtension&&this.gitExtension.exports.getAPI(1)}catch(e){}}get isActive(){return!!(this.gitExtension&&this.gitExtension.isActive&&this.gitApi)}async activate(){if(!this.gitExtension)throw new Error("The VS Code Git extension is not enabled.");await this.gitExtension.activate(),this.isDisposed||(this.subscribeToAllRepoChanges(),this.documentUriCacheCleanupTimer||(this.documentUriCacheCleanupTimer=f.setInterval(()=>this.cleanupDocumentUriCache(),3e5)))}async getSourceControls(e,t){if(!this.isActive)return[];const n=this.gitApi.repositories.filter(t=>!e||this.isInstance(t,e)).map(e=>this.getVslsSourceControl(e));return(await Promise.all(n)).filter(e=>e)}async getRecentVersionsTillMergeVersion(e,t,n){const i=this.getRepoByInstanceId(t);if(!i)return[];if(!i.getGlobalConfig||!i.getLog){const e=i.state.HEAD&&this.getVersionFromCommitHash(i.state.HEAD.commit);return e?[e]:[]}const s=await i.getLog({maxEntries:100}),r=s.findIndex(t=>t.hash===e);return r>=0&&r<s.length-1&&s.splice(r+1),s.map((e,t)=>this.getVersionFromCommit(e,t)).filter(e=>e)}getRemoteVersionsNames(e){const t=this.getRepoByInstanceId(e);return t?Promise.resolve(t.state.refs.map(e=>e.name)):Promise.resolve([])}getCurrentVersionName(e){const t=this.getRepoByInstanceId(e);return t?Promise.resolve(t.state.HEAD.name):Promise.resolve("")}async getMergeVersion(e,t,n){const i=this.getRepoByInstanceId(e);if(!i)return null;const s=await i.getBranch(t),r=await i.getMergeBase(i.state.HEAD.name,s.name);return this.getVersionFromCommitHash(r)}async getRecentVersions(e,t){const n=this.getRepoByInstanceId(e);if(!n)return[];if(!n.getGlobalConfig||!n.getLog){const e=n.state.HEAD&&this.getVersionFromCommitHash(n.state.HEAD.commit);return e?[e]:[]}let i="";try{i=await n.getConfig("user.email")}catch(e){}if(!i)try{i=await n.getGlobalConfig("user.email")}catch(e){}const s=await n.getLog({maxEntries:100}),r=s.findIndex(e=>e.authorEmail!==i);return r>=0&&r<s.length-1&&s.splice(r+1),s.map((e,t)=>this.getVersionFromCommit(e,t)).filter(e=>e)}getVersionFromCommit(e,t){return e&&this.getVersionFromCommitHash(e.hash,e.message,t)}getVersionFromCommitHash(e,t,n){if(!e)return;const i=t?t.split("\n")[0]:`HEAD${n?"~"+n:""}`,s={ref:e};return{version:JSON.stringify(s),label:i,description:t}}async getResource(e,t){if(!e||!this.isActive||this.isDisposed)return"";let{path:n,ref:i,submoduleOf:s}=m(e,this.pathManager);if(s){const e=this.getRepoContainingResource(s);return e?"index"===i?await e.diffIndexWithHEAD(n):await e.diffWithHEAD(n):""}const r=this.getRepoByInstanceId(e.instanceId)||this.getRepoContainingResource(n);if(!r)return"";const o=this.getInstanceId(r),a={resource:{type:e.type,path:e.path,version:e.version},timestamp:(new Date).getTime()},l=this.resourceCache.get(o);if(l?l.push(a):this.resourceCache.set(o,[a]),"~"===i){const e=c.Uri.file(n).toString(),[t]=r.state.indexChanges.filter(t=>t&&t.uri.toString()===e);i=t?"":"HEAD"}else/^~\d$/.test(i)&&(i=`:${i[1]}`);try{return await r.show(i,n)}catch(e){return""}}async getDiffForResource(e,t){if(!e||!e.path||!this.isActive||this.isDisposed)return null;const n=e.instanceId,i=e.groupId;if(!n||!i)return null;const s=this.getRepoByInstanceId(n);if(!s)return null;let r=null;switch(e.groupId){case"merge":r=s.state.mergeChanges;break;case"index":r=s.state.indexChanges;break;case"workingTree":r=s.state.workingTreeChanges;break;default:return null}const o=r.find(t=>{if(!t)return!1;const n=y(t.uri,this.pathManager);return n&&n.path===e.path});if(!o)return null;const a=o.uri;let c,l,d;try{c=await new Promise((e,t)=>u.fileAccess.lstat(a.fsPath,(n,i)=>n?t(n):e(i)))}catch(e){}if(this.isDisposed)return null;if(c&&c.isDirectory()){const e=this.getRepositoryForSubmodule(a);if(e){const t="index"===i?"index":"wt",n=e.rootUri.fsPath;d=g(a,this.pathManager,t,n)}}else 12!==o.status&&(l=await this.getLeftResource(o)),d=await this.getRightResource(o);if(!d||this.isDisposed)return null;const h=v(o.status);return{left:l,right:d,title:this.getTitle(o),changeType:h}}async getDiffsForVersion(e,t,n){const i=this.getRepoByInstanceId(e);if(!i||!t)return[];const s=JSON.parse(t);let r;if(i.diffWorkingDirectoryWith)r=await i.diffWorkingDirectoryWith(s.ref);else{if(!i.state.HEAD||i.state.HEAD.commit!==s.ref)return[];r=[];const e=new Map(i.state.indexChanges.map(e=>[e.uri.toString(),e]));for(const t of i.state.workingTreeChanges)e.delete(t.uri.toString()),r.push(t);r.push(...e.values())}const o=r.map(e=>this.getResourceDiffFromChange(e,t)).filter(e=>e);return await this.filterOutExternalHiddenExcludedFiles(o,e=>(e.right||e.left).path)}updateCommitMessages(e){if(this.isActive&&e)for(const t of this.gitApi.repositories){const n=t.inputBox.value,i=e(n);i!==n&&(t.inputBox.value=i)}}getResourceDiffFromChange(e,t){if(!e)return;let n=void 0;if(1!==e.status){if(n=y(e.originalUri,this.pathManager),n.type!==h.vsls.SourceControlResourceType.Workspace)return;n.type=h.vsls.SourceControlResourceType.WorkspaceWithSpecificVersion,n.version=t}const i=y(e.uri,this.pathManager);let s=v(e.status),r=o.basename(e.uri.fsPath);switch(e.status){case 5:r+=" (Modified)";break;case 7:case 1:r+=" (Added)",s=h.vsls.SourceControlChangeType.Add;break;case 3:r+=" (Renamed)";break;case 6:r+=" (Deleted)"}return{right:i,changeType:s,left:n,title:r}}async cleanResources(e,t){if(!this.isActive||this.isDisposed)return;const n=new Map;for(const t of e){if(!t||!t.instanceId)continue;const e=t.instanceId,i=n.get(e);i?i.push(t):n.set(e,[t])}for(const[e,t]of n){const n=this.getRepoByInstanceId(e);if(!n)continue;const i=[];for(const e of t){const t=m(e,this.pathManager);t&&t.path&&i.push(t.path)}if(await n.clean(i),this.isDisposed)return}}isSourceControlled(e){return!!this.getRepoContainingResource(e)}async getRightResource(e){if(e)switch(e.status){case 0:case 1:case 4:case 3:return this.getResourceFromGitParams(e.uri,"");case 2:case 6:return this.getResourceFromGitParams(e.uri,"HEAD");case 11:return this.getResourceFromGitParams(e.uri,"~3");case 12:return this.getResourceFromGitParams(e.uri,"~2");case 5:case 7:case 8:const t=this.getRepoContainingResource(e.uri);if(!t)return;const n=e.uri.toString(),[i]=t.state.indexChanges.filter(e=>e.uri.toString()===n);return i&&i.renameUri?g(i.renameUri,this.pathManager):g(e.uri,this.pathManager);case 13:case 15:return g(e.uri,this.pathManager);default:return}}async getLeftResource(e){if(e)switch(e.status){case 0:case 3:return this.getResourceFromGitParams(e.originalUri,"HEAD");case 5:return this.getResourceFromGitParams(e.uri,"~");case 12:return this.getResourceFromGitParams(e.uri,"");default:return}}getTitle(e){if(!e||!e.uri)return"";const t=o.basename(e.uri.fsPath);switch(e.status){case 0:case 3:return`${t} (Index)`;case 5:case 13:case 15:return`${t} (Working Tree)`;case 11:return`${t} (Theirs)`;case 12:return`${t} (Ours)`;default:return""}}async getResourceFromGitParams(e,t){const n=this.getRepoContainingResource(e);if(!n)return g(e,this.pathManager,t);try{let i=t;if("~"===i){const t=e.toString(),[s]=n.state.indexChanges.filter(e=>e.uri&&e.uri.toString()===t);i=s?"":"HEAD"}const{size:s,object:r}=await n.getObjectDetails(i,e.fsPath),{mimetype:a}=await n.detectObjectType(r);if("text/plain"===a)return g(e,this.pathManager,t);if(s>1e6)return{type:h.vsls.SourceControlResourceType.External,path:`data:;label:${o.basename(e.fsPath)};description:${i},`};if(p.indexOf(a)>-1){const t=await n.buffer(i,e.fsPath);return{type:h.vsls.SourceControlResourceType.External,path:`data:${a};label:${o.basename(e.fsPath)};description:${i};size:${s};base64,${t.toString("base64")}`}}return{type:h.vsls.SourceControlResourceType.External,path:`data:;label:${o.basename(e.fsPath)};description:${i},`}}catch(n){return g(e,this.pathManager,t)}}onSourceControlChanged(e,t,n){return this.subscribeToAllRepoChanges(),this.sourceControlChanged.event(e,t,n)}onResourceChanged(e,t,n){return this.subscribeToAllRepoChanges(),this.sourceControlResourceChanged.event(e,t,n)}dispose(){this.isDisposed=!0,this.disposables.forEach(e=>e.dispose()),this.documentUriCacheCleanupTimer&&(clearInterval(this.documentUriCacheCleanupTimer),this.documentUriCacheCleanupTimer=void 0)}async getVslsSourceControl(e){if(!e)return;const t=e.rootUri?o.basename(e.rootUri.fsPath)||e.rootUri.fsPath:"";return{sourceControlId:this.sourceControlId,instanceId:this.getInstanceId(e),label:"Git",name:t,resourceGroups:await this.getVslsResourceGroups(e)}}async getVslsResourceGroups(e){if(!e)return[];if(!e.clean)return[{groupId:"unsupported",label:"N/A. Ask host to update VSCode to get SCC in collaboration session."}];const t=e.state;return[{groupId:"merge",label:"Merge Changes",hideWhenEmpty:!0,supportsOpenFile:!0,resourceStates:await this.getVslsResourceStates(t.mergeChanges)},{groupId:"index",label:"Staged Changes",hideWhenEmpty:!0,supportsOpenChanges:!0,supportsOpenFile:!0,resourceStates:await this.getVslsResourceStates(t.indexChanges)},{groupId:"workingTree",label:"Changes",supportsClean:!0,supportsOpenChanges:!0,supportsOpenFile:!0,resourceStates:await this.getVslsResourceStates(t.workingTreeChanges)}]}async getVslsResourceStates(e){const t=(e||[]).map(e=>this.getVslsResourceState(e)).filter(e=>e);return await this.filterOutExternalHiddenExcludedFiles(t,e=>e.current.path)}async filterOutExternalHiddenExcludedFiles(e,t){if(!e)return;if(!e.length)return[];const n=await this.fileService.listAsync(e.map(t),{includeExcluded:!0,includeHidden:!0}),i=[];for(let t=0;t<e.length&&t<n.length;t++){const s=n[t].attributes;s!==h.vsls.FileAttributes.External&&s!==h.vsls.FileAttributes.Hidden&&s!==h.vsls.FileAttributes.Excluded&&i.push(e[t])}return i}getVslsResourceState(e){if(!e)return;const t=g(e.uri,this.pathManager);if(!t)return;const n={changeType:v(e.status),current:t};return e.originalUri&&e.uri&&e.uri.toString()!==e.originalUri.toString()&&(n.original=g(e.originalUri,this.pathManager)),n}subscribeToAllRepoChanges(){this.subscribedToRepoChanges||!this.isActive||this.isDisposed||(this.gitApi.onDidOpenRepository(this.onDidOpenRepository,this,this.disposables),this.gitApi.onDidCloseRepository(this.onDidCloseRepository,this,this.disposables),this.gitApi.repositories.forEach(e=>this.subscribeToRepoChanges(e)),this.subscribedToRepoChanges=!0)}subscribeToRepoChanges(e){e.state.onDidChange(()=>this.repoChanged(e),this,this.disposables)}repoChanged(e){this.fireSourceControlChangedEvent(e,h.vsls.SourceControlChange.Updated),this.changedInstances.add(this.getInstanceId(e)),this.eventuallyFireDocumentChangeEvents()}fireSourceControlChangedEvent(e,t){this.sourceControlChanged.fire({sourceControl:{sourceControlId:this.sourceControlId,instanceId:this.getInstanceId(e)},change:t})}eventuallyFireDocumentChangeEvents(){this.fireDocumentChangeEvents()}async fireDocumentChangeEvents(){for(const e of this.changedInstances){const t=this.resourceCache.get(e);t&&t.length&&this.sourceControlResourceChanged.fire({sourceControl:{sourceControlId:this.sourceControlId,instanceId:e},resources:t.map(e=>e.resource)})}this.changedInstances.clear()}onDidOpenRepository(e){this.subscribeToRepoChanges(e),this.fireSourceControlChangedEvent(e,h.vsls.SourceControlChange.Added)}onDidCloseRepository(e){this.fireSourceControlChangedEvent(e,h.vsls.SourceControlChange.Removed)}getRepoByInstanceId(e){if(this.isActive&&!this.isDisposed&&e)return this.gitApi.repositories.find(t=>this.isInstance(t,e))}getInstanceId(e){if(!e||!e.rootUri)return;const t=e.rootUri.toString();let n=this.rootUriToInstanceId.get(t);return n||(this.instanceCount++,n=this.instanceCount.toString(10),this.rootUriToInstanceId.set(t,n)),n}isInstance(e,t){return e&&e.rootUri&&t&&this.rootUriToInstanceId.get(e.rootUri.toString())===t}getRepoContainingResource(e){if(e&&("string"==typeof e&&(e=c.Uri.file(e)),e instanceof c.Uri)){const t=e.fsPath;e:for(const e of this.gitApi.repositories.sort((e,t)=>e.rootUri.fsPath.length-t.rootUri.fsPath.length)){const n=e.rootUri.fsPath;if(S(n,t)){for(const i of e.state.submodules){if(S(o.join(n,i.path),t))continue e}return e}}}}getRepositoryForSubmodule(e){for(const t of this.gitApi.repositories)for(const n of t.state.submodules){if(o.join(t.rootUri.fsPath,n.path)===e.fsPath)return t}}cleanupDocumentUriCache(){const e=(new Date).getTime();for(const[t,n]of this.resourceCache){for(let t=n.length-1;t>=0;t--)e-n[t].timestamp>=18e4&&n.splice(t,1);n.length||this.resourceCache.delete(t)}}}i([l.memoize,s("design:type",Object),s("design:paramtypes",[])],_.prototype,"gitApi",null),i([l.debounce(1100),s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",void 0)],_.prototype,"eventuallyFireDocumentChangeEvents",null),t.HostGitSourceControlProvider=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4),s=n(5),r=n(1314),o=n(542),a=n(189);t.dependencies=function(){const e={sourceControlService:i.lazyLoad(()=>i.dependencies.rpcFactory(s.vsls.SourceControlService,s.vsls.TraceSources.ClientSourceControl)),guestSourceControlManager:i.lazyLoad(()=>r.guestSourceControlManagerFactory(i.dependencies,e)),hostCommentService:i.lazyLoad(()=>new o.HostCommentService(i.dependencies)),commentService:i.lazyLoad(()=>i.sessionStateTracker.State===i.SessionState.Shared||i.sessionStateTracker.State===i.SessionState.SharingInProgress?e.hostCommentService():i.dependencies.rpcFactory(s.vsls.CommentService,s.vsls.TraceSources.ClientCommentService)),commentManager:i.lazyLoad(()=>a.commentManagerFactory(i.dependencies,e))};return e}()},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(18),a=n(0),c=n(4),l=n(5);function u(e){if(!e)return;const{resource:t,sccId:n,groupId:i}=e;if(!t||!t.path)return;const s=t.path;if(t.type===l.vsls.SourceControlResourceType.SpecificVerision||t.type===l.vsls.SourceControlResourceType.WorkspaceWithSpecificVersion){const r={path:s};return t.type===l.vsls.SourceControlResourceType.WorkspaceWithSpecificVersion&&(r.isWorkspace=!0),t.version&&(r.version=t.version),n&&(r.sccId=n),i&&(r.groupId=i),e.resourceUri&&(r.resourceUri=e.resourceUri.toString()),a.Uri.parse("vsls-scc://").with({query:JSON.stringify(r),path:s})}if(c.KNOWN_SCHEMES.find(e=>s.startsWith(e+":")))return a.Uri.parse(s);if(s.startsWith("file:"))return a.Uri.parse(s).with({scheme:c.VSLS_EXTERNAL_SCHEME});let r,o=t.path;switch(t.type){case l.vsls.SourceControlResourceType.Workspace:r=c.VSLS_SCHEME,o?(o=o.replace(/\\/g,"/"),o.startsWith("/")||(o="/"+o)):o="/";break;case l.vsls.SourceControlResourceType.External:r=c.VSLS_EXTERNAL_SCHEME;break;default:return}return a.Uri.parse(`${r}:${o}`)}function d(){return r.workspace.getConfiguration("git").get("decorations.enabled",!0)}function h(e){if(!e||!e.groupId)return;let t="";return e.supportsClean&&(t+="clean_"),e.supportsOpenChanges&&(t+="openChanges_"),e.supportsOpenFile&&(t+="openFile_"),t+e.groupId.replace("~","~~").replace("_","~_")}class f{constructor(e){this.decorationsChanged=new r.EventEmitter,this.disposables=[],this.decorations=new Map,this.groups=new Map,this.onDidChangeDecorations=this.decorationsChanged.event,this.id=++f.registrationCount,f.registrations.set(this.id,this),this.instanceId=e.instanceId,this.sourceControlId=e.sourceControlId;const t=e.name?a.Uri.file(`/${e.name}`):void 0;this.scc=r.scm.createSourceControl("vsls-scc",e.label,t),this.scc.inputBox.visible=!1,this.scc.quickDiffProvider=this,e.resourceGroups&&e.resourceGroups.forEach(e=>this.createResourceGroup(e)),this.updateDecorations(!1),r.window.registerDecorationProvider&&this.disposables.push(r.window.registerDecorationProvider(this))}provideDecoration(e,t){return this.decorations.get(e.toString())}provideOriginalResource(e){const t=f.getResourceIdentity(e);if(t&&t.type===l.vsls.SourceControlResourceType.Workspace)return t.type=l.vsls.SourceControlResourceType.WorkspaceWithSpecificVersion,this.getUri({resource:t})}dispose(){this.disposables.forEach(e=>e.dispose()),this.disposables=[],this.scc.dispose(),f.registrations.delete(this.id)}update(e){const t=!d(),n=e.resourceGroups||[];this.groups.forEach(e=>!n.find(t=>h(t)===e.id)&&this.groups.delete(e.id)&&e.dispose()),n.forEach(e=>{const n=this.groups.get(h(e));n?n.resourceStates=e.resourceStates.map(n=>new p(this,e.groupId,n,t,e.supportsClean,e.supportsOpenChanges)):this.createResourceGroup(e)}),this.updateDecorations(!0)}getUri(e){return u(Object.assign({sccId:this.id},e))}static getResourceIdentity(e){if(e)switch(e.scheme){case c.VSLS_SCHEME:return{path:e.path,type:l.vsls.SourceControlResourceType.Workspace};case c.VSLS_EXTERNAL_SCHEME:return{path:e.path,type:l.vsls.SourceControlResourceType.External};case"vsls-scc":const t=JSON.parse(e.query);if(!t||!t.path)return;const n=t.isWorkspace?l.vsls.SourceControlResourceType.WorkspaceWithSpecificVersion:l.vsls.SourceControlResourceType.SpecificVerision,i={path:t.path,type:n};t.version&&(i.version=t.version);const s=f.registrations.get(t.sccId);return s&&(i.sourceControlId=s.sourceControlId,i.instanceId=s.instanceId),t.groupId&&(i.groupId=t.groupId),i}}getSccResources(e){if(!(e=e||r.window.activeTextEditor&&r.window.activeTextEditor.document.uri))return[];let t;if("vsls-scc"===e.scheme){const n=JSON.parse(e.query);if(!n||!n.resourceUri)return[];t=n.resourceUri}else t=e.toString();const n=[];for(const[,e]of this.groups)for(const i of e.resourceStates)i.resourceUri.toString()===t&&n.push(i);return n}updateDecorations(e){if(!r.window.registerDecorationProvider)return;const t=new Map;this.groups.forEach(e=>e.resourceStates.forEach(e=>{const n=e,i=n.resourceDecoration;i&&n.original&&t.set(n.original.toString(),i)}));const n=new Set([...this.decorations.keys()].concat([...t.keys()]));this.decorations=t,e&&this.decorationsChanged.fire([...n.values()].map(e=>a.Uri.parse(e)))}createResourceGroup(e){if(!e)return;const t=this.scc.createResourceGroup(h(e),e.label);e.hideWhenEmpty&&(t.hideWhenEmpty=!0);const n=!d();t.resourceStates=e.resourceStates.map(t=>new p(this,e.groupId,t,n,e.supportsClean,e.supportsOpenChanges)).filter(e=>e.resourceUri),this.groups.set(t.id,t)}}f.registrationCount=0,f.registrations=new Map;class p{constructor(e,t,n,i,s,r){this.sccRegistration=e,this.groupId=t,this.useIcons=i,this.supportsClean=s,this.supportsOpenChanges=r,this.command={command:"liveshare.scc.openChange",title:"Open",arguments:[this]},this.current=n.current,this.changeType=n.changeType,this.resourceUri=e.getUri({resource:n.current,groupId:t}),this.original=e.getUri({resource:n.original,groupId:t})||this.resourceUri}get instanceId(){return this.sccRegistration.instanceId}get sourceControlId(){return this.sccRegistration.sourceControlId}get ResourceIdentity(){return{sourceControlId:this.sourceControlId,instanceId:this.instanceId,groupId:this.groupId,path:this.current.path,version:this.current.version,type:this.current.type}}get decorations(){const e=this.tooltip,t=this.strikeThrough,n=this.letter,i=this.color;return{strikeThrough:t,faded:!1,tooltip:e,light:this.useIcons?{iconPath:this.getIconPath("light")}:void 0,dark:this.useIcons?{iconPath:this.getIconPath("dark")}:void 0,letter:n,color:i,source:"vsls-scc.resource"}}get resourceDecoration(){if(!this.changeType||this.changeType===l.vsls.SourceControlChangeType.Delete||this.changeType===l.vsls.SourceControlChangeType.IndexDelete)return;return{bubble:!0,source:"git.resource",title:this.tooltip,letter:this.letter,color:this.color,priority:this.priority}}getUri(e){return this.sccRegistration.getUri(Object.assign({groupId:this.groupId,resourceUri:this.resourceUri},e))}getIconPath(e){switch(this.changeType){case l.vsls.SourceControlChangeType.IndexEdit:case l.vsls.SourceControlChangeType.Edit:return c.ExtensionUtil.getExtensionUri(`images/${e}/status-modified.svg`);case l.vsls.SourceControlChangeType.Add:return c.ExtensionUtil.getExtensionUri(`images/${e}/status-added.svg`);case l.vsls.SourceControlChangeType.IndexDelete:case l.vsls.SourceControlChangeType.Delete:return c.ExtensionUtil.getExtensionUri(`images/${e}/status-deleted.svg`);case l.vsls.SourceControlChangeType.Rename:return c.ExtensionUtil.getExtensionUri(`images/${e}/status-renamed.svg`);case l.vsls.SourceControlChangeType.IndexCopy:return c.ExtensionUtil.getExtensionUri(`images/${e}/status-copied.svg`);case l.vsls.SourceControlChangeType.Untracked:return c.ExtensionUtil.getExtensionUri(`images/${e}/status-untracked.svg`);case l.vsls.SourceControlChangeType.Ignored:return c.ExtensionUtil.getExtensionUri(`images/${e}/status-ignored.svg`);case l.vsls.SourceControlChangeType.DeleteBoth:case l.vsls.SourceControlChangeType.AddByUs:case l.vsls.SourceControlChangeType.DeleteByThem:case l.vsls.SourceControlChangeType.AddByThem:case l.vsls.SourceControlChangeType.DeleteByUs:case l.vsls.SourceControlChangeType.AddBoth:case l.vsls.SourceControlChangeType.Conflict:return c.ExtensionUtil.getExtensionUri(`images/${e}/status-conflict.svg`)}}get priority(){switch(this.changeType){case l.vsls.SourceControlChangeType.IndexEdit:case l.vsls.SourceControlChangeType.Edit:return 2;case l.vsls.SourceControlChangeType.Ignored:return 3;case l.vsls.SourceControlChangeType.IndexCopy:case l.vsls.SourceControlChangeType.DeleteBoth:case l.vsls.SourceControlChangeType.AddByUs:case l.vsls.SourceControlChangeType.DeleteByThem:case l.vsls.SourceControlChangeType.AddByThem:case l.vsls.SourceControlChangeType.DeleteByUs:case l.vsls.SourceControlChangeType.AddBoth:case l.vsls.SourceControlChangeType.Conflict:return 4;default:return 1}}get tooltip(){switch(this.changeType){case l.vsls.SourceControlChangeType.IndexEdit:return"Index Modified";case l.vsls.SourceControlChangeType.Edit:return"Modified";case l.vsls.SourceControlChangeType.Add:return"Index Added";case l.vsls.SourceControlChangeType.IndexDelete:return"Index Deleted";case l.vsls.SourceControlChangeType.Delete:return"Deleted";case l.vsls.SourceControlChangeType.Rename:return"Index Renamed";case l.vsls.SourceControlChangeType.IndexCopy:return"Index Copied";case l.vsls.SourceControlChangeType.Untracked:return"Untracked";case l.vsls.SourceControlChangeType.Ignored:return"Ignored";case l.vsls.SourceControlChangeType.DeleteBoth:return"Both Deleted";case l.vsls.SourceControlChangeType.AddByUs:return"Added By Us";case l.vsls.SourceControlChangeType.DeleteByThem:return"Deleted By Them";case l.vsls.SourceControlChangeType.AddByThem:return"Added By Them";case l.vsls.SourceControlChangeType.DeleteByUs:return"Deleted By Us";case l.vsls.SourceControlChangeType.AddBoth:return"Both Added";case l.vsls.SourceControlChangeType.Conflict:return"Both Modified";default:return""}}get letter(){switch(this.changeType){case l.vsls.SourceControlChangeType.IndexEdit:case l.vsls.SourceControlChangeType.Edit:return"M";case l.vsls.SourceControlChangeType.Add:return"A";case l.vsls.SourceControlChangeType.IndexDelete:case l.vsls.SourceControlChangeType.Delete:return"D";case l.vsls.SourceControlChangeType.Rename:return"R";case l.vsls.SourceControlChangeType.Untracked:return"U";case l.vsls.SourceControlChangeType.Ignored:return"I";case l.vsls.SourceControlChangeType.DeleteByThem:case l.vsls.SourceControlChangeType.DeleteByUs:return"D";case l.vsls.SourceControlChangeType.IndexCopy:case l.vsls.SourceControlChangeType.DeleteBoth:case l.vsls.SourceControlChangeType.AddByUs:case l.vsls.SourceControlChangeType.AddByThem:case l.vsls.SourceControlChangeType.AddBoth:case l.vsls.SourceControlChangeType.Conflict:return"C";default:return}}get color(){switch(this.changeType){case l.vsls.SourceControlChangeType.IndexEdit:case l.vsls.SourceControlChangeType.Edit:return new r.ThemeColor("gitDecoration.modifiedResourceForeground");case l.vsls.SourceControlChangeType.IndexDelete:case l.vsls.SourceControlChangeType.Delete:return new r.ThemeColor("gitDecoration.deletedResourceForeground");case l.vsls.SourceControlChangeType.Add:return new r.ThemeColor("gitDecoration.addedResourceForeground");case l.vsls.SourceControlChangeType.Rename:case l.vsls.SourceControlChangeType.Untracked:return new r.ThemeColor("gitDecoration.untrackedResourceForeground");case l.vsls.SourceControlChangeType.Ignored:return new r.ThemeColor("gitDecoration.ignoredResourceForeground");case l.vsls.SourceControlChangeType.IndexCopy:case l.vsls.SourceControlChangeType.DeleteBoth:case l.vsls.SourceControlChangeType.AddByUs:case l.vsls.SourceControlChangeType.DeleteByThem:case l.vsls.SourceControlChangeType.AddByThem:case l.vsls.SourceControlChangeType.DeleteByUs:case l.vsls.SourceControlChangeType.AddBoth:case l.vsls.SourceControlChangeType.Conflict:return new r.ThemeColor("gitDecoration.conflictingResourceForeground");default:return}}get strikeThrough(){switch(this.changeType){case l.vsls.SourceControlChangeType.Delete:case l.vsls.SourceControlChangeType.DeleteBoth:case l.vsls.SourceControlChangeType.DeleteByThem:case l.vsls.SourceControlChangeType.DeleteByUs:case l.vsls.SourceControlChangeType.IndexDelete:return!0;default:return!1}}}t.guestSourceControlManagerFactory=(e,t)=>{const{controllerDecorator:n,errorNotificationMethodDecorator:d,telemetryMethodDecorator:h}=e.methodDecorators();let m=class{constructor(e){this.service=e,this.sccRegistrations=[],this.disposables=[],this.isActive=!1}async init(){this.isActive||(this.isActive=!0,this.disposables.push(r.workspace.registerTextDocumentContentProvider("vsls-scc",this)),c.ControllerHelper.register(this,this.disposables),await this.addSourceControls(),this.isActive&&this.service.onSourceControlChanged(this.sourceControlChanged,this,this.disposables))}async dispose(){this.isActive&&(this.isActive=!1,this.disposeSourceControls(),this.disposables.forEach(e=>e.dispose()),this.disposables=[])}async provideTextDocumentContent(e,t){const n=f.getResourceIdentity(e);return n?await this.service.getResourceAsync(n,t):""}sourceControlChanged(e){if(!e||!this.isActive)return;const t=e.sourceControl;if(!t)return;const n=t.sourceControlId,i=t.instanceId;if(i)switch(e.change){case l.vsls.SourceControlChange.Added:this.addSourceControls(n,i);break;case l.vsls.SourceControlChange.Removed:this.disposeSourceControls(n,i);break;case l.vsls.SourceControlChange.Updated:this.updateSourceControl(n,i)}else this.disposeSourceControls(n),e.change!==l.vsls.SourceControlChange.Removed&&this.addSourceControls(n)}disposeSourceControls(e,t){if(e){for(let n=this.sccRegistrations.length-1;n>=0;n++)if(this.sccRegistrations[n].sourceControlId===e&&(!t||this.sccRegistrations[n].instanceId===t)){const[e]=this.sccRegistrations.splice(n,1);e.dispose()}}else this.sccRegistrations.forEach(e=>e.dispose()),this.sccRegistrations=[];this.updateSourceControlCountContext(this.sccRegistrations.length)}async addSourceControls(e,t){try{const n=e?t?[await this.service.getSourceControlAsync({sourceControlId:e,instanceId:t})]:await this.service.getSourceControlsAsync(e):await this.service.getAllSourceControlsAsync();if(!this.isActive)return;n.forEach(e=>this.sccRegistrations.push(new f(e))),this.updateSourceControlCountContext(this.sccRegistrations.length)}catch(e){}}async updateSourceControl(e,t){const n=this.sccRegistrations.find(n=>n.sourceControlId===e&&n.instanceId===t);if(n)try{const i=await this.service.getSourceControlAsync({sourceControlId:e,instanceId:t});if(!this.isActive)return;i?n.update(i):this.disposeSourceControls(e,t)}catch(n){this.isActive||this.disposeSourceControls(e,t)}else await this.addSourceControls(e,t)}async openFile(e,...t){const n=e instanceof p;let i;if(e)if(e instanceof a.Uri)switch(e.scheme){case c.VSLS_SCHEME:case c.VSLS_EXTERNAL_SCHEME:i=[e];break;case"vsls-scc":const t=JSON.parse(e.query);t.resourceUri&&(i=[a.Uri.parse(t.resourceUri)])}else{const n=e;if(!(n instanceof p))return;n&&(i=[n,...t].filter(e=>e.changeType!==l.vsls.SourceControlChangeType.Delete&&e.changeType!==l.vsls.SourceControlChangeType.IndexDelete).map(e=>e.resourceUri))}else i=this.getSccResources().map(e=>e.resourceUri);if(!i||!i.length)return;const s=r.window.activeTextEditor;for(const e of i){const t={preserveFocus:n,preview:!1,viewColumn:r.ViewColumn.Active},i=await r.workspace.openTextDocument(e);if(s&&s.document.uri.toString()===e.toString()){t.selection=s.selection;const e=s.visibleRanges;(await r.window.showTextDocument(i,t)).revealRange(e[0])}else await r.window.showTextDocument(i,t)}}async openChanges(e,...t){const n=e instanceof p,i=e instanceof a.Uri||!e;let s=[];e?e instanceof a.Uri?s=this.getSccResources(e):e instanceof p&&(s=[...t,e]):s=this.getSccResources(),s=s.filter(e=>e.supportsOpenChanges);const r=1===s.length&&void 0;for(const e of s)await this.openChange(e,r,n,i)}async openChange(e,t,n,i){if(!e)return;const s=await this.service.getDiffForResourceAsync(e.ResourceIdentity);if(!s)return;const o=e.getUri({resource:s.right}),a=e.getUri({resource:s.left}),c={preserveFocus:n,preview:t,viewColumn:r.ViewColumn.Active},l=r.window.activeTextEditor,u=o||a;i&&l&&l.document.uri.toString()===u.toString()&&(c.selection=l.selection),a&&o?await r.commands.executeCommand("vscode.diff",a,o,s.title,c):await r.commands.executeCommand("vscode.open",u,c,s.title)}updateSourceControlCountContext(e){r.commands.executeCommand("setContext","vslsSccOpenRepositoryCount",`${e}`)}async clean(...e){if(!(e=e.filter(e=>!!e&&e.supportsClean)).length||!this.isActive)return;const t=e.reduce((e,t)=>e+(t.changeType===l.vsls.SourceControlChangeType.Untracked?1:0),0);let n,i="Discard Changes";1===e.length?t>0?(n=`Are you sure you want to DELETE ${o.basename(e[0].resourceUri.fsPath)}?`,i="Delete file"):e[0].changeType===l.vsls.SourceControlChangeType.Delete?(i="Restore file",n=`Are you sure you want to restore ${o.basename(e[0].resourceUri.fsPath)}?`):n=`Are you sure you want to discard changes in ${o.basename(e[0].resourceUri.fsPath)}?`:(e.every(e=>e.changeType===l.vsls.SourceControlChangeType.Delete)?(i="Restore files",n=`Are you sure you want to restore ${e.length} files?`):n=`Are you sure you want to discard changes in ${e.length} files?`,t>0&&(n=`${n}\n\nThis will DELETE ${t} untracked files!`)),await r.window.showWarningMessage(n,{modal:!0},i)===i&&await this.service.cleanResourcesAsync(e.map(e=>e.ResourceIdentity))}async cleanAll(e){e&&e.resourceStates&&await this.clean(...e.resourceStates)}getSccResources(e){return[].concat(...this.sccRegistrations.map(t=>t.getSccResources(e)))}async revertChange(e,t,n){if(!e)return;const i=r.window.visibleTextEditors.find(t=>t.document.uri.toString()===e.toString());if(!i)return;const s=t[n],o=0===s.originalEndLineNumber,a=0===s.modifiedEndLineNumber;let c=void 0;if(!o){const t=f.getResourceIdentity(e);if(!t||t.type!==l.vsls.SourceControlResourceType.Workspace)return;t.type=l.vsls.SourceControlResourceType.WorkspaceWithSpecificVersion;const n={resource:t},i=1===this.sccRegistrations.length?this.sccRegistrations[0].getUri(n):u(n);if(!i)return;c=(await r.workspace.openTextDocument(i)).getText(new r.Range(s.originalStartLineNumber-1,0,s.originalEndLineNumber,0))}const d=i.selections,h=i.visibleRanges,p=!a&&new r.Range(s.modifiedStartLineNumber-1,0,s.modifiedEndLineNumber,0),m=new r.WorkspaceEdit;o?m.delete(e,p):a?m.insert(e,new r.Position(s.modifiedStartLineNumber,0),c):m.replace(e,p,c),r.workspace.applyEdit(m),await i.document.save(),i.selections=d,i.revealRange(h[0])}};return i([d("Opening source-controlled resource",c.TelemetryEventNames.OPEN_SCC_RESOURCE_FAULT),h(c.TelemetryEventNames.OPEN_SCC_RESOURCE,c.TelemetryEventNames.OPEN_SCC_RESOURCE_FAULT,"GuestSourceControlManager.openFile"),c.commandBindingDecorator("liveshare.scc.openFile"),c.commandBindingDecorator("liveshare.scc.openFile2"),s("design:type",Function),s("design:paramtypes",[Object,p]),s("design:returntype",Promise)],m.prototype,"openFile",null),i([d("Opening source-controlled changes",c.TelemetryEventNames.OPEN_SCC_CHANGE_FAULT),h(c.TelemetryEventNames.OPEN_SCC_CHANGE,c.TelemetryEventNames.OPEN_SCC_CHANGE_FAULT,"GuestSourceControlManager.openChanges"),c.commandBindingDecorator("liveshare.scc.openChange"),s("design:type",Function),s("design:paramtypes",[Object,p]),s("design:returntype",Promise)],m.prototype,"openChanges",null),i([d("Discarding source-controlled changes",c.TelemetryEventNames.DISCARD_SCC_CHANGE_FAULT),h(c.TelemetryEventNames.DISCARD_SCC_CHANGE,c.TelemetryEventNames.DISCARD_SCC_CHANGE_FAULT,"GuestSourceControlManager.clean"),c.commandBindingDecorator("liveshare.scc.clean"),s("design:type",Function),s("design:paramtypes",[p]),s("design:returntype",Promise)],m.prototype,"clean",null),i([d("Discarding all source-controlled changes",c.TelemetryEventNames.DISCARD_ALL_SCC_CHANGES_FAULT),h(c.TelemetryEventNames.DISCARD_ALL_SCC_CHANGES,c.TelemetryEventNames.DISCARD_ALL_SCC_CHANGES_FAULT,"GuestSourceControlManager.cleanAll"),c.commandBindingDecorator("liveshare.scc.cleanAll"),s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Promise)],m.prototype,"cleanAll",null),i([d("Revert change",c.TelemetryEventNames.REVERT_SCC_CHANGE_FAULT),h(c.TelemetryEventNames.REVERT_SCC_CHANGE,c.TelemetryEventNames.REVERT_SCC_CHANGE_FAULT,"GuestSourceControlManager.revertChange"),c.commandBindingDecorator("liveshare.scc.revertChange"),s("design:type",Function),s("design:paramtypes",[a.Uri,Array,Number]),s("design:returntype",Promise)],m.prototype,"revertChange",null),m=i([n,s("design:paramtypes",[Object])],m),new m(t.sourceControlService())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1316);t.WorkspaceTaskClient=i.default;var s=n(547);t.registerTaskProvider=s.register;var r=n(1318);t.WorkspaceTaskTelemetry=r.WorkspaceTaskTelemetry},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(547),r=n(7),o=n(4),a=n(5),c=n(1317);class l extends(r.Inittable(r.Disposable(Object))){constructor(e,t,n){super(),this.streamFactory=n,this.subscriptions=[],this.deferredInit=Promise.resolve(),this.taskCache={},this.hostTaskExecutions=[],this.pendingTaskMonitors=[],this.taskOutputCache={},this.accessControlManager=t,this.workspaceTaskService=e.rpcFactory(a.vsls.WorkspaceTaskService,a.vsls.TraceSources.ClientRpc),this.taskOutputService=e.rpcFactory(a.vsls.TaskOutputService,a.vsls.TraceSources.ClientRpc),this.trace=r.traceSource.withName("WorkspaceTaskClient"),this.sessionContext=e.sessionContext()}async init(){await super.init(),this.subscriptions.push(i.tasks.onDidStartTask(async e=>this.handleWorkspaceTaskStarted(e.execution)),i.tasks.onDidEndTask(e=>this.handleWorkspaceTaskEnded(e.execution)),i.tasks.onDidEndTaskProcess(e=>this.handleWorkspaceTaskProcessEnded(e.execution,e.exitCode)),this.workspaceTaskService.onTaskStarted(e=>this.handleHostTaskStarted(e.task,e.taskExecution)),this.workspaceTaskService.onTaskTerminated(e=>this.handleHostTaskTerminated(e.taskExecution)),this.accessControlManager.onDidRejectOperation(async e=>{if(e.operation.name===o.WellKnownRestrictedOperations.RunTask){const t=e.operation;if(e.isReadOnlySession)return;e.isCurrentUserAnonymous?await this.requestTaskRunPermissionAnonymous(t):await this.requestTaskRunPermission(t)}}),this.accessControlManager.onDidChangeOperationAccess(async e=>{if(e.operation.name===o.WellKnownRestrictedOperations.RunTask){const t=e.operation;await this.handleTaskRunPermissionChange(t,e.access)}})),this.deferredInit=this.deferredInit.then(()=>this.initializeContext()).catch(()=>{})}async initializeContext(){this.taskManagerContext=s.configure(()=>this.workspaceTaskService.getSupportedTasksAsync().catch(e=>[]),()=>this.pendingTaskMonitors),this.taskOutputService.onTaskOutputShared(e=>this.createTaskOutput(e.taskOutput));const e=await this.taskOutputService.getTaskOutputsAsync();for(const t of e)await this.createTaskOutput(t);const[t,n]=await Promise.all([this.workspaceTaskService.getSupportedTasksAsync(),this.workspaceTaskService.getTaskExecutionsAsync()]);this.hostTaskExecutions.push(...n);for(const e of t){this.taskCache[e.uniqueId]={taskOnHost:e};const t=n.filter(t=>t.taskUid===e.uniqueId)[0];t&&await this.startMonitorTask(e,t)}}async dispose(){await this.deferredInit,this.subscriptions.forEach(e=>e.dispose()),this.taskManagerContext&&this.taskManagerContext.dispose(),Object.keys(this.taskOutputCache).map(e=>this.taskOutputCache[e]).forEach(e=>e.dispose()),await super.dispose()}async requestTaskRunPermission(e){"Request permission"===(await r.NotificationUtil.showErrorMessage("The host doesn't allow guests to run tasks.",{modal:!1},{title:"Request permission"})).title&&(this.isAwaitingTaskRunPermission=!0,await this.accessControlManager.requestOperationAccess({name:o.WellKnownRestrictedOperations.RunTask,sessionId:this.sessionContext.coeditingClient.clientID}))}async requestTaskRunPermissionAnonymous(e){this.isUserAskedToSignIn||(this.isUserAskedToSignIn=!0,await o.askToSignInAndReload("Cannot run tasks in read-only mode (anonymous). Sign in to proceed."),this.isUserAskedToSignIn=!1)}async handleTaskRunPermissionChange(e,t){if(this.isAwaitingTaskRunPermission&&t===a.vsls.RestrictedOperationAccess.Allowed){const e="Run task";(await r.NotificationUtil.showInformationMessage("The host has allowed guests to run tasks.",!1,{modal:!1},{title:e})).title===e&&await i.commands.executeCommand("workbench.action.tasks.runTask")}}async createTaskOutput(e){switch(e.options.contentType){case a.vsls.TaskOutputContentType.TextWithAnsiEscapeCodes:await this.createTaskTerminal(e);break;case a.vsls.TaskOutputContentType.PlainText:await this.createOutputChannel(e)}}async handleWorkspaceTaskStarted(e){const t=l.getTaskDefinition(e.task),n=t?this.taskCache[t.taskUid]:void 0;n&&(this.trace.verbose(`local task started taskUid:${t.taskUid} executionId:${t.executionId}`),t.executionId?(n.monitorTaskExecution=e,n.hostTaskExecution={taskUid:t.taskUid,id:t.executionId}):(n.monitorTaskExecution=e,n.hostTaskExecution=void 0,this.trace.verbose(`Running remote uniqueId:${n.taskOnHost.uniqueId}`),await this.workspaceTaskService.runTaskAsync(n.taskOnHost.uniqueId)))}handleWorkspaceTaskEnded(e){const t=l.getTaskDefinition(e.task),n=t?this.taskCache[t.taskUid]:void 0;if(n&&(this.trace.verbose(`local task ended taskUid:${t.taskUid} executionId:${t.executionId}`),n.monitorTaskExecution===e)){n.monitorTaskExecution=void 0,n.hostTaskExecution=void 0;const e=this.hostTaskExecutions.filter(e=>e.taskUid===t.taskUid)[0];e&&e.id!==t.executionId&&Promise.resolve().then(()=>this.startMonitorTask(n.taskOnHost,e))}}async handleWorkspaceTaskProcessEnded(e,t){const n=l.getTaskDefinition(e.task),i=n?this.taskCache[n.taskUid]:void 0;i&&(this.trace.verbose(`local task process ended taskUid:${n.taskUid} exitCode:${t}`),i.monitorTaskExecution===e&&i.hostTaskExecution&&(!this.hostTaskExecutions.some(e=>e.id===i.hostTaskExecution.id)||n.executionId&&0!==t||await this.workspaceTaskService.terminateTaskAsync(i.hostTaskExecution)))}async handleHostTaskStarted(e,t){this.trace.verbose(`host task started uniqueId:${e.uniqueId} taskExecution:${JSON.stringify(t)}`),this.hostTaskExecutions.push(t);let n=this.getWorkspaceTaskInfo(e);n.monitorTaskExecution?n.hostTaskExecution||(n.hostTaskExecution=t):n.monitorTaskExecution=await this.startMonitorTask(e,t)}async handleHostTaskTerminated(e){this.trace.verbose(`host task terminated execution:${JSON.stringify(e)}`);const t=this.hostTaskExecutions.findIndex(t=>t.id===e.id);-1!==t&&this.hostTaskExecutions.splice(t,1);const n=this.taskCache[e.taskUid];n&&n.monitorTaskExecution&&n.monitorTaskExecution.terminate()}async startMonitorTask(e,t){this.pendingTaskMonitors.push([e,t]);try{const t=await i.tasks.fetchTasks({type:s.liveShareTaskType});for(const n of t.filter(t=>l.getTaskUid(t)===e.uniqueId))return await i.tasks.executeTask(n)}finally{this.pendingTaskMonitors.pop()}}async createTaskTerminal(e){if(this.taskOutputCache[e.id])return void this.taskOutputCache[e.id].terminal.show();this.trace.verbose(`creating task terminal info:${JSON.stringify(e)}`);const t=await this.streamFactory(e.feed.streamMoniker),n=new c.StreamChannelTerminal(t,!0),s={name:e.name,pty:n},r=i.window.createTerminal(s);r.show();const o=[this.taskOutputService.onTaskOutputClosed(t=>{t.taskOutput.id===e.id&&(a(),r.dispose())}),i.window.onDidCloseTerminal(e=>{e===r&&a()})],a=()=>{this.trace.verbose(`dispose task terminal info:${JSON.stringify(e)}`),t.dispose(),delete this.taskOutputCache[e.id],o.forEach(e=>e.dispose())};this.taskOutputCache[e.id]={taskOutput:e,terminal:r,dispose:()=>{a(),r.dispose()}}}async createOutputChannel(e){if(this.taskOutputCache[e.id])return void this.taskOutputCache[e.id].outputChannel.show();this.trace.verbose(`create output channel info:${JSON.stringify(e)}`);const t=`${e.name} [Shared]`,n=i.window.createOutputChannel(t);n.show(!0);const s=await this.streamFactory(e.feed.streamMoniker);s.onDataReceived(e=>{const t=e.toString();n.append(t)});const r=this.taskOutputService.onTaskOutputClosed(t=>{t.taskOutput.id===e.id&&(o(),n.dispose())}),o=()=>{this.trace.verbose(`dispose output channel info:${JSON.stringify(e)}`),delete this.taskOutputCache[e.id],s.dispose(),r.dispose()};this.taskOutputCache[e.id]={taskOutput:e,outputChannel:n,dispose:async()=>{await o(),n.dispose()}}}getWorkspaceTaskInfo(e){const t=e.uniqueId;let n=this.taskCache[t];return n||(this.taskCache[t]={taskOnHost:e},n=this.taskCache[t]),n}static getTaskDefinition(e){if(e.definition.type===s.liveShareTaskType)return e.definition}static getTaskUid(e){if(e.definition.type===s.liveShareTaskType){return e.definition.taskUid}}}t.default=l},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);t.StreamChannelTerminal=class{constructor(e,t){this.onDidWriteEmitter=new i.EventEmitter,this.initBuffers=[],this.onDidWrite=this.onDidWriteEmitter.event,e&&this.attach(e,t)}attach(e,t){this.streamChannel=e,this.isReadonly=t,this.disposable=e.onDataReceived(e=>this.fireDidWrite(e))}open(e){this.isOpened=!0,this.initBuffers.forEach(e=>this.fireDidWrite(e)),this.initBuffers.length=0}close(){this.disposable&&this.disposable.dispose()}handleInput(t){this.isReadonly||this.streamChannel.send(e.from(t))}fireDidWrite(e){if(this.isOpened){const t=e.toString();this.onDidWriteEmitter.fire(t)}else this.initBuffers.push(e)}}}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(9),s=n(4);class r{static sendExecutionSummary(e,t){let n=new i.TelemetryEvent(o.EXECUTE_SHARED_TASK);n.addProperty(a.TASK_KIND,e),n.addMeasure(a.TOTAL_COUNT,t.length),n.addMeasure(a.MAX_TIME,Math.max(...t)),n.addMeasure(a.MIN_TIME,Math.min(...t)),n.addMeasure(a.AVERAGE_TIME,t.reduce((e,t)=>e+t,0)/t.length),n.send()}}t.WorkspaceTaskTelemetry=r,r.FEATURE_PREFIX="WorkspaceTask/",r.PROPERTY_PREFIX=s.TelemetryPropertyNames.FEATURE_NAME+"WorkspaceTask.";class o{}o.EXECUTE_SHARED_TASK="execute-task",o.TASK_EXECUTION_ERROR=s.TelemetryEventNames.FAULT_PREFIX+"execute-task-error";class a{}a.TASK_KIND=s.TelemetryPropertyNames.FEATURE_NAME+"TaskKind",a.TOTAL_COUNT=s.TelemetryPropertyNames.FEATURE_NAME+"TotalCount",a.MAX_TIME=s.TelemetryPropertyNames.FEATURE_NAME+"MaxTime",a.MIN_TIME=s.TelemetryPropertyNames.FEATURE_NAME+"MinTime",a.AVERAGE_TIME=s.TelemetryPropertyNames.FEATURE_NAME+"AverageTime"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(549),s=n(4);t.lspClientActivator=function(e,t,n){let r=!1;s.SessionContext.onCollaboratorsJoined(async()=>{!r&&[s.SessionState.JoiningInProgress,s.SessionState.Joined].indexOf(s.sessionStateTracker.State)>=0&&(await i.activateAsync(s.ExtensionUtil.context,t,[...e.registeredServices],n),r=!0)})}},function(e,t){
/*!
Copyright (C) 2013-2017 by Andrea Giammarchi - @WebReflection

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/
var n="\\x"+("0"+"~".charCodeAt(0).toString(16)).slice(-2),i="\\"+n,s=new RegExp(n,"g"),r=new RegExp(i,"g"),o=new RegExp("(?:^|([^\\\\]))"+i),a=[].indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},c=String;function l(e,t,n){return t instanceof Array?function(e,t,n){for(var i=0,s=t.length;i<s;i++)t[i]=l(e,t[i],n);return t}(e,t,n):t instanceof c?t.length?n.hasOwnProperty(t)?n[t]:n[t]=function(e,t){for(var n=0,i=t.length;n<i;e=e[t[n++].replace(r,"~")]);return e}(e,t.split("~")):e:t instanceof Object?function(e,t,n){for(var i in t)t.hasOwnProperty(i)&&(t[i]=l(e,t[i],n));return t}(e,t,n):t}var u={stringify:function(e,t,r,o){return u.parser.stringify(e,function(e,t,r){var o,c,l=!1,u=!!t,d=[],h=[e],f=[e],p=[r?"~":"[Circular]"],m=e,g=1;return u&&(c="object"==typeof t?function(e,n){return""!==e&&t.indexOf(e)<0?void 0:n}:t),function(e,t){return u&&(t=c.call(this,e,t)),l?(m!==this&&(o=g-a.call(h,this)-1,g-=o,h.splice(g,h.length),d.splice(g-1,d.length),m=this),"object"==typeof t&&t?(a.call(h,t)<0&&h.push(m=t),g=h.length,(o=a.call(f,t))<0?(o=f.push(t)-1,r?(d.push((""+e).replace(s,n)),p[o]="~"+d.join("~")):p[o]=p[0]):t=p[o]):"string"==typeof t&&r&&(t=t.replace(n,i).replace("~",n))):l=!0,t}}(e,t,!o),r)},parse:function(e,t){return u.parser.parse(e,function(e){return function(t,s){var r="string"==typeof s;return r&&"~"===s.charAt(0)?new c(s.slice(1)):(""===t&&(s=l(s,s,{})),r&&(s=s.replace(o,"$1~").replace(i,n)),e?e.call(this,t,s):s)}}(t))},parser:JSON};e.exports=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);t.asLocation=function(e,t){if(e)return new i.Location(t.asUri(e.uri),t.asRange(e.range))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(20),r=n(5),o=n(7);t.ExternalDocumentProvider=class{constructor(e,t){this.rpcClient=e,this.prefixServiceName=t,this.documents=new Map,this.documentClosedSubscription=i.workspace.onDidCloseTextDocument(this.onTextDocumentClosed,this)}async provideTextDocumentContent(e,t){let n=e.toString();if(this.documents.has(n))return this.documents.get(n);const i=e.fragment?e.fragment:"any",a={name:this.prefixServiceName+i,methods:r.vsls.LanguageServerProvider.methods,events:r.vsls.LanguageServerProvider.events},c=s.RpcProxy.create(a,this.rpcClient,o.traceSource.withName(r.vsls.TraceSources.ClientLSP)),l={textDocument:{uri:e.toString()}};let u=await c.requestAsync({method:"liveshare/externalDocument",params:l},null);return u||(u="<Not supported>"),this.documents.set(n,u),u}dispose(){this.documentClosedSubscription.dispose(),this.documents.clear()}onTextDocumentClosed(e){this.documents.delete(e.uri.toString())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(30),r=n(59);function o(e){return"[object Number]"===Object.prototype.toString.call(e)}t.createConverterExtension=function(e){function t(t){if(t)return s.Location.create(e.asUri(t.uri),e.asRange(t.range))}function n(t){if(t)return s.LocationLink.create(e.asUri(t.targetUri),e.asRange(t.targetRange),e.asRange(t.targetSelectionRange),e.asRange(t.originSelectionRange))}function a(t){let n=s.DocumentHighlight.create(e.asRange(t.range));return o(t.kind)&&(n.kind=function(e){switch(e){case i.DocumentHighlightKind.Text:return s.DocumentHighlightKind.Text;case i.DocumentHighlightKind.Read:return s.DocumentHighlightKind.Read;case i.DocumentHighlightKind.Write:return s.DocumentHighlightKind.Write;default:return s.DocumentHighlightKind.Text}}(t.kind)),n}function c(e){let t=s.SignatureInformation.create(e.label);var n;return e.documentation&&(t.documentation="string"==typeof e.documentation?e.documentation:e.documentation.value),e.parameters&&(t.parameters=(n=e).parameters.map(e=>function(e,t){let n=s.ParameterInformation.create(e.label);return e.documentation&&(n.documentation="string"==typeof e.documentation?e.documentation:e.documentation.value),"string"!=typeof e.label&&(n.label=t.substr(e.label[0],e.label[1]-e.label[0])),n}(e,n.label))),t}function l(t){if(!t)return;let n={};return t.entries().forEach(t=>{n[e.asUri(t[0])]=t[1].map(t=>e.asTextEdit(t))}),{changes:n}}return{asHover:function(t){return null==t?null:{range:e.asRange(t.range),contents:t.contents.map((e,t)=>{return i=t>0,function(e){return void 0!==e.value}(n=e)?i?`\n${n.value}`:n.value:r.isString(n)&&i?`\n${n}`:n;var n,i})}},asDefinitionResult:function(e){if(e)return Array.isArray(e)?e.map(e=>t(e)):t(e)},asDefinitionResultAlternate:function(t){if(t)return Array.isArray(t)?t.map(t=>s.Location.create(e.asUri(t.targetUri),e.asRange(t.targetRange))):void 0},asDefinitionLinkResult:function(e){if(e)return e.map(e=>n(e))},asLocation:t,asLocationLink:n,asReferences:function(e){if(e)return e.map(e=>t(e))},asDocumentHighlights:function(e){if(e)return e.map(a)},asSymbolInformations:function(t,n){if(t)return t.map(t=>function(t,n){const i=t.location?t.location.range:t.range,r=t.location?t.location.uri:n;let o=s.SymbolInformation.create(t.name,t.kind+1,e.asRange(i),e.asUri(r));t.containerName&&(o.containerName=t.containerName);return o}(t,n))},asSignatureHelp:function(e){if(!e)return;let t,n,i=[];return t=o(e.activeSignature)?e.activeSignature:0,n=o(e.activeParameter)?e.activeParameter:0,e.signatures&&(i=e.signatures.map(c)),{activeSignature:t,activeParameter:n,signatures:i}},asWorkspaceEdit:l,asColorInformation:function(t){return{color:t.color,range:e.asRange(t.range)}},asColorPresentation:function(t){let n={label:t.label,textEdit:e.asTextEdit(t.textEdit)};return t.additionalTextEdits&&(n.additionalTextEdits=t.additionalTextEdits.map(t=>e.asTextEdit(t))),n},asCodeAction:function(t){let n,i=t.kind?t.kind.value:void 0,r=t.command;if(t.edit)n=s.CodeAction.create(t.title,l(t.edit),i),r&&(n.command=r);else{if(!r)throw new Error("Invalid CodeAction - neither command nor edit.");n=s.CodeAction.create(t.title,r,i)}return t.diagnostics&&(n.diagnostics=e.asDiagnostics(t.diagnostics)),n}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(18),s=n(1325),r=n(1326),o=n(192),a=n(1329),c=n(553);t.CachedSearchProvider=class{constructor(e){this.provider=e,this.caches=new Map}provideFileSearchResults(e,t,n){const i={query:e,options:t,token:n};let s=this.trySortedSearchFromCache(i);if(!s){const e=t.maxResults?Object.assign({},t,{maxResults:1e9}):t;i.options=e,s=this.doSortedSearch(i,this.provider)}return s.then(e=>e.map(e=>a.joinPath(t.folder,e.relativePath)))}doSortedSearch(e,t){const n=new Promise((n,i)=>{const s=[];this.doSearch(e,t,e=>s.push(e)).then(()=>n(s),i)});let i;return e.options.session&&(i=this.getOrCreateCache(e.options.session,e.options.folder),i.resultsToSearchCache[e.query.pattern]={finished:n},n.then(null,t=>{delete i.resultsToSearchCache[e.query.pattern]})),n.then(t=>{if(e.query.pattern){const n=i?i.scorerCache:Object.create(null);return this.sortResults(e,t,n)}return t})}getOrCreateCache(e,t,n=!0){if(!e)return null;if(!this.caches.has(e)){if(!n)return null;e.onCancellationRequested(()=>{this.caches.delete(e)}),this.caches.set(e,new Map)}if(!this.caches.get(e).has(t.toString())){if(!n)return null;this.caches.get(e).set(t.toString(),new l)}return this.caches.get(e).get(t.toString())}trySortedSearchFromCache(e){const t=this.getOrCreateCache(e.options.session,e.options.folder,!1);if(!t)return;const n=this.getResultsFromCache(t,e.query.pattern);return n?n.then(n=>this.sortResults(e,n,t.scorerCache)):void 0}sortResults(e,t,n){const i=r.prepareQuery(e.query.pattern);return s.topAsync(t,(e,t)=>r.compareItemsByScore(e,t,i,!0,u,n),e.options.maxResults||0,1e4)}getResultsFromCache(e,t,n){const s=t.indexOf(i.sep)>=0;let r=void 0;for(let n in e.resultsToSearchCache)if(t.startsWith(n)){if(s&&n.indexOf(i.sep)<0)continue;r=e.resultsToSearchCache[n];break}return r?r.finished.then(e=>{if(n&&n.isCancellationRequested)throw c.canceled();let i=[];const s=o.stripWildcards(t).toLowerCase();for(let t=0;t<e.length;t++){let n=e[t];o.fuzzyContains(n.relativePath,s)&&i.push(n)}return i}):null}doSearch(e,t,n){return t.provideFileSearchResults(e.options,{report:e=>{if(e){const t={relativePath:e,basename:i.basename(e)};n(t)}}},e.token)}clearCache(e){return delete this.caches[e],Promise.resolve(void 0)}};class l{constructor(){this.resultsToSearchCache=Object.create(null),this.scorerCache=Object.create(null)}}const u=new class{getItemLabel(e){return e.basename}getItemDescription(e){return e.relativePath.substr(0,e.relativePath.length-e.basename.length-1)}getItemPath(e){return e.relativePath}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){e.done?s(e.value):new n((function(t){t(e.value)})).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(553);function r(e,t,n,i,s){for(const r=n.length;i<s;i++){const s=e[i];if(t(s,n[r-1])<0){n.pop();const e=o(n,e=>t(s,e)<0);n.splice(e,0,s)}}}function o(e,t){let n=0,i=e.length;if(0===i)return 0;for(;n<i;){let s=Math.floor((n+i)/2);t(e[s])?i=s:n=s+1}return n}t.topAsync=function(e,t,n,o,a){return 0===n?Promise.resolve([]):new Promise((c,l)=>{(()=>i(this,void 0,void 0,(function*(){const i=e.length,c=e.slice(0,n).sort(t);for(let l=n,u=Math.min(n+o,i);l<i;l=u,u=Math.min(u+o,i)){if(l>n&&(yield new Promise(e=>setTimeout(e))),a&&a.isCancellationRequested)throw s.canceled();r(e,t,c,l,u)}return c})))().then(c,l)})},t.findFirstInSorted=o},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(192),s=n(1327),r=n(1328),o="win32"===e.platform,a=(e.platform,"linux"===e.platform),c=o?"\\":"/",l=[0,[]];function u(e,t,n,i){if(!e||!t)return l;const s=e.length,r=t.length;if(s<r)return l;const o=e.toLowerCase();if(!i){if(-1===o.indexOf(n))return l}return function(e,t,n,i,s,r){const o=[],a=[];for(let c=0;c<n;c++)for(let n=0;n<r;n++){const l=c*r+n,u=l-1,h=(c-1)*r+n-1,f=n>0?o[u]:0,p=c>0&&n>0?o[h]:0,m=c>0&&n>0?a[h]:0;let g;g=!p&&c>0?0:d(e,t,c,i,s,n,m),g&&p+g>=f?(a[l]=m+1,o[l]=p+g):(a[l]=0,o[l]=f)}const c=[];let l=n-1,u=r-1;for(;l>=0&&u>=0;){0===a[l*r+u]||(c.push(u),l--),u--}return[o[n*r-1],c.reverse()]}(t,n,r,e,o,s)}function d(e,t,n,i,r,o,a){let c=0;if(t[n]!==r[o])return c;if(c+=1,a>0&&(c+=5*a),e[n]===i[o]&&(c+=1),0===o)c+=8;else{const e=function(e){switch(e){case 47:case 92:return 5;case 95:case 45:case 46:case 32:case 39:case 34:case 58:return 4;default:return 0}}(i.charCodeAt(o-1));e?c+=e:s.isUpper(i.charCodeAt(o))&&(c+=1)}return c}t.score=u;const h=Object.freeze({score:0});function f(e,t,n,r,o){if(!e||!t.value)return h;const l=r.getItemLabel(e);if(!l)return h;const d=r.getItemDescription(e);let f;f=d?`${l}${d}${t.value}${n}`:`${l}${t.value}${n}`;const p=o[f];if(p)return p;const m=function(e,t,n,r,o){if(n&&a?r.original===n:i.equalsIgnoreCase(r.original,n))return{score:1<<18,labelMatch:[{start:0,end:e.length}],descriptionMatch:t?[{start:0,end:t.length}]:void 0};if(!n||!r.containsPathSeparator){const t=s.matchesPrefix(r.value,e);if(t)return{score:1<<17,labelMatch:t};const n=s.matchesCamelCase(r.value,e);if(n)return{score:65536,labelMatch:n};const[i,a]=u(e,r.value,r.lowercase,o);if(i)return{score:i+32768,labelMatch:s.createMatches(a)}}if(t){let i=t;n&&(i=`${t}${c}`);const a=i.length,l=`${i}${e}`,[d,h]=u(l,r.value,r.lowercase,o);if(d){const e=s.createMatches(h),t=[],n=[];return e.forEach(e=>{e.start<a&&e.end>a?(t.push({start:0,end:e.end-a}),n.push({start:e.start,end:a})):e.start>=a?t.push({start:e.start-a,end:e.end-a}):n.push(e)}),{score:d,labelMatch:t,descriptionMatch:n}}}return h}(l,d,r.getItemPath(e),t,n);return o[f]=m,m}function p(e,t,n){let i=-1,s=-1;if(t.descriptionMatch&&t.descriptionMatch.length?i=t.descriptionMatch[0].start:t.labelMatch&&t.labelMatch.length&&(i=t.labelMatch[0].start),t.labelMatch&&t.labelMatch.length){if(s=t.labelMatch[t.labelMatch.length-1].end,t.descriptionMatch&&t.descriptionMatch.length){const t=n.getItemDescription(e);t&&(s+=t.length)}}else t.descriptionMatch&&t.descriptionMatch.length&&(s=t.descriptionMatch[t.descriptionMatch.length-1].end);return s-i}function m(e,t,n,i){const s=i.getItemLabel(e),o=i.getItemLabel(t),a=i.getItemDescription(e),c=i.getItemDescription(t),l=s.length+(a?a.length:0),u=o.length+(c?c.length:0);if(l!==u)return l-u;const d=i.getItemPath(e),h=i.getItemPath(t);return d&&h&&d.length!==h.length?d.length-h.length:s!==o?r.compareAnything(s,o,n.value):a&&c&&a!==c?r.compareAnything(a,c,n.value):d&&h&&d!==h?r.compareAnything(d,h,n.value):0}t.prepareQuery=function(e){e||(e="");let t=i.stripWildcards(e).replace(/\s/g,"");o&&(t=t.replace(/\//g,c));const n=t.toLowerCase(),s=t.indexOf(c)>=0;return{original:e,value:t,lowercase:n,containsPathSeparator:s}},t.scoreItem=f,t.compareItemsByScore=function(e,t,n,i,s,r,o=m){const a=f(e,n,i,s,r),c=f(t,n,i,s,r),l=a.score,u=c.score;if((l===1<<18||u===1<<18)&&l!==u)return l===1<<18?-1:1;if(l===1<<17||u===1<<17){if(l!==u)return l===1<<17?-1:1;const n=s.getItemLabel(e),i=s.getItemLabel(t);if(n.length!==i.length)return n.length-i.length}if(65536===l||65536===u){if(l!==u)return 65536===l?-1:1;const n=s.getItemLabel(e),i=s.getItemLabel(t),r=function(e,t){if(!((e||t)&&(e&&e.length||t&&t.length)))return 0;if(!t||!t.length)return-1;if(!e||!e.length)return 1;const n=e[0].start,i=e[e.length-1].end-n,s=t[0].start,r=t[t.length-1].end-s;return i===r?0:r<i?1:-1}(a.labelMatch,c.labelMatch);if(0!==r)return r;if(n.length!==i.length)return n.length-i.length}if(l>32768||u>32768){if(u<32768)return-1;if(l<32768)return 1}if(l!==u)return l>u?-1:1;const d=p(e,a,s),h=p(t,c,s);return d&&h&&d!==h?h>d?-1:1:o(e,t,n,s)},t.fallbackCompare=m}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(192);function s(e){return 97<=e&&e<=122}function r(e){return 65<=e&&e<=90}function o(e){return 48<=e&&e<=57}function a(e){return 32===e||9===e||10===e||13===e}function c(e){return s(e)||r(e)||o(e)}function l(e,t){for(let n=t;n<e.length;n++){let t=e.charCodeAt(n);if(r(t)||o(t)||n>0&&!c(e.charCodeAt(n-1)))return n}return e.length}function u(e,t,n,i){if(n===e.length)return[];if(i===t.length)return null;if(e[n]!==t[i].toLowerCase())return null;{let o=null,a=i+1;for(o=u(e,t,n+1,i+1);!o&&(a=l(t,a))<t.length;)o=u(e,t,n+1,a),a++;return null===o?null:(s={start:i,end:i+1},0===(r=o).length?r=[s]:s.end===r[0].start?r[0].start=s.start:r.unshift(s),r)}var s,r}t.matchesPrefix=function(e,t,n){if(!n||n.length<t.length)return null;let s;s=e?i.startsWithIgnoreCase(n,t):0===n.indexOf(t);if(!s)return null;return t.length>0?[{start:0,end:t.length}]:[]}.bind(void 0,!0),t.isUpper=r,t.matchesCamelCase=function(e,t){if(!t)return null;if(0===(t=t.trim()).length)return null;if(!function(e){let t=0,n=0,i=0,o=0;for(let c=0;c<e.length;c++)i=e.charCodeAt(c),r(i)&&t++,s(i)&&n++,a(i)&&o++;return 0!==t&&0!==n||0!==o?t<=5:e.length<=30}(e))return null;if(t.length>60)return null;const n=function(e){let t=0,n=0,i=0,a=0,l=0;for(let u=0;u<e.length;u++)l=e.charCodeAt(u),r(l)&&t++,s(l)&&n++,c(l)&&i++,o(l)&&a++;return{upperPercent:t/e.length,lowerPercent:n/e.length,alphaPercent:i/e.length,numericPercent:a/e.length}}(t);if(!function(e){const{upperPercent:t,lowerPercent:n,alphaPercent:i,numericPercent:s}=e;return n>.2&&t<.8&&i>.6&&s<.2}(n)){if(!function(e){const{upperPercent:t,lowerPercent:n}=e;return 0===n&&t>.6}(n))return null;t=t.toLowerCase()}let i=null,d=0;for(e=e.toLowerCase();d<t.length&&null===(i=u(e,t,0,d));)d=l(t,d+1);return i},t.createMatches=function(e){let t,n,i=[];if(!e)return i;t=Array.isArray(e[1])?e[1]:e;for(const e of t)n&&n.end===e?n.end+=1:(n={start:e,end:e+1},i.push(n));return i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(192);let s,r;function o(e){s=e,r=e.resolvedOptions().numeric}function a(e,t,n=!1){if(s){const n=e||"",i=t||"",o=s.compare(n,i);return r&&0===o&&n!==i?n<i?-1:1:o}return l(e,t,n)}o(new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"})),t.setFileNameComparer=o,t.compareFileNames=a;const c=/^(.*?)(\.([^.]*))?$/;function l(e,t,n=!1){n||(e=e&&e.toLowerCase(),t=t&&t.toLowerCase());const[i,s]=u(e),[r,o]=u(t);return i!==r?i<r?-1:1:s===o?0:s<o?-1:1}function u(e){const t=e?c.exec(e):[];return[t&&t[1]||"",t&&t[3]||""]}function d(e,t,n){let s=e.toLowerCase(),r=t.toLowerCase(),o=i.startsWith(s,n),a=i.startsWith(r,n);if(o!==a)return o?-1:1;if(o&&a){if(s.length<r.length)return-1;if(s.length>r.length)return 1}return 0}t.noIntlCompareFileNames=l,t.compareAnything=function(e,t,n){let s=e.toLowerCase(),r=t.toLowerCase();const o=d(e,t,n);if(o)return o;let c=i.endsWith(s,n);if(c!==i.endsWith(r,n))return c?-1:1;let l=a(s,r);return 0!==l?l:s.localeCompare(r)},t.compareByPrefix=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(18);t.joinPath=function(e,t){const n=i.posix.join(e.path||"/",t);return e.with({path:n})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(509),s=n(4),r=n(5),o=n(7);t.default=async function(e){const t=new i.BreakpointManager(!1,e.sourceEventService(),e.pathManager());await t.init();const n=new i.JoinDebugManager(e.rpcFactory(r.vsls.DebuggerHostService,r.vsls.TraceSources.DebugHost),s.SessionContext,e.fileSystemManager(),e.pathManager(),e.accessControlManager(),o.traceSource.withName(r.vsls.TraceSources.DebugRemote));await n.init(),s.ExtensionUtil.registerCommand("liveshare.debug",()=>n.attach()),e.enableCommands["liveshare.debug"]=()=>n.canAttach()}},function(e){e.exports=JSON.parse('{"name":"vsliveshare-web","version":"1.1.0-dev","scripts":{"test":"echo \\"no tests found.\\"","vscode:prepublish":"echo \\"nothing\\"","webview:build":"cd ../communications/webview && yarn build","compile":"../../common/node_modules/.bin/tsc -b ./","webpack:build":"yarn compile && yarn webview:build","watch":"../../common/node_modules/.bin/tsc -b -watch ./","build:webpack":"node ../../node_modules/webpack-cli/bin/cli.js --config webpack.browser.config","build:webpack-calling-service":"node ../../node_modules/webpack-cli/bin/cli.js --config ../callingService/webpack.browser.config","prewebpack":"cd ../../vsls-contracts && yarn generate-contracts","webpack-dev":"yarn webpack:build && yarn build:webpack -- --env=development","webpack-dev-deploy":"yarn webpack-dev && gulp deploy-web && gulp fixOutWebPackageContentsDev","webpack":"yarn webpack:build && yarn build:webpack && gulp deploy-web","calling-service-deploy":"gulp copy-webpack-calling-service","build:webpack-node":"node ../../node_modules/webpack-cli/bin/cli.js --config webpack.node.config","webpack-node":"yarn webpack:build && yarn build:webpack-node && yarn compile-port-forwarder && gulp deploy-node","package":"yarn webpack-node && gulp package","compile-dev":"yarn compile && gulp deploy-package-out","compile-port-forwarder":"cd ../../port-forwarder/hub && yarn webpack-node"},"dependencies":{"@vs/liveshare-core":"link:../core","@vs/liveshare-debug":"link:../debugging","@vs/liveshare-lsp":"link:../languageService","@vs/liveshare-contactservice":"link:../contactService","@vs/liveshare-reviews":"link:../reviews","@vs/liveshare-notebooks":"link:../notebooks","@vs/liveshare-servers":"link:../servers","@vs/liveshare-signalr-proxy":"link:../signalR-proxy","@vs/liveshare-communications":"link:../communications","@vs/liveshare-signalr":"link:../signalR","@vs/liveshare-terminals":"link:../terminals","@vs/liveshare-tasks":"link:../tasks","@vs/liveshare-api":"link:../api","@vs/vscode-command-framework":"link:../../vscode-command-framework","@vs/vso-workspace-client":"link:../../workspace/client","@vs/vso-workspace-client-hub":"link:../../workspace/client-hub","@vs/vso-rpc-signalr":"link:../../rpc/signalr","@vs/vso-node-utils":"link:../../node/utils","module-alias":"^2.2.2","vscode-jsonrpc":"^4.0.0"},"devDependencies":{"@types/node":"^10.14.8","copyfiles":"^2.1.1","gulp":"^4.0.2","nerdbank-gitversioning":"^3.4.220"},"_moduleAliases":{"@extension-abstractions":"./src/node","@core-abstractions":"../../../node_modules/@vs/liveshare-core/dist/src/abstractions/node","@server-abstractions":"../../../node_modules/@vs/liveshare-servers/dist/src/abstractions/node","@vscode-abstractions":"../../../node_modules/@vs/vscode-command-framework/dist/src/abstractions/node","@api-abstractions":"../../../node_modules/@vs/liveshare-api/dist/src/abstractions/node"}}')},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(4);t.joinWorkspace=async function(e,t){if(t||i.workspace.workspaceFolders&&i.workspace.workspaceFolders.length>0){const t=`https://online.visualstudio.com/liveshare/${e}`;return s.ExtensionUtil.openBrowser(t),!0}},t.leaveCollaboration=async function(){i.workspace.workspaceFolders&&i.workspace.workspaceFolders.length>0&&(i.workspace.updateWorkspaceFolders(0,i.workspace.workspaceFolders.length),await i.commands.executeCommand("workbench.action.closeAllEditors")),await i.commands.executeCommand("vscode.openFolder",i.Uri.parse("vsls:/"))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(556);t.guestTerminalControllerFactory=i.guestTerminalControllerFactory;var s=n(557);t.TerminalControllerBase=s.TerminalControllerBase;var r=n(558);t.GuestTerminalHandler=r.GuestTerminalHandler;var o=n(1335);t.registerGuestTerminalHandler=o.registerGuestTerminalHandler;const a=n(314);t.tt=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(7),r=n(57),o=n(9),a=n(4);t.createJoinedTerminal=async function(e,t,n){let c=e.terminalCache.getById(t.id);if(c)return c.terminal.show(),c.terminal;const l=t.options.name;let u;n||(n=s.createTerminalRenderer(l));const d=[];let h=null;n.onDidChangeMaximumDimensions(n=>{h&&clearTimeout(h),h=r.setTimeout(async()=>{clearTimeout(h),h=null;try{await e.terminalService.resizeTerminalAsync(t.id,n.columns,n.rows)}catch(t){e.trace.error(`Error resizing terminal ${t}`)}},100)},void 0,d),e.terminalService.onTerminalResized(e=>{e.terminal.id===t.id&&(n.dimensions={columns:e.terminal.options.cols,rows:e.terminal.options.rows})},void 0,d);const f=await e.terminalEndpointBufferFactory(t);return u=await n.terminal,async function(e,t,n){let s=[];const r=new i.CancellationTokenSource;try{let n=Promise.resolve();t.onDidAcceptInput(t=>n=n.then(()=>function(t){if(!r.token.isCancellationRequested)return e.writeData(t,r.token)}(t)),void 0,s);const o=await t.terminal;for(i.window.onDidCloseTerminal(e=>{e===o&&r.cancel()},void 0,s);!r.token.isCancellationRequested;){const n=await e.readData(r.token);if(null===n)break;t.write(n)}r.cancel(),await n}catch(i){r.token.isCancellationRequested||e.isDisposed()||(n.error(`Error running shared terminal renderer ${i}`),t.write(`\r\n[31mError running shared terminal ${i}[0m`),o.Telemetry.sendFault(a.TelemetryEventNames.RUN_SHARED_TERMINAL_FAULT,o.FaultType.Error,null,i))}finally{s.forEach(e=>e.dispose())}}(f,n,e.trace),u.show(),c=e.terminalCache.register(u,t.id,!0,{dispose:async()=>{if(d.forEach(e=>e.dispose()),a.sessionStateTracker.State===a.SessionState.Shared)await e.terminalService.stopTerminalAsync(t.id);else if(n)try{await e.terminalService.resizeTerminalAsync(t.id,0,0)}catch(e){}}}),e.terminalService.onTerminalStopped(e=>{e.terminal.id===t.id&&u.dispose()},null,d),u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(558),s=n(1336);t.registerGuestTerminalHandler=function(e,t){const n={dependencies:e,terminalEndpointBufferFactory:s.createTerminalEndpointBufferFactory(e,t),accessControlManager:e.accessControlManager};e.sessionStateManager().registerHandler(new i.GuestTerminalHandler(n))}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(43);t.createTerminalEndpointBufferFactory=function(t,n){return async i=>{const r=await t.streamManagerService().getStreamAsync(i.streamName,i.streamCondition),o=await n.openStreamingChannel(r),a=new s(o);let c=!1;return o.onClosed(()=>{c=!0}),{isDisposed:()=>c,readData:async e=>{const t=await a.read(1024,e);return t?t.toString():null},writeData:async(t,n)=>{const i=e.from(t,"utf8");await o.send(i,n)}}}};class s extends i.BaseStream{constructor(e){super(),e.onDataReceived(e=>{this.onData(e)})}write(e,t){throw new Error("Method not implemented.")}close(e,t){throw new Error("Method not implemented.")}}}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotebooksService={name:"notebooksService",methods:["getContentProviders","openNotebook","executeCell","executeNotebook","cancelCellExecution","cancelNotebookExecution","applyNotebookCellChanges","changeCellLanguage"],events:["didChangeCellOutputs","didChangeCellMetadata","didChangeNotebookCells","didChangeCellLanguage","didChangeCellExecutionState"]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(4),r=n(5),o=n(9),a=n(560),c=n(562);class l extends c.notebooksServiceBase{constructor(e,t){super(),this.allowGuestExecuteCellsForSession=!1,this.executeCellOperation={name:s.WellKnownRestrictedOperations.ExecuteNotebookCell,isEnabled:()=>this.allowGuestExecuteCells()},this.cellManagers={},this.rpcClient=e.workspaceService().client,this.workspaceService=e.workspaceService(),this.pathManager=e.pathManager(),this.fileService=e.fileService,this.clientAccessCheck=t,this.workspaceAccessControlService=e.workspaceAccessControlService,this.session=e.sessionContext(),this.trace=e.trace().withName("Notebooks")}allowGuestExecuteCells(){return s.Settings.get(s.SettingKeys.allowGuestExecuteCells)||this.allowGuestExecuteCellsForSession}async init(){var e;if(super.init(),"function"==typeof(null===(e=i.notebooks)||void 0===e?void 0:e.onDidChangeCellOutputs)){try{this.disposables.push(i.notebooks.onDidChangeCellOutputs(e=>this.onDidChangeCellOutputs(e))),this.disposables.push(i.notebooks.onDidChangeCellMetadata(e=>this.onDidChangeCellMetadata(e))),this.disposables.push(i.notebooks.onDidChangeNotebookCellExecutionState(e=>this._onDidChangeNotebookCellExecutionState(e))),this.disposables.push(i.notebooks.onDidChangeNotebookCells(e=>this._onDidChangeNotebookCells(e))),this.disposables.push(i.workspace.onDidOpenNotebookDocument(e=>this._onDidOpenNotebookDocument(e))),i.workspace.notebookDocuments.forEach(e=>this.createCellManager(e))}catch(e){}this.allowGuestExecuteCellsForSession=!1,this.disposables.push(this.workspaceAccessControlService().onOpeationAccessRequested(e=>{s.SessionContext.isCollaborating&&e.operation.name===s.WellKnownRestrictedOperations.ExecuteNotebookCell&&this.requestExecuteCellsAccess(e.operation,e.sessionId)})),this.rpcClient.addRequestMethod("notebooksService.getContentProviders",e=>this.getContentProviders(e)),this.rpcClient.addRequestMethod("notebooksService.openNotebook",(e,t,n)=>this.openNotebook(e,t,n)),this.rpcClient.addRequestMethodWithContext("notebooksService.executeCell",(e,t,n,i,s)=>this.executeCell(e,t,n,i,s)),this.rpcClient.addRequestMethodWithContext("notebooksService.executeNotebook",(e,t,n,i)=>this.executeNotebook(e,t,n,i)),this.rpcClient.addRequestMethod("notebooksService.cancelCellExecution",(e,t,n,i)=>this.cancelCellExecution(e,t,n,i)),this.rpcClient.addRequestMethod("notebooksService.cancelNotebookExecution",(e,t,n)=>this.cancelNotebookExecution(e,t,n)),this.rpcClient.addRequestMethod("notebooksService.changeCellLanguage",(e,t,n,i)=>this.changeCellLanguage(e,t,n,i)),this.rpcClient.addRequestMethod("notebooksService.applyNotebookCellChanges",(e,t,n)=>this.applyNotebookCellChanges(e,t,n)),await this.workspaceService.registerServicesAsync(["notebooksService"],r.vsls.CollectionChangeType.Add)}}createCellManager(e){const t=this.pathManager.localPathToRelativePath(e.uri);this.cellManagers[t]||(this.cellManagers[t]=new a.HostCellManager(e,this.pathManager,this.fileService,this.session.coeditingClient))}_onDidOpenNotebookDocument(e){this.createCellManager(e)}async requestExecuteCellsAccess(e,t){try{const t=s.localize("notebooks.executeCellsAllowForSession"),n=s.localize("notebooks.executeCellsAllowAlways"),o=s.localize("notebooks.executeCellsReject"),a=await i.window.showInformationMessage(s.localize("notebooks.executeCellsRequested"),t,n,o);a===t?this.allowGuestExecuteCellsForSession=!0:a===n&&s.Settings.save(s.SettingKeys.allowGuestExecuteCells,!0);const c=a===t||a===n?r.vsls.RestrictedOperationAccess.Allowed:r.vsls.RestrictedOperationAccess.ExplicitlyRejectedByHost;await this.workspaceAccessControlService().setOperationAccessAsync(e,c)}catch(t){const n=`Requesting access for '${e?e.name:"null"}' operation failed: ${t.message}`;this.trace.error(n),o.Telemetry.sendFault(s.TelemetryEventNames.REQUEST_OPERATION_ACCESS_FAULT,o.FaultType.NonBlockingFault,n,t)}}async getContentProviders(e){const t=await i.commands.executeCommand("_resolveNotebookContentProvider");let n=[];return t&&(n=t.map(e=>({viewType:e.viewType,displayName:e.displayName,priority:"default",selector:e.filenamePattern.map(e=>"string"==typeof e?{filenamePattern:e}:{filenamePattern:e.include,excludeFileNamePattern:e.exclude})}))),n}async openNotebook(e,t,n){if(await this.fileService().isExcludedAsync(e,{enableMultipleRoots:!0}))throw new Error("Notebook unavailable");const r=this.pathManager.relativePathToLocalPath(e),o=await i.workspace.openNotebookDocument(r);this.createCellManager(o),await this.cellManagers[e].init();const a={usedNotebookType:o.notebookType!==t?o.notebookType:void 0,metadata:o.metadata,cells:o.getCells().map(e=>s.getNotebookCellData(e))};return a.languages=o.languages,a}applyNotebookCellChanges(e,t,n){s.assert(!!this.cellManagers[e],"Host should have cell manager for notebook guest is trying to modify"),this.cellManagers[e]&&this.cellManagers[e].applyChanges(t)}handleLanguageChange(e,t,n){const i={relativePath:this.pathManager.localPathToRelativePath(e),cellId:n,language:t};this.rpcClient.sendNotification(this.trace,"notebooksService.didChangeCellLanguage",i)}async _onDidChangeNotebookCells(e){const t=this.pathManager.localPathToRelativePath(e.document.uri);if(s.assert(!!this.cellManagers[t],"Host should have cell manager for notebook being changed"),this.cellManagers[t]){const n=[...e.document.getCells()],i=await this.cellManagers[t].onDidChangeNotebookCells(e);s.sortCells(n);const r={relativePath:t,changes:i,contentHash:s.getNotebookHash(n)};this.rpcClient.sendNotification(this.trace,"notebooksService.didChangeNotebookCells",r)}}async ensureNotebookEditor(e,t){if(!i.window.visibleNotebookEditors.find(t=>t.document.uri.toString()===e.toString())){const t=await i.workspace.openNotebookDocument(e);await i.window.showNotebookDocument(t,{preserveFocus:!0})}}async executeCell(e,t,n,o,a){if(!await this.clientAccessCheck().canPerformOperation(o,this.executeCellOperation)){const e=await this.clientAccessCheck().isClientReadOnly(o)?r.vsls.RestrictedOperationAccess.RejectedInReadOnlySession:r.vsls.RestrictedOperationAccess.DisabledByHostConfiguration;return void this.workspaceAccessControlService().rejectOperationAsync({name:s.WellKnownRestrictedOperations.ExecuteNotebookCell,sessionId:o.GuestSessionId},e)}const c=this.pathManager.relativePathToLocalPath(t);await this.ensureNotebookEditor(c,n),i.commands.executeCommand("notebook.cell.execute",e,c)}async executeNotebook(e,t,n,o){if(!await this.clientAccessCheck().canPerformOperation(n,this.executeCellOperation)){const e=await this.clientAccessCheck().isClientReadOnly(n)?r.vsls.RestrictedOperationAccess.RejectedInReadOnlySession:r.vsls.RestrictedOperationAccess.DisabledByHostConfiguration;return void this.workspaceAccessControlService().rejectOperationAsync({name:s.WellKnownRestrictedOperations.ExecuteNotebookCell,sessionId:n.GuestSessionId},e)}const a=this.pathManager.relativePathToLocalPath(e);await this.ensureNotebookEditor(a,t),await i.commands.executeCommand("notebook.execute",a)}async cancelCellExecution(e,t,n,s){const r=this.pathManager.relativePathToLocalPath(t);await this.ensureNotebookEditor(r,n),await i.commands.executeCommand("notebook.cell.cancelExecution",e,r)}async changeCellLanguage(e,t,n,r){const o=this.pathManager.relativePathToLocalPath(n),a=i.window.visibleNotebookEditors.find(e=>e.document.uri.path===o.path);if(!a)return;const c=a.document.getCells().find(t=>s.getCellId(t)===e);c&&c.document.languageId!==t&&i.languages.setTextDocumentLanguage(c.document,t)}async cancelNotebookExecution(e,t,n){const s=this.pathManager.relativePathToLocalPath(e);await this.ensureNotebookEditor(s,t),await i.commands.executeCommand("notebook.cancelExecution",s)}onDidChangeCellOutputs(e){const t={relativePath:this.pathManager.localPathToRelativePath(e.document.uri),cells:e.cells.map(e=>({id:s.getCellId(e),outputs:[...e.outputs]}))};this.rpcClient.sendNotification(this.trace,"notebooksService.didChangeCellOutputs",t)}_onDidChangeNotebookCellExecutionState(e){var t,n;const i=s.getCellId(e.cell);if(!i)return void s.assert(!!i,"Host should have cell id for cell whose execution state is being changed");const r=e.cell.executionSummary,o={relativePath:this.pathManager.localPathToRelativePath(e.cell.notebook.uri),cellId:i,executionState:e.state,executionSummary:{success:null==r?void 0:r.success,timing:{startTime:null===(t=null==r?void 0:r.timing)||void 0===t?void 0:t.startTime,endTime:null===(n=null==r?void 0:r.timing)||void 0===n?void 0:n.endTime}}};this.rpcClient.sendNotification(this.trace,"notebooksService.didChangeCellExecutionState",o)}onDidChangeCellMetadata(e){const t={relativePath:this.pathManager.localPathToRelativePath(e.document.uri),cell:{id:s.getCellId(e.cell),metadata:e.cell.metadata}};this.rpcClient.sendNotification(this.trace,"notebooksService.didChangeCellMetadata",t)}async dispose(){if(super.dispose(),this.session.isStartingCollaboration||this.session.isCollaborating)try{await this.workspaceService.registerServicesAsync(["notebooksService"],r.vsls.CollectionChangeType.Remove)}catch(e){}}}t.HostNotebooksService=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(5),r=n(4),o=n(563),a=n(564),c=n(562),l=n(1340),u={name:r.WellKnownRestrictedOperations.ExecuteNotebookCell};class d extends c.notebooksServiceBase{constructor(e,t){super(),this.waitingForCellExecutionAccess=!1,this.hasRequestedCellExecutionAccess=!1,this.cellManagers={},this.remoteChangesQueue=Promise.resolve(),this.service=t,this.pathManager=e.pathManager(),this.session=e.sessionContext(),this.workspaceAccessControlService=e.workspaceAccessControlService,this.trace=e.trace().withName("Notebooks")}async init(){var e,t,n;if(super.init(),"function"==typeof(null===(e=i.notebooks)||void 0===e?void 0:e.onDidChangeCellOutputs)){try{i.workspace.notebookDocuments}catch(e){return}await this.initContentProviders(),this.disposables.push(i.workspace.onDidOpenNotebookDocument(e=>this.onDidOpenNotebookDocument(e))),this.disposables.push(null===(t=i.notebooks)||void 0===t?void 0:t.onDidChangeNotebookCells(e=>this._onDidChangeNotebookCells(e))),this.disposables.push(this.workspaceAccessControlService().onOperationRejected(async e=>{e.operation.name===r.WellKnownRestrictedOperations.ExecuteNotebookCell&&e.operation.sessionId===r.workspaceSessionInfoTracker.workspaceSessionInfo.sessionNumber&&this.executeNotebookCellRejected(e.access)})),this.disposables.push(this.workspaceAccessControlService().onOperationAccessChanged(async e=>{if(e.operation.name===r.WellKnownRestrictedOperations.ExecuteNotebookCell&&(e.access==s.vsls.RestrictedOperationAccess.Allowed&&this.hasRequestedCellExecutionAccess||this.waitingForCellExecutionAccess)){this.waitingForCellExecutionAccess=!1;const t=e.access===s.vsls.RestrictedOperationAccess.Allowed,n=t?r.localize("notebooks.executeCellsAccessGranted"):r.localize("notebooks.executeCellsAccessDenied");i.window.showInformationMessage(n),this.notebookController.handleExecutionRequests(t)}})),"function"==typeof(null===(n=i.notebooks)||void 0===n?void 0:n.createNotebookController)&&(this.notebookController=new l.NotebookController(this.pathManager,this.service),this.notebookController.createNotebookController(),this.disposables.push(this.notebookController)),this.service.onDidChangeCellOutputs(e=>this.onDidChangeCellOutputs(e)),this.service.onDidChangeCellMetadata(e=>this.onHostDidChangeCellMetadata(e)),this.service.onDidChangeCellLanguage(e=>this.onHostDidChangeCellLanguage(e)),this.service.onDidChangeNotebookCells(e=>this.onHostDidChangeNotebookCells(e)),this.service.onDidChangeCellExecutionState(e=>this.onDidChangeCellExecutionState(e))}}onDidChangeCellOutputs(e){const t=i.window.visibleNotebookEditors.find(t=>t.document.uri.path===e.relativePath);t&&e.cells.forEach(e=>{const n=this.getCellFromActiveEditor(t,e.id);n&&this.notebookController.updateOutput(n,[...e.outputs])})}onDidChangeCellExecutionState(e){const t=i.window.visibleNotebookEditors.find(t=>t.document.uri.path===e.relativePath);if(!t)return;const n=this.getCellFromActiveEditor(t,e.cellId);n&&this.notebookController.updateExecutionState(n,e.relativePath,e.executionState,e.executionSummary.success)}getCellFromActiveEditor(e,t){return e.document.getCells().find(e=>r.getCellId(e)===t)}handleLanguageChange(e,t,n){const i=this.pathManager.localPathToRelativePath(e);this.service.changeCellLanguageAsync(n,t,i)}onDidOpenNotebookDocument(e){if(e.notebookType.startsWith(r.NotebookConstants.mirrorNotebookTypePrefix)){const t=this.pathManager.localPathToRelativePath(e.uri);this.cellManagers[t]||(this.cellManagers[t]=new o.GuestCellManager(e,this.pathManager,this.session.coeditingClient))}else i.window.showWarningMessage(r.localize("notebooks.openedWithLocalContentProvider"))}onHostDidChangeNotebookCells(e){this.cellManagers[e.relativePath]&&(this.remoteChangesQueue=this.remoteChangesQueue.then(()=>this.cellManagers[e.relativePath].onHostDidChangeNotebookCells(e)))}async _onDidChangeNotebookCells(e){const t=this.pathManager.localPathToRelativePath(e.document.uri);if(r.assert(!!this.cellManagers[t],"Guest should have cell manager for notebook being changed"),this.cellManagers[t]){const n=await this.cellManagers[t].onDidChangeNotebookCells(e);0!==n.length&&this.service.applyNotebookCellChangesAsync(t,n)}}async executeNotebookCellRejected(e){if(e===s.vsls.RestrictedOperationAccess.RejectedInReadOnlySession)return void i.window.showInformationMessage(r.localize("notebooks.executeCellsReadOnly"));const t=r.localize("notebooks.executeCellsRequestAccess");await i.window.showInformationMessage(r.localize("notebooks.executeCellsLackingPermission"),t)===t?(this.hasRequestedCellExecutionAccess=!0,this.waitingForCellExecutionAccess=!0,this.workspaceAccessControlService().requestOperationAccessAsync(u)):this.notebookController.handleExecutionRequests(!1)}async initContentProviders(){let e=[];try{e=await this.service.getContentProvidersAsync()}catch(e){}e.forEach(e=>{const t=`${r.NotebookConstants.mirrorNotebookTypePrefix}${e.viewType}`,n=new a.NotebookContentProvider(e.viewType,this.service);this.disposables.push(i.workspace.registerNotebookContentProvider(t,n,{transientOutputs:!1,transientCellMetadata:{},transientDocumentMetadata:{}},{displayName:`Live Share - ${e.displayName}`,filenamePattern:e.selector.map(e=>e.excludeFileNamePattern?{include:e.filenamePattern,exclude:e.excludeFileNamePattern}:e.filenamePattern),exclusive:!0}))})}onHostDidChangeCellMetadata(e){const t=i.window.visibleNotebookEditors.find(t=>t.document.uri.path===e.relativePath);if(!t)return;const n=t.document.getCells().find(t=>r.getCellId(t)===e.cell.id);if(n){const s=new i.WorkspaceEdit;s.replaceNotebookCellMetadata(t.document.uri,n.index,e.cell.metadata),i.workspace.applyEdit(s)}}onHostDidChangeCellLanguage(e){const t=i.window.visibleNotebookEditors.find(t=>t.document.uri.path===e.relativePath);if(!t)return;const n=t.document.getCells().find(t=>r.getCellId(t)===e.cellId);n&&n.document.languageId!==e.language&&i.languages.setTextDocumentLanguage(n.document,e.language)}}t.GuestNotebooksService=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4),s=n(0);t.NotebookController=class{constructor(e,t){this.pathManager=e,this.service=t,this.runningExecutionTasks=new Map,this.label="Live Share Controller",this.id="LiveShare-Controller",this.notebookType="*",this.description="Visual Studio Live Share Controller",this.detail=i.localize("notebooks.kernelDetail"),this.executeHandler=(e,t,n)=>this.controllerHandler(e,t,n)}createNotebookController(){var e;this.controller=null===(e=s.notebooks)||void 0===e?void 0:e.createNotebookController(this.id,this.notebookType,this.label,this.executeHandler);for(let e of s.workspace.notebookDocuments)this.controller.updateNotebookAffinity(e,s.NotebookControllerAffinity.Preferred);return this.controller}async controllerHandler(e,t,n){if(i.workspaceSessionInfoTracker.isReadOnly)s.window.showInformationMessage(i.localize("notebooks.executeCellsReadOnly"));else{for(var r of e)this.startExecutionTask(r,this.pathManager.localPathToRelativePath(r.notebook.uri));e.length!==t.cellCount?this.service.executeCellAsync({start:e[0].index,end:e[e.length-1].index+1},this.pathManager.localPathToRelativePath(t.uri),t.notebookType.substring(i.NotebookConstants.mirrorNotebookTypePrefix.length)):this.service.executeNotebookAsync(this.pathManager.localPathToRelativePath(t.uri),t.notebookType.substring(i.NotebookConstants.mirrorNotebookTypePrefix.length))}}_onDidCancelExecution(e){this.service.cancelCellExecutionAsync({start:e.range,end:e.range+1},e.path,e.type)}startExecutionTask(e,t){const n=this.controller.createNotebookCellExecution(e);n.token.onCancellationRequested(()=>this._onDidCancelExecution({range:e.index,path:t,type:e.notebook.notebookType})),n.start(),this.runningExecutionTasks.set(i.getCellId(e),{task:n,cell:e})}updateExecutionState(e,t,n,r){let o=this.getExecutionTask(i.getCellId(e));if(!o||n!=s.NotebookCellExecutionState.Executing)if(o||n!=s.NotebookCellExecutionState.Executing||this.startExecutionTask(e,t),n===s.NotebookCellExecutionState.Executing)try{o.start()}catch(e){}else if(n===s.NotebookCellExecutionState.Idle){let t=r;void 0===t&&(t=!1);try{o.end(t)}catch(e){}this.runningExecutionTasks.delete(i.getCellId(e))}}getExecutionTask(e){var t;return null===(t=this.runningExecutionTasks.get(e))||void 0===t?void 0:t.task}getExecutionCell(e){var t;return null===(t=this.runningExecutionTasks.get(e))||void 0===t?void 0:t.cell}updateOutput(e,t){try{let r=this.getExecutionTask(i.getCellId(e));const o=!!r;o||(r=this.controller.createNotebookCellExecution(e),r.start());let a=[],c=!0;if(0===t.length)a.push(new s.NotebookCellOutputItem(new Uint8Array,"text/html"));else for(var n of t[0].items){const e=Object.values(n.data);let t=new Uint8Array;"object"==typeof e[1]&&(t=Uint8Array.from(e[1])),a.push(new s.NotebookCellOutputItem(t,n.mime)),n.mime!==i.NotebookConstants.notebookErrorMimeType&&n.mime!==i.NotebookConstants.notebookStandardErrorMimeType||(c=!1)}r.replaceOutput(new s.NotebookCellOutput(a)),o||r.end(c)}catch(e){}}handleExecutionRequests(e){if(e)for(let e of this.runningExecutionTasks.keys()){const t=this.runningExecutionTasks.get(e).cell;this.service.executeCellAsync({start:t.index,end:t.index+1},this.pathManager.localPathToRelativePath(t.notebook.uri),t.notebook.notebookType.substring(i.NotebookConstants.mirrorNotebookTypePrefix.length))}else for(let e of this.runningExecutionTasks.keys())try{const t=this.runningExecutionTasks.get(e);t.task.end(!1),this.runningExecutionTasks.delete(i.getCellId(t.cell))}catch(e){}}dispose(){this.controller.dispose()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(7),r=n(4);t.builder=function(e){return new o(e)};class o extends s.CommandBase{constructor(e){super(),this.dependencies=e}async invoke(e,t){if(r.userAuthStateTracker.IsSignedIn&&!r.userAuthStateTracker.isCurrentUserAnonymous())return void i.window.showInformationMessage("You are already signed in.");let n=await i.window.showInputBox({prompt:"Please enter your user code",ignoreFocusOut:!0});if(n)try{const e=await r.liveshareGithubStrategy.exchangeAuthorizationCode(n);e&&(await this.dependencies.authenticationProvider().attemptLoginVSCodeAccount(e),r.liveshareGithubStrategy.signalNewToken(e),r.sessionStateTracker.transition(r.SessionAction.SignInSuccess),i.window.showInformationMessage("User code setup succeeded"))}catch(e){await i.window.showErrorMessage(`Failed to use user code. Err: ${null==e?void 0:e.tostring()}`)}else r.sessionStateTracker.transition(r.SessionAction.SignInError)}}},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const s=n(8),r=n(7),o=n(290),a=n(62),c=n(4),l=n(308),u=n(548),d=n(20),h=n(83),f=n(490),p=n(1343),m=n(468),g=n(5),y=n(6),v=n(555),S=n(554),_=n(559),E={statusPostAuth:c.SessionAction.AttemptSharing,authAttemptMax:1};t.shareCommandBuilder=function(e){return new b(e)},t.endCommandBuilder=function(e){return new C(e)};let w=y.createDisposable(()=>{throw new Error("Invalid operation")}),b=class extends r.CommandBase{constructor(e){super(),this.dependencies=e}async invoke(e,t){var n;const i=c.Settings.get(c.SettingKeys.serviceUri),E=(await this.dependencies.authService().getCurrentAuthenticatedUserAsync()).accessToken,b=new h.WorkspaceApi(i,()=>E,r.traceSource.withName("WorkspaceApi")),C=c.ShareCommandUtilities.buildShareInfo(),T=await b.createSharedWorkspace(C[0]),M=[],A=new c.SourceEventService;M.push(A);const k=new f.WorkspaceServer(T,r.traceSource.withName("WorkspaceServer")),[R,P]=d.createDuplexRpcMessageStreams(),I=k.acceptRpcMessageStream(P);I[0].listen();const N=I[1],L=s.createMessageConnection(R.reader,R.writer);L.listen(),this.dependencies.agentRpcServer.onHandleNoneRequest((e,t,...n)=>d.sendRpcRequest(L,t,n)),this.dependencies.agentRpcServer.onHandleNoneNotification((e,t,...n)=>{d.rpcUtils.notifyConnections(k.rpcConnections.slice(1),t,n)}),L.onNotification((e,...t)=>{this.dependencies.agentRpcServer.sendNotification(r.traceSource,e,t)});const D=this.dependencies.agentRpcServer.rpcConnections[0];k.onHandleNoneRequest((e,t,...n)=>d.sendRpcRequest(D,t,n)),k.onHandleNoneNotification((e,t,...n)=>{D.sendNotification(t,...n)});const x=new c.WorkspaceAccessControlService(N);M.push(x);const O=new c.WorkspaceUserService(e=>k.closeSshSession(e));M.push(O);const F=new c.WorkspaceService(k,O,x,b,r.traceSource.withName("WorkspaceService"));M.push(F);const U=[];U.push(y.createDisposable(async()=>{F.fireConnectionStatusChanged(g.vsls.WorkspaceConnectionStatus.Disconnected,g.vsls.WorkspaceDisconnectedReason.SessionEnded),await b.deleteWorkspace(T.workspaceInfo.id)})),U.push(k),U.push(L),U.push(k.registerRpcServerProvider(p.createHybridRpcServerProvider(T.workspaceInfo,r.traceSource.withName("AzureRelayProvider"))));const j=await this.dependencies.hubConnectionServiceFactory.getOrCreate();await j.setEnabled(!0);const H=j.getOrCreateProxy(c.HubProxyType.RelayService);c.Settings.get("traceHubData")&&(H.traceHubData=!0),U.push(k.registerRpcServerProvider(m.createRelayHubProxyServerProvider(H,T.workspaceInfo.id,r.traceSource.withName("SignalRProvider"))));const B=await this.dependencies.authService().getCurrentUserAsync(),Y={id:B.id,email:null!==(n=B.emailAddress)&&void 0!==n?n:"",avatarUri:B.avatarUri,userName:B.userName,provider:B.providerName,isAnonymous:!1,isOwner:!0,isHost:!0,isOnlineUser:!1,clientCapabilities:{extensionReadOnlySupport:!0,clientReadOnlySupport:!0}};k.addUserProfile(Y,{session:N,connection:I[0]}),this.dependencies.hostSessionId.value=N;const W={id:T.workspaceInfo.id,name:T.workspaceInfo.name,ownerId:Y.id,conversationId:T.workspaceInfo.conversationId,sessionNumber:this.dependencies.hostSessionId(),accessControl:{defaultAccessControl:{isReadOnly:!1},userAccessControl:{}},connectionMode:g.vsls.ConnectionMode.Local,sessions:k.joinedProfiles,joinUri:T.workspaceInfo.joinLink};c.workspaceSessionInfoTracker.workspaceSessionInfo=W;const q=new c.AccessControlService(this.dependencies);this.dependencies.agentRpcServer.registerRpcService(q,q.serviceInfo);const V=new c.FileService(k,{},this.dependencies.pathManager(),this.dependencies.accessControlManager,r.traceSource.withName("FileService"),N);M.push(V),M.push(new c.HostSyncService({},c.SessionContext,k,r.traceSource.withName("HostSyncService")));const $=new o.ChatService(this.dependencies);M.push($),M.forEach(e=>{k.registerRpcService(e,e.serviceInfo,e.contextMethods)}),k.addRequestMethodWithProgress(g.vsls.FileService.name+".getTextSearchResultsWithProgress",(e,t,n)=>V.getTextSearchResultsWithProgressAsync(e,t,n)),k.addRequestMethodWithProgress(g.vsls.FileService.name+".readTextWithProgress",(e,t,n,i)=>V.readTextWithProgressAsync(e,t,n,i)),await this.dependencies.accessControlManager().init(),U.push(y.createDisposable(()=>this.dependencies.accessControlManager().dispose())),await v.initCoEditingContext(this.dependencies,!1),c.SessionContext.notJoining();const K=[];K.push(this.dependencies.coEditingCommands()),K.push(l.reviewsDependencies.hostCommentService()),K.push(l.reviewsDependencies.commentManager());const z=new l.HostSourceControlService(this.dependencies,this.dependencies.accessControlManager);K.push(z);const G=new l.HostCoauthorCommitMessageUpdater(this.dependencies,z);K.push(G),K.push({init:()=>u.lspServer.activateAsync(F,this.dependencies.pathManager(),this.dependencies.accessControlManager,c.SessionContext,k),dispose:()=>u.lspServer.dispose()}),K.push(this.dependencies.pathManager());const J=new _.HostNotebooksService(this.dependencies,this.dependencies.accessControlManager);K.push(J),await Promise.all(K.map(e=>e.init())),U.push(y.createDisposable(()=>Promise.all(K.map(e=>e.dispose())))),U.push(await S.default(this.dependencies)),w=y.createDisposablesSeries(r.traceSource,...U),await k.acceptConnections(),e&&e.access===a.Access.ReadOnly&&await this.dependencies.workspaceAccessControlManager().setReadOnly(!0),c.showInvitationLink(this.dependencies.workspaceAccessControlManager())}async onCancellationRequested(e,t){}};b=i([c.cancellationDecorator(),c.errorNotificationCommandDecorator("Starting collaboration session",c.TelemetryEventNames.SHARE_FAULT,!0,async(e,t,n)=>{}),c.telemetryCommandDecorator(c.TelemetryEventNames.SHARE_WORKSPACE,c.TelemetryEventNames.SHARE_FAULT,"Share",1,(e,t)=>{}),c.telemetryStatusCommandDecorator(),c.validationCommandDecorator(),c.sessionStateTransitionsCommandDecorator(c.SessionAction.AttemptSharing,c.SessionAction.SharingSuccess,c.SessionAction.SharingError),c.progressCommandDecorator(),c.authenticationCommandDecorator(E)],b);class C extends r.CommandBase{constructor(e){super(),this.dependencies=e}invoke(e,t){return c.ExtensionUtil.runWithProgress(async()=>{this.dependencies.agentRpcServer.clear(),await w.dispose(),c.sessionStateTracker.transition(c.SessionAction.EndSharing)},{title:"Ending Collaboration Session"})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1344);t.createHybridRpcServerProvider=i.createHybridRpcServerProvider},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(8)),r=n(179),o=n(1345),a=n(1346).relayedServer;t.createHybridRpcServerProvider=function(e,t){const n=new s.Emitter,i=new s.Emitter,c=new s.Emitter,l=r.SshHelpers.getRelayUri(e,"listen");return{name:"hybrid",onRpcStreamJoined:n.event,onClose:i.event,onError:c.event,acceptConnections(s){if(r.isNode()){const s=new a({server:l,token:e.relaySas,autoAcceptConnections:!0});s.on("connect",e=>{t.info(`Azure relay provider accepting connections on serverUrl:${l}`),n.fire(r.SshHelpers.createWebSocketStreamAdapter(e))}),s.on("close",(e,t,n)=>{i.fire(new Error(n))})}else{const e=new o.HybridConnectionsWebSocketServer({server:l},e=>r.SshHelpers.webSshStreamFactory(e).then(e=>n.fire(e)),t.createChild("HybridConnections"));e.on("error",e=>c.fire(e)),e.on("close",e=>i.fire(e))}return Promise.resolve()}}}},function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(24)),r=(e,t)=>void 0!==e[t]&&null!==e[t];class o extends s.EventEmitter{constructor(e,t,n){if(super(),this.callback=t,this.logger=n,e=Object.assign({server:null,token:null,verifyClient:null,handleProtocols:null,disableHixie:!1,clientTracking:!0,perMessageDeflate:!0,maxPayload:104857600,backlog:null},e),!r(e,"server"))throw new TypeError("'server' must be provided");this.listenUri=e.server,this.closeRequested=!1,this.options=e,this.clients=[],this.connectControlChannel()}close(e){var t;this.closeRequested=!0;let n=null;try{for(let e=0,t=this.clients.length;e<t;++e)this.clients[e].close();null===(t=this.controlChannel)||void 0===t||t.close()}catch(e){n=e}if(e)e(n);else if(n)throw n}connectControlChannel(){this.controlChannel=new WebSocket(this.listenUri),this.controlChannel.onerror=e=>{this.emit("error",e),this.closeRequested||this.connectControlChannel()},this.controlChannel.onopen=e=>{this.emit("listening"),this.logger.info(`Azure relay provider accepting connections on serverUrl:${this.options.server}`)},this.controlChannel.onclose=e=>{this.closeRequested?this.emit("close",this):this.connectControlChannel()},this.controlChannel.onmessage=e=>{const t=JSON.parse(e.data);r(t,"accept")&&this.accept(t)}}accept(e){this.logger.verbose(`accept -> message:${JSON.stringify(e)}`);const t=e.accept.address,n={headers:{}};for(let t=Object.keys(e.accept.connectHeaders),i=t.length;i;--i)n.headers[t[i-1].toLowerCase()]=e.accept.connectHeaders[t[i-1]];if(!n.headers["sec-websocket-key"])return void this.abortConnection(e,400,"Bad Request");const i=n.headers["sec-websocket-protocol"],s=this,r=e=>{try{const n=new WebSocket(t,e);n.onerror=e=>{const t=s.clients.indexOf(n);-1!==t&&s.clients.splice(t,1)},s.callback(n),s.options.clientTracking&&(s.clients.push(n),n.onclose=()=>{const e=s.clients.indexOf(n);-1!==e&&s.clients.splice(e,1)})}catch(e){this.logger.error("completeHybridUpgrade failed",e)}};r(void 0!==i?i.split(/, */)[0]:void 0)}abortConnection(e,t,n){const i=e.address+"&statusCode="+t+"&statusDescription="+encodeURIComponent(n);new WebSocket(i).onerror=e=>{this.emit("requestRejected",this)}}}t.HybridConnectionsWebSocketServer=o},function(e,t,n){"use strict";var i=n(28),s=n(1),r=n(32),o=e.exports=n(1348);o.createRelayToken=function(e,t,n,o){var a=r.parse(e);a.protocol="http",a.search=a.hash=a.port=null,a.pathname=a.pathname.replace("$hc/",""),e=r.format(a),o||(o=3600);var c=s().add(o,"seconds").unix(),l=encodeURIComponent(e)+"\n"+c,u=i.createHmac("sha256",n);u.update(l);var d=u.digest("base64");return"SharedAccessSignature sr="+encodeURIComponent(e)+"&sig="+encodeURIComponent(d)+"&se="+c+"&skn="+t},o.appendRelayToken=function(e,t,n,i){var s=o.createRelayToken(e,t,n,i),a=r.parse(e);return a.search=a.search+"&sb-hc-token="+encodeURIComponent(s),r.format(a)},o.createRelayBaseUri=function(e,t){return"wss://"+e+":443/$hc/"+t},o.createRelaySendUri=function(e,t,n,i){var s=o.createRelayBaseUri(e,t);return s=s+(-1==s.indexOf("?")?"?":"&")+"sb-hc-action=connect",null!=n&&(s=s+"&sb-hc-token="+encodeURIComponent(n)),null!=i&&(s=s+"&sb-hc-id="+encodeURIComponent(i)),s},o.createRelayListenUri=function(e,t,n,i){var s=o.createRelayBaseUri(e,t);return s=s+(-1==s.indexOf("?")?"?":"&")+"sb-hc-action=listen",null!=n&&(s=s+"&sb-hc-token="+encodeURIComponent(n)),null!=i&&(s=s+"&sb-hc-id="+encodeURIComponent(i)),s}},function(e,t,n){var i={"./af":565,"./af.js":565,"./ar":566,"./ar-dz":567,"./ar-dz.js":567,"./ar-kw":568,"./ar-kw.js":568,"./ar-ly":569,"./ar-ly.js":569,"./ar-ma":570,"./ar-ma.js":570,"./ar-sa":571,"./ar-sa.js":571,"./ar-tn":572,"./ar-tn.js":572,"./ar.js":566,"./az":573,"./az.js":573,"./be":574,"./be.js":574,"./bg":575,"./bg.js":575,"./bm":576,"./bm.js":576,"./bn":577,"./bn.js":577,"./bo":578,"./bo.js":578,"./br":579,"./br.js":579,"./bs":580,"./bs.js":580,"./ca":581,"./ca.js":581,"./cs":582,"./cs.js":582,"./cv":583,"./cv.js":583,"./cy":584,"./cy.js":584,"./da":585,"./da.js":585,"./de":586,"./de-at":587,"./de-at.js":587,"./de-ch":588,"./de-ch.js":588,"./de.js":586,"./dv":589,"./dv.js":589,"./el":590,"./el.js":590,"./en-au":591,"./en-au.js":591,"./en-ca":592,"./en-ca.js":592,"./en-gb":593,"./en-gb.js":593,"./en-ie":594,"./en-ie.js":594,"./en-il":595,"./en-il.js":595,"./en-in":596,"./en-in.js":596,"./en-nz":597,"./en-nz.js":597,"./en-sg":598,"./en-sg.js":598,"./eo":599,"./eo.js":599,"./es":600,"./es-do":601,"./es-do.js":601,"./es-us":602,"./es-us.js":602,"./es.js":600,"./et":603,"./et.js":603,"./eu":604,"./eu.js":604,"./fa":605,"./fa.js":605,"./fi":606,"./fi.js":606,"./fil":607,"./fil.js":607,"./fo":608,"./fo.js":608,"./fr":609,"./fr-ca":610,"./fr-ca.js":610,"./fr-ch":611,"./fr-ch.js":611,"./fr.js":609,"./fy":612,"./fy.js":612,"./ga":613,"./ga.js":613,"./gd":614,"./gd.js":614,"./gl":615,"./gl.js":615,"./gom-deva":616,"./gom-deva.js":616,"./gom-latn":617,"./gom-latn.js":617,"./gu":618,"./gu.js":618,"./he":619,"./he.js":619,"./hi":620,"./hi.js":620,"./hr":621,"./hr.js":621,"./hu":622,"./hu.js":622,"./hy-am":623,"./hy-am.js":623,"./id":624,"./id.js":624,"./is":625,"./is.js":625,"./it":626,"./it-ch":627,"./it-ch.js":627,"./it.js":626,"./ja":628,"./ja.js":628,"./jv":629,"./jv.js":629,"./ka":630,"./ka.js":630,"./kk":631,"./kk.js":631,"./km":632,"./km.js":632,"./kn":633,"./kn.js":633,"./ko":634,"./ko.js":634,"./ku":635,"./ku.js":635,"./ky":636,"./ky.js":636,"./lb":637,"./lb.js":637,"./lo":638,"./lo.js":638,"./lt":639,"./lt.js":639,"./lv":640,"./lv.js":640,"./me":641,"./me.js":641,"./mi":642,"./mi.js":642,"./mk":643,"./mk.js":643,"./ml":644,"./ml.js":644,"./mn":645,"./mn.js":645,"./mr":646,"./mr.js":646,"./ms":647,"./ms-my":648,"./ms-my.js":648,"./ms.js":647,"./mt":649,"./mt.js":649,"./my":650,"./my.js":650,"./nb":651,"./nb.js":651,"./ne":652,"./ne.js":652,"./nl":653,"./nl-be":654,"./nl-be.js":654,"./nl.js":653,"./nn":655,"./nn.js":655,"./oc-lnc":656,"./oc-lnc.js":656,"./pa-in":657,"./pa-in.js":657,"./pl":658,"./pl.js":658,"./pt":659,"./pt-br":660,"./pt-br.js":660,"./pt.js":659,"./ro":661,"./ro.js":661,"./ru":662,"./ru.js":662,"./sd":663,"./sd.js":663,"./se":664,"./se.js":664,"./si":665,"./si.js":665,"./sk":666,"./sk.js":666,"./sl":667,"./sl.js":667,"./sq":668,"./sq.js":668,"./sr":669,"./sr-cyrl":670,"./sr-cyrl.js":670,"./sr.js":669,"./ss":671,"./ss.js":671,"./sv":672,"./sv.js":672,"./sw":673,"./sw.js":673,"./ta":674,"./ta.js":674,"./te":675,"./te.js":675,"./tet":676,"./tet.js":676,"./tg":677,"./tg.js":677,"./th":678,"./th.js":678,"./tk":679,"./tk.js":679,"./tl-ph":680,"./tl-ph.js":680,"./tlh":681,"./tlh.js":681,"./tr":682,"./tr.js":682,"./tzl":683,"./tzl.js":683,"./tzm":684,"./tzm-latn":685,"./tzm-latn.js":685,"./tzm.js":684,"./ug-cn":686,"./ug-cn.js":686,"./uk":687,"./uk.js":687,"./ur":688,"./ur.js":688,"./uz":689,"./uz-latn":690,"./uz-latn.js":690,"./uz.js":689,"./vi":691,"./vi.js":691,"./x-pseudo":692,"./x-pseudo.js":692,"./yo":693,"./yo.js":693,"./zh-cn":694,"./zh-cn.js":694,"./zh-hk":695,"./zh-hk.js":695,"./zh-mo":696,"./zh-mo.js":696,"./zh-tw":697,"./zh-tw.js":697};function s(e){var t=r(e);return n(t)}function r(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}s.keys=function(){return Object.keys(i)},s.resolve=r,e.exports=s,s.id=1347},function(e,t,n){var i=n(193);e.exports={server:i.server,relayedServer:n(1351),client:i.client,router:i.router,frame:i.frame,request:i.request,relayedRequest:n(699),connection:i.connection,w3cwebsocket:i.w3cwebsocket,deprecation:i.deprecation,version:n(1355)}},function(e,t,n){e.exports=n(1350).version},function(e){e.exports=JSON.parse('{"name":"websocket","description":"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.","keywords":["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],"author":"Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)","contributors":["Iaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],"version":"1.0.31","repository":{"type":"git","url":"https://github.com/theturtle32/WebSocket-Node.git"},"homepage":"https://github.com/theturtle32/WebSocket-Node","engines":{"node":">=0.10.0"},"dependencies":{"debug":"^2.2.0","es5-ext":"^0.10.50","nan":"^2.14.0","typedarray-to-buffer":"^3.1.5","yaeti":"^0.0.6"},"devDependencies":{"buffer-equal":"^1.0.0","faucet":"^0.0.1","gulp":"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1","jshint":"^2.0.0","tape":"^4.9.1"},"config":{"verbose":false},"scripts":{"install":"(node-gyp rebuild 2> builderror.log) || (exit 0)","test":"faucet test/unit","gulp":"gulp"},"main":"index","directories":{"lib":"./lib"},"browser":"lib/browser.js","license":"Apache-2.0"}')},function(e,t,n){(function(t){const i=n(698).extend,s=n(698),r=n(59),o=n(24).EventEmitter,a=n(193).client,c=n(699),l=(n(223),n(1));var u=function(e,t){return void 0!==e[t]&&null!==e[t]},d=function(e){o.call(this),this.closeRequested=!1,this._handlers={requestAccepted:this.handleRequestAccepted.bind(this),requestResolved:this.handleRequestResolved.bind(this)},this.pendingRequests=[],this.connections=[],e&&this.open(e)};r.inherits(d,o),d.prototype.open=function(e){if(this.config={server:null,token:null,id:null,keepalive:!0,keepaliveInterval:2e4,dropConnectionOnKeepaliveTimeout:!0,keepaliveGracePeriod:1e4,useNativeKeepalive:!1,assembleFragments:!0,autoAcceptConnections:!1,ignoreXForwardedFor:!1,disableNagleAlgorithm:!0,closeTimeout:5e3},i(this.config,e),!this.config.server)throw new Error("You must specify a hybrid connections server address on which to open the WebSocket server.");this.listenUri=e.server,u(e,"id")&&(this.listenUri=listenUri+"&id="+e.id),function e(t){var n=null,i=null;if(null!=t.config.token){var r=null;"function"==typeof t.config.token?(i=new l.duration(1,"hours"),r=t.config.token()):r=t.config.token,n={ServiceBusAuthorization:r}}var o=null,d=new a;d.connect(t.listenUri,null,null,n),d.on("connect",(function(n){t.controlChannel=n,t.controlChannel.on("error",(function(n){t.emit("error",n),clearInterval(o),closeRequested||e(t)})),t.controlChannel.on("close",(function(n){clearInterval(o),closeRequested?(t.controlChannel=null,t.emit("close",t)):e(t)})),t.controlChannel.on("message",(function(e){if("utf8"===e.type)try{!function(e,t){u(t,"accept")&&function(e,t){var n=new c(t.accept.address,t.accept.id,t.accept.connectHeaders,e.config);try{n.readHandshake()}catch(e){return n.reject(e.httpCode?e.httpCode:400,e.message,e.headers),void debug("Invalid handshake: %s",e.message)}e.pendingRequests.push(n),n.once("requestAccepted",e._handlers.requestAccepted),n.once("requestResolved",e._handlers.requestResolved),!e.config.autoAcceptConnections&&s.eventEmitterListenerCount(e,"request")>0?e.emit("request",n):e.config.autoAcceptConnections?n.accept(n.requestedProtocols[0],n.origin):n.reject(404,"No handler is configured to accept the connection.")}(e,t)}(t,JSON.parse(e.utf8Data))}catch(e){}}))})),d.on("connectFailed",(function(e){console.log(e)})),i&&(o=setInterval((function(){if(!t.closeRequested){var e=t.config.token();console.log("Renewing Token: "+e);var n={renewToken:{token:e}};t.controlChannel.send(JSON.stringify(n),(function(e){e&&console.log("renewToken error: "+e)}))}}),i.asMilliseconds()))}(this)},d.prototype.close=function(){this.closeRequested=!0,this.controlChannel&&this.controlChannel.close(),this.closeAllConnections()},d.prototype.closeAllConnections=function(){this.connections.forEach((function(e){e.close()}))},d.prototype.broadcast=function(e){t.isBuffer(e)?this.broadcastBytes(e):"function"==typeof e.toString&&this.broadcastUTF(e)},d.prototype.broadcastUTF=function(e){this.connections.forEach((function(t){t.sendUTF(e)}))},d.prototype.broadcastBytes=function(e){this.connections.forEach((function(t){t.sendBytes(e)}))},d.prototype.shutDown=function(){this.closeAllConnections()},d.prototype.handleRequestAccepted=function(e){var t=this;e.once("close",(function(n,i){t.handleConnectionClose(e,n,i)})),this.connections.push(e),this.emit("connect",e)},d.prototype.handleRequestResolved=function(e){var t=this.pendingRequests.indexOf(e);-1!==t&&this.pendingRequests.splice(t,1)},d.prototype.handleConnectionClose=function(e,t){console.log(t)},e.exports=d}).call(this,n(3).Buffer)},function(e,t,n){(function(i){function s(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==i&&"env"in i&&(e=i.env.DEBUG),e}(t=e.exports=n(1353)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var i="color: "+this.color;e.splice(1,0,i,"color: inherit");var s=0,r=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(s++,"%c"===e&&(r=s))})),e.splice(r,0,i)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=s,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(s())}).call(this,n(11))},function(e,t,n){var i;function s(e){function n(){if(n.enabled){var e=n,s=+new Date,r=s-(i||s);e.diff=r,e.prev=i,e.curr=s,i=s;for(var o=new Array(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];o[0]=t.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var c=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(function(n,i){if("%%"===n)return n;c++;var s=t.formatters[i];if("function"==typeof s){var r=o[c];n=s.call(e,r),o.splice(c,1),c--}return n})),t.formatArgs.call(e,o);var l=n.log||t.log||console.log.bind(console);l.apply(e,o)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var n,i=0;for(n in e)i=(i<<5)-i+e.charCodeAt(n),i|=0;return t.colors[Math.abs(i)%t.colors.length]}(e),"function"==typeof t.init&&t.init(n),n}(t=e.exports=s.debug=s.default=s).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length,s=0;s<i;s++)n[s]&&("-"===(e=n[s].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var n,i;for(n=0,i=t.skips.length;n<i;n++)if(t.skips[n].test(e))return!1;for(n=0,i=t.names.length;n<i;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(1354),t.names=[],t.skips=[],t.formatters={}},function(e,t){var n=1e3,i=6e4,s=60*i,r=24*s;function o(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var a,c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var o=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"days":case"day":case"d":return o*r;case"hours":case"hour":case"hrs":case"hr":case"h":return o*s;case"minutes":case"minute":case"mins":case"min":case"m":return o*i;case"seconds":case"second":case"secs":case"sec":case"s":return o*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(e);if("number"===c&&!1===isNaN(e))return t.long?o(a=e,r,"day")||o(a,s,"hour")||o(a,i,"minute")||o(a,n,"second")||a+" ms":function(e){if(e>=r)return Math.round(e/r)+"d";if(e>=s)return Math.round(e/s)+"h";if(e>=i)return Math.round(e/i)+"m";if(e>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){e.exports=n(1356).version},function(e){e.exports=JSON.parse('{"author":"Microsoft Corporation","name":"hyco-websocket","description":"","version":"1.0.5","license":"MIT","main":"index.js","homepage":"https://docs.microsoft.com/en-us/azure/service-bus-relay/","keywords":["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],"repository":{"type":"git","url":"https://github.com/Azure/azure-relay-node.git"},"engines":{"node":">=0.8.0"},"dependencies":{"websocket":"latest","crypto":"latest","moment":"latest","url":"latest","events":"latest","querystring":"latest"},"config":{"verbose":false},"directories":{"lib":"./lib"}}')},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);t.queries=((()=>{const e=i.workspace.workspaceFile;if(e&&e.query)return e.query})()||"").split("&"),t.queryParameter=e=>{const n=`${e}=`,i=t.queries.find(e=>e.startsWith(n));return i?i.substring(n.length):void 0},t.optionQuery=e=>"true"===t.queryParameter(e)},function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"BrowserInfo",(function(){return s})),n.d(t,"NodeInfo",(function(){return r})),n.d(t,"SearchBotDeviceInfo",(function(){return o})),n.d(t,"BotInfo",(function(){return a})),n.d(t,"detect",(function(){return d})),n.d(t,"browserName",(function(){return f})),n.d(t,"parseUserAgent",(function(){return p})),n.d(t,"detectOS",(function(){return m})),n.d(t,"getNodeVersion",(function(){return g}));var i=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),s=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,a=r.length;o<a;o++,s++)i[s]=r[o];return i},s=function(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"},r=function(t){this.version=t,this.type="node",this.name="node",this.os=e.platform},o=function(e,t,n,i){this.name=e,this.version=t,this.os=n,this.bot=i,this.type="bot-device"},a=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},c=/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,l=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],u=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function d(e){return e?p(e):"undefined"!=typeof navigator?p(navigator.userAgent):g()}function h(e){return""!==e&&l.reduce((function(t,n){var i=n[0],s=n[1];if(t)return t;var r=s.exec(e);return!!r&&[i,r]}),!1)}function f(e){var t=h(e);return t?t[0]:null}function p(e){var t=h(e);if(!t)return null;var n=t[0],r=t[1];if("searchbot"===n)return new a;var l=r[1]&&r[1].split(/[._]/).slice(0,3);l?l.length<3&&(l=i(l,function(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}(3-l.length))):l=[];var u=l.join("."),d=m(e),f=c.exec(e);return f&&f[1]?new o(n,u,d,f[1]):new s(n,l.join("."),d)}function m(e){for(var t=0,n=u.length;t<n;t++){var i=u[t],s=i[0];if(i[1].exec(e))return s}return null}function g(){return void 0!==e&&e.version?new r(e.version.slice(1)):null}}.call(this,n(11))},function(e,t){e.exports=require("keytar")},function(e,t,n){"use strict";n.r(t),n.d(t,"VERSION",(function(){return u})),n.d(t,"MessagePackHubProtocol",(function(){return l}));var i=n(3),s=n(89),r=n(17),o=function(){function e(){}return e.write=function(e){var t=e.byteLength||e.length,n=[];do{var i=127&t;(t>>=7)>0&&(i|=128),n.push(i)}while(t>0);t=e.byteLength||e.length;var s=new Uint8Array(n.length+t);return s.set(n,0),s.set(e,n.length),s.buffer},e.parse=function(e){for(var t=[],n=new Uint8Array(e),i=[0,7,14,21,28],s=0;s<e.byteLength;){var r=0,o=0,a=void 0;do{o|=(127&(a=n[s+r]))<<i[r],r++}while(r<Math.min(5,e.byteLength-s)&&0!=(128&a));if(0!=(128&a)&&r<5)throw new Error("Cannot read message size.");if(5===r&&a>7)throw new Error("Messages bigger than 2GB are not supported.");if(!(n.byteLength>=s+r+o))throw new Error("Incomplete message.");t.push(n.slice?n.slice(s+r,s+r+o):n.subarray(s+r,s+r+o)),s=s+r+o}return t},e}();var a=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},c=new Uint8Array([145,r.MessageType.Ping]),l=function(){function e(e){this.name="messagepack",this.version=1,this.transferFormat=r.TransferFormat.Binary,this.errorResult=1,this.voidResult=2,this.nonVoidResult=3,e&&(this.messagePackOptions=a({},e,{compatibilityMode:!1}))}return e.prototype.parseMessages=function(e,t){if(!(e instanceof i.Buffer||(n=e,n&&"undefined"!=typeof ArrayBuffer&&(n instanceof ArrayBuffer||n.constructor&&"ArrayBuffer"===n.constructor.name))))throw new Error("Invalid input for MessagePack hub protocol. Expected an ArrayBuffer or Buffer.");var n;null===t&&(t=r.NullLogger.instance);for(var s=[],a=0,c=o.parse(e);a<c.length;a++){var l=c[a],u=this.parseMessage(l,t);u&&s.push(u)}return s},e.prototype.writeMessage=function(e){switch(e.type){case r.MessageType.Invocation:return this.writeInvocation(e);case r.MessageType.StreamInvocation:return this.writeStreamInvocation(e);case r.MessageType.StreamItem:return this.writeStreamItem(e);case r.MessageType.Completion:return this.writeCompletion(e);case r.MessageType.Ping:return o.write(c);case r.MessageType.CancelInvocation:return this.writeCancelInvocation(e);default:throw new Error("Invalid message type.")}},e.prototype.parseMessage=function(e,t){if(0===e.length)throw new Error("Invalid payload.");var n=s(this.messagePackOptions).decode(i.Buffer.from(e));if(0===n.length||!(n instanceof Array))throw new Error("Invalid payload.");var o=n[0];switch(o){case r.MessageType.Invocation:return this.createInvocationMessage(this.readHeaders(n),n);case r.MessageType.StreamItem:return this.createStreamItemMessage(this.readHeaders(n),n);case r.MessageType.Completion:return this.createCompletionMessage(this.readHeaders(n),n);case r.MessageType.Ping:return this.createPingMessage(n);case r.MessageType.Close:return this.createCloseMessage(n);default:return t.log(r.LogLevel.Information,"Unknown message type '"+o+"' ignored."),null}},e.prototype.createCloseMessage=function(e){if(e.length<2)throw new Error("Invalid payload for Close message.");return{allowReconnect:e.length>=3?e[2]:void 0,error:e[1],type:r.MessageType.Close}},e.prototype.createPingMessage=function(e){if(e.length<1)throw new Error("Invalid payload for Ping message.");return{type:r.MessageType.Ping}},e.prototype.createInvocationMessage=function(e,t){if(t.length<5)throw new Error("Invalid payload for Invocation message.");var n=t[2];return n?{arguments:t[4],headers:e,invocationId:n,streamIds:[],target:t[3],type:r.MessageType.Invocation}:{arguments:t[4],headers:e,streamIds:[],target:t[3],type:r.MessageType.Invocation}},e.prototype.createStreamItemMessage=function(e,t){if(t.length<4)throw new Error("Invalid payload for StreamItem message.");return{headers:e,invocationId:t[2],item:t[3],type:r.MessageType.StreamItem}},e.prototype.createCompletionMessage=function(e,t){if(t.length<4)throw new Error("Invalid payload for Completion message.");var n,i,s=t[3];if(s!==this.voidResult&&t.length<5)throw new Error("Invalid payload for Completion message.");switch(s){case this.errorResult:n=t[4];break;case this.nonVoidResult:i=t[4]}return{error:n,headers:e,invocationId:t[2],result:i,type:r.MessageType.Completion}},e.prototype.writeInvocation=function(e){var t,n=s(this.messagePackOptions);return t=e.streamIds?n.encode([r.MessageType.Invocation,e.headers||{},e.invocationId||null,e.target,e.arguments,e.streamIds]):n.encode([r.MessageType.Invocation,e.headers||{},e.invocationId||null,e.target,e.arguments]),o.write(t.slice())},e.prototype.writeStreamInvocation=function(e){var t,n=s(this.messagePackOptions);return t=e.streamIds?n.encode([r.MessageType.StreamInvocation,e.headers||{},e.invocationId,e.target,e.arguments,e.streamIds]):n.encode([r.MessageType.StreamInvocation,e.headers||{},e.invocationId,e.target,e.arguments]),o.write(t.slice())},e.prototype.writeStreamItem=function(e){var t=s(this.messagePackOptions).encode([r.MessageType.StreamItem,e.headers||{},e.invocationId,e.item]);return o.write(t.slice())},e.prototype.writeCompletion=function(e){var t,n=s(this.messagePackOptions),i=e.error?this.errorResult:e.result?this.nonVoidResult:this.voidResult;switch(i){case this.errorResult:t=n.encode([r.MessageType.Completion,e.headers||{},e.invocationId,i,e.error]);break;case this.voidResult:t=n.encode([r.MessageType.Completion,e.headers||{},e.invocationId,i]);break;case this.nonVoidResult:t=n.encode([r.MessageType.Completion,e.headers||{},e.invocationId,i,e.result])}return o.write(t.slice())},e.prototype.writeCancelInvocation=function(e){var t=s(this.messagePackOptions).encode([r.MessageType.CancelInvocation,e.headers||{},e.invocationId]);return o.write(t.slice())},e.prototype.readHeaders=function(e){var t=e[1];if("object"!=typeof t)throw new Error("Invalid headers.");return t},e}(),u="5.0.8"}]));
//# sourceMappingURL=extension.js.map