{"version":3,"sources":["webpack://gitlens/./node_modules/dayjs/dayjs.min.js","webpack://gitlens/./node_modules/dayjs/plugin/advancedFormat.js","webpack://gitlens/./node_modules/dayjs/plugin/relativeTime.js","webpack://gitlens/./node_modules/dayjs/plugin/updateLocale.js","webpack://gitlens/./src/api/actionRunners.ts","webpack://gitlens/./src/avatars.ts","webpack://gitlens/./src/commands/git/branch.ts","webpack://gitlens/./src/commands/git/cherry-pick.ts","webpack://gitlens/./src/commands/git/coauthors.ts","webpack://gitlens/./src/commands/git/fetch.ts","webpack://gitlens/./src/commands/git/log.ts","webpack://gitlens/./src/commands/git/merge.ts","webpack://gitlens/./src/commands/git/pull.ts","webpack://gitlens/./src/commands/git/push.ts","webpack://gitlens/./src/commands/git/rebase.ts","webpack://gitlens/./src/commands/git/reset.ts","webpack://gitlens/./src/commands/git/revert.ts","webpack://gitlens/./src/commands/git/search.ts","webpack://gitlens/./src/commands/git/show.ts","webpack://gitlens/./src/commands/git/stash.ts","webpack://gitlens/./src/commands/git/status.ts","webpack://gitlens/./src/commands/git/switch.ts","webpack://gitlens/./src/commands/git/tag.ts","webpack://gitlens/./src/commands/gitCommands.ts","webpack://gitlens/./src/commands/addAuthors.ts","webpack://gitlens/./src/commands/browseRepoAtRevision.ts","webpack://gitlens/./src/commands/closeUnchangedFiles.ts","webpack://gitlens/./src/commands/closeView.ts","webpack://gitlens/./src/commands/compareWith.ts","webpack://gitlens/./src/commands/copyCurrentBranch.ts","webpack://gitlens/./src/commands/copyMessageToClipboard.ts","webpack://gitlens/./src/commands/copyShaToClipboard.ts","webpack://gitlens/./src/commands/createPullRequestOnRemote.ts","webpack://gitlens/./src/commands/openDirectoryCompare.ts","webpack://gitlens/./src/commands/diffLineWithPrevious.ts","webpack://gitlens/./src/commands/diffLineWithWorking.ts","webpack://gitlens/./src/commands/diffWith.ts","webpack://gitlens/./src/commands/diffWithNext.ts","webpack://gitlens/./src/commands/diffWithPrevious.ts","webpack://gitlens/./src/commands/diffWithRevision.ts","webpack://gitlens/./src/commands/diffWithRevisionFrom.ts","webpack://gitlens/./src/commands/diffWithWorking.ts","webpack://gitlens/./src/commands/externalDiff.ts","webpack://gitlens/./src/commands/inviteToLiveShare.ts","webpack://gitlens/./src/commands/logging.ts","webpack://gitlens/./src/commands/openAssociatedPullRequestOnRemote.ts","webpack://gitlens/./src/commands/openBranchesOnRemote.ts","webpack://gitlens/./src/commands/openBranchOnRemote.ts","webpack://gitlens/./src/commands/openChangedFiles.ts","webpack://gitlens/./src/commands/openCommitOnRemote.ts","webpack://gitlens/./src/commands/openComparisonOnRemote.ts","webpack://gitlens/./src/commands/openFileFromRemote.ts","webpack://gitlens/./src/commands/openFileOnRemote.ts","webpack://gitlens/./src/commands/openFileAtRevision.ts","webpack://gitlens/./src/commands/openFileAtRevisionFrom.ts","webpack://gitlens/./src/commands/openOnRemote.ts","webpack://gitlens/./src/commands/openPullRequestOnRemote.ts","webpack://gitlens/./src/commands/openRepoOnRemote.ts","webpack://gitlens/./src/commands/openRevisionFile.ts","webpack://gitlens/./src/commands/openWorkingFile.ts","webpack://gitlens/./src/commands/rebaseEditor.ts","webpack://gitlens/./src/commands/refreshHover.ts","webpack://gitlens/./src/commands/remoteProviders.ts","webpack://gitlens/./src/commands/repositories.ts","webpack://gitlens/./src/commands/resetAvatarCache.ts","webpack://gitlens/./src/commands/resetSuppressedWarnings.ts","webpack://gitlens/./src/commands/setViewsLayout.ts","webpack://gitlens/./src/commands/searchCommits.ts","webpack://gitlens/./src/commands/showCommitsInView.ts","webpack://gitlens/./src/commands/showLastQuickPick.ts","webpack://gitlens/./src/commands/showQuickBranchHistory.ts","webpack://gitlens/./src/commands/showQuickCommit.ts","webpack://gitlens/./src/commands/showQuickCommitFile.ts","webpack://gitlens/./src/commands/showQuickFileHistory.ts","webpack://gitlens/./src/commands/showQuickRepoStatus.ts","webpack://gitlens/./src/commands/showQuickStashList.ts","webpack://gitlens/./src/commands/showView.ts","webpack://gitlens/./src/commands/stashApply.ts","webpack://gitlens/./src/commands/stashSave.ts","webpack://gitlens/./src/commands/switchMode.ts","webpack://gitlens/./src/commands/toggleCodeLens.ts","webpack://gitlens/./src/commands/toggleFileAnnotations.ts","webpack://gitlens/./src/commands/toggleLineBlame.ts","webpack://gitlens/./src/commands.ts","webpack://gitlens/./src/commands/common.ts","webpack://gitlens/./src/commands/gitCommands.actions.ts","webpack://gitlens/./src/commands/quickCommand.buttons.ts","webpack://gitlens/./src/commands/quickCommand.steps.ts","webpack://gitlens/./src/commands/quickCommand.ts","webpack://gitlens/./src/comparers.ts","webpack://gitlens/./src/config.ts","webpack://gitlens/./src/configuration.ts","webpack://gitlens/./src/constants.ts","webpack://gitlens/./src/annotations/autolinks.ts","webpack://gitlens/./src/annotations/annotationProvider.ts","webpack://gitlens/./src/webviews/apps/shared/colors.ts","webpack://gitlens/./src/annotations/annotations.ts","webpack://gitlens/./src/hovers/hovers.ts","webpack://gitlens/./src/annotations/blameAnnotationProvider.ts","webpack://gitlens/./src/annotations/gutterBlameAnnotationProvider.ts","webpack://gitlens/./src/annotations/gutterChangesAnnotationProvider.ts","webpack://gitlens/./src/annotations/gutterHeatmapBlameAnnotationProvider.ts","webpack://gitlens/./src/annotations/fileAnnotationController.ts","webpack://gitlens/./src/annotations/lineAnnotationController.ts","webpack://gitlens/./src/codelens/codeLensProvider.ts","webpack://gitlens/./src/codelens/codeLensController.ts","webpack://gitlens/./src/hovers/lineHoverController.ts","webpack://gitlens/./src/keyboard.ts","webpack://gitlens/./src/statusbar/statusBarController.ts","webpack://gitlens/./src/terminal/linkProvider.ts","webpack://gitlens/./src/trackers/lineTracker.ts","webpack://gitlens/./src/trackers/gitLineTracker.ts","webpack://gitlens/./src/views/branchesView.ts","webpack://gitlens/./src/views/commitsView.ts","webpack://gitlens/./src/views/contributorsView.ts","webpack://gitlens/./src/views/lineHistoryView.ts","webpack://gitlens/./src/views/searchAndCompareView.ts","webpack://gitlens/./src/views/stashesView.ts","webpack://gitlens/./src/views/viewCommands.ts","webpack://gitlens/./src/views/viewDecorationProvider.ts","webpack://gitlens/./src/webviews/protocol.ts","webpack://gitlens/./src/webviews/rebaseEditor.ts","webpack://gitlens/./src/webviews/webviewBase.ts","webpack://gitlens/./src/webviews/settingsWebview.ts","webpack://gitlens/./src/webviews/welcomeWebview.ts","webpack://gitlens/./src/container.ts","webpack://gitlens/./src/emojis.ts","webpack://gitlens/./src/api/api.ts","webpack://gitlens/./src/partners.ts","webpack://gitlens/./src/extension.ts","webpack://gitlens/./src/git/formatters/formatter.ts","webpack://gitlens/./src/git/formatters/commitFormatter.ts","webpack://gitlens/./src/git/formatters/statusFormatter.ts","webpack://gitlens/./src/git/fsProvider.ts","webpack://gitlens/./src/git/git.ts","webpack://gitlens/external node-commonjs \"os\"","webpack://gitlens/./src/git/gitService.ts","webpack://gitlens/./src/git/gitUri.ts","webpack://gitlens/./src/git/locator.ts","webpack://gitlens/./src/git/models/blameCommit.ts","webpack://gitlens/./src/git/models/branch.ts","webpack://gitlens/./src/git/models/commit.ts","webpack://gitlens/./src/git/models/contributor.ts","webpack://gitlens/./src/git/models/diff.ts","webpack://gitlens/./src/git/models/file.ts","webpack://gitlens/./src/git/models/logCommit.ts","webpack://gitlens/./src/git/models/models.ts","webpack://gitlens/./src/git/models/pullRequest.ts","webpack://gitlens/./src/git/models/reflog.ts","webpack://gitlens/./src/git/models/remote.ts","webpack://gitlens/./src/git/models/repository.ts","webpack://gitlens/./src/git/models/stashCommit.ts","webpack://gitlens/./src/git/models/status.ts","webpack://gitlens/./src/git/models/tag.ts","webpack://gitlens/./src/git/parsers/diffParser.ts","webpack://gitlens/./src/git/parsers/blameParser.ts","webpack://gitlens/./src/git/parsers/branchParser.ts","webpack://gitlens/./src/git/parsers/logParser.ts","webpack://gitlens/./src/git/parsers/reflogParser.ts","webpack://gitlens/./src/git/parsers/remoteParser.ts","webpack://gitlens/./src/git/parsers/shortlogParser.ts","webpack://gitlens/./src/git/parsers/stashParser.ts","webpack://gitlens/./src/git/parsers/statusParser.ts","webpack://gitlens/./src/git/parsers/tagParser.ts","webpack://gitlens/./src/git/parsers/treeParser.ts","webpack://gitlens/./src/git/remotes/azure-devops.ts","webpack://gitlens/./src/git/remotes/bitbucket.ts","webpack://gitlens/./src/git/remotes/bitbucket-server.ts","webpack://gitlens/./src/git/remotes/custom.ts","webpack://gitlens/./src/git/remotes/gitea.ts","webpack://gitlens/./src/git/remotes/github.ts","webpack://gitlens/./src/git/remotes/gitlab.ts","webpack://gitlens/./src/git/remotes/factory.ts","webpack://gitlens/./src/git/remotes/provider.ts","webpack://gitlens/./src/git/search.ts","webpack://gitlens/external node-commonjs \"child_process\"","webpack://gitlens/./src/git/shell.ts","webpack://gitlens/./node_modules/is-plain-object/dist/is-plain-object.mjs","webpack://gitlens/./node_modules/@octokit/endpoint/dist-web/index.js","webpack://gitlens/external node-commonjs \"http\"","webpack://gitlens/external node-commonjs \"url\"","webpack://gitlens/external node-commonjs \"https\"","webpack://gitlens/external node-commonjs \"zlib\"","webpack://gitlens/./node_modules/node-fetch/lib/index.mjs","webpack://gitlens/./node_modules/deprecation/dist-web/index.js","webpack://gitlens/./node_modules/@octokit/request-error/dist-web/index.js","webpack://gitlens/./node_modules/@octokit/request/dist-web/index.js","webpack://gitlens/./node_modules/@octokit/graphql/dist-web/index.js","webpack://gitlens/./src/github/github.ts","webpack://gitlens/./src/logger.ts","webpack://gitlens/./src/messages.ts","webpack://gitlens/./src/quickpicks/quickPicksItems.ts","webpack://gitlens/./src/quickpicks/gitQuickPickItems.ts","webpack://gitlens/./src/quickpicks/commitQuickPickItems.ts","webpack://gitlens/./src/quickpicks/commitPicker.ts","webpack://gitlens/./src/quickpicks/modePicker.ts","webpack://gitlens/./src/quickpicks/referencePicker.ts","webpack://gitlens/./src/quickpicks/remoteProviderPicker.ts","webpack://gitlens/./src/quickpicks.ts","webpack://gitlens/./src/quickpicks/repositoryPicker.ts","webpack://gitlens/./node_modules/lodash-es/_baseFindIndex.js","webpack://gitlens/./node_modules/lodash-es/_listCacheClear.js","webpack://gitlens/./node_modules/lodash-es/eq.js","webpack://gitlens/./node_modules/lodash-es/_assocIndexOf.js","webpack://gitlens/./node_modules/lodash-es/_listCacheDelete.js","webpack://gitlens/./node_modules/lodash-es/_listCacheGet.js","webpack://gitlens/./node_modules/lodash-es/_listCacheHas.js","webpack://gitlens/./node_modules/lodash-es/_listCacheSet.js","webpack://gitlens/./node_modules/lodash-es/_ListCache.js","webpack://gitlens/./node_modules/lodash-es/_stackClear.js","webpack://gitlens/./node_modules/lodash-es/_stackDelete.js","webpack://gitlens/./node_modules/lodash-es/_stackGet.js","webpack://gitlens/./node_modules/lodash-es/_stackHas.js","webpack://gitlens/./node_modules/lodash-es/_freeGlobal.js","webpack://gitlens/./node_modules/lodash-es/_root.js","webpack://gitlens/./node_modules/lodash-es/_Symbol.js","webpack://gitlens/./node_modules/lodash-es/_getRawTag.js","webpack://gitlens/./node_modules/lodash-es/_objectToString.js","webpack://gitlens/./node_modules/lodash-es/_baseGetTag.js","webpack://gitlens/./node_modules/lodash-es/isObject.js","webpack://gitlens/./node_modules/lodash-es/isFunction.js","webpack://gitlens/./node_modules/lodash-es/_coreJsData.js","webpack://gitlens/./node_modules/lodash-es/_isMasked.js","webpack://gitlens/./node_modules/lodash-es/_toSource.js","webpack://gitlens/./node_modules/lodash-es/_baseIsNative.js","webpack://gitlens/./node_modules/lodash-es/_getValue.js","webpack://gitlens/./node_modules/lodash-es/_getNative.js","webpack://gitlens/./node_modules/lodash-es/_Map.js","webpack://gitlens/./node_modules/lodash-es/_nativeCreate.js","webpack://gitlens/./node_modules/lodash-es/_hashClear.js","webpack://gitlens/./node_modules/lodash-es/_hashDelete.js","webpack://gitlens/./node_modules/lodash-es/_hashGet.js","webpack://gitlens/./node_modules/lodash-es/_hashHas.js","webpack://gitlens/./node_modules/lodash-es/_hashSet.js","webpack://gitlens/./node_modules/lodash-es/_Hash.js","webpack://gitlens/./node_modules/lodash-es/_mapCacheClear.js","webpack://gitlens/./node_modules/lodash-es/_isKeyable.js","webpack://gitlens/./node_modules/lodash-es/_getMapData.js","webpack://gitlens/./node_modules/lodash-es/_mapCacheDelete.js","webpack://gitlens/./node_modules/lodash-es/_mapCacheGet.js","webpack://gitlens/./node_modules/lodash-es/_mapCacheHas.js","webpack://gitlens/./node_modules/lodash-es/_mapCacheSet.js","webpack://gitlens/./node_modules/lodash-es/_MapCache.js","webpack://gitlens/./node_modules/lodash-es/_stackSet.js","webpack://gitlens/./node_modules/lodash-es/_Stack.js","webpack://gitlens/./node_modules/lodash-es/_setCacheAdd.js","webpack://gitlens/./node_modules/lodash-es/_setCacheHas.js","webpack://gitlens/./node_modules/lodash-es/_SetCache.js","webpack://gitlens/./node_modules/lodash-es/_arraySome.js","webpack://gitlens/./node_modules/lodash-es/_cacheHas.js","webpack://gitlens/./node_modules/lodash-es/_equalArrays.js","webpack://gitlens/./node_modules/lodash-es/_Uint8Array.js","webpack://gitlens/./node_modules/lodash-es/_mapToArray.js","webpack://gitlens/./node_modules/lodash-es/_setToArray.js","webpack://gitlens/./node_modules/lodash-es/_equalByTag.js","webpack://gitlens/./node_modules/lodash-es/_arrayPush.js","webpack://gitlens/./node_modules/lodash-es/isArray.js","webpack://gitlens/./node_modules/lodash-es/_baseGetAllKeys.js","webpack://gitlens/./node_modules/lodash-es/_arrayFilter.js","webpack://gitlens/./node_modules/lodash-es/stubArray.js","webpack://gitlens/./node_modules/lodash-es/_getSymbols.js","webpack://gitlens/./node_modules/lodash-es/_baseTimes.js","webpack://gitlens/./node_modules/lodash-es/isObjectLike.js","webpack://gitlens/./node_modules/lodash-es/_baseIsArguments.js","webpack://gitlens/./node_modules/lodash-es/isArguments.js","webpack://gitlens/./node_modules/lodash-es/stubFalse.js","webpack://gitlens/./node_modules/lodash-es/isBuffer.js","webpack://gitlens/./node_modules/lodash-es/_isIndex.js","webpack://gitlens/./node_modules/lodash-es/isLength.js","webpack://gitlens/./node_modules/lodash-es/_baseIsTypedArray.js","webpack://gitlens/./node_modules/lodash-es/_baseUnary.js","webpack://gitlens/./node_modules/lodash-es/_nodeUtil.js","webpack://gitlens/./node_modules/lodash-es/isTypedArray.js","webpack://gitlens/./node_modules/lodash-es/_arrayLikeKeys.js","webpack://gitlens/./node_modules/lodash-es/_isPrototype.js","webpack://gitlens/./node_modules/lodash-es/_overArg.js","webpack://gitlens/./node_modules/lodash-es/_nativeKeys.js","webpack://gitlens/./node_modules/lodash-es/_baseKeys.js","webpack://gitlens/./node_modules/lodash-es/isArrayLike.js","webpack://gitlens/./node_modules/lodash-es/keys.js","webpack://gitlens/./node_modules/lodash-es/_getAllKeys.js","webpack://gitlens/./node_modules/lodash-es/_equalObjects.js","webpack://gitlens/./node_modules/lodash-es/_DataView.js","webpack://gitlens/./node_modules/lodash-es/_Promise.js","webpack://gitlens/./node_modules/lodash-es/_Set.js","webpack://gitlens/./node_modules/lodash-es/_WeakMap.js","webpack://gitlens/./node_modules/lodash-es/_getTag.js","webpack://gitlens/./node_modules/lodash-es/_baseIsEqualDeep.js","webpack://gitlens/./node_modules/lodash-es/_baseIsEqual.js","webpack://gitlens/./node_modules/lodash-es/_baseIsMatch.js","webpack://gitlens/./node_modules/lodash-es/_isStrictComparable.js","webpack://gitlens/./node_modules/lodash-es/_getMatchData.js","webpack://gitlens/./node_modules/lodash-es/_matchesStrictComparable.js","webpack://gitlens/./node_modules/lodash-es/_baseMatches.js","webpack://gitlens/./node_modules/lodash-es/isSymbol.js","webpack://gitlens/./node_modules/lodash-es/_isKey.js","webpack://gitlens/./node_modules/lodash-es/memoize.js","webpack://gitlens/./node_modules/lodash-es/_memoizeCapped.js","webpack://gitlens/./node_modules/lodash-es/_stringToPath.js","webpack://gitlens/./node_modules/lodash-es/_arrayMap.js","webpack://gitlens/./node_modules/lodash-es/_baseToString.js","webpack://gitlens/./node_modules/lodash-es/toString.js","webpack://gitlens/./node_modules/lodash-es/_castPath.js","webpack://gitlens/./node_modules/lodash-es/_toKey.js","webpack://gitlens/./node_modules/lodash-es/_baseGet.js","webpack://gitlens/./node_modules/lodash-es/get.js","webpack://gitlens/./node_modules/lodash-es/_baseHasIn.js","webpack://gitlens/./node_modules/lodash-es/_hasPath.js","webpack://gitlens/./node_modules/lodash-es/hasIn.js","webpack://gitlens/./node_modules/lodash-es/_baseMatchesProperty.js","webpack://gitlens/./node_modules/lodash-es/identity.js","webpack://gitlens/./node_modules/lodash-es/_baseProperty.js","webpack://gitlens/./node_modules/lodash-es/_basePropertyDeep.js","webpack://gitlens/./node_modules/lodash-es/property.js","webpack://gitlens/./node_modules/lodash-es/_baseIteratee.js","webpack://gitlens/./node_modules/lodash-es/_trimmedEndIndex.js","webpack://gitlens/./node_modules/lodash-es/_baseTrim.js","webpack://gitlens/./node_modules/lodash-es/toNumber.js","webpack://gitlens/./node_modules/lodash-es/toFinite.js","webpack://gitlens/./node_modules/lodash-es/toInteger.js","webpack://gitlens/./node_modules/lodash-es/findLastIndex.js","webpack://gitlens/./node_modules/lodash-es/_baseIsNaN.js","webpack://gitlens/./node_modules/lodash-es/_strictIndexOf.js","webpack://gitlens/./node_modules/lodash-es/_baseIndexOf.js","webpack://gitlens/./node_modules/lodash-es/_arrayIncludes.js","webpack://gitlens/./node_modules/lodash-es/_arrayIncludesWith.js","webpack://gitlens/./node_modules/lodash-es/_baseIntersection.js","webpack://gitlens/./node_modules/lodash-es/_apply.js","webpack://gitlens/./node_modules/lodash-es/_overRest.js","webpack://gitlens/./node_modules/lodash-es/constant.js","webpack://gitlens/./node_modules/lodash-es/_defineProperty.js","webpack://gitlens/./node_modules/lodash-es/_baseSetToString.js","webpack://gitlens/./node_modules/lodash-es/_shortOut.js","webpack://gitlens/./node_modules/lodash-es/_setToString.js","webpack://gitlens/./node_modules/lodash-es/_baseRest.js","webpack://gitlens/./node_modules/lodash-es/isArrayLikeObject.js","webpack://gitlens/./node_modules/lodash-es/_castArrayLikeObject.js","webpack://gitlens/./node_modules/lodash-es/intersection.js","webpack://gitlens/./src/system/array.ts","webpack://gitlens/./src/system/iterable.ts","webpack://gitlens/./src/system/promise.ts","webpack://gitlens/./src/system/decorators/gate.ts","webpack://gitlens/./node_modules/lodash-es/now.js","webpack://gitlens/./node_modules/lodash-es/debounce.js","webpack://gitlens/./node_modules/lodash-es/before.js","webpack://gitlens/./node_modules/lodash-es/once.js","webpack://gitlens/./src/system/function.ts","webpack://gitlens/./src/system/string.ts","webpack://gitlens/./src/system/decorators/log.ts","webpack://gitlens/./src/system/decorators/timeout.ts","webpack://gitlens/./node_modules/lodash-es/isEqual.js","webpack://gitlens/./src/system/object.ts","webpack://gitlens/./src/system/searchTree.ts","webpack://gitlens/./src/system/stopwatch.ts","webpack://gitlens/./src/system/version.ts","webpack://gitlens/./src/system/date.ts","webpack://gitlens/./src/system/decorators/memoize.ts","webpack://gitlens/./src/terminal.ts","webpack://gitlens/./src/trackers/trackedDocument.ts","webpack://gitlens/./src/trackers/documentTracker.ts","webpack://gitlens/./src/trackers/gitDocumentTracker.ts","webpack://gitlens/./src/views/fileHistoryView.ts","webpack://gitlens/./src/views/nodes/common.ts","webpack://gitlens/./src/views/nodes/folderNode.ts","webpack://gitlens/./src/views/nodes/mergeConflictCurrentChangesNode.ts","webpack://gitlens/./src/views/nodes/mergeConflictIncomingChangesNode.ts","webpack://gitlens/./src/views/nodes/fileRevisionAsCommitNode.ts","webpack://gitlens/./src/views/nodes/statusFileNode.ts","webpack://gitlens/./src/views/nodes/branchTrackingStatusFilesNode.ts","webpack://gitlens/./src/views/nodes/commitFileNode.ts","webpack://gitlens/./src/views/nodes/helpers.ts","webpack://gitlens/./src/views/nodes/resultsFileNode.ts","webpack://gitlens/./src/views/nodes/resultsFilesNode.ts","webpack://gitlens/./src/views/nodes/resultsCommitsNode.ts","webpack://gitlens/./src/views/nodes/compareBranchNode.ts","webpack://gitlens/./src/views/nodes/contributorNode.ts","webpack://gitlens/./src/views/nodes/contributorsNode.ts","webpack://gitlens/./src/views/nodes/mergeConflictFileNode.ts","webpack://gitlens/./src/views/nodes/mergeStatusNode.ts","webpack://gitlens/./src/views/nodes/rebaseStatusNode.ts","webpack://gitlens/./src/views/nodes/reflogRecordNode.ts","webpack://gitlens/./src/views/nodes/reflogNode.ts","webpack://gitlens/./src/views/nodes/branchOrTagFolderNode.ts","webpack://gitlens/./src/views/nodes/remoteNode.ts","webpack://gitlens/./src/views/nodes/remotesNode.ts","webpack://gitlens/./src/views/nodes/stashNode.ts","webpack://gitlens/./src/views/nodes/stashesNode.ts","webpack://gitlens/./src/views/nodes/statusFilesNode.ts","webpack://gitlens/./src/views/nodes/tagNode.ts","webpack://gitlens/./src/views/nodes/tagsNode.ts","webpack://gitlens/./src/views/nodes/repositoryNode.ts","webpack://gitlens/./src/views/nodes/pullRequestNode.ts","webpack://gitlens/./src/views/nodes/commitNode.ts","webpack://gitlens/./src/views/nodes/branchTrackingStatusNode.ts","webpack://gitlens/./src/views/nodes/branchNode.ts","webpack://gitlens/./src/views/nodes/branchesNode.ts","webpack://gitlens/./src/views/nodes/compareResultsNode.ts","webpack://gitlens/./src/views/nodes/fileHistoryTrackerNode.ts","webpack://gitlens/./src/views/nodes/fileHistoryNode.ts","webpack://gitlens/./src/views/nodes/lineHistoryTrackerNode.ts","webpack://gitlens/./src/views/nodes/lineHistoryNode.ts","webpack://gitlens/./src/views/nodes/repositoriesNode.ts","webpack://gitlens/./src/views/nodes/searchResultsNode.ts","webpack://gitlens/./src/views/nodes/stashFileNode.ts","webpack://gitlens/./src/views/nodes/comparePickerNode.ts","webpack://gitlens/./src/views/nodes/viewNode.ts","webpack://gitlens/./src/views/remotesView.ts","webpack://gitlens/./src/views/repositoriesView.ts","webpack://gitlens/./src/views/tagsView.ts","webpack://gitlens/./src/views/viewBase.ts","webpack://gitlens/./src/vsls/protocol.ts","webpack://gitlens/./src/vsls/host.ts","webpack://gitlens/./src/vsls/guest.ts","webpack://gitlens/./src/vsls/vsls.ts","webpack://gitlens/./node_modules/iconv-lite/encodings/dbcs-codec.js","webpack://gitlens/./node_modules/iconv-lite/encodings/dbcs-data.js","webpack://gitlens/./node_modules/iconv-lite/encodings/index.js","webpack://gitlens/./node_modules/iconv-lite/encodings/internal.js","webpack://gitlens/./node_modules/iconv-lite/encodings/sbcs-codec.js","webpack://gitlens/./node_modules/iconv-lite/encodings/sbcs-data-generated.js","webpack://gitlens/./node_modules/iconv-lite/encodings/sbcs-data.js","webpack://gitlens/./node_modules/iconv-lite/encodings/utf16.js","webpack://gitlens/./node_modules/iconv-lite/encodings/utf32.js","webpack://gitlens/./node_modules/iconv-lite/encodings/utf7.js","webpack://gitlens/./node_modules/iconv-lite/lib/bom-handling.js","webpack://gitlens/./node_modules/iconv-lite/lib/index.js","webpack://gitlens/./node_modules/iconv-lite/lib/streams.js","webpack://gitlens/./node_modules/once/once.js","webpack://gitlens/./node_modules/safer-buffer/safer.js","webpack://gitlens/./node_modules/tr46/index.js","webpack://gitlens/./node_modules/universal-user-agent/dist-node/index.js","webpack://gitlens/./node_modules/webidl-conversions/lib/index.js","webpack://gitlens/./node_modules/whatwg-url/lib/URL-impl.js","webpack://gitlens/./node_modules/whatwg-url/lib/URL.js","webpack://gitlens/./node_modules/whatwg-url/lib/public-api.js","webpack://gitlens/./node_modules/whatwg-url/lib/url-state-machine.js","webpack://gitlens/./node_modules/whatwg-url/lib/utils.js","webpack://gitlens/./node_modules/wrappy/wrappy.js","webpack://gitlens/external commonjs \"vscode\"","webpack://gitlens/external node-commonjs \"buffer\"","webpack://gitlens/external node-commonjs \"crypto\"","webpack://gitlens/external node-commonjs \"fs\"","webpack://gitlens/external node-commonjs \"path\"","webpack://gitlens/external node-commonjs \"punycode\"","webpack://gitlens/external node-commonjs \"stream\"","webpack://gitlens/external node-commonjs \"string_decoder\"","webpack://gitlens/external node-commonjs \"util\"","webpack://gitlens/webpack/bootstrap","webpack://gitlens/webpack/runtime/compat get default export","webpack://gitlens/webpack/runtime/create fake namespace object","webpack://gitlens/webpack/runtime/define property getters","webpack://gitlens/webpack/runtime/ensure chunk","webpack://gitlens/webpack/runtime/get javascript chunk filename","webpack://gitlens/webpack/runtime/hasOwnProperty shorthand","webpack://gitlens/webpack/runtime/make namespace object","webpack://gitlens/webpack/runtime/require chunk loading","webpack://gitlens/webpack/startup"],"names":[],"mappings":"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YACO,kCAOM,IADb,YACa,+BAeA,IADb,YACa,oCAiCA,IADb,YACa,4BAeN,IADP,YACO,+BAOA,IADP,YACO,8BAOA,IADP,YACO,4BAOA,IADP,YACO,wBAWM,IADb,YACa,mCAoBA,IADb,YACa,2CAsBN,IADP,YACO,wBAOA,IADP,YACO,+BAOA,IADP,YACO,kCAkBA,IADP,YACO,iCAOM,IADb,YACa,8BAON,IADP,YACO,gCAQA,IADP,YACO,oCAQA,IADP,YACO,uBAUA,IADP,YACO,uBA8BA,IADP,YACO,yBAcA,IADP,YACO,iCAiBA,IADP,YACO,+BAOA,IADP,YACO,8BAcA,IADP,YACO,gCAOA,IADP,YACO,0BAOA,IADP,YACO,yBAOA,IADP,YACO,+BAOA,IADP,YACO,sCAOA,IADP,YACO,6CAKM,IADb,YACa,4BAcA,IADb,YACa,iCAQN,IADP,YACO,uBAaA,IADP,YACO,yBAcM,IADb,YACa,6BAqBN,IADP,YACO,iCAOM,IADb,YACa,8BAcA,IADb,YACa,mCAQN,IADP,YACO,yBAaA,IADP,YACO,kCAOA,IADP,YACO,sCAQA,IADP,YACO,qCAOM,IADb,YACa,6CAiBN,IADP,YACO,sCAOA,IADP,YACO,mCAOA,IADP,YACO,0CA+BA,IADP,YACO,uCAYM,IADb,YACa,iCAwBN,IADP,YACO,8BA0DM,IADb,YACa,4CAiEA,IADb,YACa,yCA0CA,IADb,YACa,iDAUN,IADP,YACO,2BAsBM,IADb,YACa,4BAgBN,IADP,YACO,+BA8CM,IADb,YACa,gC,uPCtkCR,QAA+E,CAOrF,aAAc,CANG,uBAAe,GAAI,iBAKnB,sBAEhB,KAAK,WAAa,kBAEjB,wCAAsC,CACrC,sBAAuB,CAAC,EAAK,IAAU,CACtC,GAAI,EAAI,SAAW,eAEnB,IAAI,EAAI,YAAc,SACrB,MAAO,MAAK,+BAA+B,EAAK,GAGjD,GAAI,EAAI,YAAc,SACrB,MAAO,MAAK,+BAA+B,EAAK,OAMnD,wCAAsC,UAvBpC,cAA8C,CACjD,MAAO,MAAK,aAAa,MA0B1B,SAAgB,CACf,KAAK,WAAW,UAGjB,sBAAs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","file":"gitlens.js","sourcesContent":["!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(t=\"undefined\"!=typeof globalThis?globalThis:t||self).dayjs=e()}(this,(function(){\"use strict\";var t=1e3,e=6e4,n=36e5,r=\"millisecond\",i=\"second\",s=\"minute\",u=\"hour\",a=\"day\",o=\"week\",f=\"month\",h=\"quarter\",c=\"year\",d=\"date\",$=\"Invalid Date\",l=/^(\\d{4})[-/]?(\\d{1,2})?[-/]?(\\d{0,2})[Tt\\s]*(\\d{1,2})?:?(\\d{1,2})?:?(\\d{1,2})?[.:]?(\\d+)?$/,y=/\\[([^\\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,M={name:\"en\",weekdays:\"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday\".split(\"_\"),months:\"January_February_March_April_May_June_July_August_September_October_November_December\".split(\"_\")},m=function(t,e,n){var r=String(t);return!r||r.length>=e?t:\"\"+Array(e+1-r.length).join(n)+t},g={s:m,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?\"+\":\"-\")+m(r,2,\"0\")+\":\"+m(i,2,\"0\")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,f),s=n-i<0,u=e.clone().add(r+(s?-1:1),f);return+(-(r+(n-i)/(s?i-u:u-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:f,y:c,w:o,d:a,D:d,h:u,m:s,s:i,ms:r,Q:h}[t]||String(t||\"\").toLowerCase().replace(/s$/,\"\")},u:function(t){return void 0===t}},D=\"en\",v={};v[D]=M;var p=function(t){return t instanceof _},S=function(t,e,n){var r;if(!t)return D;if(\"string\"==typeof t)v[t]&&(r=t),e&&(v[t]=e,r=t);else{var i=t.name;v[i]=t,r=i}return!n&&r&&(D=r),r||!n&&D},w=function(t,e){if(p(t))return t.clone();var n=\"object\"==typeof e?e:{};return n.date=t,n.args=arguments,new _(n)},O=g;O.l=S,O.i=p,O.w=function(t,e){return w(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var _=function(){function M(t){this.$L=S(t.locale,null,!0),this.parse(t)}var m=M.prototype;return m.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(O.u(e))return new Date;if(e instanceof Date)return new Date(e);if(\"string\"==typeof e&&!/Z$/i.test(e)){var r=e.match(l);if(r){var i=r[2]-1||0,s=(r[7]||\"0\").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},m.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},m.$utils=function(){return O},m.isValid=function(){return!(this.$d.toString()===$)},m.isSame=function(t,e){var n=w(t);return this.startOf(e)<=n&&n<=this.endOf(e)},m.isAfter=function(t,e){return w(t)<this.startOf(e)},m.isBefore=function(t,e){return this.endOf(e)<w(t)},m.$g=function(t,e,n){return O.u(t)?this[e]:this.set(n,t)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(t,e){var n=this,r=!!O.u(e)||e,h=O.p(t),$=function(t,e){var i=O.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?i:i.endOf(a)},l=function(t,e){return O.w(n.toDate()[t].apply(n.toDate(\"s\"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},y=this.$W,M=this.$M,m=this.$D,g=\"set\"+(this.$u?\"UTC\":\"\");switch(h){case c:return r?$(1,0):$(31,11);case f:return r?$(1,M):$(0,M+1);case o:var D=this.$locale().weekStart||0,v=(y<D?y+7:y)-D;return $(r?m-v:m+(6-v),M);case a:case d:return l(g+\"Hours\",0);case u:return l(g+\"Minutes\",1);case s:return l(g+\"Seconds\",2);case i:return l(g+\"Milliseconds\",3);default:return this.clone()}},m.endOf=function(t){return this.startOf(t,!1)},m.$set=function(t,e){var n,o=O.p(t),h=\"set\"+(this.$u?\"UTC\":\"\"),$=(n={},n[a]=h+\"Date\",n[d]=h+\"Date\",n[f]=h+\"Month\",n[c]=h+\"FullYear\",n[u]=h+\"Hours\",n[s]=h+\"Minutes\",n[i]=h+\"Seconds\",n[r]=h+\"Milliseconds\",n)[o],l=o===a?this.$D+(e-this.$W):e;if(o===f||o===c){var y=this.clone().set(d,1);y.$d[$](l),y.init(),this.$d=y.set(d,Math.min(this.$D,y.daysInMonth())).$d}else $&&this.$d[$](l);return this.init(),this},m.set=function(t,e){return this.clone().$set(t,e)},m.get=function(t){return this[O.p(t)]()},m.add=function(r,h){var d,$=this;r=Number(r);var l=O.p(h),y=function(t){var e=w($);return O.w(e.date(e.date()+Math.round(t*r)),$)};if(l===f)return this.set(f,this.$M+r);if(l===c)return this.set(c,this.$y+r);if(l===a)return y(1);if(l===o)return y(7);var M=(d={},d[s]=e,d[u]=n,d[i]=t,d)[l]||1,m=this.$d.getTime()+r*M;return O.w(m,this)},m.subtract=function(t,e){return this.add(-1*t,e)},m.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||$;var r=t||\"YYYY-MM-DDTHH:mm:ssZ\",i=O.z(this),s=this.$H,u=this.$m,a=this.$M,o=n.weekdays,f=n.months,h=function(t,n,i,s){return t&&(t[n]||t(e,r))||i[n].substr(0,s)},c=function(t){return O.s(s%12||12,t,\"0\")},d=n.meridiem||function(t,e,n){var r=t<12?\"AM\":\"PM\";return n?r.toLowerCase():r},l={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:O.s(a+1,2,\"0\"),MMM:h(n.monthsShort,a,f,3),MMMM:h(f,a),D:this.$D,DD:O.s(this.$D,2,\"0\"),d:String(this.$W),dd:h(n.weekdaysMin,this.$W,o,2),ddd:h(n.weekdaysShort,this.$W,o,3),dddd:o[this.$W],H:String(s),HH:O.s(s,2,\"0\"),h:c(1),hh:c(2),a:d(s,u,!0),A:d(s,u,!1),m:String(u),mm:O.s(u,2,\"0\"),s:String(this.$s),ss:O.s(this.$s,2,\"0\"),SSS:O.s(this.$ms,3,\"0\"),Z:i};return r.replace(y,(function(t,e){return e||l[t]||i.replace(\":\",\"\")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(r,d,$){var l,y=O.p(d),M=w(r),m=(M.utcOffset()-this.utcOffset())*e,g=this-M,D=O.m(this,M);return D=(l={},l[c]=D/12,l[f]=D,l[h]=D/3,l[o]=(g-m)/6048e5,l[a]=(g-m)/864e5,l[u]=g/n,l[s]=g/e,l[i]=g/t,l)[y]||g,$?D:O.a(D)},m.daysInMonth=function(){return this.endOf(f).$D},m.$locale=function(){return v[this.$L]},m.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=S(t,e,!0);return r&&(n.$L=r),n},m.clone=function(){return O.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},M}(),b=_.prototype;return w.prototype=b,[[\"$ms\",r],[\"$s\",i],[\"$m\",s],[\"$H\",u],[\"$W\",a],[\"$M\",f],[\"$y\",c],[\"$D\",d]].forEach((function(t){b[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),w.extend=function(t,e){return t.$i||(t(e,_,w),t.$i=!0),w},w.locale=S,w.isDayjs=p,w.unix=function(t){return w(1e3*t)},w.en=v[D],w.Ls=v,w.p={},w}));","!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):(e=\"undefined\"!=typeof globalThis?globalThis:e||self).dayjs_plugin_advancedFormat=t()}(this,(function(){\"use strict\";return function(e,t,r){var n=t.prototype,s=n.format;r.en.ordinal=function(e){var t=[\"th\",\"st\",\"nd\",\"rd\"],r=e%100;return\"[\"+e+(t[(r-20)%10]||t[r]||t[0])+\"]\"},n.format=function(e){var t=this,r=this.$locale(),n=this.$utils(),a=(e||\"YYYY-MM-DDTHH:mm:ssZ\").replace(/\\[([^\\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,(function(e){switch(e){case\"Q\":return Math.ceil((t.$M+1)/3);case\"Do\":return r.ordinal(t.$D);case\"gggg\":return t.weekYear();case\"GGGG\":return t.isoWeekYear();case\"wo\":return r.ordinal(t.week(),\"W\");case\"w\":case\"ww\":return n.s(t.week(),\"w\"===e?1:2,\"0\");case\"W\":case\"WW\":return n.s(t.isoWeek(),\"W\"===e?1:2,\"0\");case\"k\":case\"kk\":return n.s(String(0===t.$H?24:t.$H),\"k\"===e?1:2,\"0\");case\"X\":return Math.floor(t.$d.getTime()/1e3);case\"x\":return t.$d.getTime();case\"z\":return\"[\"+t.offsetName()+\"]\";case\"zzz\":return\"[\"+t.offsetName(\"long\")+\"]\";default:return e}}));return s.bind(this)(a)}}}));","!function(r,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(r=\"undefined\"!=typeof globalThis?globalThis:r||self).dayjs_plugin_relativeTime=e()}(this,(function(){\"use strict\";return function(r,e,t){r=r||{};var n=e.prototype,o={future:\"in %s\",past:\"%s ago\",s:\"a few seconds\",m:\"a minute\",mm:\"%d minutes\",h:\"an hour\",hh:\"%d hours\",d:\"a day\",dd:\"%d days\",M:\"a month\",MM:\"%d months\",y:\"a year\",yy:\"%d years\"};function i(r,e,t,o){return n.fromToBase(r,e,t,o)}t.en.relativeTime=o,n.fromToBase=function(e,n,i,d,u){for(var f,a,s,l=i.$locale().relativeTime||o,h=r.thresholds||[{l:\"s\",r:44,d:\"second\"},{l:\"m\",r:89},{l:\"mm\",r:44,d:\"minute\"},{l:\"h\",r:89},{l:\"hh\",r:21,d:\"hour\"},{l:\"d\",r:35},{l:\"dd\",r:25,d:\"day\"},{l:\"M\",r:45},{l:\"MM\",r:10,d:\"month\"},{l:\"y\",r:17},{l:\"yy\",d:\"year\"}],m=h.length,c=0;c<m;c+=1){var y=h[c];y.d&&(f=d?t(e).diff(i,y.d,!0):i.diff(e,y.d,!0));var p=(r.rounding||Math.round)(Math.abs(f));if(s=f>0,p<=y.r||!y.r){p<=1&&c>0&&(y=h[c-1]);var v=l[y.l];u&&(p=u(\"\"+p)),a=\"string\"==typeof v?v.replace(\"%d\",p):v(p,n,y.l,s);break}}if(n)return a;var M=s?l.future:l.past;return\"function\"==typeof M?M(a):M.replace(\"%s\",a)},n.to=function(r,e){return i(r,e,this,!0)},n.from=function(r,e){return i(r,e,this)};var d=function(r){return r.$u?t.utc():t()};n.toNow=function(r){return this.to(d(this),r)},n.fromNow=function(r){return this.from(d(this),r)}}}));","!function(e,n){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=n():\"function\"==typeof define&&define.amd?define(n):(e=\"undefined\"!=typeof globalThis?globalThis:e||self).dayjs_plugin_updateLocale=n()}(this,(function(){\"use strict\";return function(e,n,t){t.updateLocale=function(e,n){var o=t.Ls[e];if(o)return(n?Object.keys(n):[]).forEach((function(e){o[e]=n[e]})),o}}}));","'use strict';\nimport { commands, Disposable, Event, EventEmitter, QuickPickItem, window } from 'vscode';\nimport { Commands } from '../commands/common';\nimport { configuration } from '../configuration';\nimport { ContextKeys, setContext } from '../constants';\nimport { Container } from '../container';\nimport { getQuickPickIgnoreFocusOut } from '../quickpicks';\nimport { Action, ActionContext, ActionRunner } from './gitlens';\n\ntype Actions = ActionContext['type'];\nconst actions: Actions[] = ['createPullRequest', 'openPullRequest', 'hover.commands'];\n\n// The order here determines the sorting of these actions when shown to the user\nexport const enum ActionRunnerType {\n\tBuiltIn = 0,\n\tBuiltInPartner = 1,\n\tPartner = 2,\n\tBuiltInPartnerInstaller = 3,\n}\n\nexport const builtInActionRunnerName = 'Built In';\n\nclass ActionRunnerQuickPickItem implements QuickPickItem {\n\tprivate readonly _label: string;\n\n\tconstructor(public readonly runner: RegisteredActionRunner, context: ActionContext) {\n\t\tthis._label = typeof runner.label === 'string' ? runner.label : runner.label(context);\n\t}\n\n\tget label(): string {\n\t\treturn this._label;\n\t}\n\n\tget detail(): string | undefined {\n\t\treturn this.runner.name;\n\t}\n}\n\nclass NoActionRunnersQuickPickItem implements QuickPickItem {\n\tpublic readonly runner: RegisteredActionRunner | undefined;\n\n\tget label(): string {\n\t\treturn 'No actions were found';\n\t}\n\n\tget detail(): string | undefined {\n\t\treturn undefined;\n\t}\n}\n\nlet runnerId = 0;\nfunction nextRunnerId() {\n\tif (runnerId === Number.MAX_SAFE_INTEGER) {\n\t\trunnerId = 1;\n\t} else {\n\t\trunnerId++;\n\t}\n\n\treturn runnerId;\n}\n\nclass RegisteredActionRunner<T extends ActionContext = ActionContext> implements ActionRunner<T>, Disposable {\n\treadonly id: number;\n\n\tconstructor(\n\t\tpublic readonly type: ActionRunnerType,\n\t\tprivate readonly runner: ActionRunner<T>,\n\t\tprivate readonly unregister: () => void,\n\t) {\n\t\tthis.id = nextRunnerId();\n\t}\n\n\tdispose() {\n\t\tthis.unregister();\n\t}\n\n\tget name(): string {\n\t\treturn this.runner.name;\n\t}\n\n\tget label(): string | ((context: T) => string) {\n\t\treturn this.runner.label;\n\t}\n\n\tget order(): number {\n\t\tswitch (this.type) {\n\t\t\tcase ActionRunnerType.BuiltIn:\n\t\t\t\treturn 0;\n\n\t\t\tcase ActionRunnerType.BuiltInPartner:\n\t\t\t\treturn 1;\n\n\t\t\tcase ActionRunnerType.Partner:\n\t\t\t\t// Sort built-in partners and partners with ids the same\n\t\t\t\treturn this.partnerId ? 1 : 2;\n\n\t\t\tcase ActionRunnerType.BuiltInPartnerInstaller:\n\t\t\t\treturn 3;\n\n\t\t\tdefault:\n\t\t\t\treturn 100;\n\t\t}\n\t}\n\n\tget partnerId(): string {\n\t\treturn this.runner.partnerId;\n\t}\n\n\trun(context: T): void | Promise<void> {\n\t\treturn this.runner.run(context);\n\t}\n\n\t// when(context: ActionContext): boolean {\n\t// \ttry {\n\t// \t\treturn this.runner.when?.(context) ?? true;\n\t// \t} catch {\n\t// \t\treturn false;\n\t// \t}\n\t// }\n}\n\nexport class ActionRunners implements Disposable {\n\tprivate _onDidChange = new EventEmitter<Actions | undefined>();\n\tget onDidChange(): Event<Actions | undefined> {\n\t\treturn this._onDidChange.event;\n\t}\n\n\tprivate readonly _actionRunners = new Map<Actions, RegisteredActionRunner<any>[]>();\n\tprivate readonly _disposable: Disposable;\n\n\tconstructor() {\n\t\tconst subscriptions: Disposable[] = [\n\t\t\tconfiguration.onDidChange(e => {\n\t\t\t\tif (!configuration.changed(e, 'partners')) return;\n\n\t\t\t\tvoid this._updateAllContextKeys();\n\t\t\t}),\n\t\t];\n\n\t\tfor (const action of actions) {\n\t\t\tsubscriptions.push(\n\t\t\t\tcommands.registerCommand(\n\t\t\t\t\t`${Commands.ActionPrefix}${action}`,\n\t\t\t\t\t(context: ActionContext, runnerId?: number) => this.run(context, runnerId),\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\tthis._disposable = Disposable.from(...subscriptions);\n\t}\n\n\tdispose() {\n\t\tthis._disposable.dispose();\n\n\t\tfor (const runners of this._actionRunners.values()) {\n\t\t\tfor (const runner of runners) {\n\t\t\t\trunner.dispose();\n\t\t\t}\n\t\t}\n\t\tthis._actionRunners.clear();\n\t}\n\n\tcount(action: Actions): number {\n\t\treturn this.get(action)?.length ?? 0;\n\t}\n\n\tget(action: Actions): RegisteredActionRunner[] | undefined {\n\t\treturn filterOnlyEnabledRunners(this._actionRunners.get(action));\n\t}\n\n\thas(action: Actions): boolean {\n\t\treturn this.count(action) > 0;\n\t}\n\n\tregister<T extends ActionContext>(\n\t\taction: Action<T>,\n\t\trunner: ActionRunner<T>,\n\t\ttype: ActionRunnerType = ActionRunnerType.Partner,\n\t): Disposable {\n\t\tlet runners = this._actionRunners.get(action);\n\t\tif (runners == null) {\n\t\t\trunners = [];\n\t\t\tthis._actionRunners.set(action, runners);\n\t\t}\n\n\t\tconst onChanged = (action: Actions) => {\n\t\t\tvoid this._updateContextKeys(action);\n\t\t\tthis._onDidChange.fire(action);\n\t\t};\n\n\t\tconst runnersMap = this._actionRunners;\n\n\t\tconst registeredRunner = new RegisteredActionRunner(type, runner, function (this: RegisteredActionRunner) {\n\t\t\tif (runners!.length === 1) {\n\t\t\t\trunnersMap.delete(action);\n\t\t\t\tonChanged(action);\n\t\t\t} else {\n\t\t\t\tconst index = runners!.indexOf(this);\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\trunners!.splice(index, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\trunners.push(registeredRunner);\n\t\tonChanged(action);\n\n\t\treturn {\n\t\t\tdispose: () => registeredRunner.dispose(),\n\t\t};\n\t}\n\n\tregisterBuiltIn<T extends ActionContext>(\n\t\taction: Action<T>,\n\t\trunner: Omit<ActionRunner<T>, 'partnerId' | 'name'>,\n\t): Disposable {\n\t\treturn this.register(\n\t\t\taction,\n\t\t\t{ ...runner, partnerId: undefined!, name: builtInActionRunnerName },\n\t\t\tActionRunnerType.BuiltIn,\n\t\t);\n\t}\n\n\tregisterBuiltInPartner<T extends ActionContext>(\n\t\tpartnerId: string,\n\t\taction: Action<T>,\n\t\trunner: Omit<ActionRunner<T>, 'partnerId'>,\n\t): Disposable {\n\t\treturn this.register(action, { ...runner, partnerId: partnerId }, ActionRunnerType.BuiltInPartner);\n\t}\n\n\tregisterBuiltInPartnerInstaller<T extends ActionContext>(\n\t\tpartnerId: string,\n\t\taction: Action<T>,\n\t\trunner: Omit<ActionRunner<T>, 'partnerId'>,\n\t): Disposable {\n\t\treturn this.register(\n\t\t\taction,\n\t\t\t{ ...runner, partnerId: partnerId, name: `${runner.name} (Not Installed)` },\n\t\t\tActionRunnerType.BuiltInPartnerInstaller,\n\t\t);\n\t}\n\n\tasync run<T extends ActionContext>(context: T, runnerId?: number) {\n\t\tlet runners = this.get(context.type);\n\t\tif (runners == null || runners.length === 0) return;\n\n\t\tif (runnerId != null) {\n\t\t\trunners = runners.filter(r => r.id === runnerId);\n\t\t}\n\t\tif (runners.length === 0) return;\n\n\t\tlet runner;\n\n\t\tif (runners.length > 1 || runners.every(r => r.type !== ActionRunnerType.BuiltIn)) {\n\t\t\tconst items: (ActionRunnerQuickPickItem | NoActionRunnersQuickPickItem)[] = runners\n\t\t\t\t// .filter(r => r.when(context))\n\t\t\t\t.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\ta.order - b.order ||\n\t\t\t\t\t\ta.name.localeCompare(b.name, undefined, { numeric: true, sensitivity: 'base' }),\n\t\t\t\t)\n\t\t\t\t.map(r => new ActionRunnerQuickPickItem(r, context));\n\n\t\t\tif (items.length === 0) {\n\t\t\t\titems.push(new NoActionRunnersQuickPickItem());\n\t\t\t}\n\n\t\t\tconst quickpick = window.createQuickPick<ActionRunnerQuickPickItem | NoActionRunnersQuickPickItem>();\n\t\t\tquickpick.ignoreFocusOut = getQuickPickIgnoreFocusOut();\n\n\t\t\tconst disposables: Disposable[] = [];\n\n\t\t\ttry {\n\t\t\t\tconst pick = await new Promise<ActionRunnerQuickPickItem | NoActionRunnersQuickPickItem | undefined>(\n\t\t\t\t\tresolve => {\n\t\t\t\t\t\tdisposables.push(\n\t\t\t\t\t\t\tquickpick.onDidHide(() => resolve(undefined)),\n\t\t\t\t\t\t\tquickpick.onDidAccept(() => {\n\t\t\t\t\t\t\t\tif (quickpick.activeItems.length !== 0) {\n\t\t\t\t\t\t\t\t\tresolve(quickpick.activeItems[0]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tlet title;\n\t\t\t\t\t\tlet placeholder;\n\t\t\t\t\t\tswitch (context.type) {\n\t\t\t\t\t\t\tcase 'createPullRequest':\n\t\t\t\t\t\t\t\ttitle = 'Create Pull Request';\n\t\t\t\t\t\t\t\tplaceholder = 'Choose how to create a pull request';\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'openPullRequest':\n\t\t\t\t\t\t\t\ttitle = 'Open Pull Request';\n\t\t\t\t\t\t\t\tplaceholder = 'Choose how to open the pull request';\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'hover.commands':\n\t\t\t\t\t\t\t\ttitle = 'Need Help or Want to Collaborate?';\n\t\t\t\t\t\t\t\tplaceholder = 'Choose what you would like to do';\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t// eslint-disable-next-line no-debugger\n\t\t\t\t\t\t\t\tdebugger;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tquickpick.title = title;\n\t\t\t\t\t\tquickpick.placeholder = placeholder;\n\t\t\t\t\t\tquickpick.matchOnDetail = true;\n\t\t\t\t\t\tquickpick.items = items;\n\n\t\t\t\t\t\tquickpick.show();\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t\tif (pick == null) return;\n\n\t\t\t\trunner = pick.runner;\n\t\t\t} finally {\n\t\t\t\tquickpick.dispose();\n\t\t\t\tdisposables.forEach(d => d.dispose());\n\t\t\t}\n\t\t} else {\n\t\t\t[runner] = runners;\n\t\t}\n\n\t\tawait runner?.run(context);\n\t}\n\n\tprivate async _updateContextKeys(action: Actions) {\n\t\tawait setContext(`${ContextKeys.ActionPrefix}${action}`, this.count(action));\n\t}\n\n\tprivate async _updateAllContextKeys() {\n\t\tfor (const action of actions) {\n\t\t\tawait this._updateContextKeys(action);\n\t\t}\n\t}\n}\n\nfunction filterOnlyEnabledRunners(runners: RegisteredActionRunner[] | undefined) {\n\tif (runners == null || runners.length === 0) return undefined;\n\n\tconst partners = Container.config.partners;\n\tif (partners == null) return runners;\n\n\treturn runners.filter(\n\t\tr => r.partnerId == null || (r.partnerId != null && partners[r.partnerId]?.enabled !== false),\n\t);\n}\n","'use strict';\nimport * as fs from 'fs';\nimport { EventEmitter, Uri } from 'vscode';\nimport { GravatarDefaultStyle } from './config';\nimport { GlobalState } from './constants';\nimport { Container } from './container';\nimport { GitRevisionReference } from './git/git';\nimport { Functions, Iterables, Strings } from './system';\nimport { MillisecondsPerDay, MillisecondsPerHour, MillisecondsPerMinute } from './system/date';\nimport { ContactPresenceStatus } from './vsls/vsls';\n\nconst _onDidFetchAvatar = new EventEmitter<{ email: string }>();\n_onDidFetchAvatar.event(\n\tFunctions.debounce(() => {\n\t\tconst avatars =\n\t\t\tavatarCache != null\n\t\t\t\t? [\n\t\t\t\t\t\t...Iterables.filterMap(avatarCache, ([key, avatar]) =>\n\t\t\t\t\t\t\tavatar.uri != null\n\t\t\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\turi: avatar.uri.toString(),\n\t\t\t\t\t\t\t\t\t\t\ttimestamp: avatar.timestamp,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t  ]\n\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t),\n\t\t\t\t  ]\n\t\t\t\t: undefined;\n\t\tvoid Container.context.globalState.update(GlobalState.Avatars, avatars);\n\t}, 1000),\n);\n\nexport namespace Avatars {\n\texport const onDidFetch = _onDidFetchAvatar.event;\n}\n\ninterface Avatar {\n\turi?: Uri;\n\tfallback?: Uri;\n\ttimestamp: number;\n\tretries: number;\n}\n\ninterface SerializedAvatar {\n\turi: string;\n\ttimestamp: number;\n}\n\nlet avatarCache: Map<string, Avatar> | undefined;\nconst avatarQueue = new Map<string, Promise<Uri>>();\n\nconst missingGravatarHash = '00000000000000000000000000000000';\n\nconst presenceCache = new Map<ContactPresenceStatus, string>();\n\nconst gitHubNoReplyAddressRegex = /^(?:(?<userId>\\d+)\\+)?(?<userName>[a-zA-Z\\d-]{1,39})@users\\.noreply\\.github\\.com$/;\n\nconst retryDecay = [\n\tMillisecondsPerDay * 7, // First item is cache expiration (since retries will be 0)\n\tMillisecondsPerMinute,\n\tMillisecondsPerMinute * 5,\n\tMillisecondsPerMinute * 10,\n\tMillisecondsPerHour,\n\tMillisecondsPerDay,\n\tMillisecondsPerDay * 7,\n];\n\nexport function getAvatarUri(\n\temail: string | undefined,\n\trepoPathOrCommit: string | GitRevisionReference | undefined,\n\t{ defaultStyle, size = 16 }: { defaultStyle?: GravatarDefaultStyle; size?: number } = {},\n): Uri | Promise<Uri> {\n\tensureAvatarCache(avatarCache);\n\n\tif (email == null || email.length === 0) {\n\t\tconst avatar = createOrUpdateAvatar(\n\t\t\t`${missingGravatarHash}:${size}`,\n\t\t\tundefined,\n\t\t\tmissingGravatarHash,\n\t\t\tsize,\n\t\t\tdefaultStyle,\n\t\t);\n\t\treturn avatar.uri ?? avatar.fallback!;\n\t}\n\n\tconst hash = Strings.md5(email.trim().toLowerCase(), 'hex');\n\tconst key = `${hash}:${size}`;\n\n\tconst avatar = createOrUpdateAvatar(\n\t\tkey,\n\t\tgetAvatarUriFromGitHubNoReplyAddress(email, size),\n\t\thash,\n\t\tsize,\n\t\tdefaultStyle,\n\t);\n\tif (avatar.uri != null) return avatar.uri;\n\n\tlet query = avatarQueue.get(key);\n\tif (query == null && repoPathOrCommit != null && hasAvatarExpired(avatar)) {\n\t\tquery = getAvatarUriFromRemoteProvider(avatar, key, email, repoPathOrCommit, { size: size }).then(\n\t\t\turi => uri ?? avatar.uri ?? avatar.fallback!,\n\t\t);\n\t\tavatarQueue.set(\n\t\t\tkey,\n\t\t\tquery.finally(() => avatarQueue.delete(key)),\n\t\t);\n\t}\n\n\tif (query != null) return query;\n\n\treturn avatar.uri ?? avatar.fallback!;\n}\n\nfunction createOrUpdateAvatar(\n\tkey: string,\n\turi: Uri | undefined,\n\thash: string,\n\tsize: number,\n\tdefaultStyle?: GravatarDefaultStyle,\n): Avatar {\n\tlet avatar = avatarCache!.get(key);\n\tif (avatar == null) {\n\t\tavatar = {\n\t\t\turi: uri,\n\t\t\tfallback: getAvatarUriFromGravatar(hash, size, defaultStyle),\n\t\t\ttimestamp: 0,\n\t\t\tretries: 0,\n\t\t};\n\t\tavatarCache!.set(key, avatar);\n\t} else if (avatar.fallback == null) {\n\t\tavatar.fallback = getAvatarUriFromGravatar(hash, size, defaultStyle);\n\t}\n\treturn avatar;\n}\n\nfunction ensureAvatarCache(cache: Map<string, Avatar> | undefined): asserts cache is Map<string, Avatar> {\n\tif (cache == null) {\n\t\tconst avatars: [string, Avatar][] | undefined = Container.context.globalState\n\t\t\t.get<[string, SerializedAvatar][]>(GlobalState.Avatars)\n\t\t\t?.map<[string, Avatar]>(([key, avatar]) => [\n\t\t\t\tkey,\n\t\t\t\t{\n\t\t\t\t\turi: Uri.parse(avatar.uri),\n\t\t\t\t\ttimestamp: avatar.timestamp,\n\t\t\t\t\tretries: 0,\n\t\t\t\t},\n\t\t\t]);\n\t\tavatarCache = new Map<string, Avatar>(avatars);\n\t}\n}\n\nfunction hasAvatarExpired(avatar: Avatar) {\n\treturn Date.now() >= avatar.timestamp + retryDecay[Math.min(avatar.retries, retryDecay.length - 1)];\n}\n\nfunction getAvatarUriFromGravatar(\n\thash: string,\n\tsize: number,\n\tdefaultStyle: GravatarDefaultStyle = GravatarDefaultStyle.Robot,\n): Uri {\n\treturn Uri.parse(`https://www.gravatar.com/avatar/${hash}.jpg?s=${size}&d=${defaultStyle}`);\n}\n\nfunction getAvatarUriFromGitHubNoReplyAddress(email: string, size: number = 16): Uri | undefined {\n\tconst match = gitHubNoReplyAddressRegex.exec(email);\n\tif (match == null) return undefined;\n\n\tconst [, userId, userName] = match;\n\treturn Uri.parse(`https://avatars.githubusercontent.com/${userId ? `u/${userId}` : userName}?size=${size}`);\n}\n\nasync function getAvatarUriFromRemoteProvider(\n\tavatar: Avatar,\n\tkey: string,\n\temail: string,\n\trepoPathOrCommit: string | GitRevisionReference,\n\t{ size = 16 }: { size?: number } = {},\n) {\n\tensureAvatarCache(avatarCache);\n\n\ttry {\n\t\tlet account;\n\t\tif (Container.config.integrations.enabled) {\n\t\t\t// if (typeof repoPathOrCommit === 'string') {\n\t\t\t// \tconst remote = await Container.git.getRichRemoteProvider(repoPathOrCommit);\n\t\t\t// \taccount = await remote?.provider.getAccountForEmail(email, { avatarSize: size });\n\t\t\t// } else {\n\t\t\tif (typeof repoPathOrCommit !== 'string') {\n\t\t\t\tconst remote = await Container.git.getRichRemoteProvider(repoPathOrCommit.repoPath);\n\t\t\t\taccount = await remote?.provider.getAccountForCommit(repoPathOrCommit.ref, { avatarSize: size });\n\t\t\t}\n\t\t}\n\t\tif (account == null) {\n\t\t\t// If we have no account assume that won't change (without a reset), so set the timestamp to \"never expire\"\n\t\t\tavatar.uri = undefined;\n\t\t\tavatar.timestamp = Number.MAX_SAFE_INTEGER;\n\t\t\tavatar.retries = 0;\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\tavatar.uri = Uri.parse(account.avatarUrl);\n\t\tavatar.timestamp = Date.now();\n\t\tavatar.retries = 0;\n\n\t\tif (account.email != null && Strings.equalsIgnoreCase(email, account.email)) {\n\t\t\tavatarCache.set(`${Strings.md5(account.email.trim().toLowerCase(), 'hex')}:${size}`, { ...avatar });\n\t\t}\n\n\t\t_onDidFetchAvatar.fire({ email: email });\n\n\t\treturn avatar.uri;\n\t} catch {\n\t\tavatar.uri = undefined;\n\t\tavatar.timestamp = Date.now();\n\t\tavatar.retries++;\n\n\t\treturn undefined;\n\t}\n}\n\nexport function getPresenceDataUri(status: ContactPresenceStatus) {\n\tlet dataUri = presenceCache.get(status);\n\tif (dataUri == null) {\n\t\tconst contents = fs\n\t\t\t.readFileSync(Container.context.asAbsolutePath(`images/dark/icon-presence-${status}.svg`))\n\t\t\t.toString('base64');\n\n\t\tdataUri = encodeURI(`data:image/svg+xml;base64,${contents}`);\n\t\tpresenceCache.set(status, dataUri);\n\t}\n\n\treturn dataUri;\n}\n\nexport function resetAvatarCache(reset: 'all' | 'failed' | 'fallback') {\n\tswitch (reset) {\n\t\tcase 'all':\n\t\t\tvoid Container.context.globalState.update(GlobalState.Avatars, undefined);\n\t\t\tavatarCache?.clear();\n\t\t\tavatarQueue.clear();\n\t\t\tbreak;\n\n\t\tcase 'failed':\n\t\t\tfor (const avatar of avatarCache?.values() ?? []) {\n\t\t\t\t// Reset failed requests\n\t\t\t\tif (avatar.uri == null) {\n\t\t\t\t\tavatar.timestamp = 0;\n\t\t\t\t\tavatar.retries = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'fallback':\n\t\t\tfor (const avatar of avatarCache?.values() ?? []) {\n\t\t\t\tavatar.fallback = undefined;\n\t\t\t}\n\t\t\tbreak;\n\t}\n}\n","'use strict';\nimport { QuickInputButtons } from 'vscode';\nimport { Container } from '../../container';\nimport { GitBranchReference, GitReference, Repository } from '../../git/git';\nimport { FlagsQuickPickItem, QuickPickItemOfT } from '../../quickpicks';\nimport { Strings } from '../../system';\nimport {\n\tappendReposToTitle,\n\tAsyncStepResultGenerator,\n\tinputBranchNameStep,\n\tPartialStepState,\n\tpickBranchesStep,\n\tpickBranchOrTagStep,\n\tpickBranchStep,\n\tpickRepositoryStep,\n\tQuickCommand,\n\tQuickPickStep,\n\tStepGenerator,\n\tStepResult,\n\tStepResultGenerator,\n\tStepSelection,\n\tStepState,\n} from '../quickCommand';\n\ninterface Context {\n\trepos: Repository[];\n\tshowTags: boolean;\n\ttitle: string;\n}\n\ntype CreateFlags = '--switch';\n\ninterface CreateState {\n\tsubcommand: 'create';\n\trepo: string | Repository;\n\treference: GitReference;\n\tname: string;\n\tflags: CreateFlags[];\n}\n\ntype DeleteFlags = '--force' | '--remotes';\n\ninterface DeleteState {\n\tsubcommand: 'delete';\n\trepo: string | Repository;\n\treferences: GitBranchReference | GitBranchReference[];\n\tflags: DeleteFlags[];\n}\n\ntype RenameFlags = '-m';\n\ninterface RenameState {\n\tsubcommand: 'rename';\n\trepo: string | Repository;\n\treference: GitBranchReference;\n\tname: string;\n\tflags: RenameFlags[];\n}\n\ntype State = CreateState | DeleteState | RenameState;\ntype BranchStepState<T extends State> = SomeNonNullable<StepState<T>, 'subcommand'>;\ntype CreateStepState<T extends CreateState = CreateState> = BranchStepState<ExcludeSome<T, 'repo', string>>;\ntype DeleteStepState<T extends DeleteState = DeleteState> = BranchStepState<ExcludeSome<T, 'repo', string>>;\ntype RenameStepState<T extends RenameState = RenameState> = BranchStepState<ExcludeSome<T, 'repo', string>>;\n\nconst subcommandToTitleMap = new Map<State['subcommand'], string>([\n\t['create', 'Create'],\n\t['delete', 'Delete'],\n\t['rename', 'Rename'],\n]);\nfunction getTitle(title: string, subcommand: State['subcommand'] | undefined) {\n\treturn subcommand == null ? title : `${subcommandToTitleMap.get(subcommand)} ${title}`;\n}\n\nexport interface BranchGitCommandArgs {\n\treadonly command: 'branch';\n\tconfirm?: boolean;\n\tstate?: Partial<State>;\n}\n\nexport class BranchGitCommand extends QuickCommand<State> {\n\tprivate subcommand: State['subcommand'] | undefined;\n\n\tconstructor(args?: BranchGitCommandArgs) {\n\t\tsuper('branch', 'branch', 'Branch', {\n\t\t\tdescription: 'create, rename, or delete branches',\n\t\t});\n\n\t\tlet counter = 0;\n\t\tif (args?.state?.subcommand != null) {\n\t\t\tcounter++;\n\n\t\t\tswitch (args?.state.subcommand) {\n\t\t\t\tcase 'create':\n\t\t\t\t\tif (args.state.reference != null) {\n\t\t\t\t\t\tcounter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (args.state.name != null) {\n\t\t\t\t\t\tcounter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'delete':\n\t\t\t\t\tif (\n\t\t\t\t\t\targs.state.references != null &&\n\t\t\t\t\t\t(!Array.isArray(args.state.references) || args.state.references.length !== 0)\n\t\t\t\t\t) {\n\t\t\t\t\t\tcounter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'rename':\n\t\t\t\t\tif (args.state.reference != null) {\n\t\t\t\t\t\tcounter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (args.state.name != null) {\n\t\t\t\t\t\tcounter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (args?.state?.repo != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis.initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: args?.confirm,\n\t\t\t...args?.state,\n\t\t};\n\t}\n\n\toverride get canConfirm(): boolean {\n\t\treturn this.subcommand != null;\n\t}\n\n\toverride get canSkipConfirm(): boolean {\n\t\treturn this.subcommand === 'delete' || this.subcommand === 'rename' ? false : super.canSkipConfirm;\n\t}\n\n\toverride get skipConfirmKey() {\n\t\treturn `${this.key}${this.subcommand == null ? '' : `-${this.subcommand}`}:${this.pickedVia}`;\n\t}\n\n\tprotected async *steps(state: PartialStepState<State>): StepGenerator {\n\t\tconst context: Context = {\n\t\t\trepos: [...(await Container.git.getOrderedRepositories())],\n\t\t\tshowTags: false,\n\t\t\ttitle: this.title,\n\t\t};\n\n\t\tlet skippedStepTwo = false;\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tcontext.title = this.title;\n\n\t\t\tif (state.counter < 1 || state.subcommand == null) {\n\t\t\t\tthis.subcommand = undefined;\n\n\t\t\t\tconst result = yield* this.pickSubcommandStep(state);\n\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\tstate.subcommand = result;\n\t\t\t}\n\n\t\t\tthis.subcommand = state.subcommand;\n\n\t\t\tcontext.title = getTitle(state.subcommand === 'delete' ? 'Branches' : this.title, state.subcommand);\n\n\t\t\tif (state.counter < 2 || state.repo == null || typeof state.repo === 'string') {\n\t\t\t\tskippedStepTwo = false;\n\t\t\t\tif (context.repos.length === 1) {\n\t\t\t\t\tskippedStepTwo = true;\n\t\t\t\t\tstate.counter++;\n\n\t\t\t\t\tstate.repo = context.repos[0];\n\t\t\t\t} else {\n\t\t\t\t\tconst result = yield* pickRepositoryStep(state, context);\n\t\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\t\tstate.repo = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tswitch (state.subcommand) {\n\t\t\t\tcase 'create':\n\t\t\t\t\tyield* this.createCommandSteps(state as CreateStepState, context);\n\t\t\t\t\t// Clear any chosen name, since we are exiting this subcommand\n\t\t\t\t\tstate.name = undefined;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'delete':\n\t\t\t\t\tyield* this.deleteCommandSteps(state as DeleteStepState, context);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'rename':\n\t\t\t\t\tyield* this.renameCommandSteps(state as RenameStepState, context);\n\t\t\t\t\t// Clear any chosen name, since we are exiting this subcommand\n\t\t\t\t\tstate.name = undefined;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tQuickCommand.endSteps(state);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// If we skipped the previous step, make sure we back up past it\n\t\t\tif (skippedStepTwo) {\n\t\t\t\tstate.counter--;\n\t\t\t}\n\t\t}\n\n\t\treturn state.counter < 0 ? StepResult.Break : undefined;\n\t}\n\n\tprivate *pickSubcommandStep(state: PartialStepState<State>): StepResultGenerator<State['subcommand']> {\n\t\tconst step = QuickCommand.createPickStep<QuickPickItemOfT<State['subcommand']>>({\n\t\t\ttitle: this.title,\n\t\t\tplaceholder: `Choose a ${this.label} command`,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'create',\n\t\t\t\t\tdescription: 'creates a new branch',\n\t\t\t\t\tpicked: state.subcommand === 'create',\n\t\t\t\t\titem: 'create',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'delete',\n\t\t\t\t\tdescription: 'deletes the specified branches',\n\t\t\t\t\tpicked: state.subcommand === 'delete',\n\t\t\t\t\titem: 'delete',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'rename',\n\t\t\t\t\tdescription: 'renames the specified branch',\n\t\t\t\t\tpicked: state.subcommand === 'rename',\n\t\t\t\t\titem: 'rename',\n\t\t\t\t},\n\t\t\t],\n\t\t\tbuttons: [QuickInputButtons.Back],\n\t\t});\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n\t}\n\n\tprivate async *createCommandSteps(state: CreateStepState, context: Context): AsyncStepResultGenerator<void> {\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tif (state.counter < 3 || state.reference == null) {\n\t\t\t\tconst result = yield* pickBranchOrTagStep(state, context, {\n\t\t\t\t\tplaceholder: context =>\n\t\t\t\t\t\t`Choose a branch${context.showTags ? ' or tag' : ''} to create the new branch from`,\n\t\t\t\t\tpicked: state.reference?.ref ?? (await state.repo.getBranch())?.ref,\n\t\t\t\t\ttitleContext: ' from',\n\t\t\t\t\tvalue: GitReference.isRevision(state.reference) ? state.reference.ref : undefined,\n\t\t\t\t});\n\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\tstate.reference = result;\n\t\t\t}\n\n\t\t\tif (state.counter < 4 || state.name == null) {\n\t\t\t\tconst result = yield* inputBranchNameStep(state, context, {\n\t\t\t\t\tplaceholder: 'Please provide a name for the new branch',\n\t\t\t\t\ttitleContext: ` from ${GitReference.toString(state.reference, {\n\t\t\t\t\t\tcapitalize: true,\n\t\t\t\t\t\ticon: false,\n\t\t\t\t\t\tlabel: state.reference.refType !== 'branch',\n\t\t\t\t\t})}`,\n\t\t\t\t\tvalue: state.name ?? GitReference.getNameWithoutRemote(state.reference),\n\t\t\t\t});\n\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\tstate.name = result;\n\t\t\t}\n\n\t\t\tif (this.confirm(state.confirm)) {\n\t\t\t\tconst result = yield* this.createCommandConfirmStep(state, context);\n\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\tstate.flags = result;\n\t\t\t}\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\tif (state.flags.includes('--switch')) {\n\t\t\t\tvoid (await state.repo.switch(state.reference.ref, { createBranch: state.name }));\n\t\t\t} else {\n\t\t\t\tvoid state.repo.branch(...state.flags, state.name, state.reference.ref);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate *createCommandConfirmStep(\n\t\tstate: CreateStepState<CreateState>,\n\t\tcontext: Context,\n\t): StepResultGenerator<CreateFlags[]> {\n\t\tconst step: QuickPickStep<FlagsQuickPickItem<CreateFlags>> = QuickCommand.createConfirmStep(\n\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t[\n\t\t\t\tFlagsQuickPickItem.create<CreateFlags>(state.flags, [], {\n\t\t\t\t\tlabel: context.title,\n\t\t\t\t\tdetail: `Will create a new branch named ${state.name} from ${GitReference.toString(\n\t\t\t\t\t\tstate.reference,\n\t\t\t\t\t)}`,\n\t\t\t\t}),\n\t\t\t\tFlagsQuickPickItem.create<CreateFlags>(state.flags, ['--switch'], {\n\t\t\t\t\tlabel: `${context.title} and Switch`,\n\t\t\t\t\tdescription: '--switch',\n\t\t\t\t\tdetail: `Will create and switch to a new branch named ${state.name} from ${GitReference.toString(\n\t\t\t\t\t\tstate.reference,\n\t\t\t\t\t)}`,\n\t\t\t\t}),\n\t\t\t],\n\t\t\tcontext,\n\t\t);\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n\t}\n\n\tprivate async *deleteCommandSteps(state: DeleteStepState, context: Context): AsyncStepResultGenerator<void> {\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tif (state.references != null && !Array.isArray(state.references)) {\n\t\t\t\tstate.references = [state.references];\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tstate.counter < 3 ||\n\t\t\t\tstate.references == null ||\n\t\t\t\t(Array.isArray(state.references) && state.references.length === 0)\n\t\t\t) {\n\t\t\t\tcontext.title = getTitle('Branches', state.subcommand);\n\n\t\t\t\tconst result = yield* pickBranchesStep(state, context, {\n\t\t\t\t\tfilter: b => !b.current,\n\t\t\t\t\tpicked: state.references?.map(r => r.ref),\n\t\t\t\t\tplaceholder: 'Choose branches to delete',\n\t\t\t\t\tsort: { current: false, missingUpstream: true },\n\t\t\t\t});\n\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\tstate.references = result;\n\t\t\t}\n\n\t\t\tcontext.title = getTitle(\n\t\t\t\tStrings.pluralize('Branch', state.references.length, {\n\t\t\t\t\tnumber: '',\n\t\t\t\t\tplural: 'Branches',\n\t\t\t\t}).trim(),\n\t\t\t\tstate.subcommand,\n\t\t\t);\n\n\t\t\tconst result = yield* this.deleteCommandConfirmStep(\n\t\t\t\tstate as ExcludeSome<typeof state, 'references', GitBranchReference>,\n\t\t\t\tcontext,\n\t\t\t);\n\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\tstate.flags = result;\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\tvoid state.repo.branchDelete(state.references, {\n\t\t\t\tforce: state.flags.includes('--force'),\n\t\t\t\tremote: state.flags.includes('--remotes'),\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate *deleteCommandConfirmStep(\n\t\tstate: DeleteStepState<ExcludeSome<DeleteState, 'references', GitBranchReference>>,\n\t\tcontext: Context,\n\t): StepResultGenerator<DeleteFlags[]> {\n\t\tconst confirmations: FlagsQuickPickItem<DeleteFlags>[] = [\n\t\t\tFlagsQuickPickItem.create<DeleteFlags>(state.flags, [], {\n\t\t\t\tlabel: context.title,\n\t\t\t\tdetail: `Will delete ${GitReference.toString(state.references)}`,\n\t\t\t}),\n\t\t];\n\t\tif (!state.references.every(b => b.remote)) {\n\t\t\tconfirmations.push(\n\t\t\t\tFlagsQuickPickItem.create<DeleteFlags>(state.flags, ['--force'], {\n\t\t\t\t\tlabel: `Force ${context.title}`,\n\t\t\t\t\tdescription: '--force',\n\t\t\t\t\tdetail: `Will forcibly delete ${GitReference.toString(state.references)}`,\n\t\t\t\t}),\n\t\t\t);\n\n\t\t\tif (state.references.some(b => b.upstream != null)) {\n\t\t\t\tconfirmations.push(\n\t\t\t\t\tFlagsQuickPickItem.create<DeleteFlags>(state.flags, ['--remotes'], {\n\t\t\t\t\t\tlabel: `${context.title} & Remote${\n\t\t\t\t\t\t\tstate.references.filter(b => !b.remote).length > 1 ? 's' : ''\n\t\t\t\t\t\t}`,\n\t\t\t\t\t\tdescription: '--remotes',\n\t\t\t\t\t\tdetail: `Will delete ${GitReference.toString(\n\t\t\t\t\t\t\tstate.references,\n\t\t\t\t\t\t)} and any remote tracking branches`,\n\t\t\t\t\t}),\n\t\t\t\t\tFlagsQuickPickItem.create<DeleteFlags>(state.flags, ['--force', '--remotes'], {\n\t\t\t\t\t\tlabel: `Force ${context.title} & Remote${\n\t\t\t\t\t\t\tstate.references.filter(b => !b.remote).length > 1 ? 's' : ''\n\t\t\t\t\t\t}`,\n\t\t\t\t\t\tdescription: '--force --remotes',\n\t\t\t\t\t\tdetail: `Will forcibly delete ${GitReference.toString(\n\t\t\t\t\t\t\tstate.references,\n\t\t\t\t\t\t)} and any remote tracking branches`,\n\t\t\t\t\t}),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst step: QuickPickStep<FlagsQuickPickItem<DeleteFlags>> = QuickCommand.createConfirmStep(\n\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\tconfirmations,\n\t\t\tcontext,\n\t\t);\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n\t}\n\n\tprivate async *renameCommandSteps(state: RenameStepState, context: Context): AsyncStepResultGenerator<void> {\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tif (state.counter < 3 || state.reference == null) {\n\t\t\t\tconst result = yield* pickBranchStep(state, context, {\n\t\t\t\t\tfilter: b => !b.remote,\n\t\t\t\t\tpicked: state.reference?.ref,\n\t\t\t\t\tplaceholder: 'Choose a branch to rename',\n\t\t\t\t});\n\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\tstate.reference = result;\n\t\t\t}\n\n\t\t\tif (state.counter < 4 || state.name == null) {\n\t\t\t\tconst result = yield* inputBranchNameStep(state, context, {\n\t\t\t\t\tplaceholder: `Please provide a new name for ${GitReference.toString(state.reference, {\n\t\t\t\t\t\ticon: false,\n\t\t\t\t\t})}`,\n\t\t\t\t\ttitleContext: ` ${GitReference.toString(state.reference, false)}`,\n\t\t\t\t\tvalue: state.name ?? state.reference.name,\n\t\t\t\t});\n\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\tstate.name = result;\n\t\t\t}\n\n\t\t\tconst result = yield* this.renameCommandConfirmStep(state, context);\n\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\tstate.flags = result;\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\tvoid state.repo.branch(...state.flags, state.reference.ref, state.name);\n\t\t}\n\t}\n\n\tprivate *renameCommandConfirmStep(\n\t\tstate: RenameStepState<RenameState>,\n\t\tcontext: Context,\n\t): StepResultGenerator<RenameFlags[]> {\n\t\tconst step: QuickPickStep<FlagsQuickPickItem<RenameFlags>> = QuickCommand.createConfirmStep(\n\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t[\n\t\t\t\tFlagsQuickPickItem.create<RenameFlags>(state.flags, ['-m'], {\n\t\t\t\t\tlabel: context.title,\n\t\t\t\t\tdetail: `Will rename ${GitReference.toString(state.reference)} to ${state.name}`,\n\t\t\t\t}),\n\t\t\t],\n\t\t\tcontext,\n\t\t);\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n\t}\n}\n","'use strict';\nimport { Container } from '../../container';\nimport { GitBranch, GitLog, GitReference, GitRevision, Repository } from '../../git/git';\nimport { FlagsQuickPickItem } from '../../quickpicks';\nimport {\n\tappendReposToTitle,\n\tPartialStepState,\n\tpickBranchOrTagStep,\n\tpickCommitsStep,\n\tpickRepositoryStep,\n\tQuickCommand,\n\tQuickPickStep,\n\tStepGenerator,\n\tStepResult,\n\tStepResultGenerator,\n\tStepSelection,\n\tStepState,\n} from '../quickCommand';\n\ninterface Context {\n\trepos: Repository[];\n\tcache: Map<string, Promise<GitLog | undefined>>;\n\tdestination: GitBranch;\n\tselectedBranchOrTag: GitReference | undefined;\n\tshowTags: boolean;\n\ttitle: string;\n}\n\ntype Flags = '--edit';\n\ninterface State<Refs = GitReference | GitReference[]> {\n\trepo: string | Repository;\n\treferences: Refs;\n\tflags: Flags[];\n}\n\nexport interface CherryPickGitCommandArgs {\n\treadonly command: 'cherry-pick';\n\tstate?: Partial<State>;\n}\n\ntype CherryPickStepState<T extends State = State> = ExcludeSome<StepState<T>, 'repo', string>;\n\nexport class CherryPickGitCommand extends QuickCommand<State> {\n\tconstructor(args?: CherryPickGitCommandArgs) {\n\t\tsuper('cherry-pick', 'cherry-pick', 'Cherry Pick', {\n\t\t\tdescription: 'integrates changes from specified commits into the current branch',\n\t\t});\n\n\t\tlet counter = 0;\n\t\tif (args?.state?.repo != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (\n\t\t\targs?.state?.references != null &&\n\t\t\t(!Array.isArray(args.state.references) || args.state.references.length !== 0)\n\t\t) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis.initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: true,\n\t\t\t...args?.state,\n\t\t};\n\t}\n\n\toverride get canSkipConfirm(): boolean {\n\t\treturn false;\n\t}\n\n\texecute(state: CherryPickStepState<State<GitReference[]>>) {\n\t\tstate.repo.cherryPick(...state.flags, ...state.references.map(c => c.ref).reverse());\n\t}\n\n\toverride isFuzzyMatch(name: string) {\n\t\treturn super.isFuzzyMatch(name) || name === 'cherry';\n\t}\n\n\tprotected async *steps(state: PartialStepState<State>): StepGenerator {\n\t\tconst context: Context = {\n\t\t\trepos: [...(await Container.git.getOrderedRepositories())],\n\t\t\tcache: new Map<string, Promise<GitLog | undefined>>(),\n\t\t\tdestination: undefined!,\n\t\t\tselectedBranchOrTag: undefined,\n\t\t\tshowTags: true,\n\t\t\ttitle: this.title,\n\t\t};\n\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\tif (state.references != null && !Array.isArray(state.references)) {\n\t\t\tstate.references = [state.references];\n\t\t}\n\n\t\tlet skippedStepOne = false;\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tcontext.title = this.title;\n\n\t\t\tif (state.counter < 1 || state.repo == null || typeof state.repo === 'string') {\n\t\t\t\tskippedStepOne = false;\n\t\t\t\tif (context.repos.length === 1) {\n\t\t\t\t\tskippedStepOne = true;\n\t\t\t\t\tif (state.repo == null) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.repo = context.repos[0];\n\t\t\t\t} else {\n\t\t\t\t\tconst result = yield* pickRepositoryStep(state, context);\n\t\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\t\tstate.repo = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (context.destination == null) {\n\t\t\t\tconst branch = await state.repo.getBranch();\n\t\t\t\tif (branch == null) break;\n\n\t\t\t\tcontext.destination = branch;\n\t\t\t}\n\n\t\t\tcontext.title = `${this.title} into ${GitReference.toString(context.destination, { icon: false })}`;\n\n\t\t\tif (state.counter < 2 || state.references == null || state.references.length === 0) {\n\t\t\t\tconst result: StepResult<GitReference> = yield* pickBranchOrTagStep(\n\t\t\t\t\tstate as CherryPickStepState,\n\t\t\t\t\tcontext,\n\t\t\t\t\t{\n\t\t\t\t\t\tfilter: { branches: b => b.id !== context.destination.id },\n\t\t\t\t\t\tplaceholder: context =>\n\t\t\t\t\t\t\t`Choose a branch${context.showTags ? ' or tag' : ''} to cherry-pick from`,\n\t\t\t\t\t\tpicked: context.selectedBranchOrTag?.ref,\n\t\t\t\t\t\tvalue: context.selectedBranchOrTag == null ? state.references?.[0]?.ref : undefined,\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t\tif (result === StepResult.Break) {\n\t\t\t\t\t// If we skipped the previous step, make sure we back up past it\n\t\t\t\t\tif (skippedStepOne) {\n\t\t\t\t\t\tstate.counter--;\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (GitReference.isRevision(result)) {\n\t\t\t\t\tstate.references = [result];\n\t\t\t\t\tcontext.selectedBranchOrTag = undefined;\n\t\t\t\t} else {\n\t\t\t\t\tcontext.selectedBranchOrTag = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (state.counter < 3 && context.selectedBranchOrTag != null) {\n\t\t\t\tconst ref = GitRevision.createRange(context.destination.ref, context.selectedBranchOrTag.ref);\n\n\t\t\t\tlet log = context.cache.get(ref);\n\t\t\t\tif (log == null) {\n\t\t\t\t\tlog = Container.git.getLog(state.repo.path, { ref: ref, merges: false });\n\t\t\t\t\tcontext.cache.set(ref, log);\n\t\t\t\t}\n\n\t\t\t\tconst result: StepResult<GitReference[]> = yield* pickCommitsStep(\n\t\t\t\t\tstate as CherryPickStepState,\n\t\t\t\t\tcontext,\n\t\t\t\t\t{\n\t\t\t\t\t\tlog: await log,\n\t\t\t\t\t\tonDidLoadMore: log => context.cache.set(ref, Promise.resolve(log)),\n\t\t\t\t\t\tpicked: state.references?.map(r => r.ref),\n\t\t\t\t\t\tplaceholder: (context, log) =>\n\t\t\t\t\t\t\tlog == null\n\t\t\t\t\t\t\t\t? `No pickable commits found on ${GitReference.toString(context.selectedBranchOrTag, {\n\t\t\t\t\t\t\t\t\t\ticon: false,\n\t\t\t\t\t\t\t\t  })}`\n\t\t\t\t\t\t\t\t: `Choose commits to cherry-pick into ${GitReference.toString(context.destination, {\n\t\t\t\t\t\t\t\t\t\ticon: false,\n\t\t\t\t\t\t\t\t  })}`,\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\tstate.references = result;\n\t\t\t}\n\n\t\t\tif (this.confirm(state.confirm)) {\n\t\t\t\tconst result = yield* this.confirmStep(state as CherryPickStepState, context);\n\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\tstate.flags = result;\n\t\t\t}\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\tthis.execute(state as CherryPickStepState<State<GitReference[]>>);\n\t\t}\n\n\t\treturn state.counter < 0 ? StepResult.Break : undefined;\n\t}\n\n\tprivate *confirmStep(state: CherryPickStepState, context: Context): StepResultGenerator<Flags[]> {\n\t\tconst step: QuickPickStep<FlagsQuickPickItem<Flags>> = QuickCommand.createConfirmStep(\n\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t[\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\tlabel: this.title,\n\t\t\t\t\tdetail: `Will apply ${GitReference.toString(state.references)} to ${GitReference.toString(\n\t\t\t\t\t\tcontext.destination,\n\t\t\t\t\t)}`,\n\t\t\t\t}),\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--edit'], {\n\t\t\t\t\tlabel: `${this.title} & Edit`,\n\t\t\t\t\tdescription: '--edit',\n\t\t\t\t\tdetail: `Will edit and apply ${GitReference.toString(state.references)} to ${GitReference.toString(\n\t\t\t\t\t\tcontext.destination,\n\t\t\t\t\t)}`,\n\t\t\t\t}),\n\t\t\t],\n\t\t\tcontext,\n\t\t);\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n\t}\n}\n","'use strict';\nimport { commands } from 'vscode';\nimport { Container } from '../../container';\nimport { GitContributor, Repository } from '../../git/git';\nimport { GitService } from '../../git/gitService';\nimport { Strings } from '../../system';\nimport {\n\tPartialStepState,\n\tpickContributorsStep,\n\tpickRepositoryStep,\n\tQuickCommand,\n\tStepGenerator,\n\tStepResult,\n\tStepState,\n} from '../quickCommand';\n\ninterface Context {\n\trepos: Repository[];\n\tactiveRepo: Repository | undefined;\n\ttitle: string;\n}\n\ninterface State {\n\trepo: string | Repository;\n\tcontributors: GitContributor | GitContributor[];\n}\n\nexport interface CoAuthorsGitCommandArgs {\n\treadonly command: 'co-authors';\n\tstate?: Partial<State>;\n}\n\ntype CoAuthorStepState<T extends State = State> = ExcludeSome<StepState<T>, 'repo', string>;\n\nexport class CoAuthorsGitCommand extends QuickCommand<State> {\n\tconstructor(args?: CoAuthorsGitCommandArgs) {\n\t\tsuper('co-authors', 'co-authors', 'Add Co-Authors', { description: 'adds co-authors to a commit message' });\n\n\t\tlet counter = 0;\n\t\tif (args?.state?.repo != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (\n\t\t\targs?.state?.contributors != null &&\n\t\t\t(!Array.isArray(args.state.contributors) || args.state.contributors.length !== 0)\n\t\t) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis.initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: false,\n\t\t\t...args?.state,\n\t\t};\n\t}\n\n\toverride get canConfirm() {\n\t\treturn false;\n\t}\n\n\tasync execute(state: CoAuthorStepState) {\n\t\tconst repo = await GitService.getOrOpenBuiltInGitRepository(state.repo.path);\n\t\tif (repo == null) return;\n\n\t\tlet message = repo.inputBox.value;\n\n\t\tconst index = message.indexOf('Co-authored-by: ');\n\t\tif (index !== -1) {\n\t\t\tmessage = message.substring(0, index - 1).trimRight();\n\t\t}\n\n\t\tif (state.contributors != null && !Array.isArray(state.contributors)) {\n\t\t\tstate.contributors = [state.contributors];\n\t\t}\n\n\t\tfor (const c of state.contributors) {\n\t\t\tlet newlines;\n\t\t\tif (message.includes('Co-authored-by: ')) {\n\t\t\t\tnewlines = '\\n';\n\t\t\t} else if (message.length !== 0 && message.endsWith('\\n')) {\n\t\t\t\tnewlines = '\\n\\n';\n\t\t\t} else {\n\t\t\t\tnewlines = '\\n\\n\\n';\n\t\t\t}\n\n\t\t\tmessage += `${newlines}Co-authored-by: ${c.toCoauthor()}`;\n\t\t}\n\n\t\trepo.inputBox.value = message;\n\t\tvoid (await commands.executeCommand('workbench.view.scm'));\n\t}\n\n\tprotected async *steps(state: PartialStepState<State>): StepGenerator {\n\t\tconst context: Context = {\n\t\t\trepos: [...(await Container.git.getOrderedRepositories())],\n\t\t\tactiveRepo: undefined,\n\t\t\ttitle: this.title,\n\t\t};\n\n\t\tconst gitApi = await GitService.getBuiltInGitApi();\n\t\tif (gitApi != null) {\n\t\t\t// Filter out any repo's that are not known to the built-in git\n\t\t\tcontext.repos = context.repos.filter(repo =>\n\t\t\t\tgitApi.repositories.find(r => Strings.normalizePath(r.rootUri.fsPath) === repo.path),\n\t\t\t);\n\n\t\t\t// Ensure that the active repo is known to the built-in git\n\t\t\tcontext.activeRepo = await Container.git.getActiveRepository();\n\t\t\tif (\n\t\t\t\tcontext.activeRepo != null &&\n\t\t\t\t!gitApi.repositories.some(r => r.rootUri.fsPath === context.activeRepo!.path)\n\t\t\t) {\n\t\t\t\tcontext.activeRepo = undefined;\n\t\t\t}\n\t\t}\n\n\t\tlet skippedStepOne = false;\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tcontext.title = this.title;\n\n\t\t\tif (state.counter < 1 || state.repo == null || typeof state.repo === 'string') {\n\t\t\t\tskippedStepOne = false;\n\t\t\t\tif (context.repos.length === 1) {\n\t\t\t\t\tskippedStepOne = true;\n\t\t\t\t\tif (state.repo == null) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.repo = context.repos[0];\n\t\t\t\t} else {\n\t\t\t\t\tconst result = yield* pickRepositoryStep(state, context);\n\t\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\t\tstate.repo = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (state.counter < 2 || state.contributors == null) {\n\t\t\t\tconst result = yield* pickContributorsStep(\n\t\t\t\t\tstate as CoAuthorStepState,\n\t\t\t\t\tcontext,\n\t\t\t\t\t'Choose contributors to add as co-authors',\n\t\t\t\t);\n\t\t\t\tif (result === StepResult.Break) {\n\t\t\t\t\t// If we skipped the previous step, make sure we back up past it\n\t\t\t\t\tif (skippedStepOne) {\n\t\t\t\t\t\tstate.counter--;\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tstate.contributors = result;\n\t\t\t}\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\tvoid this.execute(state as CoAuthorStepState);\n\t\t}\n\n\t\treturn state.counter < 0 ? StepResult.Break : undefined;\n\t}\n}\n","'use strict';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { GitBranchReference, GitReference, Repository } from '../../git/git';\nimport { FlagsQuickPickItem } from '../../quickpicks';\nimport { Arrays, Dates, Strings } from '../../system';\nimport {\n\tappendReposToTitle,\n\tAsyncStepResultGenerator,\n\tPartialStepState,\n\tpickRepositoriesStep,\n\tQuickCommand,\n\tQuickPickStep,\n\tStepGenerator,\n\tStepResult,\n\tStepSelection,\n\tStepState,\n} from '../quickCommand';\n\ninterface Context {\n\trepos: Repository[];\n\ttitle: string;\n}\n\ntype Flags = '--all' | '--prune';\n\ninterface State {\n\trepos: string | string[] | Repository | Repository[];\n\treference?: GitBranchReference;\n\tflags: Flags[];\n}\n\nexport interface FetchGitCommandArgs {\n\treadonly command: 'fetch';\n\tconfirm?: boolean;\n\tstate?: Partial<State>;\n}\n\ntype FetchStepState<T extends State = State> = ExcludeSome<StepState<T>, 'repos', string | string[] | Repository>;\n\nexport class FetchGitCommand extends QuickCommand<State> {\n\tconstructor(args?: FetchGitCommandArgs) {\n\t\tsuper('fetch', 'fetch', 'Fetch', { description: 'fetches changes from one or more remotes' });\n\n\t\tlet counter = 0;\n\t\tif (args?.state?.repos != null && (!Array.isArray(args.state.repos) || args.state.repos.length !== 0)) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis.initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: args?.confirm,\n\t\t\t...args?.state,\n\t\t};\n\t}\n\n\texecute(state: FetchStepState) {\n\t\tif (GitReference.isBranch(state.reference)) {\n\t\t\treturn state.repos[0].fetch({ branch: state.reference });\n\t\t}\n\n\t\treturn Container.git.fetchAll(state.repos, {\n\t\t\tall: state.flags.includes('--all'),\n\t\t\tprune: state.flags.includes('--prune'),\n\t\t});\n\t}\n\n\tprotected async *steps(state: PartialStepState<State>): StepGenerator {\n\t\tconst context: Context = {\n\t\t\trepos: [...(await Container.git.getOrderedRepositories())],\n\t\t\ttitle: this.title,\n\t\t};\n\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\tif (state.repos != null && !Array.isArray(state.repos)) {\n\t\t\tstate.repos = [state.repos as any];\n\t\t}\n\n\t\tlet skippedStepOne = false;\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tcontext.title = this.title;\n\n\t\t\tif (\n\t\t\t\tstate.counter < 1 ||\n\t\t\t\tstate.repos == null ||\n\t\t\t\tstate.repos.length === 0 ||\n\t\t\t\tArrays.isStringArray(state.repos)\n\t\t\t) {\n\t\t\t\tskippedStepOne = false;\n\t\t\t\tif (context.repos.length === 1) {\n\t\t\t\t\tskippedStepOne = true;\n\t\t\t\t\tstate.counter++;\n\n\t\t\t\t\tstate.repos = [context.repos[0]];\n\t\t\t\t} else {\n\t\t\t\t\tconst result = yield* pickRepositoriesStep(\n\t\t\t\t\t\tstate as ExcludeSome<typeof state, 'repos', string | Repository>,\n\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t{ skipIfPossible: state.counter >= 1 },\n\t\t\t\t\t);\n\t\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\t\tstate.repos = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.confirm(state.confirm)) {\n\t\t\t\tconst result = yield* this.confirmStep(state as FetchStepState, context);\n\t\t\t\tif (result === StepResult.Break) {\n\t\t\t\t\t// If we skipped the previous step, make sure we back up past it\n\t\t\t\t\tif (skippedStepOne) {\n\t\t\t\t\t\tstate.counter--;\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tstate.flags = result;\n\t\t\t}\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\tvoid this.execute(state as FetchStepState);\n\t\t}\n\n\t\treturn state.counter < 0 ? StepResult.Break : undefined;\n\t}\n\n\tprivate async *confirmStep(state: FetchStepState, context: Context): AsyncStepResultGenerator<Flags[]> {\n\t\tlet lastFetchedOn = '';\n\t\tif (state.repos.length === 1) {\n\t\t\tconst lastFetched = await state.repos[0].getLastFetched();\n\t\t\tif (lastFetched !== 0) {\n\t\t\t\tlastFetchedOn = `${Strings.pad(GlyphChars.Dot, 2, 2)}Last fetched ${Dates.getFormatter(\n\t\t\t\t\tnew Date(lastFetched),\n\t\t\t\t).fromNow()}`;\n\t\t\t}\n\t\t}\n\n\t\tlet step: QuickPickStep<FlagsQuickPickItem<Flags>>;\n\n\t\tif (state.repos.length === 1 && GitReference.isBranch(state.reference)) {\n\t\t\tstep = this.createConfirmStep(\n\t\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context, lastFetchedOn),\n\t\t\t\t[\n\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\t\tlabel: this.title,\n\t\t\t\t\t\tdetail: `Will fetch ${GitReference.toString(state.reference)}`,\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t);\n\t\t} else {\n\t\t\tconst reposToFetch =\n\t\t\t\tstate.repos.length === 1\n\t\t\t\t\t? `$(repo) ${state.repos[0].formattedName}`\n\t\t\t\t\t: `${state.repos.length} repositories`;\n\n\t\t\tstep = QuickCommand.createConfirmStep(\n\t\t\t\tappendReposToTitle(`Confirm ${this.title}`, state, context, lastFetchedOn),\n\t\t\t\t[\n\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\t\tlabel: this.title,\n\t\t\t\t\t\tdetail: `Will fetch ${reposToFetch}`,\n\t\t\t\t\t}),\n\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--prune'], {\n\t\t\t\t\t\tlabel: `${this.title} & Prune`,\n\t\t\t\t\t\tdescription: '--prune',\n\t\t\t\t\t\tdetail: `Will fetch and prune ${reposToFetch}`,\n\t\t\t\t\t}),\n\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--all'], {\n\t\t\t\t\t\tlabel: `${this.title} All`,\n\t\t\t\t\t\tdescription: '--all',\n\t\t\t\t\t\tdetail: `Will fetch all remotes of ${reposToFetch}`,\n\t\t\t\t\t}),\n\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--all', '--prune'], {\n\t\t\t\t\t\tlabel: `${this.title} All & Prune`,\n\t\t\t\t\t\tdescription: '--all --prune',\n\t\t\t\t\t\tdetail: `Will fetch and prune all remotes of ${reposToFetch}`,\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t\tcontext,\n\t\t\t);\n\t\t}\n\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n\t}\n}\n","'use strict';\nimport { GlyphChars, quickPickTitleMaxChars } from '../../constants';\nimport { Container } from '../../container';\nimport { GitLog, GitLogCommit, GitReference, Repository } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { Strings } from '../../system';\nimport { GitCommandsCommand } from '../gitCommands';\nimport {\n\tPartialStepState,\n\tpickBranchOrTagStep,\n\tpickCommitStep,\n\tpickRepositoryStep,\n\tQuickCommand,\n\tStepGenerator,\n\tStepResult,\n\tStepState,\n} from '../quickCommand';\n\ninterface Context {\n\trepos: Repository[];\n\tcache: Map<string, Promise<GitLog | undefined>>;\n\tselectedBranchOrTag: GitReference | undefined;\n\ttitle: string;\n}\n\ninterface State {\n\trepo: string | Repository;\n\treference: GitReference | 'HEAD';\n\n\tfileName?: string;\n}\n\ntype LogStepState<T extends State = State> = ExcludeSome<StepState<T>, 'repo', string>;\n\nexport interface LogGitCommandArgs {\n\treadonly command: 'log';\n\tstate?: Partial<State>;\n}\n\nexport class LogGitCommand extends QuickCommand<State> {\n\tconstructor(args?: LogGitCommandArgs) {\n\t\tsuper('log', 'history', 'Commits', {\n\t\t\tdescription: 'aka log, shows commit history',\n\t\t});\n\n\t\tlet counter = 0;\n\t\tif (args?.state?.repo != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (args?.state?.reference != null) {\n\t\t\tcounter++;\n\t\t\tif (\n\t\t\t\targs.state.reference !== 'HEAD' &&\n\t\t\t\tGitReference.isRevision(args.state.reference) &&\n\t\t\t\t!GitReference.isRevisionRange(args.state.reference)\n\t\t\t) {\n\t\t\t\tcounter++;\n\t\t\t}\n\t\t}\n\n\t\tthis.initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: false,\n\t\t\t...args?.state,\n\t\t};\n\t}\n\n\toverride get canConfirm(): boolean {\n\t\treturn false;\n\t}\n\n\toverride isFuzzyMatch(name: string) {\n\t\treturn super.isFuzzyMatch(name) || name === 'log';\n\t}\n\n\tprotected async *steps(state: PartialStepState<State>): StepGenerator {\n\t\tconst context: Context = {\n\t\t\trepos: [...(await Container.git.getOrderedRepositories())],\n\t\t\tcache: new Map<string, Promise<GitLog | undefined>>(),\n\t\t\tselectedBranchOrTag: undefined,\n\t\t\ttitle: this.title,\n\t\t};\n\n\t\tlet skippedStepOne = false;\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tcontext.title = this.title;\n\n\t\t\tif (state.counter < 1 || state.repo == null || typeof state.repo === 'string') {\n\t\t\t\tskippedStepOne = false;\n\t\t\t\tif (context.repos.length === 1) {\n\t\t\t\t\tskippedStepOne = true;\n\t\t\t\t\tif (state.repo == null) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.repo = context.repos[0];\n\t\t\t\t} else {\n\t\t\t\t\tconst result = yield* pickRepositoryStep(state, context);\n\t\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\t\tstate.repo = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (state.reference === 'HEAD') {\n\t\t\t\tconst branch = await state.repo.getBranch();\n\t\t\t\tstate.reference = branch;\n\t\t\t}\n\n\t\t\tif (state.counter < 2 || state.reference == null) {\n\t\t\t\tconst result = yield* pickBranchOrTagStep(state as LogStepState, context, {\n\t\t\t\t\tplaceholder: 'Choose a branch or tag to show its commit history',\n\t\t\t\t\tpicked: context.selectedBranchOrTag?.ref,\n\t\t\t\t\tvalue: context.selectedBranchOrTag == null ? state.reference?.ref : undefined,\n\t\t\t\t\tranges: true,\n\t\t\t\t});\n\t\t\t\tif (result === StepResult.Break) {\n\t\t\t\t\t// If we skipped the previous step, make sure we back up past it\n\t\t\t\t\tif (skippedStepOne) {\n\t\t\t\t\t\tstate.counter--;\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tstate.reference = result;\n\t\t\t\tcontext.selectedBranchOrTag = undefined;\n\t\t\t}\n\n\t\t\tif (!GitReference.isRevision(state.reference) || GitReference.isRevisionRange(state.reference)) {\n\t\t\t\tcontext.selectedBranchOrTag = state.reference;\n\t\t\t}\n\n\t\t\tcontext.title = `${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${GitReference.toString(\n\t\t\t\tcontext.selectedBranchOrTag,\n\t\t\t\t{ icon: false },\n\t\t\t)}`;\n\n\t\t\tif (state.fileName) {\n\t\t\t\tcontext.title += `${Strings.pad(GlyphChars.Dot, 2, 2)}${GitUri.getFormattedFilename(state.fileName, {\n\t\t\t\t\ttruncateTo: quickPickTitleMaxChars - context.title.length - 3,\n\t\t\t\t})}`;\n\t\t\t}\n\n\t\t\tif (state.counter < 3 && context.selectedBranchOrTag != null) {\n\t\t\t\tconst ref = context.selectedBranchOrTag.ref;\n\n\t\t\t\tlet log = context.cache.get(ref);\n\t\t\t\tif (log == null) {\n\t\t\t\t\tlog =\n\t\t\t\t\t\tstate.fileName != null\n\t\t\t\t\t\t\t? Container.git.getLogForFile(state.repo.path, state.fileName, { ref: ref })\n\t\t\t\t\t\t\t: Container.git.getLog(state.repo.path, { ref: ref });\n\t\t\t\t\tcontext.cache.set(ref, log);\n\t\t\t\t}\n\n\t\t\t\tconst result = yield* pickCommitStep(state as LogStepState, context, {\n\t\t\t\t\tignoreFocusOut: true,\n\t\t\t\t\tlog: await log,\n\t\t\t\t\tonDidLoadMore: log => context.cache.set(ref, Promise.resolve(log)),\n\t\t\t\t\tplaceholder: (context, log) =>\n\t\t\t\t\t\tlog == null\n\t\t\t\t\t\t\t? `No commits found in ${GitReference.toString(context.selectedBranchOrTag, {\n\t\t\t\t\t\t\t\t\ticon: false,\n\t\t\t\t\t\t\t  })}`\n\t\t\t\t\t\t\t: 'Choose a commit',\n\t\t\t\t\tpicked: state.reference?.ref,\n\t\t\t\t});\n\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\tstate.reference = result;\n\t\t\t}\n\n\t\t\tif (!(state.reference instanceof GitLogCommit) || state.reference.isFile) {\n\t\t\t\tstate.reference = await Container.git.getCommit(state.repo.path, state.reference.ref);\n\t\t\t}\n\n\t\t\tconst result = yield* GitCommandsCommand.getSteps(\n\t\t\t\t{\n\t\t\t\t\tcommand: 'show',\n\t\t\t\t\tstate: {\n\t\t\t\t\t\trepo: state.repo,\n\t\t\t\t\t\treference: state.reference as GitLogCommit,\n\t\t\t\t\t\tfileName: state.fileName,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tthis.pickedVia,\n\t\t\t);\n\t\t\tstate.counter--;\n\t\t\tif (result === StepResult.Break) {\n\t\t\t\tQuickCommand.endSteps(state);\n\t\t\t}\n\t\t}\n\n\t\treturn state.counter < 0 ? StepResult.Break : undefined;\n\t}\n}\n","'use strict';\nimport { Container } from '../../container';\nimport { GitBranch, GitLog, GitReference, GitRevision, Repository } from '../../git/git';\nimport { Directive, DirectiveQuickPickItem, FlagsQuickPickItem } from '../../quickpicks';\nimport { Strings } from '../../system';\nimport {\n\tappendReposToTitle,\n\tAsyncStepResultGenerator,\n\tPartialStepState,\n\tpickBranchOrTagStep,\n\tpickCommitStep,\n\tpickRepositoryStep,\n\tQuickCommand,\n\tQuickCommandButtons,\n\tQuickPickStep,\n\tStepGenerator,\n\tStepResult,\n\tStepSelection,\n\tStepState,\n} from '../quickCommand';\n\ninterface Context {\n\trepos: Repository[];\n\tcache: Map<string, Promise<GitLog | undefined>>;\n\tdestination: GitBranch;\n\tpickCommit: boolean;\n\tselectedBranchOrTag: GitReference | undefined;\n\tshowTags: boolean;\n\ttitle: string;\n}\n\ntype Flags = '--ff-only' | '--no-ff' | '--squash';\n\ninterface State {\n\trepo: string | Repository;\n\treference: GitReference;\n\tflags: Flags[];\n}\n\nexport interface MergeGitCommandArgs {\n\treadonly command: 'merge';\n\tstate?: Partial<State>;\n}\n\ntype MergeStepState<T extends State = State> = ExcludeSome<StepState<T>, 'repo', string>;\n\nexport class MergeGitCommand extends QuickCommand<State> {\n\tconstructor(args?: MergeGitCommandArgs) {\n\t\tsuper('merge', 'merge', 'Merge', {\n\t\t\tdescription: 'integrates changes from a specified branch into the current branch',\n\t\t});\n\n\t\tlet counter = 0;\n\t\tif (args?.state?.repo != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (args?.state?.reference != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis.initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: true,\n\t\t\t...args?.state,\n\t\t};\n\t}\n\n\toverride get canSkipConfirm(): boolean {\n\t\treturn false;\n\t}\n\n\texecute(state: MergeStepState) {\n\t\treturn state.repo.merge(...state.flags, state.reference.ref);\n\t}\n\n\tprotected async *steps(state: PartialStepState<State>): StepGenerator {\n\t\tconst context: Context = {\n\t\t\trepos: [...(await Container.git.getOrderedRepositories())],\n\t\t\tcache: new Map<string, Promise<GitLog | undefined>>(),\n\t\t\tdestination: undefined!,\n\t\t\tpickCommit: false,\n\t\t\tselectedBranchOrTag: undefined,\n\t\t\tshowTags: true,\n\t\t\ttitle: this.title,\n\t\t};\n\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\tlet skippedStepOne = false;\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tcontext.title = this.title;\n\n\t\t\tif (state.counter < 1 || state.repo == null || typeof state.repo === 'string') {\n\t\t\t\tskippedStepOne = false;\n\t\t\t\tif (context.repos.length === 1) {\n\t\t\t\t\tskippedStepOne = true;\n\t\t\t\t\tif (state.repo == null) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.repo = context.repos[0];\n\t\t\t\t} else {\n\t\t\t\t\tconst result = yield* pickRepositoryStep(state, context);\n\t\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\t\tstate.repo = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (context.destination == null) {\n\t\t\t\tconst branch = await state.repo.getBranch();\n\t\t\t\tif (branch == null) break;\n\n\t\t\t\tcontext.destination = branch;\n\t\t\t}\n\n\t\t\tcontext.title = `${this.title} into ${GitReference.toString(context.destination, { icon: false })}`;\n\n\t\t\tif (state.counter < 2 || state.reference == null) {\n\t\t\t\tconst pickCommitToggle = new QuickCommandButtons.PickCommitToggle(context.pickCommit, context, () => {\n\t\t\t\t\tcontext.pickCommit = !context.pickCommit;\n\t\t\t\t\tpickCommitToggle.on = context.pickCommit;\n\t\t\t\t});\n\n\t\t\t\tconst result: StepResult<GitReference> = yield* pickBranchOrTagStep(state as MergeStepState, context, {\n\t\t\t\t\tplaceholder: context => `Choose a branch${context.showTags ? ' or tag' : ''} to merge`,\n\t\t\t\t\tpicked: context.selectedBranchOrTag?.ref,\n\t\t\t\t\tvalue: context.selectedBranchOrTag == null ? state.reference?.ref : undefined,\n\t\t\t\t\tadditionalButtons: [pickCommitToggle],\n\t\t\t\t});\n\t\t\t\tif (result === StepResult.Break) {\n\t\t\t\t\t// If we skipped the previous step, make sure we back up past it\n\t\t\t\t\tif (skippedStepOne) {\n\t\t\t\t\t\tstate.counter--;\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tstate.reference = result;\n\t\t\t\tcontext.selectedBranchOrTag = undefined;\n\t\t\t}\n\n\t\t\tif (!GitReference.isRevision(state.reference)) {\n\t\t\t\tcontext.selectedBranchOrTag = state.reference;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tstate.counter < 3 &&\n\t\t\t\tcontext.selectedBranchOrTag != null &&\n\t\t\t\t(context.pickCommit || state.reference.ref === context.destination.ref)\n\t\t\t) {\n\t\t\t\tconst ref = context.selectedBranchOrTag.ref;\n\n\t\t\t\tlet log = context.cache.get(ref);\n\t\t\t\tif (log == null) {\n\t\t\t\t\tlog = Container.git.getLog(state.repo.path, { ref: ref, merges: false });\n\t\t\t\t\tcontext.cache.set(ref, log);\n\t\t\t\t}\n\n\t\t\t\tconst result: StepResult<GitReference> = yield* pickCommitStep(state as MergeStepState, context, {\n\t\t\t\t\tignoreFocusOut: true,\n\t\t\t\t\tlog: await log,\n\t\t\t\t\tonDidLoadMore: log => context.cache.set(ref, Promise.resolve(log)),\n\t\t\t\t\tplaceholder: (context, log) =>\n\t\t\t\t\t\tlog == null\n\t\t\t\t\t\t\t? `No commits found on ${GitReference.toString(context.selectedBranchOrTag, {\n\t\t\t\t\t\t\t\t\ticon: false,\n\t\t\t\t\t\t\t  })}`\n\t\t\t\t\t\t\t: `Choose a commit to merge into ${GitReference.toString(context.destination, {\n\t\t\t\t\t\t\t\t\ticon: false,\n\t\t\t\t\t\t\t  })}`,\n\t\t\t\t\tpicked: state.reference?.ref,\n\t\t\t\t});\n\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\tstate.reference = result;\n\t\t\t}\n\n\t\t\tconst result = yield* this.confirmStep(state as MergeStepState, context);\n\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\tstate.flags = result;\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\tthis.execute(state as MergeStepState);\n\t\t}\n\n\t\treturn state.counter < 0 ? StepResult.Break : undefined;\n\t}\n\n\tprivate async *confirmStep(state: MergeStepState, context: Context): AsyncStepResultGenerator<Flags[]> {\n\t\tconst aheadBehind = await Container.git.getAheadBehindCommitCount(state.repo.path, [\n\t\t\tGitRevision.createRange(context.destination.name, state.reference.name),\n\t\t]);\n\t\tconst count = aheadBehind != null ? aheadBehind.ahead + aheadBehind.behind : 0;\n\t\tif (count === 0) {\n\t\t\tconst step: QuickPickStep<DirectiveQuickPickItem> = this.createConfirmStep(\n\t\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t\t[],\n\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel, true, {\n\t\t\t\t\tlabel: `Cancel ${this.title}`,\n\t\t\t\t\tdetail: `${GitReference.toString(context.destination, {\n\t\t\t\t\t\tcapitalize: true,\n\t\t\t\t\t})} is up to date with ${GitReference.toString(state.reference)}`,\n\t\t\t\t}),\n\t\t\t);\n\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\t\tQuickCommand.canPickStepContinue(step, state, selection);\n\t\t\treturn StepResult.Break;\n\t\t}\n\n\t\tconst step: QuickPickStep<FlagsQuickPickItem<Flags>> = this.createConfirmStep(\n\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t[\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\tlabel: this.title,\n\t\t\t\t\tdetail: `Will merge ${Strings.pluralize('commit', count)} from ${GitReference.toString(\n\t\t\t\t\t\tstate.reference,\n\t\t\t\t\t)} into ${GitReference.toString(context.destination)}`,\n\t\t\t\t}),\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--ff-only'], {\n\t\t\t\t\tlabel: `Fast-forward ${this.title}`,\n\t\t\t\t\tdescription: '--ff-only',\n\t\t\t\t\tdetail: `Will fast-forward merge ${Strings.pluralize('commit', count)} from ${GitReference.toString(\n\t\t\t\t\t\tstate.reference,\n\t\t\t\t\t)} into ${GitReference.toString(context.destination)}`,\n\t\t\t\t}),\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--no-ff'], {\n\t\t\t\t\tlabel: `No Fast-forward ${this.title}`,\n\t\t\t\t\tdescription: '--no-ff',\n\t\t\t\t\tdetail: `Will create a merge commit when merging ${Strings.pluralize(\n\t\t\t\t\t\t'commit',\n\t\t\t\t\t\tcount,\n\t\t\t\t\t)} from ${GitReference.toString(state.reference)} into ${GitReference.toString(\n\t\t\t\t\t\tcontext.destination,\n\t\t\t\t\t)}`,\n\t\t\t\t}),\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--squash'], {\n\t\t\t\t\tlabel: `Squash ${this.title}`,\n\t\t\t\t\tdescription: '--squash',\n\t\t\t\t\tdetail: `Will squash ${Strings.pluralize('commit', count)} from ${GitReference.toString(\n\t\t\t\t\t\tstate.reference,\n\t\t\t\t\t)} into one when merging into ${GitReference.toString(context.destination)}`,\n\t\t\t\t}),\n\t\t\t],\n\t\t);\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n\t}\n}\n","'use strict';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { GitBranch, GitBranchReference, GitReference, Repository } from '../../git/git';\nimport { Directive, DirectiveQuickPickItem, FlagsQuickPickItem } from '../../quickpicks';\nimport { Arrays, Dates, Strings } from '../../system';\nimport {\n\tappendReposToTitle,\n\tAsyncStepResultGenerator,\n\tPartialStepState,\n\tpickRepositoriesStep,\n\tQuickCommand,\n\tQuickCommandButtons,\n\tQuickPickStep,\n\tStepGenerator,\n\tStepResult,\n\tStepSelection,\n\tStepState,\n} from '../quickCommand';\n\ninterface Context {\n\trepos: Repository[];\n\ttitle: string;\n}\n\ntype Flags = '--rebase';\n\ninterface State {\n\trepos: string | string[] | Repository | Repository[];\n\treference?: GitBranchReference;\n\tflags: Flags[];\n}\n\nexport interface PullGitCommandArgs {\n\treadonly command: 'pull';\n\tconfirm?: boolean;\n\tstate?: Partial<State>;\n}\n\ntype PullStepState<T extends State = State> = ExcludeSome<StepState<T>, 'repos', string | string[] | Repository>;\n\nexport class PullGitCommand extends QuickCommand<State> {\n\tconstructor(args?: PullGitCommandArgs) {\n\t\tsuper('pull', 'pull', 'Pull', {\n\t\t\tdescription: 'fetches and integrates changes from a remote into the current branch',\n\t\t});\n\n\t\tlet counter = 0;\n\t\tif (args?.state?.repos != null && (!Array.isArray(args.state.repos) || args.state.repos.length !== 0)) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis.initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: args?.confirm,\n\t\t\t...args?.state,\n\t\t};\n\t}\n\n\tasync execute(state: PullStepState) {\n\t\tif (GitReference.isBranch(state.reference)) {\n\t\t\t// Only resort to a branch fetch if the branch isn't the current one\n\t\t\tif (!GitBranch.is(state.reference) || !state.reference.current) {\n\t\t\t\tconst currentBranch = await state.repos[0].getBranch();\n\t\t\t\tif (currentBranch?.name !== state.reference.name) {\n\t\t\t\t\treturn state.repos[0].fetch({ branch: state.reference, pull: true });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn Container.git.pullAll(state.repos, { rebase: state.flags.includes('--rebase') });\n\t}\n\n\tprotected async *steps(state: PartialStepState<State>): StepGenerator {\n\t\tconst context: Context = {\n\t\t\trepos: [...(await Container.git.getOrderedRepositories())],\n\t\t\ttitle: this.title,\n\t\t};\n\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\tif (state.repos != null && !Array.isArray(state.repos)) {\n\t\t\tstate.repos = [state.repos as any];\n\t\t}\n\n\t\tlet skippedStepOne = false;\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tcontext.title = this.title;\n\n\t\t\tif (\n\t\t\t\tstate.counter < 1 ||\n\t\t\t\tstate.repos == null ||\n\t\t\t\tstate.repos.length === 0 ||\n\t\t\t\tArrays.isStringArray(state.repos)\n\t\t\t) {\n\t\t\t\tskippedStepOne = false;\n\t\t\t\tif (context.repos.length === 1) {\n\t\t\t\t\tskippedStepOne = true;\n\t\t\t\t\tstate.counter++;\n\n\t\t\t\t\tstate.repos = [context.repos[0]];\n\t\t\t\t} else {\n\t\t\t\t\tconst result = yield* pickRepositoriesStep(\n\t\t\t\t\t\tstate as ExcludeSome<typeof state, 'repos', string | Repository>,\n\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t{ skipIfPossible: state.counter >= 1 },\n\t\t\t\t\t);\n\t\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\t\tstate.repos = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.confirm(state.confirm)) {\n\t\t\t\tconst result = yield* this.confirmStep(state as PullStepState, context);\n\t\t\t\tif (result === StepResult.Break) {\n\t\t\t\t\t// If we skipped the previous step, make sure we back up past it\n\t\t\t\t\tif (skippedStepOne) {\n\t\t\t\t\t\tstate.counter--;\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tstate.flags = result;\n\t\t\t}\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\tvoid this.execute(state as PullStepState);\n\t\t}\n\n\t\treturn state.counter < 0 ? StepResult.Break : undefined;\n\t}\n\n\tprivate async *confirmStep(state: PullStepState, context: Context): AsyncStepResultGenerator<Flags[]> {\n\t\tlet step: QuickPickStep<FlagsQuickPickItem<Flags>>;\n\n\t\tif (state.repos.length > 1) {\n\t\t\tstep = this.createConfirmStep(appendReposToTitle(`Confirm ${context.title}`, state, context), [\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\tlabel: this.title,\n\t\t\t\t\tdetail: `Will pull ${state.repos.length} repositories`,\n\t\t\t\t}),\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--rebase'], {\n\t\t\t\t\tlabel: `${this.title} with Rebase`,\n\t\t\t\t\tdescription: '--rebase',\n\t\t\t\t\tdetail: `Will pull ${state.repos.length} repositories by rebasing`,\n\t\t\t\t}),\n\t\t\t]);\n\t\t} else if (GitReference.isBranch(state.reference)) {\n\t\t\tif (state.reference.remote) {\n\t\t\t\tstep = this.createConfirmStep(\n\t\t\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t\t\t[],\n\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel, true, {\n\t\t\t\t\t\tlabel: `Cancel ${this.title}`,\n\t\t\t\t\t\tdetail: 'Cannot pull a remote branch',\n\t\t\t\t\t}),\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst [repo] = state.repos;\n\t\t\t\tconst branch = await repo.getBranch(state.reference.name);\n\n\t\t\t\tif (branch?.upstream == null) {\n\t\t\t\t\tstep = this.createConfirmStep(\n\t\t\t\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t\t\t\t[],\n\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel, true, {\n\t\t\t\t\t\t\tlabel: `Cancel ${this.title}`,\n\t\t\t\t\t\t\tdetail: 'Cannot pull a branch until it has been published',\n\t\t\t\t\t\t}),\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tstep = this.createConfirmStep(appendReposToTitle(`Confirm ${context.title}`, state, context), [\n\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\t\t\tlabel: this.title,\n\t\t\t\t\t\t\tdetail: `Will pull${\n\t\t\t\t\t\t\t\tbranch.state.behind\n\t\t\t\t\t\t\t\t\t? ` ${Strings.pluralize(\n\t\t\t\t\t\t\t\t\t\t\t'commit',\n\t\t\t\t\t\t\t\t\t\t\tbranch.state.behind,\n\t\t\t\t\t\t\t\t\t  )} into ${GitReference.toString(branch)}`\n\t\t\t\t\t\t\t\t\t: ` into ${GitReference.toString(branch)}`\n\t\t\t\t\t\t\t}`,\n\t\t\t\t\t\t}),\n\t\t\t\t\t]);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst [repo] = state.repos;\n\t\t\tconst [status, lastFetched] = await Promise.all([repo.getStatus(), repo.getLastFetched()]);\n\n\t\t\tlet lastFetchedOn = '';\n\t\t\tif (lastFetched !== 0) {\n\t\t\t\tlastFetchedOn = `${Strings.pad(GlyphChars.Dot, 2, 2)}Last fetched ${Dates.getFormatter(\n\t\t\t\t\tnew Date(lastFetched),\n\t\t\t\t).fromNow()}`;\n\t\t\t}\n\n\t\t\tconst pullDetails =\n\t\t\t\tstatus?.state.behind != null\n\t\t\t\t\t? ` ${Strings.pluralize('commit', status.state.behind)} into $(repo) ${repo.formattedName}`\n\t\t\t\t\t: ` into $(repo) ${repo.formattedName}`;\n\n\t\t\tstep = this.createConfirmStep(\n\t\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context, lastFetchedOn),\n\t\t\t\t[\n\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\t\tlabel: this.title,\n\t\t\t\t\t\tdetail: `Will pull${pullDetails}`,\n\t\t\t\t\t}),\n\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--rebase'], {\n\t\t\t\t\t\tlabel: `${this.title} with Rebase`,\n\t\t\t\t\t\tdescription: '--rebase',\n\t\t\t\t\t\tdetail: `Will pull and rebase${pullDetails}`,\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t\tundefined,\n\t\t\t\t{\n\t\t\t\t\tadditionalButtons: [QuickCommandButtons.Fetch],\n\t\t\t\t\tonDidClickButton: async (quickpick, button) => {\n\t\t\t\t\t\tif (button !== QuickCommandButtons.Fetch || quickpick.busy) return false;\n\n\t\t\t\t\t\tquickpick.title = `Confirm ${context.title}${Strings.pad(GlyphChars.Dot, 2, 2)}Fetching${\n\t\t\t\t\t\t\tGlyphChars.Ellipsis\n\t\t\t\t\t\t}`;\n\n\t\t\t\t\t\tquickpick.busy = true;\n\t\t\t\t\t\tquickpick.enabled = false;\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tawait repo.fetch({ progress: true });\n\t\t\t\t\t\t\t// Signal that the step should be retried\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t} finally {\n\t\t\t\t\t\t\tquickpick.busy = false;\n\t\t\t\t\t\t\tquickpick.enabled = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n\t}\n}\n","'use strict';\nimport { configuration } from '../../configuration';\nimport { BuiltInGitConfiguration, GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { GitBranch, GitBranchReference, GitReference, Repository } from '../../git/git';\nimport { Directive, DirectiveQuickPickItem, FlagsQuickPickItem } from '../../quickpicks';\nimport { Arrays, Dates, Strings } from '../../system';\nimport {\n\tappendReposToTitle,\n\tAsyncStepResultGenerator,\n\tPartialStepState,\n\tpickRepositoriesStep,\n\tpickRepositoryStep,\n\tQuickCommand,\n\tQuickCommandButtons,\n\tQuickPickStep,\n\tStepGenerator,\n\tStepResult,\n\tStepSelection,\n\tStepState,\n} from '../quickCommand';\n\ninterface Context {\n\trepos: Repository[];\n\ttitle: string;\n}\n\ntype Flags = '--force' | '--set-upstream' | string;\n\ninterface State<Repos = string | string[] | Repository | Repository[]> {\n\trepos: Repos;\n\treference?: GitReference;\n\tflags: Flags[];\n}\n\nexport interface PushGitCommandArgs {\n\treadonly command: 'push';\n\tconfirm?: boolean;\n\tstate?: Partial<State>;\n}\n\ntype PushStepState<T extends State = State> = ExcludeSome<StepState<T>, 'repos', string | string[] | Repository>;\n\nexport class PushGitCommand extends QuickCommand<State> {\n\tconstructor(args?: PushGitCommandArgs) {\n\t\tsuper('push', 'push', 'Push', {\n\t\t\tdescription: 'pushes changes from the current branch to a remote',\n\t\t});\n\n\t\tlet counter = 0;\n\t\tif (args?.state?.repos != null && (!Array.isArray(args.state.repos) || args.state.repos.length !== 0)) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis.initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: args?.confirm,\n\t\t\t...args?.state,\n\t\t};\n\t}\n\n\texecute(state: State<Repository[]>) {\n\t\tconst index = state.flags.indexOf('--set-upstream');\n\t\tif (index !== -1) {\n\t\t\tif (!GitReference.isBranch(state.reference)) return Promise.resolve();\n\n\t\t\treturn Container.git.pushAll(state.repos, {\n\t\t\t\tforce: false,\n\t\t\t\tpublish: { remote: state.flags[index + 1] },\n\t\t\t\treference: state.reference,\n\t\t\t});\n\t\t}\n\n\t\treturn Container.git.pushAll(state.repos, {\n\t\t\tforce: state.flags.includes('--force'),\n\t\t\treference: state.reference,\n\t\t});\n\t}\n\n\tprotected async *steps(state: PartialStepState<State>): StepGenerator {\n\t\tconst context: Context = {\n\t\t\trepos: [...(await Container.git.getOrderedRepositories())],\n\t\t\ttitle: this.title,\n\t\t};\n\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\tif (state.repos != null && !Array.isArray(state.repos)) {\n\t\t\tstate.repos = [state.repos as any];\n\t\t}\n\n\t\tlet skippedStepOne = false;\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tcontext.title = this.title;\n\n\t\t\tif (\n\t\t\t\tstate.counter < 1 ||\n\t\t\t\tstate.repos == null ||\n\t\t\t\tstate.repos.length === 0 ||\n\t\t\t\tArrays.isStringArray(state.repos)\n\t\t\t) {\n\t\t\t\tskippedStepOne = false;\n\t\t\t\tif (context.repos.length === 1) {\n\t\t\t\t\tskippedStepOne = true;\n\t\t\t\t\tstate.counter++;\n\n\t\t\t\t\tstate.repos = [context.repos[0]];\n\t\t\t\t} else if (state.reference != null) {\n\t\t\t\t\tconst result = yield* pickRepositoryStep(\n\t\t\t\t\t\t{ ...state, repos: undefined, repo: state.reference.repoPath },\n\t\t\t\t\t\tcontext,\n\t\t\t\t\t);\n\t\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\t\tstate.repos = [result];\n\t\t\t\t} else {\n\t\t\t\t\tconst result = yield* pickRepositoriesStep(\n\t\t\t\t\t\tstate as ExcludeSome<typeof state, 'repos', string | Repository>,\n\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t{ skipIfPossible: state.counter >= 1 },\n\t\t\t\t\t);\n\t\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\t\tstate.repos = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.confirm(state.confirm)) {\n\t\t\t\tconst result = yield* this.confirmStep(state as PushStepState, context);\n\t\t\t\tif (result === StepResult.Break) {\n\t\t\t\t\t// If we skipped the previous step, make sure we back up past it\n\t\t\t\t\tif (skippedStepOne) {\n\t\t\t\t\t\tstate.counter--;\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tstate.flags = result;\n\t\t\t}\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\tvoid this.execute(state as State<Repository[]>);\n\t\t}\n\n\t\treturn state.counter < 0 ? StepResult.Break : undefined;\n\t}\n\n\tprivate async *confirmStep(state: PushStepState, context: Context): AsyncStepResultGenerator<Flags[]> {\n\t\tconst useForceWithLease = configuration.getAny<boolean>(BuiltInGitConfiguration.UseForcePushWithLease) ?? false;\n\n\t\tlet step: QuickPickStep<FlagsQuickPickItem<Flags>>;\n\n\t\tif (state.repos.length > 1) {\n\t\t\tstep = this.createConfirmStep(appendReposToTitle(`Confirm ${context.title}`, state, context), [\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\tlabel: this.title,\n\t\t\t\t\tdetail: `Will push ${state.repos.length} repositories`,\n\t\t\t\t}),\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--force'], {\n\t\t\t\t\tlabel: `Force ${this.title}${useForceWithLease ? ' (with lease)' : ''}`,\n\t\t\t\t\tdescription: `--force${useForceWithLease ? '-with-lease' : ''}`,\n\t\t\t\t\tdetail: `Will force push${useForceWithLease ? ' (with lease)' : ''} ${\n\t\t\t\t\t\tstate.repos.length\n\t\t\t\t\t} repositories`,\n\t\t\t\t}),\n\t\t\t]);\n\t\t} else {\n\t\t\tconst [repo] = state.repos;\n\n\t\t\tconst items: FlagsQuickPickItem<Flags>[] = [];\n\n\t\t\tif (GitReference.isBranch(state.reference)) {\n\t\t\t\tif (state.reference.remote) {\n\t\t\t\t\tstep = this.createConfirmStep(\n\t\t\t\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t\t\t\t[],\n\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel, true, {\n\t\t\t\t\t\t\tlabel: `Cancel ${this.title}`,\n\t\t\t\t\t\t\tdetail: 'Cannot push remote branch',\n\t\t\t\t\t\t}),\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tconst branch = await repo.getBranch(state.reference.name);\n\n\t\t\t\t\tif (branch != null && branch?.upstream == null) {\n\t\t\t\t\t\tfor (const remote of await repo.getRemotes()) {\n\t\t\t\t\t\t\titems.push(\n\t\t\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(\n\t\t\t\t\t\t\t\t\tstate.flags,\n\t\t\t\t\t\t\t\t\t['--set-upstream', remote.name, branch.name],\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlabel: `Publish ${branch.name} to ${remote.name}`,\n\t\t\t\t\t\t\t\t\t\tdetail: `Will publish ${GitReference.toString(branch)} to ${remote.name}`,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (items.length) {\n\t\t\t\t\t\t\tstep = this.createConfirmStep(\n\t\t\t\t\t\t\t\tappendReposToTitle('Confirm Publish', state, context),\n\t\t\t\t\t\t\t\titems,\n\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t\t{ placeholder: 'Confirm Publish' },\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstep = this.createConfirmStep(\n\t\t\t\t\t\t\t\tappendReposToTitle('Confirm Publish', state, context),\n\t\t\t\t\t\t\t\t[],\n\t\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel, true, {\n\t\t\t\t\t\t\t\t\tlabel: 'Cancel Publish',\n\t\t\t\t\t\t\t\t\tdetail: 'Cannot publish; No remotes found',\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t{ placeholder: 'Confirm Publish' },\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (branch != null && branch?.state.behind > 0) {\n\t\t\t\t\t\tconst currentBranch = await repo.getBranch();\n\n\t\t\t\t\t\tstep = this.createConfirmStep(\n\t\t\t\t\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t\t\t\t\tbranch.id === currentBranch?.id\n\t\t\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--force'], {\n\t\t\t\t\t\t\t\t\t\t\tlabel: `Force ${this.title}${useForceWithLease ? ' (with lease)' : ''}`,\n\t\t\t\t\t\t\t\t\t\t\tdescription: `--force${useForceWithLease ? '-with-lease' : ''}`,\n\t\t\t\t\t\t\t\t\t\t\tdetail: `Will force push${useForceWithLease ? ' (with lease)' : ''} ${\n\t\t\t\t\t\t\t\t\t\t\t\tbranch?.state.ahead\n\t\t\t\t\t\t\t\t\t\t\t\t\t? ` ${Strings.pluralize('commit', branch.state.ahead)}`\n\t\t\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t\t}${branch.getRemoteName() ? ` to ${branch.getRemoteName()}` : ''}${\n\t\t\t\t\t\t\t\t\t\t\t\tbranch != null && branch.state.behind > 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t? `, overwriting ${Strings.pluralize(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'commit',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbranch.state.behind,\n\t\t\t\t\t\t\t\t\t\t\t\t\t  )}${\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbranch?.getRemoteName()\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? ` on ${branch.getRemoteName()}`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t\t\t\t  }`\n\t\t\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t\t}`,\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t  ]\n\t\t\t\t\t\t\t\t: [],\n\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel, true, {\n\t\t\t\t\t\t\t\tlabel: `Cancel ${this.title}`,\n\t\t\t\t\t\t\t\tdetail: `Cannot push; ${GitReference.toString(\n\t\t\t\t\t\t\t\t\tbranch,\n\t\t\t\t\t\t\t\t)} is behind ${branch.getRemoteName()} by ${Strings.pluralize(\n\t\t\t\t\t\t\t\t\t'commit',\n\t\t\t\t\t\t\t\t\tbranch.state.behind,\n\t\t\t\t\t\t\t\t)}`,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t);\n\t\t\t\t\t} else if (branch != null && branch?.state.ahead > 0) {\n\t\t\t\t\t\tstep = this.createConfirmStep(appendReposToTitle(`Confirm ${context.title}`, state, context), [\n\t\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [branch.getRemoteName()!], {\n\t\t\t\t\t\t\t\tlabel: this.title,\n\t\t\t\t\t\t\t\tdetail: `Will push ${Strings.pluralize(\n\t\t\t\t\t\t\t\t\t'commit',\n\t\t\t\t\t\t\t\t\tbranch.state.ahead,\n\t\t\t\t\t\t\t\t)} from ${GitReference.toString(branch)} to ${branch.getRemoteName()}`,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstep = this.createConfirmStep(\n\t\t\t\t\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t\t\t\t\t[],\n\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel, true, {\n\t\t\t\t\t\t\t\tlabel: `Cancel ${this.title}`,\n\t\t\t\t\t\t\t\tdetail: 'No commits found to push',\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst status = await repo.getStatus();\n\n\t\t\t\tconst branch: GitBranchReference = {\n\t\t\t\t\trefType: 'branch',\n\t\t\t\t\tname: status?.branch ?? 'HEAD',\n\t\t\t\t\tref: status?.branch ?? 'HEAD',\n\t\t\t\t\tremote: false,\n\t\t\t\t\trepoPath: repo.path,\n\t\t\t\t};\n\n\t\t\t\tif (status?.state.ahead === 0) {\n\t\t\t\t\tif (state.reference == null && status.upstream == null) {\n\t\t\t\t\t\tstate.reference = branch;\n\n\t\t\t\t\t\tfor (const remote of await repo.getRemotes()) {\n\t\t\t\t\t\t\titems.push(\n\t\t\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(\n\t\t\t\t\t\t\t\t\tstate.flags,\n\t\t\t\t\t\t\t\t\t['--set-upstream', remote.name, status.branch],\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlabel: `Publish ${branch.name} to ${remote.name}`,\n\t\t\t\t\t\t\t\t\t\tdetail: `Will publish ${GitReference.toString(branch)} to ${remote.name}`,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (items.length) {\n\t\t\t\t\t\tstep = this.createConfirmStep(\n\t\t\t\t\t\t\tappendReposToTitle('Confirm Publish', state, context),\n\t\t\t\t\t\t\titems,\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t{ placeholder: 'Confirm Publish' },\n\t\t\t\t\t\t);\n\t\t\t\t\t} else if (status.upstream == null) {\n\t\t\t\t\t\tstep = this.createConfirmStep(\n\t\t\t\t\t\t\tappendReposToTitle('Confirm Publish', state, context),\n\t\t\t\t\t\t\t[],\n\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel, true, {\n\t\t\t\t\t\t\t\tlabel: 'Cancel Publish',\n\t\t\t\t\t\t\t\tdetail: 'Cannot publish; No remotes found',\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t{ placeholder: 'Confirm Publish' },\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstep = this.createConfirmStep(\n\t\t\t\t\t\t\tappendReposToTitle('Confirm Push', state, context),\n\t\t\t\t\t\t\t[],\n\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel, true, {\n\t\t\t\t\t\t\t\tlabel: `Cancel ${this.title}`,\n\t\t\t\t\t\t\t\tdetail: `Cannot push; No commits ahead of ${GitBranch.getRemote(status.upstream)}`,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tlet lastFetchedOn = '';\n\n\t\t\t\t\tconst lastFetched = await repo.getLastFetched();\n\t\t\t\t\tif (lastFetched !== 0) {\n\t\t\t\t\t\tlastFetchedOn = `${Strings.pad(GlyphChars.Dot, 2, 2)}Last fetched ${Dates.getFormatter(\n\t\t\t\t\t\t\tnew Date(lastFetched),\n\t\t\t\t\t\t).fromNow()}`;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet pushDetails;\n\t\t\t\t\tif (state.reference != null) {\n\t\t\t\t\t\tpushDetails = `${\n\t\t\t\t\t\t\tstatus?.state.ahead\n\t\t\t\t\t\t\t\t? ` commits up to and including ${GitReference.toString(state.reference, {\n\t\t\t\t\t\t\t\t\t\tlabel: false,\n\t\t\t\t\t\t\t\t  })}`\n\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t}${status?.upstream ? ` to ${GitBranch.getRemote(status.upstream)}` : ''}`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpushDetails = `${\n\t\t\t\t\t\t\tstatus?.state.ahead ? ` ${Strings.pluralize('commit', status.state.ahead)}` : ''\n\t\t\t\t\t\t}${status?.upstream ? ` to ${GitBranch.getRemote(status.upstream)}` : ''}`;\n\t\t\t\t\t}\n\n\t\t\t\t\tstep = this.createConfirmStep(\n\t\t\t\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context, lastFetchedOn),\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t...(status?.state.behind\n\t\t\t\t\t\t\t\t? []\n\t\t\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\t\t\t\t\t\t\tlabel: this.title,\n\t\t\t\t\t\t\t\t\t\t\tdetail: `Will push${pushDetails}`,\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t  ]),\n\t\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--force'], {\n\t\t\t\t\t\t\t\tlabel: `Force ${this.title}${useForceWithLease ? ' (with lease)' : ''}`,\n\t\t\t\t\t\t\t\tdescription: `--force${useForceWithLease ? '-with-lease' : ''}`,\n\t\t\t\t\t\t\t\tdetail: `Will force push${useForceWithLease ? ' (with lease)' : ''} ${pushDetails}${\n\t\t\t\t\t\t\t\t\tstatus != null && status.state.behind > 0\n\t\t\t\t\t\t\t\t\t\t? `, overwriting ${Strings.pluralize('commit', status.state.behind)}${\n\t\t\t\t\t\t\t\t\t\t\t\tstatus?.upstream ? ` on ${GitBranch.getRemote(status.upstream)}` : ''\n\t\t\t\t\t\t\t\t\t\t  }`\n\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t}`,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t],\n\t\t\t\t\t\tstatus?.state.behind\n\t\t\t\t\t\t\t? DirectiveQuickPickItem.create(Directive.Cancel, true, {\n\t\t\t\t\t\t\t\t\tlabel: `Cancel ${this.title}`,\n\t\t\t\t\t\t\t\t\tdetail: `Cannot push; ${GitReference.toString(branch)} is behind${\n\t\t\t\t\t\t\t\t\t\tstatus?.upstream ? ` ${GitBranch.getRemote(status.upstream)}` : ''\n\t\t\t\t\t\t\t\t\t} by ${Strings.pluralize('commit', status.state.behind)}`,\n\t\t\t\t\t\t\t  })\n\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t);\n\n\t\t\t\t\tstep.additionalButtons = [QuickCommandButtons.Fetch];\n\t\t\t\t\tstep.onDidClickButton = async (quickpick, button) => {\n\t\t\t\t\t\tif (button !== QuickCommandButtons.Fetch || quickpick.busy) return false;\n\n\t\t\t\t\t\tquickpick.title = `Confirm ${context.title}${Strings.pad(GlyphChars.Dot, 2, 2)}Fetching${\n\t\t\t\t\t\t\tGlyphChars.Ellipsis\n\t\t\t\t\t\t}`;\n\n\t\t\t\t\t\tquickpick.busy = true;\n\t\t\t\t\t\tquickpick.enabled = false;\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tawait repo.fetch({ progress: true });\n\t\t\t\t\t\t\t// Signal that the step should be retried\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t} finally {\n\t\t\t\t\t\t\tquickpick.busy = false;\n\t\t\t\t\t\t\tquickpick.enabled = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n\t}\n}\n","'use strict';\nimport { env } from 'vscode';\nimport { Container } from '../../container';\nimport { GitBranch, GitLog, GitReference, GitRevision, Repository } from '../../git/git';\nimport { Directive, DirectiveQuickPickItem, FlagsQuickPickItem } from '../../quickpicks';\nimport { Strings } from '../../system';\nimport {\n\tappendReposToTitle,\n\tAsyncStepResultGenerator,\n\tPartialStepState,\n\tpickBranchOrTagStep,\n\tpickCommitStep,\n\tpickRepositoryStep,\n\tQuickCommand,\n\tQuickCommandButtons,\n\tQuickPickStep,\n\tStepGenerator,\n\tStepResult,\n\tStepSelection,\n\tStepState,\n} from '../quickCommand';\n\ninterface Context {\n\trepos: Repository[];\n\tcache: Map<string, Promise<GitLog | undefined>>;\n\tdestination: GitBranch;\n\tpickCommit: boolean;\n\tselectedBranchOrTag: GitReference | undefined;\n\tshowTags: boolean;\n\ttitle: string;\n}\n\ntype Flags = '--interactive';\n\ninterface State {\n\trepo: string | Repository;\n\treference: GitReference;\n\tflags: Flags[];\n}\n\nexport interface RebaseGitCommandArgs {\n\treadonly command: 'rebase';\n\tstate?: Partial<State>;\n}\n\ntype RebaseStepState<T extends State = State> = ExcludeSome<StepState<T>, 'repo', string>;\n\nexport class RebaseGitCommand extends QuickCommand<State> {\n\tconstructor(args?: RebaseGitCommandArgs) {\n\t\tsuper('rebase', 'rebase', 'Rebase', {\n\t\t\tdescription:\n\t\t\t\t'integrates changes from a specified branch into the current branch, by changing the base of the branch and reapplying the commits on top',\n\t\t});\n\n\t\tlet counter = 0;\n\t\tif (args?.state?.repo != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (args?.state?.reference != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis.initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: true,\n\t\t\t...args?.state,\n\t\t};\n\t}\n\n\toverride get canSkipConfirm(): boolean {\n\t\treturn false;\n\t}\n\n\tasync execute(state: RebaseStepState) {\n\t\tlet configs: string[] | undefined;\n\t\tif (state.flags.includes('--interactive')) {\n\t\t\tawait Container.rebaseEditor.enableForNextUse();\n\n\t\t\tlet editor;\n\t\t\tswitch (env.appName) {\n\t\t\t\tcase 'Visual Studio Code - Insiders':\n\t\t\t\t\teditor = 'code-insiders --wait --reuse-window';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Visual Studio Code - Exploration':\n\t\t\t\t\teditor = 'code-exploration --wait --reuse-window';\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\teditor = 'code --wait --reuse-window';\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconfigs = ['-c', `sequence.editor=\"${editor}\"`];\n\t\t}\n\t\treturn state.repo.rebase(configs, ...state.flags, state.reference.ref);\n\t}\n\n\tprotected async *steps(state: PartialStepState<State>): StepGenerator {\n\t\tconst context: Context = {\n\t\t\trepos: [...(await Container.git.getOrderedRepositories())],\n\t\t\tcache: new Map<string, Promise<GitLog | undefined>>(),\n\t\t\tdestination: undefined!,\n\t\t\tpickCommit: false,\n\t\t\tselectedBranchOrTag: undefined,\n\t\t\tshowTags: true,\n\t\t\ttitle: this.title,\n\t\t};\n\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\tlet skippedStepOne = false;\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tcontext.title = this.title;\n\n\t\t\tif (state.counter < 1 || state.repo == null || typeof state.repo === 'string') {\n\t\t\t\tskippedStepOne = false;\n\t\t\t\tif (context.repos.length === 1) {\n\t\t\t\t\tskippedStepOne = true;\n\t\t\t\t\tif (state.repo == null) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.repo = context.repos[0];\n\t\t\t\t} else {\n\t\t\t\t\tconst result = yield* pickRepositoryStep(state, context);\n\t\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\t\tstate.repo = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (context.destination == null) {\n\t\t\t\tconst branch = await state.repo.getBranch();\n\t\t\t\tif (branch == null) break;\n\n\t\t\t\tcontext.destination = branch;\n\t\t\t}\n\n\t\t\tcontext.title = `${this.title} ${GitReference.toString(context.destination, { icon: false })}`;\n\n\t\t\tif (state.counter < 2 || state.reference == null) {\n\t\t\t\tconst pickCommitToggle = new QuickCommandButtons.PickCommitToggle(context.pickCommit, context, () => {\n\t\t\t\t\tcontext.pickCommit = !context.pickCommit;\n\t\t\t\t\tpickCommitToggle.on = context.pickCommit;\n\t\t\t\t});\n\n\t\t\t\tconst result: StepResult<GitReference> = yield* pickBranchOrTagStep(state as RebaseStepState, context, {\n\t\t\t\t\tplaceholder: context => `Choose a branch${context.showTags ? ' or tag' : ''} to rebase`,\n\t\t\t\t\tpicked: context.selectedBranchOrTag?.ref,\n\t\t\t\t\tvalue: context.selectedBranchOrTag == null ? state.reference?.ref : undefined,\n\t\t\t\t\tadditionalButtons: [pickCommitToggle],\n\t\t\t\t});\n\t\t\t\tif (result === StepResult.Break) {\n\t\t\t\t\t// If we skipped the previous step, make sure we back up past it\n\t\t\t\t\tif (skippedStepOne) {\n\t\t\t\t\t\tstate.counter--;\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tstate.reference = result;\n\t\t\t\tcontext.selectedBranchOrTag = undefined;\n\t\t\t}\n\n\t\t\tif (!GitReference.isRevision(state.reference)) {\n\t\t\t\tcontext.selectedBranchOrTag = state.reference;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tstate.counter < 3 &&\n\t\t\t\tcontext.selectedBranchOrTag != null &&\n\t\t\t\t(context.pickCommit || state.reference.ref === context.destination.ref)\n\t\t\t) {\n\t\t\t\tconst ref = context.selectedBranchOrTag.ref;\n\n\t\t\t\tlet log = context.cache.get(ref);\n\t\t\t\tif (log == null) {\n\t\t\t\t\tlog = Container.git.getLog(state.repo.path, { ref: ref, merges: false });\n\t\t\t\t\tcontext.cache.set(ref, log);\n\t\t\t\t}\n\n\t\t\t\tconst result: StepResult<GitReference> = yield* pickCommitStep(state as RebaseStepState, context, {\n\t\t\t\t\tignoreFocusOut: true,\n\t\t\t\t\tlog: await log,\n\t\t\t\t\tonDidLoadMore: log => context.cache.set(ref, Promise.resolve(log)),\n\t\t\t\t\tplaceholder: (context, log) =>\n\t\t\t\t\t\tlog == null\n\t\t\t\t\t\t\t? `No commits found on ${GitReference.toString(context.selectedBranchOrTag, {\n\t\t\t\t\t\t\t\t\ticon: false,\n\t\t\t\t\t\t\t  })}`\n\t\t\t\t\t\t\t: `Choose a commit to rebase ${GitReference.toString(context.destination, {\n\t\t\t\t\t\t\t\t\ticon: false,\n\t\t\t\t\t\t\t  })} onto`,\n\t\t\t\t\tpicked: state.reference?.ref,\n\t\t\t\t});\n\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\tstate.reference = result;\n\t\t\t}\n\n\t\t\tconst result = yield* this.confirmStep(state as RebaseStepState, context);\n\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\tstate.flags = result;\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\tvoid this.execute(state as RebaseStepState);\n\t\t}\n\n\t\treturn state.counter < 0 ? StepResult.Break : undefined;\n\t}\n\n\tprivate async *confirmStep(state: RebaseStepState, context: Context): AsyncStepResultGenerator<Flags[]> {\n\t\tconst aheadBehind = await Container.git.getAheadBehindCommitCount(state.repo.path, [\n\t\t\tstate.reference.refType === 'revision'\n\t\t\t\t? GitRevision.createRange(state.reference.ref, context.destination.ref)\n\t\t\t\t: GitRevision.createRange(context.destination.name, state.reference.name),\n\t\t]);\n\n\t\tconst count = aheadBehind != null ? aheadBehind.ahead + aheadBehind.behind : 0;\n\t\tif (count === 0) {\n\t\t\tconst step: QuickPickStep<DirectiveQuickPickItem> = this.createConfirmStep(\n\t\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t\t[],\n\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel, true, {\n\t\t\t\t\tlabel: `Cancel ${this.title}`,\n\t\t\t\t\tdetail: `${GitReference.toString(context.destination, {\n\t\t\t\t\t\tcapitalize: true,\n\t\t\t\t\t})} is up to date with ${GitReference.toString(state.reference)}`,\n\t\t\t\t}),\n\t\t\t);\n\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\t\tQuickCommand.canPickStepContinue(step, state, selection);\n\t\t\treturn StepResult.Break;\n\t\t}\n\n\t\tconst step: QuickPickStep<FlagsQuickPickItem<Flags>> = this.createConfirmStep(\n\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t[\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\tlabel: this.title,\n\t\t\t\t\tdetail: `Will update ${GitReference.toString(context.destination)} by applying ${Strings.pluralize(\n\t\t\t\t\t\t'commit',\n\t\t\t\t\t\tcount,\n\t\t\t\t\t)} on top of ${GitReference.toString(state.reference)}`,\n\t\t\t\t}),\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--interactive'], {\n\t\t\t\t\tlabel: `Interactive ${this.title}`,\n\t\t\t\t\tdescription: '--interactive',\n\t\t\t\t\tdetail: `Will interactively update ${GitReference.toString(\n\t\t\t\t\t\tcontext.destination,\n\t\t\t\t\t)} by applying ${Strings.pluralize('commit', count)} on top of ${GitReference.toString(\n\t\t\t\t\t\tstate.reference,\n\t\t\t\t\t)}`,\n\t\t\t\t}),\n\t\t\t],\n\t\t);\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n\t}\n}\n","'use strict';\nimport { Container } from '../../container';\nimport { GitBranch, GitLog, GitReference, GitRevisionReference, Repository } from '../../git/git';\nimport { FlagsQuickPickItem } from '../../quickpicks';\nimport {\n\tappendReposToTitle,\n\tPartialStepState,\n\tpickCommitStep,\n\tpickRepositoryStep,\n\tQuickCommand,\n\tQuickPickStep,\n\tStepGenerator,\n\tStepResult,\n\tStepResultGenerator,\n\tStepSelection,\n\tStepState,\n} from '../quickCommand';\n\ninterface Context {\n\trepos: Repository[];\n\tcache: Map<string, Promise<GitLog | undefined>>;\n\tdestination: GitBranch;\n\ttitle: string;\n}\n\ntype Flags = '--hard' | '--soft';\n\ninterface State {\n\trepo: string | Repository;\n\treference: GitRevisionReference;\n\tflags: Flags[];\n}\n\nexport interface ResetGitCommandArgs {\n\treadonly command: 'reset';\n\tconfirm?: boolean;\n\tstate?: Partial<State>;\n}\n\ntype ResetStepState<T extends State = State> = ExcludeSome<StepState<T>, 'repo', string>;\n\nexport class ResetGitCommand extends QuickCommand<State> {\n\tconstructor(args?: ResetGitCommandArgs) {\n\t\tsuper('reset', 'reset', 'Reset', { description: 'resets the current branch to a specified commit' });\n\n\t\tlet counter = 0;\n\t\tif (args?.state?.repo != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (args?.state?.reference != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis.initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: args?.confirm ?? true,\n\t\t\t...args?.state,\n\t\t};\n\t\tthis._canSkipConfirm = !this.initialState.confirm;\n\t}\n\n\tprivate _canSkipConfirm: boolean = false;\n\toverride get canSkipConfirm(): boolean {\n\t\treturn this._canSkipConfirm;\n\t}\n\n\texecute(state: ResetStepState) {\n\t\treturn state.repo.reset(...state.flags, state.reference.ref);\n\t}\n\n\tprotected async *steps(state: PartialStepState<State>): StepGenerator {\n\t\tconst context: Context = {\n\t\t\trepos: [...(await Container.git.getOrderedRepositories())],\n\t\t\tcache: new Map<string, Promise<GitLog | undefined>>(),\n\t\t\tdestination: undefined!,\n\t\t\ttitle: this.title,\n\t\t};\n\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\tlet skippedStepOne = false;\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tcontext.title = this.title;\n\n\t\t\tif (state.counter < 1 || state.repo == null || typeof state.repo === 'string') {\n\t\t\t\tskippedStepOne = false;\n\t\t\t\tif (context.repos.length === 1) {\n\t\t\t\t\tskippedStepOne = true;\n\t\t\t\t\tif (state.repo == null) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.repo = context.repos[0];\n\t\t\t\t} else {\n\t\t\t\t\tconst result = yield* pickRepositoryStep(state, context);\n\t\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\t\tstate.repo = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (context.destination == null) {\n\t\t\t\tconst branch = await state.repo.getBranch();\n\t\t\t\tif (branch == null) break;\n\n\t\t\t\tcontext.destination = branch;\n\t\t\t}\n\n\t\t\tcontext.title = `${this.title} ${GitReference.toString(context.destination, { icon: false })}`;\n\n\t\t\tif (state.counter < 2 || state.reference == null) {\n\t\t\t\tconst ref = context.destination.ref;\n\n\t\t\t\tlet log = context.cache.get(ref);\n\t\t\t\tif (log == null) {\n\t\t\t\t\tlog = Container.git.getLog(state.repo.path, { ref: ref, merges: false });\n\t\t\t\t\tcontext.cache.set(ref, log);\n\t\t\t\t}\n\n\t\t\t\tconst result: StepResult<GitReference> = yield* pickCommitStep(state as ResetStepState, context, {\n\t\t\t\t\tlog: await log,\n\t\t\t\t\tonDidLoadMore: log => context.cache.set(ref, Promise.resolve(log)),\n\t\t\t\t\tplaceholder: (context, log) =>\n\t\t\t\t\t\tlog == null\n\t\t\t\t\t\t\t? `${context.destination.name} has no commits`\n\t\t\t\t\t\t\t: `Choose a commit to reset ${context.destination.name} to`,\n\t\t\t\t\tpicked: state.reference?.ref,\n\t\t\t\t});\n\t\t\t\tif (result === StepResult.Break) {\n\t\t\t\t\t// If we skipped the previous step, make sure we back up past it\n\t\t\t\t\tif (skippedStepOne) {\n\t\t\t\t\t\tstate.counter--;\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tstate.reference = result;\n\t\t\t}\n\n\t\t\tif (this.confirm(state.confirm)) {\n\t\t\t\tconst result = yield* this.confirmStep(state as ResetStepState, context);\n\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\tstate.flags = result;\n\t\t\t}\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\tthis.execute(state as ResetStepState);\n\t\t}\n\n\t\treturn state.counter < 0 ? StepResult.Break : undefined;\n\t}\n\n\tprivate *confirmStep(state: ResetStepState, context: Context): StepResultGenerator<Flags[]> {\n\t\tconst step: QuickPickStep<FlagsQuickPickItem<Flags>> = this.createConfirmStep(\n\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t[\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\tlabel: this.title,\n\t\t\t\t\tdetail: `Will reset (leaves changes in the working tree) ${GitReference.toString(\n\t\t\t\t\t\tcontext.destination,\n\t\t\t\t\t)} to ${GitReference.toString(state.reference)}`,\n\t\t\t\t}),\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--soft'], {\n\t\t\t\t\tlabel: `Soft ${this.title}`,\n\t\t\t\t\tdescription: '--soft',\n\t\t\t\t\tdetail: `Will soft reset (leaves changes in the index and working tree) ${GitReference.toString(\n\t\t\t\t\t\tcontext.destination,\n\t\t\t\t\t)} to ${GitReference.toString(state.reference)}`,\n\t\t\t\t}),\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--hard'], {\n\t\t\t\t\tlabel: `Hard ${this.title}`,\n\t\t\t\t\tdescription: '--hard',\n\t\t\t\t\tdetail: `Will hard reset (discards all changes) ${GitReference.toString(\n\t\t\t\t\t\tcontext.destination,\n\t\t\t\t\t)} to ${GitReference.toString(state.reference)}`,\n\t\t\t\t}),\n\t\t\t],\n\t\t);\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n\t}\n}\n","'use strict';\nimport { Container } from '../../container';\nimport { GitBranch, GitLog, GitReference, GitRevisionReference, Repository } from '../../git/git';\nimport { FlagsQuickPickItem } from '../../quickpicks';\nimport {\n\tappendReposToTitle,\n\tPartialStepState,\n\tpickCommitsStep,\n\tpickRepositoryStep,\n\tQuickCommand,\n\tQuickPickStep,\n\tStepGenerator,\n\tStepResult,\n\tStepResultGenerator,\n\tStepSelection,\n\tStepState,\n} from '../quickCommand';\n\ninterface Context {\n\trepos: Repository[];\n\tcache: Map<string, Promise<GitLog | undefined>>;\n\tdestination: GitBranch;\n\ttitle: string;\n}\n\ntype Flags = '--edit' | '--no-edit';\n\ninterface State<Refs = GitRevisionReference | GitRevisionReference[]> {\n\trepo: string | Repository;\n\treferences: Refs;\n\tflags: Flags[];\n}\n\nexport interface RevertGitCommandArgs {\n\treadonly command: 'revert';\n\tstate?: Partial<State>;\n}\n\ntype RevertStepState<T extends State = State> = ExcludeSome<StepState<T>, 'repo', string>;\n\nexport class RevertGitCommand extends QuickCommand<State> {\n\tconstructor(args?: RevertGitCommandArgs) {\n\t\tsuper('revert', 'revert', 'Revert', {\n\t\t\tdescription: 'undoes the changes of specified commits, by creating new commits with inverted changes',\n\t\t});\n\n\t\tlet counter = 0;\n\t\tif (args?.state?.repo != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (\n\t\t\targs?.state?.references != null &&\n\t\t\t(!Array.isArray(args.state.references) || args.state.references.length !== 0)\n\t\t) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis.initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: true,\n\t\t\t...args?.state,\n\t\t};\n\t}\n\n\toverride get canSkipConfirm(): boolean {\n\t\treturn false;\n\t}\n\n\texecute(state: RevertStepState<State<GitRevisionReference[]>>) {\n\t\treturn state.repo.revert(...state.flags, ...state.references.map(c => c.ref).reverse());\n\t}\n\n\tprotected async *steps(state: PartialStepState<State>): StepGenerator {\n\t\tconst context: Context = {\n\t\t\trepos: [...(await Container.git.getOrderedRepositories())],\n\t\t\tcache: new Map<string, Promise<GitLog | undefined>>(),\n\t\t\tdestination: undefined!,\n\t\t\ttitle: this.title,\n\t\t};\n\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\tif (state.references != null && !Array.isArray(state.references)) {\n\t\t\tstate.references = [state.references];\n\t\t}\n\n\t\tlet skippedStepOne = false;\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tcontext.title = this.title;\n\n\t\t\tif (state.counter < 1 || state.repo == null || typeof state.repo === 'string') {\n\t\t\t\tskippedStepOne = false;\n\t\t\t\tif (context.repos.length === 1) {\n\t\t\t\t\tskippedStepOne = true;\n\t\t\t\t\tif (state.repo == null) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.repo = context.repos[0];\n\t\t\t\t} else {\n\t\t\t\t\tconst result = yield* pickRepositoryStep(state, context);\n\t\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\t\tstate.repo = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (context.destination == null) {\n\t\t\t\tconst branch = await state.repo.getBranch();\n\t\t\t\tif (branch == null) break;\n\n\t\t\t\tcontext.destination = branch;\n\t\t\t}\n\n\t\t\tif (state.counter < 2 || state.references == null || state.references.length === 0) {\n\t\t\t\tconst ref = context.destination.ref;\n\n\t\t\t\tlet log = context.cache.get(ref);\n\t\t\t\tif (log == null) {\n\t\t\t\t\tlog = Container.git.getLog(state.repo.path, { ref: ref, merges: false });\n\t\t\t\t\tcontext.cache.set(ref, log);\n\t\t\t\t}\n\n\t\t\t\tconst result: StepResult<GitRevisionReference[]> = yield* pickCommitsStep(\n\t\t\t\t\tstate as RevertStepState,\n\t\t\t\t\tcontext,\n\t\t\t\t\t{\n\t\t\t\t\t\tlog: await log,\n\t\t\t\t\t\tonDidLoadMore: log => context.cache.set(ref, Promise.resolve(log)),\n\t\t\t\t\t\tplaceholder: (context, log) =>\n\t\t\t\t\t\t\tlog == null ? `${context.destination.name} has no commits` : 'Choose commits to revert',\n\t\t\t\t\t\tpicked: state.references?.map(r => r.ref),\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t\tif (result === StepResult.Break) {\n\t\t\t\t\t// If we skipped the previous step, make sure we back up past it\n\t\t\t\t\tif (skippedStepOne) {\n\t\t\t\t\t\tstate.counter--;\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tstate.references = result;\n\t\t\t}\n\n\t\t\tconst result = yield* this.confirmStep(state as RevertStepState, context);\n\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\tstate.flags = result;\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\tthis.execute(state as RevertStepState<State<GitRevisionReference[]>>);\n\t\t}\n\n\t\treturn state.counter < 0 ? StepResult.Break : undefined;\n\t}\n\n\tprivate *confirmStep(state: RevertStepState, context: Context): StepResultGenerator<Flags[]> {\n\t\tconst step: QuickPickStep<FlagsQuickPickItem<Flags>> = this.createConfirmStep(\n\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t[\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--no-edit'], {\n\t\t\t\t\tlabel: this.title,\n\t\t\t\t\tdescription: '--no-edit',\n\t\t\t\t\tdetail: `Will revert ${GitReference.toString(state.references)}`,\n\t\t\t\t}),\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--edit'], {\n\t\t\t\t\tlabel: `${this.title} & Edit`,\n\t\t\t\t\tdescription: '--edit',\n\t\t\t\t\tdetail: `Will revert and edit ${GitReference.toString(state.references)}`,\n\t\t\t\t}),\n\t\t\t],\n\t\t);\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n\t}\n}\n","'use strict';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { GitLog, GitLogCommit, Repository, SearchOperators, searchOperators, SearchPattern } from '../../git/git';\nimport { ActionQuickPickItem, QuickPickItemOfT } from '../../quickpicks';\nimport { Strings } from '../../system';\nimport { SearchResultsNode } from '../../views/nodes';\nimport { GitCommandsCommand } from '../gitCommands';\nimport {\n\tappendReposToTitle,\n\tPartialStepState,\n\tpickCommitStep,\n\tpickRepositoryStep,\n\tQuickCommand,\n\tQuickCommandButtons,\n\tStepGenerator,\n\tStepResult,\n\tStepResultGenerator,\n\tStepSelection,\n\tStepState,\n} from '../quickCommand';\n\ninterface Context {\n\trepos: Repository[];\n\tcommit: GitLogCommit | undefined;\n\tresultsKey: string | undefined;\n\tresultsPromise: Promise<GitLog | undefined> | undefined;\n\ttitle: string;\n}\n\ninterface State extends Required<SearchPattern> {\n\trepo: string | Repository;\n\tshowResultsInSideBar: boolean | SearchResultsNode;\n}\n\nexport interface SearchGitCommandArgs {\n\treadonly command: 'search' | 'grep';\n\tprefillOnly?: boolean;\n\tstate?: Partial<State>;\n}\n\nconst searchOperatorToTitleMap = new Map<SearchOperators, string>([\n\t['', 'Search by Message'],\n\t['=:', 'Search by Message'],\n\t['message:', 'Search by Message'],\n\t['@:', 'Search by Author'],\n\t['author:', 'Search by Author'],\n\t['#:', 'Search by Commit SHA'],\n\t['commit:', 'Search by Commit SHA'],\n\t['?:', 'Search by File'],\n\t['file:', 'Search by File'],\n\t['~:', 'Search by Changes'],\n\t['change:', 'Search by Changes'],\n]);\n\ntype SearchStepState<T extends State = State> = ExcludeSome<StepState<T>, 'repo', string>;\n\nexport class SearchGitCommand extends QuickCommand<State> {\n\tconstructor(args?: SearchGitCommandArgs) {\n\t\tsuper('search', 'search', 'Commit Search', {\n\t\t\tdescription: 'aka grep, searches for commits',\n\t\t});\n\n\t\tlet counter = 0;\n\t\tif (args?.state?.repo != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (args?.state?.pattern != null && !args.prefillOnly) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis.initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: false,\n\t\t\t...args?.state,\n\t\t};\n\t}\n\n\toverride get canConfirm(): boolean {\n\t\treturn false;\n\t}\n\n\toverride isMatch(key: string) {\n\t\treturn super.isMatch(key) || key === 'grep';\n\t}\n\n\toverride isFuzzyMatch(name: string) {\n\t\treturn super.isFuzzyMatch(name) || name === 'grep';\n\t}\n\n\tprotected async *steps(state: PartialStepState<State>): StepGenerator {\n\t\tconst context: Context = {\n\t\t\trepos: [...(await Container.git.getOrderedRepositories())],\n\t\t\tcommit: undefined,\n\t\t\tresultsKey: undefined,\n\t\t\tresultsPromise: undefined,\n\t\t\ttitle: this.title,\n\t\t};\n\n\t\tconst cfg = Container.config.gitCommands.search;\n\t\tif (state.matchAll == null) {\n\t\t\tstate.matchAll = cfg.matchAll;\n\t\t}\n\t\tif (state.matchCase == null) {\n\t\t\tstate.matchCase = cfg.matchCase;\n\t\t}\n\t\tif (state.matchRegex == null) {\n\t\t\tstate.matchRegex = cfg.matchRegex;\n\t\t}\n\t\tif (state.showResultsInSideBar == null) {\n\t\t\tstate.showResultsInSideBar = cfg.showResultsInSideBar ?? undefined;\n\t\t}\n\n\t\tlet skippedStepOne = false;\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tcontext.title = this.title;\n\n\t\t\tif (state.counter < 1 || state.repo == null || typeof state.repo === 'string') {\n\t\t\t\tskippedStepOne = false;\n\t\t\t\tif (context.repos.length === 1) {\n\t\t\t\t\tskippedStepOne = true;\n\t\t\t\t\tif (state.repo == null) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.repo = context.repos[0];\n\t\t\t\t} else {\n\t\t\t\t\tconst result = yield* pickRepositoryStep(state, context);\n\t\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\t\tstate.repo = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (state.counter < 2 || state.pattern == null) {\n\t\t\t\tconst result = yield* this.pickSearchOperatorStep(state as SearchStepState, context);\n\t\t\t\tif (result === StepResult.Break) {\n\t\t\t\t\t// If we skipped the previous step, make sure we back up past it\n\t\t\t\t\tif (skippedStepOne) {\n\t\t\t\t\t\tstate.counter--;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.pattern = undefined;\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tstate.pattern = result;\n\t\t\t}\n\n\t\t\tconst search: SearchPattern = {\n\t\t\t\tpattern: state.pattern,\n\t\t\t\tmatchAll: state.matchAll,\n\t\t\t\tmatchCase: state.matchCase,\n\t\t\t\tmatchRegex: state.matchRegex,\n\t\t\t};\n\t\t\tconst searchKey = SearchPattern.toKey(search);\n\n\t\t\tif (context.resultsPromise == null || context.resultsKey !== searchKey) {\n\t\t\t\tcontext.resultsPromise = state.repo.searchForCommits(search);\n\t\t\t\tcontext.resultsKey = searchKey;\n\t\t\t}\n\n\t\t\t// eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n\t\t\tif (state.showResultsInSideBar) {\n\t\t\t\tvoid Container.searchAndCompareView.search(\n\t\t\t\t\tstate.repo.path,\n\t\t\t\t\tsearch,\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: { label: `for ${state.pattern}` },\n\t\t\t\t\t},\n\t\t\t\t\tcontext.resultsPromise,\n\t\t\t\t\tstate.showResultsInSideBar instanceof SearchResultsNode ? state.showResultsInSideBar : undefined,\n\t\t\t\t);\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (state.counter < 3 || context.commit == null) {\n\t\t\t\tconst repoPath = state.repo.path;\n\t\t\t\tconst result = yield* pickCommitStep(state as SearchStepState, context, {\n\t\t\t\t\tignoreFocusOut: true,\n\t\t\t\t\tlog: await context.resultsPromise,\n\t\t\t\t\tonDidLoadMore: log => (context.resultsPromise = Promise.resolve(log)),\n\t\t\t\t\tplaceholder: (context, log) =>\n\t\t\t\t\t\tlog == null\n\t\t\t\t\t\t\t? `No results for ${state.pattern}`\n\t\t\t\t\t\t\t: `${Strings.pluralize('result', log.count, {\n\t\t\t\t\t\t\t\t\tnumber: log.hasMore ? `${log.count}+` : undefined,\n\t\t\t\t\t\t\t  })} for ${state.pattern}`,\n\t\t\t\t\tpicked: context.commit?.ref,\n\t\t\t\t\tshowInSideBarCommand: new ActionQuickPickItem(\n\t\t\t\t\t\t'$(link-external)  Show Results in Side Bar',\n\t\t\t\t\t\t() =>\n\t\t\t\t\t\t\tvoid Container.searchAndCompareView.search(\n\t\t\t\t\t\t\t\trepoPath,\n\t\t\t\t\t\t\t\tsearch,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: { label: `for ${state.pattern}` },\n\t\t\t\t\t\t\t\t\treveal: {\n\t\t\t\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\t\t\t\t\texpand: true,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcontext.resultsPromise,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t),\n\t\t\t\t\tshowInSideBarButton: {\n\t\t\t\t\t\tbutton: QuickCommandButtons.ShowResultsInSideBar,\n\t\t\t\t\t\tonDidClick: () =>\n\t\t\t\t\t\t\tvoid Container.searchAndCompareView.search(\n\t\t\t\t\t\t\t\trepoPath,\n\t\t\t\t\t\t\t\tsearch,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: { label: `for ${state.pattern}` },\n\t\t\t\t\t\t\t\t\treveal: {\n\t\t\t\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\t\t\t\t\texpand: true,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcontext.resultsPromise,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tif (result === StepResult.Break) {\n\t\t\t\t\tstate.counter--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tcontext.commit = result;\n\t\t\t}\n\n\t\t\tconst result = yield* GitCommandsCommand.getSteps(\n\t\t\t\t{\n\t\t\t\t\tcommand: 'show',\n\t\t\t\t\tstate: {\n\t\t\t\t\t\trepo: state.repo,\n\t\t\t\t\t\treference: context.commit,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tthis.pickedVia,\n\t\t\t);\n\t\t\tstate.counter--;\n\t\t\tif (result === StepResult.Break) {\n\t\t\t\tQuickCommand.endSteps(state);\n\t\t\t}\n\t\t}\n\n\t\treturn state.counter < 0 ? StepResult.Break : undefined;\n\t}\n\n\tprivate *pickSearchOperatorStep(state: SearchStepState, context: Context): StepResultGenerator<string> {\n\t\tconst items: QuickPickItemOfT<SearchOperators>[] = [\n\t\t\t{\n\t\t\t\tlabel: searchOperatorToTitleMap.get('')!,\n\t\t\t\tdescription: `pattern or message: pattern or =: pattern ${GlyphChars.Dash} use quotes to search for phrases`,\n\t\t\t\titem: 'message:',\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: searchOperatorToTitleMap.get('author:')!,\n\t\t\t\tdescription: 'author: pattern or @: pattern',\n\t\t\t\titem: 'author:',\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: searchOperatorToTitleMap.get('commit:')!,\n\t\t\t\tdescription: 'commit: sha or #: sha',\n\t\t\t\titem: 'commit:',\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: searchOperatorToTitleMap.get('file:')!,\n\t\t\t\tdescription: 'file: glob or ?: glob',\n\t\t\t\titem: 'file:',\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: searchOperatorToTitleMap.get('change:')!,\n\t\t\t\tdescription: 'change: pattern or ~: pattern',\n\t\t\t\titem: 'change:',\n\t\t\t},\n\t\t];\n\n\t\tconst matchCaseButton = new QuickCommandButtons.MatchCaseToggle(state.matchCase);\n\t\tconst matchAllButton = new QuickCommandButtons.MatchAllToggle(state.matchAll);\n\t\tconst matchRegexButton = new QuickCommandButtons.MatchRegexToggle(state.matchRegex);\n\n\t\tconst step = QuickCommand.createPickStep<QuickPickItemOfT<SearchOperators>>({\n\t\t\ttitle: appendReposToTitle(context.title, state, context),\n\t\t\tplaceholder: 'e.g. \"Updates dependencies\" author:eamodio',\n\t\t\tmatchOnDescription: true,\n\t\t\tmatchOnDetail: true,\n\t\t\tadditionalButtons: [matchCaseButton, matchAllButton, matchRegexButton],\n\t\t\titems: items,\n\t\t\tvalue: state.pattern,\n\t\t\tonDidAccept: (quickpick): boolean => {\n\t\t\t\tconst pick = quickpick.selectedItems[0];\n\t\t\t\tif (!searchOperators.has(pick.item)) return true;\n\n\t\t\t\tconst value = quickpick.value.trim();\n\t\t\t\tif (value.length === 0 || searchOperators.has(value)) {\n\t\t\t\t\tquickpick.value = pick.item;\n\t\t\t\t} else {\n\t\t\t\t\tquickpick.value = `${value} ${pick.item}`;\n\t\t\t\t}\n\n\t\t\t\tvoid step.onDidChangeValue!(quickpick);\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tonDidClickButton: (quickpick, button) => {\n\t\t\t\tif (button === matchCaseButton) {\n\t\t\t\t\tstate.matchCase = !state.matchCase;\n\t\t\t\t\tmatchCaseButton.on = state.matchCase;\n\t\t\t\t} else if (button === matchAllButton) {\n\t\t\t\t\tstate.matchAll = !state.matchAll;\n\t\t\t\t\tmatchAllButton.on = state.matchAll;\n\t\t\t\t} else if (button === matchRegexButton) {\n\t\t\t\t\tstate.matchRegex = !state.matchRegex;\n\t\t\t\t\tmatchRegexButton.on = state.matchRegex;\n\t\t\t\t}\n\t\t\t},\n\t\t\tonDidChangeValue: (quickpick): boolean => {\n\t\t\t\tconst value = quickpick.value.trim();\n\t\t\t\t// Simulate an extra step if we have a value\n\t\t\t\tstate.counter = value ? 3 : 2;\n\n\t\t\t\tconst operations = SearchPattern.parseSearchOperations(value);\n\n\t\t\t\tquickpick.title = appendReposToTitle(\n\t\t\t\t\toperations.size === 0 || operations.size > 1\n\t\t\t\t\t\t? context.title\n\t\t\t\t\t\t: `Commit ${searchOperatorToTitleMap.get(operations.keys().next().value)!}`,\n\t\t\t\t\tstate,\n\t\t\t\t\tcontext,\n\t\t\t\t);\n\n\t\t\t\tif (quickpick.value.length === 0) {\n\t\t\t\t\tquickpick.items = items;\n\t\t\t\t} else {\n\t\t\t\t\t// If something was typed/selected, keep the quick pick open on focus loss\n\t\t\t\t\tquickpick.ignoreFocusOut = true;\n\t\t\t\t\tstep.ignoreFocusOut = true;\n\n\t\t\t\t\tquickpick.items = [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Search for',\n\t\t\t\t\t\t\tdescription: quickpick.value,\n\t\t\t\t\t\t\titem: quickpick.value as SearchOperators,\n\t\t\t\t\t\t},\n\t\t\t\t\t];\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t});\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\tif (!QuickCommand.canPickStepContinue(step, state, selection)) {\n\t\t\t// Since we simulated a step above, we need to remove it here\n\t\t\tstate.counter--;\n\t\t\treturn StepResult.Break;\n\t\t}\n\n\t\t// Since we simulated a step above, we need to remove it here\n\t\tstate.counter--;\n\t\treturn selection[0].item.trim();\n\t}\n}\n","'use strict';\nimport { Container } from '../../container';\nimport { GitAuthor, GitLogCommit, GitRevisionReference, GitStashCommit, Repository } from '../../git/git';\nimport { CommandQuickPickItem, CommitFilesQuickPickItem, GitCommandQuickPickItem } from '../../quickpicks';\nimport {\n\tPartialStepState,\n\tpickCommitStep,\n\tpickRepositoryStep,\n\tQuickCommand,\n\tshowCommitOrStashFilesStep,\n\tshowCommitOrStashFileStep,\n\tshowCommitOrStashStep,\n\tStepGenerator,\n\tStepResult,\n\tStepState,\n} from '../quickCommand';\n\ninterface Context {\n\trepos: Repository[];\n\ttitle: string;\n}\n\ninterface State<Ref = GitRevisionReference | GitLogCommit | GitStashCommit> {\n\trepo: string | Repository;\n\treference: Ref;\n\tfileName: string;\n}\n\nexport interface ShowGitCommandArgs {\n\treadonly command: 'show';\n\tstate?: Partial<State>;\n}\n\ntype ShowStepState<T extends State = State> = ExcludeSome<StepState<T>, 'repo', string>;\n\nexport class ShowGitCommand extends QuickCommand<State> {\n\tconstructor(args?: ShowGitCommandArgs) {\n\t\tsuper('show', 'show', 'Show', {\n\t\t\tdescription: 'shows information about a git reference',\n\t\t});\n\n\t\tlet counter = 0;\n\t\tif (args?.state?.repo != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (args?.state?.reference != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (args?.state?.fileName != null) {\n\t\t\t// Skip past the commit show\n\t\t\tcounter += 2;\n\t\t}\n\n\t\tthis.initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: false,\n\t\t\t...args?.state,\n\t\t};\n\t}\n\n\toverride get canConfirm() {\n\t\treturn false;\n\t}\n\n\tprotected override getStepState(limitBackNavigation: boolean): PartialStepState<State> {\n\t\t// This command is special since we want to allow backing up all the way to the commit,\n\t\t// so ensure the startingStep is at most 1\n\t\tconst state = super.getStepState(limitBackNavigation);\n\t\treturn {\n\t\t\t...state,\n\t\t\tstartingStep: limitBackNavigation ? Math.min(state.startingStep ?? 0, 1) : 0,\n\t\t};\n\t}\n\n\tprotected async *steps(state: PartialStepState<State>): StepGenerator {\n\t\tconst context: Context = {\n\t\t\trepos: [...(await Container.git.getOrderedRepositories())],\n\t\t\ttitle: this.title,\n\t\t};\n\n\t\tlet skippedStepOne = false;\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tcontext.title = this.title;\n\n\t\t\tif (state.counter < 1 || state.repo == null || typeof state.repo === 'string') {\n\t\t\t\tskippedStepOne = false;\n\t\t\t\tif (context.repos.length === 1) {\n\t\t\t\t\tskippedStepOne = true;\n\t\t\t\t\tif (state.repo == null) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.repo = context.repos[0];\n\t\t\t\t} else {\n\t\t\t\t\tconst result = yield* pickRepositoryStep(state, context);\n\t\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\t\tstate.repo = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tstate.counter < 2 ||\n\t\t\t\tstate.reference == null ||\n\t\t\t\t!GitLogCommit.is(state.reference) ||\n\t\t\t\tstate.reference.isFile\n\t\t\t) {\n\t\t\t\tif (state.reference != null && (!GitLogCommit.is(state.reference) || state.reference.isFile)) {\n\t\t\t\t\tstate.reference = await Container.git.getCommit(state.reference.repoPath, state.reference.ref);\n\t\t\t\t}\n\n\t\t\t\tif (state.counter < 2 || state.reference == null) {\n\t\t\t\t\tconst result = yield* pickCommitStep(state as ShowStepState, context, {\n\t\t\t\t\t\tlog: {\n\t\t\t\t\t\t\trepoPath: state.repo.path,\n\t\t\t\t\t\t\tauthors: new Map<string, GitAuthor>(),\n\t\t\t\t\t\t\tcommits: new Map<string, GitLogCommit>(),\n\t\t\t\t\t\t\tsha: undefined,\n\t\t\t\t\t\t\trange: undefined,\n\t\t\t\t\t\t\tcount: 0,\n\t\t\t\t\t\t\tlimit: undefined,\n\t\t\t\t\t\t\thasMore: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tplaceholder: 'Enter a reference or commit SHA',\n\t\t\t\t\t\tpicked: state.reference?.ref,\n\t\t\t\t\t});\n\t\t\t\t\tif (result === StepResult.Break) {\n\t\t\t\t\t\t// If we skipped the previous step, make sure we back up past it\n\t\t\t\t\t\tif (skippedStepOne) {\n\t\t\t\t\t\t\tstate.counter--;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.reference = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (state.counter < 3) {\n\t\t\t\tconst result = yield* showCommitOrStashStep(\n\t\t\t\t\tstate as ShowStepState<State<GitLogCommit | GitStashCommit>>,\n\t\t\t\t\tcontext,\n\t\t\t\t);\n\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\tif (result instanceof GitCommandQuickPickItem) {\n\t\t\t\t\tconst r = yield* result.executeSteps(this.pickedVia);\n\t\t\t\t\tstate.counter--;\n\t\t\t\t\tif (r === StepResult.Break) {\n\t\t\t\t\t\tQuickCommand.endSteps(state);\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (result instanceof CommandQuickPickItem && !(result instanceof CommitFilesQuickPickItem)) {\n\t\t\t\t\tQuickCommand.endSteps(state);\n\n\t\t\t\t\tvoid result.execute();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (state.counter < 4 || state.fileName == null) {\n\t\t\t\tconst result = yield* showCommitOrStashFilesStep(\n\t\t\t\t\tstate as ShowStepState<State<GitLogCommit | GitStashCommit>>,\n\t\t\t\t\tcontext,\n\t\t\t\t\t{\n\t\t\t\t\t\tpicked: state.fileName,\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\tif (result instanceof CommitFilesQuickPickItem) {\n\t\t\t\t\t// Since this is a sort of toggle button, back up 2 steps\n\t\t\t\t\tstate.counter -= 2;\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tstate.fileName = result.file.fileName;\n\t\t\t}\n\n\t\t\tconst result = yield* showCommitOrStashFileStep(\n\t\t\t\tstate as ShowStepState<State<GitLogCommit | GitStashCommit>>,\n\t\t\t\tcontext,\n\t\t\t);\n\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\tif (result instanceof CommitFilesQuickPickItem) {\n\t\t\t\t// Since this is a sort of toggle button, back up 2 steps\n\t\t\t\tstate.counter -= 2;\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (result instanceof GitCommandQuickPickItem) {\n\t\t\t\tyield* result.executeSteps(this.pickedVia);\n\t\t\t\tstate.counter--;\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (result instanceof CommandQuickPickItem) {\n\t\t\t\tQuickCommand.endSteps(state);\n\n\t\t\t\tvoid result.execute();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn state.counter < 0 ? StepResult.Break : undefined;\n\t}\n}\n","'use strict';\nimport { QuickInputButtons, QuickPickItem, Uri, window } from 'vscode';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { GitReference, GitStashCommit, GitStashReference, Repository, RunError } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { Logger } from '../../logger';\nimport { Messages } from '../../messages';\nimport { FlagsQuickPickItem, QuickPickItemOfT } from '../../quickpicks';\nimport { Strings } from '../../system';\nimport { GitActions, GitCommandsCommand } from '../gitCommands';\nimport {\n\tappendReposToTitle,\n\tAsyncStepResultGenerator,\n\tPartialStepState,\n\tpickRepositoryStep,\n\tpickStashStep,\n\tQuickCommand,\n\tQuickCommandButtons,\n\tQuickPickStep,\n\tStepGenerator,\n\tStepResult,\n\tStepResultGenerator,\n\tStepSelection,\n\tStepState,\n} from '../quickCommand';\n\ninterface Context {\n\trepos: Repository[];\n\ttitle: string;\n}\n\ninterface ApplyState {\n\tsubcommand: 'apply';\n\trepo: string | Repository;\n\treference: GitStashReference;\n}\n\ninterface DropState {\n\tsubcommand: 'drop';\n\trepo: string | Repository;\n\treference: GitStashReference;\n}\n\ninterface ListState {\n\tsubcommand: 'list';\n\trepo: string | Repository;\n\treference: /*GitStashReference |*/ GitStashCommit;\n}\n\ninterface PopState {\n\tsubcommand: 'pop';\n\trepo: string | Repository;\n\treference: GitStashReference;\n}\n\ntype PushFlags = '--include-untracked' | '--keep-index';\n\ninterface PushState {\n\tsubcommand: 'push';\n\trepo: string | Repository;\n\tmessage?: string;\n\turis?: Uri[];\n\tflags: PushFlags[];\n}\n\ntype State = ApplyState | DropState | ListState | PopState | PushState;\ntype StashStepState<T extends State> = SomeNonNullable<StepState<T>, 'subcommand'>;\ntype ApplyStepState<T extends ApplyState = ApplyState> = StashStepState<ExcludeSome<T, 'repo', string>>;\ntype DropStepState<T extends DropState = DropState> = StashStepState<ExcludeSome<T, 'repo', string>>;\ntype ListStepState<T extends ListState = ListState> = StashStepState<ExcludeSome<T, 'repo', string>>;\ntype PopStepState<T extends PopState = PopState> = StashStepState<ExcludeSome<T, 'repo', string>>;\ntype PushStepState<T extends PushState = PushState> = StashStepState<ExcludeSome<T, 'repo', string>>;\n\nconst subcommandToTitleMap = new Map<State['subcommand'], string>([\n\t['apply', 'Apply'],\n\t['drop', 'Drop'],\n\t['list', 'List'],\n\t['pop', 'Pop'],\n\t['push', 'Push'],\n]);\nfunction getTitle(title: string, subcommand: State['subcommand'] | undefined) {\n\treturn subcommand == null ? title : `${subcommandToTitleMap.get(subcommand)} ${title}`;\n}\n\nexport interface StashGitCommandArgs {\n\treadonly command: 'stash';\n\tconfirm?: boolean;\n\tstate?: Partial<State>;\n}\n\nexport class StashGitCommand extends QuickCommand<State> {\n\tprivate subcommand: State['subcommand'] | undefined;\n\n\tconstructor(args?: StashGitCommandArgs) {\n\t\tsuper('stash', 'stash', 'Stash', {\n\t\t\tdescription: 'shelves (stashes) local changes to be reapplied later',\n\t\t});\n\n\t\tlet counter = 0;\n\t\tif (args?.state?.subcommand != null) {\n\t\t\tcounter++;\n\n\t\t\tswitch (args.state.subcommand) {\n\t\t\t\tcase 'apply':\n\t\t\t\tcase 'drop':\n\t\t\t\tcase 'pop':\n\t\t\t\t\tif (args.state.reference != null) {\n\t\t\t\t\t\tcounter++;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'push':\n\t\t\t\t\tif (args.state.message != null) {\n\t\t\t\t\t\tcounter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (args?.state?.repo != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis.initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: args?.confirm,\n\t\t\t...args?.state,\n\t\t};\n\t}\n\n\toverride get canConfirm(): boolean {\n\t\treturn this.subcommand != null && this.subcommand !== 'list';\n\t}\n\n\toverride get canSkipConfirm(): boolean {\n\t\treturn this.subcommand === 'drop' ? false : super.canSkipConfirm;\n\t}\n\n\toverride get skipConfirmKey() {\n\t\treturn `${this.key}${this.subcommand == null ? '' : `-${this.subcommand}`}:${this.pickedVia}`;\n\t}\n\n\tprotected async *steps(state: PartialStepState<State>): StepGenerator {\n\t\tconst context: Context = {\n\t\t\trepos: [...(await Container.git.getOrderedRepositories())],\n\t\t\ttitle: this.title,\n\t\t};\n\n\t\tlet skippedStepTwo = false;\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tcontext.title = this.title;\n\n\t\t\tif (state.counter < 1 || state.subcommand == null) {\n\t\t\t\tthis.subcommand = undefined;\n\n\t\t\t\tconst result = yield* this.pickSubcommandStep(state);\n\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\tstate.subcommand = result;\n\t\t\t}\n\n\t\t\tthis.subcommand = state.subcommand;\n\n\t\t\tcontext.title = getTitle(this.title, state.subcommand);\n\n\t\t\tif (state.counter < 2 || state.repo == null || typeof state.repo === 'string') {\n\t\t\t\tskippedStepTwo = false;\n\t\t\t\tif (context.repos.length === 1) {\n\t\t\t\t\tskippedStepTwo = true;\n\t\t\t\t\tstate.counter++;\n\n\t\t\t\t\tstate.repo = context.repos[0];\n\t\t\t\t} else {\n\t\t\t\t\tconst result = yield* pickRepositoryStep(state, context);\n\t\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\t\tstate.repo = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tswitch (state.subcommand) {\n\t\t\t\tcase 'apply':\n\t\t\t\tcase 'pop':\n\t\t\t\t\tyield* this.applyOrPopCommandSteps(state as ApplyStepState | PopStepState, context);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'drop':\n\t\t\t\t\tyield* this.dropCommandSteps(state as DropStepState, context);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'list':\n\t\t\t\t\tyield* this.listCommandSteps(state as ListStepState, context);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'push':\n\t\t\t\t\tyield* this.pushCommandSteps(state as PushStepState, context);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tQuickCommand.endSteps(state);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// If we skipped the previous step, make sure we back up past it\n\t\t\tif (skippedStepTwo) {\n\t\t\t\tstate.counter--;\n\t\t\t}\n\t\t}\n\n\t\treturn state.counter < 0 ? StepResult.Break : undefined;\n\t}\n\n\tprivate *pickSubcommandStep(state: PartialStepState<State>): StepResultGenerator<State['subcommand']> {\n\t\tconst step = QuickCommand.createPickStep<QuickPickItemOfT<State['subcommand']>>({\n\t\t\ttitle: this.title,\n\t\t\tplaceholder: `Choose a ${this.label} command`,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'apply',\n\t\t\t\t\tdescription: 'integrates changes from the specified stash into the current branch',\n\t\t\t\t\tpicked: state.subcommand === 'apply',\n\t\t\t\t\titem: 'apply',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'drop',\n\t\t\t\t\tdescription: 'deletes the specified stash',\n\t\t\t\t\tpicked: state.subcommand === 'drop',\n\t\t\t\t\titem: 'drop',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'list',\n\t\t\t\t\tdescription: 'lists the saved stashes',\n\t\t\t\t\tpicked: state.subcommand === 'list',\n\t\t\t\t\titem: 'list',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'pop',\n\t\t\t\t\tdescription:\n\t\t\t\t\t\t'integrates changes from the specified stash into the current branch and deletes the stash',\n\t\t\t\t\tpicked: state.subcommand === 'pop',\n\t\t\t\t\titem: 'pop',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'push',\n\t\t\t\t\tdescription:\n\t\t\t\t\t\t'saves your local changes to a new stash and discards them from the working tree and index',\n\t\t\t\t\tpicked: state.subcommand === 'push',\n\t\t\t\t\titem: 'push',\n\t\t\t\t},\n\t\t\t],\n\t\t\tbuttons: [QuickInputButtons.Back],\n\t\t});\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n\t}\n\n\tprivate async *applyOrPopCommandSteps(state: ApplyStepState | PopStepState, context: Context): StepGenerator {\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tif (state.counter < 3 || state.reference == null) {\n\t\t\t\tconst result: StepResult<GitStashReference> = yield* pickStashStep(state, context, {\n\t\t\t\t\tstash: await Container.git.getStash(state.repo.path),\n\t\t\t\t\tplaceholder: (context, stash) =>\n\t\t\t\t\t\tstash == null\n\t\t\t\t\t\t\t? `No stashes found in ${state.repo.formattedName}`\n\t\t\t\t\t\t\t: 'Choose a stash to apply to your working tree',\n\t\t\t\t\tpicked: state.reference?.ref,\n\t\t\t\t});\n\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\tstate.reference = result;\n\t\t\t}\n\n\t\t\tif (this.confirm(state.confirm)) {\n\t\t\t\tconst result = yield* this.applyOrPopCommandConfirmStep(state, context);\n\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\tstate.subcommand = result;\n\t\t\t}\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\ttry {\n\t\t\t\tvoid (await state.repo.stashApply(\n\t\t\t\t\t// pop can only take a stash index, e.g. `stash@{1}`\n\t\t\t\t\tstate.subcommand === 'pop' ? `stash@{${state.reference.number}}` : state.reference.ref,\n\t\t\t\t\t{ deleteAfter: state.subcommand === 'pop' },\n\t\t\t\t));\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, context.title);\n\n\t\t\t\tif (ex instanceof Error) {\n\t\t\t\t\tconst msg: string = ex.message ?? '';\n\t\t\t\t\tif (msg.includes('Your local changes to the following files would be overwritten by merge')) {\n\t\t\t\t\t\tvoid window.showWarningMessage(\n\t\t\t\t\t\t\t'Unable to apply stash. Your working tree changes would be overwritten. Please commit or stash your changes before trying again',\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t(msg.includes('Auto-merging') && msg.includes('CONFLICT')) ||\n\t\t\t\t\t\t(ex instanceof RunError &&\n\t\t\t\t\t\t\t((ex.stdout.includes('Auto-merging') && ex.stdout.includes('CONFLICT')) ||\n\t\t\t\t\t\t\t\tex.stdout.includes('needs merge')))\n\t\t\t\t\t) {\n\t\t\t\t\t\tvoid window.showInformationMessage('Stash applied with conflicts');\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvoid Messages.showGenericErrorMessage(\n\t\t\t\t\t\t`Unable to apply stash \\u2014 ${msg.trim().replace(/\\n+?/g, '; ')}`,\n\t\t\t\t\t);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate *applyOrPopCommandConfirmStep(\n\t\tstate: ApplyStepState | PopStepState,\n\t\tcontext: Context,\n\t): StepResultGenerator<'apply' | 'pop'> {\n\t\tconst step = this.createConfirmStep<QuickPickItem & { item: 'apply' | 'pop' }>(\n\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tlabel: context.title,\n\t\t\t\t\tdetail:\n\t\t\t\t\t\tstate.subcommand === 'pop'\n\t\t\t\t\t\t\t? `Will delete ${GitReference.toString(\n\t\t\t\t\t\t\t\t\tstate.reference,\n\t\t\t\t\t\t\t  )} and apply the changes to the working tree`\n\t\t\t\t\t\t\t: `Will apply the changes from ${GitReference.toString(\n\t\t\t\t\t\t\t\t\tstate.reference,\n\t\t\t\t\t\t\t  )} to the working tree`,\n\t\t\t\t\titem: state.subcommand,\n\t\t\t\t},\n\t\t\t\t// Alternate confirmation (if pop then apply, and vice versa)\n\t\t\t\t{\n\t\t\t\t\tlabel: getTitle(this.title, state.subcommand === 'pop' ? 'apply' : 'pop'),\n\t\t\t\t\tdetail:\n\t\t\t\t\t\tstate.subcommand === 'pop'\n\t\t\t\t\t\t\t? `Will apply the changes from ${GitReference.toString(\n\t\t\t\t\t\t\t\t\tstate.reference,\n\t\t\t\t\t\t\t  )} to the working tree`\n\t\t\t\t\t\t\t: `Will delete ${GitReference.toString(\n\t\t\t\t\t\t\t\t\tstate.reference,\n\t\t\t\t\t\t\t  )} and apply the changes to the working tree`,\n\t\t\t\t\titem: state.subcommand === 'pop' ? 'apply' : 'pop',\n\t\t\t\t},\n\t\t\t],\n\t\t\tundefined,\n\t\t\t{\n\t\t\t\tplaceholder: `Confirm ${context.title}`,\n\t\t\t\tadditionalButtons: [QuickCommandButtons.RevealInSideBar],\n\t\t\t\tonDidClickButton: (quickpick, button) => {\n\t\t\t\t\tif (button === QuickCommandButtons.RevealInSideBar) {\n\t\t\t\t\t\tvoid GitActions.Stash.reveal(state.reference, {\n\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\texpand: true,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t);\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n\t}\n\n\tprivate async *dropCommandSteps(state: DropStepState, context: Context): StepGenerator {\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tif (state.counter < 3 || state.reference == null) {\n\t\t\t\tconst result: StepResult<GitStashReference> = yield* pickStashStep(state, context, {\n\t\t\t\t\tstash: await Container.git.getStash(state.repo.path),\n\t\t\t\t\tplaceholder: (context, stash) =>\n\t\t\t\t\t\tstash == null ? `No stashes found in ${state.repo.formattedName}` : 'Choose a stash to delete',\n\t\t\t\t\tpicked: state.reference?.ref,\n\t\t\t\t});\n\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\tstate.reference = result;\n\t\t\t}\n\n\t\t\tconst result = yield* this.dropCommandConfirmStep(state, context);\n\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\ttry {\n\t\t\t\t// drop can only take a stash index, e.g. `stash@{1}`\n\t\t\t\tvoid (await state.repo.stashDelete(`stash@{${state.reference.number}}`, state.reference.ref));\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, context.title);\n\n\t\t\t\tvoid Messages.showGenericErrorMessage('Unable to delete stash');\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate *dropCommandConfirmStep(state: DropStepState, context: Context): StepResultGenerator<void> {\n\t\tconst step = this.createConfirmStep(\n\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tlabel: context.title,\n\t\t\t\t\tdetail: `Will delete ${GitReference.toString(state.reference)}`,\n\t\t\t\t},\n\t\t\t],\n\t\t\tundefined,\n\t\t\t{\n\t\t\t\tplaceholder: `Confirm ${context.title}`,\n\t\t\t\tadditionalButtons: [QuickCommandButtons.RevealInSideBar],\n\t\t\t\tonDidClickButton: (quickpick, button) => {\n\t\t\t\t\tif (button === QuickCommandButtons.RevealInSideBar) {\n\t\t\t\t\t\tvoid GitActions.Stash.reveal(state.reference, {\n\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\texpand: true,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t);\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? undefined : StepResult.Break;\n\t}\n\n\tprivate async *listCommandSteps(state: ListStepState, context: Context): StepGenerator {\n\t\tcontext.title = 'Stashes';\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tif (state.counter < 3 || state.reference == null) {\n\t\t\t\tconst result: StepResult<GitStashCommit> = yield* pickStashStep(state, context, {\n\t\t\t\t\tstash: await Container.git.getStash(state.repo.path),\n\t\t\t\t\tplaceholder: (context, stash) =>\n\t\t\t\t\t\tstash == null ? `No stashes found in ${state.repo.formattedName}` : 'Choose a stash',\n\t\t\t\t\tpicked: state.reference?.ref,\n\t\t\t\t});\n\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\tstate.reference = result;\n\t\t\t}\n\n\t\t\t// if (!(state.reference instanceof GitStashCommit)) {\n\t\t\t// \tstate.reference = await Container.git.getCommit(state.repo.path, state.reference.ref);\n\t\t\t// }\n\n\t\t\tconst result = yield* GitCommandsCommand.getSteps(\n\t\t\t\t{\n\t\t\t\t\tcommand: 'show',\n\t\t\t\t\tstate: {\n\t\t\t\t\t\trepo: state.repo,\n\t\t\t\t\t\treference: state.reference,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tthis.pickedVia,\n\t\t\t);\n\t\t\tstate.counter--;\n\t\t\tif (result === StepResult.Break) {\n\t\t\t\tQuickCommand.endSteps(state);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async *pushCommandSteps(state: PushStepState, context: Context): StepGenerator {\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tif (state.counter < 3 || state.message == null) {\n\t\t\t\tconst result = yield* this.pushCommandInputMessageStep(state, context);\n\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\tstate.message = result;\n\t\t\t}\n\n\t\t\tif (this.confirm(state.confirm)) {\n\t\t\t\tconst result = yield* this.pushCommandConfirmStep(state, context);\n\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\tstate.flags = result;\n\t\t\t}\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\ttry {\n\t\t\t\tvoid (await state.repo.stashSave(state.message, state.uris, {\n\t\t\t\t\tincludeUntracked: state.flags.includes('--include-untracked'),\n\t\t\t\t\tkeepIndex: state.flags.includes('--keep-index'),\n\t\t\t\t}));\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, context.title);\n\n\t\t\t\tconst msg: string = ex?.message ?? ex?.toString() ?? '';\n\t\t\t\tif (msg.includes('newer version of Git')) {\n\t\t\t\t\tvoid window.showErrorMessage(`Unable to stash changes. ${msg}`);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvoid Messages.showGenericErrorMessage('Unable to stash changes');\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async *pushCommandInputMessageStep(\n\t\tstate: PushStepState,\n\t\tcontext: Context,\n\t): AsyncStepResultGenerator<string> {\n\t\tconst step = QuickCommand.createInputStep({\n\t\t\ttitle: appendReposToTitle(\n\t\t\t\tcontext.title,\n\t\t\t\tstate,\n\t\t\t\tcontext,\n\t\t\t\tstate.uris != null\n\t\t\t\t\t? `${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\t\tstate.uris.length === 1\n\t\t\t\t\t\t\t\t? GitUri.getFormattedFilename(state.uris[0])\n\t\t\t\t\t\t\t\t: `${state.uris.length} files`\n\t\t\t\t\t  }`\n\t\t\t\t\t: undefined,\n\t\t\t),\n\t\t\tplaceholder: 'Please provide a stash message',\n\t\t\tvalue: state.message,\n\t\t\tprompt: 'Enter stash message',\n\t\t});\n\n\t\tconst value: StepSelection<typeof step> = yield step;\n\t\tif (\n\t\t\t!QuickCommand.canStepContinue(step, state, value) ||\n\t\t\t!(await QuickCommand.canInputStepContinue(step, state, value))\n\t\t) {\n\t\t\treturn StepResult.Break;\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tprivate *pushCommandConfirmStep(state: PushStepState, context: Context): StepResultGenerator<PushFlags[]> {\n\t\tconst step: QuickPickStep<FlagsQuickPickItem<PushFlags>> = this.createConfirmStep(\n\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\tstate.uris == null || state.uris.length === 0\n\t\t\t\t? [\n\t\t\t\t\t\tFlagsQuickPickItem.create<PushFlags>(state.flags, [], {\n\t\t\t\t\t\t\tlabel: context.title,\n\t\t\t\t\t\t\tdetail: 'Will stash uncommitted changes',\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tFlagsQuickPickItem.create<PushFlags>(state.flags, ['--include-untracked'], {\n\t\t\t\t\t\t\tlabel: `${context.title} & Include Untracked`,\n\t\t\t\t\t\t\tdescription: '--include-untracked',\n\t\t\t\t\t\t\tdetail: 'Will stash uncommitted changes, including untracked files',\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tFlagsQuickPickItem.create<PushFlags>(state.flags, ['--keep-index'], {\n\t\t\t\t\t\t\tlabel: `${context.title} & Keep Staged`,\n\t\t\t\t\t\t\tdescription: '--keep-index',\n\t\t\t\t\t\t\tdetail: 'Will stash uncommitted changes, but will keep staged files intact',\n\t\t\t\t\t\t}),\n\t\t\t\t  ]\n\t\t\t\t: [\n\t\t\t\t\t\tFlagsQuickPickItem.create<PushFlags>(state.flags, [], {\n\t\t\t\t\t\t\tlabel: context.title,\n\t\t\t\t\t\t\tdetail: `Will stash changes from ${\n\t\t\t\t\t\t\t\tstate.uris.length === 1\n\t\t\t\t\t\t\t\t\t? GitUri.getFormattedFilename(state.uris[0])\n\t\t\t\t\t\t\t\t\t: `${state.uris.length} files`\n\t\t\t\t\t\t\t}`,\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tFlagsQuickPickItem.create<PushFlags>(state.flags, ['--keep-index'], {\n\t\t\t\t\t\t\tlabel: `${context.title} & Keep Staged`,\n\t\t\t\t\t\t\tdetail: `Will stash changes from ${\n\t\t\t\t\t\t\t\tstate.uris.length === 1\n\t\t\t\t\t\t\t\t\t? GitUri.getFormattedFilename(state.uris[0])\n\t\t\t\t\t\t\t\t\t: `${state.uris.length} files`\n\t\t\t\t\t\t\t}, but will keep staged files intact`,\n\t\t\t\t\t\t}),\n\t\t\t\t  ],\n\t\t\tundefined,\n\t\t\t{ placeholder: `Confirm ${context.title}` },\n\t\t);\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n\t}\n}\n","'use strict';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { GitReference, GitStatus, Repository } from '../../git/git';\nimport { CommandQuickPickItem, GitCommandQuickPickItem } from '../../quickpicks';\nimport { Strings } from '../../system';\nimport {\n\tPartialStepState,\n\tpickRepositoryStep,\n\tQuickCommand,\n\tshowRepositoryStatusStep,\n\tStepGenerator,\n\tStepResult,\n\tStepState,\n} from '../quickCommand';\n\ninterface Context {\n\trepos: Repository[];\n\tstatus: GitStatus;\n\ttitle: string;\n}\n\ninterface State {\n\trepo: string | Repository;\n}\n\nexport interface StatusGitCommandArgs {\n\treadonly command: 'status';\n\tstate?: Partial<State>;\n}\n\ntype StatusStepState<T extends State = State> = ExcludeSome<StepState<T>, 'repo', string>;\n\nexport class StatusGitCommand extends QuickCommand<State> {\n\tconstructor(args?: StatusGitCommandArgs) {\n\t\tsuper('status', 'status', 'Status', {\n\t\t\tdescription: 'shows status information about a repository',\n\t\t});\n\n\t\tlet counter = 0;\n\t\tif (args?.state?.repo != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis.initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: false,\n\t\t\t...args?.state,\n\t\t};\n\t}\n\n\toverride get canConfirm() {\n\t\treturn false;\n\t}\n\n\tprotected async *steps(state: PartialStepState<State>): StepGenerator {\n\t\tconst context: Context = {\n\t\t\trepos: [...(await Container.git.getOrderedRepositories())],\n\t\t\tstatus: undefined!,\n\t\t\ttitle: this.title,\n\t\t};\n\n\t\tlet skippedStepOne = false;\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tcontext.title = this.title;\n\n\t\t\tif (state.counter < 1 || state.repo == null || typeof state.repo === 'string') {\n\t\t\t\tskippedStepOne = false;\n\t\t\t\tif (context.repos.length === 1) {\n\t\t\t\t\tskippedStepOne = true;\n\t\t\t\t\tif (state.repo == null) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.repo = context.repos[0];\n\t\t\t\t} else {\n\t\t\t\t\tconst result = yield* pickRepositoryStep(state, context);\n\t\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\t\tstate.repo = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcontext.status = (await state.repo.getStatus())!;\n\t\t\tif (context.status == null) return;\n\n\t\t\tcontext.title = `${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${GitReference.toString(\n\t\t\t\tGitReference.create(context.status.branch, state.repo.path, {\n\t\t\t\t\trefType: 'branch',\n\t\t\t\t\tname: context.status.branch,\n\t\t\t\t\tremote: false,\n\t\t\t\t\tupstream:\n\t\t\t\t\t\tcontext.status.upstream != null ? { name: context.status.upstream, missing: false } : undefined,\n\t\t\t\t}),\n\t\t\t\t{ icon: false },\n\t\t\t)}`;\n\n\t\t\tconst result = yield* showRepositoryStatusStep(state as StatusStepState, context);\n\t\t\tif (result === StepResult.Break) {\n\t\t\t\t// If we skipped the previous step, make sure we back up past it\n\t\t\t\tif (skippedStepOne) {\n\t\t\t\t\tstate.counter--;\n\t\t\t\t}\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (result instanceof GitCommandQuickPickItem) {\n\t\t\t\tconst r = yield* result.executeSteps(this.pickedVia);\n\t\t\t\tstate.counter--;\n\t\t\t\tif (r === StepResult.Break) {\n\t\t\t\t\tQuickCommand.endSteps(state);\n\t\t\t\t}\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (result instanceof CommandQuickPickItem) {\n\t\t\t\tQuickCommand.endSteps(state);\n\n\t\t\t\tvoid result.execute();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n","'use strict';\nimport { ProgressLocation, QuickPickItem, window } from 'vscode';\nimport { BranchSorting } from '../../config';\nimport { Container } from '../../container';\nimport { GitReference, Repository } from '../../git/git';\nimport { Arrays } from '../../system';\nimport {\n\tappendReposToTitle,\n\tinputBranchNameStep,\n\tPartialStepState,\n\tpickBranchOrTagStepMultiRepo,\n\tpickRepositoriesStep,\n\tQuickCommand,\n\tQuickPickStep,\n\tStepGenerator,\n\tStepResult,\n\tStepResultGenerator,\n\tStepSelection,\n\tStepState,\n} from '../quickCommand';\n\ninterface Context {\n\trepos: Repository[];\n\tshowTags: boolean;\n\ttitle: string;\n}\n\ninterface State {\n\trepos: string | string[] | Repository | Repository[];\n\treference: GitReference;\n\tcreateBranch?: string;\n}\n\ntype SwitchStepState<T extends State = State> = ExcludeSome<StepState<T>, 'repos', string | string[] | Repository>;\n\nexport interface SwitchGitCommandArgs {\n\treadonly command: 'switch' | 'checkout';\n\tconfirm?: boolean;\n\tstate?: Partial<State>;\n}\n\nexport class SwitchGitCommand extends QuickCommand<State> {\n\tconstructor(args?: SwitchGitCommandArgs) {\n\t\tsuper('switch', 'switch', 'Switch', {\n\t\t\tdescription: 'aka checkout, switches the current branch to a specified branch',\n\t\t});\n\n\t\tlet counter = 0;\n\t\tif (args?.state?.repos != null && (!Array.isArray(args.state.repos) || args.state.repos.length !== 0)) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (args?.state?.reference != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis.initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: args?.confirm,\n\t\t\t...args?.state,\n\t\t};\n\t}\n\n\tasync execute(state: SwitchStepState) {\n\t\treturn void (await window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Switching ${\n\t\t\t\t\tstate.repos.length === 1 ? state.repos[0].formattedName : `${state.repos.length} repositories`\n\t\t\t\t} to ${state.reference.name}`,\n\t\t\t},\n\t\t\t() =>\n\t\t\t\tPromise.all(\n\t\t\t\t\tstate.repos.map(r =>\n\t\t\t\t\t\tr.switch(state.reference.ref, { createBranch: state.createBranch, progress: false }),\n\t\t\t\t\t),\n\t\t\t\t),\n\t\t));\n\t}\n\n\toverride isMatch(key: string) {\n\t\treturn super.isMatch(key) || key === 'checkout';\n\t}\n\n\toverride isFuzzyMatch(name: string) {\n\t\treturn super.isFuzzyMatch(name) || name === 'checkout';\n\t}\n\n\tprotected async *steps(state: PartialStepState<State>): StepGenerator {\n\t\tconst context: Context = {\n\t\t\trepos: [...(await Container.git.getOrderedRepositories())],\n\t\t\tshowTags: false,\n\t\t\ttitle: this.title,\n\t\t};\n\n\t\tif (state.repos != null && !Array.isArray(state.repos)) {\n\t\t\tstate.repos = [state.repos] as string[] | Repository[];\n\t\t}\n\n\t\tlet skippedStepOne = false;\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tcontext.title = this.title;\n\n\t\t\tif (\n\t\t\t\tstate.counter < 1 ||\n\t\t\t\tstate.repos == null ||\n\t\t\t\tstate.repos.length === 0 ||\n\t\t\t\tArrays.isStringArray(state.repos)\n\t\t\t) {\n\t\t\t\tskippedStepOne = false;\n\t\t\t\tif (context.repos.length === 1) {\n\t\t\t\t\tskippedStepOne = true;\n\t\t\t\t\tstate.counter++;\n\n\t\t\t\t\tstate.repos = [context.repos[0]];\n\t\t\t\t} else {\n\t\t\t\t\tconst result = yield* pickRepositoriesStep(\n\t\t\t\t\t\tstate as ExcludeSome<typeof state, 'repos', string | Repository>,\n\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t{ skipIfPossible: state.counter >= 1 },\n\t\t\t\t\t);\n\t\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\t\tstate.repos = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (state.counter < 2 || state.reference == null) {\n\t\t\t\tconst result = yield* pickBranchOrTagStepMultiRepo(state as SwitchStepState, context, {\n\t\t\t\t\tplaceholder: context => `Choose a branch${context.showTags ? ' or tag' : ''} to switch to`,\n\t\t\t\t});\n\t\t\t\tif (result === StepResult.Break) {\n\t\t\t\t\t// If we skipped the previous step, make sure we back up past it\n\t\t\t\t\tif (skippedStepOne) {\n\t\t\t\t\t\tstate.counter--;\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tstate.reference = result;\n\t\t\t}\n\n\t\t\tif (GitReference.isBranch(state.reference) && state.reference.remote) {\n\t\t\t\tcontext.title = `Create Branch and ${this.title}`;\n\n\t\t\t\tconst branches = await Container.git.getBranches(state.reference.repoPath, {\n\t\t\t\t\tfilter: b => b.upstream?.name === state.reference!.name,\n\t\t\t\t\tsort: { orderBy: BranchSorting.DateDesc },\n\t\t\t\t});\n\n\t\t\t\tif (branches.length === 0) {\n\t\t\t\t\tconst result = yield* inputBranchNameStep(state as SwitchStepState, context, {\n\t\t\t\t\t\tplaceholder: 'Please provide a name for the new branch',\n\t\t\t\t\t\ttitleContext: ` based on ${GitReference.toString(state.reference, {\n\t\t\t\t\t\t\ticon: false,\n\t\t\t\t\t\t})}`,\n\t\t\t\t\t\tvalue: state.createBranch ?? GitReference.getNameWithoutRemote(state.reference),\n\t\t\t\t\t});\n\t\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\t\tstate.createBranch = result;\n\t\t\t\t} else {\n\t\t\t\t\tstate.createBranch = undefined;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstate.createBranch = undefined;\n\t\t\t}\n\n\t\t\tif (this.confirm(state.confirm)) {\n\t\t\t\tconst result = yield* this.confirmStep(state as SwitchStepState, context);\n\t\t\t\tif (result === StepResult.Break) continue;\n\t\t\t}\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\tvoid this.execute(state as SwitchStepState);\n\t\t}\n\n\t\treturn state.counter < 0 ? StepResult.Break : undefined;\n\t}\n\n\tprivate *confirmStep(state: SwitchStepState, context: Context): StepResultGenerator<void> {\n\t\tconst step: QuickPickStep<QuickPickItem> = this.createConfirmStep(\n\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tlabel: context.title,\n\t\t\t\t\tdescription: state.createBranch ? '-b' : '',\n\t\t\t\t\tdetail: `Will ${\n\t\t\t\t\t\tstate.createBranch\n\t\t\t\t\t\t\t? `create and switch to a new branch named ${\n\t\t\t\t\t\t\t\t\tstate.createBranch\n\t\t\t\t\t\t\t  } from ${GitReference.toString(state.reference)}`\n\t\t\t\t\t\t\t: `switch to ${GitReference.toString(state.reference)}`\n\t\t\t\t\t} in ${\n\t\t\t\t\t\tstate.repos.length === 1\n\t\t\t\t\t\t\t? `$(repo) ${state.repos[0].formattedName}`\n\t\t\t\t\t\t\t: `${state.repos.length} repositories`\n\t\t\t\t\t}`,\n\t\t\t\t},\n\t\t\t],\n\t\t\tundefined,\n\t\t\t{ placeholder: `Confirm ${context.title}` },\n\t\t);\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? undefined : StepResult.Break;\n\t}\n}\n","'use strict';\nimport { QuickInputButtons, QuickPickItem } from 'vscode';\nimport { Container } from '../../container';\nimport { GitReference, GitTagReference, Repository } from '../../git/git';\nimport { FlagsQuickPickItem, QuickPickItemOfT } from '../../quickpicks';\nimport { Strings } from '../../system';\nimport {\n\tappendReposToTitle,\n\tAsyncStepResultGenerator,\n\tinputTagNameStep,\n\tPartialStepState,\n\tpickBranchOrTagStep,\n\tpickRepositoryStep,\n\tpickTagsStep,\n\tQuickCommand,\n\tQuickPickStep,\n\tStepGenerator,\n\tStepResult,\n\tStepResultGenerator,\n\tStepSelection,\n\tStepState,\n} from '../quickCommand';\n\ninterface Context {\n\trepos: Repository[];\n\tshowTags: boolean;\n\ttitle: string;\n}\n\ntype CreateFlags = '--force' | '-m';\n\ninterface CreateState {\n\tsubcommand: 'create';\n\trepo: string | Repository;\n\treference: GitReference;\n\tname: string;\n\tmessage: string;\n\tflags: CreateFlags[];\n}\n\ninterface DeleteState {\n\tsubcommand: 'delete';\n\trepo: string | Repository;\n\treferences: GitTagReference | GitTagReference[];\n}\n\ntype State = CreateState | DeleteState;\ntype TagStepState<T extends State> = SomeNonNullable<StepState<T>, 'subcommand'>;\ntype CreateStepState<T extends CreateState = CreateState> = TagStepState<ExcludeSome<T, 'repo', string>>;\ntype DeleteStepState<T extends DeleteState = DeleteState> = TagStepState<ExcludeSome<T, 'repo', string>>;\n\nconst subcommandToTitleMap = new Map<State['subcommand'], string>([\n\t['create', 'Create'],\n\t['delete', 'Delete'],\n]);\nfunction getTitle(title: string, subcommand: State['subcommand'] | undefined) {\n\treturn subcommand == null ? title : `${subcommandToTitleMap.get(subcommand)} ${title}`;\n}\n\nexport interface TagGitCommandArgs {\n\treadonly command: 'tag';\n\tconfirm?: boolean;\n\tstate?: Partial<State>;\n}\n\nexport class TagGitCommand extends QuickCommand<State> {\n\tprivate subcommand: State['subcommand'] | undefined;\n\n\tconstructor(args?: TagGitCommandArgs) {\n\t\tsuper('tag', 'tag', 'Tag', {\n\t\t\tdescription: 'create, or delete tags',\n\t\t});\n\n\t\tlet counter = 0;\n\t\tif (args?.state?.subcommand != null) {\n\t\t\tcounter++;\n\n\t\t\tswitch (args.state.subcommand) {\n\t\t\t\tcase 'create':\n\t\t\t\t\tif (args.state.reference != null) {\n\t\t\t\t\t\tcounter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (args.state.name != null) {\n\t\t\t\t\t\tcounter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (args.state.message != null) {\n\t\t\t\t\t\tcounter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'delete':\n\t\t\t\t\tif (\n\t\t\t\t\t\targs.state.references != null &&\n\t\t\t\t\t\t(!Array.isArray(args.state.references) || args.state.references.length !== 0)\n\t\t\t\t\t) {\n\t\t\t\t\t\tcounter++;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (args?.state?.repo != null) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis.initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: args?.confirm,\n\t\t\t...args?.state,\n\t\t};\n\t}\n\n\toverride get canConfirm(): boolean {\n\t\treturn this.subcommand != null;\n\t}\n\n\toverride get canSkipConfirm(): boolean {\n\t\treturn this.subcommand === 'delete' ? false : super.canSkipConfirm;\n\t}\n\n\toverride get skipConfirmKey() {\n\t\treturn `${this.key}${this.subcommand == null ? '' : `-${this.subcommand}`}:${this.pickedVia}`;\n\t}\n\n\tprotected async *steps(state: PartialStepState<State>): StepGenerator {\n\t\tconst context: Context = {\n\t\t\trepos: [...(await Container.git.getOrderedRepositories())],\n\t\t\tshowTags: false,\n\t\t\ttitle: this.title,\n\t\t};\n\n\t\tlet skippedStepTwo = false;\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tcontext.title = this.title;\n\n\t\t\tif (state.counter < 1 || state.subcommand == null) {\n\t\t\t\tthis.subcommand = undefined;\n\n\t\t\t\tconst result = yield* this.pickSubcommandStep(state);\n\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\tstate.subcommand = result;\n\t\t\t}\n\n\t\t\tthis.subcommand = state.subcommand;\n\n\t\t\tif (state.counter < 2 || state.repo == null || typeof state.repo === 'string') {\n\t\t\t\tskippedStepTwo = false;\n\t\t\t\tif (context.repos.length === 1) {\n\t\t\t\t\tskippedStepTwo = true;\n\t\t\t\t\tstate.counter++;\n\n\t\t\t\t\tstate.repo = context.repos[0];\n\t\t\t\t} else {\n\t\t\t\t\tconst result = yield* pickRepositoryStep(state, context);\n\t\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\t\tstate.repo = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcontext.title = getTitle(state.subcommand === 'delete' ? 'Tags' : this.title, state.subcommand);\n\n\t\t\tswitch (state.subcommand) {\n\t\t\t\tcase 'create': {\n\t\t\t\t\tyield* this.createCommandSteps(state as CreateStepState, context);\n\t\t\t\t\t// Clear any chosen name, since we are exiting this subcommand\n\t\t\t\t\tstate.name = undefined;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'delete':\n\t\t\t\t\tyield* this.deleteCommandSteps(state as DeleteStepState, context);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tQuickCommand.endSteps(state);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// If we skipped the previous step, make sure we back up past it\n\t\t\tif (skippedStepTwo) {\n\t\t\t\tstate.counter--;\n\t\t\t}\n\t\t}\n\n\t\treturn state.counter < 0 ? StepResult.Break : undefined;\n\t}\n\n\tprivate *pickSubcommandStep(state: PartialStepState<State>): StepResultGenerator<State['subcommand']> {\n\t\tconst step = QuickCommand.createPickStep<QuickPickItemOfT<State['subcommand']>>({\n\t\t\ttitle: this.title,\n\t\t\tplaceholder: `Choose a ${this.label} command`,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'create',\n\t\t\t\t\tdescription: 'creates a new tag',\n\t\t\t\t\tpicked: state.subcommand === 'create',\n\t\t\t\t\titem: 'create',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'delete',\n\t\t\t\t\tdescription: 'deletes the specified tags',\n\t\t\t\t\tpicked: state.subcommand === 'delete',\n\t\t\t\t\titem: 'delete',\n\t\t\t\t},\n\t\t\t],\n\t\t\tbuttons: [QuickInputButtons.Back],\n\t\t});\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n\t}\n\n\tprivate async *createCommandSteps(state: CreateStepState, context: Context): AsyncStepResultGenerator<void> {\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tif (state.counter < 3 || state.reference == null) {\n\t\t\t\tconst result = yield* pickBranchOrTagStep(state, context, {\n\t\t\t\t\tplaceholder: context =>\n\t\t\t\t\t\t`Choose a branch${context.showTags ? ' or tag' : ''} to create the new tag from`,\n\t\t\t\t\tpicked: state.reference?.ref ?? (await state.repo.getBranch())?.ref,\n\t\t\t\t\tvalue: GitReference.isRevision(state.reference) ? state.reference.ref : undefined,\n\t\t\t\t});\n\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\tstate.reference = result;\n\t\t\t}\n\n\t\t\tif (state.counter < 4 || state.name == null) {\n\t\t\t\tconst result = yield* inputTagNameStep(state, context, {\n\t\t\t\t\tplaceholder: 'Please provide a name for the new tag',\n\t\t\t\t\ttitleContext: ` at ${GitReference.toString(state.reference, { capitalize: true, icon: false })}`,\n\t\t\t\t\tvalue: state.name ?? GitReference.getNameWithoutRemote(state.reference),\n\t\t\t\t});\n\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\tstate.name = result;\n\t\t\t}\n\n\t\t\tif (state.counter < 5 || state.message == null) {\n\t\t\t\tconst result = yield* this.createCommandInputMessageStep(state, context);\n\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\tstate.message = result;\n\t\t\t}\n\n\t\t\tif (state.message.length !== 0 && !state.flags.includes('-m')) {\n\t\t\t\tstate.flags.push('-m');\n\t\t\t}\n\n\t\t\tif (this.confirm(state.confirm)) {\n\t\t\t\tconst result = yield* this.createCommandConfirmStep(state, context);\n\t\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\t\tstate.flags = result;\n\t\t\t}\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\tvoid state.repo.tag(\n\t\t\t\t...state.flags,\n\t\t\t\t...(state.message.length !== 0 ? [`\"${state.message}\"`] : []),\n\t\t\t\tstate.name,\n\t\t\t\tstate.reference.ref,\n\t\t\t);\n\t\t}\n\t}\n\n\tprivate async *createCommandInputMessageStep(\n\t\tstate: CreateStepState,\n\t\tcontext: Context,\n\t): AsyncStepResultGenerator<string> {\n\t\tconst step = QuickCommand.createInputStep({\n\t\t\ttitle: appendReposToTitle(\n\t\t\t\t`${context.title} at ${GitReference.toString(state.reference, { capitalize: true, icon: false })}`,\n\t\t\t\tstate,\n\t\t\t\tcontext,\n\t\t\t),\n\t\t\tplaceholder: 'Please provide an optional message to annotate the tag',\n\t\t\tvalue: state.message,\n\t\t\tprompt: 'Enter optional message',\n\t\t});\n\n\t\tconst value: StepSelection<typeof step> = yield step;\n\n\t\tif (\n\t\t\t!QuickCommand.canStepContinue(step, state, value) ||\n\t\t\t!(await QuickCommand.canInputStepContinue(step, state, value))\n\t\t) {\n\t\t\treturn StepResult.Break;\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tprivate *createCommandConfirmStep(\n\t\tstate: CreateStepState<CreateState>,\n\t\tcontext: Context,\n\t): StepResultGenerator<CreateFlags[]> {\n\t\tconst step: QuickPickStep<FlagsQuickPickItem<CreateFlags>> = QuickCommand.createConfirmStep(\n\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t[\n\t\t\t\tFlagsQuickPickItem.create<CreateFlags>(state.flags, state.message.length !== 0 ? ['-m'] : [], {\n\t\t\t\t\tlabel: context.title,\n\t\t\t\t\tdescription: state.message.length !== 0 ? '-m' : '',\n\t\t\t\t\tdetail: `Will create a new tag named ${state.name} at ${GitReference.toString(state.reference)}`,\n\t\t\t\t}),\n\t\t\t\tFlagsQuickPickItem.create<CreateFlags>(\n\t\t\t\t\tstate.flags,\n\t\t\t\t\tstate.message.length !== 0 ? ['--force', '-m'] : ['--force'],\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: `Force ${context.title}`,\n\t\t\t\t\t\tdescription: `--force${state.message.length !== 0 ? ' -m' : ''}`,\n\t\t\t\t\t\tdetail: `Will forcibly create a new tag named ${state.name} at ${GitReference.toString(\n\t\t\t\t\t\t\tstate.reference,\n\t\t\t\t\t\t)}`,\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t],\n\t\t\tcontext,\n\t\t);\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n\t}\n\n\tprivate async *deleteCommandSteps(state: DeleteStepState, context: Context): StepGenerator {\n\t\twhile (this.canStepsContinue(state)) {\n\t\t\tif (state.references != null && !Array.isArray(state.references)) {\n\t\t\t\tstate.references = [state.references];\n\t\t\t}\n\n\t\t\tif (state.counter < 3 || state.references == null || state.references.length === 0) {\n\t\t\t\tcontext.title = getTitle('Tags', state.subcommand);\n\n\t\t\t\tconst result = yield* pickTagsStep(state, context, {\n\t\t\t\t\tpicked: state.references?.map(r => r.ref),\n\t\t\t\t\tplaceholder: 'Choose tags to delete',\n\t\t\t\t});\n\t\t\t\t// Always break on the first step (so we will go back)\n\t\t\t\tif (result === StepResult.Break) break;\n\n\t\t\t\tstate.references = result;\n\t\t\t}\n\n\t\t\tcontext.title = getTitle(\n\t\t\t\tStrings.pluralize('Tag', state.references.length, { number: '' }).trim(),\n\t\t\t\tstate.subcommand,\n\t\t\t);\n\n\t\t\tconst result = yield* this.deleteCommandConfirmStep(state, context);\n\t\t\tif (result === StepResult.Break) continue;\n\n\t\t\tQuickCommand.endSteps(state);\n\t\t\tvoid state.repo.tagDelete(state.references);\n\t\t}\n\t}\n\n\tprivate *deleteCommandConfirmStep(\n\t\tstate: DeleteStepState<DeleteState>,\n\t\tcontext: Context,\n\t): StepResultGenerator<void> {\n\t\tconst step: QuickPickStep<QuickPickItem> = QuickCommand.createConfirmStep(\n\t\t\tappendReposToTitle(`Confirm ${context.title}`, state, context),\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tlabel: context.title,\n\t\t\t\t\tdetail: `Will delete ${GitReference.toString(state.references)}`,\n\t\t\t\t},\n\t\t\t],\n\t\t\tcontext,\n\t\t);\n\t\tconst selection: StepSelection<typeof step> = yield step;\n\t\treturn QuickCommand.canPickStepContinue(step, state, selection) ? undefined : StepResult.Break;\n\t}\n}\n","'use strict';\nimport { Disposable, InputBox, QuickInputButton, QuickInputButtons, QuickPick, QuickPickItem, window } from 'vscode';\nimport { configuration, GitCommandSorting } from '../configuration';\nimport { Usage, WorkspaceState } from '../constants';\nimport { Container } from '../container';\nimport { KeyMapping } from '../keyboard';\nimport { Directive, DirectiveQuickPickItem } from '../quickpicks';\nimport { log, Promises } from '../system';\nimport { command, Command, CommandContext, Commands } from './common';\nimport { BranchGitCommand, BranchGitCommandArgs } from './git/branch';\nimport { CherryPickGitCommand, CherryPickGitCommandArgs } from './git/cherry-pick';\nimport { CoAuthorsGitCommand, CoAuthorsGitCommandArgs } from './git/coauthors';\nimport { FetchGitCommand, FetchGitCommandArgs } from './git/fetch';\nimport { LogGitCommand, LogGitCommandArgs } from './git/log';\nimport { MergeGitCommand, MergeGitCommandArgs } from './git/merge';\nimport { PullGitCommand, PullGitCommandArgs } from './git/pull';\nimport { PushGitCommand, PushGitCommandArgs } from './git/push';\nimport { RebaseGitCommand, RebaseGitCommandArgs } from './git/rebase';\nimport { ResetGitCommand, ResetGitCommandArgs } from './git/reset';\nimport { RevertGitCommand, RevertGitCommandArgs } from './git/revert';\nimport { SearchGitCommand, SearchGitCommandArgs } from './git/search';\nimport { ShowGitCommand, ShowGitCommandArgs } from './git/show';\nimport { StashGitCommand, StashGitCommandArgs } from './git/stash';\nimport { StatusGitCommand, StatusGitCommandArgs } from './git/status';\nimport { SwitchGitCommand, SwitchGitCommandArgs } from './git/switch';\nimport { TagGitCommand, TagGitCommandArgs } from './git/tag';\nimport {\n\tisQuickInputStep,\n\tisQuickPickStep,\n\tQuickCommand,\n\tQuickInputStep,\n\tQuickPickStep,\n\tStepGenerator,\n\tStepSelection,\n} from './quickCommand';\nimport { QuickCommandButtons, ToggleQuickInputButton } from './quickCommand.buttons';\n\nexport * from './gitCommands.actions';\n\nconst sanitizeLabel = /\\$\\(.+?\\)|\\s/g;\nconst showLoadingSymbol = Symbol('ShowLoading');\n\nexport type GitCommandsCommandArgs =\n\t| BranchGitCommandArgs\n\t| CherryPickGitCommandArgs\n\t| CoAuthorsGitCommandArgs\n\t| FetchGitCommandArgs\n\t| LogGitCommandArgs\n\t| MergeGitCommandArgs\n\t| PullGitCommandArgs\n\t| PushGitCommandArgs\n\t| RebaseGitCommandArgs\n\t| ResetGitCommandArgs\n\t| RevertGitCommandArgs\n\t| SearchGitCommandArgs\n\t| ShowGitCommandArgs\n\t| StashGitCommandArgs\n\t| StatusGitCommandArgs\n\t| SwitchGitCommandArgs\n\t| TagGitCommandArgs;\n\nfunction* nullSteps(): StepGenerator {\n\t/* noop */\n}\n\n@command()\nexport class GitCommandsCommand extends Command {\n\tstatic getSteps(args: GitCommandsCommandArgs, pickedVia: 'menu' | 'command'): StepGenerator {\n\t\tconst commandsStep = new PickCommandStep(args);\n\n\t\tconst command = commandsStep.find(args.command);\n\t\tif (command == null) return nullSteps();\n\n\t\tcommandsStep.setCommand(command, pickedVia);\n\n\t\treturn command.executeSteps();\n\t}\n\n\tprivate startedWith: 'menu' | 'command' = 'menu';\n\n\tconstructor() {\n\t\tsuper([\n\t\t\tCommands.GitCommands,\n\t\t\tCommands.GitCommandsBranch,\n\t\t\tCommands.GitCommandsCherryPick,\n\t\t\tCommands.GitCommandsMerge,\n\t\t\tCommands.GitCommandsRebase,\n\t\t\tCommands.GitCommandsReset,\n\t\t\tCommands.GitCommandsRevert,\n\t\t\tCommands.GitCommandsSwitch,\n\t\t\tCommands.GitCommandsTag,\n\t\t]);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: GitCommandsCommandArgs) {\n\t\tswitch (context.command) {\n\t\t\tcase Commands.GitCommandsBranch:\n\t\t\t\targs = { command: 'branch' };\n\t\t\t\tbreak;\n\t\t\tcase Commands.GitCommandsCherryPick:\n\t\t\t\targs = { command: 'cherry-pick' };\n\t\t\t\tbreak;\n\t\t\tcase Commands.GitCommandsMerge:\n\t\t\t\targs = { command: 'merge' };\n\t\t\t\tbreak;\n\t\t\tcase Commands.GitCommandsRebase:\n\t\t\t\targs = { command: 'rebase' };\n\t\t\t\tbreak;\n\t\t\tcase Commands.GitCommandsReset:\n\t\t\t\targs = { command: 'reset' };\n\t\t\t\tbreak;\n\t\t\tcase Commands.GitCommandsRevert:\n\t\t\t\targs = { command: 'revert' };\n\t\t\t\tbreak;\n\t\t\tcase Commands.GitCommandsSwitch:\n\t\t\t\targs = { command: 'switch' };\n\t\t\t\tbreak;\n\t\t\tcase Commands.GitCommandsTag:\n\t\t\t\targs = { command: 'tag' };\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn this.execute(args);\n\t}\n\n\t@log({ args: false, correlate: true, singleLine: true, timed: false })\n\tasync execute(args?: GitCommandsCommandArgs) {\n\t\tconst commandsStep = new PickCommandStep(args);\n\n\t\tconst command = args?.command != null ? commandsStep.find(args.command) : undefined;\n\t\tthis.startedWith = command != null ? 'command' : 'menu';\n\n\t\tlet ignoreFocusOut;\n\n\t\tlet step;\n\t\tif (command == null) {\n\t\t\tstep = commandsStep;\n\t\t} else {\n\t\t\tstep = await this.showLoadingIfNeeded(command, this.getCommandStep(command, commandsStep));\n\t\t}\n\n\t\t// If this is the first step, don't honor the step's setting\n\t\tif (step?.ignoreFocusOut === true) {\n\t\t\tstep.ignoreFocusOut = undefined;\n\t\t}\n\n\t\twhile (step != null) {\n\t\t\t// If we are trying to back up to the menu and have a starting command, then just reset to the starting command\n\t\t\tif (step === commandsStep && command != null) {\n\t\t\t\tstep = await this.getCommandStep(command, commandsStep);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (ignoreFocusOut && step.ignoreFocusOut == null) {\n\t\t\t\tstep.ignoreFocusOut = true;\n\t\t\t}\n\n\t\t\tif (isQuickPickStep(step)) {\n\t\t\t\tstep = await this.showPickStep(step, commandsStep);\n\t\t\t\tif (step?.ignoreFocusOut === true) {\n\t\t\t\t\tignoreFocusOut = true;\n\t\t\t\t}\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (isQuickInputStep(step)) {\n\t\t\t\tstep = await this.showInputStep(step, commandsStep);\n\t\t\t\tif (step?.ignoreFocusOut === true) {\n\t\t\t\t\tignoreFocusOut = true;\n\t\t\t\t}\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate async showLoadingIfNeeded(\n\t\tcommand: QuickCommand<any>,\n\t\tstepPromise: Promise<QuickPickStep<QuickPickItem> | QuickInputStep | undefined>,\n\t): Promise<QuickPickStep<QuickPickItem> | QuickInputStep | undefined> {\n\t\tconst stepOrTimeout = await Promise.race<\n\t\t\tPromise<QuickPickStep<QuickPickItem> | QuickInputStep | undefined | typeof showLoadingSymbol>\n\t\t>([stepPromise, new Promise(resolve => setTimeout(() => resolve(showLoadingSymbol), 250))]);\n\n\t\tif (stepOrTimeout !== showLoadingSymbol) {\n\t\t\treturn stepOrTimeout;\n\t\t}\n\n\t\tconst quickpick = window.createQuickPick();\n\t\tquickpick.ignoreFocusOut = false;\n\n\t\tconst disposables: Disposable[] = [];\n\n\t\tlet step: QuickPickStep<QuickPickItem> | QuickInputStep | undefined;\n\t\ttry {\n\t\t\t// eslint-disable-next-line no-async-promise-executor\n\t\t\treturn await new Promise<QuickPickStep<QuickPickItem> | QuickInputStep | undefined>(async resolve => {\n\t\t\t\tdisposables.push(quickpick.onDidHide(() => resolve(step)));\n\n\t\t\t\tquickpick.title = command.title;\n\t\t\t\tquickpick.placeholder = 'Loading...';\n\t\t\t\tquickpick.busy = true;\n\t\t\t\tquickpick.enabled = false;\n\n\t\t\t\tquickpick.show();\n\n\t\t\t\tstep = await stepPromise;\n\n\t\t\t\tquickpick.hide();\n\t\t\t});\n\t\t} finally {\n\t\t\tquickpick.dispose();\n\t\t\tdisposables.forEach(d => d.dispose());\n\t\t}\n\t}\n\n\tprivate getButtons(step: QuickInputStep | QuickPickStep | undefined, command?: QuickCommand) {\n\t\tconst buttons: QuickInputButton[] = [];\n\n\t\tif (step != null) {\n\t\t\tif (step.buttons != null) {\n\t\t\t\tbuttons.push(...step.buttons);\n\t\t\t\treturn buttons;\n\t\t\t}\n\n\t\t\tbuttons.push(QuickInputButtons.Back);\n\n\t\t\tif (step.additionalButtons != null) {\n\t\t\t\tbuttons.push(...step.additionalButtons);\n\t\t\t}\n\t\t}\n\n\t\tif (command?.canConfirm) {\n\t\t\tif (command.canSkipConfirm) {\n\t\t\t\tconst willConfirmToggle = new QuickCommandButtons.WillConfirmToggle(command.confirm(), async () => {\n\t\t\t\t\tif (command?.skipConfirmKey == null) return;\n\n\t\t\t\t\tconst skipConfirmations = configuration.get('gitCommands.skipConfirmations') ?? [];\n\n\t\t\t\t\tconst index = skipConfirmations.indexOf(command.skipConfirmKey);\n\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\tskipConfirmations.splice(index, 1);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tskipConfirmations.push(command.skipConfirmKey);\n\t\t\t\t\t}\n\n\t\t\t\t\tvoid (await configuration.updateEffective('gitCommands.skipConfirmations', skipConfirmations));\n\t\t\t\t});\n\t\t\t\tbuttons.push(willConfirmToggle);\n\t\t\t} else {\n\t\t\t\tbuttons.push(QuickCommandButtons.WillConfirmForced);\n\t\t\t}\n\t\t}\n\n\t\treturn buttons;\n\t}\n\n\tprivate async getCommandStep(command: QuickCommand, commandsStep: PickCommandStep) {\n\t\tcommandsStep.setCommand(command, 'command');\n\n\t\tconst next = await command.next();\n\t\tif (next.done) return undefined;\n\n\t\treturn next.value;\n\t}\n\n\tprivate async nextStep(\n\t\tquickInput: InputBox | QuickPick<QuickPickItem>,\n\t\tcommand: QuickCommand,\n\t\tvalue: StepSelection<any> | undefined,\n\t) {\n\t\tquickInput.busy = true;\n\t\t// quickInput.enabled = false;\n\n\t\tconst next = await command.next(value);\n\t\tif (next.done) return undefined;\n\n\t\tquickInput.value = '';\n\t\treturn next.value;\n\t}\n\n\tprivate async showInputStep(step: QuickInputStep, commandsStep: PickCommandStep) {\n\t\tconst input = window.createInputBox();\n\t\tinput.ignoreFocusOut = !configuration.get('gitCommands.closeOnFocusOut') ? true : step.ignoreFocusOut ?? false;\n\n\t\tconst disposables: Disposable[] = [];\n\n\t\ttry {\n\t\t\treturn await new Promise<QuickPickStep | QuickInputStep | undefined>(resolve => {\n\t\t\t\tconst goBack = async () => {\n\t\t\t\t\tinput.value = '';\n\t\t\t\t\tif (commandsStep.command != null) {\n\t\t\t\t\t\tinput.busy = true;\n\t\t\t\t\t\tresolve((await commandsStep.command.previous()) ?? commandsStep);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tconst mapping: KeyMapping = {\n\t\t\t\t\tleft: { onDidPressKey: goBack },\n\t\t\t\t};\n\t\t\t\tif (step.onDidPressKey != null && step.keys != null && step.keys.length !== 0) {\n\t\t\t\t\tfor (const key of step.keys) {\n\t\t\t\t\t\tmapping[key] = {\n\t\t\t\t\t\t\tonDidPressKey: key => step.onDidPressKey!(input, key),\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst scope = Container.keyboard.createScope(mapping);\n\t\t\t\tvoid scope.start();\n\n\t\t\t\tdisposables.push(\n\t\t\t\t\tscope,\n\t\t\t\t\tinput.onDidHide(() => resolve(undefined)),\n\t\t\t\t\tinput.onDidTriggerButton(async e => {\n\t\t\t\t\t\tif (e === QuickInputButtons.Back) {\n\t\t\t\t\t\t\tvoid goBack();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (e === QuickCommandButtons.WillConfirmForced) return;\n\n\t\t\t\t\t\tif (e instanceof ToggleQuickInputButton && e.onDidClick != null) {\n\t\t\t\t\t\t\tconst result = e.onDidClick(input);\n\n\t\t\t\t\t\t\tinput.buttons = this.getButtons(step, commandsStep.command);\n\n\t\t\t\t\t\t\tif ((await result) === true) {\n\t\t\t\t\t\t\t\tresolve(commandsStep.command?.retry());\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (Promises.is(result)) {\n\t\t\t\t\t\t\t\tinput.buttons = this.getButtons(step, commandsStep.command);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (step.onDidClickButton != null) {\n\t\t\t\t\t\t\tconst result = step.onDidClickButton(input, e);\n\t\t\t\t\t\t\tinput.buttons = this.getButtons(step, commandsStep.command);\n\t\t\t\t\t\t\tif ((await result) === true) {\n\t\t\t\t\t\t\t\tresolve(commandsStep.command?.retry());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tinput.onDidChangeValue(async e => {\n\t\t\t\t\t\tif (scope != null) {\n\t\t\t\t\t\t\t// Pause the left/right keyboard commands if there is a value, otherwise the left/right arrows won't work in the input properly\n\t\t\t\t\t\t\tif (e.length !== 0) {\n\t\t\t\t\t\t\t\tawait scope.pause(['left', 'right']);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tawait scope.resume();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (step.validate == null) return;\n\n\t\t\t\t\t\tconst [, message] = await step.validate(e);\n\t\t\t\t\t\tinput.validationMessage = message;\n\t\t\t\t\t}),\n\t\t\t\t\tinput.onDidAccept(async () => {\n\t\t\t\t\t\tresolve(await this.nextStep(input, commandsStep.command!, input.value));\n\t\t\t\t\t}),\n\t\t\t\t);\n\n\t\t\t\tinput.buttons = this.getButtons(step, commandsStep.command);\n\t\t\t\tinput.title = step.title;\n\t\t\t\tinput.placeholder = step.placeholder;\n\t\t\t\tinput.prompt = step.prompt;\n\t\t\t\tif (step.value != null) {\n\t\t\t\t\tinput.value = step.value;\n\t\t\t\t}\n\n\t\t\t\t// If we are starting over clear the previously active command\n\t\t\t\tif (commandsStep.command != null && step === commandsStep) {\n\t\t\t\t\tcommandsStep.setCommand(undefined, 'menu');\n\t\t\t\t}\n\n\t\t\t\tinput.show();\n\n\t\t\t\t// Manually trigger `onDidChangeValue`, because the InputBox seems to fail to call it properly\n\t\t\t\tif (step.value != null) {\n\t\t\t\t\t// HACK: This is fragile!\n\t\t\t\t\t(input as any)._onDidChangeValueEmitter.fire(input.value);\n\t\t\t\t}\n\t\t\t});\n\t\t} finally {\n\t\t\tinput.dispose();\n\t\t\tdisposables.forEach(d => d.dispose());\n\t\t}\n\t}\n\n\tprivate async showPickStep(step: QuickPickStep, commandsStep: PickCommandStep) {\n\t\tconst originalIgnoreFocusOut = !configuration.get('gitCommands.closeOnFocusOut')\n\t\t\t? true\n\t\t\t: step.ignoreFocusOut ?? false;\n\t\tconst originalStepIgnoreFocusOut = step.ignoreFocusOut;\n\n\t\tconst quickpick = window.createQuickPick();\n\t\tquickpick.ignoreFocusOut = originalIgnoreFocusOut;\n\n\t\tconst disposables: Disposable[] = [];\n\n\t\ttry {\n\t\t\treturn await new Promise<QuickPickStep | QuickInputStep | undefined>(resolve => {\n\t\t\t\tasync function goBack() {\n\t\t\t\t\tquickpick.value = '';\n\t\t\t\t\tif (commandsStep.command != null) {\n\t\t\t\t\t\tquickpick.busy = true;\n\t\t\t\t\t\tresolve((await commandsStep.command.previous()) ?? commandsStep);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tasync function loadMore() {\n\t\t\t\t\tif (step.onDidLoadMore == null) return;\n\n\t\t\t\t\tquickpick.busy = true;\n\t\t\t\t\tquickpick.enabled = false;\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst items = await step.onDidLoadMore?.(quickpick);\n\n\t\t\t\t\t\tlet activeIndex = -1;\n\t\t\t\t\t\tif (quickpick.activeItems.length !== 0) {\n\t\t\t\t\t\t\tconst active = quickpick.activeItems[0];\n\t\t\t\t\t\t\tactiveIndex = quickpick.items.indexOf(active);\n\n\t\t\t\t\t\t\t// If the active item is the \"Load more\" directive, then select the previous item\n\t\t\t\t\t\t\tif (DirectiveQuickPickItem.is(active)) {\n\t\t\t\t\t\t\t\tactiveIndex--;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tquickpick.items = step.items = items;\n\n\t\t\t\t\t\tif (activeIndex) {\n\t\t\t\t\t\t\tquickpick.activeItems = [quickpick.items[activeIndex]];\n\t\t\t\t\t\t}\n\t\t\t\t\t} finally {\n\t\t\t\t\t\tquickpick.busy = false;\n\t\t\t\t\t\tquickpick.enabled = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst mapping: KeyMapping = {\n\t\t\t\t\tleft: { onDidPressKey: goBack },\n\t\t\t\t};\n\t\t\t\tif (step.onDidPressKey != null && step.keys != null && step.keys.length !== 0) {\n\t\t\t\t\tfor (const key of step.keys) {\n\t\t\t\t\t\tmapping[key] = {\n\t\t\t\t\t\t\tonDidPressKey: key => step.onDidPressKey!(quickpick, key),\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst scope = Container.keyboard.createScope(mapping);\n\t\t\t\tvoid scope.start();\n\n\t\t\t\tlet overrideItems = false;\n\n\t\t\t\tdisposables.push(\n\t\t\t\t\tscope,\n\t\t\t\t\tquickpick.onDidHide(() => resolve(undefined)),\n\n\t\t\t\t\tquickpick.onDidTriggerButton(async e => {\n\t\t\t\t\t\tif (e === QuickInputButtons.Back) {\n\t\t\t\t\t\t\tvoid goBack();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (e === QuickCommandButtons.WillConfirmForced) return;\n\n\t\t\t\t\t\tif (e === QuickCommandButtons.LoadMore) {\n\t\t\t\t\t\t\tvoid loadMore();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (e instanceof ToggleQuickInputButton && e.onDidClick != null) {\n\t\t\t\t\t\t\tlet activeCommand;\n\t\t\t\t\t\t\tif (commandsStep.command == null && quickpick.activeItems.length !== 0) {\n\t\t\t\t\t\t\t\tconst active = quickpick.activeItems[0];\n\t\t\t\t\t\t\t\tif (QuickCommand.is(active)) {\n\t\t\t\t\t\t\t\t\tactiveCommand = active;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst result = e.onDidClick(quickpick);\n\n\t\t\t\t\t\t\tquickpick.buttons = this.getButtons(\n\t\t\t\t\t\t\t\tactiveCommand != null ? activeCommand.value : step,\n\t\t\t\t\t\t\t\tactiveCommand ?? commandsStep.command,\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tif ((await result) === true) {\n\t\t\t\t\t\t\t\tresolve(commandsStep.command?.retry());\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (Promises.is(result)) {\n\t\t\t\t\t\t\t\tquickpick.buttons = this.getButtons(\n\t\t\t\t\t\t\t\t\tactiveCommand != null ? activeCommand.value : step,\n\t\t\t\t\t\t\t\t\tactiveCommand ?? commandsStep.command,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (step.onDidClickButton != null) {\n\t\t\t\t\t\t\tconst result = step.onDidClickButton(quickpick, e);\n\t\t\t\t\t\t\tquickpick.buttons = this.getButtons(step, commandsStep.command);\n\t\t\t\t\t\t\tif ((await result) === true) {\n\t\t\t\t\t\t\t\tresolve(commandsStep.command?.retry());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tquickpick.onDidChangeValue(async e => {\n\t\t\t\t\t\tif (scope != null) {\n\t\t\t\t\t\t\t// Pause the left/right keyboard commands if there is a value, otherwise the left/right arrows won't work in the input properly\n\t\t\t\t\t\t\tif (e.length !== 0) {\n\t\t\t\t\t\t\t\tawait scope.pause(['left', 'right']);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tawait scope.resume();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (step.onDidChangeValue != null) {\n\t\t\t\t\t\t\tconst cancel = await step.onDidChangeValue(quickpick);\n\t\t\t\t\t\t\tif (cancel) return;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// If something was typed, keep the quick pick open on focus loss\n\t\t\t\t\t\tif (e.length !== 0 && !quickpick.ignoreFocusOut) {\n\t\t\t\t\t\t\tquickpick.ignoreFocusOut = true;\n\t\t\t\t\t\t\tstep.ignoreFocusOut = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// If something typed was cleared, and we changed the behavior, then allow the quick pick close on focus loss\n\t\t\t\t\t\telse if (e.length === 0 && quickpick.ignoreFocusOut && !originalIgnoreFocusOut) {\n\t\t\t\t\t\t\tquickpick.ignoreFocusOut = originalIgnoreFocusOut;\n\t\t\t\t\t\t\tstep.ignoreFocusOut = originalStepIgnoreFocusOut;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!overrideItems) {\n\t\t\t\t\t\t\tif (quickpick.canSelectMany && e === ' ') {\n\t\t\t\t\t\t\t\tquickpick.value = '';\n\t\t\t\t\t\t\t\tquickpick.selectedItems =\n\t\t\t\t\t\t\t\t\tquickpick.selectedItems.length === quickpick.items.length ? [] : quickpick.items;\n\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (e.endsWith(' ')) {\n\t\t\t\t\t\t\t\tif (quickpick.canSelectMany && quickpick.selectedItems.length !== 0) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tlet items;\n\t\t\t\t\t\t\t\tif (commandsStep.command == null) {\n\t\t\t\t\t\t\t\t\tconst command = commandsStep.find(quickpick.value.trim(), true);\n\t\t\t\t\t\t\t\t\tif (command == null) return;\n\n\t\t\t\t\t\t\t\t\tcommandsStep.setCommand(command, this.startedWith);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tconst cmd = quickpick.value.trim().toLowerCase();\n\t\t\t\t\t\t\t\t\tconst item = step.items.find(\n\t\t\t\t\t\t\t\t\t\ti => i.label.replace(sanitizeLabel, '').toLowerCase() === cmd,\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tif (item == null) return;\n\n\t\t\t\t\t\t\t\t\titems = [item];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tresolve(await this.nextStep(quickpick, commandsStep.command!, items));\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Assume there is no matches (since there is no activeItems)\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t!quickpick.canSelectMany &&\n\t\t\t\t\t\t\tcommandsStep.command != null &&\n\t\t\t\t\t\t\te.trim().length !== 0 &&\n\t\t\t\t\t\t\t(overrideItems || quickpick.activeItems.length === 0)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tif (step.onValidateValue == null) return;\n\n\t\t\t\t\t\t\toverrideItems = await step.onValidateValue(quickpick, e.trim(), step.items);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toverrideItems = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// If we are no longer overriding the items, put them back (only if we need to)\n\t\t\t\t\t\tif (!overrideItems && quickpick.items.length !== step.items.length) {\n\t\t\t\t\t\t\tquickpick.items = step.items;\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tquickpick.onDidChangeActive(() => {\n\t\t\t\t\t\tif (commandsStep.command != null || quickpick.activeItems.length === 0) return;\n\n\t\t\t\t\t\tconst command = quickpick.activeItems[0];\n\t\t\t\t\t\tif (!QuickCommand.is(command)) return;\n\n\t\t\t\t\t\tquickpick.buttons = this.getButtons(undefined, command);\n\t\t\t\t\t}),\n\t\t\t\t\tquickpick.onDidChangeSelection(e => {\n\t\t\t\t\t\tif (!quickpick.canSelectMany) return;\n\n\t\t\t\t\t\t// If something was selected, keep the quick pick open on focus loss\n\t\t\t\t\t\tif (e.length !== 0 && !quickpick.ignoreFocusOut) {\n\t\t\t\t\t\t\tquickpick.ignoreFocusOut = true;\n\t\t\t\t\t\t\tstep.ignoreFocusOut = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// If the selection was cleared, and we changed the behavior, then allow the quick pick close on focus loss\n\t\t\t\t\t\telse if (e?.length === 0 && quickpick.ignoreFocusOut && !originalIgnoreFocusOut) {\n\t\t\t\t\t\t\tquickpick.ignoreFocusOut = originalIgnoreFocusOut;\n\t\t\t\t\t\t\tstep.ignoreFocusOut = originalStepIgnoreFocusOut;\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tquickpick.onDidAccept(async () => {\n\t\t\t\t\t\tlet items = quickpick.selectedItems;\n\t\t\t\t\t\tif (items.length === 0) {\n\t\t\t\t\t\t\tif (!quickpick.canSelectMany || quickpick.activeItems.length === 0) {\n\t\t\t\t\t\t\t\tconst value = quickpick.value.trim();\n\t\t\t\t\t\t\t\tif (value.length === 0 && !step.allowEmpty) return;\n\n\t\t\t\t\t\t\t\tif (step.onDidAccept == null) {\n\t\t\t\t\t\t\t\t\tif (step.allowEmpty) {\n\t\t\t\t\t\t\t\t\t\tresolve(await this.nextStep(quickpick, commandsStep.command!, []));\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tquickpick.busy = true;\n\n\t\t\t\t\t\t\t\tif (await step.onDidAccept(quickpick)) {\n\t\t\t\t\t\t\t\t\tresolve(await this.nextStep(quickpick, commandsStep.command!, value));\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tquickpick.busy = false;\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\titems = quickpick.activeItems;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (items.length === 1) {\n\t\t\t\t\t\t\tconst [item] = items;\n\t\t\t\t\t\t\tif (DirectiveQuickPickItem.is(item)) {\n\t\t\t\t\t\t\t\tswitch (item.directive) {\n\t\t\t\t\t\t\t\t\tcase Directive.Cancel:\n\t\t\t\t\t\t\t\t\t\tresolve(undefined);\n\t\t\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t\t\tcase Directive.Back:\n\t\t\t\t\t\t\t\t\t\tvoid goBack();\n\t\t\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t\t\tcase Directive.LoadMore:\n\t\t\t\t\t\t\t\t\t\tvoid loadMore();\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (commandsStep.command == null) {\n\t\t\t\t\t\t\tconst [command] = items;\n\t\t\t\t\t\t\tif (!QuickCommand.is(command)) return;\n\n\t\t\t\t\t\t\tcommandsStep.setCommand(command, this.startedWith);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!quickpick.canSelectMany) {\n\t\t\t\t\t\t\tif (step.onDidAccept != null) {\n\t\t\t\t\t\t\t\tquickpick.busy = true;\n\n\t\t\t\t\t\t\t\tconst next = await step.onDidAccept(quickpick);\n\n\t\t\t\t\t\t\t\tquickpick.busy = false;\n\n\t\t\t\t\t\t\t\tif (!next) return;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresolve(await this.nextStep(quickpick, commandsStep.command!, items as QuickPickItem[]));\n\t\t\t\t\t}),\n\t\t\t\t);\n\n\t\t\t\tquickpick.title = step.title;\n\t\t\t\tquickpick.placeholder = step.placeholder;\n\t\t\t\tquickpick.matchOnDescription = Boolean(step.matchOnDescription);\n\t\t\t\tquickpick.matchOnDetail = Boolean(step.matchOnDetail);\n\t\t\t\tquickpick.canSelectMany = Boolean(step.multiselect);\n\n\t\t\t\tquickpick.items = step.items;\n\n\t\t\t\tif (quickpick.canSelectMany) {\n\t\t\t\t\tquickpick.selectedItems = step.selectedItems ?? quickpick.items.filter(i => i.picked);\n\t\t\t\t\tquickpick.activeItems = quickpick.selectedItems;\n\t\t\t\t} else {\n\t\t\t\t\tquickpick.activeItems = step.selectedItems ?? quickpick.items.filter(i => i.picked);\n\t\t\t\t}\n\n\t\t\t\t// If we are starting over clear the previously active command\n\t\t\t\tif (commandsStep.command != null && step === commandsStep) {\n\t\t\t\t\tcommandsStep.setCommand(undefined, 'menu');\n\t\t\t\t}\n\n\t\t\t\t// Needs to be after we reset the command\n\t\t\t\tquickpick.buttons = this.getButtons(step, commandsStep.command);\n\n\t\t\t\tif (step.value != null) {\n\t\t\t\t\tquickpick.value = step.value;\n\t\t\t\t}\n\n\t\t\t\tquickpick.show();\n\n\t\t\t\t// Manually trigger `onDidChangeValue`, because the QuickPick seems to fail to call it properly\n\t\t\t\tif (step.value != null) {\n\t\t\t\t\t// HACK: This is fragile!\n\t\t\t\t\t(quickpick as any)._onDidChangeValueEmitter.fire(quickpick.value);\n\t\t\t\t}\n\t\t\t});\n\t\t} finally {\n\t\t\tquickpick.dispose();\n\t\t\tdisposables.forEach(d => d.dispose());\n\t\t}\n\t}\n}\n\nclass PickCommandStep implements QuickPickStep {\n\treadonly buttons = [];\n\tprivate readonly hiddenItems: QuickCommand[];\n\tignoreFocusOut = false;\n\treadonly items: QuickCommand[];\n\treadonly matchOnDescription = true;\n\treadonly placeholder = 'Choose a git command';\n\treadonly title = 'GitLens';\n\n\tconstructor(args?: GitCommandsCommandArgs) {\n\t\tthis.items = [\n\t\t\tnew BranchGitCommand(args?.command === 'branch' ? args : undefined),\n\t\t\tnew CherryPickGitCommand(args?.command === 'cherry-pick' ? args : undefined),\n\t\t\tnew CoAuthorsGitCommand(args?.command === 'co-authors' ? args : undefined),\n\t\t\tnew FetchGitCommand(args?.command === 'fetch' ? args : undefined),\n\t\t\tnew LogGitCommand(args?.command === 'log' ? args : undefined),\n\t\t\tnew MergeGitCommand(args?.command === 'merge' ? args : undefined),\n\t\t\tnew PullGitCommand(args?.command === 'pull' ? args : undefined),\n\t\t\tnew PushGitCommand(args?.command === 'push' ? args : undefined),\n\t\t\tnew RebaseGitCommand(args?.command === 'rebase' ? args : undefined),\n\t\t\tnew ResetGitCommand(args?.command === 'reset' ? args : undefined),\n\t\t\tnew RevertGitCommand(args?.command === 'revert' ? args : undefined),\n\t\t\tnew SearchGitCommand(args?.command === 'search' || args?.command === 'grep' ? args : undefined),\n\t\t\tnew ShowGitCommand(args?.command === 'show' ? args : undefined),\n\t\t\tnew StashGitCommand(args?.command === 'stash' ? args : undefined),\n\t\t\tnew StatusGitCommand(args?.command === 'status' ? args : undefined),\n\t\t\tnew SwitchGitCommand(args?.command === 'switch' || args?.command === 'checkout' ? args : undefined),\n\t\t\tnew TagGitCommand(args?.command === 'tag' ? args : undefined),\n\t\t];\n\n\t\tif (Container.config.gitCommands.sortBy === GitCommandSorting.Usage) {\n\t\t\tconst usage = Container.context.workspaceState.get<Usage>(WorkspaceState.GitCommandPaletteUsage);\n\t\t\tif (usage != null) {\n\t\t\t\tthis.items.sort((a, b) => (usage[b.key] ?? 0) - (usage[a.key] ?? 0));\n\t\t\t}\n\t\t}\n\n\t\tthis.hiddenItems = [];\n\t}\n\n\tprivate _command: QuickCommand | undefined;\n\tget command(): QuickCommand | undefined {\n\t\treturn this._command;\n\t}\n\n\tfind(commandName: string, fuzzy: boolean = false) {\n\t\tif (fuzzy) {\n\t\t\tconst cmd = commandName.toLowerCase();\n\t\t\treturn this.items.find(c => c.isFuzzyMatch(cmd)) ?? this.hiddenItems.find(c => c.isFuzzyMatch(cmd));\n\t\t}\n\n\t\treturn this.items.find(c => c.isMatch(commandName)) ?? this.hiddenItems.find(c => c.isMatch(commandName));\n\t}\n\n\tsetCommand(command: QuickCommand | undefined, via: 'menu' | 'command'): void {\n\t\tif (this._command != null) {\n\t\t\tthis._command.picked = false;\n\t\t}\n\n\t\tif (command != null) {\n\t\t\tcommand.picked = true;\n\t\t\tcommand.pickedVia = via;\n\t\t}\n\n\t\tthis._command = command;\n\t\tif (command != null) {\n\t\t\tvoid this.updateCommandUsage(command.key, Date.now());\n\t\t}\n\t}\n\n\tprivate async updateCommandUsage(id: string, timestamp: number) {\n\t\tlet usage = Container.context.workspaceState.get<Usage>(WorkspaceState.GitCommandPaletteUsage);\n\t\tif (usage === undefined) {\n\t\t\tusage = Object.create(null) as Usage;\n\t\t}\n\n\t\tusage[id] = timestamp;\n\t\tawait Container.context.workspaceState.update(WorkspaceState.GitCommandPaletteUsage, usage);\n\t}\n}\n","'use strict';\nimport { SourceControl } from 'vscode';\nimport { Container } from '../container';\nimport { command, Command, Commands } from './common';\nimport { executeGitCommand } from './gitCommands';\n\n@command()\nexport class AddAuthorsCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.AddAuthors);\n\t}\n\n\tasync execute(sourceControl: SourceControl) {\n\t\tlet repo;\n\t\tif (sourceControl?.rootUri != null) {\n\t\t\trepo = await Container.git.getRepository(sourceControl.rootUri);\n\t\t}\n\n\t\treturn executeGitCommand({\n\t\t\tcommand: 'co-authors',\n\t\t\tstate: { repo: repo, contributors: undefined },\n\t\t});\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { commands, TextEditor, Uri } from 'vscode';\nimport { BuiltInCommands } from '../constants';\nimport { Container } from '../container';\nimport { toGitLensFSUri } from '../git/fsProvider';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { ActiveEditorCommand, command, CommandContext, Commands, getCommandUri, openWorkspace } from './common';\n\nexport interface BrowseRepoAtRevisionCommandArgs {\n\turi?: Uri;\n\n\tbefore?: boolean;\n\topenInNewWindow?: boolean;\n}\n\n@command()\nexport class BrowseRepoAtRevisionCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([\n\t\t\tCommands.BrowseRepoAtRevision,\n\t\t\tCommands.BrowseRepoAtRevisionInNewWindow,\n\t\t\tCommands.BrowseRepoBeforeRevision,\n\t\t\tCommands.BrowseRepoBeforeRevisionInNewWindow,\n\t\t]);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: BrowseRepoAtRevisionCommandArgs) {\n\t\tswitch (context.command) {\n\t\t\tcase Commands.BrowseRepoAtRevisionInNewWindow:\n\t\t\t\targs = { ...args, before: false, openInNewWindow: true };\n\t\t\t\tbreak;\n\t\t\tcase Commands.BrowseRepoBeforeRevision:\n\t\t\t\targs = { ...args, before: true, openInNewWindow: false };\n\t\t\t\tbreak;\n\t\t\tcase Commands.BrowseRepoBeforeRevisionInNewWindow:\n\t\t\t\targs = { ...args, before: true, openInNewWindow: true };\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn this.execute(context.editor!, context.uri, args);\n\t}\n\n\tasync execute(editor: TextEditor, uri?: Uri, args?: BrowseRepoAtRevisionCommandArgs) {\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\tif (args.uri == null) {\n\t\t\t\turi = getCommandUri(uri, editor);\n\t\t\t\tif (uri == null) return;\n\t\t\t} else {\n\t\t\t\turi = args.uri;\n\t\t\t}\n\n\t\t\tlet gitUri = await GitUri.fromUri(uri);\n\t\t\tif (gitUri.sha == null) return;\n\n\t\t\tconst sha = args?.before\n\t\t\t\t? await Container.git.resolveReference(gitUri.repoPath!, `${gitUri.sha}^`)\n\t\t\t\t: gitUri.sha;\n\t\t\turi = toGitLensFSUri(sha, gitUri.repoPath!);\n\t\t\tgitUri = GitUri.fromRevisionUri(uri);\n\n\t\t\topenWorkspace(uri, `${paths.basename(gitUri.repoPath!)} @ ${gitUri.shortSha}`, {\n\t\t\t\topenInNewWindow: args.openInNewWindow,\n\t\t\t});\n\n\t\t\tif (!args.openInNewWindow) {\n\t\t\t\tvoid commands.executeCommand(BuiltInCommands.FocusFilesExplorer);\n\t\t\t}\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'BrowseRepoAtRevisionCommand');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to open the repository at the specified revision');\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands, TextEditor, Uri, window } from 'vscode';\nimport { TextEditorComparer, UriComparer } from '../comparers';\nimport { BuiltInCommands } from '../constants';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { Functions } from '../system';\nimport { Command, command, Commands, getRepoPathOrPrompt } from './common';\n\nexport interface CloseUnchangedFilesCommandArgs {\n\turis?: Uri[];\n}\n\n@command()\nexport class CloseUnchangedFilesCommand extends Command {\n\tprivate _onEditorChangedFn: ((editor: TextEditor | undefined) => void) | undefined;\n\n\tconstructor() {\n\t\tsuper(Commands.CloseUnchangedFiles);\n\t}\n\n\tasync execute(args?: CloseUnchangedFilesCommandArgs) {\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\tif (args.uris == null) {\n\t\t\t\tconst repoPath = await getRepoPathOrPrompt('Close All Unchanged Files');\n\t\t\t\tif (!repoPath) return;\n\n\t\t\t\tconst status = await Container.git.getStatusForRepo(repoPath);\n\t\t\t\tif (status == null) {\n\t\t\t\t\tvoid window.showWarningMessage('Unable to close unchanged files');\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\targs.uris = status.files.map(f => f.uri);\n\t\t\t}\n\n\t\t\tif (args.uris.length === 0) {\n\t\t\t\tvoid commands.executeCommand(BuiltInCommands.CloseAllEditors);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst disposable = window.onDidChangeActiveTextEditor(\n\t\t\t\tFunctions.debounce((e: TextEditor | undefined) => this._onEditorChangedFn?.(e), 50),\n\t\t\t);\n\n\t\t\tlet editor = window.activeTextEditor;\n\n\t\t\tlet count = 0;\n\t\t\tlet loopCount = 0;\n\t\t\tconst editors: TextEditor[] = [];\n\n\t\t\t// Find out how many editors there are\n\t\t\twhile (true) {\n\t\t\t\tif (editor != null) {\n\t\t\t\t\tlet found = false;\n\t\t\t\t\tfor (const e of editors) {\n\t\t\t\t\t\tif (TextEditorComparer.equals(e, editor, { usePosition: true })) {\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (found) break;\n\n\t\t\t\t\t// Start counting at the first real editor\n\t\t\t\t\tcount++;\n\t\t\t\t\teditors.push(editor);\n\t\t\t\t} else if (count !== 0) {\n\t\t\t\t\tcount++;\n\t\t\t\t}\n\n\t\t\t\teditor = await this.nextEditor();\n\n\t\t\t\tloopCount++;\n\t\t\t\t// Break out if we've looped 4 times and haven't found any editors\n\t\t\t\tif (loopCount >= 4 && editors.length === 0) break;\n\t\t\t}\n\n\t\t\tif (editors.length) {\n\t\t\t\teditor = window.activeTextEditor;\n\n\t\t\t\tfor (let i = 0; i <= count; i++) {\n\t\t\t\t\tif (\n\t\t\t\t\t\teditor == null ||\n\t\t\t\t\t\teditor.document.isDirty ||\n\t\t\t\t\t\t// eslint-disable-next-line no-loop-func\n\t\t\t\t\t\targs.uris.some(uri => UriComparer.equals(uri, editor?.document.uri))\n\t\t\t\t\t) {\n\t\t\t\t\t\teditor = await this.nextEditor();\n\t\t\t\t\t} else {\n\t\t\t\t\t\teditor = await this.closeEditor();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdisposable.dispose();\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'CloseUnchangedFilesCommand');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to close all unchanged files');\n\t\t}\n\t}\n\n\tprivate async closeEditor(timeout: number = 500): Promise<TextEditor | undefined> {\n\t\tconst editor = window.activeTextEditor;\n\n\t\tvoid (await commands.executeCommand(BuiltInCommands.CloseActiveEditor));\n\n\t\tif (editor !== window.activeTextEditor) {\n\t\t\treturn window.activeTextEditor;\n\t\t}\n\n\t\treturn this.waitForEditorChange(timeout);\n\t}\n\n\tprivate async nextEditor(timeout: number = 500): Promise<TextEditor | undefined> {\n\t\tconst editor = window.activeTextEditor;\n\n\t\tvoid (await commands.executeCommand(BuiltInCommands.NextEditor));\n\n\t\tif (editor !== window.activeTextEditor) {\n\t\t\treturn window.activeTextEditor;\n\t\t}\n\n\t\treturn this.waitForEditorChange(timeout);\n\t}\n\n\tprivate waitForEditorChange(timeout: number = 500): Promise<TextEditor | undefined> {\n\t\treturn new Promise<TextEditor | undefined>(resolve => {\n\t\t\tlet timer: NodeJS.Timer | undefined;\n\n\t\t\tthis._onEditorChangedFn = (editor: TextEditor | undefined) => {\n\t\t\t\tif (timer != null) {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\ttimer = undefined;\n\n\t\t\t\t\tresolve(editor);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\ttimer = setTimeout(() => {\n\t\t\t\ttimer = undefined;\n\n\t\t\t\tresolve(window.activeTextEditor);\n\t\t\t}, timeout);\n\t\t});\n\t}\n}\n","'use strict';\nimport { ContextKeys, setContext, SyncedState } from '../constants';\nimport { Container } from '../container';\nimport { command, Command, CommandContext, Commands } from './common';\n\n@command()\nexport class CloseViewCommand extends Command {\n\tconstructor() {\n\t\tsuper([Commands.CloseWelcomeView]);\n\t}\n\n\tprotected override preExecute(context: CommandContext) {\n\t\treturn this.execute(context.command as Commands);\n\t}\n\n\tasync execute(command: Commands) {\n\t\tswitch (command) {\n\t\t\tcase Commands.CloseWelcomeView:\n\t\t\t\tawait Container.context.globalState.update(SyncedState.WelcomeViewVisible, false);\n\t\t\t\tawait setContext(ContextKeys.ViewsWelcomeVisible, false);\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n","'use strict';\nimport { TextEditor, Uri } from 'vscode';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tgetRepoPathOrActiveOrPrompt,\n} from './common';\n\nexport interface CompareWithCommandArgs {\n\tref1?: string;\n\tref2?: string;\n}\n\n@command()\nexport class CompareWithCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([\n\t\t\tCommands.CompareWith,\n\t\t\tCommands.CompareHeadWith,\n\t\t\tCommands.CompareWorkingWith,\n\t\t\tCommands.Deprecated_DiffHeadWith,\n\t\t\tCommands.Deprecated_DiffWorkingWith,\n\t\t]);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: CompareWithCommandArgs) {\n\t\tswitch (context.command) {\n\t\t\tcase Commands.CompareWith:\n\t\t\t\targs = { ...args };\n\t\t\t\tbreak;\n\n\t\t\tcase Commands.CompareHeadWith:\n\t\t\tcase Commands.Deprecated_DiffHeadWith:\n\t\t\t\targs = { ...args };\n\t\t\t\targs.ref1 = 'HEAD';\n\t\t\t\tbreak;\n\n\t\t\tcase Commands.CompareWorkingWith:\n\t\t\tcase Commands.Deprecated_DiffWorkingWith:\n\t\t\t\targs = { ...args };\n\t\t\t\targs.ref1 = '';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: CompareWithCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\tlet title;\n\t\t\tswitch (args.ref1) {\n\t\t\t\tcase null:\n\t\t\t\t\ttitle = 'Compare';\n\t\t\t\t\tbreak;\n\t\t\t\tcase '':\n\t\t\t\t\ttitle = 'Compare Working Tree with';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'HEAD':\n\t\t\t\t\ttitle = 'Compare HEAD with';\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\ttitle = `Compare ${args.ref1} with`;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst repoPath = await getRepoPathOrActiveOrPrompt(uri, editor, title);\n\t\t\tif (!repoPath) return;\n\n\t\t\tif (args.ref1 != null && args.ref2 != null) {\n\t\t\t\tvoid (await Container.searchAndCompareView.compare(repoPath, args.ref1, args.ref2));\n\t\t\t} else {\n\t\t\t\tContainer.searchAndCompareView.selectForCompare(repoPath, args.ref1, { prompt: true });\n\t\t\t}\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'CompareWithCommmand');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to open comparison');\n\t\t}\n\t}\n}\n","'use strict';\nimport { env, TextEditor, Uri, window } from 'vscode';\nimport { Container } from '../container';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { ActiveEditorCommand, command, Commands, getCommandUri, getRepoPathOrActiveOrPrompt } from './common';\n\n@command()\nexport class CopyCurrentBranchCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.CopyCurrentBranch);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri) {\n\t\turi = getCommandUri(uri, editor);\n\n\t\tconst gitUri = uri != null ? await GitUri.fromUri(uri) : undefined;\n\n\t\tconst repoPath = await getRepoPathOrActiveOrPrompt(gitUri, editor, 'Copy Current Branch Name');\n\t\tif (!repoPath) return;\n\n\t\ttry {\n\t\t\tconst branch = await Container.git.getBranch(repoPath);\n\t\t\tif (branch?.name) {\n\t\t\t\tawait env.clipboard.writeText(branch.name);\n\t\t\t}\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'CopyCurrentBranchCommand');\n\t\t\tvoid window.showErrorMessage('Unable to copy current branch name. See output channel for more details');\n\t\t}\n\t}\n}\n","'use strict';\nimport { env, TextEditor, Uri } from 'vscode';\nimport { Container } from '../container';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { Iterables } from '../system';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tisCommandContextViewNodeHasBranch,\n\tisCommandContextViewNodeHasCommit,\n\tisCommandContextViewNodeHasTag,\n} from './common';\n\nexport interface CopyMessageToClipboardCommandArgs {\n\tmessage?: string;\n\tsha?: string;\n}\n\n@command()\nexport class CopyMessageToClipboardCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.CopyMessageToClipboard);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: CopyMessageToClipboardCommandArgs) {\n\t\tif (isCommandContextViewNodeHasCommit(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.sha = context.node.commit.sha;\n\t\t\treturn this.execute(context.editor, context.node.commit.uri, args);\n\t\t} else if (isCommandContextViewNodeHasBranch(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.sha = context.node.branch.sha;\n\t\t\treturn this.execute(context.editor, context.node.uri, args);\n\t\t} else if (isCommandContextViewNodeHasTag(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.sha = context.node.tag.sha;\n\t\t\treturn this.execute(context.editor, context.node.uri, args);\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: CopyMessageToClipboardCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\tlet repoPath;\n\t\t\t// If we don't have an editor then get the message of the last commit to the branch\n\t\t\tif (uri == null) {\n\t\t\t\trepoPath = await Container.git.getActiveRepoPath(editor);\n\t\t\t\tif (!repoPath) return;\n\n\t\t\t\tconst log = await Container.git.getLog(repoPath, { limit: 1 });\n\t\t\t\tif (log == null) return;\n\n\t\t\t\targs.message = Iterables.first(log.commits.values()).message;\n\t\t\t} else if (args.message == null) {\n\t\t\t\tconst gitUri = await GitUri.fromUri(uri);\n\t\t\t\trepoPath = gitUri.repoPath;\n\n\t\t\t\tif (args.sha == null) {\n\t\t\t\t\tconst blameline = editor?.selection.active.line ?? 0;\n\t\t\t\t\tif (blameline < 0) return;\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst blame = editor?.document.isDirty\n\t\t\t\t\t\t\t? await Container.git.getBlameForLineContents(gitUri, blameline, editor.document.getText())\n\t\t\t\t\t\t\t: await Container.git.getBlameForLine(gitUri, blameline);\n\t\t\t\t\t\tif (blame == null) return;\n\n\t\t\t\t\t\tif (blame.commit.isUncommitted) return;\n\n\t\t\t\t\t\targs.sha = blame.commit.sha;\n\t\t\t\t\t\tif (!repoPath) {\n\t\t\t\t\t\t\trepoPath = blame.commit.repoPath;\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\tLogger.error(ex, 'CopyMessageToClipboardCommand', `getBlameForLine(${blameline})`);\n\t\t\t\t\t\tvoid Messages.showGenericErrorMessage('Unable to copy message');\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Get the full commit message -- since blame only returns the summary\n\t\t\t\tconst commit = await Container.git.getCommit(repoPath!, args.sha);\n\t\t\t\tif (commit == null) return;\n\n\t\t\t\targs.message = commit.message;\n\t\t\t}\n\n\t\t\tvoid (await env.clipboard.writeText(args.message));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'CopyMessageToClipboardCommand');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to copy message');\n\t\t}\n\t}\n}\n","'use strict';\nimport { env, TextEditor, Uri } from 'vscode';\nimport { Container } from '../container';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { Iterables } from '../system';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tisCommandContextViewNodeHasBranch,\n\tisCommandContextViewNodeHasCommit,\n\tisCommandContextViewNodeHasTag,\n} from './common';\n\nexport interface CopyShaToClipboardCommandArgs {\n\tsha?: string;\n}\n\n@command()\nexport class CopyShaToClipboardCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.CopyShaToClipboard);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: CopyShaToClipboardCommandArgs) {\n\t\tif (isCommandContextViewNodeHasCommit(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.sha = Container.config.advanced.abbreviateShaOnCopy\n\t\t\t\t? context.node.commit.shortSha\n\t\t\t\t: context.node.commit.sha;\n\t\t\treturn this.execute(context.editor, context.node.commit.uri, args);\n\t\t} else if (isCommandContextViewNodeHasBranch(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.sha = context.node.branch.sha;\n\t\t\treturn this.execute(context.editor, context.node.uri, args);\n\t\t} else if (isCommandContextViewNodeHasTag(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.sha = context.node.tag.sha;\n\t\t\treturn this.execute(context.editor, context.node.uri, args);\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: CopyShaToClipboardCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\t// If we don't have an editor then get the sha of the last commit to the branch\n\t\t\tif (uri == null) {\n\t\t\t\tconst repoPath = await Container.git.getActiveRepoPath(editor);\n\t\t\t\tif (!repoPath) return;\n\n\t\t\t\tconst log = await Container.git.getLog(repoPath, { limit: 1 });\n\t\t\t\tif (log == null) return;\n\n\t\t\t\targs.sha = Iterables.first(log.commits.values()).sha;\n\t\t\t} else if (args.sha == null) {\n\t\t\t\tconst blameline = editor?.selection.active.line ?? 0;\n\t\t\t\tif (blameline < 0) return;\n\n\t\t\t\ttry {\n\t\t\t\t\tconst gitUri = await GitUri.fromUri(uri);\n\t\t\t\t\tconst blame = editor?.document.isDirty\n\t\t\t\t\t\t? await Container.git.getBlameForLineContents(gitUri, blameline, editor.document.getText())\n\t\t\t\t\t\t: await Container.git.getBlameForLine(gitUri, blameline);\n\t\t\t\t\tif (blame == null) return;\n\n\t\t\t\t\targs.sha = blame.commit.sha;\n\t\t\t\t} catch (ex) {\n\t\t\t\t\tLogger.error(ex, 'CopyShaToClipboardCommand', `getBlameForLine(${blameline})`);\n\t\t\t\t\tvoid Messages.showGenericErrorMessage('Unable to copy commit SHA');\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvoid (await env.clipboard.writeText(args.sha));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'CopyShaToClipboardCommand');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to copy commit SHA');\n\t\t}\n\t}\n}\n","'use strict';\nimport { Container } from '../container';\nimport { GitRemote, RemoteProvider, RemoteResource, RemoteResourceType } from '../git/git';\nimport { Command, command, Commands, executeCommand } from './common';\nimport { OpenOnRemoteCommandArgs } from './openOnRemote';\n\nexport interface CreatePullRequestOnRemoteCommandArgs {\n\tbase?: string;\n\tcompare: string;\n\tremote: string;\n\trepoPath: string;\n\n\tclipboard?: boolean;\n}\n\n@command()\nexport class CreatePullRequestOnRemoteCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.CreatePullRequestOnRemote);\n\t}\n\n\tasync execute(args?: CreatePullRequestOnRemoteCommandArgs) {\n\t\tif (args?.repoPath == null) return;\n\n\t\tconst repo = await Container.git.getRepository(args.repoPath);\n\t\tif (repo == null) return;\n\n\t\tconst compareRemote = await repo.getRemote(args.remote);\n\t\tif (compareRemote?.provider == null) return;\n\n\t\tconst providerId = compareRemote.provider.id;\n\t\tconst remotes = (await repo.getRemotes({\n\t\t\tfilter: r => r.provider?.id === providerId,\n\t\t})) as GitRemote<RemoteProvider>[];\n\n\t\tconst resource: RemoteResource = {\n\t\t\ttype: RemoteResourceType.CreatePullRequest,\n\t\t\tbase: {\n\t\t\t\tbranch: args.base,\n\t\t\t\tremote: undefined!,\n\t\t\t},\n\t\t\tcompare: {\n\t\t\t\tbranch: args.compare,\n\t\t\t\tremote: { path: compareRemote.path, url: compareRemote.url },\n\t\t\t},\n\t\t};\n\n\t\tvoid (await executeCommand<OpenOnRemoteCommandArgs>(Commands.OpenOnRemote, {\n\t\t\tresource: resource,\n\t\t\tremotes: remotes,\n\t\t}));\n\t}\n}\n","'use strict';\nimport { TextEditor, Uri } from 'vscode';\nimport { GitActions } from '../commands';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { ReferencePicker } from '../quickpicks';\nimport { CompareResultsNode } from '../views/nodes';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tgetRepoPathOrActiveOrPrompt,\n\tisCommandContextViewNodeHasRef,\n} from './common';\n\nexport interface OpenDirectoryCompareCommandArgs {\n\tref1?: string;\n\tref2?: string;\n}\n\n@command()\nexport class OpenDirectoryCompareCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([\n\t\t\tCommands.DiffDirectory,\n\t\t\tCommands.DiffDirectoryWithHead,\n\t\t\tCommands.ViewsOpenDirectoryDiff,\n\t\t\tCommands.ViewsOpenDirectoryDiffWithWorking,\n\t\t]);\n\t}\n\n\tprotected override async preExecute(context: CommandContext, args?: OpenDirectoryCompareCommandArgs) {\n\t\tswitch (context.command) {\n\t\t\tcase Commands.DiffDirectoryWithHead:\n\t\t\t\targs = { ...args };\n\t\t\t\targs.ref1 = 'HEAD';\n\t\t\t\targs.ref2 = undefined;\n\t\t\t\tbreak;\n\n\t\t\tcase Commands.ViewsOpenDirectoryDiff:\n\t\t\t\tif (context.type === 'viewItem' && context.node instanceof CompareResultsNode) {\n\t\t\t\t\targs = { ...args };\n\t\t\t\t\t[args.ref1, args.ref2] = await context.node.getDiffRefs();\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase Commands.ViewsOpenDirectoryDiffWithWorking:\n\t\t\t\tif (isCommandContextViewNodeHasRef(context)) {\n\t\t\t\t\targs = { ...args };\n\t\t\t\t\targs.ref1 = context.node.ref.ref;\n\t\t\t\t\targs.ref2 = undefined;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: OpenDirectoryCompareCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\tconst repoPath = await getRepoPathOrActiveOrPrompt(uri, editor, 'Directory Compare Working Tree With');\n\t\t\tif (!repoPath) return;\n\n\t\t\tif (!args.ref1) {\n\t\t\t\tconst pick = await ReferencePicker.show(\n\t\t\t\t\trepoPath,\n\t\t\t\t\t'Directory Compare Working Tree with',\n\t\t\t\t\t'Choose a branch or tag to compare with',\n\t\t\t\t\t{\n\t\t\t\t\t\tallowEnteringRefs: true,\n\t\t\t\t\t\t// checkmarks: false,\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t\tif (pick == null) return;\n\n\t\t\t\targs.ref1 = pick.ref;\n\t\t\t\tif (args.ref1 == null) return;\n\t\t\t}\n\n\t\t\tvoid GitActions.Commit.openDirectoryCompare(repoPath, args.ref1, args.ref2);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenDirectoryCompareCommand');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to open directory compare');\n\t\t}\n\t}\n}\n","'use strict';\nimport { TextDocumentShowOptions, TextEditor, Uri } from 'vscode';\nimport { Container } from '../container';\nimport { GitCommit } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { ActiveEditorCommand, command, Commands, executeCommand, getCommandUri } from './common';\nimport { DiffWithCommandArgs } from './diffWith';\n\nexport interface DiffLineWithPreviousCommandArgs {\n\tcommit?: GitCommit;\n\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n}\n\n@command()\nexport class DiffLineWithPreviousCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.DiffLineWithPrevious);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: DiffLineWithPreviousCommandArgs): Promise<any> {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return;\n\n\t\targs = { ...args };\n\t\tif (args.line == null) {\n\t\t\targs.line = editor?.selection.active.line ?? 0;\n\t\t}\n\n\t\tconst gitUri = args.commit != null ? GitUri.fromCommit(args.commit) : await GitUri.fromUri(uri);\n\n\t\ttry {\n\t\t\tconst diffUris = await Container.git.getPreviousLineDiffUris(\n\t\t\t\tgitUri.repoPath!,\n\t\t\t\tgitUri,\n\t\t\t\targs.line,\n\t\t\t\tgitUri.sha,\n\t\t\t);\n\n\t\t\tif (diffUris == null || diffUris.previous == null) {\n\t\t\t\tvoid Messages.showCommitHasNoPreviousCommitWarningMessage();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvoid (await executeCommand<DiffWithCommandArgs>(Commands.DiffWith, {\n\t\t\t\trepoPath: diffUris.current.repoPath,\n\t\t\t\tlhs: {\n\t\t\t\t\tsha: diffUris.previous.sha ?? '',\n\t\t\t\t\turi: diffUris.previous.documentUri(),\n\t\t\t\t},\n\t\t\t\trhs: {\n\t\t\t\t\tsha: diffUris.current.sha ?? '',\n\t\t\t\t\turi: diffUris.current.documentUri(),\n\t\t\t\t},\n\t\t\t\tline: diffUris.line,\n\t\t\t\tshowOptions: args.showOptions,\n\t\t\t}));\n\t\t} catch (ex) {\n\t\t\tLogger.error(\n\t\t\t\tex,\n\t\t\t\t'DiffLineWithPreviousCommand',\n\t\t\t\t`getPreviousLineDiffUris(${gitUri.repoPath}, ${gitUri.fsPath}, ${gitUri.sha})`,\n\t\t\t);\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to open compare');\n\t\t}\n\t}\n}\n","'use strict';\nimport { TextDocumentShowOptions, TextEditor, Uri, window } from 'vscode';\nimport { Container } from '../container';\nimport { GitCommit, GitRevision } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { ActiveEditorCommand, command, Commands, executeCommand, getCommandUri } from './common';\nimport { DiffWithCommandArgs } from './diffWith';\n\nexport interface DiffLineWithWorkingCommandArgs {\n\tcommit?: GitCommit;\n\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n}\n\n@command()\nexport class DiffLineWithWorkingCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.DiffLineWithWorking);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: DiffLineWithWorkingCommandArgs): Promise<any> {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return;\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\n\t\targs = { ...args };\n\t\tif (args.line == null) {\n\t\t\targs.line = editor?.selection.active.line ?? 0;\n\t\t}\n\n\t\tif (args.commit == null || args.commit.isUncommitted) {\n\t\t\tconst blameline = args.line;\n\t\t\tif (blameline < 0) return;\n\n\t\t\ttry {\n\t\t\t\tconst blame = editor?.document.isDirty\n\t\t\t\t\t? await Container.git.getBlameForLineContents(gitUri, blameline, editor.document.getText())\n\t\t\t\t\t: await Container.git.getBlameForLine(gitUri, blameline);\n\t\t\t\tif (blame == null) {\n\t\t\t\t\tvoid Messages.showFileNotUnderSourceControlWarningMessage('Unable to open compare');\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\targs.commit = blame.commit;\n\n\t\t\t\t// If the line is uncommitted, change the previous commit\n\t\t\t\tif (args.commit.isUncommitted) {\n\t\t\t\t\tconst status = await Container.git.getStatusForFile(gitUri.repoPath!, gitUri.fsPath);\n\t\t\t\t\targs.commit = args.commit.with({\n\t\t\t\t\t\tsha: status?.indexStatus != null ? GitRevision.uncommittedStaged : args.commit.previousSha!,\n\t\t\t\t\t\tfileName: args.commit.previousFileName!,\n\t\t\t\t\t\toriginalFileName: null,\n\t\t\t\t\t\tpreviousSha: null,\n\t\t\t\t\t\tpreviousFileName: null,\n\t\t\t\t\t});\n\t\t\t\t\t// editor lines are 0-based\n\t\t\t\t\targs.line = blame.line.line - 1;\n\t\t\t\t}\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, 'DiffLineWithWorkingCommand', `getBlameForLine(${blameline})`);\n\t\t\t\tvoid Messages.showGenericErrorMessage('Unable to open compare');\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst workingUri = await args.commit.getWorkingUri();\n\t\tif (workingUri == null) {\n\t\t\tvoid window.showWarningMessage('Unable to open compare. File has been deleted from the working tree');\n\n\t\t\treturn;\n\t\t}\n\n\t\tvoid (await executeCommand<DiffWithCommandArgs>(Commands.DiffWith, {\n\t\t\trepoPath: args.commit.repoPath,\n\t\t\tlhs: {\n\t\t\t\tsha: args.commit.sha,\n\t\t\t\turi: args.commit.uri,\n\t\t\t},\n\t\t\trhs: {\n\t\t\t\tsha: '',\n\t\t\t\turi: workingUri,\n\t\t\t},\n\t\t\tline: args.line,\n\t\t\tshowOptions: args.showOptions,\n\t\t}));\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { commands, Range, TextDocumentShowOptions, Uri, ViewColumn } from 'vscode';\nimport { BuiltInCommands, GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitCommit, GitRevision } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { command, Command, Commands } from './common';\n\nexport interface DiffWithCommandArgsRevision {\n\tsha: string;\n\turi: Uri;\n\ttitle?: string;\n}\n\nexport interface DiffWithCommandArgs {\n\tlhs: DiffWithCommandArgsRevision;\n\trhs: DiffWithCommandArgsRevision;\n\trepoPath: string | undefined;\n\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n}\n\n@command()\nexport class DiffWithCommand extends Command {\n\tstatic getMarkdownCommandArgs(args: DiffWithCommandArgs): string;\n\tstatic getMarkdownCommandArgs(commit: GitCommit, line?: number): string;\n\tstatic getMarkdownCommandArgs(argsOrCommit: DiffWithCommandArgs | GitCommit, line?: number): string {\n\t\tlet args: DiffWithCommandArgs | GitCommit;\n\t\tif (GitCommit.is(argsOrCommit)) {\n\t\t\tconst commit = argsOrCommit;\n\n\t\t\tif (commit.isUncommitted) {\n\t\t\t\targs = {\n\t\t\t\t\trepoPath: commit.repoPath,\n\t\t\t\t\tlhs: {\n\t\t\t\t\t\tsha: 'HEAD',\n\t\t\t\t\t\turi: commit.uri,\n\t\t\t\t\t},\n\t\t\t\t\trhs: {\n\t\t\t\t\t\tsha: '',\n\t\t\t\t\t\turi: commit.uri,\n\t\t\t\t\t},\n\t\t\t\t\tline: line,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\targs = {\n\t\t\t\t\trepoPath: commit.repoPath,\n\t\t\t\t\tlhs: {\n\t\t\t\t\t\tsha: commit.previousSha != null ? commit.previousSha : GitRevision.deletedOrMissing,\n\t\t\t\t\t\turi: commit.previousUri,\n\t\t\t\t\t},\n\t\t\t\t\trhs: {\n\t\t\t\t\t\tsha: commit.sha,\n\t\t\t\t\t\turi: commit.uri,\n\t\t\t\t\t},\n\t\t\t\t\tline: line,\n\t\t\t\t};\n\t\t\t}\n\t\t} else {\n\t\t\targs = argsOrCommit;\n\t\t}\n\n\t\treturn super.getMarkdownCommandArgsCore<DiffWithCommandArgs>(Commands.DiffWith, args);\n\t}\n\n\tconstructor() {\n\t\tsuper(Commands.DiffWith);\n\t}\n\n\tasync execute(args?: DiffWithCommandArgs): Promise<any> {\n\t\tif (args?.lhs == null || args?.rhs == null) return;\n\n\t\targs = {\n\t\t\t...args,\n\t\t\tlhs: { ...args.lhs },\n\t\t\trhs: { ...args.rhs },\n\t\t\tshowOptions: args.showOptions == null ? undefined : { ...args.showOptions },\n\t\t};\n\n\t\tif (args.repoPath == null) return;\n\n\t\ttry {\n\t\t\tlet lhsSha = args.lhs.sha;\n\t\t\tlet rhsSha = args.rhs.sha;\n\n\t\t\t[args.lhs.sha, args.rhs.sha] = await Promise.all([\n\t\t\t\tawait Container.git.resolveReference(args.repoPath, args.lhs.sha, args.lhs.uri, { timeout: 100 }),\n\t\t\t\tawait Container.git.resolveReference(args.repoPath, args.rhs.sha, args.rhs.uri, { timeout: 100 }),\n\t\t\t]);\n\n\t\t\tif (args.lhs.sha !== GitRevision.deletedOrMissing) {\n\t\t\t\tlhsSha = args.lhs.sha;\n\t\t\t}\n\n\t\t\tif (args.rhs.sha && args.rhs.sha !== GitRevision.deletedOrMissing) {\n\t\t\t\t// Ensure that the file still exists in this commit\n\t\t\t\tconst status = await Container.git.getFileStatusForCommit(\n\t\t\t\t\targs.repoPath,\n\t\t\t\t\targs.rhs.uri.fsPath,\n\t\t\t\t\targs.rhs.sha,\n\t\t\t\t);\n\t\t\t\tif (status?.status === 'D') {\n\t\t\t\t\targs.rhs.sha = GitRevision.deletedOrMissing;\n\t\t\t\t} else {\n\t\t\t\t\trhsSha = args.rhs.sha;\n\t\t\t\t}\n\n\t\t\t\tif (status?.status === 'A' && args.lhs.sha.endsWith('^')) {\n\t\t\t\t\targs.lhs.sha = GitRevision.deletedOrMissing;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst [lhs, rhs] = await Promise.all([\n\t\t\t\tContainer.git.getVersionedUri(args.repoPath, args.lhs.uri.fsPath, args.lhs.sha),\n\t\t\t\tContainer.git.getVersionedUri(args.repoPath, args.rhs.uri.fsPath, args.rhs.sha),\n\t\t\t]);\n\n\t\t\tlet rhsSuffix = GitRevision.shorten(rhsSha, { strings: { uncommitted: 'Working Tree' } });\n\t\t\tif (rhs == null) {\n\t\t\t\tif (GitRevision.isUncommitted(args.rhs.sha)) {\n\t\t\t\t\trhsSuffix = 'deleted';\n\t\t\t\t} else if (rhsSuffix.length === 0 && args.rhs.sha === GitRevision.deletedOrMissing) {\n\t\t\t\t\trhsSuffix = 'not in Working Tree';\n\t\t\t\t} else {\n\t\t\t\t\trhsSuffix = `deleted${rhsSuffix.length === 0 ? '' : ` in ${rhsSuffix}`}`;\n\t\t\t\t}\n\t\t\t} else if (lhs == null) {\n\t\t\t\trhsSuffix = `added${rhsSuffix.length === 0 ? '' : ` in ${rhsSuffix}`}`;\n\t\t\t}\n\n\t\t\tlet lhsSuffix = args.lhs.sha !== GitRevision.deletedOrMissing ? GitRevision.shorten(lhsSha) : '';\n\t\t\tif (lhs == null && args.rhs.sha.length === 0) {\n\t\t\t\tif (rhs != null) {\n\t\t\t\t\tlhsSuffix = lhsSuffix.length === 0 ? '' : `not in ${lhsSuffix}`;\n\t\t\t\t\trhsSuffix = '';\n\t\t\t\t} else {\n\t\t\t\t\tlhsSuffix = `deleted${lhsSuffix.length === 0 ? '' : ` in ${lhsSuffix}`}`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (args.lhs.title == null && (lhs != null || lhsSuffix.length !== 0)) {\n\t\t\t\targs.lhs.title = `${paths.basename(args.lhs.uri.fsPath)}${lhsSuffix ? ` (${lhsSuffix})` : ''}`;\n\t\t\t}\n\t\t\tif (args.rhs.title == null) {\n\t\t\t\targs.rhs.title = `${paths.basename(args.rhs.uri.fsPath)}${rhsSuffix ? ` (${rhsSuffix})` : ''}`;\n\t\t\t}\n\n\t\t\tconst title =\n\t\t\t\targs.lhs.title != null && args.rhs.title != null\n\t\t\t\t\t? `${args.lhs.title} ${GlyphChars.ArrowLeftRightLong} ${args.rhs.title}`\n\t\t\t\t\t: args.lhs.title ?? args.rhs.title;\n\n\t\t\tif (args.showOptions == null) {\n\t\t\t\targs.showOptions = {};\n\t\t\t}\n\n\t\t\tif (args.showOptions.viewColumn == null) {\n\t\t\t\targs.showOptions.viewColumn = ViewColumn.Active;\n\t\t\t}\n\n\t\t\tif (args.line != null && args.line !== 0) {\n\t\t\t\targs.showOptions.selection = new Range(args.line, 0, args.line, 0);\n\t\t\t}\n\n\t\t\tvoid (await commands.executeCommand(\n\t\t\t\tBuiltInCommands.Diff,\n\t\t\t\tlhs ?? GitUri.toRevisionUri(GitRevision.deletedOrMissing, args.lhs.uri.fsPath, args.repoPath),\n\t\t\t\trhs ?? GitUri.toRevisionUri(GitRevision.deletedOrMissing, args.rhs.uri.fsPath, args.repoPath),\n\t\t\t\ttitle,\n\t\t\t\targs.showOptions,\n\t\t\t));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'DiffWithCommand', 'getVersionedFile');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to open compare');\n\t\t}\n\t}\n}\n","'use strict';\nimport { Range, TextDocumentShowOptions, TextEditor, Uri } from 'vscode';\nimport { Container } from '../container';\nimport { GitLogCommit } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { ActiveEditorCommand, command, CommandContext, Commands, executeCommand, getCommandUri } from './common';\nimport { DiffWithCommandArgs } from './diffWith';\n\nexport interface DiffWithNextCommandArgs {\n\tcommit?: GitLogCommit;\n\trange?: Range;\n\n\tinDiffLeftEditor?: boolean;\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n}\n\n@command()\nexport class DiffWithNextCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([Commands.DiffWithNext, Commands.DiffWithNextInDiffLeft, Commands.DiffWithNextInDiffRight]);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: DiffWithNextCommandArgs) {\n\t\tif (context.command === Commands.DiffWithNextInDiffLeft) {\n\t\t\targs = { ...args, inDiffLeftEditor: true };\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: DiffWithNextCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return;\n\n\t\targs = { ...args };\n\t\tif (args.line == null) {\n\t\t\targs.line = editor?.selection.active.line ?? 0;\n\t\t}\n\n\t\tconst gitUri = args.commit != null ? GitUri.fromCommit(args.commit) : await GitUri.fromUri(uri);\n\t\ttry {\n\t\t\tconst diffUris = await Container.git.getNextDiffUris(\n\t\t\t\tgitUri.repoPath!,\n\t\t\t\tgitUri,\n\t\t\t\tgitUri.sha,\n\t\t\t\t// If we are in the left-side of the diff editor, we need to skip forward 1 more revision\n\t\t\t\targs.inDiffLeftEditor ? 1 : 0,\n\t\t\t);\n\n\t\t\tif (diffUris == null || diffUris.next == null) return;\n\n\t\t\tvoid (await executeCommand<DiffWithCommandArgs>(Commands.DiffWith, {\n\t\t\t\trepoPath: diffUris.current.repoPath,\n\t\t\t\tlhs: {\n\t\t\t\t\tsha: diffUris.current.sha ?? '',\n\t\t\t\t\turi: diffUris.current.documentUri(),\n\t\t\t\t},\n\t\t\t\trhs: {\n\t\t\t\t\tsha: diffUris.next.sha ?? '',\n\t\t\t\t\turi: diffUris.next.documentUri(),\n\t\t\t\t},\n\t\t\t\tline: args.line,\n\t\t\t\tshowOptions: args.showOptions,\n\t\t\t}));\n\t\t} catch (ex) {\n\t\t\tLogger.error(\n\t\t\t\tex,\n\t\t\t\t'DiffWithNextCommand',\n\t\t\t\t`getNextDiffUris(${gitUri.repoPath}, ${gitUri.fsPath}, ${gitUri.sha})`,\n\t\t\t);\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to open compare');\n\t\t}\n\t}\n}\n","'use strict';\nimport { TextDocumentShowOptions, TextEditor, Uri } from 'vscode';\nimport { Container } from '../container';\nimport { GitCommit, GitRevision } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\texecuteCommand,\n\tfindOrOpenEditor,\n\tgetCommandUri,\n} from './common';\nimport { DiffWithCommandArgs } from './diffWith';\n\nexport interface DiffWithPreviousCommandArgs {\n\tcommit?: GitCommit;\n\n\tinDiffRightEditor?: boolean;\n\turi?: Uri;\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n}\n\n@command()\nexport class DiffWithPreviousCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([Commands.DiffWithPrevious, Commands.DiffWithPreviousInDiffLeft, Commands.DiffWithPreviousInDiffRight]);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: DiffWithPreviousCommandArgs) {\n\t\tif (context.command === Commands.DiffWithPreviousInDiffRight) {\n\t\t\targs = { ...args, inDiffRightEditor: true };\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: DiffWithPreviousCommandArgs) {\n\t\targs = { ...args };\n\t\tif (args.uri == null) {\n\t\t\turi = getCommandUri(uri, editor);\n\t\t\tif (uri == null) return;\n\t\t} else {\n\t\t\turi = args.uri;\n\t\t}\n\n\t\tif (args.line == null) {\n\t\t\targs.line = editor?.selection.active.line ?? 0;\n\t\t}\n\n\t\tlet gitUri;\n\t\tif (args.commit != null) {\n\t\t\tif (!args.commit.isUncommitted) {\n\t\t\t\tvoid (await executeCommand<DiffWithCommandArgs>(Commands.DiffWith, {\n\t\t\t\t\trepoPath: args.commit.repoPath,\n\t\t\t\t\tlhs: {\n\t\t\t\t\t\tsha: `${args.commit.sha}^`,\n\t\t\t\t\t\turi: args.commit.originalUri,\n\t\t\t\t\t},\n\t\t\t\t\trhs: {\n\t\t\t\t\t\tsha: args.commit.sha || '',\n\t\t\t\t\t\turi: args.commit.uri,\n\t\t\t\t\t},\n\t\t\t\t\tline: args.line,\n\t\t\t\t\tshowOptions: args.showOptions,\n\t\t\t\t}));\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tgitUri = GitUri.fromCommit(args.commit);\n\t\t} else {\n\t\t\tgitUri = await GitUri.fromUri(uri);\n\t\t}\n\n\t\t// If we are in the right diff editor, we can't really trust the line number\n\t\t// if (args.inDiffRightEditor && args.line !== 0) {\n\t\t// \t// TODO@eamodio figure out how to tell where the line moved in the previous commit (if at all)\n\t\t// }\n\n\t\ttry {\n\t\t\tconst diffUris = await Container.git.getPreviousDiffUris(\n\t\t\t\tgitUri.repoPath!,\n\t\t\t\tgitUri,\n\t\t\t\tgitUri.sha,\n\t\t\t\t// If we are in the right-side of the diff editor, we need to skip back 1 more revision\n\t\t\t\targs.inDiffRightEditor ? 1 : 0,\n\t\t\t);\n\n\t\t\tif (diffUris == null || diffUris.previous == null) {\n\t\t\t\tif (diffUris == null) {\n\t\t\t\t\tvoid Messages.showCommitHasNoPreviousCommitWarningMessage();\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// If we have no previous and the current is the working file, just open the working file\n\t\t\t\tif (diffUris.current.sha == null) {\n\t\t\t\t\tvoid (await findOrOpenEditor(diffUris.current, args.showOptions));\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!diffUris.current.isUncommittedStaged) {\n\t\t\t\t\tvoid Messages.showCommitHasNoPreviousCommitWarningMessage();\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// If we have no previous and the current is staged, then diff staged with missing\n\t\t\t\tdiffUris.previous = GitUri.fromFile(\n\t\t\t\t\tdiffUris.current.fileName,\n\t\t\t\t\tdiffUris.current.repoPath!,\n\t\t\t\t\tGitRevision.deletedOrMissing,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tvoid (await executeCommand<DiffWithCommandArgs>(Commands.DiffWith, {\n\t\t\t\trepoPath: diffUris.current.repoPath,\n\t\t\t\tlhs: {\n\t\t\t\t\tsha: diffUris.previous.sha ?? '',\n\t\t\t\t\turi: diffUris.previous.documentUri(),\n\t\t\t\t},\n\t\t\t\trhs: {\n\t\t\t\t\tsha: diffUris.current.sha ?? '',\n\t\t\t\t\turi: diffUris.current.documentUri(),\n\t\t\t\t},\n\t\t\t\tline: args.line,\n\t\t\t\tshowOptions: args.showOptions,\n\t\t\t}));\n\t\t} catch (ex) {\n\t\t\tLogger.error(\n\t\t\t\tex,\n\t\t\t\t'DiffWithPreviousCommand',\n\t\t\t\t`getPreviousDiffUris(${gitUri.repoPath}, ${gitUri.fsPath}, ${gitUri.sha})`,\n\t\t\t);\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to open compare');\n\t\t}\n\t}\n}\n","'use strict';\nimport { TextDocumentShowOptions, TextEditor, Uri } from 'vscode';\nimport { GlyphChars, quickPickTitleMaxChars } from '../constants';\nimport { Container } from '../container';\nimport { GitRevision } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { CommandQuickPickItem, CommitPicker } from '../quickpicks';\nimport { Strings } from '../system';\nimport { ActiveEditorCommand, command, Commands, executeCommand, getCommandUri } from './common';\nimport { DiffWithCommandArgs } from './diffWith';\n\nexport interface DiffWithRevisionCommandArgs {\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n}\n\n@command()\nexport class DiffWithRevisionCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.DiffWithRevision);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: DiffWithRevisionCommandArgs): Promise<any> {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return;\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\n\t\targs = { ...args };\n\t\tif (args.line == null) {\n\t\t\targs.line = editor?.selection.active.line ?? 0;\n\t\t}\n\n\t\ttry {\n\t\t\tconst log = Container.git\n\t\t\t\t.getLogForFile(gitUri.repoPath, gitUri.fsPath)\n\t\t\t\t.then(\n\t\t\t\t\tlog =>\n\t\t\t\t\t\tlog ??\n\t\t\t\t\t\t(gitUri.sha\n\t\t\t\t\t\t\t? Container.git.getLogForFile(gitUri.repoPath, gitUri.fsPath, { ref: gitUri.sha })\n\t\t\t\t\t\t\t: undefined),\n\t\t\t\t);\n\n\t\t\tconst title = `Open Changes with Revision${Strings.pad(GlyphChars.Dot, 2, 2)}`;\n\t\t\tconst pick = await CommitPicker.show(\n\t\t\t\tlog,\n\t\t\t\t`${title}${gitUri.getFormattedFilename({\n\t\t\t\t\tsuffix: gitUri.sha ? `:${GitRevision.shorten(gitUri.sha)}` : undefined,\n\t\t\t\t\ttruncateTo: quickPickTitleMaxChars - title.length,\n\t\t\t\t})}`,\n\t\t\t\t'Choose a commit to compare with',\n\t\t\t\t{\n\t\t\t\t\tpicked: gitUri.sha,\n\t\t\t\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\t\t\t\tonDidPressKey: async (key, item) => {\n\t\t\t\t\t\tvoid (await executeCommand<DiffWithCommandArgs>(Commands.DiffWith, {\n\t\t\t\t\t\t\trepoPath: gitUri.repoPath,\n\t\t\t\t\t\t\tlhs: {\n\t\t\t\t\t\t\t\tsha: item.item.ref,\n\t\t\t\t\t\t\t\turi: gitUri,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\trhs: {\n\t\t\t\t\t\t\t\tsha: '',\n\t\t\t\t\t\t\t\turi: gitUri,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tline: args!.line,\n\t\t\t\t\t\t\tshowOptions: args!.showOptions,\n\t\t\t\t\t\t}));\n\t\t\t\t\t},\n\t\t\t\t\tshowOtherReferences: CommandQuickPickItem.fromCommand(\n\t\t\t\t\t\t'Choose a branch or tag...',\n\t\t\t\t\t\tCommands.DiffWithRevisionFrom,\n\t\t\t\t\t),\n\t\t\t\t},\n\t\t\t);\n\t\t\tif (pick == null) return;\n\n\t\t\tvoid (await executeCommand<DiffWithCommandArgs>(Commands.DiffWith, {\n\t\t\t\trepoPath: gitUri.repoPath,\n\t\t\t\tlhs: {\n\t\t\t\t\tsha: pick.ref,\n\t\t\t\t\turi: gitUri,\n\t\t\t\t},\n\t\t\t\trhs: {\n\t\t\t\t\tsha: '',\n\t\t\t\t\turi: gitUri,\n\t\t\t\t},\n\t\t\t\tline: args.line,\n\t\t\t\tshowOptions: args.showOptions,\n\t\t\t}));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'DiffWithRevisionCommand');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to open compare');\n\t\t}\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { TextDocumentShowOptions, TextEditor, Uri } from 'vscode';\nimport { GlyphChars, quickPickTitleMaxChars } from '../constants';\nimport { Container } from '../container';\nimport { GitReference, GitRevision } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Messages } from '../messages';\nimport { ReferencePicker } from '../quickpicks';\nimport { Strings } from '../system';\nimport { ActiveEditorCommand, command, Commands, executeCommand, getCommandUri } from './common';\nimport { DiffWithCommandArgs } from './diffWith';\n\nexport interface DiffWithRevisionFromCommandArgs {\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n}\n\n@command()\nexport class DiffWithRevisionFromCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.DiffWithRevisionFrom);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: DiffWithRevisionFromCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return;\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\t\tif (!gitUri.repoPath) {\n\t\t\tvoid Messages.showNoRepositoryWarningMessage('Unable to open file compare');\n\n\t\t\treturn;\n\t\t}\n\n\t\targs = { ...args };\n\t\tif (args.line == null) {\n\t\t\targs.line = editor?.selection.active.line ?? 0;\n\t\t}\n\n\t\tconst title = `Open Changes with Branch or Tag${Strings.pad(GlyphChars.Dot, 2, 2)}`;\n\t\tconst pick = await ReferencePicker.show(\n\t\t\tgitUri.repoPath,\n\t\t\t`${title}${gitUri.getFormattedFilename({ truncateTo: quickPickTitleMaxChars - title.length })}`,\n\t\t\t'Choose a branch or tag to compare with',\n\t\t\t{\n\t\t\t\tallowEnteringRefs: true,\n\t\t\t\t// checkmarks: false,\n\t\t\t},\n\t\t);\n\t\tif (pick == null) return;\n\n\t\tconst ref = pick.ref;\n\t\tif (ref == null) return;\n\n\t\tlet renamedUri: Uri | undefined;\n\t\tlet renamedTitle: string | undefined;\n\n\t\t// Check to see if this file has been renamed\n\t\tconst files = await Container.git.getDiffStatus(gitUri.repoPath, 'HEAD', ref, { filters: ['R', 'C'] });\n\t\tif (files != null) {\n\t\t\tconst fileName = Strings.normalizePath(paths.relative(gitUri.repoPath, gitUri.fsPath));\n\t\t\tconst rename = files.find(s => s.fileName === fileName);\n\t\t\tif (rename?.originalFileName != null) {\n\t\t\t\trenamedUri = GitUri.resolveToUri(rename.originalFileName, gitUri.repoPath);\n\t\t\t\trenamedTitle = `${paths.basename(rename.originalFileName)} (${GitRevision.shorten(ref)})`;\n\t\t\t}\n\t\t}\n\n\t\tvoid (await executeCommand<DiffWithCommandArgs>(Commands.DiffWith, {\n\t\t\trepoPath: gitUri.repoPath,\n\t\t\tlhs: {\n\t\t\t\tsha: GitReference.isBranch(pick) && pick.remote ? `remotes/${ref}` : ref,\n\t\t\t\turi: renamedUri ?? gitUri,\n\t\t\t\ttitle: renamedTitle ?? `${paths.basename(gitUri.fsPath)} (${GitRevision.shorten(ref)})`,\n\t\t\t},\n\t\t\trhs: {\n\t\t\t\tsha: '',\n\t\t\t\turi: gitUri,\n\t\t\t},\n\t\t\tline: args.line,\n\t\t\tshowOptions: args.showOptions,\n\t\t}));\n\t}\n}\n","'use strict';\nimport { TextDocumentShowOptions, TextEditor, Uri, window } from 'vscode';\nimport { Container } from '../container';\nimport { GitRevision } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { ActiveEditorCommand, command, Commands, executeCommand, getCommandUri } from './common';\nimport { DiffWithCommandArgs } from './diffWith';\n\nexport interface DiffWithWorkingCommandArgs {\n\tinDiffRightEditor?: boolean;\n\turi?: Uri;\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n}\n\n@command()\nexport class DiffWithWorkingCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([Commands.DiffWithWorking, Commands.DiffWithWorkingInDiffLeft, Commands.DiffWithWorkingInDiffRight]);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: DiffWithWorkingCommandArgs): Promise<any> {\n\t\targs = { ...args };\n\t\tif (args.uri == null) {\n\t\t\turi = getCommandUri(uri, editor);\n\t\t\tif (uri == null) return;\n\t\t} else {\n\t\t\turi = args.uri;\n\t\t}\n\n\t\tlet gitUri = await GitUri.fromUri(uri);\n\n\t\tif (args.line == null) {\n\t\t\targs.line = editor?.selection.active.line ?? 0;\n\t\t}\n\n\t\tif (args.inDiffRightEditor) {\n\t\t\ttry {\n\t\t\t\tconst diffUris = await Container.git.getPreviousDiffUris(gitUri.repoPath!, gitUri, gitUri.sha, 0);\n\t\t\t\tgitUri = diffUris?.previous ?? gitUri;\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(\n\t\t\t\t\tex,\n\t\t\t\t\t'DiffWithWorkingCommand',\n\t\t\t\t\t`getPreviousDiffUris(${gitUri.repoPath}, ${gitUri.fsPath}, ${gitUri.sha})`,\n\t\t\t\t);\n\t\t\t\tvoid Messages.showGenericErrorMessage('Unable to open compare');\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// If the sha is missing, just let the user know the file matches\n\t\tif (gitUri.sha == null) {\n\t\t\tvoid window.showInformationMessage('File matches the working tree');\n\n\t\t\treturn;\n\t\t}\n\t\tif (gitUri.sha === GitRevision.deletedOrMissing) {\n\t\t\tvoid window.showWarningMessage('Unable to open compare. File has been deleted from the working tree');\n\n\t\t\treturn;\n\t\t}\n\n\t\t// If we are a fake \"staged\" sha, check the status\n\t\tif (gitUri.isUncommittedStaged) {\n\t\t\tconst status = await Container.git.getStatusForFile(gitUri.repoPath!, gitUri.fsPath);\n\t\t\tif (status?.indexStatus != null) {\n\t\t\t\tvoid (await executeCommand<DiffWithCommandArgs>(Commands.DiffWith, {\n\t\t\t\t\trepoPath: gitUri.repoPath,\n\t\t\t\t\tlhs: {\n\t\t\t\t\t\tsha: GitRevision.uncommittedStaged,\n\t\t\t\t\t\turi: gitUri.documentUri(),\n\t\t\t\t\t},\n\t\t\t\t\trhs: {\n\t\t\t\t\t\tsha: '',\n\t\t\t\t\t\turi: gitUri.documentUri(),\n\t\t\t\t\t},\n\t\t\t\t\tline: args.line,\n\t\t\t\t\tshowOptions: args.showOptions,\n\t\t\t\t}));\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\turi = gitUri.toFileUri();\n\n\t\tconst workingUri = await Container.git.getWorkingUri(gitUri.repoPath!, uri);\n\t\tif (workingUri == null) {\n\t\t\tvoid window.showWarningMessage('Unable to open compare. File has been deleted from the working tree');\n\n\t\t\treturn;\n\t\t}\n\n\t\tvoid (await executeCommand<DiffWithCommandArgs>(Commands.DiffWith, {\n\t\t\trepoPath: gitUri.repoPath,\n\t\t\tlhs: {\n\t\t\t\tsha: gitUri.sha,\n\t\t\t\turi: uri,\n\t\t\t},\n\t\t\trhs: {\n\t\t\t\tsha: '',\n\t\t\t\turi: workingUri,\n\t\t\t},\n\t\t\tline: args.line,\n\t\t\tshowOptions: args.showOptions,\n\t\t}));\n\t}\n}\n","'use strict';\nimport { env, SourceControlResourceState, Uri, window } from 'vscode';\nimport { Container } from '../container';\nimport { GitRevision } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { Arrays } from '../system';\nimport {\n\tcommand,\n\tCommand,\n\tCommandContext,\n\tCommands,\n\tgetRepoPathOrPrompt,\n\tisCommandContextViewNodeHasFileCommit,\n\tisCommandContextViewNodeHasFileRefs,\n} from './common';\n\nenum Status {\n\tINDEX_MODIFIED,\n\tINDEX_ADDED,\n\tINDEX_DELETED,\n\tINDEX_RENAMED,\n\tINDEX_COPIED,\n\n\tMODIFIED,\n\tDELETED,\n\tUNTRACKED,\n\tIGNORED,\n\n\tADDED_BY_US,\n\tADDED_BY_THEM,\n\tDELETED_BY_US,\n\tDELETED_BY_THEM,\n\tBOTH_ADDED,\n\tBOTH_DELETED,\n\tBOTH_MODIFIED,\n}\n\nenum ResourceGroupType {\n\tMerge,\n\tIndex,\n\tWorkingTree,\n}\n\ninterface Resource extends SourceControlResourceState {\n\treadonly resourceGroupType: ResourceGroupType;\n\treadonly type: Status;\n}\n\ninterface ExternalDiffFile {\n\turi: Uri;\n\tstaged: boolean;\n\tref1?: string;\n\tref2?: string;\n}\n\nexport interface ExternalDiffCommandArgs {\n\tfiles?: ExternalDiffFile[];\n}\n\n@command()\nexport class ExternalDiffCommand extends Command {\n\tconstructor() {\n\t\tsuper([Commands.ExternalDiff, Commands.ExternalDiffAll]);\n\t}\n\n\tprotected override async preExecute(context: CommandContext, args?: ExternalDiffCommandArgs) {\n\t\targs = { ...args };\n\n\t\tif (isCommandContextViewNodeHasFileCommit(context)) {\n\t\t\tconst ref1 = GitRevision.isUncommitted(context.node.commit.previousFileSha)\n\t\t\t\t? ''\n\t\t\t\t: context.node.commit.previousFileSha;\n\t\t\tconst ref2 = context.node.commit.isUncommitted ? '' : context.node.commit.sha;\n\n\t\t\targs.files = [\n\t\t\t\t{\n\t\t\t\t\turi: GitUri.fromFile(context.node.file, context.node.file.repoPath ?? context.node.repoPath),\n\t\t\t\t\tstaged: context.node.commit.isUncommittedStaged || context.node.file.indexStatus != null,\n\t\t\t\t\tref1: ref1,\n\t\t\t\t\tref2: ref2,\n\t\t\t\t},\n\t\t\t];\n\n\t\t\treturn this.execute(args);\n\t\t}\n\n\t\tif (isCommandContextViewNodeHasFileRefs(context)) {\n\t\t\targs.files = [\n\t\t\t\t{\n\t\t\t\t\turi: GitUri.fromFile(context.node.file, context.node.file.repoPath ?? context.node.repoPath),\n\t\t\t\t\tstaged: context.node.file.indexStatus != null,\n\t\t\t\t\tref1: context.node.ref1,\n\t\t\t\t\tref2: context.node.ref2,\n\t\t\t\t},\n\t\t\t];\n\n\t\t\treturn this.execute(args);\n\t\t}\n\n\t\tif (args.files == null) {\n\t\t\tif (context.type === 'scm-states') {\n\t\t\t\targs.files = context.scmResourceStates.map(r => ({\n\t\t\t\t\turi: r.resourceUri,\n\t\t\t\t\tstaged: (r as Resource).resourceGroupType === ResourceGroupType.Index,\n\t\t\t\t}));\n\t\t\t} else if (context.type === 'scm-groups') {\n\t\t\t\targs.files = Arrays.filterMap(context.scmResourceGroups[0].resourceStates, r =>\n\t\t\t\t\tthis.isModified(r)\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\turi: r.resourceUri,\n\t\t\t\t\t\t\t\tstaged: (r as Resource).resourceGroupType === ResourceGroupType.Index,\n\t\t\t\t\t\t  }\n\t\t\t\t\t\t: undefined,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (context.command === Commands.ExternalDiffAll) {\n\t\t\tif (args.files == null) {\n\t\t\t\tconst repoPath = await getRepoPathOrPrompt('Open All Changes (difftool)');\n\t\t\t\tif (!repoPath) return undefined;\n\n\t\t\t\tconst status = await Container.git.getStatusForRepo(repoPath);\n\t\t\t\tif (status == null) {\n\t\t\t\t\treturn window.showInformationMessage(\"The repository doesn't have any changes\");\n\t\t\t\t}\n\n\t\t\t\targs.files = [];\n\n\t\t\t\tfor (const file of status.files) {\n\t\t\t\t\tif (file.indexStatus === 'M') {\n\t\t\t\t\t\targs.files.push({ uri: file.uri, staged: true });\n\t\t\t\t\t}\n\n\t\t\t\t\tif (file.workingTreeStatus === 'M') {\n\t\t\t\t\t\targs.files.push({ uri: file.uri, staged: false });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.execute(args);\n\t}\n\n\tprivate isModified(resource: SourceControlResourceState) {\n\t\tconst status = (resource as Resource).type;\n\t\treturn status === Status.BOTH_MODIFIED || status === Status.INDEX_MODIFIED || status === Status.MODIFIED;\n\t}\n\n\tasync execute(args?: ExternalDiffCommandArgs) {\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\tlet repoPath;\n\t\t\tif (args.files == null) {\n\t\t\t\tconst editor = window.activeTextEditor;\n\t\t\t\tif (editor == null) return;\n\n\t\t\t\trepoPath = await Container.git.getRepoPathOrActive(undefined, editor);\n\t\t\t\tif (!repoPath) return;\n\n\t\t\t\tconst uri = editor.document.uri;\n\t\t\t\tconst status = await Container.git.getStatusForFile(repoPath, uri.fsPath);\n\t\t\t\tif (status == null) {\n\t\t\t\t\tvoid window.showInformationMessage(\"The current file doesn't have any changes\");\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\targs.files = [];\n\t\t\t\tif (status.indexStatus === 'M') {\n\t\t\t\t\targs.files.push({ uri: status.uri, staged: true });\n\t\t\t\t}\n\n\t\t\t\tif (status.workingTreeStatus === 'M') {\n\t\t\t\t\targs.files.push({ uri: status.uri, staged: false });\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trepoPath = await Container.git.getRepoPath(args.files[0].uri.fsPath);\n\t\t\t\tif (!repoPath) return;\n\t\t\t}\n\n\t\t\tconst tool = Container.config.advanced.externalDiffTool || (await Container.git.getDiffTool(repoPath));\n\t\t\tif (!tool) {\n\t\t\t\tconst viewDocs = 'View Git Docs';\n\t\t\t\tconst result = await window.showWarningMessage(\n\t\t\t\t\t'Unable to open changes because no Git diff tool is configured',\n\t\t\t\t\tviewDocs,\n\t\t\t\t);\n\t\t\t\tif (result === viewDocs) {\n\t\t\t\t\tvoid env.openExternal(\n\t\t\t\t\t\tUri.parse('https://git-scm.com/docs/git-config#Documentation/git-config.txt-difftool'),\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfor (const file of args.files) {\n\t\t\t\tvoid Container.git.openDiffTool(repoPath, file.uri, {\n\t\t\t\t\tref1: file.ref1,\n\t\t\t\t\tref2: file.ref2,\n\t\t\t\t\tstaged: file.staged,\n\t\t\t\t\ttool: tool,\n\t\t\t\t});\n\t\t\t}\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ExternalDiffCommand');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to open changes in diff tool');\n\t\t}\n\t}\n}\n","'use strict';\nimport { Container } from '../container';\nimport { command, Command, CommandContext, Commands, isCommandContextViewNodeHasContributor } from './common';\n\nexport interface InviteToLiveShareCommandArgs {\n\temail?: string;\n}\n\n@command()\nexport class InviteToLiveShareCommand extends Command {\n\tstatic getMarkdownCommandArgs(args: InviteToLiveShareCommandArgs): string;\n\tstatic getMarkdownCommandArgs(email: string | undefined): string;\n\tstatic getMarkdownCommandArgs(argsOrEmail: InviteToLiveShareCommandArgs | string | undefined): string {\n\t\tconst args =\n\t\t\targsOrEmail === undefined || typeof argsOrEmail === 'string' ? { email: argsOrEmail } : argsOrEmail;\n\t\treturn super.getMarkdownCommandArgsCore<InviteToLiveShareCommandArgs>(Commands.InviteToLiveShare, args);\n\t}\n\n\tconstructor() {\n\t\tsuper(Commands.InviteToLiveShare);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: InviteToLiveShareCommandArgs) {\n\t\tif (isCommandContextViewNodeHasContributor(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.email = context.node.contributor.email;\n\t\t\treturn this.execute(args);\n\t\t}\n\n\t\treturn this.execute(args);\n\t}\n\n\tasync execute(args?: InviteToLiveShareCommandArgs) {\n\t\tif (args?.email) {\n\t\t\tconst contact = await Container.vsls.getContact(args.email);\n\t\t\tif (contact != null) {\n\t\t\t\treturn contact.invite();\n\t\t\t}\n\t\t}\n\n\t\treturn Container.vsls.startSession();\n\t}\n}\n","'use strict';\nimport { configuration, TraceLevel } from '../configuration';\nimport { command, Command, Commands } from './common';\n\n@command()\nexport class EnableDebugLoggingCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.EnableDebugLogging);\n\t}\n\n\tasync execute() {\n\t\tawait configuration.updateEffective('outputLevel', TraceLevel.Debug);\n\t}\n}\n\n@command()\nexport class DisableDebugLoggingCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.DisableDebugLogging);\n\t}\n\n\tasync execute() {\n\t\tawait configuration.updateEffective('outputLevel', TraceLevel.Errors);\n\t}\n}\n","'use strict';\nimport { TextEditor, Uri } from 'vscode';\nimport { Container } from '../container';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { ActiveEditorCommand, command, Commands, executeCommand, getCommandUri } from './common';\nimport { OpenPullRequestOnRemoteCommandArgs } from './openPullRequestOnRemote';\n\n@command()\nexport class OpenAssociatedPullRequestOnRemoteCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.OpenAssociatedPullRequestOnRemote);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri) {\n\t\tif (editor == null) return;\n\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return;\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\n\t\tconst blameline = editor.selection.active.line;\n\t\tif (blameline < 0) return;\n\n\t\ttry {\n\t\t\tconst blame = await Container.git.getBlameForLine(gitUri, blameline);\n\t\t\tif (blame == null) return;\n\n\t\t\tawait executeCommand<OpenPullRequestOnRemoteCommandArgs>(Commands.OpenPullRequestOnRemote, {\n\t\t\t\tclipboard: false,\n\t\t\t\tref: blame.commit.sha,\n\t\t\t\trepoPath: blame.commit.repoPath,\n\t\t\t});\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenAssociatedPullRequestOnRemoteCommand', `getBlameForLine(${blameline})`);\n\t\t}\n\t}\n}\n","'use strict';\nimport { TextEditor, Uri, window } from 'vscode';\nimport { RemoteResourceType } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\texecuteCommand,\n\tgetCommandUri,\n\tgetRepoPathOrActiveOrPrompt,\n\tisCommandContextViewNodeHasRemote,\n} from './common';\nimport { OpenOnRemoteCommandArgs } from './openOnRemote';\n\nexport interface OpenBranchesOnRemoteCommandArgs {\n\tclipboard?: boolean;\n\tremote?: string;\n}\n\n@command()\nexport class OpenBranchesOnRemoteCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([\n\t\t\tCommands.OpenBranchesOnRemote,\n\t\t\tCommands.Deprecated_OpenBranchesInRemote,\n\t\t\tCommands.CopyRemoteBranchesUrl,\n\t\t]);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: OpenBranchesOnRemoteCommandArgs) {\n\t\tif (isCommandContextViewNodeHasRemote(context)) {\n\t\t\targs = { ...args, remote: context.node.remote.name };\n\t\t}\n\n\t\tif (context.command === Commands.CopyRemoteBranchesUrl) {\n\t\t\targs = { ...args, clipboard: true };\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: OpenBranchesOnRemoteCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\n\t\tconst gitUri = uri != null ? await GitUri.fromUri(uri) : undefined;\n\n\t\tconst repoPath = await getRepoPathOrActiveOrPrompt(\n\t\t\tgitUri,\n\t\t\teditor,\n\t\t\targs?.clipboard ? 'Copy Remote Branches Url' : 'Open Branches on Remote',\n\t\t);\n\t\tif (!repoPath) return;\n\n\t\ttry {\n\t\t\tvoid (await executeCommand<OpenOnRemoteCommandArgs>(Commands.OpenOnRemote, {\n\t\t\t\tresource: {\n\t\t\t\t\ttype: RemoteResourceType.Branches,\n\t\t\t\t},\n\t\t\t\trepoPath: repoPath,\n\t\t\t\tremote: args?.remote,\n\t\t\t\tclipboard: args?.clipboard,\n\t\t\t}));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenBranchesOnRemoteCommand');\n\t\t\tvoid window.showErrorMessage(\n\t\t\t\t'Unable to open branches on remote provider. See output channel for more details',\n\t\t\t);\n\t\t}\n\t}\n}\n","'use strict';\nimport { TextEditor, Uri, window } from 'vscode';\nimport { RemoteResourceType } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { CommandQuickPickItem, ReferencePicker, ReferencesQuickPickIncludes } from '../quickpicks';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\texecuteCommand,\n\tgetCommandUri,\n\tgetRepoPathOrActiveOrPrompt,\n\tisCommandContextViewNodeHasBranch,\n} from './common';\nimport { OpenOnRemoteCommandArgs } from './openOnRemote';\n\nexport interface OpenBranchOnRemoteCommandArgs {\n\tbranch?: string;\n\tclipboard?: boolean;\n\tremote?: string;\n}\n\n@command()\nexport class OpenBranchOnRemoteCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([Commands.OpenBranchOnRemote, Commands.Deprecated_OpenBranchInRemote, Commands.CopyRemoteBranchUrl]);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: OpenBranchOnRemoteCommandArgs) {\n\t\tif (isCommandContextViewNodeHasBranch(context)) {\n\t\t\targs = {\n\t\t\t\t...args,\n\t\t\t\tbranch: context.node.branch.name,\n\t\t\t\tremote: context.node.branch.getRemoteName(),\n\t\t\t};\n\t\t}\n\n\t\tif (context.command === Commands.CopyRemoteBranchUrl) {\n\t\t\targs = { ...args, clipboard: true };\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: OpenBranchOnRemoteCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\n\t\tconst gitUri = uri != null ? await GitUri.fromUri(uri) : undefined;\n\n\t\tconst repoPath = await getRepoPathOrActiveOrPrompt(\n\t\t\tgitUri,\n\t\t\teditor,\n\t\t\targs?.clipboard ? 'Copy Remote Branch Url' : 'Open Branch On Remote',\n\t\t);\n\t\tif (!repoPath) return;\n\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\tif (args.branch == null) {\n\t\t\t\tconst pick = await ReferencePicker.show(\n\t\t\t\t\trepoPath,\n\t\t\t\t\targs.clipboard ? 'Copy Remote Branch Url' : 'Open Branch On Remote',\n\t\t\t\t\targs.clipboard ? 'Choose a branch to copy the url from' : 'Choose a branch to open',\n\t\t\t\t\t{\n\t\t\t\t\t\tautoPick: true,\n\t\t\t\t\t\t// checkmarks: false,\n\t\t\t\t\t\tfilter: { branches: b => b.upstream != null },\n\t\t\t\t\t\tinclude: ReferencesQuickPickIncludes.Branches,\n\t\t\t\t\t\tsort: { branches: { current: true }, tags: {} },\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t\tif (pick == null || pick instanceof CommandQuickPickItem) return;\n\n\t\t\t\targs.branch = pick.ref;\n\t\t\t}\n\n\t\t\tvoid (await executeCommand<OpenOnRemoteCommandArgs>(Commands.OpenOnRemote, {\n\t\t\t\tresource: {\n\t\t\t\t\ttype: RemoteResourceType.Branch,\n\t\t\t\t\tbranch: args.branch || 'HEAD',\n\t\t\t\t},\n\t\t\t\trepoPath: repoPath,\n\t\t\t\tremote: args.remote,\n\t\t\t\tclipboard: args.clipboard,\n\t\t\t}));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenBranchOnRemoteCommand');\n\t\t\tvoid window.showErrorMessage(\n\t\t\t\t'Unable to open branch on remote provider. See output channel for more details',\n\t\t\t);\n\t\t}\n\t}\n}\n","'use strict';\nimport { Uri, window } from 'vscode';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { Arrays } from '../system';\nimport { Command, command, Commands, findOrOpenEditors, getRepoPathOrPrompt } from './common';\n\nexport interface OpenChangedFilesCommandArgs {\n\turis?: Uri[];\n}\n\n@command()\nexport class OpenChangedFilesCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.OpenChangedFiles);\n\t}\n\n\tasync execute(args?: OpenChangedFilesCommandArgs) {\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\tif (args.uris == null) {\n\t\t\t\tconst repoPath = await getRepoPathOrPrompt('Open All Changed Files');\n\t\t\t\tif (!repoPath) return;\n\n\t\t\t\tconst status = await Container.git.getStatusForRepo(repoPath);\n\t\t\t\tif (status == null) {\n\t\t\t\t\tvoid window.showWarningMessage('Unable to open changed files');\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\targs.uris = Arrays.filterMap(status.files, f => (f.status !== 'D' ? f.uri : undefined));\n\t\t\t}\n\n\t\t\tfindOrOpenEditors(args.uris);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenChangedFilesCommand');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to open all changed files');\n\t\t}\n\t}\n}\n","'use strict';\nimport { TextEditor, Uri, window } from 'vscode';\nimport { Container } from '../container';\nimport { RemoteResourceType } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\texecuteCommand,\n\tgetCommandUri,\n\tisCommandContextGitTimelineItem,\n\tisCommandContextViewNodeHasCommit,\n} from './common';\nimport { OpenOnRemoteCommandArgs } from './openOnRemote';\n\nexport interface OpenCommitOnRemoteCommandArgs {\n\tclipboard?: boolean;\n\tsha?: string;\n}\n\n@command()\nexport class OpenCommitOnRemoteCommand extends ActiveEditorCommand {\n\tstatic getMarkdownCommandArgs(sha: string): string;\n\tstatic getMarkdownCommandArgs(args: OpenCommitOnRemoteCommandArgs): string;\n\tstatic getMarkdownCommandArgs(argsOrSha: OpenCommitOnRemoteCommandArgs | string): string {\n\t\tconst args: OpenCommitOnRemoteCommandArgs = typeof argsOrSha === 'string' ? { sha: argsOrSha } : argsOrSha;\n\t\treturn super.getMarkdownCommandArgsCore<OpenCommitOnRemoteCommandArgs>(Commands.OpenCommitOnRemote, args);\n\t}\n\n\tconstructor() {\n\t\tsuper([Commands.OpenCommitOnRemote, Commands.Deprecated_OpenCommitInRemote, Commands.CopyRemoteCommitUrl]);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: OpenCommitOnRemoteCommandArgs) {\n\t\tlet uri = context.uri;\n\n\t\tif (isCommandContextViewNodeHasCommit(context)) {\n\t\t\tif (context.node.commit.isUncommitted) return Promise.resolve(undefined);\n\n\t\t\targs = { ...args, sha: context.node.commit.sha };\n\t\t\turi = context.node.uri;\n\t\t}\n\n\t\tif (isCommandContextGitTimelineItem(context)) {\n\t\t\targs = { sha: context.item.ref };\n\t\t\turi = context.uri;\n\t\t}\n\n\t\tif (context.command === Commands.CopyRemoteCommitUrl) {\n\t\t\targs = { ...args, clipboard: true };\n\t\t}\n\n\t\treturn this.execute(context.editor, uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: OpenCommitOnRemoteCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return;\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\t\tif (!gitUri.repoPath) return;\n\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\tif (args.sha == null) {\n\t\t\t\tconst blameline = editor == null ? 0 : editor.selection.active.line;\n\t\t\t\tif (blameline < 0) return;\n\n\t\t\t\tconst blame = editor?.document.isDirty\n\t\t\t\t\t? await Container.git.getBlameForLineContents(gitUri, blameline, editor.document.getText())\n\t\t\t\t\t: await Container.git.getBlameForLine(gitUri, blameline);\n\t\t\t\tif (blame == null) {\n\t\t\t\t\tvoid Messages.showFileNotUnderSourceControlWarningMessage(\n\t\t\t\t\t\t'Unable to open commit on remote provider',\n\t\t\t\t\t);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet commit = blame.commit;\n\t\t\t\t// If the line is uncommitted, find the previous commit\n\t\t\t\tif (commit.isUncommitted) {\n\t\t\t\t\tcommit = commit.with({\n\t\t\t\t\t\tsha: commit.previousSha,\n\t\t\t\t\t\tfileName: commit.previousFileName,\n\t\t\t\t\t\tpreviousSha: null,\n\t\t\t\t\t\tpreviousFileName: null,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\targs.sha = commit.sha;\n\t\t\t}\n\n\t\t\tvoid (await executeCommand<OpenOnRemoteCommandArgs>(Commands.OpenOnRemote, {\n\t\t\t\tresource: {\n\t\t\t\t\ttype: RemoteResourceType.Commit,\n\t\t\t\t\tsha: args.sha,\n\t\t\t\t},\n\t\t\t\trepoPath: gitUri.repoPath,\n\t\t\t\tclipboard: args.clipboard,\n\t\t\t}));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenCommitOnRemoteCommand');\n\t\t\tvoid window.showErrorMessage(\n\t\t\t\t'Unable to open commit on remote provider. See output channel for more details',\n\t\t\t);\n\t\t}\n\t}\n}\n","'use strict';\nimport { window } from 'vscode';\nimport { RemoteResourceType } from '../git/git';\nimport { Logger } from '../logger';\nimport { ResultsCommitsNode } from '../views/nodes';\nimport { Command, command, CommandContext, Commands, executeCommand } from './common';\nimport { OpenOnRemoteCommandArgs } from './openOnRemote';\n\nexport interface OpenComparisonOnRemoteCommandArgs {\n\tclipboard?: boolean;\n\tref1?: string;\n\tref2?: string;\n\tnotation?: '..' | '...';\n\trepoPath?: string;\n}\n\n@command()\nexport class OpenComparisonOnRemoteCommand extends Command {\n\tconstructor() {\n\t\tsuper([Commands.OpenComparisonOnRemote, Commands.CopyRemoteComparisonUrl]);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: OpenComparisonOnRemoteCommandArgs) {\n\t\tif (context.type === 'viewItem') {\n\t\t\tif (context.node instanceof ResultsCommitsNode) {\n\t\t\t\targs = {\n\t\t\t\t\t...args,\n\t\t\t\t\trepoPath: context.node.repoPath,\n\t\t\t\t\tref1: context.node.ref1,\n\t\t\t\t\tref2: context.node.ref2,\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif (context.command === Commands.CopyRemoteBranchesUrl) {\n\t\t\targs = { ...args, clipboard: true };\n\t\t}\n\n\t\treturn this.execute(args);\n\t}\n\n\tasync execute(args?: OpenComparisonOnRemoteCommandArgs) {\n\t\tif (args?.repoPath == null || args.ref1 == null || args.ref2 == null) return;\n\n\t\ttry {\n\t\t\tvoid (await executeCommand<OpenOnRemoteCommandArgs>(Commands.OpenOnRemote, {\n\t\t\t\tresource: {\n\t\t\t\t\ttype: RemoteResourceType.Comparison,\n\t\t\t\t\tbase: args.ref1,\n\t\t\t\t\tcompare: args.ref2,\n\t\t\t\t\tnotation: args.notation,\n\t\t\t\t},\n\t\t\t\trepoPath: args.repoPath,\n\t\t\t\tclipboard: args?.clipboard,\n\t\t\t}));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenComparisonOnRemoteCommand');\n\t\t\tvoid window.showErrorMessage(\n\t\t\t\t'Unable to open comparison on remote provider. See output channel for more details',\n\t\t\t);\n\t\t}\n\t}\n}\n","'use strict';\nimport { env, Range, Uri, window } from 'vscode';\nimport { Container } from '../container';\nimport { command, Command, Commands, openEditor } from './common';\n\n@command()\nexport class OpenFileFromRemoteCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.OpenFileFromRemote);\n\t}\n\n\tasync execute() {\n\t\tlet clipboard: string | undefined = await env.clipboard.readText();\n\t\ttry {\n\t\t\tUri.parse(clipboard, true);\n\t\t} catch {\n\t\t\tclipboard = undefined;\n\t\t}\n\n\t\tconst url = await window.showInputBox({\n\t\t\tprompt: 'Enter a remote file url to open',\n\t\t\tplaceHolder: 'Remote file url',\n\t\t\tvalue: clipboard,\n\t\t\tignoreFocusOut: true,\n\t\t});\n\t\tif (url == null || url.length === 0) return;\n\n\t\tlet local = await Container.git.getLocalInfoFromRemoteUri(Uri.parse(url));\n\t\tif (local == null) {\n\t\t\tlocal = await Container.git.getLocalInfoFromRemoteUri(Uri.parse(url), { validate: false });\n\t\t\tif (local == null) {\n\t\t\t\tvoid window.showWarningMessage('Unable to parse the provided remote url.');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst confirm = 'Open File...';\n\t\t\tconst pick = await window.showWarningMessage(\n\t\t\t\t'Unable to find a workspace folder that matches the provided remote url.',\n\t\t\t\tconfirm,\n\t\t\t);\n\t\t\tif (pick !== confirm) return;\n\t\t}\n\n\t\tlet selection;\n\t\tif (local.startLine) {\n\t\t\tif (local.endLine) {\n\t\t\t\tselection = new Range(local.startLine - 1, 0, local.endLine, 0);\n\t\t\t} else {\n\t\t\t\tselection = new Range(local.startLine - 1, 0, local.startLine - 1, 0);\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\tawait openEditor(local.uri, { selection: selection, rethrow: true });\n\t\t} catch {\n\t\t\tconst uris = await window.showOpenDialog({\n\t\t\t\ttitle: 'Open local file',\n\t\t\t\tdefaultUri: local.uri,\n\t\t\t\tcanSelectMany: false,\n\t\t\t\tcanSelectFolders: false,\n\t\t\t});\n\t\t\tif (uris == null || uris.length === 0) return;\n\n\t\t\tawait openEditor(uris[0]);\n\t\t}\n\t}\n}\n","'use strict';\nimport { Range, TextEditor, Uri, window } from 'vscode';\nimport { UriComparer } from '../comparers';\nimport { BranchSorting, TagSorting } from '../configuration';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitBranch, GitRevision, RemoteResourceType } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { ReferencePicker } from '../quickpicks';\nimport { Strings } from '../system';\nimport { StatusFileNode } from '../views/nodes';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\texecuteCommand,\n\tgetCommandUri,\n\tisCommandContextViewNodeHasBranch,\n\tisCommandContextViewNodeHasCommit,\n} from './common';\nimport { OpenOnRemoteCommandArgs } from './openOnRemote';\n\nexport interface OpenFileOnRemoteCommandArgs {\n\tbranchOrTag?: string;\n\tclipboard?: boolean;\n\trange?: boolean;\n\tsha?: string;\n\tpickBranchOrTag?: boolean;\n}\n\n@command()\nexport class OpenFileOnRemoteCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([\n\t\t\tCommands.OpenFileOnRemote,\n\t\t\tCommands.Deprecated_OpenFileInRemote,\n\t\t\tCommands.CopyRemoteFileUrl,\n\t\t\tCommands.CopyRemoteFileUrlWithoutRange,\n\t\t\tCommands.OpenFileOnRemoteFrom,\n\t\t\tCommands.CopyRemoteFileUrlFrom,\n\t\t]);\n\t}\n\n\tprotected override async preExecute(context: CommandContext, args?: OpenFileOnRemoteCommandArgs) {\n\t\tlet uri = context.uri;\n\n\t\tif (context.command === Commands.CopyRemoteFileUrlWithoutRange) {\n\t\t\targs = { ...args, range: false };\n\t\t}\n\n\t\tif (isCommandContextViewNodeHasCommit(context)) {\n\t\t\targs = { ...args, range: false };\n\n\t\t\tif (\n\t\t\t\tcontext.command === Commands.CopyRemoteFileUrl ||\n\t\t\t\tcontext.command === Commands.CopyRemoteFileUrlWithoutRange ||\n\t\t\t\tcontext.command === Commands.CopyRemoteFileUrlFrom\n\t\t\t) {\n\t\t\t\t// If it is a StatusFileNode then don't include the sha, since it hasn't been pushed yet\n\t\t\t\targs.sha = context.node instanceof StatusFileNode ? undefined : context.node.commit.sha;\n\t\t\t} else if (isCommandContextViewNodeHasBranch(context)) {\n\t\t\t\targs.branchOrTag = context.node.branch?.name;\n\t\t\t}\n\n\t\t\turi = context.node.uri;\n\t\t} else if (context.type === 'viewItem') {\n\t\t\targs = { ...args, range: false };\n\n\t\t\turi = context.node.uri ?? context.uri;\n\t\t}\n\n\t\tif (\n\t\t\tcontext.command === Commands.CopyRemoteFileUrl ||\n\t\t\tcontext.command === Commands.CopyRemoteFileUrlWithoutRange ||\n\t\t\tcontext.command === Commands.CopyRemoteFileUrlFrom\n\t\t) {\n\t\t\targs = { ...args, clipboard: true };\n\t\t\tif (args.sha == null) {\n\t\t\t\tconst uri = getCommandUri(context.uri, context.editor);\n\t\t\t\tif (uri != null) {\n\t\t\t\t\tconst gitUri = await GitUri.fromUri(uri);\n\t\t\t\t\tif (gitUri.repoPath) {\n\t\t\t\t\t\tif (gitUri.sha == null) {\n\t\t\t\t\t\t\tconst commit = await Container.git.getCommitForFile(gitUri.repoPath, gitUri.fsPath, {\n\t\t\t\t\t\t\t\tfirstIfNotFound: true,\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tif (commit != null) {\n\t\t\t\t\t\t\t\targs.sha = commit.sha;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\targs.sha = gitUri.sha;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (context.command === Commands.OpenFileOnRemoteFrom || context.command === Commands.CopyRemoteFileUrlFrom) {\n\t\t\targs = { ...args, pickBranchOrTag: true, range: false };\n\t\t}\n\n\t\treturn this.execute(context.editor, uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: OpenFileOnRemoteCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return;\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\t\tif (!gitUri.repoPath) return;\n\n\t\targs = { range: true, ...args };\n\n\t\ttry {\n\t\t\tlet remotes = await Container.git.getRemotes(gitUri.repoPath);\n\t\t\tconst range =\n\t\t\t\targs.range && editor != null && UriComparer.equals(editor.document.uri, uri)\n\t\t\t\t\t? new Range(\n\t\t\t\t\t\t\teditor.selection.start.with({ line: editor.selection.start.line + 1 }),\n\t\t\t\t\t\t\teditor.selection.end.with({\n\t\t\t\t\t\t\t\tline: editor.selection.end.line + (editor.selection.end.character === 0 ? 0 : 1),\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t  )\n\t\t\t\t\t: undefined;\n\t\t\tlet sha = args.sha ?? gitUri.sha;\n\n\t\t\tif (args.branchOrTag == null && sha != null && !GitRevision.isSha(sha) && remotes.length !== 0) {\n\t\t\t\tconst [remoteName, branchName] = Strings.splitSingle(sha, '/');\n\t\t\t\tif (branchName != null) {\n\t\t\t\t\tconst remote = remotes.find(r => r.name === remoteName);\n\t\t\t\t\tif (remote != null) {\n\t\t\t\t\t\targs.branchOrTag = branchName;\n\t\t\t\t\t\tsha = undefined;\n\n\t\t\t\t\t\tremotes = [remote];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ((args.sha == null && args.branchOrTag == null) || args.pickBranchOrTag) {\n\t\t\t\tlet branch;\n\t\t\t\tif (!args.pickBranchOrTag) {\n\t\t\t\t\tbranch = await Container.git.getBranch(gitUri.repoPath);\n\t\t\t\t}\n\n\t\t\t\tif (branch?.upstream == null) {\n\t\t\t\t\tconst pick = await ReferencePicker.show(\n\t\t\t\t\t\tgitUri.repoPath,\n\t\t\t\t\t\targs.clipboard\n\t\t\t\t\t\t\t? `Copy Remote File Url From${Strings.pad(GlyphChars.Dot, 2, 2)}${gitUri.relativePath}`\n\t\t\t\t\t\t\t: `Open File on Remote From${Strings.pad(GlyphChars.Dot, 2, 2)}${gitUri.relativePath}`,\n\t\t\t\t\t\t`Choose a branch or tag to ${args.clipboard ? 'copy' : 'open'} the file revision from`,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tallowEnteringRefs: true,\n\t\t\t\t\t\t\tautoPick: true,\n\t\t\t\t\t\t\t// checkmarks: false,\n\t\t\t\t\t\t\tfilter: { branches: b => b.remote || b.upstream != null },\n\t\t\t\t\t\t\tpicked: args.branchOrTag,\n\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\tbranches: { current: true, orderBy: BranchSorting.DateDesc },\n\t\t\t\t\t\t\t\ttags: { orderBy: TagSorting.DateDesc },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\t\t\t\t\tif (pick == null) return;\n\n\t\t\t\t\tif (pick.refType === 'branch') {\n\t\t\t\t\t\tif (pick.remote) {\n\t\t\t\t\t\t\targs.branchOrTag = GitBranch.getNameWithoutRemote(pick.name);\n\n\t\t\t\t\t\t\tconst remoteName = GitBranch.getRemote(pick.name);\n\t\t\t\t\t\t\tconst remote = remotes.find(r => r.name === remoteName);\n\t\t\t\t\t\t\tif (remote != null) {\n\t\t\t\t\t\t\t\tremotes = [remote];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\targs.branchOrTag = pick.name;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsha = undefined;\n\t\t\t\t\t} else if (pick.refType === 'tag') {\n\t\t\t\t\t\targs.branchOrTag = pick.ref;\n\t\t\t\t\t\tsha = undefined;\n\t\t\t\t\t} else {\n\t\t\t\t\t\targs.branchOrTag = undefined;\n\t\t\t\t\t\tsha = pick.ref;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\targs.branchOrTag = branch.name;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvoid (await executeCommand<OpenOnRemoteCommandArgs>(Commands.OpenOnRemote, {\n\t\t\t\tresource: {\n\t\t\t\t\ttype: sha == null ? RemoteResourceType.File : RemoteResourceType.Revision,\n\t\t\t\t\tbranchOrTag: args.branchOrTag ?? 'HEAD',\n\t\t\t\t\tfileName: gitUri.relativePath,\n\t\t\t\t\trange: range,\n\t\t\t\t\tsha: sha ?? undefined,\n\t\t\t\t},\n\t\t\t\trepoPath: gitUri.repoPath,\n\t\t\t\tremotes: remotes,\n\t\t\t\tclipboard: args.clipboard,\n\t\t\t}));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenFileOnRemoteCommand');\n\t\t\tvoid window.showErrorMessage('Unable to open file on remote provider. See output channel for more details');\n\t\t}\n\t}\n}\n","'use strict';\nimport { TextDocumentShowOptions, TextEditor, Uri } from 'vscode';\nimport { FileAnnotationType } from '../configuration';\nimport { GlyphChars, quickPickTitleMaxChars } from '../constants';\nimport { Container } from '../container';\nimport { GitRevision } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { CommandQuickPickItem, CommitPicker } from '../quickpicks';\nimport { Strings } from '../system';\nimport { ActiveEditorCommand, command, CommandContext, Commands, getCommandUri } from './common';\nimport { GitActions } from './gitCommands';\n\nexport interface OpenFileAtRevisionCommandArgs {\n\trevisionUri?: Uri;\n\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n\tannotationType?: FileAnnotationType;\n}\n\n@command()\nexport class OpenFileAtRevisionCommand extends ActiveEditorCommand {\n\tstatic getMarkdownCommandArgs(args: OpenFileAtRevisionCommandArgs): string;\n\tstatic getMarkdownCommandArgs(revisionUri: Uri, annotationType?: FileAnnotationType, line?: number): string;\n\tstatic getMarkdownCommandArgs(\n\t\targsOrUri: OpenFileAtRevisionCommandArgs | Uri,\n\t\tannotationType?: FileAnnotationType,\n\t\tline?: number,\n\t): string {\n\t\tlet args: OpenFileAtRevisionCommandArgs | Uri;\n\t\tif (argsOrUri instanceof Uri) {\n\t\t\tconst revisionUri = argsOrUri;\n\n\t\t\targs = {\n\t\t\t\trevisionUri: revisionUri,\n\t\t\t\tline: line,\n\t\t\t\tannotationType: annotationType,\n\t\t\t};\n\t\t} else {\n\t\t\targs = argsOrUri;\n\t\t}\n\n\t\treturn super.getMarkdownCommandArgsCore<OpenFileAtRevisionCommandArgs>(Commands.OpenFileAtRevision, args);\n\t}\n\n\tconstructor() {\n\t\tsuper([Commands.OpenFileAtRevision, Commands.OpenBlamePriorToChange]);\n\t}\n\n\tprotected override async preExecute(context: CommandContext, args?: OpenFileAtRevisionCommandArgs) {\n\t\tif (context.command === Commands.OpenBlamePriorToChange) {\n\t\t\targs = { ...args, annotationType: FileAnnotationType.Blame };\n\t\t\tif (args.revisionUri == null && context.editor != null) {\n\t\t\t\tconst blameline = context.editor.selection.active.line;\n\t\t\t\tif (blameline >= 0) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst gitUri = await GitUri.fromUri(context.editor.document.uri);\n\t\t\t\t\t\tconst blame = await Container.git.getBlameForLine(gitUri, blameline);\n\t\t\t\t\t\tif (blame != null && !blame.commit.isUncommitted && blame.commit.previousSha != null) {\n\t\t\t\t\t\t\targs.revisionUri = GitUri.toRevisionUri(GitUri.fromCommit(blame.commit, true));\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch {}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor: TextEditor | undefined, uri?: Uri, args?: OpenFileAtRevisionCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return;\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\n\t\targs = { ...args };\n\t\tif (args.line == null) {\n\t\t\targs.line = editor?.selection.active.line ?? 0;\n\t\t}\n\n\t\ttry {\n\t\t\tif (args.revisionUri == null) {\n\t\t\t\tconst log = Container.git\n\t\t\t\t\t.getLogForFile(gitUri.repoPath, gitUri.fsPath)\n\t\t\t\t\t.then(\n\t\t\t\t\t\tlog =>\n\t\t\t\t\t\t\tlog ??\n\t\t\t\t\t\t\t(gitUri.sha\n\t\t\t\t\t\t\t\t? Container.git.getLogForFile(gitUri.repoPath, gitUri.fsPath, { ref: gitUri.sha })\n\t\t\t\t\t\t\t\t: undefined),\n\t\t\t\t\t);\n\n\t\t\t\tconst title = `Open ${\n\t\t\t\t\targs.annotationType === FileAnnotationType.Blame ? 'Blame' : 'File'\n\t\t\t\t} at Revision${Strings.pad(GlyphChars.Dot, 2, 2)}`;\n\t\t\t\tconst pick = await CommitPicker.show(\n\t\t\t\t\tlog,\n\t\t\t\t\t`${title}${gitUri.getFormattedFilename({\n\t\t\t\t\t\tsuffix: gitUri.sha ? `:${GitRevision.shorten(gitUri.sha)}` : undefined,\n\t\t\t\t\t\ttruncateTo: quickPickTitleMaxChars - title.length,\n\t\t\t\t\t})}`,\n\t\t\t\t\t`Choose a commit to ${\n\t\t\t\t\t\targs.annotationType === FileAnnotationType.Blame ? 'blame' : 'open'\n\t\t\t\t\t} the file revision from`,\n\t\t\t\t\t{\n\t\t\t\t\t\tpicked: gitUri.sha,\n\t\t\t\t\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\t\t\t\t\tonDidPressKey: async (key, item) => {\n\t\t\t\t\t\t\tvoid (await GitActions.Commit.openFileAtRevision(item.item.uri.fsPath, item.item, {\n\t\t\t\t\t\t\t\tannotationType: args!.annotationType,\n\t\t\t\t\t\t\t\tline: args!.line,\n\t\t\t\t\t\t\t\tpreserveFocus: true,\n\t\t\t\t\t\t\t\tpreview: false,\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t},\n\t\t\t\t\t\tshowOtherReferences: CommandQuickPickItem.fromCommand(\n\t\t\t\t\t\t\t'Choose a branch or tag...',\n\t\t\t\t\t\t\tCommands.OpenFileAtRevisionFrom,\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t\tif (pick == null) return;\n\n\t\t\t\tvoid (await GitActions.Commit.openFileAtRevision(pick.fileName, pick, {\n\t\t\t\t\tannotationType: args.annotationType,\n\t\t\t\t\tline: args.line,\n\t\t\t\t\t...args.showOptions,\n\t\t\t\t}));\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvoid (await GitActions.Commit.openFileAtRevision(args.revisionUri, {\n\t\t\t\tannotationType: args.annotationType,\n\t\t\t\tline: args.line,\n\t\t\t\t...args.showOptions,\n\t\t\t}));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenFileAtRevisionCommand');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to open file at revision');\n\t\t}\n\t}\n}\n","'use strict';\nimport { TextDocumentShowOptions, TextEditor, Uri } from 'vscode';\nimport { FileAnnotationType } from '../configuration';\nimport { GlyphChars, quickPickTitleMaxChars } from '../constants';\nimport { GitReference } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Messages } from '../messages';\nimport { ReferencePicker } from '../quickpicks';\nimport { Strings } from '../system';\nimport { ActiveEditorCommand, command, Commands, getCommandUri } from './common';\nimport { GitActions } from './gitCommands';\n\nexport interface OpenFileAtRevisionFromCommandArgs {\n\treference?: GitReference;\n\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n\tannotationType?: FileAnnotationType;\n}\n\n@command()\nexport class OpenFileAtRevisionFromCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.OpenFileAtRevisionFrom);\n\t}\n\n\tasync execute(editor: TextEditor | undefined, uri?: Uri, args?: OpenFileAtRevisionFromCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return;\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\t\tif (!gitUri.repoPath) {\n\t\t\tvoid Messages.showNoRepositoryWarningMessage('Unable to open file revision');\n\t\t\treturn;\n\t\t}\n\n\t\targs = { ...args };\n\t\tif (args.line == null) {\n\t\t\targs.line = editor?.selection.active.line ?? 0;\n\t\t}\n\n\t\tif (args.reference == null) {\n\t\t\tconst title = `Open File at Branch or Tag${Strings.pad(GlyphChars.Dot, 2, 2)}`;\n\t\t\tconst pick = await ReferencePicker.show(\n\t\t\t\tgitUri.repoPath,\n\t\t\t\t`${title}${gitUri.getFormattedFilename({ truncateTo: quickPickTitleMaxChars - title.length })}`,\n\t\t\t\t'Choose a branch or tag to open the file revision from',\n\t\t\t\t{\n\t\t\t\t\tallowEnteringRefs: true,\n\t\t\t\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\t\t\t\tonDidPressKey: async (key, quickpick) => {\n\t\t\t\t\t\tconst [item] = quickpick.activeItems;\n\t\t\t\t\t\tif (item != null) {\n\t\t\t\t\t\t\tvoid (await GitActions.Commit.openFileAtRevision(\n\t\t\t\t\t\t\t\tGitUri.toRevisionUri(item.ref, gitUri.fsPath, gitUri.repoPath!),\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tannotationType: args!.annotationType,\n\t\t\t\t\t\t\t\t\tline: args!.line,\n\t\t\t\t\t\t\t\t\tpreserveFocus: true,\n\t\t\t\t\t\t\t\t\tpreview: false,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t));\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\t\t\tif (pick == null) return;\n\n\t\t\targs.reference = pick;\n\t\t}\n\n\t\tvoid (await GitActions.Commit.openFileAtRevision(\n\t\t\tGitUri.toRevisionUri(args.reference.ref, gitUri.fsPath, gitUri.repoPath),\n\t\t\t{\n\t\t\t\tannotationType: args.annotationType,\n\t\t\t\tline: args.line,\n\t\t\t\t...args.showOptions,\n\t\t\t},\n\t\t));\n\t}\n}\n","'use strict';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitRemote, GitRevision, RemoteProvider, RemoteResource, RemoteResourceType } from '../git/git';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport {\n\tCopyOrOpenRemoteCommandQuickPickItem,\n\tRemoteProviderPicker,\n\tSetADefaultRemoteCommandQuickPickItem,\n} from '../quickpicks';\nimport { Strings } from '../system';\nimport { Command, command, Commands } from './common';\n\nexport type OpenOnRemoteCommandArgs =\n\t| {\n\t\t\tresource: RemoteResource;\n\t\t\trepoPath: string;\n\n\t\t\tremote?: string;\n\t\t\tclipboard?: boolean;\n\t  }\n\t| {\n\t\t\tresource: RemoteResource;\n\t\t\tremotes: GitRemote<RemoteProvider>[];\n\n\t\t\tremote?: string;\n\t\t\tclipboard?: boolean;\n\t  };\n\n@command()\nexport class OpenOnRemoteCommand extends Command {\n\tconstructor() {\n\t\tsuper([Commands.OpenOnRemote, Commands.Deprecated_OpenInRemote]);\n\t}\n\n\tasync execute(args?: OpenOnRemoteCommandArgs) {\n\t\tif (args?.resource == null) return;\n\n\t\tlet remotes = 'remotes' in args ? args.remotes : await Container.git.getRemotes(args.repoPath);\n\n\t\tif (args.remote != null) {\n\t\t\tconst filtered = remotes.filter(r => r.name === args.remote);\n\t\t\t// Only filter if we get some results\n\t\t\tif (remotes.length > 0) {\n\t\t\t\tremotes = filtered;\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\tif (args.resource.type === RemoteResourceType.Branch) {\n\t\t\t\t// Check to see if the remote is in the branch\n\t\t\t\tconst [remoteName, branchName] = Strings.splitSingle(args.resource.branch, '/');\n\t\t\t\tif (branchName != null) {\n\t\t\t\t\tconst remote = remotes.find(r => r.name === remoteName);\n\t\t\t\t\tif (remote != null) {\n\t\t\t\t\t\targs.resource.branch = branchName;\n\t\t\t\t\t\tremotes = [remote];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (args.resource.type === RemoteResourceType.Revision) {\n\t\t\t\tconst { commit, fileName } = args.resource;\n\t\t\t\tif (commit != null) {\n\t\t\t\t\tconst file = commit?.files.find(f => f.fileName === fileName);\n\t\t\t\t\tif (file?.status === 'D') {\n\t\t\t\t\t\t// Resolve to the previous commit to that file\n\t\t\t\t\t\targs.resource.sha = await Container.git.resolveReference(\n\t\t\t\t\t\t\tcommit.repoPath,\n\t\t\t\t\t\t\t`${commit.sha}^`,\n\t\t\t\t\t\t\tfileName,\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\targs.resource.sha = commit.sha;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst providers = GitRemote.getHighlanderProviders(remotes);\n\t\t\tconst provider = providers?.length ? providers[0].name : 'Remote';\n\n\t\t\tconst options: Parameters<typeof RemoteProviderPicker.show>[4] = {\n\t\t\t\tautoPick: 'default',\n\t\t\t\tclipboard: args.clipboard,\n\t\t\t\tsetDefault: true,\n\t\t\t};\n\t\t\tlet title;\n\t\t\tlet placeHolder = `Choose which remote to ${args.clipboard ? 'copy the url for' : 'open on'}`;\n\n\t\t\tswitch (args.resource.type) {\n\t\t\t\tcase RemoteResourceType.Branch:\n\t\t\t\t\ttitle = `${\n\t\t\t\t\t\targs.clipboard ? `Copy ${provider} Branch Url` : `Open Branch on ${provider}`\n\t\t\t\t\t}${Strings.pad(GlyphChars.Dot, 2, 2)}${args.resource.branch}`;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase RemoteResourceType.Branches:\n\t\t\t\t\ttitle = `${args.clipboard ? `Copy ${provider} Branches Url` : `Open Branches on ${provider}`}`;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase RemoteResourceType.Commit:\n\t\t\t\t\ttitle = `${\n\t\t\t\t\t\targs.clipboard ? `Copy ${provider} Commit Url` : `Open Commit on ${provider}`\n\t\t\t\t\t}${Strings.pad(GlyphChars.Dot, 2, 2)}${GitRevision.shorten(args.resource.sha)}`;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase RemoteResourceType.Comparison:\n\t\t\t\t\ttitle = `${\n\t\t\t\t\t\targs.clipboard ? `Copy ${provider} Comparison Url` : `Open Comparison on ${provider}`\n\t\t\t\t\t}${Strings.pad(GlyphChars.Dot, 2, 2)}${GitRevision.createRange(\n\t\t\t\t\t\targs.resource.base,\n\t\t\t\t\t\targs.resource.compare,\n\t\t\t\t\t\targs.resource.notation ?? '...',\n\t\t\t\t\t)}`;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase RemoteResourceType.CreatePullRequest:\n\t\t\t\t\toptions.autoPick = true;\n\t\t\t\t\toptions.setDefault = false;\n\n\t\t\t\t\ttitle = `${\n\t\t\t\t\t\targs.clipboard\n\t\t\t\t\t\t\t? `Copy ${provider} Create Pull Request Url`\n\t\t\t\t\t\t\t: `Create Pull Request on ${provider}`\n\t\t\t\t\t}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\targs.resource.base?.branch\n\t\t\t\t\t\t\t? GitRevision.createRange(args.resource.base.branch, args.resource.compare.branch, '...')\n\t\t\t\t\t\t\t: args.resource.compare.branch\n\t\t\t\t\t}`;\n\n\t\t\t\t\tplaceHolder = `Choose which remote to ${\n\t\t\t\t\t\targs.clipboard ? 'copy the create pull request url for' : 'create the pull request on'\n\t\t\t\t\t}`;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase RemoteResourceType.File:\n\t\t\t\t\ttitle = `${args.clipboard ? `Copy ${provider} File Url` : `Open File on ${provider}`}${Strings.pad(\n\t\t\t\t\t\tGlyphChars.Dot,\n\t\t\t\t\t\t2,\n\t\t\t\t\t\t2,\n\t\t\t\t\t)}${args.resource.fileName}`;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase RemoteResourceType.Repo:\n\t\t\t\t\ttitle = `${args.clipboard ? `Copy ${provider} Repository Url` : `Open Repository on ${provider}`}`;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase RemoteResourceType.Revision: {\n\t\t\t\t\ttitle = `${args.clipboard ? `Copy ${provider} File Url` : `Open File on ${provider}`}${Strings.pad(\n\t\t\t\t\t\tGlyphChars.Dot,\n\t\t\t\t\t\t2,\n\t\t\t\t\t\t2,\n\t\t\t\t\t)}${GitRevision.shorten(args.resource.sha)}${Strings.pad(GlyphChars.Dot, 1, 1)}${\n\t\t\t\t\t\targs.resource.fileName\n\t\t\t\t\t}`;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst pick = await RemoteProviderPicker.show(title, placeHolder, args.resource, remotes, options);\n\n\t\t\tif (pick instanceof SetADefaultRemoteCommandQuickPickItem) {\n\t\t\t\tconst remote = await pick.execute();\n\t\t\t\tif (remote != null) {\n\t\t\t\t\tvoid (await new CopyOrOpenRemoteCommandQuickPickItem(\n\t\t\t\t\t\tremote,\n\t\t\t\t\t\targs.resource,\n\t\t\t\t\t\targs.clipboard,\n\t\t\t\t\t).execute());\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvoid (await pick?.execute());\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenOnRemoteCommand');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to open in remote provider');\n\t\t}\n\t}\n}\n","'use strict';\nimport { env, Uri } from 'vscode';\nimport { Container } from '../container';\nimport { PullRequestNode } from '../views/nodes';\nimport { Command, command, CommandContext, Commands } from './common';\n\nexport interface OpenPullRequestOnRemoteCommandArgs {\n\tclipboard?: boolean;\n\tref?: string;\n\trepoPath?: string;\n\tpr?: { url: string };\n}\n\n@command()\nexport class OpenPullRequestOnRemoteCommand extends Command {\n\tconstructor() {\n\t\tsuper([Commands.OpenPullRequestOnRemote, Commands.CopyRemotePullRequestUrl]);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: OpenPullRequestOnRemoteCommandArgs) {\n\t\tif (context.type === 'viewItem' && context.node instanceof PullRequestNode) {\n\t\t\targs = {\n\t\t\t\t...args,\n\t\t\t\tpr: { url: context.node.pullRequest.url },\n\t\t\t\tclipboard: context.command === Commands.CopyRemotePullRequestUrl,\n\t\t\t};\n\t\t}\n\n\t\treturn this.execute(args);\n\t}\n\n\tasync execute(args?: OpenPullRequestOnRemoteCommandArgs) {\n\t\tif (args?.pr == null) {\n\t\t\tif (args?.repoPath == null || args?.ref == null) return;\n\n\t\t\tconst remote = await Container.git.getRichRemoteProvider(args.repoPath);\n\t\t\tif (remote?.provider == null) return;\n\n\t\t\tconst pr = await Container.git.getPullRequestForCommit(args.ref, remote.provider);\n\t\t\tif (pr == null) return;\n\n\t\t\targs = { ...args };\n\t\t\targs.pr = pr;\n\t\t}\n\n\t\tif (args.clipboard) {\n\t\t\tvoid (await env.clipboard.writeText(args.pr.url));\n\t\t} else {\n\t\t\tvoid env.openExternal(Uri.parse(args.pr.url));\n\t\t}\n\t}\n}\n","'use strict';\nimport { TextEditor, Uri, window } from 'vscode';\nimport { RemoteResourceType } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\texecuteCommand,\n\tgetCommandUri,\n\tgetRepoPathOrActiveOrPrompt,\n\tisCommandContextViewNodeHasRemote,\n} from './common';\nimport { OpenOnRemoteCommandArgs } from './openOnRemote';\n\nexport interface OpenRepoOnRemoteCommandArgs {\n\tclipboard?: boolean;\n\tremote?: string;\n}\n\n@command()\nexport class OpenRepoOnRemoteCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([Commands.OpenRepoOnRemote, Commands.Deprecated_OpenRepoInRemote, Commands.CopyRemoteRepositoryUrl]);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: OpenRepoOnRemoteCommandArgs) {\n\t\tif (isCommandContextViewNodeHasRemote(context)) {\n\t\t\targs = { ...args, remote: context.node.remote.name };\n\t\t}\n\n\t\tif (context.command === Commands.CopyRemoteRepositoryUrl) {\n\t\t\targs = { ...args, clipboard: true };\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: OpenRepoOnRemoteCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\n\t\tconst gitUri = uri != null ? await GitUri.fromUri(uri) : undefined;\n\n\t\tconst repoPath = await getRepoPathOrActiveOrPrompt(\n\t\t\tgitUri,\n\t\t\teditor,\n\t\t\targs?.clipboard\n\t\t\t\t? 'Choose which repository to copy the url from'\n\t\t\t\t: 'Choose which repository to open on remote',\n\t\t);\n\t\tif (!repoPath) return;\n\n\t\ttry {\n\t\t\tvoid (await executeCommand<OpenOnRemoteCommandArgs>(Commands.OpenOnRemote, {\n\t\t\t\tresource: {\n\t\t\t\t\ttype: RemoteResourceType.Repo,\n\t\t\t\t},\n\t\t\t\trepoPath: repoPath,\n\t\t\t\tremote: args?.remote,\n\t\t\t\tclipboard: args?.clipboard,\n\t\t\t}));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenRepoOnRemoteCommand');\n\t\t\tvoid window.showErrorMessage(\n\t\t\t\t'Unable to open repository on remote provider. See output channel for more details',\n\t\t\t);\n\t\t}\n\t}\n}\n","'use strict';\nimport { TextDocumentShowOptions, TextEditor, Uri } from 'vscode';\nimport { FileAnnotationType } from '../configuration';\nimport { Container } from '../container';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { ActiveEditorCommand, command, Commands, getCommandUri } from './common';\nimport { GitActions } from './gitCommands';\n\nexport interface OpenRevisionFileCommandArgs {\n\trevisionUri?: Uri;\n\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n\tannotationType?: FileAnnotationType;\n}\n\n@command()\nexport class OpenRevisionFileCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([Commands.OpenRevisionFile, Commands.OpenRevisionFileInDiffLeft, Commands.OpenRevisionFileInDiffRight]);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: OpenRevisionFileCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return;\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\n\t\targs = { ...args };\n\t\tif (args.line == null) {\n\t\t\targs.line = editor?.selection.active.line ?? 0;\n\t\t}\n\n\t\ttry {\n\t\t\tif (args.revisionUri == null) {\n\t\t\t\tif (gitUri?.sha) {\n\t\t\t\t\tconst commit = await Container.git.getCommit(gitUri.repoPath!, gitUri.sha);\n\n\t\t\t\t\targs.revisionUri =\n\t\t\t\t\t\tcommit != null && commit.status === 'D'\n\t\t\t\t\t\t\t? GitUri.toRevisionUri(commit.previousSha!, commit.previousUri.fsPath, commit.repoPath)\n\t\t\t\t\t\t\t: GitUri.toRevisionUri(gitUri);\n\t\t\t\t} else {\n\t\t\t\t\targs.revisionUri = GitUri.toRevisionUri(gitUri);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvoid (await GitActions.Commit.openFileAtRevision(args.revisionUri, {\n\t\t\t\tannotationType: args.annotationType,\n\t\t\t\tline: args.line,\n\t\t\t\t...args.showOptions,\n\t\t\t}));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenRevisionFileCommand');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to open file revision');\n\t\t}\n\t}\n}\n","'use strict';\nimport { Range, TextDocumentShowOptions, TextEditor, Uri, window } from 'vscode';\nimport { FileAnnotationType } from '../configuration';\nimport { Container } from '../container';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { ActiveEditorCommand, command, Commands, findOrOpenEditor, getCommandUri } from './common';\n\nexport interface OpenWorkingFileCommandArgs {\n\turi?: Uri;\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n\tannotationType?: FileAnnotationType;\n}\n\n@command()\nexport class OpenWorkingFileCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([Commands.OpenWorkingFile, Commands.OpenWorkingFileInDiffLeft, Commands.OpenWorkingFileInDiffRight]);\n\t}\n\n\tasync execute(editor: TextEditor, uri?: Uri, args?: OpenWorkingFileCommandArgs) {\n\t\targs = { ...args };\n\t\tif (args.line == null) {\n\t\t\targs.line = editor?.selection.active.line;\n\t\t}\n\n\t\ttry {\n\t\t\tif (args.uri == null) {\n\t\t\t\turi = getCommandUri(uri, editor);\n\t\t\t\tif (uri == null) return;\n\t\t\t} else {\n\t\t\t\turi = args.uri;\n\t\t\t}\n\n\t\t\targs.uri = await GitUri.fromUri(uri);\n\t\t\tif (GitUri.is(args.uri) && args.uri.sha) {\n\t\t\t\tconst workingUri = await Container.git.getWorkingUri(args.uri.repoPath!, args.uri);\n\t\t\t\tif (workingUri === undefined) {\n\t\t\t\t\tvoid window.showWarningMessage(\n\t\t\t\t\t\t'Unable to open working file. File could not be found in the working tree',\n\t\t\t\t\t);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\targs.uri = new GitUri(workingUri, args.uri.repoPath);\n\t\t\t}\n\n\t\t\tif (args.line !== undefined && args.line !== 0) {\n\t\t\t\tif (args.showOptions === undefined) {\n\t\t\t\t\targs.showOptions = {};\n\t\t\t\t}\n\t\t\t\targs.showOptions.selection = new Range(args.line, 0, args.line, 0);\n\t\t\t}\n\n\t\t\tconst e = await findOrOpenEditor(args.uri, { ...args.showOptions, throwOnError: true });\n\t\t\tif (args.annotationType === undefined) return;\n\n\t\t\tvoid (await Container.fileAnnotations.show(e, args.annotationType, { selection: { line: args.line } }));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenWorkingFileCommand');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to open working file');\n\t\t}\n\t}\n}\n","'use strict';\nimport { Container } from '../container';\nimport { command, Command, Commands } from './common';\n\n@command()\nexport class DisableRebaseEditorCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.DisableRebaseEditor);\n\t}\n\n\texecute() {\n\t\treturn Container.rebaseEditor.setEnabled(false);\n\t}\n}\n\n@command()\nexport class EnableRebaseEditorCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.EnableRebaseEditor);\n\t}\n\n\texecute() {\n\t\treturn Container.rebaseEditor.setEnabled(true);\n\t}\n}\n","'use strict';\nimport { commands } from 'vscode';\nimport { command, Command, Commands } from './common';\n\n@command()\nexport class RefreshHoverCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.RefreshHover);\n\t}\n\n\tasync execute() {\n\t\t// TODO@eamodio figure out how to really refresh/update a hover\n\t\tawait commands.executeCommand('editor.action.showHover');\n\t}\n}\n","'use strict';\nimport { Container } from '../container';\nimport { GitCommit, GitRemote, Repository, RichRemoteProvider } from '../git/git';\nimport { RepositoryPicker } from '../quickpicks/repositoryPicker';\nimport { Iterables } from '../system';\nimport { command, Command, CommandContext, Commands, isCommandContextViewNodeHasRemote } from './common';\n\nexport interface ConnectRemoteProviderCommandArgs {\n\tremote: string;\n\trepoPath: string;\n}\n\n@command()\nexport class ConnectRemoteProviderCommand extends Command {\n\tstatic getMarkdownCommandArgs(args: ConnectRemoteProviderCommandArgs): string;\n\tstatic getMarkdownCommandArgs(remote: GitRemote): string;\n\tstatic getMarkdownCommandArgs(argsOrRemote: ConnectRemoteProviderCommandArgs | GitRemote): string {\n\t\tlet args: ConnectRemoteProviderCommandArgs | GitCommit;\n\t\tif (GitRemote.is(argsOrRemote)) {\n\t\t\targs = {\n\t\t\t\tremote: argsOrRemote.id,\n\t\t\t\trepoPath: argsOrRemote.repoPath,\n\t\t\t};\n\t\t} else {\n\t\t\targs = argsOrRemote;\n\t\t}\n\n\t\treturn super.getMarkdownCommandArgsCore<ConnectRemoteProviderCommandArgs>(Commands.ConnectRemoteProvider, args);\n\t}\n\n\tconstructor() {\n\t\tsuper(Commands.ConnectRemoteProvider);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: ConnectRemoteProviderCommandArgs) {\n\t\tif (isCommandContextViewNodeHasRemote(context)) {\n\t\t\targs = { ...args, remote: context.node.remote.id, repoPath: context.node.remote.repoPath };\n\t\t}\n\n\t\treturn this.execute(args);\n\t}\n\n\tasync execute(args?: ConnectRemoteProviderCommandArgs): Promise<any> {\n\t\tlet remote: GitRemote<RichRemoteProvider> | undefined;\n\t\tlet remotes: GitRemote[] | undefined;\n\t\tlet repoPath;\n\t\tif (args?.repoPath == null) {\n\t\t\tconst repos = new Map<Repository, GitRemote<RichRemoteProvider>>();\n\n\t\t\tfor (const repo of await Container.git.getOrderedRepositories()) {\n\t\t\t\tconst remote = await repo.getRichRemote();\n\t\t\t\tif (remote?.provider != null && !(await remote.provider.isConnected())) {\n\t\t\t\t\trepos.set(repo, remote);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (repos.size === 0) return false;\n\t\t\tif (repos.size === 1) {\n\t\t\t\tlet repo;\n\t\t\t\t[repo, remote] = Iterables.first(repos);\n\t\t\t\trepoPath = repo.path;\n\t\t\t} else {\n\t\t\t\tconst pick = await RepositoryPicker.show(\n\t\t\t\t\tundefined,\n\t\t\t\t\t'Choose which repository to connect to the remote provider',\n\t\t\t\t\t[...repos.keys()],\n\t\t\t\t);\n\t\t\t\tif (pick?.item == null) return undefined;\n\n\t\t\t\trepoPath = pick.repoPath;\n\t\t\t\tremote = repos.get(pick.item)!;\n\t\t\t}\n\t\t} else if (args?.remote == null) {\n\t\t\trepoPath = args.repoPath;\n\n\t\t\tremote = await Container.git.getRichRemoteProvider(repoPath, { includeDisconnected: true });\n\t\t\tif (remote == null) return false;\n\t\t} else {\n\t\t\trepoPath = args.repoPath;\n\n\t\t\tremotes = await Container.git.getRemotes(repoPath);\n\t\t\tremote = remotes.find(r => r.id === args.remote) as GitRemote<RichRemoteProvider> | undefined;\n\t\t\tif (!remote?.provider.hasApi()) return false;\n\t\t}\n\n\t\tconst connected = await remote.provider.connect();\n\t\tif (connected && !(remotes ?? (await Container.git.getRemotes(repoPath))).some(r => r.default)) {\n\t\t\tawait remote.setAsDefault(true);\n\t\t}\n\t\treturn connected;\n\t}\n}\n\nexport interface DisconnectRemoteProviderCommandArgs {\n\tremote: string;\n\trepoPath: string;\n}\n\n@command()\nexport class DisconnectRemoteProviderCommand extends Command {\n\tstatic getMarkdownCommandArgs(args: DisconnectRemoteProviderCommandArgs): string;\n\tstatic getMarkdownCommandArgs(remote: GitRemote): string;\n\tstatic getMarkdownCommandArgs(argsOrRemote: DisconnectRemoteProviderCommandArgs | GitRemote): string {\n\t\tlet args: DisconnectRemoteProviderCommandArgs | GitCommit;\n\t\tif (GitRemote.is(argsOrRemote)) {\n\t\t\targs = {\n\t\t\t\tremote: argsOrRemote.id,\n\t\t\t\trepoPath: argsOrRemote.repoPath,\n\t\t\t};\n\t\t} else {\n\t\t\targs = argsOrRemote;\n\t\t}\n\n\t\treturn super.getMarkdownCommandArgsCore<DisconnectRemoteProviderCommandArgs>(\n\t\t\tCommands.DisconnectRemoteProvider,\n\t\t\targs,\n\t\t);\n\t}\n\n\tconstructor() {\n\t\tsuper(Commands.DisconnectRemoteProvider);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: ConnectRemoteProviderCommandArgs) {\n\t\tif (isCommandContextViewNodeHasRemote(context)) {\n\t\t\targs = { ...args, remote: context.node.remote.id, repoPath: context.node.remote.repoPath };\n\t\t}\n\n\t\treturn this.execute(args);\n\t}\n\n\tasync execute(args?: DisconnectRemoteProviderCommandArgs): Promise<any> {\n\t\tlet remote: GitRemote<RichRemoteProvider> | undefined;\n\t\tlet repoPath;\n\t\tif (args?.repoPath == null) {\n\t\t\tconst repos = new Map<Repository, GitRemote<RichRemoteProvider>>();\n\n\t\t\tfor (const repo of await Container.git.getOrderedRepositories()) {\n\t\t\t\tconst remote = await repo.getRichRemote(true);\n\t\t\t\tif (remote != null) {\n\t\t\t\t\trepos.set(repo, remote);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (repos.size === 0) return undefined;\n\t\t\tif (repos.size === 1) {\n\t\t\t\tlet repo;\n\t\t\t\t[repo, remote] = Iterables.first(repos);\n\t\t\t\trepoPath = repo.path;\n\t\t\t} else {\n\t\t\t\tconst pick = await RepositoryPicker.show(\n\t\t\t\t\tundefined,\n\t\t\t\t\t'Choose which repository to disconnect from the remote provider',\n\t\t\t\t\t[...repos.keys()],\n\t\t\t\t);\n\t\t\t\tif (pick?.item == null) return undefined;\n\n\t\t\t\trepoPath = pick.repoPath;\n\t\t\t\tremote = repos.get(pick.item)!;\n\t\t\t}\n\t\t} else if (args?.remote == null) {\n\t\t\trepoPath = args.repoPath;\n\n\t\t\tremote = await Container.git.getRichRemoteProvider(repoPath, { includeDisconnected: false });\n\t\t\tif (remote == null) return undefined;\n\t\t} else {\n\t\t\trepoPath = args.repoPath;\n\n\t\t\tremote = (await Container.git.getRemotes(repoPath)).find(r => r.id === args.remote) as\n\t\t\t\t| GitRemote<RichRemoteProvider>\n\t\t\t\t| undefined;\n\t\t\tif (!remote?.provider.hasApi()) return undefined;\n\t\t}\n\n\t\treturn remote.provider.disconnect();\n\t}\n}\n","'use strict';\nimport { executeGitCommand } from '../commands';\nimport { Container } from '../container';\nimport { command, Command, Commands } from './common';\n\n@command()\nexport class FetchRepositoriesCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.FetchRepositories);\n\t}\n\n\tasync execute() {\n\t\treturn executeGitCommand({ command: 'fetch', state: { repos: await Container.git.getOrderedRepositories() } });\n\t}\n}\n\n@command()\nexport class PullRepositoriesCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.PullRepositories);\n\t}\n\n\tasync execute() {\n\t\treturn executeGitCommand({ command: 'pull', state: { repos: await Container.git.getOrderedRepositories() } });\n\t}\n}\n\n@command()\nexport class PushRepositoriesCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.PushRepositories);\n\t}\n\n\tasync execute() {\n\t\treturn executeGitCommand({ command: 'push', state: { repos: await Container.git.getOrderedRepositories() } });\n\t}\n}\n","'use strict';\nimport { resetAvatarCache } from '../avatars';\nimport { command, Command, Commands } from './common';\n\n@command()\nexport class ResetAvatarCacheCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.ResetAvatarCache);\n\t}\n\n\texecute() {\n\t\tresetAvatarCache('all');\n\t}\n}\n","'use strict';\nimport { ConfigurationTarget } from 'vscode';\nimport { configuration } from '../configuration';\nimport { command, Command, Commands } from './common';\n\n@command()\nexport class ResetSuppressedWarningsCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.ResetSuppressedWarnings);\n\t}\n\n\tasync execute() {\n\t\tvoid (await configuration.update('advanced.messages', undefined, ConfigurationTarget.Global));\n\t}\n}\n","'use strict';\nimport { commands, window } from 'vscode';\nimport { viewsConfigKeys } from '../configuration';\nimport { command, Command, Commands } from './common';\n\nenum ViewsLayout {\n\tGitLens = 'gitlens',\n\tSourceControl = 'scm',\n}\n\nexport interface SetViewsLayoutCommandArgs {\n\tlayout: ViewsLayout;\n}\n\n@command()\nexport class SetViewsLayoutCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.SetViewsLayout);\n\t}\n\n\tasync execute(args?: SetViewsLayoutCommandArgs) {\n\t\tlet layout = args?.layout;\n\t\tif (layout == null) {\n\t\t\tconst pick = await window.showQuickPick(\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Source Control Layout',\n\t\t\t\t\t\tdescription: '(default)',\n\t\t\t\t\t\tdetail: 'Shows all the views together on the Source Control side bar',\n\t\t\t\t\t\tlayout: ViewsLayout.SourceControl,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'GitLens Layout',\n\t\t\t\t\t\tdescription: '',\n\t\t\t\t\t\tdetail: 'Shows all the views together on the GitLens side bar',\n\t\t\t\t\t\tlayout: ViewsLayout.GitLens,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\t{\n\t\t\t\t\tplaceHolder: 'Choose a GitLens views layout',\n\t\t\t\t},\n\t\t\t);\n\t\t\tif (pick == null) return;\n\n\t\t\tlayout = pick.layout;\n\t\t}\n\n\t\tswitch (layout) {\n\t\t\tcase ViewsLayout.GitLens:\n\t\t\t\ttry {\n\t\t\t\t\t// Because of https://github.com/microsoft/vscode/issues/105774, run the command twice which seems to fix things\n\t\t\t\t\tlet count = 0;\n\t\t\t\t\twhile (count++ < 2) {\n\t\t\t\t\t\tvoid (await commands.executeCommand('vscode.moveViews', {\n\t\t\t\t\t\t\tviewIds: viewsConfigKeys.map(view => `gitlens.views.${view}`),\n\t\t\t\t\t\t\tdestinationId: 'workbench.view.extension.gitlens',\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t} catch {}\n\n\t\t\t\tbreak;\n\t\t\tcase ViewsLayout.SourceControl:\n\t\t\t\ttry {\n\t\t\t\t\t// Because of https://github.com/microsoft/vscode/issues/105774, run the command twice which seems to fix things\n\t\t\t\t\tlet count = 0;\n\t\t\t\t\twhile (count++ < 2) {\n\t\t\t\t\t\tvoid (await commands.executeCommand('vscode.moveViews', {\n\t\t\t\t\t\t\tviewIds: viewsConfigKeys.map(view => `gitlens.views.${view}`),\n\t\t\t\t\t\t\tdestinationId: 'workbench.view.scm',\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t} catch {\n\t\t\t\t\tfor (const view of viewsConfigKeys) {\n\t\t\t\t\t\tvoid (await commands.executeCommand(`gitlens.views.${view}.resetViewLocation`));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n","'use strict';\nimport { executeGitCommand } from '../commands';\nimport { Container } from '../container';\nimport { SearchPattern } from '../git/git';\nimport { SearchResultsNode } from '../views/nodes';\nimport { Command, command, CommandContext, Commands, isCommandContextViewNodeHasRepository } from './common';\n\nexport interface SearchCommitsCommandArgs {\n\tsearch?: Partial<SearchPattern>;\n\trepoPath?: string;\n\n\tprefillOnly?: boolean;\n\n\tshowResultsInSideBar?: boolean;\n}\n\n@command()\nexport class SearchCommitsCommand extends Command {\n\tconstructor() {\n\t\tsuper([Commands.SearchCommits, Commands.SearchCommitsInView]);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: SearchCommitsCommandArgs) {\n\t\tif (context.type === 'viewItem') {\n\t\t\targs = { ...args };\n\t\t\targs.showResultsInSideBar = true;\n\n\t\t\tif (context.node instanceof SearchResultsNode) {\n\t\t\t\targs.repoPath = context.node.repoPath;\n\t\t\t\targs.search = context.node.search;\n\t\t\t\targs.prefillOnly = true;\n\t\t\t}\n\n\t\t\tif (isCommandContextViewNodeHasRepository(context)) {\n\t\t\t\targs.repoPath = context.node.repo.path;\n\t\t\t}\n\t\t} else if (context.command === Commands.SearchCommitsInView) {\n\t\t\targs = { ...args };\n\t\t\targs.showResultsInSideBar = true;\n\t\t}\n\n\t\treturn this.execute(args);\n\t}\n\n\tasync execute(args?: SearchCommitsCommandArgs) {\n\t\tvoid (await executeGitCommand({\n\t\t\tcommand: 'search',\n\t\t\tprefillOnly: args?.prefillOnly,\n\t\t\tstate: {\n\t\t\t\trepo: args?.repoPath,\n\t\t\t\t...args?.search,\n\t\t\t\tshowResultsInSideBar:\n\t\t\t\t\tContainer.config.gitCommands.search.showResultsInSideBar ?? args?.showResultsInSideBar,\n\t\t\t},\n\t\t}));\n\t}\n}\n","'use strict';\nimport { TextEditor, Uri } from 'vscode';\nimport { executeGitCommand } from '../commands';\nimport { Container } from '../container';\nimport { SearchPattern } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { Iterables } from '../system';\nimport { ActiveEditorCommand, command, Commands, getCommandUri } from './common';\n\nexport interface ShowCommitsInViewCommandArgs {\n\trefs?: string[];\n\trepoPath?: string;\n}\n\n@command()\nexport class ShowCommitsInViewCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([Commands.ShowCommitInView, Commands.ShowCommitsInView]);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: ShowCommitsInViewCommandArgs) {\n\t\targs = { ...args };\n\n\t\tif (args.refs === undefined) {\n\t\t\turi = getCommandUri(uri, editor);\n\t\t\tif (uri == null) return undefined;\n\n\t\t\tconst gitUri = await GitUri.fromUri(uri);\n\n\t\t\targs.repoPath = gitUri.repoPath;\n\n\t\t\tif (editor != null) {\n\t\t\t\ttry {\n\t\t\t\t\t// Check for any uncommitted changes in the range\n\t\t\t\t\tconst blame = editor.document.isDirty\n\t\t\t\t\t\t? await Container.git.getBlameForRangeContents(\n\t\t\t\t\t\t\t\tgitUri,\n\t\t\t\t\t\t\t\teditor.selection,\n\t\t\t\t\t\t\t\teditor.document.getText(),\n\t\t\t\t\t\t  )\n\t\t\t\t\t\t: await Container.git.getBlameForRange(gitUri, editor.selection);\n\t\t\t\t\tif (blame === undefined) {\n\t\t\t\t\t\treturn Messages.showFileNotUnderSourceControlWarningMessage('Unable to find commits');\n\t\t\t\t\t}\n\n\t\t\t\t\targs.refs = [\n\t\t\t\t\t\t...Iterables.filterMap(blame.commits.values(), c => (c.isUncommitted ? undefined : c.ref)),\n\t\t\t\t\t];\n\t\t\t\t} catch (ex) {\n\t\t\t\t\tLogger.error(ex, 'ShowCommitsInViewCommand', 'getBlameForRange');\n\t\t\t\t\treturn Messages.showGenericErrorMessage('Unable to find commits');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (gitUri.sha == null) return undefined;\n\n\t\t\t\targs.refs = [gitUri.sha];\n\t\t\t}\n\t\t}\n\n\t\treturn executeGitCommand({\n\t\t\tcommand: 'search',\n\t\t\tstate: {\n\t\t\t\trepo: args?.repoPath,\n\t\t\t\tpattern: SearchPattern.fromCommits(args.refs),\n\t\t\t\tshowResultsInSideBar: true,\n\t\t\t},\n\t\t});\n\t}\n}\n","'use strict';\nimport { commands } from 'vscode';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { command, Command, Commands, getLastCommand } from './common';\n\n@command()\nexport class ShowLastQuickPickCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.ShowLastQuickPick);\n\t}\n\n\texecute() {\n\t\tconst command = getLastCommand();\n\t\tif (command === undefined) return Promise.resolve(undefined);\n\n\t\ttry {\n\t\t\treturn commands.executeCommand(command.command, ...command.args);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ShowLastQuickPickCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to show last quick pick');\n\t\t}\n\t}\n}\n","'use strict';\nimport { TextEditor, Uri } from 'vscode';\nimport { Container } from '../container';\nimport { GitReference } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { ActiveEditorCachedCommand, command, CommandContext, Commands, getCommandUri } from './common';\nimport { executeGitCommand } from './gitCommands';\n\nexport interface ShowQuickBranchHistoryCommandArgs {\n\trepoPath?: string;\n\tbranch?: string;\n\ttag?: string;\n}\n\n@command()\nexport class ShowQuickBranchHistoryCommand extends ActiveEditorCachedCommand {\n\tconstructor() {\n\t\tsuper([Commands.ShowQuickBranchHistory, Commands.ShowQuickCurrentBranchHistory]);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: ShowQuickBranchHistoryCommandArgs) {\n\t\tif (context.command === Commands.ShowQuickCurrentBranchHistory) {\n\t\t\targs = { ...args };\n\t\t\targs.branch = 'HEAD';\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: ShowQuickBranchHistoryCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\n\t\tconst gitUri = uri != null ? await GitUri.fromUri(uri) : undefined;\n\n\t\tconst repoPath = args?.repoPath ?? gitUri?.repoPath ?? Container.git.getHighlanderRepoPath();\n\t\tlet ref: GitReference | 'HEAD' | undefined;\n\t\tif (repoPath != null) {\n\t\t\tif (args?.branch != null) {\n\t\t\t\tref =\n\t\t\t\t\targs.branch === 'HEAD'\n\t\t\t\t\t\t? 'HEAD'\n\t\t\t\t\t\t: GitReference.create(args.branch, repoPath, {\n\t\t\t\t\t\t\t\trefType: 'branch',\n\t\t\t\t\t\t\t\tname: args.branch,\n\t\t\t\t\t\t\t\tremote: false,\n\t\t\t\t\t\t  });\n\t\t\t} else if (args?.tag != null) {\n\t\t\t\tref = GitReference.create(args.tag, repoPath, { refType: 'tag', name: args.tag });\n\t\t\t}\n\t\t}\n\n\t\treturn executeGitCommand({\n\t\t\tcommand: 'log',\n\t\t\tstate: repoPath != null ? { repo: repoPath, reference: ref } : {},\n\t\t});\n\t}\n}\n","'use strict';\nimport { TextEditor, Uri } from 'vscode';\nimport { Container } from '../container';\nimport { GitCommit, GitLog, GitLogCommit } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport {\n\tActiveEditorCachedCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tisCommandContextViewNodeHasCommit,\n} from './common';\nimport { executeGitCommand, GitActions } from './gitCommands';\n\nexport interface ShowQuickCommitCommandArgs {\n\trepoPath?: string;\n\tsha?: string;\n\tcommit?: GitCommit | GitLogCommit;\n\trepoLog?: GitLog;\n\trevealInView?: boolean;\n}\n\n@command()\nexport class ShowQuickCommitCommand extends ActiveEditorCachedCommand {\n\tstatic getMarkdownCommandArgs(sha: string, repoPath?: string): string;\n\tstatic getMarkdownCommandArgs(args: ShowQuickCommitCommandArgs): string;\n\tstatic getMarkdownCommandArgs(argsOrSha: ShowQuickCommitCommandArgs | string, repoPath?: string): string {\n\t\tconst args = typeof argsOrSha === 'string' ? { sha: argsOrSha, repoPath: repoPath } : argsOrSha;\n\t\treturn super.getMarkdownCommandArgsCore<ShowQuickCommitCommandArgs>(Commands.ShowQuickCommit, args);\n\t}\n\n\tconstructor() {\n\t\tsuper([Commands.RevealCommitInView, Commands.ShowQuickCommit]);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: ShowQuickCommitCommandArgs) {\n\t\tif (context.command === Commands.RevealCommitInView) {\n\t\t\targs = { ...args };\n\t\t\targs.revealInView = true;\n\t\t}\n\n\t\tif (context.type === 'viewItem') {\n\t\t\targs = { ...args };\n\t\t\targs.sha = context.node.uri.sha;\n\n\t\t\tif (isCommandContextViewNodeHasCommit(context)) {\n\t\t\t\targs.commit = context.node.commit;\n\t\t\t}\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: ShowQuickCommitCommandArgs) {\n\t\tlet gitUri;\n\t\tlet repoPath;\n\t\tif (args?.commit == null) {\n\t\t\tif (args?.repoPath != null && args.sha != null) {\n\t\t\t\trepoPath = args.repoPath;\n\t\t\t\tgitUri = GitUri.fromRepoPath(repoPath);\n\t\t\t} else {\n\t\t\t\turi = getCommandUri(uri, editor);\n\t\t\t\tif (uri == null) return;\n\n\t\t\t\tgitUri = await GitUri.fromUri(uri);\n\t\t\t\trepoPath = gitUri.repoPath;\n\t\t\t}\n\t\t} else {\n\t\t\tif (args.sha == null) {\n\t\t\t\targs.sha = args.commit.sha;\n\t\t\t}\n\n\t\t\tgitUri = args.commit.toGitUri();\n\t\t\trepoPath = args.commit.repoPath;\n\n\t\t\tif (uri == null) {\n\t\t\t\turi = args.commit.uri;\n\t\t\t}\n\t\t}\n\n\t\targs = { ...args };\n\t\tif (args.sha == null) {\n\t\t\tif (editor == null) return;\n\n\t\t\tconst blameline = editor.selection.active.line;\n\t\t\tif (blameline < 0) return;\n\n\t\t\ttry {\n\t\t\t\tconst blame = await Container.git.getBlameForLine(gitUri, blameline);\n\t\t\t\tif (blame == null) {\n\t\t\t\t\tvoid Messages.showFileNotUnderSourceControlWarningMessage('Unable to show commit');\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Because the previous sha of an uncommitted file isn't trust worthy we just have to kick out\n\t\t\t\tif (blame.commit.isUncommitted) {\n\t\t\t\t\tvoid Messages.showLineUncommittedWarningMessage('Unable to show commit');\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\targs.sha = blame.commit.sha;\n\t\t\t\trepoPath = blame.commit.repoPath;\n\n\t\t\t\targs.commit = blame.commit;\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, 'ShowQuickCommitCommand', `getBlameForLine(${blameline})`);\n\t\t\t\tvoid Messages.showGenericErrorMessage('Unable to show commit');\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\tif (args.commit == null || args.commit.isFile) {\n\t\t\t\tif (args.repoLog != null) {\n\t\t\t\t\targs.commit = args.repoLog.commits.get(args.sha);\n\t\t\t\t\t// If we can't find the commit, kill the repoLog\n\t\t\t\t\tif (args.commit == null) {\n\t\t\t\t\t\targs.repoLog = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (args.repoLog == null) {\n\t\t\t\t\targs.commit = await Container.git.getCommit(repoPath!, args.sha);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (args.commit == null) {\n\t\t\t\tvoid Messages.showCommitNotFoundWarningMessage('Unable to show commit');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (args.revealInView) {\n\t\t\t\tvoid (await GitActions.Commit.reveal(args.commit, {\n\t\t\t\t\tselect: true,\n\t\t\t\t\tfocus: true,\n\t\t\t\t\texpand: true,\n\t\t\t\t}));\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvoid (await executeGitCommand({\n\t\t\t\tcommand: 'show',\n\t\t\t\tstate: {\n\t\t\t\t\trepo: repoPath!,\n\t\t\t\t\treference: args.commit as GitLogCommit,\n\t\t\t\t},\n\t\t\t}));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ShowQuickCommitCommand');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to show commit');\n\t\t}\n\t}\n}\n","'use strict';\nimport { TextEditor, Uri, window } from 'vscode';\nimport { Container } from '../container';\nimport { GitBlameCommit, GitCommit, GitLog, GitLogCommit } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport {\n\tActiveEditorCachedCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tisCommandContextViewNodeHasCommit,\n} from './common';\nimport { executeGitCommand } from './gitCommands';\n\nexport interface ShowQuickCommitFileCommandArgs {\n\tsha?: string;\n\tcommit?: GitCommit | GitLogCommit;\n\tfileLog?: GitLog;\n\trevisionUri?: string;\n}\n\n@command()\nexport class ShowQuickCommitFileCommand extends ActiveEditorCachedCommand {\n\tstatic getMarkdownCommandArgs(args: ShowQuickCommitFileCommandArgs): string {\n\t\treturn super.getMarkdownCommandArgsCore<ShowQuickCommitFileCommandArgs>(Commands.ShowQuickCommitFile, args);\n\t}\n\n\tconstructor() {\n\t\tsuper([\n\t\t\tCommands.ShowQuickCommitFile,\n\t\t\tCommands.ShowQuickCommitRevision,\n\t\t\tCommands.ShowQuickCommitRevisionInDiffLeft,\n\t\t\tCommands.ShowQuickCommitRevisionInDiffRight,\n\t\t]);\n\t}\n\n\tprotected override async preExecute(context: CommandContext, args?: ShowQuickCommitFileCommandArgs) {\n\t\tif (context.editor != null && context.command.startsWith(Commands.ShowQuickCommitRevision)) {\n\t\t\targs = { ...args };\n\n\t\t\tconst gitUri = await GitUri.fromUri(context.editor.document.uri);\n\t\t\targs.sha = gitUri.sha;\n\t\t}\n\n\t\tif (context.type === 'viewItem') {\n\t\t\targs = { ...args };\n\t\t\targs.sha = context.node.uri.sha;\n\n\t\t\tif (isCommandContextViewNodeHasCommit(context)) {\n\t\t\t\targs.commit = context.node.commit;\n\t\t\t}\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: ShowQuickCommitFileCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return;\n\n\t\targs = { ...args };\n\n\t\tlet gitUri;\n\t\tif (args.revisionUri !== undefined) {\n\t\t\tgitUri = GitUri.fromRevisionUri(Uri.parse(args.revisionUri));\n\t\t\targs.sha = gitUri.sha;\n\t\t} else {\n\t\t\tgitUri = await GitUri.fromUri(uri);\n\t\t}\n\n\t\tif (args.sha === undefined) {\n\t\t\tif (editor == null) return;\n\n\t\t\tconst blameline = editor.selection.active.line;\n\t\t\tif (blameline < 0) return;\n\n\t\t\ttry {\n\t\t\t\tconst blame = await Container.git.getBlameForLine(gitUri, blameline);\n\t\t\t\tif (blame == null) {\n\t\t\t\t\tvoid Messages.showFileNotUnderSourceControlWarningMessage('Unable to show commit file details');\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Because the previous sha of an uncommitted file isn't trust worthy we just have to kick out\n\t\t\t\tif (blame.commit.isUncommitted) {\n\t\t\t\t\tvoid Messages.showLineUncommittedWarningMessage('Unable to show commit file details');\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\targs.sha = blame.commit.sha;\n\n\t\t\t\targs.commit = blame.commit;\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, 'ShowQuickCommitFileDetailsCommand', `getBlameForLine(${blameline})`);\n\t\t\t\tvoid window.showErrorMessage('Unable to show commit file details. See output channel for more details');\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\tif (args.commit === undefined || !args.commit.isFile) {\n\t\t\t\tif (args.fileLog !== undefined) {\n\t\t\t\t\targs.commit = args.fileLog.commits.get(args.sha);\n\t\t\t\t\t// If we can't find the commit, kill the fileLog\n\t\t\t\t\tif (args.commit === undefined) {\n\t\t\t\t\t\targs.fileLog = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (args.fileLog === undefined) {\n\t\t\t\t\tconst repoPath = args.commit === undefined ? gitUri.repoPath : args.commit.repoPath;\n\t\t\t\t\targs.commit = await Container.git.getCommitForFile(repoPath, gitUri.fsPath, { ref: args.sha });\n\t\t\t\t\tif (args.commit === undefined) {\n\t\t\t\t\t\tvoid Messages.showCommitNotFoundWarningMessage('Unable to show commit file details');\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (args.commit === undefined) {\n\t\t\t\tvoid Messages.showCommitNotFoundWarningMessage('Unable to show commit file details');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// const shortSha = GitRevision.shorten(args.sha);\n\n\t\t\tconst fileName = args.commit.fileName;\n\t\t\tif (args.commit instanceof GitBlameCommit) {\n\t\t\t\targs.commit = (await Container.git.getCommit(args.commit.repoPath, args.commit.ref))!;\n\t\t\t}\n\n\t\t\tvoid (await executeGitCommand({\n\t\t\t\tcommand: 'show',\n\t\t\t\tstate: {\n\t\t\t\t\trepo: args.commit.repoPath,\n\t\t\t\t\treference: args.commit as GitLogCommit,\n\t\t\t\t\tfileName: fileName,\n\t\t\t\t},\n\t\t\t}));\n\n\t\t\t// if (args.goBackCommand === undefined) {\n\t\t\t// \tconst commandArgs: ShowQuickCommitCommandArgs = {\n\t\t\t// \t\tcommit: args.commit,\n\t\t\t// \t\tsha: args.sha,\n\t\t\t// \t};\n\n\t\t\t// \t// Create a command to get back to the commit details\n\t\t\t// \targs.goBackCommand = new CommandQuickPickItem(\n\t\t\t// \t\t{\n\t\t\t// \t\t\tlabel: `go back ${GlyphChars.ArrowBack}`,\n\t\t\t// \t\t\tdescription: `to details of ${GlyphChars.Space}$(git-commit) ${shortSha}`,\n\t\t\t// \t\t},\n\t\t\t// \t\tCommands.ShowQuickCommit,\n\t\t\t// \t\t[args.commit.toGitUri(), commandArgs],\n\t\t\t// \t);\n\t\t\t// }\n\n\t\t\t// // Create a command to get back to where we are right now\n\t\t\t// const currentCommand = new CommandQuickPickItem(\n\t\t\t// \t{\n\t\t\t// \t\tlabel: `go back ${GlyphChars.ArrowBack}`,\n\t\t\t// \t\tdescription: `to details of ${args.commit.getFormattedPath()} from ${\n\t\t\t// \t\t\tGlyphChars.Space\n\t\t\t// \t\t}$(git-commit) ${shortSha}`,\n\t\t\t// \t},\n\t\t\t// \tCommands.ShowQuickCommitFile,\n\t\t\t// \t[args.commit.toGitUri(), args],\n\t\t\t// );\n\n\t\t\t// const pick = await CommitFileQuickPick.show(args.commit as GitLogCommit, uri, {\n\t\t\t// \tgoBackCommand: args.goBackCommand,\n\t\t\t// \tcurrentCommand: currentCommand,\n\t\t\t// \tfileLog: args.fileLog,\n\t\t\t// });\n\t\t\t// if (pick === undefined) return undefined;\n\n\t\t\t// if (pick instanceof CommandQuickPickItem) return pick.execute();\n\n\t\t\t// return undefined;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ShowQuickCommitFileDetailsCommand');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to show commit file details');\n\t\t}\n\t}\n}\n","'use strict';\nimport { Range, TextEditor, Uri } from 'vscode';\nimport { Container } from '../container';\nimport { GitBranch, GitLog, GitReference, GitTag } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { CommandQuickPickItem } from '../quickpicks';\nimport { ActiveEditorCachedCommand, command, CommandContext, Commands, getCommandUri } from './common';\nimport { executeGitCommand } from './gitCommands';\n\nexport interface ShowQuickFileHistoryCommandArgs {\n\treference?: GitBranch | GitTag | GitReference;\n\tlog?: GitLog;\n\tlimit?: number;\n\trange?: Range;\n\tshowInSideBar?: boolean;\n\n\tgoBackCommand?: CommandQuickPickItem;\n\tnextPageCommand?: CommandQuickPickItem;\n}\n\n@command()\nexport class ShowQuickFileHistoryCommand extends ActiveEditorCachedCommand {\n\tconstructor() {\n\t\tsuper([\n\t\t\tCommands.OpenFileHistory,\n\t\t\tCommands.OpenFolderHistory,\n\t\t\tCommands.ShowQuickFileHistory,\n\t\t\tCommands.QuickOpenFileHistory,\n\t\t\tCommands.Deprecated_ShowFileHistoryInView,\n\t\t]);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: ShowQuickFileHistoryCommandArgs) {\n\t\tif (\n\t\t\tcontext.command === Commands.OpenFileHistory ||\n\t\t\tcontext.command === Commands.OpenFolderHistory ||\n\t\t\tcontext.command === Commands.Deprecated_ShowFileHistoryInView\n\t\t) {\n\t\t\targs = { ...args };\n\t\t\targs.showInSideBar = true;\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: ShowQuickFileHistoryCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return;\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\n\t\tif (args?.showInSideBar) {\n\t\t\tawait Container.fileHistoryView.showHistoryForUri(gitUri);\n\n\t\t\treturn;\n\t\t}\n\n\t\tvoid (await executeGitCommand({\n\t\t\tcommand: 'log',\n\t\t\tstate:\n\t\t\t\tgitUri?.repoPath != null\n\t\t\t\t\t? {\n\t\t\t\t\t\t\trepo: gitUri.repoPath,\n\t\t\t\t\t\t\treference: args?.reference ?? 'HEAD',\n\t\t\t\t\t\t\tfileName: gitUri.relativePath,\n\t\t\t\t\t  }\n\t\t\t\t\t: {},\n\t\t}));\n\t}\n}\n","'use strict';\nimport { executeGitCommand } from '../commands';\nimport { Command, command, Commands } from './common';\n\nexport interface ShowQuickRepoStatusCommandArgs {\n\trepoPath?: string;\n}\n\n@command()\nexport class ShowQuickRepoStatusCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.ShowQuickRepoStatus);\n\t}\n\n\tasync execute(args?: ShowQuickRepoStatusCommandArgs) {\n\t\treturn executeGitCommand({\n\t\t\tcommand: 'status',\n\t\t\tstate: {\n\t\t\t\trepo: args?.repoPath,\n\t\t\t},\n\t\t});\n\t}\n}\n","'use strict';\nimport { executeGitCommand } from '../commands';\nimport { Command, command, Commands } from './common';\n\nexport interface ShowQuickStashListCommandArgs {\n\trepoPath?: string;\n}\n\n@command()\nexport class ShowQuickStashListCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.ShowQuickStashList);\n\t}\n\n\texecute(args?: ShowQuickStashListCommandArgs) {\n\t\treturn executeGitCommand({\n\t\t\tcommand: 'stash',\n\t\t\tstate: {\n\t\t\t\tsubcommand: 'list',\n\t\t\t\trepo: args?.repoPath,\n\t\t\t},\n\t\t});\n\t}\n}\n","'use strict';\nimport { commands } from 'vscode';\nimport { ContextKeys, setContext, SyncedState } from '../constants';\nimport { Container } from '../container';\nimport { command, Command, CommandContext, Commands } from './common';\n\n@command()\nexport class ShowViewCommand extends Command {\n\tconstructor() {\n\t\tsuper([\n\t\t\tCommands.ShowBranchesView,\n\t\t\tCommands.ShowCommitsView,\n\t\t\tCommands.ShowContributorsView,\n\t\t\tCommands.ShowFileHistoryView,\n\t\t\tCommands.ShowLineHistoryView,\n\t\t\tCommands.ShowRemotesView,\n\t\t\tCommands.ShowRepositoriesView,\n\t\t\tCommands.ShowSearchAndCompareView,\n\t\t\tCommands.ShowStashesView,\n\t\t\tCommands.ShowTagsView,\n\t\t\tCommands.ShowWelcomeView,\n\t\t]);\n\t}\n\n\tprotected override preExecute(context: CommandContext) {\n\t\treturn this.execute(context.command as Commands);\n\t}\n\n\tasync execute(command: Commands) {\n\t\tswitch (command) {\n\t\t\tcase Commands.ShowBranchesView:\n\t\t\t\treturn Container.branchesView.show();\n\t\t\tcase Commands.ShowCommitsView:\n\t\t\t\treturn Container.commitsView.show();\n\t\t\tcase Commands.ShowContributorsView:\n\t\t\t\treturn Container.contributorsView.show();\n\t\t\tcase Commands.ShowFileHistoryView:\n\t\t\t\treturn Container.fileHistoryView.show();\n\t\t\tcase Commands.ShowLineHistoryView:\n\t\t\t\treturn Container.lineHistoryView.show();\n\t\t\tcase Commands.ShowRemotesView:\n\t\t\t\treturn Container.remotesView.show();\n\t\t\tcase Commands.ShowRepositoriesView:\n\t\t\t\treturn Container.repositoriesView.show();\n\t\t\tcase Commands.ShowSearchAndCompareView:\n\t\t\t\treturn Container.searchAndCompareView.show();\n\t\t\tcase Commands.ShowStashesView:\n\t\t\t\treturn Container.stashesView.show();\n\t\t\tcase Commands.ShowTagsView:\n\t\t\t\treturn Container.tagsView.show();\n\t\t\tcase Commands.ShowWelcomeView:\n\t\t\t\tawait setContext(ContextKeys.ViewsWelcomeVisible, true);\n\t\t\t\tvoid Container.context.globalState.update(SyncedState.WelcomeViewVisible, true);\n\t\t\t\tvoid (await commands.executeCommand('gitlens.views.welcome.focus'));\n\t\t}\n\n\t\treturn Promise.resolve(undefined);\n\t}\n}\n","'use strict';\nimport { GitActions } from '../commands';\nimport { GitStashCommit, GitStashReference } from '../git/git';\nimport { CommandQuickPickItem } from '../quickpicks';\nimport {\n\tcommand,\n\tCommand,\n\tCommandContext,\n\tCommands,\n\tisCommandContextViewNodeHasCommit,\n\tisCommandContextViewNodeHasRepository,\n} from './common';\n\nexport interface StashApplyCommandArgs {\n\tdeleteAfter?: boolean;\n\trepoPath?: string;\n\tstashItem?: GitStashReference & { message: string };\n\n\tgoBackCommand?: CommandQuickPickItem;\n}\n\n@command()\nexport class StashApplyCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.StashApply);\n\t}\n\n\tprotected override preExecute(context: CommandContext, args?: StashApplyCommandArgs) {\n\t\tif (isCommandContextViewNodeHasCommit<GitStashCommit>(context)) {\n\t\t\targs = { ...args, stashItem: context.node.commit };\n\t\t} else if (isCommandContextViewNodeHasRepository(context)) {\n\t\t\targs = { ...args, repoPath: context.node.repo.path };\n\t\t}\n\n\t\treturn this.execute(args);\n\t}\n\n\tasync execute(args?: StashApplyCommandArgs) {\n\t\tif (args?.deleteAfter) {\n\t\t\treturn GitActions.Stash.pop(args?.repoPath ?? args?.stashItem?.repoPath, args?.stashItem);\n\t\t}\n\n\t\treturn GitActions.Stash.apply(args?.repoPath ?? args?.stashItem?.repoPath, args?.stashItem);\n\t}\n}\n","'use strict';\nimport { Uri } from 'vscode';\nimport { GitActions } from '../commands';\nimport { Container } from '../container';\nimport { GitUri } from '../git/gitUri';\nimport {\n\tCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tisCommandContextViewNodeHasFile,\n\tisCommandContextViewNodeHasRepoPath,\n\tisCommandContextViewNodeHasRepository,\n} from './common';\n\nconst enum ResourceGroupType {\n\tMerge,\n\tIndex,\n\tWorkingTree,\n}\n\nexport interface StashSaveCommandArgs {\n\tmessage?: string;\n\trepoPath?: string;\n\turis?: Uri[];\n\tkeepStaged?: boolean;\n}\n\n@command()\nexport class StashSaveCommand extends Command {\n\tconstructor() {\n\t\tsuper([Commands.StashSave, Commands.StashSaveFiles]);\n\t}\n\n\tprotected override async preExecute(context: CommandContext, args?: StashSaveCommandArgs) {\n\t\tif (isCommandContextViewNodeHasFile(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.repoPath = context.node.file.repoPath ?? context.node.repoPath;\n\t\t\targs.uris = [GitUri.fromFile(context.node.file, args.repoPath)];\n\t\t} else if (isCommandContextViewNodeHasRepository(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.repoPath = context.node.repo.path;\n\t\t} else if (isCommandContextViewNodeHasRepoPath(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.repoPath = context.node.repoPath;\n\t\t} else if (context.type === 'scm-states') {\n\t\t\targs = { ...args };\n\t\t\targs.uris = context.scmResourceStates.map(s => s.resourceUri);\n\t\t\targs.repoPath = await Container.git.getRepoPath(args.uris[0].fsPath);\n\n\t\t\tconst status = await Container.git.getStatusForRepo(args.repoPath);\n\t\t\tif (status?.computeWorkingTreeStatus().staged) {\n\t\t\t\tif (!context.scmResourceStates.some(s => (s as any).resourceGroupType === ResourceGroupType.Index)) {\n\t\t\t\t\targs.keepStaged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (context.type === 'scm-groups') {\n\t\t\targs = { ...args };\n\t\t\targs.uris = context.scmResourceGroups.reduce<Uri[]>(\n\t\t\t\t(a, b) => a.concat(b.resourceStates.map(s => s.resourceUri)),\n\t\t\t\t[],\n\t\t\t);\n\t\t\targs.repoPath = await Container.git.getRepoPath(args.uris[0].fsPath);\n\n\t\t\tconst status = await Container.git.getStatusForRepo(args.repoPath);\n\t\t\tif (status?.computeWorkingTreeStatus().staged) {\n\t\t\t\tif (!context.scmResourceGroups.some(g => g.id === 'index')) {\n\t\t\t\t\targs.keepStaged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.execute(args);\n\t}\n\n\texecute(args?: StashSaveCommandArgs) {\n\t\treturn GitActions.Stash.push(args?.repoPath, args?.uris, args?.message, args?.keepStaged);\n\t}\n}\n","'use strict';\nimport { ConfigurationTarget } from 'vscode';\nimport { configuration } from '../configuration';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { ModePicker } from '../quickpicks';\nimport { log } from '../system';\nimport { command, Command, Commands } from './common';\n\n@command()\nexport class SwitchModeCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.SwitchMode);\n\t}\n\n\t@log({ args: false, correlate: true, singleLine: true, timed: false })\n\tasync execute() {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tconst pick = await ModePicker.show();\n\t\tif (pick === undefined) return;\n\n\t\tif (cc != null) {\n\t\t\tcc.exitDetails = ` \\u2014 mode=${pick.key ?? ''}`;\n\t\t}\n\n\t\tconst active = Container.config.mode.active;\n\t\tif (active === pick.key) return;\n\n\t\t// Check if we have applied any annotations and clear them if we won't be applying them again\n\t\tif (active != null && active.length !== 0) {\n\t\t\tconst activeAnnotations = Container.config.modes?.[active].annotations;\n\t\t\tif (activeAnnotations != null) {\n\t\t\t\tconst newAnnotations = pick.key != null ? Container.config.modes?.[pick.key].annotations : undefined;\n\t\t\t\tif (activeAnnotations !== newAnnotations) {\n\t\t\t\t\tawait Container.fileAnnotations.clearAll();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tawait configuration.update('mode.active', pick.key, ConfigurationTarget.Global);\n\t}\n}\n\n@command()\nexport class ToggleReviewModeCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.ToggleReviewMode);\n\t}\n\n\t@log({ args: false, singleLine: true, timed: false })\n\tasync execute() {\n\t\tif (Container.config.modes == null || !Object.keys(Container.config.modes).includes('review')) return;\n\n\t\tconst mode = Container.config.mode.active === 'review' ? undefined : 'review';\n\t\tawait configuration.update('mode.active', mode, ConfigurationTarget.Global);\n\t}\n}\n\n@command()\nexport class ToggleZenModeCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.ToggleZenMode);\n\t}\n\n\t@log({ args: false, singleLine: true, timed: false })\n\tasync execute() {\n\t\tif (Container.config.modes == null || !Object.keys(Container.config.modes).includes('zen')) return;\n\n\t\tconst mode = Container.config.mode.active === 'zen' ? undefined : 'zen';\n\t\tawait configuration.update('mode.active', mode, ConfigurationTarget.Global);\n\t}\n}\n","'use strict';\nimport { Container } from '../container';\nimport { command, Command, Commands } from './common';\n\n@command()\nexport class ToggleCodeLensCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.ToggleCodeLens);\n\t}\n\n\texecute() {\n\t\treturn Container.codeLens.toggleCodeLens();\n\t}\n}\n","'use strict';\nimport { TextEditor, TextEditorEdit, Uri, window } from 'vscode';\nimport { AnnotationContext } from '../annotations/annotationProvider';\nimport { ChangesAnnotationContext } from '../annotations/gutterChangesAnnotationProvider';\nimport { UriComparer } from '../comparers';\nimport { FileAnnotationType } from '../configuration';\nimport { isTextEditor } from '../constants';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { ActiveEditorCommand, command, Commands, EditorCommand } from './common';\n\n@command()\nexport class ClearFileAnnotationsCommand extends EditorCommand {\n\tconstructor() {\n\t\tsuper([Commands.ClearFileAnnotations, Commands.ComputingFileAnnotations]);\n\t}\n\n\tasync execute(editor: TextEditor, edit: TextEditorEdit, uri?: Uri): Promise<void> {\n\t\t// Handle the case where we are focused on a non-editor editor (output, debug console)\n\t\tif (editor != null && !isTextEditor(editor)) {\n\t\t\tif (uri != null && !UriComparer.equals(uri, editor.document.uri)) {\n\t\t\t\tconst e = window.visibleTextEditors.find(e => UriComparer.equals(uri, e.document.uri));\n\t\t\t\tif (e != null) {\n\t\t\t\t\teditor = e;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\tvoid (await Container.fileAnnotations.clear(editor));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ClearFileAnnotationsCommand');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to clear file annotations');\n\t\t}\n\t}\n}\n\nexport interface ToggleFileBlameAnnotationCommandArgs {\n\ttype: FileAnnotationType.Blame;\n\tcontext?: AnnotationContext;\n\ton?: boolean;\n}\n\nexport interface ToggleFileChangesAnnotationCommandArgs {\n\ttype: FileAnnotationType.Changes;\n\tcontext?: ChangesAnnotationContext;\n\ton?: boolean;\n}\n\nexport interface ToggleFileHeatmapAnnotationCommandArgs {\n\ttype: FileAnnotationType.Heatmap;\n\tcontext?: AnnotationContext;\n\ton?: boolean;\n}\n\nexport type ToggleFileAnnotationCommandArgs =\n\t| ToggleFileBlameAnnotationCommandArgs\n\t| ToggleFileChangesAnnotationCommandArgs\n\t| ToggleFileHeatmapAnnotationCommandArgs;\n\n@command()\nexport class ToggleFileBlameCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([Commands.ToggleFileBlame, Commands.ToggleFileBlameInDiffLeft, Commands.ToggleFileBlameInDiffRight]);\n\t}\n\n\texecute(editor: TextEditor, uri?: Uri, args?: ToggleFileBlameAnnotationCommandArgs): Promise<void> {\n\t\treturn toggleFileAnnotations<ToggleFileBlameAnnotationCommandArgs>(editor, uri, {\n\t\t\t...args,\n\t\t\ttype: FileAnnotationType.Blame,\n\t\t});\n\t}\n}\n\n@command()\nexport class ToggleFileChangesCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.ToggleFileChanges);\n\t}\n\n\texecute(editor: TextEditor, uri?: Uri, args?: ToggleFileChangesAnnotationCommandArgs): Promise<void> {\n\t\treturn toggleFileAnnotations<ToggleFileChangesAnnotationCommandArgs>(editor, uri, {\n\t\t\t...args,\n\t\t\ttype: FileAnnotationType.Changes,\n\t\t});\n\t}\n}\n\n@command()\nexport class ToggleFileHeatmapCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([\n\t\t\tCommands.ToggleFileHeatmap,\n\t\t\tCommands.ToggleFileHeatmapInDiffLeft,\n\t\t\tCommands.ToggleFileHeatmapInDiffRight,\n\t\t]);\n\t}\n\n\texecute(editor: TextEditor, uri?: Uri, args?: ToggleFileHeatmapAnnotationCommandArgs): Promise<void> {\n\t\treturn toggleFileAnnotations<ToggleFileHeatmapAnnotationCommandArgs>(editor, uri, {\n\t\t\t...args,\n\t\t\ttype: FileAnnotationType.Heatmap,\n\t\t});\n\t}\n}\n\nasync function toggleFileAnnotations<TArgs extends ToggleFileAnnotationCommandArgs>(\n\teditor: TextEditor,\n\turi: Uri | undefined,\n\targs: TArgs,\n): Promise<void> {\n\t// Handle the case where we are focused on a non-editor editor (output, debug console)\n\tif (editor != null && !isTextEditor(editor)) {\n\t\tif (uri != null && !UriComparer.equals(uri, editor.document.uri)) {\n\t\t\tconst e = window.visibleTextEditors.find(e => UriComparer.equals(uri, e.document.uri));\n\t\t\tif (e != null) {\n\t\t\t\teditor = e;\n\t\t\t}\n\t\t}\n\t}\n\n\ttry {\n\t\targs = { type: FileAnnotationType.Blame, ...(args as any) };\n\n\t\tvoid (await Container.fileAnnotations.toggle(\n\t\t\teditor,\n\t\t\targs.type,\n\t\t\t{\n\t\t\t\tselection: args.context?.selection ?? { line: editor?.selection.active.line },\n\t\t\t\t...args.context,\n\t\t\t},\n\t\t\targs.on,\n\t\t));\n\t} catch (ex) {\n\t\tLogger.error(ex, 'ToggleFileAnnotationsCommand');\n\t\tvoid window.showErrorMessage(\n\t\t\t`Unable to toggle file ${args.type} annotations. See output channel for more details`,\n\t\t);\n\t}\n}\n","import { TextEditor, Uri, window } from 'vscode';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { ActiveEditorCommand, command, Commands } from './common';\n\n@command()\nexport class ToggleLineBlameCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.ToggleLineBlame);\n\t}\n\n\tasync execute(editor: TextEditor, _uri?: Uri): Promise<void> {\n\t\ttry {\n\t\t\tvoid (await Container.lineAnnotations.toggle(editor));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ToggleLineBlameCommand');\n\t\t\tvoid window.showErrorMessage(\n\t\t\t\t'Unable to toggle line blame annotations. See output channel for more details',\n\t\t\t);\n\t\t}\n\t}\n}\n","'use strict';\nimport { Command } from 'vscode';\n\nexport function command<T extends unknown[]>(command: Omit<Command, 'arguments'> & { arguments: [...T] }): Command {\n\treturn command;\n}\n\nexport * from './commands/addAuthors';\nexport * from './commands/browseRepoAtRevision';\nexport * from './commands/closeUnchangedFiles';\nexport * from './commands/closeView';\nexport * from './commands/common';\nexport * from './commands/compareWith';\nexport * from './commands/copyCurrentBranch';\nexport * from './commands/copyMessageToClipboard';\nexport * from './commands/copyShaToClipboard';\nexport * from './commands/createPullRequestOnRemote';\nexport * from './commands/openDirectoryCompare';\nexport * from './commands/diffLineWithPrevious';\nexport * from './commands/diffLineWithWorking';\nexport * from './commands/diffWith';\nexport * from './commands/diffWithNext';\nexport * from './commands/diffWithPrevious';\nexport * from './commands/diffWithRevision';\nexport * from './commands/diffWithRevisionFrom';\nexport * from './commands/diffWithWorking';\nexport * from './commands/externalDiff';\nexport * from './commands/gitCommands';\nexport * from './commands/inviteToLiveShare';\nexport * from './commands/logging';\nexport * from './commands/openAssociatedPullRequestOnRemote';\nexport * from './commands/openBranchesOnRemote';\nexport * from './commands/openBranchOnRemote';\nexport * from './commands/openChangedFiles';\nexport * from './commands/openCommitOnRemote';\nexport * from './commands/openComparisonOnRemote';\nexport * from './commands/openFileFromRemote';\nexport * from './commands/openFileOnRemote';\nexport * from './commands/openFileAtRevision';\nexport * from './commands/openFileAtRevisionFrom';\nexport * from './commands/openOnRemote';\nexport * from './commands/openPullRequestOnRemote';\nexport * from './commands/openRepoOnRemote';\nexport * from './commands/openRevisionFile';\nexport * from './commands/openWorkingFile';\nexport * from './commands/rebaseEditor';\nexport * from './commands/refreshHover';\nexport * from './commands/remoteProviders';\nexport * from './commands/repositories';\nexport * from './commands/resetAvatarCache';\nexport * from './commands/resetSuppressedWarnings';\nexport * from './commands/setViewsLayout';\nexport * from './commands/searchCommits';\nexport * from './commands/showCommitsInView';\nexport * from './commands/showLastQuickPick';\nexport * from './commands/showQuickBranchHistory';\nexport * from './commands/showQuickCommit';\nexport * from './commands/showQuickCommitFile';\nexport * from './commands/showQuickFileHistory';\nexport * from './commands/showQuickRepoStatus';\nexport * from './commands/showQuickStashList';\nexport * from './commands/showView';\nexport * from './commands/stashApply';\nexport * from './commands/stashSave';\nexport * from './commands/switchMode';\nexport * from './commands/toggleCodeLens';\nexport * from './commands/toggleFileAnnotations';\nexport * from './commands/toggleLineBlame';\n","'use strict';\nimport * as paths from 'path';\nimport {\n\tcommands,\n\tDisposable,\n\tExtensionContext,\n\tGitTimelineItem,\n\tSourceControlResourceGroup,\n\tSourceControlResourceState,\n\tTextDocumentShowOptions,\n\tTextEditor,\n\tTextEditorEdit,\n\tTimelineItem,\n\tUri,\n\tViewColumn,\n\twindow,\n\tworkspace,\n} from 'vscode';\nimport { Action, ActionContext } from '../api/gitlens';\nimport { BuiltInCommands, DocumentSchemes, ImageMimetypes } from '../constants';\nimport { Container } from '../container';\nimport { GitBranch, GitCommit, GitContributor, GitFile, GitReference, GitRemote, GitTag, Repository } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { CommandQuickPickItem, RepositoryPicker } from '../quickpicks';\nimport { ViewNode, ViewRefNode } from '../views/nodes';\n\nexport enum Commands {\n\tActionPrefix = 'gitlens.action.',\n\tAddAuthors = 'gitlens.addAuthors',\n\tBrowseRepoAtRevision = 'gitlens.browseRepoAtRevision',\n\tBrowseRepoAtRevisionInNewWindow = 'gitlens.browseRepoAtRevisionInNewWindow',\n\tBrowseRepoBeforeRevision = 'gitlens.browseRepoBeforeRevision',\n\tBrowseRepoBeforeRevisionInNewWindow = 'gitlens.browseRepoBeforeRevisionInNewWindow',\n\tClearFileAnnotations = 'gitlens.clearFileAnnotations',\n\tCloseUnchangedFiles = 'gitlens.closeUnchangedFiles',\n\tCloseWelcomeView = 'gitlens.closeWelcomeView',\n\tCompareWith = 'gitlens.compareWith',\n\tCompareHeadWith = 'gitlens.compareHeadWith',\n\tCompareWorkingWith = 'gitlens.compareWorkingWith',\n\tComputingFileAnnotations = 'gitlens.computingFileAnnotations',\n\tConnectRemoteProvider = 'gitlens.connectRemoteProvider',\n\tCopyCurrentBranch = 'gitlens.copyCurrentBranch',\n\tCopyMessageToClipboard = 'gitlens.copyMessageToClipboard',\n\tCopyRemoteBranchesUrl = 'gitlens.copyRemoteBranchesUrl',\n\tCopyRemoteBranchUrl = 'gitlens.copyRemoteBranchUrl',\n\tCopyRemoteCommitUrl = 'gitlens.copyRemoteCommitUrl',\n\tCopyRemoteComparisonUrl = 'gitlens.copyRemoteComparisonUrl',\n\tCopyRemoteFileUrl = 'gitlens.copyRemoteFileUrlToClipboard',\n\tCopyRemoteFileUrlWithoutRange = 'gitlens.copyRemoteFileUrlWithoutRange',\n\tCopyRemoteFileUrlFrom = 'gitlens.copyRemoteFileUrlFrom',\n\tCopyRemotePullRequestUrl = 'gitlens.copyRemotePullRequestUrl',\n\tCopyRemoteRepositoryUrl = 'gitlens.copyRemoteRepositoryUrl',\n\tCopyShaToClipboard = 'gitlens.copyShaToClipboard',\n\tCreatePullRequestOnRemote = 'gitlens.createPullRequestOnRemote',\n\tDiffDirectory = 'gitlens.diffDirectory',\n\tDiffDirectoryWithHead = 'gitlens.diffDirectoryWithHead',\n\tDiffWith = 'gitlens.diffWith',\n\tDiffWithNext = 'gitlens.diffWithNext',\n\tDiffWithNextInDiffLeft = 'gitlens.diffWithNextInDiffLeft',\n\tDiffWithNextInDiffRight = 'gitlens.diffWithNextInDiffRight',\n\tDiffWithPrevious = 'gitlens.diffWithPrevious',\n\tDiffWithPreviousInDiffLeft = 'gitlens.diffWithPreviousInDiffLeft',\n\tDiffWithPreviousInDiffRight = 'gitlens.diffWithPreviousInDiffRight',\n\tDiffLineWithPrevious = 'gitlens.diffLineWithPrevious',\n\tDiffWithRevision = 'gitlens.diffWithRevision',\n\tDiffWithRevisionFrom = 'gitlens.diffWithRevisionFrom',\n\tDiffWithWorking = 'gitlens.diffWithWorking',\n\tDiffWithWorkingInDiffLeft = 'gitlens.diffWithWorkingInDiffLeft',\n\tDiffWithWorkingInDiffRight = 'gitlens.diffWithWorkingInDiffRight',\n\tDiffLineWithWorking = 'gitlens.diffLineWithWorking',\n\tDisconnectRemoteProvider = 'gitlens.disconnectRemoteProvider',\n\tDisableDebugLogging = 'gitlens.disableDebugLogging',\n\tEnableDebugLogging = 'gitlens.enableDebugLogging',\n\tDisableRebaseEditor = 'gitlens.disableRebaseEditor',\n\tEnableRebaseEditor = 'gitlens.enableRebaseEditor',\n\tExternalDiff = 'gitlens.externalDiff',\n\tExternalDiffAll = 'gitlens.externalDiffAll',\n\tFetchRepositories = 'gitlens.fetchRepositories',\n\tInviteToLiveShare = 'gitlens.inviteToLiveShare',\n\tOpenBlamePriorToChange = 'gitlens.openBlamePriorToChange',\n\tOpenBranchesOnRemote = 'gitlens.openBranchesOnRemote',\n\tOpenBranchOnRemote = 'gitlens.openBranchOnRemote',\n\tOpenChangedFiles = 'gitlens.openChangedFiles',\n\tOpenCommitOnRemote = 'gitlens.openCommitOnRemote',\n\tOpenComparisonOnRemote = 'gitlens.openComparisonOnRemote',\n\tOpenFileHistory = 'gitlens.openFileHistory',\n\tOpenFileFromRemote = 'gitlens.openFileFromRemote',\n\tOpenFileOnRemote = 'gitlens.openFileOnRemote',\n\tOpenFileOnRemoteFrom = 'gitlens.openFileOnRemoteFrom',\n\tOpenFileAtRevision = 'gitlens.openFileRevision',\n\tOpenFileAtRevisionFrom = 'gitlens.openFileRevisionFrom',\n\tOpenFolderHistory = 'gitlens.openFolderHistory',\n\tOpenOnRemote = 'gitlens.openOnRemote',\n\tOpenPullRequestOnRemote = 'gitlens.openPullRequestOnRemote',\n\tOpenAssociatedPullRequestOnRemote = 'gitlens.openAssociatedPullRequestOnRemote',\n\tOpenRepoOnRemote = 'gitlens.openRepoOnRemote',\n\tOpenRevisionFile = 'gitlens.openRevisionFile',\n\tOpenRevisionFileInDiffLeft = 'gitlens.openRevisionFileInDiffLeft',\n\tOpenRevisionFileInDiffRight = 'gitlens.openRevisionFileInDiffRight',\n\tOpenWorkingFile = 'gitlens.openWorkingFile',\n\tOpenWorkingFileInDiffLeft = 'gitlens.openWorkingFileInDiffLeft',\n\tOpenWorkingFileInDiffRight = 'gitlens.openWorkingFileInDiffRight',\n\tPullRepositories = 'gitlens.pullRepositories',\n\tPushRepositories = 'gitlens.pushRepositories',\n\tGitCommands = 'gitlens.gitCommands',\n\tGitCommandsBranch = 'gitlens.gitCommands.branch',\n\tGitCommandsCherryPick = 'gitlens.gitCommands.cherryPick',\n\tGitCommandsMerge = 'gitlens.gitCommands.merge',\n\tGitCommandsRebase = 'gitlens.gitCommands.rebase',\n\tGitCommandsReset = 'gitlens.gitCommands.reset',\n\tGitCommandsRevert = 'gitlens.gitCommands.revert',\n\tGitCommandsSwitch = 'gitlens.gitCommands.switch',\n\tGitCommandsTag = 'gitlens.gitCommands.tag',\n\tQuickOpenFileHistory = 'gitlens.quickOpenFileHistory',\n\tRefreshHover = 'gitlens.refreshHover',\n\tResetAvatarCache = 'gitlens.resetAvatarCache',\n\tResetSuppressedWarnings = 'gitlens.resetSuppressedWarnings',\n\tRevealCommitInView = 'gitlens.revealCommitInView',\n\tSearchCommits = 'gitlens.showCommitSearch',\n\tSearchCommitsInView = 'gitlens.views.searchAndCompare.searchCommits',\n\tSetViewsLayout = 'gitlens.setViewsLayout',\n\tShowBranchesView = 'gitlens.showBranchesView',\n\tShowCommitInView = 'gitlens.showCommitInView',\n\tShowCommitsInView = 'gitlens.showCommitsInView',\n\tShowCommitsView = 'gitlens.showCommitsView',\n\tShowContributorsView = 'gitlens.showContributorsView',\n\tShowFileHistoryView = 'gitlens.showFileHistoryView',\n\tShowLastQuickPick = 'gitlens.showLastQuickPick',\n\tShowLineHistoryView = 'gitlens.showLineHistoryView',\n\tShowQuickBranchHistory = 'gitlens.showQuickBranchHistory',\n\tShowQuickCommit = 'gitlens.showQuickCommitDetails',\n\tShowQuickCommitFile = 'gitlens.showQuickCommitFileDetails',\n\tShowQuickCurrentBranchHistory = 'gitlens.showQuickRepoHistory',\n\tShowQuickFileHistory = 'gitlens.showQuickFileHistory',\n\tShowQuickRepoStatus = 'gitlens.showQuickRepoStatus',\n\tShowQuickCommitRevision = 'gitlens.showQuickRevisionDetails',\n\tShowQuickCommitRevisionInDiffLeft = 'gitlens.showQuickRevisionDetailsInDiffLeft',\n\tShowQuickCommitRevisionInDiffRight = 'gitlens.showQuickRevisionDetailsInDiffRight',\n\tShowQuickStashList = 'gitlens.showQuickStashList',\n\tShowRemotesView = 'gitlens.showRemotesView',\n\tShowRepositoriesView = 'gitlens.showRepositoriesView',\n\tShowSearchAndCompareView = 'gitlens.showSearchAndCompareView',\n\tShowSettingsPage = 'gitlens.showSettingsPage',\n\tShowSettingsPageAndJumpToBranchesView = 'gitlens.showSettingsPage#branches-view',\n\tShowSettingsPageAndJumpToCommitsView = 'gitlens.showSettingsPage#commits-view',\n\tShowSettingsPageAndJumpToContributorsView = 'gitlens.showSettingsPage#contributors-view',\n\tShowSettingsPageAndJumpToFileHistoryView = 'gitlens.showSettingsPage#file-history-view',\n\tShowSettingsPageAndJumpToLineHistoryView = 'gitlens.showSettingsPage#line-history-view',\n\tShowSettingsPageAndJumpToRemotesView = 'gitlens.showSettingsPage#remotes-view',\n\tShowSettingsPageAndJumpToRepositoriesView = 'gitlens.showSettingsPage#repositories-view',\n\tShowSettingsPageAndJumpToSearchAndCompareView = 'gitlens.showSettingsPage#search-compare-view',\n\tShowSettingsPageAndJumpToStashesView = 'gitlens.showSettingsPage#stashes-view',\n\tShowSettingsPageAndJumpToTagsView = 'gitlens.showSettingsPage#tags-view',\n\tShowSettingsPageAndJumpToViews = 'gitlens.showSettingsPage#views',\n\tShowStashesView = 'gitlens.showStashesView',\n\tShowTagsView = 'gitlens.showTagsView',\n\tShowWelcomePage = 'gitlens.showWelcomePage',\n\tShowWelcomeView = 'gitlens.showWelcomeView',\n\tStashApply = 'gitlens.stashApply',\n\tStashSave = 'gitlens.stashSave',\n\tStashSaveFiles = 'gitlens.stashSaveFiles',\n\tSwitchMode = 'gitlens.switchMode',\n\tToggleCodeLens = 'gitlens.toggleCodeLens',\n\tToggleFileBlame = 'gitlens.toggleFileBlame',\n\tToggleFileBlameInDiffLeft = 'gitlens.toggleFileBlameInDiffLeft',\n\tToggleFileBlameInDiffRight = 'gitlens.toggleFileBlameInDiffRight',\n\tToggleFileChanges = 'gitlens.toggleFileChanges',\n\tToggleFileChangesOnly = 'gitlens.toggleFileChangesOnly',\n\tToggleFileHeatmap = 'gitlens.toggleFileHeatmap',\n\tToggleFileHeatmapInDiffLeft = 'gitlens.toggleFileHeatmapInDiffLeft',\n\tToggleFileHeatmapInDiffRight = 'gitlens.toggleFileHeatmapInDiffRight',\n\tToggleLineBlame = 'gitlens.toggleLineBlame',\n\tToggleReviewMode = 'gitlens.toggleReviewMode',\n\tToggleZenMode = 'gitlens.toggleZenMode',\n\tViewsOpenDirectoryDiff = 'gitlens.views.openDirectoryDiff',\n\tViewsOpenDirectoryDiffWithWorking = 'gitlens.views.openDirectoryDiffWithWorking',\n\n\tDeprecated_DiffHeadWith = 'gitlens.diffHeadWith',\n\tDeprecated_DiffWorkingWith = 'gitlens.diffWorkingWith',\n\tDeprecated_OpenBranchesInRemote = 'gitlens.openBranchesInRemote',\n\tDeprecated_OpenBranchInRemote = 'gitlens.openBranchInRemote',\n\tDeprecated_OpenCommitInRemote = 'gitlens.openCommitInRemote',\n\tDeprecated_OpenFileInRemote = 'gitlens.openFileInRemote',\n\tDeprecated_OpenInRemote = 'gitlens.openInRemote',\n\tDeprecated_OpenRepoInRemote = 'gitlens.openRepoInRemote',\n\tDeprecated_ShowFileHistoryInView = 'gitlens.showFileHistoryInView',\n}\n\nexport function executeActionCommand<T extends ActionContext>(action: Action<T>, args: Omit<T, 'type'>) {\n\treturn commands.executeCommand(`${Commands.ActionPrefix}${action}`, { ...args, type: action });\n}\n\nexport function getMarkdownActionCommand<T extends ActionContext>(action: Action<T>, args: Omit<T, 'type'>): string {\n\treturn Command.getMarkdownCommandArgsCore(`${Commands.ActionPrefix}${action}`, {\n\t\t...args,\n\t\ttype: action,\n\t});\n}\n\nexport function executeCommand<T>(command: Commands, args: T) {\n\treturn commands.executeCommand(command, args);\n}\n\nexport function executeEditorCommand<T>(command: Commands, uri: Uri | undefined, args: T) {\n\treturn commands.executeCommand(command, uri, args);\n}\n\ninterface CommandConstructor {\n\tnew (): Command;\n}\n\nconst registrableCommands: CommandConstructor[] = [];\n\nexport function command(): ClassDecorator {\n\treturn (target: any) => {\n\t\tregistrableCommands.push(target);\n\t};\n}\n\nexport function registerCommands(context: ExtensionContext): void {\n\tfor (const c of registrableCommands) {\n\t\tcontext.subscriptions.push(new c());\n\t}\n}\n\nexport function getCommandUri(uri?: Uri, editor?: TextEditor): Uri | undefined {\n\t// Always use the editor.uri (if we have one), so we are correct for a split diff\n\treturn editor?.document?.uri ?? uri;\n}\n\nexport async function getRepoPathOrActiveOrPrompt(uri: Uri | undefined, editor: TextEditor | undefined, title: string) {\n\tconst repoPath = await Container.git.getRepoPathOrActive(uri, editor);\n\tif (repoPath) return repoPath;\n\n\tconst pick = await RepositoryPicker.show(title);\n\tif (pick instanceof CommandQuickPickItem) {\n\t\tawait pick.execute();\n\t\treturn undefined;\n\t}\n\n\treturn pick?.repoPath;\n}\n\nexport async function getRepoPathOrPrompt(title: string, uri?: Uri) {\n\tconst repoPath = await Container.git.getRepoPath(uri);\n\tif (repoPath) return repoPath;\n\n\tconst pick = await RepositoryPicker.show(title);\n\tif (pick instanceof CommandQuickPickItem) {\n\t\tvoid (await pick.execute());\n\t\treturn undefined;\n\t}\n\n\treturn pick?.repoPath;\n}\n\nexport interface CommandContextParsingOptions {\n\texpectsEditor: boolean;\n}\n\nexport interface CommandBaseContext {\n\tcommand: string;\n\teditor?: TextEditor;\n\turi?: Uri;\n}\n\nexport interface CommandGitTimelineItemContext extends CommandBaseContext {\n\treadonly type: 'timeline-item:git';\n\treadonly item: GitTimelineItem;\n\treadonly uri: Uri;\n}\n\nexport interface CommandScmGroupsContext extends CommandBaseContext {\n\treadonly type: 'scm-groups';\n\treadonly scmResourceGroups: SourceControlResourceGroup[];\n}\n\nexport interface CommandScmStatesContext extends CommandBaseContext {\n\treadonly type: 'scm-states';\n\treadonly scmResourceStates: SourceControlResourceState[];\n}\n\nexport interface CommandUnknownContext extends CommandBaseContext {\n\treadonly type: 'unknown';\n}\n\nexport interface CommandUriContext extends CommandBaseContext {\n\treadonly type: 'uri';\n}\n\nexport interface CommandUrisContext extends CommandBaseContext {\n\treadonly type: 'uris';\n\treadonly uris: Uri[];\n}\n\n// export interface CommandViewContext extends CommandBaseContext {\n//     readonly type: 'view';\n// }\n\nexport interface CommandViewNodeContext extends CommandBaseContext {\n\treadonly type: 'viewItem';\n\treadonly node: ViewNode;\n}\n\nexport function isCommandContextGitTimelineItem(context: CommandContext): context is CommandGitTimelineItemContext {\n\treturn context.type === 'timeline-item:git';\n}\n\nexport function isCommandContextViewNodeHasBranch(\n\tcontext: CommandContext,\n): context is CommandViewNodeContext & { node: ViewNode & { branch: GitBranch } } {\n\tif (context.type !== 'viewItem') return false;\n\n\treturn GitBranch.is((context.node as ViewNode & { branch: GitBranch }).branch);\n}\n\nexport function isCommandContextViewNodeHasCommit<T extends GitCommit>(\n\tcontext: CommandContext,\n): context is CommandViewNodeContext & { node: ViewNode & { commit: T } } {\n\tif (context.type !== 'viewItem') return false;\n\n\treturn GitCommit.is((context.node as ViewNode & { commit: GitCommit }).commit);\n}\n\nexport function isCommandContextViewNodeHasContributor(\n\tcontext: CommandContext,\n): context is CommandViewNodeContext & { node: ViewNode & { contributor: GitContributor } } {\n\tif (context.type !== 'viewItem') return false;\n\n\treturn GitContributor.is((context.node as ViewNode & { contributor: GitContributor }).contributor);\n}\n\nexport function isCommandContextViewNodeHasFile(\n\tcontext: CommandContext,\n): context is CommandViewNodeContext & { node: ViewNode & { file: GitFile; repoPath: string } } {\n\tif (context.type !== 'viewItem') return false;\n\n\tconst node = context.node as ViewNode & { file: GitFile; repoPath: string };\n\treturn node.file != null && (node.file.repoPath != null || node.repoPath != null);\n}\n\nexport function isCommandContextViewNodeHasFileCommit(\n\tcontext: CommandContext,\n): context is CommandViewNodeContext & { node: ViewNode & { commit: GitCommit; file: GitFile; repoPath: string } } {\n\tif (context.type !== 'viewItem') return false;\n\n\tconst node = context.node as ViewNode & { commit: GitCommit; file: GitFile; repoPath: string };\n\treturn node.file != null && GitCommit.is(node.commit) && (node.file.repoPath != null || node.repoPath != null);\n}\n\nexport function isCommandContextViewNodeHasFileRefs(context: CommandContext): context is CommandViewNodeContext & {\n\tnode: ViewNode & { file: GitFile; ref1: string; ref2: string; repoPath: string };\n} {\n\tif (context.type !== 'viewItem') return false;\n\n\tconst node = context.node as ViewNode & { file: GitFile; ref1: string; ref2: string; repoPath: string };\n\treturn (\n\t\tnode.file != null &&\n\t\tnode.ref1 != null &&\n\t\tnode.ref2 != null &&\n\t\t(node.file.repoPath != null || node.repoPath != null)\n\t);\n}\n\nexport function isCommandContextViewNodeHasRef(\n\tcontext: CommandContext,\n): context is CommandViewNodeContext & { node: ViewNode & { ref: GitReference } } {\n\treturn context.type === 'viewItem' && context.node instanceof ViewRefNode;\n}\n\nexport function isCommandContextViewNodeHasRemote(\n\tcontext: CommandContext,\n): context is CommandViewNodeContext & { node: ViewNode & { remote: GitRemote } } {\n\tif (context.type !== 'viewItem') return false;\n\n\treturn GitRemote.is((context.node as ViewNode & { remote: GitRemote }).remote);\n}\n\nexport function isCommandContextViewNodeHasRepository(\n\tcontext: CommandContext,\n): context is CommandViewNodeContext & { node: ViewNode & { repo: Repository } } {\n\tif (context.type !== 'viewItem') return false;\n\n\treturn (context.node as ViewNode & { repo?: Repository }).repo instanceof Repository;\n}\n\nexport function isCommandContextViewNodeHasRepoPath(\n\tcontext: CommandContext,\n): context is CommandViewNodeContext & { node: ViewNode & { repoPath: string } } {\n\tif (context.type !== 'viewItem') return false;\n\n\treturn typeof (context.node as ViewNode & { repoPath?: string }).repoPath === 'string';\n}\n\nexport function isCommandContextViewNodeHasTag(\n\tcontext: CommandContext,\n): context is CommandViewNodeContext & { node: ViewNode & { tag: GitTag } } {\n\tif (context.type !== 'viewItem') return false;\n\n\treturn GitTag.is((context.node as ViewNode & { tag: GitTag }).tag);\n}\n\nexport type CommandContext =\n\t| CommandGitTimelineItemContext\n\t| CommandScmGroupsContext\n\t| CommandScmStatesContext\n\t| CommandUnknownContext\n\t| CommandUriContext\n\t| CommandUrisContext\n\t// | CommandViewContext\n\t| CommandViewNodeContext;\n\nfunction isScmResourceGroup(group: any): group is SourceControlResourceGroup {\n\tif (group == null) return false;\n\n\treturn (\n\t\t(group as SourceControlResourceGroup).id != null &&\n\t\t(group as SourceControlResourceGroup).label != null &&\n\t\t(group as SourceControlResourceGroup).resourceStates != null &&\n\t\tArray.isArray((group as SourceControlResourceGroup).resourceStates)\n\t);\n}\n\nfunction isScmResourceState(resource: any): resource is SourceControlResourceState {\n\tif (resource == null) return false;\n\n\treturn (resource as SourceControlResourceState).resourceUri != null;\n}\n\nfunction isTimelineItem(item: any): item is TimelineItem {\n\tif (item == null) return false;\n\n\treturn (item as TimelineItem).timestamp != null && (item as TimelineItem).label != null;\n}\n\nfunction isGitTimelineItem(item: any): item is GitTimelineItem {\n\tif (item == null) return false;\n\n\treturn (\n\t\tisTimelineItem(item) &&\n\t\t(item as GitTimelineItem).ref != null &&\n\t\t(item as GitTimelineItem).previousRef != null &&\n\t\t(item as GitTimelineItem).message != null\n\t);\n}\n\nexport abstract class Command implements Disposable {\n\tstatic getMarkdownCommandArgsCore<T>(\n\t\tcommand: Commands | `${Commands.ActionPrefix}${ActionContext['type']}`,\n\t\targs: T,\n\t): string {\n\t\treturn `command:${command}?${encodeURIComponent(JSON.stringify(args))}`;\n\t}\n\n\tprotected readonly contextParsingOptions: CommandContextParsingOptions = { expectsEditor: false };\n\n\tprivate readonly _disposable: Disposable;\n\n\tconstructor(command: Commands | Commands[]) {\n\t\tif (typeof command === 'string') {\n\t\t\tthis._disposable = commands.registerCommand(\n\t\t\t\tcommand,\n\t\t\t\t(...args: any[]) => this._execute(command, ...args),\n\t\t\t\tthis,\n\t\t\t);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst subscriptions = command.map(cmd =>\n\t\t\tcommands.registerCommand(cmd, (...args: any[]) => this._execute(cmd, ...args), this),\n\t\t);\n\t\tthis._disposable = Disposable.from(...subscriptions);\n\t}\n\n\tdispose() {\n\t\tthis._disposable.dispose();\n\t}\n\n\tprotected preExecute(context: CommandContext, ...args: any[]): Promise<any> {\n\t\treturn this.execute(...args);\n\t}\n\n\tabstract execute(...args: any[]): any;\n\n\tprotected _execute(command: string, ...args: any[]): any {\n\t\tconst [context, rest] = Command.parseContext(command, { ...this.contextParsingOptions }, ...args);\n\t\treturn this.preExecute(context, ...rest);\n\t}\n\n\tprivate static parseContext(\n\t\tcommand: string,\n\t\toptions: CommandContextParsingOptions,\n\t\t...args: any[]\n\t): [CommandContext, any[]] {\n\t\tlet editor: TextEditor | undefined = undefined;\n\n\t\tlet firstArg = args[0];\n\n\t\tif (options.expectsEditor) {\n\t\t\tif (firstArg == null || (firstArg.id != null && firstArg.document?.uri != null)) {\n\t\t\t\teditor = firstArg;\n\t\t\t\targs = args.slice(1);\n\t\t\t\tfirstArg = args[0];\n\t\t\t}\n\n\t\t\tif (args.length > 0 && (firstArg == null || firstArg instanceof Uri)) {\n\t\t\t\tconst [uri, ...rest] = args as [Uri, any];\n\t\t\t\tif (uri != null) {\n\t\t\t\t\t// If the uri matches the active editor (or we are in a left-hand side of a diff), then pass the active editor\n\t\t\t\t\tif (\n\t\t\t\t\t\teditor == null &&\n\t\t\t\t\t\t(uri.toString() === window.activeTextEditor?.document.uri.toString() ||\n\t\t\t\t\t\t\tcommand.endsWith('InDiffLeft'))\n\t\t\t\t\t) {\n\t\t\t\t\t\teditor = window.activeTextEditor;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst uris = rest[0];\n\t\t\t\t\tif (uris != null && Array.isArray(uris) && uris.length !== 0 && uris[0] instanceof Uri) {\n\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t{ command: command, type: 'uris', editor: editor, uri: uri, uris: uris },\n\t\t\t\t\t\t\trest.slice(1),\n\t\t\t\t\t\t];\n\t\t\t\t\t}\n\t\t\t\t\treturn [{ command: command, type: 'uri', editor: editor, uri: uri }, rest];\n\t\t\t\t}\n\n\t\t\t\targs = args.slice(1);\n\t\t\t} else if (editor == null) {\n\t\t\t\t// If we are expecting an editor and we have no uri, then pass the active editor\n\t\t\t\teditor = window.activeTextEditor;\n\t\t\t}\n\t\t}\n\n\t\tif (firstArg instanceof ViewNode) {\n\t\t\tconst [node, ...rest] = args as [ViewNode, any];\n\t\t\treturn [{ command: command, type: 'viewItem', node: node, uri: node.uri }, rest];\n\t\t}\n\n\t\tif (isScmResourceState(firstArg)) {\n\t\t\tconst states = [];\n\t\t\tlet count = 0;\n\t\t\tfor (const arg of args) {\n\t\t\t\tif (!isScmResourceState(arg)) break;\n\n\t\t\t\tcount++;\n\t\t\t\tstates.push(arg);\n\t\t\t}\n\n\t\t\treturn [\n\t\t\t\t{ command: command, type: 'scm-states', scmResourceStates: states, uri: states[0].resourceUri },\n\t\t\t\targs.slice(count),\n\t\t\t];\n\t\t}\n\n\t\tif (isScmResourceGroup(firstArg)) {\n\t\t\tconst groups = [];\n\t\t\tlet count = 0;\n\t\t\tfor (const arg of args) {\n\t\t\t\tif (!isScmResourceGroup(arg)) break;\n\n\t\t\t\tcount++;\n\t\t\t\tgroups.push(arg);\n\t\t\t}\n\n\t\t\treturn [{ command: command, type: 'scm-groups', scmResourceGroups: groups }, args.slice(count)];\n\t\t}\n\n\t\tif (isGitTimelineItem(firstArg)) {\n\t\t\tconst [item, uri, ...rest] = args as [GitTimelineItem, Uri, any];\n\t\t\treturn [{ command: command, type: 'timeline-item:git', item: item, uri: uri }, rest];\n\t\t}\n\n\t\treturn [{ command: command, type: 'unknown', editor: editor, uri: editor?.document.uri }, args];\n\t}\n}\n\nexport abstract class ActiveEditorCommand extends Command {\n\tprotected override readonly contextParsingOptions: CommandContextParsingOptions = { expectsEditor: true };\n\n\tconstructor(command: Commands | Commands[]) {\n\t\tsuper(command);\n\t}\n\n\tprotected override preExecute(context: CommandContext, ...args: any[]): Promise<any> {\n\t\treturn this.execute(context.editor, context.uri, ...args);\n\t}\n\n\tprotected override _execute(command: string, ...args: any[]): any {\n\t\treturn super._execute(command, undefined, ...args);\n\t}\n\n\tabstract override execute(editor?: TextEditor, ...args: any[]): any;\n}\n\nlet lastCommand: { command: string; args: any[] } | undefined = undefined;\nexport function getLastCommand() {\n\treturn lastCommand;\n}\n\nexport abstract class ActiveEditorCachedCommand extends ActiveEditorCommand {\n\tconstructor(command: Commands | Commands[]) {\n\t\tsuper(command);\n\t}\n\n\tprotected override _execute(command: string, ...args: any[]): any {\n\t\tlastCommand = {\n\t\t\tcommand: command,\n\t\t\targs: args,\n\t\t};\n\t\treturn super._execute(command, ...args);\n\t}\n\n\tabstract override execute(editor: TextEditor, ...args: any[]): any;\n}\n\nexport abstract class EditorCommand implements Disposable {\n\tprivate readonly _disposable: Disposable;\n\n\tconstructor(command: Commands | Commands[]) {\n\t\tif (!Array.isArray(command)) {\n\t\t\tcommand = [command];\n\t\t}\n\n\t\tconst subscriptions = [];\n\t\tfor (const cmd of command) {\n\t\t\tsubscriptions.push(\n\t\t\t\tcommands.registerTextEditorCommand(\n\t\t\t\t\tcmd,\n\t\t\t\t\t(editor: TextEditor, edit: TextEditorEdit, ...args: any[]) =>\n\t\t\t\t\t\tthis.executeCore(cmd, editor, edit, ...args),\n\t\t\t\t\tthis,\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t\tthis._disposable = Disposable.from(...subscriptions);\n\t}\n\n\tdispose() {\n\t\tthis._disposable.dispose();\n\t}\n\n\tprivate executeCore(command: string, editor: TextEditor, edit: TextEditorEdit, ...args: any[]): any {\n\t\treturn this.execute(editor, edit, ...args);\n\t}\n\n\tabstract execute(editor: TextEditor, edit: TextEditorEdit, ...args: any[]): any;\n}\n\nexport function findEditor(uri: Uri): TextEditor | undefined {\n\tconst active = window.activeTextEditor;\n\tconst normalizedUri = uri.toString();\n\n\tfor (const e of [...(active != null ? [active] : []), ...window.visibleTextEditors]) {\n\t\t// Don't include diff editors\n\t\tif (e.document.uri.toString() === normalizedUri && e?.viewColumn != null) {\n\t\t\treturn e;\n\t\t}\n\t}\n\n\treturn undefined;\n}\n\nexport async function findOrOpenEditor(\n\turi: Uri,\n\toptions?: TextDocumentShowOptions & { throwOnError?: boolean },\n): Promise<TextEditor | undefined> {\n\tconst e = findEditor(uri);\n\tif (e != null) {\n\t\tif (!options?.preserveFocus) {\n\t\t\tawait window.showTextDocument(e.document, { ...options, viewColumn: e.viewColumn });\n\t\t}\n\n\t\treturn e;\n\t}\n\n\treturn openEditor(uri, { viewColumn: window.activeTextEditor?.viewColumn, ...options });\n}\n\nexport function findOrOpenEditors(uris: Uri[]): void {\n\tconst normalizedUris = new Map(uris.map(uri => [uri.toString(), uri]));\n\n\tfor (const e of window.visibleTextEditors) {\n\t\t// Don't include diff editors\n\t\tif (e?.viewColumn != null) {\n\t\t\tnormalizedUris.delete(e.document.uri.toString());\n\t\t}\n\t}\n\n\tfor (const uri of normalizedUris.values()) {\n\t\tvoid commands.executeCommand(BuiltInCommands.Open, uri, { background: true, preview: false });\n\t}\n}\n\nexport async function openEditor(\n\turi: Uri,\n\toptions: TextDocumentShowOptions & { rethrow?: boolean } = {},\n): Promise<TextEditor | undefined> {\n\tconst { rethrow, ...opts } = options;\n\ttry {\n\t\tif (GitUri.is(uri)) {\n\t\t\turi = uri.documentUri();\n\t\t}\n\n\t\tif (uri.scheme === DocumentSchemes.GitLens && ImageMimetypes[paths.extname(uri.fsPath)]) {\n\t\t\tawait commands.executeCommand(BuiltInCommands.Open, uri);\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst document = await workspace.openTextDocument(uri);\n\t\treturn window.showTextDocument(document, {\n\t\t\tpreserveFocus: false,\n\t\t\tpreview: true,\n\t\t\tviewColumn: ViewColumn.Active,\n\t\t\t...opts,\n\t\t});\n\t} catch (ex) {\n\t\tconst msg: string = ex?.toString() ?? '';\n\t\tif (msg.includes('File seems to be binary and cannot be opened as text')) {\n\t\t\tawait commands.executeCommand(BuiltInCommands.Open, uri);\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (rethrow) throw ex;\n\n\t\tLogger.error(ex, 'openEditor');\n\t\treturn undefined;\n\t}\n}\n\nexport function openWorkspace(uri: Uri, name: string, options: { openInNewWindow?: boolean } = {}) {\n\tif (options.openInNewWindow) {\n\t\tvoid commands.executeCommand(BuiltInCommands.OpenFolder, uri, true);\n\n\t\treturn true;\n\t}\n\n\treturn workspace.updateWorkspaceFolders(\n\t\tworkspace.workspaceFolders != null ? workspace.workspaceFolders.length : 0,\n\t\tnull,\n\t\t{ uri: uri, name: name },\n\t);\n}\n","import { env, Range, TextDocumentShowOptions, Uri, window } from 'vscode';\nimport {\n\tBrowseRepoAtRevisionCommandArgs,\n\tCommands,\n\tDiffWithCommandArgs,\n\tDiffWithWorkingCommandArgs,\n\texecuteCommand,\n\texecuteEditorCommand,\n\tfindOrOpenEditor,\n\tfindOrOpenEditors,\n\tGitCommandsCommandArgs,\n\tOpenWorkingFileCommandArgs,\n} from '../commands';\nimport { configuration, FileAnnotationType } from '../configuration';\nimport { Container } from '../container';\nimport {\n\tGitBranchReference,\n\tGitContributor,\n\tGitFile,\n\tGitLogCommit,\n\tGitReference,\n\tGitRemote,\n\tGitRevision,\n\tGitRevisionReference,\n\tGitStashReference,\n\tGitTagReference,\n\tRepository,\n} from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { RepositoryPicker } from '../quickpicks';\nimport { ResetGitCommandArgs } from './git/reset';\n\nexport async function executeGitCommand(args: GitCommandsCommandArgs): Promise<void> {\n\tvoid (await executeCommand<GitCommandsCommandArgs>(Commands.GitCommands, args));\n}\n\nasync function ensureRepo(repo: string | Repository): Promise<Repository> {\n\treturn typeof repo === 'string' ? (await Container.git.getRepository(repo))! : repo;\n}\n\nexport namespace GitActions {\n\texport async function browseAtRevision(uri: Uri, options?: { before?: boolean; openInNewWindow?: boolean }) {\n\t\tvoid (await executeEditorCommand<BrowseRepoAtRevisionCommandArgs>(Commands.BrowseRepoAtRevision, undefined, {\n\t\t\turi: uri,\n\t\t\tbefore: options?.before,\n\t\t\topenInNewWindow: options?.openInNewWindow,\n\t\t}));\n\t}\n\n\texport function cherryPick(repo?: string | Repository, refs?: GitRevisionReference | GitRevisionReference[]) {\n\t\treturn executeGitCommand({\n\t\t\tcommand: 'cherry-pick',\n\t\t\tstate: { repo: repo, references: refs },\n\t\t});\n\t}\n\n\texport function fetch(repos?: string | string[] | Repository | Repository[], ref?: GitBranchReference) {\n\t\treturn executeGitCommand({ command: 'fetch', state: { repos: repos, reference: ref } });\n\t}\n\n\texport function merge(repo?: string | Repository, ref?: GitReference) {\n\t\treturn executeGitCommand({ command: 'merge', state: { repo: repo, reference: ref } });\n\t}\n\n\texport function pull(repos?: string | string[] | Repository | Repository[], ref?: GitBranchReference) {\n\t\treturn executeGitCommand({ command: 'pull', state: { repos: repos, reference: ref } });\n\t}\n\n\texport function push(repos?: string | string[] | Repository | Repository[], force?: boolean, ref?: GitReference) {\n\t\treturn executeGitCommand({\n\t\t\tcommand: 'push',\n\t\t\tstate: { repos: repos, flags: force ? ['--force'] : [], reference: ref },\n\t\t});\n\t}\n\n\texport function rebase(repo?: string | Repository, ref?: GitReference, interactive: boolean = true) {\n\t\treturn executeGitCommand({\n\t\t\tcommand: 'rebase',\n\t\t\tstate: { repo: repo, reference: ref, flags: interactive ? ['--interactive'] : [] },\n\t\t});\n\t}\n\n\texport function reset(\n\t\trepo?: string | Repository,\n\t\tref?: GitRevisionReference,\n\t\tflags?: NonNullable<ResetGitCommandArgs['state']>['flags'],\n\t) {\n\t\treturn executeGitCommand({\n\t\t\tcommand: 'reset',\n\t\t\tconfirm: flags == null || flags.includes('--hard'),\n\t\t\tstate: { repo: repo, reference: ref, flags: flags },\n\t\t});\n\t}\n\n\texport function revert(repo?: string | Repository, refs?: GitRevisionReference | GitRevisionReference[]) {\n\t\treturn executeGitCommand({\n\t\t\tcommand: 'revert',\n\t\t\tstate: { repo: repo, references: refs },\n\t\t});\n\t}\n\n\texport function switchTo(repos?: string | string[] | Repository | Repository[], ref?: GitReference) {\n\t\treturn executeGitCommand({\n\t\t\tcommand: 'switch',\n\t\t\tstate: { repos: repos, reference: ref },\n\t\t});\n\t}\n\n\texport namespace Branch {\n\t\texport function create(repo?: string | Repository, ref?: GitReference, name?: string) {\n\t\t\treturn executeGitCommand({\n\t\t\t\tcommand: 'branch',\n\t\t\t\tstate: {\n\t\t\t\t\tsubcommand: 'create',\n\t\t\t\t\trepo: repo,\n\t\t\t\t\treference: ref,\n\t\t\t\t\tname: name,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\texport function remove(repo?: string | Repository, refs?: GitBranchReference | GitBranchReference[]) {\n\t\t\treturn executeGitCommand({\n\t\t\t\tcommand: 'branch',\n\t\t\t\tstate: {\n\t\t\t\t\tsubcommand: 'delete',\n\t\t\t\t\trepo: repo,\n\t\t\t\t\treferences: refs,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\texport function rename(repo?: string | Repository, ref?: GitBranchReference, name?: string) {\n\t\t\treturn executeGitCommand({\n\t\t\t\tcommand: 'branch',\n\t\t\t\tstate: {\n\t\t\t\t\tsubcommand: 'rename',\n\t\t\t\t\trepo: repo,\n\t\t\t\t\treference: ref,\n\t\t\t\t\tname: name,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\texport async function reveal(\n\t\t\tbranch: GitBranchReference,\n\t\t\toptions?: {\n\t\t\t\tselect?: boolean;\n\t\t\t\tfocus?: boolean;\n\t\t\t\texpand?: boolean | number;\n\t\t\t},\n\t\t) {\n\t\t\tif (\n\t\t\t\t!configuration.get(`views.${branch.remote ? 'remotes' : 'branches'}.reveal` as const) ||\n\t\t\t\t(Container.repositoriesView.visible &&\n\t\t\t\t\t!(branch.remote ? Container.remotesView.visible : Container.branchesView.visible))\n\t\t\t) {\n\t\t\t\treturn Container.repositoriesView.revealBranch(branch, options);\n\t\t\t}\n\n\t\t\tlet node;\n\t\t\tif (branch.remote) {\n\t\t\t\tnode = await Container.remotesView.revealBranch(branch, options);\n\t\t\t} else {\n\t\t\t\tnode = await Container.branchesView.revealBranch(branch, options);\n\t\t\t}\n\n\t\t\treturn node;\n\t\t}\n\t}\n\n\texport namespace Commit {\n\t\texport async function applyChanges(\n\t\t\tfile: string | GitFile,\n\t\t\tref1: GitRevisionReference,\n\t\t\tref2?: GitRevisionReference,\n\t\t) {\n\t\t\t// Open the working file to ensure undo will work\n\t\t\tvoid (await GitActions.Commit.openFile(file, ref1, { preserveFocus: true, preview: false }));\n\t\t\tvoid (await Container.git.applyChangesToWorkingFile(\n\t\t\t\tGitUri.fromFile(file, ref1.repoPath, ref1.ref),\n\t\t\t\tref1.ref,\n\t\t\t\tref2?.ref,\n\t\t\t));\n\t\t}\n\n\t\texport async function copyIdToClipboard(ref: { repoPath: string; ref: string } | GitLogCommit) {\n\t\t\tvoid (await env.clipboard.writeText(ref.ref));\n\t\t}\n\n\t\texport async function copyMessageToClipboard(ref: { repoPath: string; ref: string } | GitLogCommit) {\n\t\t\tlet message;\n\t\t\tif (GitLogCommit.is(ref)) {\n\t\t\t\tmessage = ref.message;\n\t\t\t} else {\n\t\t\t\tconst commit = await Container.git.getCommit(ref.repoPath, ref.ref);\n\t\t\t\tif (commit == null) return;\n\n\t\t\t\tmessage = commit.message;\n\t\t\t}\n\n\t\t\tvoid (await env.clipboard.writeText(message));\n\t\t}\n\n\t\texport async function openAllChanges(commit: GitLogCommit, options?: TextDocumentShowOptions): Promise<void>;\n\t\texport async function openAllChanges(\n\t\t\tfiles: GitFile[],\n\t\t\trefs: { repoPath: string; ref1: string; ref2: string },\n\t\t\toptions?: TextDocumentShowOptions,\n\t\t): Promise<void>;\n\t\texport async function openAllChanges(\n\t\t\tcommitOrFiles: GitLogCommit | GitFile[],\n\t\t\trefsOrOptions: { repoPath: string; ref1: string; ref2: string } | TextDocumentShowOptions | undefined,\n\t\t\toptions?: TextDocumentShowOptions,\n\t\t) {\n\t\t\tlet files;\n\t\t\tlet refs;\n\t\t\tif (GitLogCommit.is(commitOrFiles)) {\n\t\t\t\tfiles = commitOrFiles.files;\n\t\t\t\trefs = {\n\t\t\t\t\trepoPath: commitOrFiles.repoPath,\n\t\t\t\t\tref1: commitOrFiles.previousSha != null ? commitOrFiles.previousSha : GitRevision.deletedOrMissing,\n\t\t\t\t\tref2: commitOrFiles.sha,\n\t\t\t\t};\n\n\t\t\t\toptions = refsOrOptions as TextDocumentShowOptions | undefined;\n\t\t\t} else {\n\t\t\t\tfiles = commitOrFiles;\n\t\t\t\trefs = refsOrOptions as { repoPath: string; ref1: string; ref2: string };\n\t\t\t}\n\n\t\t\tif (files.length > 10) {\n\t\t\t\tconst result = await window.showWarningMessage(\n\t\t\t\t\t`Are your sure you want to open the changes for all ${files.length} files?`,\n\t\t\t\t\t{ title: 'Yes' },\n\t\t\t\t\t{ title: 'No', isCloseAffordance: true },\n\t\t\t\t);\n\t\t\t\tif (result == null || result.title === 'No') return;\n\t\t\t}\n\n\t\t\toptions = { preserveFocus: true, preview: false, ...options };\n\n\t\t\tfor (const file of files) {\n\t\t\t\tawait openChanges(file, refs, options);\n\t\t\t}\n\t\t}\n\n\t\texport async function openAllChangesWithDiffTool(commit: GitLogCommit): Promise<void>;\n\t\texport async function openAllChangesWithDiffTool(\n\t\t\tfiles: GitFile[],\n\t\t\tref: { repoPath: string; ref: string },\n\t\t): Promise<void>;\n\t\texport async function openAllChangesWithDiffTool(\n\t\t\tcommitOrFiles: GitLogCommit | GitFile[],\n\t\t\tref?: { repoPath: string; ref: string },\n\t\t) {\n\t\t\tlet files;\n\t\t\tif (GitLogCommit.is(commitOrFiles)) {\n\t\t\t\tfiles = commitOrFiles.files;\n\t\t\t\tref = {\n\t\t\t\t\trepoPath: commitOrFiles.repoPath,\n\t\t\t\t\tref: commitOrFiles.sha,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tfiles = commitOrFiles;\n\t\t\t}\n\n\t\t\tif (files.length > 10) {\n\t\t\t\tconst result = await window.showWarningMessage(\n\t\t\t\t\t`Are your sure you want to open the changes for all ${files.length} files?`,\n\t\t\t\t\t{ title: 'Yes' },\n\t\t\t\t\t{ title: 'No', isCloseAffordance: true },\n\t\t\t\t);\n\t\t\t\tif (result == null || result.title === 'No') return;\n\t\t\t}\n\n\t\t\tfor (const file of files) {\n\t\t\t\tvoid openChangesWithDiffTool(file, ref!);\n\t\t\t}\n\t\t}\n\n\t\texport async function openAllChangesWithWorking(\n\t\t\tcommit: GitLogCommit,\n\t\t\toptions?: TextDocumentShowOptions,\n\t\t): Promise<void>;\n\t\texport async function openAllChangesWithWorking(\n\t\t\tfiles: GitFile[],\n\t\t\tref: { repoPath: string; ref: string },\n\t\t\toptions?: TextDocumentShowOptions,\n\t\t): Promise<void>;\n\t\texport async function openAllChangesWithWorking(\n\t\t\tcommitOrFiles: GitLogCommit | GitFile[],\n\t\t\trefOrOptions: { repoPath: string; ref: string } | TextDocumentShowOptions | undefined,\n\t\t\toptions?: TextDocumentShowOptions,\n\t\t) {\n\t\t\tlet files;\n\t\t\tlet ref;\n\t\t\tif (GitLogCommit.is(commitOrFiles)) {\n\t\t\t\tfiles = commitOrFiles.files;\n\t\t\t\tref = {\n\t\t\t\t\trepoPath: commitOrFiles.repoPath,\n\t\t\t\t\tref: commitOrFiles.sha,\n\t\t\t\t};\n\n\t\t\t\toptions = refOrOptions as TextDocumentShowOptions | undefined;\n\t\t\t} else {\n\t\t\t\tfiles = commitOrFiles;\n\t\t\t\tref = refOrOptions as { repoPath: string; ref: string };\n\t\t\t}\n\n\t\t\tif (files.length > 10) {\n\t\t\t\tconst result = await window.showWarningMessage(\n\t\t\t\t\t`Are your sure you want to open the changes for all ${files.length} files?`,\n\t\t\t\t\t{ title: 'Yes' },\n\t\t\t\t\t{ title: 'No', isCloseAffordance: true },\n\t\t\t\t);\n\t\t\t\tif (result == null || result.title === 'No') return;\n\t\t\t}\n\n\t\t\toptions = { preserveFocus: true, preview: false, ...options };\n\n\t\t\tfor (const file of files) {\n\t\t\t\tvoid (await openChangesWithWorking(file, ref, options));\n\t\t\t}\n\t\t}\n\n\t\texport async function openChanges(\n\t\t\tfile: string | GitFile,\n\t\t\tcommit: GitLogCommit,\n\t\t\toptions?: TextDocumentShowOptions,\n\t\t): Promise<void>;\n\t\texport async function openChanges(\n\t\t\tfile: GitFile,\n\t\t\trefs: { repoPath: string; ref1: string; ref2: string },\n\t\t\toptions?: TextDocumentShowOptions,\n\t\t): Promise<void>;\n\t\texport async function openChanges(\n\t\t\tfile: string | GitFile,\n\t\t\tcommitOrRefs: GitLogCommit | { repoPath: string; ref1: string; ref2: string },\n\t\t\toptions?: TextDocumentShowOptions,\n\t\t) {\n\t\t\tif (typeof file === 'string') {\n\t\t\t\tif (!GitLogCommit.is(commitOrRefs)) throw new Error('Invalid arguments');\n\n\t\t\t\tconst f = commitOrRefs.findFile(file);\n\t\t\t\tif (f == null) throw new Error('Invalid arguments');\n\n\t\t\t\tfile = f;\n\t\t\t}\n\n\t\t\tif (file.status === 'A') return;\n\n\t\t\tconst refs = GitLogCommit.is(commitOrRefs)\n\t\t\t\t? {\n\t\t\t\t\t\trepoPath: commitOrRefs.repoPath,\n\t\t\t\t\t\tref1:\n\t\t\t\t\t\t\tcommitOrRefs.previousSha != null ? commitOrRefs.previousSha : GitRevision.deletedOrMissing,\n\t\t\t\t\t\tref2: commitOrRefs.sha,\n\t\t\t\t  }\n\t\t\t\t: commitOrRefs;\n\n\t\t\toptions = { preserveFocus: true, preview: false, ...options };\n\n\t\t\tconst uri1 = GitUri.fromFile(file, refs.repoPath);\n\t\t\tconst uri2 =\n\t\t\t\tfile.status === 'R' || file.status === 'C'\n\t\t\t\t\t? GitUri.fromFile(file, refs.repoPath, refs.ref2, true)\n\t\t\t\t\t: uri1;\n\n\t\t\tvoid (await executeCommand<DiffWithCommandArgs>(Commands.DiffWith, {\n\t\t\t\trepoPath: refs.repoPath,\n\t\t\t\tlhs: { uri: uri1, sha: refs.ref1 },\n\t\t\t\trhs: { uri: uri2, sha: refs.ref2 },\n\t\t\t\tshowOptions: options,\n\t\t\t}));\n\t\t}\n\n\t\texport function openChangesWithDiffTool(\n\t\t\tfile: string | GitFile,\n\t\t\tcommit: GitLogCommit,\n\t\t\ttool?: string,\n\t\t): Promise<void>;\n\t\texport function openChangesWithDiffTool(\n\t\t\tfile: GitFile,\n\t\t\tref: { repoPath: string; ref: string },\n\t\t\ttool?: string,\n\t\t): Promise<void>;\n\t\texport async function openChangesWithDiffTool(\n\t\t\tfile: string | GitFile,\n\t\t\tcommitOrRef: GitLogCommit | { repoPath: string; ref: string },\n\t\t\ttool?: string,\n\t\t) {\n\t\t\tif (typeof file === 'string') {\n\t\t\t\tif (!GitLogCommit.is(commitOrRef)) throw new Error('Invalid arguments');\n\n\t\t\t\tconst f = commitOrRef.findFile(file);\n\t\t\t\tif (f == null) throw new Error('Invalid arguments');\n\n\t\t\t\tfile = f;\n\t\t\t}\n\n\t\t\treturn Container.git.openDiffTool(\n\t\t\t\tcommitOrRef.repoPath,\n\t\t\t\tGitUri.fromFile(file, file.repoPath ?? commitOrRef.repoPath),\n\t\t\t\t{\n\t\t\t\t\tref1: GitRevision.isUncommitted(commitOrRef.ref) ? '' : `${commitOrRef.ref}^`,\n\t\t\t\t\tref2: GitRevision.isUncommitted(commitOrRef.ref) ? '' : commitOrRef.ref,\n\t\t\t\t\tstaged: GitRevision.isUncommittedStaged(commitOrRef.ref) || file.indexStatus != null,\n\t\t\t\t\ttool: tool,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\texport async function openChangesWithWorking(\n\t\t\tfile: string | GitFile,\n\t\t\tcommit: GitLogCommit,\n\t\t\toptions?: TextDocumentShowOptions,\n\t\t): Promise<void>;\n\t\texport async function openChangesWithWorking(\n\t\t\tfile: GitFile,\n\t\t\tref: { repoPath: string; ref: string },\n\t\t\toptions?: TextDocumentShowOptions,\n\t\t): Promise<void>;\n\t\texport async function openChangesWithWorking(\n\t\t\tfile: string | GitFile,\n\t\t\tcommitOrRef: GitLogCommit | { repoPath: string; ref: string },\n\t\t\toptions?: TextDocumentShowOptions,\n\t\t) {\n\t\t\tif (typeof file === 'string') {\n\t\t\t\tif (!GitLogCommit.is(commitOrRef)) throw new Error('Invalid arguments');\n\n\t\t\t\tconst f = commitOrRef.files.find(f => f.fileName === file);\n\t\t\t\tif (f == null) throw new Error('Invalid arguments');\n\n\t\t\t\tfile = f;\n\t\t\t}\n\n\t\t\tif (file.status === 'D') return;\n\n\t\t\tlet ref;\n\t\t\tif (GitLogCommit.is(commitOrRef)) {\n\t\t\t\tref = {\n\t\t\t\t\trepoPath: commitOrRef.repoPath,\n\t\t\t\t\tref: commitOrRef.sha,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tref = commitOrRef;\n\t\t\t}\n\n\t\t\toptions = { preserveFocus: true, preview: false, ...options };\n\n\t\t\tvoid (await executeEditorCommand<DiffWithWorkingCommandArgs>(Commands.DiffWithWorking, undefined, {\n\t\t\t\turi: GitUri.fromFile(file, ref.repoPath, ref.ref),\n\t\t\t\tshowOptions: options,\n\t\t\t}));\n\t\t}\n\n\t\texport async function openDirectoryCompare(\n\t\t\trepoPath: string,\n\t\t\tref: string,\n\t\t\tref2: string | undefined,\n\t\t\ttool?: string,\n\t\t): Promise<void> {\n\t\t\treturn Container.git.openDirectoryCompare(repoPath, ref, ref2, tool);\n\t\t}\n\n\t\texport async function openDirectoryCompareWithPrevious(\n\t\t\tref: { repoPath: string; ref: string } | GitLogCommit,\n\t\t): Promise<void> {\n\t\t\treturn openDirectoryCompare(ref.repoPath, ref.ref, `${ref.ref}^`);\n\t\t}\n\n\t\texport async function openDirectoryCompareWithWorking(\n\t\t\tref: { repoPath: string; ref: string } | GitLogCommit,\n\t\t): Promise<void> {\n\t\t\treturn openDirectoryCompare(ref.repoPath, ref.ref, undefined);\n\t\t}\n\n\t\texport async function openFile(uri: Uri, options?: TextDocumentShowOptions): Promise<void>;\n\t\texport async function openFile(\n\t\t\tfile: string | GitFile,\n\t\t\tref: GitRevisionReference,\n\t\t\toptions?: TextDocumentShowOptions,\n\t\t): Promise<void>;\n\t\texport async function openFile(\n\t\t\tfileOrUri: string | GitFile | Uri,\n\t\t\trefOrOptions?: GitRevisionReference | TextDocumentShowOptions,\n\t\t\toptions?: TextDocumentShowOptions,\n\t\t) {\n\t\t\tlet uri;\n\t\t\tif (fileOrUri instanceof Uri) {\n\t\t\t\turi = fileOrUri;\n\t\t\t\toptions = refOrOptions as TextDocumentShowOptions;\n\t\t\t} else {\n\t\t\t\tconst ref = refOrOptions as GitRevisionReference;\n\t\t\t\turi = GitUri.fromFile(fileOrUri, ref.repoPath, ref.ref);\n\t\t\t}\n\n\t\t\toptions = { preserveFocus: true, preview: false, ...options };\n\n\t\t\tvoid (await executeEditorCommand<OpenWorkingFileCommandArgs>(Commands.OpenWorkingFile, undefined, {\n\t\t\t\turi: uri,\n\t\t\t\tshowOptions: options,\n\t\t\t}));\n\t\t}\n\n\t\texport async function openFileAtRevision(\n\t\t\trevisionUri: Uri,\n\t\t\toptions?: TextDocumentShowOptions & { annotationType?: FileAnnotationType; line?: number },\n\t\t): Promise<void>;\n\t\texport async function openFileAtRevision(\n\t\t\tfile: string | GitFile,\n\t\t\tcommit: GitLogCommit,\n\t\t\toptions?: TextDocumentShowOptions & { annotationType?: FileAnnotationType; line?: number },\n\t\t): Promise<void>;\n\t\texport async function openFileAtRevision(\n\t\t\tfileOrRevisionUri: string | GitFile | Uri,\n\t\t\tcommitOrOptions?: GitLogCommit | TextDocumentShowOptions,\n\t\t\toptions?: TextDocumentShowOptions & { annotationType?: FileAnnotationType; line?: number },\n\t\t): Promise<void> {\n\t\t\tlet uri;\n\t\t\tif (fileOrRevisionUri instanceof Uri) {\n\t\t\t\tif (GitLogCommit.is(commitOrOptions)) throw new Error('Invalid arguments');\n\n\t\t\t\turi = fileOrRevisionUri;\n\t\t\t\toptions = commitOrOptions;\n\t\t\t} else {\n\t\t\t\tif (!GitLogCommit.is(commitOrOptions)) throw new Error('Invalid arguments');\n\n\t\t\t\tconst commit = commitOrOptions;\n\n\t\t\t\tlet file;\n\t\t\t\tif (typeof fileOrRevisionUri === 'string') {\n\t\t\t\t\tconst f = commit.findFile(fileOrRevisionUri);\n\t\t\t\t\tif (f == null) throw new Error('Invalid arguments');\n\n\t\t\t\t\tfile = f;\n\t\t\t\t} else {\n\t\t\t\t\tfile = fileOrRevisionUri;\n\t\t\t\t}\n\n\t\t\t\turi = GitUri.toRevisionUri(\n\t\t\t\t\tfile.status === 'D' ? commit.previousFileSha : commit.sha,\n\t\t\t\t\tfile,\n\t\t\t\t\tcommit.repoPath,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tconst { annotationType, line, ...opts }: Exclude<typeof options, undefined> = {\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpreview: false,\n\t\t\t\t...options,\n\t\t\t};\n\n\t\t\tif (line != null && line !== 0) {\n\t\t\t\topts.selection = new Range(line, 0, line, 0);\n\t\t\t}\n\n\t\t\tconst editor = await findOrOpenEditor(uri, opts);\n\t\t\tif (annotationType != null && editor != null) {\n\t\t\t\tvoid (await Container.fileAnnotations.show(editor, annotationType, { selection: { line: line } }));\n\t\t\t}\n\t\t}\n\n\t\texport async function openFiles(commit: GitLogCommit): Promise<void>;\n\t\texport async function openFiles(files: GitFile[], repoPath: string, ref: string): Promise<void>;\n\t\texport async function openFiles(\n\t\t\tcommitOrFiles: GitLogCommit | GitFile[],\n\t\t\trepoPath?: string,\n\t\t\tref?: string,\n\t\t): Promise<void> {\n\t\t\tlet files;\n\t\t\tif (GitLogCommit.is(commitOrFiles)) {\n\t\t\t\tfiles = commitOrFiles.files;\n\t\t\t\trepoPath = commitOrFiles.repoPath;\n\t\t\t\tref = commitOrFiles.sha;\n\t\t\t} else {\n\t\t\t\tfiles = commitOrFiles;\n\t\t\t}\n\n\t\t\tif (files.length > 10) {\n\t\t\t\tconst result = await window.showWarningMessage(\n\t\t\t\t\t`Are your sure you want to open all ${files.length} files?`,\n\t\t\t\t\t{ title: 'Yes' },\n\t\t\t\t\t{ title: 'No', isCloseAffordance: true },\n\t\t\t\t);\n\t\t\t\tif (result == null || result.title === 'No') return;\n\t\t\t}\n\n\t\t\tconst uris: Uri[] = (\n\t\t\t\tawait Promise.all(\n\t\t\t\t\tfiles.map(file => Container.git.getWorkingUri(repoPath!, GitUri.fromFile(file, repoPath!, ref))),\n\t\t\t\t)\n\t\t\t).filter(<T>(u?: T): u is T => Boolean(u));\n\t\t\tfindOrOpenEditors(uris);\n\t\t}\n\n\t\texport async function openFilesAtRevision(commit: GitLogCommit): Promise<void>;\n\t\texport async function openFilesAtRevision(\n\t\t\tfiles: GitFile[],\n\t\t\trepoPath: string,\n\t\t\tref1: string,\n\t\t\tref2: string,\n\t\t): Promise<void>;\n\t\texport async function openFilesAtRevision(\n\t\t\tcommitOrFiles: GitLogCommit | GitFile[],\n\t\t\trepoPath?: string,\n\t\t\tref1?: string,\n\t\t\tref2?: string,\n\t\t): Promise<void> {\n\t\t\tlet files;\n\t\t\tif (GitLogCommit.is(commitOrFiles)) {\n\t\t\t\tfiles = commitOrFiles.files;\n\t\t\t\trepoPath = commitOrFiles.repoPath;\n\t\t\t\tref1 = commitOrFiles.sha;\n\t\t\t\tref2 = commitOrFiles.previousFileSha;\n\t\t\t} else {\n\t\t\t\tfiles = commitOrFiles;\n\t\t\t}\n\n\t\t\tif (files.length > 10) {\n\t\t\t\tconst result = await window.showWarningMessage(\n\t\t\t\t\t`Are your sure you want to open all ${files.length} file revisions?`,\n\t\t\t\t\t{ title: 'Yes' },\n\t\t\t\t\t{ title: 'No', isCloseAffordance: true },\n\t\t\t\t);\n\t\t\t\tif (result == null || result.title === 'No') return;\n\t\t\t}\n\n\t\t\tfindOrOpenEditors(\n\t\t\t\tfiles.map(file => GitUri.toRevisionUri(file.status === 'D' ? ref2! : ref1!, file, repoPath!)),\n\t\t\t);\n\t\t}\n\n\t\texport async function restoreFile(file: string | GitFile, ref: GitRevisionReference) {\n\t\t\tvoid (await Container.git.checkout(ref.repoPath, ref.ref, {\n\t\t\t\tfileName: typeof file === 'string' ? file : file.fileName,\n\t\t\t}));\n\t\t}\n\n\t\texport async function reveal(\n\t\t\tcommit: GitRevisionReference,\n\t\t\toptions?: {\n\t\t\t\tselect?: boolean;\n\t\t\t\tfocus?: boolean;\n\t\t\t\texpand?: boolean | number;\n\t\t\t},\n\t\t) {\n\t\t\tif (\n\t\t\t\t!configuration.get('views.commits.reveal') ||\n\t\t\t\t(Container.repositoriesView.visible && !Container.commitsView.visible)\n\t\t\t) {\n\t\t\t\treturn Container.repositoriesView.revealCommit(commit, options);\n\t\t\t}\n\n\t\t\t// TODO@eamodio stop duplicate notifications\n\n\t\t\tlet node = await Container.commitsView.revealCommit(commit, options);\n\t\t\tif (node != null) return node;\n\n\t\t\tnode = await Container.branchesView.revealCommit(commit, options);\n\t\t\tif (node != null) return node;\n\n\t\t\tnode = await Container.remotesView.revealCommit(commit, options);\n\t\t\tif (node != null) return node;\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\texport namespace Contributor {\n\t\texport function addAuthors(repo?: string | Repository, contributors?: GitContributor | GitContributor[]) {\n\t\t\treturn executeGitCommand({\n\t\t\t\tcommand: 'co-authors',\n\t\t\t\tstate: { repo: repo, contributors: contributors },\n\t\t\t});\n\t\t}\n\t}\n\n\texport namespace Tag {\n\t\texport function create(repo?: string | Repository, ref?: GitReference, name?: string) {\n\t\t\treturn executeGitCommand({\n\t\t\t\tcommand: 'tag',\n\t\t\t\tstate: {\n\t\t\t\t\tsubcommand: 'create',\n\t\t\t\t\trepo: repo,\n\t\t\t\t\treference: ref,\n\t\t\t\t\tname: name,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\texport function remove(repo?: string | Repository, refs?: GitTagReference | GitTagReference[]) {\n\t\t\treturn executeGitCommand({\n\t\t\t\tcommand: 'tag',\n\t\t\t\tstate: {\n\t\t\t\t\tsubcommand: 'delete',\n\t\t\t\t\trepo: repo,\n\t\t\t\t\treferences: refs,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\texport async function reveal(\n\t\t\ttag: GitTagReference,\n\t\t\toptions?: {\n\t\t\t\tselect?: boolean;\n\t\t\t\tfocus?: boolean;\n\t\t\t\texpand?: boolean | number;\n\t\t\t},\n\t\t) {\n\t\t\tif (\n\t\t\t\t!configuration.get('views.tags.reveal') ||\n\t\t\t\t(Container.repositoriesView.visible && !Container.tagsView.visible)\n\t\t\t) {\n\t\t\t\treturn Container.repositoriesView.revealTag(tag, options);\n\t\t\t}\n\n\t\t\tconst node = await Container.tagsView.revealTag(tag, options);\n\t\t\treturn node;\n\t\t}\n\t}\n\n\texport namespace Remote {\n\t\texport async function add(repo?: string | Repository) {\n\t\t\tif (repo == null) {\n\t\t\t\trepo = Container.git.getHighlanderRepoPath();\n\n\t\t\t\tif (repo == null) {\n\t\t\t\t\tconst pick = await RepositoryPicker.show(undefined, 'Choose a repository to add a remote to');\n\t\t\t\t\trepo = pick?.item;\n\t\t\t\t\tif (repo == null) return undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst name = await window.showInputBox({\n\t\t\t\tprompt: 'Please provide a name for the remote',\n\t\t\t\tplaceHolder: 'Remote name',\n\t\t\t\tvalue: undefined,\n\t\t\t\tignoreFocusOut: true,\n\t\t\t});\n\t\t\tif (name == null || name.length === 0) return undefined;\n\n\t\t\tconst url = await window.showInputBox({\n\t\t\t\tprompt: 'Please provide the repository url for the remote',\n\t\t\t\tplaceHolder: 'Remote repository url',\n\t\t\t\tvalue: undefined,\n\t\t\t\tignoreFocusOut: true,\n\t\t\t});\n\t\t\tif (url == null || url.length === 0) return undefined;\n\n\t\t\trepo = await ensureRepo(repo);\n\t\t\tvoid (await Container.git.addRemote(repo.path, name, url));\n\t\t\tvoid (await repo.fetch({ remote: name }));\n\n\t\t\treturn name;\n\t\t}\n\n\t\texport async function fetch(repo: string | Repository, remote: string) {\n\t\t\tif (typeof repo === 'string') {\n\t\t\t\tconst r = await Container.git.getRepository(repo);\n\t\t\t\tif (r == null) return;\n\n\t\t\t\trepo = r;\n\t\t\t}\n\n\t\t\tvoid (await repo.fetch({ remote: remote }));\n\t\t}\n\n\t\texport async function prune(repo: string | Repository, remote: string) {\n\t\t\tvoid (await Container.git.pruneRemote(typeof repo === 'string' ? repo : repo.path, remote));\n\t\t}\n\n\t\texport async function reveal(\n\t\t\tremote: GitRemote,\n\t\t\toptions?: {\n\t\t\t\tselect?: boolean;\n\t\t\t\tfocus?: boolean;\n\t\t\t\texpand?: boolean | number;\n\t\t\t},\n\t\t) {\n\t\t\t// if (\n\t\t\t// \tconfiguration.get('views.repositories.enabled') &&\n\t\t\t// \t(Container.repositoriesView.visible || !Container.remotesView.visible)\n\t\t\t// ) {\n\t\t\t// \treturn Container.repositoriesView.revealRemote(remote, options);\n\t\t\t// }\n\n\t\t\tconst node = await Container.remotesView.revealRemote(remote, options);\n\t\t\treturn node;\n\t\t}\n\t}\n\n\texport namespace Stash {\n\t\texport function apply(repo?: string | Repository, ref?: GitStashReference) {\n\t\t\treturn executeGitCommand({\n\t\t\t\tcommand: 'stash',\n\t\t\t\tstate: { subcommand: 'apply', repo: repo, reference: ref },\n\t\t\t});\n\t\t}\n\n\t\texport function drop(repo?: string | Repository, ref?: GitStashReference) {\n\t\t\treturn executeGitCommand({\n\t\t\t\tcommand: 'stash',\n\t\t\t\tstate: { subcommand: 'drop', repo: repo, reference: ref },\n\t\t\t});\n\t\t}\n\n\t\texport function pop(repo?: string | Repository, ref?: GitStashReference) {\n\t\t\treturn executeGitCommand({\n\t\t\t\tcommand: 'stash',\n\t\t\t\tstate: { subcommand: 'pop', repo: repo, reference: ref },\n\t\t\t});\n\t\t}\n\n\t\texport function push(repo?: string | Repository, uris?: Uri[], message?: string, keepStaged: boolean = false) {\n\t\t\treturn executeGitCommand({\n\t\t\t\tcommand: 'stash',\n\t\t\t\tstate: {\n\t\t\t\t\tsubcommand: 'push',\n\t\t\t\t\trepo: repo,\n\t\t\t\t\turis: uris,\n\t\t\t\t\tmessage: message,\n\t\t\t\t\tflags: keepStaged ? ['--keep-index'] : undefined,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\texport async function reveal(\n\t\t\tstash: GitStashReference,\n\t\t\toptions?: {\n\t\t\t\tselect?: boolean;\n\t\t\t\tfocus?: boolean;\n\t\t\t\texpand?: boolean | number;\n\t\t\t},\n\t\t) {\n\t\t\tif (\n\t\t\t\t!configuration.get('views.stashes.reveal') ||\n\t\t\t\t(Container.repositoriesView.visible && !Container.stashesView.visible)\n\t\t\t) {\n\t\t\t\treturn Container.repositoriesView.revealStash(stash, options);\n\t\t\t}\n\n\t\t\tconst node = await Container.stashesView.revealStash(stash, options);\n\t\t\treturn node;\n\t\t}\n\t}\n}\n","'use strict';\nimport { QuickInput, QuickInputButton, ThemeIcon, Uri } from 'vscode';\nimport { Container } from '../container';\n\nexport class ToggleQuickInputButton implements QuickInputButton {\n\tconstructor(\n\t\tprivate readonly state:\n\t\t\t| {\n\t\t\t\t\ton: { icon: string | { light: Uri; dark: Uri } | ThemeIcon; tooltip: string };\n\t\t\t\t\toff: { icon: string | { light: Uri; dark: Uri } | ThemeIcon; tooltip: string };\n\t\t\t  }\n\t\t\t| (() => {\n\t\t\t\t\ton: { icon: string | { light: Uri; dark: Uri } | ThemeIcon; tooltip: string };\n\t\t\t\t\toff: { icon: string | { light: Uri; dark: Uri } | ThemeIcon; tooltip: string };\n\t\t\t  }),\n\t\tprivate _on = false,\n\t) {}\n\n\tget iconPath(): { light: Uri; dark: Uri } | ThemeIcon {\n\t\tconst icon = this.getToggledState().icon;\n\t\treturn typeof icon === 'string'\n\t\t\t? {\n\t\t\t\t\tdark: Uri.file(Container.context.asAbsolutePath(`images/dark/${icon}.svg`)),\n\t\t\t\t\tlight: Uri.file(Container.context.asAbsolutePath(`images/light/${icon}.svg`)),\n\t\t\t  }\n\t\t\t: icon;\n\t}\n\n\tget tooltip(): string {\n\t\treturn this.getToggledState().tooltip;\n\t}\n\n\tget on() {\n\t\treturn this._on;\n\t}\n\tset on(value: boolean) {\n\t\tthis._on = value;\n\t}\n\n\tonDidClick?(quickInput: QuickInput): boolean | void | Promise<boolean | void>;\n\n\tprivate getState() {\n\t\treturn typeof this.state === 'function' ? this.state() : this.state;\n\t}\n\n\tprivate getToggledState() {\n\t\treturn this.on ? this.getState().on : this.getState().off;\n\t}\n}\n\nexport class SelectableQuickInputButton extends ToggleQuickInputButton {\n\tconstructor(tooltip: string, icon: { off: string | ThemeIcon; on: string | ThemeIcon }, selected: boolean = false) {\n\t\tsuper({ off: { tooltip: tooltip, icon: icon.off }, on: { tooltip: tooltip, icon: icon.on } }, selected);\n\t}\n}\n\nexport namespace QuickCommandButtons {\n\texport const Fetch: QuickInputButton = {\n\t\ticonPath: new ThemeIcon('sync'),\n\t\ttooltip: 'Fetch',\n\t};\n\n\texport const LoadMore: QuickInputButton = {\n\t\ticonPath: new ThemeIcon('refresh'),\n\t\ttooltip: 'Load More',\n\t};\n\n\texport const MatchCaseToggle = class extends SelectableQuickInputButton {\n\t\tconstructor(on = false) {\n\t\t\tsuper('Match Case', { off: 'icon-match-case', on: 'icon-match-case-selected' }, on);\n\t\t}\n\t};\n\n\texport const MatchAllToggle = class extends SelectableQuickInputButton {\n\t\tconstructor(on = false) {\n\t\t\tsuper('Match All', { off: 'icon-match-all', on: 'icon-match-all-selected' }, on);\n\t\t}\n\t};\n\n\texport const MatchRegexToggle = class extends SelectableQuickInputButton {\n\t\tconstructor(on = false) {\n\t\t\tsuper('Match using Regular Expressions', { off: 'icon-match-regex', on: 'icon-match-regex-selected' }, on);\n\t\t}\n\t};\n\n\texport const PickCommitToggle = class extends ToggleQuickInputButton {\n\t\tconstructor(on = false, context: { showTags: boolean }, onDidClick?: (quickInput: QuickInput) => void) {\n\t\t\tsuper(\n\t\t\t\t() => ({\n\t\t\t\t\ton: { tooltip: 'Choose a Specific Commit', icon: new ThemeIcon('git-commit') },\n\t\t\t\t\toff: {\n\t\t\t\t\t\ttooltip: `Choose a Branch${context.showTags ? ' or Tag' : ''}`,\n\t\t\t\t\t\ticon: new ThemeIcon('git-branch'),\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\ton,\n\t\t\t);\n\n\t\t\tthis.onDidClick = onDidClick;\n\t\t}\n\t};\n\n\texport const RevealInSideBar: QuickInputButton = {\n\t\ticonPath: new ThemeIcon('eye'),\n\t\ttooltip: 'Reveal in Side Bar',\n\t};\n\n\texport const SearchInSideBar: QuickInputButton = {\n\t\ticonPath: new ThemeIcon('search'),\n\t\ttooltip: 'Search in Side Bar',\n\t};\n\n\texport const ShowResultsInSideBar: QuickInputButton = {\n\t\ticonPath: new ThemeIcon('link-external'),\n\t\ttooltip: 'Show Results in Side Bar',\n\t};\n\n\texport const ShowTagsToggle = class extends SelectableQuickInputButton {\n\t\tconstructor(on = false) {\n\t\t\tsuper('Show Tags', { off: new ThemeIcon('tag'), on: 'icon-tag-selected' }, on);\n\t\t}\n\t};\n\n\texport const WillConfirmForced: QuickInputButton = {\n\t\ticonPath: new ThemeIcon('check'),\n\t\ttooltip: 'Will always confirm',\n\t};\n\n\texport const WillConfirmToggle = class extends ToggleQuickInputButton {\n\t\tconstructor(on = false, onDidClick?: (quickInput: QuickInput) => void) {\n\t\t\tsuper(\n\t\t\t\t() => ({\n\t\t\t\t\ton: {\n\t\t\t\t\t\ttooltip: 'Will confirm',\n\t\t\t\t\t\ticon: {\n\t\t\t\t\t\t\tdark: Uri.file(Container.context.asAbsolutePath('images/dark/icon-check.svg')),\n\t\t\t\t\t\t\tlight: Uri.file(Container.context.asAbsolutePath('images/light/icon-check.svg')),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\toff: {\n\t\t\t\t\t\ttooltip: 'Skips confirm',\n\t\t\t\t\t\ticon: {\n\t\t\t\t\t\t\tdark: Uri.file(Container.context.asAbsolutePath('images/dark/icon-no-check.svg')),\n\t\t\t\t\t\t\tlight: Uri.file(Container.context.asAbsolutePath('images/light/icon-no-check.svg')),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\ton,\n\t\t\t);\n\n\t\t\tthis.onDidClick = onDidClick;\n\t\t}\n\t};\n}\n","'use strict';\nimport { QuickInputButton, QuickPick } from 'vscode';\nimport { BranchSorting, configuration, TagSorting } from '../configuration';\nimport { GlyphChars, quickPickTitleMaxChars } from '../constants';\nimport { Container } from '../container';\nimport {\n\tBranchSortOptions,\n\tGitBranch,\n\tGitBranchReference,\n\tGitContributor,\n\tGitLog,\n\tGitLogCommit,\n\tGitReference,\n\tGitRemote,\n\tGitRevision,\n\tGitRevisionReference,\n\tGitStash,\n\tGitStashCommit,\n\tGitStatus,\n\tGitTag,\n\tGitTagReference,\n\tRemoteProvider,\n\tRemoteResourceType,\n\tRepository,\n\tSearchPattern,\n\tTagSortOptions,\n} from '../git/git';\nimport { GitService } from '../git/gitService';\nimport { GitUri } from '../git/gitUri';\nimport {\n\tBranchQuickPickItem,\n\tCommandQuickPickItem,\n\tCommitApplyFileChangesCommandQuickPickItem,\n\tCommitBrowseRepositoryFromHereCommandQuickPickItem,\n\tCommitCompareWithHEADCommandQuickPickItem,\n\tCommitCompareWithWorkingCommandQuickPickItem,\n\tCommitCopyIdQuickPickItem,\n\tCommitCopyMessageQuickPickItem,\n\tCommitFileQuickPickItem,\n\tCommitFilesQuickPickItem,\n\tCommitOpenAllChangesCommandQuickPickItem,\n\tCommitOpenAllChangesWithDiffToolCommandQuickPickItem,\n\tCommitOpenAllChangesWithWorkingCommandQuickPickItem,\n\tCommitOpenChangesCommandQuickPickItem,\n\tCommitOpenChangesWithDiffToolCommandQuickPickItem,\n\tCommitOpenChangesWithWorkingCommandQuickPickItem,\n\tCommitOpenDirectoryCompareCommandQuickPickItem,\n\tCommitOpenDirectoryCompareWithWorkingCommandQuickPickItem,\n\tCommitOpenFileCommandQuickPickItem,\n\tCommitOpenFilesCommandQuickPickItem,\n\tCommitOpenRevisionCommandQuickPickItem,\n\tCommitOpenRevisionsCommandQuickPickItem,\n\tCommitQuickPickItem,\n\tCommitRestoreFileChangesCommandQuickPickItem,\n\tContributorQuickPickItem,\n\tCopyRemoteResourceCommandQuickPickItem,\n\tDirective,\n\tDirectiveQuickPickItem,\n\tGitCommandQuickPickItem,\n\tOpenChangedFilesCommandQuickPickItem,\n\tOpenRemoteResourceCommandQuickPickItem,\n\tReferencesQuickPickItem,\n\tRefQuickPickItem,\n\tRepositoryQuickPickItem,\n\tRevealInSideBarQuickPickItem,\n\tSearchForCommitQuickPickItem,\n\tTagQuickPickItem,\n} from '../quickpicks';\nimport { Arrays, Iterables, Strings } from '../system';\nimport { Commands } from './common';\nimport { GitActions } from './gitCommands.actions';\nimport {\n\tAsyncStepResultGenerator,\n\tPartialStepState,\n\tQuickCommand,\n\tQuickCommandButtons,\n\tQuickPickStep,\n\tStepResult,\n\tStepResultGenerator,\n\tStepSelection,\n\tStepState,\n} from './quickCommand';\n\nexport function appendReposToTitle<\n\tState extends { repo: Repository } | { repos: Repository[] },\n\tContext extends { repos: Repository[] },\n>(title: string, state: State, context: Context, additionalContext?: string) {\n\tif (context.repos.length === 1) {\n\t\treturn `${title}${Strings.truncate(additionalContext ?? '', quickPickTitleMaxChars - title.length)}`;\n\t}\n\n\tlet repoContext;\n\tif ((state as { repo: Repository }).repo != null) {\n\t\trepoContext = `${additionalContext ?? ''}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t(state as { repo: Repository }).repo.formattedName\n\t\t}`;\n\t} else if ((state as { repos: Repository[] }).repos.length === 1) {\n\t\trepoContext = `${additionalContext ?? ''}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t(state as { repos: Repository[] }).repos[0].formattedName\n\t\t}`;\n\t} else {\n\t\trepoContext = `${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t(state as { repos: Repository[] }).repos.length\n\t\t} repositories`;\n\t}\n\n\treturn `${title}${Strings.truncate(repoContext, quickPickTitleMaxChars - title.length)}`;\n}\n\nexport async function getBranches(\n\trepos: Repository | Repository[],\n\toptions: { filter?: (b: GitBranch) => boolean; picked?: string | string[]; sort?: BranchSortOptions } = {},\n): Promise<BranchQuickPickItem[]> {\n\treturn getBranchesAndOrTags(repos, ['branches'], {\n\t\tfilter: options?.filter != null ? { branches: options.filter } : undefined,\n\t\tpicked: options?.picked,\n\t\tsort: options?.sort != null ? { branches: options.sort } : true,\n\t}) as Promise<BranchQuickPickItem[]>;\n}\n\nexport async function getTags(\n\trepos: Repository | Repository[],\n\toptions?: { filter?: (t: GitTag) => boolean; picked?: string | string[]; sort?: TagSortOptions },\n): Promise<TagQuickPickItem[]> {\n\treturn getBranchesAndOrTags(repos, ['tags'], {\n\t\tfilter: options?.filter != null ? { tags: options.filter } : undefined,\n\t\tpicked: options?.picked,\n\t\tsort: options?.sort != null ? { tags: options.sort } : true,\n\t}) as Promise<TagQuickPickItem[]>;\n}\n\nexport async function getBranchesAndOrTags(\n\trepos: Repository | Repository[],\n\tinclude: ('tags' | 'branches')[],\n\t{\n\t\tfilter,\n\t\tpicked,\n\t\tsort,\n\t}: {\n\t\tfilter?: { branches?: (b: GitBranch) => boolean; tags?: (t: GitTag) => boolean };\n\t\tpicked?: string | string[];\n\t\tsort?: boolean | { branches?: BranchSortOptions; tags?: TagSortOptions };\n\t} = {},\n): Promise<(BranchQuickPickItem | TagQuickPickItem)[]> {\n\tlet branches: GitBranch[] | undefined;\n\tlet tags: GitTag[] | undefined;\n\n\tlet singleRepo = false;\n\tif (repos instanceof Repository || repos.length === 1) {\n\t\tsingleRepo = true;\n\t\tconst repo = repos instanceof Repository ? repos : repos[0];\n\n\t\t[branches, tags] = await Promise.all<GitBranch[] | undefined, GitTag[] | undefined>([\n\t\t\tinclude.includes('branches')\n\t\t\t\t? repo.getBranches({\n\t\t\t\t\t\tfilter: filter?.branches,\n\t\t\t\t\t\tsort: typeof sort === 'boolean' ? sort : sort?.branches,\n\t\t\t\t  })\n\t\t\t\t: undefined,\n\t\t\tinclude.includes('tags') ? repo.getTags({ filter: filter?.tags, sort: true }) : undefined,\n\t\t]);\n\t} else {\n\t\tconst [branchesByRepo, tagsByRepo] = await Promise.all<GitBranch[][] | undefined, GitTag[][] | undefined>([\n\t\t\tinclude.includes('branches')\n\t\t\t\t? Promise.all(\n\t\t\t\t\t\trepos.map(r =>\n\t\t\t\t\t\t\tr.getBranches({\n\t\t\t\t\t\t\t\tfilter: filter?.branches,\n\t\t\t\t\t\t\t\tsort: typeof sort === 'boolean' ? sort : sort?.branches,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t),\n\t\t\t\t  )\n\t\t\t\t: undefined,\n\t\t\tinclude.includes('tags')\n\t\t\t\t? Promise.all(\n\t\t\t\t\t\trepos.map(r =>\n\t\t\t\t\t\t\tr.getTags({ filter: filter?.tags, sort: typeof sort === 'boolean' ? sort : sort?.tags }),\n\t\t\t\t\t\t),\n\t\t\t\t  )\n\t\t\t\t: undefined,\n\t\t]);\n\n\t\tif (include.includes('branches')) {\n\t\t\tbranches = GitBranch.sort(\n\t\t\t\tArrays.intersection(...branchesByRepo!, ((b1: GitBranch, b2: GitBranch) => b1.name === b2.name) as any),\n\t\t\t);\n\t\t}\n\n\t\tif (include.includes('tags')) {\n\t\t\ttags = GitTag.sort(\n\t\t\t\tArrays.intersection(...tagsByRepo!, ((t1: GitTag, t2: GitTag) => t1.name === t2.name) as any),\n\t\t\t);\n\t\t}\n\t}\n\n\tif (include.includes('branches') && !include.includes('tags')) {\n\t\treturn Promise.all(\n\t\t\tbranches!.map(b =>\n\t\t\t\tBranchQuickPickItem.create(\n\t\t\t\t\tb,\n\t\t\t\t\tpicked != null && (typeof picked === 'string' ? b.ref === picked : picked.includes(b.ref)),\n\t\t\t\t\t{\n\t\t\t\t\t\tcurrent: singleRepo ? 'checkmark' : false,\n\t\t\t\t\t\tref: singleRepo,\n\t\t\t\t\t\tstatus: singleRepo,\n\t\t\t\t\t\ttype: 'remote',\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t),\n\t\t);\n\t}\n\n\tif (include.includes('tags') && !include.includes('branches')) {\n\t\treturn Promise.all(\n\t\t\ttags!.map(t =>\n\t\t\t\tTagQuickPickItem.create(\n\t\t\t\t\tt,\n\t\t\t\t\tpicked != null && (typeof picked === 'string' ? t.ref === picked : picked.includes(t.ref)),\n\t\t\t\t\t{\n\t\t\t\t\t\tmessage: false, //singleRepo,\n\t\t\t\t\t\tref: singleRepo,\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t),\n\t\t);\n\t}\n\n\treturn Promise.all<BranchQuickPickItem | TagQuickPickItem>([\n\t\t...branches!\n\t\t\t.filter(b => !b.remote)\n\t\t\t.map(b =>\n\t\t\t\tBranchQuickPickItem.create(\n\t\t\t\t\tb,\n\t\t\t\t\tpicked != null && (typeof picked === 'string' ? b.ref === picked : picked.includes(b.ref)),\n\t\t\t\t\t{\n\t\t\t\t\t\tcurrent: singleRepo ? 'checkmark' : false,\n\t\t\t\t\t\tref: singleRepo,\n\t\t\t\t\t\tstatus: singleRepo,\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t),\n\t\t...tags!.map(t =>\n\t\t\tTagQuickPickItem.create(\n\t\t\t\tt,\n\t\t\t\tpicked != null && (typeof picked === 'string' ? t.ref === picked : picked.includes(t.ref)),\n\t\t\t\t{\n\t\t\t\t\tmessage: false, //singleRepo,\n\t\t\t\t\tref: singleRepo,\n\t\t\t\t\ttype: true,\n\t\t\t\t},\n\t\t\t),\n\t\t),\n\t\t...branches!\n\t\t\t.filter(b => b.remote)\n\t\t\t.map(b =>\n\t\t\t\tBranchQuickPickItem.create(\n\t\t\t\t\tb,\n\t\t\t\t\tpicked != null && (typeof picked === 'string' ? b.ref === picked : picked.includes(b.ref)),\n\t\t\t\t\t{\n\t\t\t\t\t\tcurrent: singleRepo ? 'checkmark' : false,\n\t\t\t\t\t\tref: singleRepo,\n\t\t\t\t\t\tstatus: singleRepo,\n\t\t\t\t\t\ttype: 'remote',\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t),\n\t]);\n}\n\nexport function getValidateGitReferenceFn(repos: Repository | Repository[], options?: { ranges?: boolean }) {\n\treturn async (quickpick: QuickPick<any>, value: string) => {\n\t\tlet inRefMode = false;\n\t\tif (value.startsWith('#')) {\n\t\t\tinRefMode = true;\n\t\t\tvalue = value.substring(1);\n\t\t}\n\n\t\tif (Array.isArray(repos)) {\n\t\t\tif (repos.length !== 1) return false;\n\n\t\t\trepos = repos[0];\n\t\t}\n\n\t\tif (inRefMode && options?.ranges && GitRevision.isRange(value)) {\n\t\t\tquickpick.items = [\n\t\t\t\tRefQuickPickItem.create(value, repos.path, true, { alwaysShow: true, ref: false, icon: false }),\n\t\t\t];\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!(await Container.git.validateReference(repos.path, value))) {\n\t\t\tif (inRefMode) {\n\t\t\t\tquickpick.items = [\n\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Back, true, {\n\t\t\t\t\t\tlabel: 'Enter a reference or commit SHA',\n\t\t\t\t\t}),\n\t\t\t\t];\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!inRefMode) {\n\t\t\tif (\n\t\t\t\tawait Container.git.hasBranchesAndOrTags(repos.path, {\n\t\t\t\t\tfilter: { branches: b => b.name.includes(value), tags: t => t.name.includes(value) },\n\t\t\t\t})\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tconst commit = await Container.git.getCommit(repos.path, value);\n\t\tquickpick.items = [CommitQuickPickItem.create(commit!, true, { alwaysShow: true, compact: true, icon: true })];\n\t\treturn true;\n\t};\n}\n\nexport async function* inputBranchNameStep<\n\tState extends PartialStepState & ({ repo: Repository } | { repos: Repository[] }),\n\tContext extends { repos: Repository[]; showTags?: boolean; title: string },\n>(\n\tstate: State,\n\tcontext: Context,\n\toptions: { placeholder: string; titleContext?: string; value?: string },\n): AsyncStepResultGenerator<string> {\n\tconst step = QuickCommand.createInputStep({\n\t\ttitle: appendReposToTitle(`${context.title}${options.titleContext ?? ''}`, state, context),\n\t\tplaceholder: options.placeholder,\n\t\tvalue: options.value,\n\t\tprompt: 'Enter branch name',\n\t\tvalidate: async (value: string | undefined): Promise<[boolean, string | undefined]> => {\n\t\t\tif (value == null) return [false, undefined];\n\n\t\t\tvalue = value.trim();\n\t\t\tif (value.length === 0) return [false, 'Please enter a valid branch name'];\n\n\t\t\tconst valid = await Container.git.validateBranchOrTagName(value);\n\t\t\treturn [valid, valid ? undefined : `'${value}' isn't a valid branch name`];\n\t\t},\n\t});\n\n\tconst value: StepSelection<typeof step> = yield step;\n\tif (\n\t\t!QuickCommand.canStepContinue(step, state, value) ||\n\t\t!(await QuickCommand.canInputStepContinue(step, state, value))\n\t) {\n\t\treturn StepResult.Break;\n\t}\n\n\treturn value;\n}\n\nexport async function* inputTagNameStep<\n\tState extends PartialStepState & ({ repo: Repository } | { repos: Repository[] }),\n\tContext extends { repos: Repository[]; showTags?: boolean; title: string },\n>(\n\tstate: State,\n\tcontext: Context,\n\toptions: { placeholder: string; titleContext?: string; value?: string },\n): AsyncStepResultGenerator<string> {\n\tconst step = QuickCommand.createInputStep({\n\t\ttitle: appendReposToTitle(`${context.title}${options.titleContext ?? ''}`, state, context),\n\t\tplaceholder: options.placeholder,\n\t\tvalue: options.value,\n\t\tprompt: 'Enter tag name',\n\t\tvalidate: async (value: string | undefined): Promise<[boolean, string | undefined]> => {\n\t\t\tif (value == null) return [false, undefined];\n\n\t\t\tvalue = value.trim();\n\t\t\tif (value.length === 0) return [false, 'Please enter a valid tag name'];\n\n\t\t\tconst valid = await Container.git.validateBranchOrTagName(value);\n\t\t\treturn [valid, valid ? undefined : `'${value}' isn't a valid tag name`];\n\t\t},\n\t});\n\n\tconst value: StepSelection<typeof step> = yield step;\n\tif (\n\t\t!QuickCommand.canStepContinue(step, state, value) ||\n\t\t!(await QuickCommand.canInputStepContinue(step, state, value))\n\t) {\n\t\treturn StepResult.Break;\n\t}\n\n\treturn value;\n}\n\nexport async function* pickBranchStep<\n\tState extends PartialStepState & { repo: Repository },\n\tContext extends { repos: Repository[]; showTags?: boolean; title: string },\n>(\n\tstate: State,\n\tcontext: Context,\n\t{\n\t\tfilter,\n\t\tpicked,\n\t\tplaceholder,\n\t\ttitleContext,\n\t}: {\n\t\tfilter?: (b: GitBranch) => boolean;\n\t\tpicked?: string | string[];\n\t\tplaceholder: string;\n\t\ttitleContext?: string;\n\t},\n): AsyncStepResultGenerator<GitBranchReference> {\n\tconst branches = await getBranches(state.repo, {\n\t\tfilter: filter,\n\t\tpicked: picked,\n\t});\n\n\tconst step = QuickCommand.createPickStep<BranchQuickPickItem>({\n\t\ttitle: appendReposToTitle(`${context.title}${titleContext ?? ''}`, state, context),\n\t\tplaceholder: branches.length === 0 ? `No branches found in ${state.repo.formattedName}` : placeholder,\n\t\tmatchOnDetail: true,\n\t\titems:\n\t\t\tbranches.length === 0\n\t\t\t\t? [DirectiveQuickPickItem.create(Directive.Back, true), DirectiveQuickPickItem.create(Directive.Cancel)]\n\t\t\t\t: branches,\n\t\tadditionalButtons: [QuickCommandButtons.RevealInSideBar],\n\t\tonDidClickButton: (quickpick, button) => {\n\t\t\tif (button === QuickCommandButtons.RevealInSideBar) {\n\t\t\t\tif (quickpick.activeItems.length === 0) {\n\t\t\t\t\tvoid Container.repositoriesView.revealBranches(state.repo.path, {\n\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\texpand: true,\n\t\t\t\t\t});\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvoid GitActions.Branch.reveal(quickpick.activeItems[0].item, {\n\t\t\t\t\tselect: true,\n\t\t\t\t\texpand: true,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\tonDidPressKey: async quickpick => {\n\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\tawait GitActions.Branch.reveal(quickpick.activeItems[0].item, {\n\t\t\t\tselect: true,\n\t\t\t\tfocus: false,\n\t\t\t\texpand: true,\n\t\t\t});\n\t\t},\n\t});\n\tconst selection: StepSelection<typeof step> = yield step;\n\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n}\n\nexport async function* pickBranchesStep<\n\tState extends PartialStepState & { repo: Repository },\n\tContext extends { repos: Repository[]; showTags?: boolean; title: string },\n>(\n\tstate: State,\n\tcontext: Context,\n\t{\n\t\tfilter,\n\t\tpicked,\n\t\tplaceholder,\n\t\tsort,\n\t\ttitleContext,\n\t}: {\n\t\tfilter?: (b: GitBranch) => boolean;\n\t\tpicked?: string | string[];\n\t\tplaceholder: string;\n\t\tsort?: BranchSortOptions;\n\t\ttitleContext?: string;\n\t},\n): AsyncStepResultGenerator<GitBranchReference[]> {\n\tconst branches = await getBranches(state.repo, {\n\t\tfilter: filter,\n\t\tpicked: picked,\n\t\tsort: sort,\n\t});\n\n\tconst step = QuickCommand.createPickStep<BranchQuickPickItem>({\n\t\tmultiselect: branches.length !== 0,\n\t\ttitle: appendReposToTitle(`${context.title}${titleContext ?? ''}`, state, context),\n\t\tplaceholder: branches.length === 0 ? `No branches found in ${state.repo.formattedName}` : placeholder,\n\t\tmatchOnDetail: true,\n\t\titems:\n\t\t\tbranches.length === 0\n\t\t\t\t? [DirectiveQuickPickItem.create(Directive.Back, true), DirectiveQuickPickItem.create(Directive.Cancel)]\n\t\t\t\t: branches,\n\t\tadditionalButtons: [QuickCommandButtons.RevealInSideBar],\n\t\tonDidClickButton: (quickpick, button) => {\n\t\t\tif (button === QuickCommandButtons.RevealInSideBar) {\n\t\t\t\tif (quickpick.activeItems.length === 0) {\n\t\t\t\t\tvoid Container.repositoriesView.revealBranches(state.repo.path, {\n\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\texpand: true,\n\t\t\t\t\t});\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvoid GitActions.Branch.reveal(quickpick.activeItems[0].item, {\n\t\t\t\t\tselect: true,\n\t\t\t\t\texpand: true,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\tonDidPressKey: async quickpick => {\n\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\tawait GitActions.Branch.reveal(quickpick.activeItems[0].item, {\n\t\t\t\tselect: true,\n\t\t\t\tfocus: false,\n\t\t\t\texpand: true,\n\t\t\t});\n\t\t},\n\t});\n\tconst selection: StepSelection<typeof step> = yield step;\n\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection.map(i => i.item) : StepResult.Break;\n}\n\nexport async function* pickBranchOrTagStep<\n\tState extends PartialStepState & { repo: Repository },\n\tContext extends { repos: Repository[]; showTags?: boolean; title: string },\n>(\n\tstate: State,\n\tcontext: Context,\n\t{\n\t\tfilter,\n\t\tpicked,\n\t\tplaceholder,\n\t\ttitleContext,\n\t\tvalue,\n\t\tadditionalButtons,\n\t\tranges,\n\t}: {\n\t\tfilter?: { branches?: (b: GitBranch) => boolean; tags?: (t: GitTag) => boolean };\n\t\tpicked: string | string[] | undefined;\n\t\tplaceholder: string | ((context: Context) => string);\n\t\ttitleContext?: string;\n\t\tvalue: string | undefined;\n\t\tadditionalButtons?: QuickInputButton[];\n\t\tranges?: boolean;\n\t},\n): AsyncStepResultGenerator<GitReference> {\n\tcontext.showTags = true;\n\n\tconst showTagsButton = new QuickCommandButtons.ShowTagsToggle(context.showTags);\n\n\tconst getBranchesAndOrTagsFn = async () => {\n\t\treturn getBranchesAndOrTags(state.repo, context.showTags ? ['branches', 'tags'] : ['branches'], {\n\t\t\tfilter: filter,\n\t\t\tpicked: picked,\n\t\t\tsort: true,\n\t\t});\n\t};\n\tconst branchesAndOrTags = await getBranchesAndOrTagsFn();\n\n\tconst step = QuickCommand.createPickStep<ReferencesQuickPickItem>({\n\t\ttitle: appendReposToTitle(`${context.title}${titleContext ?? ''}`, state, context),\n\t\tplaceholder:\n\t\t\tbranchesAndOrTags.length === 0\n\t\t\t\t? `No branches${context.showTags ? ' or tags' : ''} found in ${state.repo.formattedName}`\n\t\t\t\t: `${typeof placeholder === 'string' ? placeholder : placeholder(context)}${GlyphChars.Space.repeat(\n\t\t\t\t\t\t3,\n\t\t\t\t  )}(or enter a reference using #)`,\n\t\tmatchOnDescription: true,\n\t\tmatchOnDetail: true,\n\t\tvalue: value,\n\t\titems:\n\t\t\tbranchesAndOrTags.length === 0\n\t\t\t\t? [DirectiveQuickPickItem.create(Directive.Back, true), DirectiveQuickPickItem.create(Directive.Cancel)]\n\t\t\t\t: branchesAndOrTags,\n\t\tadditionalButtons: [QuickCommandButtons.RevealInSideBar, ...(additionalButtons ?? []), showTagsButton],\n\t\tonDidClickButton: async (quickpick, button) => {\n\t\t\tif (button === showTagsButton) {\n\t\t\t\tquickpick.busy = true;\n\t\t\t\tquickpick.enabled = false;\n\n\t\t\t\ttry {\n\t\t\t\t\tcontext.showTags = !context.showTags;\n\t\t\t\t\tshowTagsButton.on = context.showTags;\n\n\t\t\t\t\tconst branchesAndOrTags = await getBranchesAndOrTagsFn();\n\t\t\t\t\tquickpick.placeholder =\n\t\t\t\t\t\tbranchesAndOrTags.length === 0\n\t\t\t\t\t\t\t? `${state.repo.formattedName} has no branches${context.showTags ? ' or tags' : ''}`\n\t\t\t\t\t\t\t: `${\n\t\t\t\t\t\t\t\t\ttypeof placeholder === 'string' ? placeholder : placeholder(context)\n\t\t\t\t\t\t\t  }${GlyphChars.Space.repeat(3)}(or enter a reference using #)`;\n\t\t\t\t\tquickpick.items = branchesAndOrTags;\n\t\t\t\t} finally {\n\t\t\t\t\tquickpick.busy = false;\n\t\t\t\t\tquickpick.enabled = true;\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (button === QuickCommandButtons.RevealInSideBar) {\n\t\t\t\tif (quickpick.activeItems.length === 0) {\n\t\t\t\t\tvoid Container.repositoriesView.revealBranches(state.repo.path, {\n\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\texpand: true,\n\t\t\t\t\t});\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst item = quickpick.activeItems[0].item;\n\t\t\t\tif (GitReference.isBranch(item)) {\n\t\t\t\t\tvoid GitActions.Branch.reveal(item, { select: true, expand: true });\n\t\t\t\t} else if (GitReference.isTag(item)) {\n\t\t\t\t\tvoid GitActions.Tag.reveal(item, { select: true, expand: true });\n\t\t\t\t} else if (GitReference.isRevision(item)) {\n\t\t\t\t\tvoid GitActions.Commit.reveal(item, { select: true, expand: true });\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\tonDidPressKey: quickpick => {\n\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\tconst item = quickpick.activeItems[0].item;\n\t\t\tif (GitReference.isBranch(item)) {\n\t\t\t\tvoid GitActions.Branch.reveal(item, { select: true, focus: false, expand: true });\n\t\t\t} else if (GitReference.isTag(item)) {\n\t\t\t\tvoid GitActions.Tag.reveal(item, { select: true, focus: false, expand: true });\n\t\t\t} else if (GitReference.isRevision(item)) {\n\t\t\t\tvoid GitActions.Commit.reveal(item, { select: true, focus: false, expand: true });\n\t\t\t}\n\t\t},\n\t\tonValidateValue: getValidateGitReferenceFn(state.repo, { ranges: ranges }),\n\t});\n\tconst selection: StepSelection<typeof step> = yield step;\n\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n}\n\nexport async function* pickBranchOrTagStepMultiRepo<\n\tState extends StepState & { repos: Repository[]; reference?: GitReference },\n\tContext extends { repos: Repository[]; showTags?: boolean; title: string },\n>(\n\tstate: State,\n\tcontext: Context,\n\t{\n\t\tfilter,\n\t\tpicked,\n\t\tplaceholder,\n\t\ttitleContext,\n\t\tvalue,\n\t}: {\n\t\tfilter?: { branches?: (b: GitBranch) => boolean; tags?: (t: GitTag) => boolean };\n\t\tpicked?: string | string[];\n\t\tplaceholder: string | ((context: Context) => string);\n\t\ttitleContext?: string;\n\t\tvalue?: string;\n\t},\n): AsyncStepResultGenerator<GitReference> {\n\tcontext.showTags = state.repos.length === 1;\n\n\tconst showTagsButton = new QuickCommandButtons.ShowTagsToggle(context.showTags);\n\n\tconst getBranchesAndOrTagsFn = () => {\n\t\treturn getBranchesAndOrTags(state.repos, context.showTags ? ['branches', 'tags'] : ['branches'], {\n\t\t\t// Filter out remote branches if we are going to affect multiple repos\n\t\t\tfilter: { branches: state.repos.length === 1 ? undefined : b => !b.remote, ...filter },\n\t\t\tpicked: picked ?? state.reference?.ref,\n\t\t\tsort: { branches: { orderBy: BranchSorting.DateDesc }, tags: { orderBy: TagSorting.DateDesc } },\n\t\t});\n\t};\n\tconst branchesAndOrTags = await getBranchesAndOrTagsFn();\n\n\tconst step = QuickCommand.createPickStep<ReferencesQuickPickItem>({\n\t\ttitle: appendReposToTitle(`${context.title}${titleContext ?? ''}`, state, context),\n\t\tplaceholder:\n\t\t\tbranchesAndOrTags.length === 0\n\t\t\t\t? `No branches${context.showTags ? ' or tags' : ''} found in ${state.repos[0].formattedName}`\n\t\t\t\t: `${typeof placeholder === 'string' ? placeholder : placeholder(context)}${GlyphChars.Space.repeat(\n\t\t\t\t\t\t3,\n\t\t\t\t  )}(or enter a reference using #)`,\n\t\tmatchOnDescription: true,\n\t\tmatchOnDetail: true,\n\t\tvalue: value ?? (GitReference.isRevision(state.reference) ? state.reference.ref : undefined),\n\t\titems:\n\t\t\tbranchesAndOrTags.length === 0\n\t\t\t\t? [DirectiveQuickPickItem.create(Directive.Back, true), DirectiveQuickPickItem.create(Directive.Cancel)]\n\t\t\t\t: branchesAndOrTags,\n\t\tadditionalButtons: [QuickCommandButtons.RevealInSideBar, showTagsButton],\n\t\tonDidClickButton: async (quickpick, button) => {\n\t\t\tif (button === showTagsButton) {\n\t\t\t\tquickpick.busy = true;\n\t\t\t\tquickpick.enabled = false;\n\n\t\t\t\ttry {\n\t\t\t\t\tcontext.showTags = !context.showTags;\n\t\t\t\t\tshowTagsButton.on = context.showTags;\n\n\t\t\t\t\tconst branchesAndOrTags = await getBranchesAndOrTagsFn();\n\t\t\t\t\tquickpick.placeholder =\n\t\t\t\t\t\tbranchesAndOrTags.length === 0\n\t\t\t\t\t\t\t? `${state.repos[0].formattedName} has no branches${context.showTags ? ' or tags' : ''}`\n\t\t\t\t\t\t\t: `${\n\t\t\t\t\t\t\t\t\ttypeof placeholder === 'string' ? placeholder : placeholder(context)\n\t\t\t\t\t\t\t  }${GlyphChars.Space.repeat(3)}(or enter a reference using #)`;\n\t\t\t\t\tquickpick.items = branchesAndOrTags;\n\t\t\t\t} finally {\n\t\t\t\t\tquickpick.busy = false;\n\t\t\t\t\tquickpick.enabled = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (button === QuickCommandButtons.RevealInSideBar) {\n\t\t\t\tif (quickpick.activeItems.length === 0) {\n\t\t\t\t\tif (state.repos.length === 1) {\n\t\t\t\t\t\tvoid Container.repositoriesView.revealBranches(state.repos[0].path, {\n\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\texpand: true,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst item = quickpick.activeItems[0].item;\n\t\t\t\tif (GitReference.isBranch(item)) {\n\t\t\t\t\tvoid GitActions.Branch.reveal(item, { select: true, expand: true });\n\t\t\t\t} else if (GitReference.isTag(item)) {\n\t\t\t\t\tvoid GitActions.Tag.reveal(item, { select: true, expand: true });\n\t\t\t\t} else if (GitReference.isRevision(item)) {\n\t\t\t\t\tvoid GitActions.Commit.reveal(item, { select: true, expand: true });\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\tonDidPressKey: quickpick => {\n\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\tconst item = quickpick.activeItems[0].item;\n\t\t\tif (GitReference.isBranch(item)) {\n\t\t\t\tvoid GitActions.Branch.reveal(item, { select: true, focus: false, expand: true });\n\t\t\t} else if (GitReference.isTag(item)) {\n\t\t\t\tvoid GitActions.Tag.reveal(item, { select: true, focus: false, expand: true });\n\t\t\t} else if (GitReference.isRevision(item)) {\n\t\t\t\tvoid GitActions.Commit.reveal(item, { select: true, focus: false, expand: true });\n\t\t\t}\n\t\t},\n\t\tonValidateValue: getValidateGitReferenceFn(state.repos),\n\t});\n\n\tconst selection: StepSelection<typeof step> = yield step;\n\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n}\n\nexport async function* pickCommitStep<\n\tState extends PartialStepState & { repo: Repository },\n\tContext extends { repos: Repository[]; title: string },\n>(\n\tstate: State,\n\tcontext: Context,\n\t{\n\t\tignoreFocusOut,\n\t\tlog,\n\t\tonDidLoadMore,\n\t\tpicked,\n\t\tplaceholder,\n\t\tshowInSideBarCommand,\n\t\tshowInSideBarButton: showInSideBar,\n\t\ttitleContext,\n\t}: {\n\t\tignoreFocusOut?: boolean;\n\t\tlog: GitLog | undefined;\n\t\tonDidLoadMore?: (log: GitLog | undefined) => void;\n\t\tpicked?: string | string[] | undefined;\n\t\tplaceholder: string | ((context: Context, log: GitLog | undefined) => string);\n\t\tshowInSideBarCommand?: CommandQuickPickItem;\n\t\tshowInSideBarButton?: {\n\t\t\tbutton: QuickInputButton;\n\t\t\tonDidClick: (items: Readonly<CommitQuickPickItem<GitLogCommit>[]>) => void;\n\t\t};\n\t\ttitleContext?: string;\n\t},\n): AsyncStepResultGenerator<GitLogCommit> {\n\tfunction getItems(log: GitLog | undefined) {\n\t\treturn log == null\n\t\t\t? [DirectiveQuickPickItem.create(Directive.Back, true), DirectiveQuickPickItem.create(Directive.Cancel)]\n\t\t\t: [\n\t\t\t\t\t...Iterables.map(log.commits.values(), commit =>\n\t\t\t\t\t\tCommitQuickPickItem.create(\n\t\t\t\t\t\t\tcommit,\n\t\t\t\t\t\t\tpicked != null &&\n\t\t\t\t\t\t\t\t(typeof picked === 'string' ? commit.ref === picked : picked.includes(commit.ref)),\n\t\t\t\t\t\t\t{ compact: true, icon: true },\n\t\t\t\t\t\t),\n\t\t\t\t\t),\n\t\t\t\t\t...(log?.hasMore ? [DirectiveQuickPickItem.create(Directive.LoadMore)] : []),\n\t\t\t  ];\n\t}\n\n\tconst step = QuickCommand.createPickStep<CommandQuickPickItem | CommitQuickPickItem>({\n\t\ttitle: appendReposToTitle(`${context.title}${titleContext ?? ''}`, state, context),\n\t\tplaceholder: typeof placeholder === 'string' ? placeholder : placeholder(context, log),\n\t\tignoreFocusOut: ignoreFocusOut,\n\t\tmatchOnDescription: true,\n\t\tmatchOnDetail: true,\n\t\tvalue: typeof picked === 'string' && log?.count === 0 ? picked : undefined,\n\t\titems: showInSideBarCommand != null ? [showInSideBarCommand, ...getItems(log)] : getItems(log),\n\t\tonDidLoadMore: async quickpick => {\n\t\t\tlog = await log?.more?.(configuration.get('advanced.maxListItems'));\n\t\t\tonDidLoadMore?.(log);\n\t\t\tif (typeof placeholder !== 'string') {\n\t\t\t\tquickpick.placeholder = placeholder(context, log);\n\t\t\t}\n\t\t\treturn getItems(log);\n\t\t},\n\t\tadditionalButtons: [\n\t\t\tQuickCommandButtons.RevealInSideBar,\n\t\t\tshowInSideBar?.button ?? QuickCommandButtons.SearchInSideBar,\n\t\t\t...(log?.hasMore ? [QuickCommandButtons.LoadMore] : []),\n\t\t],\n\t\tonDidClickButton: (quickpick, button) => {\n\t\t\tif (log == null) return;\n\n\t\t\tconst items = quickpick.activeItems.filter<CommitQuickPickItem<GitLogCommit>>(\n\t\t\t\t(i): i is CommitQuickPickItem<GitLogCommit> => !CommandQuickPickItem.is(i),\n\t\t\t);\n\n\t\t\tif (button === showInSideBar?.button) {\n\t\t\t\tshowInSideBar.onDidClick(items);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (items.length === 0 || log == null) return;\n\n\t\t\tif (button === QuickCommandButtons.RevealInSideBar) {\n\t\t\t\tvoid GitActions.Commit.reveal(items[0].item, {\n\t\t\t\t\tselect: true,\n\t\t\t\t\tfocus: false,\n\t\t\t\t\texpand: true,\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (button === QuickCommandButtons.SearchInSideBar) {\n\t\t\t\tvoid Container.searchAndCompareView.search(\n\t\t\t\t\tstate.repo.path,\n\t\t\t\t\t{ pattern: SearchPattern.fromCommit(items[0].item.ref) },\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: {\n\t\t\t\t\t\t\tlabel: `for ${GitReference.toString(items[0].item, { icon: false })}`,\n\t\t\t\t\t\t},\n\t\t\t\t\t\treveal: {\n\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\t\texpand: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\tonDidPressKey: async (quickpick, key) => {\n\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\tconst items = quickpick.activeItems.filter<CommitQuickPickItem<GitLogCommit>>(\n\t\t\t\t(i): i is CommitQuickPickItem<GitLogCommit> => !CommandQuickPickItem.is(i),\n\t\t\t);\n\n\t\t\tif (key === 'ctrl+right') {\n\t\t\t\tawait GitActions.Commit.reveal(items[0].item, {\n\t\t\t\t\tselect: true,\n\t\t\t\t\tfocus: false,\n\t\t\t\t\texpand: true,\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconst commit = items[0].item;\n\t\t\t\tawait Container.searchAndCompareView.search(\n\t\t\t\t\tcommit.repoPath,\n\t\t\t\t\t{ pattern: SearchPattern.fromCommit(commit) },\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: { label: `for ${GitReference.toString(commit, { icon: false })}` },\n\t\t\t\t\t\treveal: {\n\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\t\texpand: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t\tonValidateValue: getValidateGitReferenceFn(state.repo),\n\t});\n\tconst selection: StepSelection<typeof step> = yield step;\n\tif (!QuickCommand.canPickStepContinue(step, state, selection)) return StepResult.Break;\n\n\tif (CommandQuickPickItem.is(selection[0])) {\n\t\tQuickCommand.endSteps(state);\n\n\t\tawait selection[0].execute();\n\t\treturn StepResult.Break;\n\t}\n\n\treturn selection[0].item;\n}\n\nexport function* pickCommitsStep<\n\tState extends PartialStepState & { repo: Repository },\n\tContext extends { repos: Repository[]; title: string },\n>(\n\tstate: State,\n\tcontext: Context,\n\t{\n\t\tlog,\n\t\tonDidLoadMore,\n\t\tpicked,\n\t\tplaceholder,\n\t\ttitleContext,\n\t}: {\n\t\tlog: GitLog | undefined;\n\t\tonDidLoadMore?: (log: GitLog | undefined) => void;\n\t\tpicked: string | string[] | undefined;\n\t\tplaceholder: string | ((context: Context, log: GitLog | undefined) => string);\n\t\ttitleContext?: string;\n\t},\n): StepResultGenerator<GitRevisionReference[]> {\n\tfunction getItems(log: GitLog | undefined) {\n\t\treturn log == null\n\t\t\t? [DirectiveQuickPickItem.create(Directive.Back, true), DirectiveQuickPickItem.create(Directive.Cancel)]\n\t\t\t: [\n\t\t\t\t\t...Iterables.map(log.commits.values(), commit =>\n\t\t\t\t\t\tCommitQuickPickItem.create(\n\t\t\t\t\t\t\tcommit,\n\t\t\t\t\t\t\tpicked != null &&\n\t\t\t\t\t\t\t\t(typeof picked === 'string' ? commit.ref === picked : picked.includes(commit.ref)),\n\t\t\t\t\t\t\t{ compact: true, icon: true },\n\t\t\t\t\t\t),\n\t\t\t\t\t),\n\t\t\t\t\t// Since this is multi-select, we can have a \"Load more\" item\n\t\t\t\t\t// ...(log?.hasMore ? [DirectiveQuickPickItem.create(Directive.LoadMore)] : []),\n\t\t\t  ];\n\t}\n\n\tconst step = QuickCommand.createPickStep<CommitQuickPickItem>({\n\t\ttitle: appendReposToTitle(`${context.title}${titleContext ?? ''}`, state, context),\n\t\tmultiselect: log != null,\n\t\tplaceholder: typeof placeholder === 'string' ? placeholder : placeholder(context, log),\n\t\tmatchOnDescription: true,\n\t\tmatchOnDetail: true,\n\t\titems: getItems(log),\n\t\tonDidLoadMore: async quickpick => {\n\t\t\tlog = await log?.more?.(configuration.get('advanced.maxListItems'));\n\t\t\tonDidLoadMore?.(log);\n\t\t\tif (typeof placeholder !== 'string') {\n\t\t\t\tquickpick.placeholder = placeholder(context, log);\n\t\t\t}\n\t\t\treturn getItems(log);\n\t\t},\n\t\tadditionalButtons: [\n\t\t\tQuickCommandButtons.RevealInSideBar,\n\t\t\tQuickCommandButtons.SearchInSideBar,\n\t\t\t...(log?.hasMore ? [QuickCommandButtons.LoadMore] : []),\n\t\t],\n\t\tonDidClickButton: (quickpick, button) => {\n\t\t\tif (quickpick.activeItems.length === 0 || log == null) return;\n\n\t\t\tif (button === QuickCommandButtons.RevealInSideBar) {\n\t\t\t\tvoid GitActions.Commit.reveal(quickpick.activeItems[0].item, {\n\t\t\t\t\tselect: true,\n\t\t\t\t\tfocus: false,\n\t\t\t\t\texpand: true,\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (button === QuickCommandButtons.SearchInSideBar) {\n\t\t\t\tvoid Container.searchAndCompareView.search(\n\t\t\t\t\tstate.repo.path,\n\t\t\t\t\t{ pattern: SearchPattern.fromCommit(quickpick.activeItems[0].item.ref) },\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: {\n\t\t\t\t\t\t\tlabel: `for ${GitReference.toString(quickpick.activeItems[0].item, { icon: false })}`,\n\t\t\t\t\t\t},\n\t\t\t\t\t\treveal: {\n\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\t\texpand: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\tonDidPressKey: async (quickpick, key) => {\n\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\tif (key === 'ctrl+right') {\n\t\t\t\tawait GitActions.Commit.reveal(quickpick.activeItems[0].item, {\n\t\t\t\t\tselect: true,\n\t\t\t\t\tfocus: false,\n\t\t\t\t\texpand: true,\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconst commit = quickpick.activeItems[0].item;\n\t\t\t\tawait Container.searchAndCompareView.search(\n\t\t\t\t\tcommit.repoPath,\n\t\t\t\t\t{ pattern: SearchPattern.fromCommit(commit) },\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: { label: `for ${GitReference.toString(commit, { icon: false })}` },\n\t\t\t\t\t\treveal: {\n\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\t\texpand: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t});\n\tconst selection: StepSelection<typeof step> = yield step;\n\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection.map(i => i.item) : StepResult.Break;\n}\n\nexport async function* pickContributorsStep<\n\tState extends PartialStepState & { repo: Repository },\n\tContext extends { repos: Repository[]; title: string },\n>(\n\tstate: State,\n\tcontext: Context,\n\tplaceholder: string = 'Choose contributors',\n): AsyncStepResultGenerator<GitContributor[]> {\n\tconst message = (await GitService.getOrOpenBuiltInGitRepository(state.repo.path))?.inputBox.value;\n\n\tconst step = QuickCommand.createPickStep<ContributorQuickPickItem>({\n\t\ttitle: appendReposToTitle(context.title, state, context),\n\t\tallowEmpty: true,\n\t\tmultiselect: true,\n\t\tplaceholder: placeholder,\n\t\tmatchOnDescription: true,\n\t\titems: (await Container.git.getContributors(state.repo.path)).map(c =>\n\t\t\tContributorQuickPickItem.create(c, message?.includes(c.toCoauthor())),\n\t\t),\n\t});\n\tconst selection: StepSelection<typeof step> = yield step;\n\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection.map(i => i.item) : StepResult.Break;\n}\n\nexport async function* pickRepositoryStep<\n\tState extends PartialStepState & { repo?: string | Repository },\n\tContext extends { repos: Repository[]; title: string },\n>(state: State, context: Context, placeholder: string = 'Choose a repository'): AsyncStepResultGenerator<Repository> {\n\tif (typeof state.repo === 'string') {\n\t\tstate.repo = await Container.git.getRepository(state.repo);\n\t\tif (state.repo != null) return state.repo;\n\t}\n\tconst active = state.repo ?? (await Container.git.getActiveRepository());\n\n\tconst step = QuickCommand.createPickStep<RepositoryQuickPickItem>({\n\t\ttitle: context.title,\n\t\tplaceholder: placeholder,\n\t\titems:\n\t\t\tcontext.repos.length === 0\n\t\t\t\t? [DirectiveQuickPickItem.create(Directive.Cancel)]\n\t\t\t\t: await Promise.all(\n\t\t\t\t\t\tcontext.repos.map(r =>\n\t\t\t\t\t\t\tRepositoryQuickPickItem.create(r, r.id === active?.id, {\n\t\t\t\t\t\t\t\tbranch: true,\n\t\t\t\t\t\t\t\tfetched: true,\n\t\t\t\t\t\t\t\tstatus: true,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t),\n\t\t\t\t  ),\n\t\tadditionalButtons: [QuickCommandButtons.RevealInSideBar],\n\t\tonDidClickButton: (quickpick, button) => {\n\t\t\tif (button === QuickCommandButtons.RevealInSideBar) {\n\t\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\t\tvoid Container.repositoriesView.revealRepository(quickpick.activeItems[0].item.path, {\n\t\t\t\t\tselect: true,\n\t\t\t\t\texpand: true,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\tonDidPressKey: quickpick => {\n\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\tvoid Container.repositoriesView.revealRepository(quickpick.activeItems[0].item.path, {\n\t\t\t\tselect: true,\n\t\t\t\tfocus: false,\n\t\t\t\texpand: true,\n\t\t\t});\n\t\t},\n\t});\n\tconst selection: StepSelection<typeof step> = yield step;\n\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n}\n\nexport async function* pickRepositoriesStep<\n\tState extends PartialStepState & { repos?: string[] | Repository[] },\n\tContext extends { repos: Repository[]; title: string },\n>(\n\tstate: State,\n\tcontext: Context,\n\toptions?: { placeholder?: string; skipIfPossible?: boolean },\n): AsyncStepResultGenerator<Repository[]> {\n\toptions = { placeholder: 'Choose repositories', skipIfPossible: false, ...options };\n\n\tlet actives: Repository[];\n\tif (state.repos != null) {\n\t\tif (Arrays.isStringArray(state.repos)) {\n\t\t\tactives = Arrays.filterMap(state.repos, path => context.repos.find(r => r.path === path));\n\t\t\tif (options.skipIfPossible && actives.length !== 0 && state.repos.length === actives.length) {\n\t\t\t\treturn actives;\n\t\t\t}\n\t\t} else {\n\t\t\tactives = state.repos;\n\t\t}\n\t} else {\n\t\tconst active = await Container.git.getActiveRepository();\n\t\tactives = active != null ? [active] : [];\n\t}\n\n\tconst step = QuickCommand.createPickStep<RepositoryQuickPickItem>({\n\t\tmultiselect: true,\n\t\ttitle: context.title,\n\t\tplaceholder: options.placeholder,\n\t\titems:\n\t\t\tcontext.repos.length === 0\n\t\t\t\t? [DirectiveQuickPickItem.create(Directive.Cancel)]\n\t\t\t\t: await Promise.all(\n\t\t\t\t\t\tcontext.repos.map(repo =>\n\t\t\t\t\t\t\tRepositoryQuickPickItem.create(\n\t\t\t\t\t\t\t\trepo,\n\t\t\t\t\t\t\t\tactives.some(r => r.id === repo.id),\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tbranch: true,\n\t\t\t\t\t\t\t\t\tfetched: true,\n\t\t\t\t\t\t\t\t\tstatus: true,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t),\n\t\t\t\t  ),\n\t\tadditionalButtons: [QuickCommandButtons.RevealInSideBar],\n\t\tonDidClickButton: (quickpick, button) => {\n\t\t\tif (button === QuickCommandButtons.RevealInSideBar) {\n\t\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\t\tvoid Container.repositoriesView.revealRepository(quickpick.activeItems[0].item.path, {\n\t\t\t\t\tselect: true,\n\t\t\t\t\texpand: true,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\tonDidPressKey: quickpick => {\n\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\tvoid Container.repositoriesView.revealRepository(quickpick.activeItems[0].item.path, {\n\t\t\t\tselect: true,\n\t\t\t\tfocus: false,\n\t\t\t\texpand: true,\n\t\t\t});\n\t\t},\n\t});\n\tconst selection: StepSelection<typeof step> = yield step;\n\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection.map(i => i.item) : StepResult.Break;\n}\n\nexport function* pickStashStep<\n\tState extends PartialStepState & { repo: Repository },\n\tContext extends { repos: Repository[]; title: string },\n>(\n\tstate: State,\n\tcontext: Context,\n\t{\n\t\tignoreFocusOut,\n\t\tstash,\n\t\tpicked,\n\t\tplaceholder,\n\t\ttitleContext,\n\t}: {\n\t\tignoreFocusOut?: boolean;\n\t\tstash: GitStash | undefined;\n\t\tpicked: string | string[] | undefined;\n\t\tplaceholder: string | ((context: Context, stash: GitStash | undefined) => string);\n\t\ttitleContext?: string;\n\t},\n): StepResultGenerator<GitStashCommit> {\n\tconst step = QuickCommand.createPickStep<CommitQuickPickItem<GitStashCommit>>({\n\t\ttitle: appendReposToTitle(`${context.title}${titleContext ?? ''}`, state, context),\n\t\tplaceholder: typeof placeholder === 'string' ? placeholder : placeholder(context, stash),\n\t\tignoreFocusOut: ignoreFocusOut,\n\t\tmatchOnDescription: true,\n\t\tmatchOnDetail: true,\n\t\titems:\n\t\t\tstash == null\n\t\t\t\t? [DirectiveQuickPickItem.create(Directive.Back, true), DirectiveQuickPickItem.create(Directive.Cancel)]\n\t\t\t\t: [\n\t\t\t\t\t\t...Iterables.map(stash.commits.values(), commit =>\n\t\t\t\t\t\t\tCommitQuickPickItem.create(\n\t\t\t\t\t\t\t\tcommit,\n\t\t\t\t\t\t\t\tpicked != null &&\n\t\t\t\t\t\t\t\t\t(typeof picked === 'string' ? commit.ref === picked : picked.includes(commit.ref)),\n\t\t\t\t\t\t\t\t{ compact: true, icon: true },\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t),\n\t\t\t\t  ],\n\t\tadditionalButtons: [QuickCommandButtons.RevealInSideBar, QuickCommandButtons.SearchInSideBar],\n\t\tonDidClickButton: (quickpick, button) => {\n\t\t\tif (button === QuickCommandButtons.RevealInSideBar) {\n\t\t\t\tif (quickpick.activeItems.length === 0) {\n\t\t\t\t\tvoid Container.repositoriesView.revealStashes(state.repo.path, {\n\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\texpand: true,\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tvoid GitActions.Stash.reveal(quickpick.activeItems[0].item, {\n\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\texpand: true,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (button === QuickCommandButtons.SearchInSideBar) {\n\t\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\t\tvoid Container.searchAndCompareView.search(\n\t\t\t\t\tstate.repo.path,\n\t\t\t\t\t{ pattern: SearchPattern.fromCommit(quickpick.activeItems[0].item.stashName) },\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: {\n\t\t\t\t\t\t\tlabel: `for ${GitReference.toString(quickpick.activeItems[0].item, { icon: false })}`,\n\t\t\t\t\t\t},\n\t\t\t\t\t\treveal: {\n\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\t\texpand: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\tonDidPressKey: async quickpick => {\n\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\tawait GitActions.Stash.reveal(quickpick.activeItems[0].item, {\n\t\t\t\tselect: true,\n\t\t\t\tfocus: false,\n\t\t\t\texpand: true,\n\t\t\t});\n\t\t},\n\t});\n\tconst selection: StepSelection<typeof step> = yield step;\n\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0].item : StepResult.Break;\n}\n\nexport async function* pickTagsStep<\n\tState extends PartialStepState & { repo: Repository },\n\tContext extends { repos: Repository[]; showTags?: boolean; title: string },\n>(\n\tstate: State,\n\tcontext: Context,\n\t{\n\t\tfilter,\n\t\tpicked,\n\t\tplaceholder,\n\t\ttitleContext,\n\t}: {\n\t\tfilter?: (b: GitTag) => boolean;\n\t\tpicked?: string | string[];\n\t\tplaceholder: string;\n\t\ttitleContext?: string;\n\t},\n): AsyncStepResultGenerator<GitTagReference[]> {\n\tconst tags = await getTags(state.repo, {\n\t\tfilter: filter,\n\t\tpicked: picked,\n\t});\n\n\tconst step = QuickCommand.createPickStep<TagQuickPickItem>({\n\t\tmultiselect: tags.length !== 0,\n\t\ttitle: appendReposToTitle(`${context.title}${titleContext ?? ''}`, state, context),\n\t\tplaceholder: tags.length === 0 ? `No tags found in ${state.repo.formattedName}` : placeholder,\n\t\tmatchOnDetail: true,\n\t\titems:\n\t\t\ttags.length === 0\n\t\t\t\t? [DirectiveQuickPickItem.create(Directive.Back, true), DirectiveQuickPickItem.create(Directive.Cancel)]\n\t\t\t\t: tags,\n\t\tadditionalButtons: [QuickCommandButtons.RevealInSideBar],\n\t\tonDidClickButton: (quickpick, button) => {\n\t\t\tif (button === QuickCommandButtons.RevealInSideBar) {\n\t\t\t\tif (quickpick.activeItems.length === 0) {\n\t\t\t\t\tvoid Container.repositoriesView.revealTags(state.repo.path, {\n\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\texpand: true,\n\t\t\t\t\t});\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvoid GitActions.Tag.reveal(quickpick.activeItems[0].item, {\n\t\t\t\t\tselect: true,\n\t\t\t\t\texpand: true,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\tonDidPressKey: async quickpick => {\n\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\tawait GitActions.Tag.reveal(quickpick.activeItems[0].item, {\n\t\t\t\tselect: true,\n\t\t\t\tfocus: false,\n\t\t\t\texpand: true,\n\t\t\t});\n\t\t},\n\t});\n\tconst selection: StepSelection<typeof step> = yield step;\n\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection.map(i => i.item) : StepResult.Break;\n}\n\nexport async function* showCommitOrStashStep<\n\tState extends PartialStepState & { repo: Repository; reference: GitLogCommit | GitStashCommit },\n\tContext extends { repos: Repository[]; title: string },\n>(\n\tstate: State,\n\tcontext: Context,\n): AsyncStepResultGenerator<CommitFilesQuickPickItem | GitCommandQuickPickItem | CommandQuickPickItem> {\n\tconst step: QuickPickStep<CommitFilesQuickPickItem | GitCommandQuickPickItem | CommandQuickPickItem> =\n\t\tQuickCommand.createPickStep({\n\t\t\ttitle: appendReposToTitle(\n\t\t\t\tGitReference.toString(state.reference, {\n\t\t\t\t\tcapitalize: true,\n\t\t\t\t\ticon: false,\n\t\t\t\t}),\n\t\t\t\tstate,\n\t\t\t\tcontext,\n\t\t\t),\n\t\t\tplaceholder: GitReference.toString(state.reference, { capitalize: true, icon: false }),\n\t\t\tignoreFocusOut: true,\n\t\t\titems: await getShowCommitOrStashStepItems(state),\n\t\t\tadditionalButtons: GitReference.isStash(state.reference)\n\t\t\t\t? [QuickCommandButtons.RevealInSideBar]\n\t\t\t\t: [QuickCommandButtons.RevealInSideBar, QuickCommandButtons.SearchInSideBar],\n\t\t\tonDidClickButton: (quickpick, button) => {\n\t\t\t\tif (button === QuickCommandButtons.SearchInSideBar) {\n\t\t\t\t\tvoid Container.searchAndCompareView.search(\n\t\t\t\t\t\tstate.repo.path,\n\t\t\t\t\t\t{ pattern: SearchPattern.fromCommit(state.reference.ref) },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: { label: `for ${GitReference.toString(state.reference, { icon: false })}` },\n\t\t\t\t\t\t\treveal: {\n\t\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\t\t\texpand: true,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (button === QuickCommandButtons.RevealInSideBar) {\n\t\t\t\t\tif (GitReference.isStash(state.reference)) {\n\t\t\t\t\t\tvoid GitActions.Stash.reveal(state.reference, {\n\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\t\texpand: true,\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvoid GitActions.Commit.reveal(state.reference, {\n\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\t\texpand: true,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\t\tonDidPressKey: async (quickpick, key) => {\n\t\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\t\tvoid (await quickpick.activeItems[0].onDidPressKey(key));\n\t\t\t},\n\t\t});\n\tconst selection: StepSelection<typeof step> = yield step;\n\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0] : StepResult.Break;\n}\n\nasync function getShowCommitOrStashStepItems<\n\tState extends PartialStepState & { repo: Repository; reference: GitLogCommit | GitStashCommit },\n>(state: State) {\n\tconst items: CommandQuickPickItem[] = [new CommitFilesQuickPickItem(state.reference)];\n\n\tconst branch = await Container.git.getBranch(state.repo.path);\n\tlet remotes: GitRemote<RemoteProvider>[] | undefined;\n\n\tlet isStash = false;\n\tif (GitStashCommit.is(state.reference)) {\n\t\tisStash = true;\n\n\t\titems.push(new RevealInSideBarQuickPickItem(state.reference));\n\n\t\titems.push(\n\t\t\tnew GitCommandQuickPickItem('Apply Stash...', {\n\t\t\t\tcommand: 'stash',\n\t\t\t\tstate: {\n\t\t\t\t\tsubcommand: 'apply',\n\t\t\t\t\trepo: state.repo,\n\t\t\t\t\treference: state.reference,\n\t\t\t\t},\n\t\t\t}),\n\n\t\t\tnew GitCommandQuickPickItem('Delete Stash...', {\n\t\t\t\tcommand: 'stash',\n\t\t\t\tstate: {\n\t\t\t\t\tsubcommand: 'drop',\n\t\t\t\t\trepo: state.repo,\n\t\t\t\t\treference: state.reference,\n\t\t\t\t},\n\t\t\t}),\n\t\t);\n\t} else {\n\t\tremotes = await Container.git.getRemotes(state.repo.path, { sort: true });\n\n\t\titems.push(\n\t\t\tnew RevealInSideBarQuickPickItem(state.reference),\n\t\t\tnew SearchForCommitQuickPickItem(state.reference),\n\t\t);\n\n\t\tif (\n\t\t\tbranch != null &&\n\t\t\t(await Container.git.branchContainsCommit(state.repo.path, branch.name, state.reference.ref))\n\t\t) {\n\t\t\titems.push(\n\t\t\t\tnew GitCommandQuickPickItem('Revert Commit...', {\n\t\t\t\t\tcommand: 'revert',\n\t\t\t\t\tstate: {\n\t\t\t\t\t\trepo: state.repo,\n\t\t\t\t\t\treferences: [state.reference],\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tnew GitCommandQuickPickItem('Reset Commit...', {\n\t\t\t\t\tcommand: 'reset',\n\t\t\t\t\tstate: {\n\t\t\t\t\t\trepo: state.repo,\n\t\t\t\t\t\treference: GitReference.create(`${state.reference.ref}^`, state.reference.repoPath, {\n\t\t\t\t\t\t\trefType: 'revision',\n\t\t\t\t\t\t\tname: `${state.reference.name}^`,\n\t\t\t\t\t\t\tmessage: state.reference.message,\n\t\t\t\t\t\t}),\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tnew GitCommandQuickPickItem(`Reset ${branch?.name ?? 'Current Branch'} to Commit...`, {\n\t\t\t\t\tcommand: 'reset',\n\t\t\t\t\tstate: {\n\t\t\t\t\t\trepo: state.repo,\n\t\t\t\t\t\treference: state.reference,\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tnew GitCommandQuickPickItem('Push to Commit...', {\n\t\t\t\t\tcommand: 'push',\n\t\t\t\t\tstate: {\n\t\t\t\t\t\trepos: state.repo,\n\t\t\t\t\t\treference: state.reference,\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t);\n\t\t} else {\n\t\t\titems.push(\n\t\t\t\tnew GitCommandQuickPickItem('Cherry Pick Commit...', {\n\t\t\t\t\tcommand: 'cherry-pick',\n\t\t\t\t\tstate: {\n\t\t\t\t\t\trepo: state.repo,\n\t\t\t\t\t\treferences: [state.reference],\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\titems.push(\n\t\t\tnew GitCommandQuickPickItem(`Rebase ${branch?.name ?? 'Current Branch'} onto Commit...`, {\n\t\t\t\tcommand: 'rebase',\n\t\t\t\tstate: {\n\t\t\t\t\trepo: state.repo,\n\t\t\t\t\treference: state.reference,\n\t\t\t\t},\n\t\t\t}),\n\t\t\tnew GitCommandQuickPickItem('Switch to Commit...', {\n\t\t\t\tcommand: 'switch',\n\t\t\t\tstate: {\n\t\t\t\t\trepos: [state.repo],\n\t\t\t\t\treference: state.reference,\n\t\t\t\t},\n\t\t\t}),\n\t\t\tnew GitCommandQuickPickItem('Create Branch at Commit...', {\n\t\t\t\tcommand: 'branch',\n\t\t\t\tstate: {\n\t\t\t\t\tsubcommand: 'create',\n\t\t\t\t\trepo: state.repo,\n\t\t\t\t\treference: state.reference,\n\t\t\t\t},\n\t\t\t}),\n\t\t\tnew GitCommandQuickPickItem('Create Tag at Commit...', {\n\t\t\t\tcommand: 'tag',\n\t\t\t\tstate: {\n\t\t\t\t\tsubcommand: 'create',\n\t\t\t\t\trepo: state.repo,\n\t\t\t\t\treference: state.reference,\n\t\t\t\t},\n\t\t\t}),\n\t\t);\n\t}\n\n\titems.push(\n\t\tnew CommitOpenAllChangesCommandQuickPickItem(state.reference),\n\t\tnew CommitOpenAllChangesWithDiffToolCommandQuickPickItem(state.reference),\n\t\tnew CommitOpenAllChangesWithWorkingCommandQuickPickItem(state.reference),\n\n\t\tnew CommitOpenDirectoryCompareCommandQuickPickItem(state.reference),\n\t\tnew CommitOpenDirectoryCompareWithWorkingCommandQuickPickItem(state.reference),\n\n\t\tnew CommitOpenFilesCommandQuickPickItem(state.reference),\n\t\tnew CommitOpenRevisionsCommandQuickPickItem(state.reference),\n\t);\n\n\tif (remotes?.length) {\n\t\titems.push(\n\t\t\tnew OpenRemoteResourceCommandQuickPickItem(remotes, {\n\t\t\t\ttype: RemoteResourceType.Commit,\n\t\t\t\tsha: state.reference.sha,\n\t\t\t}),\n\t\t);\n\t}\n\n\titems.push(\n\t\tnew CommitBrowseRepositoryFromHereCommandQuickPickItem(state.reference, { openInNewWindow: false }),\n\t\tnew CommitBrowseRepositoryFromHereCommandQuickPickItem(state.reference, {\n\t\t\tbefore: true,\n\t\t\topenInNewWindow: false,\n\t\t}),\n\t\tnew CommitBrowseRepositoryFromHereCommandQuickPickItem(state.reference, { openInNewWindow: true }),\n\t\tnew CommitBrowseRepositoryFromHereCommandQuickPickItem(state.reference, {\n\t\t\tbefore: true,\n\t\t\topenInNewWindow: true,\n\t\t}),\n\n\t\tnew CommitCompareWithHEADCommandQuickPickItem(state.reference),\n\t\tnew CommitCompareWithWorkingCommandQuickPickItem(state.reference),\n\t);\n\n\tif (!isStash) {\n\t\titems.push(new CommitCopyIdQuickPickItem(state.reference));\n\t}\n\titems.push(new CommitCopyMessageQuickPickItem(state.reference));\n\n\tif (remotes?.length) {\n\t\titems.push(\n\t\t\tnew CopyRemoteResourceCommandQuickPickItem(remotes, {\n\t\t\t\ttype: RemoteResourceType.Commit,\n\t\t\t\tsha: state.reference.sha,\n\t\t\t}),\n\t\t);\n\t}\n\n\treturn items;\n}\n\nexport function* showCommitOrStashFilesStep<\n\tState extends PartialStepState & {\n\t\trepo: Repository;\n\t\treference: GitLogCommit | GitStashCommit;\n\t\tfileName?: string | undefined;\n\t},\n\tContext extends { repos: Repository[]; title: string },\n>(\n\tstate: State,\n\tcontext: Context,\n\toptions?: { picked?: string },\n): StepResultGenerator<CommitFilesQuickPickItem | CommitFileQuickPickItem> {\n\tconst step: QuickPickStep<CommitFilesQuickPickItem | CommitFileQuickPickItem> = QuickCommand.createPickStep({\n\t\ttitle: appendReposToTitle(\n\t\t\tGitReference.toString(state.reference, {\n\t\t\t\tcapitalize: true,\n\t\t\t\ticon: false,\n\t\t\t}),\n\t\t\tstate,\n\t\t\tcontext,\n\t\t),\n\t\tplaceholder: GitReference.toString(state.reference, { capitalize: true, icon: false }),\n\t\tignoreFocusOut: true,\n\t\titems: [\n\t\t\tnew CommitFilesQuickPickItem(state.reference, state.fileName == null),\n\t\t\t...state.reference.files.map(\n\t\t\t\tfs => new CommitFileQuickPickItem(state.reference, fs, options?.picked === fs.fileName),\n\t\t\t),\n\t\t],\n\t\tmatchOnDescription: true,\n\t\tadditionalButtons: [QuickCommandButtons.RevealInSideBar, QuickCommandButtons.SearchInSideBar],\n\t\tonDidClickButton: (quickpick, button) => {\n\t\t\tif (button === QuickCommandButtons.SearchInSideBar) {\n\t\t\t\tvoid Container.searchAndCompareView.search(\n\t\t\t\t\tstate.repo.path,\n\t\t\t\t\t{ pattern: SearchPattern.fromCommit(state.reference.ref) },\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: { label: `for ${GitReference.toString(state.reference, { icon: false })}` },\n\t\t\t\t\t\treveal: {\n\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\t\texpand: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (button === QuickCommandButtons.RevealInSideBar) {\n\t\t\t\tif (GitReference.isStash(state.reference)) {\n\t\t\t\t\tvoid GitActions.Stash.reveal(state.reference, {\n\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\texpand: true,\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tvoid GitActions.Commit.reveal(state.reference, {\n\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\texpand: true,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\tonDidPressKey: async (quickpick, key) => {\n\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\tvoid (await quickpick.activeItems[0].onDidPressKey(key));\n\t\t},\n\t});\n\tconst selection: StepSelection<typeof step> = yield step;\n\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0] : StepResult.Break;\n}\n\nexport async function* showCommitOrStashFileStep<\n\tState extends PartialStepState & {\n\t\trepo: Repository;\n\t\treference: GitLogCommit | GitStashCommit;\n\t\tfileName: string;\n\t},\n\tContext extends { repos: Repository[]; title: string },\n>(state: State, context: Context): AsyncStepResultGenerator<CommandQuickPickItem> {\n\tconst step: QuickPickStep<CommandQuickPickItem> = QuickCommand.createPickStep<CommandQuickPickItem>({\n\t\ttitle: appendReposToTitle(\n\t\t\tGitReference.toString(state.reference, {\n\t\t\t\tcapitalize: true,\n\t\t\t\ticon: false,\n\t\t\t}),\n\t\t\tstate,\n\t\t\tcontext,\n\t\t\t`${Strings.pad(GlyphChars.Dot, 2, 2)}${GitUri.getFormattedFilename(state.fileName)}`,\n\t\t),\n\t\tplaceholder: `${GitUri.getFormattedPath(state.fileName, {\n\t\t\trelativeTo: state.repo.path,\n\t\t})} in ${GitReference.toString(state.reference, {\n\t\t\ticon: false,\n\t\t})}`,\n\t\tignoreFocusOut: true,\n\t\titems: await getShowCommitOrStashFileStepItems(state),\n\t\tmatchOnDescription: true,\n\t\tadditionalButtons: [QuickCommandButtons.RevealInSideBar, QuickCommandButtons.SearchInSideBar],\n\t\tonDidClickButton: (quickpick, button) => {\n\t\t\tif (button === QuickCommandButtons.SearchInSideBar) {\n\t\t\t\tvoid Container.searchAndCompareView.search(\n\t\t\t\t\tstate.repo.path,\n\t\t\t\t\t{ pattern: SearchPattern.fromCommit(state.reference.ref) },\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: { label: `for ${GitReference.toString(state.reference, { icon: false })}` },\n\t\t\t\t\t\treveal: {\n\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\t\texpand: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (button === QuickCommandButtons.RevealInSideBar) {\n\t\t\t\tif (GitReference.isStash(state.reference)) {\n\t\t\t\t\tvoid GitActions.Stash.reveal(state.reference, {\n\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\texpand: true,\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tvoid GitActions.Commit.reveal(state.reference, {\n\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\texpand: true,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\tonDidPressKey: async (quickpick, key) => {\n\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\tvoid (await quickpick.activeItems[0].onDidPressKey(key));\n\t\t},\n\t});\n\tconst selection: StepSelection<typeof step> = yield step;\n\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0] : StepResult.Break;\n}\n\nasync function getShowCommitOrStashFileStepItems<\n\tState extends PartialStepState & {\n\t\trepo: Repository;\n\t\treference: GitLogCommit | GitStashCommit;\n\t\tfileName: string;\n\t},\n>(state: State) {\n\tconst file = state.reference.files.find(f => f.fileName === state.fileName);\n\tif (file == null) return [];\n\n\tconst items: CommandQuickPickItem[] = [\n\t\tnew CommitFilesQuickPickItem(state.reference, undefined, GitUri.getFormattedFilename(state.fileName)),\n\t];\n\n\tlet remotes: GitRemote<RemoteProvider>[] | undefined;\n\n\tlet isStash = false;\n\tif (GitStashCommit.is(state.reference)) {\n\t\tisStash = true;\n\n\t\titems.push(new RevealInSideBarQuickPickItem(state.reference));\n\t} else {\n\t\tremotes = await Container.git.getRemotes(state.repo.path, { sort: true });\n\n\t\titems.push(\n\t\t\tnew RevealInSideBarQuickPickItem(state.reference),\n\t\t\tnew SearchForCommitQuickPickItem(state.reference),\n\n\t\t\tnew CommitApplyFileChangesCommandQuickPickItem(state.reference, file),\n\t\t\tnew CommitRestoreFileChangesCommandQuickPickItem(state.reference, file),\n\t\t);\n\t}\n\n\titems.push(\n\t\tnew CommitOpenChangesCommandQuickPickItem(state.reference, state.fileName),\n\t\tnew CommitOpenChangesWithDiffToolCommandQuickPickItem(state.reference, state.fileName),\n\t\tnew CommitOpenChangesWithWorkingCommandQuickPickItem(state.reference, state.fileName),\n\t);\n\n\tif (file.status !== 'D') {\n\t\titems.push(new CommitOpenFileCommandQuickPickItem(state.reference, file));\n\t}\n\titems.push(new CommitOpenRevisionCommandQuickPickItem(state.reference, file));\n\n\tif (remotes?.length) {\n\t\titems.push(\n\t\t\tnew OpenRemoteResourceCommandQuickPickItem(remotes, {\n\t\t\t\ttype: RemoteResourceType.Revision,\n\t\t\t\tfileName: state.fileName,\n\t\t\t\tcommit: state.reference,\n\t\t\t}),\n\t\t\tnew OpenRemoteResourceCommandQuickPickItem(remotes, {\n\t\t\t\ttype: RemoteResourceType.Commit,\n\t\t\t\tsha: state.reference.ref,\n\t\t\t}),\n\t\t);\n\t}\n\n\titems.push(\n\t\tnew CommitBrowseRepositoryFromHereCommandQuickPickItem(state.reference, { openInNewWindow: false }),\n\t\tnew CommitBrowseRepositoryFromHereCommandQuickPickItem(state.reference, {\n\t\t\tbefore: true,\n\t\t\topenInNewWindow: false,\n\t\t}),\n\t\tnew CommitBrowseRepositoryFromHereCommandQuickPickItem(state.reference, { openInNewWindow: true }),\n\t\tnew CommitBrowseRepositoryFromHereCommandQuickPickItem(state.reference, {\n\t\t\tbefore: true,\n\t\t\topenInNewWindow: true,\n\t\t}),\n\n\t\tnew CommitCompareWithHEADCommandQuickPickItem(state.reference),\n\t\tnew CommitCompareWithWorkingCommandQuickPickItem(state.reference),\n\t);\n\n\tif (!isStash) {\n\t\titems.push(new CommitCopyIdQuickPickItem(state.reference));\n\t}\n\titems.push(new CommitCopyMessageQuickPickItem(state.reference));\n\n\tif (remotes?.length) {\n\t\titems.push(\n\t\t\tnew CopyRemoteResourceCommandQuickPickItem(remotes, {\n\t\t\t\ttype: RemoteResourceType.Commit,\n\t\t\t\tsha: state.reference.sha,\n\t\t\t}),\n\t\t\tnew CopyRemoteResourceCommandQuickPickItem(remotes, {\n\t\t\t\ttype: RemoteResourceType.Revision,\n\t\t\t\tfileName: state.fileName,\n\t\t\t\tcommit: state.reference,\n\t\t\t}),\n\t\t);\n\t}\n\n\treturn items;\n}\n\nexport function* showRepositoryStatusStep<\n\tState extends PartialStepState & { repo: Repository },\n\tContext extends { repos: Repository[]; title: string; status: GitStatus },\n>(state: State, context: Context): StepResultGenerator<CommandQuickPickItem> {\n\tconst upstream = context.status.getUpstreamStatus({ expand: true, separator: ', ' });\n\tconst working = context.status.getFormattedDiffStatus({ expand: true, separator: ', ' });\n\tconst step: QuickPickStep<CommandQuickPickItem> = QuickCommand.createPickStep<CommandQuickPickItem>({\n\t\ttitle: appendReposToTitle(context.title, state, context),\n\t\tplaceholder: `${upstream ? `${upstream}, ${working}` : working}`, //'Changes to be committed',\n\t\tignoreFocusOut: true,\n\t\titems: getShowRepositoryStatusStepItems(state, context),\n\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\tonDidPressKey: async (quickpick, key) => {\n\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\tvoid (await quickpick.activeItems[0].onDidPressKey(key));\n\t\t},\n\t});\n\tconst selection: StepSelection<typeof step> = yield step;\n\treturn QuickCommand.canPickStepContinue(step, state, selection) ? selection[0] : StepResult.Break;\n}\n\nfunction getShowRepositoryStatusStepItems<\n\tState extends PartialStepState & { repo: Repository },\n\tContext extends { repos: Repository[]; title: string; status: GitStatus },\n>(state: State, context: Context) {\n\tconst items: (DirectiveQuickPickItem | CommandQuickPickItem)[] = [];\n\n\tconst computed = context.status.computeWorkingTreeStatus();\n\n\tlet workingTreeStatus;\n\tif (computed.staged === 0 && computed.unstaged === 0) {\n\t\tworkingTreeStatus = 'No working tree changes';\n\t} else {\n\t\tworkingTreeStatus = `$(files) ${\n\t\t\tcomputed.staged ? `${Strings.pluralize('staged file', computed.staged)} (${computed.stagedStatus})` : ''\n\t\t}${\n\t\t\tcomputed.unstaged\n\t\t\t\t? `${computed.staged ? ', ' : ''}${Strings.pluralize('unstaged file', computed.unstaged)} (${\n\t\t\t\t\t\tcomputed.unstagedStatus\n\t\t\t\t  })`\n\t\t\t\t: ''\n\t\t}`;\n\t}\n\n\tif (context.status.upstream) {\n\t\tif (context.status.state.ahead === 0 && context.status.state.behind === 0) {\n\t\t\titems.push(\n\t\t\t\tDirectiveQuickPickItem.create(Directive.Noop, true, {\n\t\t\t\t\tlabel: `$(git-branch) ${context.status.branch} is up to date with $(git-branch) ${context.status.upstream}`,\n\t\t\t\t\tdetail: workingTreeStatus,\n\t\t\t\t}),\n\t\t\t);\n\t\t} else if (context.status.state.ahead !== 0 && context.status.state.behind !== 0) {\n\t\t\titems.push(\n\t\t\t\tDirectiveQuickPickItem.create(Directive.Noop, true, {\n\t\t\t\t\tlabel: `$(git-branch) ${context.status.branch} has diverged from $(git-branch) ${context.status.upstream}`,\n\t\t\t\t\tdetail: workingTreeStatus,\n\t\t\t\t}),\n\t\t\t);\n\t\t} else if (context.status.state.ahead !== 0) {\n\t\t\titems.push(\n\t\t\t\tDirectiveQuickPickItem.create(Directive.Noop, true, {\n\t\t\t\t\tlabel: `$(git-branch) ${context.status.branch} is ahead of $(git-branch) ${context.status.upstream}`,\n\t\t\t\t\tdetail: workingTreeStatus,\n\t\t\t\t}),\n\t\t\t);\n\t\t} else if (context.status.state.behind !== 0) {\n\t\t\titems.push(\n\t\t\t\tDirectiveQuickPickItem.create(Directive.Noop, true, {\n\t\t\t\t\tlabel: `$(git-branch) ${context.status.branch} is behind $(git-branch) ${context.status.upstream}`,\n\t\t\t\t\tdetail: workingTreeStatus,\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tif (context.status.state.behind !== 0) {\n\t\t\titems.push(\n\t\t\t\tnew GitCommandQuickPickItem(\n\t\t\t\t\t`$(cloud-download) ${Strings.pluralize('commit', context.status.state.behind)} behind`,\n\t\t\t\t\t{\n\t\t\t\t\t\tcommand: 'log',\n\t\t\t\t\t\tstate: {\n\t\t\t\t\t\t\trepo: state.repo,\n\t\t\t\t\t\t\treference: GitReference.create(\n\t\t\t\t\t\t\t\tGitRevision.createRange(context.status.ref, context.status.upstream),\n\t\t\t\t\t\t\t\tstate.repo.path,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\tif (context.status.state.ahead !== 0) {\n\t\t\titems.push(\n\t\t\t\tnew GitCommandQuickPickItem(\n\t\t\t\t\t`$(cloud-upload) ${Strings.pluralize('commit', context.status.state.ahead)} ahead`,\n\t\t\t\t\t{\n\t\t\t\t\t\tcommand: 'log',\n\t\t\t\t\t\tstate: {\n\t\t\t\t\t\t\trepo: state.repo,\n\t\t\t\t\t\t\treference: GitReference.create(\n\t\t\t\t\t\t\t\tGitRevision.createRange(context.status.upstream, context.status.ref),\n\t\t\t\t\t\t\t\tstate.repo.path,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t} else {\n\t\titems.push(\n\t\t\tDirectiveQuickPickItem.create(Directive.Noop, true, {\n\t\t\t\tlabel: `$(git-branch) ${context.status.branch} has no upstream`,\n\t\t\t\tdetail: workingTreeStatus,\n\t\t\t}),\n\t\t);\n\t}\n\n\tif (context.status.files.length) {\n\t\titems.push(\n\t\t\tnew OpenChangedFilesCommandQuickPickItem(\n\t\t\t\tcomputed.stagedAddsAndChanges.concat(computed.unstagedAddsAndChanges),\n\t\t\t),\n\t\t);\n\t}\n\n\tif (computed.staged > 0) {\n\t\titems.push(\n\t\t\tnew OpenChangedFilesCommandQuickPickItem(computed.stagedAddsAndChanges, {\n\t\t\t\tlabel: '$(files) Open Staged Files',\n\t\t\t}),\n\t\t);\n\t}\n\n\tif (computed.unstaged > 0) {\n\t\titems.push(\n\t\t\tnew OpenChangedFilesCommandQuickPickItem(computed.unstagedAddsAndChanges, {\n\t\t\t\tlabel: '$(files) Open Unstaged Files',\n\t\t\t}),\n\t\t);\n\t}\n\n\tif (context.status.files.length) {\n\t\titems.push(new CommandQuickPickItem('$(x) Close Unchanged Files', Commands.CloseUnchangedFiles));\n\t}\n\n\treturn items;\n}\n","'use strict';\nimport { InputBox, QuickInputButton, QuickPick, QuickPickItem } from 'vscode';\nimport { Container } from '../container';\nimport { Keys } from '../keyboard';\nimport { Directive, DirectiveQuickPickItem } from '../quickpicks';\n\nexport * from './quickCommand.buttons';\nexport * from './quickCommand.steps';\n\nexport interface QuickInputStep {\n\tadditionalButtons?: QuickInputButton[];\n\tbuttons?: QuickInputButton[];\n\tignoreFocusOut?: boolean;\n\tkeys?: StepNavigationKeys[];\n\tplaceholder?: string;\n\tprompt?: string;\n\ttitle?: string;\n\tvalue?: string;\n\n\tonDidClickButton?(input: InputBox, button: QuickInputButton): boolean | void | Promise<boolean | void>;\n\tonDidPressKey?(quickpick: InputBox, key: Keys): void | Promise<void>;\n\tvalidate?(value: string | undefined): [boolean, string | undefined] | Promise<[boolean, string | undefined]>;\n}\n\nexport function isQuickInputStep(\n\tstep: QuickPickStep | QuickInputStep | typeof StepResult.Break,\n): step is QuickInputStep {\n\treturn typeof step === 'object' && (step as QuickPickStep).items == null;\n}\n\nexport interface QuickPickStep<T extends QuickPickItem = QuickPickItem> {\n\tadditionalButtons?: QuickInputButton[];\n\tallowEmpty?: boolean;\n\tbuttons?: QuickInputButton[];\n\tignoreFocusOut?: boolean;\n\titems: (DirectiveQuickPickItem | T)[]; // | DirectiveQuickPickItem[];\n\tkeys?: StepNavigationKeys[];\n\tmatchOnDescription?: boolean;\n\tmatchOnDetail?: boolean;\n\tmultiselect?: boolean;\n\tplaceholder?: string;\n\tselectedItems?: QuickPickItem[];\n\ttitle?: string;\n\tvalue?: string;\n\n\tonDidAccept?(quickpick: QuickPick<T>): boolean | Promise<boolean>;\n\tonDidChangeValue?(quickpick: QuickPick<T>): boolean | Promise<boolean>;\n\tonDidClickButton?(quickpick: QuickPick<T>, button: QuickInputButton): boolean | void | Promise<boolean | void>;\n\tonDidLoadMore?(quickpick: QuickPick<T>): (DirectiveQuickPickItem | T)[] | Promise<(DirectiveQuickPickItem | T)[]>;\n\tonDidPressKey?(quickpick: QuickPick<T>, key: Keys): void | Promise<void>;\n\tonValidateValue?(quickpick: QuickPick<T>, value: string, items: T[]): boolean | Promise<boolean>;\n\tvalidate?(selection: T[]): boolean;\n}\n\nexport function isQuickPickStep(step: QuickPickStep | QuickInputStep | typeof StepResult.Break): step is QuickPickStep {\n\treturn typeof step === 'object' && (step as QuickPickStep).items != null;\n}\n\nexport type StepGenerator =\n\t| Generator<QuickPickStep | QuickInputStep, StepResult<void | undefined>, any | undefined>\n\t| AsyncGenerator<QuickPickStep | QuickInputStep, StepResult<void | undefined>, any | undefined>;\n\nexport type StepItemType<T> = T extends QuickPickStep<infer U> ? U[] : T extends QuickInputStep ? string : never;\nexport type StepNavigationKeys = Exclude<Keys, 'left' | 'alt+left' | 'ctrl+left'>;\nexport namespace StepResult {\n\texport const Break = Symbol('BreakStep');\n}\nexport type StepResult<T> = typeof StepResult.Break | T;\nexport type StepResultGenerator<T> = Generator<QuickPickStep | QuickInputStep, StepResult<T>, any | undefined>;\nexport type AsyncStepResultGenerator<T> = AsyncGenerator<\n\tQuickPickStep | QuickInputStep,\n\tStepResult<T>,\n\tany | undefined\n>;\n// Can't use this union type because of https://github.com/microsoft/TypeScript/issues/41428\n// export type StepResultGenerator<T> =\n// \t| Generator<QuickPickStep | QuickInputStep, StepResult<T>, any | undefined>\n// \t| AsyncGenerator<QuickPickStep | QuickInputStep, StepResult<T>, any | undefined>;\nexport type StepSelection<T> = T extends QuickPickStep<infer U>\n\t? U[] | Directive\n\t: T extends QuickInputStep\n\t? string | Directive\n\t: never;\nexport type PartialStepState<T = unknown> = Partial<T> & { counter: number; confirm?: boolean; startingStep?: number };\nexport type StepState<T = Record<string, unknown>> = T & { counter: number; confirm?: boolean; startingStep?: number };\n\nexport abstract class QuickCommand<State = any> implements QuickPickItem {\n\treadonly description?: string;\n\treadonly detail?: string;\n\n\tprotected initialState: PartialStepState<State> | undefined;\n\n\tprivate _currentStep: QuickPickStep | QuickInputStep | undefined;\n\tprivate _stepsIterator: StepGenerator | undefined;\n\n\tconstructor(\n\t\tpublic readonly key: string,\n\t\tpublic readonly label: string,\n\t\tpublic readonly title: string,\n\t\toptions: {\n\t\t\tdescription?: string;\n\t\t\tdetail?: string;\n\t\t} = {},\n\t) {\n\t\tthis.description = options.description;\n\t\tthis.detail = options.detail;\n\t}\n\n\tget canConfirm(): boolean {\n\t\treturn true;\n\t}\n\n\tget canSkipConfirm(): boolean {\n\t\treturn true;\n\t}\n\n\tprivate _picked: boolean = false;\n\tget picked() {\n\t\treturn this._picked;\n\t}\n\tset picked(value: boolean) {\n\t\tthis._picked = value;\n\t\tif (!value) {\n\t\t\tthis._pickedVia = 'menu';\n\t\t}\n\t}\n\n\tprivate _pickedVia: 'menu' | 'command' = 'menu';\n\tget pickedVia() {\n\t\treturn this._pickedVia;\n\t}\n\tset pickedVia(value: 'menu' | 'command') {\n\t\tthis._pickedVia = value;\n\t}\n\n\tget skipConfirmKey(): string {\n\t\treturn `${this.key}:${this.pickedVia}`;\n\t}\n\n\tget value(): QuickPickStep | QuickInputStep | undefined {\n\t\treturn this._currentStep;\n\t}\n\n\tconfirm(override?: boolean) {\n\t\tif (!this.canConfirm || !this.canSkipConfirm) return true;\n\n\t\treturn override != null\n\t\t\t? override\n\t\t\t: !Container.config.gitCommands.skipConfirmations.includes(this.skipConfirmKey);\n\t}\n\n\tisMatch(key: string) {\n\t\treturn this.key === key;\n\t}\n\n\tisFuzzyMatch(name: string) {\n\t\treturn this.label === name;\n\t}\n\n\tprotected abstract steps(state: PartialStepState<State>): StepGenerator;\n\n\texecuteSteps() {\n\t\t// When we are chaining steps together, limit backward navigation to feel more natural\n\t\treturn this.steps(this.getStepState(true));\n\t}\n\n\tasync previous(): Promise<QuickPickStep | QuickInputStep | undefined> {\n\t\treturn (await this.next(Directive.Back)).value;\n\t}\n\n\tasync next(value?: StepSelection<any>): Promise<IteratorResult<QuickPickStep | QuickInputStep | undefined>> {\n\t\tif (this._stepsIterator == null) {\n\t\t\tthis._stepsIterator = this.steps(this.getStepState(false));\n\t\t}\n\n\t\tconst result = await this._stepsIterator.next(value);\n\t\tif (result.done) {\n\t\t\tthis.initialState = undefined;\n\t\t\tthis._stepsIterator = undefined;\n\t\t}\n\n\t\tif (result.value === StepResult.Break) {\n\t\t\tthis._currentStep = undefined;\n\t\t\treturn { ...result, value: undefined };\n\t\t}\n\n\t\tthis._currentStep = result.value as Exclude<typeof result.value, void | typeof StepResult.Break>;\n\t\treturn result;\n\t}\n\n\tasync retry(): Promise<QuickPickStep | QuickInputStep | undefined> {\n\t\tawait this.next(Directive.Back);\n\t\tawait this.next();\n\t\treturn this.value;\n\t}\n\n\tprotected canStepsContinue(state: PartialStepState) {\n\t\treturn state.counter >= (state.startingStep ?? 0);\n\t}\n\n\tprotected createConfirmStep<T extends QuickPickItem>(\n\t\ttitle: string,\n\t\tconfirmations: T[],\n\t\tcancel?: DirectiveQuickPickItem,\n\t\toptions: Partial<QuickPickStep<T>> = {},\n\t): QuickPickStep<T> {\n\t\treturn QuickCommand.createConfirmStep(title, confirmations, { title: this.title }, cancel, options);\n\t}\n\n\tprotected getStepState(limitBackNavigation: boolean): PartialStepState<State> {\n\t\t// Set the minimum step to be our initial counter, so that the back button will work as expected\n\t\t// eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n\t\treturn {\n\t\t\tcounter: 0,\n\t\t\t...this.initialState,\n\t\t\tstartingStep: limitBackNavigation ? this.initialState?.counter ?? 0 : 0,\n\t\t} as PartialStepState<State>;\n\t}\n}\n\nexport namespace QuickCommand {\n\texport function is(item: QuickPickItem): item is QuickCommand {\n\t\treturn item instanceof QuickCommand;\n\t}\n\n\texport async function canInputStepContinue<T extends QuickInputStep>(\n\t\tstep: T,\n\t\tstate: PartialStepState,\n\t\tvalue: Directive | StepItemType<T>,\n\t) {\n\t\tif (!canStepContinue(step, state, value)) return false;\n\n\t\tconst [valid] = (await step.validate?.(value)) ?? [true];\n\t\tif (valid) {\n\t\t\tstate.counter++;\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\texport function canPickStepContinue<T extends QuickPickStep>(\n\t\tstep: T,\n\t\tstate: PartialStepState,\n\t\tselection: StepItemType<T> | Directive,\n\t): selection is StepItemType<T> {\n\t\tif (!canStepContinue(step, state, selection)) return false;\n\n\t\tif (step.validate?.(selection) ?? true) {\n\t\t\tstate.counter++;\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\texport function canStepContinue<T extends QuickInputStep | QuickPickStep>(\n\t\tstep: T,\n\t\tstate: PartialStepState,\n\t\tresult: Directive | StepItemType<T>,\n\t): result is StepItemType<T> {\n\t\tif (result == null) return false;\n\t\tif (Directive.is(result)) {\n\t\t\tswitch (result) {\n\t\t\t\tcase Directive.Back:\n\t\t\t\t\tstate.counter--;\n\t\t\t\t\tif (state.counter <= (state.startingStep ?? 0)) {\n\t\t\t\t\t\tstate.counter = 0;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase Directive.Cancel:\n\t\t\t\t\tendSteps(state);\n\t\t\t\t\tbreak;\n\t\t\t\tcase Directive.Noop:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\texport function createConfirmStep<T extends QuickPickItem, Context extends { title: string }>(\n\t\ttitle: string,\n\t\tconfirmations: T[],\n\t\tcontext: Context,\n\t\tcancel?: DirectiveQuickPickItem,\n\t\toptions: Partial<QuickPickStep<T>> = {},\n\t): QuickPickStep<T> {\n\t\treturn createPickStep<T>({\n\t\t\tplaceholder: `Confirm ${context.title}`,\n\t\t\ttitle: title,\n\t\t\tignoreFocusOut: true,\n\t\t\titems: [...confirmations, cancel ?? DirectiveQuickPickItem.create(Directive.Cancel)],\n\t\t\tselectedItems: [confirmations.find(c => c.picked) ?? confirmations[0]],\n\t\t\t...options,\n\t\t});\n\t}\n\n\texport function createInputStep(step: QuickInputStep): QuickInputStep {\n\t\t// Make sure any input steps won't close on focus loss\n\t\tstep.ignoreFocusOut = true;\n\t\treturn step;\n\t}\n\n\texport function createPickStep<T extends QuickPickItem>(step: QuickPickStep<T>): QuickPickStep<T> {\n\t\treturn step;\n\t}\n\n\texport function endSteps(state: PartialStepState) {\n\t\tstate.counter = -1;\n\t}\n}\n","'use strict';\nimport { TextEditor, Uri } from 'vscode';\n\nabstract class Comparer<T> {\n\tabstract equals(lhs: T, rhs: T): boolean;\n}\n\nclass UriComparer extends Comparer<Uri> {\n\tequals(lhs: Uri | undefined, rhs: Uri | undefined, options: { exact?: boolean } = { exact: false }) {\n\t\tif (lhs === rhs) return true;\n\t\tif (lhs == null || rhs == null) return false;\n\n\t\tif (options.exact) {\n\t\t\treturn lhs.toString() === rhs.toString();\n\t\t}\n\t\treturn lhs.scheme === rhs.scheme && lhs.fsPath === rhs.fsPath;\n\t}\n}\n\nclass TextEditorComparer extends Comparer<TextEditor> {\n\tequals(\n\t\tlhs: TextEditor | undefined,\n\t\trhs: TextEditor | undefined,\n\t\toptions: { usePosition: boolean } = { usePosition: false },\n\t) {\n\t\tif (lhs === rhs) return true;\n\t\tif (lhs == null || rhs == null) return false;\n\n\t\tif (options.usePosition && lhs.viewColumn !== rhs.viewColumn) return false;\n\n\t\treturn lhs.document === rhs.document;\n\t}\n}\n\nconst textEditorComparer = new TextEditorComparer();\nconst uriComparer = new UriComparer();\nexport { textEditorComparer as TextEditorComparer, uriComparer as UriComparer };\n","'use strict';\n\nexport enum TraceLevel {\n\tSilent = 'silent',\n\tErrors = 'errors',\n\tVerbose = 'verbose',\n\tDebug = 'debug',\n}\n\nexport interface Config {\n\tautolinks: AutolinkReference[] | null;\n\tblame: {\n\t\tavatars: boolean;\n\t\tcompact: boolean;\n\t\tdateFormat: string | null;\n\t\tformat: string;\n\t\theatmap: {\n\t\t\tenabled: boolean;\n\t\t\tlocation: 'left' | 'right';\n\t\t};\n\t\thighlight: {\n\t\t\tenabled: boolean;\n\t\t\tlocations: BlameHighlightLocations[];\n\t\t};\n\t\tignoreWhitespace: boolean;\n\t\tseparateLines: boolean;\n\t\ttoggleMode: AnnotationsToggleMode;\n\t};\n\tchanges: {\n\t\tlocations: ChangesLocations[];\n\t\ttoggleMode: AnnotationsToggleMode;\n\t};\n\tcodeLens: CodeLensConfig;\n\tcurrentLine: {\n\t\tdateFormat: string | null;\n\t\tenabled: boolean;\n\t\tformat: string;\n\t\tpullRequests: {\n\t\t\tenabled: boolean;\n\t\t};\n\t\tscrollable: boolean;\n\t};\n\tdebug: boolean;\n\tdefaultDateFormat: string | null;\n\tdefaultDateShortFormat: string | null;\n\tdefaultDateSource: DateSource;\n\tdefaultDateStyle: DateStyle;\n\tdefaultGravatarsStyle: GravatarDefaultStyle;\n\tdefaultTimeFormat: string | null;\n\tfileAnnotations: {\n\t\tcommand: string | null;\n\t};\n\tgitCommands: {\n\t\tcloseOnFocusOut: boolean;\n\t\tsearch: {\n\t\t\tmatchAll: boolean;\n\t\t\tmatchCase: boolean;\n\t\t\tmatchRegex: boolean;\n\t\t\tshowResultsInSideBar: boolean | null;\n\t\t};\n\t\tskipConfirmations: string[];\n\t\tsortBy: GitCommandSorting;\n\t};\n\theatmap: {\n\t\tageThreshold: number;\n\t\tcoldColor: string;\n\t\thotColor: string;\n\t\tlocations: HeatmapLocations[];\n\t\ttoggleMode: AnnotationsToggleMode;\n\t};\n\thovers: {\n\t\tannotations: {\n\t\t\tchanges: boolean;\n\t\t\tdetails: boolean;\n\t\t\tenabled: boolean;\n\t\t\tover: 'line' | 'annotation';\n\t\t};\n\t\tautolinks: {\n\t\t\tenabled: boolean;\n\t\t\tenhanced: boolean;\n\t\t};\n\t\tcurrentLine: {\n\t\t\tchanges: boolean;\n\t\t\tdetails: boolean;\n\t\t\tenabled: boolean;\n\t\t\tover: 'line' | 'annotation';\n\t\t};\n\t\tavatars: boolean;\n\t\tavatarSize: number;\n\t\tchangesDiff: 'line' | 'hunk';\n\t\tdetailsMarkdownFormat: string;\n\t\tenabled: boolean;\n\t\tpullRequests: {\n\t\t\tenabled: boolean;\n\t\t};\n\t};\n\tintegrations: {\n\t\tenabled: boolean;\n\t};\n\tkeymap: KeyMap;\n\tliveshare: {\n\t\tallowGuestAccess: boolean;\n\t};\n\tmenus: boolean | MenuConfig;\n\tmode: {\n\t\tactive: string;\n\t\tstatusBar: {\n\t\t\tenabled: boolean;\n\t\t\talignment: 'left' | 'right';\n\t\t};\n\t};\n\tmodes: Record<string, ModeConfig> | null;\n\toutputLevel: TraceLevel;\n\tpartners: Record<\n\t\tstring,\n\t\t{\n\t\t\tenabled: boolean;\n\t\t\t[key: string]: any;\n\t\t}\n\t> | null;\n\tremotes: RemotesConfig[] | null;\n\tshowWelcomeOnInstall: boolean;\n\tshowWhatsNewAfterUpgrades: boolean;\n\tsortBranchesBy: BranchSorting;\n\tsortContributorsBy: ContributorSorting;\n\tsortTagsBy: TagSorting;\n\tstatusBar: {\n\t\talignment: 'left' | 'right';\n\t\tcommand: StatusBarCommand;\n\t\tdateFormat: string | null;\n\t\tenabled: boolean;\n\t\tformat: string;\n\t\treduceFlicker: boolean;\n\t\tpullRequests: {\n\t\t\tenabled: boolean;\n\t\t};\n\t};\n\tstrings: {\n\t\tcodeLens: {\n\t\t\tunsavedChanges: {\n\t\t\t\trecentChangeAndAuthors: string;\n\t\t\t\trecentChangeOnly: string;\n\t\t\t\tauthorsOnly: string;\n\t\t\t};\n\t\t};\n\t};\n\tterminalLinks: {\n\t\tenabled: boolean;\n\t};\n\tviews: ViewsConfig;\n\tadvanced: AdvancedConfig;\n}\n\nexport enum AnnotationsToggleMode {\n\tFile = 'file',\n\tWindow = 'window',\n}\n\nexport interface AutolinkReference {\n\tprefix: string;\n\turl: string;\n\ttitle?: string;\n\talphanumeric?: boolean;\n\tignoreCase?: boolean;\n}\n\nexport enum BlameHighlightLocations {\n\tGutter = 'gutter',\n\tLine = 'line',\n\tOverview = 'overview',\n}\n\nexport enum BranchSorting {\n\tDateDesc = 'date:desc',\n\tDateAsc = 'date:asc',\n\tNameAsc = 'name:asc',\n\tNameDesc = 'name:desc',\n}\n\nexport enum ChangesLocations {\n\tGutter = 'gutter',\n\tOverview = 'overview',\n}\n\nexport enum CodeLensCommand {\n\tCopyRemoteCommitUrl = 'gitlens.copyRemoteCommitUrl',\n\tCopyRemoteFileUrl = 'gitlens.copyRemoteFileUrl',\n\tDiffWithPrevious = 'gitlens.diffWithPrevious',\n\tOpenCommitOnRemote = 'gitlens.openCommitOnRemote',\n\tOpenFileOnRemote = 'gitlens.openFileOnRemote',\n\tRevealCommitInView = 'gitlens.revealCommitInView',\n\tShowCommitsInView = 'gitlens.showCommitsInView',\n\tShowQuickCommitDetails = 'gitlens.showQuickCommitDetails',\n\tShowQuickCommitFileDetails = 'gitlens.showQuickCommitFileDetails',\n\tShowQuickCurrentBranchHistory = 'gitlens.showQuickRepoHistory',\n\tShowQuickFileHistory = 'gitlens.showQuickFileHistory',\n\tToggleFileBlame = 'gitlens.toggleFileBlame',\n\tToggleFileChanges = 'gitlens.toggleFileChanges',\n\tToggleFileChangesOnly = 'gitlens.toggleFileChangesOnly',\n\tToggleFileHeatmap = 'gitlens.toggleFileHeatmap',\n}\n\nexport enum CodeLensScopes {\n\tDocument = 'document',\n\tContainers = 'containers',\n\tBlocks = 'blocks',\n}\n\nexport enum ContributorSorting {\n\tCountDesc = 'count:desc',\n\tCountAsc = 'count:asc',\n\tDateDesc = 'date:desc',\n\tDateAsc = 'date:asc',\n\tNameAsc = 'name:asc',\n\tNameDesc = 'name:desc',\n}\n\nexport enum CustomRemoteType {\n\tBitbucket = 'Bitbucket',\n\tBitbucketServer = 'BitbucketServer',\n\tCustom = 'Custom',\n\tGitea = 'Gitea',\n\tGitHub = 'GitHub',\n\tGitLab = 'GitLab',\n}\n\nexport enum DateSource {\n\tAuthored = 'authored',\n\tCommitted = 'committed',\n}\n\nexport enum DateStyle {\n\tAbsolute = 'absolute',\n\tRelative = 'relative',\n}\n\nexport enum FileAnnotationType {\n\tBlame = 'blame',\n\tChanges = 'changes',\n\tHeatmap = 'heatmap',\n}\n\nexport enum GitCommandSorting {\n\tName = 'name',\n\tUsage = 'usage',\n}\n\nexport enum GravatarDefaultStyle {\n\tFaces = 'wavatar',\n\tGeometric = 'identicon',\n\tMonster = 'monsterid',\n\tMysteryPerson = 'mp',\n\tRetro = 'retro',\n\tRobot = 'robohash',\n}\n\nexport enum HeatmapLocations {\n\tGutter = 'gutter',\n\tOverview = 'overview',\n}\n\nexport enum KeyMap {\n\tAlternate = 'alternate',\n\tChorded = 'chorded',\n\tNone = 'none',\n}\n\nexport enum StatusBarCommand {\n\tCopyRemoteCommitUrl = 'gitlens.copyRemoteCommitUrl',\n\tCopyRemoteFileUrl = 'gitlens.copyRemoteFileUrl',\n\tDiffWithPrevious = 'gitlens.diffWithPrevious',\n\tDiffWithWorking = 'gitlens.diffWithWorking',\n\tOpenCommitOnRemote = 'gitlens.openCommitOnRemote',\n\tOpenFileOnRemote = 'gitlens.openFileOnRemote',\n\tRevealCommitInView = 'gitlens.revealCommitInView',\n\tShowCommitsInView = 'gitlens.showCommitsInView',\n\tShowQuickCommitDetails = 'gitlens.showQuickCommitDetails',\n\tShowQuickCommitFileDetails = 'gitlens.showQuickCommitFileDetails',\n\tShowQuickCurrentBranchHistory = 'gitlens.showQuickRepoHistory',\n\tShowQuickFileHistory = 'gitlens.showQuickFileHistory',\n\tToggleCodeLens = 'gitlens.toggleCodeLens',\n\tToggleFileBlame = 'gitlens.toggleFileBlame',\n\tToggleFileChanges = 'gitlens.toggleFileChanges',\n\tToggleFileChangesOnly = 'gitlens.toggleFileChangesOnly',\n\tToggleFileHeatmap = 'gitlens.toggleFileHeatmap',\n}\n\nexport enum TagSorting {\n\tDateDesc = 'date:desc',\n\tDateAsc = 'date:asc',\n\tNameAsc = 'name:asc',\n\tNameDesc = 'name:desc',\n}\n\nexport enum ViewBranchesLayout {\n\tList = 'list',\n\tTree = 'tree',\n}\n\nexport enum ViewFilesLayout {\n\tAuto = 'auto',\n\tList = 'list',\n\tTree = 'tree',\n}\n\nexport enum ViewShowBranchComparison {\n\tBranch = 'branch',\n\tWorking = 'working',\n}\n\nexport interface AdvancedConfig {\n\tabbreviatedShaLength: number;\n\tabbreviateShaOnCopy: boolean;\n\tblame: {\n\t\tcustomArguments: string[] | null;\n\t\tdelayAfterEdit: number;\n\t\tsizeThresholdAfterEdit: number;\n\t};\n\tcaching: {\n\t\tenabled: boolean;\n\t};\n\tcommitOrdering: string | null;\n\texternalDiffTool: string | null;\n\texternalDirectoryDiffTool: string | null;\n\tfileHistoryFollowsRenames: boolean;\n\tfileHistoryShowAllBranches: boolean;\n\tmaxListItems: number;\n\tmaxSearchItems: number;\n\tmessages: {\n\t\tsuppressCommitHasNoPreviousCommitWarning: boolean;\n\t\tsuppressCommitNotFoundWarning: boolean;\n\t\tsuppressCreatePullRequestPrompt: boolean;\n\t\tsuppressDebugLoggingWarning: boolean;\n\t\tsuppressFileNotUnderSourceControlWarning: boolean;\n\t\tsuppressGitDisabledWarning: boolean;\n\t\tsuppressGitMissingWarning: boolean;\n\t\tsuppressGitVersionWarning: boolean;\n\t\tsuppressImproperWorkspaceCasingWarning: boolean;\n\t\tsuppressLineUncommittedWarning: boolean;\n\t\tsuppressNoRepositoryWarning: boolean;\n\t\tsuppressRebaseSwitchToTextWarning: boolean;\n\t};\n\tquickPick: {\n\t\tcloseOnFocusOut: boolean;\n\t};\n\trepositorySearchDepth: number;\n\tsimilarityThreshold: number | null;\n}\n\nexport interface CodeLensConfig {\n\tauthors: {\n\t\tenabled: boolean;\n\t\tcommand: CodeLensCommand | false;\n\t};\n\tenabled: boolean;\n\tincludeSingleLineSymbols: boolean;\n\trecentChange: {\n\t\tenabled: boolean;\n\t\tcommand: CodeLensCommand | false;\n\t};\n\tscopes: CodeLensScopes[];\n\tscopesByLanguage: CodeLensLanguageScope[] | null;\n\tsymbolScopes: string[];\n}\n\nexport interface CodeLensLanguageScope {\n\tlanguage: string | undefined;\n\tscopes?: CodeLensScopes[];\n\tsymbolScopes?: string[];\n}\n\nexport interface MenuConfig {\n\teditor:\n\t\t| false\n\t\t| {\n\t\t\t\tblame: boolean;\n\t\t\t\tclipboard: boolean;\n\t\t\t\tcompare: boolean;\n\t\t\t\thistory: boolean;\n\t\t\t\tremote: boolean;\n\t\t  };\n\teditorGroup:\n\t\t| false\n\t\t| {\n\t\t\t\tblame: boolean;\n\t\t\t\tcompare: boolean;\n\t\t  };\n\teditorTab:\n\t\t| false\n\t\t| {\n\t\t\t\tclipboard: boolean;\n\t\t\t\tcompare: boolean;\n\t\t\t\thistory: boolean;\n\t\t\t\tremote: boolean;\n\t\t  };\n\texplorer:\n\t\t| false\n\t\t| {\n\t\t\t\tclipboard: boolean;\n\t\t\t\tcompare: boolean;\n\t\t\t\thistory: boolean;\n\t\t\t\tremote: boolean;\n\t\t  };\n\tscm:\n\t\t| false\n\t\t| {\n\t\t\t\tauthors: boolean;\n\t\t  };\n\tscmGroupInline:\n\t\t| false\n\t\t| {\n\t\t\t\tstash: boolean;\n\t\t  };\n\tscmGroup:\n\t\t| false\n\t\t| {\n\t\t\t\tcompare: boolean;\n\t\t\t\topenClose: boolean;\n\t\t\t\tstash: boolean;\n\t\t  };\n\tscmItem:\n\t\t| false\n\t\t| {\n\t\t\t\tclipboard: boolean;\n\t\t\t\tcompare: boolean;\n\t\t\t\thistory: boolean;\n\t\t\t\tremote: boolean;\n\t\t\t\tstash: boolean;\n\t\t  };\n}\n\nexport interface ModeConfig {\n\tname: string;\n\tstatusBarItemName?: string;\n\tdescription?: string;\n\tannotations?: 'blame' | 'changes' | 'heatmap';\n\tcodeLens?: boolean;\n\tcurrentLine?: boolean;\n\thovers?: boolean;\n\tstatusBar?: boolean;\n}\n\nexport type RemotesConfig =\n\t| {\n\t\t\tdomain: string;\n\t\t\tregex: null;\n\t\t\tname?: string;\n\t\t\tprotocol?: string;\n\t\t\ttype: CustomRemoteType;\n\t\t\turls?: RemotesUrlsConfig;\n\t  }\n\t| {\n\t\t\tdomain: null;\n\t\t\tregex: string;\n\t\t\tname?: string;\n\t\t\tprotocol?: string;\n\t\t\ttype: CustomRemoteType;\n\t\t\turls?: RemotesUrlsConfig;\n\t  };\n\nexport interface RemotesUrlsConfig {\n\trepository: string;\n\tbranches: string;\n\tbranch: string;\n\tcommit: string;\n\tcomparison?: string;\n\tfile: string;\n\tfileInBranch: string;\n\tfileInCommit: string;\n\tfileLine: string;\n\tfileRange: string;\n}\n\nexport interface ViewsCommonConfig {\n\tdefaultItemLimit: number;\n\tformats: {\n\t\tcommits: {\n\t\t\tlabel: string;\n\t\t\tdescription: string;\n\t\t};\n\t\tfiles: {\n\t\t\tlabel: string;\n\t\t\tdescription: string;\n\t\t};\n\t\tstashes: {\n\t\t\tlabel: string;\n\t\t\tdescription: string;\n\t\t};\n\t};\n\tpageItemLimit: number;\n\tshowRelativeDateMarkers: boolean;\n}\n\nexport const viewsCommonConfigKeys: (keyof ViewsCommonConfig)[] = [\n\t'defaultItemLimit',\n\t'formats',\n\t'pageItemLimit',\n\t'showRelativeDateMarkers',\n];\n\ninterface ViewsConfigs {\n\tbranches: BranchesViewConfig;\n\tcommits: CommitsViewConfig;\n\tcontributors: ContributorsViewConfig;\n\tfileHistory: FileHistoryViewConfig;\n\tlineHistory: LineHistoryViewConfig;\n\tremotes: RemotesViewConfig;\n\trepositories: RepositoriesViewConfig;\n\tsearchAndCompare: SearchAndCompareViewConfig;\n\tstashes: StashesViewConfig;\n\ttags: TagsViewConfig;\n}\n\nexport type ViewsConfigKeys = keyof ViewsConfigs;\nexport const viewsConfigKeys: ViewsConfigKeys[] = [\n\t'commits',\n\t'repositories',\n\t'fileHistory',\n\t'lineHistory',\n\t'branches',\n\t'remotes',\n\t'stashes',\n\t'tags',\n\t'contributors',\n\t'searchAndCompare',\n];\n\nexport type ViewsConfig = ViewsCommonConfig & ViewsConfigs;\n\nexport interface BranchesViewConfig {\n\tavatars: boolean;\n\tbranches: {\n\t\tlayout: ViewBranchesLayout;\n\t};\n\tfiles: ViewsFilesConfig;\n\tpullRequests: {\n\t\tenabled: boolean;\n\t\tshowForBranches: boolean;\n\t\tshowForCommits: boolean;\n\t};\n\treveal: boolean;\n\tshowBranchComparison: false | ViewShowBranchComparison.Branch;\n}\n\nexport interface CommitsViewConfig {\n\tavatars: boolean;\n\tbranches: undefined;\n\tfiles: ViewsFilesConfig;\n\tpullRequests: {\n\t\tenabled: boolean;\n\t\tshowForBranches: boolean;\n\t\tshowForCommits: boolean;\n\t};\n\treveal: boolean;\n\tshowBranchComparison: false | ViewShowBranchComparison;\n}\n\nexport interface ContributorsViewConfig {\n\tavatars: boolean;\n\tfiles: ViewsFilesConfig;\n\tpullRequests: {\n\t\tenabled: boolean;\n\t\tshowForCommits: boolean;\n\t};\n\tshowAllBranches: boolean;\n\tshowStatistics: boolean;\n}\n\nexport interface FileHistoryViewConfig {\n\tavatars: boolean;\n\tfiles: ViewsFilesConfig;\n}\n\nexport interface LineHistoryViewConfig {\n\tavatars: boolean;\n}\n\nexport interface RemotesViewConfig {\n\tavatars: boolean;\n\tbranches: {\n\t\tlayout: ViewBranchesLayout;\n\t};\n\tfiles: ViewsFilesConfig;\n\tpullRequests: {\n\t\tenabled: boolean;\n\t\tshowForBranches: boolean;\n\t\tshowForCommits: boolean;\n\t};\n\treveal: boolean;\n}\n\nexport interface RepositoriesViewConfig {\n\tautoRefresh: boolean;\n\tautoReveal: boolean;\n\tavatars: boolean;\n\tbranches: {\n\t\tlayout: ViewBranchesLayout;\n\t\tshowBranchComparison: false | ViewShowBranchComparison.Branch;\n\t};\n\tcompact: boolean;\n\tfiles: ViewsFilesConfig;\n\tincludeWorkingTree: boolean;\n\tpullRequests: {\n\t\tenabled: boolean;\n\t\tshowForBranches: boolean;\n\t\tshowForCommits: boolean;\n\t};\n\tshowBranchComparison: false | ViewShowBranchComparison;\n\tshowBranches: boolean;\n\tshowCommits: boolean;\n\tshowContributors: boolean;\n\tshowIncomingActivity: boolean;\n\tshowRemotes: boolean;\n\tshowStashes: boolean;\n\tshowTags: boolean;\n\tshowUpstreamStatus: boolean;\n}\n\nexport interface SearchAndCompareViewConfig {\n\tavatars: boolean;\n\tfiles: ViewsFilesConfig;\n\tpullRequests: {\n\t\tenabled: boolean;\n\t\tshowForCommits: boolean;\n\t};\n}\n\nexport interface StashesViewConfig {\n\tfiles: ViewsFilesConfig;\n\treveal: boolean;\n}\n\nexport interface TagsViewConfig {\n\tavatars: boolean;\n\tbranches: {\n\t\tlayout: ViewBranchesLayout;\n\t};\n\tfiles: ViewsFilesConfig;\n\treveal: boolean;\n}\n\nexport interface ViewsFilesConfig {\n\tcompact: boolean;\n\tlayout: ViewFilesLayout;\n\tthreshold: number;\n}\n","'use strict';\nexport * from './config';\n\nimport {\n\tConfigurationChangeEvent,\n\tConfigurationScope,\n\tConfigurationTarget,\n\tEvent,\n\tEventEmitter,\n\tExtensionContext,\n\tworkspace,\n} from 'vscode';\nimport { Config } from './config';\nimport { Objects } from './system';\n\nconst configPrefix = 'gitlens';\n\nexport interface ConfigurationWillChangeEvent {\n\tchange: ConfigurationChangeEvent;\n\ttransform?(e: ConfigurationChangeEvent): ConfigurationChangeEvent;\n}\n\nexport class Configuration {\n\tstatic configure(context: ExtensionContext): void {\n\t\tcontext.subscriptions.push(\n\t\t\tworkspace.onDidChangeConfiguration(configuration.onConfigurationChanged, configuration),\n\t\t);\n\t}\n\n\tprivate _onDidChange = new EventEmitter<ConfigurationChangeEvent>();\n\tget onDidChange(): Event<ConfigurationChangeEvent> {\n\t\treturn this._onDidChange.event;\n\t}\n\n\tprivate _onDidChangeAny = new EventEmitter<ConfigurationChangeEvent>();\n\tget onDidChangeAny(): Event<ConfigurationChangeEvent> {\n\t\treturn this._onDidChangeAny.event;\n\t}\n\n\tprivate _onWillChange = new EventEmitter<ConfigurationWillChangeEvent>();\n\tget onWillChange(): Event<ConfigurationWillChangeEvent> {\n\t\treturn this._onWillChange.event;\n\t}\n\n\tprivate onConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tif (!e.affectsConfiguration(configPrefix)) {\n\t\t\tthis._onDidChangeAny.fire(e);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst evt: ConfigurationWillChangeEvent = {\n\t\t\tchange: e,\n\t\t};\n\t\tthis._onWillChange.fire(evt);\n\n\t\tif (evt.transform !== undefined) {\n\t\t\te = evt.transform(e);\n\t\t}\n\n\t\tthis._onDidChangeAny.fire(e);\n\t\tthis._onDidChange.fire(e);\n\t}\n\n\tget(): Config;\n\tget<T extends ConfigPath>(\n\t\tsection: T,\n\t\tscope?: ConfigurationScope | null,\n\t\tdefaultValue?: ConfigPathValue<T>,\n\t): ConfigPathValue<T>;\n\tget<T extends ConfigPath>(\n\t\tsection?: T,\n\t\tscope?: ConfigurationScope | null,\n\t\tdefaultValue?: ConfigPathValue<T>,\n\t): Config | ConfigPathValue<T> {\n\t\treturn defaultValue === undefined\n\t\t\t? workspace\n\t\t\t\t\t.getConfiguration(section === undefined ? undefined : configPrefix, scope)\n\t\t\t\t\t.get<ConfigPathValue<T>>(section === undefined ? configPrefix : section)!\n\t\t\t: workspace\n\t\t\t\t\t.getConfiguration(section === undefined ? undefined : configPrefix, scope)\n\t\t\t\t\t.get<ConfigPathValue<T>>(section === undefined ? configPrefix : section, defaultValue)!;\n\t}\n\n\tgetAny<T>(section: string, scope?: ConfigurationScope | null): T | undefined;\n\tgetAny<T>(section: string, scope: ConfigurationScope | null | undefined, defaultValue: T): T;\n\tgetAny<T>(section: string, scope?: ConfigurationScope | null, defaultValue?: T): T | undefined {\n\t\treturn defaultValue === undefined\n\t\t\t? workspace.getConfiguration(undefined, scope).get<T>(section)\n\t\t\t: workspace.getConfiguration(undefined, scope).get<T>(section, defaultValue);\n\t}\n\n\tchanged<T extends ConfigPath>(\n\t\te: ConfigurationChangeEvent | undefined,\n\t\tsection: T,\n\t\tscope?: ConfigurationScope | null | undefined,\n\t): boolean {\n\t\treturn e?.affectsConfiguration(`${configPrefix}.${section}`, scope!) ?? true;\n\t}\n\n\tinspect<T extends ConfigPath, V extends ConfigPathValue<T>>(section: T, scope?: ConfigurationScope | null) {\n\t\treturn workspace\n\t\t\t.getConfiguration(section === undefined ? undefined : configPrefix, scope)\n\t\t\t.inspect<V>(section === undefined ? configPrefix : section);\n\t}\n\n\tinspectAny<T>(section: string, scope?: ConfigurationScope | null) {\n\t\treturn workspace.getConfiguration(undefined, scope).inspect<T>(section);\n\t}\n\n\tasync migrate<T extends ConfigPath>(\n\t\tfrom: string,\n\t\tto: T,\n\t\toptions: { fallbackValue?: ConfigPathValue<T>; migrationFn?(value: any): ConfigPathValue<T> },\n\t): Promise<boolean> {\n\t\tconst inspection = configuration.inspect(from as any);\n\t\tif (inspection === undefined) return false;\n\n\t\tlet migrated = false;\n\t\tif (inspection.globalValue !== undefined) {\n\t\t\tawait this.update(\n\t\t\t\tto,\n\t\t\t\toptions.migrationFn != null ? options.migrationFn(inspection.globalValue) : inspection.globalValue,\n\t\t\t\tConfigurationTarget.Global,\n\t\t\t);\n\t\t\tmigrated = true;\n\t\t\t// Can't delete the old setting currently because it errors with `Unable to write to User Settings because <setting name> is not a registered configuration`\n\t\t\t// if (from !== to) {\n\t\t\t//     try {\n\t\t\t//         await this.update(from, undefined, ConfigurationTarget.Global);\n\t\t\t//     }\n\t\t\t//     catch { }\n\t\t\t// }\n\t\t}\n\n\t\tif (inspection.workspaceValue !== undefined) {\n\t\t\tawait this.update(\n\t\t\t\tto,\n\t\t\t\toptions.migrationFn != null\n\t\t\t\t\t? options.migrationFn(inspection.workspaceValue)\n\t\t\t\t\t: inspection.workspaceValue,\n\t\t\t\tConfigurationTarget.Workspace,\n\t\t\t);\n\t\t\tmigrated = true;\n\t\t\t// Can't delete the old setting currently because it errors with `Unable to write to User Settings because <setting name> is not a registered configuration`\n\t\t\t// if (from !== to) {\n\t\t\t//     try {\n\t\t\t//         await this.update(from, undefined, ConfigurationTarget.Workspace);\n\t\t\t//     }\n\t\t\t//     catch { }\n\t\t\t// }\n\t\t}\n\n\t\tif (inspection.workspaceFolderValue !== undefined) {\n\t\t\tawait this.update(\n\t\t\t\tto,\n\t\t\t\toptions.migrationFn != null\n\t\t\t\t\t? options.migrationFn(inspection.workspaceFolderValue)\n\t\t\t\t\t: inspection.workspaceFolderValue,\n\t\t\t\tConfigurationTarget.WorkspaceFolder,\n\t\t\t);\n\t\t\tmigrated = true;\n\t\t\t// Can't delete the old setting currently because it errors with `Unable to write to User Settings because <setting name> is not a registered configuration`\n\t\t\t// if (from !== to) {\n\t\t\t//     try {\n\t\t\t//         await this.update(from, undefined, ConfigurationTarget.WorkspaceFolder);\n\t\t\t//     }\n\t\t\t//     catch { }\n\t\t\t// }\n\t\t}\n\n\t\tif (!migrated && options.fallbackValue !== undefined) {\n\t\t\tawait this.update(to, options.fallbackValue, ConfigurationTarget.Global);\n\t\t\tmigrated = true;\n\t\t}\n\n\t\treturn migrated;\n\t}\n\n\tasync migrateIfMissing<T extends ConfigPath>(\n\t\tfrom: string,\n\t\tto: T,\n\t\toptions: { migrationFn?(value: any): ConfigPathValue<T> },\n\t): Promise<void> {\n\t\tconst fromInspection = configuration.inspect(from as any);\n\t\tif (fromInspection === undefined) return;\n\n\t\tconst toInspection = configuration.inspect(to);\n\t\tif (fromInspection.globalValue !== undefined) {\n\t\t\tif (toInspection === undefined || toInspection.globalValue === undefined) {\n\t\t\t\tawait this.update(\n\t\t\t\t\tto,\n\t\t\t\t\toptions.migrationFn != null\n\t\t\t\t\t\t? options.migrationFn(fromInspection.globalValue)\n\t\t\t\t\t\t: fromInspection.globalValue,\n\t\t\t\t\tConfigurationTarget.Global,\n\t\t\t\t);\n\t\t\t\t// Can't delete the old setting currently because it errors with `Unable to write to User Settings because <setting name> is not a registered configuration`\n\t\t\t\t// if (from !== to) {\n\t\t\t\t//     try {\n\t\t\t\t//         await this.update(from, undefined, ConfigurationTarget.Global);\n\t\t\t\t//     }\n\t\t\t\t//     catch { }\n\t\t\t\t// }\n\t\t\t}\n\t\t}\n\n\t\tif (fromInspection.workspaceValue !== undefined) {\n\t\t\tif (toInspection === undefined || toInspection.workspaceValue === undefined) {\n\t\t\t\tawait this.update(\n\t\t\t\t\tto,\n\t\t\t\t\toptions.migrationFn != null\n\t\t\t\t\t\t? options.migrationFn(fromInspection.workspaceValue)\n\t\t\t\t\t\t: fromInspection.workspaceValue,\n\t\t\t\t\tConfigurationTarget.Workspace,\n\t\t\t\t);\n\t\t\t\t// Can't delete the old setting currently because it errors with `Unable to write to User Settings because <setting name> is not a registered configuration`\n\t\t\t\t// if (from !== to) {\n\t\t\t\t//     try {\n\t\t\t\t//         await this.update(from, undefined, ConfigurationTarget.Workspace);\n\t\t\t\t//     }\n\t\t\t\t//     catch { }\n\t\t\t\t// }\n\t\t\t}\n\t\t}\n\n\t\tif (fromInspection.workspaceFolderValue !== undefined) {\n\t\t\tif (toInspection === undefined || toInspection.workspaceFolderValue === undefined) {\n\t\t\t\tawait this.update(\n\t\t\t\t\tto,\n\t\t\t\t\toptions.migrationFn != null\n\t\t\t\t\t\t? options.migrationFn(fromInspection.workspaceFolderValue)\n\t\t\t\t\t\t: fromInspection.workspaceFolderValue,\n\t\t\t\t\tConfigurationTarget.WorkspaceFolder,\n\t\t\t\t);\n\t\t\t\t// Can't delete the old setting currently because it errors with `Unable to write to User Settings because <setting name> is not a registered configuration`\n\t\t\t\t// if (from !== to) {\n\t\t\t\t//     try {\n\t\t\t\t//         await this.update(from, undefined, ConfigurationTarget.WorkspaceFolder);\n\t\t\t\t//     }\n\t\t\t\t//     catch { }\n\t\t\t\t// }\n\t\t\t}\n\t\t}\n\t}\n\n\tname<T extends ConfigPath>(section: T): string {\n\t\treturn section;\n\t}\n\n\tupdate<T extends ConfigPath>(\n\t\tsection: T,\n\t\tvalue: ConfigPathValue<T> | undefined,\n\t\ttarget: ConfigurationTarget,\n\t): Thenable<void> {\n\t\treturn workspace.getConfiguration(configPrefix).update(section, value, target);\n\t}\n\n\tupdateAny(\n\t\tsection: string,\n\t\tvalue: any,\n\t\ttarget: ConfigurationTarget,\n\t\tscope?: ConfigurationScope | null,\n\t): Thenable<void> {\n\t\treturn workspace\n\t\t\t.getConfiguration(undefined, target === ConfigurationTarget.Global ? undefined : scope!)\n\t\t\t.update(section, value, target);\n\t}\n\n\tupdateEffective<T extends ConfigPath>(section: T, value: ConfigPathValue<T> | undefined): Thenable<void> {\n\t\tconst inspect = configuration.inspect(section)!;\n\t\tif (inspect.workspaceFolderValue !== undefined) {\n\t\t\tif (value === inspect.workspaceFolderValue) return Promise.resolve(undefined);\n\n\t\t\treturn configuration.update(section, value, ConfigurationTarget.WorkspaceFolder);\n\t\t}\n\n\t\tif (inspect.workspaceValue !== undefined) {\n\t\t\tif (value === inspect.workspaceValue) return Promise.resolve(undefined);\n\n\t\t\treturn configuration.update(section, value, ConfigurationTarget.Workspace);\n\t\t}\n\n\t\tif (inspect.globalValue === value || (inspect.globalValue === undefined && value === inspect.defaultValue)) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn configuration.update(\n\t\t\tsection,\n\t\t\tObjects.areEqual(value, inspect.defaultValue) ? undefined : value,\n\t\t\tConfigurationTarget.Global,\n\t\t);\n\t}\n}\n\nexport const configuration = new Configuration();\n\ntype SubPath<T, Key extends keyof T> = Key extends string\n\t? T[Key] extends Record<string, any>\n\t\t?\n\t\t\t\t| `${Key}.${SubPath<T[Key], Exclude<keyof T[Key], keyof any[]>> & string}`\n\t\t\t\t| `${Key}.${Exclude<keyof T[Key], keyof any[]> & string}`\n\t\t: never\n\t: never;\n\ntype Path<T> = SubPath<T, keyof T> | keyof T extends string | keyof T ? SubPath<T, keyof T> | keyof T : keyof T;\n\ntype PathValue<T, P extends Path<T>> = P extends `${infer Key}.${infer Rest}`\n\t? Key extends keyof T\n\t\t? Rest extends Path<T[Key]>\n\t\t\t? PathValue<T[Key], Rest>\n\t\t\t: never\n\t\t: never\n\t: P extends keyof T\n\t? T[P]\n\t: never;\n\ntype ConfigPath = Path<Config>;\ntype ConfigPathValue<P extends ConfigPath> = PathValue<Config, P>;\n","'use strict';\nimport { commands, TextDocument, TextEditor, window } from 'vscode';\nimport { ViewShowBranchComparison } from './config';\nimport { SearchPattern } from './git/git';\n\nexport const quickPickTitleMaxChars = 80;\n\nexport enum BuiltInCommands {\n\tCloseActiveEditor = 'workbench.action.closeActiveEditor',\n\tCloseAllEditors = 'workbench.action.closeAllEditors',\n\tCursorMove = 'cursorMove',\n\tDiff = 'vscode.diff',\n\tEditorScroll = 'editorScroll',\n\tExecuteDocumentSymbolProvider = 'vscode.executeDocumentSymbolProvider',\n\tExecuteCodeLensProvider = 'vscode.executeCodeLensProvider',\n\tFocusFilesExplorer = 'workbench.files.action.focusFilesExplorer',\n\tInstallExtension = 'workbench.extensions.installExtension',\n\tOpen = 'vscode.open',\n\tOpenFolder = 'vscode.openFolder',\n\tOpenInTerminal = 'openInTerminal',\n\tOpenWith = 'vscode.openWith',\n\tNextEditor = 'workbench.action.nextEditor',\n\tPreviewHtml = 'vscode.previewHtml',\n\tRevealLine = 'revealLine',\n\tSetContext = 'setContext',\n\tShowExplorerActivity = 'workbench.view.explorer',\n\tShowReferences = 'editor.action.showReferences',\n}\n\nexport enum BuiltInGitCommands {\n\tPublish = 'git.publish',\n\tPull = 'git.pull',\n\tPullRebase = 'git.pullRebase',\n\tPush = 'git.push',\n\tPushForce = 'git.pushForce',\n\tUndoCommit = 'git.undoCommit',\n}\n\nexport enum BuiltInGitConfiguration {\n\tAutoRepositoryDetection = 'git.autoRepositoryDetection',\n\tFetchOnPull = 'git.fetchOnPull',\n\tUseForcePushWithLease = 'git.useForcePushWithLease',\n}\n\nexport enum ContextKeys {\n\tActionPrefix = 'gitlens:action:',\n\tActiveFileStatus = 'gitlens:activeFileStatus',\n\tAnnotationStatus = 'gitlens:annotationStatus',\n\tDisabledToggleCodeLens = 'gitlens:disabledToggleCodeLens',\n\tDisabled = 'gitlens:disabled',\n\tEnabled = 'gitlens:enabled',\n\tHasConnectedRemotes = 'gitlens:hasConnectedRemotes',\n\tHasRemotes = 'gitlens:hasRemotes',\n\tHasRichRemotes = 'gitlens:hasRichRemotes',\n\tKey = 'gitlens:key',\n\tReadonly = 'gitlens:readonly',\n\tViewsCanCompare = 'gitlens:views:canCompare',\n\tViewsCanCompareFile = 'gitlens:views:canCompare:file',\n\tViewsCommitsMyCommitsOnly = 'gitlens:views:commits:myCommitsOnly',\n\tViewsFileHistoryCanPin = 'gitlens:views:fileHistory:canPin',\n\tViewsFileHistoryCursorFollowing = 'gitlens:views:fileHistory:cursorFollowing',\n\tViewsFileHistoryEditorFollowing = 'gitlens:views:fileHistory:editorFollowing',\n\tViewsLineHistoryEditorFollowing = 'gitlens:views:lineHistory:editorFollowing',\n\tViewsRepositoriesAutoRefresh = 'gitlens:views:repositories:autoRefresh',\n\tViewsSearchAndCompareKeepResults = 'gitlens:views:searchAndCompare:keepResults',\n\tViewsWelcomeVisible = 'gitlens:views:welcome:visible',\n\tVsls = 'gitlens:vsls',\n}\n\nexport function setContext(key: ContextKeys | string, value: any) {\n\treturn commands.executeCommand(BuiltInCommands.SetContext, key, value);\n}\n\nexport enum Colors {\n\tGutterBackgroundColor = 'gitlens.gutterBackgroundColor',\n\tGutterForegroundColor = 'gitlens.gutterForegroundColor',\n\tGutterUncommittedForegroundColor = 'gitlens.gutterUncommittedForegroundColor',\n\tTrailingLineBackgroundColor = 'gitlens.trailingLineBackgroundColor',\n\tTrailingLineForegroundColor = 'gitlens.trailingLineForegroundColor',\n\tLineHighlightBackgroundColor = 'gitlens.lineHighlightBackgroundColor',\n\tLineHighlightOverviewRulerColor = 'gitlens.lineHighlightOverviewRulerColor',\n\tClosedPullRequestIconColor = 'gitlens.closedPullRequestIconColor',\n\tOpenPullRequestIconColor = 'gitlens.openPullRequestIconColor',\n\tMergedPullRequestIconColor = 'gitlens.mergedPullRequestIconColor',\n\tUnpushlishedChangesIconColor = 'gitlens.unpushlishedChangesIconColor',\n\tUnpublishedCommitIconColor = 'gitlens.unpublishedCommitIconColor',\n\tUnpulledChangesIconColor = 'gitlens.unpulledChangesIconColor',\n}\n\nexport enum DocumentSchemes {\n\tDebugConsole = 'debug',\n\tFile = 'file',\n\tGit = 'git',\n\tGitLens = 'gitlens',\n\tOutput = 'output',\n\tPRs = 'pr',\n\tVsls = 'vsls',\n}\n\nexport function getEditorIfActive(document: TextDocument): TextEditor | undefined {\n\tconst editor = window.activeTextEditor;\n\treturn editor != null && editor.document === document ? editor : undefined;\n}\n\nexport function isActiveDocument(document: TextDocument): boolean {\n\tconst editor = window.activeTextEditor;\n\treturn editor != null && editor.document === document;\n}\n\nexport function isTextEditor(editor: TextEditor): boolean {\n\tconst scheme = editor.document.uri.scheme;\n\treturn scheme !== DocumentSchemes.Output && scheme !== DocumentSchemes.DebugConsole;\n}\n\nexport function hasVisibleTextEditor(): boolean {\n\tif (window.visibleTextEditors.length === 0) return false;\n\n\treturn window.visibleTextEditors.some(e => isTextEditor(e));\n}\n\nexport const enum GlyphChars {\n\tAngleBracketLeftHeavy = '\\u2770',\n\tAngleBracketRightHeavy = '\\u2771',\n\tArrowBack = '\\u21a9',\n\tArrowDown = '\\u2193',\n\tArrowDownUp = '\\u21F5',\n\tArrowDropRight = '\\u2937',\n\tArrowHeadRight = '\\u27A4',\n\tArrowLeft = '\\u2190',\n\tArrowLeftDouble = '\\u21d0',\n\tArrowLeftRight = '\\u2194',\n\tArrowLeftRightDouble = '\\u21d4',\n\tArrowLeftRightDoubleStrike = '\\u21ce',\n\tArrowLeftRightLong = '\\u27f7',\n\tArrowRight = '\\u2192',\n\tArrowRightDouble = '\\u21d2',\n\tArrowRightHollow = '\\u21e8',\n\tArrowUp = '\\u2191',\n\tArrowUpDown = '\\u21C5',\n\tArrowUpRight = '\\u2197',\n\tArrowsHalfLeftRight = '\\u21cb',\n\tArrowsHalfRightLeft = '\\u21cc',\n\tArrowsLeftRight = '\\u21c6',\n\tArrowsRightLeft = '\\u21c4',\n\tAsterisk = '\\u2217',\n\tCheck = '',\n\tDash = '\\u2014',\n\tDot = '\\u2022',\n\tEllipsis = '\\u2026',\n\tEnDash = '\\u2013',\n\tEnvelope = '\\u2709',\n\tEqualsTriple = '\\u2261',\n\tFlag = '\\u2691',\n\tFlagHollow = '\\u2690',\n\tMiddleEllipsis = '\\u22EF',\n\tMuchLessThan = '\\u226A',\n\tMuchGreaterThan = '\\u226B',\n\tPencil = '\\u270E',\n\tSpace = '\\u00a0',\n\tSpaceThin = '\\u2009',\n\tSpaceThinnest = '\\u200A',\n\tSquareWithBottomShadow = '\\u274F',\n\tSquareWithTopShadow = '\\u2750',\n\tWarning = '\\u26a0',\n\tZeroWidthSpace = '\\u200b',\n}\n\nexport enum SyncedState {\n\tVersion = 'gitlens:synced:version',\n\tWelcomeViewVisible = 'gitlens:views:welcome:visible',\n\n\tDeprecated_DisallowConnectionPrefix = 'gitlens:disallow:connection:',\n}\n\nexport enum GlobalState {\n\tAvatars = 'gitlens:avatars',\n\tPendingWelcomeOnFocus = 'gitlens:pendingWelcomeOnFocus',\n\tPendingWhatsNewOnFocus = 'gitlens:pendingWhatsNewOnFocus',\n\tVersion = 'gitlens:version',\n\n\tDeprecated_Version = 'gitlensVersion',\n}\n\nexport const ImageMimetypes: Record<string, string> = {\n\t'.png': 'image/png',\n\t'.gif': 'image/gif',\n\t'.jpg': 'image/jpeg',\n\t'.jpeg': 'image/jpeg',\n\t'.jpe': 'image/jpeg',\n\t'.webp': 'image/webp',\n\t'.tif': 'image/tiff',\n\t'.tiff': 'image/tiff',\n\t'.bmp': 'image/bmp',\n};\n\nexport interface BranchComparison {\n\tref: string;\n\tnotation: '..' | '...' | undefined;\n\ttype: Exclude<ViewShowBranchComparison, false> | undefined;\n}\n\nexport interface BranchComparisons {\n\t[id: string]: string | BranchComparison;\n}\n\nexport interface NamedRef {\n\tlabel?: string;\n\tref: string;\n}\n\nexport interface PinnedComparison {\n\ttype: 'comparison';\n\ttimestamp: number;\n\tpath: string;\n\tref1: NamedRef;\n\tref2: NamedRef;\n\tnotation?: '..' | '...';\n}\n\nexport interface PinnedSearch {\n\ttype: 'search';\n\ttimestamp: number;\n\tpath: string;\n\tlabels: {\n\t\tlabel: string;\n\t\tqueryLabel:\n\t\t\t| string\n\t\t\t| {\n\t\t\t\t\tlabel: string;\n\t\t\t\t\tresultsType?: { singular: string; plural: string };\n\t\t\t  };\n\t};\n\tsearch: SearchPattern;\n}\n\nexport type PinnedItem = PinnedComparison | PinnedSearch;\n\nexport interface PinnedItems {\n\t[id: string]: PinnedItem;\n}\n\nexport interface Starred {\n\t[id: string]: boolean;\n}\n\nexport interface Usage {\n\t[id: string]: number;\n}\n\nexport enum WorkspaceState {\n\tBranchComparisons = 'gitlens:branch:comparisons',\n\tConnectedPrefix = 'gitlens:connected:',\n\tDefaultRemote = 'gitlens:remote:default',\n\tGitCommandPaletteUsage = 'gitlens:gitComandPalette:usage',\n\tStarredBranches = 'gitlens:starred:branches',\n\tStarredRepositories = 'gitlens:starred:repositories',\n\tViewsRepositoriesAutoRefresh = 'gitlens:views:repositories:autoRefresh',\n\tViewsSearchAndCompareKeepResults = 'gitlens:views:searchAndCompare:keepResults',\n\tViewsSearchAndComparePinnedItems = 'gitlens:views:searchAndCompare:pinned',\n\n\tDeprecated_DisallowConnectionPrefix = 'gitlens:disallow:connection:',\n\tDeprecated_PinnedComparisons = 'gitlens:pinned:comparisons',\n}\n","'use strict';\nimport { ConfigurationChangeEvent, Disposable } from 'vscode';\nimport { AutolinkReference, configuration } from '../configuration';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitRemote, IssueOrPullRequest } from '../git/git';\nimport { Logger } from '../logger';\nimport { Dates, debug, Iterables, Promises, Strings } from '../system';\n\nconst numRegex = /<num>/g;\n\nexport interface CacheableAutolinkReference extends AutolinkReference {\n\tlinkify?: ((text: string, markdown: boolean, footnotes?: Map<number, string>) => string) | null;\n\tmessageMarkdownRegex?: RegExp;\n\tmessageRegex?: RegExp;\n}\n\nexport interface DynamicAutolinkReference {\n\tlinkify: (text: string, markdown: boolean, footnotes?: Map<number, string>) => string;\n}\n\nfunction isDynamic(ref: AutolinkReference | DynamicAutolinkReference): ref is DynamicAutolinkReference {\n\treturn (ref as AutolinkReference).prefix === undefined && (ref as AutolinkReference).url === undefined;\n}\n\nfunction isCacheable(ref: AutolinkReference | DynamicAutolinkReference): ref is CacheableAutolinkReference {\n\treturn (ref as AutolinkReference).prefix !== undefined && (ref as AutolinkReference).url !== undefined;\n}\n\nexport class Autolinks implements Disposable {\n\tprotected _disposable: Disposable | undefined;\n\tprivate _references: CacheableAutolinkReference[] = [];\n\n\tconstructor() {\n\t\tthis._disposable = Disposable.from(configuration.onDidChange(this.onConfigurationChanged, this));\n\n\t\tthis.onConfigurationChanged();\n\t}\n\n\tdispose() {\n\t\tthis._disposable?.dispose();\n\t}\n\n\tprivate onConfigurationChanged(e?: ConfigurationChangeEvent) {\n\t\tif (configuration.changed(e, 'autolinks')) {\n\t\t\tthis._references = Container.config.autolinks ?? [];\n\t\t}\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (message: string) => message.substring(0, 50),\n\t\t\t1: _ => false,\n\t\t\t2: ({ timeout }) => timeout,\n\t\t},\n\t})\n\tasync getIssueOrPullRequestLinks(message: string, remote: GitRemote, { timeout }: { timeout?: number } = {}) {\n\t\tif (!remote.provider?.hasApi()) return undefined;\n\n\t\tconst { provider } = remote;\n\t\tconst connected = provider.maybeConnected ?? (await provider.isConnected());\n\t\tif (!connected) return undefined;\n\n\t\tconst ids = new Set<string>();\n\n\t\tlet match;\n\t\tlet num;\n\t\tfor (const ref of provider.autolinks) {\n\t\t\tif (!isCacheable(ref)) continue;\n\n\t\t\tif (ref.messageRegex === undefined) {\n\t\t\t\tref.messageRegex = new RegExp(\n\t\t\t\t\t`(?<=^|\\\\s|\\\\(|\\\\\\\\\\\\[)(${Strings.escapeRegex(ref.prefix)}([${\n\t\t\t\t\t\tref.alphanumeric ? '\\\\w' : '0-9'\n\t\t\t\t\t}]+))\\\\b`,\n\t\t\t\t\tref.ignoreCase ? 'gi' : 'g',\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tdo {\n\t\t\t\tmatch = ref.messageRegex.exec(message);\n\t\t\t\tif (match == null) break;\n\n\t\t\t\t[, , num] = match;\n\n\t\t\t\tids.add(num);\n\t\t\t} while (true);\n\t\t}\n\n\t\tif (ids.size === 0) return undefined;\n\n\t\tconst issuesOrPullRequests = await Promises.raceAll(\n\t\t\tids.values(),\n\t\t\tid => provider.getIssueOrPullRequest(id),\n\t\t\ttimeout,\n\t\t);\n\t\tif (issuesOrPullRequests.size === 0 || Iterables.every(issuesOrPullRequests.values(), pr => pr === undefined)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn issuesOrPullRequests;\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (text: string) => text.substring(0, 30),\n\t\t\t2: _ => false,\n\t\t\t3: _ => false,\n\t\t},\n\t})\n\tlinkify(\n\t\ttext: string,\n\t\tmarkdown: boolean,\n\t\tremotes?: GitRemote[],\n\t\tissuesOrPullRequests?: Map<string, IssueOrPullRequest | Promises.CancellationError | undefined>,\n\t\tfootnotes?: Map<number, string>,\n\t) {\n\t\tfor (const ref of this._references) {\n\t\t\tif (this.ensureAutolinkCached(ref, issuesOrPullRequests)) {\n\t\t\t\tif (ref.linkify != null) {\n\t\t\t\t\ttext = ref.linkify(text, markdown, footnotes);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (remotes != null && remotes.length !== 0) {\n\t\t\tfor (const r of remotes) {\n\t\t\t\tif (r.provider === undefined) continue;\n\n\t\t\t\tfor (const ref of r.provider.autolinks) {\n\t\t\t\t\tif (this.ensureAutolinkCached(ref, issuesOrPullRequests)) {\n\t\t\t\t\t\tif (ref.linkify != null) {\n\t\t\t\t\t\t\ttext = ref.linkify(text, markdown, footnotes);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn text;\n\t}\n\n\tprivate ensureAutolinkCached(\n\t\tref: CacheableAutolinkReference | DynamicAutolinkReference,\n\t\tissuesOrPullRequests?: Map<string, IssueOrPullRequest | Promises.CancellationError | undefined>,\n\t): ref is CacheableAutolinkReference | DynamicAutolinkReference {\n\t\tif (isDynamic(ref)) return true;\n\n\t\ttry {\n\t\t\tif (ref.messageMarkdownRegex === undefined) {\n\t\t\t\tref.messageMarkdownRegex = new RegExp(\n\t\t\t\t\t`(?<=^|\\\\s|\\\\(|\\\\\\\\\\\\[)(${Strings.escapeRegex(Strings.escapeMarkdown(ref.prefix))}([${\n\t\t\t\t\t\tref.alphanumeric ? '\\\\w' : '0-9'\n\t\t\t\t\t}]+))\\\\b`,\n\t\t\t\t\tref.ignoreCase ? 'gi' : 'g',\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (issuesOrPullRequests == null || issuesOrPullRequests.size === 0) {\n\t\t\t\tconst replacement = `[$1](${ref.url.replace(numRegex, '$2')}${\n\t\t\t\t\tref.title ? ` \"${ref.title.replace(numRegex, '$2')}\"` : ''\n\t\t\t\t})`;\n\t\t\t\tref.linkify = (text: string, markdown: boolean) =>\n\t\t\t\t\tmarkdown ? text.replace(ref.messageMarkdownRegex!, replacement) : text;\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tref.linkify = (text: string, markdown: boolean, footnotes?: Map<number, string>) => {\n\t\t\t\tconst includeFootnotes = footnotes == null;\n\t\t\t\tlet index;\n\n\t\t\t\tif (markdown) {\n\t\t\t\t\treturn text.replace(ref.messageMarkdownRegex!, (_substring, linkText, num) => {\n\t\t\t\t\t\tconst issue = issuesOrPullRequests?.get(num);\n\n\t\t\t\t\t\tconst issueUrl = ref.url.replace(numRegex, num);\n\n\t\t\t\t\t\tlet title = '';\n\t\t\t\t\t\tif (ref.title) {\n\t\t\t\t\t\t\ttitle = ` \"${ref.title.replace(numRegex, num)}`;\n\n\t\t\t\t\t\t\tif (issue != null) {\n\t\t\t\t\t\t\t\tif (issue instanceof Promises.CancellationError) {\n\t\t\t\t\t\t\t\t\ttitle += `\\n${GlyphChars.Dash.repeat(2)}\\nDetails timed out`;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tconst issueTitle = issue.title.replace(/([\")\\\\])/g, '\\\\$1').trim();\n\n\t\t\t\t\t\t\t\t\tif (footnotes != null) {\n\t\t\t\t\t\t\t\t\t\tindex = footnotes.size + 1;\n\t\t\t\t\t\t\t\t\t\tfootnotes.set(\n\t\t\t\t\t\t\t\t\t\t\tindex,\n\t\t\t\t\t\t\t\t\t\t\t`[**${\n\t\t\t\t\t\t\t\t\t\t\t\tissue.type === 'PullRequest' ? '$(git-pull-request)' : '$(info)'\n\t\t\t\t\t\t\t\t\t\t\t} ${issueTitle}**](${issueUrl}${title}\")\\\\\\n${GlyphChars.Space.repeat(\n\t\t\t\t\t\t\t\t\t\t\t\t5,\n\t\t\t\t\t\t\t\t\t\t\t)}${linkText} ${issue.closed ? 'closed' : 'opened'} ${Dates.getFormatter(\n\t\t\t\t\t\t\t\t\t\t\t\tissue.closedDate ?? issue.date,\n\t\t\t\t\t\t\t\t\t\t\t).fromNow()}`,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\ttitle += `\\n${GlyphChars.Dash.repeat(2)}\\n${issueTitle}\\n${\n\t\t\t\t\t\t\t\t\t\tissue.closed ? 'Closed' : 'Opened'\n\t\t\t\t\t\t\t\t\t}, ${Dates.getFormatter(issue.closedDate ?? issue.date).fromNow()}`;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttitle += '\"';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn `[${linkText}](${issueUrl}${title})`;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\ttext = text.replace(ref.messageRegex!, (_substring, linkText, num) => {\n\t\t\t\t\tconst issue = issuesOrPullRequests?.get(num);\n\t\t\t\t\tif (issue == null) return linkText;\n\n\t\t\t\t\tif (footnotes === undefined) {\n\t\t\t\t\t\tfootnotes = new Map<number, string>();\n\t\t\t\t\t}\n\n\t\t\t\t\tindex = footnotes.size + 1;\n\t\t\t\t\tfootnotes.set(\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\t`${linkText}: ${\n\t\t\t\t\t\t\tissue instanceof Promises.CancellationError\n\t\t\t\t\t\t\t\t? 'Details timed out'\n\t\t\t\t\t\t\t\t: `${issue.title}  ${GlyphChars.Dot}  ${\n\t\t\t\t\t\t\t\t\t\tissue.closed ? 'Closed' : 'Opened'\n\t\t\t\t\t\t\t\t  }, ${Dates.getFormatter(issue.closedDate ?? issue.date).fromNow()}`\n\t\t\t\t\t\t}`,\n\t\t\t\t\t);\n\t\t\t\t\treturn `${linkText}${Strings.getSuperscript(index)}`;\n\t\t\t\t});\n\n\t\t\t\treturn includeFootnotes && footnotes != null && footnotes.size !== 0\n\t\t\t\t\t? `${text}\\n${GlyphChars.Dash.repeat(2)}\\n${Iterables.join(\n\t\t\t\t\t\t\tIterables.map(footnotes, ([i, footnote]) => `${Strings.getSuperscript(i)} ${footnote}`),\n\t\t\t\t\t\t\t'\\n',\n\t\t\t\t\t  )}`\n\t\t\t\t\t: text;\n\t\t\t};\n\t\t} catch (ex) {\n\t\t\tLogger.error(\n\t\t\t\tex,\n\t\t\t\t`Failed to create autolink generator: prefix=${ref.prefix}, url=${ref.url}, title=${ref.title}`,\n\t\t\t);\n\t\t\tref.linkify = null;\n\t\t}\n\n\t\treturn true;\n\t}\n}\n","'use strict';\nimport {\n\tDecorationOptions,\n\tDisposable,\n\tRange,\n\tTextDocument,\n\tTextEditor,\n\tTextEditorDecorationType,\n\tTextEditorSelectionChangeEvent,\n\tUri,\n\twindow,\n} from 'vscode';\nimport { FileAnnotationType } from '../configuration';\nimport { ContextKeys, setContext } from '../constants';\nimport { Logger } from '../logger';\nimport { GitDocumentState, TrackedDocument } from '../trackers/gitDocumentTracker';\n\nexport enum AnnotationStatus {\n\tComputing = 'computing',\n\tComputed = 'computed',\n}\n\nexport interface AnnotationContext {\n\tselection?: { sha?: string; line?: undefined } | { sha?: undefined; line?: number } | false;\n}\n\nexport type TextEditorCorrelationKey = string;\n\nexport abstract class AnnotationProviderBase<TContext extends AnnotationContext = AnnotationContext>\n\timplements Disposable\n{\n\tstatic getCorrelationKey(editor: TextEditor | undefined): TextEditorCorrelationKey {\n\t\treturn `${editor?.document.uri.toString()}|${editor?.viewColumn}`;\n\t}\n\n\tannotationContext: TContext | undefined;\n\tcorrelationKey: TextEditorCorrelationKey;\n\tdocument: TextDocument;\n\tstatus: AnnotationStatus | undefined;\n\n\tprivate decorations:\n\t\t| { decorationType: TextEditorDecorationType; rangesOrOptions: Range[] | DecorationOptions[] }[]\n\t\t| undefined;\n\tprotected disposable: Disposable;\n\n\tconstructor(\n\t\tpublic readonly annotationType: FileAnnotationType,\n\t\tpublic editor: TextEditor,\n\t\tprotected readonly trackedDocument: TrackedDocument<GitDocumentState>,\n\t) {\n\t\tthis.correlationKey = AnnotationProviderBase.getCorrelationKey(this.editor);\n\t\tthis.document = this.editor.document;\n\n\t\tthis.disposable = Disposable.from(\n\t\t\twindow.onDidChangeTextEditorSelection(this.onTextEditorSelectionChanged, this),\n\t\t);\n\t}\n\n\tdispose() {\n\t\tthis.clear();\n\n\t\tthis.disposable.dispose();\n\t}\n\n\tprivate onTextEditorSelectionChanged(e: TextEditorSelectionChangeEvent) {\n\t\tif (this.document !== e.textEditor.document) return;\n\n\t\tvoid this.selection({ line: e.selections[0].active.line });\n\t}\n\n\tget editorUri(): Uri | undefined {\n\t\treturn this.editor?.document?.uri;\n\t}\n\n\tclear() {\n\t\tthis.annotationContext = undefined;\n\t\tthis.status = undefined;\n\t\tif (this.editor == null) return;\n\n\t\tif (this.decorations?.length) {\n\t\t\tfor (const d of this.decorations) {\n\t\t\t\ttry {\n\t\t\t\t\tthis.editor.setDecorations(d.decorationType, []);\n\t\t\t\t} catch {}\n\t\t\t}\n\n\t\t\tthis.decorations = undefined;\n\t\t}\n\t}\n\n\tmustReopen(_context?: TContext): boolean {\n\t\treturn false;\n\t}\n\n\tasync restore(editor: TextEditor) {\n\t\t// If the editor isn't disposed then we don't need to do anything\n\t\t// Explicitly check for `false`\n\t\tif ((this.editor as any)._disposed === false) return;\n\n\t\tthis.status = AnnotationStatus.Computing;\n\t\tif (editor === window.activeTextEditor) {\n\t\t\tawait setContext(ContextKeys.AnnotationStatus, this.status);\n\t\t}\n\n\t\tthis.editor = editor;\n\t\tthis.correlationKey = AnnotationProviderBase.getCorrelationKey(editor);\n\t\tthis.document = editor.document;\n\n\t\tif (this.decorations?.length) {\n\t\t\tfor (const d of this.decorations) {\n\t\t\t\tthis.editor.setDecorations(d.decorationType, d.rangesOrOptions);\n\t\t\t}\n\t\t}\n\n\t\tthis.status = AnnotationStatus.Computed;\n\t\tif (editor === window.activeTextEditor) {\n\t\t\tawait setContext(ContextKeys.AnnotationStatus, this.status);\n\t\t}\n\t}\n\n\tasync provideAnnotation(context?: TContext): Promise<boolean> {\n\t\tthis.status = AnnotationStatus.Computing;\n\t\ttry {\n\t\t\tif (await this.onProvideAnnotation(context)) {\n\t\t\t\tthis.status = AnnotationStatus.Computed;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t}\n\n\t\tthis.status = undefined;\n\t\treturn false;\n\t}\n\n\tprotected abstract onProvideAnnotation(context?: TContext): Promise<boolean>;\n\n\tabstract selection(selection?: TContext['selection']): Promise<void>;\n\n\tprotected setDecorations(\n\t\tdecorations: { decorationType: TextEditorDecorationType; rangesOrOptions: Range[] | DecorationOptions[] }[],\n\t) {\n\t\tif (this.decorations?.length) {\n\t\t\tthis.clear();\n\t\t}\n\n\t\tthis.decorations = decorations;\n\t\tif (this.decorations?.length) {\n\t\t\tfor (const d of this.decorations) {\n\t\t\t\tthis.editor.setDecorations(d.decorationType, d.rangesOrOptions);\n\t\t\t}\n\t\t}\n\t}\n\n\tabstract validate(): Promise<boolean>;\n}\n","'use strict';\n\nconst cssColorRegex =\n\t/^(?:(#?)([0-9a-f]{3}|[0-9a-f]{6})|((?:rgb|hsl)a?)\\((-?\\d+%?)[,\\s]+(-?\\d+%?)[,\\s]+(-?\\d+%?)[,\\s]*(-?[\\d.]+%?)?\\))$/i;\n\nfunction adjustLight(color: number, amount: number) {\n\tconst cc = color + amount;\n\tconst c = amount < 0 ? (cc < 0 ? 0 : cc) : cc > 255 ? 255 : cc;\n\n\treturn Math.round(c);\n}\n\nexport function darken(color: string, percentage: number) {\n\treturn lighten(color, -percentage);\n}\n\nexport function lighten(color: string, percentage: number) {\n\tconst rgba = toRgba(color);\n\tif (rgba == null) return color;\n\n\tconst [r, g, b, a] = rgba;\n\tconst amount = (255 * percentage) / 100;\n\treturn `rgba(${adjustLight(r, amount)}, ${adjustLight(g, amount)}, ${adjustLight(b, amount)}, ${a})`;\n}\n\nexport function opacity(color: string, percentage: number) {\n\tconst rgba = toRgba(color);\n\tif (rgba == null) return color;\n\n\tconst [r, g, b, a] = rgba;\n\treturn `rgba(${r}, ${g}, ${b}, ${a * (percentage / 100)})`;\n}\n\nexport function toRgba(color: string) {\n\tcolor = color.trim();\n\n\tconst result = cssColorRegex.exec(color);\n\tif (result == null) return null;\n\n\tif (result[1] === '#') {\n\t\tconst hex = result[2];\n\t\tswitch (hex.length) {\n\t\t\tcase 3:\n\t\t\t\treturn [parseInt(hex[0] + hex[0], 16), parseInt(hex[1] + hex[1], 16), parseInt(hex[2] + hex[2], 16), 1];\n\t\t\tcase 6:\n\t\t\t\treturn [\n\t\t\t\t\tparseInt(hex.substring(0, 2), 16),\n\t\t\t\t\tparseInt(hex.substring(2, 4), 16),\n\t\t\t\t\tparseInt(hex.substring(4, 6), 16),\n\t\t\t\t\t1,\n\t\t\t\t];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tswitch (result[3]) {\n\t\tcase 'rgb':\n\t\t\treturn [parseInt(result[4], 10), parseInt(result[5], 10), parseInt(result[6], 10), 1];\n\t\tcase 'rgba':\n\t\t\treturn [parseInt(result[4], 10), parseInt(result[5], 10), parseInt(result[6], 10), parseFloat(result[7])];\n\t\tdefault:\n\t\t\treturn null;\n\t}\n}\n","'use strict';\nimport {\n\tDecorationInstanceRenderOptions,\n\tDecorationOptions,\n\tOverviewRulerLane,\n\tRange,\n\tTextEditorDecorationType,\n\tThemableDecorationAttachmentRenderOptions,\n\tThemableDecorationRenderOptions,\n\tThemeColor,\n\tUri,\n\twindow,\n} from 'vscode';\nimport { HeatmapLocations } from '../config';\nimport { Config, configuration } from '../configuration';\nimport { Colors, GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { CommitFormatOptions, CommitFormatter, GitCommit } from '../git/git';\nimport { Strings } from '../system';\nimport { toRgba } from '../webviews/apps/shared/colors';\n\nexport interface ComputedHeatmap {\n\tcoldThresholdTimestamp: number;\n\tcolors: { hot: string[]; cold: string[] };\n\tcomputeRelativeAge(date: Date): number;\n}\n\ninterface RenderOptions\n\textends DecorationInstanceRenderOptions,\n\t\tThemableDecorationRenderOptions,\n\t\tThemableDecorationAttachmentRenderOptions {\n\theight?: string;\n\tuncommittedColor?: string | ThemeColor;\n}\n\nconst defaultHeatmapHotColor = '#f66a0a';\nconst defaultHeatmapColdColor = '#0a60f6';\nconst defaultHeatmapColors = [\n\t'#f66a0a',\n\t'#ef6939',\n\t'#e96950',\n\t'#e26862',\n\t'#db6871',\n\t'#d3677e',\n\t'#cc678a',\n\t'#c46696',\n\t'#bb66a0',\n\t'#b365a9',\n\t'#a965b3',\n\t'#a064bb',\n\t'#9664c4',\n\t'#8a63cc',\n\t'#7e63d3',\n\t'#7162db',\n\t'#6262e2',\n\t'#5061e9',\n\t'#3961ef',\n\t'#0a60f6',\n];\n\nlet heatmapColors: { hot: string[]; cold: string[] } | undefined;\nexport async function getHeatmapColors() {\n\tif (heatmapColors == null) {\n\t\tlet colors;\n\t\tif (\n\t\t\tContainer.config.heatmap.coldColor === defaultHeatmapColdColor &&\n\t\t\tContainer.config.heatmap.hotColor === defaultHeatmapHotColor\n\t\t) {\n\t\t\tcolors = defaultHeatmapColors;\n\t\t} else {\n\t\t\tconst chroma = (await import(/* webpackChunkName: \"heatmap-chroma\" */ 'chroma-js')).default;\n\t\t\tcolors = chroma\n\t\t\t\t.scale([Container.config.heatmap.hotColor, Container.config.heatmap.coldColor])\n\t\t\t\t.mode('lrgb')\n\t\t\t\t.classes(20)\n\t\t\t\t.colors(20);\n\t\t}\n\n\t\theatmapColors = {\n\t\t\thot: colors.slice(0, 10),\n\t\t\tcold: colors.slice(10, 20),\n\t\t};\n\n\t\tconst disposable = configuration.onDidChange(e => {\n\t\t\tif (\n\t\t\t\tconfiguration.changed(e, 'heatmap.ageThreshold') ||\n\t\t\t\tconfiguration.changed(e, 'heatmap.hotColor') ||\n\t\t\t\tconfiguration.changed(e, 'heatmap.coldColor')\n\t\t\t) {\n\t\t\t\tdisposable.dispose();\n\t\t\t\theatmapColors = undefined;\n\t\t\t}\n\t\t});\n\t}\n\n\treturn heatmapColors;\n}\n\nexport class Annotations {\n\tstatic applyHeatmap(decoration: Partial<DecorationOptions>, date: Date, heatmap: ComputedHeatmap) {\n\t\tconst [r, g, b, a] = this.getHeatmapColor(date, heatmap);\n\t\tdecoration.renderOptions!.before!.borderColor = `rgba(${r},${g},${b},${a})`;\n\t}\n\n\tstatic addOrUpdateGutterHeatmapDecoration(\n\t\tdate: Date,\n\t\theatmap: ComputedHeatmap,\n\t\trange: Range,\n\t\tmap: Map<string, { decorationType: TextEditorDecorationType; rangesOrOptions: Range[] }>,\n\t) {\n\t\tconst [r, g, b, a] = this.getHeatmapColor(date, heatmap);\n\n\t\tconst { locations } = Container.config.heatmap;\n\t\tconst gutter = locations.includes(HeatmapLocations.Gutter);\n\t\tconst overview = locations.includes(HeatmapLocations.Overview);\n\n\t\tconst key = `${r},${g},${b},${a}`;\n\t\tlet colorDecoration = map.get(key);\n\t\tif (colorDecoration == null) {\n\t\t\tcolorDecoration = {\n\t\t\t\tdecorationType: window.createTextEditorDecorationType({\n\t\t\t\t\tgutterIconPath: gutter\n\t\t\t\t\t\t? Uri.parse(\n\t\t\t\t\t\t\t\t`data:image/svg+xml,${encodeURIComponent(\n\t\t\t\t\t\t\t\t\t`<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 18 18'><rect fill='rgb(${r},${g},${b})' fill-opacity='${a}' x='7' y='0' width='2' height='18'/></svg>`,\n\t\t\t\t\t\t\t\t)}`,\n\t\t\t\t\t\t  )\n\t\t\t\t\t\t: undefined,\n\t\t\t\t\tgutterIconSize: gutter ? 'contain' : undefined,\n\t\t\t\t\toverviewRulerLane: overview ? OverviewRulerLane.Center : undefined,\n\t\t\t\t\toverviewRulerColor: overview ? `rgba(${r},${g},${b},${a})` : undefined,\n\t\t\t\t}),\n\t\t\t\trangesOrOptions: [range],\n\t\t\t};\n\t\t\tmap.set(key, colorDecoration);\n\t\t} else {\n\t\t\tcolorDecoration.rangesOrOptions.push(range);\n\t\t}\n\n\t\treturn colorDecoration.decorationType;\n\t}\n\n\tstatic gutter(\n\t\tcommit: GitCommit,\n\t\tformat: string,\n\t\tdateFormatOrFormatOptions: string | null | CommitFormatOptions,\n\t\trenderOptions: RenderOptions,\n\t): Partial<DecorationOptions> {\n\t\tconst decoration: Partial<DecorationOptions> = {\n\t\t\trenderOptions: {\n\t\t\t\tbefore: { ...renderOptions },\n\t\t\t},\n\t\t};\n\n\t\tif (commit.isUncommitted) {\n\t\t\tdecoration.renderOptions!.before!.color = renderOptions.uncommittedColor;\n\t\t}\n\n\t\tconst message = CommitFormatter.fromTemplate(format, commit, dateFormatOrFormatOptions);\n\t\tdecoration.renderOptions!.before!.contentText = Strings.pad(message.replace(/ /g, GlyphChars.Space), 1, 1);\n\n\t\treturn decoration;\n\t}\n\n\tstatic gutterRenderOptions(\n\t\tseparateLines: boolean,\n\t\theatmap: Config['blame']['heatmap'],\n\t\tavatars: boolean,\n\t\tformat: string,\n\t\toptions: CommitFormatOptions,\n\t): RenderOptions {\n\t\t// Get the character count of all the tokens, assuming there there is a cap (bail if not)\n\t\tlet chars = 0;\n\t\tfor (const token of Object.values(options.tokenOptions!)) {\n\t\t\tif (token === undefined) continue;\n\n\t\t\t// If any token is uncapped, kick out and set no max\n\t\t\tif (token.truncateTo == null) {\n\t\t\t\tchars = -1;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tchars += token.truncateTo;\n\t\t}\n\n\t\tif (chars >= 0) {\n\t\t\t// Add the chars of the template string (without tokens)\n\t\t\tchars += Strings.getWidth(Strings.interpolate(format, undefined));\n\t\t\t// If we have chars, add a bit of padding\n\t\t\tif (chars > 0) {\n\t\t\t\tchars += 3;\n\t\t\t}\n\t\t}\n\n\t\tlet borderStyle = undefined;\n\t\tlet borderWidth = undefined;\n\t\tif (heatmap.enabled) {\n\t\t\tborderStyle = 'solid';\n\t\t\tborderWidth = heatmap.location === 'left' ? '0 0 0 2px' : '0 2px 0 0';\n\t\t}\n\n\t\tlet width;\n\t\tif (chars >= 0) {\n\t\t\tconst spacing = configuration.getAny<number>('editor.letterSpacing');\n\t\t\tif (spacing != null && spacing !== 0) {\n\t\t\t\twidth = `calc(${chars}ch + ${Math.round(chars * spacing) + (avatars ? 13 : -6)}px)`;\n\t\t\t} else {\n\t\t\t\twidth = `calc(${chars}ch ${avatars ? '+ 13px' : '- 6px'})`;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tbackgroundColor: new ThemeColor(Colors.GutterBackgroundColor),\n\t\t\tborderStyle: borderStyle,\n\t\t\tborderWidth: borderWidth,\n\t\t\tcolor: new ThemeColor(Colors.GutterForegroundColor),\n\t\t\tfontWeight: 'normal',\n\t\t\tfontStyle: 'normal',\n\t\t\theight: '100%',\n\t\t\tmargin: '0 26px -1px 0',\n\t\t\ttextDecoration: `${separateLines ? 'overline solid rgba(0, 0, 0, .2)' : 'none'};box-sizing: border-box${\n\t\t\t\tavatars ? ';padding: 0 0 0 18px' : ''\n\t\t\t}`,\n\t\t\twidth: width,\n\t\t\tuncommittedColor: new ThemeColor(Colors.GutterUncommittedForegroundColor),\n\t\t};\n\t}\n\n\tstatic trailing(\n\t\tcommit: GitCommit,\n\t\t// uri: GitUri,\n\t\t// editorLine: number,\n\t\tformat: string,\n\t\tformatOptions?: CommitFormatOptions,\n\t\tscrollable: boolean = true,\n\t): Partial<DecorationOptions> {\n\t\t// TODO: Enable this once there is better caching\n\t\t// let diffUris;\n\t\t// if (commit.isUncommitted) {\n\t\t//     diffUris = await commit.getPreviousLineDiffUris(uri, editorLine, uri.sha);\n\t\t// }\n\n\t\tconst message = CommitFormatter.fromTemplate(format, commit, {\n\t\t\t...formatOptions,\n\t\t\t// previousLineDiffUris: diffUris,\n\t\t\tmessageTruncateAtNewLine: true,\n\t\t});\n\n\t\treturn {\n\t\t\trenderOptions: {\n\t\t\t\tafter: {\n\t\t\t\t\tbackgroundColor: new ThemeColor(Colors.TrailingLineBackgroundColor),\n\t\t\t\t\tcolor: new ThemeColor(Colors.TrailingLineForegroundColor),\n\t\t\t\t\tcontentText: Strings.pad(message.replace(/ /g, GlyphChars.Space), 1, 1),\n\t\t\t\t\tfontWeight: 'normal',\n\t\t\t\t\tfontStyle: 'normal',\n\t\t\t\t\t// Pull the decoration out of the document flow if we want to be scrollable\n\t\t\t\t\ttextDecoration: `none;${scrollable ? '' : ' position: absolute;'}`,\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\tprivate static getHeatmapColor(date: Date, heatmap: ComputedHeatmap) {\n\t\tconst age = heatmap.computeRelativeAge(date);\n\t\tconst colors = date.getTime() < heatmap.coldThresholdTimestamp ? heatmap.colors.cold : heatmap.colors.hot;\n\n\t\tconst color = toRgba(colors[age]);\n\t\tconst a = color == null ? 0 : age === 0 ? 1 : age <= 5 ? 0.8 : 0.6;\n\n\t\treturn [...(color ?? [0, 0, 0]), a];\n\t}\n}\n","'use strict';\nimport { MarkdownString } from 'vscode';\nimport { DiffWithCommand, ShowQuickCommitCommand } from '../commands';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport {\n\tCommitFormatter,\n\tGitBlameCommit,\n\tGitCommit,\n\tGitDiffHunk,\n\tGitDiffHunkLine,\n\tGitLogCommit,\n\tGitRemote,\n\tGitRevision,\n} from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Iterables, Promises, Strings } from '../system';\n\nexport namespace Hovers {\n\texport async function changesMessage(\n\t\tcommit: GitBlameCommit | GitLogCommit,\n\t\turi: GitUri,\n\t\teditorLine: number,\n\t): Promise<MarkdownString | undefined> {\n\t\tconst documentRef = uri.sha;\n\n\t\tlet hunkLine;\n\t\tif (GitBlameCommit.is(commit)) {\n\t\t\t// TODO: Figure out how to optimize this\n\t\t\tlet ref;\n\t\t\tif (commit.isUncommitted) {\n\t\t\t\tif (GitRevision.isUncommittedStaged(documentRef)) {\n\t\t\t\t\tref = documentRef;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tref = commit.previousSha;\n\t\t\t}\n\n\t\t\tconst line = editorLine + 1;\n\t\t\tconst commitLine = commit.lines.find(l => l.line === line) ?? commit.lines[0];\n\n\t\t\tlet originalFileName = commit.originalFileName;\n\t\t\tif (originalFileName == null) {\n\t\t\t\tif (uri.fsPath !== commit.uri.fsPath) {\n\t\t\t\t\toriginalFileName = commit.fileName;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\teditorLine = commitLine.line - 1;\n\t\t\t// TODO: Doesn't work with dirty files -- pass in editor? or contents?\n\t\t\thunkLine = await Container.git.getDiffForLine(uri, editorLine, ref, documentRef, originalFileName);\n\n\t\t\t// If we didn't find a diff & ref is undefined (meaning uncommitted), check for a staged diff\n\t\t\tif (hunkLine == null && ref == null) {\n\t\t\t\thunkLine = await Container.git.getDiffForLine(\n\t\t\t\t\turi,\n\t\t\t\t\teditorLine,\n\t\t\t\t\tundefined,\n\t\t\t\t\tGitRevision.uncommittedStaged,\n\t\t\t\t\toriginalFileName,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (hunkLine == null || commit.previousSha == null) return undefined;\n\n\t\tconst diff = getDiffFromHunkLine(hunkLine);\n\n\t\tlet message;\n\t\tlet previous;\n\t\tlet current;\n\t\tif (commit.isUncommitted) {\n\t\t\tconst diffUris = await commit.getPreviousLineDiffUris(uri, editorLine, documentRef);\n\t\t\tif (diffUris == null || diffUris.previous == null) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tmessage = `[$(compare-changes)](${DiffWithCommand.getMarkdownCommandArgs({\n\t\t\t\tlhs: {\n\t\t\t\t\tsha: diffUris.previous.sha ?? '',\n\t\t\t\t\turi: diffUris.previous.documentUri(),\n\t\t\t\t},\n\t\t\t\trhs: {\n\t\t\t\t\tsha: diffUris.current.sha ?? '',\n\t\t\t\t\turi: diffUris.current.documentUri(),\n\t\t\t\t},\n\t\t\t\trepoPath: commit.repoPath,\n\t\t\t\tline: editorLine,\n\t\t\t})} \"Open Changes\")`;\n\n\t\t\tprevious =\n\t\t\t\tdiffUris.previous.sha == null || diffUris.previous.isUncommitted\n\t\t\t\t\t? `_${GitRevision.shorten(diffUris.previous.sha, {\n\t\t\t\t\t\t\tstrings: {\n\t\t\t\t\t\t\t\tworking: 'Working Tree',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  })}_`\n\t\t\t\t\t: `[$(git-commit) ${GitRevision.shorten(\n\t\t\t\t\t\t\tdiffUris.previous.sha || '',\n\t\t\t\t\t  )}](${ShowQuickCommitCommand.getMarkdownCommandArgs(diffUris.previous.sha || '')} \"Show Commit\")`;\n\n\t\t\tcurrent =\n\t\t\t\tdiffUris.current.sha == null || diffUris.current.isUncommitted\n\t\t\t\t\t? `_${GitRevision.shorten(diffUris.current.sha, {\n\t\t\t\t\t\t\tstrings: {\n\t\t\t\t\t\t\t\tworking: 'Working Tree',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  })}_`\n\t\t\t\t\t: `[$(git-commit) ${GitRevision.shorten(\n\t\t\t\t\t\t\tdiffUris.current.sha || '',\n\t\t\t\t\t  )}](${ShowQuickCommitCommand.getMarkdownCommandArgs(diffUris.current.sha || '')} \"Show Commit\")`;\n\t\t} else {\n\t\t\tmessage = `[$(compare-changes)](${DiffWithCommand.getMarkdownCommandArgs(\n\t\t\t\tcommit,\n\t\t\t\teditorLine,\n\t\t\t)} \"Open Changes\")`;\n\n\t\t\tprevious = `[$(git-commit) ${commit.previousShortSha}](${ShowQuickCommitCommand.getMarkdownCommandArgs(\n\t\t\t\tcommit.previousSha,\n\t\t\t)} \"Show Commit\")`;\n\n\t\t\tcurrent = `[$(git-commit) ${commit.shortSha}](${ShowQuickCommitCommand.getMarkdownCommandArgs(\n\t\t\t\tcommit.sha,\n\t\t\t)} \"Show Commit\")`;\n\t\t}\n\n\t\tmessage = `${diff}\\n---\\n\\nChanges  &nbsp;${previous} &nbsp;${GlyphChars.ArrowLeftRightLong}&nbsp; ${current} &nbsp;&nbsp;|&nbsp;&nbsp; ${message}`;\n\n\t\tconst markdown = new MarkdownString(message, true);\n\t\tmarkdown.isTrusted = true;\n\t\treturn markdown;\n\t}\n\n\texport function localChangesMessage(\n\t\tfromCommit: GitLogCommit | undefined,\n\t\turi: GitUri,\n\t\teditorLine: number,\n\t\thunk: GitDiffHunk,\n\t): MarkdownString {\n\t\tconst diff = getDiffFromHunk(hunk);\n\n\t\tlet message;\n\t\tlet previous;\n\t\tlet current;\n\t\tif (fromCommit == null) {\n\t\t\tprevious = '_Working Tree_';\n\t\t\tcurrent = '_Unsaved_';\n\t\t} else {\n\t\t\tconst file = fromCommit.findFile(uri.fsPath)!;\n\n\t\t\tmessage = `[$(compare-changes)](${DiffWithCommand.getMarkdownCommandArgs({\n\t\t\t\tlhs: {\n\t\t\t\t\tsha: fromCommit.sha,\n\t\t\t\t\turi: GitUri.fromFile(file, uri.repoPath!, undefined, true).toFileUri(),\n\t\t\t\t},\n\t\t\t\trhs: {\n\t\t\t\t\tsha: '',\n\t\t\t\t\turi: uri.toFileUri(),\n\t\t\t\t},\n\t\t\t\trepoPath: uri.repoPath!,\n\t\t\t\tline: editorLine,\n\t\t\t})} \"Open Changes\")`;\n\n\t\t\tprevious = `[$(git-commit) ${fromCommit.shortSha}](${ShowQuickCommitCommand.getMarkdownCommandArgs(\n\t\t\t\tfromCommit.sha,\n\t\t\t)} \"Show Commit\")`;\n\n\t\t\tcurrent = '_Working Tree_';\n\t\t}\n\t\tmessage = `${diff}\\n---\\n\\nLocal Changes  &nbsp;${previous} &nbsp;${\n\t\t\tGlyphChars.ArrowLeftRightLong\n\t\t}&nbsp; ${current}${message == null ? '' : ` &nbsp;&nbsp;|&nbsp;&nbsp; ${message}`}`;\n\n\t\tconst markdown = new MarkdownString(message, true);\n\t\tmarkdown.isTrusted = true;\n\t\treturn markdown;\n\t}\n\n\texport async function detailsMessage(\n\t\tcommit: GitCommit,\n\t\turi: GitUri,\n\t\teditorLine: number,\n\t\tdateFormat: string | null,\n\t): Promise<MarkdownString> {\n\t\tif (dateFormat === null) {\n\t\t\tdateFormat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\tconst remotes = await Container.git.getRemotes(commit.repoPath, { sort: true });\n\n\t\tconst [previousLineDiffUris, autolinkedIssuesOrPullRequests, pr, presence] = await Promise.all([\n\t\t\tcommit.isUncommitted ? commit.getPreviousLineDiffUris(uri, editorLine, uri.sha) : undefined,\n\t\t\tgetAutoLinkedIssuesOrPullRequests(commit.message, remotes),\n\t\t\tgetPullRequestForCommit(commit.ref, remotes),\n\t\t\tContainer.vsls.maybeGetPresence(commit.email),\n\t\t]);\n\n\t\tconst details = await CommitFormatter.fromTemplateAsync(Container.config.hovers.detailsMarkdownFormat, commit, {\n\t\t\tautolinkedIssuesOrPullRequests: autolinkedIssuesOrPullRequests,\n\t\t\tdateFormat: dateFormat,\n\t\t\teditor: {\n\t\t\t\tline: editorLine,\n\t\t\t\turi: uri,\n\t\t\t},\n\t\t\tmarkdown: true,\n\t\t\tmessageAutolinks: Container.config.hovers.autolinks.enabled,\n\t\t\tpullRequestOrRemote: pr,\n\t\t\tpresence: presence,\n\t\t\tpreviousLineDiffUris: previousLineDiffUris,\n\t\t\tremotes: remotes,\n\t\t});\n\n\t\tconst markdown = new MarkdownString(details, true);\n\t\tmarkdown.isTrusted = true;\n\t\treturn markdown;\n\t}\n\n\tfunction getDiffFromHunk(hunk: GitDiffHunk): string {\n\t\treturn `\\`\\`\\`diff\\n${hunk.diff.trim()}\\n\\`\\`\\``;\n\t}\n\n\tfunction getDiffFromHunkLine(hunkLine: GitDiffHunkLine, diffStyle?: 'line' | 'hunk'): string {\n\t\tif (diffStyle === 'hunk' || (diffStyle == null && Container.config.hovers.changesDiff === 'hunk')) {\n\t\t\treturn getDiffFromHunk(hunkLine.hunk);\n\t\t}\n\n\t\treturn `\\`\\`\\`diff${hunkLine.previous == null ? '' : `\\n- ${hunkLine.previous.line.trim()}`}${\n\t\t\thunkLine.current == null ? '' : `\\n+ ${hunkLine.current.line.trim()}`\n\t\t}\\n\\`\\`\\``;\n\t}\n\n\tasync function getAutoLinkedIssuesOrPullRequests(message: string, remotes: GitRemote[]) {\n\t\tconst cc = Logger.getNewCorrelationContext('Hovers.getAutoLinkedIssues');\n\t\tLogger.debug(cc, `${GlyphChars.Dash} message=<message>`);\n\n\t\tconst start = process.hrtime();\n\n\t\tif (\n\t\t\t!Container.config.hovers.autolinks.enabled ||\n\t\t\t!Container.config.hovers.autolinks.enhanced ||\n\t\t\t!CommitFormatter.has(Container.config.hovers.detailsMarkdownFormat, 'message')\n\t\t) {\n\t\t\tLogger.debug(cc, `completed ${GlyphChars.Dot} ${Strings.getDurationMilliseconds(start)} ms`);\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst remote = await Container.git.getRichRemoteProvider(remotes);\n\t\tif (remote?.provider == null) {\n\t\t\tLogger.debug(cc, `completed ${GlyphChars.Dot} ${Strings.getDurationMilliseconds(start)} ms`);\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// TODO: Make this configurable?\n\t\tconst timeout = 250;\n\n\t\ttry {\n\t\t\tconst autolinks = await Container.autolinks.getIssueOrPullRequestLinks(message, remote, {\n\t\t\t\ttimeout: timeout,\n\t\t\t});\n\n\t\t\tif (autolinks != null && Logger.willLog('debug')) {\n\t\t\t\t// If there are any issues/PRs that timed out, log it\n\t\t\t\tconst count = Iterables.count(autolinks.values(), pr => pr instanceof Promises.CancellationError);\n\t\t\t\tif (count !== 0) {\n\t\t\t\t\tLogger.debug(\n\t\t\t\t\t\tcc,\n\t\t\t\t\t\t`timed out ${\n\t\t\t\t\t\t\tGlyphChars.Dash\n\t\t\t\t\t\t} ${count} issue/pull request queries took too long (over ${timeout} ms) ${\n\t\t\t\t\t\t\tGlyphChars.Dot\n\t\t\t\t\t\t} ${Strings.getDurationMilliseconds(start)} ms`,\n\t\t\t\t\t);\n\n\t\t\t\t\t// const pending = [\n\t\t\t\t\t// \t...Iterables.map(autolinks.values(), issueOrPullRequest =>\n\t\t\t\t\t// \t\tissueOrPullRequest instanceof Promises.CancellationError\n\t\t\t\t\t// \t\t\t? issueOrPullRequest.promise\n\t\t\t\t\t// \t\t\t: undefined,\n\t\t\t\t\t// \t),\n\t\t\t\t\t// ];\n\t\t\t\t\t// void Promise.all(pending).then(() => {\n\t\t\t\t\t// \tLogger.debug(\n\t\t\t\t\t// \t\tcc,\n\t\t\t\t\t// \t\t`${GlyphChars.Dot} ${count} issue/pull request queries completed; refreshing...`,\n\t\t\t\t\t// \t);\n\t\t\t\t\t// \tvoid commands.executeCommand('editor.action.showHover');\n\t\t\t\t\t// });\n\n\t\t\t\t\treturn autolinks;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tLogger.debug(cc, `completed ${GlyphChars.Dot} ${Strings.getDurationMilliseconds(start)} ms`);\n\n\t\t\treturn autolinks;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc, `failed ${GlyphChars.Dot} ${Strings.getDurationMilliseconds(start)} ms`);\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync function getPullRequestForCommit(ref: string, remotes: GitRemote[]) {\n\t\tconst cc = Logger.getNewCorrelationContext('Hovers.getPullRequestForCommit');\n\t\tLogger.debug(cc, `${GlyphChars.Dash} ref=${ref}`);\n\n\t\tconst start = process.hrtime();\n\n\t\tif (\n\t\t\t!Container.config.hovers.pullRequests.enabled ||\n\t\t\t!CommitFormatter.has(\n\t\t\t\tContainer.config.hovers.detailsMarkdownFormat,\n\t\t\t\t'pullRequest',\n\t\t\t\t'pullRequestAgo',\n\t\t\t\t'pullRequestAgoOrDate',\n\t\t\t\t'pullRequestDate',\n\t\t\t\t'pullRequestState',\n\t\t\t)\n\t\t) {\n\t\t\tLogger.debug(cc, `completed ${GlyphChars.Dot} ${Strings.getDurationMilliseconds(start)} ms`);\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst remote = await Container.git.getRichRemoteProvider(remotes, { includeDisconnected: true });\n\t\tif (remote?.provider == null) {\n\t\t\tLogger.debug(cc, `completed ${GlyphChars.Dot} ${Strings.getDurationMilliseconds(start)} ms`);\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst { provider } = remote;\n\t\tconst connected = provider.maybeConnected ?? (await provider.isConnected());\n\t\tif (!connected) {\n\t\t\tLogger.debug(cc, `completed ${GlyphChars.Dot} ${Strings.getDurationMilliseconds(start)} ms`);\n\n\t\t\treturn remote;\n\t\t}\n\n\t\ttry {\n\t\t\tconst pr = await Container.git.getPullRequestForCommit(ref, provider, { timeout: 250 });\n\n\t\t\tLogger.debug(cc, `completed ${GlyphChars.Dot} ${Strings.getDurationMilliseconds(start)} ms`);\n\n\t\t\treturn pr;\n\t\t} catch (ex) {\n\t\t\tif (ex instanceof Promises.CancellationError) {\n\t\t\t\tLogger.debug(cc, `timed out ${GlyphChars.Dot} ${Strings.getDurationMilliseconds(start)} ms`);\n\n\t\t\t\treturn ex;\n\t\t\t}\n\n\t\t\tLogger.error(ex, cc, `failed ${GlyphChars.Dot} ${Strings.getDurationMilliseconds(start)} ms`);\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n}\n","'use strict';\nimport { CancellationToken, Disposable, Hover, languages, Position, Range, TextDocument, TextEditor } from 'vscode';\nimport { FileAnnotationType } from '../config';\nimport { Container } from '../container';\nimport { GitBlame, GitBlameCommit, GitCommit } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Hovers } from '../hovers/hovers';\nimport { log } from '../system';\nimport { GitDocumentState, TrackedDocument } from '../trackers/gitDocumentTracker';\nimport { AnnotationProviderBase } from './annotationProvider';\nimport { ComputedHeatmap, getHeatmapColors } from './annotations';\n\nexport abstract class BlameAnnotationProviderBase extends AnnotationProviderBase {\n\tprotected blame: Promise<GitBlame | undefined>;\n\tprotected hoverProviderDisposable: Disposable | undefined;\n\n\tconstructor(\n\t\tannotationType: FileAnnotationType,\n\t\teditor: TextEditor,\n\t\ttrackedDocument: TrackedDocument<GitDocumentState>,\n\t) {\n\t\tsuper(annotationType, editor, trackedDocument);\n\n\t\tthis.blame = editor.document.isDirty\n\t\t\t? Container.git.getBlameForFileContents(this.trackedDocument.uri, editor.document.getText())\n\t\t\t: Container.git.getBlameForFile(this.trackedDocument.uri);\n\n\t\tif (editor.document.isDirty) {\n\t\t\ttrackedDocument.setForceDirtyStateChangeOnNextDocumentChange();\n\t\t}\n\t}\n\n\toverride clear() {\n\t\tif (this.hoverProviderDisposable != null) {\n\t\t\tthis.hoverProviderDisposable.dispose();\n\t\t\tthis.hoverProviderDisposable = undefined;\n\t\t}\n\t\tsuper.clear();\n\t}\n\n\tasync validate(): Promise<boolean> {\n\t\tconst blame = await this.blame;\n\t\treturn blame != null && blame.lines.length !== 0;\n\t}\n\n\tprotected async getBlame(): Promise<GitBlame | undefined> {\n\t\tconst blame = await this.blame;\n\t\tif (blame == null || blame.lines.length === 0) return undefined;\n\n\t\treturn blame;\n\t}\n\n\t@log({ args: false })\n\tprotected async getComputedHeatmap(blame: GitBlame): Promise<ComputedHeatmap> {\n\t\tconst dates: Date[] = [];\n\n\t\tlet commit;\n\t\tlet previousSha;\n\t\tfor (const l of blame.lines) {\n\t\t\tif (previousSha === l.sha) continue;\n\t\t\tpreviousSha = l.sha;\n\n\t\t\tcommit = blame.commits.get(l.sha);\n\t\t\tif (commit == null) continue;\n\n\t\t\tdates.push(commit.date);\n\t\t}\n\n\t\tdates.sort((a, b) => a.getTime() - b.getTime());\n\n\t\tconst coldThresholdDate = new Date();\n\t\tcoldThresholdDate.setDate(coldThresholdDate.getDate() - (Container.config.heatmap.ageThreshold || 90));\n\t\tconst coldThresholdTimestamp = coldThresholdDate.getTime();\n\n\t\tconst hotDates: Date[] = [];\n\t\tconst coldDates: Date[] = [];\n\n\t\tfor (const d of dates) {\n\t\t\tif (d.getTime() < coldThresholdTimestamp) {\n\t\t\t\tcoldDates.push(d);\n\t\t\t} else {\n\t\t\t\thotDates.push(d);\n\t\t\t}\n\t\t}\n\n\t\tlet lookupTable:\n\t\t\t| number[]\n\t\t\t| {\n\t\t\t\t\thot: number[];\n\t\t\t\t\tcold: number[];\n\t\t\t  };\n\t\tif (hotDates.length && coldDates.length) {\n\t\t\tlookupTable = {\n\t\t\t\thot: getRelativeAgeLookupTable(hotDates),\n\t\t\t\tcold: getRelativeAgeLookupTable(coldDates),\n\t\t\t};\n\t\t} else {\n\t\t\tlookupTable = getRelativeAgeLookupTable(dates);\n\t\t}\n\n\t\treturn {\n\t\t\tcoldThresholdTimestamp: coldThresholdTimestamp,\n\t\t\tcolors: await getHeatmapColors(),\n\t\t\tcomputeRelativeAge: (date: Date) => {\n\t\t\t\tconst lookup = Array.isArray(lookupTable)\n\t\t\t\t\t? lookupTable\n\t\t\t\t\t: date.getTime() < coldThresholdTimestamp\n\t\t\t\t\t? lookupTable.cold\n\t\t\t\t\t: lookupTable.hot;\n\n\t\t\t\tconst time = date.getTime();\n\t\t\t\tlet index = 0;\n\t\t\t\tfor (let i = 0; i < lookup.length; i++) {\n\t\t\t\t\tindex = i;\n\t\t\t\t\tif (time >= lookup[i]) break;\n\t\t\t\t}\n\n\t\t\t\treturn index;\n\t\t\t},\n\t\t};\n\t}\n\n\tregisterHoverProviders(providers: { details: boolean; changes: boolean }) {\n\t\tif (\n\t\t\t!Container.config.hovers.enabled ||\n\t\t\t!Container.config.hovers.annotations.enabled ||\n\t\t\t(!providers.details && !providers.changes)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.hoverProviderDisposable = languages.registerHoverProvider(\n\t\t\t{ pattern: this.document.uri.fsPath },\n\t\t\t{\n\t\t\t\tprovideHover: (document: TextDocument, position: Position, token: CancellationToken) =>\n\t\t\t\t\tthis.provideHover(providers, document, position, token),\n\t\t\t},\n\t\t);\n\t}\n\n\tasync provideHover(\n\t\tproviders: { details: boolean; changes: boolean },\n\t\tdocument: TextDocument,\n\t\tposition: Position,\n\t\t_token: CancellationToken,\n\t): Promise<Hover | undefined> {\n\t\tif (Container.config.hovers.annotations.over !== 'line' && position.character !== 0) return undefined;\n\n\t\tconst blame = await this.getBlame();\n\t\tif (blame == null) return undefined;\n\n\t\tconst line = blame.lines[position.line];\n\n\t\tconst commit = blame.commits.get(line.sha);\n\t\tif (commit == null) return undefined;\n\n\t\tconst messages = (\n\t\t\tawait Promise.all([\n\t\t\t\tproviders.details ? this.getDetailsHoverMessage(commit, document) : undefined,\n\t\t\t\tproviders.changes\n\t\t\t\t\t? Hovers.changesMessage(commit, await GitUri.fromUri(document.uri), position.line)\n\t\t\t\t\t: undefined,\n\t\t\t])\n\t\t).filter(<T>(m?: T): m is T => Boolean(m));\n\n\t\treturn new Hover(\n\t\t\tmessages,\n\t\t\tdocument.validateRange(new Range(position.line, 0, position.line, Number.MAX_SAFE_INTEGER)),\n\t\t);\n\t}\n\n\tprivate async getDetailsHoverMessage(commit: GitBlameCommit, document: TextDocument) {\n\t\t// Get the full commit message -- since blame only returns the summary\n\t\tlet logCommit: GitCommit | undefined = undefined;\n\t\tif (!commit.isUncommitted) {\n\t\t\tlogCommit = await Container.git.getCommitForFile(commit.repoPath, commit.uri.fsPath, {\n\t\t\t\tref: commit.sha,\n\t\t\t});\n\t\t\tif (logCommit != null) {\n\t\t\t\t// Preserve the previous commit from the blame commit\n\t\t\t\tlogCommit.previousFileName = commit.previousFileName;\n\t\t\t\tlogCommit.previousSha = commit.previousSha;\n\t\t\t}\n\t\t}\n\n\t\tlet editorLine = this.editor.selection.active.line;\n\t\tconst line = editorLine + 1;\n\t\tconst commitLine = commit.lines.find(l => l.line === line) ?? commit.lines[0];\n\t\teditorLine = commitLine.originalLine - 1;\n\n\t\treturn Hovers.detailsMessage(\n\t\t\tlogCommit ?? commit,\n\t\t\tawait GitUri.fromUri(document.uri),\n\t\t\teditorLine,\n\t\t\tContainer.config.defaultDateFormat,\n\t\t);\n\t}\n}\n\nfunction getRelativeAgeLookupTable(dates: Date[]) {\n\tconst lookup: number[] = [];\n\n\tconst half = Math.floor(dates.length / 2);\n\tconst median = dates.length % 2 ? dates[half].getTime() : (dates[half - 1].getTime() + dates[half].getTime()) / 2.0;\n\n\tconst newest = dates[dates.length - 1].getTime();\n\tlet step = (newest - median) / 5;\n\tfor (let i = 5; i > 0; i--) {\n\t\tlookup.push(median + step * i);\n\t}\n\n\tlookup.push(median);\n\n\tconst oldest = dates[0].getTime();\n\tstep = (median - oldest) / 4;\n\tfor (let i = 1; i <= 4; i++) {\n\t\tlookup.push(median - step * i);\n\t}\n\n\treturn lookup;\n}\n","'use strict';\nimport { DecorationOptions, Range, TextEditor, ThemableDecorationAttachmentRenderOptions } from 'vscode';\nimport { FileAnnotationType, GravatarDefaultStyle } from '../configuration';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { CommitFormatOptions, CommitFormatter, GitBlame, GitBlameCommit } from '../git/git';\nimport { Logger } from '../logger';\nimport { Arrays, Iterables, log, Strings } from '../system';\nimport { GitDocumentState } from '../trackers/gitDocumentTracker';\nimport { TrackedDocument } from '../trackers/trackedDocument';\nimport { AnnotationContext } from './annotationProvider';\nimport { Annotations } from './annotations';\nimport { BlameAnnotationProviderBase } from './blameAnnotationProvider';\nimport { Decorations } from './fileAnnotationController';\n\nexport class GutterBlameAnnotationProvider extends BlameAnnotationProviderBase {\n\tconstructor(editor: TextEditor, trackedDocument: TrackedDocument<GitDocumentState>) {\n\t\tsuper(FileAnnotationType.Blame, editor, trackedDocument);\n\t}\n\n\toverride clear() {\n\t\tsuper.clear();\n\n\t\tif (Decorations.gutterBlameHighlight != null) {\n\t\t\ttry {\n\t\t\t\tthis.editor.setDecorations(Decorations.gutterBlameHighlight, []);\n\t\t\t} catch {}\n\t\t}\n\t}\n\n\t@log()\n\tasync onProvideAnnotation(context?: AnnotationContext, _type?: FileAnnotationType): Promise<boolean> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tthis.annotationContext = context;\n\n\t\tconst blame = await this.getBlame();\n\t\tif (blame == null) return false;\n\n\t\tlet start = process.hrtime();\n\n\t\tconst cfg = Container.config.blame;\n\n\t\t// Precalculate the formatting options so we don't need to do it on each iteration\n\t\tconst tokenOptions = Strings.getTokensFromTemplate(cfg.format).reduce<{\n\t\t\t[token: string]: Strings.TokenOptions | undefined;\n\t\t}>((map, token) => {\n\t\t\tmap[token.key] = token.options;\n\t\t\treturn map;\n\t\t}, Object.create(null));\n\n\t\tlet getBranchAndTagTips;\n\t\tif (CommitFormatter.has(cfg.format, 'tips')) {\n\t\t\tgetBranchAndTagTips = await Container.git.getBranchesAndTagsTipsFn(blame.repoPath);\n\t\t}\n\n\t\tconst options: CommitFormatOptions = {\n\t\t\tdateFormat: cfg.dateFormat === null ? Container.config.defaultDateFormat : cfg.dateFormat,\n\t\t\tgetBranchAndTagTips: getBranchAndTagTips,\n\t\t\ttokenOptions: tokenOptions,\n\t\t};\n\n\t\tconst avatars = cfg.avatars;\n\t\tconst gravatarDefault = Container.config.defaultGravatarsStyle;\n\t\tconst separateLines = cfg.separateLines;\n\t\tconst renderOptions = Annotations.gutterRenderOptions(\n\t\t\tseparateLines,\n\t\t\tcfg.heatmap,\n\t\t\tcfg.avatars,\n\t\t\tcfg.format,\n\t\t\toptions,\n\t\t);\n\n\t\tconst decorationOptions = [];\n\t\tconst decorationsMap = new Map<string, DecorationOptions | undefined>();\n\t\tconst avatarDecorationsMap = avatars ? new Map<string, ThemableDecorationAttachmentRenderOptions>() : undefined;\n\n\t\tlet commit: GitBlameCommit | undefined;\n\t\tlet compacted = false;\n\t\tlet gutter: DecorationOptions | undefined;\n\t\tlet previousSha: string | undefined;\n\n\t\tlet computedHeatmap;\n\t\tif (cfg.heatmap.enabled) {\n\t\t\tcomputedHeatmap = await this.getComputedHeatmap(blame);\n\t\t}\n\n\t\tfor (const l of blame.lines) {\n\t\t\t// editor lines are 0-based\n\t\t\tconst editorLine = l.line - 1;\n\n\t\t\tif (previousSha === l.sha) {\n\t\t\t\tif (gutter == null) continue;\n\n\t\t\t\t// Use a shallow copy of the previous decoration options\n\t\t\t\tgutter = { ...gutter };\n\n\t\t\t\tif (cfg.compact && !compacted) {\n\t\t\t\t\t// Since we are wiping out the contextText make sure to copy the objects\n\t\t\t\t\tgutter.renderOptions = {\n\t\t\t\t\t\tbefore: {\n\t\t\t\t\t\t\t...gutter.renderOptions!.before,\n\t\t\t\t\t\t\tcontentText: GlyphChars.Space.repeat(\n\t\t\t\t\t\t\t\tStrings.getWidth(gutter.renderOptions!.before!.contentText!),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\tif (separateLines) {\n\t\t\t\t\t\tgutter.renderOptions.before!.textDecoration = `none;box-sizing: border-box${\n\t\t\t\t\t\t\tavatars ? ';padding: 0 0 0 18px' : ''\n\t\t\t\t\t\t}`;\n\t\t\t\t\t}\n\n\t\t\t\t\tcompacted = true;\n\t\t\t\t}\n\n\t\t\t\tgutter.range = new Range(editorLine, 0, editorLine, 0);\n\n\t\t\t\tdecorationOptions.push(gutter);\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tcompacted = false;\n\t\t\tpreviousSha = l.sha;\n\n\t\t\tcommit = blame.commits.get(l.sha);\n\t\t\tif (commit == null) continue;\n\n\t\t\tgutter = decorationsMap.get(l.sha);\n\t\t\tif (gutter != null) {\n\t\t\t\tgutter = {\n\t\t\t\t\t...gutter,\n\t\t\t\t\trange: new Range(editorLine, 0, editorLine, 0),\n\t\t\t\t};\n\n\t\t\t\tdecorationOptions.push(gutter);\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tgutter = Annotations.gutter(commit, cfg.format, options, renderOptions) as DecorationOptions;\n\n\t\t\tif (computedHeatmap != null) {\n\t\t\t\tAnnotations.applyHeatmap(gutter, commit.date, computedHeatmap);\n\t\t\t}\n\n\t\t\tgutter.range = new Range(editorLine, 0, editorLine, 0);\n\n\t\t\tdecorationOptions.push(gutter);\n\n\t\t\tif (avatars && commit.email != null) {\n\t\t\t\tawait this.applyAvatarDecoration(commit, gutter, gravatarDefault, avatarDecorationsMap!);\n\t\t\t}\n\n\t\t\tdecorationsMap.set(l.sha, gutter);\n\t\t}\n\n\t\tLogger.log(cc, `${Strings.getDurationMilliseconds(start)} ms to compute gutter blame annotations`);\n\n\t\tif (decorationOptions.length) {\n\t\t\tstart = process.hrtime();\n\n\t\t\tthis.setDecorations([\n\t\t\t\t{ decorationType: Decorations.gutterBlameAnnotation, rangesOrOptions: decorationOptions },\n\t\t\t]);\n\n\t\t\tLogger.log(cc, `${Strings.getDurationMilliseconds(start)} ms to apply all gutter blame annotations`);\n\t\t}\n\n\t\tthis.registerHoverProviders(Container.config.hovers.annotations);\n\t\treturn true;\n\t}\n\n\t@log({ args: false })\n\tasync selection(selection?: AnnotationContext['selection'], blame?: GitBlame): Promise<void> {\n\t\tif (selection === false || Decorations.gutterBlameHighlight == null) return;\n\n\t\tif (blame == null) {\n\t\t\tblame = await this.blame;\n\t\t\tif (!blame?.lines.length) return;\n\t\t}\n\n\t\tlet sha: string | undefined = undefined;\n\t\tif (selection?.sha != null) {\n\t\t\tsha = selection.sha;\n\t\t} else if (selection?.line != null) {\n\t\t\tif (selection.line >= 0) {\n\t\t\t\tconst commitLine = blame.lines[selection.line];\n\t\t\t\tsha = commitLine?.sha;\n\t\t\t}\n\t\t} else {\n\t\t\tsha = Iterables.first(blame.commits.values()).sha;\n\t\t}\n\n\t\tif (!sha) {\n\t\t\tthis.editor.setDecorations(Decorations.gutterBlameHighlight, []);\n\t\t\treturn;\n\t\t}\n\n\t\tconst highlightDecorationRanges = Arrays.filterMap(blame.lines, l =>\n\t\t\tl.sha === sha\n\t\t\t\t? // editor lines are 0-based\n\t\t\t\t  this.editor.document.validateRange(new Range(l.line - 1, 0, l.line - 1, Number.MAX_SAFE_INTEGER))\n\t\t\t\t: undefined,\n\t\t);\n\n\t\tthis.editor.setDecorations(Decorations.gutterBlameHighlight, highlightDecorationRanges);\n\t}\n\n\tprivate async applyAvatarDecoration(\n\t\tcommit: GitBlameCommit,\n\t\tgutter: DecorationOptions,\n\t\tgravatarDefault: GravatarDefaultStyle,\n\t\tmap: Map<string, ThemableDecorationAttachmentRenderOptions>,\n\t) {\n\t\tlet avatarDecoration = map.get(commit.email!);\n\t\tif (avatarDecoration == null) {\n\t\t\tconst url = (await commit.getAvatarUri({ defaultStyle: gravatarDefault, size: 16 })).toString(true);\n\t\t\tavatarDecoration = {\n\t\t\t\tcontentText: '',\n\t\t\t\theight: '16px',\n\t\t\t\twidth: '16px',\n\t\t\t\ttextDecoration: `none;position:absolute;top:1px;left:5px;background:url(${encodeURI(\n\t\t\t\t\turl,\n\t\t\t\t)});background-size:16px 16px;margin-left: 0 !important`,\n\t\t\t};\n\t\t\tmap.set(commit.email!, avatarDecoration);\n\t\t}\n\n\t\tgutter.renderOptions!.after = avatarDecoration;\n\t}\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tDecorationOptions,\n\tDisposable,\n\tHover,\n\tlanguages,\n\tPosition,\n\tRange,\n\tSelection,\n\tTextDocument,\n\tTextEditor,\n\tTextEditorDecorationType,\n\tTextEditorRevealType,\n} from 'vscode';\nimport { FileAnnotationType } from '../configuration';\nimport { Container } from '../container';\nimport { GitDiff, GitLogCommit } from '../git/git';\nimport { Hovers } from '../hovers/hovers';\nimport { Logger } from '../logger';\nimport { log, Strings } from '../system';\nimport { GitDocumentState, TrackedDocument } from '../trackers/gitDocumentTracker';\nimport { AnnotationContext, AnnotationProviderBase } from './annotationProvider';\nimport { Decorations } from './fileAnnotationController';\n\nexport interface ChangesAnnotationContext extends AnnotationContext {\n\tsha?: string;\n\tonly?: boolean;\n}\n\nexport class GutterChangesAnnotationProvider extends AnnotationProviderBase<ChangesAnnotationContext> {\n\tprivate state: { commit: GitLogCommit | undefined; diffs: GitDiff[] } | undefined;\n\tprivate hoverProviderDisposable: Disposable | undefined;\n\n\tconstructor(editor: TextEditor, trackedDocument: TrackedDocument<GitDocumentState>) {\n\t\tsuper(FileAnnotationType.Changes, editor, trackedDocument);\n\t}\n\n\toverride mustReopen(context?: ChangesAnnotationContext): boolean {\n\t\treturn this.annotationContext?.sha !== context?.sha || this.annotationContext?.only !== context?.only;\n\t}\n\n\toverride clear() {\n\t\tthis.state = undefined;\n\t\tif (this.hoverProviderDisposable != null) {\n\t\t\tthis.hoverProviderDisposable.dispose();\n\t\t\tthis.hoverProviderDisposable = undefined;\n\t\t}\n\t\tsuper.clear();\n\t}\n\n\tselection(_selection?: AnnotationContext['selection']): Promise<void> {\n\t\treturn Promise.resolve();\n\t}\n\n\tvalidate(): Promise<boolean> {\n\t\treturn Promise.resolve(true);\n\t}\n\n\t@log()\n\tasync onProvideAnnotation(context?: ChangesAnnotationContext): Promise<boolean> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tif (this.mustReopen(context)) {\n\t\t\tthis.clear();\n\t\t}\n\n\t\tthis.annotationContext = context;\n\n\t\tlet ref1 = this.trackedDocument.uri.sha;\n\t\tlet ref2 = context?.sha != null && context.sha !== ref1 ? `${context.sha}^` : undefined;\n\n\t\tlet commit: GitLogCommit | undefined;\n\n\t\tlet localChanges = ref1 == null && ref2 == null;\n\t\tif (localChanges) {\n\t\t\tlet ref = await Container.git.getOldestUnpushedRefForFile(\n\t\t\t\tthis.trackedDocument.uri.repoPath!,\n\t\t\t\tthis.trackedDocument.uri.fsPath,\n\t\t\t);\n\t\t\tif (ref != null) {\n\t\t\t\tref = `${ref}^`;\n\t\t\t\tcommit = await Container.git.getCommitForFile(\n\t\t\t\t\tthis.trackedDocument.uri.repoPath,\n\t\t\t\t\tthis.trackedDocument.uri.fsPath,\n\t\t\t\t\t{ ref: ref },\n\t\t\t\t);\n\t\t\t\tif (commit != null) {\n\t\t\t\t\tif (ref2 != null) {\n\t\t\t\t\t\tref2 = ref;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tref1 = ref;\n\t\t\t\t\t\tref2 = '';\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tlocalChanges = false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst status = await Container.git.getStatusForFile(\n\t\t\t\t\tthis.trackedDocument.uri.repoPath!,\n\t\t\t\t\tthis.trackedDocument.uri.fsPath,\n\t\t\t\t);\n\t\t\t\tconst commits = status?.toPsuedoCommits(\n\t\t\t\t\tawait Container.git.getCurrentUser(this.trackedDocument.uri.repoPath!),\n\t\t\t\t);\n\t\t\t\tif (commits?.length) {\n\t\t\t\t\tcommit = await Container.git.getCommitForFile(\n\t\t\t\t\t\tthis.trackedDocument.uri.repoPath,\n\t\t\t\t\t\tthis.trackedDocument.uri.fsPath,\n\t\t\t\t\t);\n\t\t\t\t\tref1 = 'HEAD';\n\t\t\t\t} else if (this.trackedDocument.dirty) {\n\t\t\t\t\tref1 = 'HEAD';\n\t\t\t\t} else {\n\t\t\t\t\tlocalChanges = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!localChanges) {\n\t\t\tcommit = await Container.git.getCommitForFile(\n\t\t\t\tthis.trackedDocument.uri.repoPath,\n\t\t\t\tthis.trackedDocument.uri.fsPath,\n\t\t\t\t{\n\t\t\t\t\tref: ref2 ?? ref1,\n\t\t\t\t},\n\t\t\t);\n\t\t\tif (commit == null) return false;\n\n\t\t\tif (ref2 != null) {\n\t\t\t\tref2 = commit.ref;\n\t\t\t} else {\n\t\t\t\tref1 = `${commit.ref}^`;\n\t\t\t\tref2 = commit.ref;\n\t\t\t}\n\t\t}\n\n\t\tconst diffs = (\n\t\t\tawait Promise.all(\n\t\t\t\tref2 == null && this.editor.document.isDirty\n\t\t\t\t\t? [\n\t\t\t\t\t\t\tContainer.git.getDiffForFileContents(\n\t\t\t\t\t\t\t\tthis.trackedDocument.uri,\n\t\t\t\t\t\t\t\tref1!,\n\t\t\t\t\t\t\t\tthis.editor.document.getText(),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tContainer.git.getDiffForFile(this.trackedDocument.uri, ref1, ref2),\n\t\t\t\t\t  ]\n\t\t\t\t\t: [Container.git.getDiffForFile(this.trackedDocument.uri, ref1, ref2)],\n\t\t\t)\n\t\t).filter(<T>(d?: T): d is T => Boolean(d));\n\t\tif (!diffs?.length) return false;\n\n\t\tlet start = process.hrtime();\n\n\t\tconst decorationsMap = new Map<\n\t\t\tstring,\n\t\t\t{ decorationType: TextEditorDecorationType; rangesOrOptions: DecorationOptions[] }\n\t\t>();\n\n\t\t// If we want to only show changes from the specified sha, get the blame so we can compare with \"visible\" shas\n\t\tconst blame =\n\t\t\tcontext?.sha != null && context?.only\n\t\t\t\t? this.editor?.document.isDirty\n\t\t\t\t\t? await Container.git.getBlameForFileContents(\n\t\t\t\t\t\t\tthis.trackedDocument.uri,\n\t\t\t\t\t\t\tthis.editor.document.getText(),\n\t\t\t\t\t  )\n\t\t\t\t\t: await Container.git.getBlameForFile(this.trackedDocument.uri)\n\t\t\t\t: undefined;\n\n\t\tlet selection: Selection | undefined;\n\n\t\tfor (const diff of diffs) {\n\t\t\tfor (const hunk of diff.hunks) {\n\t\t\t\t// Only show \"visible\" hunks\n\t\t\t\tif (blame != null) {\n\t\t\t\t\tlet skip = true;\n\n\t\t\t\t\tconst sha = context!.sha;\n\t\t\t\t\tfor (let i = hunk.current.position.start - 1; i < hunk.current.position.end; i++) {\n\t\t\t\t\t\tif (blame.lines[i].sha === sha) {\n\t\t\t\t\t\t\tskip = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (skip) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Subtract 2 because editor lines are 0-based and we will be adding 1 in the first iteration of the loop\n\t\t\t\tlet count = Math.max(hunk.current.position.start - 2, -1);\n\t\t\t\tlet index = -1;\n\t\t\t\tfor (const hunkLine of hunk.lines) {\n\t\t\t\t\tindex++;\n\t\t\t\t\tcount++;\n\n\t\t\t\t\tif (hunkLine.current?.state === 'unchanged') continue;\n\n\t\t\t\t\t// Uncomment this if we want to only show \"visible\" lines, rather than just visible hunks\n\t\t\t\t\t// if (blame != null && blame.lines[count].sha !== context!.sha) {\n\t\t\t\t\t// \tcontinue;\n\t\t\t\t\t// }\n\n\t\t\t\t\tconst range = this.editor.document.validateRange(\n\t\t\t\t\t\tnew Range(new Position(count, 0), new Position(count, Number.MAX_SAFE_INTEGER)),\n\t\t\t\t\t);\n\t\t\t\t\tif (selection == null) {\n\t\t\t\t\t\tselection = new Selection(range.start, range.end);\n\t\t\t\t\t}\n\n\t\t\t\t\tlet state;\n\t\t\t\t\tif (hunkLine.current == null) {\n\t\t\t\t\t\tconst previous = hunk.lines[index - 1];\n\t\t\t\t\t\tif (hunkLine.previous != null && (previous == null || previous.current != null)) {\n\t\t\t\t\t\t\t// Check if there are more deleted lines than added lines show a deleted indicator\n\t\t\t\t\t\t\tif (hunk.previous.count > hunk.current.count) {\n\t\t\t\t\t\t\t\tstate = 'removed';\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (hunkLine.current?.state === 'added') {\n\t\t\t\t\t\tif (hunkLine.previous?.state === 'removed') {\n\t\t\t\t\t\t\tstate = 'changed';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstate = 'added';\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (hunkLine?.current.state === 'removed') {\n\t\t\t\t\t\t// Check if there are more deleted lines than added lines show a deleted indicator\n\t\t\t\t\t\tif (hunk.previous.count > hunk.current.count) {\n\t\t\t\t\t\t\tstate = 'removed';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstate = 'changed';\n\t\t\t\t\t}\n\n\t\t\t\t\tlet decoration = decorationsMap.get(state);\n\t\t\t\t\tif (decoration == null) {\n\t\t\t\t\t\tdecoration = {\n\t\t\t\t\t\t\tdecorationType: (state === 'added'\n\t\t\t\t\t\t\t\t? Decorations.changesLineAddedAnnotation\n\t\t\t\t\t\t\t\t: state === 'removed'\n\t\t\t\t\t\t\t\t? Decorations.changesLineDeletedAnnotation\n\t\t\t\t\t\t\t\t: Decorations.changesLineChangedAnnotation)!,\n\t\t\t\t\t\t\trangesOrOptions: [{ range: range }],\n\t\t\t\t\t\t};\n\t\t\t\t\t\tdecorationsMap.set(state, decoration);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdecoration.rangesOrOptions.push({ range: range });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tLogger.log(cc, `${Strings.getDurationMilliseconds(start)} ms to compute recent changes annotations`);\n\n\t\tif (decorationsMap.size) {\n\t\t\tstart = process.hrtime();\n\n\t\t\tthis.setDecorations([...decorationsMap.values()]);\n\n\t\t\tLogger.log(cc, `${Strings.getDurationMilliseconds(start)} ms to apply recent changes annotations`);\n\n\t\t\tif (selection != null && context?.selection !== false) {\n\t\t\t\tthis.editor.selection = selection;\n\t\t\t\tthis.editor.revealRange(selection, TextEditorRevealType.InCenterIfOutsideViewport);\n\t\t\t}\n\t\t}\n\n\t\tthis.state = { commit: commit, diffs: diffs };\n\t\tthis.registerHoverProvider();\n\t\treturn true;\n\t}\n\n\tregisterHoverProvider() {\n\t\tif (!Container.config.hovers.enabled || !Container.config.hovers.annotations.enabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.hoverProviderDisposable = languages.registerHoverProvider(\n\t\t\t{ pattern: this.document.uri.fsPath },\n\t\t\t{\n\t\t\t\tprovideHover: (document: TextDocument, position: Position, token: CancellationToken) =>\n\t\t\t\t\tthis.provideHover(document, position, token),\n\t\t\t},\n\t\t);\n\t}\n\n\tprovideHover(document: TextDocument, position: Position, _token: CancellationToken): Hover | undefined {\n\t\tif (this.state == null) return undefined;\n\t\tif (Container.config.hovers.annotations.over !== 'line' && position.character !== 0) return undefined;\n\n\t\tconst { commit, diffs } = this.state;\n\n\t\tfor (const diff of diffs) {\n\t\t\tfor (const hunk of diff.hunks) {\n\t\t\t\t// If we have a \"mixed\" diff hunk, check if we have more deleted lines than added, to include a trailing line for the deleted indicator\n\t\t\t\tconst hasMoreDeletedLines = hunk.state === 'changed' && hunk.previous.count > hunk.current.count;\n\t\t\t\tif (\n\t\t\t\t\tposition.line >= hunk.current.position.start - 1 &&\n\t\t\t\t\tposition.line <= hunk.current.position.end - (hasMoreDeletedLines ? 0 : 1)\n\t\t\t\t) {\n\t\t\t\t\treturn new Hover(\n\t\t\t\t\t\tHovers.localChangesMessage(commit, this.trackedDocument.uri, position.line, hunk),\n\t\t\t\t\t\tdocument.validateRange(\n\t\t\t\t\t\t\tnew Range(\n\t\t\t\t\t\t\t\thunk.current.position.start - 1,\n\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\thunk.current.position.end - (hasMoreDeletedLines ? 0 : 1),\n\t\t\t\t\t\t\t\tNumber.MAX_SAFE_INTEGER,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n","'use strict';\nimport { Range, TextEditor, TextEditorDecorationType } from 'vscode';\nimport { FileAnnotationType } from '../configuration';\nimport { GitBlameCommit } from '../git/git';\nimport { Logger } from '../logger';\nimport { log, Strings } from '../system';\nimport { GitDocumentState } from '../trackers/gitDocumentTracker';\nimport { TrackedDocument } from '../trackers/trackedDocument';\nimport { AnnotationContext } from './annotationProvider';\nimport { Annotations } from './annotations';\nimport { BlameAnnotationProviderBase } from './blameAnnotationProvider';\n\nexport class GutterHeatmapBlameAnnotationProvider extends BlameAnnotationProviderBase {\n\tconstructor(editor: TextEditor, trackedDocument: TrackedDocument<GitDocumentState>) {\n\t\tsuper(FileAnnotationType.Heatmap, editor, trackedDocument);\n\t}\n\n\t@log()\n\tasync onProvideAnnotation(context?: AnnotationContext, _type?: FileAnnotationType): Promise<boolean> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tthis.annotationContext = context;\n\n\t\tconst blame = await this.getBlame();\n\t\tif (blame == null) return false;\n\n\t\tlet start = process.hrtime();\n\n\t\tconst decorationsMap = new Map<\n\t\t\tstring,\n\t\t\t{ decorationType: TextEditorDecorationType; rangesOrOptions: Range[] }\n\t\t>();\n\t\tconst computedHeatmap = await this.getComputedHeatmap(blame);\n\n\t\tlet commit: GitBlameCommit | undefined;\n\t\tfor (const l of blame.lines) {\n\t\t\t// editor lines are 0-based\n\t\t\tconst editorLine = l.line - 1;\n\n\t\t\tcommit = blame.commits.get(l.sha);\n\t\t\tif (commit == null) continue;\n\n\t\t\tAnnotations.addOrUpdateGutterHeatmapDecoration(\n\t\t\t\tcommit.date,\n\t\t\t\tcomputedHeatmap,\n\t\t\t\tnew Range(editorLine, 0, editorLine, 0),\n\t\t\t\tdecorationsMap,\n\t\t\t);\n\t\t}\n\n\t\tLogger.log(cc, `${Strings.getDurationMilliseconds(start)} ms to compute heatmap annotations`);\n\n\t\tif (decorationsMap.size) {\n\t\t\tstart = process.hrtime();\n\n\t\t\tthis.setDecorations([...decorationsMap.values()]);\n\n\t\t\tLogger.log(cc, `${Strings.getDurationMilliseconds(start)} ms to apply recent changes annotations`);\n\t\t}\n\n\t\t// this.registerHoverProviders(Container.config.hovers.annotations);\n\t\treturn true;\n\t}\n\n\tselection(_selection?: AnnotationContext['selection']): Promise<void> {\n\t\treturn Promise.resolve();\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport {\n\tConfigurationChangeEvent,\n\tDecorationRangeBehavior,\n\tDisposable,\n\tEvent,\n\tEventEmitter,\n\tOverviewRulerLane,\n\tProgress,\n\tProgressLocation,\n\tTextDocument,\n\tTextEditor,\n\tTextEditorDecorationType,\n\tTextEditorViewColumnChangeEvent,\n\tThemeColor,\n\tUri,\n\twindow,\n\tworkspace,\n} from 'vscode';\nimport {\n\tAnnotationsToggleMode,\n\tBlameHighlightLocations,\n\tChangesLocations,\n\tconfiguration,\n\tFileAnnotationType,\n} from '../configuration';\nimport { Colors, ContextKeys, isTextEditor, setContext } from '../constants';\nimport { Container } from '../container';\nimport { KeyboardScope } from '../keyboard';\nimport { Logger } from '../logger';\nimport { Functions, Iterables } from '../system';\nimport {\n\tDocumentBlameStateChangeEvent,\n\tDocumentDirtyStateChangeEvent,\n\tGitDocumentState,\n} from '../trackers/gitDocumentTracker';\nimport {\n\tAnnotationContext,\n\tAnnotationProviderBase,\n\tAnnotationStatus,\n\tTextEditorCorrelationKey,\n} from './annotationProvider';\nimport { GutterBlameAnnotationProvider } from './gutterBlameAnnotationProvider';\nimport { ChangesAnnotationContext, GutterChangesAnnotationProvider } from './gutterChangesAnnotationProvider';\nimport { GutterHeatmapBlameAnnotationProvider } from './gutterHeatmapBlameAnnotationProvider';\n\nexport enum AnnotationClearReason {\n\tUser = 'User',\n\tBlameabilityChanged = 'BlameabilityChanged',\n\tColumnChanged = 'ColumnChanged',\n\tDisposing = 'Disposing',\n\tDocumentChanged = 'DocumentChanged',\n\tDocumentClosed = 'DocumentClosed',\n}\n\nexport const Decorations = {\n\tgutterBlameAnnotation: window.createTextEditorDecorationType({\n\t\trangeBehavior: DecorationRangeBehavior.ClosedOpen,\n\t\ttextDecoration: 'none',\n\t}),\n\tgutterBlameHighlight: undefined as TextEditorDecorationType | undefined,\n\tchangesLineChangedAnnotation: undefined as TextEditorDecorationType | undefined,\n\tchangesLineAddedAnnotation: undefined as TextEditorDecorationType | undefined,\n\tchangesLineDeletedAnnotation: undefined as TextEditorDecorationType | undefined,\n};\n\nexport class FileAnnotationController implements Disposable {\n\tprivate _onDidToggleAnnotations = new EventEmitter<void>();\n\tget onDidToggleAnnotations(): Event<void> {\n\t\treturn this._onDidToggleAnnotations.event;\n\t}\n\n\tprivate _annotationsDisposable: Disposable | undefined;\n\tprivate _annotationProviders = new Map<TextEditorCorrelationKey, AnnotationProviderBase>();\n\tprivate _disposable: Disposable;\n\tprivate _editor: TextEditor | undefined;\n\tprivate _keyboardScope: KeyboardScope | undefined = undefined;\n\tprivate readonly _toggleModes: Map<FileAnnotationType, AnnotationsToggleMode>;\n\tprivate _windowAnnotationType?: FileAnnotationType | undefined = undefined;\n\n\tconstructor() {\n\t\tthis._disposable = Disposable.from(configuration.onDidChange(this.onConfigurationChanged, this));\n\n\t\tthis._toggleModes = new Map<FileAnnotationType, AnnotationsToggleMode>();\n\t\tthis.onConfigurationChanged();\n\t}\n\n\tdispose() {\n\t\tvoid this.clearAll();\n\n\t\tDecorations.gutterBlameAnnotation?.dispose();\n\t\tDecorations.gutterBlameHighlight?.dispose();\n\t\tDecorations.changesLineChangedAnnotation?.dispose();\n\t\tDecorations.changesLineAddedAnnotation?.dispose();\n\t\tDecorations.changesLineDeletedAnnotation?.dispose();\n\n\t\tthis._annotationsDisposable?.dispose();\n\t\tthis._disposable?.dispose();\n\t}\n\n\tprivate onConfigurationChanged(e?: ConfigurationChangeEvent) {\n\t\tconst cfg = Container.config;\n\n\t\tif (configuration.changed(e, 'blame.highlight')) {\n\t\t\tDecorations.gutterBlameHighlight?.dispose();\n\t\t\tDecorations.gutterBlameHighlight = undefined;\n\n\t\t\tconst highlight = cfg.blame.highlight;\n\n\t\t\tif (highlight.enabled) {\n\t\t\t\tconst { locations } = highlight;\n\n\t\t\t\t// TODO@eamodio: Read from the theme color when the API exists\n\t\t\t\tconst gutterHighlightColor = '#00bcf2'; // new ThemeColor(Colors.LineHighlightOverviewRulerColor)\n\t\t\t\tconst gutterHighlightUri = locations.includes(BlameHighlightLocations.Gutter)\n\t\t\t\t\t? Uri.parse(\n\t\t\t\t\t\t\t`data:image/svg+xml,${encodeURIComponent(\n\t\t\t\t\t\t\t\t`<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 18 18'><rect fill='${gutterHighlightColor}' fill-opacity='0.6' x='7' y='0' width='3' height='18'/></svg>`,\n\t\t\t\t\t\t\t)}`,\n\t\t\t\t\t  )\n\t\t\t\t\t: undefined;\n\n\t\t\t\tDecorations.gutterBlameHighlight = window.createTextEditorDecorationType({\n\t\t\t\t\tgutterIconPath: gutterHighlightUri,\n\t\t\t\t\tgutterIconSize: 'contain',\n\t\t\t\t\tisWholeLine: true,\n\t\t\t\t\toverviewRulerLane: OverviewRulerLane.Right,\n\t\t\t\t\tbackgroundColor: locations.includes(BlameHighlightLocations.Line)\n\t\t\t\t\t\t? new ThemeColor(Colors.LineHighlightBackgroundColor)\n\t\t\t\t\t\t: undefined,\n\t\t\t\t\toverviewRulerColor: locations.includes(BlameHighlightLocations.Overview)\n\t\t\t\t\t\t? new ThemeColor(Colors.LineHighlightOverviewRulerColor)\n\t\t\t\t\t\t: undefined,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (configuration.changed(e, 'changes.locations')) {\n\t\t\tDecorations.changesLineAddedAnnotation?.dispose();\n\t\t\tDecorations.changesLineChangedAnnotation?.dispose();\n\t\t\tDecorations.changesLineDeletedAnnotation?.dispose();\n\n\t\t\tconst { locations } = cfg.changes;\n\n\t\t\tDecorations.changesLineAddedAnnotation = window.createTextEditorDecorationType({\n\t\t\t\tgutterIconPath: locations.includes(ChangesLocations.Gutter)\n\t\t\t\t\t? Uri.parse(\n\t\t\t\t\t\t\t`data:image/svg+xml,${encodeURIComponent(\n\t\t\t\t\t\t\t\t\"<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 18 18'><rect fill='#587c0c' x='13' y='0' width='3' height='18'/></svg>\",\n\t\t\t\t\t\t\t)}`,\n\t\t\t\t\t  )\n\t\t\t\t\t: undefined,\n\t\t\t\tgutterIconSize: 'contain',\n\t\t\t\toverviewRulerLane: OverviewRulerLane.Left,\n\t\t\t\toverviewRulerColor: locations.includes(ChangesLocations.Overview)\n\t\t\t\t\t? new ThemeColor('editorOverviewRuler.addedForeground')\n\t\t\t\t\t: undefined,\n\t\t\t});\n\n\t\t\tDecorations.changesLineChangedAnnotation = window.createTextEditorDecorationType({\n\t\t\t\tgutterIconPath: locations.includes(ChangesLocations.Gutter)\n\t\t\t\t\t? Uri.parse(\n\t\t\t\t\t\t\t`data:image/svg+xml,${encodeURIComponent(\n\t\t\t\t\t\t\t\t\"<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 18 18'><rect fill='#0c7d9d' x='13' y='0' width='3' height='18'/></svg>\",\n\t\t\t\t\t\t\t)}`,\n\t\t\t\t\t  )\n\t\t\t\t\t: undefined,\n\t\t\t\tgutterIconSize: 'contain',\n\t\t\t\toverviewRulerLane: OverviewRulerLane.Left,\n\t\t\t\toverviewRulerColor: locations.includes(ChangesLocations.Overview)\n\t\t\t\t\t? new ThemeColor('editorOverviewRuler.modifiedForeground')\n\t\t\t\t\t: undefined,\n\t\t\t});\n\n\t\t\tDecorations.changesLineDeletedAnnotation = window.createTextEditorDecorationType({\n\t\t\t\tgutterIconPath: locations.includes(ChangesLocations.Gutter)\n\t\t\t\t\t? Uri.parse(\n\t\t\t\t\t\t\t`data:image/svg+xml,${encodeURIComponent(\n\t\t\t\t\t\t\t\t\"<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 18 18'><polygon fill='#94151b' points='13,10 13,18 17,14'/></svg>\",\n\t\t\t\t\t\t\t)}`,\n\t\t\t\t\t  )\n\t\t\t\t\t: undefined,\n\t\t\t\tgutterIconSize: 'contain',\n\t\t\t\toverviewRulerLane: OverviewRulerLane.Left,\n\t\t\t\toverviewRulerColor: locations.includes(ChangesLocations.Overview)\n\t\t\t\t\t? new ThemeColor('editorOverviewRuler.deletedForeground')\n\t\t\t\t\t: undefined,\n\t\t\t});\n\t\t}\n\n\t\tconst initializing = e == null;\n\n\t\tif (configuration.changed(e, 'blame.toggleMode')) {\n\t\t\tthis._toggleModes.set(FileAnnotationType.Blame, cfg.blame.toggleMode);\n\t\t\tif (!initializing && cfg.blame.toggleMode === AnnotationsToggleMode.File) {\n\t\t\t\tvoid this.clearAll();\n\t\t\t}\n\t\t}\n\n\t\tif (configuration.changed(e, 'changes.toggleMode')) {\n\t\t\tthis._toggleModes.set(FileAnnotationType.Changes, cfg.changes.toggleMode);\n\t\t\tif (!initializing && cfg.changes.toggleMode === AnnotationsToggleMode.File) {\n\t\t\t\tvoid this.clearAll();\n\t\t\t}\n\t\t}\n\n\t\tif (configuration.changed(e, 'heatmap.toggleMode')) {\n\t\t\tthis._toggleModes.set(FileAnnotationType.Heatmap, cfg.heatmap.toggleMode);\n\t\t\tif (!initializing && cfg.heatmap.toggleMode === AnnotationsToggleMode.File) {\n\t\t\t\tvoid this.clearAll();\n\t\t\t}\n\t\t}\n\n\t\tif (initializing) return;\n\n\t\tif (\n\t\t\tconfiguration.changed(e, 'blame') ||\n\t\t\tconfiguration.changed(e, 'changes') ||\n\t\t\tconfiguration.changed(e, 'heatmap') ||\n\t\t\tconfiguration.changed(e, 'hovers') ||\n\t\t\tconfiguration.changed(e, 'defaultDateFormat') ||\n\t\t\tconfiguration.changed(e, 'defaultDateSource') ||\n\t\t\tconfiguration.changed(e, 'defaultDateStyle') ||\n\t\t\tconfiguration.changed(e, 'defaultGravatarsStyle')\n\t\t) {\n\t\t\t// Since the configuration has changed -- reset any visible annotations\n\t\t\tfor (const provider of this._annotationProviders.values()) {\n\t\t\t\tif (provider == null) continue;\n\n\t\t\t\tvoid this.show(provider.editor, provider.annotationType ?? FileAnnotationType.Blame);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async onActiveTextEditorChanged(editor: TextEditor | undefined) {\n\t\tif (editor != null && !isTextEditor(editor)) return;\n\n\t\tthis._editor = editor;\n\t\t// Logger.log('AnnotationController.onActiveTextEditorChanged', editor && editor.document.uri.fsPath);\n\n\t\tif (this.isInWindowToggle()) {\n\t\t\tawait this.show(editor, this._windowAnnotationType!);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = this.getProvider(editor);\n\t\tif (provider == null) {\n\t\t\tvoid setContext(ContextKeys.AnnotationStatus, undefined);\n\t\t\tvoid this.detachKeyboardHook();\n\t\t} else {\n\t\t\tvoid setContext(ContextKeys.AnnotationStatus, provider.status);\n\t\t\tvoid this.attachKeyboardHook();\n\t\t}\n\t}\n\n\tprivate onBlameStateChanged(e: DocumentBlameStateChangeEvent<GitDocumentState>) {\n\t\t// Only care if we are becoming un-blameable\n\t\tif (e.blameable) return;\n\n\t\tconst editor = window.activeTextEditor;\n\t\tif (editor == null) return;\n\n\t\tvoid this.clear(editor, AnnotationClearReason.BlameabilityChanged);\n\t}\n\n\tprivate onDirtyStateChanged(e: DocumentDirtyStateChangeEvent<GitDocumentState>) {\n\t\tfor (const [key, p] of this._annotationProviders) {\n\t\t\tif (!e.document.is(p.document)) continue;\n\n\t\t\tvoid this.clearCore(key, AnnotationClearReason.DocumentChanged);\n\t\t}\n\t}\n\n\tprivate onTextDocumentClosed(document: TextDocument) {\n\t\tif (!Container.git.isTrackable(document.uri)) return;\n\n\t\tfor (const [key, p] of this._annotationProviders) {\n\t\t\tif (p.document !== document) continue;\n\n\t\t\tvoid this.clearCore(key, AnnotationClearReason.DocumentClosed);\n\t\t}\n\t}\n\n\tprivate onTextEditorViewColumnChanged(e: TextEditorViewColumnChangeEvent) {\n\t\t// FYI https://github.com/Microsoft/vscode/issues/35602\n\t\tconst provider = this.getProvider(e.textEditor);\n\t\tif (provider == null) {\n\t\t\t// If we don't find an exact match, do a fuzzy match (since we can't properly track editors)\n\t\t\tconst fuzzyProvider = Iterables.find(\n\t\t\t\tthis._annotationProviders.values(),\n\t\t\t\tp => p.editor.document === e.textEditor.document,\n\t\t\t);\n\t\t\tif (fuzzyProvider == null) return;\n\n\t\t\tvoid this.clearCore(fuzzyProvider.correlationKey, AnnotationClearReason.ColumnChanged);\n\n\t\t\treturn;\n\t\t}\n\n\t\tvoid provider.restore(e.textEditor);\n\t}\n\n\tprivate onVisibleTextEditorsChanged(editors: TextEditor[]) {\n\t\tlet provider: AnnotationProviderBase | undefined;\n\t\tfor (const e of editors) {\n\t\t\tprovider = this.getProvider(e);\n\t\t\tif (provider == null) continue;\n\n\t\t\tvoid provider.restore(e);\n\t\t}\n\t}\n\tisInWindowToggle(): boolean {\n\t\treturn this.getToggleMode(this._windowAnnotationType) === AnnotationsToggleMode.Window;\n\t}\n\n\tprivate getToggleMode(annotationType: FileAnnotationType | undefined): AnnotationsToggleMode {\n\t\tif (annotationType == null) return AnnotationsToggleMode.File;\n\n\t\treturn this._toggleModes.get(annotationType) ?? AnnotationsToggleMode.File;\n\t}\n\n\tclear(editor: TextEditor, reason: AnnotationClearReason = AnnotationClearReason.User) {\n\t\tif (this.isInWindowToggle()) {\n\t\t\treturn this.clearAll();\n\t\t}\n\n\t\treturn this.clearCore(AnnotationProviderBase.getCorrelationKey(editor), reason);\n\t}\n\n\tasync clearAll() {\n\t\tthis._windowAnnotationType = undefined;\n\t\tfor (const [key] of this._annotationProviders) {\n\t\t\tawait this.clearCore(key, AnnotationClearReason.Disposing);\n\t\t}\n\t}\n\n\tasync getAnnotationType(editor: TextEditor | undefined): Promise<FileAnnotationType | undefined> {\n\t\tconst provider = this.getProvider(editor);\n\t\tif (provider == null) return undefined;\n\n\t\tconst trackedDocument = await Container.tracker.get(editor!.document);\n\t\tif (trackedDocument == null || !trackedDocument.isBlameable) return undefined;\n\n\t\treturn provider.annotationType;\n\t}\n\n\tgetProvider(editor: TextEditor | undefined): AnnotationProviderBase | undefined {\n\t\tif (editor == null || editor.document == null) return undefined;\n\t\treturn this._annotationProviders.get(AnnotationProviderBase.getCorrelationKey(editor));\n\t}\n\n\tasync show(editor: TextEditor | undefined, type: FileAnnotationType, context?: AnnotationContext): Promise<boolean>;\n\tasync show(\n\t\teditor: TextEditor | undefined,\n\t\ttype: FileAnnotationType.Changes,\n\t\tcontext?: ChangesAnnotationContext,\n\t): Promise<boolean>;\n\tasync show(\n\t\teditor: TextEditor | undefined,\n\t\ttype: FileAnnotationType,\n\t\tcontext?: AnnotationContext | ChangesAnnotationContext,\n\t): Promise<boolean> {\n\t\tif (this.getToggleMode(type) === AnnotationsToggleMode.Window) {\n\t\t\tlet first = this._windowAnnotationType == null;\n\t\t\tconst reset = !first && this._windowAnnotationType !== type;\n\n\t\t\tthis._windowAnnotationType = type;\n\n\t\t\tif (reset) {\n\t\t\t\tawait this.clearAll();\n\t\t\t\tfirst = true;\n\t\t\t}\n\n\t\t\tif (first) {\n\t\t\t\tfor (const e of window.visibleTextEditors) {\n\t\t\t\t\tif (e === editor) continue;\n\n\t\t\t\t\tvoid this.show(e, type);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (editor == null) return false; // || editor.viewColumn == null) return false;\n\t\tthis._editor = editor;\n\n\t\tconst trackedDocument = await Container.tracker.getOrAdd(editor.document);\n\t\tif (!trackedDocument.isBlameable) return false;\n\n\t\tconst currentProvider = this.getProvider(editor);\n\t\tif (currentProvider?.annotationType === type) {\n\t\t\tawait currentProvider.provideAnnotation(context);\n\t\t\tawait currentProvider.selection(context?.selection);\n\t\t\treturn true;\n\t\t}\n\n\t\tconst provider = await window.withProgress(\n\t\t\t{ location: ProgressLocation.Window },\n\t\t\tasync (progress: Progress<{ message: string }>) => {\n\t\t\t\tawait setContext(ContextKeys.AnnotationStatus, AnnotationStatus.Computing);\n\n\t\t\t\tconst computingAnnotations = this.showAnnotationsCore(currentProvider, editor, type, context, progress);\n\t\t\t\tconst provider = await computingAnnotations;\n\n\t\t\t\tif (editor === this._editor) {\n\t\t\t\t\tawait setContext(ContextKeys.AnnotationStatus, provider?.status);\n\t\t\t\t}\n\n\t\t\t\treturn computingAnnotations;\n\t\t\t},\n\t\t);\n\n\t\treturn provider != null;\n\t}\n\n\tasync toggle(\n\t\teditor: TextEditor | undefined,\n\t\ttype: FileAnnotationType,\n\t\tcontext?: AnnotationContext,\n\t\ton?: boolean,\n\t): Promise<boolean>;\n\tasync toggle(\n\t\teditor: TextEditor | undefined,\n\t\ttype: FileAnnotationType.Changes,\n\t\tcontext?: ChangesAnnotationContext,\n\t\ton?: boolean,\n\t): Promise<boolean>;\n\tasync toggle(\n\t\teditor: TextEditor | undefined,\n\t\ttype: FileAnnotationType,\n\t\tcontext?: AnnotationContext | ChangesAnnotationContext,\n\t\ton?: boolean,\n\t): Promise<boolean> {\n\t\tif (editor != null) {\n\t\t\tconst trackedDocument = await Container.tracker.getOrAdd(editor.document);\n\t\t\tif ((type === FileAnnotationType.Changes && !trackedDocument.isTracked) || !trackedDocument.isBlameable) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tconst provider = this.getProvider(editor);\n\t\tif (provider == null) return this.show(editor, type, context);\n\n\t\tconst reopen = provider.annotationType !== type || provider.mustReopen(context);\n\t\tif (on === true && !reopen) return true;\n\n\t\tif (this.isInWindowToggle()) {\n\t\t\tawait this.clearAll();\n\t\t} else {\n\t\t\tawait this.clearCore(provider.correlationKey, AnnotationClearReason.User);\n\t\t}\n\n\t\tif (!reopen) return false;\n\n\t\treturn this.show(editor, type, context);\n\t}\n\n\tprivate async attachKeyboardHook() {\n\t\t// Allows pressing escape to exit the annotations\n\t\tif (this._keyboardScope == null) {\n\t\t\tthis._keyboardScope = await Container.keyboard.beginScope({\n\t\t\t\tescape: {\n\t\t\t\t\tonDidPressKey: async () => {\n\t\t\t\t\t\tconst e = this._editor;\n\t\t\t\t\t\tif (e == null) return undefined;\n\n\t\t\t\t\t\tawait this.clear(e, AnnotationClearReason.User);\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate async clearCore(key: TextEditorCorrelationKey, reason: AnnotationClearReason) {\n\t\tconst provider = this._annotationProviders.get(key);\n\t\tif (provider == null) return;\n\n\t\tLogger.log(`${reason}:`, `Clear annotations for ${key}`);\n\n\t\tthis._annotationProviders.delete(key);\n\t\tprovider.dispose();\n\n\t\tif (this._annotationProviders.size === 0 || key === AnnotationProviderBase.getCorrelationKey(this._editor)) {\n\t\t\tawait setContext(ContextKeys.AnnotationStatus, undefined);\n\t\t\tawait this.detachKeyboardHook();\n\t\t}\n\n\t\tif (this._annotationProviders.size === 0) {\n\t\t\tLogger.log('Remove all listener registrations for annotations');\n\n\t\t\tthis._annotationsDisposable?.dispose();\n\t\t\tthis._annotationsDisposable = undefined;\n\t\t}\n\n\t\tthis._onDidToggleAnnotations.fire();\n\t}\n\n\tprivate async detachKeyboardHook() {\n\t\tif (this._keyboardScope == null) return;\n\n\t\tawait this._keyboardScope.dispose();\n\t\tthis._keyboardScope = undefined;\n\t}\n\n\tprivate async showAnnotationsCore(\n\t\tcurrentProvider: AnnotationProviderBase | undefined,\n\t\teditor: TextEditor,\n\t\ttype: FileAnnotationType,\n\t\tcontext?: AnnotationContext | ChangesAnnotationContext,\n\t\tprogress?: Progress<{ message: string }>,\n\t): Promise<AnnotationProviderBase | undefined> {\n\t\tif (progress != null) {\n\t\t\tlet annotationsLabel = 'annotations';\n\t\t\tswitch (type) {\n\t\t\t\tcase FileAnnotationType.Blame:\n\t\t\t\t\tannotationsLabel = 'blame annotations';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase FileAnnotationType.Changes:\n\t\t\t\t\tannotationsLabel = 'changes annotations';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase FileAnnotationType.Heatmap:\n\t\t\t\t\tannotationsLabel = 'heatmap annotations';\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tprogress.report({\n\t\t\t\tmessage: `Computing ${annotationsLabel} for ${paths.basename(editor.document.fileName)}`,\n\t\t\t});\n\t\t}\n\n\t\t// Allows pressing escape to exit the annotations\n\t\tawait this.attachKeyboardHook();\n\n\t\tconst trackedDocument = await Container.tracker.getOrAdd(editor.document);\n\n\t\tlet provider: AnnotationProviderBase | undefined = undefined;\n\t\tswitch (type) {\n\t\t\tcase FileAnnotationType.Blame:\n\t\t\t\tprovider = new GutterBlameAnnotationProvider(editor, trackedDocument);\n\t\t\t\tbreak;\n\n\t\t\tcase FileAnnotationType.Changes:\n\t\t\t\tprovider = new GutterChangesAnnotationProvider(editor, trackedDocument);\n\t\t\t\tbreak;\n\n\t\t\tcase FileAnnotationType.Heatmap:\n\t\t\t\tprovider = new GutterHeatmapBlameAnnotationProvider(editor, trackedDocument);\n\t\t\t\tbreak;\n\t\t}\n\t\tif (provider == null || !(await provider.validate())) return undefined;\n\n\t\tif (currentProvider != null) {\n\t\t\tawait this.clearCore(currentProvider.correlationKey, AnnotationClearReason.User);\n\t\t}\n\n\t\tif (this._annotationsDisposable == null && this._annotationProviders.size === 0) {\n\t\t\tLogger.log('Add listener registrations for annotations');\n\n\t\t\tthis._annotationsDisposable = Disposable.from(\n\t\t\t\twindow.onDidChangeActiveTextEditor(Functions.debounce(this.onActiveTextEditorChanged, 50), this),\n\t\t\t\twindow.onDidChangeTextEditorViewColumn(this.onTextEditorViewColumnChanged, this),\n\t\t\t\twindow.onDidChangeVisibleTextEditors(Functions.debounce(this.onVisibleTextEditorsChanged, 50), this),\n\t\t\t\tworkspace.onDidCloseTextDocument(this.onTextDocumentClosed, this),\n\t\t\t\tContainer.tracker.onDidChangeBlameState(this.onBlameStateChanged, this),\n\t\t\t\tContainer.tracker.onDidChangeDirtyState(this.onDirtyStateChanged, this),\n\t\t\t);\n\t\t}\n\n\t\tthis._annotationProviders.set(provider.correlationKey, provider);\n\t\tif (await provider.provideAnnotation(context)) {\n\t\t\tthis._onDidToggleAnnotations.fire();\n\t\t\treturn provider;\n\t\t}\n\n\t\tawait this.clearCore(provider.correlationKey, AnnotationClearReason.Disposing);\n\n\t\treturn undefined;\n\t}\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tCancellationTokenSource,\n\tConfigurationChangeEvent,\n\tDecorationOptions,\n\tDecorationRangeBehavior,\n\tDisposable,\n\tRange,\n\tTextEditor,\n\tTextEditorDecorationType,\n\twindow,\n} from 'vscode';\nimport { configuration } from '../configuration';\nimport { GlyphChars, isTextEditor } from '../constants';\nimport { Container } from '../container';\nimport { Authentication, CommitFormatter, GitBlameCommit, PullRequest } from '../git/git';\nimport { LogCorrelationContext, Logger } from '../logger';\nimport { debug, Iterables, log, Promises } from '../system';\nimport { LinesChangeEvent, LineSelection } from '../trackers/gitLineTracker';\nimport { Annotations } from './annotations';\n\nconst annotationDecoration: TextEditorDecorationType = window.createTextEditorDecorationType({\n\tafter: {\n\t\tmargin: '0 0 0 3em',\n\t\ttextDecoration: 'none',\n\t},\n\trangeBehavior: DecorationRangeBehavior.ClosedOpen,\n});\n\nexport class LineAnnotationController implements Disposable {\n\tprivate _cancellation: CancellationTokenSource | undefined;\n\tprivate readonly _disposable: Disposable;\n\tprivate _editor: TextEditor | undefined;\n\tprivate _enabled: boolean = false;\n\n\tconstructor() {\n\t\tthis._disposable = Disposable.from(\n\t\t\tconfiguration.onDidChange(this.onConfigurationChanged, this),\n\t\t\tContainer.fileAnnotations.onDidToggleAnnotations(this.onFileAnnotationsToggled, this),\n\t\t\tAuthentication.onDidChange(() => void this.refresh(window.activeTextEditor)),\n\t\t);\n\t\tthis.onConfigurationChanged();\n\t}\n\n\tdispose() {\n\t\tthis.clearAnnotations(this._editor);\n\n\t\tContainer.lineTracker.stop(this);\n\t\tthis._disposable.dispose();\n\t}\n\n\tprivate onConfigurationChanged(e?: ConfigurationChangeEvent) {\n\t\tif (!configuration.changed(e, 'currentLine')) return;\n\n\t\tif (configuration.changed(e, 'currentLine.enabled')) {\n\t\t\tif (Container.config.currentLine.enabled) {\n\t\t\t\tthis._enabled = true;\n\t\t\t\tthis.resume();\n\t\t\t} else {\n\t\t\t\tthis._enabled = false;\n\t\t\t\tthis.setLineTracker(false);\n\t\t\t}\n\t\t}\n\n\t\tvoid this.refresh(window.activeTextEditor);\n\t}\n\n\tprivate _suspended: boolean = false;\n\tget suspended() {\n\t\treturn !this._enabled || this._suspended;\n\t}\n\n\t@log()\n\tresume() {\n\t\tthis.setLineTracker(true);\n\n\t\tif (this._suspended) {\n\t\t\tthis._suspended = false;\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t@log()\n\tsuspend() {\n\t\tthis.setLineTracker(false);\n\n\t\tif (!this._suspended) {\n\t\t\tthis._suspended = true;\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (e: LinesChangeEvent) =>\n\t\t\t\t`editor=${e.editor?.document.uri.toString(true)}, selections=${e.selections\n\t\t\t\t\t?.map(s => `[${s.anchor}-${s.active}]`)\n\t\t\t\t\t.join(',')}, pending=${Boolean(e.pending)}, reason=${e.reason}`,\n\t\t},\n\t})\n\tprivate onActiveLinesChanged(e: LinesChangeEvent) {\n\t\tif (!e.pending && e.selections !== undefined) {\n\t\t\tvoid this.refresh(e.editor);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clear(e.editor);\n\t}\n\n\tprivate onFileAnnotationsToggled() {\n\t\tvoid this.refresh(window.activeTextEditor);\n\t}\n\n\t@debug({ args: false, singleLine: true })\n\tclear(editor: TextEditor | undefined) {\n\t\tthis._cancellation?.cancel();\n\t\tif (this._editor !== editor && this._editor != null) {\n\t\t\tthis.clearAnnotations(this._editor);\n\t\t}\n\t\tthis.clearAnnotations(editor);\n\t}\n\n\t@log({ args: false })\n\tasync toggle(editor: TextEditor | undefined) {\n\t\tthis._enabled = !(this._enabled && !this.suspended);\n\n\t\tif (this._enabled) {\n\t\t\tif (this.resume()) {\n\t\t\t\tawait this.refresh(editor);\n\t\t\t}\n\t\t} else if (this.suspend()) {\n\t\t\tawait this.refresh(editor);\n\t\t}\n\t}\n\n\tprivate clearAnnotations(editor: TextEditor | undefined) {\n\t\tif (editor === undefined || (editor as any)._disposed === true) return;\n\n\t\teditor.setDecorations(annotationDecoration, []);\n\t}\n\n\tprivate async getPullRequests(\n\t\trepoPath: string,\n\t\tlines: [number, GitBlameCommit][],\n\t\t{ timeout }: { timeout?: number } = {},\n\t) {\n\t\tif (lines.length === 0) return undefined;\n\n\t\tconst remote = await Container.git.getRichRemoteProvider(repoPath);\n\t\tif (remote?.provider == null) return undefined;\n\n\t\tconst refs = new Set<string>();\n\n\t\tfor (const [, commit] of lines) {\n\t\t\trefs.add(commit.ref);\n\t\t}\n\n\t\tif (refs.size === 0) return undefined;\n\n\t\tconst { provider } = remote;\n\t\tconst prs = await Promises.raceAll(\n\t\t\trefs.values(),\n\t\t\tref => Container.git.getPullRequestForCommit(ref, provider),\n\t\t\ttimeout,\n\t\t);\n\t\tif (prs.size === 0 || Iterables.every(prs.values(), pr => pr == null)) return undefined;\n\n\t\treturn prs;\n\t}\n\n\t@debug({ args: false })\n\tprivate async refresh(editor: TextEditor | undefined, options?: { prs?: Map<string, PullRequest | undefined> }) {\n\t\tif (editor == null && this._editor == null) return;\n\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tconst selections = Container.lineTracker.selections;\n\t\tif (editor == null || selections == null || !isTextEditor(editor)) {\n\t\t\tif (cc != null) {\n\t\t\t\tcc.exitDetails = ` ${GlyphChars.Dot} Skipped because there is no valid editor or no valid selections`;\n\t\t\t}\n\n\t\t\tthis.clear(this._editor);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._editor !== editor) {\n\t\t\t// Clear any annotations on the previously active editor\n\t\t\tthis.clear(this._editor);\n\n\t\t\tthis._editor = editor;\n\t\t}\n\n\t\tconst cfg = Container.config.currentLine;\n\t\tif (this.suspended) {\n\t\t\tif (cc != null) {\n\t\t\t\tcc.exitDetails = ` ${GlyphChars.Dot} Skipped because the controller is suspended`;\n\t\t\t}\n\n\t\t\tthis.clear(editor);\n\t\t\treturn;\n\t\t}\n\n\t\tconst trackedDocument = await Container.tracker.getOrAdd(editor.document);\n\t\tif (!trackedDocument.isBlameable && this.suspended) {\n\t\t\tif (cc != null) {\n\t\t\t\tcc.exitDetails = ` ${GlyphChars.Dot} Skipped because the ${\n\t\t\t\t\tthis.suspended\n\t\t\t\t\t\t? 'controller is suspended'\n\t\t\t\t\t\t: `document(${trackedDocument.uri.toString(true)}) is not blameable`\n\t\t\t\t}`;\n\t\t\t}\n\n\t\t\tthis.clear(editor);\n\t\t\treturn;\n\t\t}\n\n\t\t// Make sure the editor hasn't died since the await above and that we are still on the same line(s)\n\t\tif (editor.document == null || !Container.lineTracker.includes(selections)) {\n\t\t\tif (cc != null) {\n\t\t\t\tcc.exitDetails = ` ${GlyphChars.Dot} Skipped because the ${\n\t\t\t\t\teditor.document == null\n\t\t\t\t\t\t? 'editor is gone'\n\t\t\t\t\t\t: `selection(s)=${selections\n\t\t\t\t\t\t\t\t.map(s => `[${s.anchor}-${s.active}]`)\n\t\t\t\t\t\t\t\t.join()} are no longer current`\n\t\t\t\t}`;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (cc != null) {\n\t\t\tcc.exitDetails = ` ${GlyphChars.Dot} selection(s)=${selections\n\t\t\t\t.map(s => `[${s.anchor}-${s.active}]`)\n\t\t\t\t.join()}`;\n\t\t}\n\n\t\tconst commitLines = [\n\t\t\t...Iterables.filterMap<LineSelection, [number, GitBlameCommit]>(selections, selection => {\n\t\t\t\tconst state = Container.lineTracker.getState(selection.active);\n\t\t\t\tif (state?.commit == null) {\n\t\t\t\t\tLogger.debug(cc, `Line ${selection.active} returned no commit`);\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\treturn [selection.active, state.commit];\n\t\t\t}),\n\t\t];\n\n\t\tconst repoPath = trackedDocument.uri.repoPath;\n\n\t\t// TODO: Make this configurable?\n\t\tconst timeout = 100;\n\t\tconst [getBranchAndTagTips, prs] = await Promise.all([\n\t\t\tCommitFormatter.has(cfg.format, 'tips') ? Container.git.getBranchesAndTagsTipsFn(repoPath) : undefined,\n\t\t\trepoPath != null &&\n\t\t\tcfg.pullRequests.enabled &&\n\t\t\tCommitFormatter.has(\n\t\t\t\tcfg.format,\n\t\t\t\t'pullRequest',\n\t\t\t\t'pullRequestAgo',\n\t\t\t\t'pullRequestAgoOrDate',\n\t\t\t\t'pullRequestDate',\n\t\t\t\t'pullRequestState',\n\t\t\t)\n\t\t\t\t? options?.prs ??\n\t\t\t\t  this.getPullRequests(\n\t\t\t\t\t\trepoPath,\n\t\t\t\t\t\tcommitLines.filter(([, commit]) => !commit.isUncommitted),\n\t\t\t\t\t\t{ timeout: timeout },\n\t\t\t\t  )\n\t\t\t\t: undefined,\n\t\t]);\n\n\t\tif (prs != null) {\n\t\t\tthis._cancellation?.cancel();\n\t\t\tthis._cancellation = new CancellationTokenSource();\n\t\t\tvoid this.waitForAnyPendingPullRequests(editor, prs, this._cancellation.token, timeout, cc);\n\t\t}\n\n\t\tconst decorations = [];\n\n\t\tfor (const [l, commit] of commitLines) {\n\t\t\tconst decoration = Annotations.trailing(\n\t\t\t\tcommit,\n\t\t\t\t// await GitUri.fromUri(editor.document.uri),\n\t\t\t\t// l,\n\t\t\t\tcfg.format,\n\t\t\t\t{\n\t\t\t\t\tdateFormat: cfg.dateFormat === null ? Container.config.defaultDateFormat : cfg.dateFormat,\n\t\t\t\t\tgetBranchAndTagTips: getBranchAndTagTips,\n\t\t\t\t\tpullRequestOrRemote: prs?.get(commit.ref),\n\t\t\t\t\tpullRequestPendingMessage: `PR ${GlyphChars.Ellipsis}`,\n\t\t\t\t},\n\t\t\t\tcfg.scrollable,\n\t\t\t) as DecorationOptions;\n\t\t\tdecoration.range = editor.document.validateRange(\n\t\t\t\tnew Range(l, Number.MAX_SAFE_INTEGER, l, Number.MAX_SAFE_INTEGER),\n\t\t\t);\n\n\t\t\tdecorations.push(decoration);\n\t\t}\n\n\t\teditor.setDecorations(annotationDecoration, decorations);\n\t}\n\n\tprivate setLineTracker(enabled: boolean) {\n\t\tif (enabled) {\n\t\t\tif (!Container.lineTracker.isSubscribed(this)) {\n\t\t\t\tContainer.lineTracker.start(\n\t\t\t\t\tthis,\n\t\t\t\t\tContainer.lineTracker.onDidChangeActiveLines(this.onActiveLinesChanged, this),\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tContainer.lineTracker.stop(this);\n\t}\n\n\tprivate async waitForAnyPendingPullRequests(\n\t\teditor: TextEditor,\n\t\tprs: Map<\n\t\t\tstring,\n\t\t\tPullRequest | Promises.CancellationErrorWithId<string, Promise<PullRequest | undefined>> | undefined\n\t\t>,\n\t\tcancellationToken: CancellationToken,\n\t\ttimeout: number,\n\t\tcc: LogCorrelationContext | undefined,\n\t) {\n\t\t// If there are any PRs that timed out, refresh the annotation(s) once they complete\n\t\tconst count = Iterables.count(prs.values(), pr => pr instanceof Promises.CancellationError);\n\t\tif (cancellationToken.isCancellationRequested || count === 0) return;\n\n\t\tLogger.debug(cc, `${GlyphChars.Dot} ${count} pull request queries took too long (over ${timeout} ms)`);\n\n\t\tconst resolved = new Map<string, PullRequest | undefined>();\n\t\tfor (const [key, value] of prs) {\n\t\t\tresolved.set(key, value instanceof Promises.CancellationError ? await value.promise : value);\n\t\t}\n\n\t\tif (cancellationToken.isCancellationRequested || editor !== this._editor) return;\n\n\t\tLogger.debug(cc, `${GlyphChars.Dot} ${count} pull request queries completed; refreshing...`);\n\n\t\tvoid this.refresh(editor, { prs: resolved });\n\t}\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tCodeLens,\n\tCodeLensProvider,\n\tCommand,\n\tcommands,\n\tDocumentSelector,\n\tDocumentSymbol,\n\tEvent,\n\tEventEmitter,\n\tExtensionContext,\n\tLocation,\n\tPosition,\n\tRange,\n\tSymbolInformation,\n\tSymbolKind,\n\tTextDocument,\n\tUri,\n} from 'vscode';\nimport {\n\tcommand,\n\tCommands,\n\tDiffWithPreviousCommandArgs,\n\tOpenOnRemoteCommandArgs,\n\tShowCommitsInViewCommandArgs,\n\tShowQuickCommitCommandArgs,\n\tShowQuickCommitFileCommandArgs,\n\tShowQuickFileHistoryCommandArgs,\n\tToggleFileChangesAnnotationCommandArgs,\n} from '../commands';\nimport {\n\tCodeLensCommand,\n\tCodeLensConfig,\n\tCodeLensLanguageScope,\n\tCodeLensScopes,\n\tconfiguration,\n\tFileAnnotationType,\n} from '../configuration';\nimport { BuiltInCommands, DocumentSchemes } from '../constants';\nimport { Container } from '../container';\nimport { GitBlame, GitBlameLines, GitCommit, RemoteResourceType } from '../git/git';\nimport { GitService } from '../git/gitService';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Functions, Iterables } from '../system';\nimport { DocumentTracker, GitDocumentState } from '../trackers/gitDocumentTracker';\n\nexport class GitRecentChangeCodeLens extends CodeLens {\n\tconstructor(\n\t\tpublic readonly languageId: string,\n\t\tpublic readonly symbol: DocumentSymbol | SymbolInformation,\n\t\tpublic readonly uri: GitUri | undefined,\n\t\tprivate readonly blame: (() => GitBlameLines | undefined) | undefined,\n\t\tpublic readonly blameRange: Range,\n\t\tpublic readonly isFullRange: boolean,\n\t\trange: Range,\n\t\tpublic readonly desiredCommand: CodeLensCommand | false,\n\t\tcommand?: Command | undefined,\n\t) {\n\t\tsuper(range, command);\n\t}\n\n\tgetBlame(): GitBlameLines | undefined {\n\t\treturn this.blame?.();\n\t}\n}\n\nexport class GitAuthorsCodeLens extends CodeLens {\n\tconstructor(\n\t\tpublic readonly languageId: string,\n\t\tpublic readonly symbol: DocumentSymbol | SymbolInformation,\n\t\tpublic readonly uri: GitUri | undefined,\n\t\tprivate readonly blame: () => GitBlameLines | undefined,\n\t\tpublic readonly blameRange: Range,\n\t\tpublic readonly isFullRange: boolean,\n\t\trange: Range,\n\t\tpublic readonly desiredCommand: CodeLensCommand | false,\n\t) {\n\t\tsuper(range);\n\t}\n\n\tgetBlame(): GitBlameLines | undefined {\n\t\treturn this.blame();\n\t}\n}\n\nexport class GitCodeLensProvider implements CodeLensProvider {\n\tprivate _onDidChangeCodeLenses = new EventEmitter<void>();\n\tget onDidChangeCodeLenses(): Event<void> {\n\t\treturn this._onDidChangeCodeLenses.event;\n\t}\n\n\tstatic selector: DocumentSelector = [\n\t\t{ scheme: DocumentSchemes.File },\n\t\t{ scheme: DocumentSchemes.Git },\n\t\t{ scheme: DocumentSchemes.GitLens },\n\t\t{ scheme: DocumentSchemes.PRs },\n\t\t{ scheme: DocumentSchemes.Vsls },\n\t];\n\n\tconstructor(\n\t\t_context: ExtensionContext,\n\t\tprivate readonly _git: GitService,\n\t\tprivate readonly _tracker: DocumentTracker<GitDocumentState>,\n\t) {}\n\n\treset(_reason?: 'idle' | 'saved') {\n\t\tthis._onDidChangeCodeLenses.fire();\n\t}\n\n\tasync provideCodeLenses(document: TextDocument, token: CancellationToken): Promise<CodeLens[]> {\n\t\tconst trackedDocument = await this._tracker.getOrAdd(document);\n\t\tif (!trackedDocument.isBlameable) return [];\n\n\t\tlet dirty = false;\n\t\tif (document.isDirty) {\n\t\t\t// Only allow dirty blames if we are idle\n\t\t\tif (trackedDocument.isDirtyIdle) {\n\t\t\t\tconst maxLines = Container.config.advanced.blame.sizeThresholdAfterEdit;\n\t\t\t\tif (maxLines > 0 && document.lineCount > maxLines) {\n\t\t\t\t\tdirty = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdirty = true;\n\t\t\t}\n\t\t}\n\n\t\tconst cfg = configuration.get('codeLens', document);\n\n\t\tlet languageScope = cfg.scopesByLanguage?.find(ll => ll.language?.toLowerCase() === document.languageId);\n\t\tif (languageScope == null) {\n\t\t\tlanguageScope = {\n\t\t\t\tlanguage: document.languageId,\n\t\t\t};\n\t\t}\n\t\tif (languageScope.scopes == null) {\n\t\t\tlanguageScope.scopes = cfg.scopes;\n\t\t}\n\t\tif (languageScope.symbolScopes == null) {\n\t\t\tlanguageScope.symbolScopes = cfg.symbolScopes;\n\t\t}\n\n\t\tlanguageScope.symbolScopes =\n\t\t\tlanguageScope.symbolScopes != null\n\t\t\t\t? (languageScope.symbolScopes = languageScope.symbolScopes.map(s => s.toLowerCase()))\n\t\t\t\t: [];\n\n\t\tconst lenses: CodeLens[] = [];\n\n\t\tconst gitUri = trackedDocument.uri;\n\t\tlet blame: GitBlame | undefined;\n\t\tlet symbols;\n\n\t\tif (!dirty) {\n\t\t\tif (token.isCancellationRequested) return lenses;\n\n\t\t\tif (languageScope.scopes.length === 1 && languageScope.scopes.includes(CodeLensScopes.Document)) {\n\t\t\t\tblame = document.isDirty\n\t\t\t\t\t? await this._git.getBlameForFileContents(gitUri, document.getText())\n\t\t\t\t\t: await this._git.getBlameForFile(gitUri);\n\t\t\t} else {\n\t\t\t\t[blame, symbols] = await Promise.all([\n\t\t\t\t\tdocument.isDirty\n\t\t\t\t\t\t? this._git.getBlameForFileContents(gitUri, document.getText())\n\t\t\t\t\t\t: this._git.getBlameForFile(gitUri),\n\t\t\t\t\tcommands.executeCommand(BuiltInCommands.ExecuteDocumentSymbolProvider, document.uri) as Promise<\n\t\t\t\t\t\tSymbolInformation[]\n\t\t\t\t\t>,\n\t\t\t\t]);\n\t\t\t}\n\n\t\t\tif (blame === undefined || blame.lines.length === 0) return lenses;\n\t\t} else if (languageScope.scopes.length !== 1 || !languageScope.scopes.includes(CodeLensScopes.Document)) {\n\t\t\tsymbols = (await commands.executeCommand(\n\t\t\t\tBuiltInCommands.ExecuteDocumentSymbolProvider,\n\t\t\t\tdocument.uri,\n\t\t\t)) as SymbolInformation[];\n\t\t}\n\n\t\tif (token.isCancellationRequested) return lenses;\n\n\t\tconst documentRangeFn = Functions.once(() => document.validateRange(new Range(0, 0, 1000000, 1000000)));\n\n\t\t// Since blame information isn't valid when there are unsaved changes -- update the lenses appropriately\n\t\tconst dirtyCommand: Command | undefined = dirty\n\t\t\t? { command: undefined!, title: this.getDirtyTitle(cfg) }\n\t\t\t: undefined;\n\n\t\tif (symbols !== undefined) {\n\t\t\tLogger.log('GitCodeLensProvider.provideCodeLenses:', `${symbols.length} symbol(s) found`);\n\t\t\tfor (const sym of symbols) {\n\t\t\t\tthis.provideCodeLens(\n\t\t\t\t\tlenses,\n\t\t\t\t\tdocument,\n\t\t\t\t\tsym,\n\t\t\t\t\tlanguageScope as Required<CodeLensLanguageScope>,\n\t\t\t\t\tdocumentRangeFn,\n\t\t\t\t\tblame,\n\t\t\t\t\tgitUri,\n\t\t\t\t\tcfg,\n\t\t\t\t\tdirty,\n\t\t\t\t\tdirtyCommand,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\t(languageScope.scopes.includes(CodeLensScopes.Document) || languageScope.symbolScopes.includes('file')) &&\n\t\t\t!languageScope.symbolScopes.includes('!file')\n\t\t) {\n\t\t\t// Check if we have a lens for the whole document -- if not add one\n\t\t\tif (lenses.find(l => l.range.start.line === 0 && l.range.end.line === 0) == null) {\n\t\t\t\tconst blameRange = documentRangeFn();\n\n\t\t\t\tlet blameForRangeFn: (() => GitBlameLines | undefined) | undefined = undefined;\n\t\t\t\tif (dirty || cfg.recentChange.enabled) {\n\t\t\t\t\tif (!dirty) {\n\t\t\t\t\t\tblameForRangeFn = Functions.once(() =>\n\t\t\t\t\t\t\tthis._git.getBlameForRangeSync(blame!, gitUri, blameRange),\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst fileSymbol = new SymbolInformation(\n\t\t\t\t\t\tgitUri.fileName,\n\t\t\t\t\t\tSymbolKind.File,\n\t\t\t\t\t\t'',\n\t\t\t\t\t\tnew Location(gitUri.documentUri(), new Range(0, 0, 0, blameRange.start.character)),\n\t\t\t\t\t);\n\t\t\t\t\tlenses.push(\n\t\t\t\t\t\tnew GitRecentChangeCodeLens(\n\t\t\t\t\t\t\tdocument.languageId,\n\t\t\t\t\t\t\tfileSymbol,\n\t\t\t\t\t\t\tgitUri,\n\t\t\t\t\t\t\tblameForRangeFn,\n\t\t\t\t\t\t\tblameRange,\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\tgetRangeFromSymbol(fileSymbol),\n\t\t\t\t\t\t\tcfg.recentChange.command,\n\t\t\t\t\t\t\tdirtyCommand,\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (!dirty && cfg.authors.enabled) {\n\t\t\t\t\tif (blameForRangeFn === undefined) {\n\t\t\t\t\t\tblameForRangeFn = Functions.once(() =>\n\t\t\t\t\t\t\tthis._git.getBlameForRangeSync(blame!, gitUri, blameRange),\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst fileSymbol = new SymbolInformation(\n\t\t\t\t\t\tgitUri.fileName,\n\t\t\t\t\t\tSymbolKind.File,\n\t\t\t\t\t\t'',\n\t\t\t\t\t\tnew Location(gitUri.documentUri(), new Range(0, 1, 0, blameRange.start.character)),\n\t\t\t\t\t);\n\t\t\t\t\tlenses.push(\n\t\t\t\t\t\tnew GitAuthorsCodeLens(\n\t\t\t\t\t\t\tdocument.languageId,\n\t\t\t\t\t\t\tfileSymbol,\n\t\t\t\t\t\t\tgitUri,\n\t\t\t\t\t\t\tblameForRangeFn,\n\t\t\t\t\t\t\tblameRange,\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\tgetRangeFromSymbol(fileSymbol),\n\t\t\t\t\t\t\tcfg.authors.command,\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn lenses;\n\t}\n\n\tprivate getValidateSymbolRange(\n\t\tsymbol: SymbolInformation | DocumentSymbol,\n\t\tlanguageScope: Required<CodeLensLanguageScope>,\n\t\tdocumentRangeFn: () => Range,\n\t\tincludeSingleLineSymbols: boolean,\n\t): Range | undefined {\n\t\tlet valid = false;\n\t\tlet range: Range | undefined;\n\n\t\tconst symbolName = SymbolKind[symbol.kind].toLowerCase();\n\t\tswitch (symbol.kind) {\n\t\t\tcase SymbolKind.File:\n\t\t\t\tif (\n\t\t\t\t\tlanguageScope.scopes.includes(CodeLensScopes.Containers) ||\n\t\t\t\t\tlanguageScope.symbolScopes.includes(symbolName)\n\t\t\t\t) {\n\t\t\t\t\tvalid = !languageScope.symbolScopes.includes(`!${symbolName}`);\n\t\t\t\t}\n\n\t\t\t\tif (valid) {\n\t\t\t\t\t// Adjust the range to be for the whole file\n\t\t\t\t\trange = documentRangeFn();\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase SymbolKind.Package:\n\t\t\t\tif (\n\t\t\t\t\tlanguageScope.scopes.includes(CodeLensScopes.Containers) ||\n\t\t\t\t\tlanguageScope.symbolScopes.includes(symbolName)\n\t\t\t\t) {\n\t\t\t\t\tvalid = !languageScope.symbolScopes.includes(`!${symbolName}`);\n\t\t\t\t}\n\n\t\t\t\tif (valid) {\n\t\t\t\t\t// Adjust the range to be for the whole file\n\t\t\t\t\trange = getRangeFromSymbol(symbol);\n\t\t\t\t\tif (range.start.line === 0 && range.end.line === 0) {\n\t\t\t\t\t\trange = documentRangeFn();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase SymbolKind.Class:\n\t\t\tcase SymbolKind.Interface:\n\t\t\tcase SymbolKind.Module:\n\t\t\tcase SymbolKind.Namespace:\n\t\t\tcase SymbolKind.Struct:\n\t\t\t\tif (\n\t\t\t\t\tlanguageScope.scopes.includes(CodeLensScopes.Containers) ||\n\t\t\t\t\tlanguageScope.symbolScopes.includes(symbolName)\n\t\t\t\t) {\n\t\t\t\t\trange = getRangeFromSymbol(symbol);\n\t\t\t\t\tvalid =\n\t\t\t\t\t\t!languageScope.symbolScopes.includes(`!${symbolName}`) &&\n\t\t\t\t\t\t(includeSingleLineSymbols || !range.isSingleLine);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase SymbolKind.Constructor:\n\t\t\tcase SymbolKind.Enum:\n\t\t\tcase SymbolKind.Function:\n\t\t\tcase SymbolKind.Method:\n\t\t\tcase SymbolKind.Property:\n\t\t\t\tif (\n\t\t\t\t\tlanguageScope.scopes.includes(CodeLensScopes.Blocks) ||\n\t\t\t\t\tlanguageScope.symbolScopes.includes(symbolName)\n\t\t\t\t) {\n\t\t\t\t\trange = getRangeFromSymbol(symbol);\n\t\t\t\t\tvalid =\n\t\t\t\t\t\t!languageScope.symbolScopes.includes(`!${symbolName}`) &&\n\t\t\t\t\t\t(includeSingleLineSymbols || !range.isSingleLine);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase SymbolKind.String:\n\t\t\t\tif (\n\t\t\t\t\tlanguageScope.symbolScopes.includes(symbolName) ||\n\t\t\t\t\t// A special case for markdown files, SymbolKind.String seems to be returned for headers, so consider those containers\n\t\t\t\t\t(languageScope.language === 'markdown' && languageScope.scopes.includes(CodeLensScopes.Containers))\n\t\t\t\t) {\n\t\t\t\t\trange = getRangeFromSymbol(symbol);\n\t\t\t\t\tvalid =\n\t\t\t\t\t\t!languageScope.symbolScopes.includes(`!${symbolName}`) &&\n\t\t\t\t\t\t(includeSingleLineSymbols || !range.isSingleLine);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tif (languageScope.symbolScopes.includes(symbolName)) {\n\t\t\t\t\trange = getRangeFromSymbol(symbol);\n\t\t\t\t\tvalid =\n\t\t\t\t\t\t!languageScope.symbolScopes.includes(`!${symbolName}`) &&\n\t\t\t\t\t\t(includeSingleLineSymbols || !range.isSingleLine);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn valid ? range ?? getRangeFromSymbol(symbol) : undefined;\n\t}\n\n\tprivate provideCodeLens(\n\t\tlenses: CodeLens[],\n\t\tdocument: TextDocument,\n\t\tsymbol: SymbolInformation | DocumentSymbol,\n\t\tlanguageScope: Required<CodeLensLanguageScope>,\n\t\tdocumentRangeFn: () => Range,\n\t\tblame: GitBlame | undefined,\n\t\tgitUri: GitUri | undefined,\n\t\tcfg: CodeLensConfig,\n\t\tdirty: boolean,\n\t\tdirtyCommand: Command | undefined,\n\t): void {\n\t\ttry {\n\t\t\tconst blameRange = this.getValidateSymbolRange(\n\t\t\t\tsymbol,\n\t\t\t\tlanguageScope,\n\t\t\t\tdocumentRangeFn,\n\t\t\t\tcfg.includeSingleLineSymbols,\n\t\t\t);\n\t\t\tif (blameRange === undefined) return;\n\n\t\t\tconst line = document.lineAt(getRangeFromSymbol(symbol).start);\n\t\t\t// Make sure there is only 1 lens per line\n\t\t\tif (lenses.length && lenses[lenses.length - 1].range.start.line === line.lineNumber) return;\n\n\t\t\t// Anchor the code lens to the start of the line -- so that the range won't change with edits (otherwise the code lens will be removed and re-added)\n\t\t\tlet startChar = 0;\n\n\t\t\tlet blameForRangeFn: (() => GitBlameLines | undefined) | undefined;\n\t\t\tif (dirty || cfg.recentChange.enabled) {\n\t\t\t\tif (!dirty) {\n\t\t\t\t\tblameForRangeFn = Functions.once(() => this._git.getBlameForRangeSync(blame!, gitUri!, blameRange));\n\t\t\t\t}\n\t\t\t\tlenses.push(\n\t\t\t\t\tnew GitRecentChangeCodeLens(\n\t\t\t\t\t\tdocument.languageId,\n\t\t\t\t\t\tsymbol,\n\t\t\t\t\t\tgitUri,\n\t\t\t\t\t\tblameForRangeFn,\n\t\t\t\t\t\tblameRange,\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\tline.range.with(new Position(line.range.start.line, startChar)),\n\t\t\t\t\t\tcfg.recentChange.command,\n\t\t\t\t\t\tdirtyCommand,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tstartChar++;\n\t\t\t}\n\n\t\t\tif (cfg.authors.enabled) {\n\t\t\t\tlet multiline = !blameRange.isSingleLine;\n\t\t\t\t// HACK for Omnisharp, since it doesn't return full ranges\n\t\t\t\tif (!multiline && document.languageId === 'csharp') {\n\t\t\t\t\tswitch (symbol.kind) {\n\t\t\t\t\t\tcase SymbolKind.File:\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase SymbolKind.Package:\n\t\t\t\t\t\tcase SymbolKind.Module:\n\t\t\t\t\t\tcase SymbolKind.Namespace:\n\t\t\t\t\t\tcase SymbolKind.Class:\n\t\t\t\t\t\tcase SymbolKind.Interface:\n\t\t\t\t\t\tcase SymbolKind.Constructor:\n\t\t\t\t\t\tcase SymbolKind.Method:\n\t\t\t\t\t\tcase SymbolKind.Function:\n\t\t\t\t\t\tcase SymbolKind.Enum:\n\t\t\t\t\t\t\tmultiline = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (multiline && !dirty) {\n\t\t\t\t\tif (blameForRangeFn === undefined) {\n\t\t\t\t\t\tblameForRangeFn = Functions.once(() =>\n\t\t\t\t\t\t\tthis._git.getBlameForRangeSync(blame!, gitUri!, blameRange),\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tlenses.push(\n\t\t\t\t\t\tnew GitAuthorsCodeLens(\n\t\t\t\t\t\t\tdocument.languageId,\n\t\t\t\t\t\t\tsymbol,\n\t\t\t\t\t\t\tgitUri,\n\t\t\t\t\t\t\tblameForRangeFn,\n\t\t\t\t\t\t\tblameRange,\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\tline.range.with(new Position(line.range.start.line, startChar)),\n\t\t\t\t\t\t\tcfg.authors.command,\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t} finally {\n\t\t\tif (isDocumentSymbol(symbol)) {\n\t\t\t\tfor (const child of symbol.children) {\n\t\t\t\t\tthis.provideCodeLens(\n\t\t\t\t\t\tlenses,\n\t\t\t\t\t\tdocument,\n\t\t\t\t\t\tchild,\n\t\t\t\t\t\tlanguageScope,\n\t\t\t\t\t\tdocumentRangeFn,\n\t\t\t\t\t\tblame,\n\t\t\t\t\t\tgitUri,\n\t\t\t\t\t\tcfg,\n\t\t\t\t\t\tdirty,\n\t\t\t\t\t\tdirtyCommand,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tresolveCodeLens(lens: CodeLens, token: CancellationToken): CodeLens | Promise<CodeLens> {\n\t\tif (lens instanceof GitRecentChangeCodeLens) return this.resolveGitRecentChangeCodeLens(lens, token);\n\t\tif (lens instanceof GitAuthorsCodeLens) return this.resolveGitAuthorsCodeLens(lens, token);\n\t\treturn Promise.reject<CodeLens>(undefined);\n\t}\n\n\tprivate resolveGitRecentChangeCodeLens(lens: GitRecentChangeCodeLens, _token: CancellationToken): CodeLens {\n\t\tconst blame = lens.getBlame();\n\t\tif (blame === undefined) return lens;\n\n\t\tconst recentCommit: GitCommit = Iterables.first(blame.commits.values());\n\t\t// TODO@eamodio This is FAR too expensive, but this accounts for commits that delete lines -- is there another way?\n\t\t// if (lens.uri != null) {\n\t\t// \tconst commit = await this._git.getCommitForFile(lens.uri.repoPath, lens.uri.fsPath, {\n\t\t// \t\trange: lens.blameRange,\n\t\t// \t});\n\t\t// \tif (\n\t\t// \t\tcommit != null &&\n\t\t// \t\tcommit.sha !== recentCommit.sha &&\n\t\t// \t\tcommit.date.getTime() > recentCommit.date.getTime()\n\t\t// \t) {\n\t\t// \t\trecentCommit = commit;\n\t\t// \t}\n\t\t// }\n\n\t\tlet title = `${recentCommit.author}, ${recentCommit.formattedDate}`;\n\t\tif (Container.config.debug) {\n\t\t\ttitle += ` [${lens.languageId}: ${SymbolKind[lens.symbol.kind]}(${lens.range.start.character}-${\n\t\t\t\tlens.range.end.character\n\t\t\t}${\n\t\t\t\t(lens.symbol as SymbolInformation).containerName\n\t\t\t\t\t? `|${(lens.symbol as SymbolInformation).containerName}`\n\t\t\t\t\t: ''\n\t\t\t}), Lines (${lens.blameRange.start.line + 1}-${lens.blameRange.end.line + 1}), Commit (${\n\t\t\t\trecentCommit.shortSha\n\t\t\t})]`;\n\t\t}\n\n\t\tif (lens.desiredCommand === false) {\n\t\t\treturn this.applyCommandWithNoClickAction(title, lens);\n\t\t}\n\n\t\tswitch (lens.desiredCommand) {\n\t\t\tcase CodeLensCommand.CopyRemoteCommitUrl:\n\t\t\t\treturn this.applyCopyOrOpenCommitOnRemoteCommand<GitRecentChangeCodeLens>(\n\t\t\t\t\ttitle,\n\t\t\t\t\tlens,\n\t\t\t\t\trecentCommit,\n\t\t\t\t\ttrue,\n\t\t\t\t);\n\t\t\tcase CodeLensCommand.CopyRemoteFileUrl:\n\t\t\t\treturn this.applyCopyOrOpenFileOnRemoteCommand<GitRecentChangeCodeLens>(\n\t\t\t\t\ttitle,\n\t\t\t\t\tlens,\n\t\t\t\t\trecentCommit,\n\t\t\t\t\ttrue,\n\t\t\t\t);\n\t\t\tcase CodeLensCommand.DiffWithPrevious:\n\t\t\t\treturn this.applyDiffWithPreviousCommand<GitRecentChangeCodeLens>(title, lens, recentCommit);\n\t\t\tcase CodeLensCommand.OpenCommitOnRemote:\n\t\t\t\treturn this.applyCopyOrOpenCommitOnRemoteCommand<GitRecentChangeCodeLens>(title, lens, recentCommit);\n\t\t\tcase CodeLensCommand.OpenFileOnRemote:\n\t\t\t\treturn this.applyCopyOrOpenFileOnRemoteCommand<GitRecentChangeCodeLens>(title, lens, recentCommit);\n\t\t\tcase CodeLensCommand.RevealCommitInView:\n\t\t\t\treturn this.applyRevealCommitInViewCommand<GitRecentChangeCodeLens>(title, lens, recentCommit);\n\t\t\tcase CodeLensCommand.ShowCommitsInView:\n\t\t\t\treturn this.applyShowCommitsInViewCommand<GitRecentChangeCodeLens>(title, lens, blame, recentCommit);\n\t\t\tcase CodeLensCommand.ShowQuickCommitDetails:\n\t\t\t\treturn this.applyShowQuickCommitDetailsCommand<GitRecentChangeCodeLens>(title, lens, recentCommit);\n\t\t\tcase CodeLensCommand.ShowQuickCommitFileDetails:\n\t\t\t\treturn this.applyShowQuickCommitFileDetailsCommand<GitRecentChangeCodeLens>(title, lens, recentCommit);\n\t\t\tcase CodeLensCommand.ShowQuickCurrentBranchHistory:\n\t\t\t\treturn this.applyShowQuickCurrentBranchHistoryCommand<GitRecentChangeCodeLens>(title, lens);\n\t\t\tcase CodeLensCommand.ShowQuickFileHistory:\n\t\t\t\treturn this.applyShowQuickFileHistoryCommand<GitRecentChangeCodeLens>(title, lens);\n\t\t\tcase CodeLensCommand.ToggleFileBlame:\n\t\t\t\treturn this.applyToggleFileBlameCommand<GitRecentChangeCodeLens>(title, lens);\n\t\t\tcase CodeLensCommand.ToggleFileChanges:\n\t\t\t\treturn this.applyToggleFileChangesCommand<GitRecentChangeCodeLens>(title, lens, recentCommit);\n\t\t\tcase CodeLensCommand.ToggleFileChangesOnly:\n\t\t\t\treturn this.applyToggleFileChangesCommand<GitRecentChangeCodeLens>(title, lens, recentCommit, true);\n\t\t\tcase CodeLensCommand.ToggleFileHeatmap:\n\t\t\t\treturn this.applyToggleFileHeatmapCommand<GitRecentChangeCodeLens>(title, lens);\n\t\t\tdefault:\n\t\t\t\treturn lens;\n\t\t}\n\t}\n\n\tprivate resolveGitAuthorsCodeLens(lens: GitAuthorsCodeLens, _token: CancellationToken): CodeLens {\n\t\tconst blame = lens.getBlame();\n\t\tif (blame === undefined) return lens;\n\n\t\tconst count = blame.authors.size;\n\n\t\tconst author = Iterables.first(blame.authors.values()).name;\n\n\t\tlet title = `${count} ${count > 1 ? 'authors' : 'author'} (${author}${count > 1 ? ' and others' : ''})`;\n\t\tif (Container.config.debug) {\n\t\t\ttitle += ` [${lens.languageId}: ${SymbolKind[lens.symbol.kind]}(${lens.range.start.character}-${\n\t\t\t\tlens.range.end.character\n\t\t\t}${\n\t\t\t\t(lens.symbol as SymbolInformation).containerName\n\t\t\t\t\t? `|${(lens.symbol as SymbolInformation).containerName}`\n\t\t\t\t\t: ''\n\t\t\t}), Lines (${lens.blameRange.start.line + 1}-${lens.blameRange.end.line + 1}), Authors (${Iterables.join(\n\t\t\t\tIterables.map(blame.authors.values(), a => a.name),\n\t\t\t\t', ',\n\t\t\t)})]`;\n\t\t}\n\n\t\tif (lens.desiredCommand === false) {\n\t\t\treturn this.applyCommandWithNoClickAction(title, lens);\n\t\t}\n\n\t\tconst commit =\n\t\t\tIterables.find(blame.commits.values(), c => c.author === author) ?? Iterables.first(blame.commits.values());\n\n\t\tswitch (lens.desiredCommand) {\n\t\t\tcase CodeLensCommand.CopyRemoteCommitUrl:\n\t\t\t\treturn this.applyCopyOrOpenCommitOnRemoteCommand<GitAuthorsCodeLens>(title, lens, commit, true);\n\t\t\tcase CodeLensCommand.CopyRemoteFileUrl:\n\t\t\t\treturn this.applyCopyOrOpenFileOnRemoteCommand<GitAuthorsCodeLens>(title, lens, commit, true);\n\t\t\tcase CodeLensCommand.DiffWithPrevious:\n\t\t\t\treturn this.applyDiffWithPreviousCommand<GitAuthorsCodeLens>(title, lens, commit);\n\t\t\tcase CodeLensCommand.OpenCommitOnRemote:\n\t\t\t\treturn this.applyCopyOrOpenCommitOnRemoteCommand<GitAuthorsCodeLens>(title, lens, commit);\n\t\t\tcase CodeLensCommand.OpenFileOnRemote:\n\t\t\t\treturn this.applyCopyOrOpenFileOnRemoteCommand<GitAuthorsCodeLens>(title, lens, commit);\n\t\t\tcase CodeLensCommand.RevealCommitInView:\n\t\t\t\treturn this.applyRevealCommitInViewCommand<GitAuthorsCodeLens>(title, lens, commit);\n\t\t\tcase CodeLensCommand.ShowCommitsInView:\n\t\t\t\treturn this.applyShowCommitsInViewCommand<GitAuthorsCodeLens>(title, lens, blame);\n\t\t\tcase CodeLensCommand.ShowQuickCommitDetails:\n\t\t\t\treturn this.applyShowQuickCommitDetailsCommand<GitAuthorsCodeLens>(title, lens, commit);\n\t\t\tcase CodeLensCommand.ShowQuickCommitFileDetails:\n\t\t\t\treturn this.applyShowQuickCommitFileDetailsCommand<GitAuthorsCodeLens>(title, lens, commit);\n\t\t\tcase CodeLensCommand.ShowQuickCurrentBranchHistory:\n\t\t\t\treturn this.applyShowQuickCurrentBranchHistoryCommand<GitAuthorsCodeLens>(title, lens);\n\t\t\tcase CodeLensCommand.ShowQuickFileHistory:\n\t\t\t\treturn this.applyShowQuickFileHistoryCommand<GitAuthorsCodeLens>(title, lens);\n\t\t\tcase CodeLensCommand.ToggleFileBlame:\n\t\t\t\treturn this.applyToggleFileBlameCommand<GitAuthorsCodeLens>(title, lens);\n\t\t\tcase CodeLensCommand.ToggleFileChanges:\n\t\t\t\treturn this.applyToggleFileChangesCommand<GitAuthorsCodeLens>(title, lens, commit);\n\t\t\tcase CodeLensCommand.ToggleFileChangesOnly:\n\t\t\t\treturn this.applyToggleFileChangesCommand<GitAuthorsCodeLens>(title, lens, commit, true);\n\t\t\tcase CodeLensCommand.ToggleFileHeatmap:\n\t\t\t\treturn this.applyToggleFileHeatmapCommand<GitAuthorsCodeLens>(title, lens);\n\t\t\tdefault:\n\t\t\t\treturn lens;\n\t\t}\n\t}\n\n\tprivate applyDiffWithPreviousCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t\tcommit: GitCommit | undefined,\n\t): T {\n\t\tlens.command = command<[undefined, DiffWithPreviousCommandArgs]>({\n\t\t\ttitle: title,\n\t\t\tcommand: Commands.DiffWithPrevious,\n\t\t\targuments: [\n\t\t\t\tundefined,\n\t\t\t\t{\n\t\t\t\t\tcommit: commit,\n\t\t\t\t\turi: lens.uri!.toFileUri(),\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t\treturn lens;\n\t}\n\n\tprivate applyCopyOrOpenCommitOnRemoteCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t\tcommit: GitCommit,\n\t\tclipboard: boolean = false,\n\t): T {\n\t\tlens.command = command<[OpenOnRemoteCommandArgs]>({\n\t\t\ttitle: title,\n\t\t\tcommand: Commands.OpenOnRemote,\n\t\t\targuments: [\n\t\t\t\t{\n\t\t\t\t\tresource: {\n\t\t\t\t\t\ttype: RemoteResourceType.Commit,\n\t\t\t\t\t\tsha: commit.sha,\n\t\t\t\t\t},\n\t\t\t\t\trepoPath: commit.repoPath,\n\t\t\t\t\tclipboard: clipboard,\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t\treturn lens;\n\t}\n\n\tprivate applyCopyOrOpenFileOnRemoteCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t\tcommit: GitCommit,\n\t\tclipboard: boolean = false,\n\t): T {\n\t\tlens.command = command<[OpenOnRemoteCommandArgs]>({\n\t\t\ttitle: title,\n\t\t\tcommand: Commands.OpenOnRemote,\n\t\t\targuments: [\n\t\t\t\t{\n\t\t\t\t\tresource: {\n\t\t\t\t\t\ttype: RemoteResourceType.Revision,\n\t\t\t\t\t\tfileName: commit.fileName,\n\t\t\t\t\t\tsha: commit.sha,\n\t\t\t\t\t},\n\t\t\t\t\trepoPath: commit.repoPath,\n\t\t\t\t\tclipboard: clipboard,\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t\treturn lens;\n\t}\n\n\tprivate applyRevealCommitInViewCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t\tcommit: GitCommit | undefined,\n\t): T {\n\t\tlens.command = command<[Uri, ShowQuickCommitCommandArgs]>({\n\t\t\ttitle: title,\n\t\t\tcommand: commit?.isUncommitted ? '' : CodeLensCommand.RevealCommitInView,\n\t\t\targuments: [\n\t\t\t\tlens.uri!.toFileUri(),\n\t\t\t\t{\n\t\t\t\t\tcommit: commit,\n\t\t\t\t\tsha: commit === undefined ? undefined : commit.sha,\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t\treturn lens;\n\t}\n\n\tprivate applyShowCommitsInViewCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t\tblame: GitBlameLines,\n\t\tcommit?: GitCommit,\n\t): T {\n\t\tlet refs;\n\t\tif (commit === undefined) {\n\t\t\trefs = [...Iterables.filterMap(blame.commits.values(), c => (c.isUncommitted ? undefined : c.ref))];\n\t\t} else {\n\t\t\trefs = [commit.ref];\n\t\t}\n\n\t\tlens.command = command<[ShowCommitsInViewCommandArgs]>({\n\t\t\ttitle: title,\n\t\t\tcommand: refs.length === 0 ? '' : Commands.ShowCommitsInView,\n\t\t\targuments: [\n\t\t\t\t{\n\t\t\t\t\trepoPath: blame.repoPath,\n\t\t\t\t\trefs: refs,\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t\treturn lens;\n\t}\n\n\tprivate applyShowQuickCommitDetailsCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t\tcommit: GitCommit | undefined,\n\t): T {\n\t\tlens.command = command<[Uri, ShowQuickCommitCommandArgs]>({\n\t\t\ttitle: title,\n\t\t\tcommand: commit?.isUncommitted ? '' : CodeLensCommand.ShowQuickCommitDetails,\n\t\t\targuments: [\n\t\t\t\tlens.uri!.toFileUri(),\n\t\t\t\t{\n\t\t\t\t\tcommit: commit,\n\t\t\t\t\tsha: commit === undefined ? undefined : commit.sha,\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t\treturn lens;\n\t}\n\n\tprivate applyShowQuickCommitFileDetailsCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t\tcommit: GitCommit | undefined,\n\t): T {\n\t\tlens.command = command<[Uri, ShowQuickCommitFileCommandArgs]>({\n\t\t\ttitle: title,\n\t\t\tcommand: commit?.isUncommitted ? '' : CodeLensCommand.ShowQuickCommitFileDetails,\n\t\t\targuments: [\n\t\t\t\tlens.uri!.toFileUri(),\n\t\t\t\t{\n\t\t\t\t\tcommit: commit,\n\t\t\t\t\tsha: commit === undefined ? undefined : commit.sha,\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t\treturn lens;\n\t}\n\n\tprivate applyShowQuickCurrentBranchHistoryCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t): T {\n\t\tlens.command = command<[Uri]>({\n\t\t\ttitle: title,\n\t\t\tcommand: CodeLensCommand.ShowQuickCurrentBranchHistory,\n\t\t\targuments: [lens.uri!.toFileUri()],\n\t\t});\n\t\treturn lens;\n\t}\n\n\tprivate applyShowQuickFileHistoryCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t): T {\n\t\tlens.command = command<[Uri, ShowQuickFileHistoryCommandArgs]>({\n\t\t\ttitle: title,\n\t\t\tcommand: CodeLensCommand.ShowQuickFileHistory,\n\t\t\targuments: [\n\t\t\t\tlens.uri!.toFileUri(),\n\t\t\t\t{\n\t\t\t\t\trange: lens.isFullRange ? undefined : lens.blameRange,\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t\treturn lens;\n\t}\n\n\tprivate applyToggleFileBlameCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t): T {\n\t\tlens.command = command<[Uri]>({\n\t\t\ttitle: title,\n\t\t\tcommand: Commands.ToggleFileBlame,\n\t\t\targuments: [lens.uri!.toFileUri()],\n\t\t});\n\t\treturn lens;\n\t}\n\n\tprivate applyToggleFileChangesCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t\tcommit: GitCommit,\n\t\tonly?: boolean,\n\t): T {\n\t\tlens.command = command<[Uri, ToggleFileChangesAnnotationCommandArgs]>({\n\t\t\ttitle: title,\n\t\t\tcommand: Commands.ToggleFileChanges,\n\t\t\targuments: [\n\t\t\t\tlens.uri!.toFileUri(),\n\t\t\t\t{\n\t\t\t\t\ttype: FileAnnotationType.Changes,\n\t\t\t\t\tcontext: { sha: commit.sha, only: only, selection: false },\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t\treturn lens;\n\t}\n\n\tprivate applyToggleFileHeatmapCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t): T {\n\t\tlens.command = command<[Uri]>({\n\t\t\ttitle: title,\n\t\t\tcommand: Commands.ToggleFileHeatmap,\n\t\t\targuments: [lens.uri!.toFileUri()],\n\t\t});\n\t\treturn lens;\n\t}\n\n\tprivate applyCommandWithNoClickAction<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t): T {\n\t\tlens.command = {\n\t\t\ttitle: title,\n\t\t\tcommand: '',\n\t\t};\n\t\treturn lens;\n\t}\n\n\tprivate getDirtyTitle(cfg: CodeLensConfig) {\n\t\tif (cfg.recentChange.enabled && cfg.authors.enabled) {\n\t\t\treturn Container.config.strings.codeLens.unsavedChanges.recentChangeAndAuthors;\n\t\t}\n\t\tif (cfg.recentChange.enabled) return Container.config.strings.codeLens.unsavedChanges.recentChangeOnly;\n\t\treturn Container.config.strings.codeLens.unsavedChanges.authorsOnly;\n\t}\n}\n\nfunction getRangeFromSymbol(symbol: DocumentSymbol | SymbolInformation) {\n\treturn isDocumentSymbol(symbol) ? symbol.range : symbol.location.range;\n}\n\nfunction isDocumentSymbol(symbol: DocumentSymbol | SymbolInformation): symbol is DocumentSymbol {\n\treturn Functions.is<DocumentSymbol>(symbol, 'children');\n}\n","'use strict';\nimport { ConfigurationChangeEvent, Disposable, languages } from 'vscode';\nimport { configuration } from '../configuration';\nimport { ContextKeys, setContext } from '../constants';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport {\n\tDocumentBlameStateChangeEvent,\n\tDocumentDirtyIdleTriggerEvent,\n\tGitDocumentState,\n} from '../trackers/gitDocumentTracker';\nimport { GitCodeLensProvider } from './codeLensProvider';\n\nexport class GitCodeLensController implements Disposable {\n\tprivate _canToggle: boolean = false;\n\tprivate _disposable: Disposable | undefined;\n\tprivate _provider: GitCodeLensProvider | undefined;\n\tprivate _providerDisposable: Disposable | undefined;\n\n\tconstructor() {\n\t\tthis._disposable = Disposable.from(configuration.onDidChange(this.onConfigurationChanged, this));\n\t\tthis.onConfigurationChanged();\n\t}\n\n\tdispose() {\n\t\tthis._providerDisposable?.dispose();\n\t\tthis._disposable?.dispose();\n\t}\n\n\tprivate onConfigurationChanged(e?: ConfigurationChangeEvent) {\n\t\tif (\n\t\t\tconfiguration.changed(e, 'codeLens') ||\n\t\t\tconfiguration.changed(e, 'defaultDateFormat') ||\n\t\t\tconfiguration.changed(e, 'defaultDateSource') ||\n\t\t\tconfiguration.changed(e, 'defaultDateStyle')\n\t\t) {\n\t\t\tif (e != null) {\n\t\t\t\tLogger.log('CodeLens config changed; resetting CodeLens provider');\n\t\t\t}\n\n\t\t\tconst cfg = Container.config.codeLens;\n\t\t\tif (cfg.enabled && (cfg.recentChange.enabled || cfg.authors.enabled)) {\n\t\t\t\tthis.ensureProvider();\n\t\t\t} else {\n\t\t\t\tthis._providerDisposable?.dispose();\n\t\t\t\tthis._provider = undefined;\n\t\t\t}\n\n\t\t\tthis._canToggle = cfg.recentChange.enabled || cfg.authors.enabled;\n\t\t\tvoid setContext(ContextKeys.DisabledToggleCodeLens, !this._canToggle);\n\t\t}\n\t}\n\n\tprivate onBlameStateChanged(e: DocumentBlameStateChangeEvent<GitDocumentState>) {\n\t\t// Only reset if we have saved, since the code lens won't naturally be re-rendered\n\t\tif (this._provider === undefined || !e.blameable) return;\n\n\t\tLogger.log('Blame state changed; resetting CodeLens provider');\n\t\tthis._provider.reset('saved');\n\t}\n\n\tprivate onDirtyIdleTriggered(e: DocumentDirtyIdleTriggerEvent<GitDocumentState>) {\n\t\tif (this._provider === undefined || !e.document.isBlameable) return;\n\n\t\tconst maxLines = Container.config.advanced.blame.sizeThresholdAfterEdit;\n\t\tif (maxLines > 0 && e.document.lineCount > maxLines) return;\n\n\t\tLogger.log('Dirty idle triggered; resetting CodeLens provider');\n\t\tthis._provider.reset('idle');\n\t}\n\n\ttoggleCodeLens() {\n\t\tif (!this._canToggle) return;\n\n\t\tLogger.log('toggleCodeLens()');\n\t\tif (this._provider !== undefined) {\n\t\t\tthis._providerDisposable?.dispose();\n\t\t\tthis._provider = undefined;\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.ensureProvider();\n\t}\n\n\tprivate ensureProvider() {\n\t\tif (this._provider !== undefined) {\n\t\t\tthis._provider.reset();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis._providerDisposable?.dispose();\n\n\t\tthis._provider = new GitCodeLensProvider(Container.context, Container.git, Container.tracker);\n\t\tthis._providerDisposable = Disposable.from(\n\t\t\tlanguages.registerCodeLensProvider(GitCodeLensProvider.selector, this._provider),\n\t\t\tContainer.tracker.onDidChangeBlameState(this.onBlameStateChanged, this),\n\t\t\tContainer.tracker.onDidTriggerDirtyIdle(this.onDirtyIdleTriggered, this),\n\t\t);\n\t}\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tConfigurationChangeEvent,\n\tDisposable,\n\tHover,\n\tlanguages,\n\tPosition,\n\tRange,\n\tTextDocument,\n\tTextEditor,\n\tUri,\n\twindow,\n} from 'vscode';\nimport { UriComparer } from '../comparers';\nimport { configuration, FileAnnotationType } from '../configuration';\nimport { Container } from '../container';\nimport { debug } from '../system';\nimport { LinesChangeEvent } from '../trackers/gitLineTracker';\nimport { Hovers } from './hovers';\n\nexport class LineHoverController implements Disposable {\n\tprivate readonly _disposable: Disposable;\n\tprivate _hoverProviderDisposable: Disposable | undefined;\n\tprivate _uri: Uri | undefined;\n\n\tconstructor() {\n\t\tthis._disposable = Disposable.from(configuration.onDidChange(this.onConfigurationChanged, this));\n\t\tthis.onConfigurationChanged();\n\t}\n\n\tdispose() {\n\t\tthis.unregister();\n\n\t\tContainer.lineTracker.stop(this);\n\t\tthis._disposable.dispose();\n\t}\n\n\tprivate onConfigurationChanged(e?: ConfigurationChangeEvent) {\n\t\tif (!configuration.changed(e, 'hovers.enabled') && !configuration.changed(e, 'hovers.currentLine.enabled')) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (Container.config.hovers.enabled && Container.config.hovers.currentLine.enabled) {\n\t\t\tContainer.lineTracker.start(\n\t\t\t\tthis,\n\t\t\t\tContainer.lineTracker.onDidChangeActiveLines(this.onActiveLinesChanged, this),\n\t\t\t);\n\n\t\t\tthis.register(window.activeTextEditor);\n\t\t} else {\n\t\t\tContainer.lineTracker.stop(this);\n\t\t\tthis.unregister();\n\t\t}\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (e: LinesChangeEvent) =>\n\t\t\t\t`editor=${e.editor?.document.uri.toString(true)}, selections=${e.selections\n\t\t\t\t\t?.map(s => `[${s.anchor}-${s.active}]`)\n\t\t\t\t\t.join(',')}, pending=${Boolean(e.pending)}, reason=${e.reason}`,\n\t\t},\n\t})\n\tprivate onActiveLinesChanged(e: LinesChangeEvent) {\n\t\tif (e.pending) return;\n\n\t\tif (e.editor == null || e.selections == null) {\n\t\t\tthis.unregister();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isRegistered(e.editor?.document.uri)) return;\n\n\t\tthis.register(e.editor);\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: document => document.uri.toString(true),\n\t\t\t1: (position: Position) => `${position.line}:${position.character}`,\n\t\t\t2: () => false,\n\t\t},\n\t})\n\tasync provideDetailsHover(\n\t\tdocument: TextDocument,\n\t\tposition: Position,\n\t\t_token: CancellationToken,\n\t): Promise<Hover | undefined> {\n\t\tif (!Container.lineTracker.includes(position.line)) return undefined;\n\n\t\tconst lineState = Container.lineTracker.getState(position.line);\n\t\tconst commit = lineState?.commit;\n\t\tif (commit == null) return undefined;\n\n\t\t// Avoid double annotations if we are showing the whole-file hover blame annotations\n\t\tif (Container.config.hovers.annotations.details) {\n\t\t\tconst fileAnnotations = await Container.fileAnnotations.getAnnotationType(window.activeTextEditor);\n\t\t\tif (fileAnnotations === FileAnnotationType.Blame) return undefined;\n\t\t}\n\n\t\tconst wholeLine = Container.config.hovers.currentLine.over === 'line';\n\t\t// If we aren't showing the hover over the whole line, make sure the annotation is on\n\t\tif (!wholeLine && Container.lineAnnotations.suspended) return undefined;\n\n\t\tconst range = document.validateRange(\n\t\t\tnew Range(position.line, wholeLine ? 0 : Number.MAX_SAFE_INTEGER, position.line, Number.MAX_SAFE_INTEGER),\n\t\t);\n\t\tif (!wholeLine && range.start.character !== position.character) return undefined;\n\n\t\t// Get the full commit message -- since blame only returns the summary\n\t\tlet logCommit = lineState?.logCommit;\n\t\tif (logCommit == null && !commit.isUncommitted) {\n\t\t\tlogCommit = await Container.git.getCommitForFile(commit.repoPath, commit.uri.fsPath, {\n\t\t\t\tref: commit.sha,\n\t\t\t});\n\t\t\tif (logCommit != null) {\n\t\t\t\t// Preserve the previous commit from the blame commit\n\t\t\t\tlogCommit.previousSha = commit.previousSha;\n\t\t\t\tlogCommit.previousFileName = commit.previousFileName;\n\n\t\t\t\tif (lineState != null) {\n\t\t\t\t\tlineState.logCommit = logCommit;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet editorLine = position.line;\n\t\tconst line = editorLine + 1;\n\t\tconst commitLine = commit.lines.find(l => l.line === line) ?? commit.lines[0];\n\t\teditorLine = commitLine.originalLine - 1;\n\n\t\tconst trackedDocument = await Container.tracker.get(document);\n\t\tif (trackedDocument == null) return undefined;\n\n\t\tconst message = await Hovers.detailsMessage(\n\t\t\tlogCommit ?? commit,\n\t\t\ttrackedDocument.uri,\n\t\t\teditorLine,\n\t\t\tContainer.config.defaultDateFormat,\n\t\t);\n\t\treturn new Hover(message, range);\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: document => document.uri.toString(true),\n\t\t\t1: (position: Position) => `${position.line}:${position.character}`,\n\t\t\t2: () => false,\n\t\t},\n\t})\n\tasync provideChangesHover(\n\t\tdocument: TextDocument,\n\t\tposition: Position,\n\t\t_token: CancellationToken,\n\t): Promise<Hover | undefined> {\n\t\tif (!Container.lineTracker.includes(position.line)) return undefined;\n\n\t\tconst lineState = Container.lineTracker.getState(position.line);\n\t\tconst commit = lineState?.commit;\n\t\tif (commit == null) return undefined;\n\n\t\t// Avoid double annotations if we are showing the whole-file hover blame annotations\n\t\tif (Container.config.hovers.annotations.changes) {\n\t\t\tconst fileAnnotations = await Container.fileAnnotations.getAnnotationType(window.activeTextEditor);\n\t\t\tif (fileAnnotations === FileAnnotationType.Blame) return undefined;\n\t\t}\n\n\t\tconst wholeLine = Container.config.hovers.currentLine.over === 'line';\n\t\t// If we aren't showing the hover over the whole line, make sure the annotation is on\n\t\tif (!wholeLine && Container.lineAnnotations.suspended) return undefined;\n\n\t\tconst range = document.validateRange(\n\t\t\tnew Range(position.line, wholeLine ? 0 : Number.MAX_SAFE_INTEGER, position.line, Number.MAX_SAFE_INTEGER),\n\t\t);\n\t\tif (!wholeLine && range.start.character !== position.character) return undefined;\n\n\t\tconst trackedDocument = await Container.tracker.get(document);\n\t\tif (trackedDocument == null) return undefined;\n\n\t\tconst message = await Hovers.changesMessage(commit, trackedDocument.uri, position.line);\n\t\tif (message == null) return undefined;\n\n\t\treturn new Hover(message, range);\n\t}\n\n\tprivate isRegistered(uri: Uri | undefined) {\n\t\treturn this._hoverProviderDisposable != null && UriComparer.equals(this._uri, uri);\n\t}\n\n\tprivate register(editor: TextEditor | undefined) {\n\t\tthis.unregister();\n\n\t\tif (editor == null) return;\n\n\t\tconst cfg = Container.config.hovers;\n\t\tif (!cfg.enabled || !cfg.currentLine.enabled || (!cfg.currentLine.details && !cfg.currentLine.changes)) return;\n\n\t\tthis._uri = editor.document.uri;\n\n\t\tconst subscriptions = [];\n\t\tif (cfg.currentLine.changes) {\n\t\t\tsubscriptions.push(\n\t\t\t\tlanguages.registerHoverProvider(\n\t\t\t\t\t{ pattern: this._uri.fsPath },\n\t\t\t\t\t{\n\t\t\t\t\t\tprovideHover: this.provideChangesHover.bind(this),\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t\tif (cfg.currentLine.details) {\n\t\t\tsubscriptions.push(\n\t\t\t\tlanguages.registerHoverProvider(\n\t\t\t\t\t{ pattern: this._uri.fsPath },\n\t\t\t\t\t{\n\t\t\t\t\t\tprovideHover: this.provideDetailsHover.bind(this),\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\tthis._hoverProviderDisposable = Disposable.from(...subscriptions);\n\t}\n\n\tprivate unregister() {\n\t\tthis._uri = undefined;\n\t\tif (this._hoverProviderDisposable != null) {\n\t\t\tthis._hoverProviderDisposable.dispose();\n\t\t\tthis._hoverProviderDisposable = undefined;\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands, Disposable } from 'vscode';\nimport { ContextKeys, setContext } from './constants';\nimport { Logger } from './logger';\nimport { log } from './system';\n\nexport declare interface KeyCommand {\n\tonDidPressKey?(key: Keys): void | Promise<void>;\n}\n\nconst keyNoopCommand = Object.create(null) as KeyCommand;\nexport { keyNoopCommand as KeyNoopCommand };\n\nexport const keys = [\n\t'left',\n\t'alt+left',\n\t'ctrl+left',\n\t'right',\n\t'alt+right',\n\t'ctrl+right',\n\t'alt+,',\n\t'alt+.',\n\t'escape',\n] as const;\nexport type Keys = typeof keys[number];\n\nexport type KeyMapping = { [K in Keys]?: KeyCommand | (() => Promise<KeyCommand>) };\ntype IndexableKeyMapping = KeyMapping & {\n\t[index: string]: KeyCommand | (() => Promise<KeyCommand>) | undefined;\n};\n\nconst mappings: KeyMapping[] = [];\n\nexport class KeyboardScope implements Disposable {\n\tprivate readonly _mapping: IndexableKeyMapping;\n\tconstructor(mapping: KeyMapping) {\n\t\tthis._mapping = mapping;\n\t\tfor (const key in this._mapping) {\n\t\t\tthis._mapping[key] = this._mapping[key] ?? keyNoopCommand;\n\t\t}\n\n\t\tmappings.push(this._mapping);\n\t}\n\n\t@log({\n\t\targs: false,\n\t\tprefix: context => `${context.prefix}[${mappings.length}]`,\n\t})\n\tasync dispose() {\n\t\tconst index = mappings.indexOf(this._mapping);\n\n\t\tconst cc = Logger.getCorrelationContext();\n\t\tif (cc != null) {\n\t\t\tcc.exitDetails = ` \\u2022 index=${index}`;\n\t\t}\n\n\t\tif (index === mappings.length - 1) {\n\t\t\tmappings.pop();\n\t\t\tawait this.updateKeyCommandsContext(mappings[mappings.length - 1]);\n\t\t} else {\n\t\t\tmappings.splice(index, 1);\n\t\t}\n\t}\n\n\tprivate _paused = true;\n\tget paused() {\n\t\treturn this._paused;\n\t}\n\n\t@log<KeyboardScope['clearKeyCommand']>({\n\t\targs: false,\n\t\tprefix: (context, key) => `${context.prefix}[${mappings.length}](${key})`,\n\t})\n\tasync clearKeyCommand(key: Keys) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tconst mapping = mappings[mappings.length - 1];\n\t\tif (mapping !== this._mapping || mapping[key] == null) {\n\t\t\tif (cc != null) {\n\t\t\t\tcc.exitDetails = ' \\u2022 skipped';\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tmapping[key] = undefined;\n\t\tawait setContext(`${ContextKeys.Key}:${key}`, false);\n\t}\n\n\t@log({\n\t\targs: false,\n\t\tprefix: context => `${context.prefix}(paused=${context.instance._paused})`,\n\t})\n\tasync pause(keys?: Keys[]) {\n\t\tif (this._paused) return;\n\n\t\tthis._paused = true;\n\t\tconst mapping = (Object.keys(this._mapping) as Keys[]).reduce((accumulator, key) => {\n\t\t\taccumulator[key] = keys == null || keys.includes(key) ? undefined : this._mapping[key];\n\t\t\treturn accumulator;\n\t\t}, Object.create(null) as KeyMapping);\n\n\t\tawait this.updateKeyCommandsContext(mapping);\n\t}\n\n\t@log({\n\t\targs: false,\n\t\tprefix: context => `${context.prefix}(paused=${context.instance._paused})`,\n\t})\n\tasync resume() {\n\t\tif (!this._paused) return;\n\n\t\tthis._paused = false;\n\t\tawait this.updateKeyCommandsContext(this._mapping);\n\t}\n\n\tasync start() {\n\t\tawait this.resume();\n\t}\n\n\t@log<KeyboardScope['setKeyCommand']>({\n\t\targs: false,\n\t\tprefix: (context, key) => `${context.prefix}[${mappings.length}](${key})`,\n\t})\n\tasync setKeyCommand(key: Keys, command: KeyCommand | (() => Promise<KeyCommand>)) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tconst mapping = mappings[mappings.length - 1];\n\t\tif (mapping !== this._mapping) {\n\t\t\tif (cc != null) {\n\t\t\t\tcc.exitDetails = ' \\u2022 skipped';\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst set = Boolean(mapping[key]);\n\n\t\tmapping[key] = command;\n\t\tif (!set) {\n\t\t\tawait setContext(`${ContextKeys.Key}:${key}`, true);\n\t\t}\n\t}\n\n\tprivate async updateKeyCommandsContext(mapping: KeyMapping) {\n\t\tawait Promise.all(keys.map(key => setContext(`${ContextKeys.Key}:${key}`, Boolean(mapping?.[key]))));\n\t}\n}\n\nexport class Keyboard implements Disposable {\n\tprivate readonly _disposable: Disposable;\n\n\tconstructor() {\n\t\tconst subscriptions = keys.map(key =>\n\t\t\tcommands.registerCommand(`gitlens.key.${key}`, () => this.execute(key), this),\n\t\t);\n\t\tthis._disposable = Disposable.from(...subscriptions);\n\t}\n\n\tdispose() {\n\t\tthis._disposable.dispose();\n\t}\n\n\t@log<Keyboard['createScope']>({\n\t\targs: false,\n\t\tprefix: (context, mapping) =>\n\t\t\t`${context.prefix}[${mappings.length}](${mapping === undefined ? '' : Object.keys(mapping).join(',')})`,\n\t})\n\tcreateScope(mapping?: KeyMapping): KeyboardScope {\n\t\treturn new KeyboardScope({ ...mapping });\n\t}\n\n\t@log<Keyboard['beginScope']>({\n\t\targs: false,\n\t\tprefix: (context, mapping) =>\n\t\t\t`${context.prefix}[${mappings.length}](${mapping === undefined ? '' : Object.keys(mapping).join(',')})`,\n\t})\n\tasync beginScope(mapping?: KeyMapping): Promise<KeyboardScope> {\n\t\tconst scope = this.createScope(mapping);\n\t\tawait scope.start();\n\t\treturn scope;\n\t}\n\n\t@log()\n\tasync execute(key: Keys): Promise<void> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tif (!mappings.length) {\n\t\t\tif (cc != null) {\n\t\t\t\tcc.exitDetails = ' \\u2022 skipped, no mappings';\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tconst mapping = mappings[mappings.length - 1];\n\n\t\t\tlet command = mapping[key] as KeyCommand | (() => Promise<KeyCommand>);\n\t\t\tif (typeof command === 'function') {\n\t\t\t\tcommand = await command();\n\t\t\t}\n\t\t\tif (typeof command?.onDidPressKey !== 'function') {\n\t\t\t\tif (cc != null) {\n\t\t\t\t\tcc.exitDetails = ' \\u2022 skipped, no callback';\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvoid (await command.onDidPressKey(key));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\t\t}\n\t}\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tCancellationTokenSource,\n\tConfigurationChangeEvent,\n\tDisposable,\n\tStatusBarAlignment,\n\tStatusBarItem,\n\tTextEditor,\n\tUri,\n\twindow,\n} from 'vscode';\nimport { command, Commands, ToggleFileChangesAnnotationCommandArgs } from '../commands';\nimport { configuration, FileAnnotationType, StatusBarCommand } from '../configuration';\nimport { GlyphChars, isTextEditor } from '../constants';\nimport { Container } from '../container';\nimport { CommitFormatter, GitBlameCommit, PullRequest } from '../git/git';\nimport { LogCorrelationContext, Logger } from '../logger';\nimport { debug, Promises } from '../system';\nimport { LinesChangeEvent } from '../trackers/gitLineTracker';\n\nexport class StatusBarController implements Disposable {\n\tprivate _cancellation: CancellationTokenSource | undefined;\n\tprivate readonly _disposable: Disposable;\n\tprivate _statusBarBlame: StatusBarItem | undefined;\n\tprivate _statusBarMode: StatusBarItem | undefined;\n\n\tconstructor() {\n\t\tthis._disposable = Disposable.from(configuration.onDidChange(this.onConfigurationChanged, this));\n\t\tthis.onConfigurationChanged();\n\t}\n\n\tdispose() {\n\t\tthis.clearBlame();\n\n\t\tthis._statusBarBlame?.dispose();\n\t\tthis._statusBarMode?.dispose();\n\n\t\tContainer.lineTracker.stop(this);\n\t\tthis._disposable.dispose();\n\t}\n\n\tprivate onConfigurationChanged(e?: ConfigurationChangeEvent) {\n\t\tif (configuration.changed(e, 'mode')) {\n\t\t\tconst mode =\n\t\t\t\tContainer.config.mode.active && Container.config.mode.statusBar.enabled\n\t\t\t\t\t? Container.config.modes?.[Container.config.mode.active]\n\t\t\t\t\t: undefined;\n\t\t\tif (mode?.statusBarItemName) {\n\t\t\t\tconst alignment =\n\t\t\t\t\tContainer.config.mode.statusBar.alignment !== 'left'\n\t\t\t\t\t\t? StatusBarAlignment.Right\n\t\t\t\t\t\t: StatusBarAlignment.Left;\n\n\t\t\t\tif (configuration.changed(e, 'mode.statusBar.alignment')) {\n\t\t\t\t\tif (this._statusBarMode?.alignment !== alignment) {\n\t\t\t\t\t\tthis._statusBarMode?.dispose();\n\t\t\t\t\t\tthis._statusBarMode = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._statusBarMode =\n\t\t\t\t\tthis._statusBarMode ??\n\t\t\t\t\twindow.createStatusBarItem(\n\t\t\t\t\t\t'gitlens.mode',\n\t\t\t\t\t\talignment,\n\t\t\t\t\t\talignment === StatusBarAlignment.Right ? 999 : 1,\n\t\t\t\t\t);\n\t\t\t\tthis._statusBarMode.name = 'GitLens Modes';\n\t\t\t\tthis._statusBarMode.command = Commands.SwitchMode;\n\t\t\t\tthis._statusBarMode.text = mode.statusBarItemName;\n\t\t\t\tthis._statusBarMode.tooltip = 'Switch GitLens Mode';\n\t\t\t\tthis._statusBarMode.show();\n\t\t\t} else {\n\t\t\t\tthis._statusBarMode?.dispose();\n\t\t\t\tthis._statusBarMode = undefined;\n\t\t\t}\n\t\t}\n\n\t\tif (!configuration.changed(e, 'statusBar')) return;\n\n\t\tif (Container.config.statusBar.enabled) {\n\t\t\tconst alignment =\n\t\t\t\tContainer.config.statusBar.alignment !== 'left' ? StatusBarAlignment.Right : StatusBarAlignment.Left;\n\n\t\t\tif (configuration.changed(e, 'statusBar.alignment')) {\n\t\t\t\tif (this._statusBarBlame?.alignment !== alignment) {\n\t\t\t\t\tthis._statusBarBlame?.dispose();\n\t\t\t\t\tthis._statusBarBlame = undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._statusBarBlame =\n\t\t\t\tthis._statusBarBlame ??\n\t\t\t\twindow.createStatusBarItem(\n\t\t\t\t\t'gitlens.blame',\n\t\t\t\t\talignment,\n\t\t\t\t\talignment === StatusBarAlignment.Right ? 1000 : 0,\n\t\t\t\t);\n\t\t\tthis._statusBarBlame.name = 'GitLens Current Line Blame';\n\t\t\tthis._statusBarBlame.command = Container.config.statusBar.command;\n\n\t\t\tif (configuration.changed(e, 'statusBar.enabled')) {\n\t\t\t\tContainer.lineTracker.start(\n\t\t\t\t\tthis,\n\t\t\t\t\tContainer.lineTracker.onDidChangeActiveLines(this.onActiveLinesChanged, this),\n\t\t\t\t);\n\t\t\t}\n\t\t} else if (configuration.changed(e, 'statusBar.enabled')) {\n\t\t\tContainer.lineTracker.stop(this);\n\n\t\t\tthis._statusBarBlame?.dispose();\n\t\t\tthis._statusBarBlame = undefined;\n\t\t}\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (e: LinesChangeEvent) =>\n\t\t\t\t`editor=${e.editor?.document.uri.toString(true)}, selections=${e.selections\n\t\t\t\t\t?.map(s => `[${s.anchor}-${s.active}]`)\n\t\t\t\t\t.join(',')}, pending=${Boolean(e.pending)}, reason=${e.reason}`,\n\t\t},\n\t})\n\tprivate onActiveLinesChanged(e: LinesChangeEvent) {\n\t\t// If we need to reduceFlicker, don't clear if only the selected lines changed\n\t\tlet clear = !(\n\t\t\tContainer.config.statusBar.reduceFlicker &&\n\t\t\te.reason === 'selection' &&\n\t\t\t(e.pending || e.selections != null)\n\t\t);\n\t\tif (!e.pending && e.selections != null) {\n\t\t\tconst state = Container.lineTracker.getState(e.selections[0].active);\n\t\t\tif (state?.commit != null) {\n\t\t\t\tvoid this.updateBlame(e.editor!, state.commit);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tclear = true;\n\t\t}\n\n\t\tif (clear) {\n\t\t\tthis.clearBlame();\n\t\t} else if (this._statusBarBlame != null) {\n\t\t\tthis._statusBarBlame.text = this._statusBarBlame.text.replace('$(git-commit)', '$(loading~spin)');\n\t\t}\n\t}\n\n\tclearBlame() {\n\t\tthis._cancellation?.cancel();\n\t\tthis._statusBarBlame?.hide();\n\t}\n\n\t@debug({ args: false })\n\tprivate async updateBlame(editor: TextEditor, commit: GitBlameCommit, options?: { pr?: PullRequest | null }) {\n\t\tconst cfg = Container.config.statusBar;\n\t\tif (!cfg.enabled || this._statusBarBlame == null || !isTextEditor(editor)) return;\n\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\t// TODO: Make this configurable?\n\t\tconst timeout = 100;\n\t\tconst [getBranchAndTagTips, pr] = await Promise.all([\n\t\t\tCommitFormatter.has(cfg.format, 'tips')\n\t\t\t\t? Container.git.getBranchesAndTagsTipsFn(commit.repoPath)\n\t\t\t\t: undefined,\n\t\t\tcfg.pullRequests.enabled &&\n\t\t\tCommitFormatter.has(\n\t\t\t\tcfg.format,\n\t\t\t\t'pullRequest',\n\t\t\t\t'pullRequestAgo',\n\t\t\t\t'pullRequestAgoOrDate',\n\t\t\t\t'pullRequestDate',\n\t\t\t\t'pullRequestState',\n\t\t\t) &&\n\t\t\toptions?.pr === undefined\n\t\t\t\t? this.getPullRequest(commit, { timeout: timeout })\n\t\t\t\t: options?.pr ?? undefined,\n\t\t]);\n\n\t\tif (pr != null) {\n\t\t\tthis._cancellation?.cancel();\n\t\t\tthis._cancellation = new CancellationTokenSource();\n\t\t\tvoid this.waitForPendingPullRequest(editor, commit, pr, this._cancellation.token, timeout, cc);\n\t\t}\n\n\t\tthis._statusBarBlame.text = `$(git-commit) ${CommitFormatter.fromTemplate(cfg.format, commit, {\n\t\t\tdateFormat: cfg.dateFormat === null ? Container.config.defaultDateFormat : cfg.dateFormat,\n\t\t\tgetBranchAndTagTips: getBranchAndTagTips,\n\t\t\tmessageTruncateAtNewLine: true,\n\t\t\tpullRequestOrRemote: pr,\n\t\t\tpullRequestPendingMessage: 'PR $(loading~spin)',\n\t\t})}`;\n\n\t\tswitch (cfg.command) {\n\t\t\tcase StatusBarCommand.CopyRemoteCommitUrl:\n\t\t\t\tthis._statusBarBlame.tooltip = 'Copy Remote Commit Url';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.CopyRemoteFileUrl:\n\t\t\t\tthis._statusBarBlame.command = Commands.CopyRemoteFileUrl;\n\t\t\t\tthis._statusBarBlame.tooltip = 'Copy Remote File Revision Url';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.DiffWithPrevious:\n\t\t\t\tthis._statusBarBlame.command = Commands.DiffLineWithPrevious;\n\t\t\t\tthis._statusBarBlame.tooltip = 'Open Line Changes with Previous Revision';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.DiffWithWorking:\n\t\t\t\tthis._statusBarBlame.command = Commands.DiffLineWithWorking;\n\t\t\t\tthis._statusBarBlame.tooltip = 'Open Line Changes with Working File';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.OpenCommitOnRemote:\n\t\t\t\tthis._statusBarBlame.tooltip = 'Open Commit on Remote';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.OpenFileOnRemote:\n\t\t\t\tthis._statusBarBlame.tooltip = 'Open Revision on Remote';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.RevealCommitInView:\n\t\t\t\tthis._statusBarBlame.tooltip = 'Reveal Commit in the Side Bar';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.ShowCommitsInView:\n\t\t\t\tthis._statusBarBlame.tooltip = 'Search for Commit';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.ShowQuickCommitDetails:\n\t\t\t\tthis._statusBarBlame.tooltip = 'Show Commit';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.ShowQuickCommitFileDetails:\n\t\t\t\tthis._statusBarBlame.tooltip = 'Show Commit (file)';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.ShowQuickCurrentBranchHistory:\n\t\t\t\tthis._statusBarBlame.tooltip = 'Show Branch History';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.ShowQuickFileHistory:\n\t\t\t\tthis._statusBarBlame.tooltip = 'Show File History';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.ToggleCodeLens:\n\t\t\t\tthis._statusBarBlame.tooltip = 'Toggle Git CodeLens';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.ToggleFileBlame:\n\t\t\t\tthis._statusBarBlame.tooltip = 'Toggle File Blame';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.ToggleFileChanges: {\n\t\t\t\tthis._statusBarBlame.command = command<[Uri, ToggleFileChangesAnnotationCommandArgs]>({\n\t\t\t\t\ttitle: 'Toggle File Changes',\n\t\t\t\t\tcommand: Commands.ToggleFileChanges,\n\t\t\t\t\targuments: [\n\t\t\t\t\t\tcommit.uri,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: FileAnnotationType.Changes,\n\t\t\t\t\t\t\tcontext: { sha: commit.sha, only: false, selection: false },\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t\tthis._statusBarBlame.tooltip = 'Toggle File Changes';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase StatusBarCommand.ToggleFileChangesOnly: {\n\t\t\t\tthis._statusBarBlame.command = command<[Uri, ToggleFileChangesAnnotationCommandArgs]>({\n\t\t\t\t\ttitle: 'Toggle File Changes',\n\t\t\t\t\tcommand: Commands.ToggleFileChanges,\n\t\t\t\t\targuments: [\n\t\t\t\t\t\tcommit.uri,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: FileAnnotationType.Changes,\n\t\t\t\t\t\t\tcontext: { sha: commit.sha, only: true, selection: false },\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t\tthis._statusBarBlame.tooltip = 'Toggle File Changes';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase StatusBarCommand.ToggleFileHeatmap:\n\t\t\t\tthis._statusBarBlame.tooltip = 'Toggle File Heatmap';\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis._statusBarBlame.show();\n\t}\n\n\tprivate async getPullRequest(commit: GitBlameCommit, { timeout }: { timeout?: number } = {}) {\n\t\tconst remote = await Container.git.getRichRemoteProvider(commit.repoPath);\n\t\tif (remote?.provider == null) return undefined;\n\n\t\tconst { provider } = remote;\n\t\ttry {\n\t\t\treturn await Container.git.getPullRequestForCommit(commit.ref, provider, { timeout: timeout });\n\t\t} catch (ex) {\n\t\t\treturn ex;\n\t\t}\n\t}\n\n\tprivate async waitForPendingPullRequest(\n\t\teditor: TextEditor,\n\t\tcommit: GitBlameCommit,\n\t\tpr: PullRequest | Promises.CancellationError<Promise<PullRequest | undefined>> | undefined,\n\t\tcancellationToken: CancellationToken,\n\t\ttimeout: number,\n\t\tcc: LogCorrelationContext | undefined,\n\t) {\n\t\tif (cancellationToken.isCancellationRequested || !(pr instanceof Promises.CancellationError)) return;\n\n\t\t// If the PR timed out, refresh the status bar once it completes\n\t\tLogger.debug(cc, `${GlyphChars.Dot} pull request query took too long (over ${timeout} ms)`);\n\n\t\tpr = await pr.promise;\n\n\t\tif (cancellationToken.isCancellationRequested) return;\n\n\t\tLogger.debug(cc, `${GlyphChars.Dot} pull request query completed; refreshing...`);\n\n\t\tvoid this.updateBlame(editor, commit, { pr: pr ?? null });\n\t}\n}\n","'use strict';\nimport { commands, Disposable, TerminalLink, TerminalLinkContext, TerminalLinkProvider, window } from 'vscode';\nimport {\n\tCommands,\n\tGitCommandsCommandArgs,\n\tShowQuickBranchHistoryCommandArgs,\n\tShowQuickCommitCommandArgs,\n} from '../commands';\nimport { Container } from '../container';\nimport { GitReference } from '../git/git';\n\nconst commandsRegexShared =\n\t/\\b(g(?:it)?\\b\\s*)\\b(branch|checkout|cherry-pick|fetch|grep|log|merge|pull|push|rebase|reset|revert|show|stash|status|tag)\\b/gi;\n// Since negative lookbehind isn't supported in all browsers, leave out the negative lookbehind condition `(?<!\\.lock)` to ensure the branch name doesn't end with `.lock`\nconst refRegexShared = /\\b((?!\\/)(?!\\S*\\/\\/)(?!\\S*@\\{)(?!@$)(?!\\S*\\\\)[^\\000-\\037\\177 ~^:?*[]+(?<!\\/)(?<!\\.))\\b/gi;\nconst rangeRegex = /^[0-9a-f]{7,40}\\.\\.\\.?[0-9a-f]{7,40}$/;\nconst shaRegex = /^[0-9a-f]{7,40}$/;\n\ninterface GitTerminalLink<T = object> extends TerminalLink {\n\tcommand: {\n\t\tcommand: Commands;\n\t\targs: T;\n\t};\n}\n\nexport class GitTerminalLinkProvider implements Disposable, TerminalLinkProvider<GitTerminalLink> {\n\tprivate disposable: Disposable;\n\n\tconstructor() {\n\t\tthis.disposable = window.registerTerminalLinkProvider(this);\n\t}\n\n\tdispose() {\n\t\tthis.disposable.dispose();\n\t}\n\n\tasync provideTerminalLinks(context: TerminalLinkContext): Promise<GitTerminalLink[]> {\n\t\tif (context.line.trim().length === 0) return [];\n\n\t\tconst repoPath = Container.git.getHighlanderRepoPath();\n\t\tif (repoPath == null) return [];\n\n\t\tconst links: GitTerminalLink[] = [];\n\n\t\tconst branchesAndTags = await Container.git.getBranchesAndOrTags(repoPath);\n\n\t\t// Don't use the shared regex instance directly, because we can be called reentrantly (because of the awaits below)\n\t\tconst refRegex = new RegExp(refRegexShared, refRegexShared.flags);\n\t\tconst commandsRegex = new RegExp(commandsRegexShared, commandsRegexShared.flags);\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = commandsRegex.exec(context.line);\n\t\t\tif (match != null) {\n\t\t\t\tconst [_, git, command] = match;\n\n\t\t\t\tconst link: GitTerminalLink<GitCommandsCommandArgs> = {\n\t\t\t\t\tstartIndex: match.index + git.length,\n\t\t\t\t\tlength: command.length,\n\t\t\t\t\ttooltip: 'Open in Git Command Palette',\n\t\t\t\t\tcommand: {\n\t\t\t\t\t\tcommand: Commands.GitCommands,\n\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\tcommand: command as GitCommandsCommandArgs['command'],\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t\tlinks.push(link);\n\t\t\t}\n\n\t\t\tmatch = refRegex.exec(context.line);\n\t\t\tif (match == null) break;\n\n\t\t\tconst [_, ref] = match;\n\n\t\t\tif (ref.toUpperCase() === 'HEAD') {\n\t\t\t\tconst link: GitTerminalLink<ShowQuickBranchHistoryCommandArgs> = {\n\t\t\t\t\tstartIndex: match.index,\n\t\t\t\t\tlength: ref.length,\n\t\t\t\t\ttooltip: 'Show HEAD',\n\t\t\t\t\tcommand: {\n\t\t\t\t\t\tcommand: Commands.ShowQuickBranchHistory,\n\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\tbranch: 'HEAD',\n\t\t\t\t\t\t\trepoPath: repoPath,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t\tlinks.push(link);\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst branchOrTag = branchesAndTags?.find(r => r.name === ref);\n\t\t\tif (branchOrTag != null) {\n\t\t\t\tconst link: GitTerminalLink<ShowQuickBranchHistoryCommandArgs> = {\n\t\t\t\t\tstartIndex: match.index,\n\t\t\t\t\tlength: ref.length,\n\t\t\t\t\ttooltip: branchOrTag.refType === 'branch' ? 'Show Branch' : 'Show Tag',\n\t\t\t\t\tcommand: {\n\t\t\t\t\t\tcommand: Commands.ShowQuickBranchHistory,\n\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\tbranch: branchOrTag.refType === 'branch' ? branchOrTag.name : undefined,\n\t\t\t\t\t\t\ttag: branchOrTag.refType === 'tag' ? branchOrTag.name : undefined,\n\t\t\t\t\t\t\trepoPath: repoPath,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t\tlinks.push(link);\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (!shaRegex.test(ref)) {\n\t\t\t\tif (rangeRegex.test(ref)) {\n\t\t\t\t\tconst link: GitTerminalLink<GitCommandsCommandArgs> = {\n\t\t\t\t\t\tstartIndex: match.index,\n\t\t\t\t\t\tlength: ref.length,\n\t\t\t\t\t\ttooltip: 'Show Commits',\n\t\t\t\t\t\tcommand: {\n\t\t\t\t\t\t\tcommand: Commands.GitCommands,\n\t\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t\tcommand: 'log',\n\t\t\t\t\t\t\t\tstate: {\n\t\t\t\t\t\t\t\t\trepo: repoPath,\n\t\t\t\t\t\t\t\t\treference: GitReference.create(ref, repoPath, { refType: 'revision' }),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t\tlinks.push(link);\n\t\t\t\t}\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (await Container.git.validateReference(repoPath, ref)) {\n\t\t\t\tconst link: GitTerminalLink<ShowQuickCommitCommandArgs> = {\n\t\t\t\t\tstartIndex: match.index,\n\t\t\t\t\tlength: ref.length,\n\t\t\t\t\ttooltip: 'Show Commit',\n\t\t\t\t\tcommand: {\n\t\t\t\t\t\tcommand: Commands.ShowQuickCommit,\n\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\trepoPath: repoPath,\n\t\t\t\t\t\t\tsha: ref,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t\tlinks.push(link);\n\t\t\t}\n\t\t} while (true);\n\n\t\treturn links;\n\t}\n\n\thandleTerminalLink(link: GitTerminalLink): void {\n\t\tvoid commands.executeCommand(link.command.command, link.command.args);\n\t}\n}\n","'use strict';\nimport { Disposable, Event, EventEmitter, Selection, TextEditor, TextEditorSelectionChangeEvent, window } from 'vscode';\nimport { isTextEditor } from '../constants';\nimport { debug, Functions } from '../system';\n\nexport interface LinesChangeEvent {\n\treadonly editor: TextEditor | undefined;\n\treadonly selections: LineSelection[] | undefined;\n\n\treadonly reason: 'editor' | 'selection';\n\treadonly pending?: boolean;\n}\n\nexport interface LineSelection {\n\tanchor: number;\n\tactive: number;\n}\n\nexport class LineTracker<T> implements Disposable {\n\tprivate _onDidChangeActiveLines = new EventEmitter<LinesChangeEvent>();\n\tget onDidChangeActiveLines(): Event<LinesChangeEvent> {\n\t\treturn this._onDidChangeActiveLines.event;\n\t}\n\n\tprotected _disposable: Disposable | undefined;\n\tprivate _editor: TextEditor | undefined;\n\n\tprivate readonly _state = new Map<number, T | undefined>();\n\n\tdispose() {\n\t\tfor (const subscriber of this._subscriptions.keys()) {\n\t\t\tthis.stop(subscriber);\n\t\t}\n\t}\n\n\tprivate onActiveTextEditorChanged(editor: TextEditor | undefined) {\n\t\tif (this._editor === editor) return;\n\t\tif (editor !== undefined && !isTextEditor(editor)) return;\n\n\t\tthis.reset();\n\t\tthis._editor = editor;\n\t\tthis._selections = LineTracker.toLineSelections(editor?.selections);\n\n\t\tthis.trigger('editor');\n\t}\n\n\tprivate onTextEditorSelectionChanged(e: TextEditorSelectionChangeEvent) {\n\t\t// If this isn't for our cached editor and its not a real editor -- kick out\n\t\tif (this._editor !== e.textEditor && !isTextEditor(e.textEditor)) return;\n\n\t\tconst selections = LineTracker.toLineSelections(e.selections);\n\t\tif (this._editor === e.textEditor && this.includes(selections)) return;\n\n\t\tthis.reset();\n\t\tthis._editor = e.textEditor;\n\t\tthis._selections = selections;\n\n\t\tthis.trigger(this._editor === e.textEditor ? 'selection' : 'editor');\n\t}\n\n\tgetState(line: number): T | undefined {\n\t\treturn this._state.get(line);\n\t}\n\n\tsetState(line: number, state: T | undefined) {\n\t\tthis._state.set(line, state);\n\t}\n\n\tprivate _selections: LineSelection[] | undefined;\n\tget selections(): LineSelection[] | undefined {\n\t\treturn this._selections;\n\t}\n\n\tincludes(selections: LineSelection[]): boolean;\n\tincludes(line: number, options?: { activeOnly: boolean }): boolean;\n\tincludes(lineOrSelections: number | LineSelection[], options?: { activeOnly: boolean }): boolean {\n\t\tif (Array.isArray(lineOrSelections)) {\n\t\t\treturn LineTracker.includes(lineOrSelections, this._selections);\n\t\t}\n\n\t\tif (this._selections == null || this._selections.length === 0) return false;\n\n\t\tconst line = lineOrSelections;\n\t\tconst activeOnly = options?.activeOnly ?? true;\n\n\t\tfor (const selection of this._selections) {\n\t\t\tif (\n\t\t\t\tline === selection.active ||\n\t\t\t\t(!activeOnly &&\n\t\t\t\t\t((selection.anchor >= line && line >= selection.active) ||\n\t\t\t\t\t\t(selection.active >= line && line >= selection.anchor)))\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\trefresh() {\n\t\tthis.trigger('editor');\n\t}\n\n\treset() {\n\t\tthis._state.clear();\n\t}\n\n\tprivate _subscriptions = new Map<any, Disposable[]>();\n\n\tisSubscribed(subscriber: any) {\n\t\treturn this._subscriptions.has(subscriber);\n\t}\n\n\tprotected onStart?(): Disposable | undefined;\n\n\t@debug({ args: false })\n\tstart(subscriber: any, subscription: Disposable): Disposable {\n\t\tconst disposable = {\n\t\t\tdispose: () => this.stop(subscriber),\n\t\t};\n\n\t\tconst first = this._subscriptions.size === 0;\n\n\t\tlet subs = this._subscriptions.get(subscriber);\n\t\tif (subs === undefined) {\n\t\t\tsubs = [subscription];\n\t\t\tthis._subscriptions.set(subscriber, subs);\n\t\t} else {\n\t\t\tsubs.push(subscription);\n\t\t}\n\n\t\tif (first) {\n\t\t\tthis._disposable = Disposable.from(\n\t\t\t\twindow.onDidChangeActiveTextEditor(Functions.debounce(this.onActiveTextEditorChanged, 0), this),\n\t\t\t\twindow.onDidChangeTextEditorSelection(this.onTextEditorSelectionChanged, this),\n\t\t\t\tthis.onStart?.() ?? { dispose: () => {} },\n\t\t\t);\n\n\t\t\tsetImmediate(() => this.onActiveTextEditorChanged(window.activeTextEditor));\n\t\t}\n\n\t\treturn disposable;\n\t}\n\n\t@debug({ args: false })\n\tstop(subscriber: any) {\n\t\tconst subs = this._subscriptions.get(subscriber);\n\t\tif (subs === undefined) return;\n\n\t\tthis._subscriptions.delete(subscriber);\n\t\tfor (const sub of subs) {\n\t\t\tsub.dispose();\n\t\t}\n\n\t\tif (this._subscriptions.size !== 0) return;\n\n\t\tif (this._linesChangedDebounced !== undefined) {\n\t\t\tthis._linesChangedDebounced.cancel();\n\t\t}\n\n\t\tif (this._disposable !== undefined) {\n\t\t\tthis._disposable.dispose();\n\t\t\tthis._disposable = undefined;\n\t\t}\n\t}\n\n\tprivate _suspended = false;\n\tget suspended() {\n\t\treturn this._suspended;\n\t}\n\n\tprotected onResume?(): void;\n\n\t@debug()\n\tresume(options: { force?: boolean } = {}) {\n\t\tif (!options.force && !this._suspended) return;\n\n\t\tthis._suspended = false;\n\t\tvoid this.onResume?.();\n\t\tthis.trigger('editor');\n\t}\n\n\tprotected onSuspend?(): void;\n\n\t@debug()\n\tsuspend(options: { force?: boolean } = {}) {\n\t\tif (!options.force && this._suspended) return;\n\n\t\tthis._suspended = true;\n\t\tvoid this.onSuspend?.();\n\t\tthis.trigger('editor');\n\t}\n\n\tprotected fireLinesChanged(e: LinesChangeEvent) {\n\t\tthis._onDidChangeActiveLines.fire(e);\n\t}\n\n\tprotected trigger(reason: 'editor' | 'selection') {\n\t\tthis.onLinesChanged({ editor: this._editor, selections: this.selections, reason: reason });\n\t}\n\n\tprivate _linesChangedDebounced: Functions.Deferrable<(e: LinesChangeEvent) => void> | undefined;\n\n\tprivate onLinesChanged(e: LinesChangeEvent) {\n\t\tif (e.selections === undefined) {\n\t\t\tsetImmediate(() => {\n\t\t\t\tif (window.activeTextEditor !== e.editor) return;\n\n\t\t\t\tif (this._linesChangedDebounced !== undefined) {\n\t\t\t\t\tthis._linesChangedDebounced.cancel();\n\t\t\t\t}\n\n\t\t\t\tvoid this.fireLinesChanged(e);\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._linesChangedDebounced === undefined) {\n\t\t\tthis._linesChangedDebounced = Functions.debounce(\n\t\t\t\t(e: LinesChangeEvent) => {\n\t\t\t\t\tif (window.activeTextEditor !== e.editor) return;\n\t\t\t\t\t// Make sure we are still on the same lines\n\t\t\t\t\tif (!LineTracker.includes(e.selections, LineTracker.toLineSelections(e.editor?.selections))) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvoid this.fireLinesChanged(e);\n\t\t\t\t},\n\t\t\t\t250,\n\t\t\t\t{ track: true },\n\t\t\t);\n\t\t}\n\n\t\t// If we have no pending moves, then fire an immediate pending event, and defer the real event\n\t\tif (!this._linesChangedDebounced.pending!()) {\n\t\t\tvoid this.fireLinesChanged({ ...e, pending: true });\n\t\t}\n\n\t\tthis._linesChangedDebounced(e);\n\t}\n\n\tstatic includes(selections: LineSelection[] | undefined, inSelections: LineSelection[] | undefined): boolean {\n\t\tif (selections == null && inSelections == null) return true;\n\t\tif (selections == null || inSelections == null || selections.length !== inSelections.length) return false;\n\n\t\tlet match;\n\n\t\treturn selections.every((s, i) => {\n\t\t\tmatch = inSelections[i];\n\t\t\treturn s.active === match.active && s.anchor === match.anchor;\n\t\t});\n\t}\n\n\tstatic toLineSelections(selections: readonly Selection[]): LineSelection[];\n\tstatic toLineSelections(selections: readonly Selection[] | undefined): LineSelection[] | undefined;\n\tstatic toLineSelections(selections: readonly Selection[] | undefined) {\n\t\treturn selections?.map(s => ({ active: s.active.line, anchor: s.anchor.line }));\n\t}\n}\n","'use strict';\nimport { Disposable, TextEditor } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitBlameCommit, GitLogCommit } from '../git/git';\nimport { Logger } from '../logger';\nimport { debug } from '../system';\nimport {\n\tDocumentBlameStateChangeEvent,\n\tDocumentContentChangeEvent,\n\tDocumentDirtyIdleTriggerEvent,\n\tDocumentDirtyStateChangeEvent,\n\tGitDocumentState,\n} from './gitDocumentTracker';\nimport { LinesChangeEvent, LineSelection, LineTracker } from './lineTracker';\n\nexport * from './lineTracker';\n\nexport class GitLineState {\n\tconstructor(public readonly commit: GitBlameCommit | undefined, public logCommit?: GitLogCommit) {}\n}\n\nexport class GitLineTracker extends LineTracker<GitLineState> {\n\tprotected override async fireLinesChanged(e: LinesChangeEvent) {\n\t\tthis.reset();\n\n\t\tlet updated = false;\n\t\tif (!this.suspended && !e.pending && e.selections != null && e.editor != null) {\n\t\t\tupdated = await this.updateState(e.selections, e.editor);\n\t\t}\n\n\t\treturn super.fireLinesChanged(updated ? e : { ...e, selections: undefined });\n\t}\n\n\tprivate _subscriptionOnlyWhenActive: Disposable | undefined;\n\n\tprotected override onStart(): Disposable | undefined {\n\t\tthis.onResume();\n\n\t\treturn Disposable.from(\n\t\t\t{ dispose: () => this.onSuspend() },\n\t\t\tContainer.tracker.onDidChangeBlameState(this.onBlameStateChanged, this),\n\t\t\tContainer.tracker.onDidChangeDirtyState(this.onDirtyStateChanged, this),\n\t\t\tContainer.tracker.onDidTriggerDirtyIdle(this.onDirtyIdleTriggered, this),\n\t\t);\n\t}\n\n\tprotected override onResume(): void {\n\t\tif (this._subscriptionOnlyWhenActive == null) {\n\t\t\tthis._subscriptionOnlyWhenActive = Container.tracker.onDidChangeContent(this.onContentChanged, this);\n\t\t}\n\t}\n\n\tprotected override onSuspend(): void {\n\t\tthis._subscriptionOnlyWhenActive?.dispose();\n\t\tthis._subscriptionOnlyWhenActive = undefined;\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (e: DocumentBlameStateChangeEvent<GitDocumentState>) =>\n\t\t\t\t`editor=${e.editor.document.uri.toString(true)}, doc=${e.document.uri.toString(true)}, blameable=${\n\t\t\t\t\te.blameable\n\t\t\t\t}`,\n\t\t},\n\t})\n\tprivate onBlameStateChanged(_e: DocumentBlameStateChangeEvent<GitDocumentState>) {\n\t\tthis.trigger('editor');\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (e: DocumentContentChangeEvent<GitDocumentState>) =>\n\t\t\t\t`editor=${e.editor.document.uri.toString(true)}, doc=${e.document.uri.toString(true)}`,\n\t\t},\n\t})\n\tprivate onContentChanged(e: DocumentContentChangeEvent<GitDocumentState>) {\n\t\tif (\n\t\t\te.contentChanges.some(cc =>\n\t\t\t\tthis.selections?.some(\n\t\t\t\t\tselection =>\n\t\t\t\t\t\t(cc.range.end.line >= selection.active && selection.active >= cc.range.start.line) ||\n\t\t\t\t\t\t(cc.range.start.line >= selection.active && selection.active >= cc.range.end.line),\n\t\t\t\t),\n\t\t\t)\n\t\t) {\n\t\t\tthis.trigger('editor');\n\t\t}\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (e: DocumentDirtyIdleTriggerEvent<GitDocumentState>) =>\n\t\t\t\t`editor=${e.editor.document.uri.toString(true)}, doc=${e.document.uri.toString(true)}`,\n\t\t},\n\t})\n\tprivate onDirtyIdleTriggered(e: DocumentDirtyIdleTriggerEvent<GitDocumentState>) {\n\t\tconst maxLines = Container.config.advanced.blame.sizeThresholdAfterEdit;\n\t\tif (maxLines > 0 && e.document.lineCount > maxLines) return;\n\n\t\tthis.resume();\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (e: DocumentDirtyStateChangeEvent<GitDocumentState>) =>\n\t\t\t\t`editor=${e.editor.document.uri.toString(true)}, doc=${e.document.uri.toString(true)}, dirty=${\n\t\t\t\t\te.dirty\n\t\t\t\t}`,\n\t\t},\n\t})\n\tprivate onDirtyStateChanged(e: DocumentDirtyStateChangeEvent<GitDocumentState>) {\n\t\tif (e.dirty) {\n\t\t\tthis.suspend();\n\t\t} else {\n\t\t\tthis.resume({ force: true });\n\t\t}\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (selections: LineSelection[]) => selections?.map(s => s.active).join(','),\n\t\t\t1: (editor: TextEditor) => editor.document.uri.toString(true),\n\t\t},\n\t\texit: updated => `returned ${updated}`,\n\t\tsingleLine: true,\n\t})\n\tprivate async updateState(selections: LineSelection[], editor: TextEditor): Promise<boolean> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tif (!this.includes(selections)) {\n\t\t\tif (cc != null) {\n\t\t\t\tcc.exitDetails = ` ${GlyphChars.Dot} lines no longer match`;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\tconst trackedDocument = await Container.tracker.getOrAdd(editor.document);\n\t\tif (!trackedDocument.isBlameable) {\n\t\t\tif (cc != null) {\n\t\t\t\tcc.exitDetails = ` ${GlyphChars.Dot} document is not blameable`;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (selections.length === 1) {\n\t\t\tconst blameLine = editor.document.isDirty\n\t\t\t\t? await Container.git.getBlameForLineContents(\n\t\t\t\t\t\ttrackedDocument.uri,\n\t\t\t\t\t\tselections[0].active,\n\t\t\t\t\t\teditor.document.getText(),\n\t\t\t\t  )\n\t\t\t\t: await Container.git.getBlameForLine(trackedDocument.uri, selections[0].active);\n\t\t\tif (blameLine === undefined) {\n\t\t\t\tif (cc != null) {\n\t\t\t\t\tcc.exitDetails = ` ${GlyphChars.Dot} blame failed`;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.setState(blameLine.line.line - 1, new GitLineState(blameLine.commit));\n\t\t} else {\n\t\t\tconst blame = editor.document.isDirty\n\t\t\t\t? await Container.git.getBlameForFileContents(trackedDocument.uri, editor.document.getText())\n\t\t\t\t: await Container.git.getBlameForFile(trackedDocument.uri);\n\t\t\tif (blame === undefined) {\n\t\t\t\tif (cc != null) {\n\t\t\t\t\tcc.exitDetails = ` ${GlyphChars.Dot} blame failed`;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tfor (const selection of selections) {\n\t\t\t\tconst commitLine = blame.lines[selection.active];\n\t\t\t\tthis.setState(selection.active, new GitLineState(blame.commits.get(commitLine.sha)));\n\t\t\t}\n\t\t}\n\n\t\t// Check again because of the awaits above\n\n\t\tif (!this.includes(selections)) {\n\t\t\tif (cc != null) {\n\t\t\t\tcc.exitDetails = ` ${GlyphChars.Dot} lines no longer match`;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!trackedDocument.isBlameable) {\n\t\t\tif (cc != null) {\n\t\t\t\tcc.exitDetails = ` ${GlyphChars.Dot} document is not blameable`;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (editor.document.isDirty) {\n\t\t\ttrackedDocument.setForceDirtyStateChangeOnNextDocumentChange();\n\t\t}\n\n\t\treturn true;\n\t}\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tcommands,\n\tConfigurationChangeEvent,\n\tProgressLocation,\n\tTreeItem,\n\tTreeItemCollapsibleState,\n\twindow,\n} from 'vscode';\nimport {\n\tBranchesViewConfig,\n\tconfiguration,\n\tViewBranchesLayout,\n\tViewFilesLayout,\n\tViewShowBranchComparison,\n} from '../configuration';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport {\n\tGitBranchReference,\n\tGitLogCommit,\n\tGitReference,\n\tGitRevisionReference,\n\tRepositoryChange,\n\tRepositoryChangeComparisonMode,\n\tRepositoryChangeEvent,\n} from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { debug, gate, Strings } from '../system';\nimport {\n\tBranchesNode,\n\tBranchNode,\n\tBranchOrTagFolderNode,\n\tRepositoryFolderNode,\n\tRepositoryNode,\n\tunknownGitUri,\n\tViewNode,\n} from './nodes';\nimport { ViewBase } from './viewBase';\n\nexport class BranchesRepositoryNode extends RepositoryFolderNode<BranchesView, BranchesNode> {\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this.child == null) {\n\t\t\tthis.child = new BranchesNode(this.uri, this.view, this, this.repo);\n\t\t}\n\n\t\treturn this.child.getChildren();\n\t}\n\n\tprotected changed(e: RepositoryChangeEvent) {\n\t\treturn e.changed(\n\t\t\tRepositoryChange.Config,\n\t\t\tRepositoryChange.Heads,\n\t\t\tRepositoryChange.Index,\n\t\t\tRepositoryChange.Remotes,\n\t\t\tRepositoryChange.RemoteProviders,\n\t\t\tRepositoryChange.Status,\n\t\t\tRepositoryChange.Unknown,\n\t\t\tRepositoryChangeComparisonMode.Any,\n\t\t);\n\t}\n}\n\nexport class BranchesViewNode extends ViewNode<BranchesView> {\n\tprotected override splatted = true;\n\tprivate children: BranchesRepositoryNode[] | undefined;\n\n\tconstructor(view: BranchesView) {\n\t\tsuper(unknownGitUri, view);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this.children == null) {\n\t\t\tconst repositories = await Container.git.getOrderedRepositories();\n\t\t\tif (repositories.length === 0) {\n\t\t\t\tthis.view.message = 'No branches could be found.';\n\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tthis.view.message = undefined;\n\n\t\t\tconst splat = repositories.length === 1;\n\t\t\tthis.children = repositories.map(\n\t\t\t\tr => new BranchesRepositoryNode(GitUri.fromRepoPath(r.path), this.view, this, r, splat),\n\t\t\t);\n\t\t}\n\n\t\tif (this.children.length === 1) {\n\t\t\tconst [child] = this.children;\n\n\t\t\tif (!child.repo.supportsChangeEvents) {\n\t\t\t\tthis.view.description = `${Strings.pad(GlyphChars.Warning, 0, 2)}Auto-refresh unavailable`;\n\t\t\t}\n\n\t\t\tconst branches = await child.repo.getBranches({ filter: b => !b.remote });\n\t\t\tif (branches.length === 0) {\n\t\t\t\tthis.view.message = 'No branches could be found.';\n\t\t\t\tthis.view.title = 'Branches';\n\n\t\t\t\tvoid child.ensureSubscription();\n\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tthis.view.message = undefined;\n\t\t\tthis.view.title = `Branches (${branches.length})`;\n\n\t\t\treturn child.getChildren();\n\t\t}\n\n\t\treturn this.children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Branches', TreeItemCollapsibleState.Expanded);\n\t\treturn item;\n\t}\n\n\toverride async getSplattedChild() {\n\t\tif (this.children == null) {\n\t\t\tawait this.getChildren();\n\t\t}\n\n\t\treturn this.children?.length === 1 ? this.children[0] : undefined;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset: boolean = false) {\n\t\tif (reset && this.children != null) {\n\t\t\tfor (const child of this.children) {\n\t\t\t\tchild.dispose();\n\t\t\t}\n\t\t\tthis.children = undefined;\n\t\t}\n\t}\n}\n\nexport class BranchesView extends ViewBase<BranchesViewNode, BranchesViewConfig> {\n\tprotected readonly configKey = 'branches';\n\n\tconstructor() {\n\t\tsuper('gitlens.views.branches', 'Branches');\n\t}\n\n\tgetRoot() {\n\t\treturn new BranchesViewNode(this);\n\t}\n\n\tprotected registerCommands() {\n\t\tvoid Container.viewCommands;\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('copy'),\n\t\t\t() => commands.executeCommand('gitlens.views.copy', this.selection),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('refresh'),\n\t\t\tasync () => {\n\t\t\t\tawait Container.git.resetCaches('branches');\n\t\t\t\treturn this.refresh(true);\n\t\t\t},\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setLayoutToList'),\n\t\t\t() => this.setLayout(ViewBranchesLayout.List),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setLayoutToTree'),\n\t\t\t() => this.setLayout(ViewBranchesLayout.Tree),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToAuto'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Auto),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToList'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.List),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToTree'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Tree),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOn'), () => this.setShowAvatars(true), this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOff'), () => this.setShowAvatars(false), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowBranchComparisonOn'),\n\t\t\t() => this.setShowBranchComparison(true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowBranchComparisonOff'),\n\t\t\t() => this.setShowBranchComparison(false),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowBranchPullRequestOn'),\n\t\t\t() => this.setShowBranchPullRequest(true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowBranchPullRequestOff'),\n\t\t\t() => this.setShowBranchPullRequest(false),\n\t\t\tthis,\n\t\t);\n\t}\n\n\tprotected override filterConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tconst changed = super.filterConfigurationChanged(e);\n\t\tif (\n\t\t\t!changed &&\n\t\t\t!configuration.changed(e, 'defaultDateFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateShortFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateSource') &&\n\t\t\t!configuration.changed(e, 'defaultDateStyle') &&\n\t\t\t!configuration.changed(e, 'defaultGravatarsStyle') &&\n\t\t\t!configuration.changed(e, 'defaultTimeFormat') &&\n\t\t\t!configuration.changed(e, 'sortBranchesBy')\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tfindBranch(branch: GitBranchReference, token?: CancellationToken) {\n\t\tif (branch.remote) return undefined;\n\n\t\tconst repoNodeId = RepositoryNode.getId(branch.repoPath);\n\n\t\treturn this.findNode((n: any) => n.branch?.ref === branch.ref, {\n\t\t\tallowPaging: true,\n\t\t\tmaxDepth: 4,\n\t\t\tcanTraverse: n => {\n\t\t\t\tif (n instanceof BranchesViewNode) return true;\n\n\t\t\t\tif (n instanceof BranchesRepositoryNode || n instanceof BranchOrTagFolderNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\ttoken: token,\n\t\t});\n\t}\n\n\tasync findCommit(commit: GitLogCommit | { repoPath: string; ref: string }, token?: CancellationToken) {\n\t\tconst repoNodeId = RepositoryNode.getId(commit.repoPath);\n\n\t\t// Get all the branches the commit is on\n\t\tconst branches = await Container.git.getCommitBranches(commit.repoPath, commit.ref);\n\t\tif (branches.length === 0) return undefined;\n\n\t\treturn this.findNode((n: any) => n.commit?.ref === commit.ref, {\n\t\t\tallowPaging: true,\n\t\t\tmaxDepth: 5,\n\t\t\tcanTraverse: async n => {\n\t\t\t\tif (n instanceof BranchesViewNode) return true;\n\n\t\t\t\tif (n instanceof BranchesRepositoryNode || n instanceof BranchOrTagFolderNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\tif (n instanceof BranchNode && branches.includes(n.branch.name)) {\n\t\t\t\t\tawait n.loadMore({ until: commit.ref });\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\ttoken: token,\n\t\t});\n\t}\n\n\t@gate(() => '')\n\trevealBranch(\n\t\tbranch: GitBranchReference,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\treturn window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Revealing ${GitReference.toString(branch, { icon: false })} in the side bar...`,\n\t\t\t\tcancellable: true,\n\t\t\t},\n\t\t\tasync (progress, token) => {\n\t\t\t\tconst node = await this.findBranch(branch, token);\n\t\t\t\tif (node == null) return undefined;\n\n\t\t\t\tawait this.ensureRevealNode(node, options);\n\n\t\t\t\treturn node;\n\t\t\t},\n\t\t);\n\t}\n\n\t@gate(() => '')\n\tasync revealCommit(\n\t\tcommit: GitRevisionReference,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\treturn window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Revealing ${GitReference.toString(commit, { icon: false })} in the side bar...`,\n\t\t\t\tcancellable: true,\n\t\t\t},\n\t\t\tasync (progress, token) => {\n\t\t\t\tconst node = await this.findCommit(commit, token);\n\t\t\t\tif (node == null) return undefined;\n\n\t\t\t\tawait this.ensureRevealNode(node, options);\n\n\t\t\t\treturn node;\n\t\t\t},\n\t\t);\n\t}\n\n\tprivate setLayout(layout: ViewBranchesLayout) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.branches.layout` as const, layout);\n\t}\n\n\tprivate setFilesLayout(layout: ViewFilesLayout) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.files.layout` as const, layout);\n\t}\n\n\tprivate setShowAvatars(enabled: boolean) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.avatars` as const, enabled);\n\t}\n\n\tprivate setShowBranchComparison(enabled: boolean) {\n\t\treturn configuration.updateEffective(\n\t\t\t`views.${this.configKey}.showBranchComparison` as const,\n\t\t\tenabled ? ViewShowBranchComparison.Branch : false,\n\t\t);\n\t}\n\n\tprivate async setShowBranchPullRequest(enabled: boolean) {\n\t\tawait configuration.updateEffective(`views.${this.configKey}.pullRequests.showForBranches` as const, enabled);\n\t\tawait configuration.updateEffective(`views.${this.configKey}.pullRequests.enabled` as const, enabled);\n\t}\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tcommands,\n\tConfigurationChangeEvent,\n\tDisposable,\n\tProgressLocation,\n\tTreeItem,\n\tTreeItemCollapsibleState,\n\twindow,\n} from 'vscode';\nimport { CommitsViewConfig, configuration, ViewFilesLayout, ViewShowBranchComparison } from '../configuration';\nimport { ContextKeys, GlyphChars, setContext } from '../constants';\nimport { Container } from '../container';\nimport {\n\tGitLogCommit,\n\tGitReference,\n\tGitRevisionReference,\n\tRepository,\n\tRepositoryChange,\n\tRepositoryChangeComparisonMode,\n\tRepositoryChangeEvent,\n} from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { debug, Functions, gate, Strings } from '../system';\nimport {\n\tBranchNode,\n\tBranchTrackingStatusNode,\n\tRepositoryFolderNode,\n\tRepositoryNode,\n\tunknownGitUri,\n\tViewNode,\n} from './nodes';\nimport { ViewBase } from './viewBase';\n\nexport class CommitsRepositoryNode extends RepositoryFolderNode<CommitsView, BranchNode> {\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this.child == null) {\n\t\t\tconst branch = await this.repo.getBranch();\n\t\t\tif (branch == null) {\n\t\t\t\tthis.view.message = 'No commits could be found.';\n\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tthis.view.message = undefined;\n\n\t\t\tlet authors;\n\t\t\tif (this.view.state.myCommitsOnly) {\n\t\t\t\tconst user = await Container.git.getCurrentUser(this.repo.path);\n\t\t\t\tif (user != null) {\n\t\t\t\t\tauthors = [`^${user.name} <${user.email}>$`];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.child = new BranchNode(this.uri, this.view, this, branch, true, {\n\t\t\t\texpanded: true,\n\t\t\t\tlimitCommits: !this.splatted,\n\t\t\t\tshowComparison: this.view.config.showBranchComparison,\n\t\t\t\tshowCurrent: false,\n\t\t\t\tshowTracking: true,\n\t\t\t\tauthors: authors,\n\t\t\t});\n\t\t}\n\n\t\treturn this.child.getChildren();\n\t}\n\n\t@gate()\n\t@debug()\n\toverride async refresh(reset: boolean = false) {\n\t\tif (reset) {\n\t\t\tthis.child = undefined;\n\t\t} else {\n\t\t\tvoid this.parent?.triggerChange(false);\n\t\t}\n\n\t\tawait this.ensureSubscription();\n\t}\n\n\t@debug()\n\tprotected override async subscribe() {\n\t\tconst lastFetched = (await this.repo?.getLastFetched()) ?? 0;\n\n\t\tconst interval = Repository.getLastFetchedUpdateInterval(lastFetched);\n\t\tif (lastFetched !== 0 && interval > 0) {\n\t\t\treturn Disposable.from(\n\t\t\t\tawait super.subscribe(),\n\t\t\t\tFunctions.interval(() => {\n\t\t\t\t\t// Check if the interval should change, and if so, reset it\n\t\t\t\t\tif (interval !== Repository.getLastFetchedUpdateInterval(lastFetched)) {\n\t\t\t\t\t\tvoid this.resetSubscription();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.splatted) {\n\t\t\t\t\t\tvoid this.view.triggerNodeChange(this.parent ?? this);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvoid this.view.triggerNodeChange(this);\n\t\t\t\t\t}\n\t\t\t\t}, interval),\n\t\t\t);\n\t\t}\n\n\t\treturn super.subscribe();\n\t}\n\n\tprotected changed(e: RepositoryChangeEvent) {\n\t\treturn e.changed(\n\t\t\tRepositoryChange.Config,\n\t\t\tRepositoryChange.Heads,\n\t\t\tRepositoryChange.Index,\n\t\t\tRepositoryChange.Remotes,\n\t\t\tRepositoryChange.RemoteProviders,\n\t\t\tRepositoryChange.Status,\n\t\t\tRepositoryChange.Unknown,\n\t\t\tRepositoryChangeComparisonMode.Any,\n\t\t);\n\t}\n}\n\nexport class CommitsViewNode extends ViewNode<CommitsView> {\n\tprotected override splatted = true;\n\tprivate children: CommitsRepositoryNode[] | undefined;\n\n\tconstructor(view: CommitsView) {\n\t\tsuper(unknownGitUri, view);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this.children == null) {\n\t\t\tconst repositories = await Container.git.getOrderedRepositories();\n\t\t\tif (repositories.length === 0) {\n\t\t\t\tthis.view.message = 'No commits could be found.';\n\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tthis.view.message = undefined;\n\n\t\t\tconst splat = repositories.length === 1;\n\t\t\tthis.children = repositories.map(\n\t\t\t\tr =>\n\t\t\t\t\tnew CommitsRepositoryNode(GitUri.fromRepoPath(r.path), this.view, this, r, splat, {\n\t\t\t\t\t\tshowBranchAndLastFetched: true,\n\t\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tif (this.children.length === 1) {\n\t\t\tconst [child] = this.children;\n\n\t\t\tconst branch = await child.repo.getBranch();\n\t\t\tif (branch != null) {\n\t\t\t\tconst lastFetched = (await child.repo.getLastFetched()) ?? 0;\n\n\t\t\t\tconst status = branch.getTrackingStatus();\n\t\t\t\tthis.view.description = `${status ? `${status} ${GlyphChars.Dot} ` : ''}${branch.name}${\n\t\t\t\t\tbranch.rebasing ? ' (Rebasing)' : ''\n\t\t\t\t}${lastFetched ? ` ${GlyphChars.Dot} Last fetched ${Repository.formatLastFetched(lastFetched)}` : ''}${\n\t\t\t\t\tchild.repo.supportsChangeEvents\n\t\t\t\t\t\t? ''\n\t\t\t\t\t\t: `${Strings.pad(GlyphChars.Warning, 3, 2)}Auto-refresh unavailable`\n\t\t\t\t}`;\n\t\t\t} else {\n\t\t\t\tthis.view.description = child.repo.supportsChangeEvents\n\t\t\t\t\t? undefined\n\t\t\t\t\t: `${Strings.pad(GlyphChars.Warning, 1, 2)}Auto-refresh unavailable`;\n\t\t\t}\n\n\t\t\treturn child.getChildren();\n\t\t}\n\n\t\treturn this.children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Commits', TreeItemCollapsibleState.Expanded);\n\t\treturn item;\n\t}\n\n\toverride async getSplattedChild() {\n\t\tif (this.children == null) {\n\t\t\tawait this.getChildren();\n\t\t}\n\n\t\treturn this.children?.length === 1 ? this.children[0] : undefined;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset: boolean = false) {\n\t\tif (reset && this.children != null) {\n\t\t\tfor (const child of this.children) {\n\t\t\t\tchild.dispose();\n\t\t\t}\n\t\t\tthis.children = undefined;\n\t\t}\n\t}\n}\n\ninterface CommitsViewState {\n\tmyCommitsOnly?: boolean;\n}\n\nexport class CommitsView extends ViewBase<CommitsViewNode, CommitsViewConfig> {\n\tprotected readonly configKey = 'commits';\n\n\tconstructor() {\n\t\tsuper('gitlens.views.commits', 'Commits');\n\t}\n\n\tprivate readonly _state: CommitsViewState = {};\n\tget state(): CommitsViewState {\n\t\treturn this._state;\n\t}\n\n\tgetRoot() {\n\t\treturn new CommitsViewNode(this);\n\t}\n\n\tprotected registerCommands() {\n\t\tvoid Container.viewCommands;\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('copy'),\n\t\t\t() => commands.executeCommand('gitlens.views.copy', this.selection),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('refresh'),\n\t\t\tasync () => {\n\t\t\t\tawait Container.git.resetCaches('branches', 'status', 'tags');\n\t\t\t\treturn this.refresh(true);\n\t\t\t},\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToAuto'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Auto),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToList'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.List),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToTree'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Tree),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setMyCommitsOnlyOn'),\n\t\t\t() => this.setMyCommitsOnly(true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setMyCommitsOnlyOff'),\n\t\t\t() => this.setMyCommitsOnly(false),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOn'), () => this.setShowAvatars(true), this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOff'), () => this.setShowAvatars(false), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowBranchComparisonOn'),\n\t\t\t() => this.setShowBranchComparison(true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowBranchComparisonOff'),\n\t\t\t() => this.setShowBranchComparison(false),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowBranchPullRequestOn'),\n\t\t\t() => this.setShowBranchPullRequest(true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowBranchPullRequestOff'),\n\t\t\t() => this.setShowBranchPullRequest(false),\n\t\t\tthis,\n\t\t);\n\t}\n\n\tprotected override filterConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tconst changed = super.filterConfigurationChanged(e);\n\t\tif (\n\t\t\t!changed &&\n\t\t\t!configuration.changed(e, 'defaultDateFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateShortFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateSource') &&\n\t\t\t!configuration.changed(e, 'defaultDateStyle') &&\n\t\t\t!configuration.changed(e, 'defaultGravatarsStyle') &&\n\t\t\t!configuration.changed(e, 'defaultTimeFormat')\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tasync findCommit(commit: GitLogCommit | { repoPath: string; ref: string }, token?: CancellationToken) {\n\t\tconst repoNodeId = RepositoryNode.getId(commit.repoPath);\n\n\t\tconst branch = await Container.git.getBranch(commit.repoPath);\n\t\tif (branch == null) return undefined;\n\n\t\t// Check if the commit exists on the current branch\n\t\tif (!(await Container.git.branchContainsCommit(commit.repoPath, branch.name, commit.ref))) return undefined;\n\n\t\treturn this.findNode((n: any) => n.commit?.ref === commit.ref, {\n\t\t\tallowPaging: true,\n\t\t\tmaxDepth: 2,\n\t\t\tcanTraverse: async n => {\n\t\t\t\tif (n instanceof CommitsViewNode) {\n\t\t\t\t\tlet node: ViewNode | undefined = await n.getSplattedChild?.();\n\t\t\t\t\tif (node instanceof CommitsRepositoryNode) {\n\t\t\t\t\t\tnode = await node.getSplattedChild?.();\n\t\t\t\t\t\tif (node instanceof BranchNode) {\n\t\t\t\t\t\t\tawait node.loadMore({ until: commit.ref });\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tif (n instanceof CommitsRepositoryNode) {\n\t\t\t\t\tif (n.id.startsWith(repoNodeId)) {\n\t\t\t\t\t\tconst node = await n.getSplattedChild?.();\n\t\t\t\t\t\tif (node instanceof BranchNode) {\n\t\t\t\t\t\t\tawait node.loadMore({ until: commit.ref });\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (n instanceof BranchTrackingStatusNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\ttoken: token,\n\t\t});\n\t}\n\n\t@gate(() => '')\n\tasync revealCommit(\n\t\tcommit: GitRevisionReference,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\treturn window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Revealing ${GitReference.toString(commit, { icon: false })} in the side bar...`,\n\t\t\t\tcancellable: true,\n\t\t\t},\n\t\t\tasync (progress, token) => {\n\t\t\t\tconst node = await this.findCommit(commit, token);\n\t\t\t\tif (node == null) return undefined;\n\n\t\t\t\tawait this.ensureRevealNode(node, options);\n\n\t\t\t\treturn node;\n\t\t\t},\n\t\t);\n\t}\n\n\tprivate setFilesLayout(layout: ViewFilesLayout) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.files.layout` as const, layout);\n\t}\n\n\tprivate setMyCommitsOnly(enabled: boolean) {\n\t\tvoid setContext(ContextKeys.ViewsCommitsMyCommitsOnly, enabled);\n\t\tthis.state.myCommitsOnly = enabled;\n\t\tvoid this.refresh(true);\n\t}\n\n\tprivate setShowAvatars(enabled: boolean) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.avatars` as const, enabled);\n\t}\n\n\tprivate setShowBranchComparison(enabled: boolean) {\n\t\treturn configuration.updateEffective(\n\t\t\t`views.${this.configKey}.showBranchComparison` as const,\n\t\t\tenabled ? ViewShowBranchComparison.Working : false,\n\t\t);\n\t}\n\n\tprivate async setShowBranchPullRequest(enabled: boolean) {\n\t\tawait configuration.updateEffective(`views.${this.configKey}.pullRequests.showForBranches` as const, enabled);\n\t\tawait configuration.updateEffective(`views.${this.configKey}.pullRequests.enabled` as const, enabled);\n\t}\n}\n","'use strict';\nimport { commands, ConfigurationChangeEvent, Disposable, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Avatars } from '../avatars';\nimport { configuration, ContributorsViewConfig, ViewFilesLayout } from '../configuration';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { RepositoryChange, RepositoryChangeComparisonMode, RepositoryChangeEvent } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { debug, gate, Strings } from '../system';\nimport { ContributorsNode, RepositoryFolderNode, unknownGitUri, ViewNode } from './nodes';\nimport { ViewBase } from './viewBase';\n\nexport class ContributorsRepositoryNode extends RepositoryFolderNode<ContributorsView, ContributorsNode> {\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this.child == null) {\n\t\t\tthis.child = new ContributorsNode(this.uri, this.view, this, this.repo);\n\t\t}\n\n\t\treturn this.child.getChildren();\n\t}\n\n\t@debug()\n\tprotected override async subscribe() {\n\t\treturn Disposable.from(\n\t\t\tawait super.subscribe(),\n\t\t\tAvatars.onDidFetch(e => this.child?.updateAvatar(e.email)),\n\t\t);\n\t}\n\n\tprotected changed(e: RepositoryChangeEvent) {\n\t\treturn e.changed(\n\t\t\tRepositoryChange.Config,\n\t\t\tRepositoryChange.Heads,\n\t\t\tRepositoryChange.Remotes,\n\t\t\tRepositoryChange.Unknown,\n\t\t\tRepositoryChangeComparisonMode.Any,\n\t\t);\n\t}\n}\n\nexport class ContributorsViewNode extends ViewNode<ContributorsView> {\n\tprotected override splatted = true;\n\tprivate children: ContributorsRepositoryNode[] | undefined;\n\n\tconstructor(view: ContributorsView) {\n\t\tsuper(unknownGitUri, view);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this.children == null) {\n\t\t\tconst repositories = await Container.git.getOrderedRepositories();\n\t\t\tif (repositories.length === 0) {\n\t\t\t\tthis.view.message = 'No contributors could be found.';\n\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tthis.view.message = undefined;\n\n\t\t\tconst splat = repositories.length === 1;\n\t\t\tthis.children = repositories.map(\n\t\t\t\tr => new ContributorsRepositoryNode(GitUri.fromRepoPath(r.path), this.view, this, r, splat),\n\t\t\t);\n\t\t}\n\n\t\tif (this.children.length === 1) {\n\t\t\tconst [child] = this.children;\n\n\t\t\tif (!child.repo.supportsChangeEvents) {\n\t\t\t\tthis.view.description = `${Strings.pad(GlyphChars.Warning, 0, 2)}Auto-refresh unavailable`;\n\t\t\t}\n\n\t\t\tconst children = await child.getChildren();\n\n\t\t\t// const all = Container.config.views.contributors.showAllBranches;\n\n\t\t\t// let ref: string | undefined;\n\t\t\t// // If we aren't getting all branches, get the upstream of the current branch if there is one\n\t\t\t// if (!all) {\n\t\t\t// \ttry {\n\t\t\t// \t\tconst branch = await Container.git.getBranch(this.uri.repoPath);\n\t\t\t// \t\tif (branch?.upstream?.name != null && !branch.upstream.missing) {\n\t\t\t// \t\t\tref = '@{u}';\n\t\t\t// \t\t}\n\t\t\t// \t} catch {}\n\t\t\t// }\n\n\t\t\t// const contributors = await child.repo.getContributors({ all: all, ref: ref });\n\t\t\tif (children.length === 0) {\n\t\t\t\tthis.view.message = 'No contributors could be found.';\n\t\t\t\tthis.view.title = 'Contributors';\n\n\t\t\t\tvoid child.ensureSubscription();\n\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tthis.view.message = undefined;\n\t\t\tthis.view.title = `Contributors (${children.length})`;\n\n\t\t\treturn children;\n\t\t}\n\n\t\treturn this.children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Contributors', TreeItemCollapsibleState.Expanded);\n\t\treturn item;\n\t}\n\n\toverride async getSplattedChild() {\n\t\tif (this.children == null) {\n\t\t\tawait this.getChildren();\n\t\t}\n\n\t\treturn this.children?.length === 1 ? this.children[0] : undefined;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset: boolean = false) {\n\t\tif (reset && this.children != null) {\n\t\t\tfor (const child of this.children) {\n\t\t\t\tchild.dispose();\n\t\t\t}\n\t\t\tthis.children = undefined;\n\t\t}\n\t}\n}\n\nexport class ContributorsView extends ViewBase<ContributorsViewNode, ContributorsViewConfig> {\n\tprotected readonly configKey = 'contributors';\n\n\tconstructor() {\n\t\tsuper('gitlens.views.contributors', 'Contributors');\n\t}\n\n\tgetRoot() {\n\t\treturn new ContributorsViewNode(this);\n\t}\n\n\tprotected registerCommands() {\n\t\tvoid Container.viewCommands;\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('copy'),\n\t\t\t() => commands.executeCommand('gitlens.views.copy', this.selection),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('refresh'),\n\t\t\tasync () => {\n\t\t\t\tawait Container.git.resetCaches('contributors');\n\t\t\t\treturn this.refresh(true);\n\t\t\t},\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToAuto'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Auto),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToList'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.List),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToTree'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Tree),\n\t\t\tthis,\n\t\t);\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowAllBranchesOn'),\n\t\t\t() => this.setShowAllBranches(true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowAllBranchesOff'),\n\t\t\t() => this.setShowAllBranches(false),\n\t\t\tthis,\n\t\t);\n\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOn'), () => this.setShowAvatars(true), this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOff'), () => this.setShowAvatars(false), this);\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowStatisticsOn'),\n\t\t\t() => this.setShowStatistics(true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowStatisticsOff'),\n\t\t\t() => this.setShowStatistics(false),\n\t\t\tthis,\n\t\t);\n\t}\n\n\tprotected override filterConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tconst changed = super.filterConfigurationChanged(e);\n\t\tif (\n\t\t\t!changed &&\n\t\t\t!configuration.changed(e, 'defaultDateFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateShortFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateSource') &&\n\t\t\t!configuration.changed(e, 'defaultDateStyle') &&\n\t\t\t!configuration.changed(e, 'defaultGravatarsStyle') &&\n\t\t\t!configuration.changed(e, 'defaultTimeFormat') &&\n\t\t\t!configuration.changed(e, 'sortContributorsBy')\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprivate setFilesLayout(layout: ViewFilesLayout) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.files.layout` as const, layout);\n\t}\n\n\tprivate setShowAllBranches(enabled: boolean) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.showAllBranches` as const, enabled);\n\t}\n\n\tprivate setShowAvatars(enabled: boolean) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.avatars` as const, enabled);\n\t}\n\n\tprivate setShowStatistics(enabled: boolean) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.showStatistics` as const, enabled);\n\t}\n}\n","'use strict';\nimport { commands, ConfigurationChangeEvent } from 'vscode';\nimport { configuration, LineHistoryViewConfig } from '../configuration';\nimport { ContextKeys, setContext } from '../constants';\nimport { Container } from '../container';\nimport { LineHistoryTrackerNode } from './nodes';\nimport { ViewBase } from './viewBase';\n\nconst pinnedSuffix = ' (pinned)';\n\nexport class LineHistoryView extends ViewBase<LineHistoryTrackerNode, LineHistoryViewConfig> {\n\tprotected readonly configKey = 'lineHistory';\n\n\tconstructor() {\n\t\tsuper('gitlens.views.lineHistory', 'Line History');\n\n\t\tvoid setContext(ContextKeys.ViewsLineHistoryEditorFollowing, true);\n\t}\n\n\tprotected override get showCollapseAll(): boolean {\n\t\treturn false;\n\t}\n\n\tgetRoot() {\n\t\treturn new LineHistoryTrackerNode(this);\n\t}\n\n\tprotected registerCommands() {\n\t\tvoid Container.viewCommands;\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('copy'),\n\t\t\t() => commands.executeCommand('gitlens.views.copy', this.selection),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('refresh'), () => this.refresh(true), this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('changeBase'), () => this.changeBase(), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setEditorFollowingOn'),\n\t\t\t() => this.setEditorFollowing(true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setEditorFollowingOff'),\n\t\t\t() => this.setEditorFollowing(false),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOn'), () => this.setShowAvatars(true), this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOff'), () => this.setShowAvatars(false), this);\n\t}\n\n\tprotected override filterConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tconst changed = super.filterConfigurationChanged(e);\n\t\tif (\n\t\t\t!changed &&\n\t\t\t!configuration.changed(e, 'defaultDateFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateShortFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateSource') &&\n\t\t\t!configuration.changed(e, 'defaultDateStyle') &&\n\t\t\t!configuration.changed(e, 'defaultGravatarsStyle') &&\n\t\t\t!configuration.changed(e, 'defaultTimeFormat')\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprivate changeBase() {\n\t\tvoid this.root?.changeBase();\n\t}\n\n\tprivate setEditorFollowing(enabled: boolean) {\n\t\tconst root = this.ensureRoot();\n\t\tif (!root.hasUri) return;\n\n\t\tvoid setContext(ContextKeys.ViewsLineHistoryEditorFollowing, enabled);\n\n\t\tthis.root?.setEditorFollowing(enabled);\n\n\t\tif (this.description?.endsWith(pinnedSuffix)) {\n\t\t\tif (enabled) {\n\t\t\t\tthis.description = this.description.substr(0, this.description.length - pinnedSuffix.length);\n\t\t\t}\n\t\t} else if (!enabled && this.description != null) {\n\t\t\tthis.description += pinnedSuffix;\n\t\t}\n\n\t\tif (enabled) {\n\t\t\tvoid root.ensureSubscription();\n\t\t\tvoid this.refresh(true);\n\t\t}\n\t}\n\n\tprivate setShowAvatars(enabled: boolean) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.avatars` as const, enabled);\n\t}\n}\n","'use strict';\nimport { commands, ConfigurationChangeEvent, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { getRepoPathOrPrompt } from '../commands';\nimport { configuration, SearchAndCompareViewConfig, ViewFilesLayout } from '../configuration';\nimport { ContextKeys, NamedRef, PinnedItem, PinnedItems, setContext, WorkspaceState } from '../constants';\nimport { Container } from '../container';\nimport { GitLog, GitRevision, SearchPattern } from '../git/git';\nimport { ReferencePicker, ReferencesQuickPickIncludes } from '../quickpicks';\nimport { debug, gate, Iterables, log, Promises } from '../system';\nimport {\n\tCompareResultsNode,\n\tContextValues,\n\tResultsFilesNode,\n\tSearchResultsNode,\n\tunknownGitUri,\n\tViewNode,\n} from './nodes';\nimport { ComparePickerNode } from './nodes/comparePickerNode';\nimport { ViewBase } from './viewBase';\n\ninterface DeprecatedPinnedComparison {\n\tpath: string;\n\tref1: NamedRef;\n\tref2: NamedRef;\n\tnotation?: '..' | '...';\n}\n\ninterface DeprecatedPinnedComparisons {\n\t[id: string]: DeprecatedPinnedComparison;\n}\n\nexport class SearchAndCompareViewNode extends ViewNode<SearchAndCompareView> {\n\tprotected override splatted = true;\n\tprivate comparePicker: ComparePickerNode | undefined;\n\n\tconstructor(view: SearchAndCompareView) {\n\t\tsuper(unknownGitUri, view);\n\t}\n\n\tprivate _children: (ComparePickerNode | CompareResultsNode | SearchResultsNode)[] | undefined;\n\tprivate get children(): (ComparePickerNode | CompareResultsNode | SearchResultsNode)[] {\n\t\tif (this._children == null) {\n\t\t\tthis._children = [];\n\n\t\t\t// Get pinned searches & comparisons\n\t\t\tconst pinned = this.view.getPinned();\n\t\t\tif (pinned.length !== 0) {\n\t\t\t\tthis._children.push(...pinned);\n\t\t\t}\n\t\t}\n\n\t\treturn this._children;\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\tif (this.children.length === 0) return [];\n\n\t\tthis.view.message = undefined;\n\n\t\treturn this.children.sort((a, b) => (a.pinned ? -1 : 1) - (b.pinned ? -1 : 1) || b.order - a.order);\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tthis.splatted = false;\n\n\t\tconst item = new TreeItem('SearchAndCompare', TreeItemCollapsibleState.Expanded);\n\t\titem.contextValue = ContextValues.SearchAndCompare;\n\t\treturn item;\n\t}\n\n\taddOrReplace(results: CompareResultsNode | SearchResultsNode, replace: boolean) {\n\t\tif (this.children.includes(results)) return;\n\n\t\tif (replace) {\n\t\t\tthis.clear();\n\t\t}\n\n\t\tthis.children.push(results);\n\n\t\tthis.view.triggerNodeChange();\n\t}\n\n\t@log()\n\tclear(silent: boolean = false) {\n\t\tif (this.children.length === 0) return;\n\n\t\tthis.removeComparePicker(true);\n\t\tconst index = this._children!.findIndex(c => !c.pinned);\n\t\tif (index !== -1) {\n\t\t\tthis._children!.splice(index, this._children!.length);\n\t\t}\n\n\t\tif (!silent) {\n\t\t\tthis.view.triggerNodeChange();\n\t\t}\n\t}\n\n\t@log({\n\t\targs: { 0: (n: ViewNode) => n.toString() },\n\t})\n\tdismiss(node: ComparePickerNode | CompareResultsNode | SearchResultsNode) {\n\t\tif (node === this.comparePicker) {\n\t\t\tthis.removeComparePicker();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.children.length === 0) return;\n\n\t\tconst index = this.children.indexOf(node);\n\t\tif (index === -1) return;\n\n\t\tthis.children.splice(index, 1);\n\n\t\tthis.view.triggerNodeChange();\n\t}\n\n\t@gate()\n\t@debug()\n\toverride async refresh() {\n\t\tif (this.children.length === 0) return;\n\n\t\tconst promises: Promise<any>[] = [\n\t\t\t...Iterables.filterMap(this.children, c => {\n\t\t\t\tconst result = c.refresh === undefined ? false : c.refresh();\n\t\t\t\treturn Promises.is<boolean | void>(result) ? result : undefined;\n\t\t\t}),\n\t\t];\n\t\tawait Promise.all(promises);\n\t}\n\n\tasync compareWithSelected(repoPath?: string, ref?: string | NamedRef) {\n\t\tconst selectedRef = this.comparePicker?.selectedRef;\n\t\tif (selectedRef == null) return;\n\n\t\tif (repoPath == null) {\n\t\t\trepoPath = selectedRef.repoPath;\n\t\t} else if (repoPath !== selectedRef.repoPath) {\n\t\t\t// If we don't have a matching repoPath, then start over\n\t\t\tvoid this.selectForCompare(repoPath, ref);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (ref == null) {\n\t\t\tconst pick = await ReferencePicker.show(\n\t\t\t\trepoPath,\n\t\t\t\t`Compare ${this.getRefName(selectedRef.ref)} with`,\n\t\t\t\t'Choose a reference to compare with',\n\t\t\t\t{\n\t\t\t\t\tallowEnteringRefs: true,\n\t\t\t\t\tpicked: typeof selectedRef.ref === 'string' ? selectedRef.ref : selectedRef.ref.ref,\n\t\t\t\t\t// checkmarks: true,\n\t\t\t\t\tinclude:\n\t\t\t\t\t\tReferencesQuickPickIncludes.BranchesAndTags |\n\t\t\t\t\t\tReferencesQuickPickIncludes.HEAD |\n\t\t\t\t\t\tReferencesQuickPickIncludes.WorkingTree,\n\t\t\t\t\tsort: { branches: { current: true } },\n\t\t\t\t},\n\t\t\t);\n\t\t\tif (pick == null) {\n\t\t\t\tif (this.comparePicker != null) {\n\t\t\t\t\tawait this.view.show();\n\t\t\t\t\tawait this.view.reveal(this.comparePicker, { focus: true, select: true });\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tref = pick.ref;\n\t\t}\n\n\t\tthis.removeComparePicker();\n\t\tvoid (await this.view.compare(repoPath, selectedRef.ref, ref));\n\t}\n\n\tasync selectForCompare(repoPath?: string, ref?: string | NamedRef, options?: { prompt?: boolean }) {\n\t\tif (repoPath == null) {\n\t\t\trepoPath = await getRepoPathOrPrompt('Compare');\n\t\t}\n\t\tif (repoPath == null) return;\n\n\t\tthis.removeComparePicker(true);\n\n\t\tlet prompt = options?.prompt ?? false;\n\t\tlet ref2;\n\t\tif (ref == null) {\n\t\t\tconst pick = await ReferencePicker.show(repoPath, 'Compare', 'Choose a reference to compare', {\n\t\t\t\tallowEnteringRefs: { ranges: true },\n\t\t\t\t// checkmarks: false,\n\t\t\t\tinclude:\n\t\t\t\t\tReferencesQuickPickIncludes.BranchesAndTags |\n\t\t\t\t\tReferencesQuickPickIncludes.HEAD |\n\t\t\t\t\tReferencesQuickPickIncludes.WorkingTree,\n\t\t\t\tsort: { branches: { current: true }, tags: {} },\n\t\t\t});\n\t\t\tif (pick == null) {\n\t\t\t\tawait this.triggerChange();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tref = pick.ref;\n\n\t\t\tif (GitRevision.isRange(ref)) {\n\t\t\t\tconst range = GitRevision.splitRange(ref);\n\t\t\t\tif (range != null) {\n\t\t\t\t\tref = range.ref1 || 'HEAD';\n\t\t\t\t\tref2 = range.ref2 || 'HEAD';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tprompt = true;\n\t\t}\n\n\t\tthis.comparePicker = new ComparePickerNode(this.view, this, {\n\t\t\tlabel: this.getRefName(ref),\n\t\t\trepoPath: repoPath,\n\t\t\tref: ref,\n\t\t});\n\t\tthis.children.splice(0, 0, this.comparePicker);\n\t\tvoid setContext(ContextKeys.ViewsCanCompare, true);\n\n\t\tawait this.triggerChange();\n\n\t\tawait this.view.reveal(this.comparePicker, { focus: false, select: true });\n\n\t\tif (prompt) {\n\t\t\tawait this.compareWithSelected(repoPath, ref2);\n\t\t}\n\t}\n\n\tprivate getRefName(ref: string | NamedRef) {\n\t\treturn typeof ref === 'string'\n\t\t\t? GitRevision.shorten(ref, { strings: { working: 'Working Tree' } })!\n\t\t\t: ref.label ?? GitRevision.shorten(ref.ref)!;\n\t}\n\n\tprivate removeComparePicker(silent: boolean = false) {\n\t\tvoid setContext(ContextKeys.ViewsCanCompare, false);\n\t\tif (this.comparePicker != null) {\n\t\t\tconst index = this.children.indexOf(this.comparePicker);\n\t\t\tif (index !== -1) {\n\t\t\t\tthis.children.splice(index, 1);\n\t\t\t\tif (!silent) {\n\t\t\t\t\tvoid this.triggerChange();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.comparePicker = undefined;\n\t\t}\n\t}\n}\n\nexport class SearchAndCompareView extends ViewBase<SearchAndCompareViewNode, SearchAndCompareViewConfig> {\n\tprotected readonly configKey = 'searchAndCompare';\n\n\tconstructor() {\n\t\tsuper('gitlens.views.searchAndCompare', 'Search & Compare');\n\n\t\tvoid setContext(ContextKeys.ViewsSearchAndCompareKeepResults, this.keepResults);\n\t}\n\n\tgetRoot() {\n\t\treturn new SearchAndCompareViewNode(this);\n\t}\n\n\tprotected registerCommands() {\n\t\tvoid Container.viewCommands;\n\n\t\tcommands.registerCommand(this.getQualifiedCommand('clear'), () => this.clear(), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('copy'),\n\t\t\t() => commands.executeCommand('gitlens.views.copy', this.selection),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('refresh'), () => this.refresh(true), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToAuto'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Auto),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToList'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.List),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToTree'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Tree),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setKeepResultsToOn'), () => this.setKeepResults(true), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setKeepResultsToOff'),\n\t\t\t() => this.setKeepResults(false),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOn'), () => this.setShowAvatars(true), this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOff'), () => this.setShowAvatars(false), this);\n\n\t\tcommands.registerCommand(this.getQualifiedCommand('pin'), this.pin, this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('unpin'), this.unpin, this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('swapComparison'), this.swapComparison, this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('selectForCompare'), this.selectForCompare, this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('compareWithSelected'), this.compareWithSelected, this);\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesFilterOnLeft'),\n\t\t\tn => this.setFilesFilter(n, 'left'),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesFilterOnRight'),\n\t\t\tn => this.setFilesFilter(n, 'right'),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesFilterOff'),\n\t\t\tn => this.setFilesFilter(n, false),\n\t\t\tthis,\n\t\t);\n\t}\n\n\tprotected override filterConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tconst changed = super.filterConfigurationChanged(e);\n\t\tif (\n\t\t\t!changed &&\n\t\t\t!configuration.changed(e, 'defaultDateFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateShortFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateSource') &&\n\t\t\t!configuration.changed(e, 'defaultDateStyle') &&\n\t\t\t!configuration.changed(e, 'defaultGravatarsStyle') &&\n\t\t\t!configuration.changed(e, 'defaultTimeFormat')\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tget keepResults(): boolean {\n\t\treturn Container.context.workspaceState.get<boolean>(WorkspaceState.ViewsSearchAndCompareKeepResults, true);\n\t}\n\n\tclear() {\n\t\tthis.root?.clear();\n\t}\n\n\tdismissNode(node: ViewNode) {\n\t\tif (\n\t\t\tthis.root == null ||\n\t\t\t(!(node instanceof ComparePickerNode) &&\n\t\t\t\t!(node instanceof CompareResultsNode) &&\n\t\t\t\t!(node instanceof SearchResultsNode)) ||\n\t\t\t!node.canDismiss\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.root.dismiss(node);\n\t}\n\n\tcompare(repoPath: string, ref1: string | NamedRef, ref2: string | NamedRef) {\n\t\treturn this.addResults(\n\t\t\tnew CompareResultsNode(\n\t\t\t\tthis,\n\t\t\t\tthis.ensureRoot(),\n\t\t\t\trepoPath,\n\t\t\t\ttypeof ref1 === 'string' ? { ref: ref1 } : ref1,\n\t\t\t\ttypeof ref2 === 'string' ? { ref: ref2 } : ref2,\n\t\t\t),\n\t\t);\n\t}\n\n\tcompareWithSelected(repoPath?: string, ref?: string | NamedRef) {\n\t\tvoid this.ensureRoot().compareWithSelected(repoPath, ref);\n\t}\n\n\tselectForCompare(repoPath?: string, ref?: string | NamedRef, options?: { prompt?: boolean }) {\n\t\tvoid this.ensureRoot().selectForCompare(repoPath, ref, options);\n\t}\n\n\tasync search(\n\t\trepoPath: string,\n\t\tsearch: SearchPattern,\n\t\t{\n\t\t\tlabel,\n\t\t\treveal,\n\t\t}: {\n\t\t\tlabel:\n\t\t\t\t| string\n\t\t\t\t| {\n\t\t\t\t\t\tlabel: string;\n\t\t\t\t\t\tresultsType?: { singular: string; plural: string };\n\t\t\t\t  };\n\t\t\treveal?: {\n\t\t\t\tselect?: boolean;\n\t\t\t\tfocus?: boolean;\n\t\t\t\texpand?: boolean | number;\n\t\t\t};\n\t\t},\n\t\tresults?: Promise<GitLog | undefined> | GitLog,\n\t\tupdateNode?: SearchResultsNode,\n\t) {\n\t\tif (!this.visible) {\n\t\t\tawait this.show();\n\t\t}\n\n\t\tconst labels = { label: `Results ${typeof label === 'string' ? label : label.label}`, queryLabel: label };\n\t\tif (updateNode != null) {\n\t\t\tawait updateNode.edit({ pattern: search, labels: labels, log: results });\n\n\t\t\treturn;\n\t\t}\n\n\t\tawait this.addResults(new SearchResultsNode(this, this.root!, repoPath, search, labels, results), reveal);\n\t}\n\n\tgetPinned() {\n\t\tlet savedPins = Container.context.workspaceState.get<PinnedItems>(\n\t\t\tWorkspaceState.ViewsSearchAndComparePinnedItems,\n\t\t);\n\t\tif (savedPins == null) {\n\t\t\t// Migrate any deprecated pinned items\n\t\t\tconst deprecatedPins = Container.context.workspaceState.get<DeprecatedPinnedComparisons>(\n\t\t\t\tWorkspaceState.Deprecated_PinnedComparisons,\n\t\t\t);\n\t\t\tif (deprecatedPins == null) return [];\n\n\t\t\tsavedPins = Object.create(null) as PinnedItems;\n\t\t\tfor (const p of Object.values(deprecatedPins)) {\n\t\t\t\tsavedPins[CompareResultsNode.getPinnableId(p.path, p.ref1.ref, p.ref2.ref)] = {\n\t\t\t\t\ttype: 'comparison',\n\t\t\t\t\ttimestamp: Date.now(),\n\t\t\t\t\tpath: p.path,\n\t\t\t\t\tref1: p.ref1,\n\t\t\t\t\tref2: p.ref2,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tvoid Container.context.workspaceState.update(WorkspaceState.ViewsSearchAndComparePinnedItems, savedPins);\n\t\t\tvoid Container.context.workspaceState.update(WorkspaceState.Deprecated_PinnedComparisons, undefined);\n\t\t}\n\n\t\tconst root = this.ensureRoot();\n\t\treturn Object.values(savedPins)\n\t\t\t.sort((a, b) => (b.timestamp ?? 0) - (a.timestamp ?? 0))\n\t\t\t.map(p =>\n\t\t\t\tp.type === 'comparison'\n\t\t\t\t\t? new CompareResultsNode(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\troot,\n\t\t\t\t\t\t\tp.path,\n\t\t\t\t\t\t\t{ label: p.ref1.label, ref: p.ref1.ref ?? (p.ref1 as any).name ?? (p.ref1 as any).sha },\n\t\t\t\t\t\t\t{ label: p.ref2.label, ref: p.ref2.ref ?? (p.ref2 as any).name ?? (p.ref2 as any).sha },\n\t\t\t\t\t\t\tp.timestamp,\n\t\t\t\t\t  )\n\t\t\t\t\t: new SearchResultsNode(this, root, p.path, p.search, p.labels, undefined, p.timestamp),\n\t\t\t);\n\t}\n\n\tasync updatePinned(id: string, pin?: PinnedItem) {\n\t\tlet pinned = Container.context.workspaceState.get<PinnedItems>(WorkspaceState.ViewsSearchAndComparePinnedItems);\n\t\tif (pinned == null) {\n\t\t\tpinned = Object.create(null) as PinnedItems;\n\t\t}\n\n\t\tif (pin != null) {\n\t\t\tpinned[id] = { ...pin };\n\t\t} else {\n\t\t\tconst { [id]: _, ...rest } = pinned;\n\t\t\tpinned = rest;\n\t\t}\n\n\t\tawait Container.context.workspaceState.update(WorkspaceState.ViewsSearchAndComparePinnedItems, pinned);\n\n\t\tthis.triggerNodeChange(this.ensureRoot());\n\t}\n\n\tprivate async addResults(\n\t\tresults: CompareResultsNode | SearchResultsNode,\n\t\toptions: {\n\t\t\texpand?: boolean | number;\n\t\t\tfocus?: boolean;\n\t\t\tselect?: boolean;\n\t\t} = { expand: true, focus: true, select: true },\n\t) {\n\t\tif (!this.visible) {\n\t\t\tawait this.show();\n\t\t}\n\n\t\tconst root = this.ensureRoot();\n\t\troot.addOrReplace(results, !this.keepResults);\n\n\t\tsetImmediate(() => this.reveal(results, options));\n\t}\n\n\tprivate setFilesLayout(layout: ViewFilesLayout) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.files.layout` as const, layout);\n\t}\n\n\tprivate setKeepResults(enabled: boolean) {\n\t\tvoid Container.context.workspaceState.update(WorkspaceState.ViewsSearchAndCompareKeepResults, enabled);\n\t\tvoid setContext(ContextKeys.ViewsSearchAndCompareKeepResults, enabled);\n\t}\n\n\tprivate setShowAvatars(enabled: boolean) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.avatars` as const, enabled);\n\t}\n\n\tprivate pin(node: CompareResultsNode | SearchResultsNode) {\n\t\tif (!(node instanceof CompareResultsNode) && !(node instanceof SearchResultsNode)) return undefined;\n\n\t\treturn node.pin();\n\t}\n\n\tprivate setFilesFilter(node: ResultsFilesNode, filter: 'left' | 'right' | false) {\n\t\tif (!(node instanceof ResultsFilesNode)) return;\n\n\t\tnode.filter = filter;\n\t}\n\n\tprivate swapComparison(node: CompareResultsNode) {\n\t\tif (!(node instanceof CompareResultsNode)) return undefined;\n\n\t\treturn node.swap();\n\t}\n\n\tprivate unpin(node: CompareResultsNode | SearchResultsNode) {\n\t\tif (!(node instanceof CompareResultsNode) && !(node instanceof SearchResultsNode)) return undefined;\n\n\t\treturn node.unpin();\n\t}\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tcommands,\n\tConfigurationChangeEvent,\n\tProgressLocation,\n\tTreeItem,\n\tTreeItemCollapsibleState,\n\twindow,\n} from 'vscode';\nimport { configuration, StashesViewConfig, ViewFilesLayout } from '../configuration';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport {\n\tGitReference,\n\tGitStashReference,\n\tRepositoryChange,\n\tRepositoryChangeComparisonMode,\n\tRepositoryChangeEvent,\n} from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { debug, gate, Strings } from '../system';\nimport { RepositoryFolderNode, RepositoryNode, StashesNode, StashNode, unknownGitUri, ViewNode } from './nodes';\nimport { ViewBase } from './viewBase';\n\nexport class StashesRepositoryNode extends RepositoryFolderNode<StashesView, StashesNode> {\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this.child == null) {\n\t\t\tthis.child = new StashesNode(this.uri, this.view, this, this.repo);\n\t\t}\n\n\t\treturn this.child.getChildren();\n\t}\n\n\tprotected changed(e: RepositoryChangeEvent) {\n\t\treturn e.changed(RepositoryChange.Stash, RepositoryChange.Unknown, RepositoryChangeComparisonMode.Any);\n\t}\n}\n\nexport class StashesViewNode extends ViewNode<StashesView> {\n\tprotected override splatted = true;\n\tprivate children: StashesRepositoryNode[] | undefined;\n\n\tconstructor(view: StashesView) {\n\t\tsuper(unknownGitUri, view);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this.children == null) {\n\t\t\tconst repositories = await Container.git.getOrderedRepositories();\n\t\t\tif (repositories.length === 0) {\n\t\t\t\tthis.view.message = 'No stashes could be found.';\n\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tthis.view.message = undefined;\n\n\t\t\tconst splat = repositories.length === 1;\n\t\t\tthis.children = repositories.map(\n\t\t\t\tr => new StashesRepositoryNode(GitUri.fromRepoPath(r.path), this.view, this, r, splat),\n\t\t\t);\n\t\t}\n\n\t\tif (this.children.length === 1) {\n\t\t\tconst [child] = this.children;\n\n\t\t\tif (!child.repo.supportsChangeEvents) {\n\t\t\t\tthis.view.description = `${Strings.pad(GlyphChars.Warning, 0, 2)}Auto-refresh unavailable`;\n\t\t\t}\n\n\t\t\tconst stash = await child.repo.getStash();\n\t\t\tif (stash == null) {\n\t\t\t\tthis.view.message = 'No stashes could be found.';\n\t\t\t\tthis.view.title = 'Stashes';\n\n\t\t\t\tvoid child.ensureSubscription();\n\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tthis.view.message = undefined;\n\t\t\tthis.view.title = `Stashes (${stash?.commits.size ?? 0})`;\n\n\t\t\treturn child.getChildren();\n\t\t}\n\n\t\treturn this.children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Stashes', TreeItemCollapsibleState.Expanded);\n\t\treturn item;\n\t}\n\n\toverride async getSplattedChild() {\n\t\tif (this.children == null) {\n\t\t\tawait this.getChildren();\n\t\t}\n\n\t\treturn this.children?.length === 1 ? this.children[0] : undefined;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset: boolean = false) {\n\t\tif (reset && this.children != null) {\n\t\t\tfor (const child of this.children) {\n\t\t\t\tchild.dispose();\n\t\t\t}\n\t\t\tthis.children = undefined;\n\t\t}\n\t}\n}\n\nexport class StashesView extends ViewBase<StashesViewNode, StashesViewConfig> {\n\tprotected readonly configKey = 'stashes';\n\n\tconstructor() {\n\t\tsuper('gitlens.views.stashes', 'Stashes');\n\t}\n\n\tgetRoot() {\n\t\treturn new StashesViewNode(this);\n\t}\n\n\tprotected registerCommands() {\n\t\tvoid Container.viewCommands;\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('copy'),\n\t\t\t() => commands.executeCommand('gitlens.views.copy', this.selection),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('refresh'),\n\t\t\tasync () => {\n\t\t\t\tawait Container.git.resetCaches('stashes');\n\t\t\t\treturn this.refresh(true);\n\t\t\t},\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToAuto'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Auto),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToList'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.List),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToTree'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Tree),\n\t\t\tthis,\n\t\t);\n\t}\n\n\tprotected override filterConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tconst changed = super.filterConfigurationChanged(e);\n\t\tif (\n\t\t\t!changed &&\n\t\t\t!configuration.changed(e, 'defaultDateFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateShortFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateSource') &&\n\t\t\t!configuration.changed(e, 'defaultDateStyle') &&\n\t\t\t!configuration.changed(e, 'defaultGravatarsStyle') &&\n\t\t\t!configuration.changed(e, 'defaultTimeFormat')\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tfindStash(stash: GitStashReference, token?: CancellationToken) {\n\t\tconst repoNodeId = RepositoryNode.getId(stash.repoPath);\n\n\t\treturn this.findNode(StashNode.getId(stash.repoPath, stash.ref), {\n\t\t\tmaxDepth: 2,\n\t\t\tcanTraverse: n => {\n\t\t\t\tif (n instanceof StashesViewNode) return true;\n\n\t\t\t\tif (n instanceof StashesRepositoryNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\ttoken: token,\n\t\t});\n\t}\n\n\t@gate(() => '')\n\tasync revealStash(\n\t\tstash: GitStashReference,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\treturn window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Revealing ${GitReference.toString(stash, { icon: false })} in the side bar...`,\n\t\t\t\tcancellable: true,\n\t\t\t},\n\t\t\tasync (progress, token) => {\n\t\t\t\tconst node = await this.findStash(stash, token);\n\t\t\t\tif (node == null) return undefined;\n\n\t\t\t\tawait this.ensureRevealNode(node, options);\n\n\t\t\t\treturn node;\n\t\t\t},\n\t\t);\n\t}\n\n\tprivate setFilesLayout(layout: ViewFilesLayout) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.files.layout` as const, layout);\n\t}\n}\n","'use strict';\nimport { commands, env, TextDocumentShowOptions, Uri, window } from 'vscode';\nimport { CreatePullRequestActionContext, OpenPullRequestActionContext } from '../api/gitlens';\nimport {\n\tCommands,\n\tDiffWithCommandArgs,\n\tDiffWithPreviousCommandArgs,\n\tDiffWithWorkingCommandArgs,\n\texecuteActionCommand,\n\texecuteCommand,\n\texecuteEditorCommand,\n\tGitActions,\n\tOpenFileAtRevisionCommandArgs,\n} from '../commands';\nimport { configuration, FileAnnotationType, ViewShowBranchComparison } from '../configuration';\nimport { BuiltInCommands, BuiltInGitCommands, ContextKeys, setContext } from '../constants';\nimport { Container } from '../container';\nimport { GitReference, GitRevision } from '../git/git';\nimport { GitService } from '../git/gitService';\nimport { GitUri } from '../git/gitUri';\nimport { debug } from '../system';\nimport { runGitCommandInTerminal } from '../terminal';\nimport {\n\tBranchesNode,\n\tBranchNode,\n\tBranchTrackingStatusNode,\n\tcanClearNode,\n\tcanEditNode,\n\tcanViewDismissNode,\n\tCommitFileNode,\n\tCommitNode,\n\tCompareBranchNode,\n\tContributorNode,\n\tContributorsNode,\n\tFileHistoryNode,\n\tFileRevisionAsCommitNode,\n\tFolderNode,\n\tLineHistoryNode,\n\tMergeConflictFileNode,\n\tPageableViewNode,\n\tPagerNode,\n\tPullRequestNode,\n\tRemoteNode,\n\tRemotesNode,\n\tRepositoryFolderNode,\n\tRepositoryNode,\n\tResultsFileNode,\n\tResultsFilesNode,\n\tStashFileNode,\n\tStashNode,\n\tStatusFileNode,\n\tTagNode,\n\tTagsNode,\n\tViewNode,\n\tViewRefFileNode,\n\tViewRefNode,\n} from './nodes';\n\ninterface CompareSelectedInfo {\n\tref: string;\n\trepoPath: string | undefined;\n\turi?: Uri;\n}\n\nexport class ViewCommands {\n\tconstructor() {\n\t\tcommands.registerCommand('gitlens.views.clearNode', (n: ViewNode) => canClearNode(n) && n.clear(), this);\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.copy',\n\t\t\tasync (selection: ViewNode | ViewNode[]) => {\n\t\t\t\tselection = Array.isArray(selection) ? selection : [selection];\n\t\t\t\tif (selection.length === 0) return;\n\n\t\t\t\tconst data = selection\n\t\t\t\t\t.map(n => n.toClipboard?.())\n\t\t\t\t\t.filter(s => s != null && s.length > 0)\n\t\t\t\t\t.join(',');\n\t\t\t\tawait env.clipboard.writeText(data);\n\t\t\t},\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.dismissNode',\n\t\t\t(n: ViewNode) => canViewDismissNode(n.view) && n.view.dismissNode(n),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand('gitlens.views.editNode', (n: ViewNode) => canEditNode(n) && n.edit(), this);\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.expandNode',\n\t\t\t(n: ViewNode) => n.view.reveal(n, { select: false, focus: false, expand: 3 }),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand('gitlens.views.loadMoreChildren', (n: PagerNode) => n.loadMore(), this);\n\t\tcommands.registerCommand('gitlens.views.loadAllChildren', (n: PagerNode) => n.loadAll(), this);\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.refreshNode',\n\t\t\t(n: ViewNode, reset?: boolean) => {\n\t\t\t\tif (reset == null && PageableViewNode.is(n)) {\n\t\t\t\t\tn.limit = undefined;\n\t\t\t\t\tn.view.resetNodeLastKnownLimit(n);\n\t\t\t\t}\n\n\t\t\t\treturn n.view.refreshNode(n, reset == null ? true : reset);\n\t\t\t},\n\t\t\tthis,\n\t\t);\n\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.setShowRelativeDateMarkersOn',\n\t\t\t() => this.setShowRelativeDateMarkers(true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.setShowRelativeDateMarkersOff',\n\t\t\t() => this.setShowRelativeDateMarkers(false),\n\t\t\tthis,\n\t\t);\n\n\t\tcommands.registerCommand('gitlens.views.fetch', this.fetch, this);\n\t\tcommands.registerCommand('gitlens.views.publishBranch', this.publishBranch, this);\n\t\tcommands.registerCommand('gitlens.views.publishRepository', this.publishRepository, this);\n\t\tcommands.registerCommand('gitlens.views.pull', this.pull, this);\n\t\tcommands.registerCommand('gitlens.views.push', this.push, this);\n\t\tcommands.registerCommand('gitlens.views.pushWithForce', n => this.push(n, true), this);\n\t\tcommands.registerCommand('gitlens.views.closeRepository', this.closeRepository, this);\n\n\t\tcommands.registerCommand('gitlens.views.setAsDefault', this.setAsDefault, this);\n\t\tcommands.registerCommand('gitlens.views.unsetAsDefault', this.unsetAsDefault, this);\n\n\t\tcommands.registerCommand('gitlens.views.openInTerminal', this.openInTerminal, this);\n\t\tcommands.registerCommand('gitlens.views.star', this.star, this);\n\t\tcommands.registerCommand('gitlens.views.unstar', this.unstar, this);\n\n\t\tcommands.registerCommand('gitlens.views.browseRepoAtRevision', this.browseRepoAtRevision, this);\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.browseRepoAtRevisionInNewWindow',\n\t\t\tn => this.browseRepoAtRevision(n, { openInNewWindow: true }),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.browseRepoBeforeRevision',\n\t\t\tn => this.browseRepoAtRevision(n, { before: true }),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.browseRepoBeforeRevisionInNewWindow',\n\t\t\tn => this.browseRepoAtRevision(n, { before: true, openInNewWindow: true }),\n\t\t\tthis,\n\t\t);\n\n\t\tcommands.registerCommand('gitlens.views.addAuthors', this.addAuthors, this);\n\t\tcommands.registerCommand('gitlens.views.addAuthor', this.addAuthors, this);\n\n\t\tcommands.registerCommand('gitlens.views.openChanges', this.openChanges, this);\n\t\tcommands.registerCommand('gitlens.views.openChangesWithWorking', this.openChangesWithWorking, this);\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.openPreviousChangesWithWorking',\n\t\t\tthis.openPreviousChangesWithWorking,\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand('gitlens.views.openFile', this.openFile, this);\n\t\tcommands.registerCommand('gitlens.views.openFileRevision', this.openRevision, this);\n\t\tcommands.registerCommand('gitlens.views.openChangedFiles', this.openFiles, this);\n\t\tcommands.registerCommand('gitlens.views.openChangedFileDiffs', this.openAllChanges, this);\n\t\tcommands.registerCommand('gitlens.views.openChangedFileDiffsWithWorking', this.openAllChangesWithWorking, this);\n\t\tcommands.registerCommand('gitlens.views.openChangedFileRevisions', this.openRevisions, this);\n\t\tcommands.registerCommand('gitlens.views.applyChanges', this.applyChanges, this);\n\t\tcommands.registerCommand('gitlens.views.highlightChanges', this.highlightChanges, this);\n\t\tcommands.registerCommand('gitlens.views.highlightRevisionChanges', this.highlightRevisionChanges, this);\n\t\tcommands.registerCommand('gitlens.views.restore', this.restore, this);\n\t\tcommands.registerCommand('gitlens.views.switchToBranch', this.switch, this);\n\t\tcommands.registerCommand('gitlens.views.switchToAnotherBranch', this.switch, this);\n\t\tcommands.registerCommand('gitlens.views.switchToCommit', this.switch, this);\n\t\tcommands.registerCommand('gitlens.views.switchToTag', this.switch, this);\n\t\tcommands.registerCommand('gitlens.views.addRemote', this.addRemote, this);\n\t\tcommands.registerCommand('gitlens.views.pruneRemote', this.pruneRemote, this);\n\n\t\tcommands.registerCommand('gitlens.views.stageDirectory', this.stageDirectory, this);\n\t\tcommands.registerCommand('gitlens.views.stageFile', this.stageFile, this);\n\t\tcommands.registerCommand('gitlens.views.unstageDirectory', this.unstageDirectory, this);\n\t\tcommands.registerCommand('gitlens.views.unstageFile', this.unstageFile, this);\n\n\t\tcommands.registerCommand('gitlens.views.compareAncestryWithWorking', this.compareAncestryWithWorking, this);\n\t\tcommands.registerCommand('gitlens.views.compareWithHead', this.compareHeadWith, this);\n\t\tcommands.registerCommand('gitlens.views.compareWithUpstream', this.compareWithUpstream, this);\n\t\tcommands.registerCommand('gitlens.views.compareWithSelected', this.compareWithSelected, this);\n\t\tcommands.registerCommand('gitlens.views.selectForCompare', this.selectForCompare, this);\n\t\tcommands.registerCommand('gitlens.views.compareFileWithSelected', this.compareFileWithSelected, this);\n\t\tcommands.registerCommand('gitlens.views.selectFileForCompare', this.selectFileForCompare, this);\n\t\tcommands.registerCommand('gitlens.views.compareWithWorking', this.compareWorkingWith, this);\n\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.setBranchComparisonToWorking',\n\t\t\tn => this.setBranchComparison(n, ViewShowBranchComparison.Working),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.setBranchComparisonToBranch',\n\t\t\tn => this.setBranchComparison(n, ViewShowBranchComparison.Branch),\n\t\t\tthis,\n\t\t);\n\n\t\tcommands.registerCommand('gitlens.views.cherryPick', this.cherryPick, this);\n\t\tcommands.registerCommand('gitlens.views.createBranch', this.createBranch, this);\n\t\tcommands.registerCommand('gitlens.views.deleteBranch', this.deleteBranch, this);\n\t\tcommands.registerCommand('gitlens.views.renameBranch', this.renameBranch, this);\n\t\tcommands.registerCommand('gitlens.views.deleteStash', this.deleteStash, this);\n\t\tcommands.registerCommand('gitlens.views.createTag', this.createTag, this);\n\t\tcommands.registerCommand('gitlens.views.deleteTag', this.deleteTag, this);\n\n\t\tcommands.registerCommand('gitlens.views.mergeBranchInto', this.merge, this);\n\t\tcommands.registerCommand('gitlens.views.pushToCommit', this.pushToCommit, this);\n\n\t\tcommands.registerCommand('gitlens.views.rebaseOntoBranch', this.rebase, this);\n\t\tcommands.registerCommand('gitlens.views.rebaseOntoUpstream', this.rebaseToRemote, this);\n\t\tcommands.registerCommand('gitlens.views.rebaseOntoCommit', this.rebase, this);\n\n\t\tcommands.registerCommand('gitlens.views.resetCommit', this.resetCommit, this);\n\t\tcommands.registerCommand('gitlens.views.resetToCommit', this.resetToCommit, this);\n\t\tcommands.registerCommand('gitlens.views.revert', this.revert, this);\n\t\tcommands.registerCommand('gitlens.views.undoCommit', this.undoCommit, this);\n\n\t\tcommands.registerCommand('gitlens.views.terminalRemoveRemote', this.terminalRemoveRemote, this);\n\n\t\tcommands.registerCommand('gitlens.views.createPullRequest', this.createPullRequest, this);\n\t\tcommands.registerCommand('gitlens.views.openPullRequest', this.openPullRequest, this);\n\t}\n\n\t@debug()\n\tprivate addAuthors(node?: ContributorNode | ContributorsNode) {\n\t\tif (node != null && !(node instanceof ContributorNode) && !(node instanceof ContributorsNode)) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn GitActions.Contributor.addAuthors(\n\t\t\tnode?.uri.repoPath,\n\t\t\tnode instanceof ContributorNode ? node.contributor : undefined,\n\t\t);\n\t}\n\n\t@debug()\n\tprivate addRemote(node?: RemotesNode) {\n\t\treturn GitActions.Remote.add(node?.repoPath);\n\t}\n\n\t@debug()\n\tprivate applyChanges(node: ViewRefFileNode) {\n\t\tif (!(node instanceof ViewRefFileNode)) return Promise.resolve();\n\n\t\tif (node instanceof ResultsFileNode) {\n\t\t\treturn GitActions.Commit.applyChanges(\n\t\t\t\tnode.file,\n\t\t\t\tGitReference.create(node.ref1, node.repoPath),\n\t\t\t\tGitReference.create(node.ref2, node.repoPath),\n\t\t\t);\n\t\t}\n\n\t\tif (node.ref == null || node.ref.ref === 'HEAD') return Promise.resolve();\n\n\t\treturn GitActions.Commit.applyChanges(node.file, node.ref);\n\t}\n\n\t@debug()\n\tprivate browseRepoAtRevision(node: ViewRefNode, options?: { before?: boolean; openInNewWindow?: boolean }) {\n\t\tif (!(node instanceof ViewRefNode)) return Promise.resolve();\n\n\t\treturn GitActions.browseAtRevision(node.uri, {\n\t\t\tbefore: options?.before,\n\t\t\topenInNewWindow: options?.openInNewWindow,\n\t\t});\n\t}\n\n\t@debug()\n\tprivate cherryPick(node: CommitNode) {\n\t\tif (!(node instanceof CommitNode)) return Promise.resolve();\n\n\t\treturn GitActions.cherryPick(node.repoPath, node.ref);\n\t}\n\n\t@debug()\n\tprivate closeRepository(node: RepositoryNode | RepositoryFolderNode) {\n\t\tif (!(node instanceof RepositoryNode) && !(node instanceof RepositoryFolderNode)) return;\n\n\t\tnode.repo.closed = true;\n\t}\n\n\t@debug()\n\tprivate async createBranch(node?: ViewRefNode | BranchesNode | BranchTrackingStatusNode) {\n\t\tlet from =\n\t\t\tnode instanceof ViewRefNode\n\t\t\t\t? node?.ref\n\t\t\t\t: node instanceof BranchTrackingStatusNode\n\t\t\t\t? node.branch\n\t\t\t\t: undefined;\n\t\tif (from == null) {\n\t\t\tconst branch = await Container.git.getBranch(node?.repoPath ?? (await Container.git.getActiveRepoPath()));\n\t\t\tfrom = branch;\n\t\t}\n\t\treturn GitActions.Branch.create(node?.repoPath, from);\n\t}\n\n\t@debug()\n\tprivate async createPullRequest(node: BranchNode | BranchTrackingStatusNode) {\n\t\tif (!(node instanceof BranchNode) && !(node instanceof BranchTrackingStatusNode)) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst remote = await node.branch.getRemote();\n\n\t\treturn executeActionCommand<CreatePullRequestActionContext>('createPullRequest', {\n\t\t\trepoPath: node.repoPath,\n\t\t\tremote:\n\t\t\t\tremote != null\n\t\t\t\t\t? {\n\t\t\t\t\t\t\tname: remote.name,\n\t\t\t\t\t\t\tprovider:\n\t\t\t\t\t\t\t\tremote.provider != null\n\t\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\t\tid: remote.provider.id,\n\t\t\t\t\t\t\t\t\t\t\tname: remote.provider.name,\n\t\t\t\t\t\t\t\t\t\t\tdomain: remote.provider.domain,\n\t\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t\turl: remote.url,\n\t\t\t\t\t  }\n\t\t\t\t\t: undefined,\n\t\t\tbranch: {\n\t\t\t\tname: node.branch.name,\n\t\t\t\tupstream: node.branch.upstream?.name,\n\t\t\t\tisRemote: node.branch.remote,\n\t\t\t},\n\t\t});\n\t}\n\n\t@debug()\n\tprivate async createTag(node?: ViewRefNode | TagsNode | BranchTrackingStatusNode) {\n\t\tlet from =\n\t\t\tnode instanceof ViewRefNode\n\t\t\t\t? node?.ref\n\t\t\t\t: node instanceof BranchTrackingStatusNode\n\t\t\t\t? node.branch\n\t\t\t\t: undefined;\n\t\tif (from == null) {\n\t\t\tconst branch = await Container.git.getBranch(node?.repoPath ?? (await Container.git.getActiveRepoPath()));\n\t\t\tfrom = branch;\n\t\t}\n\t\treturn GitActions.Tag.create(node?.repoPath, from);\n\t}\n\n\t@debug()\n\tprivate deleteBranch(node: BranchNode) {\n\t\tif (!(node instanceof BranchNode)) return Promise.resolve();\n\n\t\treturn GitActions.Branch.remove(node.repoPath, node.branch);\n\t}\n\n\t@debug()\n\tprivate deleteStash(node: StashNode) {\n\t\tif (!(node instanceof StashNode)) return Promise.resolve();\n\n\t\treturn GitActions.Stash.drop(node.repoPath, node.commit);\n\t}\n\n\t@debug()\n\tprivate deleteTag(node: TagNode) {\n\t\tif (!(node instanceof TagNode)) return Promise.resolve();\n\n\t\treturn GitActions.Tag.remove(node.repoPath, node.tag);\n\t}\n\n\t@debug()\n\tprivate fetch(node: RemoteNode | RepositoryNode | RepositoryFolderNode | BranchNode | BranchTrackingStatusNode) {\n\t\tif (node instanceof RepositoryNode || node instanceof RepositoryFolderNode) return GitActions.fetch(node.repo);\n\t\tif (node instanceof RemoteNode) return GitActions.Remote.fetch(node.remote.repoPath, node.remote.name);\n\t\tif (node instanceof BranchNode || node instanceof BranchTrackingStatusNode) {\n\t\t\treturn GitActions.fetch(node.repoPath, node.root ? undefined : node.branch);\n\t\t}\n\n\t\treturn Promise.resolve();\n\t}\n\n\t@debug()\n\tprivate async highlightChanges(node: CommitFileNode | StashFileNode | FileRevisionAsCommitNode | ResultsFileNode) {\n\t\tif (\n\t\t\t!(node instanceof CommitFileNode) &&\n\t\t\t!(node instanceof StashFileNode) &&\n\t\t\t!(node instanceof FileRevisionAsCommitNode) &&\n\t\t\t!(node instanceof ResultsFileNode)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tvoid (await this.openFile(node, { preserveFocus: true, preview: true }));\n\t\tvoid (await Container.fileAnnotations.toggle(\n\t\t\twindow.activeTextEditor,\n\t\t\tFileAnnotationType.Changes,\n\t\t\t{ sha: node.ref.ref },\n\t\t\ttrue,\n\t\t));\n\t}\n\n\t@debug()\n\tprivate async highlightRevisionChanges(\n\t\tnode: CommitFileNode | StashFileNode | FileRevisionAsCommitNode | ResultsFileNode,\n\t) {\n\t\tif (\n\t\t\t!(node instanceof CommitFileNode) &&\n\t\t\t!(node instanceof StashFileNode) &&\n\t\t\t!(node instanceof FileRevisionAsCommitNode) &&\n\t\t\t!(node instanceof ResultsFileNode)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tvoid (await this.openFile(node, { preserveFocus: true, preview: true }));\n\t\tvoid (await Container.fileAnnotations.toggle(\n\t\t\twindow.activeTextEditor,\n\t\t\tFileAnnotationType.Changes,\n\t\t\t{ sha: node.ref.ref, only: true },\n\t\t\ttrue,\n\t\t));\n\t}\n\n\t@debug()\n\tprivate merge(node: BranchNode | TagNode) {\n\t\tif (!(node instanceof BranchNode) && !(node instanceof TagNode)) return Promise.resolve();\n\n\t\treturn GitActions.merge(node.repoPath, node instanceof BranchNode ? node.branch : node.tag);\n\t}\n\n\t@debug()\n\tprivate pushToCommit(node: CommitNode | FileRevisionAsCommitNode) {\n\t\tif (!(node instanceof CommitNode) && !(node instanceof FileRevisionAsCommitNode)) return Promise.resolve();\n\n\t\treturn GitActions.push(node.repoPath, false, node.commit);\n\t}\n\n\t@debug()\n\tprivate openPullRequest(node: PullRequestNode) {\n\t\tif (!(node instanceof PullRequestNode)) return Promise.resolve();\n\n\t\treturn executeActionCommand<OpenPullRequestActionContext>('openPullRequest', {\n\t\t\trepoPath: node.uri.repoPath!,\n\t\t\tprovider: {\n\t\t\t\tid: node.pullRequest.provider.id,\n\t\t\t\tname: node.pullRequest.provider.name,\n\t\t\t\tdomain: node.pullRequest.provider.domain,\n\t\t\t},\n\t\t\tpullRequest: {\n\t\t\t\tid: node.pullRequest.id,\n\t\t\t\turl: node.pullRequest.url,\n\t\t\t},\n\t\t});\n\t}\n\n\t@debug()\n\tprivate openInTerminal(node: RepositoryNode | RepositoryFolderNode) {\n\t\tif (!(node instanceof RepositoryNode) && !(node instanceof RepositoryFolderNode)) return Promise.resolve();\n\n\t\treturn commands.executeCommand(BuiltInCommands.OpenInTerminal, Uri.file(node.repo.path));\n\t}\n\n\t@debug()\n\tprivate async pruneRemote(node: RemoteNode) {\n\t\tif (!(node instanceof RemoteNode)) return Promise.resolve();\n\n\t\treturn GitActions.Remote.prune(node.repo, node.remote.name);\n\t}\n\n\t@debug()\n\tprivate publishBranch(node: BranchNode | BranchTrackingStatusNode) {\n\t\tif (node instanceof BranchNode || node instanceof BranchTrackingStatusNode) {\n\t\t\treturn GitActions.push(node.repoPath, undefined, node.branch);\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\t@debug()\n\tprivate publishRepository(node: BranchNode | BranchTrackingStatusNode) {\n\t\tif (node instanceof BranchNode || node instanceof BranchTrackingStatusNode) {\n\t\t\treturn commands.executeCommand(BuiltInGitCommands.Publish, Uri.file(node.repoPath));\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\t@debug()\n\tprivate pull(node: RepositoryNode | RepositoryFolderNode | BranchNode | BranchTrackingStatusNode) {\n\t\tif (node instanceof RepositoryNode || node instanceof RepositoryFolderNode) return GitActions.pull(node.repo);\n\t\tif (node instanceof BranchNode || node instanceof BranchTrackingStatusNode) {\n\t\t\treturn GitActions.pull(node.repoPath, node.root ? undefined : node.branch);\n\t\t}\n\n\t\treturn Promise.resolve();\n\t}\n\n\t@debug()\n\tprivate push(\n\t\tnode:\n\t\t\t| RepositoryNode\n\t\t\t| RepositoryFolderNode\n\t\t\t| BranchNode\n\t\t\t| BranchTrackingStatusNode\n\t\t\t| CommitNode\n\t\t\t| FileRevisionAsCommitNode,\n\t\tforce?: boolean,\n\t) {\n\t\tif (node instanceof RepositoryNode || node instanceof RepositoryFolderNode) {\n\t\t\treturn GitActions.push(node.repo, force);\n\t\t}\n\n\t\tif (node instanceof BranchNode || node instanceof BranchTrackingStatusNode) {\n\t\t\treturn GitActions.push(node.repoPath, undefined, node.root ? undefined : node.branch);\n\t\t}\n\n\t\tif (node instanceof CommitNode || node instanceof FileRevisionAsCommitNode) {\n\t\t\tif (node.isTip) {\n\t\t\t\treturn GitActions.push(node.repoPath, force);\n\t\t\t}\n\n\t\t\treturn this.pushToCommit(node);\n\t\t}\n\n\t\treturn Promise.resolve();\n\t}\n\n\t@debug()\n\tprivate rebase(node: BranchNode | CommitNode | FileRevisionAsCommitNode | TagNode) {\n\t\tif (\n\t\t\t!(node instanceof BranchNode) &&\n\t\t\t!(node instanceof CommitNode) &&\n\t\t\t!(node instanceof FileRevisionAsCommitNode) &&\n\t\t\t!(node instanceof TagNode)\n\t\t) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn GitActions.rebase(node.repoPath, node.ref);\n\t}\n\n\t@debug()\n\tprivate rebaseToRemote(node: BranchNode | BranchTrackingStatusNode) {\n\t\tif (!(node instanceof BranchNode) && !(node instanceof BranchTrackingStatusNode)) return Promise.resolve();\n\n\t\tconst upstream = node instanceof BranchNode ? node.branch.upstream?.name : node.status.upstream;\n\t\tif (upstream == null) return Promise.resolve();\n\n\t\treturn GitActions.rebase(\n\t\t\tnode.repoPath,\n\t\t\tGitReference.create(upstream, node.repoPath, {\n\t\t\t\trefType: 'branch',\n\t\t\t\tname: upstream,\n\t\t\t\tremote: true,\n\t\t\t}),\n\t\t);\n\t}\n\n\t@debug()\n\tprivate renameBranch(node: BranchNode) {\n\t\tif (!(node instanceof BranchNode)) return Promise.resolve();\n\n\t\treturn GitActions.Branch.rename(node.repoPath, node.branch);\n\t}\n\n\t@debug()\n\tprivate resetCommit(node: CommitNode | FileRevisionAsCommitNode) {\n\t\tif (!(node instanceof CommitNode) && !(node instanceof FileRevisionAsCommitNode)) return Promise.resolve();\n\n\t\treturn GitActions.reset(\n\t\t\tnode.repoPath,\n\t\t\tGitReference.create(`${node.ref.ref}^`, node.ref.repoPath, {\n\t\t\t\trefType: 'revision',\n\t\t\t\tname: `${node.ref.name}^`,\n\t\t\t\tmessage: node.ref.message,\n\t\t\t}),\n\t\t);\n\t}\n\n\t@debug()\n\tprivate resetToCommit(node: CommitNode | FileRevisionAsCommitNode) {\n\t\tif (!(node instanceof CommitNode) && !(node instanceof FileRevisionAsCommitNode)) return Promise.resolve();\n\n\t\treturn GitActions.reset(node.repoPath, node.ref);\n\t}\n\n\t@debug()\n\tprivate restore(node: ViewRefFileNode) {\n\t\tif (!(node instanceof ViewRefFileNode)) return Promise.resolve();\n\n\t\treturn GitActions.Commit.restoreFile(node.fileName, node.ref);\n\t}\n\n\t@debug()\n\tprivate revert(node: CommitNode | FileRevisionAsCommitNode) {\n\t\tif (!(node instanceof CommitNode) && !(node instanceof FileRevisionAsCommitNode)) return Promise.resolve();\n\n\t\treturn GitActions.revert(node.repoPath, node.ref);\n\t}\n\n\t@debug()\n\tprivate setAsDefault(node: RemoteNode) {\n\t\tif (!(node instanceof RemoteNode)) return Promise.resolve();\n\n\t\treturn node.setAsDefault();\n\t}\n\n\t@debug()\n\tprivate setBranchComparison(node: ViewNode, comparisonType: Exclude<ViewShowBranchComparison, false>) {\n\t\tif (!(node instanceof CompareBranchNode)) return undefined;\n\n\t\treturn node.setComparisonType(comparisonType);\n\t}\n\n\t@debug()\n\tprivate setShowRelativeDateMarkers(enabled: boolean) {\n\t\treturn configuration.updateEffective('views.showRelativeDateMarkers', enabled);\n\t}\n\n\t@debug()\n\tprivate async stageFile(node: CommitFileNode | FileRevisionAsCommitNode | StatusFileNode) {\n\t\tif (\n\t\t\t!(node instanceof CommitFileNode) &&\n\t\t\t!(node instanceof FileRevisionAsCommitNode) &&\n\t\t\t!(node instanceof StatusFileNode)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tvoid (await Container.git.stageFile(node.repoPath, node.file.fileName));\n\t\tvoid node.triggerChange();\n\t}\n\n\t@debug()\n\tprivate async stageDirectory(node: FolderNode) {\n\t\tif (!(node instanceof FolderNode) || !node.relativePath) return;\n\n\t\tvoid (await Container.git.stageDirectory(node.repoPath, node.relativePath));\n\t\tvoid node.triggerChange();\n\t}\n\n\t@debug()\n\tprivate star(node: BranchNode | RepositoryNode | RepositoryFolderNode) {\n\t\tif (\n\t\t\t!(node instanceof BranchNode) &&\n\t\t\t!(node instanceof RepositoryNode) &&\n\t\t\t!(node instanceof RepositoryFolderNode)\n\t\t) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn node.star();\n\t}\n\n\t@debug()\n\tprivate switch(node?: ViewRefNode | BranchesNode) {\n\t\tif (node == null) {\n\t\t\treturn GitActions.switchTo(Container.git.getHighlanderRepoPath());\n\t\t}\n\n\t\tif (!(node instanceof ViewRefNode) && !(node instanceof BranchesNode)) return Promise.resolve();\n\n\t\treturn GitActions.switchTo(\n\t\t\tnode.repoPath,\n\t\t\tnode instanceof BranchesNode || (node instanceof BranchNode && node.branch.current) ? undefined : node.ref,\n\t\t);\n\t}\n\n\t@debug()\n\tprivate async undoCommit(node: CommitNode | FileRevisionAsCommitNode) {\n\t\tif (!(node instanceof CommitNode) && !(node instanceof FileRevisionAsCommitNode)) return;\n\n\t\tconst repo = await GitService.getOrOpenBuiltInGitRepository(node.repoPath);\n\t\tconst commit = await repo?.getCommit('HEAD');\n\n\t\tif (commit?.hash !== node.ref.ref) {\n\t\t\tvoid window.showWarningMessage(\n\t\t\t\t`Commit ${GitReference.toString(node.ref, {\n\t\t\t\t\tcapitalize: true,\n\t\t\t\t\ticon: false,\n\t\t\t\t})} cannot be undone, because it is no longer the most recent commit.`,\n\t\t\t);\n\n\t\t\treturn;\n\t\t}\n\n\t\tawait commands.executeCommand(BuiltInGitCommands.UndoCommit, node.repoPath);\n\t}\n\n\t@debug()\n\tprivate unsetAsDefault(node: RemoteNode) {\n\t\tif (!(node instanceof RemoteNode)) return Promise.resolve();\n\n\t\treturn node.setAsDefault(false);\n\t}\n\n\t@debug()\n\tprivate async unstageFile(node: CommitFileNode | FileRevisionAsCommitNode | StatusFileNode) {\n\t\tif (\n\t\t\t!(node instanceof CommitFileNode) &&\n\t\t\t!(node instanceof FileRevisionAsCommitNode) &&\n\t\t\t!(node instanceof StatusFileNode)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tvoid (await Container.git.unStageFile(node.repoPath, node.file.fileName));\n\t\tvoid node.triggerChange();\n\t}\n\n\t@debug()\n\tprivate async unstageDirectory(node: FolderNode) {\n\t\tif (!(node instanceof FolderNode) || !node.relativePath) return;\n\n\t\tvoid (await Container.git.unStageDirectory(node.repoPath, node.relativePath));\n\t\tvoid node.triggerChange();\n\t}\n\n\t@debug()\n\tprivate unstar(node: BranchNode | RepositoryNode | RepositoryFolderNode) {\n\t\tif (\n\t\t\t!(node instanceof BranchNode) &&\n\t\t\t!(node instanceof RepositoryNode) &&\n\t\t\t!(node instanceof RepositoryFolderNode)\n\t\t) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn node.unstar();\n\t}\n\n\t@debug()\n\tprivate compareHeadWith(node: ViewRefNode) {\n\t\tif (!(node instanceof ViewRefNode)) return Promise.resolve();\n\n\t\treturn Container.searchAndCompareView.compare(node.repoPath, 'HEAD', node.ref);\n\t}\n\n\t@debug()\n\tprivate compareWithUpstream(node: BranchNode) {\n\t\tif (!(node instanceof BranchNode)) return Promise.resolve();\n\t\tif (node.branch.upstream == null) return Promise.resolve();\n\n\t\treturn Container.searchAndCompareView.compare(node.repoPath, node.ref, node.branch.upstream.name);\n\t}\n\n\t@debug()\n\tprivate compareWorkingWith(node: ViewRefNode) {\n\t\tif (!(node instanceof ViewRefNode)) return Promise.resolve();\n\n\t\treturn Container.searchAndCompareView.compare(node.repoPath, '', node.ref);\n\t}\n\n\t@debug()\n\tprivate async compareAncestryWithWorking(node: BranchNode) {\n\t\tif (!(node instanceof BranchNode)) return undefined;\n\n\t\tconst branch = await Container.git.getBranch(node.repoPath);\n\t\tif (branch == null) return undefined;\n\n\t\tconst commonAncestor = await Container.git.getMergeBase(node.repoPath, branch.ref, node.ref.ref);\n\t\tif (commonAncestor == null) return undefined;\n\n\t\treturn Container.searchAndCompareView.compare(\n\t\t\tnode.repoPath,\n\t\t\t{ ref: commonAncestor, label: `ancestry with ${node.ref.ref} (${GitRevision.shorten(commonAncestor)})` },\n\t\t\t'',\n\t\t);\n\t}\n\n\t@debug()\n\tprivate compareWithSelected(node: ViewRefNode) {\n\t\tif (!(node instanceof ViewRefNode)) return;\n\n\t\tContainer.searchAndCompareView.compareWithSelected(node.repoPath, node.ref);\n\t}\n\n\t@debug()\n\tprivate selectForCompare(node: ViewRefNode) {\n\t\tif (!(node instanceof ViewRefNode)) return;\n\n\t\tContainer.searchAndCompareView.selectForCompare(node.repoPath, node.ref);\n\t}\n\n\t@debug()\n\tprivate compareFileWithSelected(node: ViewRefFileNode) {\n\t\tif (this._selectedFile == null || !(node instanceof ViewRefFileNode) || node.ref == null) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tif (this._selectedFile.repoPath !== node.repoPath) {\n\t\t\tthis.selectFileForCompare(node);\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst selected = this._selectedFile;\n\n\t\tthis._selectedFile = undefined;\n\t\tvoid setContext(ContextKeys.ViewsCanCompareFile, false);\n\n\t\treturn executeCommand<DiffWithCommandArgs>(Commands.DiffWith, {\n\t\t\trepoPath: selected.repoPath,\n\t\t\tlhs: {\n\t\t\t\tsha: selected.ref,\n\t\t\t\turi: selected.uri!,\n\t\t\t},\n\t\t\trhs: {\n\t\t\t\tsha: node.ref.ref,\n\t\t\t\turi: node.uri,\n\t\t\t},\n\t\t});\n\t}\n\n\tprivate _selectedFile: CompareSelectedInfo | undefined;\n\n\t@debug()\n\tprivate selectFileForCompare(node: ViewRefFileNode) {\n\t\tif (!(node instanceof ViewRefFileNode) || node.ref == null) return;\n\n\t\tthis._selectedFile = {\n\t\t\tref: node.ref.ref,\n\t\t\trepoPath: node.repoPath,\n\t\t\turi: node.uri,\n\t\t};\n\t\tvoid setContext(ContextKeys.ViewsCanCompareFile, true);\n\t}\n\n\t@debug()\n\tprivate async openAllChanges(node: CommitNode | StashNode | ResultsFilesNode, options?: TextDocumentShowOptions) {\n\t\tif (!(node instanceof CommitNode) && !(node instanceof StashNode) && !(node instanceof ResultsFilesNode)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (node instanceof ResultsFilesNode) {\n\t\t\tconst { files: diff } = await node.getFilesQueryResults();\n\t\t\tif (diff == null || diff.length === 0) return undefined;\n\n\t\t\treturn GitActions.Commit.openAllChanges(\n\t\t\t\tdiff,\n\t\t\t\t{\n\t\t\t\t\trepoPath: node.repoPath,\n\t\t\t\t\tref1: node.ref1,\n\t\t\t\t\tref2: node.ref2,\n\t\t\t\t},\n\t\t\t\toptions,\n\t\t\t);\n\t\t}\n\n\t\treturn GitActions.Commit.openAllChanges(node.commit, options);\n\t}\n\n\t@debug()\n\tprivate openChanges(node: ViewRefFileNode | MergeConflictFileNode | StatusFileNode) {\n\t\tif (\n\t\t\t!(node instanceof ViewRefFileNode) &&\n\t\t\t!(node instanceof MergeConflictFileNode) &&\n\t\t\t!(node instanceof StatusFileNode)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (node instanceof MergeConflictFileNode) {\n\t\t\tvoid executeCommand<DiffWithCommandArgs>(Commands.DiffWith, {\n\t\t\t\tlhs: {\n\t\t\t\t\tsha: node.status.HEAD.ref,\n\t\t\t\t\turi: GitUri.fromFile(node.file, node.repoPath, undefined, true),\n\t\t\t\t},\n\t\t\t\trhs: {\n\t\t\t\t\tsha: 'HEAD',\n\t\t\t\t\turi: GitUri.fromFile(node.file, node.repoPath),\n\t\t\t\t},\n\t\t\t\trepoPath: node.repoPath,\n\t\t\t\tline: 0,\n\t\t\t\tshowOptions: {\n\t\t\t\t\tpreserveFocus: false,\n\t\t\t\t\tpreview: false,\n\t\t\t\t},\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst command = node.getCommand();\n\t\tif (command?.arguments == null) return;\n\n\t\tswitch (command.command) {\n\t\t\tcase Commands.DiffWith: {\n\t\t\t\tconst [args] = command.arguments as [DiffWithCommandArgs];\n\t\t\t\targs.showOptions!.preview = false;\n\t\t\t\tvoid executeCommand<DiffWithCommandArgs>(command.command, args);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase Commands.DiffWithPrevious: {\n\t\t\t\tconst [, args] = command.arguments as [Uri, DiffWithPreviousCommandArgs];\n\t\t\t\targs.showOptions!.preview = false;\n\t\t\t\tvoid executeEditorCommand<DiffWithPreviousCommandArgs>(command.command, undefined, args);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdefault:\n\t\t\t\tthrow new Error(`Unexpected command: ${command.command}`);\n\t\t}\n\n\t\t// TODO@eamodio Revisit this\n\t\t// return GitActions.Commit.openChanges(node.file, node instanceof ViewRefFileNode ? node.ref : node.commit, {\n\t\t// \tpreserveFocus: true,\n\t\t// \tpreview: false,\n\t\t// });\n\t}\n\n\t@debug()\n\tprivate async openAllChangesWithWorking(\n\t\tnode: CommitNode | StashNode | ResultsFilesNode,\n\t\toptions?: TextDocumentShowOptions,\n\t) {\n\t\tif (!(node instanceof CommitNode) && !(node instanceof StashNode) && !(node instanceof ResultsFilesNode)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (node instanceof ResultsFilesNode) {\n\t\t\tconst { files: diff } = await node.getFilesQueryResults();\n\t\t\tif (diff == null || diff.length === 0) return undefined;\n\n\t\t\treturn GitActions.Commit.openAllChangesWithWorking(\n\t\t\t\tdiff,\n\t\t\t\t{\n\t\t\t\t\trepoPath: node.repoPath,\n\t\t\t\t\tref: node.ref1 || node.ref2,\n\t\t\t\t},\n\t\t\t\toptions,\n\t\t\t);\n\t\t}\n\n\t\treturn GitActions.Commit.openAllChangesWithWorking(node.commit, options);\n\n\t\t// options = { preserveFocus: false, preview: false, ...options };\n\n\t\t// let repoPath: string;\n\t\t// let files;\n\t\t// let ref: string;\n\n\t\t// if (node instanceof ResultsFilesNode) {\n\t\t// \tconst { diff } = await node.getFilesQueryResults();\n\t\t// \tif (diff == null || diff.length === 0) return;\n\n\t\t// \trepoPath = node.repoPath;\n\t\t// \tfiles = diff;\n\t\t// \tref = node.ref1 || node.ref2;\n\t\t// } else {\n\t\t// \trepoPath = node.commit.repoPath;\n\t\t// \tfiles = node.commit.files;\n\t\t// \tref = node.commit.sha;\n\t\t// }\n\n\t\t// if (files.length > 20) {\n\t\t// \tconst result = await window.showWarningMessage(\n\t\t// \t\t`Are your sure you want to open all ${files.length} files?`,\n\t\t// \t\t{ title: 'Yes' },\n\t\t// \t\t{ title: 'No', isCloseAffordance: true },\n\t\t// \t);\n\t\t// \tif (result == null || result.title === 'No') return;\n\t\t// }\n\n\t\t// for (const file of files) {\n\t\t// \tif (file.status === 'A' || file.status === 'D') continue;\n\n\t\t// \tconst args: DiffWithWorkingCommandArgs = {\n\t\t// \t\tshowOptions: options,\n\t\t// \t};\n\n\t\t// \tconst uri = GitUri.fromFile(file, repoPath, ref);\n\t\t// \tawait commands.executeCommand(Commands.DiffWithWorking, uri, args);\n\t\t// }\n\t}\n\n\t@debug()\n\tprivate async openChangesWithWorking(node: ViewRefFileNode | MergeConflictFileNode | StatusFileNode) {\n\t\tif (\n\t\t\t!(node instanceof ViewRefFileNode) &&\n\t\t\t!(node instanceof MergeConflictFileNode) &&\n\t\t\t!(node instanceof StatusFileNode)\n\t\t) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tif (node instanceof StatusFileNode) {\n\t\t\treturn executeEditorCommand<DiffWithWorkingCommandArgs>(Commands.DiffWithWorking, undefined, {\n\t\t\t\turi: node.uri,\n\t\t\t\tshowOptions: {\n\t\t\t\t\tpreserveFocus: true,\n\t\t\t\t\tpreview: true,\n\t\t\t\t},\n\t\t\t});\n\t\t} else if (node instanceof MergeConflictFileNode) {\n\t\t\treturn executeEditorCommand<DiffWithWorkingCommandArgs>(Commands.DiffWithWorking, undefined, {\n\t\t\t\turi: node.baseUri,\n\t\t\t\tshowOptions: {\n\t\t\t\t\tpreserveFocus: true,\n\t\t\t\t\tpreview: true,\n\t\t\t\t},\n\t\t\t});\n\t\t} else if (node instanceof FileRevisionAsCommitNode && node.commit.hasConflicts) {\n\t\t\tconst baseUri = await node.getConflictBaseUri();\n\t\t\tif (baseUri != null) {\n\t\t\t\treturn executeEditorCommand<DiffWithWorkingCommandArgs>(Commands.DiffWithWorking, undefined, {\n\t\t\t\t\turi: baseUri,\n\t\t\t\t\tshowOptions: {\n\t\t\t\t\t\tpreserveFocus: true,\n\t\t\t\t\t\tpreview: true,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn GitActions.Commit.openChangesWithWorking(node.file, { repoPath: node.repoPath, ref: node.ref.ref });\n\t}\n\n\t@debug()\n\tprivate async openPreviousChangesWithWorking(node: ViewRefFileNode) {\n\t\tif (!(node instanceof ViewRefFileNode)) return Promise.resolve();\n\n\t\treturn GitActions.Commit.openChangesWithWorking(node.file, {\n\t\t\trepoPath: node.repoPath,\n\t\t\tref: `${node.ref.ref}^`,\n\t\t});\n\t}\n\n\t@debug()\n\tprivate openFile(\n\t\tnode: ViewRefFileNode | MergeConflictFileNode | StatusFileNode | FileHistoryNode | LineHistoryNode,\n\t\toptions?: TextDocumentShowOptions,\n\t) {\n\t\tif (\n\t\t\t!(node instanceof ViewRefFileNode) &&\n\t\t\t!(node instanceof MergeConflictFileNode) &&\n\t\t\t!(node instanceof StatusFileNode) &&\n\t\t\t!(node instanceof FileHistoryNode) &&\n\t\t\t!(node instanceof LineHistoryNode)\n\t\t) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn GitActions.Commit.openFile(node.uri, {\n\t\t\tpreserveFocus: true,\n\t\t\tpreview: false,\n\t\t\t...options,\n\t\t});\n\t}\n\n\t@debug()\n\tprivate async openFiles(node: CommitNode | StashNode | ResultsFilesNode) {\n\t\tif (!(node instanceof CommitNode) && !(node instanceof StashNode) && !(node instanceof ResultsFilesNode)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (node instanceof ResultsFilesNode) {\n\t\t\tconst { files: diff } = await node.getFilesQueryResults();\n\t\t\tif (diff == null || diff.length === 0) return undefined;\n\n\t\t\treturn GitActions.Commit.openFiles(diff, node.repoPath, node.ref1 || node.ref2);\n\t\t}\n\n\t\treturn GitActions.Commit.openFiles(node.commit);\n\t}\n\n\t@debug()\n\tprivate openRevision(\n\t\tnode:\n\t\t\t| CommitFileNode\n\t\t\t| FileRevisionAsCommitNode\n\t\t\t| ResultsFileNode\n\t\t\t| StashFileNode\n\t\t\t| MergeConflictFileNode\n\t\t\t| StatusFileNode,\n\t\toptions?: OpenFileAtRevisionCommandArgs,\n\t) {\n\t\tif (\n\t\t\t!(node instanceof CommitFileNode) &&\n\t\t\t!(node instanceof FileRevisionAsCommitNode) &&\n\t\t\t!(node instanceof ResultsFileNode) &&\n\t\t\t!(node instanceof StashFileNode) &&\n\t\t\t!(node instanceof MergeConflictFileNode) &&\n\t\t\t!(node instanceof StatusFileNode)\n\t\t) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\toptions = { showOptions: { preserveFocus: true, preview: false }, ...options };\n\n\t\tlet uri = options.revisionUri;\n\t\tif (uri == null) {\n\t\t\tif (node instanceof ResultsFileNode || node instanceof MergeConflictFileNode) {\n\t\t\t\turi = GitUri.toRevisionUri(node.uri);\n\t\t\t} else {\n\t\t\t\turi =\n\t\t\t\t\tnode.commit.status === 'D'\n\t\t\t\t\t\t? GitUri.toRevisionUri(\n\t\t\t\t\t\t\t\tnode.commit.previousSha!,\n\t\t\t\t\t\t\t\tnode.commit.previousUri.fsPath,\n\t\t\t\t\t\t\t\tnode.commit.repoPath,\n\t\t\t\t\t\t  )\n\t\t\t\t\t\t: GitUri.toRevisionUri(node.uri);\n\t\t\t}\n\t\t}\n\n\t\treturn GitActions.Commit.openFileAtRevision(\n\t\t\turi,\n\t\t\toptions.showOptions ?? { preserveFocus: true, preview: false },\n\t\t);\n\t}\n\n\t@debug()\n\tprivate async openRevisions(node: CommitNode | StashNode | ResultsFilesNode, _options?: TextDocumentShowOptions) {\n\t\tif (!(node instanceof CommitNode) && !(node instanceof StashNode) && !(node instanceof ResultsFilesNode)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (node instanceof ResultsFilesNode) {\n\t\t\tconst { files: diff } = await node.getFilesQueryResults();\n\t\t\tif (diff == null || diff.length === 0) return undefined;\n\n\t\t\treturn GitActions.Commit.openFilesAtRevision(diff, node.repoPath, node.ref1, node.ref2);\n\t\t}\n\n\t\treturn GitActions.Commit.openFilesAtRevision(node.commit);\n\t}\n\n\tprivate terminalRemoveRemote(node: RemoteNode) {\n\t\tif (!(node instanceof RemoteNode)) return;\n\n\t\trunGitCommandInTerminal('remote', `remove ${node.remote.name}`, node.remote.repoPath);\n\t}\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tDisposable,\n\tEvent,\n\tEventEmitter,\n\tFileDecoration,\n\tFileDecorationProvider,\n\tThemeColor,\n\tUri,\n\twindow,\n} from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { GitBranchStatus } from '../git/git';\n\nexport class ViewFileDecorationProvider implements FileDecorationProvider, Disposable {\n\tprivate readonly _onDidChange = new EventEmitter<undefined | Uri | Uri[]>();\n\tget onDidChange(): Event<undefined | Uri | Uri[]> {\n\t\treturn this._onDidChange.event;\n\t}\n\n\tprivate readonly disposable: Disposable;\n\tconstructor() {\n\t\tthis.disposable = Disposable.from(\n\t\t\t// Register the current branch decorator separately (since we can only have 2 char's per decoration)\n\t\t\twindow.registerFileDecorationProvider({\n\t\t\t\tprovideFileDecoration: (uri, token) => {\n\t\t\t\t\tif (uri.scheme !== 'gitlens-view') return undefined;\n\n\t\t\t\t\tif (uri.authority === 'branch') {\n\t\t\t\t\t\treturn this.provideBranchCurrentDecoration(uri, token);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (uri.authority === 'remote') {\n\t\t\t\t\t\treturn this.provideRemoteDefaultDecoration(uri, token);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn undefined;\n\t\t\t\t},\n\t\t\t}),\n\t\t\twindow.registerFileDecorationProvider(this),\n\t\t);\n\t}\n\n\tdispose(): void {\n\t\tthis.disposable.dispose();\n\t}\n\n\tprovideFileDecoration(uri: Uri, token: CancellationToken): FileDecoration | undefined {\n\t\tif (uri.scheme !== 'gitlens-view') return undefined;\n\n\t\tswitch (uri.authority) {\n\t\t\tcase 'branch':\n\t\t\t\treturn this.provideBranchStatusDecoration(uri, token);\n\t\t\tcase 'commit-file':\n\t\t\t\treturn this.provideCommitFileStatusDecoration(uri, token);\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprovideCommitFileStatusDecoration(uri: Uri, _token: CancellationToken): FileDecoration | undefined {\n\t\tconst [, , status] = uri.path.split('/');\n\n\t\tswitch (status) {\n\t\t\tcase '!':\n\t\t\t\treturn {\n\t\t\t\t\tbadge: 'I',\n\t\t\t\t\tcolor: new ThemeColor('gitlens.decorations.ignoredForegroundColor'),\n\t\t\t\t\ttooltip: 'Ignored',\n\t\t\t\t};\n\t\t\tcase '?':\n\t\t\t\treturn {\n\t\t\t\t\tbadge: 'U',\n\t\t\t\t\tcolor: new ThemeColor('gitlens.decorations.untrackedForegroundColor'),\n\t\t\t\t\ttooltip: 'Untracked',\n\t\t\t\t};\n\t\t\tcase 'A':\n\t\t\t\treturn {\n\t\t\t\t\tbadge: 'A',\n\t\t\t\t\tcolor: new ThemeColor('gitlens.decorations.addedForegroundColor'),\n\t\t\t\t\ttooltip: 'Added',\n\t\t\t\t};\n\t\t\tcase 'C':\n\t\t\t\treturn {\n\t\t\t\t\tbadge: 'C',\n\t\t\t\t\tcolor: new ThemeColor('gitlens.decorations.copiedForegroundColor'),\n\t\t\t\t\ttooltip: 'Copied',\n\t\t\t\t};\n\t\t\tcase 'D':\n\t\t\t\treturn {\n\t\t\t\t\tbadge: 'D',\n\t\t\t\t\tcolor: new ThemeColor('gitlens.decorations.deletedForegroundColor'),\n\t\t\t\t\ttooltip: 'Deleted',\n\t\t\t\t};\n\t\t\tcase 'M':\n\t\t\t\treturn {\n\t\t\t\t\tbadge: 'M',\n\t\t\t\t\t// color: new ThemeColor('gitlens.decorations.modifiedForegroundColor'),\n\t\t\t\t\ttooltip: 'Modified',\n\t\t\t\t};\n\t\t\tcase 'R':\n\t\t\t\treturn {\n\t\t\t\t\tbadge: 'R',\n\t\t\t\t\tcolor: new ThemeColor('gitlens.decorations.renamedForegroundColor'),\n\t\t\t\t\ttooltip: 'Renamed',\n\t\t\t\t};\n\t\t\tdefault:\n\t\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprovideBranchStatusDecoration(uri: Uri, _token: CancellationToken): FileDecoration | undefined {\n\t\tconst [, , status] = uri.path.split('/');\n\n\t\tswitch (status as GitBranchStatus) {\n\t\t\tcase GitBranchStatus.Ahead:\n\t\t\t\treturn {\n\t\t\t\t\tbadge: '',\n\t\t\t\t\tcolor: new ThemeColor('gitlens.decorations.branchAheadForegroundColor'),\n\t\t\t\t\ttooltip: 'Ahead',\n\t\t\t\t};\n\t\t\tcase GitBranchStatus.Behind:\n\t\t\t\treturn {\n\t\t\t\t\tbadge: '',\n\t\t\t\t\tcolor: new ThemeColor('gitlens.decorations.branchBehindForegroundColor'),\n\t\t\t\t\ttooltip: 'Behind',\n\t\t\t\t};\n\t\t\tcase GitBranchStatus.Diverged:\n\t\t\t\treturn {\n\t\t\t\t\tbadge: '',\n\t\t\t\t\tcolor: new ThemeColor('gitlens.decorations.branchDivergedForegroundColor'),\n\t\t\t\t\ttooltip: 'Diverged',\n\t\t\t\t};\n\t\t\tcase GitBranchStatus.MissingUpstream:\n\t\t\t\treturn {\n\t\t\t\t\tbadge: '!',\n\t\t\t\t\tcolor: new ThemeColor('gitlens.decorations.branchMissingUpstreamForegroundColor'),\n\t\t\t\t\ttooltip: 'Missing Upstream',\n\t\t\t\t};\n\t\t\tcase GitBranchStatus.UpToDate:\n\t\t\t\treturn {\n\t\t\t\t\tbadge: '',\n\t\t\t\t\tcolor: new ThemeColor('gitlens.decorations.branchUpToDateForegroundColor'),\n\t\t\t\t\ttooltip: 'Up to Date',\n\t\t\t\t};\n\t\t\tcase GitBranchStatus.Unpublished:\n\t\t\t\treturn {\n\t\t\t\t\tbadge: '+',\n\t\t\t\t\tcolor: new ThemeColor('gitlens.decorations.branchUnpublishedForegroundColor'),\n\t\t\t\t\ttooltip: 'Unpublished',\n\t\t\t\t};\n\t\t\tdefault:\n\t\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprovideBranchCurrentDecoration(uri: Uri, _token: CancellationToken): FileDecoration | undefined {\n\t\tconst [, , status, current] = uri.path.split('/');\n\n\t\tif (!current) return undefined;\n\n\t\tlet color;\n\t\tswitch (status as GitBranchStatus) {\n\t\t\tcase GitBranchStatus.Ahead:\n\t\t\t\tcolor = new ThemeColor('gitlens.decorations.branchAheadForegroundColor');\n\t\t\t\tbreak;\n\t\t\tcase GitBranchStatus.Behind:\n\t\t\t\tcolor = new ThemeColor('gitlens.decorations.branchBehindForegroundColor');\n\t\t\t\tbreak;\n\t\t\tcase GitBranchStatus.Diverged:\n\t\t\t\tcolor = new ThemeColor('gitlens.decorations.branchDivergedForegroundColor');\n\t\t\t\tbreak;\n\t\t\tcase GitBranchStatus.UpToDate:\n\t\t\t\tcolor = new ThemeColor('gitlens.decorations.branchUpToDateForegroundColor');\n\t\t\t\tbreak;\n\t\t\tcase GitBranchStatus.Unpublished:\n\t\t\t\tcolor = new ThemeColor('gitlens.decorations.branchUnpublishedForegroundColor');\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn {\n\t\t\tbadge: GlyphChars.Check,\n\t\t\tcolor: color,\n\t\t\ttooltip: 'Current Branch',\n\t\t};\n\t}\n\n\tprovideRemoteDefaultDecoration(uri: Uri, _token: CancellationToken): FileDecoration | undefined {\n\t\tconst [, isDefault] = uri.path.split('/');\n\n\t\tif (!isDefault) return undefined;\n\n\t\treturn {\n\t\t\tbadge: GlyphChars.Check,\n\t\t\ttooltip: 'Default Remote',\n\t\t};\n\t}\n}\n","'use strict';\nimport { Config } from '../config';\n\nexport interface IpcMessage {\n\tid: string;\n\tmethod: string;\n\tparams?: any;\n}\n\nexport type IpcNotificationParamsOf<NT> = NT extends IpcNotificationType<infer P> ? P : never;\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport class IpcNotificationType<P = any> {\n\tconstructor(public readonly method: string) {}\n}\n\nexport type IpcCommandParamsOf<CT> = CT extends IpcCommandType<infer P> ? P : never;\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport class IpcCommandType<P = any> {\n\tconstructor(public readonly method: string) {}\n}\n\nexport function onIpcCommand<CT extends IpcCommandType>(\n\ttype: CT,\n\tcommand: IpcMessage,\n\tfn: (params: IpcCommandParamsOf<CT>) => unknown,\n) {\n\tfn(command.params);\n}\n\nexport function onIpcNotification<NT extends IpcNotificationType>(\n\ttype: NT,\n\tnotification: IpcMessage,\n\tfn: (params: IpcNotificationParamsOf<NT>) => void,\n) {\n\tfn(notification.params);\n}\n\nexport interface DidChangeConfigurationNotificationParams {\n\tconfig: Config;\n\tcustomSettings: Record<string, boolean>;\n}\nexport const DidChangeConfigurationNotificationType = new IpcNotificationType<DidChangeConfigurationNotificationParams>(\n\t'configuration/didChange',\n);\n\nexport const ReadyCommandType = new IpcCommandType('webview/ready');\n\nexport interface UpdateConfigurationCommandParams {\n\tchanges: {\n\t\t[key: string]: any;\n\t};\n\tremoves: string[];\n\tscope: 'user' | 'workspace';\n\turi?: string;\n}\nexport const UpdateConfigurationCommandType = new IpcCommandType<UpdateConfigurationCommandParams>(\n\t'configuration/update',\n);\n\nexport interface CommitPreviewConfigurationCommandParams {\n\tkey: string;\n\tid: string;\n\ttype: 'commit';\n\n\tformat: string;\n}\n\ntype PreviewConfigurationCommandParams = CommitPreviewConfigurationCommandParams;\nexport const PreviewConfigurationCommandType = new IpcCommandType<PreviewConfigurationCommandParams>(\n\t'configuration/preview',\n);\n\nexport interface DidPreviewConfigurationNotificationParams {\n\tid: string;\n\tpreview: string;\n}\nexport const DidPreviewConfigurationNotificationType =\n\tnew IpcNotificationType<DidPreviewConfigurationNotificationParams>('configuration/didPreview');\n\nexport interface SettingsDidRequestJumpToNotificationParams {\n\tanchor: string;\n}\nexport const SettingsDidRequestJumpToNotificationType =\n\tnew IpcNotificationType<SettingsDidRequestJumpToNotificationParams>('settings/jumpTo');\n\nexport interface AppStateWithConfig {\n\tconfig: Config;\n\tcustomSettings?: Record<string, boolean>;\n}\n\nexport interface SettingsState extends AppStateWithConfig {\n\tscope: 'user' | 'workspace';\n\tscopes: ['user' | 'workspace', string][];\n}\n\nexport type WelcomeState = AppStateWithConfig;\n\nexport interface Author {\n\treadonly author: string;\n\treadonly avatarUrl: string;\n\treadonly email: string | undefined;\n}\n\nexport interface Commit {\n\treadonly ref: string;\n\treadonly author: string;\n\t// readonly avatarUrl: string;\n\treadonly date: string;\n\treadonly dateFromNow: string;\n\t// readonly email: string | undefined;\n\treadonly message: string;\n\t// readonly command: string;\n}\n\nexport type RebaseEntryAction = 'pick' | 'reword' | 'edit' | 'squash' | 'fixup' | 'break' | 'drop';\n\nexport interface RebaseEntry {\n\treadonly action: RebaseEntryAction;\n\treadonly ref: string;\n\treadonly message: string;\n\treadonly index: number;\n}\n\nexport interface RebaseDidChangeNotificationParams {\n\tstate: RebaseState;\n}\nexport const RebaseDidChangeNotificationType = new IpcNotificationType<RebaseDidChangeNotificationParams>(\n\t'rebase/change',\n);\n\nexport const RebaseDidAbortCommandType = new IpcCommandType('rebase/abort');\n\nexport const RebaseDidDisableCommandType = new IpcCommandType('rebase/disable');\n\nexport const RebaseDidStartCommandType = new IpcCommandType('rebase/start');\n\nexport const RebaseDidSwitchCommandType = new IpcCommandType('rebase/switch');\n\nexport interface RebaseDidChangeEntryCommandParams {\n\tref: string;\n\taction: RebaseEntryAction;\n}\nexport const RebaseDidChangeEntryCommandType = new IpcCommandType<RebaseDidChangeEntryCommandParams>(\n\t'rebase/change/entry',\n);\n\nexport interface RebaseDidMoveEntryCommandParams {\n\tref: string;\n\tto: number;\n\trelative: boolean;\n}\nexport const RebaseDidMoveEntryCommandType = new IpcCommandType<RebaseDidMoveEntryCommandParams>('rebase/move/entry');\n\nexport interface RebaseState {\n\tbranch: string;\n\tonto: string;\n\n\tentries: RebaseEntry[];\n\tauthors: Author[];\n\tcommits: Commit[];\n\tcommands: {\n\t\tcommit: string;\n\t};\n}\n","'use strict';\nimport { randomBytes } from 'crypto';\nimport { TextDecoder } from 'util';\nimport {\n\tCancellationToken,\n\tcommands,\n\tConfigurationTarget,\n\tCustomTextEditorProvider,\n\tDisposable,\n\tPosition,\n\tRange,\n\tTextDocument,\n\tUri,\n\tWebviewPanel,\n\twindow,\n\tworkspace,\n\tWorkspaceEdit,\n} from 'vscode';\nimport { ShowQuickCommitCommand } from '../commands';\nimport { configuration } from '../configuration';\nimport { BuiltInCommands } from '../constants';\nimport { Container } from '../container';\nimport { RepositoryChange, RepositoryChangeComparisonMode } from '../git/git';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { debug, gate, Iterables, Strings } from '../system';\nimport {\n\tAuthor,\n\tCommit,\n\tIpcMessage,\n\tonIpcCommand,\n\tRebaseDidAbortCommandType,\n\tRebaseDidChangeEntryCommandType,\n\tRebaseDidChangeNotificationType,\n\tRebaseDidDisableCommandType,\n\tRebaseDidMoveEntryCommandType,\n\tRebaseDidStartCommandType,\n\tRebaseDidSwitchCommandType,\n\tRebaseEntry,\n\tRebaseEntryAction,\n\tRebaseState,\n} from './protocol';\n\nlet ipcSequence = 0;\nfunction nextIpcId() {\n\tif (ipcSequence === Number.MAX_SAFE_INTEGER) {\n\t\tipcSequence = 1;\n\t} else {\n\t\tipcSequence++;\n\t}\n\n\treturn `host:${ipcSequence}`;\n}\n\nlet webviewId = 0;\nfunction nextWebviewId() {\n\tif (webviewId === Number.MAX_SAFE_INTEGER) {\n\t\twebviewId = 1;\n\t} else {\n\t\twebviewId++;\n\t}\n\n\treturn webviewId;\n}\n\nconst rebaseRegex = /^\\s?#\\s?Rebase\\s([0-9a-f]+)(?:..([0-9a-f]+))?\\sonto\\s([0-9a-f]+)\\s.*$/im;\nconst rebaseCommandsRegex = /^\\s?(p|pick|r|reword|e|edit|s|squash|f|fixup|d|drop)\\s([0-9a-f]+?)\\s(.*)$/gm;\n\nconst rebaseActionsMap = new Map<string, RebaseEntryAction>([\n\t['p', 'pick'],\n\t['pick', 'pick'],\n\t['r', 'reword'],\n\t['reword', 'reword'],\n\t['e', 'edit'],\n\t['edit', 'edit'],\n\t['s', 'squash'],\n\t['squash', 'squash'],\n\t['f', 'fixup'],\n\t['fixup', 'fixup'],\n\t['d', 'drop'],\n\t['drop', 'drop'],\n]);\n\ninterface RebaseEditorContext {\n\tdispose(): void;\n\n\treadonly id: number;\n\treadonly document: TextDocument;\n\treadonly panel: WebviewPanel;\n\treadonly repoPath: string;\n\treadonly subscriptions: Disposable[];\n\n\tabortOnClose: boolean;\n\tpendingChange?: boolean;\n}\n\nexport class RebaseEditorProvider implements CustomTextEditorProvider, Disposable {\n\tprivate readonly _disposable: Disposable;\n\n\tconstructor() {\n\t\tthis._disposable = Disposable.from(\n\t\t\twindow.registerCustomEditorProvider('gitlens.rebase', this, {\n\t\t\t\tsupportsMultipleEditorsPerDocument: false,\n\t\t\t\twebviewOptions: {\n\t\t\t\t\tretainContextWhenHidden: true,\n\t\t\t\t},\n\t\t\t}),\n\t\t);\n\t}\n\n\tdispose() {\n\t\tthis._disposable.dispose();\n\t}\n\n\tget enabled(): boolean {\n\t\tconst associations = configuration.inspectAny<\n\t\t\t{ [key: string]: string } | { viewType: string; filenamePattern: string }[]\n\t\t>('workbench.editorAssociations')?.globalValue;\n\t\tif (associations == null || associations.length === 0) return true;\n\n\t\tif (Array.isArray(associations)) {\n\t\t\tconst association = associations.find(a => a.filenamePattern === 'git-rebase-todo');\n\t\t\treturn association != null ? association.viewType === 'gitlens.rebase' : true;\n\t\t}\n\n\t\tconst association = associations['git-rebase-todo'];\n\t\treturn association != null ? association === 'gitlens.rebase' : true;\n\t}\n\n\tprivate _disableAfterNextUse: boolean = false;\n\tasync enableForNextUse() {\n\t\tif (!this.enabled) {\n\t\t\tawait this.setEnabled(true);\n\t\t\tthis._disableAfterNextUse = true;\n\t\t}\n\t}\n\n\tasync setEnabled(enabled: boolean): Promise<void> {\n\t\tthis._disableAfterNextUse = false;\n\n\t\tconst inspection = configuration.inspectAny<\n\t\t\t{ [key: string]: string } | { viewType: string; filenamePattern: string }[]\n\t\t>('workbench.editorAssociations');\n\n\t\tlet associations = inspection?.globalValue;\n\t\tif (Array.isArray(associations)) {\n\t\t\tassociations = associations.reduce((accumulator, current) => {\n\t\t\t\taccumulator[current.filenamePattern] = current.viewType;\n\t\t\t\treturn accumulator;\n\t\t\t}, Object.create(null) as Record<string, string>);\n\t\t}\n\n\t\tif (associations == null) {\n\t\t\tif (enabled) return;\n\n\t\t\tassociations = {\n\t\t\t\t'git-rebase-todo': 'default',\n\t\t\t};\n\t\t} else {\n\t\t\tassociations['git-rebase-todo'] = enabled ? 'gitlens.rebase' : 'default';\n\t\t}\n\n\t\tawait configuration.updateAny('workbench.editorAssociations', associations, ConfigurationTarget.Global);\n\t}\n\n\t@debug<RebaseEditorProvider['resolveCustomTextEditor']>({ args: false })\n\tasync resolveCustomTextEditor(document: TextDocument, panel: WebviewPanel, _token: CancellationToken) {\n\t\tconst repoPath = Strings.normalizePath(Uri.joinPath(document.uri, '..', '..', '..').fsPath);\n\t\tconst repo = await Container.git.getRepository(repoPath);\n\n\t\tconst subscriptions: Disposable[] = [];\n\t\tconst context: RebaseEditorContext = {\n\t\t\tdispose: () => Disposable.from(...subscriptions).dispose(),\n\n\t\t\tid: nextWebviewId(),\n\t\t\tsubscriptions: subscriptions,\n\t\t\tdocument: document,\n\t\t\tpanel: panel,\n\t\t\trepoPath: repo?.path ?? repoPath,\n\t\t\tabortOnClose: true,\n\t\t};\n\n\t\tsubscriptions.push(\n\t\t\tpanel.onDidDispose(() => {\n\t\t\t\t// If the user closed this without taking an action, consider it an abort\n\t\t\t\tif (context.abortOnClose) {\n\t\t\t\t\tvoid this.abort(context);\n\t\t\t\t}\n\t\t\t\tDisposable.from(...subscriptions).dispose();\n\t\t\t}),\n\t\t\tpanel.onDidChangeViewState(() => {\n\t\t\t\tif (!context.pendingChange) return;\n\n\t\t\t\tvoid this.getStateAndNotify(context);\n\t\t\t}),\n\t\t\tpanel.webview.onDidReceiveMessage(e => this.onMessageReceived(context, e)),\n\t\t\tworkspace.onDidChangeTextDocument(e => {\n\t\t\t\tif (e.contentChanges.length === 0 || e.document.uri.toString() !== document.uri.toString()) return;\n\n\t\t\t\tvoid this.getStateAndNotify(context);\n\t\t\t}),\n\t\t\tworkspace.onDidSaveTextDocument(e => {\n\t\t\t\tif (e.uri.toString() !== document.uri.toString()) return;\n\n\t\t\t\tvoid this.getStateAndNotify(context);\n\t\t\t}),\n\t\t);\n\n\t\tif (repo != null) {\n\t\t\tsubscriptions.push(\n\t\t\t\trepo.onDidChange(e => {\n\t\t\t\t\tif (!e.changed(RepositoryChange.Rebase, RepositoryChangeComparisonMode.Any)) return;\n\n\t\t\t\t\tvoid this.getStateAndNotify(context);\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tpanel.webview.options = { enableCommandUris: true, enableScripts: true };\n\t\tpanel.webview.html = await this.getHtml(context);\n\n\t\tif (this._disableAfterNextUse) {\n\t\t\tthis._disableAfterNextUse = false;\n\t\t\tvoid this.setEnabled(false);\n\t\t}\n\t}\n\n\t@gate((context: RebaseEditorContext) => `${context.id}`)\n\tprivate async getStateAndNotify(context: RebaseEditorContext) {\n\t\tif (!context.panel.visible) {\n\t\t\tcontext.pendingChange = true;\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst state = await this.parseState(context);\n\t\tvoid this.postMessage(context, {\n\t\t\tid: nextIpcId(),\n\t\t\tmethod: RebaseDidChangeNotificationType.method,\n\t\t\tparams: { state: state },\n\t\t});\n\t}\n\n\tprivate async parseState(context: RebaseEditorContext): Promise<RebaseState> {\n\t\tconst branch = await Container.git.getBranch(context.repoPath);\n\t\tconst state = await parseRebaseTodo(context.document.getText(), context.repoPath, branch?.name);\n\t\treturn state;\n\t}\n\n\tprivate async postMessage(context: RebaseEditorContext, message: IpcMessage) {\n\t\ttry {\n\t\t\tconst success = await context.panel.webview.postMessage(message);\n\t\t\tcontext.pendingChange = !success;\n\t\t\treturn success;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\n\t\t\tcontext.pendingChange = true;\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tprivate onMessageReceived(context: RebaseEditorContext, e: IpcMessage) {\n\t\tswitch (e.method) {\n\t\t\t// case ReadyCommandType.method:\n\t\t\t// \tonIpcCommand(ReadyCommandType, e, params => {\n\t\t\t// \t\tthis.parseDocumentAndSendChange(panel, document);\n\t\t\t// \t});\n\n\t\t\t// \tbreak;\n\n\t\t\tcase RebaseDidAbortCommandType.method:\n\t\t\t\tonIpcCommand(RebaseDidAbortCommandType, e, () => this.abort(context));\n\n\t\t\t\tbreak;\n\n\t\t\tcase RebaseDidDisableCommandType.method:\n\t\t\t\tonIpcCommand(RebaseDidDisableCommandType, e, () => this.disable(context));\n\t\t\t\tbreak;\n\n\t\t\tcase RebaseDidStartCommandType.method:\n\t\t\t\tonIpcCommand(RebaseDidStartCommandType, e, () => this.rebase(context));\n\t\t\t\tbreak;\n\n\t\t\tcase RebaseDidSwitchCommandType.method:\n\t\t\t\tonIpcCommand(RebaseDidSwitchCommandType, e, () => this.switch(context));\n\t\t\t\tbreak;\n\n\t\t\tcase RebaseDidChangeEntryCommandType.method:\n\t\t\t\tonIpcCommand(RebaseDidChangeEntryCommandType, e, async params => {\n\t\t\t\t\tconst entries = parseRebaseTodoEntries(context.document);\n\n\t\t\t\t\tconst entry = entries.find(e => e.ref === params.ref);\n\t\t\t\t\tif (entry == null) return;\n\n\t\t\t\t\tconst start = context.document.positionAt(entry.index);\n\t\t\t\t\tconst range = context.document.validateRange(\n\t\t\t\t\t\tnew Range(new Position(start.line, 0), new Position(start.line, Number.MAX_SAFE_INTEGER)),\n\t\t\t\t\t);\n\n\t\t\t\t\tlet action = params.action;\n\t\t\t\t\tconst edit = new WorkspaceEdit();\n\n\t\t\t\t\t// Fake the new set of entries, to check if last entry is a squash/fixup\n\t\t\t\t\tconst newEntries = [...entries];\n\t\t\t\t\tnewEntries.splice(entries.indexOf(entry), 1, {\n\t\t\t\t\t\t...entry,\n\t\t\t\t\t\taction: params.action,\n\t\t\t\t\t});\n\n\t\t\t\t\tlet squashing = false;\n\n\t\t\t\t\tfor (const entry of newEntries) {\n\t\t\t\t\t\tif (entry.action === 'squash' || entry.action === 'fixup') {\n\t\t\t\t\t\t\tsquashing = true;\n\t\t\t\t\t\t} else if (squashing) {\n\t\t\t\t\t\t\tif (entry.action !== 'drop') {\n\t\t\t\t\t\t\t\tsquashing = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Ensure that the last entry isn't a squash/fixup\n\t\t\t\t\tif (squashing) {\n\t\t\t\t\t\tconst lastEntry = newEntries[newEntries.length - 1];\n\t\t\t\t\t\tif (entry.ref === lastEntry.ref) {\n\t\t\t\t\t\t\taction = 'pick';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst start = context.document.positionAt(lastEntry.index);\n\t\t\t\t\t\t\tconst range = context.document.validateRange(\n\t\t\t\t\t\t\t\tnew Range(\n\t\t\t\t\t\t\t\t\tnew Position(start.line, 0),\n\t\t\t\t\t\t\t\t\tnew Position(start.line, Number.MAX_SAFE_INTEGER),\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tedit.replace(context.document.uri, range, `pick ${lastEntry.ref} ${lastEntry.message}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tedit.replace(context.document.uri, range, `${action} ${entry.ref} ${entry.message}`);\n\t\t\t\t\tawait workspace.applyEdit(edit);\n\t\t\t\t});\n\n\t\t\t\tbreak;\n\n\t\t\tcase RebaseDidMoveEntryCommandType.method:\n\t\t\t\tonIpcCommand(RebaseDidMoveEntryCommandType, e, async params => {\n\t\t\t\t\tconst entries = parseRebaseTodoEntries(context.document);\n\n\t\t\t\t\tconst entry = entries.find(e => e.ref === params.ref);\n\t\t\t\t\tif (entry == null) return;\n\n\t\t\t\t\tconst index = entries.findIndex(e => e.ref === params.ref);\n\n\t\t\t\t\tlet newIndex;\n\t\t\t\t\tif (params.relative) {\n\t\t\t\t\t\tif ((params.to === -1 && index === 0) || (params.to === 1 && index === entries.length - 1)) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tnewIndex = index + params.to;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (index === params.to) return;\n\n\t\t\t\t\t\tnewIndex = params.to;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst newEntry = entries[newIndex];\n\t\t\t\t\tlet newLine = context.document.positionAt(newEntry.index).line;\n\t\t\t\t\tif (newIndex < index) {\n\t\t\t\t\t\tnewLine++;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst start = context.document.positionAt(entry.index);\n\t\t\t\t\tconst range = context.document.validateRange(\n\t\t\t\t\t\tnew Range(new Position(start.line, 0), new Position(start.line + 1, 0)),\n\t\t\t\t\t);\n\n\t\t\t\t\t// Fake the new set of entries, so we can ensure that the last entry isn't a squash/fixup\n\t\t\t\t\tconst newEntries = [...entries];\n\t\t\t\t\tnewEntries.splice(index, 1);\n\t\t\t\t\tnewEntries.splice(newIndex, 0, entry);\n\n\t\t\t\t\tlet squashing = false;\n\n\t\t\t\t\tfor (const entry of newEntries) {\n\t\t\t\t\t\tif (entry.action === 'squash' || entry.action === 'fixup') {\n\t\t\t\t\t\t\tsquashing = true;\n\t\t\t\t\t\t} else if (squashing) {\n\t\t\t\t\t\t\tif (entry.action !== 'drop') {\n\t\t\t\t\t\t\t\tsquashing = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tconst edit = new WorkspaceEdit();\n\n\t\t\t\t\tlet action = entry.action;\n\n\t\t\t\t\t// Ensure that the last entry isn't a squash/fixup\n\t\t\t\t\tif (squashing) {\n\t\t\t\t\t\tconst lastEntry = newEntries[newEntries.length - 1];\n\t\t\t\t\t\tif (entry.ref === lastEntry.ref) {\n\t\t\t\t\t\t\taction = 'pick';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst start = context.document.positionAt(lastEntry.index);\n\t\t\t\t\t\t\tconst range = context.document.validateRange(\n\t\t\t\t\t\t\t\tnew Range(\n\t\t\t\t\t\t\t\t\tnew Position(start.line, 0),\n\t\t\t\t\t\t\t\t\tnew Position(start.line, Number.MAX_SAFE_INTEGER),\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tedit.replace(context.document.uri, range, `pick ${lastEntry.ref} ${lastEntry.message}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tedit.delete(context.document.uri, range);\n\t\t\t\t\tedit.insert(\n\t\t\t\t\t\tcontext.document.uri,\n\t\t\t\t\t\tnew Position(newLine, 0),\n\t\t\t\t\t\t`${action} ${entry.ref} ${entry.message}\\n`,\n\t\t\t\t\t);\n\n\t\t\t\t\tawait workspace.applyEdit(edit);\n\t\t\t\t});\n\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate async abort(context: RebaseEditorContext) {\n\t\tcontext.abortOnClose = false;\n\n\t\t// Avoid triggering events by disposing them first\n\t\tcontext.dispose();\n\n\t\t// Delete the contents to abort the rebase\n\t\tconst edit = new WorkspaceEdit();\n\t\tedit.replace(context.document.uri, new Range(0, 0, context.document.lineCount, 0), '');\n\t\tawait workspace.applyEdit(edit);\n\t\tawait context.document.save();\n\n\t\tcontext.panel.dispose();\n\t}\n\n\tprivate async disable(context: RebaseEditorContext) {\n\t\tawait this.abort(context);\n\t\tawait this.setEnabled(false);\n\t}\n\n\tprivate async rebase(context: RebaseEditorContext) {\n\t\tcontext.abortOnClose = false;\n\n\t\t// Avoid triggering events by disposing them first\n\t\tcontext.dispose();\n\n\t\tawait context.document.save();\n\n\t\tcontext.panel.dispose();\n\t}\n\n\tprivate switch(context: RebaseEditorContext) {\n\t\tcontext.abortOnClose = false;\n\n\t\tvoid Messages.showRebaseSwitchToTextWarningMessage();\n\n\t\t// Open the text version of the document\n\t\tvoid commands.executeCommand(BuiltInCommands.Open, context.document.uri, {\n\t\t\toverride: false,\n\t\t\tpreview: false,\n\t\t});\n\t}\n\n\tprivate async getHtml(context: RebaseEditorContext): Promise<string> {\n\t\tconst uri = Uri.joinPath(Container.context.extensionUri, 'dist', 'webviews', 'rebase.html');\n\t\tconst content = new TextDecoder('utf8').decode(await workspace.fs.readFile(uri));\n\n\t\tconst bootstrap = await this.parseState(context);\n\t\tconst cspSource = context.panel.webview.cspSource;\n\t\tconst cspNonce = randomBytes(16).toString('base64');\n\t\tconst root = context.panel.webview.asWebviewUri(Container.context.extensionUri).toString();\n\n\t\tconst html = content\n\t\t\t.replace(/#{(head|body|endOfBody)}/i, (_substring, token) => {\n\t\t\t\tswitch (token) {\n\t\t\t\t\tcase 'endOfBody':\n\t\t\t\t\t\treturn `<script type=\"text/javascript\" nonce=\"#{cspNonce}\">window.bootstrap = ${JSON.stringify(\n\t\t\t\t\t\t\tbootstrap,\n\t\t\t\t\t\t)};</script>`;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t})\n\t\t\t.replace(/#{(cspSource|cspNonce|root)}/g, (substring, token) => {\n\t\t\t\tswitch (token) {\n\t\t\t\t\tcase 'cspSource':\n\t\t\t\t\t\treturn cspSource;\n\t\t\t\t\tcase 'cspNonce':\n\t\t\t\t\t\treturn cspNonce;\n\t\t\t\t\tcase 'root':\n\t\t\t\t\t\treturn root;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t});\n\n\t\treturn html;\n\t}\n}\n\nasync function parseRebaseTodo(\n\tcontents: string | { entries: RebaseEntry[]; onto: string },\n\trepoPath: string,\n\tbranch: string | undefined,\n): Promise<Omit<RebaseState, 'rebasing'>> {\n\tlet onto: string;\n\tlet entries;\n\tif (typeof contents === 'string') {\n\t\tentries = parseRebaseTodoEntries(contents);\n\t\t[, , , onto] = rebaseRegex.exec(contents) ?? ['', '', ''];\n\t} else {\n\t\t({ entries, onto } = contents);\n\t}\n\n\tconst authors = new Map<string, Author>();\n\tconst commits: Commit[] = [];\n\n\tconst log = await Container.git.getLogForSearch(repoPath, {\n\t\tpattern: `${onto ? `#:${onto} ` : ''}${Iterables.join(\n\t\t\tIterables.map(entries, e => `#:${e.ref}`),\n\t\t\t' ',\n\t\t)}`,\n\t});\n\tconst foundCommits = log != null ? [...log.commits.values()] : [];\n\n\tconst ontoCommit = onto ? foundCommits.find(c => c.ref.startsWith(onto)) : undefined;\n\tif (ontoCommit != null) {\n\t\tif (!authors.has(ontoCommit.author)) {\n\t\t\tauthors.set(ontoCommit.author, {\n\t\t\t\tauthor: ontoCommit.author,\n\t\t\t\tavatarUrl: (\n\t\t\t\t\tawait ontoCommit.getAvatarUri({ defaultStyle: Container.config.defaultGravatarsStyle })\n\t\t\t\t).toString(true),\n\t\t\t\temail: ontoCommit.email,\n\t\t\t});\n\t\t}\n\n\t\tcommits.push({\n\t\t\tref: ontoCommit.ref,\n\t\t\tauthor: ontoCommit.author,\n\t\t\tdate: ontoCommit.formatDate(Container.config.defaultDateFormat),\n\t\t\tdateFromNow: ontoCommit.formatDateFromNow(),\n\t\t\tmessage: ontoCommit.message || 'root',\n\t\t});\n\t}\n\n\tfor (const entry of entries) {\n\t\tconst commit = foundCommits.find(c => c.ref.startsWith(entry.ref));\n\t\tif (commit == null) continue;\n\n\t\t// If the onto commit is contained in the list of commits, remove it and clear the 'onto' value  See #1201\n\t\tif (commit.ref === ontoCommit?.ref) {\n\t\t\tcommits.splice(0, 1);\n\t\t\tonto = '';\n\t\t}\n\n\t\tif (!authors.has(commit.author)) {\n\t\t\tauthors.set(commit.author, {\n\t\t\t\tauthor: commit.author,\n\t\t\t\tavatarUrl: (\n\t\t\t\t\tawait commit.getAvatarUri({ defaultStyle: Container.config.defaultGravatarsStyle })\n\t\t\t\t).toString(true),\n\t\t\t\temail: commit.email,\n\t\t\t});\n\t\t}\n\n\t\tcommits.push({\n\t\t\tref: commit.ref,\n\t\t\tauthor: commit.author,\n\t\t\tdate: commit.formatDate(Container.config.defaultDateFormat),\n\t\t\tdateFromNow: commit.formatDateFromNow(),\n\t\t\tmessage: commit.message,\n\t\t});\n\t}\n\n\treturn {\n\t\tbranch: branch ?? '',\n\t\tonto: onto,\n\t\tentries: entries,\n\t\tauthors: [...authors.values()],\n\t\tcommits: commits,\n\t\tcommands: {\n\t\t\tcommit: ShowQuickCommitCommand.getMarkdownCommandArgs(`\\${commit}`, repoPath),\n\t\t},\n\t};\n}\n\nfunction parseRebaseTodoEntries(contents: string): RebaseEntry[];\nfunction parseRebaseTodoEntries(document: TextDocument): RebaseEntry[];\nfunction parseRebaseTodoEntries(contentsOrDocument: string | TextDocument): RebaseEntry[] {\n\tconst contents = typeof contentsOrDocument === 'string' ? contentsOrDocument : contentsOrDocument.getText();\n\n\tconst entries: RebaseEntry[] = [];\n\n\tlet match;\n\tlet action;\n\tlet ref;\n\tlet message;\n\n\tdo {\n\t\tmatch = rebaseCommandsRegex.exec(contents);\n\t\tif (match == null) break;\n\n\t\t[, action, ref, message] = match;\n\n\t\tentries.push({\n\t\t\tindex: match.index,\n\t\t\taction: rebaseActionsMap.get(action) ?? 'pick',\n\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\tref: ` ${ref}`.substr(1),\n\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\tmessage: message == null || message.length === 0 ? '' : ` ${message}`.substr(1),\n\t\t});\n\t} while (true);\n\n\treturn entries.reverse();\n}\n","'use strict';\nimport { randomBytes } from 'crypto';\nimport { TextDecoder } from 'util';\nimport {\n\tcommands,\n\tConfigurationChangeEvent,\n\tConfigurationTarget,\n\tDisposable,\n\tUri,\n\tViewColumn,\n\tWebview,\n\tWebviewPanel,\n\tWebviewPanelOnDidChangeViewStateEvent,\n\twindow,\n\tworkspace,\n} from 'vscode';\nimport { Commands } from '../commands';\nimport { configuration } from '../configuration';\nimport { Container } from '../container';\nimport { CommitFormatter, GitBlameCommit, PullRequest, PullRequestState } from '../git/git';\nimport { Logger } from '../logger';\nimport {\n\tDidChangeConfigurationNotificationType,\n\tDidPreviewConfigurationNotificationType,\n\tIpcMessage,\n\tIpcNotificationParamsOf,\n\tIpcNotificationType,\n\tonIpcCommand,\n\tPreviewConfigurationCommandType,\n\tUpdateConfigurationCommandType,\n} from './protocol';\n\nlet ipcSequence = 0;\nfunction nextIpcId() {\n\tif (ipcSequence === Number.MAX_SAFE_INTEGER) {\n\t\tipcSequence = 1;\n\t} else {\n\t\tipcSequence++;\n\t}\n\n\treturn `host:${ipcSequence}`;\n}\n\nconst emptyCommands: Disposable[] = [\n\t{\n\t\tdispose: function () {\n\t\t\t/* noop */\n\t\t},\n\t},\n];\n\nexport abstract class WebviewBase implements Disposable {\n\tprotected disposable: Disposable;\n\tprivate _disposablePanel: Disposable | undefined;\n\tprivate _panel: WebviewPanel | undefined;\n\n\tconstructor(showCommand: Commands, private readonly _column?: ViewColumn) {\n\t\tthis.disposable = Disposable.from(\n\t\t\tconfiguration.onDidChange(this.onConfigurationChanged, this),\n\t\t\tconfiguration.onDidChangeAny(this.onAnyConfigurationChanged, this),\n\t\t\tcommands.registerCommand(showCommand, this.onShowCommand, this),\n\t\t);\n\t}\n\n\tabstract get filename(): string;\n\tabstract get id(): string;\n\tabstract get title(): string;\n\n\tregisterCommands(): Disposable[] {\n\t\treturn emptyCommands;\n\t}\n\n\trenderHead?(): string | Promise<string>;\n\trenderBody?(): string | Promise<string>;\n\trenderEndOfBody?(): string | Promise<string>;\n\n\tdispose() {\n\t\tthis.disposable.dispose();\n\t\tthis._disposablePanel?.dispose();\n\t}\n\n\tprivate _customSettings:\n\t\t| Map<\n\t\t\t\tstring,\n\t\t\t\t{\n\t\t\t\t\tname: string;\n\t\t\t\t\tenabled: () => boolean;\n\t\t\t\t\tupdate: (enabled: boolean) => Promise<void>;\n\t\t\t\t}\n\t\t  >\n\t\t| undefined;\n\tprivate get customSettings() {\n\t\tif (this._customSettings == null) {\n\t\t\tthis._customSettings = new Map<\n\t\t\t\tstring,\n\t\t\t\t{\n\t\t\t\t\tname: string;\n\t\t\t\t\tenabled: () => boolean;\n\t\t\t\t\tupdate: (enabled: boolean) => Promise<void>;\n\t\t\t\t}\n\t\t\t>([\n\t\t\t\t[\n\t\t\t\t\t'rebaseEditor.enabled',\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'workbench.editorAssociations',\n\t\t\t\t\t\tenabled: () => Container.rebaseEditor.enabled,\n\t\t\t\t\t\tupdate: Container.rebaseEditor.setEnabled,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t]);\n\t\t}\n\t\treturn this._customSettings;\n\t}\n\n\tprotected onShowCommand() {\n\t\tvoid this.show(this._column);\n\t}\n\n\tprivate onAnyConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tlet notify = false;\n\t\tfor (const setting of this.customSettings.values()) {\n\t\t\tif (e.affectsConfiguration(setting.name)) {\n\t\t\t\tnotify = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!notify) return;\n\n\t\tvoid this.notifyDidChangeConfiguration();\n\t}\n\n\tprivate onConfigurationChanged(_e: ConfigurationChangeEvent) {\n\t\tvoid this.notifyDidChangeConfiguration();\n\t}\n\n\tprivate onPanelDisposed() {\n\t\tthis._disposablePanel?.dispose();\n\t\tthis._panel = undefined;\n\t}\n\n\tprivate onViewStateChanged(e: WebviewPanelOnDidChangeViewStateEvent) {\n\t\tLogger.log(\n\t\t\t`Webview(${this.id}).onViewStateChanged`,\n\t\t\t`active=${e.webviewPanel.active}, visible=${e.webviewPanel.visible}`,\n\t\t);\n\n\t\t// Anytime the webview becomes active, make sure it has the most up-to-date config\n\t\tif (e.webviewPanel.active) {\n\t\t\tvoid this.notifyDidChangeConfiguration();\n\t\t}\n\t}\n\n\tprotected onMessageReceived(e: IpcMessage) {\n\t\tswitch (e.method) {\n\t\t\tcase UpdateConfigurationCommandType.method:\n\t\t\t\tonIpcCommand(UpdateConfigurationCommandType, e, async params => {\n\t\t\t\t\tconst target =\n\t\t\t\t\t\tparams.scope === 'workspace' ? ConfigurationTarget.Workspace : ConfigurationTarget.Global;\n\n\t\t\t\t\tfor (const key in params.changes) {\n\t\t\t\t\t\tlet value = params.changes[key];\n\n\t\t\t\t\t\tconst customSetting = this.customSettings.get(key);\n\t\t\t\t\t\tif (customSetting != null) {\n\t\t\t\t\t\t\tawait customSetting.update(value);\n\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst inspect = configuration.inspect(key as any)!;\n\n\t\t\t\t\t\tif (value != null) {\n\t\t\t\t\t\t\tif (params.scope === 'workspace') {\n\t\t\t\t\t\t\t\tif (value === inspect.workspaceValue) continue;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (value === inspect.globalValue && value !== inspect.defaultValue) continue;\n\n\t\t\t\t\t\t\t\tif (value === inspect.defaultValue) {\n\t\t\t\t\t\t\t\t\tvalue = undefined;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvoid (await configuration.update(key as any, value, target));\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (const key of params.removes) {\n\t\t\t\t\t\tvoid (await configuration.update(key as any, undefined, target));\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tbreak;\n\n\t\t\tcase PreviewConfigurationCommandType.method:\n\t\t\t\tonIpcCommand(PreviewConfigurationCommandType, e, async params => {\n\t\t\t\t\tswitch (params.type) {\n\t\t\t\t\t\tcase 'commit': {\n\t\t\t\t\t\t\tconst commit = new GitBlameCommit(\n\t\t\t\t\t\t\t\t'~/code/eamodio/vscode-gitlens-demo',\n\t\t\t\t\t\t\t\t'fe26af408293cba5b4bfd77306e1ac9ff7ccaef8',\n\t\t\t\t\t\t\t\t'You',\n\t\t\t\t\t\t\t\t'eamodio@gmail.com',\n\t\t\t\t\t\t\t\tnew Date('2016-11-12T20:41:00.000Z'),\n\t\t\t\t\t\t\t\tnew Date('2020-11-01T06:57:21.000Z'),\n\t\t\t\t\t\t\t\t'Supercharged',\n\t\t\t\t\t\t\t\t'code.ts',\n\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t\t'3ac1d3f51d7cf5f438cc69f25f6740536ad80fef',\n\t\t\t\t\t\t\t\t'code.ts',\n\t\t\t\t\t\t\t\t[],\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tlet includePullRequest = false;\n\t\t\t\t\t\t\tswitch (params.key) {\n\t\t\t\t\t\t\t\tcase configuration.name('currentLine.format'):\n\t\t\t\t\t\t\t\t\tincludePullRequest = Container.config.currentLine.pullRequests.enabled;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase configuration.name('statusBar.format'):\n\t\t\t\t\t\t\t\t\tincludePullRequest = Container.config.statusBar.pullRequests.enabled;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet pr: PullRequest | undefined;\n\t\t\t\t\t\t\tif (includePullRequest) {\n\t\t\t\t\t\t\t\tpr = new PullRequest(\n\t\t\t\t\t\t\t\t\t{ id: 'github', name: 'GitHub', domain: 'github.com' },\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: 'Eric Amodio',\n\t\t\t\t\t\t\t\t\t\tavatarUrl: 'https://avatars1.githubusercontent.com/u/641685?s=32&v=4',\n\t\t\t\t\t\t\t\t\t\turl: 'https://github.com/eamodio',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t'1',\n\t\t\t\t\t\t\t\t\t'Supercharged',\n\t\t\t\t\t\t\t\t\t'https://github.com/eamodio/vscode-gitlens/pulls/1',\n\t\t\t\t\t\t\t\t\tPullRequestState.Merged,\n\t\t\t\t\t\t\t\t\tnew Date('Sat, 12 Nov 2016 19:41:00 GMT'),\n\t\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t\t\tnew Date('Sat, 12 Nov 2016 20:41:00 GMT'),\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet preview;\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tpreview = CommitFormatter.fromTemplate(params.format, commit, {\n\t\t\t\t\t\t\t\t\tdateFormat: Container.config.defaultDateFormat,\n\t\t\t\t\t\t\t\t\tpullRequestOrRemote: pr,\n\t\t\t\t\t\t\t\t\tmessageTruncateAtNewLine: true,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} catch {\n\t\t\t\t\t\t\t\tpreview = 'Invalid format';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tawait this.notify(DidPreviewConfigurationNotificationType, {\n\t\t\t\t\t\t\t\tid: params.id,\n\t\t\t\t\t\t\t\tpreview: preview,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate onMessageReceivedCore(e: IpcMessage) {\n\t\tif (e == null) return;\n\n\t\tLogger.log(`Webview(${this.id}).onMessageReceived: method=${e.method}, data=${JSON.stringify(e)}`);\n\n\t\tthis.onMessageReceived(e);\n\t}\n\n\tget visible() {\n\t\treturn this._panel?.visible ?? false;\n\t}\n\n\thide() {\n\t\tthis._panel?.dispose();\n\t}\n\n\tsetTitle(title: string) {\n\t\tif (this._panel == null) return;\n\n\t\tthis._panel.title = title;\n\t}\n\n\tasync show(column: ViewColumn = ViewColumn.Beside): Promise<void> {\n\t\tif (this._panel == null) {\n\t\t\tthis._panel = window.createWebviewPanel(\n\t\t\t\tthis.id,\n\t\t\t\tthis.title,\n\t\t\t\t{ viewColumn: column, preserveFocus: false },\n\t\t\t\t{\n\t\t\t\t\tretainContextWhenHidden: true,\n\t\t\t\t\tenableFindWidget: true,\n\t\t\t\t\tenableCommandUris: true,\n\t\t\t\t\tenableScripts: true,\n\t\t\t\t},\n\t\t\t);\n\n\t\t\tthis._panel.iconPath = Uri.file(Container.context.asAbsolutePath('images/gitlens-icon.png'));\n\t\t\tthis._disposablePanel = Disposable.from(\n\t\t\t\tthis._panel,\n\t\t\t\tthis._panel.onDidDispose(this.onPanelDisposed, this),\n\t\t\t\tthis._panel.onDidChangeViewState(this.onViewStateChanged, this),\n\t\t\t\tthis._panel.webview.onDidReceiveMessage(this.onMessageReceivedCore, this),\n\t\t\t\t...this.registerCommands(),\n\t\t\t);\n\n\t\t\tthis._panel.webview.html = await this.getHtml(this._panel.webview);\n\t\t} else {\n\t\t\tconst html = await this.getHtml(this._panel.webview);\n\n\t\t\t// Reset the html to get the webview to reload\n\t\t\tthis._panel.webview.html = '';\n\t\t\tthis._panel.webview.html = html;\n\n\t\t\tthis._panel.reveal(this._panel.viewColumn ?? ViewColumn.Active, false);\n\t\t}\n\t}\n\n\tprivate async getHtml(webview: Webview): Promise<string> {\n\t\tconst uri = Uri.joinPath(Container.context.extensionUri, 'dist', 'webviews', this.filename);\n\t\tconst content = new TextDecoder('utf8').decode(await workspace.fs.readFile(uri));\n\n\t\tconst [head, body, endOfBody] = await Promise.all([\n\t\t\tthis.renderHead?.(),\n\t\t\tthis.renderBody?.(),\n\t\t\tthis.renderEndOfBody?.(),\n\t\t]);\n\n\t\tconst cspSource = webview.cspSource;\n\t\tconst cspNonce = randomBytes(16).toString('base64');\n\t\tconst root = webview.asWebviewUri(Container.context.extensionUri).toString();\n\n\t\tconst html = content\n\t\t\t.replace(/#{(head|body|endOfBody)}/i, (_substring, token) => {\n\t\t\t\tswitch (token) {\n\t\t\t\t\tcase 'head':\n\t\t\t\t\t\treturn head ?? '';\n\t\t\t\t\tcase 'body':\n\t\t\t\t\t\treturn body ?? '';\n\t\t\t\t\tcase 'endOfBody':\n\t\t\t\t\t\treturn endOfBody ?? '';\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t})\n\t\t\t.replace(/#{(cspSource|cspNonce|root)}/g, (substring, token) => {\n\t\t\t\tswitch (token) {\n\t\t\t\t\tcase 'cspSource':\n\t\t\t\t\t\treturn cspSource;\n\t\t\t\t\tcase 'cspNonce':\n\t\t\t\t\t\treturn cspNonce;\n\t\t\t\t\tcase 'root':\n\t\t\t\t\t\treturn root;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t});\n\n\t\treturn html;\n\t}\n\n\tprotected notify<NT extends IpcNotificationType>(type: NT, params: IpcNotificationParamsOf<NT>): Thenable<boolean> {\n\t\treturn this.postMessage({ id: nextIpcId(), method: type.method, params: params });\n\t}\n\n\tprotected getCustomSettings(): Record<string, boolean> {\n\t\tconst customSettings = Object.create(null);\n\t\tfor (const [key, setting] of this.customSettings) {\n\t\t\tcustomSettings[key] = setting.enabled();\n\t\t}\n\t\treturn customSettings;\n\t}\n\n\tprivate notifyDidChangeConfiguration() {\n\t\t// Make sure to get the raw config, not from the container which has the modes mixed in\n\t\treturn this.notify(DidChangeConfigurationNotificationType, {\n\t\t\tconfig: configuration.get(),\n\t\t\tcustomSettings: this.getCustomSettings(),\n\t\t});\n\t}\n\n\tprivate postMessage(message: IpcMessage) {\n\t\tif (this._panel == null) return Promise.resolve(false);\n\n\t\treturn this._panel.webview.postMessage(message);\n\t}\n}\n","'use strict';\nimport { commands, Disposable, workspace } from 'vscode';\nimport { Commands } from '../commands';\nimport { configuration } from '../configuration';\nimport {\n\tIpcMessage,\n\tonIpcCommand,\n\tReadyCommandType,\n\tSettingsDidRequestJumpToNotificationType,\n\tSettingsState,\n} from './protocol';\nimport { WebviewBase } from './webviewBase';\n\nconst anchorRegex = /.*?#(.*)/;\n\nexport class SettingsWebview extends WebviewBase {\n\tprivate _pendingJumpToAnchor: string | undefined;\n\n\tconstructor() {\n\t\tsuper(Commands.ShowSettingsPage);\n\n\t\tthis.disposable = Disposable.from(\n\t\t\tthis.disposable,\n\t\t\t...[\n\t\t\t\tCommands.ShowSettingsPageAndJumpToBranchesView,\n\t\t\t\tCommands.ShowSettingsPageAndJumpToCommitsView,\n\t\t\t\tCommands.ShowSettingsPageAndJumpToContributorsView,\n\t\t\t\tCommands.ShowSettingsPageAndJumpToFileHistoryView,\n\t\t\t\tCommands.ShowSettingsPageAndJumpToLineHistoryView,\n\t\t\t\tCommands.ShowSettingsPageAndJumpToRemotesView,\n\t\t\t\tCommands.ShowSettingsPageAndJumpToRepositoriesView,\n\t\t\t\tCommands.ShowSettingsPageAndJumpToSearchAndCompareView,\n\t\t\t\tCommands.ShowSettingsPageAndJumpToStashesView,\n\t\t\t\tCommands.ShowSettingsPageAndJumpToTagsView,\n\t\t\t\tCommands.ShowSettingsPageAndJumpToViews,\n\t\t\t].map(c => {\n\t\t\t\t// The show and jump commands are structured to have a # separating the base command from the anchor\n\t\t\t\tlet anchor: string | undefined;\n\t\t\t\tconst match = anchorRegex.exec(c);\n\t\t\t\tif (match != null) {\n\t\t\t\t\t[, anchor] = match;\n\t\t\t\t}\n\n\t\t\t\treturn commands.registerCommand(c, () => this.onShowCommand(anchor), this);\n\t\t\t}),\n\t\t);\n\t}\n\n\tprotected override onShowCommand(anchor?: string) {\n\t\tif (anchor) {\n\t\t\tthis._pendingJumpToAnchor = anchor;\n\t\t}\n\t\tsuper.onShowCommand();\n\t}\n\n\tprotected override onMessageReceived(e: IpcMessage) {\n\t\tswitch (e.method) {\n\t\t\tcase ReadyCommandType.method:\n\t\t\t\tonIpcCommand(ReadyCommandType, e, _params => {\n\t\t\t\t\tif (this._pendingJumpToAnchor !== undefined) {\n\t\t\t\t\t\tvoid this.notify(SettingsDidRequestJumpToNotificationType, {\n\t\t\t\t\t\t\tanchor: this._pendingJumpToAnchor,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis._pendingJumpToAnchor = undefined;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tsuper.onMessageReceived(e);\n\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tget filename(): string {\n\t\treturn 'settings.html';\n\t}\n\n\tget id(): string {\n\t\treturn 'gitlens.settings';\n\t}\n\n\tget title(): string {\n\t\treturn 'GitLens Settings';\n\t}\n\n\toverride renderEndOfBody() {\n\t\tconst scopes: ['user' | 'workspace', string][] = [['user', 'User']];\n\t\tif (workspace.workspaceFolders?.length) {\n\t\t\tscopes.push(['workspace', 'Workspace']);\n\t\t}\n\n\t\tconst bootstrap: SettingsState = {\n\t\t\t// Make sure to get the raw config, not from the container which has the modes mixed in\n\t\t\tconfig: configuration.get(),\n\t\t\tcustomSettings: this.getCustomSettings(),\n\t\t\tscope: 'user',\n\t\t\tscopes: scopes,\n\t\t};\n\t\treturn `<script type=\"text/javascript\" nonce=\"#{cspNonce}\">window.bootstrap = ${JSON.stringify(\n\t\t\tbootstrap,\n\t\t)};</script>`;\n\t}\n}\n","'use strict';\nimport { Commands } from '../commands';\nimport { Container } from '../container';\nimport { WelcomeState } from './protocol';\nimport { WebviewBase } from './webviewBase';\n\nexport class WelcomeWebview extends WebviewBase {\n\tconstructor() {\n\t\tsuper(Commands.ShowWelcomePage);\n\t}\n\n\tget filename(): string {\n\t\treturn 'welcome.html';\n\t}\n\n\tget id(): string {\n\t\treturn 'gitlens.welcome';\n\t}\n\n\tget title(): string {\n\t\treturn 'Welcome to GitLens';\n\t}\n\n\toverride renderEndOfBody() {\n\t\tconst bootstrap: WelcomeState = {\n\t\t\tconfig: Container.config,\n\t\t};\n\t\treturn `<script type=\"text/javascript\" nonce=\"#{cspNonce}\">window.bootstrap = ${JSON.stringify(\n\t\t\tbootstrap,\n\t\t)};</script>`;\n\t}\n}\n","'use strict';\nimport { commands, ConfigurationChangeEvent, ConfigurationScope, ExtensionContext } from 'vscode';\nimport { Autolinks } from './annotations/autolinks';\nimport { FileAnnotationController } from './annotations/fileAnnotationController';\nimport { LineAnnotationController } from './annotations/lineAnnotationController';\nimport { ActionRunners } from './api/actionRunners';\nimport { resetAvatarCache } from './avatars';\nimport { GitCodeLensController } from './codelens/codeLensController';\nimport { Commands, ToggleFileAnnotationCommandArgs } from './commands';\nimport {\n\tAnnotationsToggleMode,\n\tConfig,\n\tconfiguration,\n\tConfigurationWillChangeEvent,\n\tFileAnnotationType,\n} from './configuration';\nimport { GitFileSystemProvider } from './git/fsProvider';\nimport { GitService } from './git/gitService';\nimport { LineHoverController } from './hovers/lineHoverController';\nimport { Keyboard } from './keyboard';\nimport { Logger } from './logger';\nimport { StatusBarController } from './statusbar/statusBarController';\nimport { memoize } from './system/decorators/memoize';\nimport { GitTerminalLinkProvider } from './terminal/linkProvider';\nimport { GitDocumentTracker } from './trackers/gitDocumentTracker';\nimport { GitLineTracker } from './trackers/gitLineTracker';\nimport { BranchesView } from './views/branchesView';\nimport { CommitsView } from './views/commitsView';\nimport { ContributorsView } from './views/contributorsView';\nimport { FileHistoryView } from './views/fileHistoryView';\nimport { LineHistoryView } from './views/lineHistoryView';\nimport { RemotesView } from './views/remotesView';\nimport { RepositoriesView } from './views/repositoriesView';\nimport { SearchAndCompareView } from './views/searchAndCompareView';\nimport { StashesView } from './views/stashesView';\nimport { TagsView } from './views/tagsView';\nimport { ViewCommands } from './views/viewCommands';\nimport { ViewFileDecorationProvider } from './views/viewDecorationProvider';\nimport { VslsController } from './vsls/vsls';\nimport { RebaseEditorProvider } from './webviews/rebaseEditor';\nimport { SettingsWebview } from './webviews/settingsWebview';\nimport { WelcomeWebview } from './webviews/welcomeWebview';\n\nexport class Container {\n\tprivate static _configsAffectedByMode: string[] | undefined;\n\tprivate static _applyModeConfigurationTransformBound:\n\t\t| ((e: ConfigurationChangeEvent) => ConfigurationChangeEvent)\n\t\t| undefined;\n\n\tprivate static _terminalLinks: GitTerminalLinkProvider | undefined;\n\n\tstatic initialize(context: ExtensionContext, config: Config) {\n\t\tthis._context = context;\n\t\tthis._config = Container.applyMode(config);\n\n\t\tcontext.subscriptions.push((this._actionRunners = new ActionRunners()));\n\t\tcontext.subscriptions.push((this._lineTracker = new GitLineTracker()));\n\t\tcontext.subscriptions.push((this._tracker = new GitDocumentTracker()));\n\t\tcontext.subscriptions.push((this._vsls = new VslsController()));\n\n\t\tcontext.subscriptions.push((this._git = new GitService()));\n\n\t\tcontext.subscriptions.push(new ViewFileDecorationProvider());\n\n\t\t// Since there is a bit of a chicken & egg problem with the DocumentTracker and the GitService, initialize the tracker once the GitService is loaded\n\t\tthis._tracker.initialize();\n\n\t\tcontext.subscriptions.push((this._fileAnnotationController = new FileAnnotationController()));\n\t\tcontext.subscriptions.push((this._lineAnnotationController = new LineAnnotationController()));\n\t\tcontext.subscriptions.push((this._lineHoverController = new LineHoverController()));\n\t\tcontext.subscriptions.push((this._statusBarController = new StatusBarController()));\n\t\tcontext.subscriptions.push((this._codeLensController = new GitCodeLensController()));\n\t\tcontext.subscriptions.push((this._keyboard = new Keyboard()));\n\t\tcontext.subscriptions.push((this._settingsWebview = new SettingsWebview()));\n\t\tcontext.subscriptions.push((this._welcomeWebview = new WelcomeWebview()));\n\n\t\tcontext.subscriptions.push((this._repositoriesView = new RepositoriesView()));\n\t\tcontext.subscriptions.push((this._commitsView = new CommitsView()));\n\t\tcontext.subscriptions.push((this._fileHistoryView = new FileHistoryView()));\n\t\tcontext.subscriptions.push((this._lineHistoryView = new LineHistoryView()));\n\t\tcontext.subscriptions.push((this._branchesView = new BranchesView()));\n\t\tcontext.subscriptions.push((this._remotesView = new RemotesView()));\n\t\tcontext.subscriptions.push((this._stashesView = new StashesView()));\n\t\tcontext.subscriptions.push((this._tagsView = new TagsView()));\n\t\tcontext.subscriptions.push((this._contributorsView = new ContributorsView()));\n\t\tcontext.subscriptions.push((this._searchAndCompareView = new SearchAndCompareView()));\n\n\t\tcontext.subscriptions.push((this._rebaseEditor = new RebaseEditorProvider()));\n\n\t\tif (config.terminalLinks.enabled) {\n\t\t\tcontext.subscriptions.push((this._terminalLinks = new GitTerminalLinkProvider()));\n\t\t}\n\n\t\tcontext.subscriptions.push(\n\t\t\tconfiguration.onDidChange(e => {\n\t\t\t\tif (!configuration.changed(e, 'terminalLinks.enabled')) return;\n\n\t\t\t\tthis._terminalLinks?.dispose();\n\t\t\t\tif (Container.config.terminalLinks.enabled) {\n\t\t\t\t\tcontext.subscriptions.push((this._terminalLinks = new GitTerminalLinkProvider()));\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tcontext.subscriptions.push(new GitFileSystemProvider());\n\n\t\tcontext.subscriptions.push(configuration.onWillChange(this.onConfigurationChanging, this));\n\t}\n\n\tprivate static onConfigurationChanging(e: ConfigurationWillChangeEvent) {\n\t\tthis._config = undefined;\n\n\t\tif (configuration.changed(e.change, 'outputLevel')) {\n\t\t\tLogger.level = configuration.get('outputLevel');\n\t\t}\n\n\t\tif (configuration.changed(e.change, 'defaultGravatarsStyle')) {\n\t\t\tresetAvatarCache('fallback');\n\t\t}\n\n\t\tif (configuration.changed(e.change, 'mode') || configuration.changed(e.change, 'modes')) {\n\t\t\tif (this._applyModeConfigurationTransformBound == null) {\n\t\t\t\tthis._applyModeConfigurationTransformBound = this.applyModeConfigurationTransform.bind(this);\n\t\t\t}\n\t\t\te.transform = this._applyModeConfigurationTransformBound;\n\t\t}\n\t}\n\n\tprivate static _actionRunners: ActionRunners;\n\tstatic get actionRunners() {\n\t\tif (this._actionRunners == null) {\n\t\t\tthis._context.subscriptions.push((this._actionRunners = new ActionRunners()));\n\t\t}\n\n\t\treturn this._actionRunners;\n\t}\n\n\tprivate static _autolinks: Autolinks;\n\tstatic get autolinks() {\n\t\tif (this._autolinks == null) {\n\t\t\tthis._context.subscriptions.push((this._autolinks = new Autolinks()));\n\t\t}\n\n\t\treturn this._autolinks;\n\t}\n\n\tprivate static _codeLensController: GitCodeLensController;\n\tstatic get codeLens() {\n\t\treturn this._codeLensController;\n\t}\n\n\tprivate static _branchesView: BranchesView | undefined;\n\tstatic get branchesView() {\n\t\tif (this._branchesView == null) {\n\t\t\tthis._context.subscriptions.push((this._branchesView = new BranchesView()));\n\t\t}\n\n\t\treturn this._branchesView;\n\t}\n\n\tprivate static _commitsView: CommitsView | undefined;\n\tstatic get commitsView() {\n\t\tif (this._commitsView == null) {\n\t\t\tthis._context.subscriptions.push((this._commitsView = new CommitsView()));\n\t\t}\n\n\t\treturn this._commitsView;\n\t}\n\n\tprivate static _config: Config | undefined;\n\tstatic get config() {\n\t\tif (this._config == null) {\n\t\t\tthis._config = Container.applyMode(configuration.get());\n\t\t}\n\t\treturn this._config;\n\t}\n\n\tprivate static _context: ExtensionContext;\n\tstatic get context() {\n\t\treturn this._context;\n\t}\n\n\tprivate static _contributorsView: ContributorsView | undefined;\n\tstatic get contributorsView() {\n\t\tif (this._contributorsView == null) {\n\t\t\tthis._context.subscriptions.push((this._contributorsView = new ContributorsView()));\n\t\t}\n\n\t\treturn this._contributorsView;\n\t}\n\n\tprivate static _fileAnnotationController: FileAnnotationController;\n\tstatic get fileAnnotations() {\n\t\treturn this._fileAnnotationController;\n\t}\n\n\tprivate static _fileHistoryView: FileHistoryView | undefined;\n\tstatic get fileHistoryView() {\n\t\tif (this._fileHistoryView == null) {\n\t\t\tthis._context.subscriptions.push((this._fileHistoryView = new FileHistoryView()));\n\t\t}\n\n\t\treturn this._fileHistoryView;\n\t}\n\n\tprivate static _git: GitService;\n\tstatic get git() {\n\t\treturn this._git;\n\t}\n\n\tprivate static _github: Promise<import('./github/github').GitHubApi | undefined> | undefined;\n\tstatic get github() {\n\t\tif (this._github == null) {\n\t\t\tthis._github = this._loadGitHubApi();\n\t\t}\n\n\t\treturn this._github;\n\t}\n\n\tprivate static async _loadGitHubApi() {\n\t\ttry {\n\t\t\treturn new (await import(/* webpackChunkName: \"github\" */ './github/github')).GitHubApi();\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@memoize()\n\tstatic get insiders() {\n\t\treturn this._context.extension.id.endsWith('-insiders');\n\t}\n\n\tprivate static _keyboard: Keyboard;\n\tstatic get keyboard() {\n\t\treturn this._keyboard;\n\t}\n\n\tprivate static _lineAnnotationController: LineAnnotationController;\n\tstatic get lineAnnotations() {\n\t\treturn this._lineAnnotationController;\n\t}\n\n\tprivate static _lineHistoryView: LineHistoryView | undefined;\n\tstatic get lineHistoryView() {\n\t\tif (this._lineHistoryView == null) {\n\t\t\tthis._context.subscriptions.push((this._lineHistoryView = new LineHistoryView()));\n\t\t}\n\n\t\treturn this._lineHistoryView;\n\t}\n\n\tprivate static _lineHoverController: LineHoverController;\n\tstatic get lineHovers() {\n\t\treturn this._lineHoverController;\n\t}\n\n\tprivate static _lineTracker: GitLineTracker;\n\tstatic get lineTracker() {\n\t\treturn this._lineTracker;\n\t}\n\n\tprivate static _rebaseEditor: RebaseEditorProvider | undefined;\n\tstatic get rebaseEditor() {\n\t\tif (this._rebaseEditor == null) {\n\t\t\tthis._context.subscriptions.push((this._rebaseEditor = new RebaseEditorProvider()));\n\t\t}\n\n\t\treturn this._rebaseEditor;\n\t}\n\n\tprivate static _remotesView: RemotesView | undefined;\n\tstatic get remotesView() {\n\t\tif (this._remotesView == null) {\n\t\t\tthis._context.subscriptions.push((this._remotesView = new RemotesView()));\n\t\t}\n\n\t\treturn this._remotesView;\n\t}\n\n\tprivate static _repositoriesView: RepositoriesView | undefined;\n\tstatic get repositoriesView(): RepositoriesView {\n\t\tif (this._repositoriesView == null) {\n\t\t\tthis._context.subscriptions.push((this._repositoriesView = new RepositoriesView()));\n\t\t}\n\n\t\treturn this._repositoriesView;\n\t}\n\n\tprivate static _searchAndCompareView: SearchAndCompareView | undefined;\n\tstatic get searchAndCompareView() {\n\t\tif (this._searchAndCompareView == null) {\n\t\t\tthis._context.subscriptions.push((this._searchAndCompareView = new SearchAndCompareView()));\n\t\t}\n\n\t\treturn this._searchAndCompareView;\n\t}\n\n\tprivate static _settingsWebview: SettingsWebview;\n\tstatic get settingsWebview() {\n\t\treturn this._settingsWebview;\n\t}\n\n\tprivate static _stashesView: StashesView | undefined;\n\tstatic get stashesView() {\n\t\tif (this._stashesView == null) {\n\t\t\tthis._context.subscriptions.push((this._stashesView = new StashesView()));\n\t\t}\n\n\t\treturn this._stashesView;\n\t}\n\n\tprivate static _statusBarController: StatusBarController;\n\tstatic get statusBar() {\n\t\treturn this._statusBarController;\n\t}\n\n\tprivate static _tagsView: TagsView | undefined;\n\tstatic get tagsView() {\n\t\tif (this._tagsView == null) {\n\t\t\tthis._context.subscriptions.push((this._tagsView = new TagsView()));\n\t\t}\n\n\t\treturn this._tagsView;\n\t}\n\n\tprivate static _tracker: GitDocumentTracker;\n\tstatic get tracker() {\n\t\treturn this._tracker;\n\t}\n\n\tprivate static _viewCommands: ViewCommands | undefined;\n\tstatic get viewCommands() {\n\t\tif (this._viewCommands == null) {\n\t\t\tthis._viewCommands = new ViewCommands();\n\t\t}\n\t\treturn this._viewCommands;\n\t}\n\n\tprivate static _vsls: VslsController;\n\tstatic get vsls() {\n\t\treturn this._vsls;\n\t}\n\n\tprivate static _welcomeWebview: WelcomeWebview;\n\tstatic get welcomeWebview() {\n\t\treturn this._welcomeWebview;\n\t}\n\n\tprivate static applyMode(config: Config) {\n\t\tif (!config.mode.active) return config;\n\n\t\tconst mode = config.modes?.[config.mode.active];\n\t\tif (mode == null) return config;\n\n\t\tif (mode.annotations != null) {\n\t\t\tlet command: string | undefined;\n\t\t\tswitch (mode.annotations) {\n\t\t\t\tcase 'blame':\n\t\t\t\t\tconfig.blame.toggleMode = AnnotationsToggleMode.Window;\n\t\t\t\t\tcommand = Commands.ToggleFileBlame;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'changes':\n\t\t\t\t\tconfig.changes.toggleMode = AnnotationsToggleMode.Window;\n\t\t\t\t\tcommand = Commands.ToggleFileChanges;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'heatmap':\n\t\t\t\t\tconfig.heatmap.toggleMode = AnnotationsToggleMode.Window;\n\t\t\t\t\tcommand = Commands.ToggleFileHeatmap;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (command != null) {\n\t\t\t\tconst commandArgs: ToggleFileAnnotationCommandArgs = {\n\t\t\t\t\ttype: mode.annotations as FileAnnotationType,\n\t\t\t\t\ton: true,\n\t\t\t\t};\n\t\t\t\t// Make sure to delay the execution by a bit so that the configuration changes get propegated first\n\t\t\t\tsetTimeout(() => commands.executeCommand(command!, commandArgs), 50);\n\t\t\t}\n\t\t}\n\n\t\tif (mode.codeLens != null) {\n\t\t\tconfig.codeLens.enabled = mode.codeLens;\n\t\t}\n\n\t\tif (mode.currentLine != null) {\n\t\t\tconfig.currentLine.enabled = mode.currentLine;\n\t\t}\n\n\t\tif (mode.hovers != null) {\n\t\t\tconfig.hovers.enabled = mode.hovers;\n\t\t}\n\n\t\tif (mode.statusBar != null) {\n\t\t\tconfig.statusBar.enabled = mode.statusBar;\n\t\t}\n\n\t\treturn config;\n\t}\n\n\tprivate static applyModeConfigurationTransform(e: ConfigurationChangeEvent): ConfigurationChangeEvent {\n\t\tif (this._configsAffectedByMode == null) {\n\t\t\tthis._configsAffectedByMode = [\n\t\t\t\t`gitlens.${configuration.name('mode')}`,\n\t\t\t\t`gitlens.${configuration.name('modes')}`,\n\t\t\t\t`gitlens.${configuration.name('blame.toggleMode')}`,\n\t\t\t\t`gitlens.${configuration.name('changes.toggleMode')}`,\n\t\t\t\t`gitlens.${configuration.name('codeLens')}`,\n\t\t\t\t`gitlens.${configuration.name('currentLine')}`,\n\t\t\t\t`gitlens.${configuration.name('heatmap.toggleMode')}`,\n\t\t\t\t`gitlens.${configuration.name('hovers')}`,\n\t\t\t\t`gitlens.${configuration.name('statusBar')}`,\n\t\t\t];\n\t\t}\n\n\t\tconst original = e.affectsConfiguration;\n\t\treturn {\n\t\t\t...e,\n\t\t\taffectsConfiguration: (section: string, scope?: ConfigurationScope) =>\n\t\t\t\tthis._configsAffectedByMode?.some(n => section.startsWith(n)) ? true : original(section, scope),\n\t\t};\n\t}\n}\n","'use strict';\nimport * as emojis from './emojis.json';\n\nconst emojiMap = (emojis as any).default as Record<string, string>;\nconst emojiRegex = /:([-+_a-z0-9]+):/g;\n\nexport function emojify(message: string) {\n\treturn message.replace(emojiRegex, (s, code) => {\n\t\treturn emojiMap[code] || s;\n\t});\n}\n","'use strict';\nimport { Disposable } from 'vscode';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { builtInActionRunnerName } from './actionRunners';\nimport { Action, ActionContext, ActionRunner, GitLensApi } from './gitlens';\n\nconst emptyDisposable = Object.freeze({\n\tdispose: () => {\n\t\t/* noop */\n\t},\n});\n\nexport class Api implements GitLensApi {\n\tregisterActionRunner<T extends ActionContext>(action: Action<T>, runner: ActionRunner): Disposable {\n\t\tif (runner.name === builtInActionRunnerName) {\n\t\t\tthrow new Error(`Cannot use the reserved name '${builtInActionRunnerName}'`);\n\t\t}\n\n\t\tif ((action as string) === 'hover.commandHelp') {\n\t\t\taction = 'hover.commands';\n\t\t}\n\t\treturn Container.actionRunners.register(action, runner);\n\t}\n\n\t// registerAutolinkProvider(provider: RemoteProvider): Disposable;\n\t// registerPullRequestProvider(provider: RemoteProvider): Disposable;\n\t// registerRemoteProvider(matcher: string | RegExp, provider: RemoteProvider | RichRemoteProvider): Disposable;\n}\n\nexport function preview() {\n\treturn (target: any, key: string, descriptor: PropertyDescriptor) => {\n\t\tlet fn: Function | undefined;\n\t\tif (typeof descriptor.value === 'function') {\n\t\t\tfn = descriptor.value;\n\t\t} else if (typeof descriptor.get === 'function') {\n\t\t\tfn = descriptor.get;\n\t\t}\n\t\tif (fn == null) throw new Error('Not supported');\n\n\t\tdescriptor.value = function (this: any, ...args: any[]) {\n\t\t\tif (Container.insiders || Logger.isDebugging) return fn!.apply(this, args);\n\n\t\t\tconsole.error('GitLens preview APIs are only available in the Insiders edition');\n\t\t\treturn emptyDisposable;\n\t\t};\n\t};\n}\n","'use strict';\nimport { CancellationTokenSource, commands, Extension, ExtensionContext, extensions, Uri } from 'vscode';\nimport { ActionContext, HoverCommandsActionContext } from './api/gitlens';\nimport { Commands, executeCommand, InviteToLiveShareCommandArgs } from './commands';\nimport { BuiltInCommands } from './constants';\nimport { Container } from './container';\n\nexport async function installExtension<T>(\n\textensionId: string,\n\ttokenSource: CancellationTokenSource,\n\ttimeout: number,\n\tvsix?: Uri,\n): Promise<Extension<T> | undefined> {\n\ttry {\n\t\tlet timer: any = 0;\n\t\tconst extension = new Promise<Extension<any> | undefined>(resolve => {\n\t\t\tconst disposable = extensions.onDidChange(() => {\n\t\t\t\tconst extension = extensions.getExtension(extensionId);\n\t\t\t\tif (extension != null) {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\tdisposable.dispose();\n\n\t\t\t\t\tresolve(extension);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\ttokenSource.token.onCancellationRequested(() => {\n\t\t\t\tdisposable.dispose();\n\n\t\t\t\tresolve(undefined);\n\t\t\t});\n\t\t});\n\n\t\tawait commands.executeCommand(BuiltInCommands.InstallExtension, vsix ?? extensionId);\n\t\t// Wait for extension activation until timeout expires\n\t\ttimer = setTimeout(() => tokenSource.cancel(), timeout);\n\n\t\treturn extension;\n\t} catch {\n\t\ttokenSource.cancel();\n\t\treturn undefined;\n\t}\n}\n\nexport function registerPartnerActionRunners(context: ExtensionContext): void {\n\tregisterLiveShare(context);\n}\n\nfunction registerLiveShare(context: ExtensionContext) {\n\tcontext.subscriptions.push(\n\t\tContainer.actionRunners.registerBuiltInPartner<HoverCommandsActionContext>('liveshare', 'hover.commands', {\n\t\t\tname: 'Live Share',\n\t\t\tlabel: (context: ActionContext) => {\n\t\t\t\tif (context.type === 'hover.commands') {\n\t\t\t\t\tif (context.commit.author.name !== 'You') {\n\t\t\t\t\t\treturn `$(live-share) Invite ${context.commit.author.name}${\n\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n\t\t\t\t\t\t\tcontext.commit.author.presence?.statusText\n\t\t\t\t\t\t\t\t? ` (${context.commit.author.presence?.statusText})`\n\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t} to a Live Share Session`;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn '$(live-share) Start a Live Share Session';\n\t\t\t},\n\t\t\trun: async (context: ActionContext) => {\n\t\t\t\tif (context.type !== 'hover.commands' || context.commit.author.name === 'You') {\n\t\t\t\t\tawait executeCommand<InviteToLiveShareCommandArgs>(Commands.InviteToLiveShare, {});\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tawait executeCommand<InviteToLiveShareCommandArgs>(Commands.InviteToLiveShare, {\n\t\t\t\t\temail: context.commit.author.email,\n\t\t\t\t});\n\t\t\t},\n\t\t}),\n\t);\n}\n","'use strict';\nimport { commands, ExtensionContext, extensions, window, workspace } from 'vscode';\nimport { CreatePullRequestActionContext, GitLensApi, OpenPullRequestActionContext } from '../src/api/gitlens';\nimport { Api } from './api/api';\nimport { Commands, executeCommand, OpenPullRequestOnRemoteCommandArgs, registerCommands } from './commands';\nimport { CreatePullRequestOnRemoteCommandArgs } from './commands/createPullRequestOnRemote';\nimport { configuration, Configuration, TraceLevel } from './configuration';\nimport { ContextKeys, GlobalState, GlyphChars, setContext, SyncedState } from './constants';\nimport { Container } from './container';\nimport { Git, GitBranch, GitCommit } from './git/git';\nimport { GitService } from './git/gitService';\nimport { GitUri } from './git/gitUri';\nimport { InvalidGitConfigError, UnableToFindGitError } from './git/locator';\nimport { Logger } from './logger';\nimport { Messages } from './messages';\nimport { registerPartnerActionRunners } from './partners';\nimport { Strings, Versions } from './system';\nimport { ViewNode } from './views/nodes';\n\nlet _context: ExtensionContext | undefined;\n\nexport async function activate(context: ExtensionContext): Promise<GitLensApi | undefined> {\n\tconst start = process.hrtime();\n\n\t_context = context;\n\n\tif (context.extension.id === 'eamodio.gitlens-insiders') {\n\t\t// Ensure that stable isn't also installed\n\t\tconst stable = extensions.getExtension('eamodio.gitlens');\n\t\tif (stable != null) {\n\t\t\tLogger.log('GitLens (Insiders) was NOT activated because GitLens is also enabled');\n\n\t\t\t// If we don't use a setTimeout here this notification will get lost for some reason\n\t\t\tsetTimeout(() => void Messages.showInsidersErrorMessage(), 0);\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t// Pretend we are enabled (until we know otherwise) and set the view contexts to reduce flashing on load\n\tvoid setContext(ContextKeys.Enabled, true);\n\n\tif (!workspace.isTrusted) {\n\t\tvoid setContext(ContextKeys.Readonly, true);\n\t\tcontext.subscriptions.push(\n\t\t\tworkspace.onDidGrantWorkspaceTrust(() => void setContext(ContextKeys.Readonly, undefined)),\n\t\t);\n\t}\n\n\tsetKeysForSync();\n\n\tLogger.configure(context, configuration.get('outputLevel'), o => {\n\t\tif (GitUri.is(o)) {\n\t\t\treturn `GitUri(${o.toString(true)}${o.repoPath ? ` repoPath=${o.repoPath}` : ''}${\n\t\t\t\to.sha ? ` sha=${o.sha}` : ''\n\t\t\t})`;\n\t\t}\n\n\t\tif (GitCommit.is(o)) {\n\t\t\treturn `GitCommit(${o.sha ? ` sha=${o.sha}` : ''}${o.repoPath ? ` repoPath=${o.repoPath}` : ''})`;\n\t\t}\n\n\t\tif (ViewNode.is(o)) {\n\t\t\treturn o.toString();\n\t\t}\n\n\t\treturn undefined;\n\t});\n\n\tconst gitlensVersion = context.extension.packageJSON.version;\n\n\tconst syncedVersion = context.globalState.get<string>(SyncedState.Version);\n\tconst localVersion =\n\t\tcontext.globalState.get<string>(GlobalState.Version) ??\n\t\tcontext.globalState.get<string>(GlobalState.Deprecated_Version);\n\n\tlet previousVersion;\n\tif (localVersion == null || syncedVersion == null) {\n\t\tpreviousVersion = syncedVersion ?? localVersion;\n\t} else if (Versions.compare(syncedVersion, localVersion) === 1) {\n\t\tpreviousVersion = syncedVersion;\n\t} else {\n\t\tpreviousVersion = localVersion;\n\t}\n\n\tif (Logger.willLog('debug')) {\n\t\tLogger.debug(\n\t\t\t`GitLens (v${gitlensVersion}): syncedVersion=${syncedVersion}, localVersion=${localVersion}, previousVersion=${previousVersion}, ${\n\t\t\t\tSyncedState.WelcomeViewVisible\n\t\t\t}=${context.globalState.get<boolean>(SyncedState.WelcomeViewVisible)}`,\n\t\t);\n\t}\n\n\tif (previousVersion == null) {\n\t\tvoid context.globalState.update(SyncedState.WelcomeViewVisible, true);\n\t\tvoid setContext(ContextKeys.ViewsWelcomeVisible, true);\n\t} else {\n\t\tvoid setContext(\n\t\t\tContextKeys.ViewsWelcomeVisible,\n\t\t\tcontext.globalState.get<boolean>(SyncedState.WelcomeViewVisible) ?? false,\n\t\t);\n\t}\n\n\tconst enabled = workspace.getConfiguration('git', null).get<boolean>('enabled', true);\n\tif (!enabled) {\n\t\tLogger.log(`GitLens (v${gitlensVersion}) was NOT activated -- \"git.enabled\": false`);\n\t\tvoid setEnabled(false);\n\n\t\tvoid Messages.showGitDisabledErrorMessage();\n\n\t\treturn undefined;\n\t}\n\n\tConfiguration.configure(context);\n\n\tconst cfg = configuration.get();\n\n\t// await migrateSettings(context, previousVersion);\n\n\ttry {\n\t\tawait GitService.initialize();\n\t} catch (ex) {\n\t\tLogger.error(ex, `GitLens (v${gitlensVersion}) activate`);\n\t\tvoid setEnabled(false);\n\n\t\tif (ex instanceof InvalidGitConfigError) {\n\t\t\tvoid Messages.showGitInvalidConfigErrorMessage();\n\t\t} else if (ex instanceof UnableToFindGitError) {\n\t\t\tvoid Messages.showGitMissingErrorMessage();\n\t\t} else {\n\t\t\tconst msg: string = ex?.message ?? '';\n\t\t\tif (msg) {\n\t\t\t\tvoid window.showErrorMessage(`Unable to initialize Git; ${msg}`);\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tContainer.initialize(context, cfg);\n\n\tregisterCommands(context);\n\tregisterBuiltInActionRunners(context);\n\tregisterPartnerActionRunners(context);\n\n\tconst gitVersion = Git.getGitVersion();\n\n\tnotifyOnUnsupportedGitVersion(gitVersion);\n\tvoid showWelcomeOrWhatsNew(context, gitlensVersion, previousVersion);\n\n\tvoid context.globalState.update(GlobalState.Version, gitlensVersion);\n\n\t// Only update our synced version if the new version is greater\n\tif (syncedVersion == null || Versions.compare(gitlensVersion, syncedVersion) === 1) {\n\t\tvoid context.globalState.update(SyncedState.Version, gitlensVersion);\n\t}\n\n\tif (cfg.outputLevel === TraceLevel.Debug) {\n\t\tsetTimeout(async () => {\n\t\t\tif (cfg.outputLevel !== TraceLevel.Debug) return;\n\n\t\t\tif (await Messages.showDebugLoggingWarningMessage()) {\n\t\t\t\tvoid commands.executeCommand(Commands.DisableDebugLogging);\n\t\t\t}\n\t\t}, 60000);\n\t}\n\n\tLogger.log(\n\t\t`GitLens (v${gitlensVersion}${cfg.mode.active ? `, mode: ${cfg.mode.active}` : ''}) activated ${\n\t\t\tGlyphChars.Dot\n\t\t} ${Strings.getDurationMilliseconds(start)} ms`,\n\t);\n\n\tconst api = new Api();\n\treturn api;\n}\n\nexport function deactivate() {\n\t// nothing to do\n}\n\n// async function migrateSettings(context: ExtensionContext, previousVersion: string | undefined) {\n// \tif (previousVersion === undefined) return;\n\n// \tconst previous = Versions.fromString(previousVersion);\n\n// \ttry {\n// \t\tif (Versions.compare(previous, Versions.from(11, 0, 0)) !== 1) {\n// \t\t}\n// \t} catch (ex) {\n// \t\tLogger.error(ex, 'migrateSettings');\n// \t}\n// }\n\nexport async function setEnabled(enabled: boolean): Promise<void> {\n\tawait Promise.all([setContext(ContextKeys.Enabled, enabled), setContext(ContextKeys.Disabled, !enabled)]);\n}\n\nexport function setKeysForSync(...keys: (SyncedState | string)[]) {\n\treturn _context?.globalState.setKeysForSync([...keys, SyncedState.Version, SyncedState.WelcomeViewVisible]);\n}\n\nexport function notifyOnUnsupportedGitVersion(version: string) {\n\tif (GitService.compareGitVersion('2.7.2') !== -1) return;\n\n\t// If git is less than v2.7.2\n\tvoid Messages.showGitVersionUnsupportedErrorMessage(version, '2.7.2');\n}\n\nfunction registerBuiltInActionRunners(context: ExtensionContext): void {\n\tcontext.subscriptions.push(\n\t\tContainer.actionRunners.registerBuiltIn<CreatePullRequestActionContext>('createPullRequest', {\n\t\t\tlabel: ctx => `Create Pull Request on ${ctx.remote?.provider?.name ?? 'Remote'}`,\n\t\t\trun: async ctx => {\n\t\t\t\tif (ctx.type !== 'createPullRequest') return;\n\n\t\t\t\tvoid (await executeCommand<CreatePullRequestOnRemoteCommandArgs>(Commands.CreatePullRequestOnRemote, {\n\t\t\t\t\tbase: undefined,\n\t\t\t\t\tcompare: ctx.branch.isRemote\n\t\t\t\t\t\t? GitBranch.getNameWithoutRemote(ctx.branch.name)\n\t\t\t\t\t\t: ctx.branch.upstream\n\t\t\t\t\t\t? GitBranch.getNameWithoutRemote(ctx.branch.upstream)\n\t\t\t\t\t\t: ctx.branch.name,\n\t\t\t\t\tremote: ctx.remote?.name ?? '',\n\t\t\t\t\trepoPath: ctx.repoPath,\n\t\t\t\t}));\n\t\t\t},\n\t\t}),\n\t\tContainer.actionRunners.registerBuiltIn<OpenPullRequestActionContext>('openPullRequest', {\n\t\t\tlabel: ctx => `Open Pull Request on ${ctx.provider?.name ?? 'Remote'}`,\n\t\t\trun: async ctx => {\n\t\t\t\tif (ctx.type !== 'openPullRequest') return;\n\n\t\t\t\tvoid (await executeCommand<OpenPullRequestOnRemoteCommandArgs>(Commands.OpenPullRequestOnRemote, {\n\t\t\t\t\tpr: { url: ctx.pullRequest.url },\n\t\t\t\t}));\n\t\t\t},\n\t\t}),\n\t);\n}\n\nasync function showWelcomeOrWhatsNew(context: ExtensionContext, version: string, previousVersion: string | undefined) {\n\tif (previousVersion == null) {\n\t\tLogger.log(`GitLens first-time install; window.focused=${window.state.focused}`);\n\t\tif (Container.config.showWelcomeOnInstall === false) return;\n\n\t\tif (window.state.focused) {\n\t\t\tawait context.globalState.update(GlobalState.PendingWelcomeOnFocus, undefined);\n\t\t\tawait commands.executeCommand(Commands.ShowWelcomePage);\n\t\t} else {\n\t\t\t// Save pending on window getting focus\n\t\t\tawait context.globalState.update(GlobalState.PendingWelcomeOnFocus, true);\n\t\t\tconst disposable = window.onDidChangeWindowState(e => {\n\t\t\t\tif (!e.focused) return;\n\n\t\t\t\tdisposable.dispose();\n\n\t\t\t\t// If the window is now focused and we are pending the welcome, clear the pending state and show the welcome\n\t\t\t\tif (context.globalState.get(GlobalState.PendingWelcomeOnFocus) === true) {\n\t\t\t\t\tvoid context.globalState.update(GlobalState.PendingWelcomeOnFocus, undefined);\n\t\t\t\t\tif (Container.config.showWelcomeOnInstall) {\n\t\t\t\t\t\tvoid commands.executeCommand(Commands.ShowWelcomePage);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tcontext.subscriptions.push(disposable);\n\t\t}\n\n\t\treturn;\n\t}\n\n\tif (previousVersion !== version) {\n\t\tLogger.log(`GitLens upgraded from v${previousVersion} to v${version}; window.focused=${window.state.focused}`);\n\t}\n\n\tconst [major, minor] = version.split('.').map(v => parseInt(v, 10));\n\tconst [prevMajor, prevMinor] = previousVersion.split('.').map(v => parseInt(v, 10));\n\tif (\n\t\t(major === prevMajor && minor === prevMinor) ||\n\t\t// Don't notify on downgrades\n\t\tmajor < prevMajor ||\n\t\t(major === prevMajor && minor < prevMinor)\n\t) {\n\t\treturn;\n\t}\n\n\tif (major !== prevMajor && Container.config.showWhatsNewAfterUpgrades) {\n\t\tif (window.state.focused) {\n\t\t\tawait context.globalState.update(GlobalState.PendingWhatsNewOnFocus, undefined);\n\t\t\tawait Messages.showWhatsNewMessage(version);\n\t\t} else {\n\t\t\t// Save pending on window getting focus\n\t\t\tawait context.globalState.update(GlobalState.PendingWhatsNewOnFocus, true);\n\t\t\tconst disposable = window.onDidChangeWindowState(e => {\n\t\t\t\tif (!e.focused) return;\n\n\t\t\t\tdisposable.dispose();\n\n\t\t\t\t// If the window is now focused and we are pending the what's new, clear the pending state and show the what's new\n\t\t\t\tif (context.globalState.get(GlobalState.PendingWhatsNewOnFocus) === true) {\n\t\t\t\t\tvoid context.globalState.update(GlobalState.PendingWhatsNewOnFocus, undefined);\n\t\t\t\t\tif (Container.config.showWhatsNewAfterUpgrades) {\n\t\t\t\t\t\tvoid Messages.showWhatsNewMessage(version);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tcontext.subscriptions.push(disposable);\n\t\t}\n\t}\n}\n","'use strict';\nimport { Strings } from '../../system';\n\nconst emptyStr = '';\n\nexport interface FormatOptions {\n\tdateFormat?: string | null;\n\ttokenOptions?: Record<string, Strings.TokenOptions | undefined>;\n}\n\ntype Constructor<T = Record<string, unknown>> = new (...args: any[]) => T;\n\nconst hasTokenRegexMap = new Map<string, RegExp>();\nconst spaceReplacementRegex = / /g;\n\ndeclare type RequiredTokenOptions<Options extends FormatOptions> = Options & Required<Pick<Options, 'tokenOptions'>>;\n\nexport abstract class Formatter<Item = any, Options extends FormatOptions = FormatOptions> {\n\tprotected _item!: Item;\n\tprotected _options!: RequiredTokenOptions<Options>;\n\n\tconstructor(item: Item, options?: Options) {\n\t\tthis.reset(item, options);\n\t}\n\n\treset(item: Item, options?: Options) {\n\t\tthis._item = item;\n\t\tthis.collapsableWhitespace = 0;\n\n\t\tif (options == null && this._options != null) return;\n\n\t\tif (options == null) {\n\t\t\t// eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n\t\t\toptions = {} as Options;\n\t\t}\n\n\t\tif (options.dateFormat == null) {\n\t\t\toptions.dateFormat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\tif (options.tokenOptions == null) {\n\t\t\toptions.tokenOptions = {};\n\t\t}\n\n\t\tthis._options = options as RequiredTokenOptions<Options>;\n\t}\n\n\tprivate collapsableWhitespace: number = 0;\n\n\tprotected _padOrTruncate(s: string, options: Strings.TokenOptions | undefined) {\n\t\tif (s == null || s.length === 0) return s;\n\n\t\t// NOTE: the collapsable whitespace logic relies on the javascript template evaluation to be left to right\n\t\tif (options == null) {\n\t\t\toptions = {\n\t\t\t\tcollapseWhitespace: false,\n\t\t\t\tpadDirection: 'left',\n\t\t\t\tprefix: undefined,\n\t\t\t\tsuffix: undefined,\n\t\t\t\ttruncateTo: undefined,\n\t\t\t};\n\t\t}\n\n\t\tlet max = options.truncateTo;\n\t\tif (max == null) {\n\t\t\tthis.collapsableWhitespace = 0;\n\t\t} else {\n\t\t\tmax += this.collapsableWhitespace;\n\t\t\tthis.collapsableWhitespace = 0;\n\n\t\t\tconst width = Strings.getWidth(s);\n\t\t\tconst diff = max - width;\n\t\t\tif (diff > 0) {\n\t\t\t\tif (options.collapseWhitespace) {\n\t\t\t\t\tthis.collapsableWhitespace = diff;\n\t\t\t\t}\n\n\t\t\t\tif (options.padDirection === 'left') {\n\t\t\t\t\ts = Strings.padLeft(s, max, undefined, width);\n\t\t\t\t} else {\n\t\t\t\t\tif (options.collapseWhitespace) {\n\t\t\t\t\t\tmax -= diff;\n\t\t\t\t\t}\n\t\t\t\t\ts = Strings.padRight(s, max, undefined, width);\n\t\t\t\t}\n\t\t\t} else if (diff < 0) {\n\t\t\t\ts = Strings.truncate(s, max, undefined, width);\n\t\t\t}\n\t\t}\n\n\t\tif (options.prefix || options.suffix) {\n\t\t\ts = `${options.prefix ?? emptyStr}${s}${options.suffix ?? emptyStr}`;\n\t\t}\n\n\t\treturn s;\n\t}\n\n\tprivate static _formatter: Formatter | undefined = undefined;\n\n\tprotected static fromTemplateCore<TFormatter extends Formatter<Item, Options>, Item, Options extends FormatOptions>(\n\t\tformatter: TFormatter | Constructor<TFormatter>,\n\t\ttemplate: string,\n\t\titem: Item,\n\t\tdateFormatOrOptions?: string | null | Options,\n\t): string {\n\t\t// Preserve spaces\n\t\ttemplate = template.replace(spaceReplacementRegex, '\\u00a0');\n\t\tif (formatter instanceof Formatter) return Strings.interpolate(template, formatter);\n\n\t\tlet options: Options | undefined = undefined;\n\t\tif (dateFormatOrOptions == null || typeof dateFormatOrOptions === 'string') {\n\t\t\t// eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n\t\t\toptions = {\n\t\t\t\tdateFormat: dateFormatOrOptions,\n\t\t\t} as Options;\n\t\t} else {\n\t\t\toptions = dateFormatOrOptions;\n\t\t}\n\n\t\tif (options.tokenOptions == null) {\n\t\t\tconst tokenOptions = Strings.getTokensFromTemplate(template).reduce<{\n\t\t\t\t[token: string]: Strings.TokenOptions | undefined;\n\t\t\t}>((map, token) => {\n\t\t\t\tmap[token.key] = token.options;\n\t\t\t\treturn map;\n\t\t\t}, Object.create(null));\n\n\t\t\toptions.tokenOptions = tokenOptions;\n\t\t}\n\n\t\tif (this._formatter == null) {\n\t\t\tthis._formatter = new formatter(item, options);\n\t\t} else {\n\t\t\tthis._formatter.reset(item, options);\n\t\t}\n\n\t\treturn Strings.interpolate(template, this._formatter);\n\t}\n\n\tprotected static fromTemplateCoreAsync<\n\t\tTFormatter extends Formatter<Item, Options>,\n\t\tItem,\n\t\tOptions extends FormatOptions,\n\t>(\n\t\tformatter: TFormatter | Constructor<TFormatter>,\n\t\ttemplate: string,\n\t\titem: Item,\n\t\tdateFormatOrOptions?: string | null | Options,\n\t): Promise<string> {\n\t\t// Preserve spaces\n\t\ttemplate = template.replace(spaceReplacementRegex, '\\u00a0');\n\t\tif (formatter instanceof Formatter) return Strings.interpolateAsync(template, formatter);\n\n\t\tlet options: Options | undefined = undefined;\n\t\tif (dateFormatOrOptions == null || typeof dateFormatOrOptions === 'string') {\n\t\t\t// eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n\t\t\toptions = {\n\t\t\t\tdateFormat: dateFormatOrOptions,\n\t\t\t} as Options;\n\t\t} else {\n\t\t\toptions = dateFormatOrOptions;\n\t\t}\n\n\t\tif (options.tokenOptions == null) {\n\t\t\tconst tokenOptions = Strings.getTokensFromTemplate(template).reduce<{\n\t\t\t\t[token: string]: Strings.TokenOptions | undefined;\n\t\t\t}>((map, token) => {\n\t\t\t\tmap[token.key] = token.options;\n\t\t\t\treturn map;\n\t\t\t}, Object.create(null));\n\n\t\t\toptions.tokenOptions = tokenOptions;\n\t\t}\n\n\t\tif (this._formatter == null) {\n\t\t\tthis._formatter = new formatter(item, options);\n\t\t} else {\n\t\t\tthis._formatter.reset(item, options);\n\t\t}\n\n\t\treturn Strings.interpolateAsync(template, this._formatter);\n\t}\n\n\tstatic has<TOptions extends FormatOptions>(\n\t\ttemplate: string,\n\t\t...tokens: (keyof NonNullable<TOptions['tokenOptions']>)[]\n\t): boolean {\n\t\tconst token =\n\t\t\ttokens.length === 1\n\t\t\t\t? (tokens[0] as string)\n\t\t\t\t: (`(${tokens.join('|')})` as keyof NonNullable<TOptions['tokenOptions']> as string);\n\n\t\tlet regex = hasTokenRegexMap.get(token);\n\t\tif (regex == null) {\n\t\t\tregex = new RegExp(`\\\\b${token}\\\\b`);\n\t\t\thasTokenRegexMap.set(token, regex);\n\t\t}\n\n\t\treturn regex.test(template);\n\t}\n}\n","'use strict';\nimport { Uri } from 'vscode';\nimport { HoverCommandsActionContext, OpenPullRequestActionContext } from '../../api/gitlens';\nimport { getPresenceDataUri } from '../../avatars';\nimport {\n\tCommands,\n\tConnectRemoteProviderCommand,\n\tDiffWithCommand,\n\tgetMarkdownActionCommand,\n\tOpenCommitOnRemoteCommand,\n\tOpenFileAtRevisionCommand,\n\tShowQuickCommitCommand,\n\tShowQuickCommitFileCommand,\n} from '../../commands';\nimport { DateStyle, FileAnnotationType } from '../../configuration';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { emojify } from '../../emojis';\nimport { Iterables, Promises, Strings } from '../../system';\nimport { ContactPresence } from '../../vsls/vsls';\nimport {\n\tGitCommit,\n\tGitLogCommit,\n\tGitRemote,\n\tGitRevision,\n\tIssueOrPullRequest,\n\tPullRequest,\n\tRemoteProvider,\n} from '../git';\nimport { GitUri } from '../gitUri';\nimport { FormatOptions, Formatter } from './formatter';\n\nconst emptyStr = '';\n\nexport interface CommitFormatOptions extends FormatOptions {\n\tautolinkedIssuesOrPullRequests?: Map<string, IssueOrPullRequest | Promises.CancellationError | undefined>;\n\tavatarSize?: number;\n\tdateStyle?: DateStyle;\n\teditor?: { line: number; uri: Uri };\n\tfootnotes?: Map<number, string>;\n\tgetBranchAndTagTips?: (sha: string, options?: { compact?: boolean; icons?: boolean }) => string | undefined;\n\tmarkdown?: boolean;\n\tmessageAutolinks?: boolean;\n\tmessageIndent?: number;\n\tmessageTruncateAtNewLine?: boolean;\n\tpullRequestOrRemote?: PullRequest | Promises.CancellationError | GitRemote;\n\tpullRequestPendingMessage?: string;\n\tpresence?: ContactPresence;\n\tpreviousLineDiffUris?: { current: GitUri; previous: GitUri | undefined };\n\tremotes?: GitRemote<RemoteProvider>[];\n\tunpublished?: boolean;\n\n\ttokenOptions?: {\n\t\tago?: Strings.TokenOptions;\n\t\tagoOrDate?: Strings.TokenOptions;\n\t\tagoOrDateShort?: Strings.TokenOptions;\n\t\tauthor?: Strings.TokenOptions;\n\t\tauthorAgo?: Strings.TokenOptions;\n\t\tauthorAgoOrDate?: Strings.TokenOptions;\n\t\tauthorAgoOrDateShort?: Strings.TokenOptions;\n\t\tauthorDate?: Strings.TokenOptions;\n\t\tauthorNotYou?: Strings.TokenOptions;\n\t\tavatar?: Strings.TokenOptions;\n\t\tchanges?: Strings.TokenOptions;\n\t\tchangesDetail?: Strings.TokenOptions;\n\t\tchangesShort?: Strings.TokenOptions;\n\t\tcommands?: Strings.TokenOptions;\n\t\tcommitterAgo?: Strings.TokenOptions;\n\t\tcommitterAgoOrDate?: Strings.TokenOptions;\n\t\tcommitterAgoOrDateShort?: Strings.TokenOptions;\n\t\tcommitterDate?: Strings.TokenOptions;\n\t\tdate?: Strings.TokenOptions;\n\t\temail?: Strings.TokenOptions;\n\t\tfootnotes?: Strings.TokenOptions;\n\t\tid?: Strings.TokenOptions;\n\t\tmessage?: Strings.TokenOptions;\n\t\tpullRequest?: Strings.TokenOptions;\n\t\tpullRequestAgo?: Strings.TokenOptions;\n\t\tpullRequestAgoOrDate?: Strings.TokenOptions;\n\t\tpullRequestDate?: Strings.TokenOptions;\n\t\tpullRequestState?: Strings.TokenOptions;\n\t\tsha?: Strings.TokenOptions;\n\t\ttips?: Strings.TokenOptions;\n\t};\n}\n\nexport class CommitFormatter extends Formatter<GitCommit, CommitFormatOptions> {\n\tprivate get _authorDate() {\n\t\treturn this._item.formatAuthorDate(this._options.dateFormat);\n\t}\n\n\tprivate get _authorDateAgo() {\n\t\treturn this._item.formatAuthorDateFromNow();\n\t}\n\n\tprivate get _authorDateAgoShort() {\n\t\treturn this._item.formatCommitterDateFromNow('en-short');\n\t}\n\n\tprivate get _committerDate() {\n\t\treturn this._item.formatCommitterDate(this._options.dateFormat);\n\t}\n\n\tprivate get _committerDateAgo() {\n\t\treturn this._item.formatCommitterDateFromNow();\n\t}\n\n\tprivate get _committerDateAgoShort() {\n\t\treturn this._item.formatCommitterDateFromNow('en-short');\n\t}\n\n\tprivate get _date() {\n\t\treturn this._item.formatDate(this._options.dateFormat);\n\t}\n\n\tprivate get _dateAgo() {\n\t\treturn this._item.formatDateFromNow();\n\t}\n\n\tprivate get _dateAgoShort() {\n\t\treturn this._item.formatDateFromNow('en-short');\n\t}\n\n\tprivate get _pullRequestDate() {\n\t\tconst { pullRequestOrRemote: pr } = this._options;\n\t\tif (pr == null || !PullRequest.is(pr)) return emptyStr;\n\n\t\treturn pr.formatDate(this._options.dateFormat) ?? emptyStr;\n\t}\n\n\tprivate get _pullRequestDateAgo() {\n\t\tconst { pullRequestOrRemote: pr } = this._options;\n\t\tif (pr == null || !PullRequest.is(pr)) return emptyStr;\n\n\t\treturn pr.formatDateFromNow() ?? emptyStr;\n\t}\n\n\tprivate get _pullRequestDateOrAgo() {\n\t\tconst dateStyle = this._options.dateStyle != null ? this._options.dateStyle : Container.config.defaultDateStyle;\n\t\treturn dateStyle === DateStyle.Absolute ? this._pullRequestDate : this._pullRequestDateAgo;\n\t}\n\n\tget ago(): string {\n\t\treturn this._padOrTruncate(this._dateAgo, this._options.tokenOptions.ago);\n\t}\n\n\tget agoOrDate(): string {\n\t\tconst dateStyle = this._options.dateStyle != null ? this._options.dateStyle : Container.config.defaultDateStyle;\n\t\treturn this._padOrTruncate(\n\t\t\tdateStyle === DateStyle.Absolute ? this._date : this._dateAgo,\n\t\t\tthis._options.tokenOptions.agoOrDate,\n\t\t);\n\t}\n\n\tget agoOrDateShort(): string {\n\t\tconst dateStyle = this._options.dateStyle != null ? this._options.dateStyle : Container.config.defaultDateStyle;\n\t\treturn this._padOrTruncate(\n\t\t\tdateStyle === DateStyle.Absolute ? this._date : this._dateAgoShort,\n\t\t\tthis._options.tokenOptions.agoOrDateShort,\n\t\t);\n\t}\n\n\tget author(): string {\n\t\tconst author = this._padOrTruncate(this._item.author, this._options.tokenOptions.author);\n\t\tif (!this._options.markdown) {\n\t\t\treturn author;\n\t\t}\n\n\t\treturn `[${author}](mailto:${this._item.email} \"Email ${this._item.author} (${this._item.email})\")`;\n\t}\n\n\tget authorAgo(): string {\n\t\treturn this._padOrTruncate(this._authorDateAgo, this._options.tokenOptions.authorAgo);\n\t}\n\n\tget authorAgoOrDate(): string {\n\t\tconst dateStyle = this._options.dateStyle != null ? this._options.dateStyle : Container.config.defaultDateStyle;\n\t\treturn this._padOrTruncate(\n\t\t\tdateStyle === DateStyle.Absolute ? this._authorDate : this._authorDateAgo,\n\t\t\tthis._options.tokenOptions.authorAgoOrDate,\n\t\t);\n\t}\n\n\tget authorAgoOrDateShort(): string {\n\t\tconst dateStyle = this._options.dateStyle != null ? this._options.dateStyle : Container.config.defaultDateStyle;\n\t\treturn this._padOrTruncate(\n\t\t\tdateStyle === DateStyle.Absolute ? this._authorDate : this._authorDateAgoShort,\n\t\t\tthis._options.tokenOptions.authorAgoOrDateShort,\n\t\t);\n\t}\n\n\tget authorDate(): string {\n\t\treturn this._padOrTruncate(this._authorDate, this._options.tokenOptions.authorDate);\n\t}\n\n\tget authorNotYou(): string {\n\t\tif (this._item.author === 'You') return this._padOrTruncate(emptyStr, this._options.tokenOptions.authorNotYou);\n\n\t\tconst author = this._padOrTruncate(this._item.author, this._options.tokenOptions.authorNotYou);\n\t\tif (!this._options.markdown) {\n\t\t\treturn author;\n\t\t}\n\n\t\treturn `[${author}](mailto:${this._item.email} \"Email ${this._item.author} (${this._item.email})\")`;\n\t}\n\n\tget avatar(): string | Promise<string> {\n\t\tif (!this._options.markdown || !Container.config.hovers.avatars) {\n\t\t\treturn this._padOrTruncate(emptyStr, this._options.tokenOptions.avatar);\n\t\t}\n\n\t\tconst presence = this._options.presence;\n\t\tif (presence != null) {\n\t\t\tconst title = `${this._item.author} ${this._item.author === 'You' ? 'are' : 'is'} ${\n\t\t\t\tpresence.status === 'dnd' ? 'in ' : emptyStr\n\t\t\t}${presence.statusText.toLocaleLowerCase()}`;\n\n\t\t\tconst avatarMarkdownPromise = this._getAvatarMarkdown(title, this._options.avatarSize);\n\t\t\treturn avatarMarkdownPromise.then(md =>\n\t\t\t\tthis._padOrTruncate(\n\t\t\t\t\t`${md}${this._getPresenceMarkdown(presence, title)}`,\n\t\t\t\t\tthis._options.tokenOptions.avatar,\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\treturn this._getAvatarMarkdown(this._item.author, this._options.avatarSize);\n\t}\n\n\tprivate async _getAvatarMarkdown(title: string, size?: number) {\n\t\tsize = size ?? Container.config.hovers.avatarSize;\n\t\tconst avatarPromise = this._item.getAvatarUri({\n\t\t\tdefaultStyle: Container.config.defaultGravatarsStyle,\n\t\t\tsize: size,\n\t\t});\n\t\treturn this._padOrTruncate(\n\t\t\t`![${title}](${(await avatarPromise).toString(true)}|width=${size},height=${size} \"${title}\")`,\n\t\t\tthis._options.tokenOptions.avatar,\n\t\t);\n\t}\n\n\tprivate _getPresenceMarkdown(presence: ContactPresence, title: string) {\n\t\treturn `![${title}](${getPresenceDataUri(presence.status)} \"${title}\")`;\n\t}\n\n\tget changes(): string {\n\t\treturn this._padOrTruncate(\n\t\t\tGitLogCommit.is(this._item) ? this._item.getFormattedDiffStatus() : emptyStr,\n\t\t\tthis._options.tokenOptions.changes,\n\t\t);\n\t}\n\n\tget changesDetail(): string {\n\t\treturn this._padOrTruncate(\n\t\t\tGitLogCommit.is(this._item)\n\t\t\t\t? this._item.getFormattedDiffStatus({ expand: true, separator: ', ' })\n\t\t\t\t: emptyStr,\n\t\t\tthis._options.tokenOptions.changesDetail,\n\t\t);\n\t}\n\n\tget changesShort(): string {\n\t\treturn this._padOrTruncate(\n\t\t\tGitLogCommit.is(this._item)\n\t\t\t\t? this._item.getFormattedDiffStatus({ compact: true, separator: emptyStr })\n\t\t\t\t: emptyStr,\n\t\t\tthis._options.tokenOptions.changesShort,\n\t\t);\n\t}\n\n\tget commands(): string {\n\t\tif (!this._options.markdown) return this._padOrTruncate(emptyStr, this._options.tokenOptions.commands);\n\n\t\tlet commands;\n\t\tif (this._item.isUncommitted) {\n\t\t\tconst { previousLineDiffUris: diffUris } = this._options;\n\t\t\tif (diffUris?.previous != null) {\n\t\t\t\tcommands = `\\`${this._padOrTruncate(\n\t\t\t\t\tGitRevision.shorten(\n\t\t\t\t\t\tGitRevision.isUncommittedStaged(diffUris.current.sha)\n\t\t\t\t\t\t\t? diffUris.current.sha\n\t\t\t\t\t\t\t: GitRevision.uncommitted,\n\t\t\t\t\t)!,\n\t\t\t\t\tthis._options.tokenOptions.commands,\n\t\t\t\t)}\\``;\n\n\t\t\t\tcommands += `&nbsp; **[\\`${GlyphChars.MuchLessThan}\\`](${DiffWithCommand.getMarkdownCommandArgs({\n\t\t\t\t\tlhs: {\n\t\t\t\t\t\tsha: diffUris.previous.sha ?? emptyStr,\n\t\t\t\t\t\turi: diffUris.previous.documentUri(),\n\t\t\t\t\t},\n\t\t\t\t\trhs: {\n\t\t\t\t\t\tsha: diffUris.current.sha ?? emptyStr,\n\t\t\t\t\t\turi: diffUris.current.documentUri(),\n\t\t\t\t\t},\n\t\t\t\t\trepoPath: this._item.repoPath,\n\t\t\t\t\tline: this._options.editor?.line,\n\t\t\t\t})} \"Open Changes\")** `;\n\t\t\t} else {\n\t\t\t\tcommands = `\\`${this._padOrTruncate(\n\t\t\t\t\tGitRevision.shorten(\n\t\t\t\t\t\tthis._item.isUncommittedStaged ? GitRevision.uncommittedStaged : GitRevision.uncommitted,\n\t\t\t\t\t)!,\n\t\t\t\t\tthis._options.tokenOptions.commands,\n\t\t\t\t)}\\``;\n\t\t\t}\n\n\t\t\treturn commands;\n\t\t}\n\n\t\tconst separator = ' &nbsp;&nbsp;|&nbsp;&nbsp; ';\n\n\t\tcommands = `---\\n\\n[$(git-commit) ${this.id}](${ShowQuickCommitCommand.getMarkdownCommandArgs(\n\t\t\tthis._item.sha,\n\t\t)} \"Show Commit\")`;\n\n\t\tcommands += ` &nbsp;&nbsp;[$(compare-changes)](${DiffWithCommand.getMarkdownCommandArgs(\n\t\t\tthis._item,\n\t\t\tthis._options.editor?.line,\n\t\t)} \"Open Changes\")`;\n\n\t\tif (this._item.previousSha != null) {\n\t\t\tconst uri = GitUri.toRevisionUri(\n\t\t\t\tthis._item.previousSha,\n\t\t\t\tthis._item.previousUri.fsPath,\n\t\t\t\tthis._item.repoPath,\n\t\t\t);\n\t\t\tcommands += ` &nbsp;&nbsp;[$(versions)](${OpenFileAtRevisionCommand.getMarkdownCommandArgs(\n\t\t\t\turi,\n\t\t\t\tFileAnnotationType.Blame,\n\t\t\t\tthis._options.editor?.line,\n\t\t\t)} \"Open Blame Prior to this Change\")`;\n\t\t}\n\n\t\tif (this._options.remotes != null && this._options.remotes.length !== 0) {\n\t\t\tconst providers = GitRemote.getHighlanderProviders(this._options.remotes);\n\n\t\t\tcommands += ` &nbsp;&nbsp;[$(globe)](${OpenCommitOnRemoteCommand.getMarkdownCommandArgs(\n\t\t\t\tthis._item.sha,\n\t\t\t)} \"Open Commit on ${providers?.length ? providers[0].name : 'Remote'}\")`;\n\t\t}\n\n\t\tconst { pullRequestOrRemote: pr } = this._options;\n\t\tif (pr != null) {\n\t\t\tif (PullRequest.is(pr)) {\n\t\t\t\tcommands += `${separator}[$(git-pull-request) PR #${\n\t\t\t\t\tpr.id\n\t\t\t\t}](${getMarkdownActionCommand<OpenPullRequestActionContext>('openPullRequest', {\n\t\t\t\t\trepoPath: this._item.repoPath,\n\t\t\t\t\tprovider: { id: pr.provider.id, name: pr.provider.name, domain: pr.provider.domain },\n\t\t\t\t\tpullRequest: { id: pr.id, url: pr.url },\n\t\t\t\t})} \"Open Pull Request \\\\#${pr.id}${\n\t\t\t\t\tContainer.actionRunners.count('openPullRequest') == 1 ? ` on ${pr.provider.name}` : '...'\n\t\t\t\t}\\n${GlyphChars.Dash.repeat(2)}\\n${Strings.escapeMarkdown(pr.title).replace(/\"/g, '\\\\\"')}\\n${\n\t\t\t\t\tpr.state\n\t\t\t\t}, ${pr.formatDateFromNow()}\")`;\n\t\t\t} else if (pr instanceof Promises.CancellationError) {\n\t\t\t\tcommands += `${separator}[$(git-pull-request) PR $(loading~spin)](command:${Commands.RefreshHover} \"Searching for a Pull Request (if any) that introduced this commit...\")`;\n\t\t\t} else if (pr.provider != null && Container.config.integrations.enabled) {\n\t\t\t\tcommands += `${separator}[$(plug) Connect to ${pr.provider.name}${\n\t\t\t\t\tGlyphChars.Ellipsis\n\t\t\t\t}](${ConnectRemoteProviderCommand.getMarkdownCommandArgs(pr)} \"Connect to ${\n\t\t\t\t\tpr.provider.name\n\t\t\t\t} to enable the display of the Pull Request (if any) that introduced this commit\")`;\n\t\t\t}\n\t\t}\n\n\t\tif (Container.actionRunners.count('hover.commands') > 0) {\n\t\t\tcommands += `${separator}[$(organization) Team${GlyphChars.SpaceThinnest}${\n\t\t\t\tGlyphChars.Ellipsis\n\t\t\t}](${getMarkdownActionCommand<HoverCommandsActionContext>('hover.commands', {\n\t\t\t\trepoPath: this._item.repoPath,\n\t\t\t\tcommit: {\n\t\t\t\t\tsha: this._item.sha,\n\t\t\t\t\tauthor: {\n\t\t\t\t\t\tname: this._item.author,\n\t\t\t\t\t\temail: this._item.email,\n\t\t\t\t\t\tpresence: this._options.presence,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tfile:\n\t\t\t\t\tthis._options.editor != null\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\turi: this._options.editor?.uri.toString(),\n\t\t\t\t\t\t\t\tline: this._options.editor?.line,\n\t\t\t\t\t\t  }\n\t\t\t\t\t\t: undefined,\n\t\t\t})} \"Show Team Actions\")`;\n\t\t}\n\n\t\tcommands += `${separator}[$(ellipsis)](${ShowQuickCommitFileCommand.getMarkdownCommandArgs({\n\t\t\trevisionUri: GitUri.toRevisionUri(this._item.toGitUri()).toString(true),\n\t\t})} \"Show More Actions\")`;\n\n\t\treturn this._padOrTruncate(commands, this._options.tokenOptions.commands);\n\t}\n\n\tget committerAgo(): string {\n\t\treturn this._padOrTruncate(this._committerDateAgo, this._options.tokenOptions.committerAgo);\n\t}\n\n\tget committerAgoOrDate(): string {\n\t\tconst dateStyle = this._options.dateStyle != null ? this._options.dateStyle : Container.config.defaultDateStyle;\n\t\treturn this._padOrTruncate(\n\t\t\tdateStyle === DateStyle.Absolute ? this._committerDate : this._committerDateAgo,\n\t\t\tthis._options.tokenOptions.committerAgoOrDate,\n\t\t);\n\t}\n\n\tget committerAgoOrDateShort(): string {\n\t\tconst dateStyle = this._options.dateStyle != null ? this._options.dateStyle : Container.config.defaultDateStyle;\n\t\treturn this._padOrTruncate(\n\t\t\tdateStyle === DateStyle.Absolute ? this._committerDate : this._committerDateAgoShort,\n\t\t\tthis._options.tokenOptions.committerAgoOrDateShort,\n\t\t);\n\t}\n\n\tget committerDate(): string {\n\t\treturn this._padOrTruncate(this._committerDate, this._options.tokenOptions.committerDate);\n\t}\n\n\tget date(): string {\n\t\treturn this._padOrTruncate(this._date, this._options.tokenOptions.date);\n\t}\n\n\tget email(): string {\n\t\treturn this._padOrTruncate(this._item.email ?? emptyStr, this._options.tokenOptions.email);\n\t}\n\n\tget footnotes(): string {\n\t\treturn this._padOrTruncate(\n\t\t\tthis._options.footnotes == null || this._options.footnotes.size === 0\n\t\t\t\t? emptyStr\n\t\t\t\t: Iterables.join(\n\t\t\t\t\t\tIterables.map(this._options.footnotes, ([i, footnote]) =>\n\t\t\t\t\t\t\tthis._options.markdown ? footnote : `${Strings.getSuperscript(i)} ${footnote}`,\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis._options.markdown ? '\\\\\\n' : '\\n',\n\t\t\t\t  ),\n\t\t\tthis._options.tokenOptions.footnotes,\n\t\t);\n\t}\n\n\tget id(): string {\n\t\tconst sha = this._padOrTruncate(this._item.shortSha ?? emptyStr, this._options.tokenOptions.id);\n\t\tif (this._options.markdown && this._options.unpublished) {\n\t\t\treturn `<span style=\"color:#35b15e;\">${sha} (unpublished)</span>`;\n\t\t}\n\n\t\treturn sha;\n\t}\n\n\tget message(): string {\n\t\tif (this._item.isUncommitted) {\n\t\t\tconst confliced = this._item.hasConflicts;\n\t\t\tconst staged =\n\t\t\t\tthis._item.isUncommittedStaged ||\n\t\t\t\t(this._options.previousLineDiffUris?.current?.isUncommittedStaged ?? false);\n\n\t\t\treturn this._padOrTruncate(\n\t\t\t\t`${this._options.markdown ? '\\n> ' : ''}${\n\t\t\t\t\tconfliced ? 'Merge' : staged ? 'Staged' : 'Uncommitted'\n\t\t\t\t} changes`,\n\t\t\t\tthis._options.tokenOptions.message,\n\t\t\t);\n\t\t}\n\n\t\tlet message = this._item.message;\n\t\tif (this._options.messageTruncateAtNewLine) {\n\t\t\tconst index = message.indexOf('\\n');\n\t\t\tif (index !== -1) {\n\t\t\t\tmessage = `${message.substring(0, index)}${GlyphChars.Space}${GlyphChars.Ellipsis}`;\n\t\t\t}\n\t\t}\n\n\t\tmessage = emojify(message);\n\t\tmessage = this._padOrTruncate(message, this._options.tokenOptions.message);\n\n\t\tif (this._options.messageAutolinks) {\n\t\t\tmessage = Container.autolinks.linkify(\n\t\t\t\tthis._options.markdown ? Strings.escapeMarkdown(message, { quoted: true }) : message,\n\t\t\t\tthis._options.markdown ?? false,\n\t\t\t\tthis._options.remotes,\n\t\t\t\tthis._options.autolinkedIssuesOrPullRequests,\n\t\t\t\tthis._options.footnotes,\n\t\t\t);\n\t\t}\n\n\t\tif (this._options.messageIndent != null && !this._options.markdown) {\n\t\t\tmessage = message.replace(/^/gm, GlyphChars.Space.repeat(this._options.messageIndent));\n\t\t}\n\n\t\treturn this._options.markdown ? `\\n> ${message}` : message;\n\t}\n\n\tget pullRequest(): string {\n\t\tconst { pullRequestOrRemote: pr } = this._options;\n\t\tif (pr == null) return this._padOrTruncate(emptyStr, this._options.tokenOptions.pullRequest);\n\n\t\tlet text;\n\t\tif (PullRequest.is(pr)) {\n\t\t\tif (this._options.markdown) {\n\t\t\t\tconst prTitle = Strings.escapeMarkdown(pr.title).replace(/\"/g, '\\\\\"').trim();\n\n\t\t\t\ttext = `PR [**#${pr.id}**](${getMarkdownActionCommand<OpenPullRequestActionContext>('openPullRequest', {\n\t\t\t\t\trepoPath: this._item.repoPath,\n\t\t\t\t\tprovider: { id: pr.provider.id, name: pr.provider.name, domain: pr.provider.domain },\n\t\t\t\t\tpullRequest: { id: pr.id, url: pr.url },\n\t\t\t\t})} \"Open Pull Request \\\\#${pr.id}${\n\t\t\t\t\tContainer.actionRunners.count('openPullRequest') == 1 ? ` on ${pr.provider.name}` : '...'\n\t\t\t\t}\\n${GlyphChars.Dash.repeat(2)}\\n${Strings.escapeMarkdown(pr.title).replace(/\"/g, '\\\\\"')}\\n${\n\t\t\t\t\tpr.state\n\t\t\t\t}, ${pr.formatDateFromNow()}\")`;\n\n\t\t\t\tif (this._options.footnotes != null) {\n\t\t\t\t\tconst index = this._options.footnotes.size + 1;\n\t\t\t\t\tthis._options.footnotes.set(\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\t`[**$(git-pull-request) ${prTitle}**](${pr.url} \"Open Pull Request \\\\#${pr.id} on ${\n\t\t\t\t\t\t\tpr.provider.name\n\t\t\t\t\t\t}\")\\\\\\n${GlyphChars.Space.repeat(4)} #${\n\t\t\t\t\t\t\tpr.id\n\t\t\t\t\t\t} ${pr.state.toLocaleLowerCase()} ${pr.formatDateFromNow()}`,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else if (this._options.footnotes != null) {\n\t\t\t\tconst index = this._options.footnotes.size + 1;\n\t\t\t\tthis._options.footnotes.set(\n\t\t\t\t\tindex,\n\t\t\t\t\t`PR #${pr.id}: ${pr.title}  ${GlyphChars.Dot}  ${pr.state}, ${pr.formatDateFromNow()}`,\n\t\t\t\t);\n\n\t\t\t\ttext = `PR #${pr.id}${Strings.getSuperscript(index)}`;\n\t\t\t} else {\n\t\t\t\ttext = `PR #${pr.id}`;\n\t\t\t}\n\t\t} else if (pr instanceof Promises.CancellationError) {\n\t\t\ttext = this._options.markdown\n\t\t\t\t? `[PR $(loading~spin)](command:${Commands.RefreshHover} \"Searching for a Pull Request (if any) that introduced this commit...\")`\n\t\t\t\t: this._options?.pullRequestPendingMessage ?? emptyStr;\n\t\t} else {\n\t\t\treturn this._padOrTruncate(emptyStr, this._options.tokenOptions.pullRequest);\n\t\t}\n\n\t\treturn this._padOrTruncate(text, this._options.tokenOptions.pullRequest);\n\t}\n\n\tget pullRequestAgo(): string {\n\t\treturn this._padOrTruncate(this._pullRequestDateAgo, this._options.tokenOptions.pullRequestAgo);\n\t}\n\n\tget pullRequestAgoOrDate(): string {\n\t\treturn this._padOrTruncate(this._pullRequestDateOrAgo, this._options.tokenOptions.pullRequestAgoOrDate);\n\t}\n\n\tget pullRequestDate(): string {\n\t\treturn this._padOrTruncate(this._pullRequestDate, this._options.tokenOptions.pullRequestDate);\n\t}\n\n\tget pullRequestState(): string {\n\t\tconst { pullRequestOrRemote: pr } = this._options;\n\t\treturn this._padOrTruncate(\n\t\t\tpr == null || !PullRequest.is(pr) ? emptyStr : pr.state ?? emptyStr,\n\t\t\tthis._options.tokenOptions.pullRequestState,\n\t\t);\n\t}\n\n\tget sha(): string {\n\t\treturn this._padOrTruncate(this._item.shortSha ?? emptyStr, this._options.tokenOptions.sha);\n\t}\n\n\tget tips(): string {\n\t\tlet branchAndTagTips = this._options.getBranchAndTagTips?.(this._item.sha, { icons: this._options.markdown });\n\t\tif (branchAndTagTips != null && this._options.markdown) {\n\t\t\tconst tips = branchAndTagTips.split(', ');\n\t\t\tbranchAndTagTips = tips\n\t\t\t\t.map(t => `<span style=\"color:#ffffff;background-color:#1d76db;\">&nbsp;&nbsp;${t}&nbsp;&nbsp;</span>`)\n\t\t\t\t.join(GlyphChars.Space.repeat(3));\n\t\t}\n\t\treturn this._padOrTruncate(branchAndTagTips ?? emptyStr, this._options.tokenOptions.tips);\n\t}\n\n\tstatic fromTemplate(template: string, commit: GitCommit, dateFormat: string | null): string;\n\tstatic fromTemplate(template: string, commit: GitCommit, options?: CommitFormatOptions): string;\n\tstatic fromTemplate(\n\t\ttemplate: string,\n\t\tcommit: GitCommit,\n\t\tdateFormatOrOptions?: string | null | CommitFormatOptions,\n\t): string;\n\tstatic fromTemplate(\n\t\ttemplate: string,\n\t\tcommit: GitCommit,\n\t\tdateFormatOrOptions?: string | null | CommitFormatOptions,\n\t): string {\n\t\tif (dateFormatOrOptions == null || typeof dateFormatOrOptions === 'string') {\n\t\t\tdateFormatOrOptions = {\n\t\t\t\tdateFormat: dateFormatOrOptions,\n\t\t\t};\n\t\t}\n\n\t\tif (CommitFormatter.has(template, 'footnotes')) {\n\t\t\tif (dateFormatOrOptions.footnotes == null) {\n\t\t\t\tdateFormatOrOptions.footnotes = new Map<number, string>();\n\t\t\t}\n\t\t}\n\n\t\tif (CommitFormatter.has(template, 'avatar') && dateFormatOrOptions?.markdown) {\n\t\t\t// eslint-disable-next-line no-debugger\n\t\t\tdebugger;\n\t\t\tthrow new Error(\"Invalid template token 'avatar' used in non-async call\");\n\t\t}\n\n\t\treturn super.fromTemplateCore(this, template, commit, dateFormatOrOptions);\n\t}\n\n\tstatic fromTemplateAsync(template: string, commit: GitCommit, dateFormat: string | null): Promise<string>;\n\tstatic fromTemplateAsync(template: string, commit: GitCommit, options?: CommitFormatOptions): Promise<string>;\n\tstatic fromTemplateAsync(\n\t\ttemplate: string,\n\t\tcommit: GitCommit,\n\t\tdateFormatOrOptions?: string | null | CommitFormatOptions,\n\t): Promise<string>;\n\tstatic fromTemplateAsync(\n\t\ttemplate: string,\n\t\tcommit: GitCommit,\n\t\tdateFormatOrOptions?: string | null | CommitFormatOptions,\n\t): Promise<string> {\n\t\tif (CommitFormatter.has(template, 'footnotes')) {\n\t\t\tif (dateFormatOrOptions == null || typeof dateFormatOrOptions === 'string') {\n\t\t\t\tdateFormatOrOptions = {\n\t\t\t\t\tdateFormat: dateFormatOrOptions,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (dateFormatOrOptions.footnotes == null) {\n\t\t\t\tdateFormatOrOptions.footnotes = new Map<number, string>();\n\t\t\t}\n\t\t}\n\n\t\treturn super.fromTemplateCoreAsync(this, template, commit, dateFormatOrOptions);\n\t}\n\n\tstatic override has(\n\t\ttemplate: string,\n\t\t...tokens: (keyof NonNullable<CommitFormatOptions['tokenOptions']>)[]\n\t): boolean {\n\t\treturn super.has<CommitFormatOptions>(template, ...tokens);\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { GlyphChars } from '../../constants';\nimport { Strings } from '../../system';\nimport { GitFile, GitFileWithCommit } from '../models/file';\nimport { FormatOptions, Formatter } from './formatter';\n\nexport interface StatusFormatOptions extends FormatOptions {\n\trelativePath?: string;\n\n\ttokenOptions?: {\n\t\tdirectory?: Strings.TokenOptions;\n\t\tfile?: Strings.TokenOptions;\n\t\tfilePath?: Strings.TokenOptions;\n\t\toriginalPath?: Strings.TokenOptions;\n\t\tpath?: Strings.TokenOptions;\n\t\tstatus?: Strings.TokenOptions;\n\t\tworking?: Strings.TokenOptions;\n\t};\n}\n\nexport class StatusFileFormatter extends Formatter<GitFile, StatusFormatOptions> {\n\tget directory() {\n\t\tconst directory = GitFile.getFormattedDirectory(this._item, false, this._options.relativePath);\n\t\treturn this._padOrTruncate(directory, this._options.tokenOptions.directory);\n\t}\n\n\tget file() {\n\t\tconst file = paths.basename(this._item.fileName);\n\t\treturn this._padOrTruncate(file, this._options.tokenOptions.file);\n\t}\n\n\tget filePath() {\n\t\tconst filePath = GitFile.getFormattedPath(this._item, {\n\t\t\trelativeTo: this._options.relativePath,\n\t\t\ttruncateTo: this._options.tokenOptions.filePath?.truncateTo,\n\t\t});\n\t\treturn this._padOrTruncate(filePath, this._options.tokenOptions.filePath);\n\t}\n\n\tget originalPath() {\n\t\t// if (\n\t\t//     // this._item.status !== 'R' ||\n\t\t//     this._item.originalFileName == null ||\n\t\t//     this._item.originalFileName.length === 0\n\t\t// ) {\n\t\t//     return '';\n\t\t// }\n\n\t\tconst originalPath = GitFile.getOriginalRelativePath(this._item, this._options.relativePath);\n\t\treturn this._padOrTruncate(originalPath, this._options.tokenOptions.originalPath);\n\t}\n\n\tget path() {\n\t\tconst directory = GitFile.getRelativePath(this._item, this._options.relativePath);\n\t\treturn this._padOrTruncate(directory, this._options.tokenOptions.path);\n\t}\n\n\tget status() {\n\t\tconst status = GitFile.getStatusText(this._item.status);\n\t\treturn this._padOrTruncate(status, this._options.tokenOptions.status);\n\t}\n\n\tget working() {\n\t\tconst statusFile = (this._item as GitFileWithCommit).commit?.files?.[0] ?? this._item;\n\n\t\tlet icon;\n\t\tif (statusFile.workingTreeStatus !== undefined && statusFile.indexStatus !== undefined) {\n\t\t\ticon = `${GlyphChars.Pencil}${GlyphChars.Space}${GlyphChars.SpaceThinnest}${GlyphChars.Check}`;\n\t\t} else if (statusFile.workingTreeStatus !== undefined) {\n\t\t\ticon = `${GlyphChars.Pencil}${GlyphChars.SpaceThin}${GlyphChars.SpaceThinnest}${GlyphChars.EnDash}${GlyphChars.Space}`;\n\t\t} else if (statusFile.indexStatus !== undefined) {\n\t\t\ticon = `${GlyphChars.Space}${GlyphChars.EnDash}${GlyphChars.Space.repeat(2)}${GlyphChars.Check}`;\n\t\t} else {\n\t\t\ticon = '';\n\t\t}\n\t\treturn this._padOrTruncate(icon, this._options.tokenOptions.working);\n\t}\n\n\tstatic fromTemplate(template: string, file: GitFile | GitFileWithCommit, dateFormat: string | null): string;\n\tstatic fromTemplate(template: string, file: GitFile | GitFileWithCommit, options?: StatusFormatOptions): string;\n\tstatic fromTemplate(\n\t\ttemplate: string,\n\t\tfile: GitFile,\n\t\tdateFormatOrOptions?: string | null | StatusFormatOptions,\n\t): string;\n\tstatic fromTemplate(\n\t\ttemplate: string,\n\t\tfile: GitFile,\n\t\tdateFormatOrOptions?: string | null | StatusFormatOptions,\n\t): string {\n\t\treturn super.fromTemplateCore(this, template, file, dateFormatOrOptions);\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport {\n\tDisposable,\n\tEvent,\n\tEventEmitter,\n\tFileChangeEvent,\n\tFileStat,\n\tFileSystemError,\n\tFileSystemProvider,\n\tFileType,\n\tUri,\n\tworkspace,\n} from 'vscode';\nimport { DocumentSchemes } from '../constants';\nimport { Container } from '../container';\nimport { GitRevision, GitTree } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { debug, Iterables, Strings, TernarySearchTree } from '../system';\n\nconst emptyArray = new Uint8Array(0);\n\nexport function fromGitLensFSUri(uri: Uri): { path: string; ref: string; repoPath: string } {\n\tconst gitUri = GitUri.is(uri) ? uri : GitUri.fromRevisionUri(uri);\n\treturn { path: gitUri.relativePath, ref: gitUri.sha!, repoPath: gitUri.repoPath! };\n}\n\nexport function toGitLensFSUri(ref: string, repoPath: string): Uri {\n\treturn GitUri.toRevisionUri(ref, repoPath, repoPath);\n}\n\nexport class GitFileSystemProvider implements FileSystemProvider, Disposable {\n\tprivate readonly _disposable: Disposable;\n\tprivate readonly _searchTreeMap = new Map<string, Promise<TernarySearchTree<string, GitTree>>>();\n\n\tconstructor() {\n\t\tthis._disposable = Disposable.from(\n\t\t\tworkspace.registerFileSystemProvider(DocumentSchemes.GitLens, this, {\n\t\t\t\tisCaseSensitive: true,\n\t\t\t\tisReadonly: true,\n\t\t\t}),\n\t\t);\n\t}\n\n\tdispose() {\n\t\tthis._disposable.dispose();\n\t}\n\n\tprivate _onDidChangeFile = new EventEmitter<FileChangeEvent[]>();\n\tget onDidChangeFile(): Event<FileChangeEvent[]> {\n\t\treturn this._onDidChangeFile.event;\n\t}\n\n\tcopy?(): void | Thenable<void> {\n\t\tthrow FileSystemError.NoPermissions;\n\t}\n\tcreateDirectory(): void | Thenable<void> {\n\t\tthrow FileSystemError.NoPermissions;\n\t}\n\tdelete(): void | Thenable<void> {\n\t\tthrow FileSystemError.NoPermissions;\n\t}\n\n\t@debug()\n\tasync readDirectory(uri: Uri): Promise<[string, FileType][]> {\n\t\tconst { path, ref, repoPath } = fromGitLensFSUri(uri);\n\n\t\tconst tree = await this.getTree(path, ref, repoPath);\n\t\tif (tree === undefined) throw FileSystemError.FileNotFound(uri);\n\n\t\tconst items = [\n\t\t\t...Iterables.map<GitTree, [string, FileType]>(tree, t => [\n\t\t\t\tpath != null && path.length !== 0 ? Strings.normalizePath(paths.relative(path, t.path)) : t.path,\n\t\t\t\ttypeToFileType(t.type),\n\t\t\t]),\n\t\t];\n\t\treturn items;\n\t}\n\n\t@debug()\n\tasync readFile(uri: Uri): Promise<Uint8Array> {\n\t\tconst { path, ref, repoPath } = fromGitLensFSUri(uri);\n\n\t\tif (ref === GitRevision.deletedOrMissing) return emptyArray;\n\n\t\tconst buffer = await Container.git.getVersionedFileBuffer(repoPath, path, ref);\n\t\tif (buffer === undefined) return emptyArray;\n\n\t\treturn buffer;\n\t}\n\n\trename(): void | Thenable<void> {\n\t\tthrow FileSystemError.NoPermissions;\n\t}\n\n\t@debug()\n\tasync stat(uri: Uri): Promise<FileStat> {\n\t\tconst { path, ref, repoPath } = fromGitLensFSUri(uri);\n\n\t\tif (ref === GitRevision.deletedOrMissing) {\n\t\t\treturn {\n\t\t\t\ttype: FileType.File,\n\t\t\t\tsize: 0,\n\t\t\t\tctime: 0,\n\t\t\t\tmtime: 0,\n\t\t\t};\n\t\t}\n\n\t\tlet treeItem;\n\n\t\tconst searchTree = this._searchTreeMap.get(ref);\n\t\tif (searchTree !== undefined) {\n\t\t\t// Add the fake root folder to the path\n\t\t\ttreeItem = (await searchTree).get(`/~/${path}`);\n\t\t} else {\n\t\t\tif (path == null || path.length === 0) {\n\t\t\t\tconst tree = await this.getTree(path, ref, repoPath);\n\t\t\t\tif (tree === undefined) throw FileSystemError.FileNotFound(uri);\n\n\t\t\t\treturn {\n\t\t\t\t\ttype: FileType.Directory,\n\t\t\t\t\tsize: 0,\n\t\t\t\t\tctime: 0,\n\t\t\t\t\tmtime: 0,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\ttreeItem = await Container.git.getTreeFileForRevision(repoPath, path, ref);\n\t\t}\n\n\t\tif (treeItem === undefined) {\n\t\t\tthrow FileSystemError.FileNotFound(uri);\n\t\t}\n\n\t\treturn {\n\t\t\ttype: typeToFileType(treeItem.type),\n\t\t\tsize: treeItem.size,\n\t\t\tctime: 0,\n\t\t\tmtime: 0,\n\t\t};\n\t}\n\n\twatch(): Disposable {\n\t\treturn {\n\t\t\tdispose: () => {\n\t\t\t\t// nothing to dispose\n\t\t\t},\n\t\t};\n\t}\n\n\twriteFile(): void | Thenable<void> {\n\t\tthrow FileSystemError.NoPermissions;\n\t}\n\n\tprivate async createSearchTree(ref: string, repoPath: string) {\n\t\tconst searchTree = TernarySearchTree.forPaths<GitTree>();\n\t\tconst trees = await Container.git.getTreeForRevision(repoPath, ref);\n\n\t\t// Add a fake root folder so that searches will work\n\t\tsearchTree.set('~', { commitSha: '', path: '~', size: 0, type: 'tree' });\n\t\tfor (const item of trees) {\n\t\t\tsearchTree.set(`~/${item.path}`, item);\n\t\t}\n\n\t\treturn searchTree;\n\t}\n\n\tprivate getOrCreateSearchTree(ref: string, repoPath: string) {\n\t\tlet searchTree = this._searchTreeMap.get(ref);\n\t\tif (searchTree === undefined) {\n\t\t\tsearchTree = this.createSearchTree(ref, repoPath);\n\t\t\tthis._searchTreeMap.set(ref, searchTree);\n\t\t}\n\n\t\treturn searchTree;\n\t}\n\n\tprivate async getTree(path: string, ref: string, repoPath: string) {\n\t\tconst searchTree = await this.getOrCreateSearchTree(ref, repoPath);\n\t\t// Add the fake root folder to the path\n\t\treturn searchTree.findSuperstr(`/~/${path}`, true);\n\t}\n}\n\nfunction typeToFileType(type: 'blob' | 'tree' | undefined | null) {\n\tswitch (type) {\n\t\tcase 'blob':\n\t\t\treturn FileType.File;\n\t\tcase 'tree':\n\t\t\treturn FileType.Directory;\n\t\tdefault:\n\t\t\treturn FileType.Unknown;\n\t}\n}\n","/* eslint-disable @typescript-eslint/naming-convention */\n'use strict';\nimport * as paths from 'path';\nimport { TextDecoder } from 'util';\nimport * as iconv from 'iconv-lite';\nimport { Uri, window, workspace } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { Strings } from '../system';\nimport { findGitPath, GitLocation } from './locator';\nimport { GitRevision } from './models/models';\nimport { GitBranchParser, GitLogParser, GitReflogParser, GitStashParser, GitTagParser } from './parsers/parsers';\nimport { fsExists, run, RunError, RunOptions } from './shell';\n\nexport * from './models/models';\nexport * from './parsers/parsers';\nexport * from './formatters/formatters';\nexport * from './remotes/provider';\nexport * from './search';\nexport { RunError } from './shell';\n\nexport type GitDiffFilter = 'A' | 'C' | 'D' | 'M' | 'R' | 'T' | 'U' | 'X' | 'B' | '*';\n\nconst emptyArray = Object.freeze([]) as unknown as any[];\nconst emptyObj = Object.freeze({});\nconst emptyStr = '';\nexport const maxGitCliLength = 30000;\nconst slash = '/';\n\nconst textDecoder = new TextDecoder('utf8');\n\n// This is a root sha of all git repo's if using sha1\nconst rootSha = '4b825dc642cb6eb9a060e54bf8d69288fbee4904';\n\nexport const GitErrors = {\n\tbadRevision: /bad revision '(.*?)'/i,\n\tnoFastForward: /\\(non-fast-forward\\)/i,\n\tnoMergeBase: /no merge base/i,\n\tnotAValidObjectName: /Not a valid object name/i,\n\tinvalidLineCount: /file .+? has only \\d+ lines/i,\n};\n\nconst GitWarnings = {\n\tnotARepository: /Not a git repository/i,\n\toutsideRepository: /is outside repository/i,\n\tnoPath: /no such path/i,\n\tnoCommits: /does not have any commits/i,\n\tnotFound: /Path '.*?' does not exist in/i,\n\tfoundButNotInRevision: /Path '.*?' exists on disk, but not in/i,\n\theadNotABranch: /HEAD does not point to a branch/i,\n\tnoUpstream: /no upstream configured for branch '(.*?)'/i,\n\tunknownRevision:\n\t\t/ambiguous argument '.*?': unknown revision or path not in the working tree|not stored as a remote-tracking branch/i,\n\tmustRunInWorkTree: /this operation must be run in a work tree/i,\n\tpatchWithConflicts: /Applied patch to '.*?' with conflicts/i,\n\tnoRemoteRepositorySpecified: /No remote repository specified\\./i,\n\tremoteConnectionError: /Could not read from remote repository/i,\n\tnotAGitCommand: /'.+' is not a git command/i,\n};\n\nexport enum GitErrorHandling {\n\tIgnore = 'ignore',\n\tThrow = 'throw',\n}\n\nexport interface GitCommandOptions extends RunOptions<BufferEncoding | 'buffer' | string> {\n\tconfigs?: string[];\n\treadonly correlationKey?: string;\n\terrors?: GitErrorHandling;\n\t// Specifies that this command should always be executed locally if possible\n\tlocal?: boolean;\n}\n\n// A map of running git commands -- avoids running duplicate overlaping commands\nconst pendingCommands = new Map<string, Promise<string | Buffer>>();\n\nexport async function git<TOut extends string | Buffer>(options: GitCommandOptions, ...args: any[]): Promise<TOut> {\n\tif (Container.vsls.isMaybeGuest) {\n\t\tif (options.local !== true) {\n\t\t\tconst guest = await Container.vsls.guest();\n\t\t\tif (guest !== undefined) {\n\t\t\t\treturn guest.git<TOut>(options, ...args);\n\t\t\t}\n\t\t} else {\n\t\t\t// Since we will have a live share path here, just blank it out\n\t\t\toptions.cwd = emptyStr;\n\t\t}\n\t}\n\n\tconst start = process.hrtime();\n\n\tconst { configs, correlationKey, errors: errorHandling, encoding, ...opts } = options;\n\n\tconst runOpts: RunOptions = {\n\t\t...opts,\n\t\tencoding: (encoding ?? 'utf8') === 'utf8' ? 'utf8' : 'buffer',\n\t\t// Adds GCM environment variables to avoid any possible credential issues -- from https://github.com/Microsoft/vscode/issues/26573#issuecomment-338686581\n\t\t// Shouldn't *really* be needed but better safe than sorry\n\t\tenv: {\n\t\t\t...process.env,\n\t\t\t...(options.env ?? emptyObj),\n\t\t\tGCM_INTERACTIVE: 'NEVER',\n\t\t\tGCM_PRESERVE_CREDS: 'TRUE',\n\t\t\tLC_ALL: 'C',\n\t\t},\n\t};\n\n\tconst gitCommand = `[${runOpts.cwd}] git ${args.join(' ')}`;\n\n\tconst command = `${correlationKey !== undefined ? `${correlationKey}:` : emptyStr}${gitCommand}`;\n\n\tlet waiting;\n\tlet promise = pendingCommands.get(command);\n\tif (promise === undefined) {\n\t\twaiting = false;\n\n\t\t// Fixes https://github.com/eamodio/vscode-gitlens/issues/73 & https://github.com/eamodio/vscode-gitlens/issues/161\n\t\t// See https://stackoverflow.com/questions/4144417/how-to-handle-asian-characters-in-file-names-in-git-on-os-x\n\t\targs.splice(\n\t\t\t0,\n\t\t\t0,\n\t\t\t'-c',\n\t\t\t'core.quotepath=false',\n\t\t\t'-c',\n\t\t\t'color.ui=false',\n\t\t\t...(configs !== undefined ? configs : emptyArray),\n\t\t);\n\n\t\tif (process.platform === 'win32') {\n\t\t\targs.splice(0, 0, '-c', 'core.longpaths=true');\n\t\t}\n\n\t\tpromise = run<TOut>(gitInfo.path, args, encoding ?? 'utf8', runOpts);\n\n\t\tpendingCommands.set(command, promise);\n\t} else {\n\t\twaiting = true;\n\t\tLogger.debug(`${gitCommand} ${GlyphChars.Dot} waiting...`);\n\t}\n\n\tlet exception: Error | undefined;\n\ttry {\n\t\treturn (await promise) as TOut;\n\t} catch (ex) {\n\t\texception = ex;\n\n\t\tswitch (errorHandling) {\n\t\t\tcase GitErrorHandling.Ignore:\n\t\t\t\texception = undefined;\n\t\t\t\treturn emptyStr as TOut;\n\n\t\t\tcase GitErrorHandling.Throw:\n\t\t\t\tthrow ex;\n\n\t\t\tdefault: {\n\t\t\t\tconst result = defaultExceptionHandler(ex, options.cwd, start);\n\t\t\t\texception = undefined;\n\t\t\t\treturn result as TOut;\n\t\t\t}\n\t\t}\n\t} finally {\n\t\tpendingCommands.delete(command);\n\n\t\tconst duration = `${Strings.getDurationMilliseconds(start)} ms ${waiting ? '(waited) ' : emptyStr}`;\n\t\tif (exception !== undefined) {\n\t\t\tLogger.warn(\n\t\t\t\t`[${runOpts.cwd}] Git ${(exception.message || exception.toString() || emptyStr)\n\t\t\t\t\t.trim()\n\t\t\t\t\t.replace(/fatal: /g, '')\n\t\t\t\t\t.replace(/\\r?\\n|\\r/g, ` ${GlyphChars.Dot} `)} ${GlyphChars.Dot} ${duration}`,\n\t\t\t);\n\t\t} else {\n\t\t\tLogger.log(`${gitCommand} ${GlyphChars.Dot} ${duration}`);\n\t\t}\n\t\tLogger.logGitCommand(\n\t\t\t`${gitCommand} ${GlyphChars.Dot} ${exception !== undefined ? 'FAILED ' : emptyStr}${duration}`,\n\t\t\texception,\n\t\t);\n\t}\n}\n\nfunction defaultExceptionHandler(ex: Error, cwd: string | undefined, start?: [number, number]): string {\n\tconst msg = ex.message || ex.toString();\n\tif (msg != null && msg.length !== 0) {\n\t\tfor (const warning of Object.values(GitWarnings)) {\n\t\t\tif (warning.test(msg)) {\n\t\t\t\tconst duration = start !== undefined ? `${Strings.getDurationMilliseconds(start)} ms` : emptyStr;\n\t\t\t\tLogger.warn(\n\t\t\t\t\t`[${cwd}] Git ${msg\n\t\t\t\t\t\t.trim()\n\t\t\t\t\t\t.replace(/fatal: /g, '')\n\t\t\t\t\t\t.replace(/\\r?\\n|\\r/g, ` ${GlyphChars.Dot} `)} ${GlyphChars.Dot} ${duration}`,\n\t\t\t\t);\n\t\t\t\treturn emptyStr;\n\t\t\t}\n\t\t}\n\n\t\tconst match = GitErrors.badRevision.exec(msg);\n\t\tif (match != null) {\n\t\t\tconst [, ref] = match;\n\n\t\t\t// Since looking up a ref with ^3 (e.g. looking for untracked files in a stash) can error on some versions of git just ignore it\n\t\t\tif (ref?.endsWith('^3')) return emptyStr;\n\t\t}\n\t}\n\n\tthrow ex;\n}\n\nlet gitInfo: GitLocation;\n\nexport namespace Git {\n\texport function getEncoding(encoding: string | undefined) {\n\t\treturn encoding !== undefined && iconv.encodingExists(encoding) ? encoding : 'utf8';\n\t}\n\n\texport function getGitPath(): string {\n\t\treturn gitInfo.path;\n\t}\n\n\texport function getGitVersion(): string {\n\t\treturn gitInfo.version;\n\t}\n\n\texport async function setOrFindGitPath(gitPath?: string | string[]): Promise<void> {\n\t\tconst start = process.hrtime();\n\n\t\tgitInfo = await findGitPath(gitPath);\n\n\t\tLogger.log(\n\t\t\t`Git found: ${gitInfo.version} @ ${gitInfo.path === 'git' ? 'PATH' : gitInfo.path} ${\n\t\t\t\tGlyphChars.Dot\n\t\t\t} ${Strings.getDurationMilliseconds(start)} ms`,\n\t\t);\n\t}\n\n\texport function splitPath(\n\t\tfileName: string,\n\t\trepoPath: string | undefined,\n\t\textract: boolean = true,\n\t): [string, string] {\n\t\tif (repoPath) {\n\t\t\tfileName = Strings.normalizePath(fileName);\n\t\t\trepoPath = Strings.normalizePath(repoPath);\n\n\t\t\tconst normalizedRepoPath = (repoPath.endsWith(slash) ? repoPath : `${repoPath}/`).toLowerCase();\n\t\t\tif (fileName.toLowerCase().startsWith(normalizedRepoPath)) {\n\t\t\t\tfileName = fileName.substring(normalizedRepoPath.length);\n\t\t\t}\n\t\t} else {\n\t\t\trepoPath = Strings.normalizePath(extract ? paths.dirname(fileName) : repoPath!);\n\t\t\tfileName = Strings.normalizePath(extract ? paths.basename(fileName) : fileName);\n\t\t}\n\n\t\treturn [fileName, repoPath];\n\t}\n\n\texport function validateVersion(major: number, minor: number): boolean {\n\t\tconst [gitMajor, gitMinor] = gitInfo.version.split('.');\n\t\treturn parseInt(gitMajor, 10) >= major && parseInt(gitMinor, 10) >= minor;\n\t}\n\n\t// Git commands\n\n\texport function add(repoPath: string | undefined, pathspec: string) {\n\t\treturn git<string>({ cwd: repoPath }, 'add', '-A', '--', pathspec);\n\t}\n\n\texport function apply(repoPath: string | undefined, patch: string, options: { allowConflicts?: boolean } = {}) {\n\t\tconst params = ['apply', '--whitespace=warn'];\n\t\tif (options.allowConflicts) {\n\t\t\tparams.push('-3');\n\t\t}\n\t\treturn git<string>({ cwd: repoPath, stdin: patch }, ...params);\n\t}\n\n\tconst ignoreRevsFileMap = new Map<string, boolean>();\n\n\texport async function blame(\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\tref?: string,\n\t\toptions: { args?: string[] | null; ignoreWhitespace?: boolean; startLine?: number; endLine?: number } = {},\n\t) {\n\t\tconst [file, root] = Git.splitPath(fileName, repoPath);\n\n\t\tconst params = ['blame', '--root', '--incremental'];\n\n\t\tif (options.ignoreWhitespace) {\n\t\t\tparams.push('-w');\n\t\t}\n\t\tif (options.startLine != null && options.endLine != null) {\n\t\t\tparams.push(`-L ${options.startLine},${options.endLine}`);\n\t\t}\n\t\tif (options.args != null) {\n\t\t\tparams.push(...options.args);\n\n\t\t\tconst index = params.indexOf('--ignore-revs-file');\n\t\t\tif (index !== -1) {\n\t\t\t\t// Ensure the version of Git supports the --ignore-revs-file flag, otherwise the blame will fail\n\t\t\t\tlet supported = Git.validateVersion(2, 23);\n\t\t\t\tif (supported) {\n\t\t\t\t\tlet ignoreRevsFile = params[index + 1];\n\t\t\t\t\tif (!paths.isAbsolute(ignoreRevsFile)) {\n\t\t\t\t\t\tignoreRevsFile = paths.join(repoPath ?? emptyStr, ignoreRevsFile);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst exists = ignoreRevsFileMap.get(ignoreRevsFile);\n\t\t\t\t\tif (exists !== undefined) {\n\t\t\t\t\t\tsupported = exists;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Ensure the specified --ignore-revs-file exists, otherwise the blame will fail\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tsupported = await fsExists(ignoreRevsFile);\n\t\t\t\t\t\t} catch {\n\t\t\t\t\t\t\tsupported = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tignoreRevsFileMap.set(ignoreRevsFile, supported);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!supported) {\n\t\t\t\t\tparams.splice(index, 2);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet stdin;\n\t\tif (ref) {\n\t\t\tif (GitRevision.isUncommittedStaged(ref)) {\n\t\t\t\t// Pipe the blame contents to stdin\n\t\t\t\tparams.push('--contents', '-');\n\n\t\t\t\t// Get the file contents for the staged version using `:`\n\t\t\t\tstdin = await Git.show<string>(repoPath, fileName, ':');\n\t\t\t} else {\n\t\t\t\tparams.push(ref);\n\t\t\t}\n\t\t}\n\n\t\treturn git<string>({ cwd: root, stdin: stdin }, ...params, '--', file);\n\t}\n\n\texport function blame__contents(\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\tcontents: string,\n\t\toptions: {\n\t\t\targs?: string[] | null;\n\t\t\tcorrelationKey?: string;\n\t\t\tignoreWhitespace?: boolean;\n\t\t\tstartLine?: number;\n\t\t\tendLine?: number;\n\t\t} = {},\n\t) {\n\t\tconst [file, root] = Git.splitPath(fileName, repoPath);\n\n\t\tconst params = ['blame', '--root', '--incremental'];\n\n\t\tif (options.ignoreWhitespace) {\n\t\t\tparams.push('-w');\n\t\t}\n\t\tif (options.startLine != null && options.endLine != null) {\n\t\t\tparams.push(`-L ${options.startLine},${options.endLine}`);\n\t\t}\n\t\tif (options.args != null) {\n\t\t\tparams.push(...options.args);\n\t\t}\n\n\t\t// Pipe the blame contents to stdin\n\t\tparams.push('--contents', '-');\n\n\t\treturn git<string>(\n\t\t\t{ cwd: root, stdin: contents, correlationKey: options.correlationKey },\n\t\t\t...params,\n\t\t\t'--',\n\t\t\tfile,\n\t\t);\n\t}\n\n\texport function branch__containsOrPointsAt(\n\t\trepoPath: string,\n\t\tref: string,\n\t\t{\n\t\t\tmode = 'contains',\n\t\t\tname = undefined,\n\t\t\tremotes = false,\n\t\t}: { mode?: 'contains' | 'pointsAt'; name?: string; remotes?: boolean } = {},\n\t) {\n\t\tconst params = ['branch'];\n\t\tif (remotes) {\n\t\t\tparams.push('-r');\n\t\t}\n\t\tparams.push(mode === 'pointsAt' ? `--points-at=${ref}` : `--contains=${ref}`, '--format=%(refname:short)');\n\t\tif (name != null) {\n\t\t\tparams.push(name);\n\t\t}\n\n\t\treturn git<string>(\n\t\t\t{ cwd: repoPath, configs: ['-c', 'color.branch=false'], errors: GitErrorHandling.Ignore },\n\t\t\t...params,\n\t\t);\n\t}\n\n\texport function check_ignore(repoPath: string, ...files: string[]) {\n\t\treturn git<string>(\n\t\t\t{ cwd: repoPath, errors: GitErrorHandling.Ignore, stdin: files.join('\\0') },\n\t\t\t'check-ignore',\n\t\t\t'-z',\n\t\t\t'--stdin',\n\t\t);\n\t}\n\n\texport function check_mailmap(repoPath: string, author: string) {\n\t\treturn git<string>({ cwd: repoPath, errors: GitErrorHandling.Ignore, local: true }, 'check-mailmap', author);\n\t}\n\n\texport async function check_ref_format(\n\t\tref: string,\n\t\trepoPath?: string,\n\t\toptions: { branch?: boolean } = { branch: true },\n\t) {\n\t\tconst params = ['check-ref-format'];\n\t\tif (options.branch) {\n\t\t\tparams.push('--branch');\n\t\t} else {\n\t\t\tparams.push('--normalize');\n\t\t}\n\n\t\ttry {\n\t\t\tconst data = await git<string>(\n\t\t\t\t{ cwd: repoPath ?? emptyStr, errors: GitErrorHandling.Throw, local: true },\n\t\t\t\t...params,\n\t\t\t\tref,\n\t\t\t);\n\t\t\treturn Boolean(data.trim());\n\t\t} catch {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\texport function checkout(\n\t\trepoPath: string,\n\t\tref: string,\n\t\t{ createBranch, fileName }: { createBranch?: string; fileName?: string } = {},\n\t) {\n\t\tconst params = ['checkout'];\n\t\tif (createBranch) {\n\t\t\tparams.push('-b', createBranch, ref, '--');\n\t\t} else {\n\t\t\tparams.push(ref, '--');\n\n\t\t\tif (fileName) {\n\t\t\t\t[fileName, repoPath] = Git.splitPath(fileName, repoPath);\n\n\t\t\t\tparams.push(fileName);\n\t\t\t}\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath }, ...params);\n\t}\n\n\texport async function config__get(key: string, repoPath?: string, options: { local?: boolean } = {}) {\n\t\tconst data = await git<string>(\n\t\t\t{ cwd: repoPath ?? emptyStr, errors: GitErrorHandling.Ignore, local: options.local },\n\t\t\t'config',\n\t\t\t'--get',\n\t\t\tkey,\n\t\t);\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\texport async function config__get_regex(pattern: string, repoPath?: string, options: { local?: boolean } = {}) {\n\t\tconst data = await git<string>(\n\t\t\t{ cwd: repoPath ?? emptyStr, errors: GitErrorHandling.Ignore, local: options.local },\n\t\t\t'config',\n\t\t\t'--get-regex',\n\t\t\tpattern,\n\t\t);\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\texport async function diff(\n\t\trepoPath: string,\n\t\tfileName: string,\n\t\tref1?: string,\n\t\tref2?: string,\n\t\toptions: {\n\t\t\tencoding?: string;\n\t\t\tfilters?: GitDiffFilter[];\n\t\t\tlinesOfContext?: number;\n\t\t\trenames?: boolean;\n\t\t\tsimilarityThreshold?: number | null;\n\t\t} = {},\n\t): Promise<string> {\n\t\tconst params = ['diff', '--no-ext-diff', '--minimal'];\n\n\t\tif (options.linesOfContext != null) {\n\t\t\tparams.push(`-U${options.linesOfContext}`);\n\t\t}\n\n\t\tif (options.renames) {\n\t\t\tparams.push(`-M${options.similarityThreshold == null ? '' : `${options.similarityThreshold}%`}`);\n\t\t}\n\n\t\tif (options.filters != null && options.filters.length !== 0) {\n\t\t\tparams.push(`--diff-filter=${options.filters.join(emptyStr)}`);\n\t\t}\n\n\t\tif (ref1) {\n\t\t\t// <sha>^3 signals an untracked file in a stash and if we are trying to find its parent, use the root sha\n\t\t\tif (ref1.endsWith('^3^')) {\n\t\t\t\tref1 = rootSha;\n\t\t\t}\n\t\t\tparams.push(GitRevision.isUncommittedStaged(ref1) ? '--staged' : ref1);\n\t\t}\n\t\tif (ref2) {\n\t\t\tparams.push(GitRevision.isUncommittedStaged(ref2) ? '--staged' : ref2);\n\t\t}\n\n\t\ttry {\n\t\t\treturn await git<string>(\n\t\t\t\t{\n\t\t\t\t\tcwd: repoPath,\n\t\t\t\t\tconfigs: ['-c', 'color.diff=false'],\n\t\t\t\t\tencoding: options.encoding,\n\t\t\t\t},\n\t\t\t\t...params,\n\t\t\t\t'--',\n\t\t\t\tfileName,\n\t\t\t);\n\t\t} catch (ex) {\n\t\t\tconst match = GitErrors.badRevision.exec(ex.message);\n\t\t\tif (match !== null) {\n\t\t\t\tconst [, ref] = match;\n\n\t\t\t\t// If the bad ref is trying to find a parent ref, assume we hit to the last commit, so try again using the root sha\n\t\t\t\tif (ref === ref1 && ref != null && ref.endsWith('^')) {\n\t\t\t\t\treturn Git.diff(repoPath, fileName, rootSha, ref2, options);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthrow ex;\n\t\t}\n\t}\n\n\texport async function diff__contents(\n\t\trepoPath: string,\n\t\tfileName: string,\n\t\tref: string,\n\t\tcontents: string,\n\t\toptions: { encoding?: string; filters?: GitDiffFilter[]; similarityThreshold?: number | null } = {},\n\t): Promise<string> {\n\t\tconst params = [\n\t\t\t'diff',\n\t\t\t`-M${options.similarityThreshold == null ? '' : `${options.similarityThreshold}%`}`,\n\t\t\t'--no-ext-diff',\n\t\t\t'-U0',\n\t\t\t'--minimal',\n\t\t];\n\n\t\tif (options.filters != null && options.filters.length !== 0) {\n\t\t\tparams.push(`--diff-filter=${options.filters.join(emptyStr)}`);\n\t\t}\n\n\t\t// // <sha>^3 signals an untracked file in a stash and if we are trying to find its parent, use the root sha\n\t\t// if (ref.endsWith('^3^')) {\n\t\t// \tref = rootSha;\n\t\t// }\n\t\t// params.push(GitRevision.isUncommittedStaged(ref) ? '--staged' : ref);\n\n\t\tparams.push('--no-index');\n\n\t\ttry {\n\t\t\treturn await git<string>(\n\t\t\t\t{\n\t\t\t\t\tcwd: repoPath,\n\t\t\t\t\tconfigs: ['-c', 'color.diff=false'],\n\t\t\t\t\tencoding: options.encoding,\n\t\t\t\t\tstdin: contents,\n\t\t\t\t},\n\t\t\t\t...params,\n\t\t\t\t'--',\n\t\t\t\tfileName,\n\t\t\t\t// Pipe the contents to stdin\n\t\t\t\t'-',\n\t\t\t);\n\t\t} catch (ex) {\n\t\t\tif (ex instanceof RunError && ex.stdout) {\n\t\t\t\treturn ex.stdout;\n\t\t\t}\n\n\t\t\tconst match = GitErrors.badRevision.exec(ex.message);\n\t\t\tif (match !== null) {\n\t\t\t\tconst [, matchedRef] = match;\n\n\t\t\t\t// If the bad ref is trying to find a parent ref, assume we hit to the last commit, so try again using the root sha\n\t\t\t\tif (matchedRef === ref && matchedRef != null && matchedRef.endsWith('^')) {\n\t\t\t\t\treturn Git.diff__contents(repoPath, fileName, rootSha, contents, options);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthrow ex;\n\t\t}\n\t}\n\n\texport function diff__name_status(\n\t\trepoPath: string,\n\t\tref1?: string,\n\t\tref2?: string,\n\t\t{ filters, similarityThreshold }: { filters?: GitDiffFilter[]; similarityThreshold?: number | null } = {},\n\t) {\n\t\tconst params = [\n\t\t\t'diff',\n\t\t\t'--name-status',\n\t\t\t`-M${similarityThreshold == null ? '' : `${similarityThreshold}%`}`,\n\t\t\t'--no-ext-diff',\n\t\t];\n\t\tif (filters != null && filters.length !== 0) {\n\t\t\tparams.push(`--diff-filter=${filters.join(emptyStr)}`);\n\t\t}\n\t\tif (ref1) {\n\t\t\tparams.push(ref1);\n\t\t}\n\t\tif (ref2) {\n\t\t\tparams.push(ref2);\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath, configs: ['-c', 'color.diff=false'] }, ...params, '--');\n\t}\n\n\texport async function diff__shortstat(repoPath: string, ref?: string) {\n\t\tconst params = ['diff', '--shortstat', '--no-ext-diff'];\n\t\tif (ref) {\n\t\t\tparams.push(ref);\n\t\t}\n\n\t\ttry {\n\t\t\treturn await git<string>({ cwd: repoPath, configs: ['-c', 'color.diff=false'] }, ...params, '--');\n\t\t} catch (ex) {\n\t\t\tconst msg: string = ex?.toString() ?? '';\n\t\t\tif (GitErrors.noMergeBase.test(msg)) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tthrow ex;\n\t\t}\n\t}\n\n\texport function difftool(\n\t\trepoPath: string,\n\t\tfileName: string,\n\t\ttool: string,\n\t\toptions: { ref1?: string; ref2?: string; staged?: boolean } = {},\n\t) {\n\t\tconst params = ['difftool', '--no-prompt', `--tool=${tool}`];\n\t\tif (options.staged) {\n\t\t\tparams.push('--staged');\n\t\t}\n\t\tif (options.ref1) {\n\t\t\tparams.push(options.ref1);\n\t\t}\n\t\tif (options.ref2) {\n\t\t\tparams.push(options.ref2);\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath }, ...params, '--', fileName);\n\t}\n\n\texport function difftool__dir_diff(repoPath: string, tool: string, ref1: string, ref2?: string) {\n\t\tconst params = ['difftool', '--dir-diff', `--tool=${tool}`, ref1];\n\t\tif (ref2) {\n\t\t\tparams.push(ref2);\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath }, ...params);\n\t}\n\n\texport async function fetch(\n\t\trepoPath: string,\n\t\toptions:\n\t\t\t| { all?: boolean; branch?: undefined; prune?: boolean; remote?: string }\n\t\t\t| {\n\t\t\t\t\tall?: undefined;\n\t\t\t\t\tbranch: string;\n\t\t\t\t\tprune?: undefined;\n\t\t\t\t\tpull?: boolean;\n\t\t\t\t\tremote: string;\n\t\t\t\t\tupstream: string;\n\t\t\t  } = {},\n\t): Promise<void> {\n\t\tconst params = ['fetch'];\n\n\t\tif (options.prune) {\n\t\t\tparams.push('--prune');\n\t\t}\n\n\t\tif (options.branch && options.remote) {\n\t\t\tif (options.upstream && options.pull) {\n\t\t\t\tparams.push('-u', options.remote, `${options.upstream}:${options.branch}`);\n\n\t\t\t\ttry {\n\t\t\t\t\tvoid (await git<string>({ cwd: repoPath }, ...params));\n\t\t\t\t\treturn;\n\t\t\t\t} catch (ex) {\n\t\t\t\t\tconst msg: string = ex?.toString() ?? '';\n\t\t\t\t\tif (GitErrors.noFastForward.test(msg)) {\n\t\t\t\t\t\tvoid window.showErrorMessage(\n\t\t\t\t\t\t\t`Unable to pull the '${options.branch}' branch, as it can't be fast-forwarded.`,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthrow ex;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tparams.push(options.remote, options.branch);\n\t\t\t}\n\t\t} else if (options.remote) {\n\t\t\tparams.push(options.remote);\n\t\t} else if (options.all) {\n\t\t\tparams.push('--all');\n\t\t}\n\n\t\tvoid (await git<string>({ cwd: repoPath }, ...params));\n\t}\n\n\texport function for_each_ref__branch(repoPath: string, options: { all: boolean } = { all: false }) {\n\t\tconst params = ['for-each-ref', `--format=${GitBranchParser.defaultFormat}`, 'refs/heads'];\n\t\tif (options.all) {\n\t\t\tparams.push('refs/remotes');\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath }, ...params);\n\t}\n\n\texport function log(\n\t\trepoPath: string,\n\t\tref: string | undefined,\n\t\t{\n\t\t\tall,\n\t\t\tauthors,\n\t\t\tformat = 'default',\n\t\t\tlimit,\n\t\t\tmerges,\n\t\t\tordering,\n\t\t\treverse,\n\t\t\tsimilarityThreshold,\n\t\t\tsince,\n\t\t}: {\n\t\t\tall?: boolean;\n\t\t\tauthors?: string[];\n\t\t\tformat?: 'default' | 'refs' | 'shortlog' | 'shortlog+stats';\n\t\t\tlimit?: number;\n\t\t\tmerges?: boolean;\n\t\t\tordering?: string | null;\n\t\t\treverse?: boolean;\n\t\t\tsimilarityThreshold?: number | null;\n\t\t\tsince?: string;\n\t\t},\n\t) {\n\t\tconst params = [\n\t\t\t'log',\n\t\t\t`--format=${\n\t\t\t\tformat === 'refs'\n\t\t\t\t\t? GitLogParser.simpleRefs\n\t\t\t\t\t: format === 'shortlog' || format === 'shortlog+stats'\n\t\t\t\t\t? GitLogParser.shortlog\n\t\t\t\t\t: GitLogParser.defaultFormat\n\t\t\t}`,\n\t\t\t'--full-history',\n\t\t\t`-M${similarityThreshold == null ? '' : `${similarityThreshold}%`}`,\n\t\t\t'-m',\n\t\t];\n\n\t\tif (format === 'default') {\n\t\t\tparams.push('--name-status');\n\t\t} else if (format === 'shortlog+stats') {\n\t\t\tparams.push('--shortstat');\n\t\t}\n\n\t\tif (ordering) {\n\t\t\tparams.push(`--${ordering}-order`);\n\t\t}\n\n\t\tif (limit && !reverse) {\n\t\t\tparams.push(`-n${limit + 1}`);\n\t\t}\n\n\t\tif (since) {\n\t\t\tparams.push(`--since=\"${since}\"`);\n\t\t}\n\n\t\tif (!merges) {\n\t\t\tparams.push('--first-parent');\n\t\t}\n\n\t\tif (authors != null && authors.length !== 0) {\n\t\t\tparams.push('--use-mailmap', ...authors.map(a => `--author=${a}`));\n\t\t} else if (format === 'shortlog') {\n\t\t\tparams.push('--use-mailmap');\n\t\t}\n\n\t\tif (all) {\n\t\t\tparams.push('--all');\n\t\t}\n\n\t\tif (ref && !GitRevision.isUncommittedStaged(ref)) {\n\t\t\t// If we are reversing, we must add a range (with HEAD) because we are using --ancestry-path for better reverse walking\n\t\t\tif (reverse) {\n\t\t\t\tparams.push('--reverse', '--ancestry-path', `${ref}..HEAD`);\n\t\t\t} else {\n\t\t\t\tparams.push(ref);\n\t\t\t}\n\t\t}\n\n\t\treturn git<string>(\n\t\t\t{ cwd: repoPath, configs: ['-c', 'diff.renameLimit=0', '-c', 'log.showSignature=false'] },\n\t\t\t...params,\n\t\t\t'--',\n\t\t);\n\t}\n\n\texport function log__file(\n\t\trepoPath: string,\n\t\tfileName: string,\n\t\tref: string | undefined,\n\t\t{\n\t\t\tall,\n\t\t\tfilters,\n\t\t\tfirstParent = false,\n\t\t\tformat = 'default',\n\t\t\tlimit,\n\t\t\tordering,\n\t\t\trenames = true,\n\t\t\treverse = false,\n\t\t\tsince,\n\t\t\tskip,\n\t\t\tstartLine,\n\t\t\tendLine,\n\t\t}: {\n\t\t\tall?: boolean;\n\t\t\tfilters?: GitDiffFilter[];\n\t\t\tfirstParent?: boolean;\n\t\t\tformat?: 'default' | 'refs' | 'simple';\n\t\t\tlimit?: number;\n\t\t\tordering?: string | null;\n\t\t\trenames?: boolean;\n\t\t\treverse?: boolean;\n\t\t\tsince?: string;\n\t\t\tskip?: number;\n\t\t\tstartLine?: number;\n\t\t\tendLine?: number;\n\t\t} = {},\n\t) {\n\t\tconst [file, root] = Git.splitPath(fileName, repoPath);\n\n\t\tconst params = [\n\t\t\t'log',\n\t\t\t`--format=${format === 'default' ? GitLogParser.defaultFormat : GitLogParser.simpleFormat}`,\n\t\t];\n\n\t\tif (ordering) {\n\t\t\tparams.push(`--${ordering}-order`);\n\t\t}\n\n\t\tif (limit && !reverse) {\n\t\t\tparams.push(`-n${limit + 1}`);\n\t\t}\n\n\t\tif (skip) {\n\t\t\tparams.push(`--skip=${skip}`);\n\t\t}\n\n\t\tif (since) {\n\t\t\tparams.push(`--since=\"${since}\"`);\n\t\t}\n\n\t\tif (all) {\n\t\t\tparams.push('--all');\n\t\t}\n\n\t\t// Can't allow rename detection (`--follow`) if `all` or a `startLine` is specified\n\t\tif (renames && (all || startLine != null)) {\n\t\t\trenames = false;\n\t\t}\n\n\t\tparams.push(renames ? '--follow' : '-m');\n\t\tif (/*renames ||*/ firstParent) {\n\t\t\tparams.push('--first-parent');\n\t\t\t// In Git >= 2.29.0 `--first-parent` implies `-m`, so lets include it for consistency\n\t\t\tif (renames) {\n\t\t\t\tparams.push('-m');\n\t\t\t}\n\t\t}\n\n\t\tif (filters != null && filters.length !== 0) {\n\t\t\tparams.push(`--diff-filter=${filters.join(emptyStr)}`);\n\t\t}\n\n\t\tif (format !== 'refs') {\n\t\t\tif (startLine == null) {\n\t\t\t\t// If this is the log of a folder, use `--name-status` to match non-file logs (for parsing)\n\t\t\t\tif (format === 'simple' || isFolderGlob(file)) {\n\t\t\t\t\tparams.push('--name-status');\n\t\t\t\t} else {\n\t\t\t\t\tparams.push('--numstat', '--summary');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Don't include `--name-status`, `--numstat`, or `--summary` because they aren't supported with `-L`\n\t\t\t\tparams.push(`-L ${startLine},${endLine == null ? startLine : endLine}:${file}`);\n\t\t\t}\n\t\t}\n\n\t\tif (ref && !GitRevision.isUncommittedStaged(ref)) {\n\t\t\t// If we are reversing, we must add a range (with HEAD) because we are using --ancestry-path for better reverse walking\n\t\t\tif (reverse) {\n\t\t\t\tparams.push('--reverse', '--ancestry-path', `${ref}..HEAD`);\n\t\t\t} else {\n\t\t\t\tparams.push(ref);\n\t\t\t}\n\t\t}\n\n\t\t// Don't specify a file spec when using a line number (so say the git docs)\n\t\tif (startLine == null) {\n\t\t\tparams.push('--', file);\n\t\t}\n\n\t\treturn git<string>({ cwd: root, configs: ['-c', 'log.showSignature=false'] }, ...params);\n\t}\n\n\texport async function log__file_recent(\n\t\trepoPath: string,\n\t\tfileName: string,\n\t\t{\n\t\t\tordering,\n\t\t\tref,\n\t\t\tsimilarityThreshold,\n\t\t}: { ordering?: string | null; ref?: string; similarityThreshold?: number | null } = {},\n\t) {\n\t\tconst params = [\n\t\t\t'log',\n\t\t\t`-M${similarityThreshold == null ? '' : `${similarityThreshold}%`}`,\n\t\t\t'-n1',\n\t\t\t'--format=%H',\n\t\t];\n\n\t\tif (ordering) {\n\t\t\tparams.push(`--${ordering}-order`);\n\t\t}\n\n\t\tif (ref) {\n\t\t\tparams.push(ref);\n\t\t}\n\n\t\tconst data = await git<string>(\n\t\t\t{ cwd: repoPath, configs: ['-c', 'log.showSignature=false'], errors: GitErrorHandling.Ignore },\n\t\t\t...params,\n\t\t\t'--',\n\t\t\tfileName,\n\t\t);\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\texport async function log__find_object(\n\t\trepoPath: string,\n\t\tobjectId: string,\n\t\tref: string,\n\t\tordering: string | null,\n\t\tfile?: string,\n\t) {\n\t\tconst params = ['log', '-n1', '--no-renames', '--format=%H', `--find-object=${objectId}`, ref];\n\n\t\tif (ordering) {\n\t\t\tparams.push(`--${ordering}-order`);\n\t\t}\n\n\t\tif (file) {\n\t\t\tparams.push('--', file);\n\t\t}\n\n\t\tconst data = await git<string>(\n\t\t\t{ cwd: repoPath, configs: ['-c', 'log.showSignature=false'], errors: GitErrorHandling.Ignore },\n\t\t\t...params,\n\t\t);\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\texport async function log__recent(repoPath: string, ordering?: string | null) {\n\t\tconst params = ['log', '-n1', '--format=%H'];\n\n\t\tif (ordering) {\n\t\t\tparams.push(`--${ordering}-order`);\n\t\t}\n\n\t\tconst data = await git<string>(\n\t\t\t{ cwd: repoPath, configs: ['-c', 'log.showSignature=false'], errors: GitErrorHandling.Ignore },\n\t\t\t...params,\n\t\t\t'--',\n\t\t);\n\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\texport async function log__recent_committerdate(repoPath: string, ordering?: string | null) {\n\t\tconst params = ['log', '-n1', '--format=%ct'];\n\n\t\tif (ordering) {\n\t\t\tparams.push(`--${ordering}-order`);\n\t\t}\n\n\t\tconst data = await git<string>(\n\t\t\t{ cwd: repoPath, configs: ['-c', 'log.showSignature=false'], errors: GitErrorHandling.Ignore },\n\t\t\t...params,\n\t\t\t'--',\n\t\t);\n\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\texport function log__search(\n\t\trepoPath: string,\n\t\tsearch: string[] = emptyArray,\n\t\t{\n\t\t\tlimit,\n\t\t\tordering,\n\t\t\tskip,\n\t\t\tuseShow,\n\t\t}: { limit?: number; ordering?: string | null; skip?: number; useShow?: boolean } = {},\n\t) {\n\t\tconst params = [\n\t\t\tuseShow ? 'show' : 'log',\n\t\t\t'--name-status',\n\t\t\t`--format=${GitLogParser.defaultFormat}`,\n\t\t\t'--use-mailmap',\n\t\t];\n\n\t\tif (limit && !useShow) {\n\t\t\tparams.push(`-n${limit + 1}`);\n\t\t}\n\n\t\tif (skip && !useShow) {\n\t\t\tparams.push(`--skip=${skip}`);\n\t\t}\n\n\t\tif (ordering && !useShow) {\n\t\t\tparams.push(`--${ordering}-order`);\n\t\t}\n\n\t\treturn git<string>(\n\t\t\t{ cwd: repoPath, configs: useShow ? undefined : ['-c', 'log.showSignature=false'] },\n\t\t\t...params,\n\t\t\t...search,\n\t\t);\n\t}\n\n\t// export function log__shortstat(repoPath: string, options: { ref?: string }) {\n\t//     const params = ['log', '--shortstat', '--oneline'];\n\t//     if (options.ref && !GitRevision.isUncommittedStaged(options.ref)) {\n\t//         params.push(options.ref);\n\t//     }\n\t//     return git<string>({ cwd: repoPath, configs: ['-c', 'log.showSignature=false'] }, ...params, '--');\n\t// }\n\n\texport async function ls_files(\n\t\trepoPath: string,\n\t\tfileName: string,\n\t\t{ ref, untracked }: { ref?: string; untracked?: boolean } = {},\n\t): Promise<string | undefined> {\n\t\tconst params = ['ls-files'];\n\t\tif (ref && !GitRevision.isUncommitted(ref)) {\n\t\t\tparams.push(`--with-tree=${ref}`);\n\t\t}\n\n\t\tif (!ref && untracked) {\n\t\t\tparams.push('-o');\n\t\t}\n\n\t\tconst data = await git<string>({ cwd: repoPath, errors: GitErrorHandling.Ignore }, ...params, '--', fileName);\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\texport function ls_remote(repoPath: string, remote: string, ref?: string) {\n\t\treturn git<string>({ cwd: repoPath }, 'ls-remote', remote, ref);\n\t}\n\n\texport function ls_remote__HEAD(repoPath: string, remote: string) {\n\t\treturn git<string>({ cwd: repoPath }, 'ls-remote', '--symref', remote, 'HEAD');\n\t}\n\n\texport async function ls_tree(repoPath: string, ref: string, { fileName }: { fileName?: string } = {}) {\n\t\tconst params = ['ls-tree'];\n\t\tif (fileName) {\n\t\t\tparams.push('-l', ref, '--', fileName);\n\t\t} else {\n\t\t\tparams.push('-lrt', ref, '--');\n\t\t}\n\t\tconst data = await git<string>({ cwd: repoPath, errors: GitErrorHandling.Ignore }, ...params);\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\texport function merge_base(\n\t\trepoPath: string,\n\t\tref1: string,\n\t\tref2: string,\n\t\t{ forkPoint }: { forkPoint?: boolean } = {},\n\t) {\n\t\tconst params = ['merge-base'];\n\t\tif (forkPoint) {\n\t\t\tparams.push('--fork-point');\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath }, ...params, ref1, ref2);\n\t}\n\n\texport function reflog(\n\t\trepoPath: string,\n\t\t{\n\t\t\tall,\n\t\t\tbranch,\n\t\t\tlimit,\n\t\t\tordering,\n\t\t\tskip,\n\t\t}: { all?: boolean; branch?: string; limit?: number; ordering?: string | null; skip?: number } = {},\n\t): Promise<string> {\n\t\tconst params = ['log', '--walk-reflogs', `--format=${GitReflogParser.defaultFormat}`, '--date=iso8601'];\n\n\t\tif (ordering) {\n\t\t\tparams.push(`--${ordering}-order`);\n\t\t}\n\n\t\tif (all) {\n\t\t\tparams.push('--all');\n\t\t}\n\n\t\tif (limit) {\n\t\t\tparams.push(`-n${limit}`);\n\t\t}\n\n\t\tif (skip) {\n\t\t\tparams.push(`--skip=${skip}`);\n\t\t}\n\n\t\tif (branch) {\n\t\t\tparams.push(branch);\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath, configs: ['-c', 'log.showSignature=false'] }, ...params, '--');\n\t}\n\n\texport function remote(repoPath: string): Promise<string> {\n\t\treturn git<string>({ cwd: repoPath }, 'remote', '-v');\n\t}\n\n\texport function remote__add(repoPath: string, name: string, url: string) {\n\t\treturn git<string>({ cwd: repoPath }, 'remote', 'add', name, url);\n\t}\n\n\texport function remote__prune(repoPath: string, remoteName: string) {\n\t\treturn git<string>({ cwd: repoPath }, 'remote', 'prune', remoteName);\n\t}\n\n\texport function remote__get_url(repoPath: string, remote: string): Promise<string> {\n\t\treturn git<string>({ cwd: repoPath }, 'remote', 'get-url', remote);\n\t}\n\n\texport function reset(repoPath: string | undefined, fileName: string) {\n\t\treturn git<string>({ cwd: repoPath }, 'reset', '-q', '--', fileName);\n\t}\n\n\texport async function rev_list__count(repoPath: string, ref: string): Promise<number | undefined> {\n\t\tlet data = await git<string>(\n\t\t\t{ cwd: repoPath, errors: GitErrorHandling.Ignore },\n\t\t\t'rev-list',\n\t\t\t'--count',\n\t\t\tref,\n\t\t\t'--',\n\t\t);\n\t\tdata = data.trim();\n\t\tif (data.length === 0) return undefined;\n\n\t\tconst result = parseInt(data, 10);\n\t\treturn isNaN(result) ? undefined : result;\n\t}\n\n\texport async function rev_list__left_right(\n\t\trepoPath: string,\n\t\trefs: string[],\n\t): Promise<{ ahead: number; behind: number } | undefined> {\n\t\tconst data = await git<string>(\n\t\t\t{ cwd: repoPath, errors: GitErrorHandling.Ignore },\n\t\t\t'rev-list',\n\t\t\t'--left-right',\n\t\t\t'--count',\n\t\t\t...refs,\n\t\t\t'--',\n\t\t);\n\t\tif (data.length === 0) return undefined;\n\n\t\tconst parts = data.split('\\t');\n\t\tif (parts.length !== 2) return undefined;\n\n\t\tconst [ahead, behind] = parts;\n\t\tconst result = {\n\t\t\tahead: parseInt(ahead, 10),\n\t\t\tbehind: parseInt(behind, 10),\n\t\t};\n\n\t\tif (isNaN(result.ahead) || isNaN(result.behind)) return undefined;\n\n\t\treturn result;\n\t}\n\n\texport async function rev_parse__currentBranch(\n\t\trepoPath: string,\n\t\tordering: string | null,\n\t): Promise<[string, string | undefined] | undefined> {\n\t\ttry {\n\t\t\tconst data = await git<string>(\n\t\t\t\t{ cwd: repoPath, errors: GitErrorHandling.Throw },\n\t\t\t\t'rev-parse',\n\t\t\t\t'--abbrev-ref',\n\t\t\t\t'--symbolic-full-name',\n\t\t\t\t'@',\n\t\t\t\t'@{u}',\n\t\t\t\t'--',\n\t\t\t);\n\t\t\treturn [data, undefined];\n\t\t} catch (ex) {\n\t\t\tconst msg: string = ex?.toString() ?? '';\n\t\t\tif (GitErrors.badRevision.test(msg) || GitWarnings.noUpstream.test(msg)) {\n\t\t\t\tif (ex.stdout != null && ex.stdout.length !== 0) {\n\t\t\t\t\treturn [ex.stdout, undefined];\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tconst data = await symbolic_ref(repoPath, 'HEAD');\n\t\t\t\t\tif (data != null) return [data.trim(), undefined];\n\t\t\t\t} catch {}\n\n\t\t\t\ttry {\n\t\t\t\t\tconst data = await symbolic_ref(repoPath, 'refs/remotes/origin/HEAD');\n\t\t\t\t\tif (data != null) return [data.trim().substr('origin/'.length), undefined];\n\t\t\t\t} catch (ex) {\n\t\t\t\t\tif (/is not a symbolic ref/.test(ex.stderr)) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst data = await ls_remote__HEAD(repoPath, 'origin');\n\t\t\t\t\t\t\tif (data != null) {\n\t\t\t\t\t\t\t\tconst match = /ref:\\s(\\S+)\\s+HEAD/m.exec(data);\n\t\t\t\t\t\t\t\tif (match != null) {\n\t\t\t\t\t\t\t\t\tconst [, branch] = match;\n\t\t\t\t\t\t\t\t\treturn [branch.substr('refs/heads/'.length), undefined];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch {}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst defaultBranch = (await config__get('init.defaultBranch', repoPath, { local: true })) ?? 'main';\n\t\t\t\tconst branchConfig = await config__get_regex(`branch\\\\.${defaultBranch}\\\\.+`, repoPath, {\n\t\t\t\t\tlocal: true,\n\t\t\t\t});\n\n\t\t\t\tlet remote;\n\t\t\t\tlet remoteBranch;\n\n\t\t\t\tif (branchConfig) {\n\t\t\t\t\tlet match = /^branch\\..+\\.remote\\s(.+)$/m.exec(branchConfig);\n\t\t\t\t\tif (match != null) {\n\t\t\t\t\t\tremote = match[1];\n\t\t\t\t\t}\n\n\t\t\t\t\tmatch = /^branch\\..+\\.merge\\srefs\\/heads\\/(.+)$/m.exec(branchConfig);\n\t\t\t\t\tif (match != null) {\n\t\t\t\t\t\tremoteBranch = match[1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn [`${defaultBranch}${remote && remoteBranch ? `\\n${remote}/${remoteBranch}` : ''}`, undefined];\n\t\t\t}\n\n\t\t\tif (GitWarnings.headNotABranch.test(msg)) {\n\t\t\t\tconst sha = await log__recent(repoPath, ordering);\n\t\t\t\tif (sha === undefined) return undefined;\n\n\t\t\t\treturn [`(HEAD detached at ${GitRevision.shorten(sha)})`, sha];\n\t\t\t}\n\n\t\t\tdefaultExceptionHandler(ex, repoPath);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\texport async function rev_parse__show_toplevel(cwd: string): Promise<string | undefined> {\n\t\ttry {\n\t\t\tconst data = await git<string>(\n\t\t\t\t{ cwd: cwd, errors: GitErrorHandling.Throw },\n\t\t\t\t'rev-parse',\n\t\t\t\t'--show-toplevel',\n\t\t\t);\n\t\t\t// Make sure to normalize: https://github.com/git-for-windows/git/issues/2478\n\t\t\t// Keep trailing spaces which are part of the directory name\n\t\t\treturn data.length === 0 ? undefined : Strings.normalizePath(data.trimLeft().replace(/[\\r|\\n]+$/, ''));\n\t\t} catch (ex) {\n\t\t\tconst inDotGit = /this operation must be run in a work tree/.test(ex.stderr);\n\t\t\tif (inDotGit || ex.code === 'ENOENT') {\n\t\t\t\t// If the `cwd` doesn't exist, walk backward to see if any parent folder exists\n\t\t\t\tlet exists = inDotGit ? false : await fsExists(cwd);\n\t\t\t\tif (!exists) {\n\t\t\t\t\tdo {\n\t\t\t\t\t\tconst parent = paths.dirname(cwd);\n\t\t\t\t\t\tif (parent === cwd || parent.length === 0) return undefined;\n\n\t\t\t\t\t\tcwd = parent;\n\t\t\t\t\t\texists = await fsExists(cwd);\n\t\t\t\t\t} while (!exists);\n\n\t\t\t\t\treturn rev_parse__show_toplevel(cwd);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\texport async function rev_parse__verify(\n\t\trepoPath: string,\n\t\tref: string,\n\t\tfilename?: string,\n\t): Promise<string | undefined> {\n\t\tconst data = await git<string>(\n\t\t\t{ cwd: repoPath, errors: GitErrorHandling.Ignore },\n\t\t\t'rev-parse',\n\t\t\t'--verify',\n\t\t\tfilename ? `${ref}:./${filename}` : `${ref}^{commit}`,\n\t\t);\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\texport function shortlog(repoPath: string) {\n\t\treturn git<string>({ cwd: repoPath }, 'shortlog', '-sne', '--all', '--no-merges', 'HEAD');\n\t}\n\n\texport async function show<TOut extends string | Buffer>(\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\tref: string,\n\t\toptions: {\n\t\t\tencoding?: 'binary' | 'ascii' | 'utf8' | 'utf16le' | 'ucs2' | 'base64' | 'latin1' | 'hex' | 'buffer';\n\t\t} = {},\n\t): Promise<TOut | undefined> {\n\t\tconst [file, root] = Git.splitPath(fileName, repoPath);\n\n\t\tif (GitRevision.isUncommittedStaged(ref)) {\n\t\t\tref = ':';\n\t\t}\n\t\tif (GitRevision.isUncommitted(ref)) throw new Error(`ref=${ref} is uncommitted`);\n\n\t\tconst opts: GitCommandOptions = {\n\t\t\tconfigs: ['-c', 'log.showSignature=false'],\n\t\t\tcwd: root,\n\t\t\tencoding: options.encoding ?? 'utf8',\n\t\t\terrors: GitErrorHandling.Throw,\n\t\t};\n\t\tconst args = ref.endsWith(':') ? `${ref}./${file}` : `${ref}:./${file}`;\n\n\t\ttry {\n\t\t\tconst data = await git<TOut>(opts, 'show', '--textconv', args, '--');\n\t\t\treturn data;\n\t\t} catch (ex) {\n\t\t\tconst msg: string = ex?.toString() ?? '';\n\t\t\tif (ref === ':' && GitErrors.badRevision.test(msg)) {\n\t\t\t\treturn Git.show<TOut>(repoPath, fileName, 'HEAD:', options);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tGitErrors.badRevision.test(msg) ||\n\t\t\t\tGitWarnings.notFound.test(msg) ||\n\t\t\t\tGitWarnings.foundButNotInRevision.test(msg)\n\t\t\t) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn defaultExceptionHandler(ex, opts.cwd) as TOut;\n\t\t}\n\t}\n\n\texport function show__diff(\n\t\trepoPath: string,\n\t\tfileName: string,\n\t\tref: string,\n\t\toriginalFileName?: string,\n\t\t{ similarityThreshold }: { similarityThreshold?: number | null } = {},\n\t) {\n\t\tconst params = [\n\t\t\t'show',\n\t\t\t`-M${similarityThreshold == null ? '' : `${similarityThreshold}%`}`,\n\t\t\t'--format=',\n\t\t\t'--minimal',\n\t\t\t'-U0',\n\t\t\tref,\n\t\t\t'--',\n\t\t\tfileName,\n\t\t];\n\t\tif (originalFileName != null && originalFileName.length !== 0) {\n\t\t\tparams.push(originalFileName);\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath }, ...params);\n\t}\n\n\texport function show__name_status(repoPath: string, fileName: string, ref: string) {\n\t\treturn git<string>({ cwd: repoPath }, 'show', '--name-status', '--format=', ref, '--', fileName);\n\t}\n\n\texport function show_ref__tags(repoPath: string) {\n\t\treturn git<string>({ cwd: repoPath, errors: GitErrorHandling.Ignore }, 'show-ref', '--tags');\n\t}\n\n\texport function stash__apply(repoPath: string, stashName: string, deleteAfter: boolean) {\n\t\tif (!stashName) return undefined;\n\t\treturn git<string>({ cwd: repoPath }, 'stash', deleteAfter ? 'pop' : 'apply', stashName);\n\t}\n\n\texport async function stash__delete(repoPath: string, stashName: string, ref?: string) {\n\t\tif (!stashName) return undefined;\n\n\t\tif (ref) {\n\t\t\tconst stashRef = await git<string>(\n\t\t\t\t{ cwd: repoPath, errors: GitErrorHandling.Ignore },\n\t\t\t\t'show',\n\t\t\t\t'--format=%H',\n\t\t\t\t'--no-patch',\n\t\t\t\tstashName,\n\t\t\t);\n\t\t\tif (stashRef?.trim() !== ref) {\n\t\t\t\tthrow new Error('Unable to delete stash; mismatch with stash number');\n\t\t\t}\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath }, 'stash', 'drop', stashName);\n\t}\n\n\texport function stash__list(\n\t\trepoPath: string,\n\t\t{\n\t\t\tformat = GitStashParser.defaultFormat,\n\t\t\tsimilarityThreshold,\n\t\t}: { format?: string; similarityThreshold?: number | null } = {},\n\t) {\n\t\treturn git<string>(\n\t\t\t{ cwd: repoPath },\n\t\t\t'stash',\n\t\t\t'list',\n\t\t\t'--name-status',\n\t\t\t`-M${similarityThreshold == null ? '' : `${similarityThreshold}%`}`,\n\t\t\t`--format=${format}`,\n\t\t);\n\t}\n\n\texport async function stash__push(\n\t\trepoPath: string,\n\t\tmessage?: string,\n\t\t{\n\t\t\tincludeUntracked,\n\t\t\tkeepIndex,\n\t\t\tpathspecs,\n\t\t\tstdin,\n\t\t}: { includeUntracked?: boolean; keepIndex?: boolean; pathspecs?: string[]; stdin?: boolean } = {},\n\t): Promise<void> {\n\t\tconst params = ['stash', 'push'];\n\n\t\tif (includeUntracked || (pathspecs != null && pathspecs.length !== 0)) {\n\t\t\tparams.push('-u');\n\t\t}\n\n\t\tif (keepIndex) {\n\t\t\tparams.push('-k');\n\t\t}\n\n\t\tif (message) {\n\t\t\tparams.push('-m', message);\n\t\t}\n\n\t\tif (stdin && pathspecs != null && pathspecs.length !== 0) {\n\t\t\tvoid (await git<string>(\n\t\t\t\t{ cwd: repoPath, stdin: pathspecs.join('\\0') },\n\t\t\t\t...params,\n\t\t\t\t'--pathspec-from-file=-',\n\t\t\t\t'--pathspec-file-nul',\n\t\t\t));\n\n\t\t\treturn;\n\t\t}\n\n\t\tparams.push('--');\n\t\tif (pathspecs != null && pathspecs.length !== 0) {\n\t\t\tparams.push(...pathspecs);\n\t\t}\n\n\t\tvoid (await git<string>({ cwd: repoPath }, ...params));\n\t}\n\n\texport function status(\n\t\trepoPath: string,\n\t\tporcelainVersion: number = 1,\n\t\t{ similarityThreshold }: { similarityThreshold?: number | null } = {},\n\t): Promise<string> {\n\t\tconst params = [\n\t\t\t'status',\n\t\t\tporcelainVersion >= 2 ? `--porcelain=v${porcelainVersion}` : '--porcelain',\n\t\t\t'--branch',\n\t\t\t'-u',\n\t\t];\n\t\tif (Git.validateVersion(2, 18)) {\n\t\t\tparams.push(`--find-renames${similarityThreshold == null ? '' : `=${similarityThreshold}%`}`);\n\t\t}\n\n\t\treturn git<string>(\n\t\t\t{ cwd: repoPath, configs: ['-c', 'color.status=false'], env: { GIT_OPTIONAL_LOCKS: '0' } },\n\t\t\t...params,\n\t\t\t'--',\n\t\t);\n\t}\n\n\texport function status__file(\n\t\trepoPath: string,\n\t\tfileName: string,\n\t\tporcelainVersion: number = 1,\n\t\t{ similarityThreshold }: { similarityThreshold?: number | null } = {},\n\t): Promise<string> {\n\t\tconst [file, root] = Git.splitPath(fileName, repoPath);\n\n\t\tconst params = ['status', porcelainVersion >= 2 ? `--porcelain=v${porcelainVersion}` : '--porcelain'];\n\t\tif (Git.validateVersion(2, 18)) {\n\t\t\tparams.push(`--find-renames${similarityThreshold == null ? '' : `=${similarityThreshold}%`}`);\n\t\t}\n\n\t\treturn git<string>(\n\t\t\t{ cwd: root, configs: ['-c', 'color.status=false'], env: { GIT_OPTIONAL_LOCKS: '0' } },\n\t\t\t...params,\n\t\t\t'--',\n\t\t\tfile,\n\t\t);\n\t}\n\n\texport function symbolic_ref(repoPath: string, ref: string) {\n\t\treturn git<string>({ cwd: repoPath }, 'symbolic-ref', '--short', ref);\n\t}\n\n\texport function tag(repoPath: string) {\n\t\treturn git<string>({ cwd: repoPath }, 'tag', '-l', `--format=${GitTagParser.defaultFormat}`);\n\t}\n\n\texport async function readDotGitFile(\n\t\trepoPath: string,\n\t\tpaths: string[],\n\t\toptions?: { numeric?: false; throw?: boolean; trim?: boolean },\n\t): Promise<string | undefined>;\n\texport async function readDotGitFile(\n\t\trepoPath: string,\n\t\tpath: string[],\n\t\toptions?: { numeric: true; throw?: boolean; trim?: boolean },\n\t): Promise<number | undefined>;\n\texport async function readDotGitFile(\n\t\trepoPath: string,\n\t\tpathParts: string[],\n\t\toptions?: { numeric?: boolean; throw?: boolean; trim?: boolean },\n\t): Promise<string | number | undefined> {\n\t\ttry {\n\t\t\tconst bytes = await workspace.fs.readFile(Uri.file(paths.join(...[repoPath, '.git', ...pathParts])));\n\t\t\tlet contents = textDecoder.decode(bytes);\n\t\t\tcontents = options?.trim ?? true ? contents.trim() : contents;\n\n\t\t\tif (options?.numeric) {\n\t\t\t\tconst number = Number.parseInt(contents, 10);\n\t\t\t\treturn isNaN(number) ? undefined : number;\n\t\t\t}\n\n\t\t\treturn contents;\n\t\t} catch (ex) {\n\t\t\tif (options?.throw) throw ex;\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n}\n\nexport function isFolderGlob(path: string) {\n\treturn paths.basename(path) === '*';\n}\n\nexport function toFolderGlob(fsPath: string) {\n\treturn paths.join(fsPath, '*');\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"os\");","'use strict';\nimport * as fs from 'fs';\nimport * as os from 'os';\nimport * as paths from 'path';\nimport {\n\tConfigurationChangeEvent,\n\tDisposable,\n\tenv,\n\tEvent,\n\tEventEmitter,\n\textensions,\n\tProgressLocation,\n\tRange,\n\tTextEditor,\n\tUri,\n\twindow,\n\tWindowState,\n\tworkspace,\n\tWorkspaceFolder,\n\tWorkspaceFoldersChangeEvent,\n} from 'vscode';\nimport { API as BuiltInGitApi, Repository as BuiltInGitRepository, GitExtension } from '../@types/git';\nimport { resetAvatarCache } from '../avatars';\nimport { configuration } from '../configuration';\nimport { BuiltInGitConfiguration, ContextKeys, DocumentSchemes, GlyphChars, setContext } from '../constants';\nimport { Container } from '../container';\nimport { setEnabled } from '../extension';\nimport { LogCorrelationContext, Logger } from '../logger';\nimport { Messages } from '../messages';\nimport {\n\tArrays,\n\tdebug,\n\tFunctions,\n\tgate,\n\tIterables,\n\tlog,\n\tPromises,\n\tStrings,\n\tTernarySearchTree,\n\tVersions,\n} from '../system';\nimport { CachedBlame, CachedDiff, CachedLog, GitDocumentState, TrackedDocument } from '../trackers/gitDocumentTracker';\nimport { vslsUriPrefixRegex } from '../vsls/vsls';\nimport {\n\tAuthentication,\n\tBranchDateFormatting,\n\tBranchSortOptions,\n\tCommitDateFormatting,\n\tGit,\n\tGitAuthor,\n\tGitBlame,\n\tGitBlameCommit,\n\tGitBlameLine,\n\tGitBlameLines,\n\tGitBlameParser,\n\tGitBranch,\n\tGitBranchParser,\n\tGitBranchReference,\n\tGitCommitType,\n\tGitContributor,\n\tGitDiff,\n\tGitDiffFilter,\n\tGitDiffHunkLine,\n\tGitDiffParser,\n\tGitDiffShortStat,\n\tGitErrors,\n\tGitFile,\n\tGitLog,\n\tGitLogCommit,\n\tGitLogParser,\n\tGitMergeStatus,\n\tGitRebaseStatus,\n\tGitReference,\n\tGitReflog,\n\tGitRemote,\n\tGitRemoteParser,\n\tGitRevision,\n\tGitStash,\n\tGitStashParser,\n\tGitStatus,\n\tGitStatusFile,\n\tGitStatusParser,\n\tGitTag,\n\tGitTagParser,\n\tGitTree,\n\tGitTreeParser,\n\tGitUser,\n\tisFolderGlob,\n\tmaxGitCliLength,\n\tPullRequest,\n\tPullRequestDateFormatting,\n\tPullRequestState,\n\tRepository,\n\tRepositoryChange,\n\tRepositoryChangeComparisonMode,\n\tRepositoryChangeEvent,\n\tSearchPattern,\n\tTagSortOptions,\n} from './git';\nimport { GitUri } from './gitUri';\nimport { GitReflogParser, GitShortLogParser } from './parsers/parsers';\nimport { RemoteProvider, RemoteProviderFactory, RemoteProviders, RichRemoteProvider } from './remotes/factory';\nimport { fsExists, isWindows } from './shell';\n\nconst emptyStr = '';\nconst slash = '/';\n\nconst RepoSearchWarnings = {\n\tdoesNotExist: /no such file or directory/i,\n};\n\nconst doubleQuoteRegex = /\"/g;\nconst driveLetterRegex = /(?<=^\\/?)([a-zA-Z])(?=:\\/)/;\nconst userConfigRegex = /^user\\.(name|email) (.*)$/gm;\nconst mappedAuthorRegex = /(.+)\\s<(.+)>/;\n\nconst emptyPromise: Promise<GitBlame | GitDiff | GitLog | undefined> = Promise.resolve(undefined);\nconst reflogCommands = ['merge', 'pull'];\n\nconst maxDefaultBranchWeight = 100;\nconst weightedDefaultBranches = new Map<string, number>([\n\t['master', maxDefaultBranchWeight],\n\t['main', 15],\n\t['default', 10],\n\t['develop', 5],\n\t['development', 1],\n]);\n\nexport class GitService implements Disposable {\n\tprivate _onDidChangeRepositories = new EventEmitter<void>();\n\tget onDidChangeRepositories(): Event<void> {\n\t\treturn this._onDidChangeRepositories.event;\n\t}\n\n\tprivate readonly _disposable: Disposable;\n\tprivate readonly _repositoryTree: TernarySearchTree<string, Repository>;\n\tprivate _repositoriesLoadingPromise: Promise<void> | undefined;\n\n\tprivate readonly _branchesCache = new Map<string, Promise<GitBranch[]>>();\n\tprivate readonly _contributorsCache = new Map<string, Promise<GitContributor[]>>();\n\tprivate readonly _mergeStatusCache = new Map<string, GitMergeStatus | null>();\n\tprivate readonly _rebaseStatusCache = new Map<string, GitRebaseStatus | null>();\n\tprivate readonly _remotesWithApiProviderCache = new Map<string, GitRemote<RichRemoteProvider> | null>();\n\tprivate readonly _stashesCache = new Map<string, GitStash | null>();\n\tprivate readonly _tagsCache = new Map<string, Promise<GitTag[]>>();\n\tprivate readonly _trackedCache = new Map<string, boolean | Promise<boolean>>();\n\tprivate readonly _userMapCache = new Map<string, GitUser | null>();\n\n\tconstructor() {\n\t\tthis._repositoryTree = TernarySearchTree.forPaths();\n\n\t\tthis._disposable = Disposable.from(\n\t\t\twindow.onDidChangeWindowState(this.onWindowStateChanged, this),\n\t\t\tworkspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged, this),\n\t\t\tconfiguration.onDidChange(this.onConfigurationChanged, this),\n\t\t\tAuthentication.onDidChange(e => {\n\t\t\t\tif (e.reason === 'connected') {\n\t\t\t\t\tresetAvatarCache('failed');\n\t\t\t\t}\n\t\t\t\tthis._remotesWithApiProviderCache.clear();\n\t\t\t\tvoid this.updateContext(this._repositoryTree);\n\t\t\t}),\n\t\t);\n\t\tthis.onConfigurationChanged();\n\n\t\tthis._repositoriesLoadingPromise = this.onWorkspaceFoldersChanged();\n\t}\n\n\tdispose() {\n\t\tthis._repositoryTree.forEach(r => r.dispose());\n\t\tvoid this.resetCaches();\n\t\tthis._disposable.dispose();\n\t}\n\n\t@log()\n\tstatic async initialize(): Promise<void> {\n\t\t// Try to use the same git as the built-in vscode git extension\n\t\tlet gitPath;\n\t\tconst gitApi = await GitService.getBuiltInGitApi();\n\t\tif (gitApi != null) {\n\t\t\tgitPath = gitApi.git.path;\n\t\t}\n\n\t\tawait Git.setOrFindGitPath(gitPath ?? configuration.getAny<string | string[]>('git.path'));\n\t}\n\n\tget readonly() {\n\t\treturn Container.vsls.readonly;\n\t}\n\n\tget useCaching() {\n\t\treturn Container.config.advanced.caching.enabled;\n\t}\n\n\tprivate onAnyRepositoryChanged(repo: Repository, e: RepositoryChangeEvent) {\n\t\tif (e.changed(RepositoryChange.Config, RepositoryChangeComparisonMode.Any)) {\n\t\t\tthis._userMapCache.delete(repo.path);\n\t\t}\n\n\t\tif (e.changed(RepositoryChange.Heads, RepositoryChange.Remotes, RepositoryChangeComparisonMode.Any)) {\n\t\t\tthis._branchesCache.delete(repo.path);\n\t\t\tthis._contributorsCache.delete(repo.path);\n\t\t\tthis._contributorsCache.delete(`stats|${repo.path}`);\n\t\t}\n\n\t\tif (e.changed(RepositoryChange.Remotes, RepositoryChange.RemoteProviders, RepositoryChangeComparisonMode.Any)) {\n\t\t\tthis._remotesWithApiProviderCache.clear();\n\t\t}\n\n\t\tif (e.changed(RepositoryChange.Index, RepositoryChange.Unknown, RepositoryChangeComparisonMode.Any)) {\n\t\t\tthis._trackedCache.clear();\n\t\t}\n\n\t\tif (e.changed(RepositoryChange.Merge, RepositoryChangeComparisonMode.Any)) {\n\t\t\tthis._mergeStatusCache.delete(repo.path);\n\t\t}\n\n\t\tif (e.changed(RepositoryChange.Rebase, RepositoryChangeComparisonMode.Any)) {\n\t\t\tthis._rebaseStatusCache.delete(repo.path);\n\t\t}\n\n\t\tif (e.changed(RepositoryChange.Stash, RepositoryChangeComparisonMode.Any)) {\n\t\t\tthis._stashesCache.delete(repo.path);\n\t\t}\n\n\t\tif (e.changed(RepositoryChange.Tags, RepositoryChangeComparisonMode.Any)) {\n\t\t\tthis._tagsCache.delete(repo.path);\n\t\t}\n\n\t\tif (e.changed(RepositoryChange.Closed, RepositoryChangeComparisonMode.Any)) {\n\t\t\t// Send a notification that the repositories changed\n\t\t\tsetImmediate(async () => {\n\t\t\t\tawait this.updateContext(this._repositoryTree);\n\n\t\t\t\tthis.fireRepositoriesChanged();\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate onConfigurationChanged(e?: ConfigurationChangeEvent) {\n\t\tif (\n\t\t\tconfiguration.changed(e, 'defaultDateFormat') ||\n\t\t\tconfiguration.changed(e, 'defaultDateSource') ||\n\t\t\tconfiguration.changed(e, 'defaultDateStyle')\n\t\t) {\n\t\t\tBranchDateFormatting.reset();\n\t\t\tCommitDateFormatting.reset();\n\t\t\tPullRequestDateFormatting.reset();\n\t\t}\n\n\t\tif (configuration.changed(e, 'views.contributors.showAllBranches')) {\n\t\t\tthis._contributorsCache.clear();\n\t\t}\n\t}\n\n\t@debug()\n\tprivate onWindowStateChanged(e: WindowState) {\n\t\tif (e.focused) {\n\t\t\tthis._repositoryTree.forEach(r => r.resume());\n\t\t} else {\n\t\t\tthis._repositoryTree.forEach(r => r.suspend());\n\t\t}\n\t}\n\n\tprivate async onWorkspaceFoldersChanged(e?: WorkspaceFoldersChangeEvent) {\n\t\tlet initializing = false;\n\t\tif (e == null) {\n\t\t\tinitializing = true;\n\t\t\te = {\n\t\t\t\tadded: workspace.workspaceFolders ?? [],\n\t\t\t\tremoved: [],\n\t\t\t};\n\n\t\t\tLogger.log(`Starting repository search in ${e.added.length} folders`);\n\t\t}\n\n\t\tconst autoRepositoryDetection =\n\t\t\tconfiguration.getAny<boolean | 'subFolders' | 'openEditors'>(\n\t\t\t\tBuiltInGitConfiguration.AutoRepositoryDetection,\n\t\t\t) ?? true;\n\t\tif (autoRepositoryDetection === false) return;\n\n\t\tfor (const f of e.added) {\n\t\t\tconst { scheme } = f.uri;\n\t\t\tif (scheme !== DocumentSchemes.File && scheme !== DocumentSchemes.Vsls) continue;\n\n\t\t\tif (scheme === DocumentSchemes.Vsls) {\n\t\t\t\tif (Container.vsls.isMaybeGuest) {\n\t\t\t\t\tconst guest = await Container.vsls.guest();\n\t\t\t\t\tif (guest != null) {\n\t\t\t\t\t\tconst repositories = await guest.getRepositoriesInFolder(\n\t\t\t\t\t\t\tf,\n\t\t\t\t\t\t\tthis.onAnyRepositoryChanged.bind(this),\n\t\t\t\t\t\t);\n\t\t\t\t\t\tfor (const r of repositories) {\n\t\t\t\t\t\t\tif (!this._repositoryTree.has(r.path)) {\n\t\t\t\t\t\t\t\tthis._repositoryTree.set(r.path, r);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Search for and add all repositories (nested and/or submodules)\n\t\t\t\tconst repositories = await this.repositorySearch(f);\n\t\t\t\tfor (const r of repositories) {\n\t\t\t\t\tif (!this._repositoryTree.has(r.path)) {\n\t\t\t\t\t\tthis._repositoryTree.set(r.path, r);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (autoRepositoryDetection === true || autoRepositoryDetection === 'subFolders') {\n\t\t\t\t\t\tvoid GitService.openBuiltInGitRepository(r.path);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (const f of e.removed) {\n\t\t\tconst { fsPath, scheme } = f.uri;\n\t\t\tif (scheme !== DocumentSchemes.File && scheme !== DocumentSchemes.Vsls) continue;\n\n\t\t\tconst repos = this._repositoryTree.findSuperstr(fsPath);\n\t\t\tconst reposToDelete =\n\t\t\t\trepos != null\n\t\t\t\t\t? // Since the filtered tree will have keys that are relative to the fsPath, normalize to the full path\n\t\t\t\t\t  [...Iterables.map<Repository, [Repository, string]>(repos, r => [r, r.path])]\n\t\t\t\t\t: [];\n\n\t\t\t// const filteredTree = this._repositoryTree.findSuperstr(fsPath);\n\t\t\t// const reposToDelete =\n\t\t\t//     filteredTree != null\n\t\t\t//         ? // Since the filtered tree will have keys that are relative to the fsPath, normalize to the full path\n\t\t\t//           [\n\t\t\t//               ...Iterables.map<[Repository, string], [Repository, string]>(\n\t\t\t//                   filteredTree.entries(),\n\t\t\t//                   ([r, k]) => [r, path.join(fsPath, k)]\n\t\t\t//               )\n\t\t\t//           ]\n\t\t\t//         : [];\n\n\t\t\tconst repo = this._repositoryTree.get(fsPath);\n\t\t\tif (repo != null) {\n\t\t\t\treposToDelete.push([repo, fsPath]);\n\t\t\t}\n\n\t\t\tfor (const [r, k] of reposToDelete) {\n\t\t\t\tthis._repositoryTree.delete(k);\n\t\t\t\tr.dispose();\n\t\t\t}\n\t\t}\n\n\t\tawait this.updateContext(this._repositoryTree);\n\n\t\tif (!initializing) {\n\t\t\t// Defer the event trigger enough to let everything unwind\n\t\t\tsetImmediate(() => this.fireRepositoriesChanged());\n\t\t}\n\t}\n\n\t@log<GitService['repositorySearch']>({\n\t\targs: false,\n\t\tsingleLine: true,\n\t\tprefix: (context, folder) => `${context.prefix}(${folder.uri.fsPath})`,\n\t\texit: result =>\n\t\t\t`returned ${result.length} repositories${\n\t\t\t\tresult.length !== 0 ? ` (${result.map(r => r.path).join(', ')})` : emptyStr\n\t\t\t}`,\n\t})\n\tprivate async repositorySearch(folder: WorkspaceFolder): Promise<Repository[]> {\n\t\tconst cc = Logger.getCorrelationContext();\n\t\tconst { uri } = folder;\n\t\tconst depth = configuration.get('advanced.repositorySearchDepth', uri);\n\n\t\tLogger.log(cc, `searching (depth=${depth})...`);\n\n\t\tconst repositories: Repository[] = [];\n\t\tconst anyRepoChangedFn = this.onAnyRepositoryChanged.bind(this);\n\n\t\tconst rootPath = await this.getRepoPathCore(uri.fsPath, true);\n\t\tif (rootPath != null) {\n\t\t\tLogger.log(cc, `found root repository in '${rootPath}'`);\n\t\t\trepositories.push(new Repository(folder, rootPath, true, anyRepoChangedFn, !window.state.focused));\n\t\t}\n\n\t\tif (depth <= 0) return repositories;\n\n\t\t// Get any specified excludes -- this is a total hack, but works for some simple cases and something is better than nothing :)\n\t\tlet excludes = {\n\t\t\t...configuration.getAny<Record<string, boolean>>('files.exclude', uri, {}),\n\t\t\t...configuration.getAny<Record<string, boolean>>('search.exclude', uri, {}),\n\t\t};\n\n\t\tconst excludedPaths = [\n\t\t\t...Iterables.filterMap(Object.entries(excludes), ([key, value]) => {\n\t\t\t\tif (!value) return undefined;\n\t\t\t\tif (key.startsWith('**/')) return key.substring(3);\n\t\t\t\treturn key;\n\t\t\t}),\n\t\t];\n\n\t\texcludes = excludedPaths.reduce((accumulator, current) => {\n\t\t\taccumulator[current] = true;\n\t\t\treturn accumulator;\n\t\t}, Object.create(null) as Record<string, boolean>);\n\n\t\tlet repoPaths;\n\t\ttry {\n\t\t\trepoPaths = await this.repositorySearchCore(uri.fsPath, depth, excludes);\n\t\t} catch (ex) {\n\t\t\tconst msg: string = ex?.toString() ?? emptyStr;\n\t\t\tif (RepoSearchWarnings.doesNotExist.test(msg)) {\n\t\t\t\tLogger.log(cc, `FAILED${msg ? ` Error: ${msg}` : emptyStr}`);\n\t\t\t} else {\n\t\t\t\tLogger.error(ex, cc, 'FAILED');\n\t\t\t}\n\n\t\t\treturn repositories;\n\t\t}\n\n\t\tfor (let p of repoPaths) {\n\t\t\tp = paths.dirname(p);\n\t\t\t// If we are the same as the root, skip it\n\t\t\tif (Strings.normalizePath(p) === rootPath) continue;\n\n\t\t\tLogger.log(cc, `searching in '${p}'...`);\n\t\t\tLogger.debug(cc, `normalizedRepoPath=${Strings.normalizePath(p)}, rootPath=${rootPath}`);\n\n\t\t\tconst rp = await this.getRepoPathCore(p, true);\n\t\t\tif (rp == null) continue;\n\n\t\t\tLogger.log(cc, `found repository in '${rp}'`);\n\t\t\trepositories.push(new Repository(folder, rp, false, anyRepoChangedFn, !window.state.focused));\n\t\t}\n\n\t\treturn repositories;\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (root: string) => root,\n\t\t\t1: (depth: number) => `${depth}`,\n\t\t\t2: () => false,\n\t\t\t3: () => false,\n\t\t},\n\t})\n\tprivate repositorySearchCore(\n\t\troot: string,\n\t\tdepth: number,\n\t\texcludes: Record<string, boolean>,\n\t\trepositories: string[] = [],\n\t): Promise<string[]> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\treturn new Promise<string[]>((resolve, reject) => {\n\t\t\tfs.readdir(root, { withFileTypes: true }, async (err, files) => {\n\t\t\t\tif (err != null) {\n\t\t\t\t\treject(err);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (files.length === 0) {\n\t\t\t\t\tresolve(repositories);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tdepth--;\n\n\t\t\t\tlet f;\n\t\t\t\tfor (f of files) {\n\t\t\t\t\tif (!f.isDirectory()) continue;\n\n\t\t\t\t\tif (f.name === '.git') {\n\t\t\t\t\t\trepositories.push(paths.resolve(root, f.name));\n\t\t\t\t\t} else if (depth >= 0 && excludes[f.name] !== true) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tawait this.repositorySearchCore(paths.resolve(root, f.name), depth, excludes, repositories);\n\t\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\t\tLogger.error(ex, cc, 'FAILED');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tresolve(repositories);\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate async updateContext(repositoryTree: TernarySearchTree<string, Repository>) {\n\t\tconst hasRepository = repositoryTree.any();\n\t\tawait setEnabled(hasRepository);\n\n\t\t// Don't block for the remote context updates (because it can block other downstream requests during initialization)\n\t\tasync function updateRemoteContext() {\n\t\t\tlet hasRemotes = false;\n\t\t\tlet hasRichRemotes = false;\n\t\t\tlet hasConnectedRemotes = false;\n\t\t\tif (hasRepository) {\n\t\t\t\tfor (const repo of repositoryTree.values()) {\n\t\t\t\t\tif (!hasConnectedRemotes) {\n\t\t\t\t\t\thasConnectedRemotes = await repo.hasRichRemote(true);\n\n\t\t\t\t\t\tif (hasConnectedRemotes) {\n\t\t\t\t\t\t\thasRichRemotes = true;\n\t\t\t\t\t\t\thasRemotes = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!hasRichRemotes) {\n\t\t\t\t\t\thasRichRemotes = await repo.hasRichRemote();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!hasRemotes) {\n\t\t\t\t\t\thasRemotes = await repo.hasRemotes();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (hasRemotes && hasRichRemotes && hasConnectedRemotes) break;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tawait Promise.all([\n\t\t\t\tsetContext(ContextKeys.HasRemotes, hasRemotes),\n\t\t\t\tsetContext(ContextKeys.HasRichRemotes, hasRichRemotes),\n\t\t\t\tsetContext(ContextKeys.HasConnectedRemotes, hasConnectedRemotes),\n\t\t\t]);\n\t\t}\n\n\t\tvoid updateRemoteContext();\n\n\t\t// If we have no repositories setup a watcher in case one is initialized\n\t\tif (!hasRepository) {\n\t\t\tconst watcher = workspace.createFileSystemWatcher('**/.git', false, true, true);\n\t\t\tconst disposable = Disposable.from(\n\t\t\t\twatcher,\n\t\t\t\twatcher.onDidCreate(async uri => {\n\t\t\t\t\tconst f = workspace.getWorkspaceFolder(uri);\n\t\t\t\t\tif (f == null) return;\n\n\t\t\t\t\t// Search for and add all repositories (nested and/or submodules)\n\t\t\t\t\tconst repositories = await this.repositorySearch(f);\n\t\t\t\t\tif (repositories.length === 0) return;\n\n\t\t\t\t\tdisposable.dispose();\n\n\t\t\t\t\tfor (const r of repositories) {\n\t\t\t\t\t\tif (!this._repositoryTree.has(r.path)) {\n\t\t\t\t\t\t\tthis._repositoryTree.set(r.path, r);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvoid GitService.openBuiltInGitRepository(r.path);\n\t\t\t\t\t}\n\n\t\t\t\t\tawait this.updateContext(this._repositoryTree);\n\n\t\t\t\t\t// Defer the event trigger enough to let everything unwind\n\t\t\t\t\tsetImmediate(() => this.fireRepositoriesChanged());\n\t\t\t\t}, this),\n\t\t\t);\n\t\t}\n\t}\n\n\tprivate fireRepositoriesChanged() {\n\t\tthis._onDidChangeRepositories.fire();\n\t}\n\n\t@log()\n\taddRemote(repoPath: string, name: string, url: string) {\n\t\treturn Git.remote__add(repoPath, name, url);\n\t}\n\n\t@log()\n\tpruneRemote(repoPath: string, remoteName: string) {\n\t\treturn Git.remote__prune(repoPath, remoteName);\n\t}\n\n\t@log()\n\tasync applyChangesToWorkingFile(uri: GitUri, ref1?: string, ref2?: string) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tref1 = ref1 ?? uri.sha;\n\t\tif (ref1 == null || uri.repoPath == null) return;\n\n\t\tif (ref2 == null) {\n\t\t\tref2 = ref1;\n\t\t\tref1 = `${ref1}^`;\n\t\t}\n\n\t\tlet patch;\n\t\ttry {\n\t\t\tpatch = await Git.diff(uri.repoPath, uri.fsPath, ref1, ref2);\n\t\t\tvoid (await Git.apply(uri.repoPath, patch));\n\t\t} catch (ex) {\n\t\t\tconst msg: string = ex?.toString() ?? emptyStr;\n\t\t\tif (patch && /patch does not apply/i.test(msg)) {\n\t\t\t\tconst result = await window.showWarningMessage(\n\t\t\t\t\t'Unable to apply changes cleanly. Retry and allow conflicts?',\n\t\t\t\t\t{ title: 'Yes' },\n\t\t\t\t\t{ title: 'No', isCloseAffordance: true },\n\t\t\t\t);\n\n\t\t\t\tif (result == null || result.title !== 'Yes') return;\n\n\t\t\t\tif (result.title === 'Yes') {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvoid (await Git.apply(uri.repoPath, patch, { allowConflicts: true }));\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// eslint-disable-next-line no-ex-assign\n\t\t\t\t\t\tex = e;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tLogger.error(ex, cc);\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to apply changes');\n\t\t}\n\t}\n\n\t@log()\n\tasync branchContainsCommit(repoPath: string, name: string, ref: string): Promise<boolean> {\n\t\tlet data = await Git.branch__containsOrPointsAt(repoPath, ref, { mode: 'contains', name: name });\n\t\tdata = data?.trim();\n\t\treturn Boolean(data);\n\t}\n\n\t@log()\n\tasync checkout(repoPath: string, ref: string, options: { createBranch?: string } | { fileName?: string } = {}) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\ttry {\n\t\t\treturn await Git.checkout(repoPath, ref, options);\n\t\t} catch (ex) {\n\t\t\tconst msg: string = ex?.toString() ?? emptyStr;\n\t\t\tif (/overwritten by checkout/i.test(msg)) {\n\t\t\t\tvoid Messages.showGenericErrorMessage(\n\t\t\t\t\t`Unable to checkout '${ref}'. Please commit or stash your changes before switching branches`,\n\t\t\t\t);\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tLogger.error(ex, cc);\n\t\t\tvoid void Messages.showGenericErrorMessage(`Unable to checkout '${ref}'`);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync resetCaches(\n\t\t...cache: ('branches' | 'contributors' | 'providers' | 'remotes' | 'stashes' | 'status' | 'tags')[]\n\t) {\n\t\tif (cache.length === 0 || cache.includes('branches')) {\n\t\t\tthis._branchesCache.clear();\n\n\t\t\tif (cache.length !== 0) {\n\t\t\t\tfor (const repo of await this.getRepositories()) {\n\t\t\t\t\trepo.resetCaches('branch');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (cache.length === 0 || cache.includes('contributors')) {\n\t\t\tthis._contributorsCache.clear();\n\t\t}\n\n\t\tif (cache.length === 0 || cache.includes('providers')) {\n\t\t\tthis._remotesWithApiProviderCache.clear();\n\t\t}\n\n\t\tif (cache.includes('remotes')) {\n\t\t\tfor (const repo of await this.getRepositories()) {\n\t\t\t\trepo.resetCaches('remotes');\n\t\t\t}\n\t\t}\n\n\t\tif (cache.length === 0 || cache.includes('stashes')) {\n\t\t\tthis._stashesCache.clear();\n\t\t}\n\n\t\tif (cache.length === 0 || cache.includes('status')) {\n\t\t\tthis._mergeStatusCache.clear();\n\t\t\tthis._rebaseStatusCache.clear();\n\t\t}\n\n\t\tif (cache.length === 0 || cache.includes('tags')) {\n\t\t\tthis._tagsCache.clear();\n\t\t}\n\n\t\tif (cache.length === 0) {\n\t\t\tthis._trackedCache.clear();\n\t\t\tthis._userMapCache.clear();\n\n\t\t\tfor (const repo of await this.getRepositories()) {\n\t\t\t\trepo.resetCaches();\n\t\t\t}\n\t\t}\n\t}\n\n\t@log({\n\t\targs: {\n\t\t\t0: (repoPath: string) => repoPath,\n\t\t\t1: (uris: Uri[]) => `${uris.length}`,\n\t\t},\n\t})\n\tasync excludeIgnoredUris(repoPath: string, uris: Uri[]): Promise<Uri[]> {\n\t\tconst paths = new Map<string, Uri>(uris.map(u => [Strings.normalizePath(u.fsPath), u]));\n\n\t\tconst data = await Git.check_ignore(repoPath, ...paths.keys());\n\t\tif (data == null) return uris;\n\n\t\tconst ignored = data.split('\\0').filter(<T>(i?: T): i is T => Boolean(i));\n\t\tif (ignored.length === 0) return uris;\n\n\t\tfor (const file of ignored) {\n\t\t\tpaths.delete(file);\n\t\t}\n\n\t\treturn [...paths.values()];\n\t}\n\n\t@gate()\n\t@log()\n\tasync fetch(\n\t\trepoPath: string,\n\t\toptions: { all?: boolean; branch?: GitBranchReference; prune?: boolean; pull?: boolean; remote?: string } = {},\n\t): Promise<void> {\n\t\tconst { branch: branchRef, ...opts } = options;\n\t\tif (GitReference.isBranch(branchRef)) {\n\t\t\tconst repo = await this.getRepository(repoPath);\n\t\t\tconst branch = await repo?.getBranch(branchRef?.name);\n\t\t\tif (!branch?.remote && branch?.upstream == null) return undefined;\n\n\t\t\treturn Git.fetch(repoPath, {\n\t\t\t\tbranch: branch.getNameWithoutRemote(),\n\t\t\t\tremote: branch.getRemoteName()!,\n\t\t\t\tupstream: branch.getTrackingWithoutRemote()!,\n\t\t\t\tpull: options.pull,\n\t\t\t});\n\t\t}\n\n\t\treturn Git.fetch(repoPath, opts);\n\t}\n\n\t@gate<GitService['fetchAll']>(\n\t\t(repos, opts) => `${repos == null ? '' : repos.map(r => r.id).join(',')}|${JSON.stringify(opts)}`,\n\t)\n\t@log({\n\t\targs: {\n\t\t\t0: (repos?: Repository[]) => (repos == null ? false : repos.map(r => r.name).join(', ')),\n\t\t},\n\t})\n\tasync fetchAll(repositories?: Repository[], options: { all?: boolean; prune?: boolean } = {}) {\n\t\tif (repositories == null) {\n\t\t\trepositories = await this.getOrderedRepositories();\n\t\t}\n\t\tif (repositories.length === 0) return;\n\n\t\tif (repositories.length === 1) {\n\t\t\tawait repositories[0].fetch(options);\n\n\t\t\treturn;\n\t\t}\n\n\t\tawait window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Fetching ${repositories.length} repositories`,\n\t\t\t},\n\t\t\t() => Promise.all(repositories!.map(r => r.fetch({ progress: false, ...options }))),\n\t\t);\n\t}\n\n\t@gate<GitService['pullAll']>(\n\t\t(repos, opts) => `${repos == null ? '' : repos.map(r => r.id).join(',')}|${JSON.stringify(opts)}`,\n\t)\n\t@log({\n\t\targs: {\n\t\t\t0: (repos?: Repository[]) => (repos == null ? false : repos.map(r => r.name).join(', ')),\n\t\t},\n\t})\n\tasync pullAll(repositories?: Repository[], options: { rebase?: boolean } = {}) {\n\t\tif (repositories == null) {\n\t\t\trepositories = await this.getOrderedRepositories();\n\t\t}\n\t\tif (repositories.length === 0) return;\n\n\t\tif (repositories.length === 1) {\n\t\t\tawait repositories[0].pull(options);\n\n\t\t\treturn;\n\t\t}\n\n\t\tawait window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Pulling ${repositories.length} repositories`,\n\t\t\t},\n\t\t\t() => Promise.all(repositories!.map(r => r.pull({ progress: false, ...options }))),\n\t\t);\n\t}\n\n\t@gate<GitService['pushAll']>(repos => `${repos == null ? '' : repos.map(r => r.id).join(',')}`)\n\t@log({\n\t\targs: {\n\t\t\t0: (repos?: Repository[]) => (repos == null ? false : repos.map(r => r.name).join(', ')),\n\t\t},\n\t})\n\tasync pushAll(\n\t\trepositories?: Repository[],\n\t\toptions: {\n\t\t\tforce?: boolean;\n\t\t\treference?: GitReference;\n\t\t\tpublish?: {\n\t\t\t\tremote: string;\n\t\t\t};\n\t\t} = {},\n\t) {\n\t\tif (repositories == null) {\n\t\t\trepositories = await this.getOrderedRepositories();\n\t\t}\n\t\tif (repositories.length === 0) return;\n\n\t\tif (repositories.length === 1) {\n\t\t\tawait repositories[0].push(options);\n\n\t\t\treturn;\n\t\t}\n\n\t\tawait window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Pushing ${repositories.length} repositories`,\n\t\t\t},\n\t\t\t() => Promise.all(repositories!.map(r => r.push({ progress: false, ...options }))),\n\t\t);\n\t}\n\n\t@log({\n\t\targs: {\n\t\t\t0: (editor: TextEditor) =>\n\t\t\t\teditor != null ? `TextEditor(${Logger.toLoggable(editor.document.uri)})` : 'undefined',\n\t\t},\n\t})\n\tasync getActiveRepository(editor?: TextEditor): Promise<Repository | undefined> {\n\t\tconst repoPath = await this.getActiveRepoPath(editor);\n\t\tif (repoPath == null) return undefined;\n\n\t\treturn this.getRepository(repoPath);\n\t}\n\n\t@log({\n\t\targs: {\n\t\t\t0: (editor: TextEditor) =>\n\t\t\t\teditor != null ? `TextEditor(${Logger.toLoggable(editor.document.uri)})` : 'undefined',\n\t\t},\n\t})\n\tasync getActiveRepoPath(editor?: TextEditor): Promise<string | undefined> {\n\t\teditor = editor ?? window.activeTextEditor;\n\n\t\tlet repoPath;\n\t\tif (editor != null) {\n\t\t\tconst doc = await Container.tracker.getOrAdd(editor.document.uri);\n\t\t\tif (doc != null) {\n\t\t\t\trepoPath = doc.uri.repoPath;\n\t\t\t}\n\t\t}\n\n\t\tif (repoPath != null) return repoPath;\n\n\t\treturn this.getHighlanderRepoPath();\n\t}\n\n\t@log()\n\tgetHighlanderRepoPath(): string | undefined {\n\t\tconst entry = this._repositoryTree.highlander();\n\t\tif (entry == null) return undefined;\n\n\t\tconst [, repo] = entry;\n\t\treturn repo.path;\n\t}\n\n\t@log()\n\tasync getBlameForFile(uri: GitUri): Promise<GitBlame | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tlet key = 'blame';\n\t\tif (uri.sha != null) {\n\t\t\tkey += `:${uri.sha}`;\n\t\t}\n\n\t\tconst doc = await Container.tracker.getOrAdd(uri);\n\t\tif (this.useCaching) {\n\t\t\tif (doc.state != null) {\n\t\t\t\tconst cachedBlame = doc.state.get<CachedBlame>(key);\n\t\t\t\tif (cachedBlame != null) {\n\t\t\t\t\tLogger.debug(cc, `Cache hit: '${key}'`);\n\t\t\t\t\treturn cachedBlame.item;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tLogger.debug(cc, `Cache miss: '${key}'`);\n\n\t\t\tif (doc.state == null) {\n\t\t\t\tdoc.state = new GitDocumentState(doc.key);\n\t\t\t}\n\t\t}\n\n\t\tconst promise = this.getBlameForFileCore(uri, doc, key, cc);\n\n\t\tif (doc.state != null) {\n\t\t\tLogger.debug(cc, `Cache add: '${key}'`);\n\n\t\t\tconst value: CachedBlame = {\n\t\t\t\titem: promise as Promise<GitBlame>,\n\t\t\t};\n\t\t\tdoc.state.set<CachedBlame>(key, value);\n\t\t}\n\n\t\treturn promise;\n\t}\n\n\tprivate async getBlameForFileCore(\n\t\turi: GitUri,\n\t\tdocument: TrackedDocument<GitDocumentState>,\n\t\tkey: string,\n\t\tcc: LogCorrelationContext | undefined,\n\t): Promise<GitBlame | undefined> {\n\t\tif (!(await this.isTracked(uri))) {\n\t\t\tLogger.log(cc, `Skipping blame; '${uri.fsPath}' is not tracked`);\n\t\t\treturn emptyPromise as Promise<GitBlame>;\n\t\t}\n\n\t\tconst [file, root] = Git.splitPath(uri.fsPath, uri.repoPath, false);\n\n\t\ttry {\n\t\t\tconst data = await Git.blame(root, file, uri.sha, {\n\t\t\t\targs: Container.config.advanced.blame.customArguments,\n\t\t\t\tignoreWhitespace: Container.config.blame.ignoreWhitespace,\n\t\t\t});\n\t\t\tconst blame = GitBlameParser.parse(data, root, file, await this.getCurrentUser(root));\n\t\t\treturn blame;\n\t\t} catch (ex) {\n\t\t\t// Trap and cache expected blame errors\n\t\t\tif (document.state != null) {\n\t\t\t\tconst msg = ex?.toString() ?? '';\n\t\t\t\tLogger.debug(cc, `Cache replace (with empty promise): '${key}'`);\n\n\t\t\t\tconst value: CachedBlame = {\n\t\t\t\t\titem: emptyPromise as Promise<GitBlame>,\n\t\t\t\t\terrorMessage: msg,\n\t\t\t\t};\n\t\t\t\tdocument.state.set<CachedBlame>(key, value);\n\n\t\t\t\tdocument.setBlameFailure();\n\n\t\t\t\treturn emptyPromise as Promise<GitBlame>;\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log({\n\t\targs: {\n\t\t\t1: _contents => '<contents>',\n\t\t},\n\t})\n\tasync getBlameForFileContents(uri: GitUri, contents: string): Promise<GitBlame | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tconst key = `blame:${Strings.sha1(contents)}`;\n\n\t\tconst doc = await Container.tracker.getOrAdd(uri);\n\t\tif (this.useCaching) {\n\t\t\tif (doc.state != null) {\n\t\t\t\tconst cachedBlame = doc.state.get<CachedBlame>(key);\n\t\t\t\tif (cachedBlame != null) {\n\t\t\t\t\tLogger.debug(cc, `Cache hit: ${key}`);\n\t\t\t\t\treturn cachedBlame.item;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tLogger.debug(cc, `Cache miss: ${key}`);\n\n\t\t\tif (doc.state == null) {\n\t\t\t\tdoc.state = new GitDocumentState(doc.key);\n\t\t\t}\n\t\t}\n\n\t\tconst promise = this.getBlameForFileContentsCore(uri, contents, doc, key, cc);\n\n\t\tif (doc.state != null) {\n\t\t\tLogger.debug(cc, `Cache add: '${key}'`);\n\n\t\t\tconst value: CachedBlame = {\n\t\t\t\titem: promise as Promise<GitBlame>,\n\t\t\t};\n\t\t\tdoc.state.set<CachedBlame>(key, value);\n\t\t}\n\n\t\treturn promise;\n\t}\n\n\tasync getBlameForFileContentsCore(\n\t\turi: GitUri,\n\t\tcontents: string,\n\t\tdocument: TrackedDocument<GitDocumentState>,\n\t\tkey: string,\n\t\tcc: LogCorrelationContext | undefined,\n\t): Promise<GitBlame | undefined> {\n\t\tif (!(await this.isTracked(uri))) {\n\t\t\tLogger.log(cc, `Skipping blame; '${uri.fsPath}' is not tracked`);\n\t\t\treturn emptyPromise as Promise<GitBlame>;\n\t\t}\n\n\t\tconst [file, root] = Git.splitPath(uri.fsPath, uri.repoPath, false);\n\n\t\ttry {\n\t\t\tconst data = await Git.blame__contents(root, file, contents, {\n\t\t\t\targs: Container.config.advanced.blame.customArguments,\n\t\t\t\tcorrelationKey: `:${key}`,\n\t\t\t\tignoreWhitespace: Container.config.blame.ignoreWhitespace,\n\t\t\t});\n\t\t\tconst blame = GitBlameParser.parse(data, root, file, await this.getCurrentUser(root));\n\t\t\treturn blame;\n\t\t} catch (ex) {\n\t\t\t// Trap and cache expected blame errors\n\t\t\tif (document.state != null) {\n\t\t\t\tconst msg = ex?.toString() ?? '';\n\t\t\t\tLogger.debug(cc, `Cache replace (with empty promise): '${key}'`);\n\n\t\t\t\tconst value: CachedBlame = {\n\t\t\t\t\titem: emptyPromise as Promise<GitBlame>,\n\t\t\t\t\terrorMessage: msg,\n\t\t\t\t};\n\t\t\t\tdocument.state.set<CachedBlame>(key, value);\n\n\t\t\t\tdocument.setBlameFailure();\n\t\t\t\treturn emptyPromise as Promise<GitBlame>;\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getBlameForLine(\n\t\turi: GitUri,\n\t\teditorLine: number, // editor lines are 0-based\n\t\toptions: { skipCache?: boolean } = {},\n\t): Promise<GitBlameLine | undefined> {\n\t\tif (!options.skipCache && this.useCaching) {\n\t\t\tconst blame = await this.getBlameForFile(uri);\n\t\t\tif (blame == null) return undefined;\n\n\t\t\tlet blameLine = blame.lines[editorLine];\n\t\t\tif (blameLine == null) {\n\t\t\t\tif (blame.lines.length !== editorLine) return undefined;\n\t\t\t\tblameLine = blame.lines[editorLine - 1];\n\t\t\t}\n\n\t\t\tconst commit = blame.commits.get(blameLine.sha);\n\t\t\tif (commit == null) return undefined;\n\n\t\t\tconst author = blame.authors.get(commit.author)!;\n\t\t\treturn {\n\t\t\t\tauthor: { ...author, lineCount: commit.lines.length },\n\t\t\t\tcommit: commit,\n\t\t\t\tline: blameLine,\n\t\t\t};\n\t\t}\n\n\t\tconst lineToBlame = editorLine + 1;\n\t\tconst fileName = uri.fsPath;\n\n\t\ttry {\n\t\t\tconst data = await Git.blame(uri.repoPath, fileName, uri.sha, {\n\t\t\t\targs: Container.config.advanced.blame.customArguments,\n\t\t\t\tignoreWhitespace: Container.config.blame.ignoreWhitespace,\n\t\t\t\tstartLine: lineToBlame,\n\t\t\t\tendLine: lineToBlame,\n\t\t\t});\n\t\t\tconst blame = GitBlameParser.parse(data, uri.repoPath, fileName, await this.getCurrentUser(uri.repoPath!));\n\t\t\tif (blame == null) return undefined;\n\n\t\t\treturn {\n\t\t\t\tauthor: Iterables.first(blame.authors.values()),\n\t\t\t\tcommit: Iterables.first(blame.commits.values()),\n\t\t\t\tline: blame.lines[editorLine],\n\t\t\t};\n\t\t} catch {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log({\n\t\targs: {\n\t\t\t2: _contents => '<contents>',\n\t\t},\n\t})\n\tasync getBlameForLineContents(\n\t\turi: GitUri,\n\t\teditorLine: number, // editor lines are 0-based\n\t\tcontents: string,\n\t\toptions: { skipCache?: boolean } = {},\n\t): Promise<GitBlameLine | undefined> {\n\t\tif (!options.skipCache && this.useCaching) {\n\t\t\tconst blame = await this.getBlameForFileContents(uri, contents);\n\t\t\tif (blame == null) return undefined;\n\n\t\t\tlet blameLine = blame.lines[editorLine];\n\t\t\tif (blameLine == null) {\n\t\t\t\tif (blame.lines.length !== editorLine) return undefined;\n\t\t\t\tblameLine = blame.lines[editorLine - 1];\n\t\t\t}\n\n\t\t\tconst commit = blame.commits.get(blameLine.sha);\n\t\t\tif (commit == null) return undefined;\n\n\t\t\tconst author = blame.authors.get(commit.author)!;\n\t\t\treturn {\n\t\t\t\tauthor: { ...author, lineCount: commit.lines.length },\n\t\t\t\tcommit: commit,\n\t\t\t\tline: blameLine,\n\t\t\t};\n\t\t}\n\n\t\tconst lineToBlame = editorLine + 1;\n\t\tconst fileName = uri.fsPath;\n\n\t\ttry {\n\t\t\tconst data = await Git.blame__contents(uri.repoPath, fileName, contents, {\n\t\t\t\targs: Container.config.advanced.blame.customArguments,\n\t\t\t\tignoreWhitespace: Container.config.blame.ignoreWhitespace,\n\t\t\t\tstartLine: lineToBlame,\n\t\t\t\tendLine: lineToBlame,\n\t\t\t});\n\t\t\tconst blame = GitBlameParser.parse(data, uri.repoPath, fileName, await this.getCurrentUser(uri.repoPath!));\n\t\t\tif (blame == null) return undefined;\n\n\t\t\treturn {\n\t\t\t\tauthor: Iterables.first(blame.authors.values()),\n\t\t\t\tcommit: Iterables.first(blame.commits.values()),\n\t\t\t\tline: blame.lines[editorLine],\n\t\t\t};\n\t\t} catch {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getBlameForRange(uri: GitUri, range: Range): Promise<GitBlameLines | undefined> {\n\t\tconst blame = await this.getBlameForFile(uri);\n\t\tif (blame == null) return undefined;\n\n\t\treturn this.getBlameForRangeSync(blame, uri, range);\n\t}\n\n\t@log({\n\t\targs: {\n\t\t\t2: _contents => '<contents>',\n\t\t},\n\t})\n\tasync getBlameForRangeContents(uri: GitUri, range: Range, contents: string): Promise<GitBlameLines | undefined> {\n\t\tconst blame = await this.getBlameForFileContents(uri, contents);\n\t\tif (blame == null) return undefined;\n\n\t\treturn this.getBlameForRangeSync(blame, uri, range);\n\t}\n\n\t@log({\n\t\targs: {\n\t\t\t0: _blame => '<blame>',\n\t\t},\n\t})\n\tgetBlameForRangeSync(blame: GitBlame, uri: GitUri, range: Range): GitBlameLines | undefined {\n\t\tif (blame.lines.length === 0) return { allLines: blame.lines, ...blame };\n\n\t\tif (range.start.line === 0 && range.end.line === blame.lines.length - 1) {\n\t\t\treturn { allLines: blame.lines, ...blame };\n\t\t}\n\n\t\tconst lines = blame.lines.slice(range.start.line, range.end.line + 1);\n\t\tconst shas = new Set(lines.map(l => l.sha));\n\n\t\t// ranges are 0-based\n\t\tconst startLine = range.start.line + 1;\n\t\tconst endLine = range.end.line + 1;\n\n\t\tconst authors = new Map<string, GitAuthor>();\n\t\tconst commits = new Map<string, GitBlameCommit>();\n\t\tfor (const c of blame.commits.values()) {\n\t\t\tif (!shas.has(c.sha)) continue;\n\n\t\t\tconst commit = c.with({\n\t\t\t\tlines: c.lines.filter(l => l.line >= startLine && l.line <= endLine),\n\t\t\t});\n\t\t\tcommits.set(c.sha, commit);\n\n\t\t\tlet author = authors.get(commit.author);\n\t\t\tif (author == null) {\n\t\t\t\tauthor = {\n\t\t\t\t\tname: commit.author,\n\t\t\t\t\tlineCount: 0,\n\t\t\t\t};\n\t\t\t\tauthors.set(author.name, author);\n\t\t\t}\n\n\t\t\tauthor.lineCount += commit.lines.length;\n\t\t}\n\n\t\tconst sortedAuthors = new Map([...authors.entries()].sort((a, b) => b[1].lineCount - a[1].lineCount));\n\n\t\treturn {\n\t\t\trepoPath: uri.repoPath!,\n\t\t\tauthors: sortedAuthors,\n\t\t\tcommits: commits,\n\t\t\tlines: lines,\n\t\t\tallLines: blame.lines,\n\t\t};\n\t}\n\n\t@log()\n\tasync getBranch(repoPath: string | undefined): Promise<GitBranch | undefined> {\n\t\tif (repoPath == null) return undefined;\n\n\t\tlet [branch] = await this.getBranches(repoPath, { filter: b => b.current });\n\t\tif (branch != null) return branch;\n\n\t\tconst data = await Git.rev_parse__currentBranch(repoPath, Container.config.advanced.commitOrdering);\n\t\tif (data == null) return undefined;\n\n\t\tconst [name, upstream] = data[0].split('\\n');\n\t\tif (GitBranch.isDetached(name)) {\n\t\t\tconst [rebaseStatus, committerDate] = await Promise.all([\n\t\t\t\tthis.getRebaseStatus(repoPath),\n\t\t\t\tGit.log__recent_committerdate(repoPath, Container.config.advanced.commitOrdering),\n\t\t\t]);\n\n\t\t\tbranch = new GitBranch(\n\t\t\t\trepoPath,\n\t\t\t\trebaseStatus?.incoming.name ?? name,\n\t\t\t\tfalse,\n\t\t\t\ttrue,\n\t\t\t\tcommitterDate != null ? new Date(Number(committerDate) * 1000) : undefined,\n\t\t\t\tdata[1],\n\t\t\t\tupstream ? { name: upstream, missing: false } : undefined,\n\t\t\t\tundefined,\n\t\t\t\tundefined,\n\t\t\t\tundefined,\n\t\t\t\trebaseStatus != null,\n\t\t\t);\n\t\t}\n\n\t\treturn branch;\n\t}\n\n\t@log({\n\t\targs: {\n\t\t\t0: b => b.name,\n\t\t},\n\t})\n\tasync getBranchAheadRange(branch: GitBranch) {\n\t\tif (branch.state.ahead > 0) {\n\t\t\treturn GitRevision.createRange(branch.upstream?.name, branch.ref);\n\t\t}\n\n\t\tif (branch.upstream == null) {\n\t\t\t// If we have no upstream branch, try to find a best guess branch to use as the \"base\"\n\t\t\tconst branches = await this.getBranches(branch.repoPath, {\n\t\t\t\tfilter: b => weightedDefaultBranches.has(b.name),\n\t\t\t});\n\t\t\tif (branches.length > 0) {\n\t\t\t\tlet weightedBranch: { weight: number; branch: GitBranch } | undefined;\n\t\t\t\tfor (const branch of branches) {\n\t\t\t\t\tconst weight = weightedDefaultBranches.get(branch.name)!;\n\t\t\t\t\tif (weightedBranch == null || weightedBranch.weight < weight) {\n\t\t\t\t\t\tweightedBranch = { weight: weight, branch: branch };\n\t\t\t\t\t}\n\n\t\t\t\t\tif (weightedBranch.weight === maxDefaultBranchWeight) break;\n\t\t\t\t}\n\n\t\t\t\tconst possibleBranch = weightedBranch!.branch.upstream?.name ?? weightedBranch!.branch.ref;\n\t\t\t\tif (possibleBranch !== branch.ref) {\n\t\t\t\t\treturn GitRevision.createRange(possibleBranch, branch.ref);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\t@log({\n\t\targs: {\n\t\t\t1: () => false,\n\t\t},\n\t})\n\tasync getBranches(\n\t\trepoPath: string | undefined,\n\t\toptions: {\n\t\t\tfilter?: (b: GitBranch) => boolean;\n\t\t\tsort?: boolean | BranchSortOptions;\n\t\t} = {},\n\t): Promise<GitBranch[]> {\n\t\tif (repoPath == null) return [];\n\n\t\tlet branchesPromise = this.useCaching ? this._branchesCache.get(repoPath) : undefined;\n\t\tif (branchesPromise == null) {\n\t\t\tasync function load(this: GitService) {\n\t\t\t\ttry {\n\t\t\t\t\tconst data = await Git.for_each_ref__branch(repoPath!, { all: true });\n\t\t\t\t\t// If we don't get any data, assume the repo doesn't have any commits yet so check if we have a current branch\n\t\t\t\t\tif (data == null || data.length === 0) {\n\t\t\t\t\t\tlet current;\n\n\t\t\t\t\t\tconst data = await Git.rev_parse__currentBranch(\n\t\t\t\t\t\t\trepoPath!,\n\t\t\t\t\t\t\tContainer.config.advanced.commitOrdering,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (data != null) {\n\t\t\t\t\t\t\tconst [name, upstream] = data[0].split('\\n');\n\t\t\t\t\t\t\tconst [rebaseStatus, committerDate] = await Promise.all([\n\t\t\t\t\t\t\t\tGitBranch.isDetached(name) ? this.getRebaseStatus(repoPath!) : undefined,\n\t\t\t\t\t\t\t\tGit.log__recent_committerdate(repoPath!, Container.config.advanced.commitOrdering),\n\t\t\t\t\t\t\t]);\n\n\t\t\t\t\t\t\tcurrent = new GitBranch(\n\t\t\t\t\t\t\t\trepoPath!,\n\t\t\t\t\t\t\t\trebaseStatus?.incoming.name ?? name,\n\t\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\t\tcommitterDate != null ? new Date(Number(committerDate) * 1000) : undefined,\n\t\t\t\t\t\t\t\tdata[1],\n\t\t\t\t\t\t\t\t{ name: upstream, missing: false },\n\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t\trebaseStatus != null,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn current != null ? [current] : [];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn GitBranchParser.parse(data, repoPath!);\n\t\t\t\t} catch (ex) {\n\t\t\t\t\tthis._branchesCache.delete(repoPath!);\n\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbranchesPromise = load.call(this);\n\n\t\t\tif (this.useCaching) {\n\t\t\t\tthis._branchesCache.set(repoPath, branchesPromise);\n\n\t\t\t\tif (!(await this.getRepository(repoPath))?.supportsChangeEvents) {\n\t\t\t\t\tthis._branchesCache.delete(repoPath);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet branches = await branchesPromise;\n\t\tif (options.filter != null) {\n\t\t\tbranches = branches.filter(options.filter);\n\t\t}\n\n\t\t// eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n\t\tif (options.sort) {\n\t\t\tGitBranch.sort(branches, typeof options.sort === 'boolean' ? undefined : options.sort);\n\t\t}\n\n\t\treturn branches;\n\t}\n\n\t@log({\n\t\targs: {\n\t\t\t1: () => false,\n\t\t},\n\t})\n\tasync getBranchesAndOrTags(\n\t\trepoPath: string | undefined,\n\t\t{\n\t\t\tfilter,\n\t\t\tinclude,\n\t\t\tsort,\n\t\t\t...options\n\t\t}: {\n\t\t\tfilter?: { branches?: (b: GitBranch) => boolean; tags?: (t: GitTag) => boolean };\n\t\t\tinclude?: 'all' | 'branches' | 'tags';\n\t\t\tsort?: boolean | { branches?: BranchSortOptions; tags?: TagSortOptions };\n\t\t} = {},\n\t) {\n\t\tconst [branches, tags] = await Promise.all<GitBranch[] | undefined, GitTag[] | undefined>([\n\t\t\tinclude == null || include === 'all' || include === 'branches'\n\t\t\t\t? this.getBranches(repoPath, {\n\t\t\t\t\t\t...options,\n\t\t\t\t\t\tfilter: filter?.branches,\n\t\t\t\t\t\tsort: typeof sort === 'boolean' ? undefined : sort?.branches,\n\t\t\t\t  })\n\t\t\t\t: undefined,\n\t\t\tinclude == null || include === 'all' || include === 'tags'\n\t\t\t\t? this.getTags(repoPath, {\n\t\t\t\t\t\t...options,\n\t\t\t\t\t\tfilter: filter?.tags,\n\t\t\t\t\t\tsort: typeof sort === 'boolean' ? undefined : sort?.tags,\n\t\t\t\t  })\n\t\t\t\t: undefined,\n\t\t]);\n\n\t\tif (branches != null && tags != null) {\n\t\t\treturn [...branches.filter(b => !b.remote), ...tags, ...branches.filter(b => b.remote)];\n\t\t}\n\n\t\treturn branches ?? tags;\n\t}\n\n\t@log()\n\tasync getBranchesAndTagsTipsFn(repoPath: string | undefined, currentName?: string) {\n\t\tconst [branches, tags] = await Promise.all([this.getBranches(repoPath), this.getTags(repoPath)]);\n\n\t\tconst branchesAndTagsBySha = Arrays.groupByFilterMap(\n\t\t\t(branches as (GitBranch | GitTag)[]).concat(tags as (GitBranch | GitTag)[]),\n\t\t\tbt => bt.sha,\n\t\t\tbt => {\n\t\t\t\tif (currentName) {\n\t\t\t\t\tif (bt.name === currentName) return undefined;\n\t\t\t\t\tif (bt.refType === 'branch' && bt.getNameWithoutRemote() === currentName) {\n\t\t\t\t\t\treturn { name: bt.name, compactName: bt.getRemoteName(), type: bt.refType };\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn { name: bt.name, compactName: undefined, type: bt.refType };\n\t\t\t},\n\t\t);\n\n\t\treturn (sha: string, options?: { compact?: boolean; icons?: boolean }): string | undefined => {\n\t\t\tconst branchesAndTags = branchesAndTagsBySha.get(sha);\n\t\t\tif (branchesAndTags == null || branchesAndTags.length === 0) return undefined;\n\n\t\t\tif (!options?.compact) {\n\t\t\t\treturn branchesAndTags\n\t\t\t\t\t.map(\n\t\t\t\t\t\tbt => `${options?.icons ? `${bt.type === 'tag' ? '$(tag)' : '$(git-branch)'} ` : ''}${bt.name}`,\n\t\t\t\t\t)\n\t\t\t\t\t.join(', ');\n\t\t\t}\n\n\t\t\tif (branchesAndTags.length > 1) {\n\t\t\t\tconst [bt] = branchesAndTags;\n\t\t\t\treturn `${options?.icons ? `${bt.type === 'tag' ? '$(tag)' : '$(git-branch)'} ` : ''}${\n\t\t\t\t\tbt.compactName ?? bt.name\n\t\t\t\t}, ${GlyphChars.Ellipsis}`;\n\t\t\t}\n\n\t\t\treturn branchesAndTags\n\t\t\t\t.map(\n\t\t\t\t\tbt =>\n\t\t\t\t\t\t`${options?.icons ? `${bt.type === 'tag' ? '$(tag)' : '$(git-branch)'} ` : ''}${\n\t\t\t\t\t\t\tbt.compactName ?? bt.name\n\t\t\t\t\t\t}`,\n\t\t\t\t)\n\t\t\t\t.join(', ');\n\t\t};\n\t}\n\n\t@log()\n\tasync getChangedFilesCount(repoPath: string, ref?: string): Promise<GitDiffShortStat | undefined> {\n\t\tconst data = await Git.diff__shortstat(repoPath, ref);\n\t\tif (!data) return undefined;\n\n\t\treturn GitDiffParser.parseShortStat(data);\n\t}\n\n\t@log()\n\tasync getCommit(repoPath: string, ref: string): Promise<GitLogCommit | undefined> {\n\t\tconst log = await this.getLog(repoPath, { limit: 2, ref: ref });\n\t\tif (log == null) return undefined;\n\n\t\treturn log.commits.get(ref) ?? Iterables.first(log.commits.values());\n\t}\n\n\t@log()\n\tasync getCommitBranches(\n\t\trepoPath: string,\n\t\tref: string,\n\t\toptions?: { mode?: 'contains' | 'pointsAt'; remotes?: boolean },\n\t): Promise<string[]> {\n\t\tconst data = await Git.branch__containsOrPointsAt(repoPath, ref, options);\n\t\tif (!data) return [];\n\n\t\treturn data\n\t\t\t.split('\\n')\n\t\t\t.map(b => b.trim())\n\t\t\t.filter(<T>(i?: T): i is T => Boolean(i));\n\t}\n\n\t@log()\n\tgetAheadBehindCommitCount(\n\t\trepoPath: string,\n\t\trefs: string[],\n\t): Promise<{ ahead: number; behind: number } | undefined> {\n\t\treturn Git.rev_list__left_right(repoPath, refs);\n\t}\n\n\t@log()\n\tgetCommitCount(repoPath: string, ref: string): Promise<number | undefined> {\n\t\treturn Git.rev_list__count(repoPath, ref);\n\t}\n\n\t@log()\n\tasync getCommitForFile(\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\toptions: { ref?: string; firstIfNotFound?: boolean; range?: Range; reverse?: boolean } = {},\n\t): Promise<GitLogCommit | undefined> {\n\t\tconst log = await this.getLogForFile(repoPath, fileName, {\n\t\t\tlimit: 2,\n\t\t\tref: options.ref,\n\t\t\trange: options.range,\n\t\t\treverse: options.reverse,\n\t\t});\n\t\tif (log == null) return undefined;\n\n\t\tconst commit = options.ref ? log.commits.get(options.ref) : undefined;\n\t\tif (commit == null && !options.firstIfNotFound && options.ref) {\n\t\t\t// If the ref isn't a valid sha we will never find it, so let it fall through so we return the first\n\t\t\tif (GitRevision.isSha(options.ref) || GitRevision.isUncommitted(options.ref)) return undefined;\n\t\t}\n\n\t\treturn commit ?? Iterables.first(log.commits.values());\n\t}\n\n\t@log()\n\tasync getOldestUnpushedRefForFile(repoPath: string, fileName: string): Promise<string | undefined> {\n\t\tconst data = await Git.log__file(repoPath, fileName, '@{push}..', {\n\t\t\tformat: 'refs',\n\t\t\tordering: Container.config.advanced.commitOrdering,\n\t\t\trenames: true,\n\t\t});\n\t\tif (data == null || data.length === 0) return undefined;\n\n\t\treturn GitLogParser.parseLastRefOnly(data);\n\t}\n\n\t@log()\n\tgetConfig(key: string, repoPath?: string): Promise<string | undefined> {\n\t\treturn Git.config__get(key, repoPath);\n\t}\n\n\t@log()\n\tasync getContributors(\n\t\trepoPath: string,\n\t\toptions?: { all?: boolean; ref?: string; stats?: boolean },\n\t): Promise<GitContributor[]> {\n\t\tif (repoPath == null) return [];\n\n\t\tconst key = options?.stats ? `stats|${repoPath}` : repoPath;\n\n\t\tlet contributors = this.useCaching ? this._contributorsCache.get(key) : undefined;\n\t\tif (contributors == null) {\n\t\t\tasync function load(this: GitService) {\n\t\t\t\ttry {\n\t\t\t\t\tconst currentUser = await this.getCurrentUser(repoPath);\n\n\t\t\t\t\tconst data = await Git.log(repoPath, options?.ref, {\n\t\t\t\t\t\tall: options?.all,\n\t\t\t\t\t\tformat: options?.stats ? 'shortlog+stats' : 'shortlog',\n\t\t\t\t\t});\n\t\t\t\t\tconst shortlog = GitShortLogParser.parseFromLog(data, repoPath, currentUser);\n\n\t\t\t\t\treturn shortlog != null ? shortlog.contributors : [];\n\t\t\t\t} catch (ex) {\n\t\t\t\t\tthis._contributorsCache.delete(key);\n\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcontributors = load.call(this);\n\n\t\t\tif (this.useCaching) {\n\t\t\t\tthis._contributorsCache.set(key, contributors);\n\n\t\t\t\tif (!(await this.getRepository(repoPath))?.supportsChangeEvents) {\n\t\t\t\t\tthis._contributorsCache.delete(key);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn contributors;\n\t}\n\n\t@log()\n\t@gate()\n\tasync getCurrentUser(repoPath: string): Promise<GitUser | undefined> {\n\t\tlet user = this._userMapCache.get(repoPath);\n\t\tif (user != null) return user;\n\t\t// If we found the repo, but no user data was found just return\n\t\tif (user === null) return undefined;\n\n\t\tuser = { name: undefined, email: undefined };\n\n\t\tconst data = await Git.config__get_regex('^user\\\\.', repoPath, { local: true });\n\t\tif (data) {\n\t\t\tlet key: string;\n\t\t\tlet value: string;\n\n\t\t\tlet match;\n\t\t\tdo {\n\t\t\t\tmatch = userConfigRegex.exec(data);\n\t\t\t\tif (match == null) break;\n\n\t\t\t\t[, key, value] = match;\n\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\tuser[key as 'name' | 'email'] = ` ${value}`.substr(1);\n\t\t\t} while (true);\n\t\t} else {\n\t\t\tuser.name =\n\t\t\t\tprocess.env.GIT_AUTHOR_NAME || process.env.GIT_COMMITTER_NAME || os.userInfo()?.username || undefined;\n\t\t\tif (!user.name) {\n\t\t\t\t// If we found no user data, mark it so we won't bother trying again\n\t\t\t\tthis._userMapCache.set(repoPath, null);\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tuser.email =\n\t\t\t\tprocess.env.GIT_AUTHOR_EMAIL ||\n\t\t\t\tprocess.env.GIT_COMMITTER_EMAIL ||\n\t\t\t\tprocess.env.EMAIL ||\n\t\t\t\t`${user.name}@${os.hostname()}`;\n\t\t}\n\n\t\tconst author = `${user.name} <${user.email}>`;\n\t\t// Check if there is a mailmap for the current user\n\t\tconst mappedAuthor = await Git.check_mailmap(repoPath, author);\n\t\tif (mappedAuthor != null && mappedAuthor.length !== 0 && author !== mappedAuthor) {\n\t\t\tconst match = mappedAuthorRegex.exec(mappedAuthor);\n\t\t\tif (match != null) {\n\t\t\t\t[, user.name, user.email] = match;\n\t\t\t}\n\t\t}\n\n\t\tthis._userMapCache.set(repoPath, user);\n\t\treturn user;\n\t}\n\n\t@log()\n\tasync getDefaultBranchName(repoPath: string | undefined, remote?: string): Promise<string | undefined> {\n\t\tif (repoPath == null) return undefined;\n\n\t\tif (!remote) {\n\t\t\ttry {\n\t\t\t\tconst data = await Git.symbolic_ref(repoPath, 'HEAD');\n\t\t\t\tif (data != null) return data.trim();\n\t\t\t} catch {}\n\t\t}\n\n\t\tremote = remote ?? 'origin';\n\t\ttry {\n\t\t\tconst data = await Git.ls_remote__HEAD(repoPath, remote);\n\t\t\tif (data == null) return undefined;\n\n\t\t\tconst match = /ref:\\s(\\S+)\\s+HEAD/m.exec(data);\n\t\t\tif (match == null) return undefined;\n\n\t\t\tconst [, branch] = match;\n\t\t\treturn branch.substr('refs/heads/'.length);\n\t\t} catch {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getDiffForFile(\n\t\turi: GitUri,\n\t\tref1: string | undefined,\n\t\tref2?: string,\n\t\toriginalFileName?: string,\n\t): Promise<GitDiff | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tlet key = 'diff';\n\t\tif (ref1 != null) {\n\t\t\tkey += `:${ref1}`;\n\t\t}\n\t\tif (ref2 != null) {\n\t\t\tkey += `:${ref2}`;\n\t\t}\n\n\t\tconst doc = await Container.tracker.getOrAdd(uri);\n\t\tif (this.useCaching) {\n\t\t\tif (doc.state != null) {\n\t\t\t\tconst cachedDiff = doc.state.get<CachedDiff>(key);\n\t\t\t\tif (cachedDiff != null) {\n\t\t\t\t\tLogger.debug(cc, `Cache hit: '${key}'`);\n\t\t\t\t\treturn cachedDiff.item;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tLogger.debug(cc, `Cache miss: '${key}'`);\n\n\t\t\tif (doc.state == null) {\n\t\t\t\tdoc.state = new GitDocumentState(doc.key);\n\t\t\t}\n\t\t}\n\n\t\tconst promise = this.getDiffForFileCore(\n\t\t\turi.repoPath,\n\t\t\turi.fsPath,\n\t\t\tref1,\n\t\t\tref2,\n\t\t\toriginalFileName,\n\t\t\t{ encoding: GitService.getEncoding(uri) },\n\t\t\tdoc,\n\t\t\tkey,\n\t\t\tcc,\n\t\t);\n\n\t\tif (doc.state != null) {\n\t\t\tLogger.debug(cc, `Cache add: '${key}'`);\n\n\t\t\tconst value: CachedDiff = {\n\t\t\t\titem: promise as Promise<GitDiff>,\n\t\t\t};\n\t\t\tdoc.state.set<CachedDiff>(key, value);\n\t\t}\n\n\t\treturn promise;\n\t}\n\n\tprivate async getDiffForFileCore(\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\tref1: string | undefined,\n\t\tref2: string | undefined,\n\t\toriginalFileName: string | undefined,\n\t\toptions: { encoding?: string },\n\t\tdocument: TrackedDocument<GitDocumentState>,\n\t\tkey: string,\n\t\tcc: LogCorrelationContext | undefined,\n\t): Promise<GitDiff | undefined> {\n\t\tconst [file, root] = Git.splitPath(fileName, repoPath, false);\n\n\t\ttry {\n\t\t\t// let data;\n\t\t\t// if (ref2 == null && ref1 != null && !GitRevision.isUncommittedStaged(ref1)) {\n\t\t\t// \tdata = await Git.show__diff(root, file, ref1, originalFileName, {\n\t\t\t// \t\tsimilarityThreshold: Container.config.advanced.similarityThreshold,\n\t\t\t// \t});\n\t\t\t// } else {\n\t\t\tconst data = await Git.diff(root, file, ref1, ref2, {\n\t\t\t\t...options,\n\t\t\t\tfilters: ['M'],\n\t\t\t\tlinesOfContext: 0,\n\t\t\t\trenames: true,\n\t\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold,\n\t\t\t});\n\t\t\t// }\n\n\t\t\tconst diff = GitDiffParser.parse(data);\n\t\t\treturn diff;\n\t\t} catch (ex) {\n\t\t\t// Trap and cache expected diff errors\n\t\t\tif (document.state != null) {\n\t\t\t\tconst msg = ex?.toString() ?? '';\n\t\t\t\tLogger.debug(cc, `Cache replace (with empty promise): '${key}'`);\n\n\t\t\t\tconst value: CachedDiff = {\n\t\t\t\t\titem: emptyPromise as Promise<GitDiff>,\n\t\t\t\t\terrorMessage: msg,\n\t\t\t\t};\n\t\t\t\tdocument.state.set<CachedDiff>(key, value);\n\n\t\t\t\treturn emptyPromise as Promise<GitDiff>;\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log({\n\t\targs: {\n\t\t\t1: _contents => '<contents>',\n\t\t},\n\t})\n\tasync getDiffForFileContents(\n\t\turi: GitUri,\n\t\tref: string,\n\t\tcontents: string,\n\t\toriginalFileName?: string,\n\t): Promise<GitDiff | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tconst key = `diff:${Strings.sha1(contents)}`;\n\n\t\tconst doc = await Container.tracker.getOrAdd(uri);\n\t\tif (this.useCaching) {\n\t\t\tif (doc.state != null) {\n\t\t\t\tconst cachedDiff = doc.state.get<CachedDiff>(key);\n\t\t\t\tif (cachedDiff != null) {\n\t\t\t\t\tLogger.debug(cc, `Cache hit: ${key}`);\n\t\t\t\t\treturn cachedDiff.item;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tLogger.debug(cc, `Cache miss: ${key}`);\n\n\t\t\tif (doc.state == null) {\n\t\t\t\tdoc.state = new GitDocumentState(doc.key);\n\t\t\t}\n\t\t}\n\n\t\tconst promise = this.getDiffForFileContentsCore(\n\t\t\turi.repoPath,\n\t\t\turi.fsPath,\n\t\t\tref,\n\t\t\tcontents,\n\t\t\toriginalFileName,\n\t\t\t{ encoding: GitService.getEncoding(uri) },\n\t\t\tdoc,\n\t\t\tkey,\n\t\t\tcc,\n\t\t);\n\n\t\tif (doc.state != null) {\n\t\t\tLogger.debug(cc, `Cache add: '${key}'`);\n\n\t\t\tconst value: CachedDiff = {\n\t\t\t\titem: promise as Promise<GitDiff>,\n\t\t\t};\n\t\t\tdoc.state.set<CachedDiff>(key, value);\n\t\t}\n\n\t\treturn promise;\n\t}\n\n\tasync getDiffForFileContentsCore(\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\tref: string,\n\t\tcontents: string,\n\t\toriginalFileName: string | undefined,\n\t\toptions: { encoding?: string },\n\t\tdocument: TrackedDocument<GitDocumentState>,\n\t\tkey: string,\n\t\tcc: LogCorrelationContext | undefined,\n\t): Promise<GitDiff | undefined> {\n\t\tconst [file, root] = Git.splitPath(fileName, repoPath, false);\n\n\t\ttry {\n\t\t\tconst data = await Git.diff__contents(root, file, ref, contents, {\n\t\t\t\t...options,\n\t\t\t\tfilters: ['M'],\n\t\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold,\n\t\t\t});\n\n\t\t\tconst diff = GitDiffParser.parse(data);\n\t\t\treturn diff;\n\t\t} catch (ex) {\n\t\t\t// Trap and cache expected diff errors\n\t\t\tif (document.state != null) {\n\t\t\t\tconst msg = ex?.toString() ?? '';\n\t\t\t\tLogger.debug(cc, `Cache replace (with empty promise): '${key}'`);\n\n\t\t\t\tconst value: CachedDiff = {\n\t\t\t\t\titem: emptyPromise as Promise<GitDiff>,\n\t\t\t\t\terrorMessage: msg,\n\t\t\t\t};\n\t\t\t\tdocument.state.set<CachedDiff>(key, value);\n\n\t\t\t\treturn emptyPromise as Promise<GitDiff>;\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getDiffForLine(\n\t\turi: GitUri,\n\t\teditorLine: number, // editor lines are 0-based\n\t\tref1: string | undefined,\n\t\tref2?: string,\n\t\toriginalFileName?: string,\n\t): Promise<GitDiffHunkLine | undefined> {\n\t\ttry {\n\t\t\tconst diff = await this.getDiffForFile(uri, ref1, ref2, originalFileName);\n\t\t\tif (diff == null) return undefined;\n\n\t\t\tconst line = editorLine + 1;\n\t\t\tconst hunk = diff.hunks.find(c => c.current.position.start <= line && c.current.position.end >= line);\n\t\t\tif (hunk == null) return undefined;\n\n\t\t\treturn hunk.lines[line - hunk.current.position.start];\n\t\t} catch (ex) {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getDiffStatus(\n\t\trepoPath: string,\n\t\tref1?: string,\n\t\tref2?: string,\n\t\toptions: { filters?: GitDiffFilter[]; similarityThreshold?: number } = {},\n\t): Promise<GitFile[] | undefined> {\n\t\ttry {\n\t\t\tconst data = await Git.diff__name_status(repoPath, ref1, ref2, {\n\t\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold,\n\t\t\t\t...options,\n\t\t\t});\n\t\t\tconst files = GitDiffParser.parseNameStatus(data, repoPath);\n\t\t\treturn files == null || files.length === 0 ? undefined : files;\n\t\t} catch (ex) {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getFileStatusForCommit(repoPath: string, fileName: string, ref: string): Promise<GitFile | undefined> {\n\t\tif (ref === GitRevision.deletedOrMissing || GitRevision.isUncommitted(ref)) return undefined;\n\n\t\tconst data = await Git.show__name_status(repoPath, fileName, ref);\n\t\tif (!data) return undefined;\n\n\t\tconst files = GitDiffParser.parseNameStatus(data, repoPath);\n\t\tif (files == null || files.length === 0) return undefined;\n\n\t\treturn files[0];\n\t}\n\n\t@log()\n\tasync getLog(\n\t\trepoPath: string,\n\t\t{\n\t\t\tref,\n\t\t\t...options\n\t\t}: {\n\t\t\tall?: boolean;\n\t\t\tauthors?: string[];\n\t\t\tlimit?: number;\n\t\t\tmerges?: boolean;\n\t\t\tordering?: string | null;\n\t\t\tref?: string;\n\t\t\treverse?: boolean;\n\t\t\tsince?: string;\n\t\t} = {},\n\t): Promise<GitLog | undefined> {\n\t\tconst limit = options.limit ?? Container.config.advanced.maxListItems ?? 0;\n\n\t\ttry {\n\t\t\tconst data = await Git.log(repoPath, ref, {\n\t\t\t\t...options,\n\t\t\t\tlimit: limit,\n\t\t\t\tmerges: options.merges == null ? true : options.merges,\n\t\t\t\tordering: options.ordering ?? Container.config.advanced.commitOrdering,\n\t\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold,\n\t\t\t});\n\t\t\tconst log = GitLogParser.parse(\n\t\t\t\tdata,\n\t\t\t\tGitCommitType.Log,\n\t\t\t\trepoPath,\n\t\t\t\tundefined,\n\t\t\t\tref,\n\t\t\t\tawait this.getCurrentUser(repoPath),\n\t\t\t\tlimit,\n\t\t\t\toptions.reverse!,\n\t\t\t\tundefined,\n\t\t\t);\n\n\t\t\tif (log != null) {\n\t\t\t\tconst opts = { ...options, ref: ref };\n\t\t\t\tlog.query = (limit: number | undefined) => this.getLog(repoPath, { ...opts, limit: limit });\n\t\t\t\tif (log.hasMore) {\n\t\t\t\t\tlog.more = this.getLogMoreFn(log, opts);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn log;\n\t\t} catch (ex) {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getLogRefsOnly(\n\t\trepoPath: string,\n\t\t{\n\t\t\tref,\n\t\t\t...options\n\t\t}: {\n\t\t\tauthors?: string[];\n\t\t\tlimit?: number;\n\t\t\tmerges?: boolean;\n\t\t\tordering?: string | null;\n\t\t\tref?: string;\n\t\t\treverse?: boolean;\n\t\t\tsince?: string;\n\t\t} = {},\n\t): Promise<Set<string> | undefined> {\n\t\tconst limit = options.limit ?? Container.config.advanced.maxListItems ?? 0;\n\n\t\ttry {\n\t\t\tconst data = await Git.log(repoPath, ref, {\n\t\t\t\tauthors: options.authors,\n\t\t\t\tformat: 'refs',\n\t\t\t\tlimit: limit,\n\t\t\t\tmerges: options.merges == null ? true : options.merges,\n\t\t\t\treverse: options.reverse,\n\t\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold,\n\t\t\t\tsince: options.since,\n\t\t\t\tordering: options.ordering ?? Container.config.advanced.commitOrdering,\n\t\t\t});\n\t\t\tconst commits = GitLogParser.parseRefsOnly(data);\n\t\t\treturn new Set(commits);\n\t\t} catch (ex) {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprivate getLogMoreFn(\n\t\tlog: GitLog,\n\t\toptions: {\n\t\t\tauthors?: string[];\n\t\t\tlimit?: number;\n\t\t\tmerges?: boolean;\n\t\t\tordering?: string | null;\n\t\t\tref?: string;\n\t\t\treverse?: boolean;\n\t\t},\n\t): (limit: number | { until: string } | undefined) => Promise<GitLog> {\n\t\treturn async (limit: number | { until: string } | undefined) => {\n\t\t\tconst moreUntil = limit != null && typeof limit === 'object' ? limit.until : undefined;\n\t\t\tlet moreLimit = typeof limit === 'number' ? limit : undefined;\n\n\t\t\tif (moreUntil && Iterables.some(log.commits.values(), c => c.ref === moreUntil)) {\n\t\t\t\treturn log;\n\t\t\t}\n\n\t\t\tmoreLimit = moreLimit ?? Container.config.advanced.maxSearchItems ?? 0;\n\n\t\t\t// If the log is for a range, then just get everything prior + more\n\t\t\tif (GitRevision.isRange(log.sha)) {\n\t\t\t\tconst moreLog = await this.getLog(log.repoPath, {\n\t\t\t\t\t...options,\n\t\t\t\t\tlimit: moreLimit === 0 ? 0 : (options.limit ?? 0) + moreLimit,\n\t\t\t\t});\n\t\t\t\t// If we can't find any more, assume we have everything\n\t\t\t\tif (moreLog == null) return { ...log, hasMore: false };\n\n\t\t\t\treturn moreLog;\n\t\t\t}\n\n\t\t\tconst ref = Iterables.last(log.commits.values())?.ref;\n\t\t\tconst moreLog = await this.getLog(log.repoPath, {\n\t\t\t\t...options,\n\t\t\t\tlimit: moreUntil == null ? moreLimit : 0,\n\t\t\t\tref: moreUntil == null ? `${ref}^` : `${moreUntil}^..${ref}^`,\n\t\t\t});\n\t\t\t// If we can't find any more, assume we have everything\n\t\t\tif (moreLog == null) return { ...log, hasMore: false };\n\n\t\t\t// Merge authors\n\t\t\tconst authors = new Map([...log.authors]);\n\t\t\tfor (const [key, addAuthor] of moreLog.authors) {\n\t\t\t\tconst author = authors.get(key);\n\t\t\t\tif (author == null) {\n\t\t\t\t\tauthors.set(key, addAuthor);\n\t\t\t\t} else {\n\t\t\t\t\tauthor.lineCount += addAuthor.lineCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst commits = new Map([...log.commits, ...moreLog.commits]);\n\n\t\t\tconst mergedLog: GitLog = {\n\t\t\t\trepoPath: log.repoPath,\n\t\t\t\tauthors: authors,\n\t\t\t\tcommits: commits,\n\t\t\t\tsha: log.sha,\n\t\t\t\trange: undefined,\n\t\t\t\tcount: commits.size,\n\t\t\t\tlimit: moreUntil == null ? (log.limit ?? 0) + moreLimit : undefined,\n\t\t\t\thasMore: moreUntil == null ? moreLog.hasMore : true,\n\t\t\t\tquery: (limit: number | undefined) => this.getLog(log.repoPath, { ...options, limit: limit }),\n\t\t\t};\n\t\t\tmergedLog.more = this.getLogMoreFn(mergedLog, options);\n\n\t\t\treturn mergedLog;\n\t\t};\n\t}\n\n\t@log()\n\tasync getLogForSearch(\n\t\trepoPath: string,\n\t\tsearch: SearchPattern,\n\t\toptions: { limit?: number; ordering?: string | null; skip?: number } = {},\n\t): Promise<GitLog | undefined> {\n\t\tsearch = { matchAll: false, matchCase: false, matchRegex: true, ...search };\n\n\t\ttry {\n\t\t\tconst limit = options.limit ?? Container.config.advanced.maxSearchItems ?? 0;\n\t\t\tconst similarityThreshold = Container.config.advanced.similarityThreshold;\n\n\t\t\tconst operations = SearchPattern.parseSearchOperations(search.pattern);\n\n\t\t\tconst searchArgs = new Set<string>();\n\t\t\tconst files: string[] = [];\n\n\t\t\tlet useShow = false;\n\n\t\t\tlet op;\n\t\t\tlet values = operations.get('commit:');\n\t\t\tif (values != null) {\n\t\t\t\tuseShow = true;\n\n\t\t\t\tsearchArgs.add('-m');\n\t\t\t\tsearchArgs.add(`-M${similarityThreshold == null ? '' : `${similarityThreshold}%`}`);\n\t\t\t\tfor (const value of values) {\n\t\t\t\t\tsearchArgs.add(value.replace(doubleQuoteRegex, ''));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsearchArgs.add(`-M${similarityThreshold == null ? '' : `${similarityThreshold}%`}`);\n\t\t\t\tsearchArgs.add('--all');\n\t\t\t\tsearchArgs.add('--full-history');\n\t\t\t\tsearchArgs.add(search.matchRegex ? '--extended-regexp' : '--fixed-strings');\n\t\t\t\tif (search.matchRegex && !search.matchCase) {\n\t\t\t\t\tsearchArgs.add('--regexp-ignore-case');\n\t\t\t\t}\n\n\t\t\t\tfor ([op, values] of operations.entries()) {\n\t\t\t\t\tswitch (op) {\n\t\t\t\t\t\tcase 'message:':\n\t\t\t\t\t\t\tsearchArgs.add('-m');\n\t\t\t\t\t\t\tif (search.matchAll) {\n\t\t\t\t\t\t\t\tsearchArgs.add('--all-match');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (const value of values) {\n\t\t\t\t\t\t\t\tsearchArgs.add(`--grep=${value.replace(doubleQuoteRegex, '\\\\b')}`);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'author:':\n\t\t\t\t\t\t\tsearchArgs.add('-m');\n\t\t\t\t\t\t\tfor (const value of values) {\n\t\t\t\t\t\t\t\tsearchArgs.add(`--author=${value.replace(doubleQuoteRegex, '\\\\b')}`);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'change:':\n\t\t\t\t\t\t\tfor (const value of values) {\n\t\t\t\t\t\t\t\tsearchArgs.add(`-G${value}`);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'file:':\n\t\t\t\t\t\t\tfor (const value of values) {\n\t\t\t\t\t\t\t\tfiles.push(value.replace(doubleQuoteRegex, ''));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst args = [...searchArgs.values(), '--'];\n\t\t\tif (files.length !== 0) {\n\t\t\t\targs.push(...files);\n\t\t\t}\n\n\t\t\tconst data = await Git.log__search(repoPath, args, {\n\t\t\t\tordering: Container.config.advanced.commitOrdering,\n\t\t\t\t...options,\n\t\t\t\tlimit: limit,\n\t\t\t\tuseShow: useShow,\n\t\t\t});\n\t\t\tconst log = GitLogParser.parse(\n\t\t\t\tdata,\n\t\t\t\tGitCommitType.Log,\n\t\t\t\trepoPath,\n\t\t\t\tundefined,\n\t\t\t\tundefined,\n\t\t\t\tawait this.getCurrentUser(repoPath),\n\t\t\t\tlimit,\n\t\t\t\tfalse,\n\t\t\t\tundefined,\n\t\t\t);\n\n\t\t\tif (log != null) {\n\t\t\t\tlog.query = (limit: number | undefined) =>\n\t\t\t\t\tthis.getLogForSearch(repoPath, search, { ...options, limit: limit });\n\t\t\t\tif (log.hasMore) {\n\t\t\t\t\tlog.more = this.getLogForSearchMoreFn(log, search, options);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn log;\n\t\t} catch (ex) {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprivate getLogForSearchMoreFn(\n\t\tlog: GitLog,\n\t\tsearch: SearchPattern,\n\t\toptions: { limit?: number; ordering?: string | null },\n\t): (limit: number | undefined) => Promise<GitLog> {\n\t\treturn async (limit: number | undefined) => {\n\t\t\tlimit = limit ?? Container.config.advanced.maxSearchItems ?? 0;\n\n\t\t\tconst moreLog = await this.getLogForSearch(log.repoPath, search, {\n\t\t\t\t...options,\n\t\t\t\tlimit: limit,\n\t\t\t\tskip: log.count,\n\t\t\t});\n\t\t\tif (moreLog == null) {\n\t\t\t\t// If we can't find any more, assume we have everything\n\t\t\t\treturn { ...log, hasMore: false };\n\t\t\t}\n\n\t\t\t// Merge authors\n\t\t\tconst authors = new Map([...log.authors]);\n\t\t\tfor (const [key, addAuthor] of moreLog.authors) {\n\t\t\t\tconst author = authors.get(key);\n\t\t\t\tif (author == null) {\n\t\t\t\t\tauthors.set(key, addAuthor);\n\t\t\t\t} else {\n\t\t\t\t\tauthor.lineCount += addAuthor.lineCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst commits = new Map([...log.commits, ...moreLog.commits]);\n\n\t\t\tconst mergedLog: GitLog = {\n\t\t\t\trepoPath: log.repoPath,\n\t\t\t\tauthors: authors,\n\t\t\t\tcommits: commits,\n\t\t\t\tsha: log.sha,\n\t\t\t\trange: log.range,\n\t\t\t\tcount: commits.size,\n\t\t\t\tlimit: (log.limit ?? 0) + limit,\n\t\t\t\thasMore: moreLog.hasMore,\n\t\t\t\tquery: (limit: number | undefined) =>\n\t\t\t\t\tthis.getLogForSearch(log.repoPath, search, { ...options, limit: limit }),\n\t\t\t};\n\t\t\tmergedLog.more = this.getLogForSearchMoreFn(mergedLog, search, options);\n\n\t\t\treturn mergedLog;\n\t\t};\n\t}\n\t@log()\n\tasync getLogForFile(\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\toptions: {\n\t\t\tall?: boolean;\n\t\t\tlimit?: number;\n\t\t\tordering?: string | null;\n\t\t\trange?: Range;\n\t\t\tref?: string;\n\t\t\trenames?: boolean;\n\t\t\treverse?: boolean;\n\t\t\tsince?: string;\n\t\t\tskip?: number;\n\t\t} = {},\n\t): Promise<GitLog | undefined> {\n\t\tif (repoPath != null && repoPath === Strings.normalizePath(fileName)) {\n\t\t\tthrow new Error(`File name cannot match the repository path; fileName=${fileName}`);\n\t\t}\n\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\toptions = { reverse: false, ...options };\n\n\t\tif (options.renames == null) {\n\t\t\toptions.renames = Container.config.advanced.fileHistoryFollowsRenames;\n\t\t}\n\n\t\tlet key = 'log';\n\t\tif (options.ref != null) {\n\t\t\tkey += `:${options.ref}`;\n\t\t}\n\n\t\tif (options.all == null) {\n\t\t\toptions.all = Container.config.advanced.fileHistoryShowAllBranches;\n\t\t}\n\t\tif (options.all) {\n\t\t\tkey += ':all';\n\t\t}\n\n\t\toptions.limit = options.limit == null ? Container.config.advanced.maxListItems || 0 : options.limit;\n\t\tif (options.limit) {\n\t\t\tkey += `:n${options.limit}`;\n\t\t}\n\n\t\tif (options.renames) {\n\t\t\tkey += ':follow';\n\t\t}\n\n\t\tif (options.reverse) {\n\t\t\tkey += ':reverse';\n\t\t}\n\n\t\tif (options.since) {\n\t\t\tkey += `:since=${options.since}`;\n\t\t}\n\n\t\tif (options.skip) {\n\t\t\tkey += `:skip${options.skip}`;\n\t\t}\n\n\t\tconst doc = await Container.tracker.getOrAdd(GitUri.fromFile(fileName, repoPath!, options.ref));\n\t\tif (this.useCaching && options.range == null) {\n\t\t\tif (doc.state != null) {\n\t\t\t\tconst cachedLog = doc.state.get<CachedLog>(key);\n\t\t\t\tif (cachedLog != null) {\n\t\t\t\t\tLogger.debug(cc, `Cache hit: '${key}'`);\n\t\t\t\t\treturn cachedLog.item;\n\t\t\t\t}\n\n\t\t\t\tif (options.ref != null || options.limit != null) {\n\t\t\t\t\t// Since we are looking for partial log, see if we have the log of the whole file\n\t\t\t\t\tconst cachedLog = doc.state.get<CachedLog>(\n\t\t\t\t\t\t`log${options.renames ? ':follow' : emptyStr}${options.reverse ? ':reverse' : emptyStr}`,\n\t\t\t\t\t);\n\t\t\t\t\tif (cachedLog != null) {\n\t\t\t\t\t\tif (options.ref == null) {\n\t\t\t\t\t\t\tLogger.debug(cc, `Cache hit: ~'${key}'`);\n\t\t\t\t\t\t\treturn cachedLog.item;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tLogger.debug(cc, `Cache ?: '${key}'`);\n\t\t\t\t\t\tlet log = await cachedLog.item;\n\t\t\t\t\t\tif (log != null && !log.hasMore && log.commits.has(options.ref)) {\n\t\t\t\t\t\t\tLogger.debug(cc, `Cache hit: '${key}'`);\n\n\t\t\t\t\t\t\t// Create a copy of the log starting at the requested commit\n\t\t\t\t\t\t\tlet skip = true;\n\t\t\t\t\t\t\tlet i = 0;\n\t\t\t\t\t\t\tconst authors = new Map<string, GitAuthor>();\n\t\t\t\t\t\t\tconst commits = new Map(\n\t\t\t\t\t\t\t\tIterables.filterMap<[string, GitLogCommit], [string, GitLogCommit]>(\n\t\t\t\t\t\t\t\t\tlog.commits.entries(),\n\t\t\t\t\t\t\t\t\t([ref, c]) => {\n\t\t\t\t\t\t\t\t\t\tif (skip) {\n\t\t\t\t\t\t\t\t\t\t\tif (ref !== options.ref) return undefined;\n\t\t\t\t\t\t\t\t\t\t\tskip = false;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t\t\tif (options.limit != null && i > options.limit) {\n\t\t\t\t\t\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tauthors.set(c.author, log.authors.get(c.author)!);\n\t\t\t\t\t\t\t\t\t\treturn [ref, c];\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tconst opts = { ...options };\n\t\t\t\t\t\t\tlog = {\n\t\t\t\t\t\t\t\t...log,\n\t\t\t\t\t\t\t\tlimit: options.limit,\n\t\t\t\t\t\t\t\tcount: commits.size,\n\t\t\t\t\t\t\t\tcommits: commits,\n\t\t\t\t\t\t\t\tauthors: authors,\n\t\t\t\t\t\t\t\tquery: (limit: number | undefined) =>\n\t\t\t\t\t\t\t\t\tthis.getLogForFile(repoPath, fileName, { ...opts, limit: limit }),\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\treturn log;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tLogger.debug(cc, `Cache miss: '${key}'`);\n\n\t\t\tif (doc.state == null) {\n\t\t\t\tdoc.state = new GitDocumentState(doc.key);\n\t\t\t}\n\t\t}\n\n\t\tconst promise = this.getLogForFileCore(repoPath, fileName, options, doc, key, cc);\n\n\t\tif (doc.state != null && options.range == null) {\n\t\t\tLogger.debug(cc, `Cache add: '${key}'`);\n\n\t\t\tconst value: CachedLog = {\n\t\t\t\titem: promise as Promise<GitLog>,\n\t\t\t};\n\t\t\tdoc.state.set<CachedLog>(key, value);\n\t\t}\n\n\t\treturn promise;\n\t}\n\n\tprivate async getLogForFileCore(\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\t{\n\t\t\tref,\n\t\t\trange,\n\t\t\t...options\n\t\t}: {\n\t\t\tall?: boolean;\n\t\t\tlimit?: number;\n\t\t\tordering?: string | null;\n\t\t\trange?: Range;\n\t\t\tref?: string;\n\t\t\trenames?: boolean;\n\t\t\treverse?: boolean;\n\t\t\tsince?: string;\n\t\t\tskip?: number;\n\t\t},\n\t\tdocument: TrackedDocument<GitDocumentState>,\n\t\tkey: string,\n\t\tcc: LogCorrelationContext | undefined,\n\t): Promise<GitLog | undefined> {\n\t\tif (!(await this.isTracked(fileName, repoPath, { ref: ref }))) {\n\t\t\tLogger.log(cc, `Skipping log; '${fileName}' is not tracked`);\n\t\t\treturn emptyPromise as Promise<GitLog>;\n\t\t}\n\n\t\tconst [file, root] = Git.splitPath(fileName, repoPath, false);\n\n\t\ttry {\n\t\t\tif (range != null && range.start.line > range.end.line) {\n\t\t\t\trange = new Range(range.end, range.start);\n\t\t\t}\n\n\t\t\tconst data = await Git.log__file(root, file, ref, {\n\t\t\t\tordering: Container.config.advanced.commitOrdering,\n\t\t\t\t...options,\n\t\t\t\tfirstParent: options.renames,\n\t\t\t\tstartLine: range == null ? undefined : range.start.line + 1,\n\t\t\t\tendLine: range == null ? undefined : range.end.line + 1,\n\t\t\t});\n\t\t\tconst log = GitLogParser.parse(\n\t\t\t\tdata,\n\t\t\t\t// If this is the log of a folder, parse it as a normal log rather than a file log\n\t\t\t\tisFolderGlob(file) ? GitCommitType.Log : GitCommitType.LogFile,\n\t\t\t\troot,\n\t\t\t\tfile,\n\t\t\t\tref,\n\t\t\t\tawait this.getCurrentUser(root),\n\t\t\t\toptions.limit,\n\t\t\t\toptions.reverse!,\n\t\t\t\trange,\n\t\t\t);\n\n\t\t\tif (log != null) {\n\t\t\t\tconst opts = { ...options, ref: ref, range: range };\n\t\t\t\tlog.query = (limit: number | undefined) =>\n\t\t\t\t\tthis.getLogForFile(repoPath, fileName, { ...opts, limit: limit });\n\t\t\t\tif (log.hasMore) {\n\t\t\t\t\tlog.more = this.getLogForFileMoreFn(log, fileName, opts);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn log;\n\t\t} catch (ex) {\n\t\t\t// Trap and cache expected log errors\n\t\t\tif (document.state != null && range == null && !options.reverse) {\n\t\t\t\tconst msg: string = ex?.toString() ?? '';\n\t\t\t\tLogger.debug(cc, `Cache replace (with empty promise): '${key}'`);\n\n\t\t\t\tconst value: CachedLog = {\n\t\t\t\t\titem: emptyPromise as Promise<GitLog>,\n\t\t\t\t\terrorMessage: msg,\n\t\t\t\t};\n\t\t\t\tdocument.state.set<CachedLog>(key, value);\n\n\t\t\t\treturn emptyPromise as Promise<GitLog>;\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprivate getLogForFileMoreFn(\n\t\tlog: GitLog,\n\t\tfileName: string,\n\t\toptions: {\n\t\t\tall?: boolean;\n\t\t\tlimit?: number;\n\t\t\tordering?: string | null;\n\t\t\trange?: Range;\n\t\t\tref?: string;\n\t\t\trenames?: boolean;\n\t\t\treverse?: boolean;\n\t\t},\n\t): (limit: number | { until: string } | undefined) => Promise<GitLog> {\n\t\treturn async (limit: number | { until: string } | undefined) => {\n\t\t\tconst moreUntil = limit != null && typeof limit === 'object' ? limit.until : undefined;\n\t\t\tlet moreLimit = typeof limit === 'number' ? limit : undefined;\n\n\t\t\tif (moreUntil && Iterables.some(log.commits.values(), c => c.ref === moreUntil)) {\n\t\t\t\treturn log;\n\t\t\t}\n\n\t\t\tmoreLimit = moreLimit ?? Container.config.advanced.maxSearchItems ?? 0;\n\n\t\t\tconst ref = Iterables.last(log.commits.values())?.ref;\n\t\t\tconst moreLog = await this.getLogForFile(log.repoPath, fileName, {\n\t\t\t\t...options,\n\t\t\t\tlimit: moreUntil == null ? moreLimit : 0,\n\t\t\t\tref: options.all ? undefined : moreUntil == null ? `${ref}^` : `${moreUntil}^..${ref}^`,\n\t\t\t\tskip: options.all ? log.count : undefined,\n\t\t\t});\n\t\t\tif (moreLog == null) {\n\t\t\t\t// If we can't find any more, assume we have everything\n\t\t\t\treturn { ...log, hasMore: false };\n\t\t\t}\n\n\t\t\t// Merge authors\n\t\t\tconst authors = new Map([...log.authors]);\n\t\t\tfor (const [key, addAuthor] of moreLog.authors) {\n\t\t\t\tconst author = authors.get(key);\n\t\t\t\tif (author == null) {\n\t\t\t\t\tauthors.set(key, addAuthor);\n\t\t\t\t} else {\n\t\t\t\t\tauthor.lineCount += addAuthor.lineCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst commits = new Map([...log.commits, ...moreLog.commits]);\n\n\t\t\tconst mergedLog: GitLog = {\n\t\t\t\trepoPath: log.repoPath,\n\t\t\t\tauthors: authors,\n\t\t\t\tcommits: commits,\n\t\t\t\tsha: log.sha,\n\t\t\t\trange: log.range,\n\t\t\t\tcount: commits.size,\n\t\t\t\tlimit: moreUntil == null ? (log.limit ?? 0) + moreLimit : undefined,\n\t\t\t\thasMore: moreUntil == null ? moreLog.hasMore : true,\n\t\t\t\tquery: (limit: number | undefined) =>\n\t\t\t\t\tthis.getLogForFile(log.repoPath, fileName, { ...options, limit: limit }),\n\t\t\t};\n\n\t\t\tif (options.renames) {\n\t\t\t\tconst renamed = Iterables.find(\n\t\t\t\t\tmoreLog.commits.values(),\n\t\t\t\t\tc => Boolean(c.originalFileName) && c.originalFileName !== fileName,\n\t\t\t\t);\n\t\t\t\tif (renamed != null) {\n\t\t\t\t\tfileName = renamed.originalFileName!;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tmergedLog.more = this.getLogForFileMoreFn(mergedLog, fileName, options);\n\n\t\t\treturn mergedLog;\n\t\t};\n\t}\n\n\t@log()\n\tasync getMergeBase(repoPath: string, ref1: string, ref2: string, options: { forkPoint?: boolean } = {}) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\ttry {\n\t\t\tconst data = await Git.merge_base(repoPath, ref1, ref2, options);\n\t\t\tif (data == null) return undefined;\n\n\t\t\treturn data.split('\\n')[0].trim() || undefined;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@gate()\n\t@log()\n\tasync getMergeStatus(repoPath: string): Promise<GitMergeStatus | undefined> {\n\t\tlet status = this.useCaching ? this._mergeStatusCache.get(repoPath) : undefined;\n\t\tif (status === undefined) {\n\t\t\tconst merge = await Git.rev_parse__verify(repoPath, 'MERGE_HEAD');\n\t\t\tif (merge != null) {\n\t\t\t\tconst [branch, mergeBase, possibleSourceBranches] = await Promise.all([\n\t\t\t\t\tthis.getBranch(repoPath),\n\t\t\t\t\tthis.getMergeBase(repoPath, 'MERGE_HEAD', 'HEAD'),\n\t\t\t\t\tthis.getCommitBranches(repoPath, 'MERGE_HEAD', { mode: 'pointsAt' }),\n\t\t\t\t]);\n\n\t\t\t\tstatus = {\n\t\t\t\t\ttype: 'merge',\n\t\t\t\t\trepoPath: repoPath,\n\t\t\t\t\tmergeBase: mergeBase,\n\t\t\t\t\tHEAD: GitReference.create(merge, repoPath, { refType: 'revision' }),\n\t\t\t\t\tcurrent: GitReference.fromBranch(branch!),\n\t\t\t\t\tincoming:\n\t\t\t\t\t\tpossibleSourceBranches?.length === 1\n\t\t\t\t\t\t\t? GitReference.create(possibleSourceBranches[0], repoPath, {\n\t\t\t\t\t\t\t\t\trefType: 'branch',\n\t\t\t\t\t\t\t\t\tname: possibleSourceBranches[0],\n\t\t\t\t\t\t\t\t\tremote: false,\n\t\t\t\t\t\t\t  })\n\t\t\t\t\t\t\t: undefined,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (this.useCaching) {\n\t\t\t\tthis._mergeStatusCache.set(repoPath, status ?? null);\n\n\t\t\t\tif (!(await this.getRepository(repoPath))?.supportsChangeEvents) {\n\t\t\t\t\tthis._mergeStatusCache.delete(repoPath);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn status ?? undefined;\n\t}\n\n\t@gate()\n\t@log()\n\tasync getRebaseStatus(repoPath: string): Promise<GitRebaseStatus | undefined> {\n\t\tlet status = this.useCaching ? this._rebaseStatusCache.get(repoPath) : undefined;\n\t\tif (status === undefined) {\n\t\t\tconst rebase = await Git.rev_parse__verify(repoPath, 'REBASE_HEAD');\n\t\t\tif (rebase != null) {\n\t\t\t\tlet [mergeBase, branch, onto, stepsNumber, stepsMessage, stepsTotal] = await Promise.all([\n\t\t\t\t\tthis.getMergeBase(repoPath, 'REBASE_HEAD', 'HEAD'),\n\t\t\t\t\tGit.readDotGitFile(repoPath, ['rebase-merge', 'head-name']),\n\t\t\t\t\tGit.readDotGitFile(repoPath, ['rebase-merge', 'onto']),\n\t\t\t\t\tGit.readDotGitFile(repoPath, ['rebase-merge', 'msgnum'], { numeric: true }),\n\t\t\t\t\tGit.readDotGitFile(repoPath, ['rebase-merge', 'message'], { throw: true }).catch(() =>\n\t\t\t\t\t\tGit.readDotGitFile(repoPath, ['rebase-merge', 'message-squashed']),\n\t\t\t\t\t),\n\t\t\t\t\tGit.readDotGitFile(repoPath, ['rebase-merge', 'end'], { numeric: true }),\n\t\t\t\t]);\n\n\t\t\t\tif (branch == null || onto == null) return undefined;\n\n\t\t\t\tif (branch.startsWith('refs/heads/')) {\n\t\t\t\t\tbranch = branch.substr(11).trim();\n\t\t\t\t}\n\n\t\t\t\tconst possibleSourceBranches = await this.getCommitBranches(repoPath, onto, { mode: 'pointsAt' });\n\n\t\t\t\tlet possibleSourceBranch: string | undefined;\n\t\t\t\tfor (const b of possibleSourceBranches) {\n\t\t\t\t\tif (b.startsWith('(no branch, rebasing')) continue;\n\n\t\t\t\t\tpossibleSourceBranch = b;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tstatus = {\n\t\t\t\t\ttype: 'rebase',\n\t\t\t\t\trepoPath: repoPath,\n\t\t\t\t\tmergeBase: mergeBase,\n\t\t\t\t\tHEAD: GitReference.create(rebase, repoPath, { refType: 'revision' }),\n\t\t\t\t\tonto: GitReference.create(onto, repoPath, { refType: 'revision' }),\n\t\t\t\t\tcurrent:\n\t\t\t\t\t\tpossibleSourceBranch != null\n\t\t\t\t\t\t\t? GitReference.create(possibleSourceBranch, repoPath, {\n\t\t\t\t\t\t\t\t\trefType: 'branch',\n\t\t\t\t\t\t\t\t\tname: possibleSourceBranch,\n\t\t\t\t\t\t\t\t\tremote: false,\n\t\t\t\t\t\t\t  })\n\t\t\t\t\t\t\t: undefined,\n\n\t\t\t\t\tincoming: GitReference.create(branch, repoPath, {\n\t\t\t\t\t\trefType: 'branch',\n\t\t\t\t\t\tname: branch,\n\t\t\t\t\t\tremote: false,\n\t\t\t\t\t}),\n\t\t\t\t\tsteps: {\n\t\t\t\t\t\tcurrent: {\n\t\t\t\t\t\t\tnumber: stepsNumber ?? 0,\n\t\t\t\t\t\t\tcommit: GitReference.create(rebase, repoPath, {\n\t\t\t\t\t\t\t\trefType: 'revision',\n\t\t\t\t\t\t\t\tmessage: stepsMessage,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttotal: stepsTotal ?? 0,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (this.useCaching) {\n\t\t\t\tthis._rebaseStatusCache.set(repoPath, status ?? null);\n\n\t\t\t\tif (!(await this.getRepository(repoPath))?.supportsChangeEvents) {\n\t\t\t\t\tthis._rebaseStatusCache.delete(repoPath);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn status ?? undefined;\n\t}\n\n\t@log()\n\tasync getNextDiffUris(\n\t\trepoPath: string,\n\t\turi: Uri,\n\t\tref: string | undefined,\n\t\tskip: number = 0,\n\t): Promise<{ current: GitUri; next: GitUri | undefined; deleted?: boolean } | undefined> {\n\t\t// If we have no ref (or staged ref) there is no next commit\n\t\tif (ref == null || ref.length === 0) return undefined;\n\n\t\tconst fileName = GitUri.relativeTo(uri, repoPath);\n\n\t\tif (GitRevision.isUncommittedStaged(ref)) {\n\t\t\treturn {\n\t\t\t\tcurrent: GitUri.fromFile(fileName, repoPath, ref),\n\t\t\t\tnext: GitUri.fromFile(fileName, repoPath, undefined),\n\t\t\t};\n\t\t}\n\n\t\tconst next = await this.getNextUri(repoPath, uri, ref, skip);\n\t\tif (next == null) {\n\t\t\tconst status = await this.getStatusForFile(repoPath, fileName);\n\t\t\tif (status != null) {\n\t\t\t\t// If the file is staged, diff with the staged version\n\t\t\t\tif (status.indexStatus != null) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcurrent: GitUri.fromFile(fileName, repoPath, ref),\n\t\t\t\t\t\tnext: GitUri.fromFile(fileName, repoPath, GitRevision.uncommittedStaged),\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tcurrent: GitUri.fromFile(fileName, repoPath, ref),\n\t\t\t\tnext: GitUri.fromFile(fileName, repoPath, undefined),\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tcurrent:\n\t\t\t\tskip === 0\n\t\t\t\t\t? GitUri.fromFile(fileName, repoPath, ref)\n\t\t\t\t\t: (await this.getNextUri(repoPath, uri, ref, skip - 1))!,\n\t\t\tnext: next,\n\t\t};\n\t}\n\n\t@log()\n\tasync getNextUri(\n\t\trepoPath: string,\n\t\turi: Uri,\n\t\tref?: string,\n\t\tskip: number = 0,\n\t\t// editorLine?: number\n\t): Promise<GitUri | undefined> {\n\t\t// If we have no ref (or staged ref) there is no next commit\n\t\tif (ref == null || ref.length === 0 || GitRevision.isUncommittedStaged(ref)) return undefined;\n\n\t\tlet filters: GitDiffFilter[] | undefined;\n\t\tif (ref === GitRevision.deletedOrMissing) {\n\t\t\t// If we are trying to move next from a deleted or missing ref then get the first commit\n\t\t\tref = undefined;\n\t\t\tfilters = ['A'];\n\t\t}\n\n\t\tconst fileName = GitUri.relativeTo(uri, repoPath);\n\t\tlet data = await Git.log__file(repoPath, fileName, ref, {\n\t\t\tfilters: filters,\n\t\t\tformat: 'simple',\n\t\t\tlimit: skip + 1,\n\t\t\tordering: Container.config.advanced.commitOrdering,\n\t\t\treverse: true,\n\t\t\t// startLine: editorLine != null ? editorLine + 1 : undefined,\n\t\t});\n\t\tif (data == null || data.length === 0) return undefined;\n\n\t\tconst [nextRef, file, status] = GitLogParser.parseSimple(data, skip);\n\t\t// If the file was deleted, check for a possible rename\n\t\tif (status === 'D') {\n\t\t\tdata = await Git.log__file(repoPath, '.', nextRef, {\n\t\t\t\tfilters: ['R', 'C'],\n\t\t\t\tformat: 'simple',\n\t\t\t\tlimit: 1,\n\t\t\t\tordering: Container.config.advanced.commitOrdering,\n\t\t\t\t// startLine: editorLine != null ? editorLine + 1 : undefined\n\t\t\t});\n\t\t\tif (data == null || data.length === 0) {\n\t\t\t\treturn GitUri.fromFile(file ?? fileName, repoPath, nextRef);\n\t\t\t}\n\n\t\t\tconst [nextRenamedRef, renamedFile] = GitLogParser.parseSimpleRenamed(data, file ?? fileName);\n\t\t\treturn GitUri.fromFile(\n\t\t\t\trenamedFile ?? file ?? fileName,\n\t\t\t\trepoPath,\n\t\t\t\tnextRenamedRef ?? nextRef ?? GitRevision.deletedOrMissing,\n\t\t\t);\n\t\t}\n\n\t\treturn GitUri.fromFile(file ?? fileName, repoPath, nextRef);\n\t}\n\n\t@log()\n\tasync getPreviousDiffUris(\n\t\trepoPath: string,\n\t\turi: Uri,\n\t\tref: string | undefined,\n\t\tskip: number = 0,\n\t\tfirstParent: boolean = false,\n\t): Promise<{ current: GitUri; previous: GitUri | undefined } | undefined> {\n\t\tif (ref === GitRevision.deletedOrMissing) return undefined;\n\n\t\tconst fileName = GitUri.relativeTo(uri, repoPath);\n\n\t\t// If we are at the working tree (i.e. no ref), we need to dig deeper to figure out where to go\n\t\tif (ref == null || ref.length === 0) {\n\t\t\t// First, check the file status to see if there is anything staged\n\t\t\tconst status = await this.getStatusForFile(repoPath, fileName);\n\t\t\tif (status != null) {\n\t\t\t\t// If the file is staged with working changes, diff working with staged (index)\n\t\t\t\t// If the file is staged without working changes, diff staged with HEAD\n\t\t\t\tif (status.indexStatus != null) {\n\t\t\t\t\t// Backs up to get to HEAD\n\t\t\t\t\tif (status.workingTreeStatus == null) {\n\t\t\t\t\t\tskip++;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (skip === 0) {\n\t\t\t\t\t\t// Diff working with staged\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tcurrent: GitUri.fromFile(fileName, repoPath, undefined),\n\t\t\t\t\t\t\tprevious: GitUri.fromFile(fileName, repoPath, GitRevision.uncommittedStaged),\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\t// Diff staged with HEAD (or prior if more skips)\n\t\t\t\t\t\tcurrent: GitUri.fromFile(fileName, repoPath, GitRevision.uncommittedStaged),\n\t\t\t\t\t\tprevious: await this.getPreviousUri(repoPath, uri, ref, skip - 1, undefined, firstParent),\n\t\t\t\t\t};\n\t\t\t\t} else if (status.workingTreeStatus != null) {\n\t\t\t\t\tif (skip === 0) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tcurrent: GitUri.fromFile(fileName, repoPath, undefined),\n\t\t\t\t\t\t\tprevious: await this.getPreviousUri(repoPath, uri, undefined, skip, undefined, firstParent),\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (skip === 0) {\n\t\t\t\tskip++;\n\t\t\t}\n\t\t}\n\t\t// If we are at the index (staged), diff staged with HEAD\n\t\telse if (GitRevision.isUncommittedStaged(ref)) {\n\t\t\tconst current =\n\t\t\t\tskip === 0\n\t\t\t\t\t? GitUri.fromFile(fileName, repoPath, ref)\n\t\t\t\t\t: (await this.getPreviousUri(repoPath, uri, undefined, skip - 1, undefined, firstParent))!;\n\t\t\tif (current == null || current.sha === GitRevision.deletedOrMissing) return undefined;\n\n\t\t\treturn {\n\t\t\t\tcurrent: current,\n\t\t\t\tprevious: await this.getPreviousUri(repoPath, uri, undefined, skip, undefined, firstParent),\n\t\t\t};\n\t\t}\n\n\t\t// If we are at a commit, diff commit with previous\n\t\tconst current =\n\t\t\tskip === 0\n\t\t\t\t? GitUri.fromFile(fileName, repoPath, ref)\n\t\t\t\t: (await this.getPreviousUri(repoPath, uri, ref, skip - 1, undefined, firstParent))!;\n\t\tif (current == null || current.sha === GitRevision.deletedOrMissing) return undefined;\n\n\t\treturn {\n\t\t\tcurrent: current,\n\t\t\tprevious: await this.getPreviousUri(repoPath, uri, ref, skip, undefined, firstParent),\n\t\t};\n\t}\n\n\t@log()\n\tasync getPreviousLineDiffUris(\n\t\trepoPath: string,\n\t\turi: Uri,\n\t\teditorLine: number,\n\t\tref: string | undefined,\n\t\tskip: number = 0,\n\t): Promise<{ current: GitUri; previous: GitUri | undefined; line: number } | undefined> {\n\t\tif (ref === GitRevision.deletedOrMissing) return undefined;\n\n\t\tlet fileName = GitUri.relativeTo(uri, repoPath);\n\n\t\tlet previous;\n\n\t\t// If we are at the working tree (i.e. no ref), we need to dig deeper to figure out where to go\n\t\tif (ref == null || ref.length === 0) {\n\t\t\t// First, check the blame on the current line to see if there are any working/staged changes\n\t\t\tconst gitUri = new GitUri(uri, repoPath);\n\n\t\t\tconst document = await workspace.openTextDocument(uri);\n\t\t\tconst blameLine = document.isDirty\n\t\t\t\t? await this.getBlameForLineContents(gitUri, editorLine, document.getText())\n\t\t\t\t: await this.getBlameForLine(gitUri, editorLine);\n\t\t\tif (blameLine == null) return undefined;\n\n\t\t\t// If line is uncommitted, we need to dig deeper to figure out where to go (because blame can't be trusted)\n\t\t\tif (blameLine.commit.isUncommitted) {\n\t\t\t\t// If the document is dirty (unsaved), use the status to determine where to go\n\t\t\t\tif (document.isDirty) {\n\t\t\t\t\t// Check the file status to see if there is anything staged\n\t\t\t\t\tconst status = await this.getStatusForFile(repoPath, fileName);\n\t\t\t\t\tif (status != null) {\n\t\t\t\t\t\t// If the file is staged, diff working with staged (index)\n\t\t\t\t\t\t// If the file is not staged, diff working with HEAD\n\t\t\t\t\t\tif (status.indexStatus != null) {\n\t\t\t\t\t\t\t// Diff working with staged\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tcurrent: GitUri.fromFile(fileName, repoPath, undefined),\n\t\t\t\t\t\t\t\tprevious: GitUri.fromFile(fileName, repoPath, GitRevision.uncommittedStaged),\n\t\t\t\t\t\t\t\tline: editorLine,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Diff working with HEAD (or prior if more skips)\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcurrent: GitUri.fromFile(fileName, repoPath, undefined),\n\t\t\t\t\t\tprevious: await this.getPreviousUri(repoPath, uri, undefined, skip, editorLine),\n\t\t\t\t\t\tline: editorLine,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\t// First, check if we have a diff in the working tree\n\t\t\t\tlet hunkLine = await this.getDiffForLine(gitUri, editorLine, undefined);\n\t\t\t\tif (hunkLine == null) {\n\t\t\t\t\t// Next, check if we have a diff in the index (staged)\n\t\t\t\t\thunkLine = await this.getDiffForLine(gitUri, editorLine, undefined, GitRevision.uncommittedStaged);\n\n\t\t\t\t\tif (hunkLine != null) {\n\t\t\t\t\t\tref = GitRevision.uncommittedStaged;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tskip++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// If line is committed, diff with line ref with previous\n\t\t\telse {\n\t\t\t\tref = blameLine.commit.sha;\n\t\t\t\tfileName = blameLine.commit.fileName || (blameLine.commit.originalFileName ?? fileName);\n\t\t\t\turi = GitUri.resolveToUri(fileName, repoPath);\n\t\t\t\teditorLine = blameLine.line.originalLine - 1;\n\n\t\t\t\tif (skip === 0 && blameLine.commit.previousSha) {\n\t\t\t\t\tprevious = GitUri.fromFile(fileName, repoPath, blameLine.commit.previousSha);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif (GitRevision.isUncommittedStaged(ref)) {\n\t\t\t\tconst current =\n\t\t\t\t\tskip === 0\n\t\t\t\t\t\t? GitUri.fromFile(fileName, repoPath, ref)\n\t\t\t\t\t\t: (await this.getPreviousUri(repoPath, uri, undefined, skip - 1, editorLine))!;\n\t\t\t\tif (current.sha === GitRevision.deletedOrMissing) return undefined;\n\n\t\t\t\treturn {\n\t\t\t\t\tcurrent: current,\n\t\t\t\t\tprevious: await this.getPreviousUri(repoPath, uri, undefined, skip, editorLine),\n\t\t\t\t\tline: editorLine,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst gitUri = new GitUri(uri, { repoPath: repoPath, sha: ref });\n\t\t\tconst blameLine = await this.getBlameForLine(gitUri, editorLine);\n\t\t\tif (blameLine == null) return undefined;\n\n\t\t\t// Diff with line ref with previous\n\t\t\tref = blameLine.commit.sha;\n\t\t\tfileName = blameLine.commit.fileName || (blameLine.commit.originalFileName ?? fileName);\n\t\t\turi = GitUri.resolveToUri(fileName, repoPath);\n\t\t\teditorLine = blameLine.line.originalLine - 1;\n\n\t\t\tif (skip === 0 && blameLine.commit.previousSha) {\n\t\t\t\tprevious = GitUri.fromFile(fileName, repoPath, blameLine.commit.previousSha);\n\t\t\t}\n\t\t}\n\n\t\tconst current =\n\t\t\tskip === 0\n\t\t\t\t? GitUri.fromFile(fileName, repoPath, ref)\n\t\t\t\t: (await this.getPreviousUri(repoPath, uri, ref, skip - 1, editorLine))!;\n\t\tif (current.sha === GitRevision.deletedOrMissing) return undefined;\n\n\t\treturn {\n\t\t\tcurrent: current,\n\t\t\tprevious: previous ?? (await this.getPreviousUri(repoPath, uri, ref, skip, editorLine)),\n\t\t\tline: editorLine,\n\t\t};\n\t}\n\n\t@log()\n\tasync getPreviousUri(\n\t\trepoPath: string,\n\t\turi: Uri,\n\t\tref?: string,\n\t\tskip: number = 0,\n\t\teditorLine?: number,\n\t\tfirstParent: boolean = false,\n\t): Promise<GitUri | undefined> {\n\t\tif (ref === GitRevision.deletedOrMissing) return undefined;\n\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tif (ref === GitRevision.uncommitted) {\n\t\t\tref = undefined;\n\t\t}\n\n\t\tconst fileName = GitUri.relativeTo(uri, repoPath);\n\t\t// TODO: Add caching\n\t\tlet data;\n\t\ttry {\n\t\t\tdata = await Git.log__file(repoPath, fileName, ref, {\n\t\t\t\tfirstParent: firstParent,\n\t\t\t\tformat: 'simple',\n\t\t\t\tlimit: skip + 2,\n\t\t\t\tordering: Container.config.advanced.commitOrdering,\n\t\t\t\tstartLine: editorLine != null ? editorLine + 1 : undefined,\n\t\t\t});\n\t\t} catch (ex) {\n\t\t\tconst msg: string = ex?.toString() ?? emptyStr;\n\t\t\t// If the line count is invalid just fallback to the most recent commit\n\t\t\tif ((ref == null || GitRevision.isUncommittedStaged(ref)) && GitErrors.invalidLineCount.test(msg)) {\n\t\t\t\tif (ref == null) {\n\t\t\t\t\tconst status = await this.getStatusForFile(repoPath, fileName);\n\t\t\t\t\tif (status?.indexStatus != null) {\n\t\t\t\t\t\treturn GitUri.fromFile(fileName, repoPath, GitRevision.uncommittedStaged);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tref = await Git.log__file_recent(repoPath, fileName, {\n\t\t\t\t\tordering: Container.config.advanced.commitOrdering,\n\t\t\t\t});\n\t\t\t\treturn GitUri.fromFile(fileName, repoPath, ref ?? GitRevision.deletedOrMissing);\n\t\t\t}\n\n\t\t\tLogger.error(ex, cc);\n\t\t\tthrow ex;\n\t\t}\n\t\tif (data == null || data.length === 0) return undefined;\n\n\t\tconst [previousRef, file] = GitLogParser.parseSimple(data, skip, ref);\n\t\t// If the previous ref matches the ref we asked for assume we are at the end of the history\n\t\tif (ref != null && ref === previousRef) return undefined;\n\n\t\treturn GitUri.fromFile(file ?? fileName, repoPath, previousRef ?? GitRevision.deletedOrMissing);\n\t}\n\n\tasync getPullRequestForBranch(\n\t\tbranch: string,\n\t\tremote: GitRemote,\n\t\toptions?: { avatarSize?: number; include?: PullRequestState[]; limit?: number; timeout?: number },\n\t): Promise<PullRequest | undefined>;\n\tasync getPullRequestForBranch(\n\t\tbranch: string,\n\t\tprovider: RichRemoteProvider,\n\t\toptions?: { avatarSize?: number; include?: PullRequestState[]; limit?: number; timeout?: number },\n\t): Promise<PullRequest | undefined>;\n\t@gate<GitService['getPullRequestForBranch']>((ref, remoteOrProvider, options) => {\n\t\tconst provider = GitRemote.is(remoteOrProvider) ? remoteOrProvider.provider : remoteOrProvider;\n\t\treturn `${ref}${provider != null ? `|${provider.id}:${provider.domain}/${provider.path}` : ''}${\n\t\t\toptions != null ? `|${options.limit ?? -1}:${options.include?.join(',')}` : ''\n\t\t}`;\n\t})\n\t@debug<GitService['getPullRequestForBranch']>({\n\t\targs: {\n\t\t\t1: (remoteOrProvider: GitRemote | RichRemoteProvider) => remoteOrProvider.name,\n\t\t},\n\t})\n\tasync getPullRequestForBranch(\n\t\tbranch: string,\n\t\tremoteOrProvider: GitRemote | RichRemoteProvider,\n\t\t{\n\t\t\ttimeout,\n\t\t\t...options\n\t\t}: { avatarSize?: number; include?: PullRequestState[]; limit?: number; timeout?: number } = {},\n\t): Promise<PullRequest | undefined> {\n\t\tlet provider;\n\t\tif (GitRemote.is(remoteOrProvider)) {\n\t\t\t({ provider } = remoteOrProvider);\n\t\t\tif (!provider?.hasApi()) return undefined;\n\t\t} else {\n\t\t\tprovider = remoteOrProvider;\n\t\t}\n\n\t\tlet promiseOrPR = provider.getPullRequestForBranch(branch, options);\n\t\tif (promiseOrPR == null || !Promises.is(promiseOrPR)) {\n\t\t\treturn promiseOrPR;\n\t\t}\n\n\t\tif (timeout != null && timeout > 0) {\n\t\t\tpromiseOrPR = Promises.cancellable(promiseOrPR, timeout);\n\t\t}\n\n\t\ttry {\n\t\t\treturn await promiseOrPR;\n\t\t} catch (ex) {\n\t\t\tif (ex instanceof Promises.CancellationError) {\n\t\t\t\tthrow ex;\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync getPullRequestForCommit(\n\t\tref: string,\n\t\tremote: GitRemote,\n\t\toptions?: { timeout?: number },\n\t): Promise<PullRequest | undefined>;\n\tasync getPullRequestForCommit(\n\t\tref: string,\n\t\tprovider: RichRemoteProvider,\n\t\toptions?: { timeout?: number },\n\t): Promise<PullRequest | undefined>;\n\t@gate<GitService['getPullRequestForCommit']>((ref, remoteOrProvider, options) => {\n\t\tconst provider = GitRemote.is(remoteOrProvider) ? remoteOrProvider.provider : remoteOrProvider;\n\t\treturn `${ref}${provider != null ? `|${provider.id}:${provider.domain}/${provider.path}` : ''}|${\n\t\t\toptions?.timeout\n\t\t}`;\n\t})\n\t@debug<GitService['getPullRequestForCommit']>({\n\t\targs: {\n\t\t\t1: (remoteOrProvider: GitRemote | RichRemoteProvider) => remoteOrProvider.name,\n\t\t},\n\t})\n\tasync getPullRequestForCommit(\n\t\tref: string,\n\t\tremoteOrProvider: GitRemote | RichRemoteProvider,\n\t\t{ timeout }: { timeout?: number } = {},\n\t): Promise<PullRequest | undefined> {\n\t\tif (GitRevision.isUncommitted(ref)) return undefined;\n\n\t\tlet provider;\n\t\tif (GitRemote.is(remoteOrProvider)) {\n\t\t\t({ provider } = remoteOrProvider);\n\t\t\tif (!provider?.hasApi()) return undefined;\n\t\t} else {\n\t\t\tprovider = remoteOrProvider;\n\t\t}\n\n\t\tlet promiseOrPR = provider.getPullRequestForCommit(ref);\n\t\tif (promiseOrPR == null || !Promises.is(promiseOrPR)) {\n\t\t\treturn promiseOrPR;\n\t\t}\n\n\t\tif (timeout != null && timeout > 0) {\n\t\t\tpromiseOrPR = Promises.cancellable(promiseOrPR, timeout);\n\t\t}\n\n\t\ttry {\n\t\t\treturn await promiseOrPR;\n\t\t} catch (ex) {\n\t\t\tif (ex instanceof Promises.CancellationError) {\n\t\t\t\tthrow ex;\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getIncomingActivity(\n\t\trepoPath: string,\n\t\t{\n\t\t\tlimit,\n\t\t\t...options\n\t\t}: { all?: boolean; branch?: string; limit?: number; ordering?: string | null; skip?: number } = {},\n\t): Promise<GitReflog | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tlimit = limit ?? Container.config.advanced.maxListItems ?? 0;\n\t\ttry {\n\t\t\t// Pass a much larger limit to reflog, because we aggregate the data and we won't know how many lines we'll need\n\t\t\tconst data = await Git.reflog(repoPath, {\n\t\t\t\tordering: Container.config.advanced.commitOrdering,\n\t\t\t\t...options,\n\t\t\t\tlimit: limit * 100,\n\t\t\t});\n\t\t\tif (data == null) return undefined;\n\n\t\t\tconst reflog = GitReflogParser.parse(data, repoPath, reflogCommands, limit, limit * 100);\n\t\t\tif (reflog?.hasMore) {\n\t\t\t\treflog.more = this.getReflogMoreFn(reflog, options);\n\t\t\t}\n\n\t\t\treturn reflog;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprivate getReflogMoreFn(\n\t\treflog: GitReflog,\n\t\toptions: { all?: boolean; branch?: string; limit?: number; ordering?: string | null; skip?: number },\n\t): (limit: number) => Promise<GitReflog> {\n\t\treturn async (limit: number | undefined) => {\n\t\t\tlimit = limit ?? Container.config.advanced.maxSearchItems ?? 0;\n\n\t\t\tconst moreLog = await this.getIncomingActivity(reflog.repoPath, {\n\t\t\t\t...options,\n\t\t\t\tlimit: limit,\n\t\t\t\tskip: reflog.total,\n\t\t\t});\n\t\t\tif (moreLog == null) {\n\t\t\t\t// If we can't find any more, assume we have everything\n\t\t\t\treturn { ...reflog, hasMore: false };\n\t\t\t}\n\n\t\t\tconst mergedLog: GitReflog = {\n\t\t\t\trepoPath: reflog.repoPath,\n\t\t\t\trecords: [...reflog.records, ...moreLog.records],\n\t\t\t\tcount: reflog.count + moreLog.count,\n\t\t\t\ttotal: reflog.total + moreLog.total,\n\t\t\t\tlimit: (reflog.limit ?? 0) + limit,\n\t\t\t\thasMore: moreLog.hasMore,\n\t\t\t};\n\t\t\tmergedLog.more = this.getReflogMoreFn(mergedLog, options);\n\n\t\t\treturn mergedLog;\n\t\t};\n\t}\n\n\tasync getRichRemoteProvider(\n\t\trepoPath: string | undefined,\n\t\toptions?: { includeDisconnected?: boolean },\n\t): Promise<GitRemote<RichRemoteProvider> | undefined>;\n\tasync getRichRemoteProvider(\n\t\tremotes: GitRemote[],\n\t\toptions?: { includeDisconnected?: boolean },\n\t): Promise<GitRemote<RichRemoteProvider> | undefined>;\n\t@gate<GitService['getRichRemoteProvider']>(\n\t\t(remotesOrRepoPath, options) =>\n\t\t\t`${typeof remotesOrRepoPath === 'string' ? remotesOrRepoPath : remotesOrRepoPath[0]?.repoPath}:${\n\t\t\t\toptions?.includeDisconnected ?? false\n\t\t\t}`,\n\t)\n\t@log({ args: { 0: () => false } })\n\tasync getRichRemoteProvider(\n\t\tremotesOrRepoPath: GitRemote[] | string | undefined,\n\t\t{ includeDisconnected }: { includeDisconnected?: boolean } = {},\n\t): Promise<GitRemote<RichRemoteProvider> | undefined> {\n\t\tif (remotesOrRepoPath == null) return undefined;\n\n\t\tconst cacheKey = `${includeDisconnected ? 'disconnected|' : ''}${\n\t\t\ttypeof remotesOrRepoPath === 'string' ? remotesOrRepoPath : remotesOrRepoPath[0]?.repoPath\n\t\t}`;\n\t\tif (cacheKey != null) {\n\t\t\tconst remote = this._remotesWithApiProviderCache.get(cacheKey);\n\t\t\tif (remote !== undefined) return remote ?? undefined;\n\t\t}\n\n\t\tconst remotes = (\n\t\t\ttypeof remotesOrRepoPath === 'string' ? await this.getRemotes(remotesOrRepoPath) : remotesOrRepoPath\n\t\t).filter(r => r.provider != null);\n\n\t\tif (remotes.length === 0) return undefined;\n\n\t\tlet remote;\n\t\tif (remotes.length === 1) {\n\t\t\tremote = remotes[0];\n\t\t} else {\n\t\t\tconst weightedRemotes = new Map<string, number>([\n\t\t\t\t['upstream', 15],\n\t\t\t\t['origin', 10],\n\t\t\t]);\n\n\t\t\tconst branch = await this.getBranch(remotes[0].repoPath);\n\t\t\tconst branchRemote = branch?.getRemoteName();\n\n\t\t\tif (branchRemote != null) {\n\t\t\t\tweightedRemotes.set(branchRemote, 100);\n\t\t\t}\n\n\t\t\tlet bestRemote;\n\t\t\tlet weight = 0;\n\t\t\tfor (const r of remotes) {\n\t\t\t\tif (r.default) {\n\t\t\t\t\tbestRemote = r;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\t// Don't choose a remote unless its weighted above\n\t\t\t\tconst matchedWeight = weightedRemotes.get(r.name) ?? -1;\n\t\t\t\tif (matchedWeight > weight) {\n\t\t\t\t\tbestRemote = r;\n\t\t\t\t\tweight = matchedWeight;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tremote = bestRemote ?? null;\n\t\t}\n\n\t\tif (!remote?.provider?.hasApi()) {\n\t\t\tif (cacheKey != null) {\n\t\t\t\tthis._remotesWithApiProviderCache.set(cacheKey, null);\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst { provider } = remote;\n\t\tif (!includeDisconnected) {\n\t\t\tconst connected = provider.maybeConnected ?? (await provider.isConnected());\n\t\t\tif (!connected) {\n\t\t\t\tif (cacheKey != null) {\n\t\t\t\t\tthis._remotesWithApiProviderCache.set(cacheKey, null);\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}\n\n\t\tif (cacheKey != null) {\n\t\t\tthis._remotesWithApiProviderCache.set(cacheKey, remote as GitRemote<RichRemoteProvider>);\n\t\t}\n\t\treturn remote as GitRemote<RichRemoteProvider>;\n\t}\n\n\t@log()\n\tasync getRemotes(\n\t\trepoPath: string | undefined,\n\t\toptions: { sort?: boolean } = {},\n\t): Promise<GitRemote<RemoteProvider>[]> {\n\t\tif (repoPath == null) return [];\n\n\t\tconst repository = await this.getRepository(repoPath);\n\t\tconst remotes = await (repository != null\n\t\t\t? repository.getRemotes({ sort: options.sort })\n\t\t\t: this.getRemotesCore(repoPath, undefined, { sort: options.sort }));\n\n\t\treturn remotes.filter(r => r.provider != null) as GitRemote<RemoteProvider>[];\n\t}\n\n\tasync getRemotesCore(\n\t\trepoPath: string | undefined,\n\t\tproviders?: RemoteProviders,\n\t\toptions: { sort?: boolean } = {},\n\t): Promise<GitRemote[]> {\n\t\tif (repoPath == null) return [];\n\n\t\tproviders = providers ?? RemoteProviderFactory.loadProviders(configuration.get('remotes', null));\n\n\t\ttry {\n\t\t\tconst data = await Git.remote(repoPath);\n\t\t\tconst remotes = GitRemoteParser.parse(data, repoPath, RemoteProviderFactory.factory(providers));\n\t\t\tif (remotes == null) return [];\n\n\t\t\tif (options.sort) {\n\t\t\t\tGitRemote.sort(remotes);\n\t\t\t}\n\n\t\t\treturn remotes;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t\treturn [];\n\t\t}\n\t}\n\n\tasync getRepoPath(filePath: string, options?: { ref?: string }): Promise<string | undefined>;\n\tasync getRepoPath(uri: Uri | undefined, options?: { ref?: string }): Promise<string | undefined>;\n\t@log<GitService['getRepoPath']>({\n\t\texit: path => `returned ${path}`,\n\t})\n\tasync getRepoPath(\n\t\tfilePathOrUri: string | Uri | undefined,\n\t\toptions: { ref?: string } = {},\n\t): Promise<string | undefined> {\n\t\tif (filePathOrUri == null) return this.getHighlanderRepoPath();\n\t\tif (GitUri.is(filePathOrUri)) return filePathOrUri.repoPath;\n\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\t// Don't save the tracking info to the cache, because we could be looking in the wrong place (e.g. looking in the root when the file is in a submodule)\n\t\tlet repo = await this.getRepository(filePathOrUri, { ...options, skipCacheUpdate: true });\n\t\tif (repo != null) return repo.path;\n\n\t\tconst rp = await this.getRepoPathCore(\n\t\t\ttypeof filePathOrUri === 'string' ? filePathOrUri : filePathOrUri.fsPath,\n\t\t\tfalse,\n\t\t);\n\t\tif (rp == null) return undefined;\n\n\t\t// Recheck this._repositoryTree.get(rp) to make sure we haven't already tried adding this due to awaits\n\t\tif (this._repositoryTree.get(rp) != null) return rp;\n\n\t\tconst isVslsScheme =\n\t\t\ttypeof filePathOrUri === 'string' ? undefined : filePathOrUri.scheme === DocumentSchemes.Vsls;\n\n\t\t// If this new repo is inside one of our known roots and we we don't already know about, add it\n\t\tconst root = this.findRepositoryForPath(this._repositoryTree, rp, isVslsScheme);\n\n\t\tlet folder;\n\t\tif (root != null) {\n\t\t\t// Not sure why I added this for vsls (I can't see a reason for it anymore), but if it is added it will break submodules\n\t\t\t// rp = root.path;\n\t\t\tfolder = root.folder;\n\t\t} else {\n\t\t\tfolder = workspace.getWorkspaceFolder(GitUri.file(rp, isVslsScheme));\n\t\t\tif (folder == null) {\n\t\t\t\tconst parts = rp.split(slash);\n\t\t\t\tfolder = {\n\t\t\t\t\turi: GitUri.file(rp, isVslsScheme),\n\t\t\t\t\tname: parts[parts.length - 1],\n\t\t\t\t\tindex: this._repositoryTree.count(),\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tLogger.log(cc, `Repository found in '${rp}'`);\n\t\trepo = new Repository(folder, rp, false, this.onAnyRepositoryChanged.bind(this), !window.state.focused);\n\t\tthis._repositoryTree.set(rp, repo);\n\n\t\t// Send a notification that the repositories changed\n\t\tsetImmediate(async () => {\n\t\t\tawait this.updateContext(this._repositoryTree);\n\n\t\t\tthis.fireRepositoriesChanged();\n\t\t});\n\n\t\treturn rp;\n\t}\n\n\t@debug()\n\tprivate async getRepoPathCore(filePath: string, isDirectory: boolean): Promise<string | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tlet repoPath: string | undefined;\n\t\ttry {\n\t\t\tconst path = isDirectory ? filePath : paths.dirname(filePath);\n\n\t\t\trepoPath = await Git.rev_parse__show_toplevel(path);\n\t\t\tif (repoPath == null) return repoPath;\n\n\t\t\tif (isWindows) {\n\t\t\t\t// On Git 2.25+ if you call `rev-parse --show-toplevel` on a mapped drive, instead of getting the mapped drive path back, you get the UNC path for the mapped drive.\n\t\t\t\t// So try to normalize it back to the mapped drive path, if possible\n\n\t\t\t\tconst repoUri = Uri.file(repoPath);\n\t\t\t\tconst pathUri = Uri.file(path);\n\t\t\t\tif (repoUri.authority.length !== 0 && pathUri.authority.length === 0) {\n\t\t\t\t\tconst match = driveLetterRegex.exec(pathUri.path);\n\t\t\t\t\tif (match != null) {\n\t\t\t\t\t\tconst [, letter] = match;\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst networkPath = await new Promise<string | undefined>(resolve =>\n\t\t\t\t\t\t\t\tfs.realpath.native(`${letter}:\\\\`, { encoding: 'utf8' }, (err, resolvedPath) =>\n\t\t\t\t\t\t\t\t\tresolve(err != null ? undefined : resolvedPath),\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (networkPath != null) {\n\t\t\t\t\t\t\t\trepoPath = Strings.normalizePath(\n\t\t\t\t\t\t\t\t\trepoUri.fsPath.replace(\n\t\t\t\t\t\t\t\t\t\tnetworkPath,\n\t\t\t\t\t\t\t\t\t\t`${letter.toLowerCase()}:${networkPath.endsWith('\\\\') ? '\\\\' : ''}`,\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\treturn repoPath;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch {}\n\t\t\t\t\t}\n\n\t\t\t\t\trepoPath = Strings.normalizePath(pathUri.fsPath);\n\t\t\t\t}\n\n\t\t\t\treturn repoPath;\n\t\t\t}\n\n\t\t\t// If we are not on Windows (symlinks don't seem to have the same issue on Windows), check if we are a symlink and if so, use the symlink path (not its resolved path)\n\t\t\t// This is because VS Code will provide document Uris using the symlinked path\n\t\t\trepoPath = await new Promise<string | undefined>(resolve => {\n\t\t\t\tfs.realpath(path, { encoding: 'utf8' }, (err, resolvedPath) => {\n\t\t\t\t\tif (err != null) {\n\t\t\t\t\t\tLogger.debug(cc, `fs.realpath failed; repoPath=${repoPath}`);\n\t\t\t\t\t\tresolve(repoPath);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (path.toLowerCase() === resolvedPath.toLowerCase()) {\n\t\t\t\t\t\tLogger.debug(cc, `No symlink detected; repoPath=${repoPath}`);\n\t\t\t\t\t\tresolve(repoPath);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst linkPath = Strings.normalizePath(resolvedPath, { stripTrailingSlash: true });\n\t\t\t\t\trepoPath = repoPath!.replace(linkPath, path);\n\t\t\t\t\tLogger.debug(\n\t\t\t\t\t\tcc,\n\t\t\t\t\t\t`Symlink detected; repoPath=${repoPath}, path=${path}, resolvedPath=${resolvedPath}`,\n\t\t\t\t\t);\n\t\t\t\t\tresolve(repoPath);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn repoPath;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\t\t\trepoPath = undefined;\n\t\t\treturn repoPath;\n\t\t} finally {\n\t\t\tif (repoPath) {\n\t\t\t\tvoid this.ensureProperWorkspaceCasing(repoPath, filePath);\n\t\t\t}\n\t\t}\n\t}\n\n\t@gate(() => '')\n\tprivate async ensureProperWorkspaceCasing(repoPath: string, filePath: string) {\n\t\tif (Container.config.advanced.messages.suppressImproperWorkspaceCasingWarning) return;\n\n\t\tfilePath = filePath.replace(/\\\\/g, '/');\n\n\t\tlet regexPath;\n\t\tlet testPath;\n\t\tif (filePath > repoPath) {\n\t\t\tregexPath = filePath;\n\t\t\ttestPath = repoPath;\n\t\t} else {\n\t\t\ttestPath = filePath;\n\t\t\tregexPath = repoPath;\n\t\t}\n\n\t\tlet pathRegex = new RegExp(`^${regexPath}`);\n\t\tif (!pathRegex.test(testPath)) {\n\t\t\tpathRegex = new RegExp(pathRegex, 'i');\n\t\t\tif (pathRegex.test(testPath)) {\n\t\t\t\tawait Messages.showIncorrectWorkspaceCasingWarningMessage();\n\t\t\t}\n\t\t}\n\t}\n\n\t@log()\n\tasync getRepoPathOrActive(uri: Uri | undefined, editor: TextEditor | undefined) {\n\t\tconst repoPath = await this.getRepoPath(uri);\n\t\tif (repoPath) return repoPath;\n\n\t\treturn this.getActiveRepoPath(editor);\n\t}\n\n\t@log()\n\tasync getRepositories(predicate?: (repo: Repository) => boolean): Promise<Iterable<Repository>> {\n\t\tconst repositoryTree = await this.getRepositoryTree();\n\n\t\tconst values = repositoryTree.values();\n\t\treturn predicate != null ? Iterables.filter(values, predicate) : values;\n\t}\n\n\t@log()\n\tasync getOrderedRepositories(): Promise<Repository[]> {\n\t\tconst repositories = [...(await this.getRepositories())];\n\t\tif (repositories.length === 0) return repositories;\n\n\t\treturn Repository.sort(repositories.filter(r => !r.closed));\n\t}\n\n\tprivate async getRepositoryTree(): Promise<TernarySearchTree<string, Repository>> {\n\t\tif (this._repositoriesLoadingPromise != null) {\n\t\t\tawait this._repositoriesLoadingPromise;\n\t\t\tthis._repositoriesLoadingPromise = undefined;\n\t\t}\n\n\t\treturn this._repositoryTree;\n\t}\n\n\tasync getRepository(\n\t\trepoPath: string,\n\t\toptions?: { ref?: string; skipCacheUpdate?: boolean },\n\t): Promise<Repository | undefined>;\n\tasync getRepository(\n\t\turi: Uri,\n\t\toptions?: { ref?: string; skipCacheUpdate?: boolean },\n\t): Promise<Repository | undefined>;\n\tasync getRepository(\n\t\trepoPathOrUri: string | Uri,\n\t\toptions?: { ref?: string; skipCacheUpdate?: boolean },\n\t): Promise<Repository | undefined>;\n\t@log<GitService['getRepository']>({\n\t\texit: repo => `returned ${repo != null ? `${repo.path}` : 'undefined'}`,\n\t})\n\tasync getRepository(\n\t\trepoPathOrUri: string | Uri,\n\t\toptions: { ref?: string; skipCacheUpdate?: boolean } = {},\n\t): Promise<Repository | undefined> {\n\t\tconst repositoryTree = await this.getRepositoryTree();\n\n\t\tlet isVslsScheme;\n\n\t\tlet path: string;\n\t\tif (typeof repoPathOrUri === 'string') {\n\t\t\tconst repo = repositoryTree.get(repoPathOrUri);\n\t\t\tif (repo != null) return repo;\n\n\t\t\tpath = repoPathOrUri;\n\t\t\tisVslsScheme = undefined;\n\t\t} else {\n\t\t\tif (GitUri.is(repoPathOrUri)) {\n\t\t\t\tif (repoPathOrUri.repoPath) {\n\t\t\t\t\tconst repo = repositoryTree.get(repoPathOrUri.repoPath);\n\t\t\t\t\tif (repo != null) return repo;\n\t\t\t\t}\n\n\t\t\t\tpath = repoPathOrUri.fsPath;\n\t\t\t} else {\n\t\t\t\tpath = repoPathOrUri.fsPath;\n\t\t\t}\n\n\t\t\tisVslsScheme = repoPathOrUri.scheme === DocumentSchemes.Vsls;\n\t\t}\n\n\t\tconst repo = this.findRepositoryForPath(repositoryTree, path, isVslsScheme);\n\t\tif (repo == null) return undefined;\n\n\t\t// Make sure the file is tracked in this repo before returning -- it could be from a submodule\n\t\tif (!(await this.isTracked(path, repo.path, options))) return undefined;\n\t\treturn repo;\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (repositoryTree: TernarySearchTree<string, Repository>) => `count=${repositoryTree.count()}`,\n\t\t},\n\t})\n\tprivate findRepositoryForPath(\n\t\trepositoryTree: TernarySearchTree<string, Repository>,\n\t\tpath: string,\n\t\tisVslsScheme: boolean | undefined,\n\t): Repository | undefined {\n\t\tlet repo = repositoryTree.findSubstr(path);\n\t\t// If we can't find the repo and we are a guest, check if we are a \"root\" workspace\n\t\tif (repo == null && isVslsScheme !== false && Container.vsls.isMaybeGuest) {\n\t\t\tif (!vslsUriPrefixRegex.test(path)) {\n\t\t\t\tpath = Strings.normalizePath(path);\n\t\t\t\tconst vslsPath = `/~0${path.startsWith(slash) ? path : `/${path}`}`;\n\t\t\t\trepo = repositoryTree.findSubstr(vslsPath);\n\t\t\t}\n\t\t}\n\t\treturn repo;\n\t}\n\n\tasync getLocalInfoFromRemoteUri(\n\t\turi: Uri,\n\t\toptions?: { validate?: boolean },\n\t): Promise<{ uri: Uri; startLine?: number; endLine?: number } | undefined> {\n\t\tfor (const repo of await this.getRepositories()) {\n\t\t\tfor (const remote of await repo.getRemotes()) {\n\t\t\t\tconst local = await remote?.provider?.getLocalInfoFromRemoteUri(repo, uri, options);\n\t\t\t\tif (local != null) return local;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tasync getRepositoryCount(): Promise<number> {\n\t\tconst repositoryTree = await this.getRepositoryTree();\n\t\treturn repositoryTree.count();\n\t}\n\n\t@gate()\n\t@log()\n\tasync getStash(repoPath: string | undefined): Promise<GitStash | undefined> {\n\t\tif (repoPath == null) return undefined;\n\n\t\tlet stash = this.useCaching ? this._stashesCache.get(repoPath) : undefined;\n\t\tif (stash === undefined) {\n\t\t\tconst data = await Git.stash__list(repoPath, {\n\t\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold,\n\t\t\t});\n\t\t\tstash = GitStashParser.parse(data, repoPath);\n\n\t\t\tif (this.useCaching) {\n\t\t\t\tthis._stashesCache.set(repoPath, stash ?? null);\n\n\t\t\t\tif (!(await this.getRepository(repoPath))?.supportsChangeEvents) {\n\t\t\t\t\tthis._stashesCache.delete(repoPath);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn stash ?? undefined;\n\t}\n\n\t@log()\n\tasync getStatusForFile(repoPath: string, fileName: string): Promise<GitStatusFile | undefined> {\n\t\tconst porcelainVersion = Git.validateVersion(2, 11) ? 2 : 1;\n\n\t\tconst data = await Git.status__file(repoPath, fileName, porcelainVersion, {\n\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold,\n\t\t});\n\t\tconst status = GitStatusParser.parse(data, repoPath, porcelainVersion);\n\t\tif (status == null || !status.files.length) return undefined;\n\n\t\treturn status.files[0];\n\t}\n\n\t@log()\n\tasync getStatusForFiles(repoPath: string, path: string): Promise<GitStatusFile[] | undefined> {\n\t\tconst porcelainVersion = Git.validateVersion(2, 11) ? 2 : 1;\n\n\t\tconst data = await Git.status__file(repoPath, path, porcelainVersion, {\n\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold,\n\t\t});\n\t\tconst status = GitStatusParser.parse(data, repoPath, porcelainVersion);\n\t\tif (status == null || !status.files.length) return [];\n\n\t\treturn status.files;\n\t}\n\n\t@log()\n\tasync getStatusForRepo(repoPath: string | undefined): Promise<GitStatus | undefined> {\n\t\tif (repoPath == null) return undefined;\n\n\t\tconst porcelainVersion = Git.validateVersion(2, 11) ? 2 : 1;\n\n\t\tconst data = await Git.status(repoPath, porcelainVersion, {\n\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold,\n\t\t});\n\t\tconst status = GitStatusParser.parse(data, repoPath, porcelainVersion);\n\n\t\tif (status?.detached) {\n\t\t\tconst rebaseStatus = await this.getRebaseStatus(repoPath);\n\t\t\tif (rebaseStatus != null) {\n\t\t\t\treturn new GitStatus(\n\t\t\t\t\trepoPath,\n\t\t\t\t\trebaseStatus.incoming.name,\n\t\t\t\t\tstatus.sha,\n\t\t\t\t\tstatus.files,\n\t\t\t\t\tstatus.state,\n\t\t\t\t\tstatus.upstream,\n\t\t\t\t\ttrue,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn status;\n\t}\n\n\t@log({\n\t\targs: {\n\t\t\t1: () => false,\n\t\t},\n\t})\n\tasync getTags(\n\t\trepoPath: string | undefined,\n\t\toptions: { filter?: (t: GitTag) => boolean; sort?: boolean | TagSortOptions } = {},\n\t): Promise<GitTag[]> {\n\t\tif (repoPath == null) return [];\n\n\t\tlet tagsPromise = this.useCaching ? this._tagsCache.get(repoPath) : undefined;\n\t\tif (tagsPromise == null) {\n\t\t\tasync function load(this: GitService) {\n\t\t\t\ttry {\n\t\t\t\t\tconst data = await Git.tag(repoPath!);\n\t\t\t\t\treturn GitTagParser.parse(data, repoPath!) ?? [];\n\t\t\t\t} catch (ex) {\n\t\t\t\t\tthis._tagsCache.delete(repoPath!);\n\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttagsPromise = load.call(this);\n\n\t\t\tif (this.useCaching) {\n\t\t\t\tthis._tagsCache.set(repoPath, tagsPromise);\n\n\t\t\t\tif (!(await this.getRepository(repoPath))?.supportsChangeEvents) {\n\t\t\t\t\tthis._tagsCache.delete(repoPath);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet tags = await tagsPromise;\n\t\tif (options.filter != null) {\n\t\t\ttags = tags.filter(options.filter);\n\t\t}\n\n\t\t// eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n\t\tif (options.sort) {\n\t\t\tGitTag.sort(tags, typeof options.sort === 'boolean' ? undefined : options.sort);\n\t\t}\n\n\t\treturn tags;\n\t}\n\n\t@log()\n\tasync getTreeFileForRevision(repoPath: string, fileName: string, ref: string): Promise<GitTree | undefined> {\n\t\tif (repoPath == null || fileName == null || fileName.length === 0) return undefined;\n\n\t\tconst data = await Git.ls_tree(repoPath, ref, { fileName: fileName });\n\t\tconst trees = GitTreeParser.parse(data);\n\t\treturn trees?.length ? trees[0] : undefined;\n\t}\n\n\t@log()\n\tasync getTreeForRevision(repoPath: string, ref: string): Promise<GitTree[]> {\n\t\tif (repoPath == null) return [];\n\n\t\tconst data = await Git.ls_tree(repoPath, ref);\n\t\treturn GitTreeParser.parse(data) ?? [];\n\t}\n\n\t@log()\n\tgetVersionedFileBuffer(repoPath: string, fileName: string, ref: string) {\n\t\treturn Git.show<Buffer>(repoPath, fileName, ref, { encoding: 'buffer' });\n\t}\n\n\t@log()\n\tasync getVersionedUri(\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\tref: string | undefined,\n\t): Promise<Uri | undefined> {\n\t\tif (ref === GitRevision.deletedOrMissing) return undefined;\n\n\t\tif (\n\t\t\tref == null ||\n\t\t\tref.length === 0 ||\n\t\t\t(GitRevision.isUncommitted(ref) && !GitRevision.isUncommittedStaged(ref))\n\t\t) {\n\t\t\t// Make sure the file exists in the repo\n\t\t\tlet data = await Git.ls_files(repoPath!, fileName);\n\t\t\tif (data != null) return GitUri.file(fileName);\n\n\t\t\t// Check if the file exists untracked\n\t\t\tdata = await Git.ls_files(repoPath!, fileName, { untracked: true });\n\t\t\tif (data != null) return GitUri.file(fileName);\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (GitRevision.isUncommittedStaged(ref)) {\n\t\t\treturn GitUri.git(fileName, repoPath);\n\t\t}\n\n\t\treturn GitUri.toRevisionUri(ref, fileName, repoPath!);\n\t}\n\n\t@log()\n\tasync getWorkingUri(repoPath: string, uri: Uri) {\n\t\tlet fileName = GitUri.relativeTo(uri, repoPath);\n\n\t\tlet data;\n\t\tlet ref;\n\t\tdo {\n\t\t\tdata = await Git.ls_files(repoPath, fileName);\n\t\t\tif (data != null) {\n\t\t\t\tfileName = Strings.splitSingle(data, '\\n')[0];\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// TODO: Add caching\n\t\t\t// Get the most recent commit for this file name\n\t\t\tref = await Git.log__file_recent(repoPath, fileName, {\n\t\t\t\tordering: Container.config.advanced.commitOrdering,\n\t\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold,\n\t\t\t});\n\t\t\tif (ref == null) return undefined;\n\n\t\t\t// Now check if that commit had any renames\n\t\t\tdata = await Git.log__file(repoPath, '.', ref, {\n\t\t\t\tfilters: ['R', 'C', 'D'],\n\t\t\t\tformat: 'simple',\n\t\t\t\tlimit: 1,\n\t\t\t\tordering: Container.config.advanced.commitOrdering,\n\t\t\t});\n\t\t\tif (data == null || data.length === 0) break;\n\n\t\t\tconst [foundRef, foundFile, foundStatus] = GitLogParser.parseSimpleRenamed(data, fileName);\n\t\t\tif (foundStatus === 'D' && foundFile != null) return undefined;\n\t\t\tif (foundRef == null || foundFile == null) break;\n\n\t\t\tfileName = foundFile;\n\t\t} while (true);\n\n\t\turi = GitUri.resolveToUri(fileName, repoPath);\n\t\treturn (await fsExists(uri.fsPath)) ? uri : undefined;\n\t}\n\n\t@log()\n\tasync hasBranchesAndOrTags(\n\t\trepoPath: string | undefined,\n\t\t{\n\t\t\tfilter,\n\t\t}: {\n\t\t\tfilter?: { branches?: (b: GitBranch) => boolean; tags?: (t: GitTag) => boolean };\n\t\t} = {},\n\t) {\n\t\tconst [branches, tags] = await Promise.all<GitBranch[] | undefined, GitTag[] | undefined>([\n\t\t\tthis.getBranches(repoPath, {\n\t\t\t\tfilter: filter?.branches,\n\t\t\t\tsort: false,\n\t\t\t}),\n\t\t\tthis.getTags(repoPath, {\n\t\t\t\tfilter: filter?.tags,\n\t\t\t\tsort: false,\n\t\t\t}),\n\t\t]);\n\n\t\treturn (branches != null && branches.length !== 0) || (tags != null && tags.length !== 0);\n\t}\n\n\t@log()\n\tasync hasRemotes(repoPath: string | undefined): Promise<boolean> {\n\t\tif (repoPath == null) return false;\n\n\t\tconst repository = await this.getRepository(repoPath);\n\t\tif (repository == null) return false;\n\n\t\treturn repository.hasRemotes();\n\t}\n\n\t@log()\n\tasync hasTrackingBranch(repoPath: string | undefined): Promise<boolean> {\n\t\tif (repoPath == null) return false;\n\n\t\tconst repository = await this.getRepository(repoPath);\n\t\tif (repository == null) return false;\n\n\t\treturn repository.hasUpstreamBranch();\n\t}\n\n\t@log({\n\t\targs: {\n\t\t\t1: (editor: TextEditor) =>\n\t\t\t\teditor != null ? `TextEditor(${Logger.toLoggable(editor.document.uri)})` : 'undefined',\n\t\t},\n\t})\n\tasync isActiveRepoPath(repoPath: string | undefined, editor?: TextEditor): Promise<boolean> {\n\t\tif (repoPath == null) return false;\n\n\t\teditor = editor ?? window.activeTextEditor;\n\t\tif (editor == null) return false;\n\n\t\tconst doc = await Container.tracker.getOrAdd(editor.document.uri);\n\t\treturn repoPath === doc?.uri.repoPath;\n\t}\n\n\tisTrackable(scheme: string): boolean;\n\tisTrackable(uri: Uri): boolean;\n\tisTrackable(schemeOruri: string | Uri): boolean {\n\t\tconst scheme = typeof schemeOruri === 'string' ? schemeOruri : schemeOruri.scheme;\n\t\treturn (\n\t\t\tscheme === DocumentSchemes.File ||\n\t\t\tscheme === DocumentSchemes.Git ||\n\t\t\tscheme === DocumentSchemes.GitLens ||\n\t\t\tscheme === DocumentSchemes.PRs ||\n\t\t\tscheme === DocumentSchemes.Vsls\n\t\t);\n\t}\n\n\tasync isTracked(\n\t\tfileName: string,\n\t\trepoPath?: string,\n\t\toptions?: { ref?: string; skipCacheUpdate?: boolean },\n\t): Promise<boolean>;\n\tasync isTracked(uri: GitUri): Promise<boolean>;\n\t@log<GitService['isTracked']>({\n\t\texit: tracked => `returned ${tracked}`,\n\t\tsingleLine: true,\n\t})\n\tasync isTracked(\n\t\tfileNameOrUri: string | GitUri,\n\t\trepoPath?: string,\n\t\toptions: { ref?: string; skipCacheUpdate?: boolean } = {},\n\t): Promise<boolean> {\n\t\tif (options.ref === GitRevision.deletedOrMissing) return false;\n\n\t\tlet ref = options.ref;\n\t\tlet cacheKey: string;\n\t\tlet fileName: string;\n\t\tif (typeof fileNameOrUri === 'string') {\n\t\t\t[fileName, repoPath] = Git.splitPath(fileNameOrUri, repoPath);\n\t\t\tcacheKey = GitUri.toKey(fileNameOrUri);\n\t\t} else {\n\t\t\tif (!this.isTrackable(fileNameOrUri)) return false;\n\n\t\t\tfileName = fileNameOrUri.fsPath;\n\t\t\trepoPath = fileNameOrUri.repoPath;\n\t\t\tref = fileNameOrUri.sha;\n\t\t\tcacheKey = GitUri.toKey(fileName);\n\t\t}\n\n\t\tif (ref != null) {\n\t\t\tcacheKey += `:${ref}`;\n\t\t}\n\n\t\tlet tracked = this._trackedCache.get(cacheKey);\n\t\tif (tracked != null) {\n\t\t\ttracked = await tracked;\n\n\t\t\treturn tracked;\n\t\t}\n\n\t\ttracked = this.isTrackedCore(fileName, repoPath == null ? emptyStr : repoPath, ref);\n\t\tif (options.skipCacheUpdate) {\n\t\t\ttracked = await tracked;\n\n\t\t\treturn tracked;\n\t\t}\n\n\t\tthis._trackedCache.set(cacheKey, tracked);\n\t\ttracked = await tracked;\n\t\tthis._trackedCache.set(cacheKey, tracked);\n\n\t\treturn tracked;\n\t}\n\n\tprivate async isTrackedCore(fileName: string, repoPath: string, ref?: string) {\n\t\tif (ref === GitRevision.deletedOrMissing) return false;\n\n\t\ttry {\n\t\t\t// Even if we have a ref, check first to see if the file exists (that way the cache will be better reused)\n\t\t\tlet tracked = Boolean(await Git.ls_files(repoPath == null ? emptyStr : repoPath, fileName));\n\t\t\tif (!tracked && ref != null) {\n\t\t\t\ttracked = Boolean(await Git.ls_files(repoPath == null ? emptyStr : repoPath, fileName, { ref: ref }));\n\t\t\t\t// If we still haven't found this file, make sure it wasn't deleted in that ref (i.e. check the previous)\n\t\t\t\tif (!tracked) {\n\t\t\t\t\ttracked = Boolean(\n\t\t\t\t\t\tawait Git.ls_files(repoPath == null ? emptyStr : repoPath, fileName, {\n\t\t\t\t\t\t\tref: `${ref}^`,\n\t\t\t\t\t\t}),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn tracked;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t@log()\n\tasync getDiffTool(repoPath?: string) {\n\t\treturn (\n\t\t\t(await Git.config__get('diff.guitool', repoPath, { local: true })) ??\n\t\t\tGit.config__get('diff.tool', repoPath, { local: true })\n\t\t);\n\t}\n\n\t@log()\n\tasync openDiffTool(\n\t\trepoPath: string,\n\t\turi: Uri,\n\t\toptions: { ref1?: string; ref2?: string; staged?: boolean; tool?: string } = {},\n\t): Promise<void> {\n\t\ttry {\n\t\t\tif (!options.tool) {\n\t\t\t\tconst cc = Logger.getCorrelationContext();\n\n\t\t\t\toptions.tool = Container.config.advanced.externalDiffTool || (await this.getDiffTool(repoPath));\n\t\t\t\tif (options.tool == null) throw new Error('No diff tool found');\n\n\t\t\t\tLogger.log(cc, `Using tool=${options.tool}`);\n\t\t\t}\n\n\t\t\tconst { tool, ...opts } = options;\n\t\t\tawait Git.difftool(repoPath, uri.fsPath, tool, opts);\n\t\t} catch (ex) {\n\t\t\tconst msg: string = ex?.toString() ?? '';\n\t\t\tif (msg === 'No diff tool found' || /Unknown .+? tool/.test(msg)) {\n\t\t\t\tconst viewDocs = 'View Git Docs';\n\t\t\t\tconst result = await window.showWarningMessage(\n\t\t\t\t\t'Unable to open changes because the specified diff tool cannot be found or no Git diff tool is configured',\n\t\t\t\t\tviewDocs,\n\t\t\t\t);\n\t\t\t\tif (result === viewDocs) {\n\t\t\t\t\tvoid env.openExternal(\n\t\t\t\t\t\tUri.parse('https://git-scm.com/docs/git-config#Documentation/git-config.txt-difftool'),\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.error(ex, 'openDiffTool');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to open compare');\n\t\t}\n\t}\n\n\t@log()\n\tasync openDirectoryCompare(repoPath: string, ref1: string, ref2?: string, tool?: string): Promise<void> {\n\t\ttry {\n\t\t\tif (!tool) {\n\t\t\t\tconst cc = Logger.getCorrelationContext();\n\n\t\t\t\ttool = Container.config.advanced.externalDirectoryDiffTool || (await this.getDiffTool(repoPath));\n\t\t\t\tif (tool == null) throw new Error('No diff tool found');\n\n\t\t\t\tLogger.log(cc, `Using tool=${tool}`);\n\t\t\t}\n\n\t\t\tawait Git.difftool__dir_diff(repoPath, tool, ref1, ref2);\n\t\t} catch (ex) {\n\t\t\tconst msg: string = ex?.toString() ?? '';\n\t\t\tif (msg === 'No diff tool found' || /Unknown .+? tool/.test(msg)) {\n\t\t\t\tconst viewDocs = 'View Git Docs';\n\t\t\t\tconst result = await window.showWarningMessage(\n\t\t\t\t\t'Unable to open directory compare because the specified diff tool cannot be found or no Git diff tool is configured',\n\t\t\t\t\tviewDocs,\n\t\t\t\t);\n\t\t\t\tif (result === viewDocs) {\n\t\t\t\t\tvoid env.openExternal(\n\t\t\t\t\t\tUri.parse('https://git-scm.com/docs/git-config#Documentation/git-config.txt-difftool'),\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.error(ex, 'openDirectoryCompare');\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to open directory compare');\n\t\t}\n\t}\n\n\tasync resolveReference(\n\t\trepoPath: string,\n\t\tref: string,\n\t\tfileName?: string,\n\t\toptions?: { timeout?: number },\n\t): Promise<string>;\n\tasync resolveReference(repoPath: string, ref: string, uri?: Uri, options?: { timeout?: number }): Promise<string>;\n\t@log()\n\tasync resolveReference(\n\t\trepoPath: string,\n\t\tref: string,\n\t\tfileNameOrUri?: string | Uri,\n\t\toptions?: { timeout?: number },\n\t) {\n\t\tif (ref == null || ref.length === 0 || ref === GitRevision.deletedOrMissing || GitRevision.isUncommitted(ref)) {\n\t\t\treturn ref;\n\t\t}\n\n\t\tif (fileNameOrUri == null) {\n\t\t\tif (GitRevision.isSha(ref) || !GitRevision.isShaLike(ref) || ref.endsWith('^3')) return ref;\n\n\t\t\treturn (await Git.rev_parse__verify(repoPath, ref)) ?? ref;\n\t\t}\n\n\t\tconst fileName =\n\t\t\ttypeof fileNameOrUri === 'string'\n\t\t\t\t? fileNameOrUri\n\t\t\t\t: Strings.normalizePath(paths.relative(repoPath, fileNameOrUri.fsPath));\n\n\t\tconst blob = await Git.rev_parse__verify(repoPath, ref, fileName);\n\t\tif (blob == null) return GitRevision.deletedOrMissing;\n\n\t\tlet promise: Promise<string | void | undefined> = Git.log__find_object(\n\t\t\trepoPath,\n\t\t\tblob,\n\t\t\tref,\n\t\t\tContainer.config.advanced.commitOrdering,\n\t\t\tfileName,\n\t\t);\n\t\tif (options?.timeout != null) {\n\t\t\tpromise = Promise.race([promise, Functions.wait(options.timeout)]);\n\t\t}\n\n\t\treturn (await promise) ?? ref;\n\t}\n\n\t@log()\n\tvalidateBranchOrTagName(ref: string, repoPath?: string): Promise<boolean> {\n\t\treturn Git.check_ref_format(ref, repoPath);\n\t}\n\n\t@log()\n\tasync validateReference(repoPath: string, ref: string) {\n\t\tif (ref == null || ref.length === 0) return false;\n\t\tif (ref === GitRevision.deletedOrMissing || GitRevision.isUncommitted(ref)) return true;\n\n\t\treturn (await Git.rev_parse__verify(repoPath, ref)) != null;\n\t}\n\n\tstageFile(repoPath: string, fileName: string): Promise<string>;\n\tstageFile(repoPath: string, uri: Uri): Promise<string>;\n\t@log()\n\tstageFile(repoPath: string, fileNameOrUri: string | Uri): Promise<string> {\n\t\treturn Git.add(\n\t\t\trepoPath,\n\t\t\ttypeof fileNameOrUri === 'string' ? fileNameOrUri : Git.splitPath(fileNameOrUri.fsPath, repoPath)[0],\n\t\t);\n\t}\n\n\tstageDirectory(repoPath: string, directory: string): Promise<string>;\n\tstageDirectory(repoPath: string, uri: Uri): Promise<string>;\n\t@log()\n\tstageDirectory(repoPath: string, directoryOrUri: string | Uri): Promise<string> {\n\t\treturn Git.add(\n\t\t\trepoPath,\n\t\t\ttypeof directoryOrUri === 'string' ? directoryOrUri : Git.splitPath(directoryOrUri.fsPath, repoPath)[0],\n\t\t);\n\t}\n\n\tunStageFile(repoPath: string, fileName: string): Promise<string>;\n\tunStageFile(repoPath: string, uri: Uri): Promise<string>;\n\t@log()\n\tunStageFile(repoPath: string, fileNameOrUri: string | Uri): Promise<string> {\n\t\treturn Git.reset(\n\t\t\trepoPath,\n\t\t\ttypeof fileNameOrUri === 'string' ? fileNameOrUri : Git.splitPath(fileNameOrUri.fsPath, repoPath)[0],\n\t\t);\n\t}\n\n\tunStageDirectory(repoPath: string, directory: string): Promise<string>;\n\tunStageDirectory(repoPath: string, uri: Uri): Promise<string>;\n\t@log()\n\tunStageDirectory(repoPath: string, directoryOrUri: string | Uri): Promise<string> {\n\t\treturn Git.reset(\n\t\t\trepoPath,\n\t\t\ttypeof directoryOrUri === 'string' ? directoryOrUri : Git.splitPath(directoryOrUri.fsPath, repoPath)[0],\n\t\t);\n\t}\n\n\t@log()\n\tstashApply(repoPath: string, stashName: string, { deleteAfter }: { deleteAfter?: boolean } = {}) {\n\t\treturn Git.stash__apply(repoPath, stashName, Boolean(deleteAfter));\n\t}\n\n\t@log()\n\tstashDelete(repoPath: string, stashName: string, ref?: string) {\n\t\treturn Git.stash__delete(repoPath, stashName, ref);\n\t}\n\n\t@log()\n\tstashSave(\n\t\trepoPath: string,\n\t\tmessage?: string,\n\t\turis?: Uri[],\n\t\toptions: { includeUntracked?: boolean; keepIndex?: boolean } = {},\n\t) {\n\t\tif (uris == null) return Git.stash__push(repoPath, message, options);\n\n\t\tGitService.ensureGitVersion(\n\t\t\t'2.13.2',\n\t\t\t'Stashing individual files',\n\t\t\t' Please retry by stashing everything or install a more recent version of Git.',\n\t\t);\n\n\t\tconst pathspecs = uris.map(u => `./${Git.splitPath(u.fsPath, repoPath)[0]}`);\n\n\t\tconst stdinVersion = '2.30.0';\n\t\tconst stdin = GitService.compareGitVersion(stdinVersion) !== -1;\n\t\t// If we don't support stdin, then error out if we are over the maximum allowed git cli length\n\t\tif (!stdin && Arrays.countStringLength(pathspecs) > maxGitCliLength) {\n\t\t\tGitService.ensureGitVersion(\n\t\t\t\tstdinVersion,\n\t\t\t\t`Stashing so many files (${pathspecs.length}) at once`,\n\t\t\t\t' Please retry by stashing fewer files or install a more recent version of Git.',\n\t\t\t);\n\t\t}\n\n\t\treturn Git.stash__push(repoPath, message, {\n\t\t\t...options,\n\t\t\tpathspecs: pathspecs,\n\t\t\tstdin: stdin,\n\t\t});\n\t}\n\n\tstatic compareGitVersion(version: string) {\n\t\treturn Versions.compare(Versions.fromString(Git.getGitVersion()), Versions.fromString(version));\n\t}\n\tstatic ensureGitVersion(version: string, prefix: string, suffix: string): void {\n\t\tif (GitService.compareGitVersion(version) === -1) {\n\t\t\tthrow new Error(\n\t\t\t\t`${prefix} requires a newer version of Git (>= ${version}) than is currently installed (${Git.getGitVersion()}).${suffix}`,\n\t\t\t);\n\t\t}\n\t}\n\n\t@log()\n\tstatic async getBuiltInGitApi(): Promise<BuiltInGitApi | undefined> {\n\t\ttry {\n\t\t\tconst extension = extensions.getExtension<GitExtension>('vscode.git');\n\t\t\tif (extension != null) {\n\t\t\t\tconst gitExtension = extension.isActive ? extension.exports : await extension.activate();\n\t\t\t\treturn gitExtension.getAPI(1);\n\t\t\t}\n\t\t} catch {}\n\n\t\treturn undefined;\n\t}\n\n\t@log()\n\tstatic async getOrOpenBuiltInGitRepository(repoPath: string): Promise<BuiltInGitRepository | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\t\ttry {\n\t\t\tconst gitApi = await GitService.getBuiltInGitApi();\n\t\t\tif (gitApi?.openRepository != null) {\n\t\t\t\treturn (await gitApi?.openRepository?.(Uri.file(repoPath))) ?? undefined;\n\t\t\t}\n\n\t\t\treturn gitApi?.getRepository(Uri.file(repoPath)) ?? undefined;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tstatic async openBuiltInGitRepository(repoPath: string): Promise<BuiltInGitRepository | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\t\ttry {\n\t\t\tconst gitApi = await GitService.getBuiltInGitApi();\n\t\t\treturn (await gitApi?.openRepository?.(Uri.file(repoPath))) ?? undefined;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tstatic getEncoding(repoPath: string, fileName: string): string;\n\tstatic getEncoding(uri: Uri): string;\n\tstatic getEncoding(repoPathOrUri: string | Uri, fileName?: string): string {\n\t\tconst uri = typeof repoPathOrUri === 'string' ? GitUri.resolveToUri(fileName!, repoPathOrUri) : repoPathOrUri;\n\t\treturn Git.getEncoding(configuration.getAny<string>('files.encoding', uri));\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { Uri } from 'vscode';\nimport { UriComparer } from '../comparers';\nimport { DocumentSchemes } from '../constants';\nimport { Container } from '../container';\nimport { GitCommit, GitFile, GitRevision } from '../git/git';\nimport { Logger } from '../logger';\nimport { debug, memoize, Strings } from '../system';\n\nconst emptyStr = '';\nconst slash = '/';\n\nexport interface GitCommitish {\n\tfileName?: string;\n\trepoPath: string;\n\tsha?: string;\n\tversionedPath?: string;\n}\n\ninterface UriComponents {\n\tscheme: string;\n\tauthority: string;\n\tpath: string;\n\tquery: string;\n\tfragment: string;\n}\n\ninterface UriEx {\n\tnew (): Uri;\n\tnew (scheme: string, authority: string, path: string, query: string, fragment: string): Uri;\n\t// Use this ctor, because vscode doesn't validate it\n\tnew (components: UriComponents): Uri;\n}\n\nexport class GitUri extends (Uri as any as UriEx) {\n\tstatic is(uri: any): uri is GitUri {\n\t\treturn uri instanceof GitUri;\n\t}\n\n\treadonly repoPath?: string;\n\treadonly sha?: string;\n\treadonly versionedPath?: string;\n\n\tconstructor(uri?: Uri);\n\tconstructor(uri: Uri, commit: GitCommitish);\n\tconstructor(uri: Uri, repoPath: string | undefined);\n\tconstructor(uri?: Uri, commitOrRepoPath?: GitCommitish | string) {\n\t\tif (uri == null) {\n\t\t\tsuper('unknown', emptyStr, emptyStr, emptyStr, emptyStr);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (uri.scheme === DocumentSchemes.GitLens) {\n\t\t\tconst data = JSON.parse(uri.query) as UriRevisionData;\n\n\t\t\t// Fixes issues with uri.query:\n\t\t\t// When Uri's come from the FileSystemProvider, the uri.query only contains the root repo info (not the actual file path)\n\t\t\t// When Uri's come from breadcrumbs (via the FileSystemProvider), the uri.query contains the wrong file path\n\t\t\tif (data.path !== uri.path) {\n\t\t\t\tif (data.path.startsWith('//') && !uri.path.startsWith('//')) {\n\t\t\t\t\tdata.path = `/${uri.path}`;\n\t\t\t\t} else {\n\t\t\t\t\tdata.path = uri.path;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsuper({\n\t\t\t\tscheme: uri.scheme,\n\t\t\t\tauthority: uri.authority,\n\t\t\t\tpath: data.path,\n\t\t\t\tquery: JSON.stringify(data),\n\t\t\t\tfragment: uri.fragment,\n\t\t\t});\n\n\t\t\tthis.repoPath = data.repoPath;\n\t\t\tif (GitRevision.isUncommittedStaged(data.ref) || !GitRevision.isUncommitted(data.ref)) {\n\t\t\t\tthis.sha = data.ref;\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (commitOrRepoPath === undefined) {\n\t\t\tsuper(uri);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (typeof commitOrRepoPath === 'string') {\n\t\t\tsuper(uri);\n\n\t\t\tthis.repoPath = commitOrRepoPath;\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst [authority, fsPath] = GitUri.ensureValidUNCPath(\n\t\t\turi.authority,\n\t\t\tGitUri.resolve(commitOrRepoPath.fileName ?? uri.fsPath, commitOrRepoPath.repoPath),\n\t\t);\n\n\t\tlet path;\n\t\tswitch (uri.scheme) {\n\t\t\tcase 'https':\n\t\t\tcase 'http':\n\t\t\tcase 'file':\n\t\t\t\tif (!fsPath) {\n\t\t\t\t\tpath = slash;\n\t\t\t\t} else if (!fsPath.startsWith(slash)) {\n\t\t\t\t\tpath = `/${fsPath}`;\n\t\t\t\t} else {\n\t\t\t\t\tpath = fsPath;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tpath = fsPath;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tsuper({\n\t\t\tscheme: uri.scheme,\n\t\t\tauthority: authority,\n\t\t\tpath: path,\n\t\t\tquery: uri.query,\n\t\t\tfragment: uri.fragment,\n\t\t});\n\t\tthis.repoPath = commitOrRepoPath.repoPath;\n\t\tthis.versionedPath = commitOrRepoPath.versionedPath;\n\t\tif (GitRevision.isUncommittedStaged(commitOrRepoPath.sha) || !GitRevision.isUncommitted(commitOrRepoPath.sha)) {\n\t\t\tthis.sha = commitOrRepoPath.sha;\n\t\t}\n\t}\n\n\t@memoize()\n\tget directory(): string {\n\t\treturn GitUri.getDirectory(this.relativeFsPath);\n\t}\n\n\t@memoize()\n\tget fileName(): string {\n\t\treturn paths.basename(this.relativeFsPath);\n\t}\n\n\t@memoize()\n\tget isUncommitted() {\n\t\treturn GitRevision.isUncommitted(this.sha);\n\t}\n\n\t@memoize()\n\tget isUncommittedStaged() {\n\t\treturn GitRevision.isUncommittedStaged(this.sha);\n\t}\n\n\t@memoize()\n\tprivate get relativeFsPath() {\n\t\treturn this.repoPath == null || this.repoPath.length === 0\n\t\t\t? this.fsPath\n\t\t\t: paths.relative(this.repoPath, this.fsPath);\n\t}\n\n\t@memoize()\n\tget relativePath() {\n\t\treturn Strings.normalizePath(this.relativeFsPath);\n\t}\n\n\t@memoize()\n\tget shortSha() {\n\t\treturn GitRevision.shorten(this.sha);\n\t}\n\n\t@memoize<GitUri['documentUri']>(options => `${options?.useVersionedPath ? 'versioned' : ''}`)\n\tdocumentUri({ useVersionedPath }: { useVersionedPath?: boolean } = {}) {\n\t\tif (useVersionedPath && this.versionedPath !== undefined) return GitUri.file(this.versionedPath);\n\t\tif (this.scheme !== 'file') return this;\n\n\t\treturn GitUri.file(this.fsPath);\n\t}\n\n\tequals(uri: Uri | undefined) {\n\t\tif (!UriComparer.equals(this, uri)) return false;\n\n\t\treturn this.sha === (GitUri.is(uri) ? uri.sha : undefined);\n\t}\n\n\tgetFormattedFilename(options: { suffix?: string; truncateTo?: number } = {}): string {\n\t\treturn GitUri.getFormattedFilename(this.fsPath, options);\n\t}\n\n\tgetFormattedPath(options: { relativeTo?: string; suffix?: string; truncateTo?: number } = {}): string {\n\t\treturn GitUri.getFormattedPath(this.fsPath, { relativeTo: this.repoPath, ...options });\n\t}\n\n\t@memoize()\n\ttoFileUri() {\n\t\treturn GitUri.file(this.fsPath);\n\t}\n\n\tprivate static ensureValidUNCPath(authority: string, fsPath: string): [string, string] {\n\t\t// Check for authority as used in UNC shares or use the path as given\n\t\tif (fsPath[0] === slash && fsPath[1] === slash) {\n\t\t\tconst index = fsPath.indexOf(slash, 2);\n\t\t\tif (index === -1) {\n\t\t\t\tauthority = fsPath.substring(2);\n\t\t\t\tfsPath = slash;\n\t\t\t} else {\n\t\t\t\tauthority = fsPath.substring(2, index);\n\t\t\t\tfsPath = fsPath.substring(index) || slash;\n\t\t\t}\n\t\t}\n\n\t\treturn [authority, fsPath];\n\t}\n\n\tstatic file(path: string, useVslsScheme?: boolean) {\n\t\tconst uri = Uri.file(path);\n\t\tif (Container.vsls.isMaybeGuest && useVslsScheme !== false) {\n\t\t\treturn uri.with({ scheme: DocumentSchemes.Vsls });\n\t\t}\n\n\t\treturn uri;\n\t}\n\n\tstatic fromCommit(commit: GitCommit, previous: boolean = false) {\n\t\tif (!previous) return new GitUri(commit.uri, commit);\n\n\t\treturn new GitUri(commit.previousUri, {\n\t\t\trepoPath: commit.repoPath,\n\t\t\tsha: commit.previousSha,\n\t\t});\n\t}\n\n\tstatic fromFile(file: string | GitFile, repoPath: string, ref?: string, original: boolean = false): GitUri {\n\t\tconst uri = GitUri.resolveToUri(\n\t\t\ttypeof file === 'string' ? file : (original && file.originalFileName) || file.fileName,\n\t\t\trepoPath,\n\t\t);\n\t\treturn ref == null || ref.length === 0\n\t\t\t? new GitUri(uri, repoPath)\n\t\t\t: new GitUri(uri, { repoPath: repoPath, sha: ref });\n\t}\n\n\tstatic fromRepoPath(repoPath: string, ref?: string) {\n\t\treturn ref == null || ref.length === 0\n\t\t\t? new GitUri(GitUri.file(repoPath), repoPath)\n\t\t\t: new GitUri(GitUri.file(repoPath), { repoPath: repoPath, sha: ref });\n\t}\n\n\tstatic fromRevisionUri(uri: Uri): GitUri {\n\t\treturn new GitUri(uri);\n\t}\n\n\t@debug({\n\t\texit: uri => `returned ${Logger.toLoggable(uri)}`,\n\t})\n\tstatic async fromUri(uri: Uri): Promise<GitUri> {\n\t\tif (GitUri.is(uri)) return uri;\n\n\t\tif (!Container.git.isTrackable(uri)) return new GitUri(uri);\n\n\t\tif (uri.scheme === DocumentSchemes.GitLens) return new GitUri(uri);\n\n\t\t// If this is a git uri, find its repoPath\n\t\tif (uri.scheme === DocumentSchemes.Git) {\n\t\t\ttry {\n\t\t\t\tconst data: { path: string; ref: string } = JSON.parse(uri.query);\n\n\t\t\t\tconst repoPath = await Container.git.getRepoPath(data.path);\n\n\t\t\t\tlet ref;\n\t\t\t\tswitch (data.ref) {\n\t\t\t\t\tcase emptyStr:\n\t\t\t\t\tcase '~':\n\t\t\t\t\t\tref = GitRevision.uncommittedStaged;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase null:\n\t\t\t\t\t\tref = undefined;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tref = data.ref;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tconst commitish: GitCommitish = {\n\t\t\t\t\tfileName: data.path,\n\t\t\t\t\trepoPath: repoPath!,\n\t\t\t\t\tsha: ref,\n\t\t\t\t};\n\t\t\t\treturn new GitUri(uri, commitish);\n\t\t\t} catch {}\n\t\t}\n\n\t\tif (uri.scheme === DocumentSchemes.PRs) {\n\t\t\ttry {\n\t\t\t\tconst data: {\n\t\t\t\t\tbaseCommit: string;\n\t\t\t\t\theadCommit: string;\n\t\t\t\t\tisBase: boolean;\n\t\t\t\t\tfileName: string;\n\t\t\t\t\tprNumber: number;\n\t\t\t\t\tstatus: number;\n\t\t\t\t\tremoteName: string;\n\t\t\t\t} = JSON.parse(uri.query);\n\n\t\t\t\tlet repoPath = Strings.normalizePath(uri.fsPath);\n\t\t\t\tif (repoPath.endsWith(data.fileName)) {\n\t\t\t\t\trepoPath = repoPath.substr(0, repoPath.length - data.fileName.length - 1);\n\t\t\t\t} else {\n\t\t\t\t\trepoPath = (await Container.git.getRepoPath(uri.fsPath))!;\n\t\t\t\t}\n\n\t\t\t\tconst commitish: GitCommitish = {\n\t\t\t\t\tfileName: data.fileName,\n\t\t\t\t\trepoPath: repoPath,\n\t\t\t\t\tsha: data.isBase ? data.baseCommit : data.headCommit,\n\t\t\t\t};\n\t\t\t\treturn new GitUri(uri, commitish);\n\t\t\t} catch {}\n\t\t}\n\n\t\treturn new GitUri(uri, await Container.git.getRepoPath(uri));\n\t}\n\n\tstatic getDirectory(fileName: string, relativeTo?: string): string {\n\t\tlet directory: string | undefined = paths.dirname(fileName);\n\t\tdirectory = relativeTo != null ? GitUri.relativeTo(directory, relativeTo) : Strings.normalizePath(directory);\n\t\treturn directory == null || directory.length === 0 || directory === '.' ? emptyStr : directory;\n\t}\n\n\tstatic getFormattedFilename(\n\t\tfileNameOrUri: string | Uri,\n\t\toptions: {\n\t\t\tsuffix?: string;\n\t\t\ttruncateTo?: number;\n\t\t} = {},\n\t): string {\n\t\tconst { suffix = emptyStr, truncateTo } = options;\n\n\t\tlet fileName: string;\n\t\tif (fileNameOrUri instanceof Uri) {\n\t\t\tfileName = fileNameOrUri.fsPath;\n\t\t} else {\n\t\t\tfileName = fileNameOrUri;\n\t\t}\n\n\t\tlet file = paths.basename(fileName);\n\t\tif (truncateTo != null && file.length >= truncateTo) {\n\t\t\treturn Strings.truncateMiddle(file, truncateTo);\n\t\t}\n\n\t\tif (suffix) {\n\t\t\tif (truncateTo != null && file.length + suffix.length >= truncateTo) {\n\t\t\t\treturn `${Strings.truncateMiddle(file, truncateTo - suffix.length)}${suffix}`;\n\t\t\t}\n\n\t\t\tfile += suffix;\n\t\t}\n\n\t\treturn file;\n\t}\n\n\tstatic getFormattedPath(\n\t\tfileNameOrUri: string | Uri,\n\t\toptions: {\n\t\t\trelativeTo?: string;\n\t\t\tsuffix?: string;\n\t\t\ttruncateTo?: number;\n\t\t},\n\t): string {\n\t\tconst { relativeTo, suffix = emptyStr, truncateTo } = options;\n\n\t\tlet fileName: string;\n\t\tif (fileNameOrUri instanceof Uri) {\n\t\t\tfileName = fileNameOrUri.fsPath;\n\t\t} else {\n\t\t\tfileName = fileNameOrUri;\n\t\t}\n\n\t\tlet file = paths.basename(fileName);\n\t\tif (truncateTo != null && file.length >= truncateTo) {\n\t\t\treturn Strings.truncateMiddle(file, truncateTo);\n\t\t}\n\n\t\tif (suffix) {\n\t\t\tif (truncateTo != null && file.length + suffix.length >= truncateTo) {\n\t\t\t\treturn `${Strings.truncateMiddle(file, truncateTo - suffix.length)}${suffix}`;\n\t\t\t}\n\n\t\t\tfile += suffix;\n\t\t}\n\n\t\tconst directory = GitUri.getDirectory(fileName, relativeTo);\n\t\tif (!directory) return file;\n\n\t\tfile = `/${file}`;\n\n\t\tif (truncateTo != null && file.length + directory.length >= truncateTo) {\n\t\t\treturn `${Strings.truncateLeft(directory, truncateTo - file.length)}${file}`;\n\t\t}\n\n\t\treturn `${directory}${file}`;\n\t}\n\n\tstatic relativeTo(fileNameOrUri: string | Uri, relativeTo: string | undefined): string {\n\t\tconst fileName = fileNameOrUri instanceof Uri ? fileNameOrUri.fsPath : fileNameOrUri;\n\t\tconst relativePath =\n\t\t\trelativeTo == null || relativeTo.length === 0 || !paths.isAbsolute(fileName)\n\t\t\t\t? fileName\n\t\t\t\t: paths.relative(relativeTo, fileName);\n\t\treturn Strings.normalizePath(relativePath);\n\t}\n\n\tstatic git(fileName: string, repoPath?: string) {\n\t\tconst path = GitUri.resolve(fileName, repoPath);\n\t\treturn Uri.parse(\n\t\t\t// Change encoded / back to / otherwise uri parsing won't work properly\n\t\t\t`${DocumentSchemes.Git}:/${encodeURIComponent(path).replace(/%2F/g, slash)}?${encodeURIComponent(\n\t\t\t\tJSON.stringify({\n\t\t\t\t\t// Ensure we use the fsPath here, otherwise the url won't open properly\n\t\t\t\t\tpath: Uri.file(path).fsPath,\n\t\t\t\t\tref: '~',\n\t\t\t\t}),\n\t\t\t)}`,\n\t\t);\n\t}\n\n\tstatic resolve(fileName: string, repoPath?: string) {\n\t\tconst normalizedFileName = Strings.normalizePath(fileName);\n\t\tif (repoPath === undefined) return normalizedFileName;\n\n\t\tconst normalizedRepoPath = Strings.normalizePath(repoPath);\n\t\tif (normalizedFileName == null || normalizedFileName.length === 0) return normalizedRepoPath;\n\n\t\tif (normalizedFileName.startsWith(normalizedRepoPath)) return normalizedFileName;\n\n\t\treturn Strings.normalizePath(paths.join(normalizedRepoPath, normalizedFileName));\n\t}\n\n\tstatic resolveToUri(fileName: string, repoPath?: string) {\n\t\treturn GitUri.file(this.resolve(fileName, repoPath));\n\t}\n\n\tstatic toKey(fileName: string): string;\n\tstatic toKey(uri: Uri): string;\n\tstatic toKey(fileNameOrUri: string | Uri): string;\n\tstatic toKey(fileNameOrUri: string | Uri): string {\n\t\treturn Strings.normalizePath(typeof fileNameOrUri === 'string' ? fileNameOrUri : fileNameOrUri.fsPath);\n\n\t\t// return typeof fileNameOrUri === 'string'\n\t\t//     ? GitUri.file(fileNameOrUri).toString(true)\n\t\t//     : fileNameOrUri.toString(true);\n\t}\n\n\tstatic toRevisionUri(uri: GitUri): Uri;\n\tstatic toRevisionUri(ref: string, fileName: string, repoPath: string): Uri;\n\tstatic toRevisionUri(ref: string, file: GitFile, repoPath: string): Uri;\n\tstatic toRevisionUri(uriOrRef: string | GitUri, fileNameOrFile?: string | GitFile, repoPath?: string): Uri {\n\t\tlet fileName: string;\n\t\tlet ref: string | undefined;\n\t\tlet shortSha: string | undefined;\n\n\t\tif (typeof uriOrRef === 'string') {\n\t\t\tif (typeof fileNameOrFile === 'string') {\n\t\t\t\tfileName = fileNameOrFile;\n\t\t\t} else {\n\t\t\t\t//if (fileNameOrFile!.status === 'D') {\n\t\t\t\tfileName = GitUri.resolve(fileNameOrFile!.originalFileName ?? fileNameOrFile!.fileName, repoPath);\n\t\t\t\t// } else {\n\t\t\t\t// \tfileName = GitUri.resolve(fileNameOrFile!.fileName, repoPath);\n\t\t\t}\n\n\t\t\tref = uriOrRef;\n\t\t\tshortSha = GitRevision.shorten(ref);\n\t\t} else {\n\t\t\tfileName = uriOrRef.fsPath;\n\n\t\t\tref = uriOrRef.sha;\n\t\t\tshortSha = uriOrRef.shortSha;\n\t\t\trepoPath = uriOrRef.repoPath!;\n\t\t}\n\n\t\tif (ref == null || ref.length === 0) {\n\t\t\treturn Uri.file(fileName);\n\t\t}\n\n\t\tif (GitRevision.isUncommitted(ref)) {\n\t\t\treturn GitRevision.isUncommittedStaged(ref) ? GitUri.git(fileName, repoPath) : Uri.file(fileName);\n\t\t}\n\n\t\tconst filePath = Strings.normalizePath(fileName, { addLeadingSlash: true });\n\t\tconst data: UriRevisionData = {\n\t\t\tpath: filePath,\n\t\t\tref: ref,\n\t\t\trepoPath: Strings.normalizePath(repoPath!),\n\t\t};\n\n\t\tconst uri = Uri.parse(\n\t\t\t// Replace / in the authority with a similar unicode characters otherwise parsing will be wrong\n\t\t\t`${DocumentSchemes.GitLens}://${encodeURIComponent(shortSha.replace(/\\//g, '\\u200A\\u2215\\u200A'))}${\n\t\t\t\t// Change encoded / back to / otherwise uri parsing won't work properly\n\t\t\t\tfilePath === slash ? emptyStr : encodeURIComponent(filePath).replace(/%2F/g, slash)\n\t\t\t}?${encodeURIComponent(JSON.stringify(data))}`,\n\t\t);\n\t\treturn uri;\n\t}\n}\n\ninterface UriRevisionData {\n\tpath: string;\n\tref?: string;\n\trepoPath: string;\n}\n","'use strict';\nimport * as paths from 'path';\nimport { findExecutable, run } from './shell';\n\nexport class UnableToFindGitError extends Error {\n\tconstructor(public readonly original?: Error) {\n\t\tsuper('Unable to find git');\n\n\t\tError.captureStackTrace(this, UnableToFindGitError);\n\t}\n}\n\nexport class InvalidGitConfigError extends Error {\n\tconstructor(public readonly original: Error) {\n\t\tsuper('Invalid Git configuration');\n\n\t\tError.captureStackTrace(this, InvalidGitConfigError);\n\t}\n}\n\nexport interface GitLocation {\n\tpath: string;\n\tversion: string;\n}\n\nfunction parseVersion(raw: string): string {\n\treturn raw?.replace(/^git version /, '');\n}\n\nasync function findSpecificGit(path: string): Promise<GitLocation> {\n\tlet version;\n\ttry {\n\t\tversion = await run<string>(path, ['--version'], 'utf8');\n\t} catch (ex) {\n\t\tif (/bad config/i.test(ex.message)) throw new InvalidGitConfigError(ex);\n\t\tthrow ex;\n\t}\n\n\t// If needed, let's update our path to avoid the search on every command\n\tif (!path || path === 'git') {\n\t\tconst foundPath = findExecutable(path, ['--version']).cmd;\n\n\t\t// Ensure that the path we found works\n\t\ttry {\n\t\t\tversion = await run<string>(foundPath, ['--version'], 'utf8');\n\t\t} catch (ex) {\n\t\t\tif (/bad config/i.test(ex.message)) throw new InvalidGitConfigError(ex);\n\t\t\tthrow ex;\n\t\t}\n\n\t\tpath = foundPath;\n\t}\n\n\treturn {\n\t\tpath: path,\n\t\tversion: parseVersion(version.trim()),\n\t};\n}\n\nasync function findGitDarwin(): Promise<GitLocation> {\n\ttry {\n\t\tlet path = await run<string>('which', ['git'], 'utf8');\n\t\tpath = path.replace(/^\\s+|\\s+$/g, '');\n\n\t\tif (path !== '/usr/bin/git') {\n\t\t\treturn findSpecificGit(path);\n\t\t}\n\n\t\ttry {\n\t\t\tawait run<string>('xcode-select', ['-p'], 'utf8');\n\t\t\treturn findSpecificGit(path);\n\t\t} catch (ex) {\n\t\t\tif (ex.code === 2) {\n\t\t\t\treturn Promise.reject(new UnableToFindGitError(ex));\n\t\t\t}\n\t\t\treturn findSpecificGit(path);\n\t\t}\n\t} catch (ex) {\n\t\treturn Promise.reject(\n\t\t\tex instanceof InvalidGitConfigError || ex instanceof UnableToFindGitError\n\t\t\t\t? ex\n\t\t\t\t: new UnableToFindGitError(ex),\n\t\t);\n\t}\n}\n\nfunction findSystemGitWin32(basePath: string | null | undefined): Promise<GitLocation> {\n\tif (basePath == null || basePath.length === 0) return Promise.reject(new UnableToFindGitError());\n\treturn findSpecificGit(paths.join(basePath, 'Git', 'cmd', 'git.exe'));\n}\n\nfunction findGitWin32(): Promise<GitLocation> {\n\treturn findSystemGitWin32(process.env['ProgramW6432'])\n\t\t.then(null, () => findSystemGitWin32(process.env['ProgramFiles(x86)']))\n\t\t.then(null, () => findSystemGitWin32(process.env['ProgramFiles']))\n\t\t.then(null, () => findSpecificGit('git'));\n}\n\nexport async function findGitPath(paths?: string | string[]): Promise<GitLocation> {\n\ttry {\n\t\tif (paths == null || typeof paths === 'string') {\n\t\t\treturn await findSpecificGit(paths ?? 'git');\n\t\t}\n\n\t\tfor (const path of paths) {\n\t\t\ttry {\n\t\t\t\treturn await findSpecificGit(path);\n\t\t\t} catch {}\n\t\t}\n\n\t\tthrow new UnableToFindGitError();\n\t} catch {\n\t\ttry {\n\t\t\tswitch (process.platform) {\n\t\t\t\tcase 'darwin':\n\t\t\t\t\treturn await findGitDarwin();\n\t\t\t\tcase 'win32':\n\t\t\t\t\treturn await findGitWin32();\n\t\t\t\tdefault:\n\t\t\t\t\treturn Promise.reject(new UnableToFindGitError());\n\t\t\t}\n\t\t} catch (ex) {\n\t\t\treturn Promise.reject(\n\t\t\t\tex instanceof InvalidGitConfigError || ex instanceof UnableToFindGitError\n\t\t\t\t\t? ex\n\t\t\t\t\t: new UnableToFindGitError(ex),\n\t\t\t);\n\t\t}\n\t}\n}\n","'use strict';\nimport { GitCommit, GitCommitLine, GitCommitType } from './commit';\n\nexport class GitBlameCommit extends GitCommit {\n\tstatic override is(commit: any): commit is GitBlameCommit {\n\t\treturn (\n\t\t\tcommit instanceof GitBlameCommit\n\t\t\t//|| (commit.repoPath !== undefined && commit.sha !== undefined && commit.type === GitCommitType.Blame)\n\t\t);\n\t}\n\n\tconstructor(\n\t\trepoPath: string,\n\t\tsha: string,\n\t\tauthor: string,\n\t\temail: string | undefined,\n\t\tauthorDate: Date,\n\t\tcommitterDate: Date,\n\t\tmessage: string,\n\t\tfileName: string,\n\t\toriginalFileName: string | undefined,\n\t\tpreviousSha: string | undefined,\n\t\tpreviousFileName: string | undefined,\n\t\tpublic readonly lines: GitCommitLine[],\n\t) {\n\t\tsuper(\n\t\t\tGitCommitType.Blame,\n\t\t\trepoPath,\n\t\t\tsha,\n\t\t\tauthor,\n\t\t\temail,\n\t\t\tauthorDate,\n\t\t\tcommitterDate,\n\t\t\tmessage,\n\t\t\tfileName,\n\t\t\toriginalFileName,\n\t\t\tpreviousSha,\n\t\t\tpreviousFileName,\n\t\t);\n\t}\n\n\twith(changes: {\n\t\tsha?: string;\n\t\tfileName?: string;\n\t\toriginalFileName?: string | null;\n\t\tpreviousFileName?: string | null;\n\t\tpreviousSha?: string | null;\n\t\tlines?: GitCommitLine[] | null;\n\t}): GitBlameCommit {\n\t\treturn new GitBlameCommit(\n\t\t\tthis.repoPath,\n\t\t\tchanges.sha ?? this.sha,\n\t\t\tthis.author,\n\t\t\tthis.email,\n\t\t\tthis.authorDate,\n\t\t\tthis.committerDate,\n\t\t\tthis.message,\n\t\t\tchanges.fileName ?? this.fileName,\n\t\t\tthis.getChangedValue(changes.originalFileName, this.originalFileName),\n\t\t\tthis.getChangedValue(changes.previousSha, this.previousSha),\n\t\t\tthis.getChangedValue(changes.previousFileName, this.previousFileName),\n\t\t\tthis.getChangedValue(changes.lines, changes.sha ?? changes.fileName ? [] : this.lines) ?? [],\n\t\t);\n\t}\n}\n","'use strict';\nimport { BranchSorting, configuration, DateStyle } from '../../configuration';\nimport { Starred, WorkspaceState } from '../../constants';\nimport { Container } from '../../container';\nimport { Dates, debug, memoize } from '../../system';\nimport { GitRemote, GitRevision } from '../git';\nimport { GitBranchReference, GitReference, PullRequest, PullRequestState } from './models';\nimport { GitStatus } from './status';\n\nconst whitespaceRegex = /\\s/;\nconst detachedHEADRegex = /^(?=.*\\bHEAD\\b)?(?=.*\\bdetached\\b).*$/;\n\nexport const BranchDateFormatting = {\n\tdateFormat: undefined! as string | null,\n\tdateStyle: undefined! as DateStyle,\n\n\treset: () => {\n\t\tBranchDateFormatting.dateFormat = configuration.get('defaultDateFormat');\n\t\tBranchDateFormatting.dateStyle = configuration.get('defaultDateStyle');\n\t},\n};\n\nexport interface GitTrackingState {\n\tahead: number;\n\tbehind: number;\n}\n\nexport enum GitBranchStatus {\n\tAhead = 'ahead',\n\tBehind = 'behind',\n\tDiverged = 'diverged',\n\tLocal = 'local',\n\tMissingUpstream = 'missingUpstream',\n\tRemote = 'remote',\n\tUpToDate = 'upToDate',\n\tUnpublished = 'unpublished',\n}\n\nexport interface BranchSortOptions {\n\tcurrent?: boolean;\n\tmissingUpstream?: boolean;\n\torderBy?: BranchSorting;\n}\n\nexport class GitBranch implements GitBranchReference {\n\tstatic is(branch: any): branch is GitBranch {\n\t\treturn branch instanceof GitBranch;\n\t}\n\n\tstatic isOfRefType(branch: GitReference | undefined) {\n\t\treturn branch?.refType === 'branch';\n\t}\n\n\tstatic sort(branches: GitBranch[], options?: BranchSortOptions) {\n\t\toptions = { current: true, orderBy: configuration.get('sortBranchesBy'), ...options };\n\n\t\tswitch (options.orderBy) {\n\t\t\tcase BranchSorting.DateAsc:\n\t\t\t\treturn branches.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t(options!.missingUpstream\n\t\t\t\t\t\t\t? (a.upstream?.missing ? -1 : 1) - (b.upstream?.missing ? -1 : 1)\n\t\t\t\t\t\t\t: 0) ||\n\t\t\t\t\t\t(options!.current ? (a.current ? -1 : 1) - (b.current ? -1 : 1) : 0) ||\n\t\t\t\t\t\t(a.starred ? -1 : 1) - (b.starred ? -1 : 1) ||\n\t\t\t\t\t\t(b.remote ? -1 : 1) - (a.remote ? -1 : 1) ||\n\t\t\t\t\t\t(a.date == null ? -1 : a.date.getTime()) - (b.date == null ? -1 : b.date.getTime()),\n\t\t\t\t);\n\t\t\tcase BranchSorting.NameAsc:\n\t\t\t\treturn branches.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t(options!.missingUpstream\n\t\t\t\t\t\t\t? (a.upstream?.missing ? -1 : 1) - (b.upstream?.missing ? -1 : 1)\n\t\t\t\t\t\t\t: 0) ||\n\t\t\t\t\t\t(options!.current ? (a.current ? -1 : 1) - (b.current ? -1 : 1) : 0) ||\n\t\t\t\t\t\t(a.starred ? -1 : 1) - (b.starred ? -1 : 1) ||\n\t\t\t\t\t\t(a.name === 'main' ? -1 : 1) - (b.name === 'main' ? -1 : 1) ||\n\t\t\t\t\t\t(a.name === 'master' ? -1 : 1) - (b.name === 'master' ? -1 : 1) ||\n\t\t\t\t\t\t(a.name === 'develop' ? -1 : 1) - (b.name === 'develop' ? -1 : 1) ||\n\t\t\t\t\t\t(b.remote ? -1 : 1) - (a.remote ? -1 : 1) ||\n\t\t\t\t\t\ta.name.localeCompare(b.name, undefined, { numeric: true, sensitivity: 'base' }),\n\t\t\t\t);\n\t\t\tcase BranchSorting.NameDesc:\n\t\t\t\treturn branches.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t(options!.missingUpstream\n\t\t\t\t\t\t\t? (a.upstream?.missing ? -1 : 1) - (b.upstream?.missing ? -1 : 1)\n\t\t\t\t\t\t\t: 0) ||\n\t\t\t\t\t\t(options!.current ? (a.current ? -1 : 1) - (b.current ? -1 : 1) : 0) ||\n\t\t\t\t\t\t(a.starred ? -1 : 1) - (b.starred ? -1 : 1) ||\n\t\t\t\t\t\t(a.name === 'main' ? -1 : 1) - (b.name === 'main' ? -1 : 1) ||\n\t\t\t\t\t\t(a.name === 'master' ? -1 : 1) - (b.name === 'master' ? -1 : 1) ||\n\t\t\t\t\t\t(a.name === 'develop' ? -1 : 1) - (b.name === 'develop' ? -1 : 1) ||\n\t\t\t\t\t\t(b.remote ? -1 : 1) - (a.remote ? -1 : 1) ||\n\t\t\t\t\t\tb.name.localeCompare(a.name, undefined, { numeric: true, sensitivity: 'base' }),\n\t\t\t\t);\n\t\t\tcase BranchSorting.DateDesc:\n\t\t\tdefault:\n\t\t\t\treturn branches.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t(options!.missingUpstream\n\t\t\t\t\t\t\t? (a.upstream?.missing ? -1 : 1) - (b.upstream?.missing ? -1 : 1)\n\t\t\t\t\t\t\t: 0) ||\n\t\t\t\t\t\t(options!.current ? (a.current ? -1 : 1) - (b.current ? -1 : 1) : 0) ||\n\t\t\t\t\t\t(a.starred ? -1 : 1) - (b.starred ? -1 : 1) ||\n\t\t\t\t\t\t(b.remote ? -1 : 1) - (a.remote ? -1 : 1) ||\n\t\t\t\t\t\t(b.date == null ? -1 : b.date.getTime()) - (a.date == null ? -1 : a.date.getTime()),\n\t\t\t\t);\n\t\t}\n\t}\n\n\treadonly refType = 'branch';\n\treadonly detached: boolean;\n\treadonly id: string;\n\treadonly upstream?: { name: string; missing: boolean };\n\treadonly state: GitTrackingState;\n\n\tconstructor(\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly name: string,\n\t\tpublic readonly remote: boolean,\n\t\tpublic readonly current: boolean,\n\t\tpublic readonly date: Date | undefined,\n\t\tpublic readonly sha?: string,\n\t\tupstream?: { name: string; missing: boolean },\n\t\tahead: number = 0,\n\t\tbehind: number = 0,\n\t\tdetached: boolean = false,\n\t\tpublic readonly rebasing: boolean = false,\n\t) {\n\t\tthis.id = `${repoPath}|${remote ? 'remotes/' : 'heads/'}${name}`;\n\n\t\tthis.detached = detached || (this.current ? GitBranch.isDetached(name) : false);\n\t\tif (this.detached) {\n\t\t\tthis.name = GitBranch.formatDetached(this.sha!);\n\t\t}\n\n\t\tthis.upstream = upstream?.name == null || upstream.name.length === 0 ? undefined : upstream;\n\t\tthis.state = {\n\t\t\tahead: ahead,\n\t\t\tbehind: behind,\n\t\t};\n\t}\n\n\tget formattedDate(): string {\n\t\treturn BranchDateFormatting.dateStyle === DateStyle.Absolute\n\t\t\t? this.formatDate(BranchDateFormatting.dateFormat)\n\t\t\t: this.formatDateFromNow();\n\t}\n\n\tget ref() {\n\t\treturn this.detached ? this.sha! : this.name;\n\t}\n\n\t@memoize()\n\tprivate get dateFormatter(): Dates.DateFormatter | undefined {\n\t\treturn this.date == null ? undefined : Dates.getFormatter(this.date);\n\t}\n\n\t@memoize<GitBranch['formatDate']>(format => (format == null ? 'MMMM Do, YYYY h:mma' : format))\n\tformatDate(format?: string | null): string {\n\t\tif (format == null) {\n\t\t\tformat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\treturn this.dateFormatter?.format(format) ?? '';\n\t}\n\n\tformatDateFromNow(): string {\n\t\treturn this.dateFormatter?.fromNow() ?? '';\n\t}\n\n\t@debug()\n\tasync getAssociatedPullRequest(options?: {\n\t\tavatarSize?: number;\n\t\tinclude?: PullRequestState[];\n\t\tlimit?: number;\n\t\ttimeout?: number;\n\t}): Promise<PullRequest | undefined> {\n\t\tconst remote = await this.getRemote();\n\t\tif (remote == null) return undefined;\n\n\t\treturn Container.git.getPullRequestForBranch(this.getNameWithoutRemote(), remote, options);\n\t}\n\n\t@memoize()\n\tgetBasename(): string {\n\t\tconst name = this.getNameWithoutRemote();\n\t\tconst index = name.lastIndexOf('/');\n\t\treturn index !== -1 ? name.substring(index + 1) : name;\n\t}\n\n\t@memoize()\n\tgetNameWithoutRemote(): string {\n\t\treturn this.remote ? this.name.substring(this.name.indexOf('/') + 1) : this.name;\n\t}\n\n\t@memoize()\n\tgetTrackingWithoutRemote(): string | undefined {\n\t\treturn this.upstream?.name.substring(this.upstream.name.indexOf('/') + 1);\n\t}\n\n\t@memoize()\n\tasync getRemote(): Promise<GitRemote | undefined> {\n\t\tconst remoteName = this.getRemoteName();\n\t\tif (remoteName == null) return undefined;\n\n\t\tconst remotes = await Container.git.getRemotes(this.repoPath);\n\t\tif (remotes.length === 0) return undefined;\n\n\t\treturn remotes.find(r => r.name === remoteName);\n\t}\n\n\t@memoize()\n\tgetRemoteName(): string | undefined {\n\t\tif (this.remote) return GitBranch.getRemote(this.name);\n\t\tif (this.upstream != null) return GitBranch.getRemote(this.upstream.name);\n\n\t\treturn undefined;\n\t}\n\n\t@memoize()\n\tasync getStatus(): Promise<GitBranchStatus> {\n\t\tif (this.remote) return GitBranchStatus.Remote;\n\n\t\tif (this.upstream != null) {\n\t\t\tif (this.upstream.missing) return GitBranchStatus.MissingUpstream;\n\t\t\tif (this.state.ahead && this.state.behind) return GitBranchStatus.Diverged;\n\t\t\tif (this.state.ahead) return GitBranchStatus.Ahead;\n\t\t\tif (this.state.behind) return GitBranchStatus.Behind;\n\t\t\treturn GitBranchStatus.UpToDate;\n\t\t}\n\n\t\tconst remotes = await Container.git.getRemotes(this.repoPath);\n\t\tif (remotes.length > 0) return GitBranchStatus.Unpublished;\n\n\t\treturn GitBranchStatus.Local;\n\t}\n\n\tgetTrackingStatus(options?: {\n\t\tcount?: boolean;\n\t\tempty?: string;\n\t\texpand?: boolean;\n\t\ticons?: boolean;\n\t\tprefix?: string;\n\t\tseparator?: string;\n\t\tsuffix?: string;\n\t}): string {\n\t\treturn GitStatus.getUpstreamStatus(this.upstream, this.state, options);\n\t}\n\n\tget starred() {\n\t\tconst starred = Container.context.workspaceState.get<Starred>(WorkspaceState.StarredBranches);\n\t\treturn starred !== undefined && starred[this.id] === true;\n\t}\n\n\tasync star() {\n\t\tawait (await Container.git.getRepository(this.repoPath))?.star(this);\n\t}\n\n\tasync unstar() {\n\t\tawait (await Container.git.getRepository(this.repoPath))?.unstar(this);\n\t}\n\n\tstatic formatDetached(sha: string): string {\n\t\treturn `(${GitRevision.shorten(sha)}...)`;\n\t}\n\n\tstatic getNameWithoutRemote(name: string): string {\n\t\treturn name.substring(name.indexOf('/') + 1);\n\t}\n\n\tstatic getRemote(name: string): string {\n\t\treturn name.substring(0, name.indexOf('/'));\n\t}\n\n\tstatic isDetached(name: string): boolean {\n\t\t// If there is whitespace in the name assume this is not a valid branch name\n\t\t// Deals with detached HEAD states\n\t\treturn whitespaceRegex.test(name) || detachedHEADRegex.test(name);\n\t}\n}\n","'use strict';\nimport { Uri } from 'vscode';\nimport { getAvatarUri } from '../../avatars';\nimport { configuration, DateSource, DateStyle, GravatarDefaultStyle } from '../../configuration';\nimport { Container } from '../../container';\nimport { Dates, memoize } from '../../system';\nimport { CommitFormatter } from '../formatters/formatters';\nimport { GitUri } from '../gitUri';\nimport { GitReference, GitRevision, GitRevisionReference, PullRequest } from './models';\n\nexport interface GitAuthor {\n\tname: string;\n\tlineCount: number;\n}\n\nexport interface GitCommitLine {\n\tsha: string;\n\tpreviousSha?: string;\n\tline: number;\n\toriginalLine: number;\n\tcode?: string;\n}\n\nexport enum GitCommitType {\n\tBlame = 'blame',\n\tLog = 'log',\n\tLogFile = 'logFile',\n\tStash = 'stash',\n\tStashFile = 'stashFile',\n}\n\nexport const CommitDateFormatting = {\n\tdateFormat: undefined! as string | null,\n\tdateSource: undefined! as DateSource,\n\tdateStyle: undefined! as DateStyle,\n\n\treset: () => {\n\t\tCommitDateFormatting.dateFormat = configuration.get('defaultDateFormat');\n\t\tCommitDateFormatting.dateSource = configuration.get('defaultDateSource');\n\t\tCommitDateFormatting.dateStyle = configuration.get('defaultDateStyle');\n\t},\n};\n\nexport abstract class GitCommit implements GitRevisionReference {\n\tstatic is(commit: any): commit is GitCommit {\n\t\treturn commit instanceof GitCommit;\n\t}\n\n\tstatic isOfRefType(commit: GitReference | undefined) {\n\t\treturn commit?.refType === 'revision' || commit?.refType === 'stash';\n\t}\n\n\treadonly refType: GitRevisionReference['refType'] = 'revision';\n\n\tconstructor(\n\t\tpublic readonly type: GitCommitType,\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly sha: string,\n\t\tpublic readonly author: string,\n\t\tpublic readonly email: string | undefined,\n\t\tpublic readonly authorDate: Date,\n\t\tpublic readonly committerDate: Date,\n\t\tpublic readonly message: string,\n\t\tfileName: string,\n\t\tpublic readonly originalFileName: string | undefined,\n\t\tpublic previousSha: string | undefined,\n\t\tpublic previousFileName: string | undefined,\n\t) {\n\t\tthis._fileName = fileName || '';\n\t}\n\n\tget hasConflicts(): boolean {\n\t\treturn false;\n\t}\n\n\tget ref() {\n\t\treturn this.sha;\n\t}\n\n\tget name() {\n\t\treturn this.shortSha;\n\t}\n\n\tprivate readonly _fileName: string;\n\tget fileName() {\n\t\t// If we aren't a single-file commit, return an empty file name (makes it default to the repoPath)\n\t\treturn this.isFile ? this._fileName : '';\n\t}\n\n\tget date(): Date {\n\t\treturn CommitDateFormatting.dateSource === DateSource.Committed ? this.committerDate : this.authorDate;\n\t}\n\n\tget formattedDate(): string {\n\t\treturn CommitDateFormatting.dateStyle === DateStyle.Absolute\n\t\t\t? this.formatDate(CommitDateFormatting.dateFormat)\n\t\t\t: this.formatDateFromNow();\n\t}\n\n\t@memoize()\n\tget shortSha() {\n\t\treturn GitRevision.shorten(this.sha);\n\t}\n\n\tget isFile() {\n\t\treturn (\n\t\t\tthis.type === GitCommitType.Blame ||\n\t\t\tthis.type === GitCommitType.LogFile ||\n\t\t\tthis.type === GitCommitType.StashFile\n\t\t);\n\t}\n\n\tget isStash() {\n\t\treturn this.type === GitCommitType.Stash || this.type === GitCommitType.StashFile;\n\t}\n\n\t@memoize()\n\tget isUncommitted(): boolean {\n\t\treturn GitRevision.isUncommitted(this.sha);\n\t}\n\n\t@memoize()\n\tget isUncommittedStaged(): boolean {\n\t\treturn GitRevision.isUncommittedStaged(this.sha);\n\t}\n\n\t@memoize()\n\tget originalUri(): Uri {\n\t\treturn this.originalFileName ? GitUri.resolveToUri(this.originalFileName, this.repoPath) : this.uri;\n\t}\n\n\tget previousFileSha(): string {\n\t\treturn `${this.sha}^`;\n\t}\n\n\tget previousShortSha() {\n\t\treturn this.previousSha && GitRevision.shorten(this.previousSha);\n\t}\n\n\tget previousUri(): Uri {\n\t\treturn this.previousFileName ? GitUri.resolveToUri(this.previousFileName, this.repoPath) : this.uri;\n\t}\n\n\t@memoize()\n\tget uri(): Uri {\n\t\treturn GitUri.resolveToUri(this.fileName, this.repoPath);\n\t}\n\n\t@memoize()\n\tasync getAssociatedPullRequest(options?: { timeout?: number }): Promise<PullRequest | undefined> {\n\t\tconst remote = await Container.git.getRichRemoteProvider(this.repoPath);\n\t\tif (remote?.provider == null) return undefined;\n\n\t\treturn Container.git.getPullRequestForCommit(this.ref, remote, options);\n\t}\n\n\t@memoize<GitCommit['getPreviousLineDiffUris']>(\n\t\t(uri, editorLine, ref) => `${uri.toString(true)}|${editorLine ?? ''}|${ref ?? ''}`,\n\t)\n\tgetPreviousLineDiffUris(uri: Uri, editorLine: number, ref: string | undefined) {\n\t\tif (!this.isFile) return Promise.resolve(undefined);\n\n\t\treturn Container.git.getPreviousLineDiffUris(this.repoPath, uri, editorLine, ref);\n\t}\n\n\t@memoize()\n\tgetWorkingUri(): Promise<Uri | undefined> {\n\t\tif (!this.isFile) return Promise.resolve(undefined);\n\n\t\treturn Container.git.getWorkingUri(this.repoPath, this.uri);\n\t}\n\n\t@memoize()\n\tprivate get authorDateFormatter(): Dates.DateFormatter {\n\t\treturn Dates.getFormatter(this.authorDate);\n\t}\n\n\t@memoize()\n\tprivate get committerDateFormatter(): Dates.DateFormatter {\n\t\treturn Dates.getFormatter(this.committerDate);\n\t}\n\n\tprivate get dateFormatter(): Dates.DateFormatter {\n\t\treturn CommitDateFormatting.dateSource === DateSource.Committed\n\t\t\t? this.committerDateFormatter\n\t\t\t: this.authorDateFormatter;\n\t}\n\n\t@memoize<GitCommit['formatAuthorDate']>(format => (format == null ? 'MMMM Do, YYYY h:mma' : format))\n\tformatAuthorDate(format?: string | null) {\n\t\tif (format == null) {\n\t\t\tformat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\treturn this.authorDateFormatter.format(format);\n\t}\n\n\tformatAuthorDateFromNow(locale?: string) {\n\t\treturn this.authorDateFormatter.fromNow(locale);\n\t}\n\n\t@memoize<GitCommit['formatCommitterDate']>(format => (format == null ? 'MMMM Do, YYYY h:mma' : format))\n\tformatCommitterDate(format?: string | null) {\n\t\tif (format == null) {\n\t\t\tformat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\treturn this.committerDateFormatter.format(format);\n\t}\n\n\tformatCommitterDateFromNow(locale?: string) {\n\t\treturn this.committerDateFormatter.fromNow(locale);\n\t}\n\n\t@memoize<GitCommit['formatDate']>(format => (format == null ? 'MMMM Do, YYYY h:mma' : format))\n\tformatDate(format?: string | null) {\n\t\tif (format == null) {\n\t\t\tformat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\treturn this.dateFormatter.format(format);\n\t}\n\n\tformatDateFromNow(locale?: string) {\n\t\treturn this.dateFormatter.fromNow(locale);\n\t}\n\n\tgetFormattedPath(options: { relativeTo?: string; suffix?: string; truncateTo?: number } = {}): string {\n\t\treturn GitUri.getFormattedPath(this.fileName, options);\n\t}\n\n\tgetAvatarUri(options?: { defaultStyle?: GravatarDefaultStyle; size?: number }): Uri | Promise<Uri> {\n\t\treturn getAvatarUri(this.email, this, options);\n\t}\n\n\t@memoize()\n\tgetShortMessage() {\n\t\treturn CommitFormatter.fromTemplate(`\\${message}`, this, { messageTruncateAtNewLine: true });\n\t}\n\n\t@memoize()\n\ttoGitUri(previous: boolean = false): GitUri {\n\t\treturn GitUri.fromCommit(this, previous);\n\t}\n\n\tabstract with(changes: {\n\t\ttype?: GitCommitType;\n\t\tsha?: string;\n\t\tfileName?: string;\n\t\toriginalFileName?: string | null;\n\t\tpreviousFileName?: string | null;\n\t\tpreviousSha?: string | null;\n\t}): GitCommit;\n\n\tprotected getChangedValue<T>(change: T | null | undefined, original: T | undefined): T | undefined {\n\t\tif (change === undefined) return original;\n\t\treturn change !== null ? change : undefined;\n\t}\n}\n","'use strict';\nimport { Uri } from 'vscode';\nimport { getAvatarUri } from '../../avatars';\nimport { configuration, ContributorSorting, GravatarDefaultStyle } from '../../configuration';\nimport { Dates, memoize } from '../../system';\n\nexport interface ContributorSortOptions {\n\tcurrent?: true;\n\torderBy?: ContributorSorting;\n}\n\nexport class GitContributor {\n\tstatic is(contributor: any): contributor is GitContributor {\n\t\treturn contributor instanceof GitContributor;\n\t}\n\n\tstatic sort(contributors: GitContributor[], options?: ContributorSortOptions) {\n\t\toptions = { current: true, orderBy: configuration.get('sortContributorsBy'), ...options };\n\n\t\tswitch (options.orderBy) {\n\t\t\tcase ContributorSorting.CountAsc:\n\t\t\t\treturn contributors.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t(a.current ? -1 : 1) - (b.current ? -1 : 1) ||\n\t\t\t\t\t\ta.count - b.count ||\n\t\t\t\t\t\ta.date.getTime() - b.date.getTime(),\n\t\t\t\t);\n\t\t\tcase ContributorSorting.DateDesc:\n\t\t\t\treturn contributors.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t(options!.current ? (a.current ? -1 : 1) - (b.current ? -1 : 1) : 0) ||\n\t\t\t\t\t\tb.date.getTime() - a.date.getTime() ||\n\t\t\t\t\t\tb.count - a.count,\n\t\t\t\t);\n\t\t\tcase ContributorSorting.DateAsc:\n\t\t\t\treturn contributors.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t(options!.current ? (a.current ? -1 : 1) - (b.current ? -1 : 1) : 0) ||\n\t\t\t\t\t\ta.date.getTime() - b.date.getTime() ||\n\t\t\t\t\t\tb.count - a.count,\n\t\t\t\t);\n\t\t\tcase ContributorSorting.NameAsc:\n\t\t\t\treturn contributors.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t(a.current ? -1 : 1) - (b.current ? -1 : 1) ||\n\t\t\t\t\t\ta.name.localeCompare(b.name, undefined, { numeric: true, sensitivity: 'base' }),\n\t\t\t\t);\n\t\t\tcase ContributorSorting.NameDesc:\n\t\t\t\treturn contributors.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t(a.current ? -1 : 1) - (b.current ? -1 : 1) ||\n\t\t\t\t\t\tb.name.localeCompare(a.name, undefined, { numeric: true, sensitivity: 'base' }),\n\t\t\t\t);\n\t\t\tcase ContributorSorting.CountDesc:\n\t\t\tdefault:\n\t\t\t\treturn contributors.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t(a.current ? -1 : 1) - (b.current ? -1 : 1) ||\n\t\t\t\t\t\tb.count - a.count ||\n\t\t\t\t\t\tb.date.getTime() - a.date.getTime(),\n\t\t\t\t);\n\t\t}\n\t}\n\n\tconstructor(\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly name: string,\n\t\tpublic readonly email: string,\n\t\tpublic readonly count: number,\n\t\tpublic readonly date: Date,\n\t\tpublic readonly stats?: {\n\t\t\tfiles: number;\n\t\t\tadditions: number;\n\t\t\tdeletions: number;\n\t\t},\n\t\tpublic readonly current: boolean = false,\n\t) {}\n\n\t@memoize()\n\tprivate get dateFormatter(): Dates.DateFormatter {\n\t\treturn Dates.getFormatter(this.date);\n\t}\n\n\t@memoize<GitContributor['formatDate']>(format => (format == null ? 'MMMM Do, YYYY h:mma' : format))\n\tformatDate(format?: string | null) {\n\t\tif (format == null) {\n\t\t\tformat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\treturn this.dateFormatter.format(format);\n\t}\n\n\tformatDateFromNow(locale?: string) {\n\t\treturn this.dateFormatter.fromNow(locale);\n\t}\n\n\tgetAvatarUri(options?: { defaultStyle?: GravatarDefaultStyle; size?: number }): Uri | Promise<Uri> {\n\t\treturn getAvatarUri(this.email, undefined /*this.repoPath*/, options);\n\t}\n\n\ttoCoauthor(): string {\n\t\treturn `${this.name}${this.email ? ` <${this.email}>` : ''}`;\n\t}\n}\n","'use strict';\nimport { GitDiffParser } from '../parsers/diffParser';\n\nexport interface GitDiffLine {\n\tline: string;\n\tstate: 'added' | 'removed' | 'unchanged';\n}\n\nexport interface GitDiffHunkLine {\n\thunk: GitDiffHunk;\n\tcurrent: GitDiffLine | undefined;\n\tprevious: GitDiffLine | undefined;\n}\n\nexport class GitDiffHunk {\n\tconstructor(\n\t\tpublic readonly diff: string,\n\t\tpublic current: {\n\t\t\tcount: number;\n\t\t\tposition: { start: number; end: number };\n\t\t},\n\t\tpublic previous: {\n\t\t\tcount: number;\n\t\t\tposition: { start: number; end: number };\n\t\t},\n\t) {}\n\n\tget lines(): GitDiffHunkLine[] {\n\t\treturn this.parseHunk().lines;\n\t}\n\n\tget state(): 'added' | 'changed' | 'removed' {\n\t\treturn this.parseHunk().state;\n\t}\n\n\tprivate parsedHunk: { lines: GitDiffHunkLine[]; state: 'added' | 'changed' | 'removed' } | undefined;\n\tprivate parseHunk() {\n\t\tif (this.parsedHunk == null) {\n\t\t\tthis.parsedHunk = GitDiffParser.parseHunk(this);\n\t\t}\n\t\treturn this.parsedHunk;\n\t}\n}\n\nexport interface GitDiff {\n\treadonly hunks: GitDiffHunk[];\n\n\treadonly diff?: string;\n}\n\nexport interface GitDiffShortStat {\n\treadonly files: number;\n\treadonly insertions: number;\n\treadonly deletions: number;\n}\n","'use strict';\nimport { GlyphChars } from '../../constants';\nimport { Strings } from '../../system';\nimport { GitUri } from '../gitUri';\nimport { GitLogCommit } from './logCommit';\n\nexport declare type GitFileStatus = GitFileConflictStatus | GitFileIndexStatus | GitFileWorkingTreeStatus;\n\nexport enum GitFileConflictStatus {\n\tAddedByBoth = 'AA',\n\tAddedByUs = 'AU',\n\tAddedByThem = 'UA',\n\tDeletedByBoth = 'DD',\n\tDeletedByUs = 'DU',\n\tDeletedByThem = 'UD',\n\tModifiedByBoth = 'UU',\n}\n\nexport enum GitFileIndexStatus {\n\tAdded = 'A',\n\tDeleted = 'D',\n\tModified = 'M',\n\tRenamed = 'R',\n\tCopied = 'C',\n}\n\nexport enum GitFileWorkingTreeStatus {\n\tAdded = 'A',\n\tDeleted = 'D',\n\tModified = 'M',\n\tUntracked = '?',\n\tIgnored = '!',\n}\n\nexport interface GitFile {\n\tstatus: GitFileConflictStatus | GitFileIndexStatus | GitFileWorkingTreeStatus;\n\treadonly repoPath?: string;\n\treadonly conflictStatus?: GitFileConflictStatus;\n\treadonly indexStatus?: GitFileIndexStatus;\n\treadonly workingTreeStatus?: GitFileWorkingTreeStatus;\n\treadonly fileName: string;\n\treadonly originalFileName?: string;\n}\n\nexport interface GitFileWithCommit extends GitFile {\n\treadonly commit: GitLogCommit;\n}\n\nexport namespace GitFile {\n\texport function is(file: any | undefined): file is GitFile {\n\t\treturn (\n\t\t\tfile != null &&\n\t\t\t'fileName' in file &&\n\t\t\ttypeof file.fileName === 'string' &&\n\t\t\t'status' in file &&\n\t\t\ttypeof file.status === 'string' &&\n\t\t\tfile.status.length === 1\n\t\t);\n\t}\n\n\texport function getFormattedDirectory(\n\t\tfile: GitFile,\n\t\tincludeOriginal: boolean = false,\n\t\trelativeTo?: string,\n\t): string {\n\t\tconst directory = GitUri.getDirectory(file.fileName, relativeTo);\n\t\treturn includeOriginal && (file.status === 'R' || file.status === 'C') && file.originalFileName\n\t\t\t? `${directory} ${Strings.pad(GlyphChars.ArrowLeft, 1, 1)} ${file.originalFileName}`\n\t\t\t: directory;\n\t}\n\n\texport function getFormattedPath(\n\t\tfile: GitFile,\n\t\toptions: { relativeTo?: string; suffix?: string; truncateTo?: number } = {},\n\t): string {\n\t\treturn GitUri.getFormattedPath(file.fileName, options);\n\t}\n\n\texport function getOriginalRelativePath(file: GitFile, relativeTo?: string): string {\n\t\tif (file.originalFileName == null || file.originalFileName.length === 0) return '';\n\n\t\treturn GitUri.relativeTo(file.originalFileName, relativeTo);\n\t}\n\n\texport function getRelativePath(file: GitFile, relativeTo?: string): string {\n\t\treturn GitUri.relativeTo(file.fileName, relativeTo);\n\t}\n\n\tconst statusIconsMap = {\n\t\t'!': 'icon-status-ignored.svg',\n\t\t'?': 'icon-status-untracked.svg',\n\t\tA: 'icon-status-added.svg',\n\t\tD: 'icon-status-deleted.svg',\n\t\tM: 'icon-status-modified.svg',\n\t\tR: 'icon-status-renamed.svg',\n\t\tC: 'icon-status-copied.svg',\n\t\tAA: 'icon-status-conflict.svg',\n\t\tAU: 'icon-status-conflict.svg',\n\t\tUA: 'icon-status-conflict.svg',\n\t\tDD: 'icon-status-conflict.svg',\n\t\tDU: 'icon-status-conflict.svg',\n\t\tUD: 'icon-status-conflict.svg',\n\t\tUU: 'icon-status-conflict.svg',\n\t\tT: 'icon-status-modified.svg',\n\t};\n\n\texport function getStatusIcon(status: GitFileStatus): string {\n\t\treturn statusIconsMap[status] ?? 'icon-status-unknown.svg';\n\t}\n\n\tconst statusCodiconsMap = {\n\t\t'!': '$(diff-ignored)',\n\t\t'?': '$(diff-added)',\n\t\tA: '$(diff-added)',\n\t\tD: '$(diff-removed)',\n\t\tM: '$(diff-modified)',\n\t\tR: '$(diff-renamed)',\n\t\tC: '$(diff-added)',\n\t\tAA: '$(warning)',\n\t\tAU: '$(warning)',\n\t\tUA: '$(warning)',\n\t\tDD: '$(warning)',\n\t\tDU: '$(warning)',\n\t\tUD: '$(warning)',\n\t\tUU: '$(warning)',\n\t\tT: '$(diff-modified)',\n\t};\n\n\texport function getStatusCodicon(status: GitFileStatus, missing: string = GlyphChars.Space.repeat(4)): string {\n\t\treturn statusCodiconsMap[status] ?? missing;\n\t}\n\n\tconst statusTextMap = {\n\t\t'!': 'Ignored',\n\t\t'?': 'Untracked',\n\t\tA: 'Added',\n\t\tD: 'Deleted',\n\t\tM: 'Modified',\n\t\tR: 'Renamed',\n\t\tC: 'Copied',\n\t\tAA: 'Conflict',\n\t\tAU: 'Conflict',\n\t\tUA: 'Conflict',\n\t\tDD: 'Conflict',\n\t\tDU: 'Conflict',\n\t\tUD: 'Conflict',\n\t\tUU: 'Conflict',\n\t\tT: 'Modified',\n\t};\n\n\texport function getStatusText(status: GitFileStatus): string {\n\t\treturn statusTextMap[status] ?? 'Unknown';\n\t}\n}\n","'use strict';\nimport { Uri } from 'vscode';\nimport { memoize, Strings } from '../../system';\nimport { GitUri } from '../gitUri';\nimport { GitCommit, GitCommitType } from './commit';\nimport { GitFile, GitFileStatus } from './file';\nimport { GitReference } from './models';\n\nconst emptyStats = Object.freeze({\n\tadded: 0,\n\tdeleted: 0,\n\tchanged: 0,\n});\n\nexport interface GitLogCommitLine {\n\tfrom: {\n\t\tline: number;\n\t\tcount: number;\n\t};\n\tto: {\n\t\tline: number;\n\t\tcount: number;\n\t};\n}\n\nexport class GitLogCommit extends GitCommit {\n\tstatic override isOfRefType(commit: GitReference | undefined) {\n\t\treturn commit?.refType === 'revision';\n\t}\n\n\tstatic override is(commit: any): commit is GitLogCommit {\n\t\treturn (\n\t\t\tcommit instanceof GitLogCommit\n\t\t\t// || (commit.repoPath !== undefined &&\n\t\t\t//     commit.sha !== undefined &&\n\t\t\t//     (commit.type === GitCommitType.Log || commit.type === GitCommitType.LogFile))\n\t\t);\n\t}\n\n\tnextSha?: string;\n\tnextFileName?: string;\n\n\tconstructor(\n\t\ttype: GitCommitType,\n\t\trepoPath: string,\n\t\tsha: string,\n\t\tauthor: string,\n\t\temail: string | undefined,\n\t\tauthorDate: Date,\n\t\tcommitterDate: Date,\n\t\tmessage: string,\n\t\tfileName: string,\n\t\tpublic readonly files: GitFile[],\n\t\tpublic readonly status?: GitFileStatus | undefined,\n\t\toriginalFileName?: string | undefined,\n\t\tpreviousSha?: string | undefined,\n\t\tpreviousFileName?: string | undefined,\n\t\tprivate readonly _fileStats?:\n\t\t\t| {\n\t\t\t\t\tinsertions: number;\n\t\t\t\t\tdeletions: number;\n\t\t\t  }\n\t\t\t| undefined,\n\t\tpublic readonly parentShas?: string[],\n\t\tpublic readonly line?: GitLogCommitLine,\n\t) {\n\t\tsuper(\n\t\t\ttype,\n\t\t\trepoPath,\n\t\t\tsha,\n\t\t\tauthor,\n\t\t\temail,\n\t\t\tauthorDate,\n\t\t\tcommitterDate,\n\t\t\tmessage,\n\t\t\tfileName,\n\t\t\toriginalFileName,\n\t\t\tpreviousSha ?? `${sha}^`,\n\t\t\tpreviousFileName,\n\t\t);\n\t}\n\n\t@memoize()\n\toverride get hasConflicts() {\n\t\treturn this.files.some(f => f.conflictStatus != null);\n\t}\n\n\tget isMerge() {\n\t\treturn this.parentShas != null && this.parentShas.length > 1;\n\t}\n\n\tget nextUri(): Uri {\n\t\treturn this.nextFileName ? GitUri.resolveToUri(this.nextFileName, this.repoPath) : this.uri;\n\t}\n\n\toverride get previousFileSha(): string {\n\t\treturn this.isFile ? this.previousSha! : `${this.sha}^`;\n\t}\n\n\tfindFile(fileName: string): GitFile | undefined {\n\t\tfileName = GitUri.relativeTo(fileName, this.repoPath);\n\t\treturn this.files.find(f => f.fileName === fileName);\n\t}\n\n\t@memoize()\n\tgetDiffStatus() {\n\t\tif (this._fileStats !== undefined) {\n\t\t\treturn {\n\t\t\t\tadded: this._fileStats.insertions,\n\t\t\t\tdeleted: this._fileStats.deletions,\n\t\t\t\tchanged: 0,\n\t\t\t};\n\t\t}\n\n\t\tif (this.isFile || this.files.length === 0) return emptyStats;\n\n\t\tconst diff = {\n\t\t\tadded: 0,\n\t\t\tdeleted: 0,\n\t\t\tchanged: 0,\n\t\t};\n\t\tfor (const f of this.files) {\n\t\t\tswitch (f.status) {\n\t\t\t\tcase 'A':\n\t\t\t\tcase '?':\n\t\t\t\t\tdiff.added++;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'D':\n\t\t\t\t\tdiff.deleted++;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdiff.changed++;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn diff;\n\t}\n\n\tgetFormattedDiffStatus({\n\t\tcompact,\n\t\tempty,\n\t\texpand,\n\t\tprefix = '',\n\t\tseparator = ' ',\n\t\tsuffix = '',\n\t}: {\n\t\tcompact?: boolean;\n\t\tempty?: string;\n\t\texpand?: boolean;\n\t\tprefix?: string;\n\t\tseparator?: string;\n\t\tsuffix?: string;\n\t} = {}): string {\n\t\tconst { added, changed, deleted } = this.getDiffStatus();\n\t\tif (added === 0 && changed === 0 && deleted === 0) return empty ?? '';\n\n\t\tif (expand) {\n\t\t\tconst type = this.isFile ? 'line' : 'file';\n\n\t\t\tlet status = '';\n\t\t\tif (added) {\n\t\t\t\tstatus += `${Strings.pluralize(type, added)} added`;\n\t\t\t}\n\t\t\tif (changed) {\n\t\t\t\tstatus += `${status.length === 0 ? '' : separator}${Strings.pluralize(type, changed)} changed`;\n\t\t\t}\n\t\t\tif (deleted) {\n\t\t\t\tstatus += `${status.length === 0 ? '' : separator}${Strings.pluralize(type, deleted)} deleted`;\n\t\t\t}\n\t\t\treturn `${prefix}${status}${suffix}`;\n\t\t}\n\n\t\t// When `isFile` we are getting line changes -- and we can't get changed lines (only inserts and deletes)\n\t\treturn `${prefix}${compact && added === 0 ? '' : `+${added}${separator}`}${\n\t\t\t(compact || this.isFile) && changed === 0 ? '' : `~${changed}${separator}`\n\t\t}${compact && deleted === 0 ? '' : `-${deleted}`}${suffix}`;\n\t}\n\n\ttoFileCommit(file: string | GitFile): GitLogCommit | undefined {\n\t\tconst fileName = typeof file === 'string' ? GitUri.relativeTo(file, this.repoPath) : file.fileName;\n\t\tconst foundFile = this.files.find(f => f.fileName === fileName);\n\t\tif (foundFile == null) return undefined;\n\n\t\tlet sha;\n\t\t// If this is a stash commit with an untracked file\n\t\tif (this.type === GitCommitType.Stash && foundFile.status === '?') {\n\t\t\tsha = `${this.sha}^3`;\n\t\t}\n\n\t\t// If this isn't a single-file commit, we can't trust the previousSha\n\t\tconst previousSha = this.isFile ? this.previousSha : `${this.sha}^`;\n\n\t\treturn this.with({\n\t\t\ttype: this.isStash ? GitCommitType.StashFile : GitCommitType.LogFile,\n\t\t\tsha: sha,\n\t\t\tfileName: foundFile.fileName,\n\t\t\toriginalFileName: foundFile.originalFileName,\n\t\t\tpreviousSha: previousSha,\n\t\t\tpreviousFileName: foundFile.originalFileName ?? foundFile.fileName,\n\t\t\tstatus: foundFile.status,\n\t\t\tfiles: [foundFile],\n\t\t});\n\t}\n\n\twith(changes: {\n\t\ttype?: GitCommitType;\n\t\tsha?: string | null;\n\t\tfileName?: string;\n\t\tauthor?: string;\n\t\temail?: string;\n\t\tauthorDate?: Date;\n\t\tcommittedDate?: Date;\n\t\tmessage?: string;\n\t\toriginalFileName?: string | null;\n\t\tpreviousFileName?: string | null;\n\t\tpreviousSha?: string | null;\n\t\tstatus?: GitFileStatus;\n\t\tfiles?: GitFile[] | null;\n\t}): GitLogCommit {\n\t\treturn new GitLogCommit(\n\t\t\tchanges.type ?? this.type,\n\t\t\tthis.repoPath,\n\t\t\tthis.getChangedValue(changes.sha, this.sha)!,\n\t\t\tchanges.author ?? this.author,\n\t\t\tchanges.email ?? this.email,\n\t\t\tchanges.authorDate ?? this.authorDate,\n\t\t\tchanges.committedDate ?? this.committerDate,\n\t\t\tchanges.message ?? this.message,\n\t\t\tchanges.fileName ?? this.fileName,\n\t\t\tthis.getChangedValue(changes.files, this.files) ?? [],\n\t\t\tchanges.status ?? this.status,\n\t\t\tthis.getChangedValue(changes.originalFileName, this.originalFileName),\n\t\t\tthis.getChangedValue(changes.previousSha, this.previousSha),\n\t\t\tthis.getChangedValue(changes.previousFileName, this.previousFileName),\n\t\t\tthis._fileStats,\n\t\t\tthis.parentShas,\n\t\t\tthis.line,\n\t\t);\n\t}\n}\n","'use strict';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { GitBranch } from './branch';\n\nconst emptyStr = '';\n\nconst rangeRegex = /^(\\S*?)(\\.\\.\\.?)(\\S*)\\s*$/;\nconst shaLikeRegex = /(^[0-9a-f]{40}([\\^@~:]\\S*)?$)|(^[0]{40}(:|-)$)/;\nconst shaRegex = /(^[0-9a-f]{40}$)|(^[0]{40}(:|-)$)/;\nconst shaParentRegex = /(^[0-9a-f]{40})\\^[0-3]?$/;\nconst shaShortenRegex = /^(.*?)([\\^@~:].*)?$/;\nconst uncommittedRegex = /^[0]{40}(?:[\\^@~:]\\S*)?:?$/;\nconst uncommittedStagedRegex = /^[0]{40}([\\^@~]\\S*)?:$/;\n\nfunction isMatch(regex: RegExp, ref: string | undefined) {\n\treturn ref == null || ref.length === 0 ? false : regex.test(ref);\n}\n\nexport namespace GitRevision {\n\texport const deletedOrMissing = '0000000000000000000000000000000000000000-';\n\texport const uncommitted = '0000000000000000000000000000000000000000';\n\texport const uncommittedStaged = '0000000000000000000000000000000000000000:';\n\n\texport function createRange(\n\t\tref1: string | undefined,\n\t\tref2: string | undefined,\n\t\tnotation: '..' | '...' = '..',\n\t): string {\n\t\treturn `${ref1 ?? ''}${notation}${ref2 ?? ''}`;\n\t}\n\n\texport function isRange(ref: string | undefined) {\n\t\treturn ref?.includes('..') ?? false;\n\t}\n\n\texport function isSha(ref: string) {\n\t\treturn isMatch(shaRegex, ref);\n\t}\n\n\texport function isShaLike(ref: string) {\n\t\treturn isMatch(shaLikeRegex, ref);\n\t}\n\n\texport function isShaParent(ref: string) {\n\t\treturn isMatch(shaParentRegex, ref);\n\t}\n\n\texport function isUncommitted(ref: string | undefined) {\n\t\treturn isMatch(uncommittedRegex, ref);\n\t}\n\n\texport function isUncommittedStaged(ref: string | undefined): boolean {\n\t\treturn isMatch(uncommittedStagedRegex, ref);\n\t}\n\n\texport function shorten(\n\t\tref: string | undefined,\n\t\t{\n\t\t\tforce,\n\t\t\tstrings = {},\n\t\t}: {\n\t\t\tforce?: boolean;\n\t\t\tstrings?: { uncommitted?: string; uncommittedStaged?: string; working?: string };\n\t\t} = {},\n\t) {\n\t\tif (ref === deletedOrMissing) return '(deleted)';\n\n\t\tif (ref == null || ref.length === 0) return strings.working ?? emptyStr;\n\t\tif (isUncommitted(ref)) {\n\t\t\treturn isUncommittedStaged(ref)\n\t\t\t\t? strings.uncommittedStaged ?? 'Index'\n\t\t\t\t: strings.uncommitted ?? 'Working Tree';\n\t\t}\n\n\t\tif (GitRevision.isRange(ref)) return ref;\n\t\tif (!force && !isShaLike(ref)) return ref;\n\n\t\t// Don't allow shas to be shortened to less than 5 characters\n\t\tconst len = Math.max(5, Container.config.advanced.abbreviatedShaLength);\n\n\t\t// If we have a suffix, append it\n\t\tconst match = shaShortenRegex.exec(ref);\n\t\tif (match != null) {\n\t\t\tconst [, rev, suffix] = match;\n\n\t\t\tif (suffix != null) {\n\t\t\t\treturn `${rev.substr(0, len)}${suffix}`;\n\t\t\t}\n\t\t}\n\n\t\treturn ref.substr(0, len);\n\t}\n\n\texport function splitRange(ref: string): { ref1: string; ref2: string; notation: '..' | '...' } | undefined {\n\t\tconst match = rangeRegex.exec(ref);\n\t\tif (match == null) return undefined;\n\n\t\tconst [, ref1, notation, ref2] = match;\n\t\treturn {\n\t\t\tref1: ref1,\n\t\t\tnotation: notation as '..' | '...',\n\t\t\tref2: ref2,\n\t\t};\n\t}\n}\n\nexport interface GitBranchReference {\n\treadonly refType: 'branch';\n\tname: string;\n\tref: string;\n\treadonly remote: boolean;\n\treadonly upstream?: { name: string; missing: boolean };\n\trepoPath: string;\n}\n\nexport interface GitRevisionReference {\n\treadonly refType: 'revision' | 'stash';\n\tname: string;\n\tref: string;\n\trepoPath: string;\n\n\tnumber?: string | undefined;\n\tmessage?: string;\n}\n\nexport interface GitStashReference {\n\treadonly refType: 'stash';\n\tname: string;\n\tref: string;\n\trepoPath: string;\n\tnumber: string | undefined;\n\n\tmessage?: string;\n}\n\nexport interface GitTagReference {\n\treadonly refType: 'tag';\n\tname: string;\n\tref: string;\n\trepoPath: string;\n}\n\nexport type GitReference = GitBranchReference | GitRevisionReference | GitStashReference | GitTagReference;\n\nexport namespace GitReference {\n\texport function create(\n\t\tref: string,\n\t\trepoPath: string,\n\t\toptions: { refType: 'branch'; name: string; remote: boolean; upstream?: { name: string; missing: boolean } },\n\t): GitBranchReference;\n\texport function create(\n\t\tref: string,\n\t\trepoPath: string,\n\t\toptions?: { refType: 'revision'; name?: string; message?: string },\n\t): GitRevisionReference;\n\texport function create(\n\t\tref: string,\n\t\trepoPath: string,\n\t\toptions: { refType: 'stash'; name: string; number: string | undefined; message?: string },\n\t): GitStashReference;\n\texport function create(ref: string, repoPath: string, options: { refType: 'tag'; name: string }): GitTagReference;\n\texport function create(\n\t\tref: string,\n\t\trepoPath: string,\n\t\toptions:\n\t\t\t| { refType: 'branch'; name: string; remote: boolean }\n\t\t\t| { refType?: 'revision'; name?: string; message?: string }\n\t\t\t| { refType: 'stash'; name: string; number: string | undefined; message?: string }\n\t\t\t| { refType: 'tag'; name: string } = { refType: 'revision' },\n\t): GitReference {\n\t\tswitch (options.refType) {\n\t\t\tcase 'branch':\n\t\t\t\treturn {\n\t\t\t\t\tname: options.name,\n\t\t\t\t\tref: ref,\n\t\t\t\t\trefType: 'branch',\n\t\t\t\t\tremote: options.remote,\n\t\t\t\t\trepoPath: repoPath,\n\t\t\t\t};\n\t\t\tcase 'stash':\n\t\t\t\treturn {\n\t\t\t\t\tname: options.name,\n\t\t\t\t\tref: ref,\n\t\t\t\t\trefType: 'stash',\n\t\t\t\t\trepoPath: repoPath,\n\t\t\t\t\tnumber: options.number,\n\t\t\t\t\tmessage: options.message,\n\t\t\t\t};\n\t\t\tcase 'tag':\n\t\t\t\treturn {\n\t\t\t\t\tname: options.name,\n\t\t\t\t\tref: ref,\n\t\t\t\t\trefType: 'tag',\n\t\t\t\t\trepoPath: repoPath,\n\t\t\t\t};\n\t\t\tdefault:\n\t\t\t\treturn {\n\t\t\t\t\tname:\n\t\t\t\t\t\toptions.name ?? GitRevision.shorten(ref, { force: true, strings: { working: 'Working Tree' } }),\n\t\t\t\t\tref: ref,\n\t\t\t\t\trefType: 'revision',\n\t\t\t\t\trepoPath: repoPath,\n\t\t\t\t\tmessage: options.message,\n\t\t\t\t};\n\t\t}\n\t}\n\n\texport function fromBranch(branch: GitBranchReference) {\n\t\treturn create(branch.ref, branch.repoPath, {\n\t\t\trefType: branch.refType,\n\t\t\tname: branch.name,\n\t\t\tremote: branch.remote,\n\t\t\tupstream: branch.upstream,\n\t\t});\n\t}\n\n\texport function fromTag(tag: GitTagReference) {\n\t\treturn create(tag.ref, tag.repoPath, {\n\t\t\trefType: tag.refType,\n\t\t\tname: tag.name,\n\t\t});\n\t}\n\n\texport function getNameWithoutRemote(ref: GitReference) {\n\t\tif (ref.refType === 'branch') {\n\t\t\treturn ref.remote ? GitBranch.getNameWithoutRemote(ref.name) : ref.name;\n\t\t}\n\t\treturn ref.name;\n\t}\n\n\texport function isBranch(ref: GitReference | undefined): ref is GitBranchReference {\n\t\treturn ref?.refType === 'branch';\n\t}\n\n\texport function isRevision(ref: GitReference | undefined): ref is GitRevisionReference {\n\t\treturn ref?.refType === 'revision';\n\t}\n\n\texport function isRevisionRange(ref: GitReference | undefined): ref is GitRevisionReference {\n\t\treturn ref?.refType === 'revision' && GitRevision.isRange(ref.ref);\n\t}\n\n\texport function isStash(ref: GitReference | undefined): ref is GitStashReference {\n\t\treturn ref?.refType === 'stash' || (ref?.refType === 'revision' && (ref as any)?.stashName);\n\t}\n\n\texport function isTag(ref: GitReference | undefined): ref is GitTagReference {\n\t\treturn ref?.refType === 'tag';\n\t}\n\n\texport function toString(\n\t\trefs: GitReference | GitReference[] | undefined,\n\t\toptions?: { capitalize?: boolean; expand?: boolean; icon?: boolean; label?: boolean } | false,\n\t) {\n\t\tif (refs == null) return '';\n\n\t\toptions =\n\t\t\toptions === false\n\t\t\t\t? {}\n\t\t\t\t: { expand: true, icon: true, label: options?.label ?? options?.expand ?? true, ...options };\n\n\t\tlet result;\n\t\tif (!Array.isArray(refs) || refs.length === 1) {\n\t\t\tconst ref = Array.isArray(refs) ? refs[0] : refs;\n\t\t\tswitch (ref.refType) {\n\t\t\t\tcase 'branch':\n\t\t\t\t\tresult = `${options.label ? `${ref.remote ? 'remote ' : ''}branch ` : ''}${\n\t\t\t\t\t\toptions.icon ? `$(git-branch)${GlyphChars.Space}${ref.name}${GlyphChars.Space}` : ref.name\n\t\t\t\t\t}`;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'tag':\n\t\t\t\t\tresult = `${options.label ? 'tag ' : ''}${\n\t\t\t\t\t\toptions.icon ? `$(tag)${GlyphChars.Space}${ref.name}${GlyphChars.Space}` : ref.name\n\t\t\t\t\t}`;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault: {\n\t\t\t\t\tif (GitReference.isStash(ref)) {\n\t\t\t\t\t\tlet message;\n\t\t\t\t\t\tif (options.expand && ref.message) {\n\t\t\t\t\t\t\tmessage = `${ref.number != null ? `${ref.number}: ` : ''}${\n\t\t\t\t\t\t\t\tref.message.length > 20\n\t\t\t\t\t\t\t\t\t? `${ref.message.substring(0, 20).trimRight()}${GlyphChars.Ellipsis}`\n\t\t\t\t\t\t\t\t\t: ref.message\n\t\t\t\t\t\t\t}`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresult = `${options.label ? 'stash ' : ''}${\n\t\t\t\t\t\t\toptions.icon\n\t\t\t\t\t\t\t\t? `$(archive)${GlyphChars.Space}${message ?? ref.name}${GlyphChars.Space}`\n\t\t\t\t\t\t\t\t: `${message ?? ref.number ?? ref.name}`\n\t\t\t\t\t\t}`;\n\t\t\t\t\t} else if (GitRevision.isRange(ref.ref)) {\n\t\t\t\t\t\tresult = ref.name;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet message;\n\t\t\t\t\t\tif (options.expand && ref.message) {\n\t\t\t\t\t\t\tmessage =\n\t\t\t\t\t\t\t\tref.message.length > 20\n\t\t\t\t\t\t\t\t\t? ` (${ref.message.substring(0, 20).trimRight()}${GlyphChars.Ellipsis})`\n\t\t\t\t\t\t\t\t\t: ` (${ref.message})`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet name;\n\t\t\t\t\t\tlet prefix;\n\t\t\t\t\t\tif (options.expand && options.label && GitRevision.isShaParent(ref.ref)) {\n\t\t\t\t\t\t\tname = ref.name.endsWith('^') ? ref.name.substr(0, ref.name.length - 1) : ref.name;\n\t\t\t\t\t\t\tprefix = 'before ';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tname = ref.name;\n\t\t\t\t\t\t\tprefix = '';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresult = `${options.label ? `${prefix}commit ` : ''}${\n\t\t\t\t\t\t\toptions.icon\n\t\t\t\t\t\t\t\t? `$(git-commit)${GlyphChars.Space}${name}${message ?? ''}${GlyphChars.Space}`\n\t\t\t\t\t\t\t\t: `${name}${message ?? ''}`\n\t\t\t\t\t\t}`;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn options.capitalize && options.expand && options.label !== false\n\t\t\t\t? `${result[0].toLocaleUpperCase()}${result.substring(1)}`\n\t\t\t\t: result;\n\t\t}\n\n\t\tconst expanded = options.expand ? ` (${refs.map(r => r.name).join(', ')})` : '';\n\t\tswitch (refs[0].refType) {\n\t\t\tcase 'branch':\n\t\t\t\treturn `${refs.length} branches${expanded}`;\n\t\t\tcase 'tag':\n\t\t\t\treturn `${refs.length} tags${expanded}`;\n\t\t\tdefault:\n\t\t\t\treturn `${refs.length} ${GitReference.isStash(refs[0]) ? 'stashes' : 'commits'}${expanded}`;\n\t\t}\n\t}\n}\n\nexport * from './author';\nexport * from './blame';\nexport * from './blameCommit';\nexport * from './branch';\nexport * from './commit';\nexport * from './contributor';\nexport * from './defaultBranch';\nexport * from './diff';\nexport * from './file';\nexport * from './issue';\nexport * from './log';\nexport * from './logCommit';\nexport * from './merge';\nexport * from './pullRequest';\nexport * from './rebase';\nexport * from './reflog';\nexport * from './remote';\nexport * from './remoteProvider';\nexport * from './repository';\nexport * from './shortlog';\nexport * from './stash';\nexport * from './stashCommit';\nexport * from './status';\nexport * from './tag';\nexport * from './tree';\nexport * from './user';\n","'use strict';\nimport { configuration, DateStyle } from '../../configuration';\nimport { Dates, memoize } from '../../system';\nimport { RemoteProviderReference } from './remoteProvider';\n\nexport const PullRequestDateFormatting = {\n\tdateFormat: undefined! as string | null,\n\tdateStyle: undefined! as DateStyle,\n\n\treset: () => {\n\t\tPullRequestDateFormatting.dateFormat = configuration.get('defaultDateFormat');\n\t\tPullRequestDateFormatting.dateStyle = configuration.get('defaultDateStyle');\n\t},\n};\n\nexport enum PullRequestState {\n\tOpen = 'Open',\n\tClosed = 'Closed',\n\tMerged = 'Merged',\n}\n\nexport class PullRequest {\n\tstatic is(pr: any): pr is PullRequest {\n\t\treturn pr instanceof PullRequest;\n\t}\n\n\tconstructor(\n\t\tpublic readonly provider: RemoteProviderReference,\n\t\tpublic readonly author: {\n\t\t\treadonly name: string;\n\t\t\treadonly avatarUrl: string;\n\t\t\treadonly url: string;\n\t\t},\n\t\tpublic readonly id: string,\n\t\tpublic readonly title: string,\n\t\tpublic readonly url: string,\n\t\tpublic readonly state: PullRequestState,\n\t\tpublic readonly date: Date,\n\t\tpublic readonly closedDate?: Date,\n\t\tpublic readonly mergedDate?: Date,\n\t) {}\n\n\tget formattedDate(): string {\n\t\treturn PullRequestDateFormatting.dateStyle === DateStyle.Absolute\n\t\t\t? this.formatDate(PullRequestDateFormatting.dateFormat)\n\t\t\t: this.formatDateFromNow();\n\t}\n\n\t@memoize()\n\tprivate get dateFormatter(): Dates.DateFormatter {\n\t\treturn Dates.getFormatter(this.mergedDate ?? this.closedDate ?? this.date);\n\t}\n\n\t@memoize<PullRequest['formatDate']>(format => (format == null ? 'MMMM Do, YYYY h:mma' : format))\n\tformatDate(format?: string | null) {\n\t\tif (format == null) {\n\t\t\tformat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\treturn this.dateFormatter.format(format);\n\t}\n\n\tformatDateFromNow() {\n\t\treturn this.dateFormatter.fromNow();\n\t}\n\n\t@memoize()\n\tprivate get closedDateFormatter(): Dates.DateFormatter | undefined {\n\t\treturn this.closedDate === undefined ? undefined : Dates.getFormatter(this.closedDate);\n\t}\n\n\t@memoize<PullRequest['formatClosedDate']>(format => (format == null ? 'MMMM Do, YYYY h:mma' : format))\n\tformatClosedDate(format?: string | null) {\n\t\tif (format == null) {\n\t\t\tformat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\treturn this.closedDateFormatter?.format(format) ?? '';\n\t}\n\n\tformatClosedDateFromNow() {\n\t\treturn this.closedDateFormatter?.fromNow() ?? '';\n\t}\n\n\t@memoize()\n\tprivate get mergedDateFormatter(): Dates.DateFormatter | undefined {\n\t\treturn this.mergedDate === undefined ? undefined : Dates.getFormatter(this.mergedDate);\n\t}\n\n\t@memoize<PullRequest['formatMergedDate']>(format => (format == null ? 'MMMM Do, YYYY h:mma' : format))\n\tformatMergedDate(format?: string | null) {\n\t\tif (format == null) {\n\t\t\tformat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\treturn this.mergedDateFormatter?.format(format) ?? '';\n\t}\n\n\tformatMergedDateFromNow() {\n\t\treturn this.mergedDateFormatter?.fromNow() ?? '';\n\t}\n\n\t@memoize()\n\tprivate get updatedDateFormatter(): Dates.DateFormatter {\n\t\treturn Dates.getFormatter(this.date);\n\t}\n\n\t@memoize<PullRequest['formatUpdatedDate']>(format => (format == null ? 'MMMM Do, YYYY h:mma' : format))\n\tformatUpdatedDate(format?: string | null) {\n\t\tif (format == null) {\n\t\t\tformat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\treturn this.updatedDateFormatter.format(format);\n\t}\n\n\tformatUpdatedDateFromNow() {\n\t\treturn this.updatedDateFormatter.fromNow();\n\t}\n}\n","'use strict';\nimport { DateStyle } from '../../config';\nimport { Dates, memoize } from '../../system';\nimport { CommitDateFormatting, GitRevision } from '../git';\n\nexport interface GitReflog {\n\treadonly repoPath: string;\n\treadonly records: GitReflogRecord[];\n\n\treadonly count: number;\n\treadonly total: number;\n\treadonly limit: number | undefined;\n\treadonly hasMore: boolean;\n\tmore?(limit: number | undefined): Promise<GitReflog | undefined>;\n}\n\nexport class GitReflogRecord {\n\tprivate _previousSha: string | undefined;\n\n\tconstructor(\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly sha: string,\n\t\tprivate _selector: string,\n\t\tpublic readonly date: Date,\n\t\tpublic readonly command: string,\n\t\tpublic readonly commandArgs: string | undefined,\n\t\tpublic readonly details: string | undefined,\n\t) {}\n\n\t@memoize<GitReflogRecord['formatDate']>(format => (format == null ? 'MMMM Do, YYYY h:mma' : format))\n\tformatDate(format?: string | null) {\n\t\tif (format == null) {\n\t\t\tformat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\treturn this.dateFormatter.format(format);\n\t}\n\n\tformatDateFromNow() {\n\t\treturn this.dateFormatter.fromNow();\n\t}\n\n\tget formattedDate(): string {\n\t\treturn CommitDateFormatting.dateStyle === DateStyle.Absolute\n\t\t\t? this.formatDate(CommitDateFormatting.dateFormat)\n\t\t\t: this.formatDateFromNow();\n\t}\n\n\t@memoize()\n\tget HEAD() {\n\t\tif (this._selector == null || this._selector.length === 0) return '';\n\n\t\tif (this._selector.startsWith('refs/heads')) {\n\t\t\treturn this._selector.substr(11);\n\t\t}\n\n\t\tif (this._selector.startsWith('refs/remotes')) {\n\t\t\treturn this._selector.substr(13);\n\t\t}\n\n\t\treturn this._selector;\n\t}\n\n\tget previousSha() {\n\t\treturn this._previousSha;\n\t}\n\n\t@memoize()\n\tget previousShortSha() {\n\t\treturn GitRevision.shorten(this._previousSha);\n\t}\n\n\tget selector() {\n\t\treturn this._selector;\n\t}\n\n\t@memoize()\n\tget shortSha() {\n\t\treturn GitRevision.shorten(this.sha);\n\t}\n\n\tupdate(previousSha?: string, selector?: string) {\n\t\tif (previousSha !== undefined) {\n\t\t\tthis._previousSha = previousSha;\n\t\t}\n\t\tif (selector !== undefined) {\n\t\t\tthis._selector = selector;\n\t\t}\n\t}\n\n\t@memoize()\n\tprivate get dateFormatter(): Dates.DateFormatter {\n\t\treturn Dates.getFormatter(this.date);\n\t}\n}\n","'use strict';\nimport { WorkspaceState } from '../../constants';\nimport { Container } from '../../container';\nimport { RemoteProvider, RichRemoteProvider } from '../remotes/factory';\n\nexport enum GitRemoteType {\n\tFetch = 'fetch',\n\tPush = 'push',\n}\n\nexport class GitRemote<TProvider extends RemoteProvider | undefined = RemoteProvider | RichRemoteProvider | undefined> {\n\tstatic getHighlanderProviders(remotes: GitRemote<RemoteProvider>[]) {\n\t\tif (remotes.length === 0) return undefined;\n\n\t\tconst remote = remotes.length === 1 ? remotes[0] : remotes.find(r => r.default);\n\t\tif (remote != null) return [remote.provider];\n\n\t\tconst providerName = remotes[0].provider.name;\n\t\tif (remotes.every(r => r.provider.name === providerName)) return remotes.map(r => r.provider);\n\n\t\treturn undefined;\n\t}\n\n\tstatic getHighlanderProviderName(remotes: GitRemote<RemoteProvider>[]) {\n\t\tif (remotes.length === 0) return undefined;\n\n\t\tconst remote = remotes.length === 1 ? remotes[0] : remotes.find(r => r.default);\n\t\tif (remote != null) return remote.provider.name;\n\n\t\tconst providerName = remotes[0].provider.name;\n\t\t// Only use the real provider name if there is only 1 type of provider\n\t\tif (remotes.every(r => r.provider.name === providerName)) return providerName;\n\n\t\treturn undefined;\n\t}\n\n\tstatic is(remote: any): remote is GitRemote {\n\t\treturn remote instanceof GitRemote;\n\t}\n\n\tstatic sort(remotes: GitRemote[]) {\n\t\treturn remotes.sort(\n\t\t\t(a, b) =>\n\t\t\t\t(a.default ? -1 : 1) - (b.default ? -1 : 1) ||\n\t\t\t\t(a.name === 'origin' ? -1 : 1) - (b.name === 'origin' ? -1 : 1) ||\n\t\t\t\ta.name.localeCompare(b.name, undefined, { numeric: true, sensitivity: 'base' }),\n\t\t);\n\t}\n\n\tconstructor(\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly id: string,\n\t\tpublic readonly name: string,\n\t\tpublic readonly scheme: string,\n\t\tpublic readonly domain: string,\n\t\tpublic readonly path: string,\n\t\tpublic readonly provider: TProvider,\n\t\tpublic readonly urls: { type: GitRemoteType; url: string }[],\n\t) {}\n\n\tget default() {\n\t\tconst defaultRemote = Container.context.workspaceState.get<string>(WorkspaceState.DefaultRemote);\n\t\treturn this.id === defaultRemote;\n\t}\n\n\tget url(): string {\n\t\tlet bestUrl: string | undefined;\n\t\tfor (const remoteUrl of this.urls) {\n\t\t\tif (remoteUrl.type === GitRemoteType.Push) {\n\t\t\t\treturn remoteUrl.url;\n\t\t\t}\n\n\t\t\tif (bestUrl == null) {\n\t\t\t\tbestUrl = remoteUrl.url;\n\t\t\t}\n\t\t}\n\n\t\treturn bestUrl!;\n\t}\n\n\tasync setAsDefault(state: boolean = true, updateViews: boolean = true) {\n\t\tvoid (await Container.context.workspaceState.update(WorkspaceState.DefaultRemote, state ? this.id : undefined));\n\n\t\t// TODO@eamodio this is UGLY\n\t\tif (updateViews) {\n\t\t\tvoid (await Container.remotesView.refresh());\n\t\t\tvoid (await Container.repositoriesView.refresh());\n\t\t}\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport {\n\tcommands,\n\tConfigurationChangeEvent,\n\tDisposable,\n\tEvent,\n\tEventEmitter,\n\tProgressLocation,\n\tRelativePattern,\n\tUri,\n\twindow,\n\tworkspace,\n\tWorkspaceFolder,\n} from 'vscode';\nimport { CreatePullRequestActionContext } from '../../api/gitlens';\nimport { executeActionCommand } from '../../commands';\nimport { configuration } from '../../configuration';\nimport { BuiltInGitCommands, BuiltInGitConfiguration, Starred, WorkspaceState } from '../../constants';\nimport { Container } from '../../container';\nimport { Logger } from '../../logger';\nimport { Messages } from '../../messages';\nimport { Arrays, Dates, debug, Functions, gate, Iterables, log, logName } from '../../system';\nimport { runGitCommandInTerminal } from '../../terminal';\nimport {\n\tGitBranch,\n\tGitContributor,\n\tGitDiffShortStat,\n\tGitRemote,\n\tGitStash,\n\tGitStatus,\n\tGitTag,\n\tSearchPattern,\n} from '../git';\nimport { GitService } from '../gitService';\nimport { GitUri } from '../gitUri';\nimport { RemoteProviderFactory, RemoteProviders, RichRemoteProvider } from '../remotes/factory';\nimport {\n\tBranchSortOptions,\n\tGitBranchReference,\n\tGitLog,\n\tGitLogCommit,\n\tGitMergeStatus,\n\tGitRebaseStatus,\n\tGitReference,\n\tGitTagReference,\n\tTagSortOptions,\n} from './models';\n\nexport const enum RepositoryChange {\n\t// FileSystem = 'filesystem',\n\tUnknown = 'unknown',\n\n\t// No file watching required\n\tClosed = 'closed',\n\tIgnores = 'ignores',\n\tStarred = 'starred',\n\n\t// File watching required\n\tCherryPick = 'cherrypick',\n\tConfig = 'config',\n\tHeads = 'heads',\n\tIndex = 'index',\n\tMerge = 'merge',\n\tRebase = 'rebase',\n\tRemotes = 'remotes',\n\tRemoteProviders = 'providers',\n\tStash = 'stash',\n\t/*\n\t * Union of Cherry, Merge, and Rebase\n\t */\n\tStatus = 'status',\n\tTags = 'tags',\n}\n\nexport const enum RepositoryChangeComparisonMode {\n\tAny,\n\tAll,\n\tExclusive,\n}\n\nexport class RepositoryChangeEvent {\n\tprivate readonly _changes: Set<RepositoryChange>;\n\n\tconstructor(public readonly repository: Repository, changes: RepositoryChange[]) {\n\t\tthis._changes = new Set(changes);\n\t}\n\n\ttoString(changesOnly: boolean = false): string {\n\t\treturn changesOnly\n\t\t\t? `changes=${Iterables.join(this._changes, ', ')}`\n\t\t\t: `{ repository: ${this.repository?.name ?? ''}, changes: ${Iterables.join(this._changes, ', ')} }`;\n\t}\n\n\tchanged(...args: [...RepositoryChange[], RepositoryChangeComparisonMode]) {\n\t\tlet affected = args.slice(0, -1) as RepositoryChange[];\n\t\tconst mode = args[args.length - 1] as RepositoryChangeComparisonMode;\n\n\t\t// If we don't support file watching, then treat Unknown as acceptable for any change other than Closed/Ignores/Starred, i.e. any changes that require file watching\n\t\tif (!this.repository.supportsChangeEvents) {\n\t\t\tif (this._changes.has(RepositoryChange.Unknown)) {\n\t\t\t\taffected = affected.filter(\n\t\t\t\t\tc =>\n\t\t\t\t\t\tc === RepositoryChange.Closed ||\n\t\t\t\t\t\tc === RepositoryChange.Ignores ||\n\t\t\t\t\t\tc === RepositoryChange.Starred,\n\t\t\t\t);\n\t\t\t\tif (affected.length === 0) return true;\n\t\t\t}\n\t\t}\n\n\t\tif (mode === RepositoryChangeComparisonMode.Any) {\n\t\t\treturn Iterables.some(this._changes, c => affected.includes(c));\n\t\t}\n\n\t\tlet changes = this._changes;\n\n\t\tif (mode === RepositoryChangeComparisonMode.Exclusive) {\n\t\t\tif (\n\t\t\t\taffected.includes(RepositoryChange.CherryPick) ||\n\t\t\t\taffected.includes(RepositoryChange.Merge) ||\n\t\t\t\taffected.includes(RepositoryChange.Rebase)\n\t\t\t) {\n\t\t\t\tif (!affected.includes(RepositoryChange.Status)) {\n\t\t\t\t\taffected.push(RepositoryChange.Status);\n\t\t\t\t}\n\t\t\t} else if (affected.includes(RepositoryChange.Status)) {\n\t\t\t\tchanges = new Set(changes);\n\t\t\t\tchanges.delete(RepositoryChange.CherryPick);\n\t\t\t\tchanges.delete(RepositoryChange.Merge);\n\t\t\t\tchanges.delete(RepositoryChange.Rebase);\n\t\t\t}\n\t\t}\n\n\t\tconst intersection = [...Iterables.filter(changes, c => affected.includes(c))];\n\t\treturn mode === RepositoryChangeComparisonMode.Exclusive\n\t\t\t? intersection.length === changes.size\n\t\t\t: intersection.length === affected.length;\n\t}\n\n\twith(changes: RepositoryChange[]) {\n\t\treturn new RepositoryChangeEvent(this.repository, [...this._changes, ...changes]);\n\t}\n}\n\nexport interface RepositoryFileSystemChangeEvent {\n\treadonly repository?: Repository;\n\treadonly uris: Uri[];\n}\n\n@logName<Repository>((r, name) => `${name}(${r.id})`)\nexport class Repository implements Disposable {\n\tstatic formatLastFetched(lastFetched: number, short: boolean = true): string {\n\t\tconst formatter = Dates.getFormatter(new Date(lastFetched));\n\t\tif (Date.now() - lastFetched < Dates.MillisecondsPerDay) {\n\t\t\treturn formatter.fromNow();\n\t\t}\n\n\t\tif (short) {\n\t\t\treturn formatter.format(Container.config.defaultDateShortFormat ?? 'MMM D, YYYY');\n\t\t}\n\n\t\tlet format =\n\t\t\tContainer.config.defaultDateFormat ??\n\t\t\t`dddd, MMMM Do, YYYY [at] ${Container.config.defaultTimeFormat ?? 'h:mma'}`;\n\t\tif (!/[hHm]/.test(format)) {\n\t\t\tformat += ` [at] ${Container.config.defaultTimeFormat ?? 'h:mma'}`;\n\t\t}\n\t\treturn formatter.format(format);\n\t}\n\n\tstatic getLastFetchedUpdateInterval(lastFetched: number): number {\n\t\tconst timeDiff = Date.now() - lastFetched;\n\t\treturn timeDiff < Dates.MillisecondsPerDay\n\t\t\t? (timeDiff < Dates.MillisecondsPerHour ? Dates.MillisecondsPerMinute : Dates.MillisecondsPerHour) / 2\n\t\t\t: 0;\n\t}\n\n\tstatic sort(repositories: Repository[]) {\n\t\treturn repositories.sort((a, b) => (a.starred ? -1 : 1) - (b.starred ? -1 : 1) || a.index - b.index);\n\t}\n\n\tprivate _onDidChange = new EventEmitter<RepositoryChangeEvent>();\n\tget onDidChange(): Event<RepositoryChangeEvent> {\n\t\treturn this._onDidChange.event;\n\t}\n\n\tprivate _onDidChangeFileSystem = new EventEmitter<RepositoryFileSystemChangeEvent>();\n\tget onDidChangeFileSystem(): Event<RepositoryFileSystemChangeEvent> {\n\t\treturn this._onDidChangeFileSystem.event;\n\t}\n\n\treadonly formattedName: string;\n\treadonly id: string;\n\treadonly index: number;\n\treadonly name: string;\n\treadonly normalizedPath: string;\n\n\tprivate _branch: Promise<GitBranch | undefined> | undefined;\n\tprivate readonly _disposable: Disposable;\n\tprivate _fireChangeDebounced: (() => void) | undefined = undefined;\n\tprivate _fireFileSystemChangeDebounced: (() => void) | undefined = undefined;\n\tprivate _fsWatchCounter = 0;\n\tprivate _fsWatcherDisposable: Disposable | undefined;\n\tprivate _pendingFileSystemChange?: RepositoryFileSystemChangeEvent;\n\tprivate _pendingRepoChange?: RepositoryChangeEvent;\n\tprivate _providers: RemoteProviders | undefined;\n\tprivate _remotes: Promise<GitRemote[]> | undefined;\n\tprivate _remotesDisposable: Disposable | undefined;\n\tprivate _repoWatcherDisposable: Disposable | undefined;\n\tprivate _suspended: boolean;\n\n\tconstructor(\n\t\tpublic readonly folder: WorkspaceFolder,\n\t\tpublic readonly path: string,\n\t\tpublic readonly root: boolean,\n\t\tprivate readonly onAnyRepositoryChanged: (repo: Repository, e: RepositoryChangeEvent) => void,\n\t\tsuspended: boolean,\n\t\tclosed: boolean = false,\n\t) {\n\t\tconst relativePath = paths.relative(folder.uri.fsPath, path);\n\t\tif (root) {\n\t\t\t// Check if the repository is not contained by a workspace folder\n\t\t\tconst repoFolder = workspace.getWorkspaceFolder(GitUri.fromRepoPath(path));\n\t\t\tif (repoFolder == null) {\n\t\t\t\t// If it isn't within a workspace folder we can't get change events, see: https://github.com/Microsoft/vscode/issues/3025\n\t\t\t\tthis._supportsChangeEvents = false;\n\t\t\t\tthis.formattedName = this.name = paths.basename(path);\n\t\t\t} else {\n\t\t\t\tthis.formattedName = this.name = folder.name;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.formattedName = relativePath ? `${folder.name} (${relativePath})` : folder.name;\n\t\t\tthis.name = folder.name;\n\t\t}\n\t\tthis.index = folder.index;\n\n\t\tthis.normalizedPath = (path.endsWith('/') ? path : `${path}/`).toLowerCase();\n\t\tthis.id = this.normalizedPath;\n\n\t\tthis._suspended = suspended;\n\t\tthis._closed = closed;\n\n\t\t// TODO: createFileSystemWatcher doesn't work unless the folder is part of the workspaceFolders\n\t\t// https://github.com/Microsoft/vscode/issues/3025\n\t\tconst watcher = workspace.createFileSystemWatcher(\n\t\t\tnew RelativePattern(\n\t\t\t\tfolder,\n\t\t\t\t'{\\\n**/.git/config,\\\n**/.git/index,\\\n**/.git/HEAD,\\\n**/.git/*_HEAD,\\\n**/.git/MERGE_*,\\\n**/.git/refs/**,\\\n**/.git/rebase-merge/**,\\\n**/.git/sequencer/**,\\\n**/.gitignore\\\n}',\n\t\t\t),\n\t\t);\n\t\tthis._disposable = Disposable.from(\n\t\t\twatcher,\n\t\t\twatcher.onDidChange(this.onRepositoryChanged, this),\n\t\t\twatcher.onDidCreate(this.onRepositoryChanged, this),\n\t\t\twatcher.onDidDelete(this.onRepositoryChanged, this),\n\t\t\tconfiguration.onDidChange(this.onConfigurationChanged, this),\n\t\t);\n\t\tthis.onConfigurationChanged();\n\n\t\tif (!this.supportsChangeEvents) {\n\t\t\tvoid this.tryWatchingForChangesViaBuiltInApi();\n\n\t\t\tif (Logger.willLog('debug')) {\n\t\t\t\tLogger.debug(\n\t\t\t\t\t`Repository(${\n\t\t\t\t\t\tthis.id\n\t\t\t\t\t}) doesn't support file watching; path=${path}, workspaceFolders=${workspace.workspaceFolders\n\t\t\t\t\t\t?.map(wf => wf.uri.fsPath)\n\t\t\t\t\t\t.join('; ')}`,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tdispose() {\n\t\tthis.stopWatchingFileSystem();\n\n\t\t// // Clean up any disposables in storage\n\t\t// for (const item of this.storage.values()) {\n\t\t//     if (item != null && typeof item.dispose === 'function') {\n\t\t//         item.dispose();\n\t\t//     }\n\t\t// }\n\n\t\tthis._remotesDisposable?.dispose();\n\t\tthis._repoWatcherDisposable?.dispose();\n\t\tthis._disposable.dispose();\n\t}\n\n\tprivate _supportsChangeEvents: boolean = true;\n\tget supportsChangeEvents(): boolean {\n\t\treturn this._supportsChangeEvents;\n\t}\n\n\tprivate _updatedAt: number = 0;\n\tget updatedAt(): number {\n\t\treturn this._updatedAt;\n\t}\n\n\tprivate onConfigurationChanged(e?: ConfigurationChangeEvent) {\n\t\tif (configuration.changed(e, 'remotes', this.folder.uri)) {\n\t\t\tthis._providers = RemoteProviderFactory.loadProviders(configuration.get('remotes', this.folder.uri));\n\n\t\t\tif (e != null) {\n\t\t\t\tthis.resetCaches('remotes');\n\t\t\t\tthis.fireChange(RepositoryChange.Remotes);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onFileSystemChanged(uri: Uri) {\n\t\t// Ignore .git changes\n\t\tif (/\\.git(?:\\/|\\\\|$)/.test(uri.fsPath)) return;\n\n\t\tthis.fireFileSystemChange(uri);\n\t}\n\n\t@debug()\n\tprivate onRepositoryChanged(uri: Uri | undefined) {\n\t\tthis._lastFetched = undefined;\n\n\t\tif (uri == null) {\n\t\t\tthis.fireChange(RepositoryChange.Unknown);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (uri.path.endsWith('.git/config')) {\n\t\t\tthis.resetCaches();\n\t\t\tthis.fireChange(RepositoryChange.Config, RepositoryChange.Remotes);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (uri.path.endsWith('.git/index')) {\n\t\t\tthis.fireChange(RepositoryChange.Index);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (uri.path.endsWith('.git/HEAD') || uri.path.endsWith('.git/ORIG_HEAD')) {\n\t\t\tthis.resetCaches('branch');\n\t\t\tthis.fireChange(RepositoryChange.Heads);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (uri.path.endsWith('.git/refs/stash')) {\n\t\t\tthis.fireChange(RepositoryChange.Stash);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (uri.path.endsWith('.git/CHERRY_PICK_HEAD')) {\n\t\t\tthis.fireChange(RepositoryChange.CherryPick, RepositoryChange.Status);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (uri.path.endsWith('.git/MERGE_HEAD')) {\n\t\t\tthis.fireChange(RepositoryChange.Merge, RepositoryChange.Status);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (uri.path.endsWith('.git/REBASE_HEAD') || /\\.git\\/rebase-merge/.test(uri.path)) {\n\t\t\tthis.fireChange(RepositoryChange.Rebase, RepositoryChange.Status);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (uri.path.endsWith('/.gitignore')) {\n\t\t\tthis.fireChange(RepositoryChange.Ignores);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst match = /\\.git\\/refs\\/(heads|remotes|tags)/.exec(uri.path);\n\t\tif (match != null) {\n\t\t\tswitch (match[1]) {\n\t\t\t\tcase 'heads':\n\t\t\t\t\tthis.resetCaches('branch');\n\t\t\t\t\tthis.fireChange(RepositoryChange.Heads);\n\n\t\t\t\t\treturn;\n\t\t\t\tcase 'remotes':\n\t\t\t\t\tthis.resetCaches();\n\t\t\t\t\tthis.fireChange(RepositoryChange.Remotes);\n\n\t\t\t\t\treturn;\n\t\t\t\tcase 'tags':\n\t\t\t\t\tthis.fireChange(RepositoryChange.Tags);\n\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.fireChange(RepositoryChange.Unknown);\n\t}\n\n\tprivate _closed: boolean = false;\n\tget closed(): boolean {\n\t\treturn this._closed;\n\t}\n\tset closed(value: boolean) {\n\t\tconst changed = this._closed !== value;\n\t\tthis._closed = value;\n\t\tif (changed) {\n\t\t\tthis.fireChange(RepositoryChange.Closed);\n\t\t}\n\t}\n\n\t@gate()\n\t@log()\n\tbranch(...args: string[]) {\n\t\tthis.runTerminalCommand('branch', ...args);\n\t}\n\n\t@gate()\n\t@log()\n\tbranchDelete(\n\t\tbranches: GitBranchReference | GitBranchReference[],\n\t\t{ force, remote }: { force?: boolean; remote?: boolean } = {},\n\t) {\n\t\tif (!Array.isArray(branches)) {\n\t\t\tbranches = [branches];\n\t\t}\n\n\t\tconst localBranches = branches.filter(b => !b.remote);\n\t\tif (localBranches.length !== 0) {\n\t\t\tconst args = ['--delete'];\n\t\t\tif (force) {\n\t\t\t\targs.push('--force');\n\t\t\t}\n\t\t\tthis.runTerminalCommand('branch', ...args, ...branches.map(b => b.ref));\n\n\t\t\tif (remote) {\n\t\t\t\tconst trackingBranches = localBranches.filter(b => b.upstream != null);\n\t\t\t\tif (trackingBranches.length !== 0) {\n\t\t\t\t\tconst branchesByOrigin = Arrays.groupByMap(trackingBranches, b =>\n\t\t\t\t\t\tGitBranch.getRemote(b.upstream!.name),\n\t\t\t\t\t);\n\n\t\t\t\t\tfor (const [remote, branches] of branchesByOrigin.entries()) {\n\t\t\t\t\t\tthis.runTerminalCommand(\n\t\t\t\t\t\t\t'push',\n\t\t\t\t\t\t\t'-d',\n\t\t\t\t\t\t\tremote,\n\t\t\t\t\t\t\t...branches.map(b => GitBranch.getNameWithoutRemote(b.upstream!.name)),\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst remoteBranches = branches.filter(b => b.remote);\n\t\tif (remoteBranches.length !== 0) {\n\t\t\tconst branchesByOrigin = Arrays.groupByMap(remoteBranches, b => GitBranch.getRemote(b.name));\n\n\t\t\tfor (const [remote, branches] of branchesByOrigin.entries()) {\n\t\t\t\tthis.runTerminalCommand(\n\t\t\t\t\t'push',\n\t\t\t\t\t'-d',\n\t\t\t\t\tremote,\n\t\t\t\t\t...branches.map(b => GitReference.getNameWithoutRemote(b)),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\t@gate(() => '')\n\t@log()\n\tcherryPick(...args: string[]) {\n\t\tthis.runTerminalCommand('cherry-pick', ...args);\n\t}\n\n\tcontainsUri(uri: Uri) {\n\t\tif (GitUri.is(uri)) {\n\t\t\turi = uri.repoPath != null ? GitUri.file(uri.repoPath) : uri.documentUri();\n\t\t}\n\n\t\treturn this.folder === workspace.getWorkspaceFolder(uri);\n\t}\n\n\t@gate()\n\t@log()\n\tasync fetch(\n\t\toptions: {\n\t\t\tall?: boolean;\n\t\t\tbranch?: GitBranchReference;\n\t\t\tprogress?: boolean;\n\t\t\tprune?: boolean;\n\t\t\tpull?: boolean;\n\t\t\tremote?: string;\n\t\t} = {},\n\t) {\n\t\tconst { progress, ...opts } = { progress: true, ...options };\n\t\tif (!progress) return this.fetchCore(opts);\n\n\t\treturn void (await window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle:\n\t\t\t\t\topts.branch != null\n\t\t\t\t\t\t? `${opts.pull ? 'Pulling' : 'Fetching'} ${opts.branch.name}...`\n\t\t\t\t\t\t: `Fetching ${opts.remote ? `${opts.remote} of ` : ''}${this.formattedName}...`,\n\t\t\t},\n\t\t\t() => this.fetchCore(opts),\n\t\t));\n\t}\n\n\tprivate async fetchCore(\n\t\toptions: { all?: boolean; branch?: GitBranchReference; prune?: boolean; pull?: boolean; remote?: string } = {},\n\t) {\n\t\ttry {\n\t\t\tvoid (await Container.git.fetch(this.path, options));\n\n\t\t\tthis.fireChange(RepositoryChange.Unknown);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to fetch repository');\n\t\t}\n\t}\n\n\tasync getBranch(name?: string): Promise<GitBranch | undefined> {\n\t\tif (name) {\n\t\t\tconst [branch] = await this.getBranches({ filter: b => b.name === name });\n\t\t\treturn branch;\n\t\t}\n\n\t\tif (this._branch == null || !this.supportsChangeEvents) {\n\t\t\tthis._branch = Container.git.getBranch(this.path);\n\t\t}\n\t\treturn this._branch;\n\t}\n\n\tgetBranches(\n\t\toptions: {\n\t\t\tfilter?: (b: GitBranch) => boolean;\n\t\t\tsort?: boolean | BranchSortOptions;\n\t\t} = {},\n\t): Promise<GitBranch[]> {\n\t\treturn Container.git.getBranches(this.path, options);\n\t}\n\n\tgetBranchesAndOrTags(\n\t\toptions: {\n\t\t\tfilter?: { branches?: (b: GitBranch) => boolean; tags?: (t: GitTag) => boolean };\n\t\t\tinclude?: 'all' | 'branches' | 'tags';\n\t\t\tsort?: boolean | { branches?: BranchSortOptions; tags?: TagSortOptions };\n\t\t} = {},\n\t) {\n\t\treturn Container.git.getBranchesAndOrTags(this.path, options);\n\t}\n\n\tgetChangedFilesCount(sha?: string): Promise<GitDiffShortStat | undefined> {\n\t\treturn Container.git.getChangedFilesCount(this.path, sha);\n\t}\n\n\tgetCommit(ref: string): Promise<GitLogCommit | undefined> {\n\t\treturn Container.git.getCommit(this.path, ref);\n\t}\n\n\tgetContributors(options?: { all?: boolean; ref?: string; stats?: boolean }): Promise<GitContributor[]> {\n\t\treturn Container.git.getContributors(this.path, options);\n\t}\n\n\tprivate _lastFetched: number | undefined;\n\t@gate()\n\tasync getLastFetched(): Promise<number> {\n\t\tif (this._lastFetched == null) {\n\t\t\tconst hasRemotes = await this.hasRemotes();\n\t\t\tif (!hasRemotes || Container.vsls.isMaybeGuest) return 0;\n\t\t}\n\n\t\ttry {\n\t\t\tconst stat = await workspace.fs.stat(Uri.file(paths.join(this.path, '.git/FETCH_HEAD')));\n\t\t\t// If the file is empty, assume the fetch failed, and don't update the timestamp\n\t\t\tif (stat.size > 0) {\n\t\t\t\tthis._lastFetched = stat.mtime;\n\t\t\t}\n\t\t} catch {\n\t\t\tthis._lastFetched = undefined;\n\t\t}\n\n\t\treturn this._lastFetched ?? 0;\n\t}\n\n\tgetMergeStatus(): Promise<GitMergeStatus | undefined> {\n\t\treturn Container.git.getMergeStatus(this.path);\n\t}\n\n\tgetRebaseStatus(): Promise<GitRebaseStatus | undefined> {\n\t\treturn Container.git.getRebaseStatus(this.path);\n\t}\n\n\tasync getRemote(remote: string): Promise<GitRemote | undefined> {\n\t\treturn (await this.getRemotes()).find(r => r.name === remote);\n\t}\n\n\tasync getRemotes(options: { filter?: (remote: GitRemote) => boolean; sort?: boolean } = {}): Promise<GitRemote[]> {\n\t\tif (this._remotes == null || !this.supportsChangeEvents) {\n\t\t\tif (this._providers == null) {\n\t\t\t\tconst remotesCfg = configuration.get('remotes', this.folder.uri);\n\t\t\t\tthis._providers = RemoteProviderFactory.loadProviders(remotesCfg);\n\t\t\t}\n\n\t\t\t// Since we are caching the results, always sort\n\t\t\tthis._remotes = Container.git.getRemotesCore(this.path, this._providers, { sort: true });\n\t\t\tvoid this.subscribeToRemotes(this._remotes);\n\t\t}\n\n\t\treturn options.filter != null ? (await this._remotes).filter(options.filter) : this._remotes;\n\t}\n\n\tasync getRichRemote(connectedOnly: boolean = false): Promise<GitRemote<RichRemoteProvider> | undefined> {\n\t\treturn Container.git.getRichRemoteProvider(await this.getRemotes(), { includeDisconnected: !connectedOnly });\n\t}\n\n\tprivate async subscribeToRemotes(remotes: Promise<GitRemote[]>) {\n\t\tthis._remotesDisposable?.dispose();\n\t\tthis._remotesDisposable = undefined;\n\n\t\tthis._remotesDisposable = Disposable.from(\n\t\t\t...Iterables.filterMap(await remotes, r => {\n\t\t\t\tif (!RichRemoteProvider.is(r.provider)) return undefined;\n\n\t\t\t\treturn r.provider.onDidChange(() => this.fireChange(RepositoryChange.RemoteProviders));\n\t\t\t}),\n\t\t);\n\t}\n\n\tgetStash(): Promise<GitStash | undefined> {\n\t\treturn Container.git.getStash(this.path);\n\t}\n\n\tgetStatus(): Promise<GitStatus | undefined> {\n\t\treturn Container.git.getStatusForRepo(this.path);\n\t}\n\n\tgetTags(options?: { filter?: (t: GitTag) => boolean; sort?: boolean | TagSortOptions }): Promise<GitTag[]> {\n\t\treturn Container.git.getTags(this.path, options);\n\t}\n\n\tasync hasRemotes(): Promise<boolean> {\n\t\tconst remotes = await this.getRemotes();\n\t\treturn remotes?.length > 0;\n\t}\n\n\tasync hasRichRemote(connectedOnly: boolean = false): Promise<boolean> {\n\t\tconst remote = await this.getRichRemote(connectedOnly);\n\t\treturn remote?.provider != null;\n\t}\n\n\tasync hasUpstreamBranch(): Promise<boolean> {\n\t\tconst branch = await this.getBranch();\n\t\treturn branch?.upstream != null;\n\t}\n\n\t@gate(() => '')\n\t@log()\n\tmerge(...args: string[]) {\n\t\tthis.runTerminalCommand('merge', ...args);\n\t}\n\n\t@gate()\n\t@log()\n\tasync pull(options: { progress?: boolean; rebase?: boolean } = {}) {\n\t\tconst { progress, ...opts } = { progress: true, ...options };\n\t\tif (!progress) return this.pullCore();\n\n\t\treturn void (await window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Pulling ${this.formattedName}...`,\n\t\t\t},\n\t\t\t() => this.pullCore(opts),\n\t\t));\n\t}\n\n\tprivate async pullCore(options: { rebase?: boolean } = {}) {\n\t\ttry {\n\t\t\tconst upstream = await this.hasUpstreamBranch();\n\t\t\tif (upstream) {\n\t\t\t\tvoid (await commands.executeCommand(\n\t\t\t\t\toptions.rebase ? BuiltInGitCommands.PullRebase : BuiltInGitCommands.Pull,\n\t\t\t\t\tthis.path,\n\t\t\t\t));\n\t\t\t} else if (configuration.getAny<boolean>(BuiltInGitConfiguration.FetchOnPull, Uri.file(this.path))) {\n\t\t\t\tvoid (await Container.git.fetch(this.path));\n\t\t\t}\n\n\t\t\tthis.fireChange(RepositoryChange.Unknown);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to pull repository');\n\t\t}\n\t}\n\n\t@gate()\n\t@log()\n\tasync push(\n\t\toptions: {\n\t\t\tforce?: boolean;\n\t\t\tprogress?: boolean;\n\t\t\treference?: GitReference;\n\t\t\tpublish?: {\n\t\t\t\tremote: string;\n\t\t\t};\n\t\t} = {},\n\t) {\n\t\tconst { progress, ...opts } = { progress: true, ...options };\n\t\tif (!progress) return this.pushCore(opts);\n\n\t\treturn void (await window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: GitReference.isBranch(opts.reference)\n\t\t\t\t\t? `${opts.publish != null ? 'Publishing ' : 'Pushing '}${opts.reference.name}...`\n\t\t\t\t\t: `Pushing ${this.formattedName}...`,\n\t\t\t},\n\t\t\t() => this.pushCore(opts),\n\t\t));\n\t}\n\n\tprivate async showCreatePullRequestPrompt(remoteName: string, branch: GitBranchReference) {\n\t\tif (!Container.actionRunners.count('createPullRequest')) return;\n\t\tif (!(await Messages.showCreatePullRequestPrompt(branch.name))) return;\n\n\t\tconst remote = await this.getRemote(remoteName);\n\n\t\tvoid executeActionCommand<CreatePullRequestActionContext>('createPullRequest', {\n\t\t\trepoPath: this.path,\n\t\t\tremote:\n\t\t\t\tremote != null\n\t\t\t\t\t? {\n\t\t\t\t\t\t\tname: remote.name,\n\t\t\t\t\t\t\tprovider:\n\t\t\t\t\t\t\t\tremote.provider != null\n\t\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\t\tid: remote.provider.id,\n\t\t\t\t\t\t\t\t\t\t\tname: remote.provider.name,\n\t\t\t\t\t\t\t\t\t\t\tdomain: remote.provider.domain,\n\t\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t\turl: remote.url,\n\t\t\t\t\t  }\n\t\t\t\t\t: { name: remoteName },\n\t\t\tbranch: {\n\t\t\t\tname: branch.name,\n\t\t\t\tisRemote: branch.remote,\n\t\t\t\tupstream: branch.upstream?.name,\n\t\t\t},\n\t\t});\n\t}\n\n\tprivate async pushCore(\n\t\toptions: {\n\t\t\tforce?: boolean;\n\t\t\treference?: GitReference;\n\t\t\tpublish?: {\n\t\t\t\tremote: string;\n\t\t\t};\n\t\t} = {},\n\t) {\n\t\ttry {\n\t\t\tif (GitReference.isBranch(options.reference)) {\n\t\t\t\tconst repo = await GitService.getOrOpenBuiltInGitRepository(this.path);\n\t\t\t\tif (repo == null) return;\n\n\t\t\t\tif (options.publish != null) {\n\t\t\t\t\tawait repo?.push(options.publish.remote, options.reference.name, true);\n\t\t\t\t\tvoid this.showCreatePullRequestPrompt(options.publish.remote, options.reference);\n\t\t\t\t} else {\n\t\t\t\t\tconst branch = await this.getBranch(options.reference.name);\n\t\t\t\t\tif (branch == null) return;\n\n\t\t\t\t\tconst currentBranch = await this.getBranch();\n\t\t\t\t\tif (branch.id === currentBranch?.id) {\n\t\t\t\t\t\tvoid (await commands.executeCommand(\n\t\t\t\t\t\t\toptions.force ? BuiltInGitCommands.PushForce : BuiltInGitCommands.Push,\n\t\t\t\t\t\t\tthis.path,\n\t\t\t\t\t\t));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tawait repo?.push(branch.getRemoteName(), branch.name);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (options.reference != null) {\n\t\t\t\tconst repo = await GitService.getOrOpenBuiltInGitRepository(this.path);\n\t\t\t\tif (repo == null) return;\n\n\t\t\t\tconst branch = await this.getBranch();\n\t\t\t\tif (branch == null) return;\n\n\t\t\t\tawait repo?.push(branch.getRemoteName(), `${options.reference.ref}:${branch.getNameWithoutRemote()}`);\n\t\t\t} else {\n\t\t\t\tvoid (await commands.executeCommand(\n\t\t\t\t\toptions.force ? BuiltInGitCommands.PushForce : BuiltInGitCommands.Push,\n\t\t\t\t\tthis.path,\n\t\t\t\t));\n\t\t\t}\n\n\t\t\tthis.fireChange(RepositoryChange.Unknown);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to push repository');\n\t\t}\n\t}\n\n\t@gate(() => '')\n\t@log()\n\trebase(configs: string[] | undefined, ...args: string[]) {\n\t\tthis.runTerminalCommand(\n\t\t\tconfigs != null && configs.length !== 0 ? `${configs.join(' ')} rebase` : 'rebase',\n\t\t\t...args,\n\t\t);\n\t}\n\n\t@gate(() => '')\n\t@log()\n\treset(...args: string[]) {\n\t\tthis.runTerminalCommand('reset', ...args);\n\t}\n\n\tresetCaches(...cache: ('branch' | 'remotes')[]) {\n\t\tif (cache.length === 0 || cache.includes('branch')) {\n\t\t\tthis._branch = undefined;\n\t\t}\n\n\t\tif (cache.length === 0 || cache.includes('remotes')) {\n\t\t\tthis._remotes = undefined;\n\t\t\tthis._remotesDisposable?.dispose();\n\t\t\tthis._remotesDisposable = undefined;\n\t\t}\n\t}\n\n\tresume() {\n\t\tif (!this._suspended) return;\n\n\t\tthis._suspended = false;\n\n\t\t// If we've come back into focus and we are dirty, fire the change events\n\n\t\tif (this._pendingRepoChange != null) {\n\t\t\tthis._fireChangeDebounced!();\n\t\t}\n\n\t\tif (this._pendingFileSystemChange != null) {\n\t\t\tthis._fireFileSystemChangeDebounced!();\n\t\t}\n\t}\n\n\t@gate()\n\t@log()\n\trevert(...args: string[]) {\n\t\tthis.runTerminalCommand('revert', ...args);\n\t}\n\n\tsearchForCommits(\n\t\tsearch: SearchPattern,\n\t\toptions: { limit?: number; skip?: number } = {},\n\t): Promise<GitLog | undefined> {\n\t\treturn Container.git.getLogForSearch(this.path, search, options);\n\t}\n\n\tget starred() {\n\t\tconst starred = Container.context.workspaceState.get<Starred>(WorkspaceState.StarredRepositories);\n\t\treturn starred != null && starred[this.id] === true;\n\t}\n\n\tstar(branch?: GitBranch) {\n\t\treturn this.updateStarred(true, branch);\n\t}\n\n\t@gate(() => '')\n\t@log()\n\tasync stashApply(stashName: string, options: { deleteAfter?: boolean } = {}) {\n\t\tvoid (await Container.git.stashApply(this.path, stashName, options));\n\n\t\tthis.fireChange(RepositoryChange.Stash);\n\t}\n\n\t@gate(() => '')\n\t@log()\n\tasync stashDelete(stashName: string, ref?: string) {\n\t\tvoid (await Container.git.stashDelete(this.path, stashName, ref));\n\n\t\tthis.fireChange(RepositoryChange.Stash);\n\t}\n\n\t@gate(() => '')\n\t@log()\n\tasync stashSave(message?: string, uris?: Uri[], options: { includeUntracked?: boolean; keepIndex?: boolean } = {}) {\n\t\tvoid (await Container.git.stashSave(this.path, message, uris, options));\n\n\t\tthis.fireChange(RepositoryChange.Stash);\n\t}\n\n\t@gate()\n\t@log()\n\tasync switch(ref: string, options: { createBranch?: string | undefined; progress?: boolean } = {}) {\n\t\tconst { progress, ...opts } = { progress: true, ...options };\n\t\tif (!progress) return this.switchCore(ref, opts);\n\n\t\treturn void (await window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Switching ${this.formattedName} to ${ref}...`,\n\t\t\t\tcancellable: false,\n\t\t\t},\n\t\t\t() => this.switchCore(ref, opts),\n\t\t));\n\t}\n\n\tprivate async switchCore(ref: string, options: { createBranch?: string } = {}) {\n\t\ttry {\n\t\t\tvoid (await Container.git.checkout(this.path, ref, options));\n\n\t\t\tthis.fireChange(RepositoryChange.Unknown);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to switch to reference');\n\t\t}\n\t}\n\n\ttoAbsoluteUri(path: string, options?: { validate?: boolean }): Uri | undefined {\n\t\tconst uri = Uri.joinPath(GitUri.file(this.path), path);\n\t\treturn !(options?.validate ?? true) || this.containsUri(uri) ? uri : undefined;\n\t}\n\n\tunstar(branch?: GitBranch) {\n\t\treturn this.updateStarred(false, branch);\n\t}\n\n\tprivate async updateStarred(star: boolean, branch?: GitBranch) {\n\t\tif (branch != null) {\n\t\t\tawait this.updateStarredCore(WorkspaceState.StarredBranches, branch.id, star);\n\t\t} else {\n\t\t\tawait this.updateStarredCore(WorkspaceState.StarredRepositories, this.id, star);\n\t\t}\n\n\t\tthis.fireChange(RepositoryChange.Starred);\n\t}\n\n\tprivate async updateStarredCore(key: WorkspaceState, id: string, star: boolean) {\n\t\tlet starred = Container.context.workspaceState.get<Starred>(key);\n\t\tif (starred === undefined) {\n\t\t\tstarred = Object.create(null) as Starred;\n\t\t}\n\n\t\tif (star) {\n\t\t\tstarred[id] = true;\n\t\t} else {\n\t\t\tconst { [id]: _, ...rest } = starred;\n\t\t\tstarred = rest;\n\t\t}\n\t\tawait Container.context.workspaceState.update(key, starred);\n\n\t\tthis.fireChange(RepositoryChange.Starred);\n\t}\n\n\tstartWatchingFileSystem(): Disposable {\n\t\tthis._fsWatchCounter++;\n\t\tif (this._fsWatcherDisposable == null) {\n\t\t\t// TODO: createFileSystemWatcher doesn't work unless the folder is part of the workspaceFolders\n\t\t\t// https://github.com/Microsoft/vscode/issues/3025\n\t\t\tconst watcher = workspace.createFileSystemWatcher(new RelativePattern(this.folder, '**'));\n\t\t\tthis._fsWatcherDisposable = Disposable.from(\n\t\t\t\twatcher,\n\t\t\t\twatcher.onDidChange(this.onFileSystemChanged, this),\n\t\t\t\twatcher.onDidCreate(this.onFileSystemChanged, this),\n\t\t\t\twatcher.onDidDelete(this.onFileSystemChanged, this),\n\t\t\t);\n\t\t}\n\n\t\treturn { dispose: () => this.stopWatchingFileSystem() };\n\t}\n\n\tstopWatchingFileSystem(force: boolean = false) {\n\t\tif (this._fsWatcherDisposable == null) return;\n\t\tif (--this._fsWatchCounter > 0 && !force) return;\n\n\t\tthis._fsWatchCounter = 0;\n\t\tthis._fsWatcherDisposable.dispose();\n\t\tthis._fsWatcherDisposable = undefined;\n\t}\n\n\tsuspend() {\n\t\tthis._suspended = true;\n\t}\n\n\t@gate()\n\t@log()\n\ttag(...args: string[]) {\n\t\tthis.runTerminalCommand('tag', ...args);\n\t}\n\n\t@gate()\n\t@log()\n\ttagDelete(tags: GitTagReference | GitTagReference[]) {\n\t\tif (!Array.isArray(tags)) {\n\t\t\ttags = [tags];\n\t\t}\n\n\t\tconst args = ['--delete'];\n\t\tthis.runTerminalCommand('tag', ...args, ...tags.map(t => t.ref));\n\t}\n\n\t@debug()\n\tprivate fireChange(...changes: RepositoryChange[]) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tthis._updatedAt = Date.now();\n\n\t\tif (this._fireChangeDebounced == null) {\n\t\t\tthis._fireChangeDebounced = Functions.debounce(this.fireChangeCore.bind(this), 250);\n\t\t}\n\n\t\tthis._pendingRepoChange = this._pendingRepoChange?.with(changes) ?? new RepositoryChangeEvent(this, changes);\n\n\t\tthis.onAnyRepositoryChanged(this, new RepositoryChangeEvent(this, changes));\n\n\t\tif (this._suspended) {\n\t\t\tLogger.debug(cc, `queueing suspended ${this._pendingRepoChange.toString(true)}`);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis._fireChangeDebounced();\n\t}\n\n\tprivate fireChangeCore() {\n\t\tconst e = this._pendingRepoChange;\n\t\tif (e == null) return;\n\n\t\tthis._pendingRepoChange = undefined;\n\n\t\tLogger.debug(`Repository(${this.id}) firing ${e.toString(true)}`);\n\t\tthis._onDidChange.fire(e);\n\t}\n\n\t@debug()\n\tprivate fireFileSystemChange(uri: Uri) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tthis._updatedAt = Date.now();\n\n\t\tif (this._fireFileSystemChangeDebounced == null) {\n\t\t\tthis._fireFileSystemChangeDebounced = Functions.debounce(this.fireFileSystemChangeCore.bind(this), 2500);\n\t\t}\n\n\t\tif (this._pendingFileSystemChange == null) {\n\t\t\tthis._pendingFileSystemChange = { repository: this, uris: [] };\n\t\t}\n\n\t\tconst e = this._pendingFileSystemChange;\n\t\te.uris.push(uri);\n\n\t\tif (this._suspended) {\n\t\t\tLogger.debug(cc, `queueing suspended fs changes=${e.uris.map(u => u.fsPath).join(', ')}`);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._fireFileSystemChangeDebounced();\n\t}\n\n\tprivate async fireFileSystemChangeCore() {\n\t\tlet e = this._pendingFileSystemChange;\n\t\tif (e == null) return;\n\n\t\tthis._pendingFileSystemChange = undefined;\n\n\t\tconst uris = await Container.git.excludeIgnoredUris(this.path, e.uris);\n\t\tif (uris.length === 0) return;\n\n\t\tif (uris.length !== e.uris.length) {\n\t\t\te = { ...e, uris: uris };\n\t\t}\n\n\t\tLogger.debug(`Repository(${this.id}) firing fs changes=${e.uris.map(u => u.fsPath).join(', ')}`);\n\n\t\tthis._onDidChangeFileSystem.fire(e);\n\t}\n\n\tprivate runTerminalCommand(command: string, ...args: string[]) {\n\t\tconst parsedArgs = args.map(arg =>\n\t\t\targ.startsWith('#') || arg.includes(\"'\") || arg.includes('(') || arg.includes(')') ? `\"${arg}\"` : arg,\n\t\t);\n\t\trunGitCommandInTerminal(command, parsedArgs.join(' '), this.path, true);\n\n\t\tsetTimeout(() => this.fireChange(RepositoryChange.Unknown), 2500);\n\t}\n\n\tprivate async tryWatchingForChangesViaBuiltInApi() {\n\t\tconst repo = await GitService.getOrOpenBuiltInGitRepository(this.path);\n\t\tif (repo != null) {\n\t\t\tconst internalRepo = (repo as any)._repository;\n\t\t\tif (internalRepo != null && 'onDidChangeRepository' in internalRepo) {\n\t\t\t\ttry {\n\t\t\t\t\tthis._repoWatcherDisposable = internalRepo.onDidChangeRepository((e: Uri | undefined) =>\n\t\t\t\t\t\tthis.onRepositoryChanged(e),\n\t\t\t\t\t);\n\t\t\t\t\tthis._supportsChangeEvents = true;\n\n\t\t\t\t\tif (Logger.willLog('debug')) {\n\t\t\t\t\t\tLogger.debug(`Repository(${this.id}) is now using fallback file watching`);\n\t\t\t\t\t}\n\t\t\t\t} catch {}\n\t\t\t}\n\t\t}\n\t}\n}\n","'use strict';\nimport { Container } from '../../container';\nimport { gate, memoize } from '../../system';\nimport { GitCommitType } from './commit';\nimport { GitFile, GitFileWorkingTreeStatus } from './file';\nimport { GitLogCommit } from './logCommit';\nimport { GitReference } from './models';\n\nconst stashNumberRegex = /stash@{(\\d+)}/;\n\nexport class GitStashCommit extends GitLogCommit {\n\tstatic override isOfRefType(commit: GitReference | undefined) {\n\t\treturn commit?.refType === 'stash';\n\t}\n\n\tstatic override is(commit: any): commit is GitStashCommit {\n\t\treturn (\n\t\t\tcommit instanceof GitStashCommit\n\t\t\t// || (commit.repoPath !== undefined &&\n\t\t\t//     commit.sha !== undefined &&\n\t\t\t//     (commit.type === GitCommitType.Stash || commit.type === GitCommitType.StashFile))\n\t\t);\n\t}\n\n\toverride readonly refType = 'stash';\n\n\tconstructor(\n\t\ttype: GitCommitType,\n\t\tpublic readonly stashName: string,\n\t\trepoPath: string,\n\t\tsha: string,\n\t\tauthorDate: Date,\n\t\tcommittedDate: Date,\n\t\tmessage: string,\n\t\tfileName: string,\n\t\tfiles: GitFile[],\n\t) {\n\t\tsuper(type, repoPath, sha, 'You', undefined, authorDate, committedDate, message, fileName, files);\n\t}\n\n\t@memoize()\n\tget number() {\n\t\tconst match = stashNumberRegex.exec(this.stashName);\n\t\tif (match == null) return undefined;\n\n\t\treturn match[1];\n\t}\n\n\toverride get shortSha() {\n\t\treturn this.stashName;\n\t}\n\n\tprivate _untrackedFilesChecked = false;\n\t@gate()\n\tasync checkForUntrackedFiles() {\n\t\tif (!this._untrackedFilesChecked) {\n\t\t\tthis._untrackedFilesChecked = true;\n\n\t\t\t// Check for any untracked files -- since git doesn't return them via `git stash list` :(\n\t\t\t// See https://stackoverflow.com/questions/12681529/\n\t\t\tconst commit = await Container.git.getCommit(this.repoPath, `${this.stashName}^3`);\n\t\t\tif (commit != null && commit.files.length !== 0) {\n\t\t\t\t// Since these files are untracked -- make them look that way\n\t\t\t\tconst files = commit.files.map(s => ({\n\t\t\t\t\t...s,\n\t\t\t\t\tstatus: GitFileWorkingTreeStatus.Untracked,\n\t\t\t\t\tconflictStatus: undefined,\n\t\t\t\t\tindexStatus: undefined,\n\t\t\t\t\tworkingTreeStatus: undefined,\n\t\t\t\t}));\n\n\t\t\t\tthis.files.push(...files);\n\t\t\t}\n\t\t}\n\t}\n\n\toverride with(changes: {\n\t\ttype?: GitCommitType;\n\t\tsha?: string | null;\n\t\tfileName?: string;\n\t\tauthorDate?: Date;\n\t\tcommittedDate?: Date;\n\t\tmessage?: string;\n\t\tfiles?: GitFile[] | null;\n\t}): GitLogCommit {\n\t\treturn new GitStashCommit(\n\t\t\tchanges.type ?? this.type,\n\t\t\tthis.stashName,\n\t\t\tthis.repoPath,\n\t\t\tthis.getChangedValue(changes.sha, this.sha)!,\n\t\t\tchanges.authorDate ?? this.authorDate,\n\t\t\tchanges.committedDate ?? this.committerDate,\n\t\t\tchanges.message ?? this.message,\n\t\t\tchanges.fileName ?? this.fileName,\n\t\t\tthis.getChangedValue(changes.files, this.files) ?? [],\n\t\t);\n\t}\n}\n","'use strict';\nimport { Uri } from 'vscode';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { memoize, Strings } from '../../system';\nimport { GitUri } from '../gitUri';\nimport { GitBranch, GitTrackingState } from './branch';\nimport { GitFile, GitFileConflictStatus, GitFileIndexStatus, GitFileStatus, GitFileWorkingTreeStatus } from './file';\nimport { GitCommitType, GitLogCommit, GitRemote, GitRevision, GitUser } from './models';\n\nexport interface ComputedWorkingTreeGitStatus {\n\tstaged: number;\n\tstagedAddsAndChanges: GitStatusFile[];\n\tstagedStatus: string;\n\n\tunstaged: number;\n\tunstagedAddsAndChanges: GitStatusFile[];\n\tunstagedStatus: string;\n\n\tconflicted: number;\n\tconflictedAddsAndChanges: GitStatusFile[];\n\tconflictedStatus: string;\n}\n\nexport class GitStatus {\n\treadonly detached: boolean;\n\n\tconstructor(\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly branch: string,\n\t\tpublic readonly sha: string,\n\t\tpublic readonly files: GitStatusFile[],\n\t\tpublic readonly state: GitTrackingState,\n\t\tpublic readonly upstream?: string,\n\t\tpublic readonly rebasing: boolean = false,\n\t) {\n\t\tthis.detached = GitBranch.isDetached(branch);\n\t\tif (this.detached) {\n\t\t\tthis.branch = GitBranch.formatDetached(this.sha);\n\t\t}\n\t}\n\n\t@memoize()\n\tget conflicts() {\n\t\treturn this.files.filter(f => f.conflicted);\n\t}\n\n\t@memoize()\n\tget hasConflicts() {\n\t\treturn this.files.some(f => f.conflicted);\n\t}\n\n\tget ref() {\n\t\treturn this.detached ? this.sha : this.branch;\n\t}\n\n\t@memoize()\n\tcomputeWorkingTreeStatus(): ComputedWorkingTreeGitStatus {\n\t\tlet conflictedAdds = 0;\n\t\tlet conflictedDeletes = 0;\n\t\tlet conflictedChanges = 0;\n\t\tlet stagedAdds = 0;\n\t\tlet unstagedAdds = 0;\n\t\tlet stagedChanges = 0;\n\t\tlet unstagedChanges = 0;\n\t\tlet stagedDeletes = 0;\n\t\tlet unstagedDeletes = 0;\n\n\t\tconst conflictedAddsAndChanges: GitStatusFile[] = [];\n\t\tconst stagedAddsAndChanges: GitStatusFile[] = [];\n\t\tconst unstagedAddsAndChanges: GitStatusFile[] = [];\n\n\t\tfor (const f of this.files) {\n\t\t\tswitch (f.conflictStatus) {\n\t\t\t\tcase undefined:\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase GitFileConflictStatus.AddedByBoth:\n\t\t\t\tcase GitFileConflictStatus.AddedByUs:\n\t\t\t\tcase GitFileConflictStatus.AddedByThem:\n\t\t\t\t\tconflictedAdds++;\n\t\t\t\t\tstagedAddsAndChanges.push(f);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase GitFileConflictStatus.DeletedByBoth:\n\t\t\t\tcase GitFileConflictStatus.DeletedByUs:\n\t\t\t\tcase GitFileConflictStatus.DeletedByThem:\n\t\t\t\t\tconflictedDeletes++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconflictedChanges++;\n\t\t\t\t\tconflictedAddsAndChanges.push(f);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tswitch (f.indexStatus) {\n\t\t\t\tcase undefined:\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase GitFileIndexStatus.Added:\n\t\t\t\t\tstagedAdds++;\n\t\t\t\t\tstagedAddsAndChanges.push(f);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase GitFileIndexStatus.Deleted:\n\t\t\t\t\tstagedDeletes++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tstagedChanges++;\n\t\t\t\t\tstagedAddsAndChanges.push(f);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tswitch (f.workingTreeStatus) {\n\t\t\t\tcase undefined:\n\t\t\t\tcase GitFileWorkingTreeStatus.Ignored:\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase GitFileWorkingTreeStatus.Added:\n\t\t\t\tcase GitFileWorkingTreeStatus.Untracked:\n\t\t\t\t\tunstagedAdds++;\n\t\t\t\t\tunstagedAddsAndChanges.push(f);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase GitFileWorkingTreeStatus.Deleted:\n\t\t\t\t\tunstagedDeletes++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tunstagedChanges++;\n\t\t\t\t\tunstagedAddsAndChanges.push(f);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tconst conflicted = conflictedAdds + conflictedChanges + conflictedDeletes;\n\t\tconst staged = stagedAdds + stagedChanges + stagedDeletes;\n\t\tconst unstaged = unstagedAdds + unstagedChanges + unstagedDeletes;\n\n\t\treturn {\n\t\t\tconflicted: conflicted,\n\t\t\tconflictedAddsAndChanges: conflictedAddsAndChanges,\n\t\t\tconflictedStatus: conflicted > 0 ? `+${conflictedAdds} ~${conflictedChanges} -${conflictedDeletes}` : '',\n\t\t\tstaged: staged,\n\t\t\tstagedStatus: staged > 0 ? `+${stagedAdds} ~${stagedChanges} -${stagedDeletes}` : '',\n\t\t\tstagedAddsAndChanges: stagedAddsAndChanges,\n\t\t\tunstaged: unstaged,\n\t\t\tunstagedStatus: unstaged > 0 ? `+${unstagedAdds} ~${unstagedChanges} -${unstagedDeletes}` : '',\n\t\t\tunstagedAddsAndChanges: unstagedAddsAndChanges,\n\t\t};\n\t}\n\n\t@memoize()\n\tgetDiffStatus() {\n\t\tconst diff = {\n\t\t\tadded: 0,\n\t\t\tdeleted: 0,\n\t\t\tchanged: 0,\n\t\t};\n\n\t\tif (this.files.length === 0) return diff;\n\n\t\tfor (const f of this.files) {\n\t\t\tswitch (f.status) {\n\t\t\t\tcase 'A':\n\t\t\t\tcase '?':\n\t\t\t\t\tdiff.added++;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'D':\n\t\t\t\t\tdiff.deleted++;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdiff.changed++;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn diff;\n\t}\n\n\tgetFormattedDiffStatus({\n\t\tcompact,\n\t\tempty,\n\t\texpand,\n\t\tprefix = '',\n\t\tseparator = ' ',\n\t\tsuffix = '',\n\t}: {\n\t\tcompact?: boolean;\n\t\tempty?: string;\n\t\texpand?: boolean;\n\t\tprefix?: string;\n\t\tseparator?: string;\n\t\tsuffix?: string;\n\t} = {}): string {\n\t\tconst { added, changed, deleted } = this.getDiffStatus();\n\t\tif (added === 0 && changed === 0 && deleted === 0) return empty ?? '';\n\n\t\tif (expand) {\n\t\t\tlet status = '';\n\t\t\tif (added) {\n\t\t\t\tstatus += `${Strings.pluralize('file', added)} added`;\n\t\t\t}\n\t\t\tif (changed) {\n\t\t\t\tstatus += `${status.length === 0 ? '' : separator}${Strings.pluralize('file', changed)} changed`;\n\t\t\t}\n\t\t\tif (deleted) {\n\t\t\t\tstatus += `${status.length === 0 ? '' : separator}${Strings.pluralize('file', deleted)} deleted`;\n\t\t\t}\n\t\t\treturn `${prefix}${status}${suffix}`;\n\t\t}\n\n\t\tlet status = '';\n\t\tif (compact) {\n\t\t\tif (added !== 0) {\n\t\t\t\tstatus += `+${added}`;\n\t\t\t}\n\t\t\tif (changed !== 0) {\n\t\t\t\tstatus += `${status.length === 0 ? '' : separator}~${changed}`;\n\t\t\t}\n\t\t\tif (deleted !== 0) {\n\t\t\t\tstatus += `${status.length === 0 ? '' : separator}-${deleted}`;\n\t\t\t}\n\t\t} else {\n\t\t\tstatus += `+${added}${separator}~${changed}${separator}-${deleted}`;\n\t\t}\n\n\t\treturn `${prefix}${status}${suffix}`;\n\t}\n\n\t@memoize()\n\tasync getRemote(): Promise<GitRemote | undefined> {\n\t\tif (this.upstream == null) return undefined;\n\n\t\tconst remotes = await Container.git.getRemotes(this.repoPath);\n\t\tif (remotes.length === 0) return undefined;\n\n\t\tconst remoteName = GitBranch.getRemote(this.upstream);\n\t\treturn remotes.find(r => r.name === remoteName);\n\t}\n\n\tgetUpstreamStatus(options: {\n\t\tempty?: string;\n\t\texpand?: boolean;\n\t\ticons?: boolean;\n\t\tprefix?: string;\n\t\tseparator?: string;\n\t\tsuffix?: string;\n\t}): string {\n\t\treturn GitStatus.getUpstreamStatus(\n\t\t\tthis.upstream ? { name: this.upstream, missing: false } : undefined,\n\t\t\tthis.state,\n\t\t\toptions,\n\t\t);\n\t}\n\n\tstatic getUpstreamStatus(\n\t\tupstream: { name: string; missing: boolean } | undefined,\n\t\tstate: { ahead: number; behind: number },\n\t\toptions: {\n\t\t\tcount?: boolean;\n\t\t\tempty?: string;\n\t\t\texpand?: boolean;\n\t\t\ticons?: boolean;\n\t\t\tprefix?: string;\n\t\t\tseparator?: string;\n\t\t\tsuffix?: string;\n\t\t} = {},\n\t): string {\n\t\tconst { count = true, expand = false, icons = false, prefix = '', separator = ' ', suffix = '' } = options;\n\t\tif (upstream == null || (state.behind === 0 && state.ahead === 0)) return options.empty ?? '';\n\n\t\tif (expand) {\n\t\t\tlet status = '';\n\t\t\tif (upstream.missing) {\n\t\t\t\tstatus = 'missing';\n\t\t\t} else {\n\t\t\t\tif (state.behind) {\n\t\t\t\t\tstatus += `${Strings.pluralize('commit', state.behind, {\n\t\t\t\t\t\tinfix: icons ? '$(arrow-down) ' : undefined,\n\t\t\t\t\t})} behind`;\n\t\t\t\t}\n\t\t\t\tif (state.ahead) {\n\t\t\t\t\tstatus += `${status.length === 0 ? '' : separator}${Strings.pluralize('commit', state.ahead, {\n\t\t\t\t\t\tinfix: icons ? '$(arrow-up) ' : undefined,\n\t\t\t\t\t})} ahead`;\n\t\t\t\t\tif (suffix.startsWith(` ${upstream.name.split('/')[0]}`)) {\n\t\t\t\t\t\tstatus += ' of';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn `${prefix}${status}${suffix}`;\n\t\t}\n\n\t\tconst showCounts = count && !upstream.missing;\n\n\t\treturn `${prefix}${showCounts ? state.behind : ''}${\n\t\t\tshowCounts || state.behind !== 0 ? GlyphChars.ArrowDown : ''\n\t\t}${separator}${showCounts ? state.ahead : ''}${\n\t\t\tshowCounts || state.ahead !== 0 ? GlyphChars.ArrowUp : ''\n\t\t}${suffix}`;\n\t}\n}\n\nexport class GitStatusFile implements GitFile {\n\tpublic readonly conflictStatus: GitFileConflictStatus | undefined;\n\tpublic readonly indexStatus: GitFileIndexStatus | undefined;\n\tpublic readonly workingTreeStatus: GitFileWorkingTreeStatus | undefined;\n\n\tconstructor(\n\t\tpublic readonly repoPath: string,\n\t\tx: string | undefined,\n\t\ty: string | undefined,\n\t\tpublic readonly fileName: string,\n\t\tpublic readonly originalFileName?: string,\n\t) {\n\t\tif (x != null && y != null) {\n\t\t\tswitch (x + y) {\n\t\t\t\tcase '??':\n\t\t\t\t\tthis.workingTreeStatus = GitFileWorkingTreeStatus.Untracked;\n\t\t\t\t\tbreak;\n\t\t\t\tcase '!!':\n\t\t\t\t\tthis.workingTreeStatus = GitFileWorkingTreeStatus.Ignored;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'AA':\n\t\t\t\t\tthis.conflictStatus = GitFileConflictStatus.AddedByBoth;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'AU':\n\t\t\t\t\tthis.conflictStatus = GitFileConflictStatus.AddedByUs;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'UA':\n\t\t\t\t\tthis.conflictStatus = GitFileConflictStatus.AddedByThem;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'DD':\n\t\t\t\t\tthis.conflictStatus = GitFileConflictStatus.DeletedByBoth;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'DU':\n\t\t\t\t\tthis.conflictStatus = GitFileConflictStatus.DeletedByUs;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'UD':\n\t\t\t\t\tthis.conflictStatus = GitFileConflictStatus.DeletedByThem;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'UU':\n\t\t\t\t\tthis.conflictStatus = GitFileConflictStatus.ModifiedByBoth;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (this.conflictStatus == null) {\n\t\t\tswitch (x) {\n\t\t\t\tcase 'A':\n\t\t\t\t\tthis.indexStatus = GitFileIndexStatus.Added;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'D':\n\t\t\t\t\tthis.indexStatus = GitFileIndexStatus.Deleted;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'M':\n\t\t\t\t\tthis.indexStatus = GitFileIndexStatus.Modified;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'R':\n\t\t\t\t\tthis.indexStatus = GitFileIndexStatus.Renamed;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'C':\n\t\t\t\t\tthis.indexStatus = GitFileIndexStatus.Copied;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tswitch (y) {\n\t\t\t\tcase 'A':\n\t\t\t\t\tthis.workingTreeStatus = GitFileWorkingTreeStatus.Modified;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'D':\n\t\t\t\t\tthis.workingTreeStatus = GitFileWorkingTreeStatus.Modified;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'M':\n\t\t\t\t\tthis.workingTreeStatus = GitFileWorkingTreeStatus.Modified;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tget conflicted() {\n\t\treturn this.conflictStatus != null;\n\t}\n\n\tget edited() {\n\t\treturn this.workingTreeStatus != null;\n\t}\n\n\tget staged() {\n\t\treturn this.indexStatus != null;\n\t}\n\n\tget status(): GitFileStatus {\n\t\treturn (this.conflictStatus ?? this.indexStatus ?? this.workingTreeStatus)!;\n\t}\n\n\t@memoize()\n\tget uri(): Uri {\n\t\treturn GitUri.resolveToUri(this.fileName, this.repoPath);\n\t}\n\n\tgetFormattedDirectory(includeOriginal: boolean = false): string {\n\t\treturn GitFile.getFormattedDirectory(this, includeOriginal);\n\t}\n\n\tgetFormattedPath(options: { relativeTo?: string; suffix?: string; truncateTo?: number } = {}): string {\n\t\treturn GitFile.getFormattedPath(this, options);\n\t}\n\n\tgetOcticon() {\n\t\treturn GitFile.getStatusCodicon(this.status);\n\t}\n\n\tgetStatusText(): string {\n\t\treturn GitFile.getStatusText(this.status);\n\t}\n\n\ttoPsuedoCommits(user: GitUser | undefined): GitLogCommit[] {\n\t\tconst commits: GitLogCommit[] = [];\n\n\t\tif (this.conflictStatus != null) {\n\t\t\tcommits.push(\n\t\t\t\tnew GitLogCommit(\n\t\t\t\t\tGitCommitType.LogFile,\n\t\t\t\t\tthis.repoPath,\n\t\t\t\t\tGitRevision.uncommitted,\n\t\t\t\t\t'You',\n\t\t\t\t\tuser?.email ?? undefined,\n\t\t\t\t\tnew Date(),\n\t\t\t\t\tnew Date(),\n\t\t\t\t\t'',\n\t\t\t\t\tthis.fileName,\n\t\t\t\t\t[this],\n\t\t\t\t\tthis.status,\n\t\t\t\t\tthis.originalFileName,\n\t\t\t\t\tGitRevision.uncommittedStaged,\n\t\t\t\t\tthis.originalFileName ?? this.fileName,\n\t\t\t\t),\n\t\t\t);\n\t\t\treturn commits;\n\t\t}\n\n\t\tif (this.workingTreeStatus == null && this.indexStatus == null) return commits;\n\n\t\tif (this.workingTreeStatus != null && this.indexStatus != null) {\n\t\t\tcommits.push(\n\t\t\t\tnew GitLogCommit(\n\t\t\t\t\tGitCommitType.LogFile,\n\t\t\t\t\tthis.repoPath,\n\t\t\t\t\tGitRevision.uncommitted,\n\t\t\t\t\t'You',\n\t\t\t\t\tuser?.email ?? undefined,\n\t\t\t\t\tnew Date(),\n\t\t\t\t\tnew Date(),\n\t\t\t\t\t'',\n\t\t\t\t\tthis.fileName,\n\t\t\t\t\t[this],\n\t\t\t\t\tthis.status,\n\t\t\t\t\tthis.originalFileName,\n\t\t\t\t\tGitRevision.uncommittedStaged,\n\t\t\t\t\tthis.originalFileName ?? this.fileName,\n\t\t\t\t),\n\t\t\t\tnew GitLogCommit(\n\t\t\t\t\tGitCommitType.LogFile,\n\t\t\t\t\tthis.repoPath,\n\t\t\t\t\tGitRevision.uncommittedStaged,\n\t\t\t\t\t'You',\n\t\t\t\t\tuser != null ? user.email : undefined,\n\t\t\t\t\tnew Date(),\n\t\t\t\t\tnew Date(),\n\t\t\t\t\t'',\n\t\t\t\t\tthis.fileName,\n\t\t\t\t\t[this],\n\t\t\t\t\tthis.status,\n\t\t\t\t\tthis.originalFileName,\n\t\t\t\t\t'HEAD',\n\t\t\t\t\tthis.originalFileName ?? this.fileName,\n\t\t\t\t),\n\t\t\t);\n\t\t} else {\n\t\t\tcommits.push(\n\t\t\t\tnew GitLogCommit(\n\t\t\t\t\tGitCommitType.LogFile,\n\t\t\t\t\tthis.repoPath,\n\t\t\t\t\tthis.workingTreeStatus != null ? GitRevision.uncommitted : GitRevision.uncommittedStaged,\n\t\t\t\t\t'You',\n\t\t\t\t\tuser?.email ?? undefined,\n\t\t\t\t\tnew Date(),\n\t\t\t\t\tnew Date(),\n\t\t\t\t\t'',\n\t\t\t\t\tthis.fileName,\n\t\t\t\t\t[this],\n\t\t\t\t\tthis.status,\n\t\t\t\t\tthis.originalFileName,\n\t\t\t\t\t'HEAD',\n\t\t\t\t\tthis.originalFileName ?? this.fileName,\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\treturn commits;\n\t}\n\n\twith(changes: {\n\t\tconflictStatus?: GitFileConflictStatus | null;\n\t\tindexStatus?: GitFileIndexStatus | null;\n\t\tworkTreeStatus?: GitFileWorkingTreeStatus | null;\n\t\tfileName?: string;\n\t\toriginalFileName?: string | null;\n\t}): GitStatusFile {\n\t\tconst working = this.getChangedValue(changes.workTreeStatus, this.workingTreeStatus);\n\n\t\tlet status: string;\n\t\tswitch (working) {\n\t\t\tcase GitFileWorkingTreeStatus.Untracked:\n\t\t\t\tstatus = '??';\n\t\t\t\tbreak;\n\t\t\tcase GitFileWorkingTreeStatus.Ignored:\n\t\t\t\tstatus = '!!';\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tstatus =\n\t\t\t\t\tthis.getChangedValue(changes.conflictStatus, this.conflictStatus) ??\n\t\t\t\t\t`${this.getChangedValue(changes.indexStatus, this.indexStatus) ?? ' '}${working ?? ' '}`;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn new GitStatusFile(\n\t\t\tthis.repoPath,\n\t\t\tstatus[0]?.trim() || undefined,\n\t\t\tstatus[1]?.trim() || undefined,\n\t\t\tchanges.fileName ?? this.fileName,\n\t\t\tthis.getChangedValue(changes.originalFileName, this.originalFileName),\n\t\t);\n\t}\n\n\tprotected getChangedValue<T>(change: T | null | undefined, original: T | undefined): T | undefined {\n\t\tif (change === undefined) return original;\n\t\treturn change !== null ? change : undefined;\n\t}\n}\n","'use strict';\nimport { configuration, DateStyle, TagSorting } from '../../configuration';\nimport { Dates, memoize } from '../../system';\nimport { GitReference, GitTagReference } from './models';\n\nexport const TagDateFormatting = {\n\tdateFormat: undefined! as string | null,\n\tdateStyle: undefined! as DateStyle,\n\n\treset: () => {\n\t\tTagDateFormatting.dateFormat = configuration.get('defaultDateFormat');\n\t\tTagDateFormatting.dateStyle = configuration.get('defaultDateStyle');\n\t},\n};\n\nexport interface TagSortOptions {\n\tcurrent?: boolean;\n\torderBy?: TagSorting;\n}\n\nexport class GitTag implements GitTagReference {\n\tstatic is(tag: any): tag is GitTag {\n\t\treturn tag instanceof GitTag;\n\t}\n\n\tstatic isOfRefType(tag: GitReference | undefined) {\n\t\treturn tag?.refType === 'tag';\n\t}\n\n\tstatic sort(tags: GitTag[], options?: TagSortOptions) {\n\t\toptions = { orderBy: configuration.get('sortTagsBy'), ...options };\n\n\t\tswitch (options.orderBy) {\n\t\t\tcase TagSorting.DateAsc:\n\t\t\t\treturn tags.sort((a, b) => a.date.getTime() - b.date.getTime());\n\t\t\tcase TagSorting.NameAsc:\n\t\t\t\treturn tags.sort((a, b) =>\n\t\t\t\t\ta.name.localeCompare(b.name, undefined, { numeric: true, sensitivity: 'base' }),\n\t\t\t\t);\n\t\t\tcase TagSorting.NameDesc:\n\t\t\t\treturn tags.sort((a, b) =>\n\t\t\t\t\tb.name.localeCompare(a.name, undefined, { numeric: true, sensitivity: 'base' }),\n\t\t\t\t);\n\t\t\tcase TagSorting.DateDesc:\n\t\t\tdefault:\n\t\t\t\treturn tags.sort((a, b) => b.date.getTime() - a.date.getTime());\n\t\t}\n\t}\n\n\treadonly refType = 'tag';\n\n\tconstructor(\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly name: string,\n\t\tpublic readonly sha: string,\n\t\tpublic readonly message: string,\n\t\tpublic readonly date: Date,\n\t\tpublic readonly commitDate: Date | undefined,\n\t) {}\n\n\tget formattedDate(): string {\n\t\treturn TagDateFormatting.dateStyle === DateStyle.Absolute\n\t\t\t? this.formatDate(TagDateFormatting.dateFormat)\n\t\t\t: this.formatDateFromNow();\n\t}\n\n\tget ref() {\n\t\treturn this.name;\n\t}\n\n\t@memoize()\n\tprivate get commitDateFormatter(): Dates.DateFormatter | undefined {\n\t\treturn this.commitDate == null ? undefined : Dates.getFormatter(this.commitDate);\n\t}\n\n\t@memoize()\n\tprivate get dateFormatter(): Dates.DateFormatter {\n\t\treturn Dates.getFormatter(this.date);\n\t}\n\n\t@memoize<GitTag['formatCommitDate']>(format => (format == null ? 'MMMM Do, YYYY h:mma' : format))\n\tformatCommitDate(format?: string | null) {\n\t\tconst formatter = this.commitDateFormatter;\n\t\tif (formatter == null) return '';\n\n\t\tif (format == null) {\n\t\t\tformat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\treturn formatter.format(format);\n\t}\n\n\tformatCommitDateFromNow() {\n\t\tconst formatter = this.commitDateFormatter;\n\t\tif (formatter == null) return '';\n\n\t\treturn formatter.fromNow();\n\t}\n\n\t@memoize<GitTag['formatDate']>(format => (format == null ? 'MMMM Do, YYYY h:mma' : format))\n\tformatDate(format?: string | null) {\n\t\tif (format == null) {\n\t\t\tformat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\treturn this.dateFormatter.format(format);\n\t}\n\n\tformatDateFromNow() {\n\t\treturn this.dateFormatter.fromNow();\n\t}\n\n\t@memoize()\n\tgetBasename(): string {\n\t\tconst index = this.name.lastIndexOf('/');\n\t\treturn index !== -1 ? this.name.substring(index + 1) : this.name;\n\t}\n}\n","'use strict';\nimport { debug, Strings } from '../../system';\nimport { GitDiff, GitDiffHunk, GitDiffHunkLine, GitDiffLine, GitDiffShortStat } from '../models/diff';\nimport { GitFile, GitFileStatus } from '../models/file';\n\nconst nameStatusDiffRegex = /^(.*?)\\t(.*?)(?:\\t(.*?))?$/gm;\nconst shortStatDiffRegex =\n\t/^\\s*(\\d+)\\sfiles? changed(?:,\\s+(\\d+)\\s+insertions?\\(\\+\\))?(?:,\\s+(\\d+)\\s+deletions?\\(-\\))?/;\nconst unifiedDiffRegex = /^@@ -([\\d]+)(?:,([\\d]+))? \\+([\\d]+)(?:,([\\d]+))? @@(?:.*?)\\n([\\s\\S]*?)(?=^@@)/gm;\n\nexport class GitDiffParser {\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(data: string, debug: boolean = false): GitDiff | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst hunks: GitDiffHunk[] = [];\n\n\t\tlet previousStart;\n\t\tlet previousCount;\n\t\tlet currentStart;\n\t\tlet currentCount;\n\t\tlet hunk;\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = unifiedDiffRegex.exec(`${data}\\n@@`);\n\t\t\tif (match == null) break;\n\n\t\t\t[, previousStart, previousCount, currentStart, currentCount, hunk] = match;\n\n\t\t\tpreviousCount = Number(previousCount) || 0;\n\t\t\tpreviousStart = Number(previousStart) || 0;\n\t\t\tcurrentCount = Number(currentCount) || 0;\n\t\t\tcurrentStart = Number(currentStart) || 0;\n\n\t\t\thunks.push(\n\t\t\t\tnew GitDiffHunk(\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${hunk}`.substr(1),\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: currentCount,\n\t\t\t\t\t\tposition: {\n\t\t\t\t\t\t\tstart: currentStart,\n\t\t\t\t\t\t\tend: currentStart + (currentCount > 0 ? currentCount - 1 : 0),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: previousCount,\n\t\t\t\t\t\tposition: {\n\t\t\t\t\t\t\tstart: previousStart,\n\t\t\t\t\t\t\tend: previousStart + (previousCount > 0 ? previousCount - 1 : 0),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t} while (true);\n\n\t\tif (!hunks.length) return undefined;\n\n\t\tconst diff: GitDiff = {\n\t\t\tdiff: debug ? data : undefined,\n\t\t\thunks: hunks,\n\t\t};\n\t\treturn diff;\n\t}\n\n\t@debug({ args: false, singleLine: true })\n\tstatic parseHunk(hunk: GitDiffHunk): { lines: GitDiffHunkLine[]; state: 'added' | 'changed' | 'removed' } {\n\t\tconst currentLines: (GitDiffLine | undefined)[] = [];\n\t\tconst previousLines: (GitDiffLine | undefined)[] = [];\n\n\t\tlet hasAddedOrChanged;\n\t\tlet hasRemoved;\n\n\t\tlet removed = 0;\n\t\tfor (const l of Strings.lines(hunk.diff)) {\n\t\t\tswitch (l[0]) {\n\t\t\t\tcase '+':\n\t\t\t\t\thasAddedOrChanged = true;\n\t\t\t\t\tcurrentLines.push({\n\t\t\t\t\t\tline: ` ${l.substring(1)}`,\n\t\t\t\t\t\tstate: 'added',\n\t\t\t\t\t});\n\n\t\t\t\t\tif (removed > 0) {\n\t\t\t\t\t\tremoved--;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpreviousLines.push(undefined);\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '-':\n\t\t\t\t\thasRemoved = true;\n\t\t\t\t\tremoved++;\n\n\t\t\t\t\tpreviousLines.push({\n\t\t\t\t\t\tline: ` ${l.substring(1)}`,\n\t\t\t\t\t\tstate: 'removed',\n\t\t\t\t\t});\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\twhile (removed > 0) {\n\t\t\t\t\t\tremoved--;\n\t\t\t\t\t\tcurrentLines.push(undefined);\n\t\t\t\t\t}\n\n\t\t\t\t\tcurrentLines.push({ line: l, state: 'unchanged' });\n\t\t\t\t\tpreviousLines.push({ line: l, state: 'unchanged' });\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\twhile (removed > 0) {\n\t\t\tremoved--;\n\t\t\tcurrentLines.push(undefined);\n\t\t}\n\n\t\tconst hunkLines: GitDiffHunkLine[] = [];\n\n\t\tfor (let i = 0; i < currentLines.length; i++) {\n\t\t\thunkLines.push({\n\t\t\t\thunk: hunk,\n\t\t\t\tcurrent: currentLines[i],\n\t\t\t\tprevious: previousLines[i],\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\tlines: hunkLines,\n\t\t\tstate: hasAddedOrChanged && hasRemoved ? 'changed' : hasAddedOrChanged ? 'added' : 'removed',\n\t\t};\n\t}\n\n\t@debug({ args: false, singleLine: true })\n\tstatic parseNameStatus(data: string, repoPath: string): GitFile[] | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst files: GitFile[] = [];\n\n\t\tlet status: string;\n\t\tlet fileName: string;\n\t\tlet originalFileName: string;\n\n\t\tlet match: RegExpExecArray | null;\n\t\tdo {\n\t\t\tmatch = nameStatusDiffRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, status, fileName, originalFileName] = match;\n\n\t\t\tfiles.push({\n\t\t\t\trepoPath: repoPath,\n\t\t\t\tstatus: (!status.startsWith('.') ? status[0].trim() : '?') as GitFileStatus,\n\t\t\t\tconflictStatus: undefined,\n\t\t\t\tindexStatus: undefined,\n\t\t\t\tworkingTreeStatus: undefined,\n\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\tfileName: ` ${fileName}`.substr(1),\n\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\toriginalFileName:\n\t\t\t\t\toriginalFileName == null || originalFileName.length === 0\n\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t: ` ${originalFileName}`.substr(1),\n\t\t\t});\n\t\t} while (true);\n\n\t\treturn files;\n\t}\n\n\t@debug({ args: false, singleLine: true })\n\tstatic parseShortStat(data: string): GitDiffShortStat | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst match = shortStatDiffRegex.exec(data);\n\t\tif (match == null) return undefined;\n\n\t\tconst [, files, insertions, deletions] = match;\n\n\t\tconst diffShortStat: GitDiffShortStat = {\n\t\t\tfiles: files == null ? 0 : parseInt(files, 10),\n\t\t\tinsertions: insertions == null ? 0 : parseInt(insertions, 10),\n\t\t\tdeletions: deletions == null ? 0 : parseInt(deletions, 10),\n\t\t};\n\n\t\treturn diffShortStat;\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { debug, Strings } from '../../system';\nimport { GitAuthor, GitBlame, GitBlameCommit, GitCommitLine, GitRevision, GitUser } from '../git';\n\nconst emptyStr = '';\nconst slash = '/';\n\ninterface BlameEntry {\n\tsha: string;\n\n\tline: number;\n\toriginalLine: number;\n\tlineCount: number;\n\n\tauthor: string;\n\tauthorDate?: string;\n\tauthorTimeZone?: string;\n\tauthorEmail?: string;\n\n\tcommitterDate?: string;\n\tcommitterTimeZone?: string;\n\n\tpreviousSha?: string;\n\tpreviousFileName?: string;\n\n\tfileName?: string;\n\n\tsummary?: string;\n}\n\nexport class GitBlameParser {\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(\n\t\tdata: string,\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\tcurrentUser: GitUser | undefined,\n\t): GitBlame | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst authors = new Map<string, GitAuthor>();\n\t\tconst commits = new Map<string, GitBlameCommit>();\n\t\tconst lines: GitCommitLine[] = [];\n\n\t\tlet relativeFileName;\n\n\t\tlet entry: BlameEntry | undefined = undefined;\n\t\tlet line: string;\n\t\tlet lineParts: string[];\n\n\t\tlet first = true;\n\n\t\tfor (line of Strings.lines(data)) {\n\t\t\tlineParts = line.split(' ');\n\t\t\tif (lineParts.length < 2) continue;\n\n\t\t\tif (entry === undefined) {\n\t\t\t\tentry = {\n\t\t\t\t\tauthor: undefined!,\n\t\t\t\t\tsha: lineParts[0],\n\t\t\t\t\toriginalLine: parseInt(lineParts[1], 10),\n\t\t\t\t\tline: parseInt(lineParts[2], 10),\n\t\t\t\t\tlineCount: parseInt(lineParts[3], 10),\n\t\t\t\t};\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tswitch (lineParts[0]) {\n\t\t\t\tcase 'author':\n\t\t\t\t\tif (GitRevision.isUncommitted(entry.sha)) {\n\t\t\t\t\t\tentry.author = 'You';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tentry.author = lineParts.slice(1).join(' ').trim();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'author-mail': {\n\t\t\t\t\tif (GitRevision.isUncommitted(entry.sha)) {\n\t\t\t\t\t\tentry.authorEmail = currentUser !== undefined ? currentUser.email : undefined;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tentry.authorEmail = lineParts.slice(1).join(' ').trim();\n\t\t\t\t\tconst start = entry.authorEmail.indexOf('<');\n\t\t\t\t\tif (start >= 0) {\n\t\t\t\t\t\tconst end = entry.authorEmail.indexOf('>', start);\n\t\t\t\t\t\tif (end > start) {\n\t\t\t\t\t\t\tentry.authorEmail = entry.authorEmail.substring(start + 1, end);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tentry.authorEmail = entry.authorEmail.substring(start + 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'author-time':\n\t\t\t\t\tentry.authorDate = lineParts[1];\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'author-tz':\n\t\t\t\t\tentry.authorTimeZone = lineParts[1];\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'committer-time':\n\t\t\t\t\tentry.committerDate = lineParts[1];\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'committer-tz':\n\t\t\t\t\tentry.committerTimeZone = lineParts[1];\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'summary':\n\t\t\t\t\tentry.summary = lineParts.slice(1).join(' ').trim();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'previous':\n\t\t\t\t\tentry.previousSha = lineParts[1];\n\t\t\t\t\tentry.previousFileName = lineParts.slice(2).join(' ');\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'filename':\n\t\t\t\t\tentry.fileName = lineParts.slice(1).join(' ');\n\n\t\t\t\t\tif (first && repoPath === undefined) {\n\t\t\t\t\t\t// Try to get the repoPath from the most recent commit\n\t\t\t\t\t\trepoPath = Strings.normalizePath(\n\t\t\t\t\t\t\tfileName.replace(\n\t\t\t\t\t\t\t\tfileName.startsWith(slash) ? `/${entry.fileName}` : entry.fileName,\n\t\t\t\t\t\t\t\temptyStr,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t);\n\t\t\t\t\t\trelativeFileName = Strings.normalizePath(paths.relative(repoPath, fileName));\n\t\t\t\t\t} else {\n\t\t\t\t\t\trelativeFileName = entry.fileName;\n\t\t\t\t\t}\n\t\t\t\t\tfirst = false;\n\n\t\t\t\t\tGitBlameParser.parseEntry(entry, repoPath, relativeFileName, commits, authors, lines, currentUser);\n\n\t\t\t\t\tentry = undefined;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tfor (const [, c] of commits) {\n\t\t\tif (c.author === undefined) return undefined;\n\n\t\t\tconst author = authors.get(c.author);\n\t\t\tif (author === undefined) return undefined;\n\n\t\t\tauthor.lineCount += c.lines.length;\n\t\t}\n\n\t\tconst sortedAuthors = new Map([...authors.entries()].sort((a, b) => b[1].lineCount - a[1].lineCount));\n\n\t\tconst blame: GitBlame = {\n\t\t\trepoPath: repoPath!,\n\t\t\tauthors: sortedAuthors,\n\t\t\tcommits: commits,\n\t\t\tlines: lines,\n\t\t};\n\t\treturn blame;\n\t}\n\n\tprivate static parseEntry(\n\t\tentry: BlameEntry,\n\t\trepoPath: string | undefined,\n\t\trelativeFileName: string,\n\t\tcommits: Map<string, GitBlameCommit>,\n\t\tauthors: Map<string, GitAuthor>,\n\t\tlines: GitCommitLine[],\n\t\tcurrentUser: { name?: string; email?: string } | undefined,\n\t) {\n\t\tlet commit = commits.get(entry.sha);\n\t\tif (commit === undefined) {\n\t\t\tif (entry.author !== undefined) {\n\t\t\t\tif (\n\t\t\t\t\tcurrentUser !== undefined &&\n\t\t\t\t\t// Name or e-mail is configured\n\t\t\t\t\t(currentUser.name !== undefined || currentUser.email !== undefined) &&\n\t\t\t\t\t// Match on name if configured\n\t\t\t\t\t(currentUser.name === undefined || currentUser.name === entry.author) &&\n\t\t\t\t\t// Match on email if configured\n\t\t\t\t\t(currentUser.email === undefined || currentUser.email === entry.authorEmail)\n\t\t\t\t) {\n\t\t\t\t\tentry.author = 'You';\n\t\t\t\t}\n\n\t\t\t\tlet author = authors.get(entry.author);\n\t\t\t\tif (author === undefined) {\n\t\t\t\t\tauthor = {\n\t\t\t\t\t\tname: entry.author,\n\t\t\t\t\t\tlineCount: 0,\n\t\t\t\t\t};\n\t\t\t\t\tauthors.set(entry.author, author);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcommit = new GitBlameCommit(\n\t\t\t\trepoPath!,\n\t\t\t\tentry.sha,\n\t\t\t\tentry.author,\n\t\t\t\tentry.authorEmail,\n\t\t\t\tnew Date((entry.authorDate as any) * 1000),\n\t\t\t\tnew Date((entry.committerDate as any) * 1000),\n\t\t\t\tentry.summary!,\n\t\t\t\trelativeFileName,\n\t\t\t\tentry.previousFileName !== undefined && entry.previousFileName !== entry.fileName\n\t\t\t\t\t? entry.previousFileName\n\t\t\t\t\t: undefined,\n\t\t\t\tentry.previousSha,\n\t\t\t\tentry.previousSha && entry.previousFileName,\n\t\t\t\t[],\n\t\t\t);\n\n\t\t\tcommits.set(entry.sha, commit);\n\t\t}\n\n\t\tfor (let i = 0, len = entry.lineCount; i < len; i++) {\n\t\t\tconst line: GitCommitLine = {\n\t\t\t\tsha: entry.sha,\n\t\t\t\tline: entry.line + i,\n\t\t\t\toriginalLine: entry.originalLine + i,\n\t\t\t};\n\n\t\t\tif (commit.previousSha) {\n\t\t\t\tline.previousSha = commit.previousSha;\n\t\t\t}\n\n\t\t\tcommit.lines.push(line);\n\t\t\tlines[line.line - 1] = line;\n\t\t}\n\t}\n}\n","'use strict';\nimport { debug } from '../../system';\nimport { GitBranch } from '../models/branch';\n\nconst branchWithTrackingRegex =\n\t/^<h>(.+)<n>(.+)<u>(.*)<t>(?:\\[(?:ahead ([0-9]+))?[,\\s]*(?:behind ([0-9]+))?]|\\[(gone)])?<r>(.*)<d>(.*)$/gm;\n\n// Using %x00 codes because some shells seem to try to expand things if not\nconst lb = '%3c'; // `%${'<'.charCodeAt(0).toString(16)}`;\nconst rb = '%3e'; // `%${'>'.charCodeAt(0).toString(16)}`;\n\nexport class GitBranchParser {\n\tstatic defaultFormat = [\n\t\t`${lb}h${rb}%(HEAD)`, // HEAD indicator\n\t\t`${lb}n${rb}%(refname)`, // branch name\n\t\t`${lb}u${rb}%(upstream:short)`, // branch upstream\n\t\t`${lb}t${rb}%(upstream:track)`, // branch upstream tracking state\n\t\t`${lb}r${rb}%(objectname)`, // ref\n\t\t`${lb}d${rb}%(committerdate:iso8601)`, // committer date\n\t].join('');\n\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(data: string, repoPath: string): GitBranch[] {\n\t\tconst branches: GitBranch[] = [];\n\n\t\tif (!data) return branches;\n\n\t\tlet current;\n\t\tlet name;\n\t\tlet upstream;\n\t\tlet ahead;\n\t\tlet behind;\n\t\tlet missing;\n\t\tlet ref;\n\t\tlet date;\n\n\t\tlet remote;\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = branchWithTrackingRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, current, name, upstream, ahead, behind, missing, ref, date] = match;\n\n\t\t\tif (name.startsWith('refs/remotes/')) {\n\t\t\t\t// Strip off refs/remotes/\n\t\t\t\tname = name.substr(13);\n\t\t\t\tif (name.endsWith('/HEAD')) continue;\n\n\t\t\t\tremote = true;\n\t\t\t} else {\n\t\t\t\t// Strip off refs/heads/\n\t\t\t\tname = name.substr(11);\n\t\t\t\tremote = false;\n\t\t\t}\n\n\t\t\tbranches.push(\n\t\t\t\tnew GitBranch(\n\t\t\t\t\trepoPath,\n\t\t\t\t\tname,\n\t\t\t\t\tremote,\n\t\t\t\t\tcurrent.charCodeAt(0) === 42, // '*',\n\t\t\t\t\tnew Date(date),\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\tref == null || ref.length === 0 ? undefined : ` ${ref}`.substr(1),\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\tupstream == null || upstream.length === 0\n\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t: { name: ` ${upstream}`.substr(1), missing: Boolean(missing) },\n\t\t\t\t\tNumber(ahead) || 0,\n\t\t\t\t\tNumber(behind) || 0,\n\t\t\t\t),\n\t\t\t);\n\t\t} while (true);\n\n\t\treturn branches;\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { Range } from 'vscode';\nimport { Arrays, debug, Strings } from '../../system';\nimport {\n\tGitAuthor,\n\tGitCommitType,\n\tGitFile,\n\tGitFileIndexStatus,\n\tGitLog,\n\tGitLogCommit,\n\tGitLogCommitLine,\n\tGitRevision,\n\tGitUser,\n} from '../git';\n\nconst emptyEntry: LogEntry = {};\nconst emptyStr = '';\nconst slash = '/';\n\nconst diffRegex = /diff --git a\\/(.*) b\\/(.*)/;\nconst diffRangeRegex = /^@@ -(\\d+?),(\\d+?) \\+(\\d+?),(\\d+?) @@/;\n\nexport const fileStatusRegex = /(\\S)\\S*\\t([^\\t\\n]+)(?:\\t(.+))?/;\nconst fileStatusAndSummaryRegex = /^(\\d+?|-)\\s+?(\\d+?|-)\\s+?(.*)(?:\\n\\s(delete|rename|copy|create))?/;\nconst fileStatusAndSummaryRenamedFileRegex = /(.+)\\s=>\\s(.+)/;\nconst fileStatusAndSummaryRenamedFilePathRegex = /(.*?){(.+?)\\s=>\\s(.*?)}(.*)/;\n\nconst logRefsRegex = /^<r> (.*)/gm;\nconst logFileSimpleRegex = /^<r> (.*)\\s*(?:(?:diff --git a\\/(.*) b\\/(.*))|(?:(\\S)\\S*\\t([^\\t\\n]+)(?:\\t(.+))?))/gm;\nconst logFileSimpleRenamedRegex = /^<r> (\\S+)\\s*(.*)$/s;\nconst logFileSimpleRenamedFilesRegex = /^(\\S)\\S*\\t([^\\t\\n]+)(?:\\t(.+)?)?$/gm;\n\n// Using %x00 codes because some shells seem to try to expand things if not\nconst lb = '%x3c'; // `%x${'<'.charCodeAt(0).toString(16)}`;\nconst rb = '%x3e'; // `%x${'>'.charCodeAt(0).toString(16)}`;\nconst sl = '%x2f'; // `%x${'/'.charCodeAt(0).toString(16)}`;\nconst sp = '%x20'; // `%x${' '.charCodeAt(0).toString(16)}`;\n\ninterface LogEntry {\n\tref?: string;\n\n\tauthor?: string;\n\tdate?: string;\n\tcommittedDate?: string;\n\temail?: string;\n\n\tparentShas?: string[];\n\n\tfileName?: string;\n\toriginalFileName?: string;\n\tfiles?: GitFile[];\n\n\tstatus?: GitFileIndexStatus;\n\tfileStats?: {\n\t\tinsertions: number;\n\t\tdeletions: number;\n\t};\n\n\tsummary?: string;\n\n\tline?: GitLogCommitLine;\n}\n\nexport class GitLogParser {\n\tstatic defaultFormat = [\n\t\t`${lb}${sl}f${rb}`,\n\t\t`${lb}r${rb}${sp}%H`, // ref\n\t\t`${lb}a${rb}${sp}%aN`, // author\n\t\t`${lb}e${rb}${sp}%aE`, // email\n\t\t`${lb}d${rb}${sp}%at`, // date\n\t\t`${lb}c${rb}${sp}%ct`, // committed date\n\t\t`${lb}p${rb}${sp}%P`, // parents\n\t\t`${lb}s${rb}`,\n\t\t'%B', // summary\n\t\t`${lb}${sl}s${rb}`,\n\t\t`${lb}f${rb}`,\n\t].join('%n');\n\n\tstatic simpleRefs = `${lb}r${rb}${sp}%H`;\n\tstatic simpleFormat = `${lb}r${rb}${sp}%H`;\n\n\tstatic shortlog = '%H%x00%aN%x00%aE%x00%at';\n\n\t@debug({ args: false })\n\tstatic parse(\n\t\tdata: string,\n\t\ttype: GitCommitType,\n\t\trepoPath: string | undefined,\n\t\tfileName: string | undefined,\n\t\tsha: string | undefined,\n\t\tcurrentUser: GitUser | undefined,\n\t\tlimit: number | undefined,\n\t\treverse: boolean,\n\t\trange: Range | undefined,\n\t): GitLog | undefined {\n\t\tif (!data) return undefined;\n\n\t\tlet relativeFileName: string;\n\t\tlet recentCommit: GitLogCommit | undefined = undefined;\n\n\t\tlet entry: LogEntry = emptyEntry;\n\t\tlet line: string | undefined = undefined;\n\t\tlet token: number;\n\n\t\tlet i = 0;\n\t\tlet first = true;\n\n\t\tconst lines = Strings.lines(`${data}</f>`);\n\t\t// Skip the first line since it will always be </f>\n\t\tlet next = lines.next();\n\t\tif (next.done) return undefined;\n\n\t\tif (repoPath !== undefined) {\n\t\t\trepoPath = Strings.normalizePath(repoPath);\n\t\t}\n\n\t\tconst authors = new Map<string, GitAuthor>();\n\t\tconst commits = new Map<string, GitLogCommit>();\n\t\tlet truncationCount = limit;\n\n\t\tlet match;\n\t\tlet renamedFileName;\n\t\tlet renamedMatch;\n\n\t\tloop: while (true) {\n\t\t\tnext = lines.next();\n\t\t\tif (next.done) break;\n\n\t\t\tline = next.value;\n\n\t\t\t// Since log --reverse doesn't properly honor a max count -- enforce it here\n\t\t\tif (reverse && limit && i >= limit) break;\n\n\t\t\t// <1-char token> data\n\t\t\t// e.g. <r> bd1452a2dc\n\t\t\ttoken = line.charCodeAt(1);\n\n\t\t\tswitch (token) {\n\t\t\t\tcase 114: // 'r': // ref\n\t\t\t\t\tentry = {\n\t\t\t\t\t\tref: line.substring(4),\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 97: // 'a': // author\n\t\t\t\t\tif (GitRevision.isUncommitted(entry.ref)) {\n\t\t\t\t\t\tentry.author = 'You';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tentry.author = line.substring(4);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 101: // 'e': // author-mail\n\t\t\t\t\tentry.email = line.substring(4);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 100: // 'd': // author-date\n\t\t\t\t\tentry.date = line.substring(4);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 99: // 'c': // committer-date\n\t\t\t\t\tentry.committedDate = line.substring(4);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 112: // 'p': // parents\n\t\t\t\t\tentry.parentShas = line.substring(4).split(' ');\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 115: // 's': // summary\n\t\t\t\t\twhile (true) {\n\t\t\t\t\t\tnext = lines.next();\n\t\t\t\t\t\tif (next.done) break;\n\n\t\t\t\t\t\tline = next.value;\n\t\t\t\t\t\tif (line === '</s>') break;\n\n\t\t\t\t\t\tif (entry.summary === undefined) {\n\t\t\t\t\t\t\tentry.summary = line;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tentry.summary += `\\n${line}`;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Remove the trailing newline\n\t\t\t\t\tif (entry.summary != null && entry.summary.charCodeAt(entry.summary.length - 1) === 10) {\n\t\t\t\t\t\tentry.summary = entry.summary.slice(0, -1);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 102: {\n\t\t\t\t\t// 'f': // files\n\t\t\t\t\t// Skip the blank line git adds before the files\n\t\t\t\t\tnext = lines.next();\n\n\t\t\t\t\tlet hasFiles = true;\n\t\t\t\t\tif (next.done || next.value === '</f>') {\n\t\t\t\t\t\t// If this is a merge commit and there are no files returned, skip the commit and reduce our truncationCount to ensure accurate truncation detection\n\t\t\t\t\t\tif ((entry.parentShas?.length ?? 0) > 1) {\n\t\t\t\t\t\t\tif (truncationCount) {\n\t\t\t\t\t\t\t\ttruncationCount--;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\thasFiles = false;\n\t\t\t\t\t}\n\n\t\t\t\t\t// eslint-disable-next-line no-unmodified-loop-condition\n\t\t\t\t\twhile (hasFiles) {\n\t\t\t\t\t\tnext = lines.next();\n\t\t\t\t\t\tif (next.done) break;\n\n\t\t\t\t\t\tline = next.value;\n\t\t\t\t\t\tif (line === '</f>') break;\n\n\t\t\t\t\t\tif (line.startsWith('warning:')) continue;\n\n\t\t\t\t\t\tif (type === GitCommitType.Log) {\n\t\t\t\t\t\t\tmatch = fileStatusRegex.exec(line);\n\t\t\t\t\t\t\tif (match != null) {\n\t\t\t\t\t\t\t\tif (entry.files === undefined) {\n\t\t\t\t\t\t\t\t\tentry.files = [];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\trenamedFileName = match[3];\n\t\t\t\t\t\t\t\tif (renamedFileName !== undefined) {\n\t\t\t\t\t\t\t\t\tentry.files.push({\n\t\t\t\t\t\t\t\t\t\tstatus: match[1] as GitFileIndexStatus,\n\t\t\t\t\t\t\t\t\t\tfileName: renamedFileName,\n\t\t\t\t\t\t\t\t\t\toriginalFileName: match[2],\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tentry.files.push({\n\t\t\t\t\t\t\t\t\t\tstatus: match[1] as GitFileIndexStatus,\n\t\t\t\t\t\t\t\t\t\tfileName: match[2],\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmatch = diffRegex.exec(line);\n\t\t\t\t\t\t\tif (match != null) {\n\t\t\t\t\t\t\t\t[, entry.originalFileName, entry.fileName] = match;\n\t\t\t\t\t\t\t\tif (entry.fileName === entry.originalFileName) {\n\t\t\t\t\t\t\t\t\tentry.originalFileName = undefined;\n\t\t\t\t\t\t\t\t\tentry.status = GitFileIndexStatus.Modified;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tentry.status = GitFileIndexStatus.Renamed;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tvoid lines.next();\n\t\t\t\t\t\t\t\tvoid lines.next();\n\t\t\t\t\t\t\t\tnext = lines.next();\n\n\t\t\t\t\t\t\t\tmatch = diffRangeRegex.exec(next.value);\n\t\t\t\t\t\t\t\tif (match !== null) {\n\t\t\t\t\t\t\t\t\tentry.line = {\n\t\t\t\t\t\t\t\t\t\tfrom: {\n\t\t\t\t\t\t\t\t\t\t\tline: parseInt(match[1], 10),\n\t\t\t\t\t\t\t\t\t\t\tcount: parseInt(match[2], 10),\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tto: {\n\t\t\t\t\t\t\t\t\t\t\tline: parseInt(match[3], 10),\n\t\t\t\t\t\t\t\t\t\t\tcount: parseInt(match[4], 10),\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\twhile (true) {\n\t\t\t\t\t\t\t\t\tnext = lines.next();\n\t\t\t\t\t\t\t\t\tif (next.done || next.value === '</f>') break;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnext = lines.next();\n\t\t\t\t\t\t\t\tmatch = fileStatusAndSummaryRegex.exec(`${line}\\n${next.value}`);\n\t\t\t\t\t\t\t\tif (match != null) {\n\t\t\t\t\t\t\t\t\tentry.fileStats = {\n\t\t\t\t\t\t\t\t\t\tinsertions: Number(match[1]) || 0,\n\t\t\t\t\t\t\t\t\t\tdeletions: Number(match[2]) || 0,\n\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\tswitch (match[4]) {\n\t\t\t\t\t\t\t\t\t\tcase undefined:\n\t\t\t\t\t\t\t\t\t\t\tentry.status = 'M' as GitFileIndexStatus;\n\t\t\t\t\t\t\t\t\t\t\tentry.fileName = match[3];\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'copy':\n\t\t\t\t\t\t\t\t\t\tcase 'rename':\n\t\t\t\t\t\t\t\t\t\t\tentry.status = (match[4] === 'copy' ? 'C' : 'R') as GitFileIndexStatus;\n\n\t\t\t\t\t\t\t\t\t\t\trenamedFileName = match[3];\n\t\t\t\t\t\t\t\t\t\t\trenamedMatch =\n\t\t\t\t\t\t\t\t\t\t\t\tfileStatusAndSummaryRenamedFilePathRegex.exec(renamedFileName);\n\t\t\t\t\t\t\t\t\t\t\tif (renamedMatch != null) {\n\t\t\t\t\t\t\t\t\t\t\t\t// If there is no new path, the path part was removed so ensure we don't end up with //\n\t\t\t\t\t\t\t\t\t\t\t\tentry.fileName =\n\t\t\t\t\t\t\t\t\t\t\t\t\trenamedMatch[3] === ''\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? `${renamedMatch[1]}${renamedMatch[4]}`.replace('//', '/')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: `${renamedMatch[1]}${renamedMatch[3]}${renamedMatch[4]}`;\n\t\t\t\t\t\t\t\t\t\t\t\tentry.originalFileName = `${renamedMatch[1]}${renamedMatch[2]}${renamedMatch[4]}`;\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\trenamedMatch =\n\t\t\t\t\t\t\t\t\t\t\t\t\tfileStatusAndSummaryRenamedFileRegex.exec(renamedFileName);\n\t\t\t\t\t\t\t\t\t\t\t\tif (renamedMatch != null) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tentry.fileName = renamedMatch[2];\n\t\t\t\t\t\t\t\t\t\t\t\t\tentry.originalFileName = renamedMatch[1];\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tentry.fileName = renamedFileName;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'create':\n\t\t\t\t\t\t\t\t\t\t\tentry.status = 'A' as GitFileIndexStatus;\n\t\t\t\t\t\t\t\t\t\t\tentry.fileName = match[3];\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'delete':\n\t\t\t\t\t\t\t\t\t\t\tentry.status = 'D' as GitFileIndexStatus;\n\t\t\t\t\t\t\t\t\t\t\tentry.fileName = match[3];\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\t\tentry.status = 'M' as GitFileIndexStatus;\n\t\t\t\t\t\t\t\t\t\t\tentry.fileName = match[3];\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (next.done || next.value === '</f>') break;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (entry.files !== undefined) {\n\t\t\t\t\t\tentry.fileName = Arrays.filterMap(entry.files, f => (f.fileName ? f.fileName : undefined)).join(\n\t\t\t\t\t\t\t', ',\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (first && repoPath === undefined && type === GitCommitType.LogFile && fileName !== undefined) {\n\t\t\t\t\t\t// Try to get the repoPath from the most recent commit\n\t\t\t\t\t\trepoPath = Strings.normalizePath(\n\t\t\t\t\t\t\tfileName.replace(\n\t\t\t\t\t\t\t\tfileName.startsWith(slash) ? `/${entry.fileName}` : entry.fileName!,\n\t\t\t\t\t\t\t\temptyStr,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t);\n\t\t\t\t\t\trelativeFileName = Strings.normalizePath(paths.relative(repoPath, fileName));\n\t\t\t\t\t} else {\n\t\t\t\t\t\trelativeFileName = entry.fileName!;\n\t\t\t\t\t}\n\t\t\t\t\tfirst = false;\n\n\t\t\t\t\tconst commit = commits.get(entry.ref!);\n\t\t\t\t\tif (commit === undefined) {\n\t\t\t\t\t\ti++;\n\t\t\t\t\t\tif (limit && i > limit) break loop;\n\t\t\t\t\t} else if (truncationCount) {\n\t\t\t\t\t\t// Since this matches an existing commit it will be skipped, so reduce our truncationCount to ensure accurate truncation detection\n\t\t\t\t\t\ttruncationCount--;\n\t\t\t\t\t}\n\n\t\t\t\t\trecentCommit = GitLogParser.parseEntry(\n\t\t\t\t\t\tentry,\n\t\t\t\t\t\tcommit,\n\t\t\t\t\t\ttype,\n\t\t\t\t\t\trepoPath,\n\t\t\t\t\t\trelativeFileName,\n\t\t\t\t\t\tcommits,\n\t\t\t\t\t\tauthors,\n\t\t\t\t\t\trecentCommit,\n\t\t\t\t\t\tcurrentUser,\n\t\t\t\t\t);\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst log: GitLog = {\n\t\t\trepoPath: repoPath!,\n\t\t\tauthors: authors,\n\t\t\tcommits: commits,\n\t\t\tsha: sha,\n\t\t\tcount: i,\n\t\t\tlimit: limit,\n\t\t\trange: range,\n\t\t\thasMore: Boolean(truncationCount && i > truncationCount && truncationCount !== 1),\n\t\t};\n\t\treturn log;\n\t}\n\n\tprivate static parseEntry(\n\t\tentry: LogEntry,\n\t\tcommit: GitLogCommit | undefined,\n\t\ttype: GitCommitType,\n\t\trepoPath: string | undefined,\n\t\trelativeFileName: string,\n\t\tcommits: Map<string, GitLogCommit>,\n\t\tauthors: Map<string, GitAuthor>,\n\t\trecentCommit: GitLogCommit | undefined,\n\t\tcurrentUser: { name?: string; email?: string } | undefined,\n\t): GitLogCommit | undefined {\n\t\tif (commit === undefined) {\n\t\t\tif (entry.author !== undefined) {\n\t\t\t\tif (\n\t\t\t\t\tcurrentUser !== undefined &&\n\t\t\t\t\t// Name or e-mail is configured\n\t\t\t\t\t(currentUser.name !== undefined || currentUser.email !== undefined) &&\n\t\t\t\t\t// Match on name if configured\n\t\t\t\t\t(currentUser.name === undefined || currentUser.name === entry.author) &&\n\t\t\t\t\t// Match on email if configured\n\t\t\t\t\t(currentUser.email === undefined || currentUser.email === entry.email)\n\t\t\t\t) {\n\t\t\t\t\tentry.author = 'You';\n\t\t\t\t}\n\n\t\t\t\tlet author = authors.get(entry.author);\n\t\t\t\tif (author === undefined) {\n\t\t\t\t\tauthor = {\n\t\t\t\t\t\tname: entry.author,\n\t\t\t\t\t\tlineCount: 0,\n\t\t\t\t\t};\n\t\t\t\t\tauthors.set(entry.author, author);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst originalFileName =\n\t\t\t\tentry.originalFileName ?? (relativeFileName !== entry.fileName ? entry.fileName : undefined);\n\n\t\t\tif (type === GitCommitType.LogFile) {\n\t\t\t\tentry.files = [\n\t\t\t\t\t{\n\t\t\t\t\t\tstatus: entry.status!,\n\t\t\t\t\t\tfileName: relativeFileName,\n\t\t\t\t\t\toriginalFileName: originalFileName,\n\t\t\t\t\t},\n\t\t\t\t];\n\t\t\t}\n\n\t\t\tcommit = new GitLogCommit(\n\t\t\t\ttype,\n\t\t\t\trepoPath!,\n\t\t\t\tentry.ref!,\n\t\t\t\tentry.author!,\n\t\t\t\tentry.email,\n\t\t\t\tnew Date((entry.date! as any) * 1000),\n\t\t\t\tnew Date((entry.committedDate! as any) * 1000),\n\t\t\t\tentry.summary === undefined ? emptyStr : entry.summary,\n\t\t\t\trelativeFileName,\n\t\t\t\tentry.files ?? [],\n\t\t\t\tentry.status,\n\t\t\t\toriginalFileName,\n\t\t\t\ttype === GitCommitType.Log ? entry.parentShas![0] : undefined,\n\t\t\t\tundefined,\n\t\t\t\tentry.fileStats,\n\t\t\t\tentry.parentShas,\n\t\t\t\tentry.line,\n\t\t\t);\n\n\t\t\tcommits.set(entry.ref!, commit);\n\t\t}\n\t\t// else {\n\t\t//     Logger.log(`merge commit? ${entry.sha}`);\n\t\t// }\n\n\t\tif (recentCommit !== undefined) {\n\t\t\t// If the commit sha's match (merge commit), just forward it along\n\t\t\tcommit.nextSha = commit.sha !== recentCommit.sha ? recentCommit.sha : recentCommit.nextSha;\n\n\t\t\t// Only add a filename if this is a file log\n\t\t\tif (type === GitCommitType.LogFile) {\n\t\t\t\trecentCommit.previousFileName = commit.originalFileName ?? commit.fileName;\n\t\t\t\tcommit.nextFileName = recentCommit.originalFileName ?? recentCommit.fileName;\n\t\t\t}\n\t\t}\n\t\treturn commit;\n\t}\n\n\t@debug({ args: false })\n\tstatic parseLastRefOnly(data: string): string | undefined {\n\t\tlet ref;\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = logRefsRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, ref] = match;\n\t\t} while (true);\n\n\t\t// Ensure the regex state is reset\n\t\tlogRefsRegex.lastIndex = 0;\n\n\t\treturn ref;\n\t}\n\n\t@debug({ args: false })\n\tstatic parseRefsOnly(data: string): string[] {\n\t\tconst refs = [];\n\n\t\tlet ref;\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = logRefsRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, ref] = match;\n\n\t\t\tif (ref == null || ref.length === 0) continue;\n\n\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\trefs.push(` ${ref}`.substr(1));\n\t\t} while (true);\n\n\t\t// Ensure the regex state is reset\n\t\tlogRefsRegex.lastIndex = 0;\n\n\t\treturn refs;\n\t}\n\n\t@debug({ args: false })\n\tstatic parseSimple(\n\t\tdata: string,\n\t\tskip: number,\n\t\tskipRef?: string,\n\t): [string | undefined, string | undefined, GitFileIndexStatus | undefined] {\n\t\tlet ref;\n\t\tlet diffFile;\n\t\tlet diffRenamed;\n\t\tlet status;\n\t\tlet file;\n\t\tlet renamed;\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = logFileSimpleRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\tif (match[1] === skipRef) continue;\n\t\t\tif (skip-- > 0) continue;\n\n\t\t\t[, ref, diffFile, diffRenamed, status, file, renamed] = match;\n\n\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\tfile = ` ${diffRenamed || diffFile || renamed || file}`.substr(1);\n\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\tstatus = status == null || status.length === 0 ? undefined : ` ${status}`.substr(1);\n\t\t} while (skip >= 0);\n\n\t\t// Ensure the regex state is reset\n\t\tlogFileSimpleRegex.lastIndex = 0;\n\n\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\treturn [\n\t\t\tref == null || ref.length === 0 ? undefined : ` ${ref}`.substr(1),\n\t\t\tfile,\n\t\t\tstatus as GitFileIndexStatus | undefined,\n\t\t];\n\t}\n\n\t@debug({ args: false })\n\tstatic parseSimpleRenamed(\n\t\tdata: string,\n\t\toriginalFileName: string,\n\t): [string | undefined, string | undefined, GitFileIndexStatus | undefined] {\n\t\tlet match = logFileSimpleRenamedRegex.exec(data);\n\t\tif (match == null) return [undefined, undefined, undefined];\n\n\t\tconst [, ref, files] = match;\n\n\t\tlet status;\n\t\tlet file;\n\t\tlet renamed;\n\n\t\tdo {\n\t\t\tmatch = logFileSimpleRenamedFilesRegex.exec(files);\n\t\t\tif (match == null) break;\n\n\t\t\t[, status, file, renamed] = match;\n\n\t\t\tif (originalFileName !== file) {\n\t\t\t\tstatus = undefined;\n\t\t\t\tfile = undefined;\n\t\t\t\trenamed = undefined;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\tfile = ` ${renamed || file}`.substr(1);\n\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\tstatus = status == null || status.length === 0 ? undefined : ` ${status}`.substr(1);\n\n\t\t\tbreak;\n\t\t} while (true);\n\n\t\t// Ensure the regex state is reset\n\t\tlogFileSimpleRenamedFilesRegex.lastIndex = 0;\n\n\t\treturn [\n\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\tref == null || ref.length === 0 || file == null ? undefined : ` ${ref}`.substr(1),\n\t\t\tfile,\n\t\t\tstatus as GitFileIndexStatus | undefined,\n\t\t];\n\t}\n}\n","'use strict';\nimport { debug } from '../../system';\nimport { GitReflog, GitReflogRecord } from '../models/reflog';\n\nconst reflogRegex = /^<r>(.+)<d>(.+?)@{(.+)}<s>(\\w*)(.*?)(?::(.*))?$/gm;\n// const reflogRegex = /^<r>(.+)<d>(.+?)@{(.+)}<s>(\\w*)(.*?)(?::(.*))?<n>(.*)$/gm;\nconst reflogHEADRegex = /.*?\\/?HEAD$/;\n\n// Using %x00 codes because some shells seem to try to expand things if not\nconst lb = '%x3c'; // `%x${'<'.charCodeAt(0).toString(16)}`;\nconst rb = '%x3e'; // `%x${'>'.charCodeAt(0).toString(16)}`;\n\nexport class GitReflogParser {\n\tstatic defaultFormat = [\n\t\t`${lb}r${rb}%H`, // ref\n\t\t`${lb}d${rb}%gD`, // reflog selector (with iso8601 timestamp)\n\t\t`${lb}s${rb}%gs`, // reflog subject\n\t\t// `${lb}n${rb}%D` // ref names\n\t].join('');\n\n\t@debug({ args: false })\n\tstatic parse(\n\t\tdata: string,\n\t\trepoPath: string,\n\t\tcommands: string[],\n\t\tlimit: number,\n\t\ttotalLimit: number,\n\t): GitReflog | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst records: GitReflogRecord[] = [];\n\n\t\tlet sha;\n\t\tlet selector;\n\t\tlet date;\n\t\tlet command;\n\t\tlet commandArgs;\n\t\tlet details;\n\n\t\tlet head;\n\t\tlet headDate;\n\t\tlet headSha;\n\n\t\tlet count = 0;\n\t\tlet total = 0;\n\t\tlet recordDate;\n\t\tlet record: GitReflogRecord | undefined;\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = reflogRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, sha, selector, date, command, commandArgs, details] = match;\n\n\t\t\ttotal++;\n\n\t\t\tif (record !== undefined) {\n\t\t\t\t// If the next record has the same sha as the previous, use it if it is not pointing to just HEAD and the previous is\n\t\t\t\tif (\n\t\t\t\t\tsha === record.sha &&\n\t\t\t\t\t(date !== recordDate || !reflogHEADRegex.test(record.selector) || reflogHEADRegex.test(selector))\n\t\t\t\t) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (sha !== record.sha) {\n\t\t\t\t\tif (\n\t\t\t\t\t\thead != null &&\n\t\t\t\t\t\theadDate === recordDate &&\n\t\t\t\t\t\theadSha == record.sha &&\n\t\t\t\t\t\treflogHEADRegex.test(record.selector)\n\t\t\t\t\t) {\n\t\t\t\t\t\trecord.update(sha, head);\n\t\t\t\t\t} else {\n\t\t\t\t\t\trecord.update(sha);\n\t\t\t\t\t}\n\n\t\t\t\t\trecords.push(record);\n\t\t\t\t\trecord = undefined;\n\t\t\t\t\trecordDate = undefined;\n\n\t\t\t\t\tcount++;\n\t\t\t\t\tif (limit !== 0 && count >= limit) break;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (command === 'HEAD') {\n\t\t\t\thead = selector;\n\t\t\t\theadDate = date;\n\t\t\t\theadSha = sha;\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (commands.includes(command)) {\n\t\t\t\trecord = new GitReflogRecord(\n\t\t\t\t\trepoPath,\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${sha}`.substr(1),\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${selector}`.substr(1),\n\t\t\t\t\tnew Date(date),\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${command}`.substr(1),\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\tcommandArgs == null || commandArgs.length === 0 ? undefined : commandArgs.substr(1),\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\tdetails == null || details.length === 0 ? undefined : details.substr(1),\n\t\t\t\t);\n\t\t\t\trecordDate = date;\n\t\t\t}\n\t\t} while (true);\n\n\t\t// Ensure the regex state is reset\n\t\treflogRegex.lastIndex = 0;\n\n\t\treturn {\n\t\t\trepoPath: repoPath,\n\t\t\trecords: records,\n\t\t\tcount: count,\n\t\t\ttotal: total,\n\t\t\tlimit: limit,\n\t\t\thasMore: (limit !== 0 && count >= limit) || (totalLimit !== 0 && total >= totalLimit),\n\t\t};\n\t}\n}\n","'use strict';\nimport { debug } from '../../system';\nimport { GitRemote } from '../git';\nimport { GitRemoteType } from '../models/remote';\nimport { RemoteProvider } from '../remotes/factory';\n\nconst emptyStr = '';\n\nconst remoteRegex = /^(.*)\\t(.*)\\s\\((.*)\\)$/gm;\nconst urlRegex =\n\t/^(?:(git:\\/\\/)(.*?)\\/|(https?:\\/\\/)(?:.*?@)?(.*?)\\/|git@(.*):|(ssh:\\/\\/)(?:.*@)?(.*?)(?::.*?)?(?:\\/|(?=~))|(?:.*?@)(.*?):)(.*)$/;\n\n// Test git urls\n/*\nhttp://host.xz/user/project.git\nhttp://host.xz/path/to/repo.git\nhttp://host.xz/path/to/repo.git/\nhttp://username@host.xz/user/project.git\nhttp://username:password@host.xz/user/project.git\nhttps://host.xz/user/project.git\nhttps://host.xz/path/to/repo.git\nhttps://host.xz/path/to/repo.git/\nhttps://username@host.xz/user/project.git\nhttps://username:password@host.xz/user/project.git\n\ngit@host.xz:user/project.git\ngit://host.xz/path/to/repo.git/\ngit://host.xz/~user/path/to/repo.git/\n\nssh://host.xz/project.git\nssh://host.xz/path/to/repo.git\nssh://host.xz/path/to/repo.git/\nssh://host.xz:~project.git\nssh://host.xz:port/path/to/repo.git/\nssh://user@host.xz/project.git\nssh://user@host.xz/path/to/repo.git\nssh://user@host.xz/path/to/repo.git/\nssh://user@host.xz:port/path/to/repo.git/\nssh://user:password@host.xz/project.git\nssh://user:password@host.xz/path/to/repo.git\nssh://user:password@host.xz/path/to/repo.git/\n\nuser@host.xz:project.git\nuser@host.xz:path/to/repo.git\nuser@host.xz:/path/to/repo.git/\nuser:password@host.xz:project.git\nuser:password@host.xz:/path/to/repo.git\nuser:password@host.xz:/path/to/repo.git/\n*/\n\nexport class GitRemoteParser {\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(\n\t\tdata: string,\n\t\trepoPath: string,\n\t\tproviderFactory: (url: string, domain: string, path: string) => RemoteProvider | undefined,\n\t): GitRemote[] | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst remotes: GitRemote[] = [];\n\t\tconst groups = Object.create(null) as Record<string, GitRemote | undefined>;\n\n\t\tlet name;\n\t\tlet url;\n\t\tlet type;\n\n\t\tlet scheme;\n\t\tlet domain;\n\t\tlet path;\n\n\t\tlet uniqueness;\n\t\tlet remote: GitRemote | undefined;\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = remoteRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, name, url, type] = match;\n\n\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\turl = ` ${url}`.substr(1);\n\n\t\t\t[scheme, domain, path] = this.parseGitUrl(url);\n\n\t\t\tuniqueness = `${domain ? `${domain}/` : ''}${path}`;\n\t\t\tremote = groups[uniqueness];\n\t\t\tif (remote === undefined) {\n\t\t\t\tconst provider = providerFactory(url, domain, path);\n\n\t\t\t\tremote = new GitRemote(\n\t\t\t\t\trepoPath,\n\t\t\t\t\tuniqueness,\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${name}`.substr(1),\n\t\t\t\t\tscheme,\n\t\t\t\t\tprovider !== undefined ? provider.domain : domain,\n\t\t\t\t\tprovider !== undefined ? provider.path : path,\n\t\t\t\t\tprovider,\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t[{ url: url, type: ` ${type}`.substr(1) as GitRemoteType }],\n\t\t\t\t);\n\t\t\t\tremotes.push(remote);\n\t\t\t\tgroups[uniqueness] = remote;\n\t\t\t} else {\n\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\tremote.urls.push({ url: url, type: ` ${type}`.substr(1) as GitRemoteType });\n\t\t\t}\n\t\t} while (true);\n\n\t\treturn remotes;\n\t}\n\n\tstatic parseGitUrl(url: string): [string, string, string] {\n\t\tconst match = urlRegex.exec(url);\n\t\tif (match == null) return [emptyStr, emptyStr, url];\n\n\t\treturn [\n\t\t\tmatch[1] || match[3] || match[6],\n\t\t\tmatch[2] || match[4] || match[5] || match[7] || match[8],\n\t\t\tmatch[9].replace(/\\.git\\/?$/, emptyStr),\n\t\t];\n\t}\n}\n","'use strict';\nimport { debug } from '../../system';\nimport { GitContributor, GitShortLog, GitUser } from '../git';\n\nconst shortlogRegex = /^(.*?)\\t(.*?) <(.*?)>$/gm;\nconst shortstatRegex =\n\t/(?<files>\\d+) files? changed(?:, (?<additions>\\d+) insertions?\\(\\+\\))?(?:, (?<deletions>\\d+) deletions?\\(-\\))?/;\n\nexport class GitShortLogParser {\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(data: string, repoPath: string): GitShortLog | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst contributors: GitContributor[] = [];\n\n\t\tlet count;\n\t\tlet name;\n\t\tlet email;\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = shortlogRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, count, name, email] = match;\n\n\t\t\tcontributors.push(\n\t\t\t\tnew GitContributor(\n\t\t\t\t\trepoPath,\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${name}`.substr(1),\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${email}`.substr(1),\n\t\t\t\t\tNumber(count) || 0,\n\t\t\t\t\tnew Date(),\n\t\t\t\t),\n\t\t\t);\n\t\t} while (true);\n\n\t\treturn { repoPath: repoPath, contributors: contributors };\n\t}\n\n\t@debug({ args: false })\n\tstatic parseFromLog(data: string, repoPath: string, currentUser?: GitUser): GitShortLog | undefined {\n\t\tif (!data) return undefined;\n\n\t\ttype Contributor = {\n\t\t\tsha: string;\n\t\t\tname: string;\n\t\t\temail: string;\n\t\t\tcount: number;\n\t\t\ttimestamp: number;\n\t\t\tstats?: {\n\t\t\t\tfiles: number;\n\t\t\t\tadditions: number;\n\t\t\t\tdeletions: number;\n\t\t\t};\n\t\t};\n\n\t\tconst contributors = new Map<string, Contributor>();\n\n\t\tconst lines = data.trim().split('\\n');\n\t\tfor (let i = 0; i < lines.length; i++) {\n\t\t\tconst [sha, author, email, date] = lines[i].trim().split('\\0');\n\n\t\t\tlet stats:\n\t\t\t\t| {\n\t\t\t\t\t\tfiles: number;\n\t\t\t\t\t\tadditions: number;\n\t\t\t\t\t\tdeletions: number;\n\t\t\t\t  }\n\t\t\t\t| undefined;\n\t\t\tif (lines[i + 1] === '') {\n\t\t\t\ti += 2;\n\t\t\t\tconst match = shortstatRegex.exec(lines[i]);\n\n\t\t\t\tif (match?.groups != null) {\n\t\t\t\t\tconst { files, additions, deletions } = match.groups;\n\t\t\t\t\tstats = {\n\t\t\t\t\t\tfiles: Number(files || 0),\n\t\t\t\t\t\tadditions: Number(additions || 0),\n\t\t\t\t\t\tdeletions: Number(deletions || 0),\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst timestamp = Number(date);\n\n\t\t\tconst contributor = contributors.get(`${author}${email}`);\n\t\t\tif (contributor == null) {\n\t\t\t\tcontributors.set(`${author}${email}`, {\n\t\t\t\t\tsha: sha,\n\t\t\t\t\tname: author,\n\t\t\t\t\temail: email,\n\t\t\t\t\tcount: 1,\n\t\t\t\t\ttimestamp: timestamp,\n\t\t\t\t\tstats: stats,\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tcontributor.count++;\n\t\t\t\tif (stats != null) {\n\t\t\t\t\tif (contributor.stats == null) {\n\t\t\t\t\t\tcontributor.stats = stats;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontributor.stats.files += stats.files;\n\t\t\t\t\t\tcontributor.stats.additions += stats.additions;\n\t\t\t\t\t\tcontributor.stats.deletions += stats.deletions;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (timestamp > contributor.timestamp) {\n\t\t\t\t\tcontributor.timestamp = timestamp;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\trepoPath: repoPath,\n\t\t\tcontributors:\n\t\t\t\tcontributors.size === 0\n\t\t\t\t\t? []\n\t\t\t\t\t: Array.from(\n\t\t\t\t\t\t\tcontributors.values(),\n\t\t\t\t\t\t\tc =>\n\t\t\t\t\t\t\t\tnew GitContributor(\n\t\t\t\t\t\t\t\t\trepoPath,\n\t\t\t\t\t\t\t\t\tc.name,\n\t\t\t\t\t\t\t\t\tc.email,\n\t\t\t\t\t\t\t\t\tc.count,\n\t\t\t\t\t\t\t\t\tnew Date(Number(c.timestamp) * 1000),\n\t\t\t\t\t\t\t\t\tc.stats,\n\t\t\t\t\t\t\t\t\tcurrentUser != null\n\t\t\t\t\t\t\t\t\t\t? currentUser.name === c.name && currentUser.email === c.email\n\t\t\t\t\t\t\t\t\t\t: false,\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t  ),\n\t\t};\n\t}\n}\n","'use strict';\nimport { Arrays, debug, Strings } from '../../system';\nimport { fileStatusRegex, GitCommitType, GitFile, GitFileIndexStatus, GitStash, GitStashCommit } from '../git';\n// import { Logger } from './logger';\n\n// Using %x00 codes because some shells seem to try to expand things if not\nconst lb = '%x3c'; // `%x${'<'.charCodeAt(0).toString(16)}`;\nconst rb = '%x3e'; // `%x${'>'.charCodeAt(0).toString(16)}`;\nconst sl = '%x2f'; // `%x${'/'.charCodeAt(0).toString(16)}`;\nconst sp = '%x20'; // `%x${' '.charCodeAt(0).toString(16)}`;\n\nconst emptyStr = '';\nconst emptyEntry: StashEntry = {};\n\ninterface StashEntry {\n\tref?: string;\n\tdate?: string;\n\tcommittedDate?: string;\n\tfileNames?: string;\n\tfiles?: GitFile[];\n\tsummary?: string;\n\tstashName?: string;\n}\n\nexport class GitStashParser {\n\tstatic defaultFormat = [\n\t\t`${lb}${sl}f${rb}`,\n\t\t`${lb}r${rb}${sp}%H`, // ref\n\t\t`${lb}d${rb}${sp}%at`, // date\n\t\t`${lb}c${rb}${sp}%ct`, // committed date\n\t\t`${lb}l${rb}${sp}%gd`, // reflog-selector\n\t\t`${lb}s${rb}`,\n\t\t'%B', // summary\n\t\t`${lb}${sl}s${rb}`,\n\t\t`${lb}f${rb}`,\n\t].join('%n');\n\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(data: string, repoPath: string): GitStash | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst lines = Strings.lines(`${data}</f>`);\n\t\t// Skip the first line since it will always be </f>\n\t\tlet next = lines.next();\n\t\tif (next.done) return undefined;\n\n\t\tif (repoPath !== undefined) {\n\t\t\trepoPath = Strings.normalizePath(repoPath);\n\t\t}\n\n\t\tconst commits = new Map<string, GitStashCommit>();\n\n\t\tlet entry: StashEntry = emptyEntry;\n\t\tlet line: string | undefined = undefined;\n\t\tlet token: number;\n\n\t\tlet match;\n\t\tlet renamedFileName;\n\n\t\twhile (true) {\n\t\t\tnext = lines.next();\n\t\t\tif (next.done) break;\n\n\t\t\tline = next.value;\n\n\t\t\t// <<1-char token>> <data>\n\t\t\t// e.g. <r> bd1452a2dc\n\t\t\ttoken = line.charCodeAt(1);\n\n\t\t\tswitch (token) {\n\t\t\t\tcase 114: // 'r': // ref\n\t\t\t\t\tentry = {\n\t\t\t\t\t\tref: line.substring(4),\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 100: // 'd': // author-date\n\t\t\t\t\tentry.date = line.substring(4);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 99: // 'c': // committer-date\n\t\t\t\t\tentry.committedDate = line.substring(4);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 108: // 'l': // reflog-selector\n\t\t\t\t\tentry.stashName = line.substring(4);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 115: // 's': // summary\n\t\t\t\t\twhile (true) {\n\t\t\t\t\t\tnext = lines.next();\n\t\t\t\t\t\tif (next.done) break;\n\n\t\t\t\t\t\tline = next.value;\n\t\t\t\t\t\tif (line === '</s>') break;\n\n\t\t\t\t\t\tif (entry.summary === undefined) {\n\t\t\t\t\t\t\tentry.summary = line;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tentry.summary += `\\n${line}`;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Remove the trailing newline\n\t\t\t\t\tif (entry.summary != null && entry.summary.charCodeAt(entry.summary.length - 1) === 10) {\n\t\t\t\t\t\tentry.summary = entry.summary.slice(0, -1);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 102: // 'f': // files\n\t\t\t\t\t// Skip the blank line git adds before the files\n\t\t\t\t\tnext = lines.next();\n\t\t\t\t\tif (!next.done && next.value !== '</f>') {\n\t\t\t\t\t\twhile (true) {\n\t\t\t\t\t\t\tnext = lines.next();\n\t\t\t\t\t\t\tif (next.done) break;\n\n\t\t\t\t\t\t\tline = next.value;\n\t\t\t\t\t\t\tif (line === '</f>') break;\n\n\t\t\t\t\t\t\tif (line.startsWith('warning:')) continue;\n\n\t\t\t\t\t\t\tmatch = fileStatusRegex.exec(line);\n\t\t\t\t\t\t\tif (match != null) {\n\t\t\t\t\t\t\t\tif (entry.files === undefined) {\n\t\t\t\t\t\t\t\t\tentry.files = [];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\trenamedFileName = match[3];\n\t\t\t\t\t\t\t\tif (renamedFileName !== undefined) {\n\t\t\t\t\t\t\t\t\tentry.files.push({\n\t\t\t\t\t\t\t\t\t\tstatus: match[1] as GitFileIndexStatus,\n\t\t\t\t\t\t\t\t\t\tfileName: renamedFileName,\n\t\t\t\t\t\t\t\t\t\toriginalFileName: match[2],\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tentry.files.push({\n\t\t\t\t\t\t\t\t\t\tstatus: match[1] as GitFileIndexStatus,\n\t\t\t\t\t\t\t\t\t\tfileName: match[2],\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (entry.files !== undefined) {\n\t\t\t\t\t\t\tentry.fileNames = Arrays.filterMap(entry.files, f =>\n\t\t\t\t\t\t\t\tf.fileName ? f.fileName : undefined,\n\t\t\t\t\t\t\t).join(', ');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tGitStashParser.parseEntry(entry, repoPath, commits);\n\t\t\t}\n\t\t}\n\n\t\tconst stash: GitStash = {\n\t\t\trepoPath: repoPath,\n\t\t\tcommits: commits,\n\t\t};\n\t\treturn stash;\n\t}\n\n\tprivate static parseEntry(entry: StashEntry, repoPath: string, commits: Map<string, GitStashCommit>) {\n\t\tlet commit = commits.get(entry.ref!);\n\t\tif (commit === undefined) {\n\t\t\tcommit = new GitStashCommit(\n\t\t\t\tGitCommitType.Stash,\n\t\t\t\tentry.stashName!,\n\t\t\t\trepoPath,\n\t\t\t\tentry.ref!,\n\t\t\t\tnew Date((entry.date! as any) * 1000),\n\t\t\t\tnew Date((entry.committedDate! as any) * 1000),\n\t\t\t\tentry.summary === undefined ? emptyStr : entry.summary,\n\t\t\t\tentry.fileNames!,\n\t\t\t\tentry.files ?? [],\n\t\t\t);\n\t\t}\n\n\t\tcommits.set(entry.ref!, commit);\n\t}\n}\n","'use strict';\nimport { debug, Strings } from '../../system';\nimport { GitStatus, GitStatusFile } from '../git';\n\nconst emptyStr = '';\n\nconst aheadStatusV1Regex = /(?:ahead ([0-9]+))/;\nconst behindStatusV1Regex = /(?:behind ([0-9]+))/;\n\nexport class GitStatusParser {\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(data: string, repoPath: string, porcelainVersion: number): GitStatus | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst lines = data.split('\\n').filter(<T>(i?: T): i is T => Boolean(i));\n\t\tif (lines.length === 0) return undefined;\n\n\t\tif (porcelainVersion < 2) return this.parseV1(lines, repoPath);\n\n\t\treturn this.parseV2(lines, repoPath);\n\t}\n\n\t@debug({ args: false, singleLine: true })\n\tprivate static parseV1(lines: string[], repoPath: string): GitStatus {\n\t\tlet branch: string | undefined;\n\t\tconst files = [];\n\t\tconst state = {\n\t\t\tahead: 0,\n\t\t\tbehind: 0,\n\t\t};\n\t\tlet upstream;\n\n\t\tlet position = -1;\n\t\twhile (++position < lines.length) {\n\t\t\tconst line = lines[position];\n\t\t\t// Header\n\t\t\tif (line.startsWith('##')) {\n\t\t\t\tconst lineParts = line.split(' ');\n\t\t\t\t[branch, upstream] = lineParts[1].split('...');\n\t\t\t\tif (lineParts.length > 2) {\n\t\t\t\t\tconst upstreamStatus = lineParts.slice(2).join(' ');\n\n\t\t\t\t\tconst aheadStatus = aheadStatusV1Regex.exec(upstreamStatus);\n\t\t\t\t\tstate.ahead = aheadStatus == null ? 0 : Number(aheadStatus[1]) || 0;\n\n\t\t\t\t\tconst behindStatus = behindStatusV1Regex.exec(upstreamStatus);\n\t\t\t\t\tstate.behind = behindStatus == null ? 0 : Number(behindStatus[1]) || 0;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst rawStatus = line.substring(0, 2);\n\t\t\t\tconst fileName = line.substring(3);\n\t\t\t\tif (rawStatus.startsWith('R') || rawStatus.startsWith('C')) {\n\t\t\t\t\tconst [file1, file2] = fileName.replace(/\"/g, emptyStr).split('->');\n\t\t\t\t\tfiles.push(this.parseStatusFile(repoPath, rawStatus, file2.trim(), file1.trim()));\n\t\t\t\t} else {\n\t\t\t\t\tfiles.push(this.parseStatusFile(repoPath, rawStatus, fileName));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn new GitStatus(Strings.normalizePath(repoPath), branch ?? emptyStr, emptyStr, files, state, upstream);\n\t}\n\n\t@debug({ args: false, singleLine: true })\n\tprivate static parseV2(lines: string[], repoPath: string): GitStatus {\n\t\tlet branch: string | undefined;\n\t\tconst files = [];\n\t\tlet sha: string | undefined;\n\t\tconst state = {\n\t\t\tahead: 0,\n\t\t\tbehind: 0,\n\t\t};\n\t\tlet upstream;\n\n\t\tlet position = -1;\n\t\twhile (++position < lines.length) {\n\t\t\tconst line = lines[position];\n\t\t\t// Headers\n\t\t\tif (line.startsWith('#')) {\n\t\t\t\tconst lineParts = line.split(' ');\n\t\t\t\tswitch (lineParts[1]) {\n\t\t\t\t\tcase 'branch.oid':\n\t\t\t\t\t\tsha = lineParts[2];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'branch.head':\n\t\t\t\t\t\tbranch = lineParts[2];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'branch.upstream':\n\t\t\t\t\t\tupstream = lineParts[2];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'branch.ab':\n\t\t\t\t\t\tstate.ahead = Number(lineParts[2].substring(1));\n\t\t\t\t\t\tstate.behind = Number(lineParts[3].substring(1));\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst lineParts = line.split(' ');\n\t\t\t\tswitch (lineParts[0][0]) {\n\t\t\t\t\tcase '1': // normal\n\t\t\t\t\t\tfiles.push(this.parseStatusFile(repoPath, lineParts[1], lineParts.slice(8).join(' ')));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase '2': {\n\t\t\t\t\t\t// rename\n\t\t\t\t\t\tconst file = lineParts.slice(9).join(' ').split('\\t');\n\t\t\t\t\t\tfiles.push(this.parseStatusFile(repoPath, lineParts[1], file[0], file[1]));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase 'u': // unmerged\n\t\t\t\t\t\tfiles.push(this.parseStatusFile(repoPath, lineParts[1], lineParts.slice(10).join(' ')));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase '?': // untracked\n\t\t\t\t\t\tfiles.push(this.parseStatusFile(repoPath, '??', lineParts.slice(1).join(' ')));\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn new GitStatus(\n\t\t\tStrings.normalizePath(repoPath),\n\t\t\tbranch ?? emptyStr,\n\t\t\tsha ?? emptyStr,\n\t\t\tfiles,\n\t\t\tstate,\n\t\t\tupstream,\n\t\t);\n\t}\n\n\tstatic parseStatusFile(\n\t\trepoPath: string,\n\t\trawStatus: string,\n\t\tfileName: string,\n\t\toriginalFileName?: string,\n\t): GitStatusFile {\n\t\tlet x = !rawStatus.startsWith('.') ? rawStatus[0].trim() : undefined;\n\t\tif (x == null || x.length === 0) {\n\t\t\tx = undefined;\n\t\t}\n\n\t\tlet y = undefined;\n\t\tif (rawStatus.length > 1) {\n\t\t\ty = rawStatus[1] !== '.' ? rawStatus[1].trim() : undefined;\n\t\t\tif (y == null || y.length === 0) {\n\t\t\t\ty = undefined;\n\t\t\t}\n\t\t}\n\n\t\treturn new GitStatusFile(repoPath, x, y, fileName, originalFileName);\n\t}\n}\n","'use strict';\nimport { debug } from '../../system';\nimport { GitTag } from '../git';\n\nconst tagRegex = /^<n>(.+)<\\*r>(.*)<r>(.*)<d>(.*)<ad>(.*)<s>(.*)$/gm;\n\n// Using %x00 codes because some shells seem to try to expand things if not\nconst lb = '%3c'; // `%${'<'.charCodeAt(0).toString(16)}`;\nconst rb = '%3e'; // `%${'>'.charCodeAt(0).toString(16)}`;\n\nexport class GitTagParser {\n\tstatic defaultFormat = [\n\t\t`${lb}n${rb}%(refname)`, // tag name\n\t\t`${lb}*r${rb}%(*objectname)`, // ref\n\t\t`${lb}r${rb}%(objectname)`, // ref\n\t\t`${lb}d${rb}%(creatordate:iso8601)`, // created date\n\t\t`${lb}ad${rb}%(authordate:iso8601)`, // author date\n\t\t`${lb}s${rb}%(subject)`, // message\n\t].join('');\n\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(data: string, repoPath: string): GitTag[] | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst tags: GitTag[] = [];\n\n\t\tlet name;\n\t\tlet ref1;\n\t\tlet ref2;\n\t\tlet date;\n\t\tlet commitDate;\n\t\tlet message;\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = tagRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, name, ref1, ref2, date, commitDate, message] = match;\n\n\t\t\t// Strip off refs/tags/\n\t\t\tname = name.substr(10);\n\n\t\t\ttags.push(\n\t\t\t\tnew GitTag(\n\t\t\t\t\trepoPath,\n\t\t\t\t\tname,\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${ref1 || ref2}`.substr(1),\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${message}`.substr(1),\n\t\t\t\t\tnew Date(date),\n\t\t\t\t\tcommitDate == null || commitDate.length === 0 ? undefined : new Date(commitDate),\n\t\t\t\t),\n\t\t\t);\n\t\t} while (true);\n\n\t\treturn tags;\n\t}\n}\n","'use strict';\nimport { debug } from '../../system';\nimport { GitTree } from '../git';\n\nconst emptyStr = '';\nconst treeRegex = /(?:.+?)\\s+(.+?)\\s+(.+?)\\s+(.+?)\\s+(.+)/gm;\n\nexport class GitTreeParser {\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(data: string | undefined): GitTree[] | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst trees: GitTree[] = [];\n\n\t\tlet type;\n\t\tlet sha;\n\t\tlet size;\n\t\tlet filePath;\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = treeRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, type, sha, size, filePath] = match;\n\n\t\t\ttrees.push({\n\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\tcommitSha: sha == null || sha.length === 0 ? emptyStr : ` ${sha}`.substr(1),\n\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\tpath: filePath == null || filePath.length === 0 ? emptyStr : ` ${filePath}`.substr(1),\n\t\t\t\tsize: Number(size) || 0,\n\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\ttype: (type == null || type.length === 0 ? emptyStr : ` ${type}`.substr(1)) as 'blob' | 'tree',\n\t\t\t});\n\t\t} while (true);\n\n\t\treturn trees;\n\t}\n}\n","'use strict';\nimport { Range, Uri } from 'vscode';\nimport { DynamicAutolinkReference } from '../../annotations/autolinks';\nimport { AutolinkReference } from '../../config';\nimport { Repository } from '../models/repository';\nimport { RemoteProvider } from './provider';\n\nconst gitRegex = /\\/_git\\/?/i;\nconst legacyDefaultCollectionRegex = /^DefaultCollection\\//i;\nconst orgAndProjectRegex = /^(.*?)\\/(.*?)\\/(.*)/;\nconst sshDomainRegex = /^(ssh|vs-ssh)\\./i;\nconst sshPathRegex = /^\\/?v\\d\\//i;\n\nconst fileRegex = /path=([^&]+)/i;\nconst rangeRegex = /line=(\\d+)(?:&lineEnd=(\\d+))?/;\n\nexport class AzureDevOpsRemote extends RemoteProvider {\n\tconstructor(domain: string, path: string, protocol?: string, name?: string, legacy: boolean = false) {\n\t\tif (sshDomainRegex.test(domain)) {\n\t\t\tpath = path.replace(sshPathRegex, '');\n\t\t\tdomain = domain.replace(sshDomainRegex, '');\n\n\t\t\t// Add in /_git/ into ssh urls\n\t\t\tconst match = orgAndProjectRegex.exec(path);\n\t\t\tif (match != null) {\n\t\t\t\tconst [, org, project, rest] = match;\n\n\t\t\t\t// Handle legacy vsts urls\n\t\t\t\tif (legacy) {\n\t\t\t\t\tdomain = `${org}.${domain}`;\n\t\t\t\t\tpath = `${project}/_git/${rest}`;\n\t\t\t\t} else {\n\t\t\t\t\tpath = `${org}/${project}/_git/${rest}`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Azure DevOps allows projects and repository names with spaces. In that situation,\n\t\t// the `path` will be previously encoded during git clone\n\t\t// revert that encoding to avoid double-encoding by gitlens during copy remote and open remote\n\t\tpath = decodeURIComponent(path);\n\t\tsuper(domain, path, protocol, name);\n\t}\n\n\tprivate _autolinks: (AutolinkReference | DynamicAutolinkReference)[] | undefined;\n\toverride get autolinks(): (AutolinkReference | DynamicAutolinkReference)[] {\n\t\tif (this._autolinks === undefined) {\n\t\t\t// Strip off any `_git` part from the repo url\n\t\t\tconst baseUrl = this.baseUrl.replace(gitRegex, '/');\n\t\t\tthis._autolinks = [\n\t\t\t\t{\n\t\t\t\t\tprefix: '#',\n\t\t\t\t\turl: `${baseUrl}/_workitems/edit/<num>`,\n\t\t\t\t\ttitle: `Open Work Item #<num> on ${this.name}`,\n\t\t\t\t},\n\t\t\t];\n\t\t}\n\t\treturn this._autolinks;\n\t}\n\n\toverride get icon() {\n\t\treturn 'vsts';\n\t}\n\n\tget id() {\n\t\treturn 'azure-devops';\n\t}\n\n\tget name() {\n\t\treturn 'Azure DevOps';\n\t}\n\n\tprivate _displayPath: string | undefined;\n\toverride get displayPath(): string {\n\t\tif (this._displayPath === undefined) {\n\t\t\tthis._displayPath = this.path.replace(gitRegex, '/').replace(legacyDefaultCollectionRegex, '');\n\t\t}\n\t\treturn this._displayPath;\n\t}\n\n\tasync getLocalInfoFromRemoteUri(\n\t\trepository: Repository,\n\t\turi: Uri,\n\t\toptions?: { validate?: boolean },\n\t): Promise<{ uri: Uri; startLine?: number; endLine?: number } | undefined> {\n\t\tif (uri.authority !== this.domain) return Promise.resolve(undefined);\n\t\t// if ((options?.validate ?? true) && !uri.path.startsWith(`/${this.path}/`)) return undefined;\n\n\t\tlet startLine;\n\t\tlet endLine;\n\t\tif (uri.query) {\n\t\t\tconst match = rangeRegex.exec(uri.query);\n\t\t\tif (match != null) {\n\t\t\t\tconst [, start, end] = match;\n\t\t\t\tif (start) {\n\t\t\t\t\tstartLine = parseInt(start, 10);\n\t\t\t\t\tif (end) {\n\t\t\t\t\t\tendLine = parseInt(end, 10);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst match = fileRegex.exec(uri.query);\n\t\tif (match == null) return Promise.resolve(undefined);\n\n\t\tconst [, path] = match;\n\n\t\tconst absoluteUri = repository.toAbsoluteUri(path, { validate: options?.validate });\n\t\treturn Promise.resolve(\n\t\t\tabsoluteUri != null ? { uri: absoluteUri, startLine: startLine, endLine: endLine } : undefined,\n\t\t);\n\t}\n\n\tprotected getUrlForBranches(): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/branches`);\n\t}\n\n\tprotected getUrlForBranch(branch: string): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/?version=GB${branch}&_a=history`);\n\t}\n\n\tprotected getUrlForCommit(sha: string): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/commit/${sha}`);\n\t}\n\n\tprotected override getUrlForComparison(base: string, compare: string, _notation: '..' | '...'): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/branchCompare?baseVersion=GB${base}&targetVersion=GB${compare}`);\n\t}\n\n\tprotected getUrlForFile(fileName: string, branch?: string, sha?: string, range?: Range): string {\n\t\tlet line;\n\t\tif (range != null) {\n\t\t\tif (range.start.line === range.end.line) {\n\t\t\t\tline = `&line=${range.start.line}&lineStartColumn=${range.start.character + 1}&lineEndColumn=${\n\t\t\t\t\trange.end.character + 1\n\t\t\t\t}`;\n\t\t\t} else {\n\t\t\t\tline = `&line=${range.start.line}&lineEnd=${range.end.line}&lineStartColumn=${\n\t\t\t\t\trange.start.character + 1\n\t\t\t\t}&lineEndColumn=${range.end.character + 1}`;\n\t\t\t}\n\t\t} else {\n\t\t\tline = '';\n\t\t}\n\n\t\tif (sha) return this.encodeUrl(`${this.baseUrl}?path=${fileName}&version=GC${sha}${line}&_a=contents`);\n\t\tif (branch) return this.encodeUrl(`${this.baseUrl}/?path=/${fileName}&version=GB${branch}&_a=contents${line}`);\n\t\treturn this.encodeUrl(`${this.baseUrl}?path=/${fileName}${line}`);\n\t}\n}\n","'use strict';\nimport { Range, Uri } from 'vscode';\nimport { DynamicAutolinkReference } from '../../annotations/autolinks';\nimport { AutolinkReference } from '../../config';\nimport { GitRevision } from '../models/models';\nimport { Repository } from '../models/repository';\nimport { RemoteProvider } from './provider';\n\nconst fileRegex = /^\\/([^/]+)\\/([^/]+?)\\/src(.+)$/i;\nconst rangeRegex = /^lines-(\\d+)(?::(\\d+))?$/;\n\nexport class BitbucketRemote extends RemoteProvider {\n\tconstructor(domain: string, path: string, protocol?: string, name?: string, custom: boolean = false) {\n\t\tsuper(domain, path, protocol, name, custom);\n\t}\n\n\tprivate _autolinks: (AutolinkReference | DynamicAutolinkReference)[] | undefined;\n\toverride get autolinks(): (AutolinkReference | DynamicAutolinkReference)[] {\n\t\tif (this._autolinks === undefined) {\n\t\t\tthis._autolinks = [\n\t\t\t\t{\n\t\t\t\t\tprefix: 'issue #',\n\t\t\t\t\turl: `${this.baseUrl}/issues/<num>`,\n\t\t\t\t\ttitle: `Open Issue #<num> on ${this.name}`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tprefix: 'pull request #',\n\t\t\t\t\turl: `${this.baseUrl}/pull-requests/<num>`,\n\t\t\t\t\ttitle: `Open PR #<num> on ${this.name}`,\n\t\t\t\t},\n\t\t\t];\n\t\t}\n\t\treturn this._autolinks;\n\t}\n\n\toverride get icon() {\n\t\treturn 'bitbucket';\n\t}\n\n\tget id() {\n\t\treturn 'bitbucket';\n\t}\n\n\tget name() {\n\t\treturn this.formatName('Bitbucket');\n\t}\n\n\tasync getLocalInfoFromRemoteUri(\n\t\trepository: Repository,\n\t\turi: Uri,\n\t\toptions?: { validate?: boolean },\n\t): Promise<{ uri: Uri; startLine?: number; endLine?: number } | undefined> {\n\t\tif (uri.authority !== this.domain) return undefined;\n\t\tif ((options?.validate ?? true) && !uri.path.startsWith(`/${this.path}/`)) return undefined;\n\n\t\tlet startLine;\n\t\tlet endLine;\n\t\tif (uri.fragment) {\n\t\t\tconst match = rangeRegex.exec(uri.fragment);\n\t\t\tif (match != null) {\n\t\t\t\tconst [, start, end] = match;\n\t\t\t\tif (start) {\n\t\t\t\t\tstartLine = parseInt(start, 10);\n\t\t\t\t\tif (end) {\n\t\t\t\t\t\tendLine = parseInt(end, 10);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst match = fileRegex.exec(uri.path);\n\t\tif (match == null) return undefined;\n\n\t\tconst [, , , path] = match;\n\n\t\t// Check for a permalink\n\t\tlet index = path.indexOf('/', 1);\n\t\tif (index !== -1) {\n\t\t\tconst sha = path.substring(1, index);\n\t\t\tif (GitRevision.isSha(sha)) {\n\t\t\t\tconst uri = repository.toAbsoluteUri(path.substr(index), { validate: options?.validate });\n\t\t\t\tif (uri != null) return { uri: uri, startLine: startLine, endLine: endLine };\n\t\t\t}\n\t\t}\n\n\t\tconst branches = new Set<string>(\n\t\t\t(\n\t\t\t\tawait repository.getBranches({\n\t\t\t\t\tfilter: b => b.remote,\n\t\t\t\t})\n\t\t\t).map(b => b.getNameWithoutRemote()),\n\t\t);\n\n\t\t// Check for a link with branch (and deal with branch names with /)\n\t\tlet branch;\n\t\tindex = path.length;\n\t\tdo {\n\t\t\tindex = path.lastIndexOf('/', index - 1);\n\t\t\tbranch = path.substring(1, index);\n\n\t\t\tif (branches.has(branch)) {\n\t\t\t\tconst uri = repository.toAbsoluteUri(path.substr(index), { validate: options?.validate });\n\t\t\t\tif (uri != null) return { uri: uri, startLine: startLine, endLine: endLine };\n\t\t\t}\n\t\t} while (index > 0);\n\n\t\treturn undefined;\n\t}\n\n\tprotected getUrlForBranches(): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/branches`);\n\t}\n\n\tprotected getUrlForBranch(branch: string): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/branch/${branch}`);\n\t}\n\n\tprotected getUrlForCommit(sha: string): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/commits/${sha}`);\n\t}\n\n\tprotected override getUrlForComparison(base: string, compare: string, _notation: '..' | '...'): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/branches/compare/${base}%0D${compare}`).replace('%250D', '%0D');\n\t}\n\n\tprotected getUrlForFile(fileName: string, branch?: string, sha?: string, range?: Range): string {\n\t\tlet line;\n\t\tif (range != null) {\n\t\t\tif (range.start.line === range.end.line) {\n\t\t\t\tline = `#${fileName}-${range.start.line}`;\n\t\t\t} else {\n\t\t\t\tline = `#${fileName}-${range.start.line}:${range.end.line}`;\n\t\t\t}\n\t\t} else {\n\t\t\tline = '';\n\t\t}\n\n\t\tif (sha) return `${this.encodeUrl(`${this.baseUrl}/src/${sha}/${fileName}`)}${line}`;\n\t\tif (branch) return `${this.encodeUrl(`${this.baseUrl}/src/${branch}/${fileName}`)}${line}`;\n\t\treturn `${this.encodeUrl(`${this.baseUrl}?path=${fileName}`)}${line}`;\n\t}\n}\n","'use strict';\nimport { Range, Uri } from 'vscode';\nimport { DynamicAutolinkReference } from '../../annotations/autolinks';\nimport { AutolinkReference } from '../../config';\nimport { GitRevision } from '../models/models';\nimport { Repository } from '../models/repository';\nimport { RemoteProvider } from './provider';\n\nconst fileRegex = /^\\/([^/]+)\\/([^/]+?)\\/src(.+)$/i;\nconst rangeRegex = /^lines-(\\d+)(?::(\\d+))?$/;\n\nexport class BitbucketServerRemote extends RemoteProvider {\n\tconstructor(domain: string, path: string, protocol?: string, name?: string, custom: boolean = false) {\n\t\tsuper(domain, path, protocol, name, custom);\n\t}\n\n\tprivate _autolinks: (AutolinkReference | DynamicAutolinkReference)[] | undefined;\n\toverride get autolinks(): (AutolinkReference | DynamicAutolinkReference)[] {\n\t\tif (this._autolinks === undefined) {\n\t\t\tthis._autolinks = [\n\t\t\t\t{\n\t\t\t\t\tprefix: 'issue #',\n\t\t\t\t\turl: `${this.baseUrl}/issues/<num>`,\n\t\t\t\t\ttitle: `Open Issue #<num> on ${this.name}`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tprefix: 'pull request #',\n\t\t\t\t\turl: `${this.baseUrl}/pull-requests/<num>`,\n\t\t\t\t\ttitle: `Open PR #<num> on ${this.name}`,\n\t\t\t\t},\n\t\t\t];\n\t\t}\n\t\treturn this._autolinks;\n\t}\n\n\tprotected override get baseUrl(): string {\n\t\tconst [project, repo] = this.path.startsWith('scm/')\n\t\t\t? this.path.replace('scm/', '').split('/')\n\t\t\t: this.splitPath();\n\t\treturn `${this.protocol}://${this.domain}/projects/${project}/repos/${repo}`;\n\t}\n\n\toverride get icon() {\n\t\treturn 'bitbucket';\n\t}\n\n\tget id() {\n\t\treturn 'bitbucket-server';\n\t}\n\n\tget name() {\n\t\treturn this.formatName('Bitbucket Server');\n\t}\n\n\tasync getLocalInfoFromRemoteUri(\n\t\trepository: Repository,\n\t\turi: Uri,\n\t\toptions?: { validate?: boolean },\n\t): Promise<{ uri: Uri; startLine?: number; endLine?: number } | undefined> {\n\t\tif (uri.authority !== this.domain) return undefined;\n\t\tif ((options?.validate ?? true) && !uri.path.startsWith(`/${this.path}/`)) return undefined;\n\n\t\tlet startLine;\n\t\tlet endLine;\n\t\tif (uri.fragment) {\n\t\t\tconst match = rangeRegex.exec(uri.fragment);\n\t\t\tif (match != null) {\n\t\t\t\tconst [, start, end] = match;\n\t\t\t\tif (start) {\n\t\t\t\t\tstartLine = parseInt(start, 10);\n\t\t\t\t\tif (end) {\n\t\t\t\t\t\tendLine = parseInt(end, 10);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst match = fileRegex.exec(uri.path);\n\t\tif (match == null) return undefined;\n\n\t\tconst [, , , path] = match;\n\n\t\t// Check for a permalink\n\t\tlet index = path.indexOf('/', 1);\n\t\tif (index !== -1) {\n\t\t\tconst sha = path.substring(1, index);\n\t\t\tif (GitRevision.isSha(sha)) {\n\t\t\t\tconst uri = repository.toAbsoluteUri(path.substr(index), { validate: options?.validate });\n\t\t\t\tif (uri != null) return { uri: uri, startLine: startLine, endLine: endLine };\n\t\t\t}\n\t\t}\n\n\t\tconst branches = new Set<string>(\n\t\t\t(\n\t\t\t\tawait repository.getBranches({\n\t\t\t\t\tfilter: b => b.remote,\n\t\t\t\t})\n\t\t\t).map(b => b.getNameWithoutRemote()),\n\t\t);\n\n\t\t// Check for a link with branch (and deal with branch names with /)\n\t\tlet branch;\n\t\tindex = path.length;\n\t\tdo {\n\t\t\tindex = path.lastIndexOf('/', index - 1);\n\t\t\tbranch = path.substring(1, index);\n\n\t\t\tif (branches.has(branch)) {\n\t\t\t\tconst uri = repository.toAbsoluteUri(path.substr(index), { validate: options?.validate });\n\t\t\t\tif (uri != null) return { uri: uri, startLine: startLine, endLine: endLine };\n\t\t\t}\n\t\t} while (index > 0);\n\n\t\treturn undefined;\n\t}\n\n\tprotected getUrlForBranches(): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/branches`);\n\t}\n\n\tprotected getUrlForBranch(branch: string): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/commits?until=${branch}`);\n\t}\n\n\tprotected getUrlForCommit(sha: string): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/commits/${sha}`);\n\t}\n\n\tprotected override getUrlForComparison(base: string, compare: string, _notation: '..' | '...'): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/branches/compare/${base}%0D${compare}`).replace('%250D', '%0D');\n\t}\n\n\tprotected getUrlForFile(fileName: string, branch?: string, sha?: string, range?: Range): string {\n\t\tlet line;\n\t\tif (range != null) {\n\t\t\tif (range.start.line === range.end.line) {\n\t\t\t\tline = `#${range.start.line}`;\n\t\t\t} else {\n\t\t\t\tline = `#${range.start.line}-${range.end.line}`;\n\t\t\t}\n\t\t} else {\n\t\t\tline = '';\n\t\t}\n\t\tif (sha) return `${this.encodeUrl(`${this.baseUrl}/browse/${fileName}?at=${sha}`)}${line}`;\n\t\tif (branch) return `${this.encodeUrl(`${this.baseUrl}/browse/${fileName}?at=${branch}`)}${line}`;\n\t\treturn `${this.encodeUrl(`${this.baseUrl}/browse/${fileName}`)}${line}`;\n\t}\n}\n","'use strict';\nimport { Range, Uri } from 'vscode';\nimport { RemotesUrlsConfig } from '../../configuration';\nimport { Strings } from '../../system';\nimport { Repository } from '../models/repository';\nimport { RemoteProvider } from './provider';\n\nexport class CustomRemote extends RemoteProvider {\n\tprivate readonly urls: RemotesUrlsConfig;\n\n\tconstructor(domain: string, path: string, urls: RemotesUrlsConfig, protocol?: string, name?: string) {\n\t\tsuper(domain, path, protocol, name, true);\n\t\tthis.urls = urls;\n\t}\n\n\tget id() {\n\t\treturn 'custom';\n\t}\n\n\tget name() {\n\t\treturn this.formatName('Custom');\n\t}\n\n\tgetLocalInfoFromRemoteUri(\n\t\t_repository: Repository,\n\t\t_uri: Uri,\n\t): Promise<{ uri: Uri; startLine?: number; endLine?: number } | undefined> {\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tprotected override getUrlForRepository(): string {\n\t\treturn this.encodeUrl(Strings.interpolate(this.urls.repository, this.getContext()));\n\t}\n\n\tprotected getUrlForBranches(): string {\n\t\treturn this.encodeUrl(Strings.interpolate(this.urls.branches, this.getContext()));\n\t}\n\n\tprotected getUrlForBranch(branch: string): string {\n\t\treturn this.encodeUrl(Strings.interpolate(this.urls.branch, this.getContext({ branch: branch })));\n\t}\n\n\tprotected getUrlForCommit(sha: string): string {\n\t\treturn this.encodeUrl(Strings.interpolate(this.urls.commit, this.getContext({ id: sha })));\n\t}\n\n\tprotected override getUrlForComparison(base: string, compare: string, notation: '..' | '...'): string | undefined {\n\t\tif (this.urls.comparison == null) return undefined;\n\n\t\treturn this.encodeUrl(\n\t\t\tStrings.interpolate(\n\t\t\t\tthis.urls.comparison,\n\t\t\t\tthis.getContext({ ref1: base, ref2: compare, notation: notation }),\n\t\t\t),\n\t\t);\n\t}\n\n\tprotected getUrlForFile(fileName: string, branch?: string, sha?: string, range?: Range): string {\n\t\tlet line;\n\t\tif (range != null) {\n\t\t\tif (range.start.line === range.end.line) {\n\t\t\t\tline = Strings.interpolate(this.urls.fileLine, { line: range.start.line });\n\t\t\t} else {\n\t\t\t\tline = Strings.interpolate(this.urls.fileRange, { start: range.start.line, end: range.end.line });\n\t\t\t}\n\t\t} else {\n\t\t\tline = '';\n\t\t}\n\n\t\tlet url;\n\t\tif (sha) {\n\t\t\turl = Strings.interpolate(this.urls.fileInCommit, this.getContext({ id: sha, file: fileName, line: line }));\n\t\t} else if (branch) {\n\t\t\turl = Strings.interpolate(\n\t\t\t\tthis.urls.fileInBranch,\n\t\t\t\tthis.getContext({ branch: branch, file: fileName, line: line }),\n\t\t\t);\n\t\t} else {\n\t\t\turl = Strings.interpolate(this.urls.file, this.getContext({ file: fileName, line: line }));\n\t\t}\n\n\t\tconst decodeHash = url.includes('#');\n\t\turl = this.encodeUrl(url);\n\t\tif (decodeHash) {\n\t\t\tconst index = url.lastIndexOf('%23');\n\t\t\tif (index !== -1) {\n\t\t\t\turl = `${url.substring(0, index)}#${url.substring(index + 3)}`;\n\t\t\t}\n\t\t}\n\t\treturn url;\n\t}\n\n\tprivate getContext(context?: Record<string, unknown>) {\n\t\tconst [repoBase, repoPath] = this.splitPath();\n\t\treturn {\n\t\t\trepo: this.path,\n\t\t\trepoBase: repoBase,\n\t\t\trepoPath: repoPath,\n\t\t\t...(context ?? {}),\n\t\t};\n\t}\n}\n","'use strict';\nimport { Range, Uri } from 'vscode';\nimport { DynamicAutolinkReference } from '../../annotations/autolinks';\nimport { AutolinkReference } from '../../config';\nimport { GitRevision } from '../models/models';\nimport { Repository } from '../models/repository';\nimport { RemoteProvider } from './provider';\n\nconst fileRegex = /^\\/([^/]+)\\/([^/]+?)\\/src(.+)$/i;\nconst rangeRegex = /^L(\\d+)(?:-L(\\d+))?$/;\n\nexport class GiteaRemote extends RemoteProvider {\n\tconstructor(domain: string, path: string, protocol?: string, name?: string, custom: boolean = false) {\n\t\tsuper(domain, path, protocol, name, custom);\n\t}\n\n\tprivate _autolinks: (AutolinkReference | DynamicAutolinkReference)[] | undefined;\n\toverride get autolinks(): (AutolinkReference | DynamicAutolinkReference)[] {\n\t\tif (this._autolinks === undefined) {\n\t\t\tthis._autolinks = [\n\t\t\t\t{\n\t\t\t\t\tprefix: '#',\n\t\t\t\t\turl: `${this.baseUrl}/issues/<num>`,\n\t\t\t\t\ttitle: `Open Issue #<num> on ${this.name}`,\n\t\t\t\t},\n\t\t\t];\n\t\t}\n\t\treturn this._autolinks;\n\t}\n\n\toverride get icon() {\n\t\treturn 'gitea';\n\t}\n\n\tget id() {\n\t\treturn 'gitea';\n\t}\n\n\tget name() {\n\t\treturn this.formatName('Gitea');\n\t}\n\n\tasync getLocalInfoFromRemoteUri(\n\t\trepository: Repository,\n\t\turi: Uri,\n\t\toptions?: { validate?: boolean },\n\t): Promise<{ uri: Uri; startLine?: number; endLine?: number } | undefined> {\n\t\tif (uri.authority !== this.domain) return undefined;\n\t\tif ((options?.validate ?? true) && !uri.path.startsWith(`/${this.path}/`)) return undefined;\n\n\t\tlet startLine;\n\t\tlet endLine;\n\t\tif (uri.fragment) {\n\t\t\tconst match = rangeRegex.exec(uri.fragment);\n\t\t\tif (match != null) {\n\t\t\t\tconst [, start, end] = match;\n\t\t\t\tif (start) {\n\t\t\t\t\tstartLine = parseInt(start, 10);\n\t\t\t\t\tif (end) {\n\t\t\t\t\t\tendLine = parseInt(end, 10);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst match = fileRegex.exec(uri.path);\n\t\tif (match == null) return undefined;\n\n\t\tconst [, , , path] = match;\n\t\tlet offset;\n\t\tlet index;\n\n\t\t// Check for a permalink\n\t\tif (path.startsWith('/commit/')) {\n\t\t\toffset = '/commit/'.length;\n\t\t\tindex = path.indexOf('/', offset);\n\t\t\tif (index !== -1) {\n\t\t\t\tconst sha = path.substring(offset, index);\n\t\t\t\tif (GitRevision.isSha(sha)) {\n\t\t\t\t\tconst uri = repository.toAbsoluteUri(path.substr(index), { validate: options?.validate });\n\t\t\t\t\tif (uri != null) return { uri: uri, startLine: startLine, endLine: endLine };\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst branches = new Set<string>(\n\t\t\t(\n\t\t\t\tawait repository.getBranches({\n\t\t\t\t\tfilter: b => b.remote,\n\t\t\t\t})\n\t\t\t).map(b => b.getNameWithoutRemote()),\n\t\t);\n\n\t\t// Check for a link with branch (and deal with branch names with /)\n\t\tif (path.startsWith('/branch/')) {\n\t\t\tlet branch;\n\t\t\toffset = '/branch/'.length;\n\t\t\tindex = offset;\n\t\t\tdo {\n\t\t\t\tbranch = path.substring(offset, index);\n\n\t\t\t\tif (branches.has(branch)) {\n\t\t\t\t\tconst uri = repository.toAbsoluteUri(path.substr(index), { validate: options?.validate });\n\t\t\t\t\tif (uri != null) return { uri: uri, startLine: startLine, endLine: endLine };\n\t\t\t\t}\n\n\t\t\t\tindex = path.indexOf('/', index + 1);\n\t\t\t} while (index < path.length && index !== -1);\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprotected getUrlForBranches(): string {\n\t\treturn `${this.baseUrl}/branches`;\n\t}\n\n\tprotected getUrlForBranch(branch: string): string {\n\t\treturn `${this.baseUrl}/src/branch/${branch}`;\n\t}\n\n\tprotected getUrlForCommit(sha: string): string {\n\t\treturn `${this.baseUrl}/commit/${sha}`;\n\t}\n\n\tprotected override getUrlForComparison(ref1: string, ref2: string, _notation: '..' | '...'): string {\n\t\treturn `${this.baseUrl}/compare/${ref1}...${ref2}`;\n\t}\n\n\tprotected getUrlForFile(fileName: string, branch?: string, sha?: string, range?: Range): string {\n\t\tlet line;\n\t\tif (range != null) {\n\t\t\tif (range.start.line === range.end.line) {\n\t\t\t\tline = `#L${range.start.line}`;\n\t\t\t} else {\n\t\t\t\tline = `#L${range.start.line}-L${range.end.line}`;\n\t\t\t}\n\t\t} else {\n\t\t\tline = '';\n\t\t}\n\n\t\tif (sha) return `${this.baseUrl}/src/commit/${sha}/${fileName}${line}`;\n\t\tif (branch) return `${this.baseUrl}/src/branch/${branch}/${fileName}${line}`;\n\t\t// this route is deprecated but there is no alternative\n\t\treturn `${this.baseUrl}/src/${fileName}${line}`;\n\t}\n}\n","'use strict';\nimport { AuthenticationSession, Range, Uri } from 'vscode';\nimport { DynamicAutolinkReference } from '../../annotations/autolinks';\nimport { AutolinkReference } from '../../config';\nimport { Container } from '../../container';\nimport { GitHubPullRequest } from '../../github/github';\nimport {\n\tAccount,\n\tDefaultBranch,\n\tGitRevision,\n\tIssueOrPullRequest,\n\tPullRequest,\n\tPullRequestState,\n\tRepository,\n} from '../models/models';\nimport { RichRemoteProvider } from './provider';\n\nconst issueEnricher3rdPartyRegex = /\\b(?<repo>[^/\\s]+\\/[^/\\s]+)\\\\#(?<num>[0-9]+)\\b(?!]\\()/g;\nconst fileRegex = /^\\/([^/]+)\\/([^/]+?)\\/blob(.+)$/i;\nconst rangeRegex = /^L(\\d+)(?:-L(\\d+))?$/;\n\nconst authProvider = Object.freeze({ id: 'github', scopes: ['repo'] });\n\nexport class GitHubRemote extends RichRemoteProvider {\n\tprotected get authProvider() {\n\t\treturn authProvider;\n\t}\n\n\tconstructor(domain: string, path: string, protocol?: string, name?: string, custom: boolean = false) {\n\t\tsuper(domain, path, protocol, name, custom);\n\t}\n\n\tget apiBaseUrl() {\n\t\treturn this.custom ? `${this.protocol}://${this.domain}/api` : `https://api.${this.domain}`;\n\t}\n\n\tprivate _autolinks: (AutolinkReference | DynamicAutolinkReference)[] | undefined;\n\toverride get autolinks(): (AutolinkReference | DynamicAutolinkReference)[] {\n\t\tif (this._autolinks === undefined) {\n\t\t\tthis._autolinks = [\n\t\t\t\t{\n\t\t\t\t\tprefix: '#',\n\t\t\t\t\turl: `${this.baseUrl}/issues/<num>`,\n\t\t\t\t\ttitle: `Open Issue #<num> on ${this.name}`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tprefix: 'gh-',\n\t\t\t\t\turl: `${this.baseUrl}/issues/<num>`,\n\t\t\t\t\ttitle: `Open Issue #<num> on ${this.name}`,\n\t\t\t\t\tignoreCase: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlinkify: (text: string) =>\n\t\t\t\t\t\ttext.replace(\n\t\t\t\t\t\t\tissueEnricher3rdPartyRegex,\n\t\t\t\t\t\t\t`[$&](${this.protocol}://${this.domain}/$<repo>/issues/$<num> \"Open Issue #$<num> from $<repo> on ${this.name}\")`,\n\t\t\t\t\t\t),\n\t\t\t\t},\n\t\t\t];\n\t\t}\n\t\treturn this._autolinks;\n\t}\n\n\toverride get icon() {\n\t\treturn 'github';\n\t}\n\n\tget id() {\n\t\treturn 'github';\n\t}\n\n\tget name() {\n\t\treturn this.formatName('GitHub');\n\t}\n\n\tasync getLocalInfoFromRemoteUri(\n\t\trepository: Repository,\n\t\turi: Uri,\n\t\toptions?: { validate?: boolean },\n\t): Promise<{ uri: Uri; startLine?: number; endLine?: number } | undefined> {\n\t\tif (uri.authority !== this.domain) return undefined;\n\t\tif ((options?.validate ?? true) && !uri.path.startsWith(`/${this.path}/`)) return undefined;\n\n\t\tlet startLine;\n\t\tlet endLine;\n\t\tif (uri.fragment) {\n\t\t\tconst match = rangeRegex.exec(uri.fragment);\n\t\t\tif (match != null) {\n\t\t\t\tconst [, start, end] = match;\n\t\t\t\tif (start) {\n\t\t\t\t\tstartLine = parseInt(start, 10);\n\t\t\t\t\tif (end) {\n\t\t\t\t\t\tendLine = parseInt(end, 10);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst match = fileRegex.exec(uri.path);\n\t\tif (match == null) return undefined;\n\n\t\tconst [, , , path] = match;\n\n\t\t// Check for a permalink\n\t\tlet index = path.indexOf('/', 1);\n\t\tif (index !== -1) {\n\t\t\tconst sha = path.substring(1, index);\n\t\t\tif (GitRevision.isSha(sha)) {\n\t\t\t\tconst uri = repository.toAbsoluteUri(path.substr(index), { validate: options?.validate });\n\t\t\t\tif (uri != null) return { uri: uri, startLine: startLine, endLine: endLine };\n\t\t\t}\n\t\t}\n\n\t\tconst branches = new Set<string>(\n\t\t\t(\n\t\t\t\tawait repository.getBranches({\n\t\t\t\t\tfilter: b => b.remote,\n\t\t\t\t})\n\t\t\t).map(b => b.getNameWithoutRemote()),\n\t\t);\n\n\t\t// Check for a link with branch (and deal with branch names with /)\n\t\tlet branch;\n\t\tindex = path.length;\n\t\tdo {\n\t\t\tindex = path.lastIndexOf('/', index - 1);\n\t\t\tbranch = path.substring(1, index);\n\n\t\t\tif (branches.has(branch)) {\n\t\t\t\tconst uri = repository.toAbsoluteUri(path.substr(index), { validate: options?.validate });\n\t\t\t\tif (uri != null) return { uri: uri, startLine: startLine, endLine: endLine };\n\t\t\t}\n\t\t} while (index > 0);\n\n\t\treturn undefined;\n\t}\n\n\tprotected getUrlForBranches(): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/branches`);\n\t}\n\n\tprotected getUrlForBranch(branch: string): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/tree/${branch}`);\n\t}\n\n\tprotected getUrlForCommit(sha: string): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/commit/${sha}`);\n\t}\n\n\tprotected override getUrlForComparison(base: string, compare: string, notation: '..' | '...'): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/compare/${base}${notation}${compare}`);\n\t}\n\n\tprotected override getUrlForCreatePullRequest(\n\t\tbase: { branch?: string; remote: { path: string; url: string } },\n\t\tcompare: { branch: string; remote: { path: string; url: string } },\n\t): string | undefined {\n\t\tif (base.remote.url === compare.remote.url) {\n\t\t\treturn this.encodeUrl(`${this.baseUrl}/pull/new/${base.branch ?? 'HEAD'}...${compare.branch}`);\n\t\t}\n\n\t\tconst [owner] = compare.remote.path.split('/', 1);\n\t\treturn this.encodeUrl(`${this.baseUrl}/pull/new/${base.branch ?? 'HEAD'}...${owner}:${compare.branch}`);\n\t}\n\n\tprotected getUrlForFile(fileName: string, branch?: string, sha?: string, range?: Range): string {\n\t\tlet line;\n\t\tif (range != null) {\n\t\t\tif (range.start.line === range.end.line) {\n\t\t\t\tline = `#L${range.start.line}`;\n\t\t\t} else {\n\t\t\t\tline = `#L${range.start.line}-L${range.end.line}`;\n\t\t\t}\n\t\t} else {\n\t\t\tline = '';\n\t\t}\n\n\t\tif (sha) return `${this.encodeUrl(`${this.baseUrl}/blob/${sha}/${fileName}`)}${line}`;\n\t\tif (branch) return `${this.encodeUrl(`${this.baseUrl}/blob/${branch}/${fileName}`)}${line}`;\n\t\treturn `${this.encodeUrl(`${this.baseUrl}?path=${fileName}`)}${line}`;\n\t}\n\n\tprotected async getProviderAccountForCommit(\n\t\t{ accessToken }: AuthenticationSession,\n\t\tref: string,\n\t\toptions?: {\n\t\t\tavatarSize?: number;\n\t\t},\n\t): Promise<Account | undefined> {\n\t\tconst [owner, repo] = this.splitPath();\n\t\treturn (await Container.github)?.getAccountForCommit(this, accessToken, owner, repo, ref, {\n\t\t\t...options,\n\t\t\tbaseUrl: this.apiBaseUrl,\n\t\t});\n\t}\n\n\tprotected async getProviderAccountForEmail(\n\t\t{ accessToken }: AuthenticationSession,\n\t\temail: string,\n\t\toptions?: {\n\t\t\tavatarSize?: number;\n\t\t},\n\t): Promise<Account | undefined> {\n\t\tconst [owner, repo] = this.splitPath();\n\t\treturn (await Container.github)?.getAccountForEmail(this, accessToken, owner, repo, email, {\n\t\t\t...options,\n\t\t\tbaseUrl: this.apiBaseUrl,\n\t\t});\n\t}\n\n\tprotected async getProviderDefaultBranch({\n\t\taccessToken,\n\t}: AuthenticationSession): Promise<DefaultBranch | undefined> {\n\t\tconst [owner, repo] = this.splitPath();\n\t\treturn (await Container.github)?.getDefaultBranch(this, accessToken, owner, repo, {\n\t\t\tbaseUrl: this.apiBaseUrl,\n\t\t});\n\t}\n\tprotected async getProviderIssueOrPullRequest(\n\t\t{ accessToken }: AuthenticationSession,\n\t\tid: string,\n\t): Promise<IssueOrPullRequest | undefined> {\n\t\tconst [owner, repo] = this.splitPath();\n\t\treturn (await Container.github)?.getIssueOrPullRequest(this, accessToken, owner, repo, Number(id), {\n\t\t\tbaseUrl: this.apiBaseUrl,\n\t\t});\n\t}\n\n\tprotected async getProviderPullRequestForBranch(\n\t\t{ accessToken }: AuthenticationSession,\n\t\tbranch: string,\n\t\toptions?: {\n\t\t\tavatarSize?: number;\n\t\t\tinclude?: PullRequestState[];\n\t\t},\n\t): Promise<PullRequest | undefined> {\n\t\tconst [owner, repo] = this.splitPath();\n\t\tconst { include, ...opts } = options ?? {};\n\n\t\treturn (await Container.github)?.getPullRequestForBranch(this, accessToken, owner, repo, branch, {\n\t\t\t...opts,\n\t\t\tinclude: include?.map(s => GitHubPullRequest.toState(s)),\n\t\t\tbaseUrl: this.apiBaseUrl,\n\t\t});\n\t}\n\n\tprotected async getProviderPullRequestForCommit(\n\t\t{ accessToken }: AuthenticationSession,\n\t\tref: string,\n\t): Promise<PullRequest | undefined> {\n\t\tconst [owner, repo] = this.splitPath();\n\t\treturn (await Container.github)?.getPullRequestForCommit(this, accessToken, owner, repo, ref, {\n\t\t\tbaseUrl: this.apiBaseUrl,\n\t\t});\n\t}\n}\n","'use strict';\nimport { Range, Uri } from 'vscode';\nimport { DynamicAutolinkReference } from '../../annotations/autolinks';\nimport { AutolinkReference } from '../../config';\nimport { GitRevision } from '../models/models';\nimport { Repository } from '../models/repository';\nimport { RemoteProvider } from './provider';\n\nconst fileRegex = /^\\/([^/]+)\\/([^/]+?)\\/-\\/blob(.+)$/i;\nconst rangeRegex = /^L(\\d+)(?:-(\\d+))?$/;\n\nexport class GitLabRemote extends RemoteProvider {\n\tconstructor(domain: string, path: string, protocol?: string, name?: string, custom: boolean = false) {\n\t\tsuper(domain, path, protocol, name, custom);\n\t}\n\n\tprivate _autolinks: (AutolinkReference | DynamicAutolinkReference)[] | undefined;\n\toverride get autolinks(): (AutolinkReference | DynamicAutolinkReference)[] {\n\t\tif (this._autolinks === undefined) {\n\t\t\tthis._autolinks = [\n\t\t\t\t{\n\t\t\t\t\tprefix: '#',\n\t\t\t\t\turl: `${this.baseUrl}/issues/<num>`,\n\t\t\t\t\ttitle: `Open Issue #<num> on ${this.name}`,\n\t\t\t\t},\n\t\t\t];\n\t\t}\n\t\treturn this._autolinks;\n\t}\n\n\toverride get icon() {\n\t\treturn 'gitlab';\n\t}\n\n\tget id() {\n\t\treturn 'gitlab';\n\t}\n\n\tget name() {\n\t\treturn this.formatName('GitLab');\n\t}\n\n\tasync getLocalInfoFromRemoteUri(\n\t\trepository: Repository,\n\t\turi: Uri,\n\t\toptions?: { validate?: boolean },\n\t): Promise<{ uri: Uri; startLine?: number; endLine?: number } | undefined> {\n\t\tif (uri.authority !== this.domain) return undefined;\n\t\tif ((options?.validate ?? true) && !uri.path.startsWith(`/${this.path}/`)) return undefined;\n\n\t\tlet startLine;\n\t\tlet endLine;\n\t\tif (uri.fragment) {\n\t\t\tconst match = rangeRegex.exec(uri.fragment);\n\t\t\tif (match != null) {\n\t\t\t\tconst [, start, end] = match;\n\t\t\t\tif (start) {\n\t\t\t\t\tstartLine = parseInt(start, 10);\n\t\t\t\t\tif (end) {\n\t\t\t\t\t\tendLine = parseInt(end, 10);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst match = fileRegex.exec(uri.path);\n\t\tif (match == null) return undefined;\n\n\t\tconst [, , , path] = match;\n\n\t\t// Check for a permalink\n\t\tlet index = path.indexOf('/', 1);\n\t\tif (index !== -1) {\n\t\t\tconst sha = path.substring(1, index);\n\t\t\tif (GitRevision.isSha(sha)) {\n\t\t\t\tconst uri = repository.toAbsoluteUri(path.substr(index), { validate: options?.validate });\n\t\t\t\tif (uri != null) return { uri: uri, startLine: startLine, endLine: endLine };\n\t\t\t}\n\t\t}\n\n\t\tconst branches = new Set<string>(\n\t\t\t(\n\t\t\t\tawait repository.getBranches({\n\t\t\t\t\tfilter: b => b.remote,\n\t\t\t\t})\n\t\t\t).map(b => b.getNameWithoutRemote()),\n\t\t);\n\n\t\t// Check for a link with branch (and deal with branch names with /)\n\t\tlet branch;\n\t\tindex = path.length;\n\t\tdo {\n\t\t\tindex = path.lastIndexOf('/', index - 1);\n\t\t\tbranch = path.substring(1, index);\n\n\t\t\tif (branches.has(branch)) {\n\t\t\t\tconst uri = repository.toAbsoluteUri(path.substr(index), { validate: options?.validate });\n\t\t\t\tif (uri != null) return { uri: uri, startLine: startLine, endLine: endLine };\n\t\t\t}\n\t\t} while (index > 0);\n\n\t\treturn undefined;\n\t}\n\n\tprotected getUrlForBranches(): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/branches`);\n\t}\n\n\tprotected getUrlForBranch(branch: string): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/tree/${branch}`);\n\t}\n\n\tprotected getUrlForCommit(sha: string): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/commit/${sha}`);\n\t}\n\n\tprotected override getUrlForComparison(base: string, compare: string, notation: '..' | '...'): string {\n\t\treturn this.encodeUrl(`${this.baseUrl}/-/compare/${base}${notation}${compare}`);\n\t}\n\n\tprotected getUrlForFile(fileName: string, branch?: string, sha?: string, range?: Range): string {\n\t\tlet line;\n\t\tif (range != null) {\n\t\t\tif (range.start.line === range.end.line) {\n\t\t\t\tline = `#L${range.start.line}`;\n\t\t\t} else {\n\t\t\t\tline = `#L${range.start.line}-${range.end.line}`;\n\t\t\t}\n\t\t} else {\n\t\t\tline = '';\n\t\t}\n\n\t\tif (sha) return `${this.encodeUrl(`${this.baseUrl}/blob/${sha}/${fileName}`)}${line}`;\n\t\tif (branch) return `${this.encodeUrl(`${this.baseUrl}/blob/${branch}/${fileName}`)}${line}`;\n\t\treturn `${this.encodeUrl(`${this.baseUrl}?path=${fileName}`)}${line}`;\n\t}\n}\n","'use strict';\nimport { CustomRemoteType, RemotesConfig } from '../../configuration';\nimport { Logger } from '../../logger';\nimport { AzureDevOpsRemote } from './azure-devops';\nimport { BitbucketRemote } from './bitbucket';\nimport { BitbucketServerRemote } from './bitbucket-server';\nimport { CustomRemote } from './custom';\nimport { GiteaRemote } from './gitea';\nimport { GitHubRemote } from './github';\nimport { GitLabRemote } from './gitlab';\nimport { RemoteProvider, RichRemoteProvider } from './provider';\n\nexport { RemoteProvider, RichRemoteProvider };\nexport type RemoteProviders = {\n\tcustom: boolean;\n\tmatcher: string | RegExp;\n\tcreator: (domain: string, path: string) => RemoteProvider;\n}[];\n\nconst builtInProviders: RemoteProviders = [\n\t{\n\t\tcustom: false,\n\t\tmatcher: 'bitbucket.org',\n\t\tcreator: (domain: string, path: string) => new BitbucketRemote(domain, path),\n\t},\n\t{\n\t\tcustom: false,\n\t\tmatcher: 'github.com',\n\t\tcreator: (domain: string, path: string) => new GitHubRemote(domain, path),\n\t},\n\t{\n\t\tcustom: false,\n\t\tmatcher: 'gitlab.com',\n\t\tcreator: (domain: string, path: string) => new GitLabRemote(domain, path),\n\t},\n\t{\n\t\tcustom: false,\n\t\tmatcher: /\\bdev\\.azure\\.com$/i,\n\t\tcreator: (domain: string, path: string) => new AzureDevOpsRemote(domain, path),\n\t},\n\t{\n\t\tcustom: true,\n\t\tmatcher: /^(.+\\/(?:bitbucket|stash))\\/scm\\/(.+)$/i,\n\t\tcreator: (domain: string, path: string) => new BitbucketServerRemote(domain, path),\n\t},\n\t{\n\t\tcustom: false,\n\t\tmatcher: /\\bgitlab\\b/i,\n\t\tcreator: (domain: string, path: string) => new GitLabRemote(domain, path),\n\t},\n\t{\n\t\tcustom: false,\n\t\tmatcher: /\\bvisualstudio\\.com$/i,\n\t\tcreator: (domain: string, path: string) => new AzureDevOpsRemote(domain, path, undefined, undefined, true),\n\t},\n\t{\n\t\tcustom: false,\n\t\tmatcher: /\\bgitea\\b/i,\n\t\tcreator: (domain: string, path: string) => new GiteaRemote(domain, path),\n\t},\n];\n\nexport class RemoteProviderFactory {\n\tstatic factory(\n\t\tproviders: RemoteProviders,\n\t): (url: string, domain: string, path: string) => RemoteProvider | undefined {\n\t\treturn (url: string, domain: string, path: string) => this.create(providers, url, domain, path);\n\t}\n\n\tstatic create(providers: RemoteProviders, url: string, domain: string, path: string): RemoteProvider | undefined {\n\t\ttry {\n\t\t\tconst key = domain.toLowerCase();\n\t\t\tfor (const { custom, matcher, creator } of providers) {\n\t\t\t\tif (typeof matcher === 'string') {\n\t\t\t\t\tif (matcher === key) return creator(domain, path);\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (matcher.test(key)) return creator(domain, path);\n\t\t\t\tif (!custom) continue;\n\n\t\t\t\tconst match = matcher.exec(url);\n\t\t\t\tif (match != null) {\n\t\t\t\t\treturn creator(match[1], match[2]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'RemoteProviderFactory');\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tstatic loadProviders(cfg: RemotesConfig[] | null | undefined): RemoteProviders {\n\t\tconst providers: RemoteProviders = [];\n\n\t\tif (cfg != null && cfg.length > 0) {\n\t\t\tfor (const rc of cfg) {\n\t\t\t\tconst provider = this.getCustomProvider(rc);\n\t\t\t\tif (provider == null) continue;\n\n\t\t\t\tlet matcher: string | RegExp | undefined;\n\t\t\t\ttry {\n\t\t\t\t\tmatcher = rc.regex ? new RegExp(rc.regex, 'i') : rc.domain?.toLowerCase();\n\t\t\t\t\tif (matcher == null) throw new Error('No matcher found');\n\t\t\t\t} catch (ex) {\n\t\t\t\t\tLogger.error(ex, `Loading remote provider '${rc.name ?? ''}' failed`);\n\t\t\t\t}\n\n\t\t\t\tproviders.push({\n\t\t\t\t\tcustom: true,\n\t\t\t\t\tmatcher: matcher!,\n\t\t\t\t\tcreator: provider,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tproviders.push(...builtInProviders);\n\n\t\treturn providers;\n\t}\n\n\tprivate static getCustomProvider(cfg: RemotesConfig) {\n\t\tswitch (cfg.type) {\n\t\t\tcase CustomRemoteType.Bitbucket:\n\t\t\t\treturn (domain: string, path: string) =>\n\t\t\t\t\tnew BitbucketRemote(domain, path, cfg.protocol, cfg.name, true);\n\t\t\tcase CustomRemoteType.BitbucketServer:\n\t\t\t\treturn (domain: string, path: string) =>\n\t\t\t\t\tnew BitbucketServerRemote(domain, path, cfg.protocol, cfg.name, true);\n\t\t\tcase CustomRemoteType.Custom:\n\t\t\t\treturn (domain: string, path: string) =>\n\t\t\t\t\tnew CustomRemote(domain, path, cfg.urls!, cfg.protocol, cfg.name);\n\t\t\tcase CustomRemoteType.Gitea:\n\t\t\t\treturn (domain: string, path: string) => new GiteaRemote(domain, path, cfg.protocol, cfg.name, true);\n\t\t\tcase CustomRemoteType.GitHub:\n\t\t\t\treturn (domain: string, path: string) => new GitHubRemote(domain, path, cfg.protocol, cfg.name, true);\n\t\t\tcase CustomRemoteType.GitLab:\n\t\t\t\treturn (domain: string, path: string) => new GitLabRemote(domain, path, cfg.protocol, cfg.name, true);\n\t\t\tdefault:\n\t\t\t\treturn undefined;\n\t\t}\n\t}\n}\n","'use strict';\nimport {\n\tauthentication,\n\tAuthenticationSession,\n\tAuthenticationSessionsChangeEvent,\n\tenv,\n\tEvent,\n\tEventEmitter,\n\tRange,\n\tUri,\n} from 'vscode';\nimport { DynamicAutolinkReference } from '../../annotations/autolinks';\nimport { AutolinkReference } from '../../config';\nimport { WorkspaceState } from '../../constants';\nimport { Container } from '../../container';\nimport { Logger } from '../../logger';\nimport { debug, gate, log, Promises } from '../../system';\nimport {\n\tAccount,\n\tDefaultBranch,\n\tGitLogCommit,\n\tIssueOrPullRequest,\n\tPullRequest,\n\tPullRequestState,\n\tRemoteProviderReference,\n\tRepository,\n} from '../models/models';\n\nexport enum RemoteResourceType {\n\tBranch = 'branch',\n\tBranches = 'branches',\n\tCommit = 'commit',\n\tComparison = 'comparison',\n\tCreatePullRequest = 'createPullRequest',\n\tFile = 'file',\n\tRepo = 'repo',\n\tRevision = 'revision',\n}\n\nexport type RemoteResource =\n\t| {\n\t\t\ttype: RemoteResourceType.Branch;\n\t\t\tbranch: string;\n\t  }\n\t| {\n\t\t\ttype: RemoteResourceType.Branches;\n\t  }\n\t| {\n\t\t\ttype: RemoteResourceType.Commit;\n\t\t\tsha: string;\n\t  }\n\t| {\n\t\t\ttype: RemoteResourceType.Comparison;\n\t\t\tbase: string;\n\t\t\tcompare: string;\n\t\t\tnotation?: '..' | '...';\n\t  }\n\t| {\n\t\t\ttype: RemoteResourceType.CreatePullRequest;\n\t\t\tbase: {\n\t\t\t\tbranch?: string;\n\t\t\t\tremote: { path: string; url: string };\n\t\t\t};\n\t\t\tcompare: {\n\t\t\t\tbranch: string;\n\t\t\t\tremote: { path: string; url: string };\n\t\t\t};\n\t  }\n\t| {\n\t\t\ttype: RemoteResourceType.File;\n\t\t\tbranchOrTag?: string;\n\t\t\tfileName: string;\n\t\t\trange?: Range;\n\t  }\n\t| {\n\t\t\ttype: RemoteResourceType.Repo;\n\t  }\n\t| {\n\t\t\ttype: RemoteResourceType.Revision;\n\t\t\tbranchOrTag?: string;\n\t\t\tcommit?: GitLogCommit;\n\t\t\tfileName: string;\n\t\t\trange?: Range;\n\t\t\tsha?: string;\n\t  };\n\nexport function getNameFromRemoteResource(resource: RemoteResource) {\n\tswitch (resource.type) {\n\t\tcase RemoteResourceType.Branch:\n\t\t\treturn 'Branch';\n\t\tcase RemoteResourceType.Branches:\n\t\t\treturn 'Branches';\n\t\tcase RemoteResourceType.Commit:\n\t\t\treturn 'Commit';\n\t\tcase RemoteResourceType.Comparison:\n\t\t\treturn 'Comparison';\n\t\tcase RemoteResourceType.CreatePullRequest:\n\t\t\treturn 'Create Pull Request';\n\t\tcase RemoteResourceType.File:\n\t\t\treturn 'File';\n\t\tcase RemoteResourceType.Repo:\n\t\t\treturn 'Repository';\n\t\tcase RemoteResourceType.Revision:\n\t\t\treturn 'File';\n\t\tdefault:\n\t\t\treturn '';\n\t}\n}\n\nexport abstract class RemoteProvider implements RemoteProviderReference {\n\treadonly type: 'simple' | 'rich' = 'simple';\n\tprotected readonly _name: string | undefined;\n\n\tconstructor(\n\t\tpublic readonly domain: string,\n\t\tpublic readonly path: string,\n\t\tpublic readonly protocol: string = 'https',\n\t\tname?: string,\n\t\tpublic readonly custom: boolean = false,\n\t) {\n\t\tthis._name = name;\n\t}\n\n\tget autolinks(): (AutolinkReference | DynamicAutolinkReference)[] {\n\t\treturn [];\n\t}\n\n\tget displayPath(): string {\n\t\treturn this.path;\n\t}\n\n\tget icon(): string {\n\t\treturn 'remote';\n\t}\n\n\tabstract get id(): string;\n\tabstract get name(): string;\n\n\tasync copy(resource: RemoteResource): Promise<void> {\n\t\tconst url = this.url(resource);\n\t\tif (url == null) return;\n\n\t\tvoid (await env.clipboard.writeText(url));\n\t}\n\n\thasApi(): this is RichRemoteProvider {\n\t\treturn RichRemoteProvider.is(this);\n\t}\n\n\tabstract getLocalInfoFromRemoteUri(\n\t\trepository: Repository,\n\t\turi: Uri,\n\t\toptions?: { validate?: boolean },\n\t): Promise<{ uri: Uri; startLine?: number; endLine?: number } | undefined>;\n\n\topen(resource: RemoteResource): Promise<boolean | undefined> {\n\t\treturn this.openUrl(this.url(resource));\n\t}\n\n\turl(resource: RemoteResource): string | undefined {\n\t\tswitch (resource.type) {\n\t\t\tcase RemoteResourceType.Branch:\n\t\t\t\treturn this.getUrlForBranch(resource.branch);\n\t\t\tcase RemoteResourceType.Branches:\n\t\t\t\treturn this.getUrlForBranches();\n\t\t\tcase RemoteResourceType.Commit:\n\t\t\t\treturn this.getUrlForCommit(resource.sha);\n\t\t\tcase RemoteResourceType.Comparison: {\n\t\t\t\treturn this.getUrlForComparison?.(resource.base, resource.compare, resource.notation ?? '...');\n\t\t\t}\n\t\t\tcase RemoteResourceType.CreatePullRequest: {\n\t\t\t\treturn this.getUrlForCreatePullRequest?.(resource.base, resource.compare);\n\t\t\t}\n\t\t\tcase RemoteResourceType.File:\n\t\t\t\treturn this.getUrlForFile(\n\t\t\t\t\tresource.fileName,\n\t\t\t\t\tresource.branchOrTag != null ? resource.branchOrTag : undefined,\n\t\t\t\t\tundefined,\n\t\t\t\t\tresource.range,\n\t\t\t\t);\n\t\t\tcase RemoteResourceType.Repo:\n\t\t\t\treturn this.getUrlForRepository();\n\t\t\tcase RemoteResourceType.Revision:\n\t\t\t\treturn this.getUrlForFile(\n\t\t\t\t\tresource.fileName,\n\t\t\t\t\tresource.branchOrTag != null ? resource.branchOrTag : undefined,\n\t\t\t\t\tresource.sha != null ? resource.sha : undefined,\n\t\t\t\t\tresource.range,\n\t\t\t\t);\n\t\t\tdefault:\n\t\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprotected get baseUrl(): string {\n\t\treturn `${this.protocol}://${this.domain}/${this.path}`;\n\t}\n\n\tprotected formatName(name: string) {\n\t\tif (this._name != null) return this._name;\n\t\treturn `${name}${this.custom ? ` (${this.domain})` : ''}`;\n\t}\n\n\tprotected splitPath(): [string, string] {\n\t\tconst index = this.path.indexOf('/');\n\t\treturn [this.path.substring(0, index), this.path.substring(index + 1)];\n\t}\n\n\tprotected abstract getUrlForBranch(branch: string): string;\n\n\tprotected abstract getUrlForBranches(): string;\n\n\tprotected abstract getUrlForCommit(sha: string): string;\n\n\tprotected getUrlForComparison?(base: string, compare: string, notation: '..' | '...'): string | undefined;\n\n\tprotected getUrlForCreatePullRequest?(\n\t\tbase: { branch?: string; remote: { path: string; url: string } },\n\t\tcompare: { branch: string; remote: { path: string; url: string } },\n\t): string | undefined;\n\n\tprotected abstract getUrlForFile(fileName: string, branch?: string, sha?: string, range?: Range): string;\n\n\tprotected getUrlForRepository(): string {\n\t\treturn this.baseUrl;\n\t}\n\n\tprivate async openUrl(url?: string): Promise<boolean | undefined> {\n\t\tif (url == null) return undefined;\n\n\t\treturn env.openExternal(Uri.parse(url));\n\t}\n\n\tprotected encodeUrl(url: string): string;\n\tprotected encodeUrl(url: string | undefined): string | undefined;\n\tprotected encodeUrl(url: string | undefined): string | undefined {\n\t\treturn url != null ? encodeURI(url).replace(/#/g, '%23') : undefined;\n\t}\n}\n\nconst _onDidChangeAuthentication = new EventEmitter<{ reason: 'connected' | 'disconnected'; key: string }>();\n\nexport class Authentication {\n\tstatic get onDidChange(): Event<{ reason: 'connected' | 'disconnected'; key: string }> {\n\t\treturn _onDidChangeAuthentication.event;\n\t}\n}\n\nexport class AuthenticationError extends Error {\n\tconstructor(private original: Error) {\n\t\tsuper(original.message);\n\n\t\tError.captureStackTrace(this, AuthenticationError);\n\t}\n}\n\nexport class ClientError extends Error {\n\tconstructor(private original: Error) {\n\t\tsuper(original.message);\n\n\t\tError.captureStackTrace(this, ClientError);\n\t}\n}\n\n// TODO@eamodio revisit how once authenticated, all remotes are always connected, even after a restart\n\nexport abstract class RichRemoteProvider extends RemoteProvider {\n\toverride readonly type: 'simple' | 'rich' = 'rich';\n\n\tstatic is(provider: RemoteProvider | undefined): provider is RichRemoteProvider {\n\t\treturn provider?.type === 'rich';\n\t}\n\n\tprivate readonly _onDidChange = new EventEmitter<void>();\n\tget onDidChange(): Event<void> {\n\t\treturn this._onDidChange.event;\n\t}\n\n\tprivate invalidClientExceptionCount = 0;\n\n\tconstructor(domain: string, path: string, protocol?: string, name?: string, custom?: boolean) {\n\t\tsuper(domain, path, protocol, name, custom);\n\n\t\tContainer.context.subscriptions.push(\n\t\t\t// TODO@eamodio revisit how connections are linked or not\n\t\t\tAuthentication.onDidChange(e => {\n\t\t\t\tif (e.key !== this.key) return;\n\n\t\t\t\tif (e.reason === 'disconnected') {\n\t\t\t\t\tthis.disconnect(true);\n\t\t\t\t} else if (e.reason === 'connected') {\n\t\t\t\t\tvoid this.ensureSession(false);\n\t\t\t\t}\n\t\t\t}),\n\t\t\tauthentication.onDidChangeSessions(this.onAuthenticationSessionsChanged, this),\n\t\t);\n\t}\n\n\tabstract get apiBaseUrl(): string;\n\tprotected abstract get authProvider(): { id: string; scopes: string[] };\n\n\tprivate get key() {\n\t\treturn this.custom ? `${this.name}:${this.domain}` : this.name;\n\t}\n\n\tprivate get connectedKey() {\n\t\treturn `${WorkspaceState.ConnectedPrefix}${this.key}`;\n\t}\n\n\tget maybeConnected(): boolean | undefined {\n\t\tif (this._session === undefined) return undefined;\n\n\t\treturn this._session !== null;\n\t}\n\n\tprotected _session: AuthenticationSession | null | undefined;\n\tprotected session() {\n\t\tif (this._session === undefined) {\n\t\t\treturn this.ensureSession(false);\n\t\t}\n\t\treturn this._session ?? undefined;\n\t}\n\n\tprivate onAuthenticationSessionsChanged(e: AuthenticationSessionsChangeEvent) {\n\t\tif (e.provider.id === this.authProvider.id) {\n\t\t\tvoid this.ensureSession(false);\n\t\t}\n\t}\n\n\t@log()\n\tasync connect(): Promise<boolean> {\n\t\ttry {\n\t\t\tconst session = await this.ensureSession(true);\n\t\t\treturn Boolean(session);\n\t\t} catch (ex) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t@log()\n\tdisconnect(silent: boolean = false): void {\n\t\tconst disconnected = this._session != null;\n\n\t\tthis.invalidClientExceptionCount = 0;\n\t\tthis._prsByCommit.clear();\n\t\tthis._session = null;\n\n\t\tif (disconnected) {\n\t\t\tvoid Container.context.workspaceState.update(this.connectedKey, false);\n\n\t\t\tthis._onDidChange.fire();\n\t\t\tif (!silent) {\n\t\t\t\t_onDidChangeAuthentication.fire({ reason: 'disconnected', key: this.key });\n\t\t\t}\n\t\t}\n\t}\n\n\t@gate()\n\t@debug<RichRemoteProvider['isConnected']>({\n\t\texit: connected => `returned ${connected}`,\n\t})\n\tasync isConnected(): Promise<boolean> {\n\t\treturn (await this.session()) != null;\n\t}\n\n\t@gate()\n\t@debug()\n\tasync getAccountForCommit(\n\t\tref: string,\n\t\toptions?: {\n\t\t\tavatarSize?: number;\n\t\t},\n\t): Promise<Account | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tconst connected = this.maybeConnected ?? (await this.isConnected());\n\t\tif (!connected) return undefined;\n\n\t\ttry {\n\t\t\tconst author = await this.getProviderAccountForCommit(this._session!, ref, options);\n\t\t\tthis.invalidClientExceptionCount = 0;\n\t\t\treturn author;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\n\t\t\tif (ex instanceof ClientError || ex instanceof AuthenticationError) {\n\t\t\t\tthis.handleClientException();\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprotected abstract getProviderAccountForCommit(\n\t\tsession: AuthenticationSession,\n\t\tref: string,\n\t\toptions?: {\n\t\t\tavatarSize?: number;\n\t\t},\n\t): Promise<Account | undefined>;\n\n\t@gate()\n\t@debug()\n\tasync getAccountForEmail(\n\t\temail: string,\n\t\toptions?: {\n\t\t\tavatarSize?: number;\n\t\t},\n\t): Promise<Account | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tconst connected = this.maybeConnected ?? (await this.isConnected());\n\t\tif (!connected) return undefined;\n\n\t\ttry {\n\t\t\tconst author = await this.getProviderAccountForEmail(this._session!, email, options);\n\t\t\tthis.invalidClientExceptionCount = 0;\n\t\t\treturn author;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\n\t\t\tif (ex instanceof ClientError || ex instanceof AuthenticationError) {\n\t\t\t\tthis.handleClientException();\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprotected abstract getProviderAccountForEmail(\n\t\tsession: AuthenticationSession,\n\t\temail: string,\n\t\toptions?: {\n\t\t\tavatarSize?: number;\n\t\t},\n\t): Promise<Account | undefined>;\n\n\t@gate()\n\t@debug()\n\tasync getDefaultBranch(): Promise<DefaultBranch | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tconst connected = this.maybeConnected ?? (await this.isConnected());\n\t\tif (!connected) return undefined;\n\n\t\ttry {\n\t\t\tconst defaultBranch = await this.getProviderDefaultBranch(this._session!);\n\t\t\tthis.invalidClientExceptionCount = 0;\n\t\t\treturn defaultBranch;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\n\t\t\tif (ex instanceof ClientError || ex instanceof AuthenticationError) {\n\t\t\t\tthis.handleClientException();\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprotected abstract getProviderDefaultBranch({\n\t\taccessToken,\n\t}: AuthenticationSession): Promise<DefaultBranch | undefined>;\n\n\t@gate()\n\t@debug()\n\tasync getIssueOrPullRequest(id: string): Promise<IssueOrPullRequest | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tconst connected = this.maybeConnected ?? (await this.isConnected());\n\t\tif (!connected) return undefined;\n\n\t\ttry {\n\t\t\tconst issueOrPullRequest = await this.getProviderIssueOrPullRequest(this._session!, id);\n\t\t\tthis.invalidClientExceptionCount = 0;\n\t\t\treturn issueOrPullRequest;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\n\t\t\tif (ex instanceof ClientError || ex instanceof AuthenticationError) {\n\t\t\t\tthis.handleClientException();\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprotected abstract getProviderIssueOrPullRequest(\n\t\tsession: AuthenticationSession,\n\t\tid: string,\n\t): Promise<IssueOrPullRequest | undefined>;\n\n\t@gate()\n\t@debug()\n\tasync getPullRequestForBranch(\n\t\tbranch: string,\n\t\toptions?: {\n\t\t\tavatarSize?: number;\n\t\t\tinclude?: PullRequestState[];\n\t\t},\n\t): Promise<PullRequest | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tconst connected = this.maybeConnected ?? (await this.isConnected());\n\t\tif (!connected) return undefined;\n\n\t\ttry {\n\t\t\tconst pr = await this.getProviderPullRequestForBranch(this._session!, branch, options);\n\t\t\tthis.invalidClientExceptionCount = 0;\n\t\t\treturn pr;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\n\t\t\tif (ex instanceof ClientError || ex instanceof AuthenticationError) {\n\t\t\t\tthis.handleClientException();\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\t}\n\tprotected abstract getProviderPullRequestForBranch(\n\t\tsession: AuthenticationSession,\n\t\tbranch: string,\n\t\toptions?: {\n\t\t\tavatarSize?: number;\n\t\t\tinclude?: PullRequestState[];\n\t\t},\n\t): Promise<PullRequest | undefined>;\n\n\tprivate _prsByCommit = new Map<string, Promise<PullRequest | null> | PullRequest | null>();\n\n\t@gate()\n\t@debug()\n\tgetPullRequestForCommit(ref: string): Promise<PullRequest | undefined> | PullRequest | undefined {\n\t\tlet pr = this._prsByCommit.get(ref);\n\t\tif (pr === undefined) {\n\t\t\tpr = this.getPullRequestForCommitCore(ref);\n\t\t\tthis._prsByCommit.set(ref, pr);\n\t\t}\n\t\tif (pr == null || !Promises.is(pr)) return pr ?? undefined;\n\n\t\treturn pr.then(pr => pr ?? undefined);\n\t}\n\n\t@debug()\n\tprivate async getPullRequestForCommitCore(ref: string) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tconst connected = this.maybeConnected ?? (await this.isConnected());\n\t\tif (!connected) return null;\n\n\t\ttry {\n\t\t\tconst pr = (await this.getProviderPullRequestForCommit(this._session!, ref)) ?? null;\n\t\t\tthis._prsByCommit.set(ref, pr);\n\t\t\tthis.invalidClientExceptionCount = 0;\n\t\t\treturn pr;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\n\t\t\tthis._prsByCommit.delete(ref);\n\n\t\t\tif (ex instanceof ClientError || ex instanceof AuthenticationError) {\n\t\t\t\tthis.handleClientException();\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tprotected abstract getProviderPullRequestForCommit(\n\t\tsession: AuthenticationSession,\n\t\tref: string,\n\t): Promise<PullRequest | undefined>;\n\n\t@gate()\n\tprivate async ensureSession(createIfNeeded: boolean): Promise<AuthenticationSession | undefined> {\n\t\tif (this._session != null) return this._session;\n\n\t\tif (!Container.config.integrations.enabled) return undefined;\n\n\t\tif (createIfNeeded) {\n\t\t\tawait Container.context.workspaceState.update(this.connectedKey, undefined);\n\t\t} else if (Container.context.workspaceState.get<boolean>(this.connectedKey) === false) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tlet session;\n\t\ttry {\n\t\t\tsession = await authentication.getSession(this.authProvider.id, this.authProvider.scopes, {\n\t\t\t\tcreateIfNone: createIfNeeded,\n\t\t\t});\n\t\t} catch (ex) {\n\t\t\tawait Container.context.workspaceState.update(this.connectedKey, undefined);\n\n\t\t\tif (ex instanceof Error && ex.message.includes('User did not consent')) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tsession = null;\n\t\t}\n\n\t\tif (session === undefined && !createIfNeeded) {\n\t\t\tawait Container.context.workspaceState.update(this.connectedKey, undefined);\n\t\t}\n\n\t\tthis._session = session ?? null;\n\t\tthis.invalidClientExceptionCount = 0;\n\n\t\tif (session != null) {\n\t\t\tawait Container.context.workspaceState.update(this.connectedKey, true);\n\n\t\t\tthis._onDidChange.fire();\n\t\t\t_onDidChangeAuthentication.fire({ reason: 'connected', key: this.key });\n\t\t}\n\n\t\treturn session ?? undefined;\n\t}\n\n\t@debug()\n\tprivate handleClientException() {\n\t\tthis.invalidClientExceptionCount++;\n\n\t\tif (this.invalidClientExceptionCount >= 5) {\n\t\t\tthis.disconnect();\n\t\t}\n\t}\n}\n","'use strict';\nimport { GitRevision } from './git';\nimport { GitRevisionReference } from './models/models';\n\nexport type SearchOperators =\n\t| ''\n\t| '=:'\n\t| 'message:'\n\t| '@:'\n\t| 'author:'\n\t| '#:'\n\t| 'commit:'\n\t| '?:'\n\t| 'file:'\n\t| '~:'\n\t| 'change:';\n\nexport const searchOperators = new Set<string>([\n\t'',\n\t'=:',\n\t'message:',\n\t'@:',\n\t'author:',\n\t'#:',\n\t'commit:',\n\t'?:',\n\t'file:',\n\t'~:',\n\t'change:',\n]);\n\nexport interface SearchPattern {\n\tpattern: string;\n\tmatchAll?: boolean;\n\tmatchCase?: boolean;\n\tmatchRegex?: boolean;\n}\n\nexport namespace SearchPattern {\n\tconst emptyStr = '';\n\n\tconst searchMessageOperationRegex = /(?=(.*?)\\s?(?:(?:=:|message:|@:|author:|#:|commit:|\\?:|file:|~:|change:)|$))/;\n\tconst searchMessageValuesRegex = /(\".+\"|[^\\b\\s]+)/g;\n\tconst searchOperationRegex =\n\t\t/((?:=|message|@|author|#|commit|\\?|file|~|change):)\\s?(?=(.*?)\\s?(?:(?:=:|message:|@:|author:|#:|commit:|\\?:|file:|~:|change:)|$))/g;\n\n\texport function fromCommit(ref: string): string;\n\texport function fromCommit(commit: GitRevisionReference): string;\n\texport function fromCommit(refOrCommit: string | GitRevisionReference) {\n\t\treturn `#:${typeof refOrCommit === 'string' ? GitRevision.shorten(refOrCommit) : refOrCommit.name}`;\n\t}\n\n\texport function fromCommits(refs: string[]): string;\n\texport function fromCommits(commits: GitRevisionReference[]): string;\n\texport function fromCommits(refsOrCommits: (string | GitRevisionReference)[]) {\n\t\treturn refsOrCommits.map(r => `#:${typeof r === 'string' ? GitRevision.shorten(r) : r.name}`).join(' ');\n\t}\n\n\texport function parseSearchOperations(search: string): Map<string, string[]> {\n\t\tconst operations = new Map<string, string[]>();\n\n\t\tlet op;\n\t\tlet value;\n\n\t\tlet match = searchMessageOperationRegex.exec(search);\n\t\tif (match != null && match[1] !== '') {\n\t\t\t[, value] = match;\n\n\t\t\tif (GitRevision.isSha(value)) {\n\t\t\t\tlet values = operations.get('commit:');\n\t\t\t\tif (values === undefined) {\n\t\t\t\t\tvalues = [value];\n\t\t\t\t\toperations.set('commit:', values);\n\t\t\t\t} else {\n\t\t\t\t\tvalues.push(value);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tparseSearchMessageOperations(value, operations);\n\t\t\t}\n\t\t}\n\n\t\tdo {\n\t\t\tmatch = searchOperationRegex.exec(search);\n\t\t\tif (match == null) break;\n\n\t\t\t[, op, value] = match;\n\n\t\t\tif (op !== undefined) {\n\t\t\t\top = normalizeSearchOperatorsMap.get(op as SearchOperators)!;\n\n\t\t\t\tif (op === 'message:') {\n\t\t\t\t\tparseSearchMessageOperations(value, operations);\n\t\t\t\t} else {\n\t\t\t\t\tlet values = operations.get(op);\n\t\t\t\t\tif (values === undefined) {\n\t\t\t\t\t\tvalues = [value];\n\t\t\t\t\t\toperations.set(op, values);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalues.push(value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} while (true);\n\n\t\treturn operations;\n\t}\n\n\tfunction parseSearchMessageOperations(message: string, operations: Map<string, string[]>) {\n\t\tlet values = operations.get('message:');\n\n\t\tif (message === emptyStr) {\n\t\t\tif (values === undefined) {\n\t\t\t\tvalues = [''];\n\t\t\t\toperations.set('message:', values);\n\t\t\t} else {\n\t\t\t\tvalues.push('');\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tlet match;\n\t\tlet value;\n\t\tdo {\n\t\t\tmatch = searchMessageValuesRegex.exec(message);\n\t\t\tif (match == null) break;\n\n\t\t\t[, value] = match;\n\n\t\t\tif (values === undefined) {\n\t\t\t\tvalues = [value];\n\t\t\t\toperations.set('message:', values);\n\t\t\t} else {\n\t\t\t\tvalues.push(value);\n\t\t\t}\n\t\t} while (true);\n\t}\n\n\texport function toKey(search: SearchPattern) {\n\t\treturn `${search.pattern}|${search.matchAll ? 'A' : ''}${search.matchCase ? 'C' : ''}${\n\t\t\tsearch.matchRegex ? 'R' : ''\n\t\t}`;\n\t}\n}\nexport const normalizeSearchOperatorsMap = new Map<SearchOperators, SearchOperators>([\n\t['', 'message:'],\n\t['=:', 'message:'],\n\t['message:', 'message:'],\n\t['@:', 'author:'],\n\t['author:', 'author:'],\n\t['#:', 'commit:'],\n\t['commit:', 'commit:'],\n\t['?:', 'file:'],\n\t['file:', 'file:'],\n\t['~:', 'change:'],\n\t['change:', 'change:'],\n]);\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"child_process\");","'use strict';\nimport { ExecException, execFile } from 'child_process';\nimport * as fs from 'fs';\nimport * as paths from 'path';\nimport * as iconv from 'iconv-lite';\nimport { Logger } from '../logger';\n\nexport const isWindows = process.platform === 'win32';\n\nconst slashesRegex = /[\\\\/]/;\nconst ps1Regex = /\\.ps1$/i;\nconst batOrCmdRegex = /\\.(bat|cmd)$/i;\nconst jsRegex = /\\.(js)$/i;\n\n/**\n * Search PATH to see if a file exists in any of the path folders.\n *\n * @param  {string} exe The file to search for\n * @return {string}     A fully qualified path, or the original path if nothing\n *                      is found\n *\n * @private\n */\nfunction runDownPath(exe: string): string {\n\t// NB: Windows won't search PATH looking for executables in spawn like\n\t// Posix does\n\n\t// Files with any directory path don't get this applied\n\tif (slashesRegex.test(exe)) return exe;\n\n\tconst target = paths.join('.', exe);\n\ttry {\n\t\tconst stats = fs.statSync(target);\n\t\tif (stats?.isFile() && isExecutable(stats)) return target;\n\t} catch {}\n\n\tconst path = process.env.PATH;\n\tif (path != null && path.length !== 0) {\n\t\tconst haystack = path.split(isWindows ? ';' : ':');\n\t\tlet stats;\n\t\tfor (const p of haystack) {\n\t\t\tconst needle = paths.join(p, exe);\n\t\t\ttry {\n\t\t\t\tstats = fs.statSync(needle);\n\t\t\t\tif (stats?.isFile() && isExecutable(stats)) return needle;\n\t\t\t} catch {}\n\t\t}\n\t}\n\n\treturn exe;\n}\n\nfunction isExecutable(stats: fs.Stats) {\n\tif (isWindows) return true;\n\n\tconst isGroup = stats.gid ? process.getgid != null && stats.gid === process.getgid() : true;\n\tconst isUser = stats.uid ? process.getuid != null && stats.uid === process.getuid() : true;\n\n\treturn Boolean(stats.mode & 0o0001 || (stats.mode & 0o0010 && isGroup) || (stats.mode & 0o0100 && isUser));\n}\n\n/**\n * Finds the executable and parameters to run on Windows. This method\n * mimics the POSIX behavior of being able to run scripts as executables by\n * replacing the passed-in executable with the script runner, for PowerShell,\n * CMD, and node scripts.\n *\n * This method also does the work of running down PATH, which spawn on Windows\n * also doesn't do, unlike on POSIX.\n */\nexport function findExecutable(exe: string, args: string[]): { cmd: string; args: string[] } {\n\t// POSIX can just execute scripts directly, no need for silly goosery\n\tif (!isWindows) return { cmd: runDownPath(exe), args: args };\n\n\tif (!fs.existsSync(exe)) {\n\t\t// NB: When you write something like `surf-client ... -- surf-build` on Windows,\n\t\t// a shell would normally convert that to surf-build.cmd, but since it's passed\n\t\t// in as an argument, it doesn't happen\n\t\tconst possibleExts = ['.exe', '.bat', '.cmd', '.ps1'];\n\t\tfor (const ext of possibleExts) {\n\t\t\tconst possibleFullPath = runDownPath(`${exe}${ext}`);\n\n\t\t\tif (fs.existsSync(possibleFullPath)) return findExecutable(possibleFullPath, args);\n\t\t}\n\t}\n\n\tif (ps1Regex.test(exe)) {\n\t\tconst cmd = paths.join(\n\t\t\tprocess.env.SYSTEMROOT ?? 'C:\\\\WINDOWS',\n\t\t\t'System32',\n\t\t\t'WindowsPowerShell',\n\t\t\t'v1.0',\n\t\t\t'PowerShell.exe',\n\t\t);\n\t\tconst psargs = ['-ExecutionPolicy', 'Unrestricted', '-NoLogo', '-NonInteractive', '-File', exe];\n\n\t\treturn { cmd: cmd, args: psargs.concat(args) };\n\t}\n\n\tif (batOrCmdRegex.test(exe)) {\n\t\tconst cmd = paths.join(process.env.SYSTEMROOT ?? 'C:\\\\WINDOWS', 'System32', 'cmd.exe');\n\t\tconst cmdArgs = ['/C', exe, ...args];\n\n\t\treturn { cmd: cmd, args: cmdArgs };\n\t}\n\n\tif (jsRegex.test(exe)) {\n\t\tconst cmd = process.execPath;\n\t\tconst nodeArgs = [exe];\n\n\t\treturn { cmd: cmd, args: nodeArgs.concat(args) };\n\t}\n\n\treturn { cmd: exe, args: args };\n}\n\nexport interface RunOptions<TEncoding = BufferEncoding | 'buffer'> {\n\tcwd?: string;\n\treadonly env?: Record<string, any>;\n\treadonly encoding?: TEncoding;\n\t/**\n\t * The size the output buffer to allocate to the spawned process. Set this\n\t * if you are anticipating a large amount of output.\n\t *\n\t * If not specified, this will be 10MB (10485760 bytes) which should be\n\t * enough for most Git operations.\n\t */\n\treadonly maxBuffer?: number;\n\t/**\n\t * An optional string or buffer which will be written to\n\t * the child process stdin stream immediately immediately\n\t * after spawning the process.\n\t */\n\treadonly stdin?: string | Buffer;\n\t/**\n\t * The encoding to use when writing to stdin, if the stdin\n\t * parameter is a string.\n\t */\n\treadonly stdinEncoding?: string;\n}\n\nconst bufferExceededRegex = /stdout maxBuffer( length)? exceeded/;\n\nexport class RunError extends Error {\n\tconstructor(\n\t\tprivate readonly original: ExecException,\n\t\tpublic readonly stdout: string,\n\t\tpublic readonly stderr: string,\n\t) {\n\t\tsuper(original.message);\n\n\t\tstdout = stdout.trim();\n\t\tstderr = stderr.trim();\n\t\tError.captureStackTrace(this, RunError);\n\t}\n\n\tget cmd(): string | undefined {\n\t\treturn this.original.cmd;\n\t}\n\n\tget killed(): boolean | undefined {\n\t\treturn this.original.killed;\n\t}\n\n\tget code(): number | undefined {\n\t\treturn this.original.code;\n\t}\n\n\tget signal(): NodeJS.Signals | undefined {\n\t\treturn this.original.signal;\n\t}\n}\n\nexport function run<TOut extends string | Buffer>(\n\tcommand: string,\n\targs: any[],\n\tencoding: BufferEncoding | 'buffer' | string,\n\toptions: RunOptions = {},\n): Promise<TOut> {\n\tconst { stdin, stdinEncoding, ...opts }: RunOptions = { maxBuffer: 100 * 1024 * 1024, ...options };\n\n\treturn new Promise<TOut>((resolve, reject) => {\n\t\tconst proc = execFile(command, args, opts, (error: ExecException | null, stdout, stderr) => {\n\t\t\tif (error != null) {\n\t\t\t\tif (bufferExceededRegex.test(error.message)) {\n\t\t\t\t\terror.message = `Command output exceeded the allocated stdout buffer. Set 'options.maxBuffer' to a larger value than ${opts.maxBuffer} bytes`;\n\t\t\t\t}\n\n\t\t\t\treject(\n\t\t\t\t\tnew RunError(\n\t\t\t\t\t\terror,\n\t\t\t\t\t\tencoding === 'utf8' || encoding === 'binary' || encoding === 'buffer'\n\t\t\t\t\t\t\t? stdout\n\t\t\t\t\t\t\t: iconv.decode(Buffer.from(stdout, 'binary'), encoding),\n\t\t\t\t\t\tencoding === 'utf8' || encoding === 'binary' || encoding === 'buffer'\n\t\t\t\t\t\t\t? stderr\n\t\t\t\t\t\t\t: iconv.decode(Buffer.from(stderr, 'binary'), encoding),\n\t\t\t\t\t),\n\t\t\t\t);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (stderr) {\n\t\t\t\tLogger.warn(`Warning(${command} ${args.join(' ')}): ${stderr}`);\n\t\t\t}\n\n\t\t\tresolve(\n\t\t\t\tencoding === 'utf8' || encoding === 'binary' || encoding === 'buffer'\n\t\t\t\t\t? (stdout as TOut)\n\t\t\t\t\t: (iconv.decode(Buffer.from(stdout, 'binary'), encoding) as TOut),\n\t\t\t);\n\t\t});\n\n\t\tif (stdin != null) {\n\t\t\tproc.stdin?.end(stdin, (stdinEncoding ?? 'utf8') as BufferEncoding);\n\t\t}\n\t});\n}\n\nexport function fsExists(path: string) {\n\treturn new Promise<boolean>(resolve => fs.exists(path, exists => resolve(exists)));\n}\n","/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\nfunction isObject(o) {\n  return Object.prototype.toString.call(o) === '[object Object]';\n}\n\nfunction isPlainObject(o) {\n  var ctor,prot;\n\n  if (isObject(o) === false) return false;\n\n  // If has modified constructor\n  ctor = o.constructor;\n  if (ctor === undefined) return true;\n\n  // If has modified prototype\n  prot = ctor.prototype;\n  if (isObject(prot) === false) return false;\n\n  // If constructor does not have an Object-specific method\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  }\n\n  // Most likely a plain Object\n  return true;\n}\n\nexport { isPlainObject };\n","import { isPlainObject } from 'is-plain-object';\nimport { getUserAgent } from 'universal-user-agent';\n\nfunction lowercaseKeys(object) {\n    if (!object) {\n        return {};\n    }\n    return Object.keys(object).reduce((newObj, key) => {\n        newObj[key.toLowerCase()] = object[key];\n        return newObj;\n    }, {});\n}\n\nfunction mergeDeep(defaults, options) {\n    const result = Object.assign({}, defaults);\n    Object.keys(options).forEach((key) => {\n        if (isPlainObject(options[key])) {\n            if (!(key in defaults))\n                Object.assign(result, { [key]: options[key] });\n            else\n                result[key] = mergeDeep(defaults[key], options[key]);\n        }\n        else {\n            Object.assign(result, { [key]: options[key] });\n        }\n    });\n    return result;\n}\n\nfunction removeUndefinedProperties(obj) {\n    for (const key in obj) {\n        if (obj[key] === undefined) {\n            delete obj[key];\n        }\n    }\n    return obj;\n}\n\nfunction merge(defaults, route, options) {\n    if (typeof route === \"string\") {\n        let [method, url] = route.split(\" \");\n        options = Object.assign(url ? { method, url } : { url: method }, options);\n    }\n    else {\n        options = Object.assign({}, route);\n    }\n    // lowercase header names before merging with defaults to avoid duplicates\n    options.headers = lowercaseKeys(options.headers);\n    // remove properties with undefined values before merging\n    removeUndefinedProperties(options);\n    removeUndefinedProperties(options.headers);\n    const mergedOptions = mergeDeep(defaults || {}, options);\n    // mediaType.previews arrays are merged, instead of overwritten\n    if (defaults && defaults.mediaType.previews.length) {\n        mergedOptions.mediaType.previews = defaults.mediaType.previews\n            .filter((preview) => !mergedOptions.mediaType.previews.includes(preview))\n            .concat(mergedOptions.mediaType.previews);\n    }\n    mergedOptions.mediaType.previews = mergedOptions.mediaType.previews.map((preview) => preview.replace(/-preview/, \"\"));\n    return mergedOptions;\n}\n\nfunction addQueryParameters(url, parameters) {\n    const separator = /\\?/.test(url) ? \"&\" : \"?\";\n    const names = Object.keys(parameters);\n    if (names.length === 0) {\n        return url;\n    }\n    return (url +\n        separator +\n        names\n            .map((name) => {\n            if (name === \"q\") {\n                return (\"q=\" + parameters.q.split(\"+\").map(encodeURIComponent).join(\"+\"));\n            }\n            return `${name}=${encodeURIComponent(parameters[name])}`;\n        })\n            .join(\"&\"));\n}\n\nconst urlVariableRegex = /\\{[^}]+\\}/g;\nfunction removeNonChars(variableName) {\n    return variableName.replace(/^\\W+|\\W+$/g, \"\").split(/,/);\n}\nfunction extractUrlVariableNames(url) {\n    const matches = url.match(urlVariableRegex);\n    if (!matches) {\n        return [];\n    }\n    return matches.map(removeNonChars).reduce((a, b) => a.concat(b), []);\n}\n\nfunction omit(object, keysToOmit) {\n    return Object.keys(object)\n        .filter((option) => !keysToOmit.includes(option))\n        .reduce((obj, key) => {\n        obj[key] = object[key];\n        return obj;\n    }, {});\n}\n\n// Based on https://github.com/bramstein/url-template, licensed under BSD\n// TODO: create separate package.\n//\n// Copyright (c) 2012-2014, Bram Stein\n// All rights reserved.\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions\n// are met:\n//  1. Redistributions of source code must retain the above copyright\n//     notice, this list of conditions and the following disclaimer.\n//  2. Redistributions in binary form must reproduce the above copyright\n//     notice, this list of conditions and the following disclaimer in the\n//     documentation and/or other materials provided with the distribution.\n//  3. The name of the author may not be used to endorse or promote products\n//     derived from this software without specific prior written permission.\n// THIS SOFTWARE IS PROVIDED BY THE AUTHOR \"AS IS\" AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\n// MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO\n// EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n// INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,\n// BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n// EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n/* istanbul ignore file */\nfunction encodeReserved(str) {\n    return str\n        .split(/(%[0-9A-Fa-f]{2})/g)\n        .map(function (part) {\n        if (!/%[0-9A-Fa-f]/.test(part)) {\n            part = encodeURI(part).replace(/%5B/g, \"[\").replace(/%5D/g, \"]\");\n        }\n        return part;\n    })\n        .join(\"\");\n}\nfunction encodeUnreserved(str) {\n    return encodeURIComponent(str).replace(/[!'()*]/g, function (c) {\n        return \"%\" + c.charCodeAt(0).toString(16).toUpperCase();\n    });\n}\nfunction encodeValue(operator, value, key) {\n    value =\n        operator === \"+\" || operator === \"#\"\n            ? encodeReserved(value)\n            : encodeUnreserved(value);\n    if (key) {\n        return encodeUnreserved(key) + \"=\" + value;\n    }\n    else {\n        return value;\n    }\n}\nfunction isDefined(value) {\n    return value !== undefined && value !== null;\n}\nfunction isKeyOperator(operator) {\n    return operator === \";\" || operator === \"&\" || operator === \"?\";\n}\nfunction getValues(context, operator, key, modifier) {\n    var value = context[key], result = [];\n    if (isDefined(value) && value !== \"\") {\n        if (typeof value === \"string\" ||\n            typeof value === \"number\" ||\n            typeof value === \"boolean\") {\n            value = value.toString();\n            if (modifier && modifier !== \"*\") {\n                value = value.substring(0, parseInt(modifier, 10));\n            }\n            result.push(encodeValue(operator, value, isKeyOperator(operator) ? key : \"\"));\n        }\n        else {\n            if (modifier === \"*\") {\n                if (Array.isArray(value)) {\n                    value.filter(isDefined).forEach(function (value) {\n                        result.push(encodeValue(operator, value, isKeyOperator(operator) ? key : \"\"));\n                    });\n                }\n                else {\n                    Object.keys(value).forEach(function (k) {\n                        if (isDefined(value[k])) {\n                            result.push(encodeValue(operator, value[k], k));\n                        }\n                    });\n                }\n            }\n            else {\n                const tmp = [];\n                if (Array.isArray(value)) {\n                    value.filter(isDefined).forEach(function (value) {\n                        tmp.push(encodeValue(operator, value));\n                    });\n                }\n                else {\n                    Object.keys(value).forEach(function (k) {\n                        if (isDefined(value[k])) {\n                            tmp.push(encodeUnreserved(k));\n                            tmp.push(encodeValue(operator, value[k].toString()));\n                        }\n                    });\n                }\n                if (isKeyOperator(operator)) {\n                    result.push(encodeUnreserved(key) + \"=\" + tmp.join(\",\"));\n                }\n                else if (tmp.length !== 0) {\n                    result.push(tmp.join(\",\"));\n                }\n            }\n        }\n    }\n    else {\n        if (operator === \";\") {\n            if (isDefined(value)) {\n                result.push(encodeUnreserved(key));\n            }\n        }\n        else if (value === \"\" && (operator === \"&\" || operator === \"?\")) {\n            result.push(encodeUnreserved(key) + \"=\");\n        }\n        else if (value === \"\") {\n            result.push(\"\");\n        }\n    }\n    return result;\n}\nfunction parseUrl(template) {\n    return {\n        expand: expand.bind(null, template),\n    };\n}\nfunction expand(template, context) {\n    var operators = [\"+\", \"#\", \".\", \"/\", \";\", \"?\", \"&\"];\n    return template.replace(/\\{([^\\{\\}]+)\\}|([^\\{\\}]+)/g, function (_, expression, literal) {\n        if (expression) {\n            let operator = \"\";\n            const values = [];\n            if (operators.indexOf(expression.charAt(0)) !== -1) {\n                operator = expression.charAt(0);\n                expression = expression.substr(1);\n            }\n            expression.split(/,/g).forEach(function (variable) {\n                var tmp = /([^:\\*]*)(?::(\\d+)|(\\*))?/.exec(variable);\n                values.push(getValues(context, operator, tmp[1], tmp[2] || tmp[3]));\n            });\n            if (operator && operator !== \"+\") {\n                var separator = \",\";\n                if (operator === \"?\") {\n                    separator = \"&\";\n                }\n                else if (operator !== \"#\") {\n                    separator = operator;\n                }\n                return (values.length !== 0 ? operator : \"\") + values.join(separator);\n            }\n            else {\n                return values.join(\",\");\n            }\n        }\n        else {\n            return encodeReserved(literal);\n        }\n    });\n}\n\nfunction parse(options) {\n    // https://fetch.spec.whatwg.org/#methods\n    let method = options.method.toUpperCase();\n    // replace :varname with {varname} to make it RFC 6570 compatible\n    let url = (options.url || \"/\").replace(/:([a-z]\\w+)/g, \"{$1}\");\n    let headers = Object.assign({}, options.headers);\n    let body;\n    let parameters = omit(options, [\n        \"method\",\n        \"baseUrl\",\n        \"url\",\n        \"headers\",\n        \"request\",\n        \"mediaType\",\n    ]);\n    // extract variable names from URL to calculate remaining variables later\n    const urlVariableNames = extractUrlVariableNames(url);\n    url = parseUrl(url).expand(parameters);\n    if (!/^http/.test(url)) {\n        url = options.baseUrl + url;\n    }\n    const omittedParameters = Object.keys(options)\n        .filter((option) => urlVariableNames.includes(option))\n        .concat(\"baseUrl\");\n    const remainingParameters = omit(parameters, omittedParameters);\n    const isBinaryRequest = /application\\/octet-stream/i.test(headers.accept);\n    if (!isBinaryRequest) {\n        if (options.mediaType.format) {\n            // e.g. application/vnd.github.v3+json => application/vnd.github.v3.raw\n            headers.accept = headers.accept\n                .split(/,/)\n                .map((preview) => preview.replace(/application\\/vnd(\\.\\w+)(\\.v3)?(\\.\\w+)?(\\+json)?$/, `application/vnd$1$2.${options.mediaType.format}`))\n                .join(\",\");\n        }\n        if (options.mediaType.previews.length) {\n            const previewsFromAcceptHeader = headers.accept.match(/[\\w-]+(?=-preview)/g) || [];\n            headers.accept = previewsFromAcceptHeader\n                .concat(options.mediaType.previews)\n                .map((preview) => {\n                const format = options.mediaType.format\n                    ? `.${options.mediaType.format}`\n                    : \"+json\";\n                return `application/vnd.github.${preview}-preview${format}`;\n            })\n                .join(\",\");\n        }\n    }\n    // for GET/HEAD requests, set URL query parameters from remaining parameters\n    // for PATCH/POST/PUT/DELETE requests, set request body from remaining parameters\n    if ([\"GET\", \"HEAD\"].includes(method)) {\n        url = addQueryParameters(url, remainingParameters);\n    }\n    else {\n        if (\"data\" in remainingParameters) {\n            body = remainingParameters.data;\n        }\n        else {\n            if (Object.keys(remainingParameters).length) {\n                body = remainingParameters;\n            }\n            else {\n                headers[\"content-length\"] = 0;\n            }\n        }\n    }\n    // default content-type for JSON if body is set\n    if (!headers[\"content-type\"] && typeof body !== \"undefined\") {\n        headers[\"content-type\"] = \"application/json; charset=utf-8\";\n    }\n    // GitHub expects 'content-length: 0' header for PUT/PATCH requests without body.\n    // fetch does not allow to set `content-length` header, but we can set body to an empty string\n    if ([\"PATCH\", \"PUT\"].includes(method) && typeof body === \"undefined\") {\n        body = \"\";\n    }\n    // Only return body/request keys if present\n    return Object.assign({ method, url, headers }, typeof body !== \"undefined\" ? { body } : null, options.request ? { request: options.request } : null);\n}\n\nfunction endpointWithDefaults(defaults, route, options) {\n    return parse(merge(defaults, route, options));\n}\n\nfunction withDefaults(oldDefaults, newDefaults) {\n    const DEFAULTS = merge(oldDefaults, newDefaults);\n    const endpoint = endpointWithDefaults.bind(null, DEFAULTS);\n    return Object.assign(endpoint, {\n        DEFAULTS,\n        defaults: withDefaults.bind(null, DEFAULTS),\n        merge: merge.bind(null, DEFAULTS),\n        parse,\n    });\n}\n\nconst VERSION = \"6.0.12\";\n\nconst userAgent = `octokit-endpoint.js/${VERSION} ${getUserAgent()}`;\n// DEFAULTS has all properties set that EndpointOptions has, except url.\n// So we use RequestParameters and add method as additional required property.\nconst DEFAULTS = {\n    method: \"GET\",\n    baseUrl: \"https://api.github.com\",\n    headers: {\n        accept: \"application/vnd.github.v3+json\",\n        \"user-agent\": userAgent,\n    },\n    mediaType: {\n        format: \"\",\n        previews: [],\n    },\n};\n\nconst endpoint = withDefaults(null, DEFAULTS);\n\nexport { endpoint };\n//# sourceMappingURL=index.js.map\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"http\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"url\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"https\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"zlib\");","import Stream from 'stream';\nimport http from 'http';\nimport Url from 'url';\nimport whatwgUrl from 'whatwg-url';\nimport https from 'https';\nimport zlib from 'zlib';\n\n// Based on https://github.com/tmpvar/jsdom/blob/aa85b2abf07766ff7bf5c1f6daafb3726f2f2db5/lib/jsdom/living/blob.js\n\n// fix for \"Readable\" isn't a named export issue\nconst Readable = Stream.Readable;\n\nconst BUFFER = Symbol('buffer');\nconst TYPE = Symbol('type');\n\nclass Blob {\n\tconstructor() {\n\t\tthis[TYPE] = '';\n\n\t\tconst blobParts = arguments[0];\n\t\tconst options = arguments[1];\n\n\t\tconst buffers = [];\n\t\tlet size = 0;\n\n\t\tif (blobParts) {\n\t\t\tconst a = blobParts;\n\t\t\tconst length = Number(a.length);\n\t\t\tfor (let i = 0; i < length; i++) {\n\t\t\t\tconst element = a[i];\n\t\t\t\tlet buffer;\n\t\t\t\tif (element instanceof Buffer) {\n\t\t\t\t\tbuffer = element;\n\t\t\t\t} else if (ArrayBuffer.isView(element)) {\n\t\t\t\t\tbuffer = Buffer.from(element.buffer, element.byteOffset, element.byteLength);\n\t\t\t\t} else if (element instanceof ArrayBuffer) {\n\t\t\t\t\tbuffer = Buffer.from(element);\n\t\t\t\t} else if (element instanceof Blob) {\n\t\t\t\t\tbuffer = element[BUFFER];\n\t\t\t\t} else {\n\t\t\t\t\tbuffer = Buffer.from(typeof element === 'string' ? element : String(element));\n\t\t\t\t}\n\t\t\t\tsize += buffer.length;\n\t\t\t\tbuffers.push(buffer);\n\t\t\t}\n\t\t}\n\n\t\tthis[BUFFER] = Buffer.concat(buffers);\n\n\t\tlet type = options && options.type !== undefined && String(options.type).toLowerCase();\n\t\tif (type && !/[^\\u0020-\\u007E]/.test(type)) {\n\t\t\tthis[TYPE] = type;\n\t\t}\n\t}\n\tget size() {\n\t\treturn this[BUFFER].length;\n\t}\n\tget type() {\n\t\treturn this[TYPE];\n\t}\n\ttext() {\n\t\treturn Promise.resolve(this[BUFFER].toString());\n\t}\n\tarrayBuffer() {\n\t\tconst buf = this[BUFFER];\n\t\tconst ab = buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.byteLength);\n\t\treturn Promise.resolve(ab);\n\t}\n\tstream() {\n\t\tconst readable = new Readable();\n\t\treadable._read = function () {};\n\t\treadable.push(this[BUFFER]);\n\t\treadable.push(null);\n\t\treturn readable;\n\t}\n\ttoString() {\n\t\treturn '[object Blob]';\n\t}\n\tslice() {\n\t\tconst size = this.size;\n\n\t\tconst start = arguments[0];\n\t\tconst end = arguments[1];\n\t\tlet relativeStart, relativeEnd;\n\t\tif (start === undefined) {\n\t\t\trelativeStart = 0;\n\t\t} else if (start < 0) {\n\t\t\trelativeStart = Math.max(size + start, 0);\n\t\t} else {\n\t\t\trelativeStart = Math.min(start, size);\n\t\t}\n\t\tif (end === undefined) {\n\t\t\trelativeEnd = size;\n\t\t} else if (end < 0) {\n\t\t\trelativeEnd = Math.max(size + end, 0);\n\t\t} else {\n\t\t\trelativeEnd = Math.min(end, size);\n\t\t}\n\t\tconst span = Math.max(relativeEnd - relativeStart, 0);\n\n\t\tconst buffer = this[BUFFER];\n\t\tconst slicedBuffer = buffer.slice(relativeStart, relativeStart + span);\n\t\tconst blob = new Blob([], { type: arguments[2] });\n\t\tblob[BUFFER] = slicedBuffer;\n\t\treturn blob;\n\t}\n}\n\nObject.defineProperties(Blob.prototype, {\n\tsize: { enumerable: true },\n\ttype: { enumerable: true },\n\tslice: { enumerable: true }\n});\n\nObject.defineProperty(Blob.prototype, Symbol.toStringTag, {\n\tvalue: 'Blob',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\n/**\n * fetch-error.js\n *\n * FetchError interface for operational errors\n */\n\n/**\n * Create FetchError instance\n *\n * @param   String      message      Error message for human\n * @param   String      type         Error type for machine\n * @param   String      systemError  For Node.js system error\n * @return  FetchError\n */\nfunction FetchError(message, type, systemError) {\n  Error.call(this, message);\n\n  this.message = message;\n  this.type = type;\n\n  // when err.type is `system`, err.code contains system error code\n  if (systemError) {\n    this.code = this.errno = systemError.code;\n  }\n\n  // hide custom error implementation details from end-users\n  Error.captureStackTrace(this, this.constructor);\n}\n\nFetchError.prototype = Object.create(Error.prototype);\nFetchError.prototype.constructor = FetchError;\nFetchError.prototype.name = 'FetchError';\n\nlet convert;\ntry {\n\tconvert = require('encoding').convert;\n} catch (e) {}\n\nconst INTERNALS = Symbol('Body internals');\n\n// fix an issue where \"PassThrough\" isn't a named export for node <10\nconst PassThrough = Stream.PassThrough;\n\n/**\n * Body mixin\n *\n * Ref: https://fetch.spec.whatwg.org/#body\n *\n * @param   Stream  body  Readable stream\n * @param   Object  opts  Response options\n * @return  Void\n */\nfunction Body(body) {\n\tvar _this = this;\n\n\tvar _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n\t    _ref$size = _ref.size;\n\n\tlet size = _ref$size === undefined ? 0 : _ref$size;\n\tvar _ref$timeout = _ref.timeout;\n\tlet timeout = _ref$timeout === undefined ? 0 : _ref$timeout;\n\n\tif (body == null) {\n\t\t// body is undefined or null\n\t\tbody = null;\n\t} else if (isURLSearchParams(body)) {\n\t\t// body is a URLSearchParams\n\t\tbody = Buffer.from(body.toString());\n\t} else if (isBlob(body)) ; else if (Buffer.isBuffer(body)) ; else if (Object.prototype.toString.call(body) === '[object ArrayBuffer]') {\n\t\t// body is ArrayBuffer\n\t\tbody = Buffer.from(body);\n\t} else if (ArrayBuffer.isView(body)) {\n\t\t// body is ArrayBufferView\n\t\tbody = Buffer.from(body.buffer, body.byteOffset, body.byteLength);\n\t} else if (body instanceof Stream) ; else {\n\t\t// none of the above\n\t\t// coerce to string then buffer\n\t\tbody = Buffer.from(String(body));\n\t}\n\tthis[INTERNALS] = {\n\t\tbody,\n\t\tdisturbed: false,\n\t\terror: null\n\t};\n\tthis.size = size;\n\tthis.timeout = timeout;\n\n\tif (body instanceof Stream) {\n\t\tbody.on('error', function (err) {\n\t\t\tconst error = err.name === 'AbortError' ? err : new FetchError(`Invalid response body while trying to fetch ${_this.url}: ${err.message}`, 'system', err);\n\t\t\t_this[INTERNALS].error = error;\n\t\t});\n\t}\n}\n\nBody.prototype = {\n\tget body() {\n\t\treturn this[INTERNALS].body;\n\t},\n\n\tget bodyUsed() {\n\t\treturn this[INTERNALS].disturbed;\n\t},\n\n\t/**\n  * Decode response as ArrayBuffer\n  *\n  * @return  Promise\n  */\n\tarrayBuffer() {\n\t\treturn consumeBody.call(this).then(function (buf) {\n\t\t\treturn buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.byteLength);\n\t\t});\n\t},\n\n\t/**\n  * Return raw response as Blob\n  *\n  * @return Promise\n  */\n\tblob() {\n\t\tlet ct = this.headers && this.headers.get('content-type') || '';\n\t\treturn consumeBody.call(this).then(function (buf) {\n\t\t\treturn Object.assign(\n\t\t\t// Prevent copying\n\t\t\tnew Blob([], {\n\t\t\t\ttype: ct.toLowerCase()\n\t\t\t}), {\n\t\t\t\t[BUFFER]: buf\n\t\t\t});\n\t\t});\n\t},\n\n\t/**\n  * Decode response as json\n  *\n  * @return  Promise\n  */\n\tjson() {\n\t\tvar _this2 = this;\n\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\ttry {\n\t\t\t\treturn JSON.parse(buffer.toString());\n\t\t\t} catch (err) {\n\t\t\t\treturn Body.Promise.reject(new FetchError(`invalid json response body at ${_this2.url} reason: ${err.message}`, 'invalid-json'));\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n  * Decode response as text\n  *\n  * @return  Promise\n  */\n\ttext() {\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\treturn buffer.toString();\n\t\t});\n\t},\n\n\t/**\n  * Decode response as buffer (non-spec api)\n  *\n  * @return  Promise\n  */\n\tbuffer() {\n\t\treturn consumeBody.call(this);\n\t},\n\n\t/**\n  * Decode response as text, while automatically detecting the encoding and\n  * trying to decode to UTF-8 (non-spec api)\n  *\n  * @return  Promise\n  */\n\ttextConverted() {\n\t\tvar _this3 = this;\n\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\treturn convertBody(buffer, _this3.headers);\n\t\t});\n\t}\n};\n\n// In browsers, all properties are enumerable.\nObject.defineProperties(Body.prototype, {\n\tbody: { enumerable: true },\n\tbodyUsed: { enumerable: true },\n\tarrayBuffer: { enumerable: true },\n\tblob: { enumerable: true },\n\tjson: { enumerable: true },\n\ttext: { enumerable: true }\n});\n\nBody.mixIn = function (proto) {\n\tfor (const name of Object.getOwnPropertyNames(Body.prototype)) {\n\t\t// istanbul ignore else: future proof\n\t\tif (!(name in proto)) {\n\t\t\tconst desc = Object.getOwnPropertyDescriptor(Body.prototype, name);\n\t\t\tObject.defineProperty(proto, name, desc);\n\t\t}\n\t}\n};\n\n/**\n * Consume and convert an entire Body to a Buffer.\n *\n * Ref: https://fetch.spec.whatwg.org/#concept-body-consume-body\n *\n * @return  Promise\n */\nfunction consumeBody() {\n\tvar _this4 = this;\n\n\tif (this[INTERNALS].disturbed) {\n\t\treturn Body.Promise.reject(new TypeError(`body used already for: ${this.url}`));\n\t}\n\n\tthis[INTERNALS].disturbed = true;\n\n\tif (this[INTERNALS].error) {\n\t\treturn Body.Promise.reject(this[INTERNALS].error);\n\t}\n\n\tlet body = this.body;\n\n\t// body is null\n\tif (body === null) {\n\t\treturn Body.Promise.resolve(Buffer.alloc(0));\n\t}\n\n\t// body is blob\n\tif (isBlob(body)) {\n\t\tbody = body.stream();\n\t}\n\n\t// body is buffer\n\tif (Buffer.isBuffer(body)) {\n\t\treturn Body.Promise.resolve(body);\n\t}\n\n\t// istanbul ignore if: should never happen\n\tif (!(body instanceof Stream)) {\n\t\treturn Body.Promise.resolve(Buffer.alloc(0));\n\t}\n\n\t// body is stream\n\t// get ready to actually consume the body\n\tlet accum = [];\n\tlet accumBytes = 0;\n\tlet abort = false;\n\n\treturn new Body.Promise(function (resolve, reject) {\n\t\tlet resTimeout;\n\n\t\t// allow timeout on slow response body\n\t\tif (_this4.timeout) {\n\t\t\tresTimeout = setTimeout(function () {\n\t\t\t\tabort = true;\n\t\t\t\treject(new FetchError(`Response timeout while trying to fetch ${_this4.url} (over ${_this4.timeout}ms)`, 'body-timeout'));\n\t\t\t}, _this4.timeout);\n\t\t}\n\n\t\t// handle stream errors\n\t\tbody.on('error', function (err) {\n\t\t\tif (err.name === 'AbortError') {\n\t\t\t\t// if the request was aborted, reject with this Error\n\t\t\t\tabort = true;\n\t\t\t\treject(err);\n\t\t\t} else {\n\t\t\t\t// other errors, such as incorrect content-encoding\n\t\t\t\treject(new FetchError(`Invalid response body while trying to fetch ${_this4.url}: ${err.message}`, 'system', err));\n\t\t\t}\n\t\t});\n\n\t\tbody.on('data', function (chunk) {\n\t\t\tif (abort || chunk === null) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (_this4.size && accumBytes + chunk.length > _this4.size) {\n\t\t\t\tabort = true;\n\t\t\t\treject(new FetchError(`content size at ${_this4.url} over limit: ${_this4.size}`, 'max-size'));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\taccumBytes += chunk.length;\n\t\t\taccum.push(chunk);\n\t\t});\n\n\t\tbody.on('end', function () {\n\t\t\tif (abort) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tclearTimeout(resTimeout);\n\n\t\t\ttry {\n\t\t\t\tresolve(Buffer.concat(accum, accumBytes));\n\t\t\t} catch (err) {\n\t\t\t\t// handle streams that have accumulated too much data (issue #414)\n\t\t\t\treject(new FetchError(`Could not create Buffer from response body for ${_this4.url}: ${err.message}`, 'system', err));\n\t\t\t}\n\t\t});\n\t});\n}\n\n/**\n * Detect buffer encoding and convert to target encoding\n * ref: http://www.w3.org/TR/2011/WD-html5-20110113/parsing.html#determining-the-character-encoding\n *\n * @param   Buffer  buffer    Incoming buffer\n * @param   String  encoding  Target encoding\n * @return  String\n */\nfunction convertBody(buffer, headers) {\n\tif (typeof convert !== 'function') {\n\t\tthrow new Error('The package `encoding` must be installed to use the textConverted() function');\n\t}\n\n\tconst ct = headers.get('content-type');\n\tlet charset = 'utf-8';\n\tlet res, str;\n\n\t// header\n\tif (ct) {\n\t\tres = /charset=([^;]*)/i.exec(ct);\n\t}\n\n\t// no charset in content type, peek at response body for at most 1024 bytes\n\tstr = buffer.slice(0, 1024).toString();\n\n\t// html5\n\tif (!res && str) {\n\t\tres = /<meta.+?charset=(['\"])(.+?)\\1/i.exec(str);\n\t}\n\n\t// html4\n\tif (!res && str) {\n\t\tres = /<meta[\\s]+?http-equiv=(['\"])content-type\\1[\\s]+?content=(['\"])(.+?)\\2/i.exec(str);\n\t\tif (!res) {\n\t\t\tres = /<meta[\\s]+?content=(['\"])(.+?)\\1[\\s]+?http-equiv=(['\"])content-type\\3/i.exec(str);\n\t\t\tif (res) {\n\t\t\t\tres.pop(); // drop last quote\n\t\t\t}\n\t\t}\n\n\t\tif (res) {\n\t\t\tres = /charset=(.*)/i.exec(res.pop());\n\t\t}\n\t}\n\n\t// xml\n\tif (!res && str) {\n\t\tres = /<\\?xml.+?encoding=(['\"])(.+?)\\1/i.exec(str);\n\t}\n\n\t// found charset\n\tif (res) {\n\t\tcharset = res.pop();\n\n\t\t// prevent decode issues when sites use incorrect encoding\n\t\t// ref: https://hsivonen.fi/encoding-menu/\n\t\tif (charset === 'gb2312' || charset === 'gbk') {\n\t\t\tcharset = 'gb18030';\n\t\t}\n\t}\n\n\t// turn raw buffers into a single utf-8 buffer\n\treturn convert(buffer, 'UTF-8', charset).toString();\n}\n\n/**\n * Detect a URLSearchParams object\n * ref: https://github.com/bitinn/node-fetch/issues/296#issuecomment-307598143\n *\n * @param   Object  obj     Object to detect by type or brand\n * @return  String\n */\nfunction isURLSearchParams(obj) {\n\t// Duck-typing as a necessary condition.\n\tif (typeof obj !== 'object' || typeof obj.append !== 'function' || typeof obj.delete !== 'function' || typeof obj.get !== 'function' || typeof obj.getAll !== 'function' || typeof obj.has !== 'function' || typeof obj.set !== 'function') {\n\t\treturn false;\n\t}\n\n\t// Brand-checking and more duck-typing as optional condition.\n\treturn obj.constructor.name === 'URLSearchParams' || Object.prototype.toString.call(obj) === '[object URLSearchParams]' || typeof obj.sort === 'function';\n}\n\n/**\n * Check if `obj` is a W3C `Blob` object (which `File` inherits from)\n * @param  {*} obj\n * @return {boolean}\n */\nfunction isBlob(obj) {\n\treturn typeof obj === 'object' && typeof obj.arrayBuffer === 'function' && typeof obj.type === 'string' && typeof obj.stream === 'function' && typeof obj.constructor === 'function' && typeof obj.constructor.name === 'string' && /^(Blob|File)$/.test(obj.constructor.name) && /^(Blob|File)$/.test(obj[Symbol.toStringTag]);\n}\n\n/**\n * Clone body given Res/Req instance\n *\n * @param   Mixed  instance  Response or Request instance\n * @return  Mixed\n */\nfunction clone(instance) {\n\tlet p1, p2;\n\tlet body = instance.body;\n\n\t// don't allow cloning a used body\n\tif (instance.bodyUsed) {\n\t\tthrow new Error('cannot clone body after it is used');\n\t}\n\n\t// check that body is a stream and not form-data object\n\t// note: we can't clone the form-data object without having it as a dependency\n\tif (body instanceof Stream && typeof body.getBoundary !== 'function') {\n\t\t// tee instance body\n\t\tp1 = new PassThrough();\n\t\tp2 = new PassThrough();\n\t\tbody.pipe(p1);\n\t\tbody.pipe(p2);\n\t\t// set instance body to teed body and return the other teed body\n\t\tinstance[INTERNALS].body = p1;\n\t\tbody = p2;\n\t}\n\n\treturn body;\n}\n\n/**\n * Performs the operation \"extract a `Content-Type` value from |object|\" as\n * specified in the specification:\n * https://fetch.spec.whatwg.org/#concept-bodyinit-extract\n *\n * This function assumes that instance.body is present.\n *\n * @param   Mixed  instance  Any options.body input\n */\nfunction extractContentType(body) {\n\tif (body === null) {\n\t\t// body is null\n\t\treturn null;\n\t} else if (typeof body === 'string') {\n\t\t// body is string\n\t\treturn 'text/plain;charset=UTF-8';\n\t} else if (isURLSearchParams(body)) {\n\t\t// body is a URLSearchParams\n\t\treturn 'application/x-www-form-urlencoded;charset=UTF-8';\n\t} else if (isBlob(body)) {\n\t\t// body is blob\n\t\treturn body.type || null;\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\treturn null;\n\t} else if (Object.prototype.toString.call(body) === '[object ArrayBuffer]') {\n\t\t// body is ArrayBuffer\n\t\treturn null;\n\t} else if (ArrayBuffer.isView(body)) {\n\t\t// body is ArrayBufferView\n\t\treturn null;\n\t} else if (typeof body.getBoundary === 'function') {\n\t\t// detect form data input from form-data module\n\t\treturn `multipart/form-data;boundary=${body.getBoundary()}`;\n\t} else if (body instanceof Stream) {\n\t\t// body is stream\n\t\t// can't really do much about this\n\t\treturn null;\n\t} else {\n\t\t// Body constructor defaults other things to string\n\t\treturn 'text/plain;charset=UTF-8';\n\t}\n}\n\n/**\n * The Fetch Standard treats this as if \"total bytes\" is a property on the body.\n * For us, we have to explicitly get it with a function.\n *\n * ref: https://fetch.spec.whatwg.org/#concept-body-total-bytes\n *\n * @param   Body    instance   Instance of Body\n * @return  Number?            Number of bytes, or null if not possible\n */\nfunction getTotalBytes(instance) {\n\tconst body = instance.body;\n\n\n\tif (body === null) {\n\t\t// body is null\n\t\treturn 0;\n\t} else if (isBlob(body)) {\n\t\treturn body.size;\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\treturn body.length;\n\t} else if (body && typeof body.getLengthSync === 'function') {\n\t\t// detect form data input from form-data module\n\t\tif (body._lengthRetrievers && body._lengthRetrievers.length == 0 || // 1.x\n\t\tbody.hasKnownLength && body.hasKnownLength()) {\n\t\t\t// 2.x\n\t\t\treturn body.getLengthSync();\n\t\t}\n\t\treturn null;\n\t} else {\n\t\t// body is stream\n\t\treturn null;\n\t}\n}\n\n/**\n * Write a Body to a Node.js WritableStream (e.g. http.Request) object.\n *\n * @param   Body    instance   Instance of Body\n * @return  Void\n */\nfunction writeToStream(dest, instance) {\n\tconst body = instance.body;\n\n\n\tif (body === null) {\n\t\t// body is null\n\t\tdest.end();\n\t} else if (isBlob(body)) {\n\t\tbody.stream().pipe(dest);\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\tdest.write(body);\n\t\tdest.end();\n\t} else {\n\t\t// body is stream\n\t\tbody.pipe(dest);\n\t}\n}\n\n// expose Promise\nBody.Promise = global.Promise;\n\n/**\n * headers.js\n *\n * Headers class offers convenient helpers\n */\n\nconst invalidTokenRegex = /[^\\^_`a-zA-Z\\-0-9!#$%&'*+.|~]/;\nconst invalidHeaderCharRegex = /[^\\t\\x20-\\x7e\\x80-\\xff]/;\n\nfunction validateName(name) {\n\tname = `${name}`;\n\tif (invalidTokenRegex.test(name) || name === '') {\n\t\tthrow new TypeError(`${name} is not a legal HTTP header name`);\n\t}\n}\n\nfunction validateValue(value) {\n\tvalue = `${value}`;\n\tif (invalidHeaderCharRegex.test(value)) {\n\t\tthrow new TypeError(`${value} is not a legal HTTP header value`);\n\t}\n}\n\n/**\n * Find the key in the map object given a header name.\n *\n * Returns undefined if not found.\n *\n * @param   String  name  Header name\n * @return  String|Undefined\n */\nfunction find(map, name) {\n\tname = name.toLowerCase();\n\tfor (const key in map) {\n\t\tif (key.toLowerCase() === name) {\n\t\t\treturn key;\n\t\t}\n\t}\n\treturn undefined;\n}\n\nconst MAP = Symbol('map');\nclass Headers {\n\t/**\n  * Headers class\n  *\n  * @param   Object  headers  Response headers\n  * @return  Void\n  */\n\tconstructor() {\n\t\tlet init = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n\n\t\tthis[MAP] = Object.create(null);\n\n\t\tif (init instanceof Headers) {\n\t\t\tconst rawHeaders = init.raw();\n\t\t\tconst headerNames = Object.keys(rawHeaders);\n\n\t\t\tfor (const headerName of headerNames) {\n\t\t\t\tfor (const value of rawHeaders[headerName]) {\n\t\t\t\t\tthis.append(headerName, value);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\t// We don't worry about converting prop to ByteString here as append()\n\t\t// will handle it.\n\t\tif (init == null) ; else if (typeof init === 'object') {\n\t\t\tconst method = init[Symbol.iterator];\n\t\t\tif (method != null) {\n\t\t\t\tif (typeof method !== 'function') {\n\t\t\t\t\tthrow new TypeError('Header pairs must be iterable');\n\t\t\t\t}\n\n\t\t\t\t// sequence<sequence<ByteString>>\n\t\t\t\t// Note: per spec we have to first exhaust the lists then process them\n\t\t\t\tconst pairs = [];\n\t\t\t\tfor (const pair of init) {\n\t\t\t\t\tif (typeof pair !== 'object' || typeof pair[Symbol.iterator] !== 'function') {\n\t\t\t\t\t\tthrow new TypeError('Each header pair must be iterable');\n\t\t\t\t\t}\n\t\t\t\t\tpairs.push(Array.from(pair));\n\t\t\t\t}\n\n\t\t\t\tfor (const pair of pairs) {\n\t\t\t\t\tif (pair.length !== 2) {\n\t\t\t\t\t\tthrow new TypeError('Each header pair must be a name/value tuple');\n\t\t\t\t\t}\n\t\t\t\t\tthis.append(pair[0], pair[1]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// record<ByteString, ByteString>\n\t\t\t\tfor (const key of Object.keys(init)) {\n\t\t\t\t\tconst value = init[key];\n\t\t\t\t\tthis.append(key, value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new TypeError('Provided initializer must be an object');\n\t\t}\n\t}\n\n\t/**\n  * Return combined header value given name\n  *\n  * @param   String  name  Header name\n  * @return  Mixed\n  */\n\tget(name) {\n\t\tname = `${name}`;\n\t\tvalidateName(name);\n\t\tconst key = find(this[MAP], name);\n\t\tif (key === undefined) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this[MAP][key].join(', ');\n\t}\n\n\t/**\n  * Iterate over all headers\n  *\n  * @param   Function  callback  Executed for each item with parameters (value, name, thisArg)\n  * @param   Boolean   thisArg   `this` context for callback function\n  * @return  Void\n  */\n\tforEach(callback) {\n\t\tlet thisArg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;\n\n\t\tlet pairs = getHeaders(this);\n\t\tlet i = 0;\n\t\twhile (i < pairs.length) {\n\t\t\tvar _pairs$i = pairs[i];\n\t\t\tconst name = _pairs$i[0],\n\t\t\t      value = _pairs$i[1];\n\n\t\t\tcallback.call(thisArg, value, name, this);\n\t\t\tpairs = getHeaders(this);\n\t\t\ti++;\n\t\t}\n\t}\n\n\t/**\n  * Overwrite header values given name\n  *\n  * @param   String  name   Header name\n  * @param   String  value  Header value\n  * @return  Void\n  */\n\tset(name, value) {\n\t\tname = `${name}`;\n\t\tvalue = `${value}`;\n\t\tvalidateName(name);\n\t\tvalidateValue(value);\n\t\tconst key = find(this[MAP], name);\n\t\tthis[MAP][key !== undefined ? key : name] = [value];\n\t}\n\n\t/**\n  * Append a value onto existing header\n  *\n  * @param   String  name   Header name\n  * @param   String  value  Header value\n  * @return  Void\n  */\n\tappend(name, value) {\n\t\tname = `${name}`;\n\t\tvalue = `${value}`;\n\t\tvalidateName(name);\n\t\tvalidateValue(value);\n\t\tconst key = find(this[MAP], name);\n\t\tif (key !== undefined) {\n\t\t\tthis[MAP][key].push(value);\n\t\t} else {\n\t\t\tthis[MAP][name] = [value];\n\t\t}\n\t}\n\n\t/**\n  * Check for header name existence\n  *\n  * @param   String   name  Header name\n  * @return  Boolean\n  */\n\thas(name) {\n\t\tname = `${name}`;\n\t\tvalidateName(name);\n\t\treturn find(this[MAP], name) !== undefined;\n\t}\n\n\t/**\n  * Delete all header values given name\n  *\n  * @param   String  name  Header name\n  * @return  Void\n  */\n\tdelete(name) {\n\t\tname = `${name}`;\n\t\tvalidateName(name);\n\t\tconst key = find(this[MAP], name);\n\t\tif (key !== undefined) {\n\t\t\tdelete this[MAP][key];\n\t\t}\n\t}\n\n\t/**\n  * Return raw headers (non-spec api)\n  *\n  * @return  Object\n  */\n\traw() {\n\t\treturn this[MAP];\n\t}\n\n\t/**\n  * Get an iterator on keys.\n  *\n  * @return  Iterator\n  */\n\tkeys() {\n\t\treturn createHeadersIterator(this, 'key');\n\t}\n\n\t/**\n  * Get an iterator on values.\n  *\n  * @return  Iterator\n  */\n\tvalues() {\n\t\treturn createHeadersIterator(this, 'value');\n\t}\n\n\t/**\n  * Get an iterator on entries.\n  *\n  * This is the default iterator of the Headers object.\n  *\n  * @return  Iterator\n  */\n\t[Symbol.iterator]() {\n\t\treturn createHeadersIterator(this, 'key+value');\n\t}\n}\nHeaders.prototype.entries = Headers.prototype[Symbol.iterator];\n\nObject.defineProperty(Headers.prototype, Symbol.toStringTag, {\n\tvalue: 'Headers',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\nObject.defineProperties(Headers.prototype, {\n\tget: { enumerable: true },\n\tforEach: { enumerable: true },\n\tset: { enumerable: true },\n\tappend: { enumerable: true },\n\thas: { enumerable: true },\n\tdelete: { enumerable: true },\n\tkeys: { enumerable: true },\n\tvalues: { enumerable: true },\n\tentries: { enumerable: true }\n});\n\nfunction getHeaders(headers) {\n\tlet kind = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'key+value';\n\n\tconst keys = Object.keys(headers[MAP]).sort();\n\treturn keys.map(kind === 'key' ? function (k) {\n\t\treturn k.toLowerCase();\n\t} : kind === 'value' ? function (k) {\n\t\treturn headers[MAP][k].join(', ');\n\t} : function (k) {\n\t\treturn [k.toLowerCase(), headers[MAP][k].join(', ')];\n\t});\n}\n\nconst INTERNAL = Symbol('internal');\n\nfunction createHeadersIterator(target, kind) {\n\tconst iterator = Object.create(HeadersIteratorPrototype);\n\titerator[INTERNAL] = {\n\t\ttarget,\n\t\tkind,\n\t\tindex: 0\n\t};\n\treturn iterator;\n}\n\nconst HeadersIteratorPrototype = Object.setPrototypeOf({\n\tnext() {\n\t\t// istanbul ignore if\n\t\tif (!this || Object.getPrototypeOf(this) !== HeadersIteratorPrototype) {\n\t\t\tthrow new TypeError('Value of `this` is not a HeadersIterator');\n\t\t}\n\n\t\tvar _INTERNAL = this[INTERNAL];\n\t\tconst target = _INTERNAL.target,\n\t\t      kind = _INTERNAL.kind,\n\t\t      index = _INTERNAL.index;\n\n\t\tconst values = getHeaders(target, kind);\n\t\tconst len = values.length;\n\t\tif (index >= len) {\n\t\t\treturn {\n\t\t\t\tvalue: undefined,\n\t\t\t\tdone: true\n\t\t\t};\n\t\t}\n\n\t\tthis[INTERNAL].index = index + 1;\n\n\t\treturn {\n\t\t\tvalue: values[index],\n\t\t\tdone: false\n\t\t};\n\t}\n}, Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));\n\nObject.defineProperty(HeadersIteratorPrototype, Symbol.toStringTag, {\n\tvalue: 'HeadersIterator',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\n/**\n * Export the Headers object in a form that Node.js can consume.\n *\n * @param   Headers  headers\n * @return  Object\n */\nfunction exportNodeCompatibleHeaders(headers) {\n\tconst obj = Object.assign({ __proto__: null }, headers[MAP]);\n\n\t// http.request() only supports string as Host header. This hack makes\n\t// specifying custom Host header possible.\n\tconst hostHeaderKey = find(headers[MAP], 'Host');\n\tif (hostHeaderKey !== undefined) {\n\t\tobj[hostHeaderKey] = obj[hostHeaderKey][0];\n\t}\n\n\treturn obj;\n}\n\n/**\n * Create a Headers object from an object of headers, ignoring those that do\n * not conform to HTTP grammar productions.\n *\n * @param   Object  obj  Object of headers\n * @return  Headers\n */\nfunction createHeadersLenient(obj) {\n\tconst headers = new Headers();\n\tfor (const name of Object.keys(obj)) {\n\t\tif (invalidTokenRegex.test(name)) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (Array.isArray(obj[name])) {\n\t\t\tfor (const val of obj[name]) {\n\t\t\t\tif (invalidHeaderCharRegex.test(val)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (headers[MAP][name] === undefined) {\n\t\t\t\t\theaders[MAP][name] = [val];\n\t\t\t\t} else {\n\t\t\t\t\theaders[MAP][name].push(val);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (!invalidHeaderCharRegex.test(obj[name])) {\n\t\t\theaders[MAP][name] = [obj[name]];\n\t\t}\n\t}\n\treturn headers;\n}\n\nconst INTERNALS$1 = Symbol('Response internals');\n\n// fix an issue where \"STATUS_CODES\" aren't a named export for node <10\nconst STATUS_CODES = http.STATUS_CODES;\n\n/**\n * Response class\n *\n * @param   Stream  body  Readable stream\n * @param   Object  opts  Response options\n * @return  Void\n */\nclass Response {\n\tconstructor() {\n\t\tlet body = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\t\tlet opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\t\tBody.call(this, body, opts);\n\n\t\tconst status = opts.status || 200;\n\t\tconst headers = new Headers(opts.headers);\n\n\t\tif (body != null && !headers.has('Content-Type')) {\n\t\t\tconst contentType = extractContentType(body);\n\t\t\tif (contentType) {\n\t\t\t\theaders.append('Content-Type', contentType);\n\t\t\t}\n\t\t}\n\n\t\tthis[INTERNALS$1] = {\n\t\t\turl: opts.url,\n\t\t\tstatus,\n\t\t\tstatusText: opts.statusText || STATUS_CODES[status],\n\t\t\theaders,\n\t\t\tcounter: opts.counter\n\t\t};\n\t}\n\n\tget url() {\n\t\treturn this[INTERNALS$1].url || '';\n\t}\n\n\tget status() {\n\t\treturn this[INTERNALS$1].status;\n\t}\n\n\t/**\n  * Convenience property representing if the request ended normally\n  */\n\tget ok() {\n\t\treturn this[INTERNALS$1].status >= 200 && this[INTERNALS$1].status < 300;\n\t}\n\n\tget redirected() {\n\t\treturn this[INTERNALS$1].counter > 0;\n\t}\n\n\tget statusText() {\n\t\treturn this[INTERNALS$1].statusText;\n\t}\n\n\tget headers() {\n\t\treturn this[INTERNALS$1].headers;\n\t}\n\n\t/**\n  * Clone this response\n  *\n  * @return  Response\n  */\n\tclone() {\n\t\treturn new Response(clone(this), {\n\t\t\turl: this.url,\n\t\t\tstatus: this.status,\n\t\t\tstatusText: this.statusText,\n\t\t\theaders: this.headers,\n\t\t\tok: this.ok,\n\t\t\tredirected: this.redirected\n\t\t});\n\t}\n}\n\nBody.mixIn(Response.prototype);\n\nObject.defineProperties(Response.prototype, {\n\turl: { enumerable: true },\n\tstatus: { enumerable: true },\n\tok: { enumerable: true },\n\tredirected: { enumerable: true },\n\tstatusText: { enumerable: true },\n\theaders: { enumerable: true },\n\tclone: { enumerable: true }\n});\n\nObject.defineProperty(Response.prototype, Symbol.toStringTag, {\n\tvalue: 'Response',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\nconst INTERNALS$2 = Symbol('Request internals');\nconst URL = whatwgUrl.URL;\n\n// fix an issue where \"format\", \"parse\" aren't a named export for node <10\nconst parse_url = Url.parse;\nconst format_url = Url.format;\n\n/**\n * Wrapper around `new URL` to handle arbitrary URLs\n *\n * @param  {string} urlStr\n * @return {void}\n */\nfunction parseURL(urlStr) {\n\t/*\n \tCheck whether the URL is absolute or not\n \t\tScheme: https://tools.ietf.org/html/rfc3986#section-3.1\n \tAbsolute URL: https://tools.ietf.org/html/rfc3986#section-4.3\n */\n\tif (/^[a-zA-Z][a-zA-Z\\d+\\-.]*:/.exec(urlStr)) {\n\t\turlStr = new URL(urlStr).toString();\n\t}\n\n\t// Fallback to old implementation for arbitrary URLs\n\treturn parse_url(urlStr);\n}\n\nconst streamDestructionSupported = 'destroy' in Stream.Readable.prototype;\n\n/**\n * Check if a value is an instance of Request.\n *\n * @param   Mixed   input\n * @return  Boolean\n */\nfunction isRequest(input) {\n\treturn typeof input === 'object' && typeof input[INTERNALS$2] === 'object';\n}\n\nfunction isAbortSignal(signal) {\n\tconst proto = signal && typeof signal === 'object' && Object.getPrototypeOf(signal);\n\treturn !!(proto && proto.constructor.name === 'AbortSignal');\n}\n\n/**\n * Request class\n *\n * @param   Mixed   input  Url or Request instance\n * @param   Object  init   Custom options\n * @return  Void\n */\nclass Request {\n\tconstructor(input) {\n\t\tlet init = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\t\tlet parsedURL;\n\n\t\t// normalize input\n\t\tif (!isRequest(input)) {\n\t\t\tif (input && input.href) {\n\t\t\t\t// in order to support Node.js' Url objects; though WHATWG's URL objects\n\t\t\t\t// will fall into this branch also (since their `toString()` will return\n\t\t\t\t// `href` property anyway)\n\t\t\t\tparsedURL = parseURL(input.href);\n\t\t\t} else {\n\t\t\t\t// coerce input to a string before attempting to parse\n\t\t\t\tparsedURL = parseURL(`${input}`);\n\t\t\t}\n\t\t\tinput = {};\n\t\t} else {\n\t\t\tparsedURL = parseURL(input.url);\n\t\t}\n\n\t\tlet method = init.method || input.method || 'GET';\n\t\tmethod = method.toUpperCase();\n\n\t\tif ((init.body != null || isRequest(input) && input.body !== null) && (method === 'GET' || method === 'HEAD')) {\n\t\t\tthrow new TypeError('Request with GET/HEAD method cannot have body');\n\t\t}\n\n\t\tlet inputBody = init.body != null ? init.body : isRequest(input) && input.body !== null ? clone(input) : null;\n\n\t\tBody.call(this, inputBody, {\n\t\t\ttimeout: init.timeout || input.timeout || 0,\n\t\t\tsize: init.size || input.size || 0\n\t\t});\n\n\t\tconst headers = new Headers(init.headers || input.headers || {});\n\n\t\tif (inputBody != null && !headers.has('Content-Type')) {\n\t\t\tconst contentType = extractContentType(inputBody);\n\t\t\tif (contentType) {\n\t\t\t\theaders.append('Content-Type', contentType);\n\t\t\t}\n\t\t}\n\n\t\tlet signal = isRequest(input) ? input.signal : null;\n\t\tif ('signal' in init) signal = init.signal;\n\n\t\tif (signal != null && !isAbortSignal(signal)) {\n\t\t\tthrow new TypeError('Expected signal to be an instanceof AbortSignal');\n\t\t}\n\n\t\tthis[INTERNALS$2] = {\n\t\t\tmethod,\n\t\t\tredirect: init.redirect || input.redirect || 'follow',\n\t\t\theaders,\n\t\t\tparsedURL,\n\t\t\tsignal\n\t\t};\n\n\t\t// node-fetch-only options\n\t\tthis.follow = init.follow !== undefined ? init.follow : input.follow !== undefined ? input.follow : 20;\n\t\tthis.compress = init.compress !== undefined ? init.compress : input.compress !== undefined ? input.compress : true;\n\t\tthis.counter = init.counter || input.counter || 0;\n\t\tthis.agent = init.agent || input.agent;\n\t}\n\n\tget method() {\n\t\treturn this[INTERNALS$2].method;\n\t}\n\n\tget url() {\n\t\treturn format_url(this[INTERNALS$2].parsedURL);\n\t}\n\n\tget headers() {\n\t\treturn this[INTERNALS$2].headers;\n\t}\n\n\tget redirect() {\n\t\treturn this[INTERNALS$2].redirect;\n\t}\n\n\tget signal() {\n\t\treturn this[INTERNALS$2].signal;\n\t}\n\n\t/**\n  * Clone this request\n  *\n  * @return  Request\n  */\n\tclone() {\n\t\treturn new Request(this);\n\t}\n}\n\nBody.mixIn(Request.prototype);\n\nObject.defineProperty(Request.prototype, Symbol.toStringTag, {\n\tvalue: 'Request',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\nObject.defineProperties(Request.prototype, {\n\tmethod: { enumerable: true },\n\turl: { enumerable: true },\n\theaders: { enumerable: true },\n\tredirect: { enumerable: true },\n\tclone: { enumerable: true },\n\tsignal: { enumerable: true }\n});\n\n/**\n * Convert a Request to Node.js http request options.\n *\n * @param   Request  A Request instance\n * @return  Object   The options object to be passed to http.request\n */\nfunction getNodeRequestOptions(request) {\n\tconst parsedURL = request[INTERNALS$2].parsedURL;\n\tconst headers = new Headers(request[INTERNALS$2].headers);\n\n\t// fetch step 1.3\n\tif (!headers.has('Accept')) {\n\t\theaders.set('Accept', '*/*');\n\t}\n\n\t// Basic fetch\n\tif (!parsedURL.protocol || !parsedURL.hostname) {\n\t\tthrow new TypeError('Only absolute URLs are supported');\n\t}\n\n\tif (!/^https?:$/.test(parsedURL.protocol)) {\n\t\tthrow new TypeError('Only HTTP(S) protocols are supported');\n\t}\n\n\tif (request.signal && request.body instanceof Stream.Readable && !streamDestructionSupported) {\n\t\tthrow new Error('Cancellation of streamed requests with AbortSignal is not supported in node < 8');\n\t}\n\n\t// HTTP-network-or-cache fetch steps 2.4-2.7\n\tlet contentLengthValue = null;\n\tif (request.body == null && /^(POST|PUT)$/i.test(request.method)) {\n\t\tcontentLengthValue = '0';\n\t}\n\tif (request.body != null) {\n\t\tconst totalBytes = getTotalBytes(request);\n\t\tif (typeof totalBytes === 'number') {\n\t\t\tcontentLengthValue = String(totalBytes);\n\t\t}\n\t}\n\tif (contentLengthValue) {\n\t\theaders.set('Content-Length', contentLengthValue);\n\t}\n\n\t// HTTP-network-or-cache fetch step 2.11\n\tif (!headers.has('User-Agent')) {\n\t\theaders.set('User-Agent', 'node-fetch/1.0 (+https://github.com/bitinn/node-fetch)');\n\t}\n\n\t// HTTP-network-or-cache fetch step 2.15\n\tif (request.compress && !headers.has('Accept-Encoding')) {\n\t\theaders.set('Accept-Encoding', 'gzip,deflate');\n\t}\n\n\tlet agent = request.agent;\n\tif (typeof agent === 'function') {\n\t\tagent = agent(parsedURL);\n\t}\n\n\tif (!headers.has('Connection') && !agent) {\n\t\theaders.set('Connection', 'close');\n\t}\n\n\t// HTTP-network fetch step 4.2\n\t// chunked encoding is handled by Node.js\n\n\treturn Object.assign({}, parsedURL, {\n\t\tmethod: request.method,\n\t\theaders: exportNodeCompatibleHeaders(headers),\n\t\tagent\n\t});\n}\n\n/**\n * abort-error.js\n *\n * AbortError interface for cancelled requests\n */\n\n/**\n * Create AbortError instance\n *\n * @param   String      message      Error message for human\n * @return  AbortError\n */\nfunction AbortError(message) {\n  Error.call(this, message);\n\n  this.type = 'aborted';\n  this.message = message;\n\n  // hide custom error implementation details from end-users\n  Error.captureStackTrace(this, this.constructor);\n}\n\nAbortError.prototype = Object.create(Error.prototype);\nAbortError.prototype.constructor = AbortError;\nAbortError.prototype.name = 'AbortError';\n\n// fix an issue where \"PassThrough\", \"resolve\" aren't a named export for node <10\nconst PassThrough$1 = Stream.PassThrough;\nconst resolve_url = Url.resolve;\n\n/**\n * Fetch function\n *\n * @param   Mixed    url   Absolute url or Request instance\n * @param   Object   opts  Fetch options\n * @return  Promise\n */\nfunction fetch(url, opts) {\n\n\t// allow custom promise\n\tif (!fetch.Promise) {\n\t\tthrow new Error('native promise missing, set fetch.Promise to your favorite alternative');\n\t}\n\n\tBody.Promise = fetch.Promise;\n\n\t// wrap http.request into fetch\n\treturn new fetch.Promise(function (resolve, reject) {\n\t\t// build request object\n\t\tconst request = new Request(url, opts);\n\t\tconst options = getNodeRequestOptions(request);\n\n\t\tconst send = (options.protocol === 'https:' ? https : http).request;\n\t\tconst signal = request.signal;\n\n\t\tlet response = null;\n\n\t\tconst abort = function abort() {\n\t\t\tlet error = new AbortError('The user aborted a request.');\n\t\t\treject(error);\n\t\t\tif (request.body && request.body instanceof Stream.Readable) {\n\t\t\t\trequest.body.destroy(error);\n\t\t\t}\n\t\t\tif (!response || !response.body) return;\n\t\t\tresponse.body.emit('error', error);\n\t\t};\n\n\t\tif (signal && signal.aborted) {\n\t\t\tabort();\n\t\t\treturn;\n\t\t}\n\n\t\tconst abortAndFinalize = function abortAndFinalize() {\n\t\t\tabort();\n\t\t\tfinalize();\n\t\t};\n\n\t\t// send request\n\t\tconst req = send(options);\n\t\tlet reqTimeout;\n\n\t\tif (signal) {\n\t\t\tsignal.addEventListener('abort', abortAndFinalize);\n\t\t}\n\n\t\tfunction finalize() {\n\t\t\treq.abort();\n\t\t\tif (signal) signal.removeEventListener('abort', abortAndFinalize);\n\t\t\tclearTimeout(reqTimeout);\n\t\t}\n\n\t\tif (request.timeout) {\n\t\t\treq.once('socket', function (socket) {\n\t\t\t\treqTimeout = setTimeout(function () {\n\t\t\t\t\treject(new FetchError(`network timeout at: ${request.url}`, 'request-timeout'));\n\t\t\t\t\tfinalize();\n\t\t\t\t}, request.timeout);\n\t\t\t});\n\t\t}\n\n\t\treq.on('error', function (err) {\n\t\t\treject(new FetchError(`request to ${request.url} failed, reason: ${err.message}`, 'system', err));\n\t\t\tfinalize();\n\t\t});\n\n\t\treq.on('response', function (res) {\n\t\t\tclearTimeout(reqTimeout);\n\n\t\t\tconst headers = createHeadersLenient(res.headers);\n\n\t\t\t// HTTP fetch step 5\n\t\t\tif (fetch.isRedirect(res.statusCode)) {\n\t\t\t\t// HTTP fetch step 5.2\n\t\t\t\tconst location = headers.get('Location');\n\n\t\t\t\t// HTTP fetch step 5.3\n\t\t\t\tconst locationURL = location === null ? null : resolve_url(request.url, location);\n\n\t\t\t\t// HTTP fetch step 5.5\n\t\t\t\tswitch (request.redirect) {\n\t\t\t\t\tcase 'error':\n\t\t\t\t\t\treject(new FetchError(`uri requested responds with a redirect, redirect mode is set to error: ${request.url}`, 'no-redirect'));\n\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\treturn;\n\t\t\t\t\tcase 'manual':\n\t\t\t\t\t\t// node-fetch-specific step: make manual redirect a bit easier to use by setting the Location header value to the resolved URL.\n\t\t\t\t\t\tif (locationURL !== null) {\n\t\t\t\t\t\t\t// handle corrupted header\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\theaders.set('Location', locationURL);\n\t\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\t\t// istanbul ignore next: nodejs server prevent invalid response headers, we can't test this through normal request\n\t\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'follow':\n\t\t\t\t\t\t// HTTP-redirect fetch step 2\n\t\t\t\t\t\tif (locationURL === null) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 5\n\t\t\t\t\t\tif (request.counter >= request.follow) {\n\t\t\t\t\t\t\treject(new FetchError(`maximum redirect reached at: ${request.url}`, 'max-redirect'));\n\t\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 6 (counter increment)\n\t\t\t\t\t\t// Create a new Request object.\n\t\t\t\t\t\tconst requestOpts = {\n\t\t\t\t\t\t\theaders: new Headers(request.headers),\n\t\t\t\t\t\t\tfollow: request.follow,\n\t\t\t\t\t\t\tcounter: request.counter + 1,\n\t\t\t\t\t\t\tagent: request.agent,\n\t\t\t\t\t\t\tcompress: request.compress,\n\t\t\t\t\t\t\tmethod: request.method,\n\t\t\t\t\t\t\tbody: request.body,\n\t\t\t\t\t\t\tsignal: request.signal,\n\t\t\t\t\t\t\ttimeout: request.timeout,\n\t\t\t\t\t\t\tsize: request.size\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 9\n\t\t\t\t\t\tif (res.statusCode !== 303 && request.body && getTotalBytes(request) === null) {\n\t\t\t\t\t\t\treject(new FetchError('Cannot follow redirect with body being a readable stream', 'unsupported-redirect'));\n\t\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 11\n\t\t\t\t\t\tif (res.statusCode === 303 || (res.statusCode === 301 || res.statusCode === 302) && request.method === 'POST') {\n\t\t\t\t\t\t\trequestOpts.method = 'GET';\n\t\t\t\t\t\t\trequestOpts.body = undefined;\n\t\t\t\t\t\t\trequestOpts.headers.delete('content-length');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 15\n\t\t\t\t\t\tresolve(fetch(new Request(locationURL, requestOpts)));\n\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// prepare response\n\t\t\tres.once('end', function () {\n\t\t\t\tif (signal) signal.removeEventListener('abort', abortAndFinalize);\n\t\t\t});\n\t\t\tlet body = res.pipe(new PassThrough$1());\n\n\t\t\tconst response_options = {\n\t\t\t\turl: request.url,\n\t\t\t\tstatus: res.statusCode,\n\t\t\t\tstatusText: res.statusMessage,\n\t\t\t\theaders: headers,\n\t\t\t\tsize: request.size,\n\t\t\t\ttimeout: request.timeout,\n\t\t\t\tcounter: request.counter\n\t\t\t};\n\n\t\t\t// HTTP-network fetch step 12.1.1.3\n\t\t\tconst codings = headers.get('Content-Encoding');\n\n\t\t\t// HTTP-network fetch step 12.1.1.4: handle content codings\n\n\t\t\t// in following scenarios we ignore compression support\n\t\t\t// 1. compression support is disabled\n\t\t\t// 2. HEAD request\n\t\t\t// 3. no Content-Encoding header\n\t\t\t// 4. no content response (204)\n\t\t\t// 5. content not modified response (304)\n\t\t\tif (!request.compress || request.method === 'HEAD' || codings === null || res.statusCode === 204 || res.statusCode === 304) {\n\t\t\t\tresponse = new Response(body, response_options);\n\t\t\t\tresolve(response);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// For Node v6+\n\t\t\t// Be less strict when decoding compressed responses, since sometimes\n\t\t\t// servers send slightly invalid responses that are still accepted\n\t\t\t// by common browsers.\n\t\t\t// Always using Z_SYNC_FLUSH is what cURL does.\n\t\t\tconst zlibOptions = {\n\t\t\t\tflush: zlib.Z_SYNC_FLUSH,\n\t\t\t\tfinishFlush: zlib.Z_SYNC_FLUSH\n\t\t\t};\n\n\t\t\t// for gzip\n\t\t\tif (codings == 'gzip' || codings == 'x-gzip') {\n\t\t\t\tbody = body.pipe(zlib.createGunzip(zlibOptions));\n\t\t\t\tresponse = new Response(body, response_options);\n\t\t\t\tresolve(response);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// for deflate\n\t\t\tif (codings == 'deflate' || codings == 'x-deflate') {\n\t\t\t\t// handle the infamous raw deflate response from old servers\n\t\t\t\t// a hack for old IIS and Apache servers\n\t\t\t\tconst raw = res.pipe(new PassThrough$1());\n\t\t\t\traw.once('data', function (chunk) {\n\t\t\t\t\t// see http://stackoverflow.com/questions/37519828\n\t\t\t\t\tif ((chunk[0] & 0x0F) === 0x08) {\n\t\t\t\t\t\tbody = body.pipe(zlib.createInflate());\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbody = body.pipe(zlib.createInflateRaw());\n\t\t\t\t\t}\n\t\t\t\t\tresponse = new Response(body, response_options);\n\t\t\t\t\tresolve(response);\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// for br\n\t\t\tif (codings == 'br' && typeof zlib.createBrotliDecompress === 'function') {\n\t\t\t\tbody = body.pipe(zlib.createBrotliDecompress());\n\t\t\t\tresponse = new Response(body, response_options);\n\t\t\t\tresolve(response);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// otherwise, use response as-is\n\t\t\tresponse = new Response(body, response_options);\n\t\t\tresolve(response);\n\t\t});\n\n\t\twriteToStream(req, request);\n\t});\n}\n/**\n * Redirect code matching\n *\n * @param   Number   code  Status code\n * @return  Boolean\n */\nfetch.isRedirect = function (code) {\n\treturn code === 301 || code === 302 || code === 303 || code === 307 || code === 308;\n};\n\n// expose Promise\nfetch.Promise = global.Promise;\n\nexport default fetch;\nexport { Headers, Request, Response, FetchError };\n","class Deprecation extends Error {\n  constructor(message) {\n    super(message); // Maintains proper stack trace (only available on V8)\n\n    /* istanbul ignore next */\n\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, this.constructor);\n    }\n\n    this.name = 'Deprecation';\n  }\n\n}\n\nexport { Deprecation };\n","import { Deprecation } from 'deprecation';\nimport once from 'once';\n\nconst logOnceCode = once((deprecation) => console.warn(deprecation));\nconst logOnceHeaders = once((deprecation) => console.warn(deprecation));\n/**\n * Error with extra properties to help with debugging\n */\nclass RequestError extends Error {\n    constructor(message, statusCode, options) {\n        super(message);\n        // Maintains proper stack trace (only available on V8)\n        /* istanbul ignore next */\n        if (Error.captureStackTrace) {\n            Error.captureStackTrace(this, this.constructor);\n        }\n        this.name = \"HttpError\";\n        this.status = statusCode;\n        let headers;\n        if (\"headers\" in options && typeof options.headers !== \"undefined\") {\n            headers = options.headers;\n        }\n        if (\"response\" in options) {\n            this.response = options.response;\n            headers = options.response.headers;\n        }\n        // redact request credentials without mutating original request options\n        const requestCopy = Object.assign({}, options.request);\n        if (options.request.headers.authorization) {\n            requestCopy.headers = Object.assign({}, options.request.headers, {\n                authorization: options.request.headers.authorization.replace(/ .*$/, \" [REDACTED]\"),\n            });\n        }\n        requestCopy.url = requestCopy.url\n            // client_id & client_secret can be passed as URL query parameters to increase rate limit\n            // see https://developer.github.com/v3/#increasing-the-unauthenticated-rate-limit-for-oauth-applications\n            .replace(/\\bclient_secret=\\w+/g, \"client_secret=[REDACTED]\")\n            // OAuth tokens can be passed as URL query parameters, although it is not recommended\n            // see https://developer.github.com/v3/#oauth2-token-sent-in-a-header\n            .replace(/\\baccess_token=\\w+/g, \"access_token=[REDACTED]\");\n        this.request = requestCopy;\n        // deprecations\n        Object.defineProperty(this, \"code\", {\n            get() {\n                logOnceCode(new Deprecation(\"[@octokit/request-error] `error.code` is deprecated, use `error.status`.\"));\n                return statusCode;\n            },\n        });\n        Object.defineProperty(this, \"headers\", {\n            get() {\n                logOnceHeaders(new Deprecation(\"[@octokit/request-error] `error.headers` is deprecated, use `error.response.headers`.\"));\n                return headers || {};\n            },\n        });\n    }\n}\n\nexport { RequestError };\n//# sourceMappingURL=index.js.map\n","import { endpoint } from '@octokit/endpoint';\nimport { getUserAgent } from 'universal-user-agent';\nimport { isPlainObject } from 'is-plain-object';\nimport nodeFetch from 'node-fetch';\nimport { RequestError } from '@octokit/request-error';\n\nconst VERSION = \"5.6.2\";\n\nfunction getBufferResponse(response) {\n    return response.arrayBuffer();\n}\n\nfunction fetchWrapper(requestOptions) {\n    const log = requestOptions.request && requestOptions.request.log\n        ? requestOptions.request.log\n        : console;\n    if (isPlainObject(requestOptions.body) ||\n        Array.isArray(requestOptions.body)) {\n        requestOptions.body = JSON.stringify(requestOptions.body);\n    }\n    let headers = {};\n    let status;\n    let url;\n    const fetch = (requestOptions.request && requestOptions.request.fetch) || nodeFetch;\n    return fetch(requestOptions.url, Object.assign({\n        method: requestOptions.method,\n        body: requestOptions.body,\n        headers: requestOptions.headers,\n        redirect: requestOptions.redirect,\n    }, \n    // `requestOptions.request.agent` type is incompatible\n    // see https://github.com/octokit/types.ts/pull/264\n    requestOptions.request))\n        .then(async (response) => {\n        url = response.url;\n        status = response.status;\n        for (const keyAndValue of response.headers) {\n            headers[keyAndValue[0]] = keyAndValue[1];\n        }\n        if (\"deprecation\" in headers) {\n            const matches = headers.link && headers.link.match(/<([^>]+)>; rel=\"deprecation\"/);\n            const deprecationLink = matches && matches.pop();\n            log.warn(`[@octokit/request] \"${requestOptions.method} ${requestOptions.url}\" is deprecated. It is scheduled to be removed on ${headers.sunset}${deprecationLink ? `. See ${deprecationLink}` : \"\"}`);\n        }\n        if (status === 204 || status === 205) {\n            return;\n        }\n        // GitHub API returns 200 for HEAD requests\n        if (requestOptions.method === \"HEAD\") {\n            if (status < 400) {\n                return;\n            }\n            throw new RequestError(response.statusText, status, {\n                response: {\n                    url,\n                    status,\n                    headers,\n                    data: undefined,\n                },\n                request: requestOptions,\n            });\n        }\n        if (status === 304) {\n            throw new RequestError(\"Not modified\", status, {\n                response: {\n                    url,\n                    status,\n                    headers,\n                    data: await getResponseData(response),\n                },\n                request: requestOptions,\n            });\n        }\n        if (status >= 400) {\n            const data = await getResponseData(response);\n            const error = new RequestError(toErrorMessage(data), status, {\n                response: {\n                    url,\n                    status,\n                    headers,\n                    data,\n                },\n                request: requestOptions,\n            });\n            throw error;\n        }\n        return getResponseData(response);\n    })\n        .then((data) => {\n        return {\n            status,\n            url,\n            headers,\n            data,\n        };\n    })\n        .catch((error) => {\n        if (error instanceof RequestError)\n            throw error;\n        throw new RequestError(error.message, 500, {\n            request: requestOptions,\n        });\n    });\n}\nasync function getResponseData(response) {\n    const contentType = response.headers.get(\"content-type\");\n    if (/application\\/json/.test(contentType)) {\n        return response.json();\n    }\n    if (!contentType || /^text\\/|charset=utf-8$/.test(contentType)) {\n        return response.text();\n    }\n    return getBufferResponse(response);\n}\nfunction toErrorMessage(data) {\n    if (typeof data === \"string\")\n        return data;\n    // istanbul ignore else - just in case\n    if (\"message\" in data) {\n        if (Array.isArray(data.errors)) {\n            return `${data.message}: ${data.errors.map(JSON.stringify).join(\", \")}`;\n        }\n        return data.message;\n    }\n    // istanbul ignore next - just in case\n    return `Unknown error: ${JSON.stringify(data)}`;\n}\n\nfunction withDefaults(oldEndpoint, newDefaults) {\n    const endpoint = oldEndpoint.defaults(newDefaults);\n    const newApi = function (route, parameters) {\n        const endpointOptions = endpoint.merge(route, parameters);\n        if (!endpointOptions.request || !endpointOptions.request.hook) {\n            return fetchWrapper(endpoint.parse(endpointOptions));\n        }\n        const request = (route, parameters) => {\n            return fetchWrapper(endpoint.parse(endpoint.merge(route, parameters)));\n        };\n        Object.assign(request, {\n            endpoint,\n            defaults: withDefaults.bind(null, endpoint),\n        });\n        return endpointOptions.request.hook(request, endpointOptions);\n    };\n    return Object.assign(newApi, {\n        endpoint,\n        defaults: withDefaults.bind(null, endpoint),\n    });\n}\n\nconst request = withDefaults(endpoint, {\n    headers: {\n        \"user-agent\": `octokit-request.js/${VERSION} ${getUserAgent()}`,\n    },\n});\n\nexport { request };\n//# sourceMappingURL=index.js.map\n","import { request } from '@octokit/request';\nimport { getUserAgent } from 'universal-user-agent';\n\nconst VERSION = \"4.6.4\";\n\nclass GraphqlError extends Error {\n    constructor(request, response) {\n        const message = response.data.errors[0].message;\n        super(message);\n        Object.assign(this, response.data);\n        Object.assign(this, { headers: response.headers });\n        this.name = \"GraphqlError\";\n        this.request = request;\n        // Maintains proper stack trace (only available on V8)\n        /* istanbul ignore next */\n        if (Error.captureStackTrace) {\n            Error.captureStackTrace(this, this.constructor);\n        }\n    }\n}\n\nconst NON_VARIABLE_OPTIONS = [\n    \"method\",\n    \"baseUrl\",\n    \"url\",\n    \"headers\",\n    \"request\",\n    \"query\",\n    \"mediaType\",\n];\nconst FORBIDDEN_VARIABLE_OPTIONS = [\"query\", \"method\", \"url\"];\nconst GHES_V3_SUFFIX_REGEX = /\\/api\\/v3\\/?$/;\nfunction graphql(request, query, options) {\n    if (options) {\n        if (typeof query === \"string\" && \"query\" in options) {\n            return Promise.reject(new Error(`[@octokit/graphql] \"query\" cannot be used as variable name`));\n        }\n        for (const key in options) {\n            if (!FORBIDDEN_VARIABLE_OPTIONS.includes(key))\n                continue;\n            return Promise.reject(new Error(`[@octokit/graphql] \"${key}\" cannot be used as variable name`));\n        }\n    }\n    const parsedOptions = typeof query === \"string\" ? Object.assign({ query }, options) : query;\n    const requestOptions = Object.keys(parsedOptions).reduce((result, key) => {\n        if (NON_VARIABLE_OPTIONS.includes(key)) {\n            result[key] = parsedOptions[key];\n            return result;\n        }\n        if (!result.variables) {\n            result.variables = {};\n        }\n        result.variables[key] = parsedOptions[key];\n        return result;\n    }, {});\n    // workaround for GitHub Enterprise baseUrl set with /api/v3 suffix\n    // https://github.com/octokit/auth-app.js/issues/111#issuecomment-657610451\n    const baseUrl = parsedOptions.baseUrl || request.endpoint.DEFAULTS.baseUrl;\n    if (GHES_V3_SUFFIX_REGEX.test(baseUrl)) {\n        requestOptions.url = baseUrl.replace(GHES_V3_SUFFIX_REGEX, \"/api/graphql\");\n    }\n    return request(requestOptions).then((response) => {\n        if (response.data.errors) {\n            const headers = {};\n            for (const key of Object.keys(response.headers)) {\n                headers[key] = response.headers[key];\n            }\n            throw new GraphqlError(requestOptions, {\n                headers,\n                data: response.data,\n            });\n        }\n        return response.data.data;\n    });\n}\n\nfunction withDefaults(request$1, newDefaults) {\n    const newRequest = request$1.defaults(newDefaults);\n    const newApi = (query, options) => {\n        return graphql(newRequest, query, options);\n    };\n    return Object.assign(newApi, {\n        defaults: withDefaults.bind(null, newRequest),\n        endpoint: request.endpoint,\n    });\n}\n\nconst graphql$1 = withDefaults(request, {\n    headers: {\n        \"user-agent\": `octokit-graphql.js/${VERSION} ${getUserAgent()}`,\n    },\n    method: \"POST\",\n    url: \"/graphql\",\n});\nfunction withCustomRequest(customRequest) {\n    return withDefaults(customRequest, {\n        method: \"POST\",\n        url: \"/graphql\",\n    });\n}\n\nexport { graphql$1 as graphql, withCustomRequest };\n//# sourceMappingURL=index.js.map\n","'use strict';\nimport { graphql } from '@octokit/graphql';\nimport {\n\tAuthenticationError,\n\tClientError,\n\tDefaultBranch,\n\tIssueOrPullRequest,\n\tPullRequest,\n\tPullRequestState,\n\tRichRemoteProvider,\n} from '../git/git';\nimport { Account } from '../git/models/author';\nimport { Logger } from '../logger';\nimport { debug } from '../system';\n\nexport class GitHubApi {\n\t@debug({\n\t\targs: {\n\t\t\t0: (p: RichRemoteProvider) => p.name,\n\t\t\t1: _ => '<token>',\n\t\t},\n\t})\n\tasync getAccountForCommit(\n\t\tprovider: RichRemoteProvider,\n\t\ttoken: string,\n\t\towner: string,\n\t\trepo: string,\n\t\tref: string,\n\t\toptions?: {\n\t\t\tbaseUrl?: string;\n\t\t\tavatarSize?: number;\n\t\t},\n\t): Promise<Account | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tinterface QueryResult {\n\t\t\trepository:\n\t\t\t\t| {\n\t\t\t\t\t\tobject:\n\t\t\t\t\t\t\t| {\n\t\t\t\t\t\t\t\t\tauthor?: {\n\t\t\t\t\t\t\t\t\t\tname: string | null;\n\t\t\t\t\t\t\t\t\t\temail: string | null;\n\t\t\t\t\t\t\t\t\t\tavatarUrl: string;\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t| null\n\t\t\t\t\t\t\t| undefined;\n\t\t\t\t  }\n\t\t\t\t| null\n\t\t\t\t| undefined;\n\t\t}\n\n\t\ttry {\n\t\t\tconst query = `query getAccountForCommit(\n\t$owner: String!\n\t$repo: String!\n\t$ref: GitObjectID!\n\t$avatarSize: Int\n) {\n\trepository(name: $repo, owner: $owner) {\n\t\tobject(oid: $ref) {\n\t\t\t... on Commit {\n\t\t\t\tauthor {\n\t\t\t\t\tname\n\t\t\t\t\temail\n\t\t\t\t\tavatarUrl(size: $avatarSize)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}`;\n\n\t\t\tconst rsp = await graphql<QueryResult>(query, {\n\t\t\t\t...options,\n\t\t\t\theaders: { authorization: `Bearer ${token}` },\n\t\t\t\towner: owner,\n\t\t\t\trepo: repo,\n\t\t\t\tref: ref,\n\t\t\t});\n\n\t\t\tconst author = rsp?.repository?.object?.author;\n\t\t\tif (author == null) return undefined;\n\n\t\t\treturn {\n\t\t\t\tprovider: provider,\n\t\t\t\tname: author.name ?? undefined,\n\t\t\t\temail: author.email ?? undefined,\n\t\t\t\tavatarUrl: author.avatarUrl,\n\t\t\t};\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\n\t\t\tif (ex.code >= 400 && ex.code <= 500) {\n\t\t\t\tif (ex.code === 401) throw new AuthenticationError(ex);\n\t\t\t\tthrow new ClientError(ex);\n\t\t\t}\n\t\t\tthrow ex;\n\t\t}\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (p: RichRemoteProvider) => p.name,\n\t\t\t1: _ => '<token>',\n\t\t},\n\t})\n\tasync getAccountForEmail(\n\t\tprovider: RichRemoteProvider,\n\t\ttoken: string,\n\t\towner: string,\n\t\trepo: string,\n\t\temail: string,\n\t\toptions?: {\n\t\t\tbaseUrl?: string;\n\t\t\tavatarSize?: number;\n\t\t},\n\t): Promise<Account | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tinterface QueryResult {\n\t\t\tsearch:\n\t\t\t\t| {\n\t\t\t\t\t\tnodes:\n\t\t\t\t\t\t\t| {\n\t\t\t\t\t\t\t\t\tname: string | null;\n\t\t\t\t\t\t\t\t\temail: string | null;\n\t\t\t\t\t\t\t\t\tavatarUrl: string;\n\t\t\t\t\t\t\t  }[]\n\t\t\t\t\t\t\t| null\n\t\t\t\t\t\t\t| undefined;\n\t\t\t\t  }\n\t\t\t\t| null\n\t\t\t\t| undefined;\n\t\t}\n\n\t\ttry {\n\t\t\tconst query = `query getAccountForEmail(\n\t$emailQuery: String!\n\t$avatarSize: Int\n) {\n\tsearch(type: USER, query: $emailQuery, first: 1) {\n\t\tnodes {\n\t\t\t... on User {\n\t\t\t\tname\n\t\t\t\temail\n\t\t\t\tavatarUrl(size: $avatarSize)\n\t\t\t}\n\t\t}\n\t}\n}`;\n\n\t\t\tconst rsp = await graphql<QueryResult>(query, {\n\t\t\t\t...options,\n\t\t\t\theaders: { authorization: `Bearer ${token}` },\n\t\t\t\towner: owner,\n\t\t\t\trepo: repo,\n\t\t\t\temailQuery: `in:email ${email}`,\n\t\t\t});\n\n\t\t\tconst author = rsp?.search?.nodes?.[0];\n\t\t\tif (author == null) return undefined;\n\n\t\t\treturn {\n\t\t\t\tprovider: provider,\n\t\t\t\tname: author.name ?? undefined,\n\t\t\t\temail: author.email ?? undefined,\n\t\t\t\tavatarUrl: author.avatarUrl,\n\t\t\t};\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\n\t\t\tif (ex.code >= 400 && ex.code <= 500) {\n\t\t\t\tif (ex.code === 401) throw new AuthenticationError(ex);\n\t\t\t\tthrow new ClientError(ex);\n\t\t\t}\n\t\t\tthrow ex;\n\t\t}\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (p: RichRemoteProvider) => p.name,\n\t\t\t1: _ => '<token>',\n\t\t},\n\t})\n\tasync getDefaultBranch(\n\t\tprovider: RichRemoteProvider,\n\t\ttoken: string,\n\t\towner: string,\n\t\trepo: string,\n\t\toptions?: {\n\t\t\tbaseUrl?: string;\n\t\t},\n\t): Promise<DefaultBranch | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tinterface QueryResult {\n\t\t\trepository: {\n\t\t\t\tdefaultBranchRef: {\n\t\t\t\t\tname: string;\n\t\t\t\t} | null;\n\t\t\t} | null;\n\t\t}\n\n\t\ttry {\n\t\t\tconst query = `query getDefaultBranch(\n\t$owner: String!\n\t$repo: String!\n) {\n\trepository(name: $repo, owner: $owner) {\n\t\tdefaultBranchRef {\n\t\t\tname\n\t\t}\n\t}\n}`;\n\n\t\t\tconst rsp = await graphql<QueryResult>(query, {\n\t\t\t\t...options,\n\t\t\t\theaders: { authorization: `Bearer ${token}` },\n\t\t\t\towner: owner,\n\t\t\t\trepo: repo,\n\t\t\t});\n\n\t\t\tconst defaultBranch = rsp?.repository?.defaultBranchRef?.name ?? undefined;\n\t\t\tif (defaultBranch == null) return undefined;\n\n\t\t\treturn {\n\t\t\t\tprovider: provider,\n\t\t\t\tname: defaultBranch,\n\t\t\t};\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\n\t\t\tif (ex.code >= 400 && ex.code <= 500) {\n\t\t\t\tif (ex.code === 401) throw new AuthenticationError(ex);\n\t\t\t\tthrow new ClientError(ex);\n\t\t\t}\n\t\t\tthrow ex;\n\t\t}\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (p: RichRemoteProvider) => p.name,\n\t\t\t1: _ => '<token>',\n\t\t},\n\t})\n\tasync getIssueOrPullRequest(\n\t\tprovider: RichRemoteProvider,\n\t\ttoken: string,\n\t\towner: string,\n\t\trepo: string,\n\t\tnumber: number,\n\t\toptions?: {\n\t\t\tbaseUrl?: string;\n\t\t},\n\t): Promise<IssueOrPullRequest | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tinterface QueryResult {\n\t\t\trepository?: { issueOrPullRequest?: GitHubIssueOrPullRequest };\n\t\t}\n\n\t\ttry {\n\t\t\tconst query = `query getIssueOrPullRequest(\n\t$owner: String!\n\t$repo: String!\n\t$number: Int!\n) {\n\trepository(name: $repo, owner: $owner) {\n\t\tissueOrPullRequest(number: $number) {\n\t\t\t__typename\n\t\t\t... on Issue {\n\t\t\t\tcreatedAt\n\t\t\t\tclosed\n\t\t\t\tclosedAt\n\t\t\t\ttitle\n\t\t\t}\n\t\t\t... on PullRequest {\n\t\t\t\tcreatedAt\n\t\t\t\tclosed\n\t\t\t\tclosedAt\n\t\t\t\ttitle\n\t\t\t}\n\t\t}\n\t}\n}`;\n\n\t\t\tconst rsp = await graphql<QueryResult>(query, {\n\t\t\t\t...options,\n\t\t\t\theaders: { authorization: `Bearer ${token}` },\n\t\t\t\towner: owner,\n\t\t\t\trepo: repo,\n\t\t\t\tnumber: number,\n\t\t\t});\n\n\t\t\tconst issue = rsp?.repository?.issueOrPullRequest;\n\t\t\tif (issue == null) return undefined;\n\n\t\t\treturn {\n\t\t\t\tprovider: provider,\n\t\t\t\ttype: issue.type,\n\t\t\t\tid: number,\n\t\t\t\tdate: new Date(issue.createdAt),\n\t\t\t\ttitle: issue.title,\n\t\t\t\tclosed: issue.closed,\n\t\t\t\tclosedDate: issue.closedAt == null ? undefined : new Date(issue.closedAt),\n\t\t\t};\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\n\t\t\tif (ex.code >= 400 && ex.code <= 500) {\n\t\t\t\tif (ex.code === 401) throw new AuthenticationError(ex);\n\t\t\t\tthrow new ClientError(ex);\n\t\t\t}\n\t\t\tthrow ex;\n\t\t}\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (p: RichRemoteProvider) => p.name,\n\t\t\t1: _ => '<token>',\n\t\t},\n\t})\n\tasync getPullRequestForBranch(\n\t\tprovider: RichRemoteProvider,\n\t\ttoken: string,\n\t\towner: string,\n\t\trepo: string,\n\t\tbranch: string,\n\t\toptions?: {\n\t\t\tbaseUrl?: string;\n\t\t\tavatarSize?: number;\n\t\t\tinclude?: GitHubPullRequestState[];\n\t\t},\n\t): Promise<PullRequest | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tinterface QueryResult {\n\t\t\trepository:\n\t\t\t\t| {\n\t\t\t\t\t\trefs: {\n\t\t\t\t\t\t\tnodes: {\n\t\t\t\t\t\t\t\tassociatedPullRequests?: {\n\t\t\t\t\t\t\t\t\tnodes?: GitHubPullRequest[];\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}[];\n\t\t\t\t\t\t};\n\t\t\t\t  }\n\t\t\t\t| null\n\t\t\t\t| undefined;\n\t\t}\n\n\t\ttry {\n\t\t\tconst query = `query getPullRequestForBranch(\n\t$owner: String!\n\t$repo: String!\n\t$branch: String!\n\t$limit: Int!\n\t$include: [PullRequestState!]\n\t$avatarSize: Int\n) {\n\trepository(name: $repo, owner: $owner) {\n\t\trefs(query: $branch, refPrefix: \"refs/heads/\", first: 1) {\n\t\t\tnodes {\n\t\t\t\tassociatedPullRequests(first: $limit, orderBy: {field: UPDATED_AT, direction: DESC}, states: $include) {\n\t\t\t\t\tnodes {\n\t\t\t\t\t\tauthor {\n\t\t\t\t\t\t\tlogin\n\t\t\t\t\t\t\tavatarUrl(size: $avatarSize)\n\t\t\t\t\t\t\turl\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpermalink\n\t\t\t\t\t\tnumber\n\t\t\t\t\t\ttitle\n\t\t\t\t\t\tstate\n\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t\tclosedAt\n\t\t\t\t\t\tmergedAt\n\t\t\t\t\t\trepository {\n\t\t\t\t\t\t\tisFork\n\t\t\t\t\t\t\towner {\n\t\t\t\t\t\t\t\tlogin\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}`;\n\n\t\t\tconst rsp = await graphql<QueryResult>(query, {\n\t\t\t\t...options,\n\t\t\t\theaders: { authorization: `Bearer ${token}` },\n\t\t\t\towner: owner,\n\t\t\t\trepo: repo,\n\t\t\t\tbranch: branch,\n\t\t\t\t// Since GitHub sort doesn't seem to really work, look for a max of 10 PRs and then sort them ourselves\n\t\t\t\tlimit: 10,\n\t\t\t});\n\n\t\t\t// If the pr is not from a fork, keep it e.g. show root pr's on forks, otherwise, ensure the repo owners match\n\t\t\tconst prs = rsp?.repository?.refs.nodes[0]?.associatedPullRequests?.nodes?.filter(\n\t\t\t\tpr => !pr.repository.isFork || pr.repository.owner.login === owner,\n\t\t\t);\n\t\t\tif (prs == null || prs.length === 0) return undefined;\n\n\t\t\tif (prs.length > 1) {\n\t\t\t\tprs.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t(a.repository.owner.login === owner ? -1 : 1) - (b.repository.owner.login === owner ? -1 : 1) ||\n\t\t\t\t\t\t(a.state === 'OPEN' ? -1 : 1) - (b.state === 'OPEN' ? -1 : 1) ||\n\t\t\t\t\t\tnew Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime(),\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn GitHubPullRequest.from(prs[0], provider);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\n\t\t\tif (ex.code >= 400 && ex.code <= 500) {\n\t\t\t\tif (ex.code === 401) throw new AuthenticationError(ex);\n\t\t\t\tthrow new ClientError(ex);\n\t\t\t}\n\t\t\tthrow ex;\n\t\t}\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (p: RichRemoteProvider) => p.name,\n\t\t\t1: _ => '<token>',\n\t\t},\n\t})\n\tasync getPullRequestForCommit(\n\t\tprovider: RichRemoteProvider,\n\t\ttoken: string,\n\t\towner: string,\n\t\trepo: string,\n\t\tref: string,\n\t\toptions?: {\n\t\t\tbaseUrl?: string;\n\t\t\tavatarSize?: number;\n\t\t},\n\t): Promise<PullRequest | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tinterface QueryResult {\n\t\t\trepository:\n\t\t\t\t| {\n\t\t\t\t\t\tobject?: {\n\t\t\t\t\t\t\tassociatedPullRequests?: {\n\t\t\t\t\t\t\t\tnodes?: GitHubPullRequest[];\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t};\n\t\t\t\t  }\n\t\t\t\t| null\n\t\t\t\t| undefined;\n\t\t}\n\n\t\ttry {\n\t\t\tconst query = `query getPullRequestForCommit(\n\t$owner: String!\n\t$repo: String!\n\t$ref: GitObjectID!\n\t$avatarSize: Int\n) {\n\trepository(name: $repo, owner: $owner) {\n\t\tobject(oid: $ref) {\n\t\t\t... on Commit {\n\t\t\t\tassociatedPullRequests(first: 2, orderBy: {field: UPDATED_AT, direction: DESC}) {\n\t\t\t\t\tnodes {\n\t\t\t\t\t\tauthor {\n\t\t\t\t\t\t\tlogin\n\t\t\t\t\t\t\tavatarUrl(size: $avatarSize)\n\t\t\t\t\t\t\turl\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpermalink\n\t\t\t\t\t\tnumber\n\t\t\t\t\t\ttitle\n\t\t\t\t\t\tstate\n\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t\tclosedAt\n\t\t\t\t\t\tmergedAt\n\t\t\t\t\t\trepository {\n\t\t\t\t\t\t\tisFork\n\t\t\t\t\t\t\towner {\n\t\t\t\t\t\t\t\tlogin\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}`;\n\n\t\t\tconst rsp = await graphql<QueryResult>(query, {\n\t\t\t\t...options,\n\t\t\t\theaders: { authorization: `Bearer ${token}` },\n\t\t\t\towner: owner,\n\t\t\t\trepo: repo,\n\t\t\t\tref: ref,\n\t\t\t});\n\n\t\t\t// If the pr is not from a fork, keep it e.g. show root pr's on forks, otherwise, ensure the repo owners match\n\t\t\tconst prs = rsp?.repository?.object?.associatedPullRequests?.nodes?.filter(\n\t\t\t\tpr => !pr.repository.isFork || pr.repository.owner.login === owner,\n\t\t\t);\n\t\t\tif (prs == null || prs.length === 0) return undefined;\n\n\t\t\tif (prs.length > 1) {\n\t\t\t\tprs.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t(a.repository.owner.login === owner ? -1 : 1) - (b.repository.owner.login === owner ? -1 : 1) ||\n\t\t\t\t\t\t(a.state === 'OPEN' ? -1 : 1) - (b.state === 'OPEN' ? -1 : 1) ||\n\t\t\t\t\t\tnew Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime(),\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn GitHubPullRequest.from(prs[0], provider);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\n\t\t\tif (ex.code >= 400 && ex.code <= 500) {\n\t\t\t\tif (ex.code === 401) throw new AuthenticationError(ex);\n\t\t\t\tthrow new ClientError(ex);\n\t\t\t}\n\t\t\tthrow ex;\n\t\t}\n\t}\n}\n\ninterface GitHubIssueOrPullRequest {\n\ttype: 'Issue' | 'PullRequest';\n\tnumber: number;\n\tcreatedAt: string;\n\tclosed: boolean;\n\tclosedAt: string | null;\n\ttitle: string;\n}\n\ntype GitHubPullRequestState = 'OPEN' | 'CLOSED' | 'MERGED';\n\ninterface GitHubPullRequest {\n\tauthor: {\n\t\tlogin: string;\n\t\tavatarUrl: string;\n\t\turl: string;\n\t};\n\tpermalink: string;\n\tnumber: number;\n\ttitle: string;\n\tstate: GitHubPullRequestState;\n\tupdatedAt: string;\n\tclosedAt: string | null;\n\tmergedAt: string | null;\n\trepository: {\n\t\tisFork: boolean;\n\t\towner: {\n\t\t\tlogin: string;\n\t\t};\n\t};\n}\n\nexport namespace GitHubPullRequest {\n\texport function from(pr: GitHubPullRequest, provider: RichRemoteProvider): PullRequest {\n\t\treturn new PullRequest(\n\t\t\tprovider,\n\t\t\t{\n\t\t\t\tname: pr.author.login,\n\t\t\t\tavatarUrl: pr.author.avatarUrl,\n\t\t\t\turl: pr.author.url,\n\t\t\t},\n\t\t\tString(pr.number),\n\t\t\tpr.title,\n\t\t\tpr.permalink,\n\t\t\tfromState(pr.state),\n\t\t\tnew Date(pr.updatedAt),\n\t\t\tpr.closedAt == null ? undefined : new Date(pr.closedAt),\n\t\t\tpr.mergedAt == null ? undefined : new Date(pr.mergedAt),\n\t\t);\n\t}\n\n\texport function fromState(state: GitHubPullRequestState): PullRequestState {\n\t\treturn state === 'MERGED'\n\t\t\t? PullRequestState.Merged\n\t\t\t: state === 'CLOSED'\n\t\t\t? PullRequestState.Closed\n\t\t\t: PullRequestState.Open;\n\t}\n\n\texport function toState(state: PullRequestState): GitHubPullRequestState {\n\t\treturn state === PullRequestState.Merged ? 'MERGED' : state === PullRequestState.Closed ? 'CLOSED' : 'OPEN';\n\t}\n}\n","'use strict';\nimport { ExtensionContext, ExtensionMode, OutputChannel, Uri, window } from 'vscode';\nimport { TraceLevel } from './configuration';\nimport { getCorrelationContext, getNextCorrelationId } from './system';\n\nconst emptyStr = '';\nconst extensionOutputChannelName = 'GitLens';\nconst ConsolePrefix = '[GitLens]';\n\nconst extensionGitOutputChannelName = 'GitLens (Git)';\nconst GitConsolePrefix = '[GitLens (Git)]';\n\nexport { TraceLevel } from './configuration';\n\nexport interface LogCorrelationContext {\n\treadonly correlationId?: number;\n\treadonly prefix: string;\n\texitDetails?: string;\n}\n\nexport class Logger {\n\tstatic output: OutputChannel | undefined;\n\tstatic customLoggableFn: ((o: object) => string | undefined) | undefined;\n\n\tstatic configure(context: ExtensionContext, level: TraceLevel, loggableFn?: (o: any) => string | undefined) {\n\t\tthis.customLoggableFn = loggableFn;\n\n\t\tthis._isDebugging = context.extensionMode === ExtensionMode.Development;\n\t\tthis.level = level;\n\t}\n\n\tprivate static _isDebugging: boolean;\n\tstatic get isDebugging() {\n\t\treturn this._isDebugging;\n\t}\n\n\tprivate static _level: TraceLevel = TraceLevel.Silent;\n\tstatic get level() {\n\t\treturn this._level;\n\t}\n\tstatic set level(value: TraceLevel) {\n\t\tthis._level = value;\n\t\tif (value === TraceLevel.Silent) {\n\t\t\tif (this.output != null) {\n\t\t\t\tthis.output.dispose();\n\t\t\t\tthis.output = undefined;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.output = this.output ?? window.createOutputChannel(extensionOutputChannelName);\n\t\t}\n\t}\n\n\tstatic debug(message: string, ...params: any[]): void;\n\tstatic debug(context: LogCorrelationContext | undefined, message: string, ...params: any[]): void;\n\tstatic debug(contextOrMessage: LogCorrelationContext | string | undefined, ...params: any[]): void {\n\t\tif (this.level !== TraceLevel.Debug && !Logger.isDebugging) return;\n\n\t\tlet message;\n\t\tif (typeof contextOrMessage === 'string') {\n\t\t\tmessage = contextOrMessage;\n\t\t} else {\n\t\t\tmessage = params.shift();\n\n\t\t\tif (contextOrMessage != null) {\n\t\t\t\tmessage = `${contextOrMessage.prefix} ${message ?? emptyStr}`;\n\t\t\t}\n\t\t}\n\n\t\tif (Logger.isDebugging) {\n\t\t\tconsole.log(this.timestamp, ConsolePrefix, message ?? emptyStr, ...params);\n\t\t}\n\n\t\tif (this.output != null && this.level === TraceLevel.Debug) {\n\t\t\tthis.output.appendLine(`${this.timestamp} ${message ?? emptyStr}${this.toLoggableParams(true, params)}`);\n\t\t}\n\t}\n\n\tstatic error(ex: Error, message?: string, ...params: any[]): void;\n\tstatic error(ex: Error, context?: LogCorrelationContext, message?: string, ...params: any[]): void;\n\tstatic error(ex: Error, contextOrMessage: LogCorrelationContext | string | undefined, ...params: any[]): void {\n\t\tif (this.level === TraceLevel.Silent && !Logger.isDebugging) return;\n\n\t\tlet message;\n\t\tif (contextOrMessage == null || typeof contextOrMessage === 'string') {\n\t\t\tmessage = contextOrMessage;\n\t\t} else {\n\t\t\tmessage = `${contextOrMessage.prefix} ${params.shift() ?? emptyStr}`;\n\t\t}\n\n\t\tif (message == null) {\n\t\t\tconst stack = ex.stack;\n\t\t\tif (stack) {\n\t\t\t\tconst match = /.*\\s*?at\\s(.+?)\\s/.exec(stack);\n\t\t\t\tif (match != null) {\n\t\t\t\t\tmessage = match[1];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (Logger.isDebugging) {\n\t\t\tconsole.error(this.timestamp, ConsolePrefix, message ?? emptyStr, ...params, ex);\n\t\t}\n\n\t\tif (this.output != null && this.level !== TraceLevel.Silent) {\n\t\t\tthis.output.appendLine(\n\t\t\t\t`${this.timestamp} ${message ?? emptyStr}${this.toLoggableParams(false, params)}\\n${ex?.toString()}`,\n\t\t\t);\n\t\t}\n\t}\n\n\tstatic getCorrelationContext() {\n\t\treturn getCorrelationContext();\n\t}\n\n\tstatic getNewCorrelationContext(prefix: string): LogCorrelationContext {\n\t\tconst correlationId = getNextCorrelationId();\n\t\treturn {\n\t\t\tcorrelationId: correlationId,\n\t\t\tprefix: `[${correlationId}] ${prefix}`,\n\t\t};\n\t}\n\n\tstatic log(message: string, ...params: any[]): void;\n\tstatic log(context: LogCorrelationContext | undefined, message: string, ...params: any[]): void;\n\tstatic log(contextOrMessage: LogCorrelationContext | string | undefined, ...params: any[]): void {\n\t\tif (this.level !== TraceLevel.Verbose && this.level !== TraceLevel.Debug && !Logger.isDebugging) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet message;\n\t\tif (typeof contextOrMessage === 'string') {\n\t\t\tmessage = contextOrMessage;\n\t\t} else {\n\t\t\tmessage = params.shift();\n\n\t\t\tif (contextOrMessage != null) {\n\t\t\t\tmessage = `${contextOrMessage.prefix} ${message ?? emptyStr}`;\n\t\t\t}\n\t\t}\n\n\t\tif (Logger.isDebugging) {\n\t\t\tconsole.log(this.timestamp, ConsolePrefix, message ?? emptyStr, ...params);\n\t\t}\n\n\t\tif (this.output != null && (this.level === TraceLevel.Verbose || this.level === TraceLevel.Debug)) {\n\t\t\tthis.output.appendLine(`${this.timestamp} ${message ?? emptyStr}${this.toLoggableParams(false, params)}`);\n\t\t}\n\t}\n\n\tstatic logWithDebugParams(message: string, ...params: any[]): void;\n\tstatic logWithDebugParams(context: LogCorrelationContext | undefined, message: string, ...params: any[]): void;\n\tstatic logWithDebugParams(contextOrMessage: LogCorrelationContext | string | undefined, ...params: any[]): void {\n\t\tif (this.level !== TraceLevel.Verbose && this.level !== TraceLevel.Debug && !Logger.isDebugging) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet message;\n\t\tif (typeof contextOrMessage === 'string') {\n\t\t\tmessage = contextOrMessage;\n\t\t} else {\n\t\t\tmessage = params.shift();\n\n\t\t\tif (contextOrMessage != null) {\n\t\t\t\tmessage = `${contextOrMessage.prefix} ${message ?? emptyStr}`;\n\t\t\t}\n\t\t}\n\n\t\tif (Logger.isDebugging) {\n\t\t\tconsole.log(this.timestamp, ConsolePrefix, message ?? emptyStr, ...params);\n\t\t}\n\n\t\tif (this.output != null && (this.level === TraceLevel.Verbose || this.level === TraceLevel.Debug)) {\n\t\t\tthis.output.appendLine(`${this.timestamp} ${message ?? emptyStr}${this.toLoggableParams(true, params)}`);\n\t\t}\n\t}\n\n\tstatic warn(message: string, ...params: any[]): void;\n\tstatic warn(context: LogCorrelationContext | undefined, message: string, ...params: any[]): void;\n\tstatic warn(contextOrMessage: LogCorrelationContext | string | undefined, ...params: any[]): void {\n\t\tif (this.level === TraceLevel.Silent && !Logger.isDebugging) return;\n\n\t\tlet message;\n\t\tif (typeof contextOrMessage === 'string') {\n\t\t\tmessage = contextOrMessage;\n\t\t} else {\n\t\t\tmessage = params.shift();\n\n\t\t\tif (contextOrMessage != null) {\n\t\t\t\tmessage = `${contextOrMessage.prefix} ${message ?? emptyStr}`;\n\t\t\t}\n\t\t}\n\n\t\tif (Logger.isDebugging) {\n\t\t\tconsole.warn(this.timestamp, ConsolePrefix, message ?? emptyStr, ...params);\n\t\t}\n\n\t\tif (this.output != null && this.level !== TraceLevel.Silent) {\n\t\t\tthis.output.appendLine(`${this.timestamp} ${message ?? emptyStr}${this.toLoggableParams(false, params)}`);\n\t\t}\n\t}\n\n\tstatic willLog(type: 'debug' | 'error' | 'log' | 'warn'): boolean {\n\t\tswitch (type) {\n\t\t\tcase 'debug':\n\t\t\t\treturn this.level === TraceLevel.Debug || Logger.isDebugging;\n\t\t\tcase 'error':\n\t\t\tcase 'warn':\n\t\t\t\treturn this.level !== TraceLevel.Silent || Logger.isDebugging;\n\t\t\tcase 'log':\n\t\t\t\treturn this.level === TraceLevel.Verbose || this.level === TraceLevel.Debug || Logger.isDebugging;\n\t\t\tdefault:\n\t\t\t\treturn false;\n\t\t}\n\t}\n\n\tstatic showOutputChannel() {\n\t\tif (this.output == null) return;\n\n\t\tthis.output.show();\n\t}\n\n\tstatic toLoggable(p: any, sanitize?: ((key: string, value: any) => any) | undefined) {\n\t\tif (typeof p !== 'object') return String(p);\n\t\tif (this.customLoggableFn != null) {\n\t\t\tconst loggable = this.customLoggableFn(p);\n\t\t\tif (loggable != null) return loggable;\n\t\t}\n\t\tif (p instanceof Uri) return `Uri(${p.toString(true)})`;\n\n\t\ttry {\n\t\t\treturn JSON.stringify(p, sanitize);\n\t\t} catch {\n\t\t\treturn '<error>';\n\t\t}\n\t}\n\n\tstatic toLoggableName(instance: Function | object) {\n\t\tlet name: string;\n\t\tif (typeof instance === 'function') {\n\t\t\tif (instance.prototype == null || instance.prototype.constructor == null) {\n\t\t\t\treturn instance.name;\n\t\t\t}\n\n\t\t\tname = instance.prototype.constructor.name ?? emptyStr;\n\t\t} else {\n\t\t\tname = instance.constructor?.name ?? emptyStr;\n\t\t}\n\n\t\t// Strip webpack module name (since I never name classes with an _)\n\t\tconst index = name.indexOf('_');\n\t\treturn index === -1 ? name : name.substr(index + 1);\n\t}\n\n\tprivate static get timestamp(): string {\n\t\tconst now = new Date();\n\t\treturn `[${now\n\t\t\t.toISOString()\n\t\t\t.replace(/T/, ' ')\n\t\t\t.replace(/\\..+/, emptyStr)}:${`00${now.getUTCMilliseconds()}`.slice(-3)}]`;\n\t}\n\n\tprivate static toLoggableParams(debugOnly: boolean, params: any[]) {\n\t\tif (params.length === 0 || (debugOnly && this.level !== TraceLevel.Debug && !Logger.isDebugging)) {\n\t\t\treturn emptyStr;\n\t\t}\n\n\t\tconst loggableParams = params.map(p => this.toLoggable(p)).join(', ');\n\t\treturn loggableParams.length !== 0 ? ` \\u2014 ${loggableParams}` : emptyStr;\n\t}\n\n\tstatic gitOutput: OutputChannel | undefined;\n\n\tstatic logGitCommand(command: string, ex?: Error): void {\n\t\tif (this.level !== TraceLevel.Debug) return;\n\n\t\tif (Logger.isDebugging) {\n\t\t\tif (ex != null) {\n\t\t\t\tconsole.error(this.timestamp, GitConsolePrefix, command ?? emptyStr, ex);\n\t\t\t} else {\n\t\t\t\tconsole.log(this.timestamp, GitConsolePrefix, command ?? emptyStr);\n\t\t\t}\n\t\t}\n\n\t\tif (this.gitOutput == null) {\n\t\t\tthis.gitOutput = window.createOutputChannel(extensionGitOutputChannelName);\n\t\t}\n\t\tthis.gitOutput.appendLine(`${this.timestamp} ${command}${ex != null ? `\\n\\n${ex.toString()}` : emptyStr}`);\n\t}\n}\n","'use strict';\nimport { ConfigurationTarget, env, MessageItem, Uri, window } from 'vscode';\nimport { configuration } from './configuration';\nimport { GitCommit } from './git/git';\nimport { Logger } from './logger';\n\nexport enum SuppressedMessages {\n\tCommitHasNoPreviousCommitWarning = 'suppressCommitHasNoPreviousCommitWarning',\n\tCommitNotFoundWarning = 'suppressCommitNotFoundWarning',\n\tCreatePullRequestPrompt = 'suppressCreatePullRequestPrompt',\n\tSuppressDebugLoggingWarning = 'suppressDebugLoggingWarning',\n\tFileNotUnderSourceControlWarning = 'suppressFileNotUnderSourceControlWarning',\n\tGitDisabledWarning = 'suppressGitDisabledWarning',\n\tGitMissingWarning = 'suppressGitMissingWarning',\n\tGitVersionWarning = 'suppressGitVersionWarning',\n\tIncorrectWorkspaceCasingWarning = 'suppressImproperWorkspaceCasingWarning',\n\tLineUncommittedWarning = 'suppressLineUncommittedWarning',\n\tNoRepositoryWarning = 'suppressNoRepositoryWarning',\n\tRebaseSwitchToTextWarning = 'suppressRebaseSwitchToTextWarning',\n}\n\nexport class Messages {\n\tstatic showCommitHasNoPreviousCommitWarningMessage(commit?: GitCommit): Promise<MessageItem | undefined> {\n\t\tif (commit === undefined) {\n\t\t\treturn Messages.showMessage(\n\t\t\t\t'info',\n\t\t\t\t'There is no previous commit.',\n\t\t\t\tSuppressedMessages.CommitHasNoPreviousCommitWarning,\n\t\t\t);\n\t\t}\n\t\treturn Messages.showMessage(\n\t\t\t'info',\n\t\t\t`Commit ${commit.shortSha} (${commit.author}, ${commit.formattedDate}) has no previous commit.`,\n\t\t\tSuppressedMessages.CommitHasNoPreviousCommitWarning,\n\t\t);\n\t}\n\n\tstatic showCommitNotFoundWarningMessage(message: string): Promise<MessageItem | undefined> {\n\t\treturn Messages.showMessage(\n\t\t\t'warn',\n\t\t\t`${message}. The commit could not be found.`,\n\t\t\tSuppressedMessages.CommitNotFoundWarning,\n\t\t);\n\t}\n\n\tstatic async showCreatePullRequestPrompt(branch: string): Promise<boolean> {\n\t\tconst create = { title: 'Create Pull Request...' };\n\t\tconst result = await Messages.showMessage(\n\t\t\t'info',\n\t\t\t`Would you like to create a Pull Request for branch '${branch}'?`,\n\t\t\tSuppressedMessages.CreatePullRequestPrompt,\n\t\t\t{ title: \"Don't Show Again\" },\n\t\t\tcreate,\n\t\t);\n\t\treturn result === create;\n\t}\n\n\tstatic async showDebugLoggingWarningMessage(): Promise<boolean> {\n\t\tconst disable = { title: 'Disable Debug Logging' };\n\t\tconst result = await Messages.showMessage(\n\t\t\t'warn',\n\t\t\t'GitLens debug logging is currently enabled. Unless you are reporting an issue, it is recommended to be disabled. Would you like to disable it?',\n\t\t\tSuppressedMessages.SuppressDebugLoggingWarning,\n\t\t\t{ title: \"Don't Show Again\" },\n\t\t\tdisable,\n\t\t);\n\n\t\treturn result === disable;\n\t}\n\n\tstatic async showGenericErrorMessage(message: string): Promise<MessageItem | undefined> {\n\t\tconst actions: MessageItem[] = [{ title: 'Open Output Channel' }];\n\t\tconst result = await Messages.showMessage(\n\t\t\t'error',\n\t\t\t`${message}. See output channel for more details`,\n\t\t\tundefined,\n\t\t\tnull,\n\t\t\t...actions,\n\t\t);\n\n\t\tif (result !== undefined) {\n\t\t\tLogger.showOutputChannel();\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic showFileNotUnderSourceControlWarningMessage(message: string): Promise<MessageItem | undefined> {\n\t\treturn Messages.showMessage(\n\t\t\t'warn',\n\t\t\t`${message}. The file is probably not under source control.`,\n\t\t\tSuppressedMessages.FileNotUnderSourceControlWarning,\n\t\t);\n\t}\n\n\tstatic showGitDisabledErrorMessage() {\n\t\treturn Messages.showMessage(\n\t\t\t'error',\n\t\t\t'GitLens requires Git to be enabled. Please re-enable Git \\u2014 set `git.enabled` to true and reload.',\n\t\t\tSuppressedMessages.GitDisabledWarning,\n\t\t);\n\t}\n\n\tstatic showGitInvalidConfigErrorMessage() {\n\t\treturn Messages.showMessage(\n\t\t\t'error',\n\t\t\t'GitLens is unable to use Git. Your Git configuration seems to be invalid. Please resolve any issues with your Git configuration and reload.',\n\t\t);\n\t}\n\n\tstatic showGitMissingErrorMessage() {\n\t\treturn Messages.showMessage(\n\t\t\t'error',\n\t\t\t\"GitLens was unable to find Git. Please make sure Git is installed. Also ensure that Git is either in the PATH, or that 'git.path' is pointed to its installed location.\",\n\t\t\tSuppressedMessages.GitMissingWarning,\n\t\t);\n\t}\n\n\tstatic showGitVersionUnsupportedErrorMessage(version: string, required: string): Promise<MessageItem | undefined> {\n\t\treturn Messages.showMessage(\n\t\t\t'error',\n\t\t\t`GitLens requires a newer version of Git (>= ${required}) than is currently installed (${version}). Please install a more recent version of Git.`,\n\t\t\tSuppressedMessages.GitVersionWarning,\n\t\t);\n\t}\n\n\tstatic async showIncorrectWorkspaceCasingWarningMessage(): Promise<void> {\n\t\tvoid (await Messages.showMessage(\n\t\t\t'warn',\n\t\t\t'This workspace was opened with a different casing than what exists on disk. Please re-open this workspace with the exact casing as it exists on disk, otherwise you may experience issues with certain Git features, such as missing blame or history.',\n\t\t\tSuppressedMessages.IncorrectWorkspaceCasingWarning,\n\t\t));\n\t}\n\n\tstatic showInsidersErrorMessage() {\n\t\treturn Messages.showMessage(\n\t\t\t'error',\n\t\t\t'GitLens (Insiders) cannot be used while GitLens is also enabled. Please ensure that only one version is enabled.',\n\t\t\tSuppressedMessages.GitDisabledWarning,\n\t\t);\n\t}\n\n\tstatic showLineUncommittedWarningMessage(message: string): Promise<MessageItem | undefined> {\n\t\treturn Messages.showMessage(\n\t\t\t'warn',\n\t\t\t`${message}. The line has uncommitted changes.`,\n\t\t\tSuppressedMessages.LineUncommittedWarning,\n\t\t);\n\t}\n\n\tstatic showNoRepositoryWarningMessage(message: string): Promise<MessageItem | undefined> {\n\t\treturn Messages.showMessage(\n\t\t\t'warn',\n\t\t\t`${message}. No repository could be found.`,\n\t\t\tSuppressedMessages.NoRepositoryWarning,\n\t\t);\n\t}\n\n\tstatic showRebaseSwitchToTextWarningMessage(): Promise<MessageItem | undefined> {\n\t\treturn Messages.showMessage(\n\t\t\t'warn',\n\t\t\t'Closing either the git-rebase-todo file or the Rebase Editor will start the rebase.',\n\t\t\tSuppressedMessages.RebaseSwitchToTextWarning,\n\t\t);\n\t}\n\n\tstatic async showWhatsNewMessage(version: string) {\n\t\tconst whatsnew = { title: \"What's New\" };\n\t\tconst result = await Messages.showMessage(\n\t\t\t'info',\n\t\t\t`GitLens has been updated to v${version}  check out what's new!`,\n\t\t\tundefined,\n\t\t\tnull,\n\t\t\twhatsnew,\n\t\t);\n\n\t\tif (result === whatsnew) {\n\t\t\tawait env.openExternal(Uri.parse('https://gitlens.amod.io/#whats-new'));\n\t\t}\n\t}\n\n\tprivate static async showMessage(\n\t\ttype: 'info' | 'warn' | 'error',\n\t\tmessage: string,\n\t\tsuppressionKey?: SuppressedMessages,\n\t\tdontShowAgain: MessageItem | null = { title: \"Don't Show Again\" },\n\t\t...actions: MessageItem[]\n\t): Promise<MessageItem | undefined> {\n\t\tLogger.log(`ShowMessage(${type}, '${message}', ${suppressionKey}, ${JSON.stringify(dontShowAgain)})`);\n\n\t\tif (suppressionKey !== undefined && configuration.get(`advanced.messages.${suppressionKey}` as const)) {\n\t\t\tLogger.log(\n\t\t\t\t`ShowMessage(${type}, '${message}', ${suppressionKey}, ${JSON.stringify(dontShowAgain)}) skipped`,\n\t\t\t);\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (suppressionKey !== undefined && dontShowAgain !== null) {\n\t\t\tactions.push(dontShowAgain);\n\t\t}\n\n\t\tlet result: MessageItem | undefined = undefined;\n\t\tswitch (type) {\n\t\t\tcase 'info':\n\t\t\t\tresult = await window.showInformationMessage(message, ...actions);\n\t\t\t\tbreak;\n\n\t\t\tcase 'warn':\n\t\t\t\tresult = await window.showWarningMessage(message, ...actions);\n\t\t\t\tbreak;\n\n\t\t\tcase 'error':\n\t\t\t\tresult = await window.showErrorMessage(message, ...actions);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif ((suppressionKey !== undefined && dontShowAgain === null) || result === dontShowAgain) {\n\t\t\tLogger.log(\n\t\t\t\t`ShowMessage(${type}, '${message}', ${suppressionKey}, ${JSON.stringify(\n\t\t\t\t\tdontShowAgain,\n\t\t\t\t)}) don't show again requested`,\n\t\t\t);\n\t\t\tawait this.suppressedMessage(suppressionKey!);\n\n\t\t\tif (result === dontShowAgain) return undefined;\n\t\t}\n\n\t\tLogger.log(\n\t\t\t`ShowMessage(${type}, '${message}', ${suppressionKey}, ${JSON.stringify(dontShowAgain)}) returned ${\n\t\t\t\tresult != null ? result.title : result\n\t\t\t}`,\n\t\t);\n\t\treturn result;\n\t}\n\n\tprivate static suppressedMessage(suppressionKey: SuppressedMessages) {\n\t\tconst messages = { ...configuration.get('advanced.messages') };\n\n\t\tmessages[suppressionKey] = true;\n\n\t\tfor (const [key, value] of Object.entries(messages)) {\n\t\t\tif (value !== true) {\n\t\t\t\tdelete messages[key as keyof typeof messages];\n\t\t\t}\n\t\t}\n\n\t\treturn configuration.update('advanced.messages', messages, ConfigurationTarget.Global);\n\t}\n}\n","'use strict';\nimport { commands, QuickPickItem } from 'vscode';\nimport { Commands, GitActions } from '../commands';\nimport { Container } from '../container';\nimport { GitReference, GitRevisionReference, GitStashCommit, SearchPattern } from '../git/git';\nimport { Keys } from '../keyboard';\n\ndeclare module 'vscode' {\n\tinterface QuickPickItem {\n\t\tonDidSelect?(): void;\n\t\tonDidPressKey?(key: Keys): Promise<void>;\n\t}\n}\n\nexport interface QuickPickItemOfT<T = any> extends QuickPickItem {\n\treadonly item: T;\n}\n\nexport enum Directive {\n\tBack,\n\tCancel,\n\tLoadMore,\n\tNoop,\n}\n\nexport namespace Directive {\n\texport function is<T>(value: Directive | T): value is Directive {\n\t\treturn typeof value === 'number' && Directive[value] != null;\n\t}\n}\n\nexport interface DirectiveQuickPickItem extends QuickPickItem {\n\tdirective: Directive;\n}\n\nexport namespace DirectiveQuickPickItem {\n\texport function create(\n\t\tdirective: Directive,\n\t\tpicked?: boolean,\n\t\toptions: { label?: string; description?: string; detail?: string } = {},\n\t) {\n\t\tlet label = options.label;\n\t\tif (label == null) {\n\t\t\tswitch (directive) {\n\t\t\t\tcase Directive.Back:\n\t\t\t\t\tlabel = 'Back';\n\t\t\t\t\tbreak;\n\t\t\t\tcase Directive.Cancel:\n\t\t\t\t\tlabel = 'Cancel';\n\t\t\t\t\tbreak;\n\t\t\t\tcase Directive.LoadMore:\n\t\t\t\t\tlabel = 'Load more';\n\t\t\t\t\tbreak;\n\t\t\t\tcase Directive.Noop:\n\t\t\t\t\tlabel = 'Try again';\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tconst item: DirectiveQuickPickItem = {\n\t\t\tlabel: label,\n\t\t\tdescription: options.description,\n\t\t\tdetail: options.detail,\n\t\t\talwaysShow: true,\n\t\t\tpicked: picked,\n\t\t\tdirective: directive,\n\t\t};\n\n\t\treturn item;\n\t}\n\n\texport function is(item: QuickPickItem): item is DirectiveQuickPickItem {\n\t\treturn item != null && 'directive' in item;\n\t}\n}\n\nexport class CommandQuickPickItem<Arguments extends any[] = any[]> implements QuickPickItem {\n\tstatic fromCommand<T>(label: string, command: Commands, args?: T): CommandQuickPickItem;\n\tstatic fromCommand<T>(item: QuickPickItem, command: Commands, args?: T): CommandQuickPickItem;\n\tstatic fromCommand<T>(labelOrItem: string | QuickPickItem, command: Commands, args?: T): CommandQuickPickItem {\n\t\treturn new CommandQuickPickItem(\n\t\t\ttypeof labelOrItem === 'string' ? { label: labelOrItem } : labelOrItem,\n\t\t\tcommand,\n\t\t\targs == null ? [] : [args],\n\t\t);\n\t}\n\n\tstatic is(item: QuickPickItem): item is CommandQuickPickItem {\n\t\treturn item instanceof CommandQuickPickItem;\n\t}\n\n\tlabel!: string;\n\tdescription?: string;\n\tdetail?: string | undefined;\n\n\tconstructor(\n\t\tlabel: string,\n\t\tcommand?: Commands,\n\t\targs?: Arguments,\n\t\toptions?: {\n\t\t\tonDidPressKey?: (key: Keys, result: Thenable<unknown>) => void;\n\t\t\tsuppressKeyPress?: boolean;\n\t\t},\n\t);\n\tconstructor(\n\t\titem: QuickPickItem,\n\t\tcommand?: Commands,\n\t\targs?: Arguments,\n\t\toptions?: {\n\t\t\tonDidPressKey?: (key: Keys, result: Thenable<unknown>) => void;\n\t\t\tsuppressKeyPress?: boolean;\n\t\t},\n\t);\n\tconstructor(\n\t\tlabelOrItem: string | QuickPickItem,\n\t\tcommand?: Commands,\n\t\targs?: Arguments,\n\t\toptions?: {\n\t\t\tonDidPressKey?: (key: Keys, result: Thenable<unknown>) => void;\n\t\t\tsuppressKeyPress?: boolean;\n\t\t},\n\t);\n\tconstructor(\n\t\tlabelOrItem: string | QuickPickItem,\n\t\tprotected readonly command?: Commands,\n\t\tprotected readonly args?: Arguments,\n\t\tprotected readonly options?: {\n\t\t\t// onDidExecute?: (\n\t\t\t// \toptions: { preserveFocus?: boolean; preview?: boolean } | undefined,\n\t\t\t// \tresult: Thenable<unknown>,\n\t\t\t// ) => void;\n\t\t\tonDidPressKey?: (key: Keys, result: Thenable<unknown>) => void;\n\t\t\tsuppressKeyPress?: boolean;\n\t\t},\n\t) {\n\t\tthis.command = command;\n\t\tthis.args = args;\n\n\t\tif (typeof labelOrItem === 'string') {\n\t\t\tthis.label = labelOrItem;\n\t\t} else {\n\t\t\tObject.assign(this, labelOrItem);\n\t\t}\n\t}\n\n\texecute(_options?: { preserveFocus?: boolean; preview?: boolean }): Promise<unknown | undefined> {\n\t\tif (this.command === undefined) return Promise.resolve(undefined);\n\n\t\tconst result = commands.executeCommand(this.command, ...(this.args ?? [])) as Promise<unknown | undefined>;\n\t\t// this.options?.onDidExecute?.(options, result);\n\t\treturn result;\n\t}\n\n\tasync onDidPressKey(key: Keys): Promise<void> {\n\t\tif (this.options?.suppressKeyPress) return;\n\n\t\tconst result = this.execute({ preserveFocus: true, preview: false });\n\t\tthis.options?.onDidPressKey?.(key, result);\n\t\tvoid (await result);\n\t}\n}\n\nexport class ActionQuickPickItem extends CommandQuickPickItem {\n\tconstructor(\n\t\tlabelOrItem: string | QuickPickItem,\n\t\tprivate readonly action: (options?: { preserveFocus?: boolean; preview?: boolean }) => void | Promise<void>,\n\t) {\n\t\tsuper(labelOrItem, undefined, undefined);\n\t}\n\n\toverride async execute(options?: { preserveFocus?: boolean; preview?: boolean }): Promise<void> {\n\t\treturn this.action(options);\n\t}\n}\n\nexport type FlagsQuickPickItem<T> = QuickPickItemOfT<T[]>;\nexport namespace FlagsQuickPickItem {\n\texport function create<T>(flags: T[], item: T[], options: QuickPickItem) {\n\t\treturn { ...options, item: item, picked: hasFlags(flags, item) };\n\t}\n}\n\nfunction hasFlags<T>(flags: T[], has?: T | T[]): boolean {\n\tif (has === undefined) return flags.length === 0;\n\tif (!Array.isArray(has)) return flags.includes(has);\n\n\treturn has.length === 0 ? flags.length === 0 : has.every(f => flags.includes(f));\n}\n\nexport class RevealInSideBarQuickPickItem extends CommandQuickPickItem {\n\tconstructor(\n\t\tprivate readonly reference: GitRevisionReference,\n\t\titem: QuickPickItem = {\n\t\t\tlabel: `$(eye) Reveal ${GitReference.isStash(reference) ? 'Stash' : 'Commit'} in Side Bar`,\n\t\t\tdescription: GitReference.isStash(reference) ? '' : 'can take a while',\n\t\t},\n\t) {\n\t\tsuper(item, undefined, undefined);\n\t}\n\n\toverride async execute(options?: { preserveFocus?: boolean; preview?: boolean }): Promise<void> {\n\t\tif (GitStashCommit.is(this.reference)) {\n\t\t\tvoid (await GitActions.Stash.reveal(this.reference, {\n\t\t\t\tselect: true,\n\t\t\t\tfocus: !(options?.preserveFocus ?? false),\n\t\t\t\texpand: true,\n\t\t\t}));\n\t\t} else {\n\t\t\tvoid (await GitActions.Commit.reveal(this.reference, {\n\t\t\t\tselect: true,\n\t\t\t\tfocus: !(options?.preserveFocus ?? false),\n\t\t\t\texpand: true,\n\t\t\t}));\n\t\t}\n\t}\n}\n\nexport class SearchForCommitQuickPickItem extends CommandQuickPickItem {\n\tconstructor(\n\t\tprivate readonly reference: GitRevisionReference,\n\t\titem: QuickPickItem = {\n\t\t\tlabel: '$(search) Search for Commit in Side Bar',\n\t\t},\n\t) {\n\t\tsuper(item, undefined, undefined);\n\t}\n\n\toverride async execute(options?: { preserveFocus?: boolean; preview?: boolean }): Promise<void> {\n\t\tvoid (await Container.searchAndCompareView.search(\n\t\t\tthis.reference.repoPath,\n\t\t\t{\n\t\t\t\tpattern: SearchPattern.fromCommit(this.reference),\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: {\n\t\t\t\t\tlabel: `for ${GitReference.toString(this.reference, { icon: false })}`,\n\t\t\t\t},\n\t\t\t\treveal: {\n\t\t\t\t\tselect: true,\n\t\t\t\t\tfocus: !(options?.preserveFocus ?? false),\n\t\t\t\t\texpand: true,\n\t\t\t\t},\n\t\t\t},\n\t\t));\n\t}\n}\n","'use strict';\nimport { QuickPickItem } from 'vscode';\nimport { Commands, GitCommandsCommand, GitCommandsCommandArgs } from '../commands';\nimport { GlyphChars } from '../constants';\nimport { emojify } from '../emojis';\nimport {\n\tGitBranch,\n\tGitContributor,\n\tGitLogCommit,\n\tGitReference,\n\tGitRemoteType,\n\tGitRevision,\n\tGitStashCommit,\n\tGitTag,\n\tRepository,\n} from '../git/git';\nimport { Dates, Strings } from '../system';\nimport { CommandQuickPickItem, QuickPickItemOfT } from './quickPicksItems';\n\nexport class GitCommandQuickPickItem extends CommandQuickPickItem<[GitCommandsCommandArgs]> {\n\tconstructor(label: string, args: GitCommandsCommandArgs);\n\tconstructor(item: QuickPickItem, args: GitCommandsCommandArgs);\n\tconstructor(labelOrItem: string | QuickPickItem, args: GitCommandsCommandArgs) {\n\t\tsuper(labelOrItem, Commands.GitCommands, [args], { suppressKeyPress: true });\n\t}\n\n\texecuteSteps(pickedVia: 'menu' | 'command') {\n\t\treturn GitCommandsCommand.getSteps(this.args![0], pickedVia);\n\t}\n}\n\nexport interface BranchQuickPickItem extends QuickPickItemOfT<GitBranch> {\n\treadonly current: boolean;\n\treadonly ref: string;\n\treadonly remote: boolean;\n}\n\nexport namespace BranchQuickPickItem {\n\texport async function create(\n\t\tbranch: GitBranch,\n\t\tpicked?: boolean,\n\t\toptions: {\n\t\t\talwaysShow?: boolean;\n\t\t\tcurrent?: boolean | 'checkmark';\n\t\t\tchecked?: boolean;\n\t\t\tref?: boolean;\n\t\t\tstatus?: boolean;\n\t\t\ttype?: boolean | 'remote';\n\t\t} = {},\n\t) {\n\t\tlet description = '';\n\t\tif (options.type === true) {\n\t\t\tif (options.current === true && branch.current) {\n\t\t\t\tdescription = 'current branch';\n\t\t\t} else {\n\t\t\t\tdescription = 'branch';\n\t\t\t}\n\t\t} else if (options.type === 'remote') {\n\t\t\tif (branch.remote) {\n\t\t\t\tdescription = 'remote branch';\n\t\t\t}\n\t\t} else if (options.current === true && branch.current) {\n\t\t\tdescription = 'current branch';\n\t\t}\n\n\t\tif (options.status && !branch.remote && branch.upstream != null) {\n\t\t\tlet arrows = GlyphChars.Dash;\n\n\t\t\tconst remote = await branch.getRemote();\n\t\t\tif (!branch.upstream.missing) {\n\t\t\t\tif (remote != null) {\n\t\t\t\t\tlet left;\n\t\t\t\t\tlet right;\n\t\t\t\t\tfor (const { type } of remote.urls) {\n\t\t\t\t\t\tif (type === GitRemoteType.Fetch) {\n\t\t\t\t\t\t\tleft = true;\n\n\t\t\t\t\t\t\tif (right) break;\n\t\t\t\t\t\t} else if (type === GitRemoteType.Push) {\n\t\t\t\t\t\t\tright = true;\n\n\t\t\t\t\t\t\tif (left) break;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (left && right) {\n\t\t\t\t\t\tarrows = GlyphChars.ArrowsRightLeft;\n\t\t\t\t\t} else if (right) {\n\t\t\t\t\t\tarrows = GlyphChars.ArrowRight;\n\t\t\t\t\t} else if (left) {\n\t\t\t\t\t\tarrows = GlyphChars.ArrowLeft;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tarrows = GlyphChars.Warning;\n\t\t\t}\n\n\t\t\tconst status = `${branch.getTrackingStatus({ suffix: `${GlyphChars.Space} ` })}${arrows}${\n\t\t\t\tGlyphChars.Space\n\t\t\t} ${branch.upstream.name}`;\n\t\t\tdescription = `${description ? `${description}${GlyphChars.Space.repeat(2)}${status}` : status}`;\n\t\t}\n\n\t\tif (options.ref) {\n\t\t\tif (branch.sha) {\n\t\t\t\tdescription = description\n\t\t\t\t\t? `${description}${Strings.pad('$(git-commit)', 2, 2)}${GitRevision.shorten(branch.sha)}`\n\t\t\t\t\t: `${Strings.pad('$(git-commit)', 0, 2)}${GitRevision.shorten(branch.sha)}`;\n\t\t\t}\n\n\t\t\tif (branch.date !== undefined) {\n\t\t\t\tdescription = description\n\t\t\t\t\t? `${description}${Strings.pad(GlyphChars.Dot, 2, 2)}${branch.formattedDate}`\n\t\t\t\t\t: branch.formattedDate;\n\t\t\t}\n\t\t}\n\n\t\tconst checked =\n\t\t\toptions.checked || (options.checked == null && options.current === 'checkmark' && branch.current);\n\t\tconst item: BranchQuickPickItem = {\n\t\t\tlabel: `${Strings.pad('$(git-branch)', 0, 2)}${branch.starred ? '$(star-full) ' : ''}${branch.name}${\n\t\t\t\tchecked ? `${GlyphChars.Space.repeat(2)}$(check)${GlyphChars.Space}` : ''\n\t\t\t}`,\n\t\t\tdescription: description,\n\t\t\talwaysShow: options.alwaysShow,\n\t\t\tpicked: picked ?? branch.current,\n\t\t\titem: branch,\n\t\t\tcurrent: branch.current,\n\t\t\tref: branch.name,\n\t\t\tremote: branch.remote,\n\t\t};\n\n\t\treturn item;\n\t}\n}\n\nexport class CommitLoadMoreQuickPickItem implements QuickPickItem {\n\treadonly label = 'Load more';\n\treadonly alwaysShow = true;\n}\n\nexport type CommitQuickPickItem<T extends GitLogCommit = GitLogCommit> = QuickPickItemOfT<T>;\n\nexport namespace CommitQuickPickItem {\n\texport function create<T extends GitLogCommit = GitLogCommit>(\n\t\tcommit: T,\n\t\tpicked?: boolean,\n\t\toptions: { alwaysShow?: boolean; compact?: boolean; icon?: boolean } = {},\n\t) {\n\t\tif (GitStashCommit.is(commit)) {\n\t\t\tconst number = commit.number == null ? '' : `${commit.number}: `;\n\n\t\t\tif (options.compact) {\n\t\t\t\tconst item: CommitQuickPickItem<T> = {\n\t\t\t\t\tlabel: `${options.icon ? Strings.pad('$(archive)', 0, 2) : ''}${number}${commit.getShortMessage()}`,\n\t\t\t\t\tdescription: `${commit.formattedDate}${Strings.pad(\n\t\t\t\t\t\tGlyphChars.Dot,\n\t\t\t\t\t\t2,\n\t\t\t\t\t\t2,\n\t\t\t\t\t)}${commit.getFormattedDiffStatus({ compact: true })}`,\n\t\t\t\t\talwaysShow: options.alwaysShow,\n\t\t\t\t\tpicked: picked,\n\t\t\t\t\titem: commit,\n\t\t\t\t};\n\n\t\t\t\treturn item;\n\t\t\t}\n\n\t\t\tconst item: CommitQuickPickItem<T> = {\n\t\t\t\tlabel: `${options.icon ? Strings.pad('$(archive)', 0, 2) : ''}${number}${commit.getShortMessage()}`,\n\t\t\t\tdescription: '',\n\t\t\t\tdetail: `${GlyphChars.Space.repeat(2)}${commit.formattedDate}${Strings.pad(\n\t\t\t\t\tGlyphChars.Dot,\n\t\t\t\t\t2,\n\t\t\t\t\t2,\n\t\t\t\t)}${commit.getFormattedDiffStatus({ compact: true })}`,\n\t\t\t\talwaysShow: options.alwaysShow,\n\t\t\t\tpicked: picked,\n\t\t\t\titem: commit,\n\t\t\t};\n\n\t\t\treturn item;\n\t\t}\n\n\t\tif (options.compact) {\n\t\t\tconst item: CommitQuickPickItem<T> = {\n\t\t\t\tlabel: `${options.icon ? Strings.pad('$(git-commit)', 0, 2) : ''}${commit.getShortMessage()}`,\n\t\t\t\tdescription: `${commit.author}, ${commit.formattedDate}${Strings.pad('$(git-commit)', 2, 2)}${\n\t\t\t\t\tcommit.shortSha\n\t\t\t\t}${Strings.pad(GlyphChars.Dot, 2, 2)}${commit.getFormattedDiffStatus({ compact: true })}`,\n\t\t\t\talwaysShow: options.alwaysShow,\n\t\t\t\tpicked: picked,\n\t\t\t\titem: commit,\n\t\t\t};\n\t\t\treturn item;\n\t\t}\n\n\t\tconst item: CommitQuickPickItem<T> = {\n\t\t\tlabel: `${options.icon ? Strings.pad('$(git-commit)', 0, 2) : ''}${commit.getShortMessage()}`,\n\t\t\tdescription: '',\n\t\t\tdetail: `${GlyphChars.Space.repeat(2)}${commit.author}, ${commit.formattedDate}${Strings.pad(\n\t\t\t\t'$(git-commit)',\n\t\t\t\t2,\n\t\t\t\t2,\n\t\t\t)}${commit.shortSha}${Strings.pad(GlyphChars.Dot, 2, 2)}${commit.getFormattedDiffStatus({\n\t\t\t\tcompact: true,\n\t\t\t})}`,\n\t\t\talwaysShow: options.alwaysShow,\n\t\t\tpicked: picked,\n\t\t\titem: commit,\n\t\t};\n\t\treturn item;\n\t}\n}\n\nexport type ContributorQuickPickItem = QuickPickItemOfT<GitContributor>;\n\nexport namespace ContributorQuickPickItem {\n\texport function create(\n\t\tcontributor: GitContributor,\n\t\tpicked?: boolean,\n\t\toptions: { alwaysShow?: boolean } = {},\n\t): ContributorQuickPickItem {\n\t\tconst item: ContributorQuickPickItem = {\n\t\t\tlabel: contributor.name,\n\t\t\tdescription: contributor.email,\n\t\t\talwaysShow: options.alwaysShow,\n\t\t\tpicked: picked,\n\t\t\titem: contributor,\n\t\t};\n\t\treturn item;\n\t}\n}\n\nexport interface RefQuickPickItem extends QuickPickItemOfT<GitReference> {\n\treadonly current: boolean;\n\treadonly ref: string;\n\treadonly remote: boolean;\n}\n\nexport namespace RefQuickPickItem {\n\texport function create(\n\t\tref: string,\n\t\trepoPath: string,\n\t\tpicked?: boolean,\n\t\toptions: { alwaysShow?: boolean; ref?: boolean; icon?: boolean } = {},\n\t): RefQuickPickItem {\n\t\tif (ref === '') {\n\t\t\treturn {\n\t\t\t\tlabel: `${options.icon ? Strings.pad('$(file-directory)', 0, 2) : ''}Working Tree`,\n\t\t\t\tdescription: '',\n\t\t\t\talwaysShow: options.alwaysShow,\n\t\t\t\tpicked: picked,\n\t\t\t\titem: GitReference.create(ref, repoPath, { refType: 'revision', name: 'Working Tree' }),\n\t\t\t\tcurrent: false,\n\t\t\t\tref: ref,\n\t\t\t\tremote: false,\n\t\t\t};\n\t\t}\n\n\t\tif (ref === 'HEAD') {\n\t\t\treturn {\n\t\t\t\tlabel: `${options.icon ? Strings.pad('$(git-branch)', 0, 2) : ''}HEAD`,\n\t\t\t\tdescription: '',\n\t\t\t\talwaysShow: options.alwaysShow,\n\t\t\t\tpicked: picked,\n\t\t\t\titem: GitReference.create(ref, repoPath, { refType: 'revision', name: 'HEAD' }),\n\t\t\t\tcurrent: false,\n\t\t\t\tref: ref,\n\t\t\t\tremote: false,\n\t\t\t};\n\t\t}\n\n\t\tconst gitRef = GitReference.create(ref, repoPath);\n\n\t\tif (GitRevision.isRange(ref)) {\n\t\t\treturn {\n\t\t\t\tlabel: `Range ${gitRef.name}`,\n\t\t\t\tdescription: '',\n\t\t\t\talwaysShow: options.alwaysShow,\n\t\t\t\tpicked: picked,\n\t\t\t\titem: gitRef,\n\t\t\t\tcurrent: false,\n\t\t\t\tref: ref,\n\t\t\t\tremote: false,\n\t\t\t};\n\t\t}\n\n\t\tconst item: RefQuickPickItem = {\n\t\t\tlabel: `Commit ${gitRef.name}`,\n\t\t\tdescription: options.ref ? `$(git-commit) ${ref}` : '',\n\t\t\talwaysShow: options.alwaysShow,\n\t\t\tpicked: picked,\n\t\t\titem: gitRef,\n\t\t\tcurrent: false,\n\t\t\tref: ref,\n\t\t\tremote: false,\n\t\t};\n\n\t\treturn item;\n\t}\n}\n\nexport interface RepositoryQuickPickItem extends QuickPickItemOfT<Repository> {\n\treadonly repoPath: string;\n}\n\nexport namespace RepositoryQuickPickItem {\n\texport async function create(\n\t\trepository: Repository,\n\t\tpicked?: boolean,\n\t\toptions: { alwaysShow?: boolean; branch?: boolean; fetched?: boolean; status?: boolean } = {},\n\t) {\n\t\tlet repoStatus;\n\t\tif (options.branch || options.status) {\n\t\t\trepoStatus = await repository.getStatus();\n\t\t}\n\n\t\tlet description = '';\n\t\tif (options.branch && repoStatus != null) {\n\t\t\tdescription = repoStatus.branch;\n\t\t}\n\n\t\tif (options.status && repoStatus != null) {\n\t\t\tlet workingStatus = '';\n\t\t\tif (repoStatus.files.length !== 0) {\n\t\t\t\tworkingStatus = repoStatus.getFormattedDiffStatus({\n\t\t\t\t\tcompact: true,\n\t\t\t\t\tprefix: Strings.pad(GlyphChars.Dot, 2, 2),\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst upstreamStatus = repoStatus.getUpstreamStatus({\n\t\t\t\tprefix: description ? `${GlyphChars.Space} ` : '',\n\t\t\t});\n\n\t\t\tconst status = `${upstreamStatus}${workingStatus}`;\n\t\t\tif (status) {\n\t\t\t\tdescription = `${description ? `${description}${status}` : status}`;\n\t\t\t}\n\t\t}\n\n\t\tif (options.fetched) {\n\t\t\tconst lastFetched = await repository.getLastFetched();\n\t\t\tif (lastFetched !== 0) {\n\t\t\t\tconst fetched = `Last fetched ${Dates.getFormatter(new Date(lastFetched)).fromNow()}`;\n\t\t\t\tdescription = `${\n\t\t\t\t\tdescription ? `${description}${Strings.pad(GlyphChars.Dot, 2, 2)}${fetched}` : fetched\n\t\t\t\t}`;\n\t\t\t}\n\t\t}\n\n\t\tconst item: RepositoryQuickPickItem = {\n\t\t\tlabel: repository.formattedName,\n\t\t\tdescription: description,\n\t\t\talwaysShow: options.alwaysShow,\n\t\t\tpicked: picked,\n\t\t\titem: repository,\n\t\t\trepoPath: repository.path,\n\t\t};\n\n\t\treturn item;\n\t}\n}\n\nexport interface TagQuickPickItem extends QuickPickItemOfT<GitTag> {\n\treadonly current: boolean;\n\treadonly ref: string;\n\treadonly remote: boolean;\n}\n\nexport namespace TagQuickPickItem {\n\texport function create(\n\t\ttag: GitTag,\n\t\tpicked?: boolean,\n\t\toptions: {\n\t\t\talwaysShow?: boolean;\n\t\t\tmessage?: boolean;\n\t\t\tchecked?: boolean;\n\t\t\tref?: boolean;\n\t\t\ttype?: boolean;\n\t\t} = {},\n\t) {\n\t\tlet description = '';\n\t\tif (options.type) {\n\t\t\tdescription = 'tag';\n\t\t}\n\n\t\tif (options.ref) {\n\t\t\tdescription = description\n\t\t\t\t? `${description}${Strings.pad('$(git-commit)', 2, 2)}${GitRevision.shorten(tag.sha)}`\n\t\t\t\t: `${Strings.pad('$(git-commit)', 0, 2)}${GitRevision.shorten(tag.sha)}`;\n\n\t\t\tdescription = description\n\t\t\t\t? `${description}${Strings.pad(GlyphChars.Dot, 2, 2)}${tag.formattedDate}`\n\t\t\t\t: tag.formattedDate;\n\t\t}\n\n\t\tif (options.message) {\n\t\t\tconst message = emojify(tag.message);\n\t\t\tdescription = description ? `${description}${Strings.pad(GlyphChars.Dot, 2, 2)}${message}` : message;\n\t\t}\n\n\t\tconst item: TagQuickPickItem = {\n\t\t\tlabel: `${Strings.pad('$(tag)', 0, 2)}${tag.name}${\n\t\t\t\toptions.checked ? `${GlyphChars.Space.repeat(2)}$(check)${GlyphChars.Space}` : ''\n\t\t\t}`,\n\t\t\tdescription: description,\n\t\t\talwaysShow: options.alwaysShow,\n\t\t\tpicked: picked,\n\t\t\titem: tag,\n\t\t\tcurrent: false,\n\t\t\tref: tag.name,\n\t\t\tremote: false,\n\t\t};\n\n\t\treturn item;\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { QuickPickItem, window } from 'vscode';\nimport { Commands, GitActions, OpenChangedFilesCommandArgs } from '../commands';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { CommitFormatter, GitFile, GitLogCommit, GitStatusFile } from '../git/git';\nimport { Keys } from '../keyboard';\nimport { Strings } from '../system';\nimport { CommandQuickPickItem } from './quickPicksItems';\n\nexport class CommitFilesQuickPickItem extends CommandQuickPickItem {\n\tconstructor(readonly commit: GitLogCommit, picked: boolean = true, fileName?: string) {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tlabel: commit.getShortMessage(),\n\t\t\t\tdescription: CommitFormatter.fromTemplate(`\\${author}, \\${ago}  $(git-commit)  \\${id}`, commit),\n\t\t\t\tdetail: `$(files) ${commit.getFormattedDiffStatus({\n\t\t\t\t\texpand: true,\n\t\t\t\t\tseparator: ', ',\n\t\t\t\t\tempty: 'No files changed',\n\t\t\t\t})}${fileName ? `${Strings.pad(GlyphChars.Dot, 2, 2)}${fileName}` : ''}`,\n\t\t\t\tpicked: picked,\n\t\t\t},\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\t{ suppressKeyPress: true },\n\t\t);\n\t}\n\n\tget sha(): string {\n\t\treturn this.commit.sha;\n\t}\n}\n\nexport class CommitFileQuickPickItem extends CommandQuickPickItem {\n\tconstructor(readonly commit: GitLogCommit, readonly file: GitFile, picked?: boolean) {\n\t\tsuper({\n\t\t\tlabel: `${Strings.pad(GitFile.getStatusCodicon(file.status), 0, 2)}${paths.basename(file.fileName)}`,\n\t\t\tdescription: GitFile.getFormattedDirectory(file, true),\n\t\t\tpicked: picked,\n\t\t});\n\n\t\t// TODO@eamodio - add line diff details\n\t\t// this.detail = this.commit.getFormattedDiffStatus({ expand: true });\n\t}\n\n\tget sha(): string {\n\t\treturn this.commit.sha;\n\t}\n\n\toverride execute(options?: { preserveFocus?: boolean; preview?: boolean }): Promise<void> {\n\t\treturn GitActions.Commit.openChanges(this.file, this.commit, options);\n\t\t// const fileCommit = this.commit.toFileCommit(this.file)!;\n\n\t\t// if (fileCommit.previousSha === undefined) {\n\t\t// \tvoid (await findOrOpenEditor(\n\t\t// \t\tGitUri.toRevisionUri(fileCommit.sha, this.file, fileCommit.repoPath),\n\t\t// \t\toptions,\n\t\t// \t));\n\n\t\t// \treturn;\n\t\t// }\n\n\t\t// const commandArgs: DiffWithPreviousCommandArgs = {\n\t\t// \tcommit: fileCommit,\n\t\t// \tshowOptions: options,\n\t\t// };\n\t\t// void (await commands.executeCommand(Commands.DiffWithPrevious, fileCommit.toGitUri(), commandArgs));\n\t}\n}\n\nexport class CommitBrowseRepositoryFromHereCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(\n\t\tprivate readonly commit: GitLogCommit,\n\t\tprivate readonly executeOptions?: {\n\t\t\tbefore?: boolean;\n\t\t\topenInNewWindow: boolean;\n\t\t},\n\t\titem?: QuickPickItem,\n\t) {\n\t\tsuper(\n\t\t\titem ??\n\t\t\t\t`$(folder-opened) Browse Repository from${executeOptions?.before ? ' Before' : ''} Here${\n\t\t\t\t\texecuteOptions?.openInNewWindow ? ' in New Window' : ''\n\t\t\t\t}`,\n\t\t);\n\t}\n\n\toverride execute(_options: { preserveFocus?: boolean; preview?: boolean }): Promise<void> {\n\t\treturn GitActions.browseAtRevision(this.commit.toGitUri(), {\n\t\t\tbefore: this.executeOptions?.before,\n\t\t\topenInNewWindow: this.executeOptions?.openInNewWindow,\n\t\t});\n\t}\n}\n\nexport class CommitCompareWithHEADCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, item?: QuickPickItem) {\n\t\tsuper(item ?? '$(compare-changes) Compare with HEAD');\n\t}\n\n\toverride execute(_options: { preserveFocus?: boolean; preview?: boolean }): Promise<void> {\n\t\treturn Container.searchAndCompareView.compare(this.commit.repoPath, this.commit.ref, 'HEAD');\n\t}\n}\n\nexport class CommitCompareWithWorkingCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, item?: QuickPickItem) {\n\t\tsuper(item ?? '$(compare-changes) Compare with Working Tree');\n\t}\n\n\toverride execute(_options: { preserveFocus?: boolean; preview?: boolean }): Promise<void> {\n\t\treturn Container.searchAndCompareView.compare(this.commit.repoPath, this.commit.ref, '');\n\t}\n}\n\nexport class CommitCopyIdQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, item?: QuickPickItem) {\n\t\tsuper(item ?? '$(clippy) Copy SHA');\n\t}\n\n\toverride execute(): Promise<void> {\n\t\treturn GitActions.Commit.copyIdToClipboard(this.commit);\n\t}\n\n\toverride async onDidPressKey(key: Keys): Promise<void> {\n\t\tawait super.onDidPressKey(key);\n\t\tvoid window.showInformationMessage('Commit SHA copied to the clipboard');\n\t}\n}\n\nexport class CommitCopyMessageQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, item?: QuickPickItem) {\n\t\tsuper(item ?? '$(clippy) Copy Message');\n\t}\n\n\toverride execute(): Promise<void> {\n\t\treturn GitActions.Commit.copyMessageToClipboard(this.commit);\n\t}\n\n\toverride async onDidPressKey(key: Keys): Promise<void> {\n\t\tawait super.onDidPressKey(key);\n\t\tvoid window.showInformationMessage(\n\t\t\t`${this.commit.isStash ? 'Stash' : 'Commit'} Message copied to the clipboard`,\n\t\t);\n\t}\n}\n\nexport class CommitOpenAllChangesCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, item?: QuickPickItem) {\n\t\tsuper(item ?? '$(git-compare) Open All Changes');\n\t}\n\n\toverride execute(options: { preserveFocus?: boolean; preview?: boolean }): Promise<void> {\n\t\treturn GitActions.Commit.openAllChanges(this.commit, options);\n\t}\n}\n\nexport class CommitOpenAllChangesWithDiffToolCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, item?: QuickPickItem) {\n\t\tsuper(item ?? '$(git-compare) Open All Changes (difftool)');\n\t}\n\n\toverride execute(): Promise<void> {\n\t\treturn GitActions.Commit.openAllChangesWithDiffTool(this.commit);\n\t}\n}\n\nexport class CommitOpenAllChangesWithWorkingCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, item?: QuickPickItem) {\n\t\tsuper(item ?? '$(git-compare) Open All Changes with Working Tree');\n\t}\n\n\toverride execute(options: { preserveFocus?: boolean; preview?: boolean }): Promise<void> {\n\t\treturn GitActions.Commit.openAllChangesWithWorking(this.commit, options);\n\t}\n}\n\nexport class CommitOpenChangesCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, private readonly file: string | GitFile, item?: QuickPickItem) {\n\t\tsuper(item ?? '$(git-compare) Open Changes');\n\t}\n\n\toverride execute(options: { preserveFocus?: boolean; preview?: boolean }): Promise<void> {\n\t\treturn GitActions.Commit.openChanges(this.file, this.commit, options);\n\t}\n}\n\nexport class CommitOpenChangesWithDiffToolCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, private readonly file: string | GitFile, item?: QuickPickItem) {\n\t\tsuper(item ?? '$(git-compare) Open Changes (difftool)');\n\t}\n\n\toverride execute(): Promise<void> {\n\t\treturn GitActions.Commit.openChangesWithDiffTool(this.file, this.commit);\n\t}\n}\n\nexport class CommitOpenChangesWithWorkingCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, private readonly file: string | GitFile, item?: QuickPickItem) {\n\t\tsuper(item ?? '$(git-compare) Open Changes with Working File');\n\t}\n\n\toverride execute(options: { preserveFocus?: boolean; preview?: boolean }): Promise<void> {\n\t\treturn GitActions.Commit.openChangesWithWorking(this.file, this.commit, options);\n\t}\n}\n\nexport class CommitOpenDirectoryCompareCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, item?: QuickPickItem) {\n\t\tsuper(item ?? '$(git-compare) Open Directory Compare');\n\t}\n\n\toverride execute(): Promise<void> {\n\t\treturn GitActions.Commit.openDirectoryCompareWithPrevious(this.commit);\n\t}\n}\n\nexport class CommitOpenDirectoryCompareWithWorkingCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, item?: QuickPickItem) {\n\t\tsuper(item ?? '$(git-compare) Open Directory Compare with Working Tree');\n\t}\n\n\toverride execute(): Promise<void> {\n\t\treturn GitActions.Commit.openDirectoryCompareWithWorking(this.commit);\n\t}\n}\n\nexport class CommitOpenFilesCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, item?: QuickPickItem) {\n\t\tsuper(item ?? '$(files) Open Files');\n\t}\n\n\toverride execute(_options: { preserveFocus?: boolean; preview?: boolean }): Promise<void> {\n\t\treturn GitActions.Commit.openFiles(this.commit);\n\t}\n}\n\nexport class CommitOpenFileCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, private readonly file: string | GitFile, item?: QuickPickItem) {\n\t\tsuper(item ?? '$(file) Open File');\n\t}\n\n\toverride execute(options?: { preserveFocus?: boolean; preview?: boolean }): Promise<void> {\n\t\treturn GitActions.Commit.openFile(this.file, this.commit, options);\n\t}\n}\n\nexport class CommitOpenRevisionsCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, item?: QuickPickItem) {\n\t\tsuper(item ?? '$(files) Open Files at Revision');\n\t}\n\n\toverride execute(_options: { preserveFocus?: boolean; preview?: boolean }): Promise<void> {\n\t\treturn GitActions.Commit.openFilesAtRevision(this.commit);\n\t}\n}\n\nexport class CommitOpenRevisionCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, private readonly file: string | GitFile, item?: QuickPickItem) {\n\t\tsuper(item ?? '$(file) Open File at Revision');\n\t}\n\n\toverride execute(options?: { preserveFocus?: boolean; preview?: boolean }): Promise<void> {\n\t\treturn GitActions.Commit.openFileAtRevision(this.file, this.commit, options);\n\t}\n}\n\nexport class CommitApplyFileChangesCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, private readonly file: string | GitFile, item?: QuickPickItem) {\n\t\tsuper(item ?? 'Apply Changes');\n\t}\n\n\toverride async execute(): Promise<void> {\n\t\treturn GitActions.Commit.applyChanges(this.file, this.commit);\n\t}\n}\n\nexport class CommitRestoreFileChangesCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, private readonly file: string | GitFile, item?: QuickPickItem) {\n\t\tsuper(\n\t\t\titem ?? {\n\t\t\t\tlabel: 'Restore',\n\t\t\t\tdescription: 'aka checkout',\n\t\t\t},\n\t\t);\n\t}\n\n\toverride execute(): Promise<void> {\n\t\treturn GitActions.Commit.restoreFile(this.file, this.commit);\n\t}\n}\n\nexport class OpenChangedFilesCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(files: GitStatusFile[], item?: QuickPickItem) {\n\t\tconst commandArgs: OpenChangedFilesCommandArgs = {\n\t\t\turis: files.map(f => f.uri),\n\t\t};\n\n\t\tsuper(item ?? '$(files) Open All Changed Files', Commands.OpenChangedFiles, [commandArgs]);\n\t}\n}\n","'use strict';\nimport { Disposable, window } from 'vscode';\nimport { configuration } from '../configuration';\nimport { Container } from '../container';\nimport { GitLog, GitLogCommit } from '../git/git';\nimport { KeyboardScope, Keys } from '../keyboard';\nimport {\n\tCommandQuickPickItem,\n\tCommitQuickPickItem,\n\tDirective,\n\tDirectiveQuickPickItem,\n\tgetQuickPickIgnoreFocusOut,\n} from '../quickpicks';\nimport { Iterables, Promises } from '../system';\n\nexport namespace CommitPicker {\n\texport async function show(\n\t\tlog: GitLog | undefined | Promise<GitLog | undefined>,\n\t\ttitle: string,\n\t\tplaceholder: string,\n\t\toptions?: {\n\t\t\tpicked?: string;\n\t\t\tkeys?: Keys[];\n\t\t\tonDidPressKey?(key: Keys, item: CommitQuickPickItem): void | Promise<void>;\n\t\t\tshowOtherReferences?: CommandQuickPickItem;\n\t\t},\n\t): Promise<GitLogCommit | undefined> {\n\t\tconst quickpick = window.createQuickPick<CommandQuickPickItem | CommitQuickPickItem | DirectiveQuickPickItem>();\n\t\tquickpick.ignoreFocusOut = getQuickPickIgnoreFocusOut();\n\n\t\tquickpick.title = title;\n\t\tquickpick.placeholder = placeholder;\n\t\tquickpick.matchOnDescription = true;\n\t\tquickpick.matchOnDetail = true;\n\n\t\tif (Promises.is(log)) {\n\t\t\tquickpick.busy = true;\n\t\t\tquickpick.enabled = false;\n\t\t\tquickpick.show();\n\n\t\t\tlog = await log;\n\n\t\t\tif (log == null) {\n\t\t\t\tquickpick.placeholder = 'Unable to show commit history';\n\t\t\t}\n\t\t}\n\n\t\tquickpick.items = getItems(log);\n\n\t\tif (options?.picked) {\n\t\t\tquickpick.activeItems = quickpick.items.filter(i => (CommandQuickPickItem.is(i) ? false : i.picked));\n\t\t}\n\n\t\tfunction getItems(log: GitLog | undefined) {\n\t\t\treturn log == null\n\t\t\t\t? [DirectiveQuickPickItem.create(Directive.Cancel)]\n\t\t\t\t: [\n\t\t\t\t\t\t...(options?.showOtherReferences != null ? [options?.showOtherReferences] : []),\n\t\t\t\t\t\t...Iterables.map(log.commits.values(), commit =>\n\t\t\t\t\t\t\tCommitQuickPickItem.create(commit, options?.picked === commit.ref, {\n\t\t\t\t\t\t\t\tcompact: true,\n\t\t\t\t\t\t\t\ticon: true,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t),\n\t\t\t\t\t\t...(log?.hasMore ? [DirectiveQuickPickItem.create(Directive.LoadMore)] : []),\n\t\t\t\t  ];\n\t\t}\n\n\t\tasync function loadMore() {\n\t\t\tquickpick.busy = true;\n\t\t\tquickpick.enabled = false;\n\n\t\t\ttry {\n\t\t\t\tlog = await (await log)?.more?.(configuration.get('advanced.maxListItems'));\n\t\t\t\tconst items = getItems(log);\n\n\t\t\t\tlet activeIndex = -1;\n\t\t\t\tif (quickpick.activeItems.length !== 0) {\n\t\t\t\t\tconst active = quickpick.activeItems[0];\n\t\t\t\t\tactiveIndex = quickpick.items.indexOf(active);\n\n\t\t\t\t\t// If the active item is the \"Load more\" directive, then select the previous item\n\t\t\t\t\tif (DirectiveQuickPickItem.is(active)) {\n\t\t\t\t\t\tactiveIndex--;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tquickpick.items = items;\n\n\t\t\t\tif (activeIndex) {\n\t\t\t\t\tquickpick.activeItems = [quickpick.items[activeIndex]];\n\t\t\t\t}\n\t\t\t} finally {\n\t\t\t\tquickpick.busy = false;\n\t\t\t\tquickpick.enabled = true;\n\t\t\t}\n\t\t}\n\n\t\tconst disposables: Disposable[] = [];\n\n\t\tlet scope: KeyboardScope | undefined;\n\t\tif (options?.keys != null && options.keys.length !== 0 && options?.onDidPressKey !== null) {\n\t\t\tscope = Container.keyboard.createScope(\n\t\t\t\tObject.fromEntries(\n\t\t\t\t\toptions.keys.map(key => [\n\t\t\t\t\t\tkey,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tonDidPressKey: key => {\n\t\t\t\t\t\t\t\tif (quickpick.activeItems.length !== 0) {\n\t\t\t\t\t\t\t\t\tconst [item] = quickpick.activeItems;\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\titem != null &&\n\t\t\t\t\t\t\t\t\t\t!DirectiveQuickPickItem.is(item) &&\n\t\t\t\t\t\t\t\t\t\t!CommandQuickPickItem.is(item)\n\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\tvoid options.onDidPressKey!(key, item);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t]),\n\t\t\t\t),\n\t\t\t);\n\t\t\tvoid scope.start();\n\t\t\tdisposables.push(scope);\n\t\t}\n\n\t\ttry {\n\t\t\tconst pick = await new Promise<\n\t\t\t\tCommandQuickPickItem | CommitQuickPickItem | DirectiveQuickPickItem | undefined\n\t\t\t>(resolve => {\n\t\t\t\tdisposables.push(\n\t\t\t\t\tquickpick.onDidHide(() => resolve(undefined)),\n\t\t\t\t\tquickpick.onDidAccept(() => {\n\t\t\t\t\t\tif (quickpick.activeItems.length !== 0) {\n\t\t\t\t\t\t\tconst [item] = quickpick.activeItems;\n\t\t\t\t\t\t\tif (DirectiveQuickPickItem.is(item)) {\n\t\t\t\t\t\t\t\tswitch (item.directive) {\n\t\t\t\t\t\t\t\t\tcase Directive.LoadMore:\n\t\t\t\t\t\t\t\t\t\tvoid loadMore();\n\t\t\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\tresolve(undefined);\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tresolve(item);\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tquickpick.onDidChangeValue(async e => {\n\t\t\t\t\t\tif (scope == null) return;\n\n\t\t\t\t\t\t// Pause the left/right keyboard commands if there is a value, otherwise the left/right arrows won't work in the input properly\n\t\t\t\t\t\tif (e.length !== 0) {\n\t\t\t\t\t\t\tawait scope.pause(['left', 'right']);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tawait scope.resume();\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t);\n\n\t\t\t\tquickpick.busy = false;\n\t\t\t\tquickpick.enabled = true;\n\n\t\t\t\tquickpick.show();\n\t\t\t});\n\t\t\tif (pick == null || DirectiveQuickPickItem.is(pick)) return undefined;\n\n\t\t\tif (pick instanceof CommandQuickPickItem) {\n\t\t\t\tvoid (await pick.execute());\n\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn pick.item;\n\t\t} finally {\n\t\t\tquickpick.dispose();\n\t\t\tdisposables.forEach(d => d.dispose());\n\t\t}\n\t}\n}\n","'use strict';\nimport { QuickPickItem, window } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\n\nexport interface ModesQuickPickItem extends QuickPickItem {\n\tkey: string | undefined;\n}\n\nexport namespace ModePicker {\n\texport async function show(): Promise<ModesQuickPickItem | undefined> {\n\t\tif (Container.config.modes == null) return undefined;\n\n\t\tconst modes = Container.config.modes;\n\t\tconst modeKeys = Object.keys(modes);\n\t\tif (modeKeys.length === 0) return undefined;\n\n\t\tconst mode = Container.config.mode.active;\n\n\t\tconst items = modeKeys.map(key => {\n\t\t\tconst modeCfg = modes[key];\n\t\t\tconst item: ModesQuickPickItem = {\n\t\t\t\tlabel: `${mode === key ? '$(check)\\u00a0\\u00a0' : '\\u00a0\\u00a0\\u00a0\\u00a0\\u00a0'}${\n\t\t\t\t\tmodeCfg.name\n\t\t\t\t} mode`,\n\t\t\t\tdescription: modeCfg.description ? `\\u00a0${GlyphChars.Dash}\\u00a0 ${modeCfg.description}` : '',\n\t\t\t\tkey: key,\n\t\t\t};\n\t\t\treturn item;\n\t\t});\n\n\t\tif (mode) {\n\t\t\titems.splice(0, 0, {\n\t\t\t\tlabel: `Exit ${modes[mode].name} mode`,\n\t\t\t\tkey: undefined,\n\t\t\t});\n\t\t}\n\n\t\tconst pick = await window.showQuickPick(items, {\n\t\t\tplaceHolder: 'select a GitLens mode to enter',\n\t\t});\n\n\t\treturn pick;\n\t}\n}\n","'use strict';\nimport { CancellationTokenSource, Disposable, QuickPick, window } from 'vscode';\nimport { getBranchesAndOrTags, getValidateGitReferenceFn } from '../commands/quickCommand';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { BranchSortOptions, GitBranch, GitReference, GitTag, TagSortOptions } from '../git/git';\nimport { KeyboardScope, Keys } from '../keyboard';\nimport { BranchQuickPickItem, getQuickPickIgnoreFocusOut, RefQuickPickItem, TagQuickPickItem } from '../quickpicks';\n\nexport type ReferencesQuickPickItem = BranchQuickPickItem | TagQuickPickItem | RefQuickPickItem;\n\nexport enum ReferencesQuickPickIncludes {\n\tBranches = 1,\n\tTags = 2,\n\tWorkingTree = 4,\n\tHEAD = 8,\n\n\tBranchesAndTags = 3,\n}\n\nexport interface ReferencesQuickPickOptions {\n\tallowEnteringRefs?: boolean | { ranges?: boolean };\n\tautoPick?: boolean;\n\tpicked?: string;\n\tfilter?: { branches?(b: GitBranch): boolean; tags?(t: GitTag): boolean };\n\tinclude?: ReferencesQuickPickIncludes;\n\tkeys?: Keys[];\n\tonDidPressKey?(key: Keys, quickpick: QuickPick<ReferencesQuickPickItem>): void | Promise<void>;\n\tsort?: boolean | { branches?: BranchSortOptions; tags?: TagSortOptions };\n}\n\nexport namespace ReferencePicker {\n\texport async function show(\n\t\trepoPath: string,\n\t\ttitle: string,\n\t\tplaceHolder: string,\n\t\toptions: ReferencesQuickPickOptions = {},\n\t): Promise<GitReference | undefined> {\n\t\tconst quickpick = window.createQuickPick<ReferencesQuickPickItem>();\n\t\tquickpick.ignoreFocusOut = getQuickPickIgnoreFocusOut();\n\n\t\tquickpick.title = title;\n\t\tquickpick.placeholder =\n\t\t\toptions.allowEnteringRefs != null\n\t\t\t\t? `${placeHolder}${GlyphChars.Space.repeat(3)}(or enter a reference using #)`\n\t\t\t\t: placeHolder;\n\t\tquickpick.matchOnDescription = true;\n\n\t\tconst disposables: Disposable[] = [];\n\n\t\tlet scope: KeyboardScope | undefined;\n\t\tif (options?.keys != null && options.keys.length !== 0 && options?.onDidPressKey !== null) {\n\t\t\tscope = Container.keyboard.createScope(\n\t\t\t\tObject.fromEntries(\n\t\t\t\t\toptions.keys.map(key => [\n\t\t\t\t\t\tkey,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tonDidPressKey: key => {\n\t\t\t\t\t\t\t\tif (quickpick.activeItems.length !== 0) {\n\t\t\t\t\t\t\t\t\tvoid options.onDidPressKey!(key, quickpick);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t]),\n\t\t\t\t),\n\t\t\t);\n\t\t\tvoid scope.start();\n\t\t\tdisposables.push(scope);\n\t\t}\n\n\t\tconst cancellation = new CancellationTokenSource();\n\n\t\tlet autoPick;\n\t\tlet items = getItems(repoPath, options);\n\t\tif (options.autoPick) {\n\t\t\titems = items.then(itms => {\n\t\t\t\tif (itms.length <= 1) {\n\t\t\t\t\tautoPick = itms[0];\n\t\t\t\t\tcancellation.cancel();\n\t\t\t\t}\n\t\t\t\treturn itms;\n\t\t\t});\n\t\t}\n\n\t\tquickpick.busy = true;\n\t\tquickpick.enabled = false;\n\n\t\tquickpick.show();\n\n\t\tconst getValidateGitReference = getValidateGitReferenceFn((await Container.git.getRepository(repoPath))!, {\n\t\t\tranges:\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n\t\t\t\toptions?.allowEnteringRefs && typeof options.allowEnteringRefs !== 'boolean'\n\t\t\t\t\t? options.allowEnteringRefs.ranges\n\t\t\t\t\t: undefined,\n\t\t});\n\n\t\tquickpick.items = await items;\n\n\t\tquickpick.busy = false;\n\t\tquickpick.enabled = true;\n\n\t\ttry {\n\t\t\tlet pick = await new Promise<ReferencesQuickPickItem | undefined>(resolve => {\n\t\t\t\tdisposables.push(\n\t\t\t\t\tcancellation.token.onCancellationRequested(() => quickpick.hide()),\n\t\t\t\t\tquickpick.onDidHide(() => resolve(undefined)),\n\t\t\t\t\tquickpick.onDidAccept(() => {\n\t\t\t\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\t\t\t\tresolve(quickpick.activeItems[0]);\n\t\t\t\t\t}),\n\t\t\t\t\tquickpick.onDidChangeValue(async e => {\n\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n\t\t\t\t\t\tif (options.allowEnteringRefs) {\n\t\t\t\t\t\t\tif (!(await getValidateGitReference(quickpick, e))) {\n\t\t\t\t\t\t\t\tquickpick.items = await items;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (scope == null) return;\n\n\t\t\t\t\t\t// Pause the left/right keyboard commands if there is a value, otherwise the left/right arrows won't work in the input properly\n\t\t\t\t\t\tif (e.length !== 0) {\n\t\t\t\t\t\t\tawait scope.pause(['left', 'right']);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tawait scope.resume();\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t);\n\t\t\t});\n\t\t\tif (pick == null && autoPick != null) {\n\t\t\t\tpick = autoPick;\n\t\t\t}\n\t\t\tif (pick == null) return undefined;\n\n\t\t\treturn pick.item;\n\t\t} finally {\n\t\t\tquickpick.dispose();\n\t\t\tdisposables.forEach(d => d.dispose());\n\t\t}\n\t}\n\n\tasync function getItems(\n\t\trepoPath: string,\n\t\t{ picked, filter, include, sort }: ReferencesQuickPickOptions,\n\t): Promise<ReferencesQuickPickItem[]> {\n\t\tinclude = include ?? ReferencesQuickPickIncludes.BranchesAndTags;\n\n\t\tconst items: ReferencesQuickPickItem[] = await getBranchesAndOrTags(\n\t\t\t(await Container.git.getRepository(repoPath))!,\n\t\t\tinclude && ReferencesQuickPickIncludes.BranchesAndTags\n\t\t\t\t? ['branches', 'tags']\n\t\t\t\t: include && ReferencesQuickPickIncludes.Branches\n\t\t\t\t? ['branches']\n\t\t\t\t: include && ReferencesQuickPickIncludes.Tags\n\t\t\t\t? ['tags']\n\t\t\t\t: [],\n\t\t\t{\n\t\t\t\tfilter: filter,\n\t\t\t\tpicked: picked,\n\t\t\t\tsort: sort ?? { branches: { current: false }, tags: {} },\n\t\t\t},\n\t\t);\n\n\t\t// Move the picked item to the top\n\t\tif (picked) {\n\t\t\tconst index = items.findIndex(i => i.ref === picked);\n\t\t\tif (index !== -1) {\n\t\t\t\titems.splice(0, 0, ...items.splice(index, 1));\n\t\t\t}\n\t\t}\n\n\t\tif (include & ReferencesQuickPickIncludes.HEAD) {\n\t\t\titems.splice(0, 0, RefQuickPickItem.create('HEAD', repoPath, undefined, { icon: true }));\n\t\t}\n\n\t\tif (include & ReferencesQuickPickIncludes.WorkingTree) {\n\t\t\titems.splice(0, 0, RefQuickPickItem.create('', repoPath, undefined, { icon: true }));\n\t\t}\n\n\t\treturn items;\n\t}\n}\n","'use strict';\nimport { Disposable, env, Uri, window } from 'vscode';\nimport { Commands, OpenOnRemoteCommandArgs } from '../commands';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport {\n\tgetNameFromRemoteResource,\n\tGitBranch,\n\tGitRemote,\n\tRemoteProvider,\n\tRemoteResource,\n\tRemoteResourceType,\n} from '../git/git';\nimport { Keys } from '../keyboard';\nimport { CommandQuickPickItem, getQuickPickIgnoreFocusOut } from '../quickpicks';\n\nexport class ConfigureCustomRemoteProviderCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor() {\n\t\tsuper({ label: 'See how to configure a custom remote provider...' });\n\t}\n\n\toverride async execute(): Promise<void> {\n\t\tawait env.openExternal(\n\t\t\tUri.parse('https://github.com/eamodio/vscode-gitlens#remote-provider-integration-settings-'),\n\t\t);\n\t}\n}\n\nexport class CopyOrOpenRemoteCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(\n\t\tprivate readonly remote: GitRemote<RemoteProvider>,\n\t\tprivate readonly resource: RemoteResource,\n\t\tprivate readonly clipboard?: boolean,\n\t) {\n\t\tsuper({\n\t\t\tlabel: `$(repo) ${remote.provider.path}`,\n\t\t\tdescription: remote.name,\n\t\t});\n\t}\n\n\toverride async execute(): Promise<void> {\n\t\tlet resource = this.resource;\n\t\tif (resource.type === RemoteResourceType.Comparison) {\n\t\t\tif (GitBranch.getRemote(resource.base) === this.remote.name) {\n\t\t\t\tresource = { ...resource, base: GitBranch.getNameWithoutRemote(resource.base) };\n\t\t\t}\n\n\t\t\tif (GitBranch.getRemote(resource.compare) === this.remote.name) {\n\t\t\t\tresource = { ...resource, compare: GitBranch.getNameWithoutRemote(resource.compare) };\n\t\t\t}\n\t\t} else if (resource.type === RemoteResourceType.CreatePullRequest) {\n\t\t\tlet branch = resource.base.branch;\n\t\t\tif (branch == null) {\n\t\t\t\tbranch = await Container.git.getDefaultBranchName(this.remote.repoPath, this.remote.name);\n\t\t\t\tif (branch == null && this.remote.provider.hasApi()) {\n\t\t\t\t\tconst defaultBranch = await this.remote.provider.getDefaultBranch?.();\n\t\t\t\t\tbranch = defaultBranch?.name;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tresource = {\n\t\t\t\t...resource,\n\t\t\t\tbase: { branch: branch, remote: { path: this.remote.path, url: this.remote.url } },\n\t\t\t};\n\t\t} else if (\n\t\t\tresource.type === RemoteResourceType.File &&\n\t\t\tresource.branchOrTag != null &&\n\t\t\t(this.remote.provider.id === 'bitbucket' || this.remote.provider.id === 'bitbucket-server')\n\t\t) {\n\t\t\t// HACK ALERT\n\t\t\t// Since Bitbucket can't support branch names in the url (other than with the default branch),\n\t\t\t// turn this into a `Revision` request\n\t\t\tconst { branchOrTag } = resource;\n\t\t\tconst branchesOrTags = await Container.git.getBranchesAndOrTags(this.remote.repoPath, {\n\t\t\t\tfilter: {\n\t\t\t\t\tbranches: b => b.name === branchOrTag || GitBranch.getNameWithoutRemote(b.name) === branchOrTag,\n\t\t\t\t\ttags: b => b.name === branchOrTag,\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tconst sha = branchesOrTags?.[0]?.sha;\n\t\t\tif (sha) {\n\t\t\t\tresource = { ...resource, type: RemoteResourceType.Revision, sha: sha };\n\t\t\t}\n\t\t}\n\n\t\tvoid (await (this.clipboard ? this.remote.provider.copy(resource) : this.remote.provider.open(resource)));\n\t}\n}\n\nexport class CopyRemoteResourceCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(remotes: GitRemote<RemoteProvider>[], resource: RemoteResource) {\n\t\tconst providers = GitRemote.getHighlanderProviders(remotes);\n\t\tconst commandArgs: OpenOnRemoteCommandArgs = {\n\t\t\tresource: resource,\n\t\t\tremotes: remotes,\n\t\t\tclipboard: true,\n\t\t};\n\t\tsuper(\n\t\t\t`$(clippy) Copy ${providers?.length ? providers[0].name : 'Remote'} ${getNameFromRemoteResource(\n\t\t\t\tresource,\n\t\t\t)} Url${providers?.length === 1 ? '' : GlyphChars.Ellipsis}`,\n\t\t\tCommands.OpenOnRemote,\n\t\t\t[commandArgs],\n\t\t);\n\t}\n\n\toverride async onDidPressKey(key: Keys): Promise<void> {\n\t\tawait super.onDidPressKey(key);\n\t\tvoid window.showInformationMessage('Url copied to the clipboard');\n\t}\n}\n\nexport class OpenRemoteResourceCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(remotes: GitRemote<RemoteProvider>[], resource: RemoteResource) {\n\t\tconst providers = GitRemote.getHighlanderProviders(remotes);\n\t\tconst commandArgs: OpenOnRemoteCommandArgs = {\n\t\t\tresource: resource,\n\t\t\tremotes: remotes,\n\t\t\tclipboard: false,\n\t\t};\n\t\tsuper(\n\t\t\t`$(link-external) Open ${getNameFromRemoteResource(resource)} on ${\n\t\t\t\tproviders?.length === 1\n\t\t\t\t\t? providers[0].name\n\t\t\t\t\t: `${providers?.length ? providers[0].name : 'Remote'}${GlyphChars.Ellipsis}`\n\t\t\t}`,\n\t\t\tCommands.OpenOnRemote,\n\t\t\t[commandArgs],\n\t\t);\n\t}\n}\n\nexport class SetADefaultRemoteCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly remotes: GitRemote<RemoteProvider>[]) {\n\t\tsuper({ label: 'Set a Default Remote...' });\n\t}\n\n\toverride async execute(): Promise<GitRemote<RemoteProvider> | undefined> {\n\t\treturn RemoteProviderPicker.setADefaultRemote(this.remotes);\n\t}\n}\n\nexport class SetRemoteAsDefaultCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly remote: GitRemote<RemoteProvider>) {\n\t\tsuper({\n\t\t\tlabel: remote.provider.name,\n\t\t\tdetail: `$(repo) ${remote.provider.path}`,\n\t\t});\n\t}\n\n\toverride async execute(): Promise<GitRemote<RemoteProvider>> {\n\t\tvoid (await this.remote.setAsDefault(true));\n\t\treturn this.remote;\n\t}\n}\n\nexport namespace RemoteProviderPicker {\n\texport async function show(\n\t\ttitle: string,\n\t\tplaceHolder: string,\n\t\tresource: RemoteResource,\n\t\tremotes: GitRemote<RemoteProvider>[],\n\t\toptions?: { autoPick?: 'default' | boolean; clipboard?: boolean; setDefault?: boolean },\n\t): Promise<\n\t\t| ConfigureCustomRemoteProviderCommandQuickPickItem\n\t\t| CopyOrOpenRemoteCommandQuickPickItem\n\t\t| SetADefaultRemoteCommandQuickPickItem\n\t\t| undefined\n\t> {\n\t\tconst { autoPick, clipboard, setDefault } = { autoPick: false, clipboard: false, setDefault: true, ...options };\n\n\t\tlet items: (\n\t\t\t| ConfigureCustomRemoteProviderCommandQuickPickItem\n\t\t\t| CopyOrOpenRemoteCommandQuickPickItem\n\t\t\t| SetADefaultRemoteCommandQuickPickItem\n\t\t)[];\n\t\tif (remotes.length === 0) {\n\t\t\titems = [new ConfigureCustomRemoteProviderCommandQuickPickItem()];\n\t\t\tplaceHolder = 'No auto-detected or configured remote providers found';\n\t\t} else {\n\t\t\tif (autoPick === 'default' && remotes.length > 1) {\n\t\t\t\t// If there is a default just execute it directly\n\t\t\t\tconst remote = remotes.find(r => r.default);\n\t\t\t\tif (remote != null) {\n\t\t\t\t\tremotes = [remote];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\titems = remotes.map(r => new CopyOrOpenRemoteCommandQuickPickItem(r, resource, clipboard));\n\t\t\tif (setDefault) {\n\t\t\t\titems.push(new SetADefaultRemoteCommandQuickPickItem(remotes));\n\t\t\t}\n\t\t}\n\n\t\t// eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n\t\tif (autoPick && remotes.length === 1) return items[0];\n\n\t\tconst quickpick = window.createQuickPick<\n\t\t\t| ConfigureCustomRemoteProviderCommandQuickPickItem\n\t\t\t| CopyOrOpenRemoteCommandQuickPickItem\n\t\t\t| SetADefaultRemoteCommandQuickPickItem\n\t\t>();\n\t\tquickpick.ignoreFocusOut = getQuickPickIgnoreFocusOut();\n\n\t\tconst disposables: Disposable[] = [];\n\n\t\ttry {\n\t\t\tconst pick = await new Promise<\n\t\t\t\t| ConfigureCustomRemoteProviderCommandQuickPickItem\n\t\t\t\t| CopyOrOpenRemoteCommandQuickPickItem\n\t\t\t\t| SetADefaultRemoteCommandQuickPickItem\n\t\t\t\t| undefined\n\t\t\t>(resolve => {\n\t\t\t\tdisposables.push(\n\t\t\t\t\tquickpick.onDidHide(() => resolve(undefined)),\n\t\t\t\t\tquickpick.onDidAccept(() => {\n\t\t\t\t\t\tif (quickpick.activeItems.length !== 0) {\n\t\t\t\t\t\t\tresolve(quickpick.activeItems[0]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t);\n\n\t\t\t\tquickpick.title = title;\n\t\t\t\tquickpick.placeholder = placeHolder;\n\t\t\t\tquickpick.matchOnDetail = true;\n\t\t\t\tquickpick.items = items;\n\n\t\t\t\tquickpick.show();\n\t\t\t});\n\t\t\tif (pick == null) return undefined;\n\n\t\t\treturn pick;\n\t\t} finally {\n\t\t\tquickpick.dispose();\n\t\t\tdisposables.forEach(d => d.dispose());\n\t\t}\n\t}\n\n\texport async function setADefaultRemote(\n\t\tremotes: GitRemote<RemoteProvider>[],\n\t): Promise<GitRemote<RemoteProvider> | undefined> {\n\t\tconst items = remotes.map(r => new SetRemoteAsDefaultCommandQuickPickItem(r));\n\n\t\tconst quickpick = window.createQuickPick<SetRemoteAsDefaultCommandQuickPickItem>();\n\t\tquickpick.ignoreFocusOut = getQuickPickIgnoreFocusOut();\n\n\t\tconst disposables: Disposable[] = [];\n\n\t\ttry {\n\t\t\tconst pick = await new Promise<SetRemoteAsDefaultCommandQuickPickItem | undefined>(resolve => {\n\t\t\t\tdisposables.push(\n\t\t\t\t\tquickpick.onDidHide(() => resolve(undefined)),\n\t\t\t\t\tquickpick.onDidAccept(() => {\n\t\t\t\t\t\tif (quickpick.activeItems.length !== 0) {\n\t\t\t\t\t\t\tresolve(quickpick.activeItems[0]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t);\n\n\t\t\t\tquickpick.title = 'Set a Default Remote';\n\t\t\t\tquickpick.placeholder = 'Choose which remote to set as the default';\n\t\t\t\tquickpick.matchOnDetail = true;\n\t\t\t\tquickpick.items = items;\n\n\t\t\t\tquickpick.show();\n\t\t\t});\n\t\t\tif (pick == null) return undefined;\n\n\t\t\treturn await pick.execute();\n\t\t} finally {\n\t\t\tquickpick.dispose();\n\t\t\tdisposables.forEach(d => d.dispose());\n\t\t}\n\t}\n}\n","'use strict';\n\nimport { configuration } from './configuration';\n\nexport function getQuickPickIgnoreFocusOut() {\n\treturn !configuration.get('advanced.quickPick.closeOnFocusOut');\n}\n\nexport * from './quickpicks/quickPicksItems';\nexport * from './quickpicks/gitQuickPickItems';\nexport * from './quickpicks/commitQuickPickItems';\n\nexport * from './quickpicks/commitPicker';\nexport * from './quickpicks/modePicker';\nexport * from './quickpicks/referencePicker';\nexport * from './quickpicks/remoteProviderPicker';\nexport * from './quickpicks/repositoryPicker';\n","'use strict';\nimport { Disposable, window } from 'vscode';\nimport { Container } from '../container';\nimport { Repository } from '../git/git';\nimport { getQuickPickIgnoreFocusOut, RepositoryQuickPickItem } from '../quickpicks';\nimport { Iterables } from '../system';\n\nexport namespace RepositoryPicker {\n\texport async function show(\n\t\ttitle: string | undefined,\n\t\tplaceholder: string = 'Choose a repository',\n\t\trepositories?: Repository[],\n\t): Promise<RepositoryQuickPickItem | undefined> {\n\t\tconst items: RepositoryQuickPickItem[] = await Promise.all([\n\t\t\t...Iterables.map(repositories ?? (await Container.git.getOrderedRepositories()), r =>\n\t\t\t\tRepositoryQuickPickItem.create(r, undefined, { branch: true, status: true }),\n\t\t\t),\n\t\t]);\n\n\t\tconst quickpick = window.createQuickPick<RepositoryQuickPickItem>();\n\t\tquickpick.ignoreFocusOut = getQuickPickIgnoreFocusOut();\n\n\t\tconst disposables: Disposable[] = [];\n\n\t\ttry {\n\t\t\tconst pick = await new Promise<RepositoryQuickPickItem | undefined>(resolve => {\n\t\t\t\tdisposables.push(\n\t\t\t\t\tquickpick.onDidHide(() => resolve(undefined)),\n\t\t\t\t\tquickpick.onDidAccept(() => {\n\t\t\t\t\t\tif (quickpick.activeItems.length !== 0) {\n\t\t\t\t\t\t\tresolve(quickpick.activeItems[0]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t);\n\n\t\t\t\tquickpick.title = title;\n\t\t\t\tquickpick.placeholder = placeholder;\n\t\t\t\tquickpick.matchOnDescription = true;\n\t\t\t\tquickpick.matchOnDetail = true;\n\t\t\t\tquickpick.items = items;\n\n\t\t\t\tquickpick.show();\n\t\t\t});\n\t\t\tif (pick == null) return undefined;\n\n\t\t\treturn pick;\n\t\t} finally {\n\t\t\tquickpick.dispose();\n\t\t\tdisposables.forEach(d => d.dispose());\n\t\t}\n\t}\n}\n","/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nexport default baseFindIndex;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nexport default listCacheClear;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nexport default eq;\n","import eq from './eq.js';\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nexport default assocIndexOf;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nexport default listCacheDelete;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nexport default listCacheGet;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nexport default listCacheHas;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nexport default listCacheSet;\n","import listCacheClear from './_listCacheClear.js';\nimport listCacheDelete from './_listCacheDelete.js';\nimport listCacheGet from './_listCacheGet.js';\nimport listCacheHas from './_listCacheHas.js';\nimport listCacheSet from './_listCacheSet.js';\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nexport default ListCache;\n","import ListCache from './_ListCache.js';\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nexport default stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nexport default stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nexport default stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nexport default stackHas;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nexport default isObject;\n","import baseGetTag from './_baseGetTag.js';\nimport isObject from './isObject.js';\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nexport default isFunction;\n","import root from './_root.js';\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nexport default coreJsData;\n","import coreJsData from './_coreJsData.js';\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nexport default isMasked;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nexport default toSource;\n","import isFunction from './isFunction.js';\nimport isMasked from './_isMasked.js';\nimport isObject from './isObject.js';\nimport toSource from './_toSource.js';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nexport default baseIsNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nexport default getValue;\n","import baseIsNative from './_baseIsNative.js';\nimport getValue from './_getValue.js';\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nexport default getNative;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nexport default Map;\n","import getNative from './_getNative.js';\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nexport default nativeCreate;\n","import nativeCreate from './_nativeCreate.js';\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nexport default hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default hashDelete;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nexport default hashGet;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nexport default hashHas;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nexport default hashSet;\n","import hashClear from './_hashClear.js';\nimport hashDelete from './_hashDelete.js';\nimport hashGet from './_hashGet.js';\nimport hashHas from './_hashHas.js';\nimport hashSet from './_hashSet.js';\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nexport default Hash;\n","import Hash from './_Hash.js';\nimport ListCache from './_ListCache.js';\nimport Map from './_Map.js';\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nexport default mapCacheClear;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nexport default isKeyable;\n","import isKeyable from './_isKeyable.js';\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nexport default getMapData;\n","import getMapData from './_getMapData.js';\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default mapCacheDelete;\n","import getMapData from './_getMapData.js';\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nexport default mapCacheGet;\n","import getMapData from './_getMapData.js';\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nexport default mapCacheHas;\n","import getMapData from './_getMapData.js';\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nexport default mapCacheSet;\n","import mapCacheClear from './_mapCacheClear.js';\nimport mapCacheDelete from './_mapCacheDelete.js';\nimport mapCacheGet from './_mapCacheGet.js';\nimport mapCacheHas from './_mapCacheHas.js';\nimport mapCacheSet from './_mapCacheSet.js';\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nexport default MapCache;\n","import ListCache from './_ListCache.js';\nimport Map from './_Map.js';\nimport MapCache from './_MapCache.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nexport default stackSet;\n","import ListCache from './_ListCache.js';\nimport stackClear from './_stackClear.js';\nimport stackDelete from './_stackDelete.js';\nimport stackGet from './_stackGet.js';\nimport stackHas from './_stackHas.js';\nimport stackSet from './_stackSet.js';\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nexport default Stack;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nexport default setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nexport default setCacheHas;\n","import MapCache from './_MapCache.js';\nimport setCacheAdd from './_setCacheAdd.js';\nimport setCacheHas from './_setCacheHas.js';\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nexport default SetCache;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arraySome;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nexport default cacheHas;\n","import SetCache from './_SetCache.js';\nimport arraySome from './_arraySome.js';\nimport cacheHas from './_cacheHas.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Check that cyclic values are equal.\n  var arrStacked = stack.get(array);\n  var othStacked = stack.get(other);\n  if (arrStacked && othStacked) {\n    return arrStacked == other && othStacked == array;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalArrays;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nexport default Uint8Array;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nexport default mapToArray;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nexport default setToArray;\n","import Symbol from './_Symbol.js';\nimport Uint8Array from './_Uint8Array.js';\nimport eq from './eq.js';\nimport equalArrays from './_equalArrays.js';\nimport mapToArray from './_mapToArray.js';\nimport setToArray from './_setToArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nexport default equalByTag;\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nexport default arrayPush;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nexport default isArray;\n","import arrayPush from './_arrayPush.js';\nimport isArray from './isArray.js';\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nexport default baseGetAllKeys;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nexport default arrayFilter;\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nexport default stubArray;\n","import arrayFilter from './_arrayFilter.js';\nimport stubArray from './stubArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nexport default getSymbols;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nexport default baseTimes;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nexport default baseIsArguments;\n","import baseIsArguments from './_baseIsArguments.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nexport default isArguments;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nexport default stubFalse;\n","import root from './_root.js';\nimport stubFalse from './stubFalse.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nexport default isBuffer;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nexport default isIndex;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nexport default isLength;\n","import baseGetTag from './_baseGetTag.js';\nimport isLength from './isLength.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nexport default baseIsTypedArray;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nexport default baseUnary;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nexport default nodeUtil;\n","import baseIsTypedArray from './_baseIsTypedArray.js';\nimport baseUnary from './_baseUnary.js';\nimport nodeUtil from './_nodeUtil.js';\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nexport default isTypedArray;\n","import baseTimes from './_baseTimes.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isIndex from './_isIndex.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default arrayLikeKeys;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nexport default isPrototype;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nexport default overArg;\n","import overArg from './_overArg.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nexport default nativeKeys;\n","import isPrototype from './_isPrototype.js';\nimport nativeKeys from './_nativeKeys.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default baseKeys;\n","import isFunction from './isFunction.js';\nimport isLength from './isLength.js';\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nexport default isArrayLike;\n","import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeys from './_baseKeys.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nexport default keys;\n","import baseGetAllKeys from './_baseGetAllKeys.js';\nimport getSymbols from './_getSymbols.js';\nimport keys from './keys.js';\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nexport default getAllKeys;\n","import getAllKeys from './_getAllKeys.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Check that cyclic values are equal.\n  var objStacked = stack.get(object);\n  var othStacked = stack.get(other);\n  if (objStacked && othStacked) {\n    return objStacked == other && othStacked == object;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalObjects;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nexport default DataView;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nexport default Promise;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nexport default Set;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nexport default WeakMap;\n","import DataView from './_DataView.js';\nimport Map from './_Map.js';\nimport Promise from './_Promise.js';\nimport Set from './_Set.js';\nimport WeakMap from './_WeakMap.js';\nimport baseGetTag from './_baseGetTag.js';\nimport toSource from './_toSource.js';\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nexport default getTag;\n","import Stack from './_Stack.js';\nimport equalArrays from './_equalArrays.js';\nimport equalByTag from './_equalByTag.js';\nimport equalObjects from './_equalObjects.js';\nimport getTag from './_getTag.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nexport default baseIsEqualDeep;\n","import baseIsEqualDeep from './_baseIsEqualDeep.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nexport default baseIsEqual;\n","import Stack from './_Stack.js';\nimport baseIsEqual from './_baseIsEqual.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nexport default baseIsMatch;\n","import isObject from './isObject.js';\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nexport default isStrictComparable;\n","import isStrictComparable from './_isStrictComparable.js';\nimport keys from './keys.js';\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nexport default getMatchData;\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nexport default matchesStrictComparable;\n","import baseIsMatch from './_baseIsMatch.js';\nimport getMatchData from './_getMatchData.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nexport default baseMatches;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nexport default isSymbol;\n","import isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nexport default isKey;\n","import MapCache from './_MapCache.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nexport default memoize;\n","import memoize from './memoize.js';\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nexport default memoizeCapped;\n","import memoizeCapped from './_memoizeCapped.js';\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nexport default stringToPath;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nexport default arrayMap;\n","import Symbol from './_Symbol.js';\nimport arrayMap from './_arrayMap.js';\nimport isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nexport default baseToString;\n","import baseToString from './_baseToString.js';\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nexport default toString;\n","import isArray from './isArray.js';\nimport isKey from './_isKey.js';\nimport stringToPath from './_stringToPath.js';\nimport toString from './toString.js';\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nexport default castPath;\n","import isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nexport default toKey;\n","import castPath from './_castPath.js';\nimport toKey from './_toKey.js';\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nexport default baseGet;\n","import baseGet from './_baseGet.js';\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nexport default get;\n","/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\nexport default baseHasIn;\n","import castPath from './_castPath.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isIndex from './_isIndex.js';\nimport isLength from './isLength.js';\nimport toKey from './_toKey.js';\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      result = false;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result || ++index != length) {\n    return result;\n  }\n  length = object == null ? 0 : object.length;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\nexport default hasPath;\n","import baseHasIn from './_baseHasIn.js';\nimport hasPath from './_hasPath.js';\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\nexport default hasIn;\n","import baseIsEqual from './_baseIsEqual.js';\nimport get from './get.js';\nimport hasIn from './hasIn.js';\nimport isKey from './_isKey.js';\nimport isStrictComparable from './_isStrictComparable.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\nimport toKey from './_toKey.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nexport default baseMatchesProperty;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nexport default identity;\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nexport default baseProperty;\n","import baseGet from './_baseGet.js';\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nexport default basePropertyDeep;\n","import baseProperty from './_baseProperty.js';\nimport basePropertyDeep from './_basePropertyDeep.js';\nimport isKey from './_isKey.js';\nimport toKey from './_toKey.js';\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nexport default property;\n","import baseMatches from './_baseMatches.js';\nimport baseMatchesProperty from './_baseMatchesProperty.js';\nimport identity from './identity.js';\nimport isArray from './isArray.js';\nimport property from './property.js';\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nexport default baseIteratee;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nexport default trimmedEndIndex;\n","import trimmedEndIndex from './_trimmedEndIndex.js';\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nexport default baseTrim;\n","import baseTrim from './_baseTrim.js';\nimport isObject from './isObject.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nexport default toNumber;\n","import toNumber from './toNumber.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_INTEGER = 1.7976931348623157e+308;\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\nexport default toFinite;\n","import toFinite from './toFinite.js';\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\nexport default toInteger;\n","import baseFindIndex from './_baseFindIndex.js';\nimport baseIteratee from './_baseIteratee.js';\nimport toInteger from './toInteger.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * This method is like `_.findIndex` except that it iterates over elements\n * of `collection` from right to left.\n *\n * @static\n * @memberOf _\n * @since 2.0.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @param {number} [fromIndex=array.length-1] The index to search from.\n * @returns {number} Returns the index of the found element, else `-1`.\n * @example\n *\n * var users = [\n *   { 'user': 'barney',  'active': true },\n *   { 'user': 'fred',    'active': false },\n *   { 'user': 'pebbles', 'active': false }\n * ];\n *\n * _.findLastIndex(users, function(o) { return o.user == 'pebbles'; });\n * // => 2\n *\n * // The `_.matches` iteratee shorthand.\n * _.findLastIndex(users, { 'user': 'barney', 'active': true });\n * // => 0\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.findLastIndex(users, ['active', false]);\n * // => 2\n *\n * // The `_.property` iteratee shorthand.\n * _.findLastIndex(users, 'active');\n * // => 0\n */\nfunction findLastIndex(array, predicate, fromIndex) {\n  var length = array == null ? 0 : array.length;\n  if (!length) {\n    return -1;\n  }\n  var index = length - 1;\n  if (fromIndex !== undefined) {\n    index = toInteger(fromIndex);\n    index = fromIndex < 0\n      ? nativeMax(length + index, 0)\n      : nativeMin(index, length - 1);\n  }\n  return baseFindIndex(array, baseIteratee(predicate, 3), index, true);\n}\n\nexport default findLastIndex;\n","/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\nexport default baseIsNaN;\n","/**\n * A specialized version of `_.indexOf` which performs strict equality\n * comparisons of values, i.e. `===`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction strictIndexOf(array, value, fromIndex) {\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nexport default strictIndexOf;\n","import baseFindIndex from './_baseFindIndex.js';\nimport baseIsNaN from './_baseIsNaN.js';\nimport strictIndexOf from './_strictIndexOf.js';\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  return value === value\n    ? strictIndexOf(array, value, fromIndex)\n    : baseFindIndex(array, baseIsNaN, fromIndex);\n}\n\nexport default baseIndexOf;\n","import baseIndexOf from './_baseIndexOf.js';\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array == null ? 0 : array.length;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\nexport default arrayIncludes;\n","/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arrayIncludesWith;\n","import SetCache from './_SetCache.js';\nimport arrayIncludes from './_arrayIncludes.js';\nimport arrayIncludesWith from './_arrayIncludesWith.js';\nimport arrayMap from './_arrayMap.js';\nimport baseUnary from './_baseUnary.js';\nimport cacheHas from './_cacheHas.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMin = Math.min;\n\n/**\n * The base implementation of methods like `_.intersection`, without support\n * for iteratee shorthands, that accepts an array of arrays to inspect.\n *\n * @private\n * @param {Array} arrays The arrays to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of shared values.\n */\nfunction baseIntersection(arrays, iteratee, comparator) {\n  var includes = comparator ? arrayIncludesWith : arrayIncludes,\n      length = arrays[0].length,\n      othLength = arrays.length,\n      othIndex = othLength,\n      caches = Array(othLength),\n      maxLength = Infinity,\n      result = [];\n\n  while (othIndex--) {\n    var array = arrays[othIndex];\n    if (othIndex && iteratee) {\n      array = arrayMap(array, baseUnary(iteratee));\n    }\n    maxLength = nativeMin(array.length, maxLength);\n    caches[othIndex] = !comparator && (iteratee || (length >= 120 && array.length >= 120))\n      ? new SetCache(othIndex && array)\n      : undefined;\n  }\n  array = arrays[0];\n\n  var index = -1,\n      seen = caches[0];\n\n  outer:\n  while (++index < length && result.length < maxLength) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (!(seen\n          ? cacheHas(seen, computed)\n          : includes(result, computed, comparator)\n        )) {\n      othIndex = othLength;\n      while (--othIndex) {\n        var cache = caches[othIndex];\n        if (!(cache\n              ? cacheHas(cache, computed)\n              : includes(arrays[othIndex], computed, comparator))\n            ) {\n          continue outer;\n        }\n      }\n      if (seen) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nexport default baseIntersection;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nexport default apply;\n","import apply from './_apply.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nexport default overRest;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nexport default constant;\n","import getNative from './_getNative.js';\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nexport default defineProperty;\n","import constant from './constant.js';\nimport defineProperty from './_defineProperty.js';\nimport identity from './identity.js';\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nexport default baseSetToString;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nexport default shortOut;\n","import baseSetToString from './_baseSetToString.js';\nimport shortOut from './_shortOut.js';\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nexport default setToString;\n","import identity from './identity.js';\nimport overRest from './_overRest.js';\nimport setToString from './_setToString.js';\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nexport default baseRest;\n","import isArrayLike from './isArrayLike.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\nexport default isArrayLikeObject;\n","import isArrayLikeObject from './isArrayLikeObject.js';\n\n/**\n * Casts `value` to an empty array if it's not an array like object.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Array|Object} Returns the cast array-like object.\n */\nfunction castArrayLikeObject(value) {\n  return isArrayLikeObject(value) ? value : [];\n}\n\nexport default castArrayLikeObject;\n","import arrayMap from './_arrayMap.js';\nimport baseIntersection from './_baseIntersection.js';\nimport baseRest from './_baseRest.js';\nimport castArrayLikeObject from './_castArrayLikeObject.js';\n\n/**\n * Creates an array of unique values that are included in all given arrays\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons. The order and references of result values are\n * determined by the first array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {...Array} [arrays] The arrays to inspect.\n * @returns {Array} Returns the new array of intersecting values.\n * @example\n *\n * _.intersection([2, 1], [2, 3]);\n * // => [2]\n */\nvar intersection = baseRest(function(arrays) {\n  var mapped = arrayMap(arrays, castArrayLikeObject);\n  return (mapped.length && mapped[0] === arrays[0])\n    ? baseIntersection(mapped)\n    : [];\n});\n\nexport default intersection;\n","'use strict';\n\nexport { findLastIndex, intersection } from 'lodash-es';\n\nexport function chunk<T>(source: T[], size: number): T[][] {\n\tconst chunks = [];\n\n\tlet index = 0;\n\twhile (index < source.length) {\n\t\tchunks.push(source.slice(index, size + index));\n\t\tindex += size;\n\t}\n\treturn chunks;\n}\n\nexport function countStringLength(source: string[]): number {\n\tlet length = 0;\n\tfor (const s of source) {\n\t\tlength += s.length;\n\t}\n\treturn length;\n}\n\nexport function countUniques<T>(source: T[], accessor: (item: T) => string): Record<string, number> {\n\tconst uniqueCounts = Object.create(null) as Record<string, number>;\n\tfor (const item of source) {\n\t\tconst value = accessor(item);\n\t\tuniqueCounts[value] = (uniqueCounts[value] ?? 0) + 1;\n\t}\n\treturn uniqueCounts;\n}\n\nexport function filterMap<T, TMapped>(\n\tsource: T[],\n\tpredicateMapper: (item: T, index: number) => TMapped | null | undefined,\n): TMapped[] {\n\tlet index = 0;\n\treturn source.reduce((accumulator, current) => {\n\t\tconst mapped = predicateMapper(current, index++);\n\t\tif (mapped != null) {\n\t\t\taccumulator.push(mapped);\n\t\t}\n\t\treturn accumulator;\n\t}, [] as TMapped[]);\n}\n\nexport function filterMapAsync<T, TMapped>(\n\tsource: T[],\n\tpredicateMapper: (item: T, index: number) => Promise<TMapped | null | undefined>,\n): Promise<TMapped[]> {\n\tlet index = 0;\n\treturn source.reduce(async (accumulator, current) => {\n\t\tconst mapped = await predicateMapper(current, index++);\n\t\tif (mapped != null) {\n\t\t\taccumulator.push(mapped);\n\t\t}\n\t\treturn accumulator;\n\t}, [] as any);\n}\n\nexport function groupBy<T>(source: T[], groupingKey: (item: T) => string): Record<string, T[]> {\n\treturn source.reduce((groupings, current) => {\n\t\tconst value = groupingKey(current);\n\t\tconst group = groupings[value];\n\t\tif (group === undefined) {\n\t\t\tgroupings[value] = [current];\n\t\t} else {\n\t\t\tgroup.push(current);\n\t\t}\n\t\treturn groupings;\n\t}, Object.create(null) as Record<string, T[]>);\n}\n\nexport function groupByMap<TKey, TValue>(source: TValue[], groupingKey: (item: TValue) => TKey): Map<TKey, TValue[]> {\n\treturn source.reduce((groupings, current) => {\n\t\tconst value = groupingKey(current);\n\t\tconst group = groupings.get(value);\n\t\tif (group === undefined) {\n\t\t\tgroupings.set(value, [current]);\n\t\t} else {\n\t\t\tgroup.push(current);\n\t\t}\n\t\treturn groupings;\n\t}, new Map<TKey, TValue[]>());\n}\n\nexport function groupByFilterMap<TKey, TValue, TMapped>(\n\tsource: TValue[],\n\tgroupingKey: (item: TValue) => TKey,\n\tpredicateMapper: (item: TValue) => TMapped | null | undefined,\n): Map<TKey, TMapped[]> {\n\treturn source.reduce((groupings, current) => {\n\t\tconst mapped = predicateMapper(current);\n\t\tif (mapped != null) {\n\t\t\tconst value = groupingKey(current);\n\t\t\tconst group = groupings.get(value);\n\t\t\tif (group === undefined) {\n\t\t\t\tgroupings.set(value, [mapped]);\n\t\t\t} else {\n\t\t\t\tgroup.push(mapped);\n\t\t\t}\n\t\t}\n\t\treturn groupings;\n\t}, new Map<TKey, TMapped[]>());\n}\n\nexport function isStringArray<T extends any[]>(array: string[] | T): array is string[] {\n\treturn typeof array[0] === 'string';\n}\n\nexport interface HierarchicalItem<T> {\n\tname: string;\n\trelativePath: string;\n\tvalue?: T;\n\n\tparent?: HierarchicalItem<T>;\n\tchildren: Map<string, HierarchicalItem<T>> | undefined;\n\tdescendants: T[] | undefined;\n}\n\nexport function makeHierarchical<T>(\n\tvalues: T[],\n\tsplitPath: (i: T) => string[],\n\tjoinPath: (...paths: string[]) => string,\n\tcompact: boolean = false,\n\tcanCompact?: (i: T) => boolean,\n): HierarchicalItem<T> {\n\tconst seed = {\n\t\tname: '',\n\t\trelativePath: '',\n\t\tchildren: new Map(),\n\t\tdescendants: [],\n\t};\n\n\tlet hierarchy = values.reduce((root: HierarchicalItem<T>, value) => {\n\t\tlet folder = root;\n\n\t\tlet relativePath = '';\n\t\tfor (const folderName of splitPath(value)) {\n\t\t\trelativePath = joinPath(relativePath, folderName);\n\n\t\t\tif (folder.children === undefined) {\n\t\t\t\tfolder.children = new Map();\n\t\t\t}\n\n\t\t\tlet f = folder.children.get(folderName);\n\t\t\tif (f === undefined) {\n\t\t\t\tf = {\n\t\t\t\t\tname: folderName,\n\t\t\t\t\trelativePath: relativePath,\n\t\t\t\t\tparent: folder,\n\t\t\t\t\tchildren: undefined,\n\t\t\t\t\tdescendants: undefined,\n\t\t\t\t};\n\t\t\t\tfolder.children.set(folderName, f);\n\t\t\t}\n\n\t\t\tif (folder.descendants === undefined) {\n\t\t\t\tfolder.descendants = [];\n\t\t\t}\n\t\t\tfolder.descendants.push(value);\n\t\t\tfolder = f;\n\t\t}\n\n\t\tfolder.value = value;\n\n\t\treturn root;\n\t}, seed);\n\n\tif (compact) {\n\t\thierarchy = compactHierarchy(hierarchy, joinPath, true, canCompact);\n\t}\n\n\treturn hierarchy;\n}\n\nexport function compactHierarchy<T>(\n\troot: HierarchicalItem<T>,\n\tjoinPath: (...paths: string[]) => string,\n\tisRoot: boolean = true,\n\tcanCompact?: (i: T) => boolean,\n): HierarchicalItem<T> {\n\tif (root.children === undefined) return root;\n\n\tconst children = [...root.children.values()];\n\tfor (const child of children) {\n\t\tcompactHierarchy(child, joinPath, false, canCompact);\n\t}\n\n\tif (!isRoot && children.length === 1) {\n\t\tconst child = children[0];\n\t\tif (child.value === undefined || canCompact?.(child.value)) {\n\t\t\troot.name = joinPath(root.name, child.name);\n\t\t\troot.relativePath = child.relativePath;\n\t\t\troot.children = child.children;\n\t\t\troot.descendants = child.descendants;\n\t\t\troot.value = child.value;\n\t\t}\n\t}\n\n\treturn root;\n}\n\nexport function uniqueBy<TKey, TValue>(\n\tsource: TValue[],\n\tuniqueKey: (item: TValue) => TKey,\n\tonDeduplicate: (original: TValue, current: TValue) => TValue | void,\n) {\n\tconst map = source.reduce((uniques, current) => {\n\t\tconst value = uniqueKey(current);\n\t\tconst original = uniques.get(value);\n\t\tif (original === undefined) {\n\t\t\tuniques.set(value, current);\n\t\t} else {\n\t\t\tconst updated = onDeduplicate(original, current);\n\t\t\tif (updated !== undefined) {\n\t\t\t\tuniques.set(value, updated);\n\t\t\t}\n\t\t}\n\t\treturn uniques;\n\t}, new Map<TKey, TValue>());\n\treturn [...map.values()];\n}\n","'use strict';\n\nexport function* chunk<T>(source: T[], size: number): Iterable<T[]> {\n\tlet chunk: T[] = [];\n\n\tfor (const item of source) {\n\t\tif (chunk.length < size) {\n\t\t\tchunk.push(item);\n\t\t\tcontinue;\n\t\t}\n\n\t\tyield chunk;\n\t\tchunk = [];\n\t}\n\n\tif (chunk.length > 0) {\n\t\tyield chunk;\n\t}\n}\n\nexport function* chunkByStringLength(source: string[], maxLength: number): Iterable<string[]> {\n\tlet chunk: string[] = [];\n\n\tlet chunkLength = 0;\n\tfor (const item of source) {\n\t\tlet length = chunkLength + item.length;\n\t\tif (length > maxLength && chunk.length > 0) {\n\t\t\tyield chunk;\n\n\t\t\tchunk = [];\n\t\t\tlength = item.length;\n\t\t}\n\n\t\tchunk.push(item);\n\t\tchunkLength = length;\n\t}\n\n\tif (chunk.length > 0) {\n\t\tyield chunk;\n\t}\n}\n\nexport function count<T>(source: Iterable<T> | IterableIterator<T>, predicate?: (item: T) => boolean): number {\n\tlet count = 0;\n\tlet next: IteratorResult<T>;\n\n\twhile (true) {\n\t\tnext = (source as IterableIterator<T>).next();\n\t\tif (next.done) break;\n\n\t\tif (predicate === undefined || predicate(next.value)) {\n\t\t\tcount++;\n\t\t}\n\t}\n\n\treturn count;\n}\n\nexport function every<T>(source: Iterable<T> | IterableIterator<T>, predicate: (item: T) => boolean): boolean {\n\tfor (const item of source) {\n\t\tif (!predicate(item)) return false;\n\t}\n\treturn true;\n}\n\nexport function filter<T>(source: Iterable<T | undefined | null> | IterableIterator<T | undefined | null>): Iterable<T>;\nexport function filter<T>(source: Iterable<T> | IterableIterator<T>, predicate: (item: T) => boolean): Iterable<T>;\nexport function* filter<T>(source: Iterable<T> | IterableIterator<T>, predicate?: (item: T) => boolean): Iterable<T> {\n\tif (predicate === undefined) {\n\t\tfor (const item of source) {\n\t\t\tif (item != null) yield item;\n\t\t}\n\t} else {\n\t\tfor (const item of source) {\n\t\t\tif (predicate(item)) yield item;\n\t\t}\n\t}\n}\n\nexport function* filterMap<T, TMapped>(\n\tsource: Iterable<T> | IterableIterator<T>,\n\tpredicateMapper: (item: T) => TMapped | undefined | null,\n): Iterable<TMapped> {\n\tfor (const item of source) {\n\t\tconst mapped = predicateMapper(item);\n\t\tif (mapped != null) yield mapped;\n\t}\n}\n\nexport function forEach<T>(source: Iterable<T> | IterableIterator<T>, fn: (item: T, index: number) => void): void {\n\tlet i = 0;\n\tfor (const item of source) {\n\t\tfn(item, i);\n\t\ti++;\n\t}\n}\n\nexport function find<T>(source: Iterable<T> | IterableIterator<T>, predicate: (item: T) => boolean): T | null {\n\tfor (const item of source) {\n\t\tif (predicate(item)) return item;\n\t}\n\treturn null;\n}\n\nexport function first<T>(source: Iterable<T>): T {\n\treturn source[Symbol.iterator]().next().value;\n}\n\nexport function* flatMap<T, TMapped>(\n\tsource: Iterable<T> | IterableIterator<T>,\n\tmapper: (item: T) => Iterable<TMapped>,\n): Iterable<TMapped> {\n\tfor (const item of source) {\n\t\tyield* mapper(item);\n\t}\n}\n\nexport function has<T>(source: Iterable<T> | IterableIterator<T>, item: T): boolean {\n\treturn some(source, i => i === item);\n}\n\nexport function isIterable(source: Iterable<any>): boolean {\n\treturn typeof source[Symbol.iterator] === 'function';\n}\n\nexport function join(source: Iterable<any>, separator: string): string {\n\tlet value = '';\n\n\tconst iterator = source[Symbol.iterator]();\n\tlet next = iterator.next();\n\tif (next.done) return value;\n\n\twhile (true) {\n\t\tconst s = next.value.toString();\n\n\t\tnext = iterator.next();\n\t\tif (next.done) {\n\t\t\tvalue += s;\n\t\t\tbreak;\n\t\t}\n\n\t\tvalue += `${s}${separator}`;\n\t}\n\n\treturn value;\n}\n\nexport function last<T>(source: Iterable<T>): T | undefined {\n\tlet item: T | undefined;\n\tfor (item of source) {\n\t\t/* noop */\n\t}\n\treturn item;\n}\n\nexport function* map<T, TMapped>(\n\tsource: Iterable<T> | IterableIterator<T>,\n\tmapper: (item: T) => TMapped,\n): Iterable<TMapped> {\n\tfor (const item of source) {\n\t\tyield mapper(item);\n\t}\n}\n\nexport function next<T>(source: IterableIterator<T>): T {\n\treturn source.next().value;\n}\n\nexport function* skip<T>(source: Iterable<T> | IterableIterator<T>, count: number): IterableIterator<T> {\n\tlet i = 0;\n\tfor (const item of source) {\n\t\tif (i >= count) yield item;\n\t\ti++;\n\t}\n}\n\nexport function some<T>(source: Iterable<T> | IterableIterator<T>, predicate: (item: T) => boolean): boolean {\n\tfor (const item of source) {\n\t\tif (predicate(item)) return true;\n\t}\n\treturn false;\n}\n\nexport function* take<T>(source: Iterable<T> | IterableIterator<T>, count: number): Iterable<T> {\n\tif (count > 0) {\n\t\tlet i = 0;\n\t\tfor (const item of source) {\n\t\t\tyield item;\n\t\t\ti++;\n\t\t\tif (i >= count) break;\n\t\t}\n\t}\n}\n\nexport function* union<T>(...sources: (Iterable<T> | IterableIterator<T>)[]): Iterable<T> {\n\tfor (const source of sources) {\n\t\tfor (const item of source) {\n\t\t\tyield item;\n\t\t}\n\t}\n}\n","'use strict';\nimport { CancellationToken } from 'vscode';\nimport { map } from './iterable';\n\nexport class CancellationError<TPromise = any> extends Error {\n\tconstructor(public readonly promise: TPromise, message: string) {\n\t\tsuper(message);\n\t}\n}\n\nexport class CancellationErrorWithId<T, TPromise = any> extends CancellationError<TPromise> {\n\tconstructor(public readonly id: T, promise: TPromise, message: string) {\n\t\tsuper(promise, message);\n\t}\n}\n\nexport function cancellable<T>(\n\tpromise: Promise<T>,\n\ttimeoutOrToken?: number | CancellationToken,\n\toptions: {\n\t\tcancelMessage?: string;\n\t\tonDidCancel?(resolve: (value: T | PromiseLike<T>) => void, reject: (reason?: any) => void): void;\n\t} = {},\n): Promise<T> {\n\tif (timeoutOrToken == null) return promise;\n\n\treturn new Promise((resolve, reject) => {\n\t\tlet fulfilled = false;\n\t\tlet timer: NodeJS.Timer | undefined;\n\t\tif (typeof timeoutOrToken === 'number') {\n\t\t\ttimer = global.setTimeout(() => {\n\t\t\t\tif (typeof options.onDidCancel === 'function') {\n\t\t\t\t\toptions.onDidCancel(resolve, reject);\n\t\t\t\t} else {\n\t\t\t\t\treject(new CancellationError(promise, options.cancelMessage ?? 'TIMED OUT'));\n\t\t\t\t}\n\t\t\t}, timeoutOrToken);\n\t\t} else {\n\t\t\ttimeoutOrToken.onCancellationRequested(() => {\n\t\t\t\tif (fulfilled) return;\n\n\t\t\t\tif (typeof options.onDidCancel === 'function') {\n\t\t\t\t\toptions.onDidCancel(resolve, reject);\n\t\t\t\t} else {\n\t\t\t\t\treject(new CancellationError(promise, options.cancelMessage ?? 'CANCELLED'));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tpromise.then(\n\t\t\t() => {\n\t\t\t\tfulfilled = true;\n\t\t\t\tif (timer !== undefined) {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t}\n\t\t\t\tresolve(promise);\n\t\t\t},\n\t\t\tex => {\n\t\t\t\tfulfilled = true;\n\t\t\t\tif (timer !== undefined) {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t}\n\t\t\t\treject(ex);\n\t\t\t},\n\t\t);\n\t});\n}\n\nexport function first<T>(promises: Promise<T>[], predicate: (value: T) => boolean): Promise<T | undefined> {\n\tconst newPromises: Promise<T | undefined>[] = promises.map(\n\t\tp =>\n\t\t\tnew Promise<T>((resolve, reject) =>\n\t\t\t\tp.then(value => {\n\t\t\t\t\tif (predicate(value)) {\n\t\t\t\t\t\tresolve(value);\n\t\t\t\t\t}\n\t\t\t\t}, reject),\n\t\t\t),\n\t);\n\tnewPromises.push(Promise.all(promises).then(() => undefined));\n\treturn Promise.race(newPromises);\n}\n\nexport function is<T>(obj: T | Promise<T>): obj is Promise<T> {\n\treturn obj != null && typeof (obj as Promise<T>).then === 'function';\n}\n\nexport function raceAll<TPromise>(\n\tpromises: Promise<TPromise>[],\n\ttimeout?: number,\n): Promise<(TPromise | CancellationError<Promise<TPromise>>)[]>;\nexport function raceAll<TPromise, T>(\n\tpromises: Map<T, Promise<TPromise>>,\n\ttimeout?: number,\n): Promise<Map<T, TPromise | CancellationErrorWithId<T, Promise<TPromise>>>>;\nexport function raceAll<TPromise, T>(\n\tids: Iterable<T>,\n\tfn: (id: T) => Promise<TPromise>,\n\ttimeout?: number,\n): Promise<Map<T, TPromise | CancellationErrorWithId<T, Promise<TPromise>>>>;\nexport async function raceAll<TPromise, T>(\n\tpromisesOrIds: Promise<TPromise>[] | Map<T, Promise<TPromise>> | Iterable<T>,\n\ttimeoutOrFn?: number | ((id: T) => Promise<TPromise>),\n\ttimeout?: number,\n) {\n\tlet promises;\n\tif (timeoutOrFn != null && typeof timeoutOrFn !== 'number') {\n\t\tpromises = new Map(map<T, [T, Promise<TPromise>]>(promisesOrIds as Iterable<T>, id => [id, timeoutOrFn(id)]));\n\t} else {\n\t\ttimeout = timeoutOrFn;\n\t\tpromises = promisesOrIds as Promise<TPromise>[] | Map<T, Promise<TPromise>>;\n\t}\n\n\tif (promises instanceof Map) {\n\t\treturn new Map(\n\t\t\tawait Promise.all(\n\t\t\t\tmap<[T, Promise<TPromise>], Promise<[T, TPromise | CancellationErrorWithId<T, Promise<TPromise>>]>>(\n\t\t\t\t\tpromises.entries(),\n\t\t\t\t\ttimeout == null\n\t\t\t\t\t\t? ([id, promise]) => promise.then(p => [id, p])\n\t\t\t\t\t\t: ([id, promise]) =>\n\t\t\t\t\t\t\t\tPromise.race([\n\t\t\t\t\t\t\t\t\tpromise,\n\n\t\t\t\t\t\t\t\t\tnew Promise<CancellationErrorWithId<T, Promise<TPromise>>>(resolve =>\n\t\t\t\t\t\t\t\t\t\tsetTimeout(\n\t\t\t\t\t\t\t\t\t\t\t() => resolve(new CancellationErrorWithId(id, promise, 'TIMED OUT')),\n\t\t\t\t\t\t\t\t\t\t\ttimeout,\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t]).then(p => [id, p]),\n\t\t\t\t),\n\t\t\t),\n\t\t);\n\t}\n\n\treturn Promise.all(\n\t\ttimeout == null\n\t\t\t? promises\n\t\t\t: promises.map(p =>\n\t\t\t\t\tPromise.race([\n\t\t\t\t\t\tp,\n\t\t\t\t\t\tnew Promise<CancellationError<Promise<TPromise>>>(resolve =>\n\t\t\t\t\t\t\tsetTimeout(() => resolve(new CancellationError(p, 'TIMED OUT')), timeout),\n\t\t\t\t\t\t),\n\t\t\t\t\t]),\n\t\t\t  ),\n\t);\n}\n","'use strict';\nimport { is as isPromise } from '../promise';\n\nconst emptyStr = '';\n\nfunction defaultResolver(...args: any[]): string {\n\tif (args.length === 1) {\n\t\tconst arg0 = args[0];\n\t\tif (arg0 == null) return emptyStr;\n\t\tif (typeof arg0 === 'string') return arg0;\n\t\tif (typeof arg0 === 'number' || typeof arg0 === 'boolean') {\n\t\t\treturn String(arg0);\n\t\t}\n\n\t\treturn JSON.stringify(arg0);\n\t}\n\n\treturn JSON.stringify(args);\n}\n\nexport function gate<T extends (...arg: any) => any>(resolver?: (...args: Parameters<T>) => string) {\n\treturn (target: any, key: string, descriptor: PropertyDescriptor) => {\n\t\tlet fn: Function | undefined;\n\t\tif (typeof descriptor.value === 'function') {\n\t\t\tfn = descriptor.value;\n\t\t} else if (typeof descriptor.get === 'function') {\n\t\t\tfn = descriptor.get;\n\t\t}\n\t\tif (fn == null) throw new Error('Not supported');\n\n\t\tconst gateKey = `$gate$${key}`;\n\n\t\tdescriptor.value = function (this: any, ...args: any[]) {\n\t\t\tconst prop =\n\t\t\t\targs.length === 0 ? gateKey : `${gateKey}$${(resolver ?? defaultResolver)(...(args as Parameters<T>))}`;\n\n\t\t\tif (!Object.prototype.hasOwnProperty.call(this, prop)) {\n\t\t\t\tObject.defineProperty(this, prop, {\n\t\t\t\t\tconfigurable: false,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\twritable: true,\n\t\t\t\t\tvalue: undefined,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tlet promise = this[prop];\n\t\t\tif (promise === undefined) {\n\t\t\t\tlet result;\n\t\t\t\ttry {\n\t\t\t\t\tresult = fn!.apply(this, args);\n\t\t\t\t\tif (result == null || !isPromise(result)) {\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis[prop] = promise = result\n\t\t\t\t\t\t.then((r: any) => {\n\t\t\t\t\t\t\tthis[prop] = undefined;\n\t\t\t\t\t\t\treturn r;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(ex => {\n\t\t\t\t\t\t\tthis[prop] = undefined;\n\t\t\t\t\t\t\tthrow ex;\n\t\t\t\t\t\t});\n\t\t\t\t} catch (ex) {\n\t\t\t\t\tthis[prop] = undefined;\n\t\t\t\t\tthrow ex;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn promise;\n\t\t};\n\t};\n}\n","import root from './_root.js';\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nexport default now;\n","import isObject from './isObject.js';\nimport now from './now.js';\nimport toNumber from './toNumber.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nexport default debounce;\n","import toInteger from './toInteger.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that invokes `func`, with the `this` binding and arguments\n * of the created function, while it's called less than `n` times. Subsequent\n * calls to the created function return the result of the last `func` invocation.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Function\n * @param {number} n The number of calls at which `func` is no longer invoked.\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new restricted function.\n * @example\n *\n * jQuery(element).on('click', _.before(5, addContactToList));\n * // => Allows adding up to 4 contacts to the list.\n */\nfunction before(n, func) {\n  var result;\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  n = toInteger(n);\n  return function() {\n    if (--n > 0) {\n      result = func.apply(this, arguments);\n    }\n    if (n <= 1) {\n      func = undefined;\n    }\n    return result;\n  };\n}\n\nexport default before;\n","import before from './before.js';\n\n/**\n * Creates a function that is restricted to invoking `func` once. Repeat calls\n * to the function return the value of the first invocation. The `func` is\n * invoked with the `this` binding and arguments of the created function.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new restricted function.\n * @example\n *\n * var initialize = _.once(createApplication);\n * initialize();\n * initialize();\n * // => `createApplication` is invoked once\n */\nfunction once(func) {\n  return before(2, func);\n}\n\nexport default once;\n","'use strict';\nimport { debounce as _debounce, once as _once } from 'lodash-es';\nimport { Disposable } from 'vscode';\n\nexport interface Deferrable<T extends (...args: any[]) => any> {\n\t(...args: Parameters<T>): ReturnType<T> | undefined;\n\tcancel(): void;\n\tflush(): ReturnType<T> | undefined;\n\tpending?(): boolean;\n}\n\ninterface PropOfValue {\n\t(): any;\n\tvalue: string | undefined;\n}\n\nexport function cachedOnce<T>(fn: (...args: any[]) => Promise<T>, seed: T): (...args: any[]) => Promise<T> {\n\tlet cached: T | undefined = seed;\n\treturn (...args: any[]) => {\n\t\tif (cached !== undefined) {\n\t\t\tconst promise = Promise.resolve(cached);\n\t\t\tcached = undefined;\n\n\t\t\treturn promise;\n\t\t}\n\t\treturn fn(...args);\n\t};\n}\n\nexport interface DebounceOptions {\n\tleading?: boolean;\n\tmaxWait?: number;\n\ttrack?: boolean;\n\ttrailing?: boolean;\n}\n\nexport function debounce<T extends (...args: any[]) => any>(\n\tfn: T,\n\twait?: number,\n\toptions?: DebounceOptions,\n): Deferrable<T> {\n\tconst { track, ...opts }: DebounceOptions = {\n\t\ttrack: false,\n\t\t...(options ?? {}),\n\t};\n\n\tif (track !== true) return _debounce(fn, wait, opts);\n\n\tlet pending = false;\n\n\tconst debounced = _debounce(\n\t\tfunction (this: any, ...args: any[]) {\n\t\t\tpending = false;\n\t\t\treturn fn.apply(this, args);\n\t\t} as any as T,\n\t\twait,\n\t\toptions,\n\t);\n\n\tconst tracked: Deferrable<T> = function (this: any, ...args: Parameters<T>) {\n\t\tpending = true;\n\t\treturn debounced.apply(this, args);\n\t} as any;\n\n\ttracked.pending = function () {\n\t\treturn pending;\n\t};\n\ttracked.cancel = function () {\n\t\treturn debounced.cancel.apply(debounced);\n\t};\n\ttracked.flush = function () {\n\t\treturn debounced.flush.apply(debounced);\n\t};\n\n\treturn tracked;\n}\n\n// export function debounceMemoized<T extends (...args: any[]) => any>(\n// \tfn: T,\n// \twait?: number,\n// \toptions?: DebounceOptions & { resolver?(...args: any[]): any }\n// ): T {\n// \tconst { resolver, ...opts } = options || ({} as DebounceOptions & { resolver?: T });\n\n// \tconst memo = _memoize(() => {\n// \t\treturn debounce(fn, wait, opts);\n// \t}, resolver);\n\n// \treturn function(this: any, ...args: []) {\n// \t\treturn memo.apply(this, args).apply(this, args);\n// \t} as T;\n// }\n\nconst comma = ',';\nconst emptyStr = '';\nconst equals = '=';\nconst openBrace = '{';\nconst openParen = '(';\nconst closeParen = ')';\n\nconst fnBodyRegex = /\\(([\\s\\S]*)\\)/;\nconst fnBodyStripCommentsRegex = /(\\/\\*([\\s\\S]*?)\\*\\/|([^:]|^)\\/\\/(.*)$)/gm;\nconst fnBodyStripParamDefaultValueRegex = /\\s?=.*$/;\n\nexport function getParameters(fn: Function): string[] {\n\tif (typeof fn !== 'function') throw new Error('Not supported');\n\n\tif (fn.length === 0) return [];\n\n\tlet fnBody: string = Function.prototype.toString.call(fn);\n\tfnBody = fnBody.replace(fnBodyStripCommentsRegex, emptyStr) || fnBody;\n\tfnBody = fnBody.slice(0, fnBody.indexOf(openBrace));\n\n\tlet open = fnBody.indexOf(openParen);\n\tlet close = fnBody.indexOf(closeParen);\n\n\topen = open >= 0 ? open + 1 : 0;\n\tclose = close > 0 ? close : fnBody.indexOf(equals);\n\n\tfnBody = fnBody.slice(open, close);\n\tfnBody = `(${fnBody})`;\n\n\tconst match = fnBodyRegex.exec(fnBody);\n\treturn match != null\n\t\t? match[1].split(comma).map(param => param.trim().replace(fnBodyStripParamDefaultValueRegex, emptyStr))\n\t\t: [];\n}\n\nexport function is<T extends object>(o: T | null | undefined): o is T;\nexport function is<T extends object>(o: object, prop: keyof T, value?: any): o is T;\nexport function is<T extends object>(o: object, matcher: (o: object) => boolean): o is T;\nexport function is<T extends object>(o: object, propOrMatcher?: keyof T | ((o: any) => boolean), value?: any): o is T {\n\tif (propOrMatcher == null) return o != null;\n\tif (typeof propOrMatcher === 'function') return propOrMatcher(o);\n\n\treturn value === undefined ? (o as any)[propOrMatcher] !== undefined : (o as any)[propOrMatcher] === value;\n}\n\nexport function once<T extends (...args: any[]) => any>(fn: T): T {\n\treturn _once(fn);\n}\n\nexport function propOf<T, K extends Extract<keyof T, string>>(o: T, key: K) {\n\tconst propOfCore = <T, K extends Extract<keyof T, string>>(o: T, key: K) => {\n\t\tconst value: string =\n\t\t\t(propOfCore as PropOfValue).value === undefined ? key : `${(propOfCore as PropOfValue).value}.${key}`;\n\t\t(propOfCore as PropOfValue).value = value;\n\t\tconst fn = <Y extends Extract<keyof T[K], string>>(k: Y) => propOfCore(o[key], k);\n\t\treturn Object.assign(fn, { value: value });\n\t};\n\treturn propOfCore(o, key);\n}\n\nexport function interval(fn: (...args: any[]) => void, ms: number): Disposable {\n\tlet timer: NodeJS.Timer | undefined;\n\tconst disposable = {\n\t\tdispose: () => {\n\t\t\tif (timer !== undefined) {\n\t\t\t\tclearInterval(timer);\n\t\t\t\ttimer = undefined;\n\t\t\t}\n\t\t},\n\t};\n\ttimer = global.setInterval(fn, ms);\n\n\treturn disposable;\n}\n\nexport function progress<T>(promise: Promise<T>, intervalMs: number, onProgress: () => boolean): Promise<T> {\n\treturn new Promise((resolve, reject) => {\n\t\tlet timer: NodeJS.Timer | undefined;\n\t\ttimer = global.setInterval(() => {\n\t\t\tif (onProgress()) {\n\t\t\t\tif (timer !== undefined) {\n\t\t\t\t\tclearInterval(timer);\n\t\t\t\t\ttimer = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t}, intervalMs);\n\n\t\tpromise.then(\n\t\t\t() => {\n\t\t\t\tif (timer !== undefined) {\n\t\t\t\t\tclearInterval(timer);\n\t\t\t\t\ttimer = undefined;\n\t\t\t\t}\n\n\t\t\t\tresolve(promise);\n\t\t\t},\n\t\t\tex => {\n\t\t\t\tif (timer !== undefined) {\n\t\t\t\t\tclearInterval(timer);\n\t\t\t\t\ttimer = undefined;\n\t\t\t\t}\n\n\t\t\t\treject(ex);\n\t\t\t},\n\t\t);\n\t});\n}\n\nexport async function wait(ms: number) {\n\tawait new Promise(resolve => setTimeout(resolve, ms));\n}\n\nexport async function waitUntil(fn: (...args: any[]) => boolean, timeout: number): Promise<boolean> {\n\tconst max = Math.round(timeout / 100);\n\tlet counter = 0;\n\twhile (true) {\n\t\tif (fn()) return true;\n\t\tif (counter > max) return false;\n\n\t\tawait wait(100);\n\t\tcounter++;\n\t}\n}\n","'use strict';\nimport { BinaryToTextEncoding, createHash } from 'crypto';\nimport { isWindows } from '../git/shell';\n\nconst emptyStr = '';\n\nexport const enum CharCode {\n\t/**\n\t * The `/` character.\n\t */\n\tSlash = 47,\n\t/**\n\t * The `\\` character.\n\t */\n\tBackslash = 92,\n\tA = 65,\n\tZ = 90,\n\ta = 97,\n\tz = 122,\n}\n\nexport function base64(s: string): string {\n\tconst buffer = Buffer.from(s);\n\treturn buffer.toString('base64');\n}\n\nexport function compareSubstring(\n\ta: string,\n\tb: string,\n\taStart: number = 0,\n\taEnd: number = a.length,\n\tbStart: number = 0,\n\tbEnd: number = b.length,\n): number {\n\tfor (; aStart < aEnd && bStart < bEnd; aStart++, bStart++) {\n\t\tconst codeA = a.charCodeAt(aStart);\n\t\tconst codeB = b.charCodeAt(bStart);\n\t\tif (codeA < codeB) {\n\t\t\treturn -1;\n\t\t} else if (codeA > codeB) {\n\t\t\treturn 1;\n\t\t}\n\t}\n\tconst aLen = aEnd - aStart;\n\tconst bLen = bEnd - bStart;\n\tif (aLen < bLen) {\n\t\treturn -1;\n\t} else if (aLen > bLen) {\n\t\treturn 1;\n\t}\n\treturn 0;\n}\n\nexport function compareSubstringIgnoreCase(\n\ta: string,\n\tb: string,\n\taStart: number = 0,\n\taEnd: number = a.length,\n\tbStart: number = 0,\n\tbEnd: number = b.length,\n): number {\n\tfor (; aStart < aEnd && bStart < bEnd; aStart++, bStart++) {\n\t\tconst codeA = a.charCodeAt(aStart);\n\t\tconst codeB = b.charCodeAt(bStart);\n\n\t\tif (codeA === codeB) {\n\t\t\t// equal\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst diff = codeA - codeB;\n\t\tif (diff === 32 && isUpperAsciiLetter(codeB)) {\n\t\t\t//codeB =[65-90] && codeA =[97-122]\n\t\t\tcontinue;\n\t\t} else if (diff === -32 && isUpperAsciiLetter(codeA)) {\n\t\t\t//codeB =[97-122] && codeA =[65-90]\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (isLowerAsciiLetter(codeA) && isLowerAsciiLetter(codeB)) {\n\t\t\t//\n\t\t\treturn diff;\n\t\t}\n\t\treturn compareSubstring(a.toLowerCase(), b.toLowerCase(), aStart, aEnd, bStart, bEnd);\n\t}\n\n\tconst aLen = aEnd - aStart;\n\tconst bLen = bEnd - bStart;\n\n\tif (aLen < bLen) {\n\t\treturn -1;\n\t} else if (aLen > bLen) {\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}\n\nconst escapeMarkdownRegex = /[\\\\`*_{}[\\]()#+\\-.!]/g;\nconst escapeMarkdownHeaderRegex = /^===/gm;\n// const sampleMarkdown = '## message `not code` *not important* _no underline_ \\n> don\\'t quote me \\n- don\\'t list me \\n+ don\\'t list me \\n1. don\\'t list me \\nnot h1 \\n=== \\nnot h2 \\n---\\n***\\n---\\n___';\nconst markdownQuotedRegex = /\\n/g;\n\nexport function escapeMarkdown(s: string, options: { quoted?: boolean } = {}): string {\n\ts = s\n\t\t// Escape markdown\n\t\t.replace(escapeMarkdownRegex, '\\\\$&')\n\t\t// Escape markdown header (since the above regex won't match it)\n\t\t.replace(escapeMarkdownHeaderRegex, '\\u200b===');\n\n\tif (!options.quoted) return s;\n\n\t// Keep under the same block-quote but with line breaks\n\treturn s.replace(markdownQuotedRegex, '\\t\\n>  ');\n}\n\nexport function equalsIgnoreCase(a: string | null | undefined, b: string | null | undefined): boolean {\n\tif (a == null && b == null) return true;\n\tif (a == null || b == null) return false;\n\treturn a.localeCompare(b, undefined, { sensitivity: 'accent' }) === 0;\n}\n\nexport function escapeRegex(s: string) {\n\treturn s.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&');\n}\n\nexport function getCommonBase(s1: string, s2: string, delimiter: string) {\n\tlet char;\n\tlet index = 0;\n\tfor (let i = 0; i < s1.length; i++) {\n\t\tchar = s1[i];\n\t\tif (char !== s2[i]) break;\n\n\t\tif (char === delimiter) {\n\t\t\tindex = i;\n\t\t}\n\t}\n\n\treturn index > 0 ? s1.substring(0, index + 1) : undefined;\n}\n\nexport function getDurationMilliseconds(start: [number, number]) {\n\tconst [secs, nanosecs] = process.hrtime(start);\n\treturn secs * 1000 + Math.floor(nanosecs / 1000000);\n}\n\nconst superscripts = ['\\u00B9', '\\u00B2', '\\u00B3', '\\u2074', '\\u2075', '\\u2076', '\\u2077', '\\u2078', '\\u2079'];\n\nexport function getSuperscript(num: number) {\n\treturn superscripts[num - 1] ?? '';\n}\n\nconst driveLetterNormalizeRegex = /(?<=^\\/?)([A-Z])(?=:\\/)/;\nconst pathNormalizeRegex = /\\\\/g;\nconst pathStripTrailingSlashRegex = /\\/$/g;\nconst tokenRegex = /\\$\\{('.*?[^\\\\]'|\\W*)?([^|]*?)(?:\\|(\\d+)(-|\\?)?)?('.*?[^\\\\]'|\\W*)?\\}/g;\nconst tokenSanitizeRegex = /\\$\\{(?:'.*?[^\\\\]'|\\W*)?(\\w*?)(?:'.*?[^\\\\]'|[\\W\\d]*)\\}/g;\nconst tokenGroupCharacter = \"'\";\nconst tokenGroupCharacterEscapedRegex = /(\\\\')/g;\nconst tokenGroupRegex = /^'?(.*?)'?$/;\n\nexport interface TokenOptions {\n\tcollapseWhitespace: boolean;\n\tpadDirection: 'left' | 'right';\n\tprefix: string | undefined;\n\tsuffix: string | undefined;\n\ttruncateTo: number | undefined;\n}\n\nexport function getTokensFromTemplate(template: string) {\n\tconst tokens: { key: string; options: TokenOptions }[] = [];\n\n\tlet match;\n\tdo {\n\t\tmatch = tokenRegex.exec(template);\n\t\tif (match == null) break;\n\n\t\tlet [, prefix, key, truncateTo, option, suffix] = match;\n\t\t// Check for a prefix group\n\t\tif (prefix != null) {\n\t\t\tmatch = tokenGroupRegex.exec(prefix);\n\t\t\tif (match != null) {\n\t\t\t\t[, prefix] = match;\n\t\t\t\tprefix = prefix.replace(tokenGroupCharacterEscapedRegex, tokenGroupCharacter);\n\t\t\t}\n\t\t}\n\n\t\t// Check for a suffix group\n\t\tif (suffix != null) {\n\t\t\tmatch = tokenGroupRegex.exec(suffix);\n\t\t\tif (match != null) {\n\t\t\t\t[, suffix] = match;\n\t\t\t\tsuffix = suffix.replace(tokenGroupCharacterEscapedRegex, tokenGroupCharacter);\n\t\t\t}\n\t\t}\n\n\t\ttokens.push({\n\t\t\tkey: key,\n\t\t\toptions: {\n\t\t\t\tcollapseWhitespace: option === '?',\n\t\t\t\tpadDirection: option === '-' ? 'left' : 'right',\n\t\t\t\tprefix: prefix || undefined,\n\t\t\t\tsuffix: suffix || undefined,\n\t\t\t\ttruncateTo: truncateTo == null ? undefined : parseInt(truncateTo, 10),\n\t\t\t},\n\t\t});\n\t} while (true);\n\n\treturn tokens;\n}\n\nconst tokenSanitizeReplacement = `$\\${$1=this.$1,($1 == null ? '' : $1)}`;\nconst interpolationMap = new Map<string, Function>();\n\nexport function interpolate(template: string, context: object | undefined): string {\n\tif (template == null || template.length === 0) return template;\n\tif (context == null) return template.replace(tokenSanitizeRegex, emptyStr);\n\n\tlet fn = interpolationMap.get(template);\n\tif (fn == null) {\n\t\t// eslint-disable-next-line @typescript-eslint/no-implied-eval\n\t\tfn = new Function(`return \\`${template.replace(tokenSanitizeRegex, tokenSanitizeReplacement)}\\`;`);\n\t\tinterpolationMap.set(template, fn);\n\t}\n\n\treturn fn.call(context);\n}\n\n// eslint-disable-next-line prefer-arrow-callback\nconst AsyncFunction = Object.getPrototypeOf(async function () {\n\t/* noop */\n}).constructor;\n\nconst tokenSanitizeReplacementAsync = `$\\${$1=this.$1,($1 == null ? '' : typeof $1.then === 'function' ? (($1 = await $1),$1 == null ? '' : $1) : $1)}`;\n\nconst interpolationAsyncMap = new Map<string, typeof AsyncFunction>();\n\nexport async function interpolateAsync(template: string, context: object | undefined): Promise<string> {\n\tif (template == null || template.length === 0) return template;\n\tif (context == null) return template.replace(tokenSanitizeRegex, emptyStr);\n\n\tlet fn = interpolationAsyncMap.get(template);\n\tif (fn == null) {\n\t\t// // eslint-disable-next-line @typescript-eslint/no-implied-eval\n\t\tconst body = `return \\`${template.replace(tokenSanitizeRegex, tokenSanitizeReplacementAsync)}\\`;`;\n\t\tfn = new AsyncFunction(body);\n\t\tinterpolationAsyncMap.set(template, fn);\n\t}\n\n\tconst value = await fn.call(context);\n\treturn value;\n}\n\nexport function isLowerAsciiLetter(code: number): boolean {\n\treturn code >= CharCode.a && code <= CharCode.z;\n}\n\nexport function isUpperAsciiLetter(code: number): boolean {\n\treturn code >= CharCode.A && code <= CharCode.Z;\n}\n\nexport function* lines(s: string, char: string = '\\n'): IterableIterator<string> {\n\tlet i = 0;\n\twhile (i < s.length) {\n\t\tlet j = s.indexOf(char, i);\n\t\tif (j === -1) {\n\t\t\tj = s.length;\n\t\t}\n\n\t\tyield s.substring(i, j);\n\t\ti = j + 1;\n\t}\n}\n\nexport function md5(s: string, encoding: BinaryToTextEncoding = 'base64'): string {\n\treturn createHash('md5').update(s).digest(encoding);\n}\n\nexport function normalizePath(\n\tfileName: string,\n\toptions: { addLeadingSlash?: boolean; stripTrailingSlash?: boolean } = { stripTrailingSlash: true },\n) {\n\tif (fileName == null || fileName.length === 0) return fileName;\n\n\tlet normalized = fileName.replace(pathNormalizeRegex, '/');\n\n\tconst { addLeadingSlash, stripTrailingSlash } = { stripTrailingSlash: true, ...options };\n\n\tif (stripTrailingSlash) {\n\t\tnormalized = normalized.replace(pathStripTrailingSlashRegex, emptyStr);\n\t}\n\n\tif (addLeadingSlash && normalized.charCodeAt(0) !== CharCode.Slash) {\n\t\tnormalized = `/${normalized}`;\n\t}\n\n\tif (isWindows) {\n\t\t// Ensure that drive casing is normalized (lower case)\n\t\tnormalized = normalized.replace(driveLetterNormalizeRegex, (drive: string) => drive.toLowerCase());\n\t}\n\n\treturn normalized;\n}\n\nexport function pad(s: string, before: number = 0, after: number = 0, padding: string = '\\u00a0') {\n\tif (before === 0 && after === 0) return s;\n\n\treturn `${before === 0 ? emptyStr : padding.repeat(before)}${s}${after === 0 ? emptyStr : padding.repeat(after)}`;\n}\n\nexport function padLeft(s: string, padTo: number, padding: string = '\\u00a0', width?: number) {\n\tconst diff = padTo - (width ?? getWidth(s));\n\treturn diff <= 0 ? s : padding.repeat(diff) + s;\n}\n\nexport function padLeftOrTruncate(s: string, max: number, padding?: string, width?: number) {\n\twidth = width ?? getWidth(s);\n\tif (width < max) return padLeft(s, max, padding, width);\n\tif (width > max) return truncate(s, max, undefined, width);\n\treturn s;\n}\n\nexport function padRight(s: string, padTo: number, padding: string = '\\u00a0', width?: number) {\n\tconst diff = padTo - (width ?? getWidth(s));\n\treturn diff <= 0 ? s : s + padding.repeat(diff);\n}\n\nexport function padOrTruncate(s: string, max: number, padding?: string, width?: number) {\n\tconst left = max < 0;\n\tmax = Math.abs(max);\n\n\twidth = width ?? getWidth(s);\n\tif (width < max) return left ? padLeft(s, max, padding, width) : padRight(s, max, padding, width);\n\tif (width > max) return truncate(s, max, undefined, width);\n\treturn s;\n}\n\nexport function padRightOrTruncate(s: string, max: number, padding?: string, width?: number) {\n\twidth = width ?? getWidth(s);\n\tif (width < max) return padRight(s, max, padding, width);\n\tif (width > max) return truncate(s, max);\n\treturn s;\n}\n\nexport function pluralize(\n\ts: string,\n\tcount: number,\n\toptions?: { infix?: string; number?: string; plural?: string; zero?: string },\n) {\n\tif (options == null) return `${count} ${s}${count === 1 ? emptyStr : 's'}`;\n\n\treturn `${\n\t\tcount === 0 ? (options.zero != null ? options.zero : count) : options.number != null ? options.number : count\n\t}${options.infix ?? ' '}${count === 1 ? s : options.plural ?? `${s}s`}`;\n}\n\n// Removes \\ / : * ? \" < > | and C0 and C1 control codes\n// eslint-disable-next-line no-control-regex\nconst illegalCharsForFSRegex = /[\\\\/:*?\"<>|\\x00-\\x1f\\x80-\\x9f]/g;\n\nexport function sanitizeForFileSystem(s: string, replacement: string = '_') {\n\tif (!s) return s;\n\treturn s.replace(illegalCharsForFSRegex, replacement);\n}\n\nexport function sha1(s: string, encoding: BinaryToTextEncoding = 'base64'): string {\n\treturn createHash('sha1').update(s).digest(encoding);\n}\n\nexport function splitLast(s: string, splitter: string) {\n\tconst index = s.lastIndexOf(splitter);\n\tif (index === -1) return [s];\n\n\treturn [s.substr(index), s.substring(0, index - 1)];\n}\n\nexport function splitSingle(s: string, splitter: string) {\n\tconst parts = s.split(splitter, 1);\n\tconst first = parts[0];\n\treturn first.length === s.length ? parts : [first, s.substr(first.length + 1)];\n}\n\nexport function truncate(s: string, truncateTo: number, ellipsis: string = '\\u2026', width?: number) {\n\tif (!s) return s;\n\tif (truncateTo <= 1) return ellipsis;\n\n\twidth = width ?? getWidth(s);\n\tif (width <= truncateTo) return s;\n\tif (width === s.length) return `${s.substring(0, truncateTo - 1)}${ellipsis}`;\n\n\t// Skip ahead to start as far as we can by assuming all the double-width characters won't be truncated\n\tlet chars = Math.floor(truncateTo / (width / s.length));\n\tlet count = getWidth(s.substring(0, chars));\n\twhile (count < truncateTo) {\n\t\tcount += getWidth(s[chars++]);\n\t}\n\n\tif (count >= truncateTo) {\n\t\tchars--;\n\t}\n\n\treturn `${s.substring(0, chars)}${ellipsis}`;\n}\n\nexport function truncateLeft(s: string, truncateTo: number, ellipsis: string = '\\u2026', width?: number) {\n\tif (!s) return s;\n\tif (truncateTo <= 1) return ellipsis;\n\n\twidth = width ?? getWidth(s);\n\tif (width <= truncateTo) return s;\n\tif (width === s.length) return `${ellipsis}${s.substring(width - truncateTo)}`;\n\n\t// Skip ahead to start as far as we can by assuming all the double-width characters won't be truncated\n\tlet chars = Math.floor(truncateTo / (width / s.length));\n\tlet count = getWidth(s.substring(0, chars));\n\twhile (count < truncateTo) {\n\t\tcount += getWidth(s[chars++]);\n\t}\n\n\tif (count >= truncateTo) {\n\t\tchars--;\n\t}\n\n\treturn `${ellipsis}${s.substring(s.length - chars)}`;\n}\n\nexport function truncateMiddle(s: string, truncateTo: number, ellipsis: string = '\\u2026') {\n\tif (!s) return s;\n\tif (truncateTo <= 1) return ellipsis;\n\n\tconst width = getWidth(s);\n\tif (width <= truncateTo) return s;\n\n\treturn `${s.slice(0, Math.floor(truncateTo / 2) - 1)}${ellipsis}${s.slice(width - Math.ceil(truncateTo / 2))}`;\n}\n\n// See chalk/ansi-regex\nconst ansiRegex =\n\t// eslint-disable-next-line no-control-regex\n\t/[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:[a-zA-Z\\d]*(?:;[-a-zA-Z\\d/#&.:=?%@~_]*)*)?\\u0007)|(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))/g;\nconst containsNonAsciiRegex = /[^\\x20-\\x7F\\u00a0\\u2026]/;\n\n// See sindresorhus/string-width\nexport function getWidth(s: string): number {\n\tif (s == null || s.length === 0) return 0;\n\n\t// Shortcut to avoid needless string `RegExp`s, replacements, and allocations\n\tif (!containsNonAsciiRegex.test(s)) return s.length;\n\n\ts = s.replace(ansiRegex, emptyStr);\n\n\tlet count = 0;\n\tlet emoji = 0;\n\tlet joiners = 0;\n\n\tconst graphemes = [...s];\n\tfor (let i = 0; i < graphemes.length; i++) {\n\t\tconst code = graphemes[i].codePointAt(0)!;\n\n\t\t// Ignore control characters\n\t\tif (code <= 0x1f || (code >= 0x7f && code <= 0x9f)) continue;\n\n\t\t// Ignore combining characters\n\t\tif (code >= 0x300 && code <= 0x36f) continue;\n\n\t\tif (\n\t\t\t(code >= 0x1f600 && code <= 0x1f64f) || // Emoticons\n\t\t\t(code >= 0x1f300 && code <= 0x1f5ff) || // Misc Symbols and Pictographs\n\t\t\t(code >= 0x1f680 && code <= 0x1f6ff) || // Transport and Map\n\t\t\t(code >= 0x2600 && code <= 0x26ff) || // Misc symbols\n\t\t\t(code >= 0x2700 && code <= 0x27bf) || // Dingbats\n\t\t\t(code >= 0xfe00 && code <= 0xfe0f) || // Variation Selectors\n\t\t\t(code >= 0x1f900 && code <= 0x1f9ff) || // Supplemental Symbols and Pictographs\n\t\t\t(code >= 65024 && code <= 65039) || // Variation selector\n\t\t\t(code >= 8400 && code <= 8447) // Combining Diacritical Marks for Symbols\n\t\t) {\n\t\t\tif (code >= 0x1f3fb && code <= 0x1f3ff) continue; // emoji modifier fitzpatrick type\n\n\t\t\temoji++;\n\t\t\tcount += 2;\n\t\t\tcontinue;\n\t\t}\n\n\t\t// Ignore zero-width joiners '\\u200d'\n\t\tif (code === 8205) {\n\t\t\tjoiners++;\n\t\t\tcount -= 2;\n\t\t\tcontinue;\n\t\t}\n\n\t\t// Surrogates\n\t\tif (code > 0xffff) {\n\t\t\ti++;\n\t\t}\n\n\t\tcount += isFullwidthCodePoint(code) ? 2 : 1;\n\t}\n\n\tconst offset = emoji - joiners;\n\tif (offset > 1) {\n\t\tcount += offset - 1;\n\t}\n\treturn count;\n}\n\n// See sindresorhus/is-fullwidth-code-point\nfunction isFullwidthCodePoint(cp: number) {\n\t// code points are derived from:\n\t// http://www.unix.org/Public/UNIDATA/EastAsianWidth.txt\n\tif (\n\t\tcp >= 0x1100 &&\n\t\t(cp <= 0x115f || // Hangul Jamo\n\t\t\tcp === 0x2329 || // LEFT-POINTING ANGLE BRACKET\n\t\t\tcp === 0x232a || // RIGHT-POINTING ANGLE BRACKET\n\t\t\t// CJK Radicals Supplement .. Enclosed CJK Letters and Months\n\t\t\t(cp >= 0x2e80 && cp <= 0x3247 && cp !== 0x303f) ||\n\t\t\t// Enclosed CJK Letters and Months .. CJK Unified Ideographs Extension A\n\t\t\t(cp >= 0x3250 && cp <= 0x4dbf) ||\n\t\t\t// CJK Unified Ideographs .. Yi Radicals\n\t\t\t(cp >= 0x4e00 && cp <= 0xa4c6) ||\n\t\t\t// Hangul Jamo Extended-A\n\t\t\t(cp >= 0xa960 && cp <= 0xa97c) ||\n\t\t\t// Hangul Syllables\n\t\t\t(cp >= 0xac00 && cp <= 0xd7a3) ||\n\t\t\t// CJK Compatibility Ideographs\n\t\t\t(cp >= 0xf900 && cp <= 0xfaff) ||\n\t\t\t// Vertical Forms\n\t\t\t(cp >= 0xfe10 && cp <= 0xfe19) ||\n\t\t\t// CJK Compatibility Forms .. Small Form Variants\n\t\t\t(cp >= 0xfe30 && cp <= 0xfe6b) ||\n\t\t\t// Halfwidth and Fullwidth Forms\n\t\t\t(cp >= 0xff01 && cp <= 0xff60) ||\n\t\t\t(cp >= 0xffe0 && cp <= 0xffe6) ||\n\t\t\t// Kana Supplement\n\t\t\t(cp >= 0x1b000 && cp <= 0x1b001) ||\n\t\t\t// Enclosed Ideographic Supplement\n\t\t\t(cp >= 0x1f200 && cp <= 0x1f251) ||\n\t\t\t// CJK Unified Ideographs Extension B .. Tertiary Ideographic Plane\n\t\t\t(cp >= 0x20000 && cp <= 0x3fffd))\n\t) {\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n","'use strict';\nimport { LogCorrelationContext, Logger, TraceLevel } from '../../logger';\nimport { filterMap } from '../array';\nimport { getParameters } from '../function';\nimport { is as isPromise } from '../promise';\nimport { getDurationMilliseconds } from '../string';\n\nconst emptyStr = '';\n\nconst correlationContext = new Map<number, LogCorrelationContext>();\nlet correlationCounter = 0;\n\nexport function getCorrelationContext() {\n\treturn correlationContext.get(correlationCounter);\n}\n\nexport function getCorrelationId() {\n\treturn correlationCounter;\n}\n\nexport function getNextCorrelationId() {\n\tif (correlationCounter === Number.MAX_SAFE_INTEGER) {\n\t\tcorrelationCounter = 0;\n\t}\n\treturn ++correlationCounter;\n}\n\nfunction clearCorrelationContext(correlationId: number) {\n\tcorrelationContext.delete(correlationId);\n}\n\nfunction setCorrelationContext(correlationId: number, context: LogCorrelationContext) {\n\tcorrelationContext.set(correlationId, context);\n}\n\nexport interface LogContext {\n\tid: number;\n\tinstance: any;\n\tinstanceName: string;\n\tname: string;\n\tprefix: string;\n}\n\nexport const LogInstanceNameFn = Symbol('logInstanceNameFn');\n\nexport function logName<T>(fn: (c: T, name: string) => string) {\n\treturn (target: Function) => {\n\t\t(target as any)[LogInstanceNameFn] = fn;\n\t};\n}\n\nexport function debug<T extends (...arg: any) => any>(\n\toptions: {\n\t\targs?: false | Record<string, (arg: any) => string | false>;\n\t\tcondition?(...args: Parameters<T>): boolean;\n\t\tcorrelate?: boolean;\n\t\tenter?(...args: Parameters<T>): string;\n\t\texit?(result: PromiseType<ReturnType<T>>): string;\n\t\tprefix?(context: LogContext, ...args: Parameters<T>): string;\n\t\tsanitize?(key: string, value: any): any;\n\t\tsingleLine?: boolean;\n\t\ttimed?: boolean;\n\t} = { timed: true },\n) {\n\treturn log<T>({ debug: true, ...options });\n}\n\ntype PromiseType<T> = T extends Promise<infer U> ? U : T;\n\nexport function log<T extends (...arg: any) => any>(\n\toptions: {\n\t\targs?: false | Record<number, (arg: any) => string | false>;\n\t\tcondition?(...args: Parameters<T>): boolean;\n\t\tcorrelate?: boolean;\n\t\tdebug?: boolean;\n\t\tenter?(...args: Parameters<T>): string;\n\t\texit?(result: PromiseType<ReturnType<T>>): string;\n\t\tprefix?(context: LogContext, ...args: Parameters<T>): string;\n\t\tsanitize?(key: string, value: any): any;\n\t\tsingleLine?: boolean;\n\t\ttimed?: boolean;\n\t} = { timed: true },\n) {\n\toptions = { timed: true, ...options };\n\n\tconst logFn = (options.debug ? Logger.debug.bind(Logger) : Logger.log.bind(Logger)) as\n\t\t| typeof Logger.debug\n\t\t| typeof Logger.log;\n\n\treturn (target: any, key: string, descriptor: PropertyDescriptor & Record<string, any>) => {\n\t\tlet fn: Function | undefined;\n\t\tlet fnKey: string | undefined;\n\t\tif (typeof descriptor.value === 'function') {\n\t\t\tfn = descriptor.value;\n\t\t\tfnKey = 'value';\n\t\t} else if (typeof descriptor.get === 'function') {\n\t\t\tfn = descriptor.get;\n\t\t\tfnKey = 'get';\n\t\t}\n\t\tif (fn == null || fnKey == null) throw new Error('Not supported');\n\n\t\tconst parameters = getParameters(fn);\n\n\t\tdescriptor[fnKey] = function (this: any, ...args: Parameters<T>) {\n\t\t\tconst correlationId = getNextCorrelationId();\n\n\t\t\tif (\n\t\t\t\t(!Logger.isDebugging &&\n\t\t\t\t\tLogger.level !== TraceLevel.Debug &&\n\t\t\t\t\t!(Logger.level === TraceLevel.Verbose && !options.debug)) ||\n\t\t\t\t(typeof options.condition === 'function' && !options.condition(...args))\n\t\t\t) {\n\t\t\t\treturn fn!.apply(this, args);\n\t\t\t}\n\n\t\t\tlet instanceName: string;\n\t\t\tif (this != null) {\n\t\t\t\tinstanceName = Logger.toLoggableName(this);\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n\t\t\t\tif (this.constructor?.[LogInstanceNameFn]) {\n\t\t\t\t\tinstanceName = target.constructor[LogInstanceNameFn](this, instanceName);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tinstanceName = emptyStr;\n\t\t\t}\n\n\t\t\tlet { correlate } = options;\n\t\t\tif (!correlate && options.timed) {\n\t\t\t\tcorrelate = true;\n\t\t\t}\n\n\t\t\tlet prefix = `${correlate ? `[${correlationId.toString(16)}] ` : emptyStr}${\n\t\t\t\tinstanceName ? `${instanceName}.` : emptyStr\n\t\t\t}${key}`;\n\n\t\t\tif (options.prefix != null) {\n\t\t\t\tprefix = options.prefix(\n\t\t\t\t\t{\n\t\t\t\t\t\tid: correlationId,\n\t\t\t\t\t\tinstance: this,\n\t\t\t\t\t\tinstanceName: instanceName,\n\t\t\t\t\t\tname: key,\n\t\t\t\t\t\tprefix: prefix,\n\t\t\t\t\t},\n\t\t\t\t\t...args,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tlet correlationContext: LogCorrelationContext | undefined;\n\t\t\tif (correlate) {\n\t\t\t\tcorrelationContext = { correlationId: correlationId, prefix: prefix };\n\t\t\t\tsetCorrelationContext(correlationId, correlationContext);\n\t\t\t}\n\n\t\t\tconst enter = options.enter != null ? options.enter(...args) : emptyStr;\n\n\t\t\tlet loggableParams: string;\n\t\t\tif (options.args === false || args.length === 0) {\n\t\t\t\tloggableParams = emptyStr;\n\n\t\t\t\tif (!options.singleLine) {\n\t\t\t\t\tlogFn(`${prefix}${enter}`);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst argFns = typeof options.args === 'object' ? options.args : undefined;\n\t\t\t\tlet argFn;\n\t\t\t\tlet loggable;\n\t\t\t\tloggableParams = filterMap(args, (v: any, index: number) => {\n\t\t\t\t\tconst p = parameters[index];\n\n\t\t\t\t\targFn = argFns !== undefined ? argFns[index] : undefined;\n\t\t\t\t\tif (argFn !== undefined) {\n\t\t\t\t\t\tloggable = argFn(v);\n\t\t\t\t\t\tif (loggable === false) return undefined;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tloggable = Logger.toLoggable(v, options.sanitize);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn p ? `${p}=${loggable}` : loggable;\n\t\t\t\t}).join(', ');\n\n\t\t\t\tif (!options.singleLine) {\n\t\t\t\t\tif (!options.debug) {\n\t\t\t\t\t\tLogger.logWithDebugParams(`${prefix}${enter}`, loggableParams);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlogFn(`${prefix}${enter}`, loggableParams);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (options.singleLine || options.timed || options.exit != null) {\n\t\t\t\tconst start = options.timed ? process.hrtime() : undefined;\n\n\t\t\t\tconst logError = (ex: Error) => {\n\t\t\t\t\tconst timing = start !== undefined ? ` \\u2022 ${getDurationMilliseconds(start)} ms` : emptyStr;\n\t\t\t\t\tif (options.singleLine) {\n\t\t\t\t\t\tLogger.error(\n\t\t\t\t\t\t\tex,\n\t\t\t\t\t\t\t`${prefix}${enter}`,\n\t\t\t\t\t\t\t`failed${\n\t\t\t\t\t\t\t\tcorrelationContext?.exitDetails ? correlationContext.exitDetails : emptyStr\n\t\t\t\t\t\t\t}${timing}`,\n\t\t\t\t\t\t\tloggableParams,\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tLogger.error(\n\t\t\t\t\t\t\tex,\n\t\t\t\t\t\t\tprefix,\n\t\t\t\t\t\t\t`failed${\n\t\t\t\t\t\t\t\tcorrelationContext?.exitDetails ? correlationContext.exitDetails : emptyStr\n\t\t\t\t\t\t\t}${timing}`,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (correlate) {\n\t\t\t\t\t\tclearCorrelationContext(correlationId);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tlet result;\n\t\t\t\ttry {\n\t\t\t\t\tresult = fn!.apply(this, args);\n\t\t\t\t} catch (ex) {\n\t\t\t\t\tlogError(ex);\n\t\t\t\t\tthrow ex;\n\t\t\t\t}\n\n\t\t\t\tconst logResult = (r: any) => {\n\t\t\t\t\tconst timing = start !== undefined ? ` \\u2022 ${getDurationMilliseconds(start)} ms` : emptyStr;\n\t\t\t\t\tlet exit;\n\t\t\t\t\tif (options.exit != null) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\texit = options.exit(r);\n\t\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\t\texit = `@log.exit error: ${ex}`;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\texit = 'completed';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (options.singleLine) {\n\t\t\t\t\t\tif (!options.debug) {\n\t\t\t\t\t\t\tLogger.logWithDebugParams(\n\t\t\t\t\t\t\t\t`${prefix}${enter} ${exit}${\n\t\t\t\t\t\t\t\t\tcorrelationContext?.exitDetails ? correlationContext.exitDetails : emptyStr\n\t\t\t\t\t\t\t\t}${timing}`,\n\t\t\t\t\t\t\t\tloggableParams,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlogFn(\n\t\t\t\t\t\t\t\t`${prefix}${enter} ${exit}${\n\t\t\t\t\t\t\t\t\tcorrelationContext?.exitDetails ? correlationContext.exitDetails : emptyStr\n\t\t\t\t\t\t\t\t}${timing}`,\n\t\t\t\t\t\t\t\tloggableParams,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlogFn(\n\t\t\t\t\t\t\t`${prefix} ${exit}${\n\t\t\t\t\t\t\t\tcorrelationContext?.exitDetails ? correlationContext.exitDetails : emptyStr\n\t\t\t\t\t\t\t}${timing}`,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (correlate) {\n\t\t\t\t\t\tclearCorrelationContext(correlationId);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tif (result != null && isPromise(result)) {\n\t\t\t\t\tconst promise = result.then(logResult);\n\t\t\t\t\tpromise.catch(logError);\n\t\t\t\t} else {\n\t\t\t\t\tlogResult(result);\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\treturn fn!.apply(this, args);\n\t\t};\n\t};\n}\n","'use strict';\nimport { cancellable, is as isPromise } from '../promise';\n\nexport function timeout(timeout: number): any;\nexport function timeout(timeoutFromLastArg: true, defaultTimeout?: number): any;\nexport function timeout(timeoutOrTimeoutFromLastArg: number | boolean, defaultTimeout?: number): any {\n\tlet timeout: number | undefined;\n\tlet timeoutFromLastArg = false;\n\tif (typeof timeoutOrTimeoutFromLastArg === 'boolean') {\n\t\ttimeoutFromLastArg = timeoutOrTimeoutFromLastArg;\n\t} else {\n\t\ttimeout = timeoutOrTimeoutFromLastArg;\n\t}\n\n\treturn (target: any, key: string, descriptor: PropertyDescriptor) => {\n\t\tlet fn: Function | undefined;\n\t\tif (typeof descriptor.value === 'function') {\n\t\t\tfn = descriptor.value;\n\t\t}\n\t\tif (fn == null) throw new Error('Not supported');\n\n\t\tdescriptor.value = function (this: any, ...args: any[]) {\n\t\t\tif (timeoutFromLastArg) {\n\t\t\t\tconst lastArg = args[args.length - 1];\n\t\t\t\tif (lastArg != null && typeof lastArg === 'number') {\n\t\t\t\t\ttimeout = lastArg;\n\t\t\t\t} else {\n\t\t\t\t\ttimeout = defaultTimeout;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst result = fn?.apply(this, args);\n\t\t\tif (timeout == null || timeout < 1 || !isPromise(result)) return result;\n\n\t\t\treturn cancellable(result, timeout, { onDidCancel: resolve => resolve(undefined) });\n\t\t};\n\t};\n}\n","import baseIsEqual from './_baseIsEqual.js';\n\n/**\n * Performs a deep comparison between two values to determine if they are\n * equivalent.\n *\n * **Note:** This method supports comparing arrays, array buffers, booleans,\n * date objects, error objects, maps, numbers, `Object` objects, regexes,\n * sets, strings, symbols, and typed arrays. `Object` objects are compared\n * by their own, not inherited, enumerable properties. Functions and DOM\n * nodes are compared by strict equality, i.e. `===`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.isEqual(object, other);\n * // => true\n *\n * object === other;\n * // => false\n */\nfunction isEqual(value, other) {\n  return baseIsEqual(value, other);\n}\n\nexport default isEqual;\n","'use strict';\n\nexport { isEqual as areEqual } from 'lodash-es';\n\nexport function flatten(o: any, prefix: string = '', stringify: boolean = false): Record<string, any> {\n\tconst flattened = Object.create(null) as Record<string, any>;\n\t_flatten(flattened, prefix, o, stringify);\n\treturn flattened;\n}\n\nfunction _flatten(flattened: Record<string, any>, key: string, value: any, stringify: boolean = false) {\n\tif (Object(value) !== value) {\n\t\tif (stringify) {\n\t\t\tif (value == null) {\n\t\t\t\tflattened[key] = null;\n\t\t\t} else if (typeof value === 'string') {\n\t\t\t\tflattened[key] = value;\n\t\t\t} else {\n\t\t\t\tflattened[key] = JSON.stringify(value);\n\t\t\t}\n\t\t} else {\n\t\t\tflattened[key] = value;\n\t\t}\n\t} else if (Array.isArray(value)) {\n\t\tconst len = value.length;\n\t\tfor (let i = 0; i < len; i++) {\n\t\t\t_flatten(flattened, `${key}[${i}]`, value[i], stringify);\n\t\t}\n\t\tif (len === 0) {\n\t\t\tflattened[key] = null;\n\t\t}\n\t} else {\n\t\tlet isEmpty = true;\n\t\tfor (const p in value) {\n\t\t\tisEmpty = false;\n\t\t\t_flatten(flattened, key ? `${key}.${p}` : p, value[p], stringify);\n\t\t}\n\t\tif (isEmpty && key) {\n\t\t\tflattened[key] = null;\n\t\t}\n\t}\n}\n\nexport function paths(o: Record<string, any>, path?: string): string[] {\n\tconst results = [];\n\n\tfor (const key in o) {\n\t\tconst child = o[key];\n\t\tif (typeof child === 'object') {\n\t\t\tresults.push(...paths(child, path === undefined ? key : `${path}.${key}`));\n\t\t} else {\n\t\t\tresults.push(path === undefined ? key : `${path}.${key}`);\n\t\t}\n\t}\n\n\treturn results;\n}\n","/* eslint-disable @typescript-eslint/strict-boolean-expressions */\n'use strict';\nimport { count, map, some } from './iterable';\nimport { CharCode, compareSubstring, compareSubstringIgnoreCase } from './string';\n\nconst FIN = { done: true, value: undefined };\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport interface IKeyIterator<K> {\n\treset(key: K): this;\n\tnext(): this;\n\n\thasNext(): boolean;\n\tcmp(a: string): number;\n\tvalue(): string;\n}\n\nexport class StringIterator implements IKeyIterator<string> {\n\tprivate _value: string = '';\n\tprivate _pos: number = 0;\n\n\treset(key: string): this {\n\t\tthis._value = key;\n\t\tthis._pos = 0;\n\t\treturn this;\n\t}\n\n\tnext(): this {\n\t\tthis._pos += 1;\n\t\treturn this;\n\t}\n\n\thasNext(): boolean {\n\t\treturn this._pos < this._value.length - 1;\n\t}\n\n\tcmp(a: string): number {\n\t\tconst aCode = a.charCodeAt(0);\n\t\tconst thisCode = this._value.charCodeAt(this._pos);\n\t\treturn aCode - thisCode;\n\t}\n\n\tvalue(): string {\n\t\treturn this._value[this._pos];\n\t}\n}\n\nexport class PathIterator implements IKeyIterator<string> {\n\tprivate _value!: string;\n\tprivate _from!: number;\n\tprivate _to!: number;\n\n\tconstructor(private readonly _splitOnBackslash: boolean = true, private readonly _caseSensitive: boolean = true) {}\n\n\treset(key: string): this {\n\t\tthis._value = key.replace(/\\\\$|\\/$/, '');\n\t\tthis._from = 0;\n\t\tthis._to = 0;\n\t\treturn this.next();\n\t}\n\n\thasNext(): boolean {\n\t\treturn this._to < this._value.length;\n\t}\n\n\tnext(): this {\n\t\t// this._data = key.split(/[\\\\/]/).filter(s => !!s);\n\t\tthis._from = this._to;\n\t\tlet justSeps = true;\n\t\tfor (; this._to < this._value.length; this._to++) {\n\t\t\tconst ch = this._value.charCodeAt(this._to);\n\t\t\tif (ch === CharCode.Slash || (this._splitOnBackslash && ch === CharCode.Backslash)) {\n\t\t\t\tif (justSeps) {\n\t\t\t\t\tthis._from++;\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tjustSeps = false;\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tcmp(a: string): number {\n\t\treturn this._caseSensitive\n\t\t\t? compareSubstring(a, this._value, 0, a.length, this._from, this._to)\n\t\t\t: compareSubstringIgnoreCase(a, this._value, 0, a.length, this._from, this._to);\n\t}\n\n\tvalue(): string {\n\t\treturn this._value.substring(this._from, this._to);\n\t}\n}\n\nclass TernarySearchTreeNode<K, V> {\n\tsegment!: string;\n\tvalue: V | undefined;\n\tkey!: K;\n\tleft: TernarySearchTreeNode<K, V> | undefined;\n\tmid: TernarySearchTreeNode<K, V> | undefined;\n\tright: TernarySearchTreeNode<K, V> | undefined;\n\n\tisEmpty(): boolean {\n\t\treturn !this.left && !this.mid && !this.right && !this.value;\n\t}\n}\n\nexport class TernarySearchTree<K, V> {\n\tstatic forPaths<E>(): TernarySearchTree<string, E> {\n\t\treturn new TernarySearchTree<string, E>(new PathIterator());\n\t}\n\n\tstatic forStrings<E>(): TernarySearchTree<string, E> {\n\t\treturn new TernarySearchTree<string, E>(new StringIterator());\n\t}\n\n\tprivate _iter: IKeyIterator<K>;\n\tprivate _root: TernarySearchTreeNode<K, V> | undefined;\n\n\tconstructor(segments: IKeyIterator<K>) {\n\t\tthis._iter = segments;\n\t}\n\n\tclear(): void {\n\t\tthis._root = undefined;\n\t}\n\n\tset(key: K, element: V): V | undefined {\n\t\tconst iter = this._iter.reset(key);\n\t\tlet node: TernarySearchTreeNode<K, V>;\n\n\t\tif (!this._root) {\n\t\t\tthis._root = new TernarySearchTreeNode<K, V>();\n\t\t\tthis._root.segment = iter.value();\n\t\t}\n\n\t\tnode = this._root;\n\t\twhile (true) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tif (!node.left) {\n\t\t\t\t\tnode.left = new TernarySearchTreeNode<K, V>();\n\t\t\t\t\tnode.left.segment = iter.value();\n\t\t\t\t}\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tif (!node.right) {\n\t\t\t\t\tnode.right = new TernarySearchTreeNode<K, V>();\n\t\t\t\t\tnode.right.segment = iter.value();\n\t\t\t\t}\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tif (!node.mid) {\n\t\t\t\t\tnode.mid = new TernarySearchTreeNode<K, V>();\n\t\t\t\t\tnode.mid.segment = iter.value();\n\t\t\t\t}\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tconst oldElement = node.value;\n\t\tnode.value = element;\n\t\tnode.key = key;\n\t\treturn oldElement;\n\t}\n\n\tget(key: K): V | undefined {\n\t\treturn this._getNode(key)?.value;\n\t}\n\n\tprivate _getNode(key: K) {\n\t\tconst iter = this._iter.reset(key);\n\t\tlet node = this._root;\n\t\twhile (node) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn node;\n\t}\n\n\thas(key: K): boolean {\n\t\tconst node = this._getNode(key);\n\t\treturn !(node?.value === undefined && node?.mid === undefined);\n\t}\n\n\tdelete(key: K): void {\n\t\treturn this._delete(key, false);\n\t}\n\n\tdeleteSuperstr(key: K): void {\n\t\treturn this._delete(key, true);\n\t}\n\n\tprivate _delete(key: K, superStr: boolean): void {\n\t\tconst iter = this._iter.reset(key);\n\t\tconst stack: [-1 | 0 | 1, TernarySearchTreeNode<K, V>][] = [];\n\t\tlet node = this._root;\n\n\t\t// find and unset node\n\t\twhile (node) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tstack.push([1, node]);\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tstack.push([-1, node]);\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tstack.push([0, node]);\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\tif (superStr) {\n\t\t\t\t\t// remove children\n\t\t\t\t\tnode.left = undefined;\n\t\t\t\t\tnode.mid = undefined;\n\t\t\t\t\tnode.right = undefined;\n\t\t\t\t} else {\n\t\t\t\t\t// remove element\n\t\t\t\t\tnode.value = undefined;\n\t\t\t\t}\n\n\t\t\t\t// clean up empty nodes\n\t\t\t\twhile (stack.length > 0 && node.isEmpty()) {\n\t\t\t\t\tconst [dir, parent] = stack.pop()!;\n\t\t\t\t\tswitch (dir) {\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\tparent.left = undefined;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\t\tparent.mid = undefined;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase -1:\n\t\t\t\t\t\t\tparent.right = undefined;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tnode = parent;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tfindSubstr(key: K): V | undefined {\n\t\tconst iter = this._iter.reset(key);\n\t\tlet node = this._root;\n\t\tlet candidate: V | undefined;\n\t\twhile (node) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tcandidate = node.value || candidate;\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn node?.value || candidate;\n\t}\n\n\tfindSuperstr(key: K, limit: boolean = false): Iterable<V> | undefined {\n\t\tconst iter = this._iter.reset(key);\n\t\tlet node = this._root;\n\t\twhile (node) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\t// collect\n\t\t\t\tif (!node.mid) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\tnode = node.mid;\n\t\t\t\treturn {\n\t\t\t\t\t// eslint-disable-next-line no-loop-func\n\t\t\t\t\t[Symbol.iterator]: () => this._nodeIterator(node!, limit),\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate _nodeIterator(node: TernarySearchTreeNode<K, V>, limit: boolean = false): Iterator<V> {\n\t\tlet res: { done: false; value: V };\n\t\tlet idx: number;\n\t\tlet data: V[];\n\t\tconst next = (): IteratorResult<V> => {\n\t\t\tif (!data) {\n\t\t\t\t// lazy till first invocation\n\t\t\t\tdata = [];\n\t\t\t\tidx = 0;\n\t\t\t\tthis._forEach(node, value => data.push(value), limit);\n\t\t\t}\n\t\t\tif (idx >= data.length) {\n\t\t\t\treturn FIN as unknown as IteratorResult<V>;\n\t\t\t}\n\n\t\t\tif (!res) {\n\t\t\t\tres = { done: false, value: data[idx++] };\n\t\t\t} else {\n\t\t\t\tres.value = data[idx++];\n\t\t\t}\n\t\t\treturn res;\n\t\t};\n\t\treturn { next: next };\n\t}\n\n\tforEach(callback: (value: V, index: K) => any) {\n\t\tthis._forEach(this._root, callback);\n\t}\n\n\tprivate _forEach(\n\t\tnode: TernarySearchTreeNode<K, V> | undefined,\n\t\tcallback: (value: V, index: K) => any,\n\t\tlimit: boolean = false,\n\t) {\n\t\tif (node === undefined) return;\n\n\t\t// left\n\t\tthis._forEach(node.left, callback, limit);\n\n\t\t// node\n\t\tif (node.value) {\n\t\t\tcallback(node.value, node.key);\n\t\t}\n\n\t\tif (!limit) {\n\t\t\t// mid\n\t\t\tthis._forEach(node.mid, callback, limit);\n\t\t}\n\n\t\t// right\n\t\tthis._forEach(node.right, callback, limit);\n\t}\n\n\tany(): boolean {\n\t\treturn this._root !== undefined && !this._root.isEmpty();\n\t}\n\n\tcount(predicate?: (entry: V) => boolean): number {\n\t\tif (this._root === undefined || this._root.isEmpty()) return 0;\n\n\t\treturn count(this.entries(), predicate === undefined ? undefined : ([, e]) => predicate(e));\n\t}\n\n\tentries(): Iterable<[K, V]> {\n\t\treturn this._iterator(this._root);\n\t}\n\n\tvalues(): Iterable<V> {\n\t\treturn map(this.entries(), ([, e]) => e);\n\t}\n\n\thighlander(): [K, V] | undefined {\n\t\tif (this._root === undefined || this._root.isEmpty()) return undefined;\n\n\t\tconst entries = this.entries() as IterableIterator<[K, V]>;\n\n\t\tlet count = 0;\n\t\tlet next: IteratorResult<[K, V]>;\n\t\tlet value: [K, V] | undefined;\n\n\t\twhile (true) {\n\t\t\tnext = entries.next();\n\t\t\tif (next.done) break;\n\n\t\t\tvalue = next.value;\n\n\t\t\tcount++;\n\t\t\tif (count > 1) return undefined;\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tsome(predicate: (entry: V) => boolean): boolean {\n\t\tif (this._root === undefined || this._root.isEmpty()) return false;\n\n\t\treturn some(this.entries(), ([, e]) => predicate(e));\n\t}\n\n\t*[Symbol.iterator](): IterableIterator<[K, V]> {\n\t\tyield* this._iterator(this._root);\n\t}\n\n\tprivate *_iterator(node: TernarySearchTreeNode<K, V> | undefined): IterableIterator<[K, V]> {\n\t\tif (node) {\n\t\t\t// left\n\t\t\tyield* this._iterator(node.left);\n\n\t\t\t// node\n\t\t\tif (node.value) {\n\t\t\t\tyield [node.key, node.value];\n\t\t\t}\n\n\t\t\t// mid\n\t\t\tyield* this._iterator(node.mid);\n\n\t\t\t// right\n\t\t\tyield* this._iterator(node.right);\n\t\t}\n\t}\n}\n","'use strict';\n\nexport class Stopwatch {\n\tprivate static readonly timers = new Map<string, [number, number]>();\n\n\tstatic start(id: string) {\n\t\tif (Stopwatch.timers.has(id)) {\n\t\t\tthis.log(id);\n\t\t}\n\n\t\tStopwatch.timers.set(id, process.hrtime());\n\t}\n\n\tstatic log(id: string, message?: string) {\n\t\tconst [secs, nanosecs] = process.hrtime(Stopwatch.timers.get(id));\n\t\tconst ms = secs * 1000 + Math.floor(nanosecs / 1000000);\n\n\t\tconsole.log(`${id}${message ? `(${message})` : ''} took ${ms} ms`);\n\t}\n\n\tstatic stop(id: string, message?: string) {\n\t\tif (!Stopwatch.timers.has(id)) return;\n\n\t\tthis.log(id, message);\n\t\tStopwatch.timers.delete(id);\n\t}\n}\n","'use strict';\n\ndeclare type VersionComparisonResult = -1 | 0 | 1;\n\nexport interface Version {\n\tmajor: number;\n\tminor: number;\n\tpatch: number;\n\tpre?: string;\n}\n\nexport function compare(v1: string | Version, v2: string | Version): VersionComparisonResult {\n\tif (typeof v1 === 'string') {\n\t\tv1 = fromString(v1);\n\t}\n\tif (typeof v2 === 'string') {\n\t\tv2 = fromString(v2);\n\t}\n\n\tif (v1.major > v2.major) return 1;\n\tif (v1.major < v2.major) return -1;\n\n\tif (v1.minor > v2.minor) return 1;\n\tif (v1.minor < v2.minor) return -1;\n\n\tif (v1.patch > v2.patch) return 1;\n\tif (v1.patch < v2.patch) return -1;\n\n\tif (v1.pre === undefined && v2.pre !== undefined) return 1;\n\tif (v1.pre !== undefined && v2.pre === undefined) return -1;\n\n\tif (v1.pre !== undefined && v2.pre !== undefined) {\n\t\treturn v1.pre.localeCompare(v2.pre) as VersionComparisonResult;\n\t}\n\n\treturn 0;\n}\n\nexport function from(major: string | number, minor: string | number, patch?: string | number, pre?: string): Version {\n\treturn {\n\t\tmajor: typeof major === 'string' ? parseInt(major, 10) : major,\n\t\tminor: typeof minor === 'string' ? parseInt(minor, 10) : minor,\n\t\tpatch: patch == null ? 0 : typeof patch === 'string' ? parseInt(patch, 10) : patch,\n\t\tpre: pre,\n\t};\n}\n\nexport function fromString(version: string): Version {\n\tconst [ver, pre] = version.split('-');\n\tconst [major, minor, patch] = ver.split('.');\n\treturn from(major, minor, patch, pre);\n}\n","'use strict';\nimport dayjs from 'dayjs';\nimport * as advancedFormat from 'dayjs/plugin/advancedFormat';\nimport * as relativeTime from 'dayjs/plugin/relativeTime';\nimport * as updateLocale from 'dayjs/plugin/updateLocale';\n\ndayjs.extend(advancedFormat.default);\ndayjs.extend(relativeTime.default, {\n\tthresholds: [\n\t\t{ l: 's', r: 44, d: 'second' },\n\t\t{ l: 'm', r: 89 },\n\t\t{ l: 'mm', r: 44, d: 'minute' },\n\t\t{ l: 'h', r: 89 },\n\t\t{ l: 'hh', r: 21, d: 'hour' },\n\t\t{ l: 'd', r: 35 },\n\t\t{ l: 'dd', r: 6, d: 'day' },\n\t\t{ l: 'w', r: 7 },\n\t\t{ l: 'ww', r: 3, d: 'week' },\n\t\t{ l: 'M', r: 4 },\n\t\t{ l: 'MM', r: 10, d: 'month' },\n\t\t{ l: 'y', r: 17 },\n\t\t{ l: 'yy', d: 'year' },\n\t],\n});\ndayjs.extend(updateLocale.default);\n\ndayjs.updateLocale('en', {\n\trelativeTime: {\n\t\tfuture: 'in %s',\n\t\tpast: '%s ago',\n\t\ts: 'seconds',\n\t\tm: 'a minute',\n\t\tmm: '%d minutes',\n\t\th: 'an hour',\n\t\thh: '%d hours',\n\t\td: 'a day',\n\t\tdd: '%d days',\n\t\tw: 'a week',\n\t\tww: '%d weeks',\n\t\tM: 'a month',\n\t\tMM: '%d months',\n\t\ty: 'a year',\n\t\tyy: '%d years',\n\t},\n});\n\nconst shortLocale = {\n\tname: 'en-short',\n\tweekdays: 'Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split('_'),\n\tmonths: 'January_February_March_April_May_June_July_August_September_October_November_December'.split('_'),\n\tweekStart: 1,\n\tweekdaysShort: 'Sun_Mon_Tue_Wed_Thu_Fri_Sat'.split('_'),\n\tmonthsShort: 'Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec'.split('_'),\n\tweekdaysMin: 'Su_Mo_Tu_We_Th_Fr_Sa'.split('_'),\n\t// relativeTime: {\n\t// \tfuture: 'in %s',\n\t// \tpast: '%s',\n\t// \ts: 'now',\n\t// \tm: '1 min',\n\t// \tmm: '%d mins',\n\t// \th: '1 hr',\n\t// \thh: '%d hrs',\n\t// \td: '1 day',\n\t// \tdd: '%d days',\n\t// \tw: '1 wk',\n\t// \tww: '%d wks',\n\t// \tM: '1 mo',\n\t// \tMM: '%d mos',\n\t// \ty: '1 yr',\n\t// \tyy: '%d yrs',\n\t// },\n\trelativeTime: {\n\t\tfuture: 'in %s',\n\t\tpast: '%s',\n\t\ts: 'now',\n\t\tm: '1m',\n\t\tmm: '%dm',\n\t\th: '1h',\n\t\thh: '%dh',\n\t\td: '1d',\n\t\tdd: '%dd',\n\t\tw: '1wk',\n\t\tww: '%dwk',\n\t\tM: '1mo',\n\t\tMM: '%dmo',\n\t\ty: '1yr',\n\t\tyy: '%dyr',\n\t},\n\tformats: {\n\t\tLTS: 'h:mm:ss A',\n\t\tLT: 'h:mm A',\n\t\tL: 'MM/DD/YYYY',\n\t\tLL: 'MMMM D, YYYY',\n\t\tLLL: 'MMMM D, YYYY h:mm A',\n\t\tLLLL: 'dddd, MMMM D, YYYY h:mm A',\n\t},\n\tordinal: (n: number) => {\n\t\tconst s = ['th', 'st', 'nd', 'rd'];\n\t\tconst v = n % 100;\n\t\treturn `[${n}${s[(v - 20) % 10] || s[v] || s[0]}]`;\n\t},\n};\n\ndayjs.locale('en-short', shortLocale, true);\n\nexport const MillisecondsPerMinute = 60000; // 60 * 1000\nexport const MillisecondsPerHour = 3600000; // 60 * 60 * 1000\nexport const MillisecondsPerDay = 86400000; // 24 * 60 * 60 * 1000\n\nexport interface DateFormatter {\n\tfromNow(locale?: string): string;\n\tformat(format: string): string;\n}\n\nexport function getFormatter(date: Date): DateFormatter {\n\tconst formatter = dayjs(date);\n\treturn {\n\t\tfromNow: function (locale?: string) {\n\t\t\treturn (locale ? formatter.locale(locale) : formatter).fromNow();\n\t\t},\n\t\tformat: function (format: string) {\n\t\t\treturn formatter.format(format);\n\t\t},\n\t};\n}\n","'use strict';\n\nconst emptyStr = '';\n\nfunction defaultResolver(...args: any[]): string {\n\tif (args.length === 1) {\n\t\tconst arg0 = args[0];\n\t\tif (arg0 == null) return emptyStr;\n\t\tif (typeof arg0 === 'string') return arg0;\n\t\tif (typeof arg0 === 'number' || typeof arg0 === 'boolean') {\n\t\t\treturn String(arg0);\n\t\t}\n\n\t\treturn JSON.stringify(arg0);\n\t}\n\n\treturn JSON.stringify(args);\n}\n\nexport function memoize<T extends (...arg: any) => any>(resolver?: (...args: Parameters<T>) => string) {\n\treturn (target: any, key: string, descriptor: PropertyDescriptor & Record<string, any>) => {\n\t\tlet fn: Function | undefined;\n\t\tlet fnKey: string | undefined;\n\n\t\tif (typeof descriptor.value === 'function') {\n\t\t\tfn = descriptor.value;\n\t\t\tfnKey = 'value';\n\t\t} else if (typeof descriptor.get === 'function') {\n\t\t\tfn = descriptor.get;\n\t\t\tfnKey = 'get';\n\t\t} else {\n\t\t\tthrow new Error('Not supported');\n\t\t}\n\n\t\tif (fn == null) throw new Error('Not supported');\n\n\t\tconst memoizeKey = `$memoize$${key}`;\n\n\t\tlet result;\n\t\tdescriptor[fnKey] = function (...args: any[]) {\n\t\t\tconst prop =\n\t\t\t\tfnKey === 'get' || args.length === 0\n\t\t\t\t\t? memoizeKey\n\t\t\t\t\t: `${memoizeKey}$${(resolver ?? defaultResolver)(...(args as Parameters<T>))}`;\n\n\t\t\tif (Object.prototype.hasOwnProperty.call(this, prop)) {\n\t\t\t\tresult = this[prop];\n\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tresult = fn!.apply(this, args);\n\t\t\tObject.defineProperty(this, prop, {\n\t\t\t\tconfigurable: false,\n\t\t\t\tenumerable: false,\n\t\t\t\twritable: false,\n\t\t\t\tvalue: result,\n\t\t\t});\n\n\t\t\treturn result;\n\t\t};\n\t};\n}\n","'use strict';\nimport { Disposable, Terminal, window } from 'vscode';\nimport { Container } from './container';\n\nlet _terminal: Terminal | undefined;\nlet _terminalCwd: string | undefined;\nlet _disposable: Disposable | undefined;\n\nconst extensionTerminalName = 'GitLens';\n\nfunction ensureTerminal(cwd: string): Terminal {\n\tif (_terminal === undefined) {\n\t\t_terminal = window.createTerminal(extensionTerminalName);\n\t\t_disposable = window.onDidCloseTerminal((e: Terminal) => {\n\t\t\tif (e.name === extensionTerminalName) {\n\t\t\t\t_terminal = undefined;\n\t\t\t\t_disposable!.dispose();\n\t\t\t\t_disposable = undefined;\n\t\t\t}\n\t\t});\n\n\t\tContainer.context.subscriptions.push(_disposable);\n\t\t_terminalCwd = undefined;\n\t}\n\n\tif (_terminalCwd !== cwd) {\n\t\t_terminal.sendText(`cd \"${cwd}\"`, true);\n\t\t_terminalCwd = cwd;\n\t}\n\n\treturn _terminal;\n}\n\nexport function runGitCommandInTerminal(command: string, args: string, cwd: string, execute: boolean = false) {\n\t// let git = Git.getGitPath();\n\t// if (git.includes(' ')) {\n\t//     git = `\"${git}\"`;\n\t// }\n\n\tconst terminal = ensureTerminal(cwd);\n\tterminal.show(false);\n\tterminal.sendText(`git ${command} ${args}`, execute);\n}\n","'use strict';\nimport { Disposable, Event, EventEmitter, TextDocument, TextEditor } from 'vscode';\nimport { ContextKeys, getEditorIfActive, isActiveDocument, setContext } from '../constants';\nimport { Container } from '../container';\nimport {\n\tGitRevision,\n\tRepository,\n\tRepositoryChange,\n\tRepositoryChangeComparisonMode,\n\tRepositoryChangeEvent,\n} from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { Functions } from '../system';\n\nexport interface DocumentBlameStateChangeEvent<T> {\n\treadonly editor: TextEditor;\n\treadonly document: TrackedDocument<T>;\n\treadonly blameable: boolean;\n}\n\nexport class TrackedDocument<T> implements Disposable {\n\tstatic async create<T>(\n\t\tdocument: TextDocument,\n\t\tkey: string,\n\t\tdirty: boolean,\n\t\teventDelegates: { onDidBlameStateChange(e: DocumentBlameStateChangeEvent<T>): void },\n\t) {\n\t\tconst doc = new TrackedDocument(document, key, dirty, eventDelegates);\n\t\tawait doc.initialize();\n\t\treturn doc;\n\t}\n\n\tprivate _onDidBlameStateChange = new EventEmitter<DocumentBlameStateChangeEvent<T>>();\n\tget onDidBlameStateChange(): Event<DocumentBlameStateChangeEvent<T>> {\n\t\treturn this._onDidBlameStateChange.event;\n\t}\n\n\tstate: T | undefined;\n\n\tprivate _disposable: Disposable | undefined;\n\tprivate _disposed: boolean = false;\n\tprivate _repo: Repository | undefined;\n\tprivate _uri!: GitUri;\n\n\tprivate constructor(\n\t\tprivate readonly _document: TextDocument,\n\t\tpublic readonly key: string,\n\t\tpublic dirty: boolean,\n\t\tprivate _eventDelegates: { onDidBlameStateChange(e: DocumentBlameStateChangeEvent<T>): void },\n\t) {}\n\n\tdispose() {\n\t\tthis._disposed = true;\n\t\tthis.reset('dispose');\n\t\tthis._disposable?.dispose();\n\t}\n\n\tprivate initializing = true;\n\tprivate async initialize(): Promise<Repository | undefined> {\n\t\tconst uri = this._document.uri;\n\n\t\t// Since there is a bit of a chicken & egg problem with the DocumentTracker and the GitService, wait for the GitService to load if it isn't\n\t\tif (Container.git == null) {\n\t\t\tif (!(await Functions.waitUntil(() => Container.git != null, 2000))) {\n\t\t\t\tLogger.log(\n\t\t\t\t\t`TrackedDocument.initialize(${uri.toString(true)})`,\n\t\t\t\t\t'Timed out waiting for the GitService to start',\n\t\t\t\t);\n\t\t\t\tthrow new Error('TrackedDocument timed out waiting for the GitService to start');\n\t\t\t}\n\t\t}\n\n\t\tthis._uri = await GitUri.fromUri(uri);\n\t\tif (this._disposed) return undefined;\n\n\t\tconst repo = await Container.git.getRepository(this._uri);\n\t\tthis._repo = repo;\n\t\tif (this._disposed) return undefined;\n\n\t\tif (repo != null) {\n\t\t\tthis._disposable = repo.onDidChange(this.onRepositoryChanged, this);\n\t\t}\n\n\t\tawait this.update();\n\n\t\tthis.initializing = false;\n\n\t\treturn repo;\n\t}\n\n\tprivate onRepositoryChanged(e: RepositoryChangeEvent) {\n\t\tif (\n\t\t\t!e.changed(\n\t\t\t\tRepositoryChange.Index,\n\t\t\t\tRepositoryChange.Heads,\n\t\t\t\tRepositoryChange.Status,\n\t\t\t\tRepositoryChange.Unknown,\n\t\t\t\tRepositoryChangeComparisonMode.Any,\n\t\t\t)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Reset any cached state\n\t\tthis.reset('repository');\n\t\tvoid this.update();\n\t}\n\n\tprivate _forceDirtyStateChangeOnNextDocumentChange: boolean = false;\n\tget forceDirtyStateChangeOnNextDocumentChange() {\n\t\treturn this._forceDirtyStateChangeOnNextDocumentChange;\n\t}\n\n\tprivate _hasRemotes: boolean = false;\n\tget hasRemotes() {\n\t\treturn this._hasRemotes;\n\t}\n\n\tget isBlameable() {\n\t\tif (this._blameFailed) return false;\n\n\t\treturn this._isTracked;\n\t}\n\n\tprivate _isDirtyIdle: boolean = false;\n\tget isDirtyIdle() {\n\t\treturn this._isDirtyIdle;\n\t}\n\tset isDirtyIdle(value: boolean) {\n\t\tthis._isDirtyIdle = value;\n\t}\n\n\tget isRevision() {\n\t\treturn this._uri != null ? Boolean(this._uri.sha) && this._uri.sha !== GitRevision.deletedOrMissing : false;\n\t}\n\n\tprivate _isTracked: boolean = false;\n\tget isTracked() {\n\t\treturn this._isTracked;\n\t}\n\n\tget lineCount(): number {\n\t\treturn this._document.lineCount;\n\t}\n\n\tget uri() {\n\t\treturn this._uri;\n\t}\n\n\tactivate() {\n\t\tvoid setContext(ContextKeys.ActiveFileStatus, this.getStatus());\n\t}\n\n\tis(document: TextDocument) {\n\t\treturn document === this._document;\n\t}\n\n\treset(reason: 'config' | 'dispose' | 'document' | 'repository') {\n\t\tthis._blameFailed = false;\n\t\tthis._isDirtyIdle = false;\n\n\t\tif (this.state == null) return;\n\n\t\t// // Don't remove broken blame on change (since otherwise we'll have to run the broken blame again)\n\t\t// if (!this.state.hasErrors) {\n\n\t\tthis.state = undefined;\n\t\tLogger.log(`Reset state for '${this.key}', reason=${reason}`);\n\n\t\t// }\n\t}\n\n\tprivate _blameFailed: boolean = false;\n\tsetBlameFailure() {\n\t\tconst wasBlameable = this.isBlameable;\n\n\t\tthis._blameFailed = true;\n\n\t\tif (wasBlameable && isActiveDocument(this._document)) {\n\t\t\tvoid this.update({ forceBlameChange: true });\n\t\t}\n\t}\n\n\tresetForceDirtyStateChangeOnNextDocumentChange() {\n\t\tthis._forceDirtyStateChangeOnNextDocumentChange = false;\n\t}\n\n\tsetForceDirtyStateChangeOnNextDocumentChange() {\n\t\tthis._forceDirtyStateChangeOnNextDocumentChange = true;\n\t}\n\n\tasync update({ forceBlameChange }: { forceBlameChange?: boolean } = {}) {\n\t\tif (this._disposed || this._uri == null) {\n\t\t\tthis._hasRemotes = false;\n\t\t\tthis._isTracked = false;\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isDirtyIdle = false;\n\n\t\tconst active = getEditorIfActive(this._document);\n\t\tconst wasBlameable = forceBlameChange ? undefined : this.isBlameable;\n\n\t\tthis._isTracked = await Container.git.isTracked(this._uri);\n\n\t\tlet repo = undefined;\n\t\tif (this._isTracked) {\n\t\t\trepo = this._repo;\n\t\t}\n\n\t\tif (repo != null) {\n\t\t\tthis._hasRemotes = await repo.hasRemotes();\n\t\t} else {\n\t\t\tthis._hasRemotes = false;\n\t\t}\n\n\t\tif (active != null) {\n\t\t\tconst blameable = this.isBlameable;\n\n\t\t\tvoid setContext(ContextKeys.ActiveFileStatus, this.getStatus());\n\n\t\t\tif (!this.initializing && wasBlameable !== blameable) {\n\t\t\t\tconst e: DocumentBlameStateChangeEvent<T> = { editor: active, document: this, blameable: blameable };\n\t\t\t\tthis._onDidBlameStateChange.fire(e);\n\t\t\t\tthis._eventDelegates.onDidBlameStateChange(e);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate getStatus() {\n\t\tlet status = '';\n\t\tif (this.isTracked) {\n\t\t\tstatus += 'tracked|';\n\t\t}\n\t\tif (this.isBlameable) {\n\t\t\tstatus += 'blameable|';\n\t\t}\n\t\tif (this.isRevision) {\n\t\t\tstatus += 'revision|';\n\t\t}\n\t\tif (this.hasRemotes) {\n\t\t\tstatus += 'remotes|';\n\t\t}\n\n\t\treturn status ? status : undefined;\n\t}\n}\n","'use strict';\nimport {\n\tConfigurationChangeEvent,\n\tDisposable,\n\tEndOfLine,\n\tEvent,\n\tEventEmitter,\n\tPosition,\n\tRange,\n\tTextDocument,\n\tTextDocumentChangeEvent,\n\tTextDocumentContentChangeEvent,\n\tTextEditor,\n\tTextLine,\n\tUri,\n\twindow,\n\tworkspace,\n} from 'vscode';\nimport { configuration } from '../configuration';\nimport { ContextKeys, DocumentSchemes, isActiveDocument, isTextEditor, setContext } from '../constants';\nimport { GitUri } from '../git/gitUri';\nimport { Functions } from '../system';\nimport { DocumentBlameStateChangeEvent, TrackedDocument } from './trackedDocument';\n\nexport * from './trackedDocument';\n\nexport interface DocumentContentChangeEvent<T> {\n\treadonly editor: TextEditor;\n\treadonly document: TrackedDocument<T>;\n\treadonly contentChanges: ReadonlyArray<TextDocumentContentChangeEvent>;\n}\n\nexport interface DocumentDirtyStateChangeEvent<T> {\n\treadonly editor: TextEditor;\n\treadonly document: TrackedDocument<T>;\n\treadonly dirty: boolean;\n}\n\nexport interface DocumentDirtyIdleTriggerEvent<T> {\n\treadonly editor: TextEditor;\n\treadonly document: TrackedDocument<T>;\n}\n\nexport class DocumentTracker<T> implements Disposable {\n\tprivate _onDidChangeBlameState = new EventEmitter<DocumentBlameStateChangeEvent<T>>();\n\tget onDidChangeBlameState(): Event<DocumentBlameStateChangeEvent<T>> {\n\t\treturn this._onDidChangeBlameState.event;\n\t}\n\n\tprivate _onDidChangeContent = new EventEmitter<DocumentContentChangeEvent<T>>();\n\tget onDidChangeContent(): Event<DocumentContentChangeEvent<T>> {\n\t\treturn this._onDidChangeContent.event;\n\t}\n\n\tprivate _onDidChangeDirtyState = new EventEmitter<DocumentDirtyStateChangeEvent<T>>();\n\tget onDidChangeDirtyState(): Event<DocumentDirtyStateChangeEvent<T>> {\n\t\treturn this._onDidChangeDirtyState.event;\n\t}\n\n\tprivate _onDidTriggerDirtyIdle = new EventEmitter<DocumentDirtyIdleTriggerEvent<T>>();\n\tget onDidTriggerDirtyIdle(): Event<DocumentDirtyIdleTriggerEvent<T>> {\n\t\treturn this._onDidTriggerDirtyIdle.event;\n\t}\n\n\tprivate _dirtyIdleTriggerDelay!: number;\n\tprivate readonly _disposable: Disposable | undefined;\n\tprivate readonly _documentMap = new Map<TextDocument | string, Promise<TrackedDocument<T>>>();\n\n\tconstructor() {\n\t\tthis._disposable = Disposable.from(\n\t\t\tconfiguration.onDidChange(this.onConfigurationChanged, this),\n\t\t\twindow.onDidChangeActiveTextEditor(this.onActiveTextEditorChanged, this),\n\t\t\t// window.onDidChangeVisibleTextEditors(Functions.debounce(this.onVisibleEditorsChanged, 5000), this),\n\t\t\tworkspace.onDidChangeTextDocument(Functions.debounce(this.onTextDocumentChanged, 50), this),\n\t\t\tworkspace.onDidCloseTextDocument(this.onTextDocumentClosed, this),\n\t\t\tworkspace.onDidSaveTextDocument(this.onTextDocumentSaved, this),\n\t\t);\n\n\t\tvoid this.onConfigurationChanged();\n\t}\n\n\tdispose() {\n\t\tthis._disposable?.dispose();\n\n\t\tvoid this.clear();\n\t}\n\n\tinitialize() {\n\t\tvoid this.onActiveTextEditorChanged(window.activeTextEditor);\n\t}\n\n\tprivate async onConfigurationChanged(e?: ConfigurationChangeEvent) {\n\t\t// Only rest the cached state if we aren't initializing\n\t\tif (\n\t\t\te != null &&\n\t\t\t(configuration.changed(e, 'blame.ignoreWhitespace') || configuration.changed(e, 'advanced.caching.enabled'))\n\t\t) {\n\t\t\tfor (const d of this._documentMap.values()) {\n\t\t\t\t(await d).reset('config');\n\t\t\t}\n\t\t}\n\n\t\tif (configuration.changed(e, 'advanced.blame.delayAfterEdit')) {\n\t\t\tthis._dirtyIdleTriggerDelay = configuration.get('advanced.blame.delayAfterEdit');\n\t\t\tthis._dirtyIdleTriggeredDebounced = undefined;\n\t\t}\n\t}\n\n\tprivate _timer: NodeJS.Timer | undefined;\n\tprivate async onActiveTextEditorChanged(editor: TextEditor | undefined) {\n\t\tif (editor != null && !isTextEditor(editor)) return;\n\n\t\tif (this._timer != null) {\n\t\t\tclearTimeout(this._timer);\n\t\t\tthis._timer = undefined;\n\t\t}\n\n\t\tif (editor == null) {\n\t\t\tthis._timer = setTimeout(() => {\n\t\t\t\tthis._timer = undefined;\n\n\t\t\t\tvoid setContext(ContextKeys.ActiveFileStatus, undefined);\n\t\t\t}, 250);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst doc = this._documentMap.get(editor.document);\n\t\tif (doc != null) {\n\t\t\t(await doc).activate();\n\n\t\t\treturn;\n\t\t}\n\n\t\t// No need to activate this, as it is implicit in initialization if currently active\n\t\tvoid this.addCore(editor.document);\n\t}\n\n\tprivate async onTextDocumentChanged(e: TextDocumentChangeEvent) {\n\t\tconst { scheme } = e.document.uri;\n\t\tif (scheme !== DocumentSchemes.File && scheme !== DocumentSchemes.Git && scheme !== DocumentSchemes.Vsls) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst doc = await (this._documentMap.get(e.document) ?? this.addCore(e.document));\n\t\tdoc.reset('document');\n\n\t\tconst dirty = e.document.isDirty;\n\t\tconst editor = window.activeTextEditor;\n\n\t\t// If we have an idle tracker, either reset or cancel it\n\t\tif (this._dirtyIdleTriggeredDebounced != null) {\n\t\t\tif (dirty) {\n\t\t\t\tthis._dirtyIdleTriggeredDebounced({ editor: editor!, document: doc });\n\t\t\t} else {\n\t\t\t\tthis._dirtyIdleTriggeredDebounced.cancel();\n\t\t\t}\n\t\t}\n\n\t\t// Only fire change events for the active document\n\t\tif (editor?.document === e.document) {\n\t\t\tthis._onDidChangeContent.fire({ editor: editor, document: doc, contentChanges: e.contentChanges });\n\t\t}\n\n\t\tif (!doc.forceDirtyStateChangeOnNextDocumentChange && doc.dirty === dirty) return;\n\n\t\tdoc.resetForceDirtyStateChangeOnNextDocumentChange();\n\t\tdoc.dirty = dirty;\n\n\t\t// Only fire state change events for the active document\n\t\tif (editor == null || editor.document !== e.document) return;\n\n\t\tthis.fireDocumentDirtyStateChanged({ editor: editor, document: doc, dirty: doc.dirty });\n\t}\n\n\tprivate async onTextDocumentClosed(document: TextDocument) {\n\t\tconst doc = this._documentMap.get(document);\n\t\tif (doc == null) return;\n\n\t\tthis._documentMap.delete(document);\n\t\tthis._documentMap.delete(GitUri.toKey(document.uri));\n\n\t\t(await doc).dispose();\n\t}\n\n\tprivate async onTextDocumentSaved(document: TextDocument) {\n\t\tconst doc = this._documentMap.get(document);\n\t\tif (doc != null) {\n\t\t\tvoid (await doc).update({ forceBlameChange: true });\n\n\t\t\treturn;\n\t\t}\n\n\t\t// If we are saving the active document make sure we are tracking it\n\t\tif (isActiveDocument(document)) {\n\t\t\tvoid this.addCore(document);\n\t\t}\n\t}\n\n\t// private onVisibleEditorsChanged(editors: TextEditor[]) {\n\t//     if (this._documentMap.size === 0) return;\n\n\t//     // If we have no visible editors, or no \"real\" visible editors reset our cache\n\t//     if (editors.length === 0 || editors.every(e => !isTextEditor(e))) {\n\t//         this.clear();\n\t//     }\n\t// }\n\n\tadd(document: TextDocument): Promise<TrackedDocument<T>>;\n\tadd(uri: Uri): Promise<TrackedDocument<T>>;\n\tadd(documentOrId: TextDocument | Uri): Promise<TrackedDocument<T>> {\n\t\tconst doc = this._add(documentOrId);\n\t\treturn doc;\n\t}\n\n\tasync clear() {\n\t\tfor (const d of this._documentMap.values()) {\n\t\t\t(await d).dispose();\n\t\t}\n\n\t\tthis._documentMap.clear();\n\t}\n\n\tget(fileName: string): Promise<TrackedDocument<T>> | undefined;\n\tget(document: TextDocument): Promise<TrackedDocument<T>> | undefined;\n\tget(uri: Uri): Promise<TrackedDocument<T>> | undefined;\n\tget(documentOrId: string | TextDocument | Uri): Promise<TrackedDocument<T>> | undefined {\n\t\tconst doc = this._get(documentOrId);\n\t\treturn doc;\n\t}\n\n\tasync getOrAdd(document: TextDocument): Promise<TrackedDocument<T>>;\n\tasync getOrAdd(uri: Uri): Promise<TrackedDocument<T>>;\n\tasync getOrAdd(documentOrId: TextDocument | Uri): Promise<TrackedDocument<T>> {\n\t\tconst doc = this._get(documentOrId) ?? this._add(documentOrId);\n\t\treturn doc;\n\t}\n\n\thas(fileName: string): boolean;\n\thas(document: TextDocument): boolean;\n\thas(uri: Uri): boolean;\n\thas(key: string | TextDocument | Uri): boolean {\n\t\tif (typeof key === 'string' || key instanceof Uri) {\n\t\t\tkey = GitUri.toKey(key);\n\t\t}\n\t\treturn this._documentMap.has(key);\n\t}\n\n\tprivate async _add(documentOrId: TextDocument | Uri): Promise<TrackedDocument<T>> {\n\t\tlet document;\n\t\tif (GitUri.is(documentOrId)) {\n\t\t\ttry {\n\t\t\t\tdocument = await workspace.openTextDocument(documentOrId.documentUri({ useVersionedPath: true }));\n\t\t\t} catch (ex) {\n\t\t\t\tconst msg: string = ex?.toString() ?? '';\n\t\t\t\tif (msg.includes('File seems to be binary and cannot be opened as text')) {\n\t\t\t\t\tdocument = new BinaryTextDocument(documentOrId);\n\t\t\t\t} else if (\n\t\t\t\t\tmsg.includes('File not found') ||\n\t\t\t\t\tmsg.includes('Unable to read file') ||\n\t\t\t\t\tmsg.includes('Unable to resolve non-existing file')\n\t\t\t\t) {\n\t\t\t\t\t// If we can't find the file, assume it is because the file has been renamed or deleted at some point\n\t\t\t\t\tdocument = new MissingRevisionTextDocument(documentOrId);\n\n\t\t\t\t\t// const [fileName, repoPath] = await Container.git.findWorkingFileName(documentOrId, undefined, ref);\n\t\t\t\t\t// if (fileName == null) throw new Error(`Failed to add tracking for document: ${documentOrId}`);\n\n\t\t\t\t\t// documentOrId = await workspace.openTextDocument(path.resolve(repoPath!, fileName));\n\t\t\t\t} else {\n\t\t\t\t\tthrow ex;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (documentOrId instanceof Uri) {\n\t\t\tdocument = await workspace.openTextDocument(documentOrId);\n\t\t} else {\n\t\t\tdocument = documentOrId;\n\t\t}\n\n\t\tconst doc = this.addCore(document);\n\t\treturn doc;\n\t}\n\n\tprivate _get(documentOrId: string | TextDocument | Uri) {\n\t\tif (GitUri.is(documentOrId)) {\n\t\t\tdocumentOrId = GitUri.toKey(documentOrId.documentUri({ useVersionedPath: true }));\n\t\t} else if (typeof documentOrId === 'string' || documentOrId instanceof Uri) {\n\t\t\tdocumentOrId = GitUri.toKey(documentOrId);\n\t\t}\n\n\t\tconst doc = this._documentMap.get(documentOrId);\n\t\treturn doc;\n\t}\n\n\tprivate async addCore(document: TextDocument): Promise<TrackedDocument<T>> {\n\t\tconst key = GitUri.toKey(document.uri);\n\n\t\t// Always start out false, so we will fire the event if needed\n\t\tconst doc = TrackedDocument.create<T>(document, key, false, {\n\t\t\tonDidBlameStateChange: (e: DocumentBlameStateChangeEvent<T>) => this._onDidChangeBlameState.fire(e),\n\t\t});\n\n\t\tthis._documentMap.set(document, doc);\n\t\tthis._documentMap.set(key, doc);\n\n\t\treturn doc;\n\t}\n\n\tprivate _dirtyIdleTriggeredDebounced:\n\t\t| Functions.Deferrable<(e: DocumentDirtyIdleTriggerEvent<T>) => void>\n\t\t| undefined;\n\tprivate _dirtyStateChangedDebounced:\n\t\t| Functions.Deferrable<(e: DocumentDirtyStateChangeEvent<T>) => void>\n\t\t| undefined;\n\tprivate fireDocumentDirtyStateChanged(e: DocumentDirtyStateChangeEvent<T>) {\n\t\tif (e.dirty) {\n\t\t\tsetImmediate(() => {\n\t\t\t\tthis._dirtyStateChangedDebounced?.cancel();\n\t\t\t\tif (window.activeTextEditor !== e.editor) return;\n\n\t\t\t\tthis._onDidChangeDirtyState.fire(e);\n\t\t\t});\n\n\t\t\tif (this._dirtyIdleTriggerDelay > 0) {\n\t\t\t\tif (this._dirtyIdleTriggeredDebounced == null) {\n\t\t\t\t\tthis._dirtyIdleTriggeredDebounced = Functions.debounce(\n\t\t\t\t\t\t(e: DocumentDirtyIdleTriggerEvent<T>) => {\n\t\t\t\t\t\t\tif (this._dirtyIdleTriggeredDebounced?.pending!()) return;\n\n\t\t\t\t\t\t\te.document.isDirtyIdle = true;\n\t\t\t\t\t\t\tthis._onDidTriggerDirtyIdle.fire(e);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tthis._dirtyIdleTriggerDelay,\n\t\t\t\t\t\t{ track: true },\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tthis._dirtyIdleTriggeredDebounced({ editor: e.editor, document: e.document });\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._dirtyStateChangedDebounced == null) {\n\t\t\tthis._dirtyStateChangedDebounced = Functions.debounce((e: DocumentDirtyStateChangeEvent<T>) => {\n\t\t\t\tif (window.activeTextEditor !== e.editor) return;\n\n\t\t\t\tthis._onDidChangeDirtyState.fire(e);\n\t\t\t}, 250);\n\t\t}\n\n\t\tthis._dirtyStateChangedDebounced(e);\n\t}\n}\n\nclass EmptyTextDocument implements TextDocument {\n\treadonly eol: EndOfLine;\n\treadonly fileName: string;\n\treadonly isClosed: boolean;\n\treadonly isDirty: boolean;\n\treadonly isUntitled: boolean;\n\treadonly languageId: string;\n\treadonly lineCount: number;\n\treadonly uri: Uri;\n\treadonly version: number;\n\n\tconstructor(public readonly gitUri: GitUri) {\n\t\tthis.uri = gitUri.documentUri({ useVersionedPath: true });\n\n\t\tthis.eol = EndOfLine.LF;\n\t\tthis.fileName = this.uri.fsPath;\n\t\tthis.isClosed = false;\n\t\tthis.isDirty = false;\n\t\tthis.isUntitled = false;\n\t\tthis.languageId = '';\n\t\tthis.lineCount = 0;\n\t\tthis.version = 0;\n\t}\n\n\tgetText(_range?: Range | undefined): string {\n\t\tthrow new Error('Method not supported.');\n\t}\n\n\tgetWordRangeAtPosition(_position: Position, _regex?: RegExp | undefined): Range | undefined {\n\t\tthrow new Error('Method not supported.');\n\t}\n\n\tlineAt(line: number): TextLine;\n\tlineAt(position: Position): TextLine;\n\tlineAt(_position: any): TextLine {\n\t\tthrow new Error('Method not supported.');\n\t}\n\n\toffsetAt(_position: Position): number {\n\t\tthrow new Error('Method not supported.');\n\t}\n\n\tpositionAt(_offset: number): Position {\n\t\tthrow new Error('Method not supported.');\n\t}\n\n\tsave(): Thenable<boolean> {\n\t\tthrow new Error('Method not supported.');\n\t}\n\n\tvalidatePosition(_position: Position): Position {\n\t\tthrow new Error('Method not supported.');\n\t}\n\n\tvalidateRange(_range: Range): Range {\n\t\tthrow new Error('Method not supported.');\n\t}\n}\n\nclass BinaryTextDocument extends EmptyTextDocument {}\nclass MissingRevisionTextDocument extends EmptyTextDocument {}\n","'use strict';\nimport { GitBlame, GitDiff, GitLog } from '../git/git';\nimport { DocumentTracker } from './documentTracker';\n\nexport * from './documentTracker';\n\ninterface CachedItem<T> {\n\titem: Promise<T>;\n\terrorMessage?: string;\n}\n\nexport type CachedBlame = CachedItem<GitBlame>;\nexport type CachedDiff = CachedItem<GitDiff>;\nexport type CachedLog = CachedItem<GitLog>;\n\nexport class GitDocumentState {\n\tprivate cache = new Map<string, CachedBlame | CachedDiff | CachedLog>();\n\n\tconstructor(public readonly key: string) {}\n\n\tget<T extends CachedBlame | CachedDiff | CachedLog>(key: string): T | undefined {\n\t\treturn this.cache.get(key) as T;\n\t}\n\n\tset<T extends CachedBlame | CachedDiff | CachedLog>(key: string, value: T) {\n\t\tthis.cache.set(key, value);\n\t}\n}\n\nexport class GitDocumentTracker extends DocumentTracker<GitDocumentState> {}\n","'use strict';\nimport { commands, ConfigurationChangeEvent } from 'vscode';\nimport { configuration, FileHistoryViewConfig } from '../configuration';\nimport { ContextKeys, setContext } from '../constants';\nimport { Container } from '../container';\nimport { GitUri } from '../git/gitUri';\nimport { FileHistoryTrackerNode, LineHistoryTrackerNode } from './nodes';\nimport { ViewBase } from './viewBase';\n\nconst pinnedSuffix = ' (pinned)';\n\nexport class FileHistoryView extends ViewBase<FileHistoryTrackerNode | LineHistoryTrackerNode, FileHistoryViewConfig> {\n\tprotected readonly configKey = 'fileHistory';\n\n\tprivate _followCursor: boolean = false;\n\tprivate _followEditor: boolean = true;\n\n\tconstructor() {\n\t\tsuper('gitlens.views.fileHistory', 'File History');\n\n\t\tvoid setContext(ContextKeys.ViewsFileHistoryCursorFollowing, this._followCursor);\n\t\tvoid setContext(ContextKeys.ViewsFileHistoryEditorFollowing, this._followEditor);\n\t}\n\n\tprotected override get showCollapseAll(): boolean {\n\t\treturn false;\n\t}\n\n\tgetRoot(): LineHistoryTrackerNode | FileHistoryTrackerNode {\n\t\treturn this._followCursor ? new LineHistoryTrackerNode(this) : new FileHistoryTrackerNode(this);\n\t}\n\n\tprotected registerCommands() {\n\t\tvoid Container.viewCommands;\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('copy'),\n\t\t\t() => commands.executeCommand('gitlens.views.copy', this.selection),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('refresh'), () => this.refresh(true), this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('changeBase'), () => this.changeBase(), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setCursorFollowingOn'),\n\t\t\t() => this.setCursorFollowing(true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setCursorFollowingOff'),\n\t\t\t() => this.setCursorFollowing(false),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setEditorFollowingOn'),\n\t\t\t() => this.setEditorFollowing(true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setEditorFollowingOff'),\n\t\t\t() => this.setEditorFollowing(false),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setRenameFollowingOn'),\n\t\t\t() => this.setRenameFollowing(true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setRenameFollowingOff'),\n\t\t\t() => this.setRenameFollowing(false),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowAllBranchesOn'),\n\t\t\t() => this.setShowAllBranches(true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowAllBranchesOff'),\n\t\t\t() => this.setShowAllBranches(false),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOn'), () => this.setShowAvatars(true), this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOff'), () => this.setShowAvatars(false), this);\n\t}\n\n\tprotected override filterConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tconst changed = super.filterConfigurationChanged(e);\n\t\tif (\n\t\t\t!changed &&\n\t\t\t!configuration.changed(e, 'defaultDateFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateShortFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateSource') &&\n\t\t\t!configuration.changed(e, 'defaultDateStyle') &&\n\t\t\t!configuration.changed(e, 'defaultGravatarsStyle') &&\n\t\t\t!configuration.changed(e, 'defaultTimeFormat') &&\n\t\t\t!configuration.changed(e, 'advanced.fileHistoryFollowsRenames') &&\n\t\t\t!configuration.changed(e, 'advanced.fileHistoryShowAllBranches')\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tasync showHistoryForUri(uri: GitUri) {\n\t\tthis.setCursorFollowing(false);\n\n\t\tconst root = this.ensureRoot(true);\n\n\t\tif (root instanceof FileHistoryTrackerNode) {\n\t\t\tawait root.showHistoryForUri(uri);\n\n\t\t\tthis.setEditorFollowing(false);\n\t\t}\n\n\t\treturn this.show();\n\t}\n\n\tprivate changeBase() {\n\t\tvoid this.root?.changeBase();\n\t}\n\n\tprivate setCursorFollowing(enabled: boolean) {\n\t\tconst uri = !this._followEditor && this.root?.hasUri ? this.root.uri : undefined;\n\n\t\tthis._followCursor = enabled;\n\t\tvoid setContext(ContextKeys.ViewsFileHistoryCursorFollowing, enabled);\n\n\t\tthis.title = this._followCursor ? 'Line History' : 'File History';\n\n\t\tconst root = this.ensureRoot(true);\n\t\tif (uri != null) {\n\t\t\troot.setUri(uri);\n\t\t}\n\t\troot.setEditorFollowing(this._followEditor);\n\t\tvoid root.ensureSubscription();\n\t\tvoid this.refresh(true);\n\t}\n\n\tprivate setEditorFollowing(enabled: boolean) {\n\t\tconst root = this.ensureRoot();\n\t\tif (!root.hasUri) return;\n\n\t\tthis._followEditor = enabled;\n\t\tvoid setContext(ContextKeys.ViewsFileHistoryEditorFollowing, enabled);\n\n\t\troot.setEditorFollowing(enabled);\n\n\t\tif (this.description?.endsWith(pinnedSuffix)) {\n\t\t\tif (enabled) {\n\t\t\t\tthis.description = this.description.substr(0, this.description.length - pinnedSuffix.length);\n\t\t\t}\n\t\t} else if (!enabled && this.description != null) {\n\t\t\tthis.description += pinnedSuffix;\n\t\t}\n\n\t\tif (enabled) {\n\t\t\tvoid root.ensureSubscription();\n\t\t\tvoid this.refresh(true);\n\t\t}\n\t}\n\n\tprivate setRenameFollowing(enabled: boolean) {\n\t\treturn configuration.updateEffective('advanced.fileHistoryFollowsRenames', enabled);\n\t}\n\n\tprivate setShowAllBranches(enabled: boolean) {\n\t\treturn configuration.updateEffective('advanced.fileHistoryShowAllBranches', enabled);\n\t}\n\n\tprivate setShowAvatars(enabled: boolean) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.avatars` as const, enabled);\n\t}\n}\n","import { Command, ThemeIcon, TreeItem, TreeItemCollapsibleState, Uri } from 'vscode';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { View } from '../viewBase';\nimport { ContextValues, PageableViewNode, unknownGitUri, ViewNode } from './viewNode';\n\nexport class MessageNode extends ViewNode {\n\tconstructor(\n\t\tview: View,\n\t\tparent: ViewNode,\n\t\tprivate readonly _message: string,\n\t\tprivate readonly _description?: string,\n\t\tprivate readonly _tooltip?: string,\n\t\tprivate readonly _iconPath?:\n\t\t\t| string\n\t\t\t| Uri\n\t\t\t| {\n\t\t\t\t\tlight: string | Uri;\n\t\t\t\t\tdark: string | Uri;\n\t\t\t  }\n\t\t\t| ThemeIcon,\n\t\tprivate readonly _contextValue?: string,\n\t) {\n\t\tsuper(unknownGitUri, view, parent);\n\t}\n\n\tgetChildren(): ViewNode[] | Promise<ViewNode[]> {\n\t\treturn [];\n\t}\n\n\tgetTreeItem(): TreeItem | Promise<TreeItem> {\n\t\tconst item = new TreeItem(this._message, TreeItemCollapsibleState.None);\n\t\titem.contextValue = this._contextValue ?? ContextValues.Message;\n\t\titem.description = this._description;\n\t\titem.tooltip = this._tooltip;\n\t\titem.iconPath = this._iconPath;\n\t\treturn item;\n\t}\n}\n\nexport class CommandMessageNode extends MessageNode {\n\tconstructor(\n\t\tview: View,\n\t\tparent: ViewNode,\n\t\tprivate readonly _command: Command,\n\t\tmessage: string,\n\t\tdescription?: string,\n\t\ttooltip?: string,\n\t\ticonPath?:\n\t\t\t| string\n\t\t\t| Uri\n\t\t\t| {\n\t\t\t\t\tlight: string | Uri;\n\t\t\t\t\tdark: string | Uri;\n\t\t\t  }\n\t\t\t| ThemeIcon,\n\t) {\n\t\tsuper(view, parent, message, description, tooltip, iconPath);\n\t}\n\n\toverride getTreeItem(): TreeItem | Promise<TreeItem> {\n\t\tconst item = super.getTreeItem();\n\t\tif (item instanceof TreeItem) {\n\t\t\titem.command = this._command;\n\t\t\treturn item;\n\t\t}\n\n\t\treturn item.then(i => {\n\t\t\ti.command = this._command;\n\t\t\treturn i;\n\t\t});\n\t}\n}\n\nexport class UpdateableMessageNode extends ViewNode {\n\toverride readonly id: string;\n\n\tconstructor(\n\t\tview: View,\n\t\tparent: ViewNode,\n\t\tid: string,\n\t\tprivate _message: string,\n\t\tprivate _tooltip?: string,\n\t\tprivate _iconPath?:\n\t\t\t| string\n\t\t\t| Uri\n\t\t\t| {\n\t\t\t\t\tlight: string | Uri;\n\t\t\t\t\tdark: string | Uri;\n\t\t\t  }\n\t\t\t| ThemeIcon,\n\t) {\n\t\tsuper(unknownGitUri, view, parent);\n\t\tthis.id = id;\n\t}\n\n\tgetChildren(): ViewNode[] | Promise<ViewNode[]> {\n\t\treturn [];\n\t}\n\n\tgetTreeItem(): TreeItem | Promise<TreeItem> {\n\t\tconst item = new TreeItem(this._message, TreeItemCollapsibleState.None);\n\t\titem.id = this.id;\n\t\titem.contextValue = ContextValues.Message;\n\t\titem.tooltip = this._tooltip;\n\t\titem.iconPath = this._iconPath;\n\t\treturn item;\n\t}\n\n\tupdate(\n\t\tchanges: {\n\t\t\tmessage?: string;\n\t\t\ttooltip?: string | null;\n\t\t\ticonPath?:\n\t\t\t\t| string\n\t\t\t\t| null\n\t\t\t\t| Uri\n\t\t\t\t| {\n\t\t\t\t\t\tlight: string | Uri;\n\t\t\t\t\t\tdark: string | Uri;\n\t\t\t\t  }\n\t\t\t\t| ThemeIcon;\n\t\t},\n\t\tview: View,\n\t) {\n\t\tif (changes.message !== undefined) {\n\t\t\tthis._message = changes.message;\n\t\t}\n\n\t\tif (changes.tooltip !== undefined) {\n\t\t\tthis._tooltip = changes.tooltip === null ? undefined : changes.tooltip;\n\t\t}\n\n\t\tif (changes.iconPath !== undefined) {\n\t\t\tthis._iconPath = changes.iconPath === null ? undefined : changes.iconPath;\n\t\t}\n\n\t\tview.triggerNodeChange(this);\n\t}\n}\n\nexport abstract class PagerNode extends ViewNode {\n\tconstructor(\n\t\tview: View,\n\t\tparent: ViewNode & PageableViewNode,\n\t\tprotected readonly message: string,\n\t\tprotected readonly previousNode?: ViewNode,\n\t\tprotected readonly pageSize: number = Container.config.views.pageItemLimit,\n\t\tprotected readonly countFn?: () => Promise<number | undefined>,\n\t) {\n\t\tsuper(unknownGitUri, view, parent);\n\t}\n\n\tasync loadAll() {\n\t\tconst count = (await this.countFn?.()) ?? 0;\n\t\treturn this.view.loadMoreNodeChildren(\n\t\t\tthis.parent! as ViewNode & PageableViewNode,\n\t\t\tcount > 5000 ? 5000 : 0,\n\t\t\tthis.previousNode,\n\t\t);\n\t}\n\n\tloadMore() {\n\t\treturn this.view.loadMoreNodeChildren(\n\t\t\tthis.parent! as ViewNode & PageableViewNode,\n\t\t\tthis.pageSize,\n\t\t\tthis.previousNode,\n\t\t);\n\t}\n\n\tgetChildren(): ViewNode[] | Promise<ViewNode[]> {\n\t\treturn [];\n\t}\n\n\tgetTreeItem(): TreeItem | Promise<TreeItem> {\n\t\tconst item = new TreeItem(this.message, TreeItemCollapsibleState.None);\n\t\titem.contextValue = ContextValues.Pager;\n\t\titem.command = this.getCommand();\n\t\treturn item;\n\t}\n\n\toverride getCommand(): Command | undefined {\n\t\treturn {\n\t\t\ttitle: 'Load more',\n\t\t\tcommand: 'gitlens.views.loadMoreChildren',\n\t\t\targuments: [this],\n\t\t};\n\t}\n}\n\nexport class LoadMoreNode extends PagerNode {\n\tconstructor(\n\t\tview: View,\n\t\tparent: ViewNode & PageableViewNode,\n\t\tpreviousNode: ViewNode,\n\t\tpageSize?: number,\n\t\tcountFn?: () => Promise<number | undefined>,\n\t) {\n\t\tsuper(\n\t\t\tview,\n\t\t\tparent,\n\t\t\tpageSize === 0\n\t\t\t\t? `Load all ${GlyphChars.Space}${GlyphChars.Dash}${GlyphChars.Space} this may take a while`\n\t\t\t\t: 'Load more',\n\t\t\tpreviousNode,\n\t\t\tpageSize,\n\t\t\tcountFn,\n\t\t);\n\t}\n}\n","'use strict';\nimport { ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { ViewFilesLayout, ViewsFilesConfig } from '../../configuration';\nimport { GitUri } from '../../git/gitUri';\nimport { Arrays } from '../../system';\nimport { FileHistoryView } from '../fileHistoryView';\nimport { StashesView } from '../stashesView';\nimport { ViewsWithCommits } from '../viewBase';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport interface FileNode extends ViewNode {\n\tfolderName: string;\n\tlabel?: string;\n\tpriority: number;\n\trelativePath?: string;\n\troot?: Arrays.HierarchicalItem<FileNode>;\n}\n\nexport class FolderNode extends ViewNode<ViewsWithCommits | FileHistoryView | StashesView> {\n\treadonly priority: number = 1;\n\n\tconstructor(\n\t\tview: ViewsWithCommits | FileHistoryView | StashesView,\n\t\tparent: ViewNode,\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly folderName: string,\n\t\tpublic readonly root: Arrays.HierarchicalItem<FileNode>,\n\t\tprivate readonly containsWorkingFiles?: boolean,\n\t\tpublic readonly relativePath?: string,\n\t) {\n\t\tsuper(GitUri.fromRepoPath(repoPath), view, parent);\n\t}\n\n\toverride toClipboard(): string {\n\t\treturn this.folderName;\n\t}\n\n\tgetChildren(): (FolderNode | FileNode)[] {\n\t\tif (this.root.descendants === undefined || this.root.children === undefined) return [];\n\n\t\tlet children: (FolderNode | FileNode)[];\n\n\t\tconst nesting = FolderNode.getFileNesting(\n\t\t\tthis.view.config.files,\n\t\t\tthis.root.descendants,\n\t\t\tthis.relativePath === undefined,\n\t\t);\n\t\tif (nesting === ViewFilesLayout.List) {\n\t\t\tthis.root.descendants.forEach(n => (n.relativePath = this.root.relativePath));\n\t\t\tchildren = this.root.descendants;\n\t\t} else {\n\t\t\tchildren = [];\n\t\t\tfor (const folder of this.root.children.values()) {\n\t\t\t\tif (folder.value === undefined) {\n\t\t\t\t\tchildren.push(\n\t\t\t\t\t\tnew FolderNode(\n\t\t\t\t\t\t\tthis.view,\n\t\t\t\t\t\t\tthis.folderName ? this : this.parent!,\n\t\t\t\t\t\t\tthis.repoPath,\n\t\t\t\t\t\t\tfolder.name,\n\t\t\t\t\t\t\tfolder,\n\t\t\t\t\t\t\tthis.containsWorkingFiles,\n\t\t\t\t\t\t\tfolder.relativePath,\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Make sure to set the parent\n\t\t\t\t(folder.value as any).parent = this.folderName ? this : this.parent!;\n\t\t\t\tfolder.value.relativePath = this.root.relativePath;\n\t\t\t\tchildren.push(folder.value);\n\t\t\t}\n\t\t}\n\n\t\tchildren.sort((a, b) => {\n\t\t\treturn (\n\t\t\t\t(a instanceof FolderNode ? -1 : 1) - (b instanceof FolderNode ? -1 : 1) ||\n\t\t\t\ta.priority - b.priority ||\n\t\t\t\ta.label!.localeCompare(b.label!, undefined, { numeric: true, sensitivity: 'base' })\n\t\t\t);\n\t\t});\n\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(this.label, TreeItemCollapsibleState.Expanded);\n\t\titem.contextValue = ContextValues.Folder;\n\t\tif (this.containsWorkingFiles) {\n\t\t\titem.contextValue += '+working';\n\t\t}\n\t\titem.iconPath = ThemeIcon.Folder;\n\t\titem.tooltip = this.label;\n\t\treturn item;\n\t}\n\n\tget label(): string {\n\t\treturn this.folderName;\n\t}\n\n\tstatic getFileNesting<T extends FileNode>(\n\t\tconfig: ViewsFilesConfig,\n\t\tchildren: T[],\n\t\tisRoot: boolean,\n\t): ViewFilesLayout {\n\t\tconst nesting = config.layout || ViewFilesLayout.Auto;\n\t\tif (nesting === ViewFilesLayout.Auto) {\n\t\t\tif (isRoot || config.compact) {\n\t\t\t\tconst nestingThreshold = config.threshold || 5;\n\t\t\t\tif (children.length <= nestingThreshold) return ViewFilesLayout.List;\n\t\t\t}\n\t\t\treturn ViewFilesLayout.Tree;\n\t\t}\n\t\treturn nesting;\n\t}\n}\n","'use strict';\nimport { Command, MarkdownString, ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Commands, DiffWithCommandArgs } from '../../commands';\nimport { BuiltInCommands, GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { CommitFormatter, GitFile, GitMergeStatus, GitRebaseStatus, GitReference } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { FileHistoryView } from '../fileHistoryView';\nimport { LineHistoryView } from '../lineHistoryView';\nimport { ViewsWithCommits } from '../viewBase';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport class MergeConflictCurrentChangesNode extends ViewNode<ViewsWithCommits | FileHistoryView | LineHistoryView> {\n\tconstructor(\n\t\tview: ViewsWithCommits | FileHistoryView | LineHistoryView,\n\t\tparent: ViewNode,\n\t\tprivate readonly status: GitMergeStatus | GitRebaseStatus,\n\t\tprivate readonly file: GitFile,\n\t) {\n\t\tsuper(GitUri.fromFile(file, status.repoPath, 'HEAD'), view, parent);\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\treturn [];\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tconst commit = await Container.git.getCommit(this.status.repoPath, 'HEAD');\n\n\t\tconst item = new TreeItem('Current changes', TreeItemCollapsibleState.None);\n\t\titem.contextValue = ContextValues.MergeConflictCurrentChanges;\n\t\titem.description = `${GitReference.toString(this.status.current, { expand: false, icon: false })}${\n\t\t\tcommit != null ? ` (${GitReference.toString(commit, { expand: false, icon: false })})` : ' (HEAD)'\n\t\t}`;\n\t\titem.iconPath = this.view.config.avatars\n\t\t\t? (await commit?.getAvatarUri({ defaultStyle: Container.config.defaultGravatarsStyle })) ??\n\t\t\t  new ThemeIcon('diff')\n\t\t\t: new ThemeIcon('diff');\n\t\titem.tooltip = new MarkdownString(\n\t\t\t`Current changes to $(file)${GlyphChars.Space}${this.file.fileName} on ${GitReference.toString(\n\t\t\t\tthis.status.current,\n\t\t\t)}${\n\t\t\t\tcommit != null\n\t\t\t\t\t? `\\n\\n${await CommitFormatter.fromTemplateAsync(\n\t\t\t\t\t\t\t`$(git-commit)&nbsp;\\${id} ${GlyphChars.Dash} \\${avatar}&nbsp;__\\${author}__, \\${ago}\\${' via 'pullRequest} &nbsp; _(\\${date})_ \\n\\n\\${message}`,\n\t\t\t\t\t\t\tcommit,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tavatarSize: 16,\n\t\t\t\t\t\t\t\tdateFormat: Container.config.defaultDateFormat,\n\t\t\t\t\t\t\t\tmarkdown: true,\n\t\t\t\t\t\t\t\t// messageAutolinks: true,\n\t\t\t\t\t\t\t\tmessageIndent: 4,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  )}`\n\t\t\t\t\t: ''\n\t\t\t}`,\n\t\t\ttrue,\n\t\t);\n\t\titem.command = this.getCommand();\n\n\t\treturn item;\n\t}\n\n\toverride getCommand(): Command | undefined {\n\t\tif (this.status.mergeBase == null) {\n\t\t\treturn {\n\t\t\t\ttitle: 'Open Revision',\n\t\t\t\tcommand: BuiltInCommands.Open,\n\t\t\t\targuments: [GitUri.toRevisionUri('HEAD', this.file.fileName, this.status.repoPath)],\n\t\t\t};\n\t\t}\n\n\t\tconst commandArgs: DiffWithCommandArgs = {\n\t\t\tlhs: {\n\t\t\t\tsha: this.status.mergeBase,\n\t\t\t\turi: GitUri.fromFile(this.file, this.status.repoPath, undefined, true),\n\t\t\t\ttitle: `${this.file.fileName} (merge-base)`,\n\t\t\t},\n\t\t\trhs: {\n\t\t\t\tsha: 'HEAD',\n\t\t\t\turi: GitUri.fromFile(this.file, this.status.repoPath),\n\t\t\t\ttitle: `${this.file.fileName} (${GitReference.toString(this.status.current, {\n\t\t\t\t\texpand: false,\n\t\t\t\t\ticon: false,\n\t\t\t\t})})`,\n\t\t\t},\n\t\t\trepoPath: this.status.repoPath,\n\t\t\tline: 0,\n\t\t\tshowOptions: {\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpreview: true,\n\t\t\t},\n\t\t};\n\t\treturn {\n\t\t\ttitle: 'Open Changes',\n\t\t\tcommand: Commands.DiffWith,\n\t\t\targuments: [commandArgs],\n\t\t};\n\t}\n}\n","'use strict';\nimport { Command, MarkdownString, ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Commands, DiffWithCommandArgs } from '../../commands';\nimport { BuiltInCommands, GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { CommitFormatter, GitFile, GitMergeStatus, GitRebaseStatus, GitReference } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { FileHistoryView } from '../fileHistoryView';\nimport { LineHistoryView } from '../lineHistoryView';\nimport { ViewsWithCommits } from '../viewBase';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport class MergeConflictIncomingChangesNode extends ViewNode<ViewsWithCommits | FileHistoryView | LineHistoryView> {\n\tconstructor(\n\t\tview: ViewsWithCommits | FileHistoryView | LineHistoryView,\n\t\tparent: ViewNode,\n\t\tprivate readonly status: GitMergeStatus | GitRebaseStatus,\n\t\tprivate readonly file: GitFile,\n\t) {\n\t\tsuper(GitUri.fromFile(file, status.repoPath, status.HEAD.ref), view, parent);\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\treturn [];\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tconst commit = await Container.git.getCommit(\n\t\t\tthis.status.repoPath,\n\t\t\tthis.status.type === 'rebase' ? this.status.steps.current.commit.ref : this.status.HEAD.ref,\n\t\t);\n\n\t\tconst item = new TreeItem('Incoming changes', TreeItemCollapsibleState.None);\n\t\titem.contextValue = ContextValues.MergeConflictIncomingChanges;\n\t\titem.description = `${GitReference.toString(this.status.incoming, { expand: false, icon: false })}${\n\t\t\tthis.status.type === 'rebase'\n\t\t\t\t? ` (${GitReference.toString(this.status.steps.current.commit, { expand: false, icon: false })})`\n\t\t\t\t: ` (${GitReference.toString(this.status.HEAD, { expand: false, icon: false })})`\n\t\t}`;\n\t\titem.iconPath = this.view.config.avatars\n\t\t\t? (await commit?.getAvatarUri({ defaultStyle: Container.config.defaultGravatarsStyle })) ??\n\t\t\t  new ThemeIcon('diff')\n\t\t\t: new ThemeIcon('diff');\n\t\titem.tooltip = new MarkdownString(\n\t\t\t`Incoming changes to $(file)${GlyphChars.Space}${this.file.fileName}${\n\t\t\t\tthis.status.incoming != null\n\t\t\t\t\t? ` from ${GitReference.toString(this.status.incoming)}${\n\t\t\t\t\t\t\tcommit != null\n\t\t\t\t\t\t\t\t? `\\n\\n${await CommitFormatter.fromTemplateAsync(\n\t\t\t\t\t\t\t\t\t\t`$(git-commit)&nbsp;\\${id} ${GlyphChars.Dash} \\${avatar}&nbsp;__\\${author}__, \\${ago}\\${' via 'pullRequest} &nbsp; _(\\${date})_ \\n\\n\\${message}`,\n\t\t\t\t\t\t\t\t\t\tcommit,\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tavatarSize: 16,\n\t\t\t\t\t\t\t\t\t\t\tdateFormat: Container.config.defaultDateFormat,\n\t\t\t\t\t\t\t\t\t\t\tmarkdown: true,\n\t\t\t\t\t\t\t\t\t\t\t// messageAutolinks: true,\n\t\t\t\t\t\t\t\t\t\t\tmessageIndent: 4,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t  )}`\n\t\t\t\t\t\t\t\t: this.status.type === 'rebase'\n\t\t\t\t\t\t\t\t? `\\n\\n${GitReference.toString(this.status.steps.current.commit, {\n\t\t\t\t\t\t\t\t\t\tcapitalize: true,\n\t\t\t\t\t\t\t\t\t\tlabel: false,\n\t\t\t\t\t\t\t\t  })}`\n\t\t\t\t\t\t\t\t: `\\n\\n${GitReference.toString(this.status.HEAD, { capitalize: true, label: false })}`\n\t\t\t\t\t  }`\n\t\t\t\t\t: ''\n\t\t\t}`,\n\t\t\ttrue,\n\t\t);\n\t\titem.command = this.getCommand();\n\n\t\treturn item;\n\t}\n\n\toverride getCommand(): Command | undefined {\n\t\tif (this.status.mergeBase == null) {\n\t\t\treturn {\n\t\t\t\ttitle: 'Open Revision',\n\t\t\t\tcommand: BuiltInCommands.Open,\n\t\t\t\targuments: [GitUri.toRevisionUri(this.status.HEAD.ref, this.file.fileName, this.status.repoPath)],\n\t\t\t};\n\t\t}\n\n\t\tconst commandArgs: DiffWithCommandArgs = {\n\t\t\tlhs: {\n\t\t\t\tsha: this.status.mergeBase,\n\t\t\t\turi: GitUri.fromFile(this.file, this.status.repoPath, undefined, true),\n\t\t\t\ttitle: `${this.file.fileName} (merge-base)`,\n\t\t\t},\n\t\t\trhs: {\n\t\t\t\tsha: this.status.HEAD.ref,\n\t\t\t\turi: GitUri.fromFile(this.file, this.status.repoPath),\n\t\t\t\ttitle: `${this.file.fileName} (${\n\t\t\t\t\tthis.status.incoming != null\n\t\t\t\t\t\t? GitReference.toString(this.status.incoming, { expand: false, icon: false })\n\t\t\t\t\t\t: 'incoming'\n\t\t\t\t})`,\n\t\t\t},\n\t\t\trepoPath: this.status.repoPath,\n\t\t\tline: 0,\n\t\t\tshowOptions: {\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpreview: true,\n\t\t\t},\n\t\t};\n\t\treturn {\n\t\t\ttitle: 'Open Changes',\n\t\t\tcommand: Commands.DiffWith,\n\t\t\targuments: [commandArgs],\n\t\t};\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport {\n\tCommand,\n\tMarkdownString,\n\tSelection,\n\tThemeColor,\n\tThemeIcon,\n\tTreeItem,\n\tTreeItemCollapsibleState,\n\tUri,\n} from 'vscode';\nimport { Commands, DiffWithPreviousCommandArgs } from '../../commands';\nimport { Colors, GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport {\n\tCommitFormatter,\n\tGitBranch,\n\tGitFile,\n\tGitLogCommit,\n\tGitRevisionReference,\n\tStatusFileFormatter,\n} from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { FileHistoryView } from '../fileHistoryView';\nimport { LineHistoryView } from '../lineHistoryView';\nimport { ViewsWithCommits } from '../viewBase';\nimport { MergeConflictCurrentChangesNode } from './mergeConflictCurrentChangesNode';\nimport { MergeConflictIncomingChangesNode } from './mergeConflictIncomingChangesNode';\nimport { ContextValues, ViewNode, ViewRefFileNode } from './viewNode';\n\nexport class FileRevisionAsCommitNode extends ViewRefFileNode<ViewsWithCommits | FileHistoryView | LineHistoryView> {\n\tconstructor(\n\t\tview: ViewsWithCommits | FileHistoryView | LineHistoryView,\n\t\tparent: ViewNode,\n\t\tpublic readonly file: GitFile,\n\t\tpublic commit: GitLogCommit,\n\t\tprivate readonly _options: {\n\t\t\tbranch?: GitBranch;\n\t\t\tgetBranchAndTagTips?: (sha: string, options?: { compact?: boolean }) => string | undefined;\n\t\t\tselection?: Selection;\n\t\t\tunpublished?: boolean;\n\t\t} = {},\n\t) {\n\t\tsuper(GitUri.fromFile(file, commit.repoPath, commit.sha), view, parent);\n\t}\n\n\toverride toClipboard(): string {\n\t\tlet message = this.commit.message;\n\t\tconst index = message.indexOf('\\n');\n\t\tif (index !== -1) {\n\t\t\tmessage = `${message.substring(0, index)}${GlyphChars.Space}${GlyphChars.Ellipsis}`;\n\t\t}\n\n\t\treturn `${this.commit.shortSha}: ${message}`;\n\t}\n\n\tget fileName(): string {\n\t\treturn this.file.fileName;\n\t}\n\n\tget isTip(): boolean {\n\t\treturn (this._options.branch?.current && this._options.branch.sha === this.commit.ref) ?? false;\n\t}\n\n\tget ref(): GitRevisionReference {\n\t\treturn this.commit;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (!this.commit.hasConflicts) return [];\n\n\t\tconst [mergeStatus, rebaseStatus] = await Promise.all([\n\t\t\tContainer.git.getMergeStatus(this.commit.repoPath),\n\t\t\tContainer.git.getRebaseStatus(this.commit.repoPath),\n\t\t]);\n\t\tif (mergeStatus == null && rebaseStatus == null) return [];\n\n\t\treturn [\n\t\t\tnew MergeConflictCurrentChangesNode(this.view, this, (mergeStatus ?? rebaseStatus)!, this.file),\n\t\t\tnew MergeConflictIncomingChangesNode(this.view, this, (mergeStatus ?? rebaseStatus)!, this.file),\n\t\t];\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tif (!this.commit.isFile) {\n\t\t\t// Try to get the commit directly from the multi-file commit\n\t\t\tconst commit = this.commit.toFileCommit(this.file);\n\t\t\tif (commit == null) {\n\t\t\t\tconst log = await Container.git.getLogForFile(this.repoPath, this.file.fileName, {\n\t\t\t\t\tlimit: 2,\n\t\t\t\t\tref: this.commit.sha,\n\t\t\t\t});\n\t\t\t\tif (log != null) {\n\t\t\t\t\tthis.commit = log.commits.get(this.commit.sha) ?? this.commit;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.commit = commit;\n\t\t\t}\n\t\t}\n\n\t\tconst item = new TreeItem(\n\t\t\tCommitFormatter.fromTemplate(this.view.config.formats.commits.label, this.commit, {\n\t\t\t\tdateFormat: Container.config.defaultDateFormat,\n\t\t\t\tgetBranchAndTagTips: (sha: string) => this._options.getBranchAndTagTips?.(sha, { compact: true }),\n\t\t\t\tmessageTruncateAtNewLine: true,\n\t\t\t}),\n\t\t\tthis.commit.hasConflicts ? TreeItemCollapsibleState.Expanded : TreeItemCollapsibleState.None,\n\t\t);\n\n\t\titem.contextValue = this.contextValue;\n\n\t\titem.description = CommitFormatter.fromTemplate(this.view.config.formats.commits.description, this.commit, {\n\t\t\tdateFormat: Container.config.defaultDateFormat,\n\t\t\tgetBranchAndTagTips: (sha: string) => this._options.getBranchAndTagTips?.(sha, { compact: true }),\n\t\t\tmessageTruncateAtNewLine: true,\n\t\t});\n\n\t\titem.resourceUri = Uri.parse(`gitlens-view://commit-file/status/${this.file.status}`);\n\n\t\tif (!this.commit.isUncommitted && this.view.config.avatars) {\n\t\t\titem.iconPath = this._options.unpublished\n\t\t\t\t? new ThemeIcon('arrow-up', new ThemeColor(Colors.UnpublishedCommitIconColor))\n\t\t\t\t: await this.commit.getAvatarUri({ defaultStyle: Container.config.defaultGravatarsStyle });\n\t\t}\n\n\t\tif (item.iconPath == null) {\n\t\t\tconst icon = GitFile.getStatusIcon(this.file.status);\n\t\t\titem.iconPath = {\n\t\t\t\tdark: Container.context.asAbsolutePath(paths.join('images', 'dark', icon)),\n\t\t\t\tlight: Container.context.asAbsolutePath(paths.join('images', 'light', icon)),\n\t\t\t};\n\t\t}\n\n\t\titem.command = this.getCommand();\n\n\t\treturn item;\n\t}\n\n\tprotected get contextValue(): string {\n\t\tif (!this.commit.isUncommitted) {\n\t\t\treturn `${ContextValues.File}+committed${this._options.branch?.current ? '+current' : ''}${\n\t\t\t\tthis.isTip ? '+HEAD' : ''\n\t\t\t}${this._options.unpublished ? '+unpublished' : ''}`;\n\t\t}\n\n\t\treturn this.commit.hasConflicts\n\t\t\t? `${ContextValues.File}+conflicted`\n\t\t\t: this.commit.isUncommittedStaged\n\t\t\t? `${ContextValues.File}+staged`\n\t\t\t: `${ContextValues.File}+unstaged`;\n\t}\n\n\toverride getCommand(): Command | undefined {\n\t\tlet line;\n\t\tif (this.commit.line !== undefined) {\n\t\t\tline = this.commit.line.to.line - 1;\n\t\t} else {\n\t\t\tline = this._options.selection !== undefined ? this._options.selection.active.line : 0;\n\t\t}\n\n\t\tif (this.commit.hasConflicts) {\n\t\t\treturn {\n\t\t\t\ttitle: 'Open Changes',\n\t\t\t\tcommand: Commands.DiffWith,\n\t\t\t\targuments: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlhs: {\n\t\t\t\t\t\t\tsha: 'MERGE_HEAD',\n\t\t\t\t\t\t\turi: GitUri.fromFile(this.file, this.repoPath, undefined, true),\n\t\t\t\t\t\t},\n\t\t\t\t\t\trhs: {\n\t\t\t\t\t\t\tsha: 'HEAD',\n\t\t\t\t\t\t\turi: GitUri.fromFile(this.file, this.repoPath),\n\t\t\t\t\t\t},\n\t\t\t\t\t\trepoPath: this.repoPath,\n\t\t\t\t\t\tline: 0,\n\t\t\t\t\t\tshowOptions: {\n\t\t\t\t\t\t\tpreserveFocus: false,\n\t\t\t\t\t\t\tpreview: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t};\n\t\t}\n\n\t\tconst commandArgs: DiffWithPreviousCommandArgs = {\n\t\t\tcommit: this.commit,\n\t\t\turi: GitUri.fromFile(this.file, this.commit.repoPath),\n\t\t\tline: line,\n\t\t\tshowOptions: {\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpreview: true,\n\t\t\t},\n\t\t};\n\t\treturn {\n\t\t\ttitle: 'Open Changes with Previous Revision',\n\t\t\tcommand: Commands.DiffWithPrevious,\n\t\t\targuments: [undefined, commandArgs],\n\t\t};\n\t}\n\n\toverride async resolveTreeItem(item: TreeItem): Promise<TreeItem> {\n\t\tif (item.tooltip == null) {\n\t\t\titem.tooltip = await this.getTooltip();\n\t\t}\n\t\treturn item;\n\t}\n\n\tasync getConflictBaseUri(): Promise<Uri | undefined> {\n\t\tif (!this.commit.hasConflicts) return undefined;\n\n\t\tconst mergeBase = await Container.git.getMergeBase(this.repoPath, 'MERGE_HEAD', 'HEAD');\n\t\treturn GitUri.fromFile(this.file, this.repoPath, mergeBase ?? 'HEAD');\n\t}\n\n\tprivate async getTooltip() {\n\t\tconst remotes = await Container.git.getRemotes(this.commit.repoPath);\n\t\tconst remote = await Container.git.getRichRemoteProvider(remotes);\n\n\t\tlet autolinkedIssuesOrPullRequests;\n\t\tlet pr;\n\n\t\tif (remote?.provider != null) {\n\t\t\t[autolinkedIssuesOrPullRequests, pr] = await Promise.all([\n\t\t\t\tContainer.autolinks.getIssueOrPullRequestLinks(this.commit.message, remote),\n\t\t\t\tContainer.git.getPullRequestForCommit(this.commit.ref, remote.provider),\n\t\t\t]);\n\t\t}\n\n\t\tconst status = StatusFileFormatter.fromTemplate(`\\${status}\\${ (originalPath)}`, this.file);\n\t\tconst tooltip = await CommitFormatter.fromTemplateAsync(\n\t\t\t`\\${'$(git-commit) 'id}\\${' via 'pullRequest} \\u2022 ${status}\\${ \\u2022 changesDetail}\\${'&nbsp;&nbsp;&nbsp;'tips}\\n\\n\\${avatar} &nbsp;__\\${author}__, \\${ago} &nbsp; _(\\${date})_ \\n\\n\\${message}\\${\\n\\n---\\n\\nfootnotes}`,\n\t\t\tthis.commit,\n\t\t\t{\n\t\t\t\tautolinkedIssuesOrPullRequests: autolinkedIssuesOrPullRequests,\n\t\t\t\tdateFormat: Container.config.defaultDateFormat,\n\t\t\t\tgetBranchAndTagTips: this._options.getBranchAndTagTips,\n\t\t\t\tmarkdown: true,\n\t\t\t\tmessageAutolinks: true,\n\t\t\t\tmessageIndent: 4,\n\t\t\t\tpullRequestOrRemote: pr,\n\t\t\t\tremotes: remotes,\n\t\t\t\tunpublished: this._options.unpublished,\n\t\t\t},\n\t\t);\n\n\t\tconst markdown = new MarkdownString(tooltip, true);\n\t\tmarkdown.isTrusted = true;\n\n\t\treturn markdown;\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { Command, ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Commands, DiffWithCommandArgs, DiffWithPreviousCommandArgs } from '../../commands';\nimport { Container } from '../../container';\nimport { GitFile, GitLogCommit, StatusFileFormatter } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { Strings } from '../../system';\nimport { ViewsWithCommits } from '../viewBase';\nimport { FileRevisionAsCommitNode } from './fileRevisionAsCommitNode';\nimport { FileNode } from './folderNode';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport class StatusFileNode extends ViewNode<ViewsWithCommits> implements FileNode {\n\tpublic readonly commits: GitLogCommit[];\n\tpublic readonly file: GitFile;\n\tpublic readonly repoPath: string;\n\n\tprivate readonly _hasStagedChanges: boolean;\n\tprivate readonly _hasUnstagedChanges: boolean;\n\n\tconstructor(view: ViewsWithCommits, parent: ViewNode, repoPath: string, file: GitFile, commits: GitLogCommit[]) {\n\t\tlet hasStagedChanges = false;\n\t\tlet hasUnstagedChanges = false;\n\t\tlet ref = undefined;\n\t\tfor (const c of commits) {\n\t\t\tif (c.isUncommitted) {\n\t\t\t\tif (c.isUncommittedStaged) {\n\t\t\t\t\thasStagedChanges = true;\n\t\t\t\t\tif (!hasUnstagedChanges) {\n\t\t\t\t\t\tref = c.sha;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tref = undefined;\n\t\t\t\t\thasUnstagedChanges = true;\n\t\t\t\t}\n\t\t\t} else if (hasUnstagedChanges) {\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tref = c.sha;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tsuper(GitUri.fromFile(file, repoPath, ref), view, parent);\n\n\t\tthis.repoPath = repoPath;\n\t\tthis.file = file;\n\t\tthis.commits = commits;\n\n\t\tthis._hasStagedChanges = hasStagedChanges;\n\t\tthis._hasUnstagedChanges = hasUnstagedChanges;\n\t}\n\n\toverride toClipboard(): string {\n\t\treturn this.fileName;\n\t}\n\n\tget fileName(): string {\n\t\treturn this.file.fileName;\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\treturn this.commits.map(c => new FileRevisionAsCommitNode(this.view, this, this.file, c));\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(this.label, TreeItemCollapsibleState.None);\n\t\titem.description = this.description;\n\n\t\tif ((this._hasStagedChanges || this._hasUnstagedChanges) && this.commits.length === 1) {\n\t\t\titem.contextValue = ContextValues.File;\n\t\t\tif (this._hasStagedChanges) {\n\t\t\t\titem.contextValue += '+staged';\n\t\t\t\titem.tooltip = StatusFileFormatter.fromTemplate(\n\t\t\t\t\t`\\${file}\\n\\${directory}/\\n\\n\\${status}\\${ (originalPath)} in Index (staged)`,\n\t\t\t\t\tthis.file,\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\titem.contextValue += '+unstaged';\n\t\t\t\titem.tooltip = StatusFileFormatter.fromTemplate(\n\t\t\t\t\t`\\${file}\\n\\${directory}/\\n\\n\\${status}\\${ (originalPath)} in Working Tree`,\n\t\t\t\t\tthis.file,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Use the file icon and decorations\n\t\t\titem.resourceUri = GitUri.resolveToUri(this.file.fileName, this.repoPath);\n\t\t\titem.iconPath = ThemeIcon.File;\n\n\t\t\titem.command = this.getCommand();\n\t\t} else {\n\t\t\titem.collapsibleState = TreeItemCollapsibleState.Collapsed;\n\t\t\tif (this._hasStagedChanges || this._hasUnstagedChanges) {\n\t\t\t\titem.contextValue = ContextValues.File;\n\t\t\t\tif (this._hasStagedChanges && this._hasUnstagedChanges) {\n\t\t\t\t\titem.contextValue += '+staged+unstaged';\n\t\t\t\t} else if (this._hasStagedChanges) {\n\t\t\t\t\titem.contextValue += '+staged';\n\t\t\t\t} else {\n\t\t\t\t\titem.contextValue += '+unstaged';\n\t\t\t\t}\n\n\t\t\t\t// Use the file icon and decorations\n\t\t\t\titem.resourceUri = GitUri.resolveToUri(this.file.fileName, this.repoPath);\n\t\t\t\titem.iconPath = ThemeIcon.File;\n\t\t\t} else {\n\t\t\t\titem.contextValue = ContextValues.StatusFileCommits;\n\n\t\t\t\tconst icon = GitFile.getStatusIcon(this.file.status);\n\t\t\t\titem.iconPath = {\n\t\t\t\t\tdark: Container.context.asAbsolutePath(paths.join('images', 'dark', icon)),\n\t\t\t\t\tlight: Container.context.asAbsolutePath(paths.join('images', 'light', icon)),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\titem.tooltip = StatusFileFormatter.fromTemplate(\n\t\t\t\t`\\${file}\\n\\${directory}/\\n\\n\\${status}\\${ (originalPath)} in ${this.getChangedIn()}`,\n\t\t\t\tthis.file,\n\t\t\t);\n\n\t\t\titem.command = this.getCommand();\n\t\t}\n\n\t\t// Only cache the label/description for a single refresh\n\t\tthis._label = undefined;\n\t\tthis._description = undefined;\n\n\t\treturn item;\n\t}\n\n\tprivate _description: string | undefined;\n\tget description() {\n\t\tif (this._description == null) {\n\t\t\tthis._description = StatusFileFormatter.fromTemplate(\n\t\t\t\tthis.view.config.formats.files.description,\n\t\t\t\t{\n\t\t\t\t\t...this.file,\n\t\t\t\t\tcommit: this.commit,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trelativePath: this.relativePath,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t\treturn this._description;\n\t}\n\n\tprivate _folderName: string | undefined;\n\tget folderName() {\n\t\tif (this._folderName == null) {\n\t\t\tthis._folderName = paths.dirname(this.uri.relativePath);\n\t\t}\n\t\treturn this._folderName;\n\t}\n\n\tprivate _label: string | undefined;\n\tget label() {\n\t\tif (this._label == null) {\n\t\t\tthis._label = StatusFileFormatter.fromTemplate(\n\t\t\t\tthis.view.config.formats.files.label,\n\t\t\t\t{\n\t\t\t\t\t...this.file,\n\t\t\t\t\tcommit: this.commit,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trelativePath: this.relativePath,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t\treturn this._label;\n\t}\n\n\tget commit() {\n\t\treturn this.commits[0];\n\t}\n\n\tget priority(): number {\n\t\tif (this._hasStagedChanges && !this._hasUnstagedChanges) return -3;\n\t\tif (this._hasStagedChanges) return -2;\n\t\tif (this._hasUnstagedChanges) return -1;\n\t\treturn 0;\n\t}\n\n\tprivate _relativePath: string | undefined;\n\tget relativePath(): string | undefined {\n\t\treturn this._relativePath;\n\t}\n\tset relativePath(value: string | undefined) {\n\t\tthis._relativePath = value;\n\t\tthis._label = undefined;\n\t\tthis._description = undefined;\n\t}\n\n\tprivate getChangedIn(): string {\n\t\tconst changedIn = [];\n\n\t\tlet commits = 0;\n\n\t\tif (this._hasUnstagedChanges) {\n\t\t\tcommits++;\n\t\t\tchangedIn.push('Working Tree');\n\t\t}\n\n\t\tif (this._hasStagedChanges) {\n\t\t\tcommits++;\n\t\t\tchangedIn.push('Index (staged)');\n\t\t}\n\n\t\tif (this.commits.length > commits) {\n\t\t\tcommits = this.commits.length - commits;\n\t\t}\n\n\t\tif (commits > 0) {\n\t\t\tchangedIn.push(Strings.pluralize('commit', commits));\n\t\t}\n\n\t\tif (changedIn.length > 2) {\n\t\t\tchangedIn[changedIn.length - 1] = `and ${changedIn[changedIn.length - 1]}`;\n\t\t}\n\t\treturn changedIn.join(changedIn.length > 2 ? ', ' : ' and ');\n\t}\n\n\toverride getCommand(): Command | undefined {\n\t\tif ((this._hasStagedChanges || this._hasUnstagedChanges) && this.commits.length === 1) {\n\t\t\tconst commandArgs: DiffWithPreviousCommandArgs = {\n\t\t\t\tcommit: this.commit,\n\t\t\t\turi: GitUri.fromFile(this.file, this.repoPath),\n\t\t\t\tline: 0,\n\t\t\t\tshowOptions: {\n\t\t\t\t\tpreserveFocus: true,\n\t\t\t\t\tpreview: true,\n\t\t\t\t},\n\t\t\t};\n\t\t\treturn {\n\t\t\t\ttitle: 'Open Changes with Previous Revision',\n\t\t\t\tcommand: Commands.DiffWithPrevious,\n\t\t\t\targuments: [undefined, commandArgs],\n\t\t\t};\n\t\t}\n\n\t\tconst commit = this.commits[this.commits.length - 1];\n\t\tconst file = commit.findFile(this.file.fileName)!;\n\t\tconst commandArgs: DiffWithCommandArgs = {\n\t\t\tlhs: {\n\t\t\t\tsha: `${commit.sha}^`,\n\t\t\t\turi: GitUri.fromFile(file, this.repoPath, undefined, true),\n\t\t\t},\n\t\t\trhs: {\n\t\t\t\tsha: '',\n\t\t\t\turi: GitUri.fromFile(this.file, this.repoPath),\n\t\t\t},\n\t\t\trepoPath: this.repoPath,\n\t\t\tline: 0,\n\t\t\tshowOptions: {\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpreview: true,\n\t\t\t},\n\t\t};\n\t\treturn {\n\t\t\ttitle: 'Open Changes',\n\t\t\tcommand: Commands.DiffWith,\n\t\t\targuments: [commandArgs],\n\t\t};\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { ViewFilesLayout } from '../../configuration';\nimport { Container } from '../../container';\nimport { GitBranch, GitFileWithCommit, GitRevision } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { Arrays, Iterables, Strings } from '../../system';\nimport { ViewsWithCommits } from '../viewBase';\nimport { BranchNode } from './branchNode';\nimport { BranchTrackingStatus } from './branchTrackingStatusNode';\nimport { FileNode, FolderNode } from './folderNode';\nimport { StatusFileNode } from './statusFileNode';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport class BranchTrackingStatusFilesNode extends ViewNode<ViewsWithCommits> {\n\tstatic key = ':status-branch:files';\n\tstatic getId(repoPath: string, name: string, root: boolean, upstream: string, direction: string): string {\n\t\treturn `${BranchNode.getId(repoPath, name, root)}${this.key}(${upstream}|${direction})`;\n\t}\n\n\treadonly repoPath: string;\n\n\tconstructor(\n\t\tview: ViewsWithCommits,\n\t\tparent: ViewNode,\n\t\tpublic readonly branch: GitBranch,\n\t\tpublic readonly status: Required<BranchTrackingStatus>,\n\t\tpublic readonly direction: 'ahead' | 'behind',\n\t\t// Specifies that the node is shown as a root\n\t\tprivate readonly root: boolean = false,\n\t) {\n\t\tsuper(GitUri.fromRepoPath(status.repoPath), view, parent);\n\t\tthis.repoPath = status.repoPath;\n\t}\n\n\toverride get id(): string {\n\t\treturn BranchTrackingStatusFilesNode.getId(\n\t\t\tthis.status.repoPath,\n\t\t\tthis.status.ref,\n\t\t\tthis.root,\n\t\t\tthis.status.upstream,\n\t\t\tthis.direction,\n\t\t);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst log = await Container.git.getLog(this.repoPath, {\n\t\t\tlimit: 0,\n\t\t\tref: GitRevision.createRange(\n\t\t\t\tthis.status.upstream,\n\t\t\t\tthis.branch.ref,\n\t\t\t\tthis.direction === 'behind' ? '...' : '..',\n\t\t\t),\n\t\t});\n\n\t\tconst files =\n\t\t\tlog != null\n\t\t\t\t? [\n\t\t\t\t\t\t...Iterables.flatMap(log.commits.values(), c =>\n\t\t\t\t\t\t\tc.files.map(s => {\n\t\t\t\t\t\t\t\tconst file: GitFileWithCommit = { ...s, commit: c };\n\t\t\t\t\t\t\t\treturn file;\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t),\n\t\t\t\t  ]\n\t\t\t\t: [];\n\n\t\tfiles.sort((a, b) => b.commit.date.getTime() - a.commit.date.getTime());\n\n\t\tconst groups = Arrays.groupBy(files, s => s.fileName);\n\n\t\tlet children: FileNode[] = Object.values(groups).map(\n\t\t\tfiles =>\n\t\t\t\tnew StatusFileNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\tthis.repoPath,\n\t\t\t\t\tfiles[files.length - 1],\n\t\t\t\t\tfiles.map(s => s.commit),\n\t\t\t\t),\n\t\t);\n\n\t\tif (this.view.config.files.layout !== ViewFilesLayout.List) {\n\t\t\tconst hierarchy = Arrays.makeHierarchical(\n\t\t\t\tchildren,\n\t\t\t\tn => n.uri.relativePath.split('/'),\n\t\t\t\t(...parts: string[]) => Strings.normalizePath(paths.join(...parts)),\n\t\t\t\tthis.view.config.files.compact,\n\t\t\t);\n\n\t\t\tconst root = new FolderNode(this.view, this, this.repoPath, '', hierarchy, false);\n\t\t\tchildren = root.getChildren() as FileNode[];\n\t\t} else {\n\t\t\tchildren.sort(\n\t\t\t\t(a, b) =>\n\t\t\t\t\ta.priority - b.priority ||\n\t\t\t\t\ta.label!.localeCompare(b.label!, undefined, { numeric: true, sensitivity: 'base' }),\n\t\t\t);\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tconst stats = await Container.git.getChangedFilesCount(\n\t\t\tthis.repoPath,\n\t\t\t`${this.status.upstream}${this.direction === 'behind' ? '..' : '...'}`,\n\t\t);\n\t\tconst files = stats?.files ?? 0;\n\n\t\tconst label = `${Strings.pluralize('file', files)} changed`;\n\t\tconst item = new TreeItem(label, TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\titem.contextValue = ContextValues.BranchStatusFiles;\n\n\t\treturn item;\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { Command, Selection, TreeItem, TreeItemCollapsibleState, Uri } from 'vscode';\nimport { Commands, DiffWithPreviousCommandArgs } from '../../commands';\nimport { Container } from '../../container';\nimport { GitBranch, GitFile, GitLogCommit, GitRevisionReference, StatusFileFormatter } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { FileHistoryView } from '../fileHistoryView';\nimport { View, ViewsWithCommits } from '../viewBase';\nimport { ContextValues, ViewNode, ViewRefFileNode } from './viewNode';\n\nexport class CommitFileNode<TView extends View = ViewsWithCommits | FileHistoryView> extends ViewRefFileNode<TView> {\n\tconstructor(\n\t\tview: TView,\n\t\tparent: ViewNode,\n\t\tpublic readonly file: GitFile,\n\t\tpublic commit: GitLogCommit,\n\t\tprivate readonly _options: {\n\t\t\tbranch?: GitBranch;\n\t\t\tselection?: Selection;\n\t\t\tunpublished?: boolean;\n\t\t} = {},\n\t) {\n\t\tsuper(GitUri.fromFile(file, commit.repoPath, commit.sha), view, parent);\n\t}\n\n\toverride toClipboard(): string {\n\t\treturn this.fileName;\n\t}\n\n\tget fileName(): string {\n\t\treturn this.file.fileName;\n\t}\n\n\tget priority(): number {\n\t\treturn 0;\n\t}\n\n\tget ref(): GitRevisionReference {\n\t\treturn this.commit;\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\treturn [];\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tif (!this.commit.isFile) {\n\t\t\t// Try to get the commit directly from the multi-file commit\n\t\t\tconst commit = this.commit.toFileCommit(this.file);\n\t\t\tif (commit == null) {\n\t\t\t\tconst log = await Container.git.getLogForFile(this.repoPath, this.file.fileName, {\n\t\t\t\t\tlimit: 2,\n\t\t\t\t\tref: this.commit.sha,\n\t\t\t\t});\n\t\t\t\tif (log != null) {\n\t\t\t\t\tthis.commit = log.commits.get(this.commit.sha) ?? this.commit;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.commit = commit;\n\t\t\t}\n\t\t}\n\n\t\tconst item = new TreeItem(this.label, TreeItemCollapsibleState.None);\n\t\titem.contextValue = this.contextValue;\n\t\titem.description = this.description;\n\t\titem.resourceUri = Uri.parse(`gitlens-view://commit-file/status/${this.file.status}`);\n\t\titem.tooltip = this.tooltip;\n\n\t\tconst icon = GitFile.getStatusIcon(this.file.status);\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath(paths.join('images', 'dark', icon)),\n\t\t\tlight: Container.context.asAbsolutePath(paths.join('images', 'light', icon)),\n\t\t};\n\n\t\titem.command = this.getCommand();\n\n\t\t// Only cache the label for a single refresh (its only cached because it is used externally for sorting)\n\t\tthis._label = undefined;\n\n\t\treturn item;\n\t}\n\n\tprotected get contextValue(): string {\n\t\tif (!this.commit.isUncommitted) {\n\t\t\treturn `${ContextValues.File}+committed${this._options.branch?.current ? '+current' : ''}${\n\t\t\t\tthis._options.branch?.current && this._options.branch.sha === this.commit.ref ? '+HEAD' : ''\n\t\t\t}${this._options.unpublished ? '+unpublished' : ''}`;\n\t\t}\n\n\t\treturn this.commit.isUncommittedStaged ? `${ContextValues.File}+staged` : `${ContextValues.File}+unstaged`;\n\t}\n\n\tprivate get description() {\n\t\treturn StatusFileFormatter.fromTemplate(this.view.config.formats.files.description, this.file, {\n\t\t\trelativePath: this.relativePath,\n\t\t});\n\t}\n\n\tprivate _folderName: string | undefined;\n\tget folderName() {\n\t\tif (this._folderName === undefined) {\n\t\t\tthis._folderName = paths.dirname(this.uri.relativePath);\n\t\t}\n\t\treturn this._folderName;\n\t}\n\n\tprivate _label: string | undefined;\n\tget label() {\n\t\tif (this._label === undefined) {\n\t\t\tthis._label = StatusFileFormatter.fromTemplate(this.view.config.formats.files.label, this.file, {\n\t\t\t\trelativePath: this.relativePath,\n\t\t\t});\n\t\t}\n\t\treturn this._label;\n\t}\n\n\tprivate _relativePath: string | undefined;\n\tget relativePath(): string | undefined {\n\t\treturn this._relativePath;\n\t}\n\tset relativePath(value: string | undefined) {\n\t\tthis._relativePath = value;\n\t\tthis._label = undefined;\n\t}\n\n\tprivate get tooltip() {\n\t\treturn StatusFileFormatter.fromTemplate(`\\${file}\\n\\${directory}/\\n\\n\\${status}\\${ (originalPath)}`, this.file);\n\t}\n\n\toverride getCommand(): Command | undefined {\n\t\tlet line;\n\t\tif (this.commit.line !== undefined) {\n\t\t\tline = this.commit.line.to.line - 1;\n\t\t} else {\n\t\t\tline = this._options.selection !== undefined ? this._options.selection.active.line : 0;\n\t\t}\n\n\t\tconst commandArgs: DiffWithPreviousCommandArgs = {\n\t\t\tcommit: this.commit,\n\t\t\turi: GitUri.fromFile(this.file, this.commit.repoPath),\n\t\t\tline: line,\n\t\t\tshowOptions: {\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpreview: true,\n\t\t\t},\n\t\t};\n\t\treturn {\n\t\t\ttitle: 'Open Changes with Previous Revision',\n\t\t\tcommand: Commands.DiffWithPrevious,\n\t\t\targuments: [undefined, commandArgs],\n\t\t};\n\t}\n}\n","'use strict';\nimport { GitLogCommit } from '../../git/git';\nimport { MessageNode } from './common';\nimport { ContextValues, ViewNode } from './viewNode';\n\nconst markers: [number, string][] = [\n\t[0, 'Less than a week ago'],\n\t[7, 'Over a week ago'],\n\t[25, 'Over a month ago'],\n\t[77, 'Over 3 months ago'],\n];\n\nexport function* insertDateMarkers<T extends ViewNode & { commit: GitLogCommit }>(\n\titerable: Iterable<T>,\n\tparent: ViewNode,\n\tskip?: number,\n\t{ show }: { show: boolean } = { show: true },\n): Iterable<ViewNode> {\n\tif (!parent.view.config.showRelativeDateMarkers || !show) {\n\t\treturn yield* iterable;\n\t}\n\n\tlet index = skip ?? 0;\n\tlet time = undefined;\n\tconst now = Date.now();\n\n\tlet first = true;\n\n\tfor (const node of iterable) {\n\t\tif (index < markers.length) {\n\t\t\tlet [daysAgo, marker] = markers[index];\n\t\t\tif (time === undefined) {\n\t\t\t\tconst date = new Date(now);\n\t\t\t\ttime = date.setDate(date.getDate() - daysAgo);\n\t\t\t}\n\n\t\t\tconst date = new Date(node.commit.committerDate).setUTCHours(0, 0, 0, 0);\n\t\t\tif (date <= time) {\n\t\t\t\twhile (index < markers.length - 1) {\n\t\t\t\t\t[daysAgo] = markers[index + 1];\n\t\t\t\t\tconst nextDate = new Date(now);\n\t\t\t\t\tconst nextTime = nextDate.setDate(nextDate.getDate() - daysAgo);\n\n\t\t\t\t\tif (date > nextTime) break;\n\n\t\t\t\t\tindex++;\n\t\t\t\t\ttime = undefined;\n\t\t\t\t\t[, marker] = markers[index];\n\t\t\t\t}\n\n\t\t\t\t// Don't show the marker if it is the first node\n\t\t\t\tif (!first) {\n\t\t\t\t\tyield new MessageNode(\n\t\t\t\t\t\tparent.view,\n\t\t\t\t\t\tparent,\n\t\t\t\t\t\t'',\n\t\t\t\t\t\tmarker,\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tContextValues.DateMarker,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tindex++;\n\t\t\t\ttime = undefined;\n\t\t\t}\n\t\t}\n\n\t\tfirst = false;\n\t\tyield node;\n\t}\n\n\treturn undefined;\n}\n","'use strict';\nimport * as paths from 'path';\nimport { Command, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Commands, DiffWithCommandArgs } from '../../commands';\nimport { Container } from '../../container';\nimport { GitFile, GitReference, GitRevisionReference, StatusFileFormatter } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { View } from '../viewBase';\nimport { FileNode } from './folderNode';\nimport { ContextValues, ViewNode, ViewRefFileNode } from './viewNode';\n\nexport class ResultsFileNode extends ViewRefFileNode implements FileNode {\n\tconstructor(\n\t\tview: View,\n\t\tparent: ViewNode,\n\t\trepoPath: string,\n\t\tpublic readonly file: GitFile,\n\t\tpublic readonly ref1: string,\n\t\tpublic readonly ref2: string,\n\t\tprivate readonly direction: 'ahead' | 'behind' | undefined,\n\t) {\n\t\tsuper(GitUri.fromFile(file, repoPath, ref1 || ref2), view, parent);\n\t}\n\n\toverride toClipboard(): string {\n\t\treturn this.fileName;\n\t}\n\n\tget fileName(): string {\n\t\treturn this.file.fileName;\n\t}\n\n\tget ref(): GitRevisionReference {\n\t\treturn GitReference.create(this.ref1 || this.ref2, this.uri.repoPath!);\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\treturn [];\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(this.label, TreeItemCollapsibleState.None);\n\t\titem.contextValue = ContextValues.ResultsFile;\n\t\titem.description = this.description;\n\t\titem.tooltip = StatusFileFormatter.fromTemplate(\n\t\t\t`\\${file}\\n\\${directory}/\\n\\n\\${status}\\${ (originalPath)}`,\n\t\t\tthis.file,\n\t\t);\n\n\t\tconst statusIcon = GitFile.getStatusIcon(this.file.status);\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath(paths.join('images', 'dark', statusIcon)),\n\t\t\tlight: Container.context.asAbsolutePath(paths.join('images', 'light', statusIcon)),\n\t\t};\n\n\t\titem.command = this.getCommand();\n\t\treturn item;\n\t}\n\n\tprivate _description: string | undefined;\n\tget description() {\n\t\tif (this._description === undefined) {\n\t\t\tthis._description = StatusFileFormatter.fromTemplate(\n\t\t\t\tthis.view.config.formats.files.description,\n\t\t\t\tthis.file,\n\t\t\t\t{\n\t\t\t\t\trelativePath: this.relativePath,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t\treturn this._description;\n\t}\n\n\tprivate _folderName: string | undefined;\n\tget folderName() {\n\t\tif (this._folderName === undefined) {\n\t\t\tthis._folderName = paths.dirname(this.uri.relativePath);\n\t\t}\n\t\treturn this._folderName;\n\t}\n\n\tprivate _label: string | undefined;\n\tget label() {\n\t\tif (this._label === undefined) {\n\t\t\tthis._label = StatusFileFormatter.fromTemplate(this.view.config.formats.files.label, this.file, {\n\t\t\t\trelativePath: this.relativePath,\n\t\t\t});\n\t\t}\n\t\treturn this._label;\n\t}\n\n\tprivate _relativePath: string | undefined;\n\tget relativePath(): string | undefined {\n\t\treturn this._relativePath;\n\t}\n\tset relativePath(value: string | undefined) {\n\t\tthis._relativePath = value;\n\t\tthis._label = undefined;\n\t\tthis._description = undefined;\n\t}\n\n\tget priority(): number {\n\t\treturn 0;\n\t}\n\n\toverride getCommand(): Command | undefined {\n\t\tconst commandArgs: DiffWithCommandArgs = {\n\t\t\tlhs: {\n\t\t\t\tsha: this.ref1,\n\t\t\t\turi:\n\t\t\t\t\t(this.file.status === 'R' || this.file.status === 'C') && this.direction === 'behind'\n\t\t\t\t\t\t? GitUri.fromFile(this.file, this.uri.repoPath!, this.ref2, true)\n\t\t\t\t\t\t: this.uri,\n\t\t\t},\n\t\t\trhs: {\n\t\t\t\tsha: this.ref2,\n\t\t\t\turi:\n\t\t\t\t\t(this.file.status === 'R' || this.file.status === 'C') && this.direction !== 'behind'\n\t\t\t\t\t\t? GitUri.fromFile(this.file, this.uri.repoPath!, this.ref2, true)\n\t\t\t\t\t\t: this.uri,\n\t\t\t},\n\t\t\trepoPath: this.uri.repoPath!,\n\n\t\t\tline: 0,\n\t\t\tshowOptions: {\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpreview: true,\n\t\t\t},\n\t\t};\n\t\treturn {\n\t\t\ttitle: 'Open Changes',\n\t\t\tcommand: Commands.DiffWith,\n\t\t\targuments: [commandArgs],\n\t\t};\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { ViewFilesLayout } from '../../configuration';\nimport { Container } from '../../container';\nimport { GitFile } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { Arrays, debug, gate, Iterables, Promises, Strings } from '../../system';\nimport { ViewsWithCommits } from '../viewBase';\nimport { FileNode, FolderNode } from './folderNode';\nimport { ResultsFileNode } from './resultsFileNode';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport interface FilesQueryResults {\n\tlabel: string;\n\tfiles: GitFile[] | undefined;\n\tfiltered?: {\n\t\tfilter: 'left' | 'right';\n\t\tfiles: GitFile[];\n\t};\n}\n\nexport class ResultsFilesNode extends ViewNode<ViewsWithCommits> {\n\tconstructor(\n\t\tview: ViewsWithCommits,\n\t\tparent: ViewNode,\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly ref1: string,\n\t\tpublic readonly ref2: string,\n\t\tprivate readonly _filesQuery: () => Promise<FilesQueryResults>,\n\t\tprivate readonly direction: 'ahead' | 'behind' | undefined,\n\t\tprivate readonly _options: {\n\t\t\texpand?: boolean;\n\t\t} = {},\n\t) {\n\t\tsuper(GitUri.fromRepoPath(repoPath), view, parent);\n\n\t\tthis._options = { expand: true, ..._options };\n\t}\n\n\toverride get id(): string {\n\t\treturn `${this.parent!.id}:results:files`;\n\t}\n\n\tprivate _filter: 'left' | 'right' | false = false;\n\tget filter(): 'left' | 'right' | false {\n\t\treturn this._filter;\n\t}\n\tset filter(value: 'left' | 'right' | false) {\n\t\tif (this._filter === value) return;\n\n\t\tthis._filter = value;\n\t\tthis._filterResults = undefined;\n\n\t\tvoid this.triggerChange(false);\n\t}\n\n\tget filterable(): boolean {\n\t\treturn this.filtered || (this.ref1 !== this.ref2 && this.direction === undefined);\n\t}\n\n\tget filtered(): boolean {\n\t\treturn Boolean(this.filter);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst results = await this.getFilesQueryResults();\n\t\tconst files = (this.filtered ? results.filtered?.files : undefined) ?? results.files;\n\t\tif (files == null) return [];\n\n\t\tlet children: FileNode[] = [\n\t\t\t...Iterables.map(\n\t\t\t\tfiles,\n\t\t\t\ts => new ResultsFileNode(this.view, this, this.repoPath, s, this.ref1, this.ref2, this.direction),\n\t\t\t),\n\t\t];\n\n\t\tif (this.view.config.files.layout !== ViewFilesLayout.List) {\n\t\t\tconst hierarchy = Arrays.makeHierarchical(\n\t\t\t\tchildren,\n\t\t\t\tn => n.uri.relativePath.split('/'),\n\t\t\t\t(...parts: string[]) => Strings.normalizePath(paths.join(...parts)),\n\t\t\t\tthis.view.config.files.compact,\n\t\t\t);\n\n\t\t\tconst root = new FolderNode(this.view, this, this.repoPath, '', hierarchy);\n\t\t\tchildren = root.getChildren() as FileNode[];\n\t\t} else {\n\t\t\tchildren.sort(\n\t\t\t\t(a, b) =>\n\t\t\t\t\ta.priority - b.priority ||\n\t\t\t\t\ta.label!.localeCompare(b.label!, undefined, { numeric: true, sensitivity: 'base' }),\n\t\t\t);\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tlet label;\n\t\tlet icon;\n\t\tlet files: GitFile[] | undefined;\n\t\tlet state;\n\n\t\ttry {\n\t\t\tconst results = await Promises.cancellable(this.getFilesQueryResults(), 100);\n\t\t\tlabel = results.label;\n\t\t\tfiles = (this.filtered ? results.filtered?.files : undefined) ?? results.files;\n\n\t\t\tif (this.filtered && results.filtered == null) {\n\t\t\t\tlabel = 'files changed';\n\t\t\t\ticon = new ThemeIcon('ellipsis');\n\t\t\t}\n\n\t\t\tstate =\n\t\t\t\tfiles == null || files.length === 0\n\t\t\t\t\t? TreeItemCollapsibleState.None\n\t\t\t\t\t: this._options.expand\n\t\t\t\t\t? TreeItemCollapsibleState.Expanded\n\t\t\t\t\t: TreeItemCollapsibleState.Collapsed;\n\t\t} catch (ex) {\n\t\t\tif (ex instanceof Promises.CancellationError) {\n\t\t\t\tex.promise.then(() => setTimeout(() => this.triggerChange(false), 0));\n\t\t\t}\n\n\t\t\tlabel = 'files changed';\n\t\t\ticon = new ThemeIcon('ellipsis');\n\t\t\t// Need to use Collapsed before we have results or the item won't show up in the view until the children are awaited\n\t\t\t// https://github.com/microsoft/vscode/issues/54806 & https://github.com/microsoft/vscode/issues/62214\n\t\t\tstate = TreeItemCollapsibleState.Collapsed;\n\t\t}\n\n\t\tconst item = new TreeItem(\n\t\t\t`${this.filtered && files != null ? `Showing ${files.length} of ` : ''}${label}`,\n\t\t\tstate,\n\t\t);\n\t\titem.id = this.id;\n\t\titem.iconPath = icon;\n\t\titem.contextValue = `${ContextValues.ResultsFiles}${this.filterable ? '+filterable' : ''}${\n\t\t\tthis.filtered ? `+filtered~${this.filter}` : ''\n\t\t}`;\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset: boolean = false) {\n\t\tif (!reset) return;\n\n\t\tthis._filterResults = undefined;\n\t\tthis._filesQueryResults = this._filesQuery();\n\t}\n\n\tprivate _filesQueryResults: Promise<FilesQueryResults> | undefined;\n\tprivate _filterResults: Promise<void> | undefined;\n\n\tasync getFilesQueryResults() {\n\t\tif (this._filesQueryResults === undefined) {\n\t\t\tthis._filesQueryResults = this._filesQuery();\n\t\t}\n\n\t\tconst results = await this._filesQueryResults;\n\t\tif (\n\t\t\tresults.files == null ||\n\t\t\t!this.filterable ||\n\t\t\tthis.filter === false ||\n\t\t\tresults.filtered?.filter === this.filter\n\t\t) {\n\t\t\treturn results;\n\t\t}\n\n\t\tif (this._filterResults === undefined) {\n\t\t\tthis._filterResults = this.filterResults(this.filter, results);\n\t\t}\n\n\t\tawait this._filterResults;\n\n\t\treturn results;\n\t}\n\n\tprivate async filterResults(filter: 'left' | 'right', results: FilesQueryResults) {\n\t\tlet filterTo: Set<string> | undefined;\n\n\t\tconst ref = this.filter === 'left' ? this.ref2 : this.ref1;\n\n\t\tconst mergeBase = await Container.git.getMergeBase(this.repoPath, this.ref1 || 'HEAD', this.ref2 || 'HEAD');\n\t\tif (mergeBase != null) {\n\t\t\tconst files = await Container.git.getDiffStatus(this.uri.repoPath!, `${mergeBase}..${ref}`);\n\t\t\tif (files != null) {\n\t\t\t\tfilterTo = new Set<string>(files.map(f => f.fileName));\n\t\t\t}\n\t\t} else {\n\t\t\tconst commit = await Container.git.getCommit(this.uri.repoPath!, ref || 'HEAD');\n\t\t\tif (commit?.files != null) {\n\t\t\t\tfilterTo = new Set<string>(commit.files.map(f => f.fileName));\n\t\t\t}\n\t\t}\n\n\t\tif (filterTo == null) return;\n\n\t\tresults.filtered = {\n\t\t\tfilter: filter,\n\t\t\tfiles: results.files!.filter(f => filterTo!.has(f.fileName)),\n\t\t};\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Container } from '../../container';\nimport { GitLog } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { debug, gate, Iterables, Promises } from '../../system';\nimport { ViewsWithCommits } from '../viewBase';\nimport { CommitNode } from './commitNode';\nimport { LoadMoreNode } from './common';\nimport { insertDateMarkers } from './helpers';\nimport { FilesQueryResults, ResultsFilesNode } from './resultsFilesNode';\nimport { ContextValues, PageableViewNode, ViewNode } from './viewNode';\n\nexport interface CommitsQueryResults {\n\treadonly label: string;\n\treadonly log: GitLog | undefined;\n\treadonly hasMore: boolean;\n\tmore?(limit: number | undefined): Promise<void>;\n}\n\nexport class ResultsCommitsNode<View extends ViewsWithCommits = ViewsWithCommits>\n\textends ViewNode<View>\n\timplements PageableViewNode\n{\n\tconstructor(\n\t\tview: View,\n\t\tparent: ViewNode,\n\t\tpublic readonly repoPath: string,\n\t\tprivate _label: string,\n\t\tprivate readonly _results: {\n\t\t\tquery: (limit: number | undefined) => Promise<CommitsQueryResults>;\n\t\t\tcomparison?: { ref1: string; ref2: string };\n\t\t\tdeferred?: boolean;\n\t\t\tdirection?: 'ahead' | 'behind';\n\t\t\tfiles?: {\n\t\t\t\tref1: string;\n\t\t\t\tref2: string;\n\t\t\t\tquery: () => Promise<FilesQueryResults>;\n\t\t\t};\n\t\t},\n\t\tprivate readonly _options: {\n\t\t\tid?: string;\n\t\t\tdescription?: string;\n\t\t\texpand?: boolean;\n\t\t} = {},\n\t\tsplatted?: boolean,\n\t) {\n\t\tsuper(GitUri.fromRepoPath(repoPath), view, parent);\n\n\t\tif (splatted != null) {\n\t\t\tthis.splatted = splatted;\n\t\t}\n\t\tthis._options = { expand: true, ..._options };\n\t}\n\n\tget ref1(): string | undefined {\n\t\treturn this._results.comparison?.ref1;\n\t}\n\n\tget ref2(): string | undefined {\n\t\treturn this._results.comparison?.ref2;\n\t}\n\n\toverride get id(): string {\n\t\treturn `${this.parent!.id}:results:commits${this._options.id ? `:${this._options.id}` : ''}`;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst { log } = await this.getCommitsQueryResults();\n\t\tif (log == null) return [];\n\n\t\tconst getBranchAndTagTips = await Container.git.getBranchesAndTagsTipsFn(this.uri.repoPath);\n\t\tconst children = [];\n\n\t\tconst { files } = this._results;\n\t\tif (files != null) {\n\t\t\tchildren.push(\n\t\t\t\tnew ResultsFilesNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\tthis.uri.repoPath!,\n\t\t\t\t\tfiles.ref1,\n\t\t\t\t\tfiles.ref2,\n\t\t\t\t\tfiles.query,\n\t\t\t\t\tthis._results.direction,\n\t\t\t\t\t{\n\t\t\t\t\t\texpand: false,\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\tconst options = { expand: this._options.expand && log.count === 1 };\n\n\t\tchildren.push(\n\t\t\t...insertDateMarkers(\n\t\t\t\tIterables.map(\n\t\t\t\t\tlog.commits.values(),\n\t\t\t\t\tc => new CommitNode(this.view, this, c, undefined, undefined, getBranchAndTagTips, options),\n\t\t\t\t),\n\t\t\t\tthis,\n\t\t\t\tundefined,\n\t\t\t\t{ show: log.count > 1 },\n\t\t\t),\n\t\t);\n\n\t\tif (log.hasMore) {\n\t\t\tchildren.push(new LoadMoreNode(this.view, this, children[children.length - 1]));\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tlet label;\n\t\tlet state;\n\n\t\tif (this._results.deferred) {\n\t\t\tlabel = this._label;\n\t\t\tstate = TreeItemCollapsibleState.Collapsed;\n\t\t} else {\n\t\t\ttry {\n\t\t\t\tlet log;\n\t\t\t\t({ label, log } = await Promises.cancellable(this.getCommitsQueryResults(), 100));\n\t\t\t\tstate =\n\t\t\t\t\tlog == null || log.count === 0\n\t\t\t\t\t\t? TreeItemCollapsibleState.None\n\t\t\t\t\t\t: this._options.expand || log.count === 1\n\t\t\t\t\t\t? TreeItemCollapsibleState.Expanded\n\t\t\t\t\t\t: TreeItemCollapsibleState.Collapsed;\n\t\t\t} catch (ex) {\n\t\t\t\tif (ex instanceof Promises.CancellationError) {\n\t\t\t\t\tex.promise.then(() => this.triggerChange(false));\n\t\t\t\t}\n\n\t\t\t\t// Need to use Collapsed before we have results or the item won't show up in the view until the children are awaited\n\t\t\t\t// https://github.com/microsoft/vscode/issues/54806 & https://github.com/microsoft/vscode/issues/62214\n\t\t\t\tstate = TreeItemCollapsibleState.Collapsed;\n\t\t\t}\n\t\t}\n\n\t\tconst item = new TreeItem(label ?? this._label, state);\n\t\titem.id = this.id;\n\t\titem.contextValue =\n\t\t\tthis._results.comparison != null ? ContextValues.CompareResultsCommits : ContextValues.SearchResultsCommits;\n\t\titem.description = this._options.description;\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset: boolean = false) {\n\t\tif (reset) {\n\t\t\tthis._commitsQueryResults = undefined;\n\t\t\tvoid this.getCommitsQueryResults();\n\t\t}\n\t}\n\n\tprivate _commitsQueryResults: Promise<CommitsQueryResults> | undefined;\n\tprivate async getCommitsQueryResults() {\n\t\tif (this._commitsQueryResults == null) {\n\t\t\tthis._commitsQueryResults = this._results.query(this.limit ?? Container.config.advanced.maxSearchItems);\n\t\t\tconst results = await this._commitsQueryResults;\n\t\t\tthis._hasMore = results.hasMore;\n\n\t\t\tif (this._results.deferred) {\n\t\t\t\tthis._results.deferred = false;\n\n\t\t\t\tvoid this.triggerChange(false);\n\t\t\t}\n\t\t}\n\n\t\treturn this._commitsQueryResults;\n\t}\n\n\tprivate _hasMore = true;\n\tget hasMore() {\n\t\treturn this._hasMore;\n\t}\n\n\tlimit: number | undefined = this.view.getNodeLastKnownLimit(this);\n\tasync loadMore(limit?: number) {\n\t\tconst results = await this.getCommitsQueryResults();\n\t\tif (results == null || !results.hasMore) return;\n\n\t\tawait results.more?.(limit ?? this.view.config.pageItemLimit);\n\n\t\tthis.limit = results.log?.count;\n\n\t\tvoid this.triggerChange(false);\n\t}\n}\n","'use strict';\nimport { ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { ViewShowBranchComparison } from '../../configuration';\nimport { BranchComparison, BranchComparisons, GlyphChars, WorkspaceState } from '../../constants';\nimport { Container } from '../../container';\nimport { GitBranch, GitRevision } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { CommandQuickPickItem, ReferencePicker } from '../../quickpicks';\nimport { debug, gate, log, Strings } from '../../system';\nimport { BranchesView } from '../branchesView';\nimport { CommitsView } from '../commitsView';\nimport { RepositoriesView } from '../repositoriesView';\nimport { RepositoryNode } from './repositoryNode';\nimport { CommitsQueryResults, ResultsCommitsNode } from './resultsCommitsNode';\nimport { FilesQueryResults, ResultsFilesNode } from './resultsFilesNode';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport class CompareBranchNode extends ViewNode<BranchesView | CommitsView | RepositoriesView> {\n\tstatic key = ':compare-branch';\n\tstatic getId(repoPath: string, name: string, root: boolean): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${name})${root ? ':root' : ''}`;\n\t}\n\n\tprivate _children: ViewNode[] | undefined;\n\tprivate _compareWith: BranchComparison | undefined;\n\n\tconstructor(\n\t\turi: GitUri,\n\t\tview: BranchesView | CommitsView | RepositoriesView,\n\t\tparent: ViewNode,\n\t\tpublic readonly branch: GitBranch,\n\t\tprivate showComparison: ViewShowBranchComparison,\n\t\t// Specifies that the node is shown as a root\n\t\tpublic readonly root: boolean = false,\n\t) {\n\t\tsuper(uri, view, parent);\n\n\t\tthis.loadCompareWith();\n\t}\n\n\tget ahead(): { readonly ref1: string; readonly ref2: string } {\n\t\treturn {\n\t\t\tref1: this._compareWith?.ref || 'HEAD',\n\t\t\tref2: this.branch.ref,\n\t\t};\n\t}\n\n\tget behind(): { readonly ref1: string; readonly ref2: string } {\n\t\treturn {\n\t\t\tref1: this.branch.ref,\n\t\t\tref2: this._compareWith?.ref || 'HEAD',\n\t\t};\n\t}\n\n\toverride get id(): string {\n\t\treturn CompareBranchNode.getId(this.branch.repoPath, this.branch.name, this.root);\n\t}\n\n\tget repoPath(): string {\n\t\treturn this.branch.repoPath;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._compareWith == null) return [];\n\n\t\tif (this._children == null) {\n\t\t\tconst ahead = this.ahead;\n\t\t\tconst behind = this.behind;\n\n\t\t\tconst aheadBehindCounts = await Container.git.getAheadBehindCommitCount(this.branch.repoPath, [\n\t\t\t\tGitRevision.createRange(behind.ref1, behind.ref2, '...'),\n\t\t\t]);\n\t\t\tconst mergeBase =\n\t\t\t\t(await Container.git.getMergeBase(this.repoPath, behind.ref1, behind.ref2, { forkPoint: true })) ??\n\t\t\t\t(await Container.git.getMergeBase(this.repoPath, behind.ref1, behind.ref2));\n\n\t\t\tthis._children = [\n\t\t\t\tnew ResultsCommitsNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\tthis.uri.repoPath!,\n\t\t\t\t\t'Behind',\n\t\t\t\t\t{\n\t\t\t\t\t\tquery: this.getCommitsQuery(GitRevision.createRange(behind.ref1, behind.ref2, '..')),\n\t\t\t\t\t\tcomparison: behind,\n\t\t\t\t\t\tdirection: 'behind',\n\t\t\t\t\t\tfiles: {\n\t\t\t\t\t\t\tref1: this.compareWithWorkingTree ? '' : mergeBase ?? behind.ref1,\n\t\t\t\t\t\t\tref2: behind.ref2,\n\t\t\t\t\t\t\tquery: this.getBehindFilesQuery.bind(this),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'behind',\n\t\t\t\t\t\tdescription: Strings.pluralize('commit', aheadBehindCounts?.behind ?? 0),\n\t\t\t\t\t\texpand: false,\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t\tnew ResultsCommitsNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\tthis.uri.repoPath!,\n\t\t\t\t\t'Ahead',\n\t\t\t\t\t{\n\t\t\t\t\t\tquery: this.getCommitsQuery(\n\t\t\t\t\t\t\tGitRevision.createRange(ahead.ref1, this.compareWithWorkingTree ? '' : ahead.ref2, '..'),\n\t\t\t\t\t\t),\n\t\t\t\t\t\tcomparison: ahead,\n\t\t\t\t\t\tdirection: 'ahead',\n\t\t\t\t\t\tfiles: {\n\t\t\t\t\t\t\tref1: mergeBase ?? ahead.ref1,\n\t\t\t\t\t\t\tref2: this.compareWithWorkingTree ? '' : ahead.ref2,\n\t\t\t\t\t\t\tquery: this.getAheadFilesQuery.bind(this),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'ahead',\n\t\t\t\t\t\tdescription: Strings.pluralize('commit', aheadBehindCounts?.ahead ?? 0),\n\t\t\t\t\t\texpand: false,\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t\tnew ResultsFilesNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\tthis.uri.repoPath!,\n\t\t\t\t\tthis._compareWith.ref || 'HEAD',\n\t\t\t\t\tthis.compareWithWorkingTree ? '' : this.branch.ref,\n\t\t\t\t\tthis.getFilesQuery.bind(this),\n\t\t\t\t\tundefined,\n\t\t\t\t\t{\n\t\t\t\t\t\texpand: false,\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t];\n\t\t}\n\t\treturn this._children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tlet state: TreeItemCollapsibleState;\n\t\tlet label;\n\t\tlet tooltip;\n\t\tif (this._compareWith == null) {\n\t\t\tlabel = `Compare ${\n\t\t\t\tthis.compareWithWorkingTree ? 'Working Tree' : this.branch.name\n\t\t\t} with <branch, tag, or ref>`;\n\t\t\tstate = TreeItemCollapsibleState.None;\n\t\t\ttooltip = `Click to compare ${\n\t\t\t\tthis.compareWithWorkingTree ? 'Working Tree' : this.branch.name\n\t\t\t} with a branch, tag, or ref`;\n\t\t} else {\n\t\t\tlabel = `Compare ${\n\t\t\t\tthis.compareWithWorkingTree ? 'Working Tree' : this.branch.name\n\t\t\t} with ${GitRevision.shorten(this._compareWith.ref, {\n\t\t\t\tstrings: { working: 'Working Tree' },\n\t\t\t})}`;\n\t\t\tstate = TreeItemCollapsibleState.Collapsed;\n\t\t}\n\n\t\tconst item = new TreeItem(label, state);\n\t\titem.id = this.id;\n\t\titem.contextValue = `${ContextValues.CompareBranch}${this.branch.current ? '+current' : ''}+${\n\t\t\tthis.comparisonType\n\t\t}${this._compareWith == null ? '' : '+comparing'}${this.root ? '+root' : ''}`;\n\n\t\tif (this._compareWith == null) {\n\t\t\titem.command = {\n\t\t\t\ttitle: `Compare ${this.branch.name}${this.compareWithWorkingTree ? ' (working)' : ''} with${\n\t\t\t\t\tGlyphChars.Ellipsis\n\t\t\t\t}`,\n\t\t\t\tcommand: 'gitlens.views.editNode',\n\t\t\t\targuments: [this],\n\t\t\t};\n\t\t}\n\n\t\titem.iconPath = new ThemeIcon('git-compare');\n\t\titem.tooltip = tooltip;\n\n\t\treturn item;\n\t}\n\n\t@log()\n\tasync clear() {\n\t\tif (this._compareWith == null) return;\n\n\t\tthis._compareWith = undefined;\n\t\tawait this.updateCompareWith(undefined);\n\n\t\tthis._children = undefined;\n\t\tthis.view.triggerNodeChange(this);\n\t}\n\n\t@log()\n\tasync edit() {\n\t\tawait this.compareWith();\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh() {\n\t\tthis._children = undefined;\n\t\tthis.loadCompareWith();\n\t}\n\n\t@log()\n\tasync setComparisonType(comparisonType: Exclude<ViewShowBranchComparison, false>) {\n\t\tif (this._compareWith != null) {\n\t\t\tawait this.updateCompareWith({ ...this._compareWith, type: comparisonType });\n\t\t} else {\n\t\t\tthis.showComparison = comparisonType;\n\t\t}\n\n\t\tthis._children = undefined;\n\t\tthis.view.triggerNodeChange(this);\n\t}\n\n\tprivate get comparisonType() {\n\t\treturn this._compareWith?.type ?? this.showComparison;\n\t}\n\n\tprivate get compareWithWorkingTree() {\n\t\treturn this.comparisonType === ViewShowBranchComparison.Working;\n\t}\n\n\tprivate async compareWith() {\n\t\tconst pick = await ReferencePicker.show(\n\t\t\tthis.branch.repoPath,\n\t\t\t`Compare ${this.branch.name}${this.compareWithWorkingTree ? ' (working)' : ''} with`,\n\t\t\t'Choose a reference to compare with',\n\t\t\t{\n\t\t\t\tallowEnteringRefs: true,\n\t\t\t\tpicked: this.branch.ref,\n\t\t\t\t// checkmarks: true,\n\t\t\t\tsort: { branches: { current: true }, tags: {} },\n\t\t\t},\n\t\t);\n\t\tif (pick == null || pick instanceof CommandQuickPickItem) return;\n\n\t\tawait this.updateCompareWith({\n\t\t\tref: pick.ref,\n\t\t\tnotation: undefined,\n\t\t\ttype: this.comparisonType,\n\t\t});\n\n\t\tthis._children = undefined;\n\t\tthis.view.triggerNodeChange(this);\n\t}\n\n\tprivate async getAheadFilesQuery(): Promise<FilesQueryResults> {\n\t\tlet files = await Container.git.getDiffStatus(\n\t\t\tthis.repoPath,\n\t\t\tGitRevision.createRange(this._compareWith?.ref || 'HEAD', this.branch.ref || 'HEAD', '...'),\n\t\t);\n\n\t\tif (this.compareWithWorkingTree) {\n\t\t\tconst workingFiles = await Container.git.getDiffStatus(this.repoPath, 'HEAD');\n\t\t\tif (workingFiles != null) {\n\t\t\t\tif (files != null) {\n\t\t\t\t\tfor (const wf of workingFiles) {\n\t\t\t\t\t\tconst index = files.findIndex(f => f.fileName === wf.fileName);\n\t\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\t\tfiles.splice(index, 1, wf);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfiles.push(wf);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfiles = workingFiles;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tlabel: `${Strings.pluralize('file', files?.length ?? 0, { zero: 'No' })} changed`,\n\t\t\tfiles: files,\n\t\t};\n\t}\n\n\tprivate async getBehindFilesQuery(): Promise<FilesQueryResults> {\n\t\tconst files = await Container.git.getDiffStatus(\n\t\t\tthis.uri.repoPath!,\n\t\t\tGitRevision.createRange(this.branch.ref, this._compareWith?.ref || 'HEAD', '...'),\n\t\t);\n\n\t\treturn {\n\t\t\tlabel: `${Strings.pluralize('file', files?.length ?? 0, { zero: 'No' })} changed`,\n\t\t\tfiles: files,\n\t\t};\n\t}\n\n\tprivate getCommitsQuery(range: string): (limit: number | undefined) => Promise<CommitsQueryResults> {\n\t\tconst repoPath = this.uri.repoPath!;\n\t\treturn async (limit: number | undefined) => {\n\t\t\tconst log = await Container.git.getLog(repoPath, {\n\t\t\t\tlimit: limit,\n\t\t\t\tref: range,\n\t\t\t});\n\n\t\t\tconst results: Mutable<Partial<CommitsQueryResults>> = {\n\t\t\t\tlog: log,\n\t\t\t\thasMore: log?.hasMore ?? true,\n\t\t\t};\n\t\t\tif (results.hasMore) {\n\t\t\t\tresults.more = async (limit: number | undefined) => {\n\t\t\t\t\tresults.log = (await results.log?.more?.(limit)) ?? results.log;\n\t\t\t\t\tresults.hasMore = results.log?.hasMore ?? true;\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn results as CommitsQueryResults;\n\t\t};\n\t}\n\n\tprivate async getFilesQuery(): Promise<FilesQueryResults> {\n\t\tlet comparison;\n\t\tif (this._compareWith!.ref === '') {\n\t\t\tcomparison = this.branch.ref;\n\t\t} else if (this.compareWithWorkingTree) {\n\t\t\tcomparison = this._compareWith!.ref;\n\t\t} else {\n\t\t\tcomparison = `${this._compareWith!.ref}..${this.branch.ref}`;\n\t\t}\n\n\t\tconst files = await Container.git.getDiffStatus(this.uri.repoPath!, comparison);\n\n\t\treturn {\n\t\t\tlabel: `${Strings.pluralize('file', files?.length ?? 0, { zero: 'No' })} changed`,\n\t\t\tfiles: files,\n\t\t};\n\t}\n\n\tprivate loadCompareWith() {\n\t\tconst comparisons = Container.context.workspaceState.get<BranchComparisons>(WorkspaceState.BranchComparisons);\n\n\t\tconst id = `${this.branch.id}${this.branch.current ? '+current' : ''}`;\n\t\tconst compareWith = comparisons?.[id];\n\t\tif (compareWith != null && typeof compareWith === 'string') {\n\t\t\tthis._compareWith = {\n\t\t\t\tref: compareWith,\n\t\t\t\tnotation: undefined,\n\t\t\t\ttype: this.showComparison,\n\t\t\t};\n\t\t} else {\n\t\t\tthis._compareWith = compareWith;\n\t\t}\n\t}\n\n\tprivate async updateCompareWith(compareWith: BranchComparison | undefined) {\n\t\tthis._compareWith = compareWith;\n\n\t\tlet comparisons = Container.context.workspaceState.get<BranchComparisons>(WorkspaceState.BranchComparisons);\n\t\tif (comparisons == null) {\n\t\t\tcomparisons = Object.create(null) as BranchComparisons;\n\t\t}\n\n\t\tconst id = `${this.branch.id}${this.branch.current ? '+current' : ''}`;\n\n\t\tif (compareWith != null) {\n\t\t\tcomparisons[id] = { ...compareWith };\n\t\t} else {\n\t\t\tconst { [id]: _, ...rest } = comparisons;\n\t\t\tcomparisons = rest;\n\t\t}\n\t\tawait Container.context.workspaceState.update(WorkspaceState.BranchComparisons, comparisons);\n\t}\n}\n","'use strict';\nimport { MarkdownString, TreeItem, TreeItemCollapsibleState, window } from 'vscode';\nimport { getPresenceDataUri } from '../../avatars';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { GitContributor, GitLog } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { debug, gate, Iterables, Strings } from '../../system';\nimport { ContactPresence } from '../../vsls/vsls';\nimport { ContributorsView } from '../contributorsView';\nimport { RepositoriesView } from '../repositoriesView';\nimport { CommitNode } from './commitNode';\nimport { LoadMoreNode, MessageNode } from './common';\nimport { insertDateMarkers } from './helpers';\nimport { RepositoryNode } from './repositoryNode';\nimport { ContextValues, PageableViewNode, ViewNode } from './viewNode';\n\nexport class ContributorNode extends ViewNode<ContributorsView | RepositoriesView> implements PageableViewNode {\n\tstatic key = ':contributor';\n\tstatic getId(repoPath: string, name: string, email: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${name}|${email})`;\n\t}\n\n\tconstructor(\n\t\turi: GitUri,\n\t\tview: ContributorsView | RepositoriesView,\n\t\tparent: ViewNode,\n\t\tpublic readonly contributor: GitContributor,\n\t\tprivate readonly _options?: {\n\t\t\tall?: boolean;\n\t\t\tref?: string;\n\t\t\tpresence: Map<string, ContactPresence> | undefined;\n\t\t},\n\t) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\toverride toClipboard(): string {\n\t\treturn `${this.contributor.name}${this.contributor.email ? ` <${this.contributor.email}>` : ''}`;\n\t}\n\n\toverride get id(): string {\n\t\treturn ContributorNode.getId(this.contributor.repoPath, this.contributor.name, this.contributor.email);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst log = await this.getLog();\n\t\tif (log == null) return [new MessageNode(this.view, this, 'No commits could be found.')];\n\n\t\tconst getBranchAndTagTips = await Container.git.getBranchesAndTagsTipsFn(this.uri.repoPath);\n\t\tconst children = [\n\t\t\t...insertDateMarkers(\n\t\t\t\tIterables.map(\n\t\t\t\t\tlog.commits.values(),\n\t\t\t\t\tc => new CommitNode(this.view, this, c, undefined, undefined, getBranchAndTagTips),\n\t\t\t\t),\n\t\t\t\tthis,\n\t\t\t),\n\t\t];\n\n\t\tif (log.hasMore) {\n\t\t\tchildren.push(new LoadMoreNode(this.view, this, children[children.length - 1]));\n\t\t}\n\t\treturn children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tconst presence = this._options?.presence?.get(this.contributor.email);\n\n\t\tconst item = new TreeItem(\n\t\t\tthis.contributor.current ? `${this.contributor.name} (you)` : this.contributor.name,\n\t\t\tTreeItemCollapsibleState.Collapsed,\n\t\t);\n\t\titem.id = this.id;\n\t\titem.contextValue = this.contributor.current\n\t\t\t? `${ContextValues.Contributor}+current`\n\t\t\t: ContextValues.Contributor;\n\t\titem.description = `${\n\t\t\tpresence != null && presence.status !== 'offline'\n\t\t\t\t? `${presence.statusText} ${GlyphChars.Space}${GlyphChars.Dot}${GlyphChars.Space} `\n\t\t\t\t: ''\n\t\t}${this.contributor.email}`;\n\n\t\tlet avatarUri;\n\t\tlet avatarMarkdown;\n\t\tif (this.view.config.avatars) {\n\t\t\tconst size = Container.config.hovers.avatarSize;\n\t\t\tavatarUri = await this.contributor.getAvatarUri({\n\t\t\t\tdefaultStyle: Container.config.defaultGravatarsStyle,\n\t\t\t\tsize: size,\n\t\t\t});\n\n\t\t\tif (presence != null) {\n\t\t\t\tconst title = `${this.contributor.count ? 'You are' : `${this.contributor.name} is`} ${\n\t\t\t\t\tpresence.status === 'dnd' ? 'in ' : ''\n\t\t\t\t}${presence.statusText.toLocaleLowerCase()}`;\n\n\t\t\t\tavatarMarkdown = `![${title}](${avatarUri.toString(\n\t\t\t\t\ttrue,\n\t\t\t\t)}|width=${size},height=${size} \"${title}\")![${title}](${getPresenceDataUri(\n\t\t\t\t\tpresence.status,\n\t\t\t\t)} \"${title}\")`;\n\t\t\t} else {\n\t\t\t\tavatarMarkdown = `![${this.contributor.name}](${avatarUri.toString(\n\t\t\t\t\ttrue,\n\t\t\t\t)}|width=${size},height=${size} \"${this.contributor.name}\")`;\n\t\t\t}\n\t\t}\n\n\t\tconst numberFormatter = new Intl.NumberFormat();\n\n\t\tconst stats =\n\t\t\tthis.contributor.stats != null\n\t\t\t\t? `\\\\\\n${Strings.pluralize('file', this.contributor.stats.files, {\n\t\t\t\t\t\tnumber: numberFormatter.format(this.contributor.stats.files),\n\t\t\t\t  })} changed, ${Strings.pluralize('addition', this.contributor.stats.additions, {\n\t\t\t\t\t\tnumber: numberFormatter.format(this.contributor.stats.additions),\n\t\t\t\t  })}, ${Strings.pluralize('deletion', this.contributor.stats.deletions, {\n\t\t\t\t\t\tnumber: numberFormatter.format(this.contributor.stats.deletions),\n\t\t\t\t  })}`\n\t\t\t\t: '';\n\n\t\titem.tooltip = new MarkdownString(\n\t\t\t`${avatarMarkdown != null ? avatarMarkdown : ''} &nbsp;__[${this.contributor.name}](mailto:${\n\t\t\t\tthis.contributor.email\n\t\t\t} \"Email ${this.contributor.name} (${\n\t\t\t\tthis.contributor.email\n\t\t\t})\")__ \\\\\\nLast commit ${this.contributor.formatDateFromNow()} (${this.contributor.formatDate()})\\n\\n${Strings.pluralize(\n\t\t\t\t'commit',\n\t\t\t\tthis.contributor.count,\n\t\t\t\t{ number: numberFormatter.format(this.contributor.count) },\n\t\t\t)}${stats}`,\n\t\t);\n\n\t\titem.iconPath = avatarUri;\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset?: boolean) {\n\t\tif (reset) {\n\t\t\tthis._log = undefined;\n\t\t}\n\t}\n\n\tprivate _log: GitLog | undefined;\n\tprivate async getLog() {\n\t\tif (this._log == null) {\n\t\t\tthis._log = await Container.git.getLog(this.uri.repoPath!, {\n\t\t\t\tall: this._options?.all,\n\t\t\t\tref: this._options?.ref,\n\t\t\t\tlimit: this.limit ?? this.view.config.defaultItemLimit,\n\t\t\t\tauthors: [`^${this.contributor.name} <${this.contributor.email}>$`],\n\t\t\t});\n\t\t}\n\n\t\treturn this._log;\n\t}\n\n\tget hasMore() {\n\t\treturn this._log?.hasMore ?? true;\n\t}\n\n\tlimit: number | undefined = this.view.getNodeLastKnownLimit(this);\n\t@gate()\n\tasync loadMore(limit?: number | { until?: any }) {\n\t\tlet log = await window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: { viewId: this.view.id },\n\t\t\t},\n\t\t\t() => this.getLog(),\n\t\t);\n\t\tif (log == null || !log.hasMore) return;\n\n\t\tlog = await log.more?.(limit ?? this.view.config.pageItemLimit);\n\t\tif (this._log === log) return;\n\n\t\tthis._log = log;\n\t\tthis.limit = log?.count;\n\n\t\tvoid this.triggerChange(false);\n\t}\n}\n","'use strict';\nimport { ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Container } from '../../container';\nimport { GitContributor, Repository } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { debug, gate, timeout } from '../../system';\nimport { ContributorsView } from '../contributorsView';\nimport { RepositoriesView } from '../repositoriesView';\nimport { MessageNode } from './common';\nimport { ContributorNode } from './contributorNode';\nimport { RepositoryNode } from './repositoryNode';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport class ContributorsNode extends ViewNode<ContributorsView | RepositoriesView> {\n\tstatic key = ':contributors';\n\tstatic getId(repoPath: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}`;\n\t}\n\n\tprotected override splatted = true;\n\n\tprivate _children: ContributorNode[] | undefined;\n\n\tconstructor(\n\t\turi: GitUri,\n\t\tview: ContributorsView | RepositoriesView,\n\t\tparent: ViewNode,\n\t\tpublic readonly repo: Repository,\n\t) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\toverride get id(): string {\n\t\treturn ContributorsNode.getId(this.repo.path);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._children == null) {\n\t\t\tconst all = Container.config.views.contributors.showAllBranches;\n\n\t\t\tlet ref: string | undefined;\n\t\t\t// If we aren't getting all branches, get the upstream of the current branch if there is one\n\t\t\tif (!all) {\n\t\t\t\ttry {\n\t\t\t\t\tconst branch = await Container.git.getBranch(this.uri.repoPath);\n\t\t\t\t\tif (branch?.upstream?.name != null && !branch.upstream.missing) {\n\t\t\t\t\t\tref = '@{u}';\n\t\t\t\t\t}\n\t\t\t\t} catch {}\n\t\t\t}\n\n\t\t\tconst stats = Container.config.views.contributors.showStatistics;\n\n\t\t\tconst contributors = await this.repo.getContributors({ all: all, ref: ref, stats: stats });\n\t\t\tif (contributors.length === 0) return [new MessageNode(this.view, this, 'No contributors could be found.')];\n\n\t\t\tGitContributor.sort(contributors);\n\t\t\tconst presenceMap = await this.maybeGetPresenceMap(contributors);\n\n\t\t\tthis._children = contributors.map(\n\t\t\t\tc => new ContributorNode(this.uri, this.view, this, c, { all: all, ref: ref, presence: presenceMap }),\n\t\t\t);\n\t\t}\n\n\t\treturn this._children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tthis.splatted = false;\n\n\t\tconst item = new TreeItem('Contributors', TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\titem.contextValue = ContextValues.Contributors;\n\t\titem.iconPath = new ThemeIcon('organization');\n\t\treturn item;\n\t}\n\n\tupdateAvatar(email: string) {\n\t\tif (this._children == null) return;\n\n\t\tfor (const child of this._children) {\n\t\t\tif (child.contributor.email === email) {\n\t\t\t\tvoid child.triggerChange();\n\t\t\t}\n\t\t}\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh() {\n\t\tthis._children = undefined;\n\t}\n\n\t@debug({ args: false })\n\t@timeout(250)\n\tprivate async maybeGetPresenceMap(contributors: GitContributor[]) {\n\t\t// Only get presence for the current user, because it is far too slow otherwise\n\t\tconst email = contributors.find(c => c.current)?.email;\n\t\tif (email == null) return undefined;\n\n\t\treturn Container.vsls.getContactsPresence([email]);\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { Command, ThemeIcon, TreeItem, TreeItemCollapsibleState, Uri } from 'vscode';\nimport { BuiltInCommands } from '../../constants';\nimport { GitFile, GitMergeStatus, GitRebaseStatus, StatusFileFormatter } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { ViewsWithCommits } from '../viewBase';\nimport { FileNode } from './folderNode';\nimport { MergeConflictCurrentChangesNode } from './mergeConflictCurrentChangesNode';\nimport { MergeConflictIncomingChangesNode } from './mergeConflictIncomingChangesNode';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport class MergeConflictFileNode extends ViewNode<ViewsWithCommits> implements FileNode {\n\tconstructor(\n\t\tview: ViewsWithCommits,\n\t\tparent: ViewNode,\n\t\tpublic readonly status: GitMergeStatus | GitRebaseStatus,\n\t\tpublic readonly file: GitFile,\n\t) {\n\t\tsuper(GitUri.fromFile(file, status.repoPath, status.HEAD.ref), view, parent);\n\t}\n\n\toverride toClipboard(): string {\n\t\treturn this.fileName;\n\t}\n\n\tget baseUri(): Uri {\n\t\treturn GitUri.fromFile(this.file, this.status.repoPath, this.status.mergeBase ?? 'HEAD');\n\t}\n\n\tget fileName(): string {\n\t\treturn this.file.fileName;\n\t}\n\n\tget repoPath(): string {\n\t\treturn this.status.repoPath;\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\treturn [\n\t\t\tnew MergeConflictCurrentChangesNode(this.view, this, this.status, this.file),\n\t\t\tnew MergeConflictIncomingChangesNode(this.view, this, this.status, this.file),\n\t\t];\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(this.label, TreeItemCollapsibleState.Collapsed);\n\t\titem.description = this.description;\n\t\titem.contextValue = `${ContextValues.File}+conflicted`;\n\t\titem.tooltip = StatusFileFormatter.fromTemplate(\n\t\t\t`\\${file}\\n\\${directory}/\\n\\n\\${status}\\${ (originalPath)} in Index (staged)`,\n\t\t\tthis.file,\n\t\t);\n\t\t// Use the file icon and decorations\n\t\titem.resourceUri = GitUri.resolveToUri(this.file.fileName, this.repoPath);\n\t\titem.iconPath = ThemeIcon.File;\n\t\titem.command = this.getCommand();\n\n\t\t// Only cache the label/description for a single refresh\n\t\tthis._label = undefined;\n\t\tthis._description = undefined;\n\n\t\treturn item;\n\t}\n\n\tprivate _description: string | undefined;\n\tget description() {\n\t\tif (this._description == null) {\n\t\t\tthis._description = StatusFileFormatter.fromTemplate(\n\t\t\t\tthis.view.config.formats.files.description,\n\t\t\t\tthis.file,\n\t\t\t\t{\n\t\t\t\t\trelativePath: this.relativePath,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t\treturn this._description;\n\t}\n\n\tprivate _folderName: string | undefined;\n\tget folderName() {\n\t\tif (this._folderName == null) {\n\t\t\tthis._folderName = paths.dirname(this.uri.relativePath);\n\t\t}\n\t\treturn this._folderName;\n\t}\n\n\tprivate _label: string | undefined;\n\tget label() {\n\t\tif (this._label == null) {\n\t\t\tthis._label = StatusFileFormatter.fromTemplate(this.view.config.formats.files.label, this.file, {\n\t\t\t\trelativePath: this.relativePath,\n\t\t\t});\n\t\t}\n\t\treturn this._label;\n\t}\n\n\tget priority(): number {\n\t\treturn 0;\n\t}\n\n\tprivate _relativePath: string | undefined;\n\tget relativePath(): string | undefined {\n\t\treturn this._relativePath;\n\t}\n\tset relativePath(value: string | undefined) {\n\t\tthis._relativePath = value;\n\t\tthis._label = undefined;\n\t\tthis._description = undefined;\n\t}\n\n\toverride getCommand(): Command | undefined {\n\t\treturn {\n\t\t\ttitle: 'Open File',\n\t\t\tcommand: BuiltInCommands.Open,\n\t\t\targuments: [\n\t\t\t\tGitUri.resolveToUri(this.file.fileName, this.repoPath),\n\t\t\t\t{\n\t\t\t\t\tpreserveFocus: true,\n\t\t\t\t\tpreview: true,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { MarkdownString, ThemeColor, ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { ViewFilesLayout } from '../../configuration';\nimport { GitBranch, GitMergeStatus, GitReference, GitStatus } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { Arrays, Strings } from '../../system';\nimport { ViewsWithCommits } from '../viewBase';\nimport { BranchNode } from './branchNode';\nimport { FileNode, FolderNode } from './folderNode';\nimport { MergeConflictFileNode } from './mergeConflictFileNode';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport class MergeStatusNode extends ViewNode<ViewsWithCommits> {\n\tstatic key = ':merge';\n\tstatic getId(repoPath: string, name: string, root: boolean): string {\n\t\treturn `${BranchNode.getId(repoPath, name, root)}${this.key}`;\n\t}\n\n\tconstructor(\n\t\tview: ViewsWithCommits,\n\t\tparent: ViewNode,\n\t\tpublic readonly branch: GitBranch,\n\t\tpublic readonly mergeStatus: GitMergeStatus,\n\t\tpublic readonly status: GitStatus | undefined,\n\t\t// Specifies that the node is shown as a root\n\t\tpublic readonly root: boolean,\n\t) {\n\t\tsuper(GitUri.fromRepoPath(mergeStatus.repoPath), view, parent);\n\t}\n\n\toverride get id(): string {\n\t\treturn MergeStatusNode.getId(this.mergeStatus.repoPath, this.mergeStatus.current.name, this.root);\n\t}\n\n\tget repoPath(): string {\n\t\treturn this.uri.repoPath!;\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\tif (this.status?.hasConflicts !== true) return [];\n\n\t\tlet children: FileNode[] = this.status.conflicts.map(\n\t\t\tf => new MergeConflictFileNode(this.view, this, this.mergeStatus, f),\n\t\t);\n\n\t\tif (this.view.config.files.layout !== ViewFilesLayout.List) {\n\t\t\tconst hierarchy = Arrays.makeHierarchical(\n\t\t\t\tchildren,\n\t\t\t\tn => n.uri.relativePath.split('/'),\n\t\t\t\t(...parts: string[]) => Strings.normalizePath(paths.join(...parts)),\n\t\t\t\tthis.view.config.files.compact,\n\t\t\t);\n\n\t\t\tconst root = new FolderNode(this.view, this, this.repoPath, '', hierarchy);\n\t\t\tchildren = root.getChildren() as FileNode[];\n\t\t} else {\n\t\t\tchildren.sort((a, b) =>\n\t\t\t\ta.label!.localeCompare(b.label!, undefined, { numeric: true, sensitivity: 'base' }),\n\t\t\t);\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(\n\t\t\t`${this.status?.hasConflicts ? 'Resolve conflicts before merging' : 'Merging'} ${\n\t\t\t\tthis.mergeStatus.incoming != null\n\t\t\t\t\t? `${GitReference.toString(this.mergeStatus.incoming, { expand: false, icon: false })} `\n\t\t\t\t\t: ''\n\t\t\t}into ${GitReference.toString(this.mergeStatus.current, { expand: false, icon: false })}`,\n\t\t\tTreeItemCollapsibleState.Expanded,\n\t\t);\n\t\titem.id = this.id;\n\t\titem.contextValue = ContextValues.Merge;\n\t\titem.description = this.status?.hasConflicts\n\t\t\t? Strings.pluralize('conflict', this.status.conflicts.length)\n\t\t\t: undefined;\n\t\titem.iconPath = this.status?.hasConflicts\n\t\t\t? new ThemeIcon('warning', new ThemeColor('list.warningForeground'))\n\t\t\t: new ThemeIcon('debug-pause', new ThemeColor('list.foreground'));\n\t\titem.tooltip = new MarkdownString(\n\t\t\t`${`Merging ${\n\t\t\t\tthis.mergeStatus.incoming != null ? GitReference.toString(this.mergeStatus.incoming) : ''\n\t\t\t}into ${GitReference.toString(this.mergeStatus.current)}`}${\n\t\t\t\tthis.status?.hasConflicts\n\t\t\t\t\t? `\\n\\n${Strings.pluralize('conflicted file', this.status.conflicts.length)}`\n\t\t\t\t\t: ''\n\t\t\t}`,\n\t\t\ttrue,\n\t\t);\n\n\t\treturn item;\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport {\n\tCommand,\n\tcommands,\n\tMarkdownString,\n\tThemeColor,\n\tThemeIcon,\n\tTreeItem,\n\tTreeItemCollapsibleState,\n\tUri,\n} from 'vscode';\nimport { Commands, DiffWithPreviousCommandArgs } from '../../commands';\nimport { ViewFilesLayout } from '../../configuration';\nimport { BuiltInCommands, GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport {\n\tCommitFormatter,\n\tGitBranch,\n\tGitLogCommit,\n\tGitRebaseStatus,\n\tGitReference,\n\tGitRevisionReference,\n\tGitStatus,\n} from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { Arrays, Strings } from '../../system';\nimport { ViewsWithCommits } from '../viewBase';\nimport { BranchNode } from './branchNode';\nimport { CommitFileNode } from './commitFileNode';\nimport { FileNode, FolderNode } from './folderNode';\nimport { MergeConflictFileNode } from './mergeConflictFileNode';\nimport { ContextValues, ViewNode, ViewRefNode } from './viewNode';\n\nexport class RebaseStatusNode extends ViewNode<ViewsWithCommits> {\n\tstatic key = ':rebase';\n\tstatic getId(repoPath: string, name: string, root: boolean): string {\n\t\treturn `${BranchNode.getId(repoPath, name, root)}${this.key}`;\n\t}\n\n\tconstructor(\n\t\tview: ViewsWithCommits,\n\t\tparent: ViewNode,\n\t\tpublic readonly branch: GitBranch,\n\t\tpublic readonly rebaseStatus: GitRebaseStatus,\n\t\tpublic readonly status: GitStatus | undefined,\n\t\t// Specifies that the node is shown as a root\n\t\tpublic readonly root: boolean,\n\t) {\n\t\tsuper(GitUri.fromRepoPath(rebaseStatus.repoPath), view, parent);\n\t}\n\n\toverride get id(): string {\n\t\treturn RebaseStatusNode.getId(this.rebaseStatus.repoPath, this.rebaseStatus.incoming.name, this.root);\n\t}\n\n\tget repoPath(): string {\n\t\treturn this.uri.repoPath!;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tlet children: FileNode[] =\n\t\t\tthis.status?.conflicts.map(f => new MergeConflictFileNode(this.view, this, this.rebaseStatus, f)) ?? [];\n\n\t\tif (this.view.config.files.layout !== ViewFilesLayout.List) {\n\t\t\tconst hierarchy = Arrays.makeHierarchical(\n\t\t\t\tchildren,\n\t\t\t\tn => n.uri.relativePath.split('/'),\n\t\t\t\t(...parts: string[]) => Strings.normalizePath(paths.join(...parts)),\n\t\t\t\tthis.view.config.files.compact,\n\t\t\t);\n\n\t\t\tconst root = new FolderNode(this.view, this, this.repoPath, '', hierarchy);\n\t\t\tchildren = root.getChildren() as FileNode[];\n\t\t} else {\n\t\t\tchildren.sort((a, b) =>\n\t\t\t\ta.label!.localeCompare(b.label!, undefined, { numeric: true, sensitivity: 'base' }),\n\t\t\t);\n\t\t}\n\n\t\tconst commit = await Container.git.getCommit(\n\t\t\tthis.rebaseStatus.repoPath,\n\t\t\tthis.rebaseStatus.steps.current.commit.ref,\n\t\t);\n\t\tif (commit != null) {\n\t\t\tchildren.splice(0, 0, new RebaseCommitNode(this.view, this, commit) as any);\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(\n\t\t\t`${this.status?.hasConflicts ? 'Resolve conflicts to continue rebasing' : 'Rebasing'} ${\n\t\t\t\tthis.rebaseStatus.incoming != null\n\t\t\t\t\t? `${GitReference.toString(this.rebaseStatus.incoming, { expand: false, icon: false })}`\n\t\t\t\t\t: ''\n\t\t\t} (${this.rebaseStatus.steps.current.number}/${this.rebaseStatus.steps.total})`,\n\t\t\tTreeItemCollapsibleState.Expanded,\n\t\t);\n\t\titem.id = this.id;\n\t\titem.contextValue = ContextValues.Rebase;\n\t\titem.description = this.status?.hasConflicts\n\t\t\t? Strings.pluralize('conflict', this.status.conflicts.length)\n\t\t\t: undefined;\n\t\titem.iconPath = this.status?.hasConflicts\n\t\t\t? new ThemeIcon('warning', new ThemeColor('list.warningForeground'))\n\t\t\t: new ThemeIcon('debug-pause', new ThemeColor('list.foreground'));\n\t\titem.tooltip = new MarkdownString(\n\t\t\t`${`Rebasing ${\n\t\t\t\tthis.rebaseStatus.incoming != null ? GitReference.toString(this.rebaseStatus.incoming) : ''\n\t\t\t}onto ${GitReference.toString(this.rebaseStatus.current)}`}\\n\\nStep ${\n\t\t\t\tthis.rebaseStatus.steps.current.number\n\t\t\t} of ${this.rebaseStatus.steps.total}\\\\\\nPaused at ${GitReference.toString(\n\t\t\t\tthis.rebaseStatus.steps.current.commit,\n\t\t\t\t{ icon: true },\n\t\t\t)}${\n\t\t\t\tthis.status?.hasConflicts\n\t\t\t\t\t? `\\n\\n${Strings.pluralize('conflicted file', this.status.conflicts.length)}`\n\t\t\t\t\t: ''\n\t\t\t}`,\n\t\t\ttrue,\n\t\t);\n\n\t\treturn item;\n\t}\n\n\tasync openEditor() {\n\t\tconst rebaseTodoUri = Uri.joinPath(this.uri, '.git', 'rebase-merge', 'git-rebase-todo');\n\t\tawait commands.executeCommand(BuiltInCommands.OpenWith, rebaseTodoUri, 'gitlens.rebase', {\n\t\t\tpreview: false,\n\t\t});\n\t}\n}\n\nexport class RebaseCommitNode extends ViewRefNode<ViewsWithCommits, GitRevisionReference> {\n\tconstructor(view: ViewsWithCommits, parent: ViewNode, public readonly commit: GitLogCommit) {\n\t\tsuper(commit.toGitUri(), view, parent);\n\t}\n\n\toverride toClipboard(): string {\n\t\tlet message = this.commit.message;\n\t\tconst index = message.indexOf('\\n');\n\t\tif (index !== -1) {\n\t\t\tmessage = `${message.substring(0, index)}${GlyphChars.Space}${GlyphChars.Ellipsis}`;\n\t\t}\n\n\t\treturn `${this.commit.shortSha}: ${message}`;\n\t}\n\n\tget ref(): GitRevisionReference {\n\t\treturn this.commit;\n\t}\n\n\tprivate get tooltip() {\n\t\treturn CommitFormatter.fromTemplate(\n\t\t\t`\\${author}\\${ (email)} ${\n\t\t\t\tGlyphChars.Dash\n\t\t\t} \\${id}\\${ (tips)}\\n\\${ago} (\\${date})\\${\\n\\nmessage}${this.commit.getFormattedDiffStatus({\n\t\t\t\texpand: true,\n\t\t\t\tprefix: '\\n\\n',\n\t\t\t\tseparator: '\\n',\n\t\t\t})}\\${\\n\\n${GlyphChars.Dash.repeat(2)}\\nfootnotes}`,\n\t\t\tthis.commit,\n\t\t\t{\n\t\t\t\tdateFormat: Container.config.defaultDateFormat,\n\t\t\t\tmessageIndent: 4,\n\t\t\t},\n\t\t);\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\tconst commit = this.commit;\n\n\t\tlet children: FileNode[] = commit.files.map(\n\t\t\ts => new CommitFileNode(this.view, this, s, commit.toFileCommit(s)!),\n\t\t);\n\n\t\tif (this.view.config.files.layout !== ViewFilesLayout.List) {\n\t\t\tconst hierarchy = Arrays.makeHierarchical(\n\t\t\t\tchildren,\n\t\t\t\tn => n.uri.relativePath.split('/'),\n\t\t\t\t(...parts: string[]) => Strings.normalizePath(paths.join(...parts)),\n\t\t\t\tthis.view.config.files.compact,\n\t\t\t);\n\n\t\t\tconst root = new FolderNode(this.view, this, this.repoPath, '', hierarchy);\n\t\t\tchildren = root.getChildren() as FileNode[];\n\t\t} else {\n\t\t\tchildren.sort((a, b) =>\n\t\t\t\ta.label!.localeCompare(b.label!, undefined, { numeric: true, sensitivity: 'base' }),\n\t\t\t);\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(`Paused at commit ${this.commit.shortSha}`, TreeItemCollapsibleState.Collapsed);\n\n\t\t// item.contextValue = ContextValues.RebaseCommit;\n\n\t\titem.description = CommitFormatter.fromTemplate(`\\${message}`, this.commit, {\n\t\t\tmessageTruncateAtNewLine: true,\n\t\t});\n\t\titem.iconPath = new ThemeIcon('git-commit');\n\t\titem.tooltip = this.tooltip;\n\n\t\treturn item;\n\t}\n\n\toverride getCommand(): Command | undefined {\n\t\tconst commandArgs: DiffWithPreviousCommandArgs = {\n\t\t\tcommit: this.commit,\n\t\t\turi: this.uri,\n\t\t\tline: 0,\n\t\t\tshowOptions: {\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpreview: true,\n\t\t\t},\n\t\t};\n\t\treturn {\n\t\t\ttitle: 'Open Changes with Previous Revision',\n\t\t\tcommand: Commands.DiffWithPrevious,\n\t\t\targuments: [undefined, commandArgs],\n\t\t};\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState, window } from 'vscode';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { GitLog, GitReflogRecord } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { debug, gate, Iterables } from '../../system';\nimport { ViewsWithCommits } from '../viewBase';\nimport { CommitNode } from './commitNode';\nimport { LoadMoreNode, MessageNode } from './common';\nimport { RepositoryNode } from './repositoryNode';\nimport { ContextValues, PageableViewNode, ViewNode } from './viewNode';\n\nexport class ReflogRecordNode extends ViewNode<ViewsWithCommits> implements PageableViewNode {\n\tstatic key = ':reflog-record';\n\tstatic getId(\n\t\trepoPath: string,\n\t\tsha: string,\n\t\tselector: string,\n\t\tcommand: string,\n\t\tcommandArgs: string | undefined,\n\t\tdate: Date,\n\t): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${sha}|${selector}|${command}|${\n\t\t\tcommandArgs ?? ''\n\t\t}|${date.getTime()})`;\n\t}\n\n\tconstructor(view: ViewsWithCommits, parent: ViewNode, public readonly record: GitReflogRecord) {\n\t\tsuper(GitUri.fromRepoPath(record.repoPath), view, parent);\n\t}\n\n\toverride get id(): string {\n\t\treturn ReflogRecordNode.getId(\n\t\t\tthis.uri.repoPath!,\n\t\t\tthis.record.sha,\n\t\t\tthis.record.selector,\n\t\t\tthis.record.command,\n\t\t\tthis.record.commandArgs,\n\t\t\tthis.record.date,\n\t\t);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst log = await this.getLog();\n\t\tif (log === undefined) return [new MessageNode(this.view, this, 'No commits could be found.')];\n\n\t\tconst children: (CommitNode | LoadMoreNode)[] = [\n\t\t\t...Iterables.map(log.commits.values(), c => new CommitNode(this.view, this, c)),\n\t\t];\n\n\t\tif (log.hasMore) {\n\t\t\tchildren.push(new LoadMoreNode(this.view, this, children[children.length - 1]));\n\t\t}\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(\n\t\t\t`${this.record.command}${this.record.commandArgs ? ` ${this.record.commandArgs}` : ''}`,\n\t\t\tTreeItemCollapsibleState.Collapsed,\n\t\t);\n\t\titem.id = this.id;\n\t\titem.description = `${\n\t\t\tthis.record.HEAD.length === 0\n\t\t\t\t? ''\n\t\t\t\t: `${this.record.HEAD} ${GlyphChars.Space}${GlyphChars.Dot}${GlyphChars.Space} `\n\t\t}${this.record.formattedDate}`;\n\t\titem.contextValue = ContextValues.ReflogRecord;\n\t\titem.tooltip = `${this.record.HEAD.length === 0 ? '' : `${this.record.HEAD}\\n`}${this.record.command}${\n\t\t\tthis.record.commandArgs ? ` ${this.record.commandArgs}` : ''\n\t\t}${\n\t\t\tthis.record.details ? ` (${this.record.details})` : ''\n\t\t}\\n${this.record.formatDateFromNow()} (${this.record.formatDate()})\\n${this.record.previousShortSha} ${\n\t\t\tGlyphChars.Space\n\t\t}${GlyphChars.ArrowRight}${GlyphChars.Space} ${this.record.shortSha}`;\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset?: boolean) {\n\t\tif (reset) {\n\t\t\tthis._log = undefined;\n\t\t}\n\t}\n\n\tprivate _log: GitLog | undefined;\n\tprivate async getLog() {\n\t\tif (this._log === undefined) {\n\t\t\tconst range = `${this.record.previousSha}..${this.record.sha}`;\n\t\t\tthis._log = await Container.git.getLog(this.uri.repoPath!, {\n\t\t\t\tlimit: this.limit ?? this.view.config.defaultItemLimit,\n\t\t\t\tref: range,\n\t\t\t});\n\t\t}\n\n\t\treturn this._log;\n\t}\n\n\tget hasMore() {\n\t\treturn this._log?.hasMore ?? true;\n\t}\n\n\tlimit: number | undefined = this.view.getNodeLastKnownLimit(this);\n\t@gate()\n\tasync loadMore(limit?: number | { until?: any }) {\n\t\tlet log = await window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: { viewId: this.view.id },\n\t\t\t},\n\t\t\t() => this.getLog(),\n\t\t);\n\t\tif (log === undefined || !log.hasMore) return;\n\n\t\tlog = await log.more?.(limit ?? this.view.config.pageItemLimit);\n\t\tif (this._log === log) return;\n\n\t\tthis._log = log;\n\t\tthis.limit = log?.count;\n\t\tvoid this.triggerChange(false);\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Container } from '../../container';\nimport { GitReflog, Repository } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { debug, gate } from '../../system';\nimport { RepositoriesView } from '../repositoriesView';\nimport { LoadMoreNode, MessageNode } from './common';\nimport { ReflogRecordNode } from './reflogRecordNode';\nimport { RepositoryNode } from './repositoryNode';\nimport { ContextValues, PageableViewNode, ViewNode } from './viewNode';\n\nexport class ReflogNode extends ViewNode<RepositoriesView> implements PageableViewNode {\n\tstatic key = ':reflog';\n\tstatic getId(repoPath: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}`;\n\t}\n\n\tprivate _children: ViewNode[] | undefined;\n\n\tconstructor(uri: GitUri, view: RepositoriesView, parent: ViewNode, public readonly repo: Repository) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\toverride get id(): string {\n\t\treturn ReflogNode.getId(this.repo.path);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._children === undefined) {\n\t\t\tconst children = [];\n\n\t\t\tconst reflog = await this.getReflog();\n\t\t\tif (reflog === undefined || reflog.records.length === 0) {\n\t\t\t\treturn [new MessageNode(this.view, this, 'No activity could be found.')];\n\t\t\t}\n\n\t\t\tchildren.push(...reflog.records.map(r => new ReflogRecordNode(this.view, this, r)));\n\n\t\t\tif (reflog.hasMore) {\n\t\t\t\tchildren.push(new LoadMoreNode(this.view, this, children[children.length - 1]));\n\t\t\t}\n\n\t\t\tthis._children = children;\n\t\t}\n\t\treturn this._children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Incoming Activity', TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\titem.contextValue = ContextValues.Reflog;\n\t\titem.description = 'experimental';\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath('images/dark/icon-activity.svg'),\n\t\t\tlight: Container.context.asAbsolutePath('images/light/icon-activity.svg'),\n\t\t};\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset?: boolean) {\n\t\tthis._children = undefined;\n\t\tif (reset) {\n\t\t\tthis._reflog = undefined;\n\t\t}\n\t}\n\n\tprivate _reflog: GitReflog | undefined;\n\tprivate async getReflog() {\n\t\tif (this._reflog === undefined) {\n\t\t\tthis._reflog = await Container.git.getIncomingActivity(this.repo.path, {\n\t\t\t\tall: true,\n\t\t\t\tlimit: this.limit ?? this.view.config.defaultItemLimit,\n\t\t\t});\n\t\t}\n\n\t\treturn this._reflog;\n\t}\n\n\tget hasMore() {\n\t\treturn this._reflog?.hasMore ?? true;\n\t}\n\n\tlimit: number | undefined = this.view.getNodeLastKnownLimit(this);\n\tasync loadMore(limit?: number) {\n\t\tlet reflog = await this.getReflog();\n\t\tif (reflog === undefined || !reflog.hasMore) return;\n\n\t\treflog = await reflog.more?.(limit ?? this.view.config.pageItemLimit);\n\t\tif (this._reflog === reflog) return;\n\n\t\tthis._reflog = reflog;\n\t\tthis.limit = reflog?.count;\n\t\tvoid this.triggerChange(false);\n\t}\n}\n","'use strict';\nimport { ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { GitUri } from '../../git/gitUri';\nimport { Arrays } from '../../system';\nimport { View } from '../viewBase';\nimport { BranchNode } from './branchNode';\nimport { RepositoryNode } from './repositoryNode';\nimport { TagNode } from './tagNode';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport class BranchOrTagFolderNode extends ViewNode {\n\tstatic getId(repoPath: string, key: string | undefined, type: string, relativePath: string | undefined): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}:${\n\t\t\tkey === undefined ? type : `${key}:${type}`\n\t\t}-folder(${relativePath})`;\n\t}\n\n\tconstructor(\n\t\tview: View,\n\t\tparent: ViewNode,\n\t\tpublic readonly type: 'branch' | 'remote-branch' | 'tag',\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly folderName: string,\n\t\tpublic readonly relativePath: string | undefined,\n\t\tpublic readonly root: Arrays.HierarchicalItem<BranchNode | TagNode>,\n\t\tprivate readonly _key?: string,\n\t\tprivate readonly _expanded: boolean = false,\n\t) {\n\t\tsuper(GitUri.fromRepoPath(repoPath), view, parent);\n\t}\n\n\toverride toClipboard(): string {\n\t\treturn this.folderName;\n\t}\n\n\toverride get id(): string {\n\t\treturn BranchOrTagFolderNode.getId(this.repoPath, this._key, this.type, this.relativePath);\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\tif (this.root.descendants === undefined || this.root.children === undefined) return [];\n\n\t\tconst children: (BranchOrTagFolderNode | BranchNode | TagNode)[] = [];\n\n\t\tfor (const folder of this.root.children.values()) {\n\t\t\tif (folder.value === undefined) {\n\t\t\t\t// If the folder contains the current branch, expand it by default\n\t\t\t\tconst expanded = folder.descendants?.some(n => n instanceof BranchNode && n.current);\n\t\t\t\tchildren.push(\n\t\t\t\t\tnew BranchOrTagFolderNode(\n\t\t\t\t\t\tthis.view,\n\t\t\t\t\t\tthis.folderName ? this : this.parent!,\n\t\t\t\t\t\tthis.type,\n\t\t\t\t\t\tthis.repoPath,\n\t\t\t\t\t\tfolder.name,\n\t\t\t\t\t\tfolder.relativePath,\n\t\t\t\t\t\tfolder,\n\t\t\t\t\t\tthis._key,\n\t\t\t\t\t\texpanded,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Make sure to set the parent\n\t\t\t(folder.value as any).parent = this.folderName ? this : this.parent!;\n\t\t\tchildren.push(folder.value);\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(\n\t\t\tthis.label,\n\t\t\tthis._expanded ? TreeItemCollapsibleState.Expanded : TreeItemCollapsibleState.Collapsed,\n\t\t);\n\t\titem.id = this.id;\n\t\titem.contextValue = ContextValues.Folder;\n\t\titem.iconPath = ThemeIcon.Folder;\n\t\titem.tooltip = this.label;\n\t\treturn item;\n\t}\n\n\tget label(): string {\n\t\treturn this.folderName;\n\t}\n}\n","'use strict';\nimport { ThemeIcon, TreeItem, TreeItemCollapsibleState, Uri } from 'vscode';\nimport { ViewBranchesLayout } from '../../configuration';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { GitRemote, GitRemoteType, Repository } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { Arrays, log } from '../../system';\nimport { RemotesView } from '../remotesView';\nimport { RepositoriesView } from '../repositoriesView';\nimport { BranchNode } from './branchNode';\nimport { BranchOrTagFolderNode } from './branchOrTagFolderNode';\nimport { MessageNode } from './common';\nimport { RepositoryNode } from './repositoryNode';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport class RemoteNode extends ViewNode<RemotesView | RepositoriesView> {\n\tstatic key = ':remote';\n\tstatic getId(repoPath: string, name: string, id: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${name}|${id})`;\n\t}\n\n\tconstructor(\n\t\turi: GitUri,\n\t\tview: RemotesView | RepositoriesView,\n\t\tparent: ViewNode,\n\t\tpublic readonly remote: GitRemote,\n\t\tpublic readonly repo: Repository,\n\t) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\toverride toClipboard(): string {\n\t\treturn this.remote.name;\n\t}\n\n\toverride get id(): string {\n\t\treturn RemoteNode.getId(this.remote.repoPath, this.remote.name, this.remote.id);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst branches = await this.repo.getBranches({\n\t\t\t// only show remote branches for this remote\n\t\t\tfilter: b => b.remote && b.name.startsWith(this.remote.name),\n\t\t\tsort: true,\n\t\t});\n\t\tif (branches.length === 0) return [new MessageNode(this.view, this, 'No branches could be found.')];\n\n\t\tconst branchNodes = branches.map(\n\t\t\tb =>\n\t\t\t\tnew BranchNode(GitUri.fromRepoPath(this.uri.repoPath!, b.ref), this.view, this, b, false, {\n\t\t\t\t\tshowComparison: false,\n\t\t\t\t\tshowTracking: false,\n\t\t\t\t}),\n\t\t);\n\t\tif (this.view.config.branches.layout === ViewBranchesLayout.List) return branchNodes;\n\n\t\tconst hierarchy = Arrays.makeHierarchical(\n\t\t\tbranchNodes,\n\t\t\tn => n.treeHierarchy,\n\t\t\t(...paths) => paths.join('/'),\n\t\t\tthis.view.config.files.compact,\n\t\t\tb => {\n\t\t\t\tb.compacted = true;\n\t\t\t\treturn true;\n\t\t\t},\n\t\t);\n\n\t\tconst root = new BranchOrTagFolderNode(\n\t\t\tthis.view,\n\t\t\tthis,\n\t\t\t'remote-branch',\n\t\t\tthis.repo.path,\n\t\t\t'',\n\t\t\tundefined,\n\t\t\thierarchy,\n\t\t\t`remote(${this.remote.name})`,\n\t\t);\n\t\tconst children = root.getChildren();\n\t\treturn children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tlet arrows;\n\t\tlet left;\n\t\tlet right;\n\t\tfor (const { type } of this.remote.urls) {\n\t\t\tif (type === GitRemoteType.Fetch) {\n\t\t\t\tleft = true;\n\n\t\t\t\tif (right) break;\n\t\t\t} else if (type === GitRemoteType.Push) {\n\t\t\t\tright = true;\n\n\t\t\t\tif (left) break;\n\t\t\t}\n\t\t}\n\n\t\tif (left && right) {\n\t\t\tarrows = GlyphChars.ArrowsRightLeft;\n\t\t} else if (right) {\n\t\t\tarrows = GlyphChars.ArrowRight;\n\t\t} else if (left) {\n\t\t\tarrows = GlyphChars.ArrowLeft;\n\t\t} else {\n\t\t\tarrows = GlyphChars.Dash;\n\t\t}\n\n\t\tconst item = new TreeItem(this.remote.name, TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\n\t\tif (this.remote.provider != null) {\n\t\t\tconst { provider } = this.remote;\n\n\t\t\titem.description = `${arrows}${GlyphChars.Space} ${provider.name} ${GlyphChars.Space}${GlyphChars.Dot}${GlyphChars.Space} ${provider.displayPath}`;\n\t\t\titem.iconPath =\n\t\t\t\tprovider.icon === 'remote'\n\t\t\t\t\t? new ThemeIcon('cloud')\n\t\t\t\t\t: {\n\t\t\t\t\t\t\tdark: Container.context.asAbsolutePath(`images/dark/icon-${provider.icon}.svg`),\n\t\t\t\t\t\t\tlight: Container.context.asAbsolutePath(`images/light/icon-${provider.icon}.svg`),\n\t\t\t\t\t  };\n\n\t\t\tif (provider.hasApi()) {\n\t\t\t\tconst connected = provider.maybeConnected ?? (await provider.isConnected());\n\n\t\t\t\titem.contextValue = `${ContextValues.Remote}${connected ? '+connected' : '+disconnected'}`;\n\t\t\t\titem.tooltip = `${this.remote.name} (${provider.name} ${GlyphChars.Dash} ${\n\t\t\t\t\tconnected ? 'connected' : 'not connected'\n\t\t\t\t})\\n${provider.displayPath}\\n`;\n\t\t\t} else {\n\t\t\t\titem.contextValue = ContextValues.Remote;\n\t\t\t\titem.tooltip = `${this.remote.name} (${provider.name})\\n${provider.displayPath}\\n`;\n\t\t\t}\n\t\t} else {\n\t\t\titem.description = `${arrows}${GlyphChars.Space} ${\n\t\t\t\tthis.remote.domain\n\t\t\t\t\t? `${this.remote.domain} ${GlyphChars.Space}${GlyphChars.Dot}${GlyphChars.Space} `\n\t\t\t\t\t: ''\n\t\t\t}${this.remote.path}`;\n\t\t\titem.contextValue = ContextValues.Remote;\n\t\t\titem.iconPath = new ThemeIcon('cloud');\n\t\t\titem.tooltip = `${this.remote.name} (${this.remote.domain})\\n${this.remote.path}\\n`;\n\t\t}\n\n\t\tif (this.remote.default) {\n\t\t\titem.contextValue += '+default';\n\t\t\titem.resourceUri = Uri.parse('gitlens-view://remote/default');\n\t\t}\n\n\t\tfor (const { type, url } of this.remote.urls) {\n\t\t\titem.tooltip += `\\n${url} (${type})`;\n\t\t}\n\n\t\treturn item;\n\t}\n\n\t@log()\n\tasync setAsDefault(state: boolean = true) {\n\t\tvoid (await this.remote.setAsDefault(state));\n\t\tvoid this.triggerChange();\n\t}\n}\n","'use strict';\nimport { ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Repository } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { debug, gate } from '../../system';\nimport { RemotesView } from '../remotesView';\nimport { RepositoriesView } from '../repositoriesView';\nimport { MessageNode } from './common';\nimport { RemoteNode } from './remoteNode';\nimport { RepositoryNode } from './repositoryNode';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport class RemotesNode extends ViewNode<RemotesView | RepositoriesView> {\n\tstatic key = ':remotes';\n\tstatic getId(repoPath: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}`;\n\t}\n\n\tprivate _children: ViewNode[] | undefined;\n\n\tconstructor(uri: GitUri, view: RemotesView | RepositoriesView, parent: ViewNode, public readonly repo: Repository) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\toverride get id(): string {\n\t\treturn RemotesNode.getId(this.repo.path);\n\t}\n\n\tget repoPath(): string {\n\t\treturn this.repo.path;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._children == null) {\n\t\t\tconst remotes = await this.repo.getRemotes({ sort: true });\n\t\t\tif (remotes.length === 0) {\n\t\t\t\treturn [new MessageNode(this.view, this, 'No remotes could be found')];\n\t\t\t}\n\n\t\t\tthis._children = remotes.map(r => new RemoteNode(this.uri, this.view, this, r, this.repo));\n\t\t}\n\n\t\treturn this._children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Remotes', TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\titem.contextValue = ContextValues.Remotes;\n\t\titem.iconPath = new ThemeIcon('cloud');\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh() {\n\t\tthis._children = undefined;\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { ViewFilesLayout } from '../../config';\nimport { Container } from '../../container';\nimport { CommitFormatter, GitStashCommit, GitStashReference } from '../../git/git';\nimport { Arrays, Strings } from '../../system';\nimport { ContextValues, FileNode, FolderNode, RepositoryNode, StashFileNode, ViewNode, ViewRefNode } from '../nodes';\nimport { RepositoriesView } from '../repositoriesView';\nimport { StashesView } from '../stashesView';\n\nexport class StashNode extends ViewRefNode<StashesView | RepositoriesView, GitStashReference> {\n\tstatic key = ':stash';\n\tstatic getId(repoPath: string, ref: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${ref})`;\n\t}\n\n\tconstructor(view: StashesView | RepositoriesView, parent: ViewNode, public readonly commit: GitStashCommit) {\n\t\tsuper(commit.toGitUri(), view, parent);\n\t}\n\n\toverride toClipboard(): string {\n\t\treturn this.commit.stashName;\n\t}\n\n\toverride get id(): string {\n\t\treturn StashNode.getId(this.commit.repoPath, this.commit.sha);\n\t}\n\n\tget ref(): GitStashReference {\n\t\treturn this.commit;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\t// Ensure we have checked for untracked files\n\t\tawait this.commit.checkForUntrackedFiles();\n\n\t\tlet children: FileNode[] = this.commit.files.map(\n\t\t\ts => new StashFileNode(this.view, this, s, this.commit.toFileCommit(s)!),\n\t\t);\n\n\t\tif (this.view.config.files.layout !== ViewFilesLayout.List) {\n\t\t\tconst hierarchy = Arrays.makeHierarchical(\n\t\t\t\tchildren,\n\t\t\t\tn => n.uri.relativePath.split('/'),\n\t\t\t\t(...parts: string[]) => Strings.normalizePath(paths.join(...parts)),\n\t\t\t\tthis.view.config.files.compact,\n\t\t\t);\n\n\t\t\tconst root = new FolderNode(this.view, this, this.repoPath, '', hierarchy);\n\t\t\tchildren = root.getChildren() as FileNode[];\n\t\t} else {\n\t\t\tchildren.sort((a, b) =>\n\t\t\t\ta.label!.localeCompare(b.label!, undefined, { numeric: true, sensitivity: 'base' }),\n\t\t\t);\n\t\t}\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(\n\t\t\tCommitFormatter.fromTemplate(this.view.config.formats.stashes.label, this.commit, {\n\t\t\t\tmessageTruncateAtNewLine: true,\n\t\t\t\tdateFormat: Container.config.defaultDateFormat,\n\t\t\t}),\n\t\t\tTreeItemCollapsibleState.Collapsed,\n\t\t);\n\t\titem.id = this.id;\n\t\titem.description = CommitFormatter.fromTemplate(this.view.config.formats.stashes.description, this.commit, {\n\t\t\tmessageTruncateAtNewLine: true,\n\t\t\tdateFormat: Container.config.defaultDateFormat,\n\t\t});\n\t\titem.contextValue = ContextValues.Stash;\n\t\titem.tooltip = CommitFormatter.fromTemplate(`\\${ago} (\\${date})\\n\\n\\${message}`, this.commit, {\n\t\t\tdateFormat: Container.config.defaultDateFormat,\n\t\t\t// messageAutolinks: true,\n\t\t});\n\n\t\treturn item;\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Container } from '../../container';\nimport { Repository } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { debug, gate, Iterables } from '../../system';\nimport { RepositoriesView } from '../repositoriesView';\nimport { StashesView } from '../stashesView';\nimport { MessageNode } from './common';\nimport { RepositoryNode } from './repositoryNode';\nimport { StashNode } from './stashNode';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport class StashesNode extends ViewNode<StashesView | RepositoriesView> {\n\tstatic key = ':stashes';\n\tstatic getId(repoPath: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}`;\n\t}\n\n\tprivate _children: ViewNode[] | undefined;\n\n\tconstructor(uri: GitUri, view: StashesView | RepositoriesView, parent: ViewNode, public readonly repo: Repository) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\toverride get id(): string {\n\t\treturn StashesNode.getId(this.repo.path);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._children == null) {\n\t\t\tconst stash = await this.repo.getStash();\n\t\t\tif (stash == null) return [new MessageNode(this.view, this, 'No stashes could be found.')];\n\n\t\t\tthis._children = [...Iterables.map(stash.commits.values(), c => new StashNode(this.view, this, c))];\n\t\t}\n\n\t\treturn this._children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Stashes', TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\titem.contextValue = ContextValues.Stashes;\n\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath('images/dark/icon-stash.svg'),\n\t\t\tlight: Container.context.asAbsolutePath('images/light/icon-stash.svg'),\n\t\t};\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh() {\n\t\tthis._children = undefined;\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { ViewFilesLayout } from '../../configuration';\nimport { Container } from '../../container';\nimport {\n\tGitCommitType,\n\tGitFileWithCommit,\n\tGitLog,\n\tGitLogCommit,\n\tGitRevision,\n\tGitStatus,\n\tGitStatusFile,\n\tGitTrackingState,\n} from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { Arrays, Iterables, Strings } from '../../system';\nimport { RepositoriesView } from '../repositoriesView';\nimport { FileNode, FolderNode } from './folderNode';\nimport { RepositoryNode } from './repositoryNode';\nimport { StatusFileNode } from './statusFileNode';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport class StatusFilesNode extends ViewNode<RepositoriesView> {\n\tstatic key = ':status-files';\n\tstatic getId(repoPath: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}`;\n\t}\n\n\treadonly repoPath: string;\n\n\tconstructor(\n\t\tview: RepositoriesView,\n\t\tparent: ViewNode,\n\t\tpublic readonly status:\n\t\t\t| GitStatus\n\t\t\t| {\n\t\t\t\t\treadonly repoPath: string;\n\t\t\t\t\treadonly files: GitStatusFile[];\n\t\t\t\t\treadonly state: GitTrackingState;\n\t\t\t\t\treadonly upstream?: string;\n\t\t\t  },\n\t\tpublic readonly range: string | undefined,\n\t) {\n\t\tsuper(GitUri.fromRepoPath(status.repoPath), view, parent);\n\t\tthis.repoPath = status.repoPath;\n\t}\n\n\toverride get id(): string {\n\t\treturn StatusFilesNode.getId(this.repoPath);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tlet files: GitFileWithCommit[] = [];\n\n\t\tconst repoPath = this.repoPath;\n\n\t\tlet log: GitLog | undefined;\n\t\tif (this.range != null) {\n\t\t\tlog = await Container.git.getLog(repoPath, { limit: 0, ref: this.range });\n\t\t\tif (log != null) {\n\t\t\t\tfiles = [\n\t\t\t\t\t...Iterables.flatMap(log.commits.values(), c =>\n\t\t\t\t\t\tc.files.map(s => {\n\t\t\t\t\t\t\tconst file: GitFileWithCommit = { ...s, commit: c };\n\t\t\t\t\t\t\treturn file;\n\t\t\t\t\t\t}),\n\t\t\t\t\t),\n\t\t\t\t];\n\t\t\t}\n\t\t}\n\n\t\tif (this.view.config.includeWorkingTree && this.status.files.length !== 0) {\n\t\t\tfiles.splice(\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\t...Iterables.flatMap(this.status.files, s => {\n\t\t\t\t\tif (s.workingTreeStatus != null && s.indexStatus != null) {\n\t\t\t\t\t\t// Decrements the date to guarantee this entry will be sorted after the previous entry (most recent first)\n\t\t\t\t\t\tconst older = new Date();\n\t\t\t\t\t\tolder.setMilliseconds(older.getMilliseconds() - 1);\n\n\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\tthis.toStatusFile(s, GitRevision.uncommitted, GitRevision.uncommittedStaged),\n\t\t\t\t\t\t\tthis.toStatusFile(s, GitRevision.uncommittedStaged, 'HEAD', older),\n\t\t\t\t\t\t];\n\t\t\t\t\t} else if (s.indexStatus != null) {\n\t\t\t\t\t\treturn [this.toStatusFile(s, GitRevision.uncommittedStaged, 'HEAD')];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn [this.toStatusFile(s, GitRevision.uncommitted, 'HEAD')];\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tfiles.sort((a, b) => b.commit.date.getTime() - a.commit.date.getTime());\n\n\t\tconst groups = Arrays.groupBy(files, s => s.fileName);\n\n\t\tlet children: FileNode[] = Object.values(groups).map(\n\t\t\tfiles =>\n\t\t\t\tnew StatusFileNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\trepoPath,\n\t\t\t\t\tfiles[files.length - 1],\n\t\t\t\t\tfiles.map(s => s.commit),\n\t\t\t\t),\n\t\t);\n\n\t\tif (this.view.config.files.layout !== ViewFilesLayout.List) {\n\t\t\tconst hierarchy = Arrays.makeHierarchical(\n\t\t\t\tchildren,\n\t\t\t\tn => n.uri.relativePath.split('/'),\n\t\t\t\t(...parts: string[]) => Strings.normalizePath(paths.join(...parts)),\n\t\t\t\tthis.view.config.files.compact,\n\t\t\t);\n\n\t\t\tconst root = new FolderNode(this.view, this, repoPath, '', hierarchy, true);\n\t\t\tchildren = root.getChildren() as FileNode[];\n\t\t} else {\n\t\t\tchildren.sort(\n\t\t\t\t(a, b) =>\n\t\t\t\t\ta.priority - b.priority ||\n\t\t\t\t\ta.label!.localeCompare(b.label!, undefined, { numeric: true, sensitivity: 'base' }),\n\t\t\t);\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tlet files = this.view.config.includeWorkingTree ? this.status.files.length : 0;\n\n\t\tif (this.range != null) {\n\t\t\tif (this.status.upstream != null && this.status.state.ahead > 0) {\n\t\t\t\tif (files > 0) {\n\t\t\t\t\tconst aheadFiles = await Container.git.getDiffStatus(this.repoPath, `${this.status.upstream}...`);\n\n\t\t\t\t\tif (aheadFiles != null) {\n\t\t\t\t\t\tconst uniques = new Set();\n\t\t\t\t\t\tfor (const f of this.status.files) {\n\t\t\t\t\t\t\tuniques.add(f.fileName);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (const f of aheadFiles) {\n\t\t\t\t\t\t\tuniques.add(f.fileName);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfiles = uniques.size;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst stats = await Container.git.getChangedFilesCount(this.repoPath, `${this.status.upstream}...`);\n\t\t\t\t\tif (stats != null) {\n\t\t\t\t\t\tfiles += stats.files;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfiles = -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst label = files === -1 ? '?? files changed' : `${Strings.pluralize('file', files)} changed`;\n\t\tconst item = new TreeItem(label, TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\titem.contextValue = ContextValues.StatusFiles;\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath('images/dark/icon-diff.svg'),\n\t\t\tlight: Container.context.asAbsolutePath('images/light/icon-diff.svg'),\n\t\t};\n\n\t\treturn item;\n\t}\n\n\tprivate toStatusFile(file: GitStatusFile, ref: string, previousRef: string, date?: Date): GitFileWithCommit {\n\t\treturn {\n\t\t\tstatus: file.status,\n\t\t\trepoPath: file.repoPath,\n\t\t\tindexStatus: file.indexStatus,\n\t\t\tworkingTreeStatus: file.workingTreeStatus,\n\t\t\tfileName: file.fileName,\n\t\t\toriginalFileName: file.originalFileName,\n\t\t\tcommit: new GitLogCommit(\n\t\t\t\tGitCommitType.LogFile,\n\t\t\t\tfile.repoPath,\n\t\t\t\tref,\n\t\t\t\t'You',\n\t\t\t\tundefined,\n\t\t\t\tdate ?? new Date(),\n\t\t\t\tdate ?? new Date(),\n\t\t\t\t'',\n\t\t\t\tfile.fileName,\n\t\t\t\t[file],\n\t\t\t\tfile.status,\n\t\t\t\tfile.originalFileName,\n\t\t\t\tpreviousRef,\n\t\t\t\tfile.fileName,\n\t\t\t),\n\t\t};\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState, window } from 'vscode';\nimport { ViewBranchesLayout } from '../../configuration';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { emojify } from '../../emojis';\nimport { GitLog, GitRevision, GitTag, GitTagReference, TagDateFormatting } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { debug, gate, Iterables, Strings } from '../../system';\nimport { RepositoriesView } from '../repositoriesView';\nimport { TagsView } from '../tagsView';\nimport { CommitNode } from './commitNode';\nimport { LoadMoreNode, MessageNode } from './common';\nimport { insertDateMarkers } from './helpers';\nimport { RepositoryNode } from './repositoryNode';\nimport { ContextValues, PageableViewNode, ViewNode, ViewRefNode } from './viewNode';\n\nexport class TagNode extends ViewRefNode<TagsView | RepositoriesView, GitTagReference> implements PageableViewNode {\n\tstatic key = ':tag';\n\tstatic getId(repoPath: string, name: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${name})`;\n\t}\n\n\tconstructor(uri: GitUri, view: TagsView | RepositoriesView, parent: ViewNode, public readonly tag: GitTag) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\toverride toClipboard(): string {\n\t\treturn this.tag.name;\n\t}\n\n\toverride get id(): string {\n\t\treturn TagNode.getId(this.tag.repoPath, this.tag.name);\n\t}\n\n\tget label(): string {\n\t\treturn this.view.config.branches.layout === ViewBranchesLayout.Tree ? this.tag.getBasename() : this.tag.name;\n\t}\n\n\tget ref(): GitTagReference {\n\t\treturn this.tag;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst log = await this.getLog();\n\t\tif (log == null) return [new MessageNode(this.view, this, 'No commits could be found.')];\n\n\t\tconst getBranchAndTagTips = await Container.git.getBranchesAndTagsTipsFn(this.uri.repoPath, this.tag.name);\n\t\tconst children = [\n\t\t\t...insertDateMarkers(\n\t\t\t\tIterables.map(\n\t\t\t\t\tlog.commits.values(),\n\t\t\t\t\tc => new CommitNode(this.view, this, c, undefined, undefined, getBranchAndTagTips),\n\t\t\t\t),\n\t\t\t\tthis,\n\t\t\t),\n\t\t];\n\n\t\tif (log.hasMore) {\n\t\t\tchildren.push(\n\t\t\t\tnew LoadMoreNode(this.view, this, children[children.length - 1], undefined, () =>\n\t\t\t\t\tContainer.git.getCommitCount(this.tag.repoPath, this.tag.name),\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(this.label, TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\titem.contextValue = ContextValues.Tag;\n\t\titem.description = emojify(this.tag.message);\n\t\titem.tooltip = `${this.tag.name}${Strings.pad(GlyphChars.Dash, 2, 2)}${GitRevision.shorten(this.tag.sha, {\n\t\t\tforce: true,\n\t\t})}\\n${this.tag.formatDateFromNow()} (${this.tag.formatDate(TagDateFormatting.dateFormat)})\\n\\n${emojify(\n\t\t\tthis.tag.message,\n\t\t)}${\n\t\t\tthis.tag.commitDate != null && this.tag.date !== this.tag.commitDate\n\t\t\t\t? `\\n${this.tag.formatCommitDateFromNow()} (${this.tag.formatCommitDate(TagDateFormatting.dateFormat)})`\n\t\t\t\t: ''\n\t\t}`;\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset?: boolean) {\n\t\tif (reset) {\n\t\t\tthis._log = undefined;\n\t\t}\n\t}\n\n\tprivate _log: GitLog | undefined;\n\tprivate async getLog() {\n\t\tif (this._log == null) {\n\t\t\tthis._log = await Container.git.getLog(this.uri.repoPath!, {\n\t\t\t\tlimit: this.limit ?? this.view.config.defaultItemLimit,\n\t\t\t\tref: this.tag.name,\n\t\t\t});\n\t\t}\n\n\t\treturn this._log;\n\t}\n\n\tget hasMore() {\n\t\treturn this._log?.hasMore ?? true;\n\t}\n\n\tlimit: number | undefined = this.view.getNodeLastKnownLimit(this);\n\t@gate()\n\tasync loadMore(limit?: number | { until?: any }) {\n\t\tlet log = await window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: { viewId: this.view.id },\n\t\t\t},\n\t\t\t() => this.getLog(),\n\t\t);\n\t\tif (log == null || !log.hasMore) return;\n\n\t\tlog = await log.more?.(limit ?? this.view.config.pageItemLimit);\n\t\tif (this._log === log) return;\n\n\t\tthis._log = log;\n\t\tthis.limit = log?.count;\n\n\t\tvoid this.triggerChange(false);\n\t}\n}\n","'use strict';\nimport { ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { ViewBranchesLayout } from '../../configuration';\nimport { Repository } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { Arrays, debug, gate } from '../../system';\nimport { RepositoriesView } from '../repositoriesView';\nimport { TagsView } from '../tagsView';\nimport { BranchOrTagFolderNode } from './branchOrTagFolderNode';\nimport { MessageNode } from './common';\nimport { RepositoryNode } from './repositoryNode';\nimport { TagNode } from './tagNode';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport class TagsNode extends ViewNode<TagsView | RepositoriesView> {\n\tstatic key = ':tags';\n\tstatic getId(repoPath: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}`;\n\t}\n\n\tprivate _children: ViewNode[] | undefined;\n\n\tconstructor(uri: GitUri, view: TagsView | RepositoriesView, parent: ViewNode, public readonly repo: Repository) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\toverride get id(): string {\n\t\treturn TagsNode.getId(this.repo.path);\n\t}\n\n\tget repoPath(): string {\n\t\treturn this.repo.path;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._children == null) {\n\t\t\tconst tags = await this.repo.getTags({ sort: true });\n\t\t\tif (tags.length === 0) return [new MessageNode(this.view, this, 'No tags could be found.')];\n\n\t\t\tconst tagNodes = tags.map(\n\t\t\t\tt => new TagNode(GitUri.fromRepoPath(this.uri.repoPath!, t.ref), this.view, this, t),\n\t\t\t);\n\t\t\tif (this.view.config.branches.layout === ViewBranchesLayout.List) return tagNodes;\n\n\t\t\tconst hierarchy = Arrays.makeHierarchical(\n\t\t\t\ttagNodes,\n\t\t\t\tn => n.tag.name.split('/'),\n\t\t\t\t(...paths) => paths.join('/'),\n\t\t\t\tthis.view.config.files.compact,\n\t\t\t);\n\n\t\t\tconst root = new BranchOrTagFolderNode(\n\t\t\t\tthis.view,\n\t\t\t\tthis,\n\t\t\t\t'tag',\n\t\t\t\tthis.repo.path,\n\t\t\t\t'',\n\t\t\t\tundefined,\n\t\t\t\thierarchy,\n\t\t\t\t'tags',\n\t\t\t);\n\t\t\tthis._children = root.getChildren();\n\t\t}\n\n\t\treturn this._children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Tags', TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\titem.contextValue = ContextValues.Tags;\n\t\titem.iconPath = new ThemeIcon('tag');\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh() {\n\t\tthis._children = undefined;\n\t}\n}\n","'use strict';\nimport { Disposable, MarkdownString, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport {\n\tGitBranch,\n\tGitRemote,\n\tGitStatus,\n\tRepository,\n\tRepositoryChange,\n\tRepositoryChangeComparisonMode,\n\tRepositoryChangeEvent,\n\tRepositoryFileSystemChangeEvent,\n} from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { Arrays, debug, Functions, gate, log, Strings } from '../../system';\nimport { RepositoriesView } from '../repositoriesView';\nimport { BranchesNode } from './branchesNode';\nimport { BranchNode } from './branchNode';\nimport { BranchTrackingStatusNode } from './branchTrackingStatusNode';\nimport { MessageNode } from './common';\nimport { CompareBranchNode } from './compareBranchNode';\nimport { ContributorsNode } from './contributorsNode';\nimport { MergeStatusNode } from './mergeStatusNode';\nimport { RebaseStatusNode } from './rebaseStatusNode';\nimport { ReflogNode } from './reflogNode';\nimport { RemotesNode } from './remotesNode';\nimport { StashesNode } from './stashesNode';\nimport { StatusFilesNode } from './statusFilesNode';\nimport { TagsNode } from './tagsNode';\nimport { ContextValues, SubscribeableViewNode, ViewNode } from './viewNode';\n\nexport class RepositoryNode extends SubscribeableViewNode<RepositoriesView> {\n\tstatic key = ':repository';\n\tstatic getId(repoPath: string): string {\n\t\treturn `gitlens${this.key}(${repoPath})`;\n\t}\n\n\tprivate _children: ViewNode[] | undefined;\n\tprivate _status: Promise<GitStatus | undefined>;\n\n\tconstructor(uri: GitUri, view: RepositoriesView, parent: ViewNode, public readonly repo: Repository) {\n\t\tsuper(uri, view, parent);\n\n\t\tthis._status = this.repo.getStatus();\n\t}\n\n\toverride toClipboard(): string {\n\t\treturn this.repo.path;\n\t}\n\n\toverride get id(): string {\n\t\treturn RepositoryNode.getId(this.repo.path);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._children === undefined) {\n\t\t\tconst children = [];\n\n\t\t\tconst status = await this._status;\n\t\t\tif (status != null) {\n\t\t\t\tconst branch = new GitBranch(\n\t\t\t\t\tstatus.repoPath,\n\t\t\t\t\tstatus.branch,\n\t\t\t\t\tfalse,\n\t\t\t\t\ttrue,\n\t\t\t\t\tundefined,\n\t\t\t\t\tstatus.sha,\n\t\t\t\t\tstatus.upstream ? { name: status.upstream, missing: false } : undefined,\n\t\t\t\t\tstatus.state.ahead,\n\t\t\t\t\tstatus.state.behind,\n\t\t\t\t\tstatus.detached,\n\t\t\t\t\tstatus.rebasing,\n\t\t\t\t);\n\n\t\t\t\tif (this.view.config.showBranchComparison !== false) {\n\t\t\t\t\tchildren.push(\n\t\t\t\t\t\tnew CompareBranchNode(\n\t\t\t\t\t\t\tthis.uri,\n\t\t\t\t\t\t\tthis.view,\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\tbranch,\n\t\t\t\t\t\t\tthis.view.config.showBranchComparison,\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tconst [mergeStatus, rebaseStatus] = await Promise.all([\n\t\t\t\t\tContainer.git.getMergeStatus(status.repoPath),\n\t\t\t\t\tContainer.git.getRebaseStatus(status.repoPath),\n\t\t\t\t]);\n\n\t\t\t\tif (mergeStatus != null) {\n\t\t\t\t\tchildren.push(new MergeStatusNode(this.view, this, branch, mergeStatus, status, true));\n\t\t\t\t} else if (rebaseStatus != null) {\n\t\t\t\t\tchildren.push(new RebaseStatusNode(this.view, this, branch, rebaseStatus, status, true));\n\t\t\t\t} else if (this.view.config.showUpstreamStatus) {\n\t\t\t\t\tif (status.upstream) {\n\t\t\t\t\t\tif (!status.state.behind && !status.state.ahead) {\n\t\t\t\t\t\t\tchildren.push(new BranchTrackingStatusNode(this.view, this, branch, status, 'same', true));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (status.state.behind) {\n\t\t\t\t\t\t\t\tchildren.push(\n\t\t\t\t\t\t\t\t\tnew BranchTrackingStatusNode(this.view, this, branch, status, 'behind', true),\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (status.state.ahead) {\n\t\t\t\t\t\t\t\tchildren.push(\n\t\t\t\t\t\t\t\t\tnew BranchTrackingStatusNode(this.view, this, branch, status, 'ahead', true, {\n\t\t\t\t\t\t\t\t\t\tshowAheadCommits: true,\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tchildren.push(new BranchTrackingStatusNode(this.view, this, branch, status, 'none', true));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.view.config.includeWorkingTree && status.files.length !== 0) {\n\t\t\t\t\tconst range = undefined; //status.upstream ? GitRevision.createRange(status.upstream, branch.ref) : undefined;\n\t\t\t\t\tchildren.push(new StatusFilesNode(this.view, this, status, range));\n\t\t\t\t}\n\n\t\t\t\tif (children.length !== 0 && !this.view.config.compact) {\n\t\t\t\t\tchildren.push(new MessageNode(this.view, this, '', GlyphChars.Dash.repeat(2), ''));\n\t\t\t\t}\n\n\t\t\t\tif (this.view.config.showCommits) {\n\t\t\t\t\tchildren.push(\n\t\t\t\t\t\tnew BranchNode(this.uri, this.view, this, branch, true, {\n\t\t\t\t\t\t\tshowAsCommits: true,\n\t\t\t\t\t\t\tshowComparison: false,\n\t\t\t\t\t\t\tshowCurrent: false,\n\t\t\t\t\t\t\tshowStatus: false,\n\t\t\t\t\t\t\tshowTracking: false,\n\t\t\t\t\t\t}),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.view.config.showBranches) {\n\t\t\t\tchildren.push(new BranchesNode(this.uri, this.view, this, this.repo));\n\t\t\t}\n\n\t\t\tif (this.view.config.showRemotes) {\n\t\t\t\tchildren.push(new RemotesNode(this.uri, this.view, this, this.repo));\n\t\t\t}\n\n\t\t\tif (this.view.config.showStashes) {\n\t\t\t\tchildren.push(new StashesNode(this.uri, this.view, this, this.repo));\n\t\t\t}\n\n\t\t\tif (this.view.config.showTags) {\n\t\t\t\tchildren.push(new TagsNode(this.uri, this.view, this, this.repo));\n\t\t\t}\n\n\t\t\tif (this.view.config.showContributors) {\n\t\t\t\tchildren.push(new ContributorsNode(this.uri, this.view, this, this.repo));\n\t\t\t}\n\n\t\t\tif (this.view.config.showIncomingActivity) {\n\t\t\t\tchildren.push(new ReflogNode(this.uri, this.view, this, this.repo));\n\t\t\t}\n\n\t\t\tthis._children = children;\n\t\t}\n\t\treturn this._children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tconst label = this.repo.formattedName ?? this.uri.repoPath ?? '';\n\n\t\tconst lastFetched = (await this.repo?.getLastFetched()) ?? 0;\n\n\t\tlet description;\n\t\tlet tooltip = `${this.repo.formattedName ?? this.uri.repoPath ?? ''}${\n\t\t\tlastFetched\n\t\t\t\t? `${Strings.pad(GlyphChars.Dash, 2, 2)}Last fetched ${Repository.formatLastFetched(\n\t\t\t\t\t\tlastFetched,\n\t\t\t\t\t\tfalse,\n\t\t\t\t  )}`\n\t\t\t\t: ''\n\t\t}${this.repo.formattedName ? `\\n${this.uri.repoPath}` : ''}`;\n\t\tlet iconSuffix = '';\n\t\tlet workingStatus = '';\n\n\t\tlet contextValue: string = ContextValues.Repository;\n\t\tif (this.repo.starred) {\n\t\t\tcontextValue += '+starred';\n\t\t}\n\n\t\tconst status = await this._status;\n\t\tif (status != null) {\n\t\t\ttooltip += `\\n\\nCurrent branch $(git-branch) ${status.branch}${status.rebasing ? ' (Rebasing)' : ''}`;\n\n\t\t\tif (this.view.config.includeWorkingTree && status.files.length !== 0) {\n\t\t\t\tworkingStatus = status.getFormattedDiffStatus({\n\t\t\t\t\tcompact: true,\n\t\t\t\t\tprefix: Strings.pad(GlyphChars.Dot, 1, 1),\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst upstreamStatus = status.getUpstreamStatus({\n\t\t\t\tsuffix: Strings.pad(GlyphChars.Dot, 1, 1),\n\t\t\t});\n\n\t\t\tdescription = `${upstreamStatus}${status.branch}${status.rebasing ? ' (Rebasing)' : ''}${workingStatus}`;\n\n\t\t\tlet providerName;\n\t\t\tif (status.upstream != null) {\n\t\t\t\tconst providers = GitRemote.getHighlanderProviders(await Container.git.getRemotes(status.repoPath));\n\t\t\t\tproviderName = providers?.length ? providers[0].name : undefined;\n\t\t\t} else {\n\t\t\t\tconst remote = await status.getRemote();\n\t\t\t\tproviderName = remote?.provider?.name;\n\t\t\t}\n\n\t\t\ticonSuffix = workingStatus ? '-blue' : '';\n\t\t\tif (status.upstream != null) {\n\t\t\t\ttooltip += ` is ${status.getUpstreamStatus({\n\t\t\t\t\tempty: `up to date with $(git-branch) ${status.upstream}${\n\t\t\t\t\t\tproviderName ? ` on ${providerName}` : ''\n\t\t\t\t\t}`,\n\t\t\t\t\texpand: true,\n\t\t\t\t\ticons: true,\n\t\t\t\t\tseparator: ', ',\n\t\t\t\t\tsuffix: ` $(git-branch) ${status.upstream}${providerName ? ` on ${providerName}` : ''}`,\n\t\t\t\t})}`;\n\n\t\t\t\tif (status.state.behind) {\n\t\t\t\t\tcontextValue += '+behind';\n\t\t\t\t\ticonSuffix = '-red';\n\t\t\t\t}\n\t\t\t\tif (status.state.ahead) {\n\t\t\t\t\ticonSuffix = status.state.behind ? '-yellow' : '-green';\n\t\t\t\t\tcontextValue += '+ahead';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (workingStatus) {\n\t\t\t\ttooltip += `\\n\\nWorking tree has uncommitted changes${status.getFormattedDiffStatus({\n\t\t\t\t\texpand: true,\n\t\t\t\t\tprefix: '\\n',\n\t\t\t\t\tseparator: '\\n',\n\t\t\t\t})}`;\n\t\t\t}\n\t\t}\n\n\t\tif (!this.repo.supportsChangeEvents) {\n\t\t\tdescription = `${Strings.pad(GlyphChars.Warning, 1, 0)}${\n\t\t\t\tdescription ? Strings.pad(description, 2, 0) : ''\n\t\t\t}`;\n\t\t\ttooltip += `\\n\\n${GlyphChars.Warning} Unable to automatically detect repository changes`;\n\t\t}\n\n\t\tconst item = new TreeItem(label, TreeItemCollapsibleState.Expanded);\n\t\titem.id = this.id;\n\t\titem.contextValue = contextValue;\n\t\titem.description = `${description ?? ''}${\n\t\t\tlastFetched\n\t\t\t\t? `${Strings.pad(GlyphChars.Dot, 1, 1)}Last fetched ${Repository.formatLastFetched(lastFetched)}`\n\t\t\t\t: ''\n\t\t}`;\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath(`images/dark/icon-repo${iconSuffix}.svg`),\n\t\t\tlight: Container.context.asAbsolutePath(`images/light/icon-repo${iconSuffix}.svg`),\n\t\t};\n\t\titem.tooltip = new MarkdownString(tooltip, true);\n\n\t\treturn item;\n\t}\n\n\t@log()\n\tfetch(options: { all?: boolean; progress?: boolean; prune?: boolean; remote?: string } = {}) {\n\t\treturn this.repo.fetch(options);\n\t}\n\n\t@log()\n\tpull(options: { progress?: boolean; rebase?: boolean } = {}) {\n\t\treturn this.repo.pull(options);\n\t}\n\n\t@log()\n\tpush(options: { force?: boolean; progress?: boolean } = {}) {\n\t\treturn this.repo.push(options);\n\t}\n\n\t@gate()\n\t@debug()\n\toverride async refresh(reset: boolean = false) {\n\t\tif (reset) {\n\t\t\tthis._status = this.repo.getStatus();\n\n\t\t\tthis._children = undefined;\n\t\t}\n\n\t\tawait this.ensureSubscription();\n\t}\n\n\t@log()\n\tasync star() {\n\t\tawait this.repo.star();\n\t\tvoid this.parent!.triggerChange();\n\t}\n\n\t@log()\n\tasync unstar() {\n\t\tawait this.repo.unstar();\n\t\tvoid this.parent!.triggerChange();\n\t}\n\n\t@debug()\n\tprotected async subscribe() {\n\t\tconst lastFetched = (await this.repo?.getLastFetched()) ?? 0;\n\n\t\tconst disposables = [this.repo.onDidChange(this.onRepositoryChanged, this)];\n\n\t\tconst interval = Repository.getLastFetchedUpdateInterval(lastFetched);\n\t\tif (lastFetched !== 0 && interval > 0) {\n\t\t\tdisposables.push(\n\t\t\t\tFunctions.interval(() => {\n\t\t\t\t\t// Check if the interval should change, and if so, reset it\n\t\t\t\t\tif (interval !== Repository.getLastFetchedUpdateInterval(lastFetched)) {\n\t\t\t\t\t\tvoid this.resetSubscription();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.splatted) {\n\t\t\t\t\t\tvoid this.view.triggerNodeChange(this.parent ?? this);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvoid this.view.triggerNodeChange(this);\n\t\t\t\t\t}\n\t\t\t\t}, interval),\n\t\t\t);\n\t\t}\n\n\t\tif (this.view.config.includeWorkingTree) {\n\t\t\tdisposables.push(\n\t\t\t\tthis.repo.onDidChangeFileSystem(this.onFileSystemChanged, this),\n\t\t\t\tthis.repo.startWatchingFileSystem(),\n\t\t\t);\n\t\t}\n\n\t\treturn Disposable.from(...disposables);\n\t}\n\n\tprotected override get requiresResetOnVisible(): boolean {\n\t\treturn this._repoUpdatedAt !== this.repo.updatedAt;\n\t}\n\n\tprivate _repoUpdatedAt: number = this.repo.updatedAt;\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (e: RepositoryFileSystemChangeEvent) =>\n\t\t\t\t`{ repository: ${e.repository?.name ?? ''}, uris(${e.uris.length}): [${e.uris\n\t\t\t\t\t.slice(0, 1)\n\t\t\t\t\t.map(u => u.fsPath)\n\t\t\t\t\t.join(', ')}${e.uris.length > 1 ? ', ...' : ''}] }`,\n\t\t},\n\t})\n\tprivate async onFileSystemChanged(_e: RepositoryFileSystemChangeEvent) {\n\t\tthis._repoUpdatedAt = this.repo.updatedAt;\n\n\t\tthis._status = this.repo.getStatus();\n\n\t\tif (this._children !== undefined) {\n\t\t\tconst status = await this._status;\n\n\t\t\tlet index = this._children.findIndex(c => c instanceof StatusFilesNode);\n\t\t\tif (status !== undefined && (status.state.ahead || status.files.length !== 0)) {\n\t\t\t\tlet deleteCount = 1;\n\t\t\t\tif (index === -1) {\n\t\t\t\t\tindex = Arrays.findLastIndex(\n\t\t\t\t\t\tthis._children,\n\t\t\t\t\t\tc => c instanceof BranchTrackingStatusNode || c instanceof BranchNode,\n\t\t\t\t\t);\n\t\t\t\t\tdeleteCount = 0;\n\t\t\t\t\tindex++;\n\t\t\t\t}\n\n\t\t\t\tconst range = undefined; //status.upstream ? GitRevision.createRange(status.upstream, status.sha) : undefined;\n\t\t\t\tthis._children.splice(index, deleteCount, new StatusFilesNode(this.view, this, status, range));\n\t\t\t} else if (index !== -1) {\n\t\t\t\tthis._children.splice(index, 1);\n\t\t\t}\n\t\t}\n\n\t\tvoid this.triggerChange(false);\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (e: RepositoryChangeEvent) => e.toString(),\n\t\t},\n\t})\n\tprivate onRepositoryChanged(e: RepositoryChangeEvent) {\n\t\tthis._repoUpdatedAt = this.repo.updatedAt;\n\n\t\tif (e.changed(RepositoryChange.Closed, RepositoryChangeComparisonMode.Any)) {\n\t\t\tthis.dispose();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tthis._children == null ||\n\t\t\te.changed(\n\t\t\t\tRepositoryChange.Config,\n\t\t\t\tRepositoryChange.Index,\n\t\t\t\tRepositoryChange.Heads,\n\t\t\t\tRepositoryChange.Status,\n\t\t\t\tRepositoryChange.Unknown,\n\t\t\t\tRepositoryChangeComparisonMode.Any,\n\t\t\t)\n\t\t) {\n\t\t\tvoid this.triggerChange(true);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.changed(RepositoryChange.Remotes, RepositoryChange.RemoteProviders, RepositoryChangeComparisonMode.Any)) {\n\t\t\tconst node = this._children.find(c => c instanceof RemotesNode);\n\t\t\tif (node != null) {\n\t\t\t\tvoid this.view.triggerNodeChange(node);\n\t\t\t}\n\t\t}\n\n\t\tif (e.changed(RepositoryChange.Stash, RepositoryChangeComparisonMode.Any)) {\n\t\t\tconst node = this._children.find(c => c instanceof StashesNode);\n\t\t\tif (node != null) {\n\t\t\t\tvoid this.view.triggerNodeChange(node);\n\t\t\t}\n\t\t}\n\n\t\tif (e.changed(RepositoryChange.Tags, RepositoryChangeComparisonMode.Any)) {\n\t\t\tconst node = this._children.find(c => c instanceof TagsNode);\n\t\t\tif (node != null) {\n\t\t\t\tvoid this.view.triggerNodeChange(node);\n\t\t\t}\n\t\t}\n\t}\n}\n","'use strict';\nimport { ThemeColor, ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Colors } from '../../constants';\nimport { GitBranch, GitCommit, PullRequest, PullRequestState } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { BranchesView } from '../branchesView';\nimport { CommitsView } from '../commitsView';\nimport { ContributorsView } from '../contributorsView';\nimport { RemotesView } from '../remotesView';\nimport { RepositoriesView } from '../repositoriesView';\nimport { SearchAndCompareView } from '../searchAndCompareView';\nimport { RepositoryNode } from './repositoryNode';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport class PullRequestNode extends ViewNode<\n\tBranchesView | CommitsView | ContributorsView | RemotesView | RepositoriesView | SearchAndCompareView\n> {\n\tstatic key = ':pullrequest';\n\tstatic getId(repoPath: string, id: string, ref: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${id}):${ref}`;\n\t}\n\n\tconstructor(\n\t\tview: BranchesView | CommitsView | ContributorsView | RemotesView | RepositoriesView | SearchAndCompareView,\n\t\tparent: ViewNode,\n\t\tpublic readonly pullRequest: PullRequest,\n\t\tpublic readonly branchOrCommit: GitBranch | GitCommit,\n\t) {\n\t\tsuper(GitUri.fromRepoPath(branchOrCommit.repoPath), view, parent);\n\t}\n\n\toverride toClipboard(): string {\n\t\treturn this.pullRequest.url;\n\t}\n\n\toverride get id(): string {\n\t\treturn PullRequestNode.getId(this.branchOrCommit.repoPath, this.pullRequest.id, this.branchOrCommit.ref);\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\treturn [];\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(`#${this.pullRequest.id}: ${this.pullRequest.title}`, TreeItemCollapsibleState.None);\n\t\titem.id = this.id;\n\t\titem.contextValue = ContextValues.PullRequest;\n\t\titem.description = `${this.pullRequest.state}, ${this.pullRequest.formatDateFromNow()}`;\n\t\titem.iconPath = new ThemeIcon(\n\t\t\t'git-pull-request',\n\t\t\tnew ThemeColor(\n\t\t\t\tthis.pullRequest.state === PullRequestState.Closed\n\t\t\t\t\t? Colors.ClosedPullRequestIconColor\n\t\t\t\t\t: this.pullRequest.state === PullRequestState.Merged\n\t\t\t\t\t? Colors.MergedPullRequestIconColor\n\t\t\t\t\t: Colors.OpenPullRequestIconColor,\n\t\t\t),\n\t\t);\n\t\titem.tooltip = `${this.pullRequest.title}\\n#${this.pullRequest.id} by ${this.pullRequest.author.name} was ${\n\t\t\tthis.pullRequest.state === PullRequestState.Open ? 'opened' : this.pullRequest.state.toLowerCase()\n\t\t} ${this.pullRequest.formatDateFromNow()}`;\n\n\t\tif (this.branchOrCommit instanceof GitCommit) {\n\t\t\titem.tooltip = `Commit ${this.branchOrCommit.shortSha} was introduced by PR #${this.pullRequest.id}\\n${item.tooltip}`;\n\t\t}\n\n\t\t// item.tooltip = `Open Pull Request #${this.pullRequest.number} on ${this.pullRequest.provider}`;\n\t\t// item.command = {\n\t\t// \ttitle: 'Open Pull Request',\n\t\t// \tcommand: Commands.OpenPullRequestOnRemote,\n\t\t// \targuments: [this],\n\t\t// };\n\n\t\treturn item;\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { Command, MarkdownString, ThemeColor, ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Commands, DiffWithPreviousCommandArgs } from '../../commands';\nimport { ViewFilesLayout } from '../../configuration';\nimport { Colors, GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { CommitFormatter, GitBranch, GitLogCommit, GitRevisionReference } from '../../git/git';\nimport { Arrays, Strings } from '../../system';\nimport { FileHistoryView } from '../fileHistoryView';\nimport { TagsView } from '../tagsView';\nimport { ViewsWithCommits } from '../viewBase';\nimport { CommitFileNode } from './commitFileNode';\nimport { FileNode, FolderNode } from './folderNode';\nimport { PullRequestNode } from './pullRequestNode';\nimport { ContextValues, ViewNode, ViewRefNode } from './viewNode';\n\nexport class CommitNode extends ViewRefNode<ViewsWithCommits | FileHistoryView, GitRevisionReference> {\n\tconstructor(\n\t\tview: ViewsWithCommits | FileHistoryView,\n\t\tparent: ViewNode,\n\t\tpublic readonly commit: GitLogCommit,\n\t\tprivate readonly unpublished?: boolean,\n\t\tpublic readonly branch?: GitBranch,\n\t\tprivate readonly getBranchAndTagTips?: (sha: string, options?: { compact?: boolean }) => string | undefined,\n\t\tprivate readonly _options: { expand?: boolean } = {},\n\t) {\n\t\tsuper(commit.toGitUri(), view, parent);\n\t}\n\n\toverride toClipboard(): string {\n\t\tlet message = this.commit.message;\n\t\tconst index = message.indexOf('\\n');\n\t\tif (index !== -1) {\n\t\t\tmessage = `${message.substring(0, index)}${GlyphChars.Space}${GlyphChars.Ellipsis}`;\n\t\t}\n\n\t\treturn `${this.commit.shortSha}: ${message}`;\n\t}\n\n\tget isTip(): boolean {\n\t\treturn (this.branch?.current && this.branch.sha === this.commit.ref) ?? false;\n\t}\n\n\tget ref(): GitRevisionReference {\n\t\treturn this.commit;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst commit = this.commit;\n\n\t\tlet children: (PullRequestNode | FileNode)[] = commit.files.map(\n\t\t\ts => new CommitFileNode(this.view, this, s, commit.toFileCommit(s)!),\n\t\t);\n\n\t\tif (this.view.config.files.layout !== ViewFilesLayout.List) {\n\t\t\tconst hierarchy = Arrays.makeHierarchical(\n\t\t\t\tchildren as FileNode[],\n\t\t\t\tn => n.uri.relativePath.split('/'),\n\t\t\t\t(...parts: string[]) => Strings.normalizePath(paths.join(...parts)),\n\t\t\t\tthis.view.config.files.compact,\n\t\t\t);\n\n\t\t\tconst root = new FolderNode(this.view, this, this.repoPath, '', hierarchy);\n\t\t\tchildren = root.getChildren() as FileNode[];\n\t\t} else {\n\t\t\t(children as FileNode[]).sort((a, b) =>\n\t\t\t\ta.label!.localeCompare(b.label!, undefined, { numeric: true, sensitivity: 'base' }),\n\t\t\t);\n\t\t}\n\n\t\tif (!(this.view instanceof TagsView) && !(this.view instanceof FileHistoryView)) {\n\t\t\tif (this.view.config.pullRequests.enabled && this.view.config.pullRequests.showForCommits) {\n\t\t\t\tconst pr = await commit.getAssociatedPullRequest();\n\t\t\t\tif (pr != null) {\n\t\t\t\t\tchildren.splice(0, 0, new PullRequestNode(this.view, this, pr, commit));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tconst label = CommitFormatter.fromTemplate(this.view.config.formats.commits.label, this.commit, {\n\t\t\tdateFormat: Container.config.defaultDateFormat,\n\t\t\tgetBranchAndTagTips: (sha: string) => this.getBranchAndTagTips?.(sha, { compact: true }),\n\t\t\tmessageTruncateAtNewLine: true,\n\t\t});\n\n\t\tconst item = new TreeItem(\n\t\t\tlabel,\n\t\t\tthis._options.expand ? TreeItemCollapsibleState.Expanded : TreeItemCollapsibleState.Collapsed,\n\t\t);\n\n\t\titem.contextValue = `${ContextValues.Commit}${this.branch?.current ? '+current' : ''}${\n\t\t\tthis.isTip ? '+HEAD' : ''\n\t\t}${this.unpublished ? '+unpublished' : ''}`;\n\n\t\titem.description = CommitFormatter.fromTemplate(this.view.config.formats.commits.description, this.commit, {\n\t\t\tdateFormat: Container.config.defaultDateFormat,\n\t\t\tgetBranchAndTagTips: (sha: string) => this.getBranchAndTagTips?.(sha, { compact: true }),\n\t\t\tmessageTruncateAtNewLine: true,\n\t\t});\n\t\titem.iconPath = this.unpublished\n\t\t\t? new ThemeIcon('arrow-up', new ThemeColor(Colors.UnpublishedCommitIconColor))\n\t\t\t: this.view.config.avatars\n\t\t\t? await this.commit.getAvatarUri({ defaultStyle: Container.config.defaultGravatarsStyle })\n\t\t\t: new ThemeIcon('git-commit');\n\t\t// item.tooltip = this.tooltip;\n\n\t\treturn item;\n\t}\n\n\toverride getCommand(): Command | undefined {\n\t\tconst commandArgs: DiffWithPreviousCommandArgs = {\n\t\t\tcommit: this.commit,\n\t\t\turi: this.uri,\n\t\t\tline: 0,\n\t\t\tshowOptions: {\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpreview: true,\n\t\t\t},\n\t\t};\n\t\treturn {\n\t\t\ttitle: 'Open Changes with Previous Revision',\n\t\t\tcommand: Commands.DiffWithPrevious,\n\t\t\targuments: [undefined, commandArgs],\n\t\t};\n\t}\n\n\toverride async resolveTreeItem(item: TreeItem): Promise<TreeItem> {\n\t\tif (item.tooltip == null) {\n\t\t\titem.tooltip = await this.getTooltip();\n\t\t}\n\t\treturn item;\n\t}\n\n\tprivate async getTooltip() {\n\t\tconst remotes = await Container.git.getRemotes(this.commit.repoPath);\n\t\tconst remote = await Container.git.getRichRemoteProvider(remotes);\n\n\t\tlet autolinkedIssuesOrPullRequests;\n\t\tlet pr;\n\n\t\tif (remote?.provider != null) {\n\t\t\t[autolinkedIssuesOrPullRequests, pr] = await Promise.all([\n\t\t\t\tContainer.autolinks.getIssueOrPullRequestLinks(this.commit.message, remote),\n\t\t\t\tContainer.git.getPullRequestForCommit(this.commit.ref, remote.provider),\n\t\t\t]);\n\t\t}\n\n\t\tconst tooltip = await CommitFormatter.fromTemplateAsync(\n\t\t\t`\\${'$(git-commit) 'id}\\${' via 'pullRequest}\\${ \\u2022 changesDetail}\\${'&nbsp;&nbsp;&nbsp;'tips}\\n\\n\\${avatar} &nbsp;__\\${author}__, \\${ago} &nbsp; _(\\${date})_ \\n\\n\\${message}\\${\\n\\n---\\n\\nfootnotes}`,\n\t\t\tthis.commit,\n\t\t\t{\n\t\t\t\tautolinkedIssuesOrPullRequests: autolinkedIssuesOrPullRequests,\n\t\t\t\tdateFormat: Container.config.defaultDateFormat,\n\t\t\t\tgetBranchAndTagTips: this.getBranchAndTagTips,\n\t\t\t\tmarkdown: true,\n\t\t\t\tmessageAutolinks: true,\n\t\t\t\tmessageIndent: 4,\n\t\t\t\tpullRequestOrRemote: pr,\n\t\t\t\tremotes: remotes,\n\t\t\t\tunpublished: this.unpublished,\n\t\t\t},\n\t\t);\n\n\t\tconst markdown = new MarkdownString(tooltip, true);\n\t\tmarkdown.isTrusted = true;\n\n\t\treturn markdown;\n\t}\n}\n","'use strict';\nimport { MarkdownString, ThemeColor, ThemeIcon, TreeItem, TreeItemCollapsibleState, window } from 'vscode';\nimport { Colors } from '../../constants';\nimport { Container } from '../../container';\nimport { GitBranch, GitLog, GitRemote, GitRevision, GitTrackingState } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { Dates, debug, gate, Iterables, Strings } from '../../system';\nimport { ViewsWithCommits } from '../viewBase';\nimport { BranchNode } from './branchNode';\nimport { BranchTrackingStatusFilesNode } from './branchTrackingStatusFilesNode';\nimport { CommitNode } from './commitNode';\nimport { LoadMoreNode } from './common';\nimport { insertDateMarkers } from './helpers';\nimport { ContextValues, PageableViewNode, ViewNode } from './viewNode';\n\nexport interface BranchTrackingStatus {\n\tref: string;\n\trepoPath: string;\n\tstate: GitTrackingState;\n\tupstream?: string;\n}\n\nexport class BranchTrackingStatusNode extends ViewNode<ViewsWithCommits> implements PageableViewNode {\n\tstatic key = ':status-branch:upstream';\n\tstatic getId(\n\t\trepoPath: string,\n\t\tname: string,\n\t\troot: boolean,\n\t\tupstream: string | undefined,\n\t\tupstreamType: string,\n\t): string {\n\t\treturn `${BranchNode.getId(repoPath, name, root)}${this.key}(${upstream ?? ''}):${upstreamType}`;\n\t}\n\n\tprivate readonly options: {\n\t\tshowAheadCommits?: boolean;\n\t};\n\n\tconstructor(\n\t\tview: ViewsWithCommits,\n\t\tparent: ViewNode,\n\t\tpublic readonly branch: GitBranch,\n\t\tpublic readonly status: BranchTrackingStatus,\n\t\tpublic readonly upstreamType: 'ahead' | 'behind' | 'same' | 'none',\n\t\t// Specifies that the node is shown as a root\n\t\tpublic readonly root: boolean = false,\n\t\toptions?: {\n\t\t\tshowAheadCommits?: boolean;\n\t\t},\n\t) {\n\t\tsuper(GitUri.fromRepoPath(status.repoPath), view, parent);\n\n\t\tthis.options = { showAheadCommits: false, ...options };\n\t}\n\n\toverride get id(): string {\n\t\treturn BranchTrackingStatusNode.getId(\n\t\t\tthis.status.repoPath,\n\t\t\tthis.status.ref,\n\t\t\tthis.root,\n\t\t\tthis.status.upstream,\n\t\t\tthis.upstreamType,\n\t\t);\n\t}\n\n\tget repoPath(): string {\n\t\treturn this.uri.repoPath!;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this.upstreamType === 'same' || this.upstreamType === 'none') return [];\n\n\t\tconst log = await this.getLog();\n\t\tif (log == null) return [];\n\n\t\tlet commits;\n\t\tif (this.upstreamType === 'ahead') {\n\t\t\t// Since the last commit when we are looking 'ahead' can have no previous (because of the range given) -- look it up\n\t\t\tcommits = [...log.commits.values()];\n\t\t\tconst commit = commits[commits.length - 1];\n\t\t\tif (commit.previousSha == null) {\n\t\t\t\tconst previousLog = await Container.git.getLog(this.uri.repoPath!, { limit: 2, ref: commit.sha });\n\t\t\t\tif (previousLog != null) {\n\t\t\t\t\tcommits[commits.length - 1] = Iterables.first(previousLog.commits.values());\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tcommits = log.commits.values();\n\t\t}\n\n\t\tconst children = [];\n\n\t\tlet showFiles = true;\n\t\tif (\n\t\t\t!this.options.showAheadCommits &&\n\t\t\tthis.upstreamType === 'ahead' &&\n\t\t\tthis.status.upstream &&\n\t\t\tthis.status.state.ahead > 0\n\t\t) {\n\t\t\tshowFiles = false;\n\t\t\t// TODO@eamodio fix this\n\t\t\tchildren.push(\n\t\t\t\t...(await new BranchTrackingStatusFilesNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\tthis.branch,\n\t\t\t\t\tthis.status as Required<BranchTrackingStatus>,\n\t\t\t\t\tthis.upstreamType,\n\t\t\t\t\tthis.root,\n\t\t\t\t).getChildren()),\n\t\t\t);\n\t\t} else {\n\t\t\tchildren.push(\n\t\t\t\t...insertDateMarkers(\n\t\t\t\t\tIterables.map(\n\t\t\t\t\t\tcommits,\n\t\t\t\t\t\tc => new CommitNode(this.view, this, c, this.upstreamType === 'ahead', this.branch),\n\t\t\t\t\t),\n\t\t\t\t\tthis,\n\t\t\t\t\t1,\n\t\t\t\t),\n\t\t\t);\n\n\t\t\tif (log.hasMore) {\n\t\t\t\tchildren.push(new LoadMoreNode(this.view, this, children[children.length - 1]));\n\t\t\t}\n\t\t}\n\n\t\tif (showFiles) {\n\t\t\tchildren.splice(\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\tnew BranchTrackingStatusFilesNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\tthis.branch,\n\t\t\t\t\tthis.status as Required<BranchTrackingStatus>,\n\t\t\t\t\tthis.upstreamType,\n\t\t\t\t\tthis.root,\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tlet lastFetched = 0;\n\n\t\tif (this.upstreamType !== 'none') {\n\t\t\tconst repo = await Container.git.getRepository(this.repoPath);\n\t\t\tlastFetched = (await repo?.getLastFetched()) ?? 0;\n\t\t}\n\n\t\tlet label;\n\t\tlet description;\n\t\tlet collapsibleState;\n\t\tlet contextValue;\n\t\tlet icon;\n\t\tlet tooltip;\n\t\tswitch (this.upstreamType) {\n\t\t\tcase 'ahead': {\n\t\t\t\tconst remote = await this.branch.getRemote();\n\n\t\t\t\tlabel = `Changes to push to ${remote?.name ?? GitBranch.getRemote(this.status.upstream!)}${\n\t\t\t\t\tremote?.provider?.name ? ` on ${remote?.provider.name}` : ''\n\t\t\t\t}`;\n\t\t\t\tdescription = Strings.pluralize('commit', this.status.state.ahead);\n\t\t\t\ttooltip = `Branch $(git-branch) ${this.branch.name} is ${Strings.pluralize(\n\t\t\t\t\t'commit',\n\t\t\t\t\tthis.status.state.ahead,\n\t\t\t\t\t{ infix: '$(arrow-up) ' },\n\t\t\t\t)} ahead of $(git-branch) ${this.status.upstream}${\n\t\t\t\t\tremote?.provider?.name ? ` on ${remote.provider.name}` : ''\n\t\t\t\t}`;\n\n\t\t\t\tcollapsibleState = TreeItemCollapsibleState.Collapsed;\n\t\t\t\tcontextValue = this.root\n\t\t\t\t\t? ContextValues.StatusAheadOfUpstream\n\t\t\t\t\t: ContextValues.BranchStatusAheadOfUpstream;\n\t\t\t\ticon = new ThemeIcon('cloud-upload', new ThemeColor(Colors.UnpushlishedChangesIconColor));\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'behind': {\n\t\t\t\tconst remote = await this.branch.getRemote();\n\n\t\t\t\tlabel = `Changes to pull from ${remote?.name ?? GitBranch.getRemote(this.status.upstream!)}${\n\t\t\t\t\tremote?.provider?.name ? ` on ${remote.provider.name}` : ''\n\t\t\t\t}`;\n\t\t\t\tdescription = Strings.pluralize('commit', this.status.state.behind);\n\t\t\t\ttooltip = `Branch $(git-branch) ${this.branch.name} is ${Strings.pluralize(\n\t\t\t\t\t'commit',\n\t\t\t\t\tthis.status.state.behind,\n\t\t\t\t\t{ infix: '$(arrow-down) ' },\n\t\t\t\t)} behind $(git-branch) ${this.status.upstream}${\n\t\t\t\t\tremote?.provider?.name ? ` on ${remote.provider.name}` : ''\n\t\t\t\t}`;\n\n\t\t\t\tcollapsibleState = TreeItemCollapsibleState.Collapsed;\n\t\t\t\tcontextValue = this.root\n\t\t\t\t\t? ContextValues.StatusBehindUpstream\n\t\t\t\t\t: ContextValues.BranchStatusBehindUpstream;\n\t\t\t\ticon = new ThemeIcon('cloud-download', new ThemeColor(Colors.UnpulledChangesIconColor));\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'same': {\n\t\t\t\tconst remote = await this.branch.getRemote();\n\n\t\t\t\tlabel = `Up to date with ${remote?.name ?? GitBranch.getRemote(this.status.upstream!)}${\n\t\t\t\t\tremote?.provider?.name ? ` on ${remote.provider.name}` : ''\n\t\t\t\t}`;\n\t\t\t\tdescription = lastFetched ? `Last fetched ${Dates.getFormatter(new Date(lastFetched)).fromNow()}` : '';\n\t\t\t\ttooltip = `Branch $(git-branch) ${this.branch.name} is up to date with $(git-branch) ${\n\t\t\t\t\tthis.status.upstream\n\t\t\t\t}${remote?.provider?.name ? ` on ${remote.provider.name}` : ''}`;\n\n\t\t\t\tcollapsibleState = TreeItemCollapsibleState.None;\n\t\t\t\tcontextValue = this.root\n\t\t\t\t\t? ContextValues.StatusSameAsUpstream\n\t\t\t\t\t: ContextValues.BranchStatusSameAsUpstream;\n\t\t\t\ticon = new ThemeIcon('cloud');\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'none': {\n\t\t\t\tconst remotes = await Container.git.getRemotes(this.branch.repoPath);\n\t\t\t\tconst providers = GitRemote.getHighlanderProviders(remotes);\n\t\t\t\tconst providerName = providers?.length ? providers[0].name : undefined;\n\n\t\t\t\tlabel = `Publish ${this.branch.name} to ${providerName ?? 'a remote'}`;\n\t\t\t\ttooltip = `Branch $(git-branch) ${this.branch.name} hasn't been published to ${\n\t\t\t\t\tproviderName ?? 'a remote'\n\t\t\t\t}`;\n\n\t\t\t\tcollapsibleState = TreeItemCollapsibleState.None;\n\t\t\t\tcontextValue = this.root ? ContextValues.StatusNoUpstream : ContextValues.BranchStatusNoUpstream;\n\t\t\t\ticon = new ThemeIcon(\n\t\t\t\t\t'cloud-upload',\n\t\t\t\t\tremotes.length ? new ThemeColor(Colors.UnpushlishedChangesIconColor) : undefined,\n\t\t\t\t);\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tconst item = new TreeItem(label, collapsibleState);\n\t\titem.id = this.id;\n\t\titem.contextValue = contextValue;\n\t\titem.description = description;\n\t\tif (lastFetched) {\n\t\t\ttooltip += `\\n\\nLast fetched ${Dates.getFormatter(new Date(lastFetched)).fromNow()}`;\n\t\t}\n\t\titem.iconPath = icon;\n\t\titem.tooltip = new MarkdownString(tooltip, true);\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset?: boolean) {\n\t\tif (reset) {\n\t\t\tthis._log = undefined;\n\t\t}\n\t}\n\n\tprivate _log: GitLog | undefined;\n\tprivate async getLog() {\n\t\tif (this.upstreamType === 'same' || this.upstreamType === 'none') return undefined;\n\n\t\tif (this._log == null) {\n\t\t\tconst range =\n\t\t\t\tthis.upstreamType === 'ahead'\n\t\t\t\t\t? GitRevision.createRange(this.status.upstream, this.status.ref)\n\t\t\t\t\t: GitRevision.createRange(this.status.ref, this.status.upstream);\n\n\t\t\tthis._log = await Container.git.getLog(this.uri.repoPath!, {\n\t\t\t\tlimit: this.limit ?? this.view.config.defaultItemLimit,\n\t\t\t\tref: range,\n\t\t\t});\n\t\t}\n\n\t\treturn this._log;\n\t}\n\n\tget hasMore() {\n\t\treturn this._log?.hasMore ?? true;\n\t}\n\n\tlimit: number | undefined = this.view.getNodeLastKnownLimit(this);\n\t@gate()\n\tasync loadMore(limit?: number | { until?: any }) {\n\t\tlet log = await window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: { viewId: this.view.id },\n\t\t\t},\n\t\t\t() => this.getLog(),\n\t\t);\n\t\tif (log == null || !log.hasMore) return;\n\n\t\tlog = await log.more?.(limit ?? this.view.config.pageItemLimit);\n\t\tif (this._log === log) return;\n\n\t\tthis._log = log;\n\t\tthis.limit = log?.count;\n\n\t\tvoid this.triggerChange(false);\n\t}\n}\n","'use strict';\nimport { MarkdownString, ThemeColor, ThemeIcon, TreeItem, TreeItemCollapsibleState, Uri, window } from 'vscode';\nimport { ViewBranchesLayout, ViewShowBranchComparison } from '../../configuration';\nimport { Colors, GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport {\n\tBranchDateFormatting,\n\tGitBranch,\n\tGitBranchReference,\n\tGitLog,\n\tGitRemote,\n\tGitRemoteType,\n\tPullRequestState,\n} from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { debug, gate, Iterables, log, Strings } from '../../system';\nimport { BranchesView } from '../branchesView';\nimport { CommitsView } from '../commitsView';\nimport { RemotesView } from '../remotesView';\nimport { RepositoriesView } from '../repositoriesView';\nimport { BranchTrackingStatusNode } from './branchTrackingStatusNode';\nimport { CommitNode } from './commitNode';\nimport { LoadMoreNode, MessageNode } from './common';\nimport { CompareBranchNode } from './compareBranchNode';\nimport { insertDateMarkers } from './helpers';\nimport { MergeStatusNode } from './mergeStatusNode';\nimport { PullRequestNode } from './pullRequestNode';\nimport { RebaseStatusNode } from './rebaseStatusNode';\nimport { RepositoryNode } from './repositoryNode';\nimport { ContextValues, PageableViewNode, ViewNode, ViewRefNode } from './viewNode';\n\nexport class BranchNode\n\textends ViewRefNode<BranchesView | CommitsView | RemotesView | RepositoriesView, GitBranchReference>\n\timplements PageableViewNode\n{\n\tstatic key = ':branch';\n\tstatic getId(repoPath: string, name: string, root: boolean): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${name})${root ? ':root' : ''}`;\n\t}\n\n\tprivate _children: ViewNode[] | undefined;\n\tprivate readonly options: {\n\t\texpanded: boolean;\n\t\tlimitCommits: boolean;\n\t\tshowAsCommits: boolean;\n\t\tshowComparison: false | ViewShowBranchComparison;\n\t\tshowCurrent: boolean;\n\t\tshowStatus: boolean;\n\t\tshowTracking: boolean;\n\t\tauthors?: string[];\n\t};\n\tprotected override splatted = true;\n\n\tconstructor(\n\t\turi: GitUri,\n\t\tview: BranchesView | CommitsView | RemotesView | RepositoriesView,\n\t\tparent: ViewNode,\n\t\tpublic readonly branch: GitBranch,\n\t\t// Specifies that the node is shown as a root\n\t\tpublic readonly root: boolean,\n\n\t\toptions?: {\n\t\t\texpanded?: boolean;\n\t\t\tlimitCommits?: boolean;\n\t\t\tshowAsCommits?: boolean;\n\t\t\tshowComparison?: false | ViewShowBranchComparison;\n\t\t\tshowCurrent?: boolean;\n\t\t\tshowStatus?: boolean;\n\t\t\tshowTracking?: boolean;\n\t\t\tauthors?: string[];\n\t\t},\n\t) {\n\t\tsuper(uri, view, parent);\n\n\t\tthis.options = {\n\t\t\texpanded: false,\n\t\t\tlimitCommits: false,\n\t\t\tshowAsCommits: false,\n\t\t\tshowComparison: false,\n\t\t\t// Hide the current branch checkmark when the node is displayed as a root\n\t\t\tshowCurrent: !this.root,\n\t\t\t// Don't show merge/rebase status info the node is displayed as a root\n\t\t\tshowStatus: true, //!this.root,\n\t\t\t// Don't show tracking info the node is displayed as a root\n\t\t\tshowTracking: !this.root,\n\t\t\t...options,\n\t\t};\n\t}\n\n\toverride toClipboard(): string {\n\t\treturn this.branch.name;\n\t}\n\n\toverride get id(): string {\n\t\treturn BranchNode.getId(this.branch.repoPath, this.branch.name, this.root);\n\t}\n\n\tcompacted: boolean = false;\n\n\tget current(): boolean {\n\t\treturn this.branch.current;\n\t}\n\n\tget label(): string {\n\t\tif (this.options.showAsCommits) return 'Commits';\n\n\t\tconst branchName = this.branch.getNameWithoutRemote();\n\t\treturn `${\n\t\t\tthis.view.config.branches?.layout !== ViewBranchesLayout.Tree ||\n\t\t\tthis.compacted ||\n\t\t\tthis.root ||\n\t\t\tthis.current ||\n\t\t\tthis.branch.detached ||\n\t\t\tthis.branch.starred\n\t\t\t\t? branchName\n\t\t\t\t: this.branch.getBasename()\n\t\t}${this.branch.rebasing ? ' (Rebasing)' : ''}`;\n\t}\n\n\tget ref(): GitBranchReference {\n\t\treturn this.branch;\n\t}\n\n\tget treeHierarchy(): string[] {\n\t\treturn this.root || this.current || this.branch.detached || this.branch.starred\n\t\t\t? [this.branch.name]\n\t\t\t: this.branch.getNameWithoutRemote().split('/');\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._children == null) {\n\t\t\tconst children = [];\n\n\t\t\tconst range = await Container.git.getBranchAheadRange(this.branch);\n\t\t\tconst [log, getBranchAndTagTips, status, mergeStatus, rebaseStatus, pr, unpublishedCommits] =\n\t\t\t\tawait Promise.all([\n\t\t\t\t\tthis.getLog(),\n\t\t\t\t\tContainer.git.getBranchesAndTagsTipsFn(this.uri.repoPath, this.branch.name),\n\t\t\t\t\tthis.options.showStatus && this.branch.current\n\t\t\t\t\t\t? Container.git.getStatusForRepo(this.uri.repoPath)\n\t\t\t\t\t\t: undefined,\n\t\t\t\t\tthis.options.showStatus && this.branch.current\n\t\t\t\t\t\t? Container.git.getMergeStatus(this.uri.repoPath!)\n\t\t\t\t\t\t: undefined,\n\t\t\t\t\tthis.options.showStatus ? Container.git.getRebaseStatus(this.uri.repoPath!) : undefined,\n\t\t\t\t\tthis.view.config.pullRequests.enabled &&\n\t\t\t\t\tthis.view.config.pullRequests.showForBranches &&\n\t\t\t\t\t(this.branch.upstream != null || this.branch.remote)\n\t\t\t\t\t\t? this.branch.getAssociatedPullRequest(\n\t\t\t\t\t\t\t\tthis.root ? { include: [PullRequestState.Open, PullRequestState.Merged] } : undefined,\n\t\t\t\t\t\t  )\n\t\t\t\t\t\t: undefined,\n\t\t\t\t\trange && !this.branch.remote\n\t\t\t\t\t\t? Container.git.getLogRefsOnly(this.uri.repoPath!, {\n\t\t\t\t\t\t\t\tlimit: 0,\n\t\t\t\t\t\t\t\tref: range,\n\t\t\t\t\t\t  })\n\t\t\t\t\t\t: undefined,\n\t\t\t\t]);\n\t\t\tif (log == null) return [new MessageNode(this.view, this, 'No commits could be found.')];\n\n\t\t\tif (this.options.showComparison !== false && !(this.view instanceof RemotesView)) {\n\t\t\t\tchildren.push(\n\t\t\t\t\tnew CompareBranchNode(\n\t\t\t\t\t\tthis.uri,\n\t\t\t\t\t\tthis.view,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\tthis.branch,\n\t\t\t\t\t\tthis.options.showComparison,\n\t\t\t\t\t\tthis.splatted,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (pr != null) {\n\t\t\t\tchildren.push(new PullRequestNode(this.view, this, pr, this.branch));\n\t\t\t}\n\n\t\t\tif (this.options.showStatus && mergeStatus != null) {\n\t\t\t\tchildren.push(\n\t\t\t\t\tnew MergeStatusNode(\n\t\t\t\t\t\tthis.view,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\tthis.branch,\n\t\t\t\t\t\tmergeStatus,\n\t\t\t\t\t\tstatus ?? (await Container.git.getStatusForRepo(this.uri.repoPath)),\n\t\t\t\t\t\tthis.root,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t} else if (\n\t\t\t\tthis.options.showStatus &&\n\t\t\t\trebaseStatus != null &&\n\t\t\t\t(this.branch.current || this.branch.name === rebaseStatus.incoming.name)\n\t\t\t) {\n\t\t\t\tchildren.push(\n\t\t\t\t\tnew RebaseStatusNode(\n\t\t\t\t\t\tthis.view,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\tthis.branch,\n\t\t\t\t\t\trebaseStatus,\n\t\t\t\t\t\tstatus ?? (await Container.git.getStatusForRepo(this.uri.repoPath)),\n\t\t\t\t\t\tthis.root,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t} else if (this.options.showTracking) {\n\t\t\t\tconst status = {\n\t\t\t\t\tref: this.branch.ref,\n\t\t\t\t\trepoPath: this.branch.repoPath,\n\t\t\t\t\tstate: this.branch.state,\n\t\t\t\t\tupstream: this.branch.upstream?.name,\n\t\t\t\t};\n\n\t\t\t\tif (this.branch.upstream != null) {\n\t\t\t\t\tif (this.root && !status.state.behind && !status.state.ahead) {\n\t\t\t\t\t\tchildren.push(\n\t\t\t\t\t\t\tnew BranchTrackingStatusNode(this.view, this, this.branch, status, 'same', this.root),\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (status.state.behind) {\n\t\t\t\t\t\t\tchildren.push(\n\t\t\t\t\t\t\t\tnew BranchTrackingStatusNode(this.view, this, this.branch, status, 'behind', this.root),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (status.state.ahead) {\n\t\t\t\t\t\t\tchildren.push(\n\t\t\t\t\t\t\t\tnew BranchTrackingStatusNode(this.view, this, this.branch, status, 'ahead', this.root),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tchildren.push(\n\t\t\t\t\t\tnew BranchTrackingStatusNode(this.view, this, this.branch, status, 'none', this.root),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (children.length !== 0) {\n\t\t\t\tchildren.push(new MessageNode(this.view, this, '', GlyphChars.Dash.repeat(2), ''));\n\t\t\t}\n\n\t\t\tchildren.push(\n\t\t\t\t...insertDateMarkers(\n\t\t\t\t\tIterables.map(\n\t\t\t\t\t\tlog.commits.values(),\n\t\t\t\t\t\tc =>\n\t\t\t\t\t\t\tnew CommitNode(\n\t\t\t\t\t\t\t\tthis.view,\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\tc,\n\t\t\t\t\t\t\t\tunpublishedCommits?.has(c.ref),\n\t\t\t\t\t\t\t\tthis.branch,\n\t\t\t\t\t\t\t\tgetBranchAndTagTips,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t),\n\t\t\t\t\tthis,\n\t\t\t\t),\n\t\t\t);\n\n\t\t\tif (log.hasMore) {\n\t\t\t\tchildren.push(\n\t\t\t\t\tnew LoadMoreNode(this.view, this, children[children.length - 1], undefined, () =>\n\t\t\t\t\t\tContainer.git.getCommitCount(this.branch.repoPath, this.branch.name),\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis._children = children;\n\t\t}\n\t\treturn this._children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tthis.splatted = false;\n\n\t\tlet tooltip: string | MarkdownString = `${\n\t\t\tthis.current ? 'Current branch' : 'Branch'\n\t\t} $(git-branch) ${this.branch.getNameWithoutRemote()}${this.branch.rebasing ? ' (Rebasing)' : ''}`;\n\n\t\tlet contextValue: string = ContextValues.Branch;\n\t\tif (this.current) {\n\t\t\tcontextValue += '+current';\n\t\t}\n\t\tif (this.branch.remote) {\n\t\t\tcontextValue += '+remote';\n\t\t}\n\t\tif (this.branch.starred) {\n\t\t\tcontextValue += '+starred';\n\t\t}\n\t\tif (this.branch.upstream != null && !this.branch.upstream.missing) {\n\t\t\tcontextValue += '+tracking';\n\t\t}\n\t\tif (this.options.showAsCommits) {\n\t\t\tcontextValue += '+commits';\n\t\t}\n\n\t\tlet color: ThemeColor | undefined;\n\t\tlet description;\n\t\tlet iconSuffix = '';\n\t\tif (!this.branch.remote) {\n\t\t\tif (this.branch.upstream != null) {\n\t\t\t\tlet arrows = GlyphChars.Dash;\n\n\t\t\t\tconst remote = await this.branch.getRemote();\n\t\t\t\tif (!this.branch.upstream.missing) {\n\t\t\t\t\tif (remote != null) {\n\t\t\t\t\t\tlet left;\n\t\t\t\t\t\tlet right;\n\t\t\t\t\t\tfor (const { type } of remote.urls) {\n\t\t\t\t\t\t\tif (type === GitRemoteType.Fetch) {\n\t\t\t\t\t\t\t\tleft = true;\n\n\t\t\t\t\t\t\t\tif (right) break;\n\t\t\t\t\t\t\t} else if (type === GitRemoteType.Push) {\n\t\t\t\t\t\t\t\tright = true;\n\n\t\t\t\t\t\t\t\tif (left) break;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (left && right) {\n\t\t\t\t\t\t\tarrows = GlyphChars.ArrowsRightLeft;\n\t\t\t\t\t\t} else if (right) {\n\t\t\t\t\t\t\tarrows = GlyphChars.ArrowRight;\n\t\t\t\t\t\t} else if (left) {\n\t\t\t\t\t\t\tarrows = GlyphChars.ArrowLeft;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tarrows = GlyphChars.Warning;\n\t\t\t\t}\n\n\t\t\t\tdescription = this.options.showAsCommits\n\t\t\t\t\t? `${this.branch.getTrackingStatus({\n\t\t\t\t\t\t\tsuffix: Strings.pad(GlyphChars.Dot, 1, 1),\n\t\t\t\t\t  })}${this.branch.getNameWithoutRemote()}${this.branch.rebasing ? ' (Rebasing)' : ''}${Strings.pad(\n\t\t\t\t\t\t\tarrows,\n\t\t\t\t\t\t\t2,\n\t\t\t\t\t\t\t2,\n\t\t\t\t\t  )}${this.branch.upstream.name}`\n\t\t\t\t\t: `${this.branch.getTrackingStatus({ suffix: `${GlyphChars.Space} ` })}${arrows}${\n\t\t\t\t\t\t\tGlyphChars.Space\n\t\t\t\t\t  } ${this.branch.upstream.name}`;\n\n\t\t\t\ttooltip += ` is ${this.branch.getTrackingStatus({\n\t\t\t\t\tempty: this.branch.upstream.missing\n\t\t\t\t\t\t? `missing upstream $(git-branch) ${this.branch.upstream.name}`\n\t\t\t\t\t\t: `up to date with $(git-branch)  ${this.branch.upstream.name}${\n\t\t\t\t\t\t\t\tremote?.provider?.name ? ` on ${remote.provider.name}` : ''\n\t\t\t\t\t\t  }`,\n\t\t\t\t\texpand: true,\n\t\t\t\t\ticons: true,\n\t\t\t\t\tseparator: ', ',\n\t\t\t\t\tsuffix: ` $(git-branch) ${this.branch.upstream.name}${\n\t\t\t\t\t\tremote?.provider?.name ? ` on ${remote.provider.name}` : ''\n\t\t\t\t\t}`,\n\t\t\t\t})}`;\n\n\t\t\t\tif (this.branch.state.ahead || this.branch.state.behind) {\n\t\t\t\t\tif (this.branch.state.ahead) {\n\t\t\t\t\t\tcontextValue += '+ahead';\n\t\t\t\t\t\tcolor = new ThemeColor(Colors.UnpushlishedChangesIconColor);\n\t\t\t\t\t\ticonSuffix = '-green';\n\t\t\t\t\t}\n\t\t\t\t\tif (this.branch.state.behind) {\n\t\t\t\t\t\tcontextValue += '+behind';\n\t\t\t\t\t\tcolor = new ThemeColor(Colors.UnpulledChangesIconColor);\n\t\t\t\t\t\ticonSuffix = this.branch.state.ahead ? '-yellow' : '-red';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst providers = GitRemote.getHighlanderProviders(\n\t\t\t\t\tawait Container.git.getRemotes(this.branch.repoPath),\n\t\t\t\t);\n\t\t\t\tconst providerName = providers?.length ? providers[0].name : undefined;\n\n\t\t\t\ttooltip += ` hasn't been published to ${providerName ?? 'a remote'}`;\n\t\t\t}\n\t\t}\n\n\t\tif (this.branch.date != null) {\n\t\t\tdescription = `${description ? `${description}${Strings.pad(GlyphChars.Dot, 2, 2)}` : ''}${\n\t\t\t\tthis.branch.formattedDate\n\t\t\t}`;\n\n\t\t\ttooltip += `\\n\\nLast commit ${this.branch.formatDateFromNow()} (${this.branch.formatDate(\n\t\t\t\tBranchDateFormatting.dateFormat,\n\t\t\t)})`;\n\t\t}\n\n\t\ttooltip = new MarkdownString(tooltip, true);\n\t\tif (this.branch.starred) {\n\t\t\ttooltip.appendMarkdown('\\\\\\n$(star-full) Favorited');\n\t\t}\n\n\t\tconst item = new TreeItem(\n\t\t\tthis.label,\n\t\t\tthis.options.expanded ? TreeItemCollapsibleState.Expanded : TreeItemCollapsibleState.Collapsed,\n\t\t);\n\t\titem.id = this.id;\n\t\titem.contextValue = contextValue;\n\t\titem.description = description;\n\t\titem.iconPath = this.options.showAsCommits\n\t\t\t? new ThemeIcon('git-commit', color)\n\t\t\t: {\n\t\t\t\t\tdark: Container.context.asAbsolutePath(`images/dark/icon-branch${iconSuffix}.svg`),\n\t\t\t\t\tlight: Container.context.asAbsolutePath(`images/light/icon-branch${iconSuffix}.svg`),\n\t\t\t  };\n\t\titem.tooltip = tooltip;\n\t\titem.resourceUri = Uri.parse(\n\t\t\t`gitlens-view://branch/status/${await this.branch.getStatus()}${\n\t\t\t\tthis.options.showCurrent && this.current ? '/current' : ''\n\t\t\t}`,\n\t\t);\n\n\t\treturn item;\n\t}\n\n\t@log()\n\tasync star() {\n\t\tawait this.branch.star();\n\t\tvoid this.view.refresh(true);\n\t}\n\n\t@log()\n\tasync unstar() {\n\t\tawait this.branch.unstar();\n\t\tvoid this.view.refresh(true);\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset?: boolean) {\n\t\tthis._children = undefined;\n\t\tif (reset) {\n\t\t\tthis._log = undefined;\n\t\t}\n\t}\n\n\tprivate _log: GitLog | undefined;\n\tprivate async getLog() {\n\t\tif (this._log == null) {\n\t\t\tlet limit =\n\t\t\t\tthis.limit ??\n\t\t\t\t(this.root && !this.options.limitCommits\n\t\t\t\t\t? this.view.config.pageItemLimit\n\t\t\t\t\t: this.view.config.defaultItemLimit);\n\t\t\t// Try to show more commits if they are unpublished\n\t\t\tif (limit !== 0 && this.branch.state.ahead > limit) {\n\t\t\t\tlimit = Math.min(this.branch.state.ahead + 1, limit * 2);\n\t\t\t}\n\n\t\t\tthis._log = await Container.git.getLog(this.uri.repoPath!, {\n\t\t\t\tlimit: limit,\n\t\t\t\tref: this.ref.ref,\n\t\t\t\tauthors: this.options?.authors,\n\t\t\t});\n\t\t}\n\n\t\treturn this._log;\n\t}\n\n\tget hasMore() {\n\t\treturn this._log?.hasMore ?? true;\n\t}\n\n\tlimit: number | undefined = this.view.getNodeLastKnownLimit(this);\n\t@gate()\n\tasync loadMore(limit?: number | { until?: any }) {\n\t\tlet log = await window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: { viewId: this.view.id },\n\t\t\t},\n\t\t\t() => this.getLog(),\n\t\t);\n\t\tif (log == null || !log.hasMore) return;\n\n\t\tlog = await log.more?.(limit ?? this.view.config.pageItemLimit);\n\t\tif (this._log === log) return;\n\n\t\tthis._log = log;\n\t\tthis.limit = log?.count;\n\n\t\tthis._children = undefined;\n\t\tvoid this.triggerChange(false);\n\t}\n}\n","'use strict';\nimport { ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { ViewBranchesLayout } from '../../configuration';\nimport { Repository } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { Arrays, debug, gate } from '../../system';\nimport { BranchesView } from '../branchesView';\nimport { RepositoriesView } from '../repositoriesView';\nimport { BranchNode } from './branchNode';\nimport { BranchOrTagFolderNode } from './branchOrTagFolderNode';\nimport { MessageNode } from './common';\nimport { RepositoryNode } from './repositoryNode';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport class BranchesNode extends ViewNode<BranchesView | RepositoriesView> {\n\tstatic key = ':branches';\n\tstatic getId(repoPath: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}`;\n\t}\n\n\tprivate _children: ViewNode[] | undefined;\n\n\tconstructor(\n\t\turi: GitUri,\n\t\tview: BranchesView | RepositoriesView,\n\t\tparent: ViewNode,\n\t\tpublic readonly repo: Repository,\n\t) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\toverride get id(): string {\n\t\treturn BranchesNode.getId(this.repo.path);\n\t}\n\n\tget repoPath(): string {\n\t\treturn this.repo.path;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._children == null) {\n\t\t\tconst branches = await this.repo.getBranches({\n\t\t\t\t// only show local branches\n\t\t\t\tfilter: b => !b.remote,\n\t\t\t\tsort: { current: false },\n\t\t\t});\n\t\t\tif (branches.length === 0) return [new MessageNode(this.view, this, 'No branches could be found.')];\n\n\t\t\tconst branchNodes = branches.map(\n\t\t\t\tb =>\n\t\t\t\t\tnew BranchNode(GitUri.fromRepoPath(this.uri.repoPath!, b.ref), this.view, this, b, false, {\n\t\t\t\t\t\tshowComparison:\n\t\t\t\t\t\t\tthis.view instanceof RepositoriesView\n\t\t\t\t\t\t\t\t? this.view.config.branches.showBranchComparison\n\t\t\t\t\t\t\t\t: this.view.config.showBranchComparison,\n\t\t\t\t\t}),\n\t\t\t);\n\t\t\tif (this.view.config.branches.layout === ViewBranchesLayout.List) return branchNodes;\n\n\t\t\tconst hierarchy = Arrays.makeHierarchical(\n\t\t\t\tbranchNodes,\n\t\t\t\tn => n.treeHierarchy,\n\t\t\t\t(...paths) => paths.join('/'),\n\t\t\t\tthis.view.config.files.compact,\n\t\t\t\tb => {\n\t\t\t\t\tb.compacted = true;\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t);\n\n\t\t\tconst root = new BranchOrTagFolderNode(\n\t\t\t\tthis.view,\n\t\t\t\tthis,\n\t\t\t\t'branch',\n\t\t\t\tthis.repo.path,\n\t\t\t\t'',\n\t\t\t\tundefined,\n\t\t\t\thierarchy,\n\t\t\t\t'branches',\n\t\t\t);\n\t\t\tthis._children = root.getChildren();\n\t\t}\n\n\t\treturn this._children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tconst item = new TreeItem('Branches', TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\titem.contextValue = ContextValues.Branches;\n\t\tif (await this.repo.hasRemotes()) {\n\t\t\titem.contextValue += '+remotes';\n\t\t}\n\t\titem.iconPath = new ThemeIcon('git-branch');\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh() {\n\t\tthis._children = undefined;\n\t}\n}\n","'use strict';\nimport { ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { NamedRef } from '../../constants';\nimport { Container } from '../../container';\nimport { GitRevision } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { debug, gate, log, Strings } from '../../system';\nimport { SearchAndCompareView } from '../searchAndCompareView';\nimport { RepositoryNode } from './repositoryNode';\nimport { CommitsQueryResults, ResultsCommitsNode } from './resultsCommitsNode';\nimport { FilesQueryResults, ResultsFilesNode } from './resultsFilesNode';\nimport { ContextValues, ViewNode } from './viewNode';\n\nlet instanceId = 0;\n\nexport class CompareResultsNode extends ViewNode<SearchAndCompareView> {\n\tstatic key = ':compare-results';\n\tstatic getId(repoPath: string, ref1: string, ref2: string, instanceId: number): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${ref1}|${ref2}):${instanceId}`;\n\t}\n\n\tstatic getPinnableId(repoPath: string, ref1: string, ref2: string) {\n\t\treturn Strings.sha1(`${repoPath}|${ref1}|${ref2}`);\n\t}\n\n\tprivate _children: ViewNode[] | undefined;\n\tprivate _instanceId: number;\n\n\tconstructor(\n\t\tview: SearchAndCompareView,\n\t\tparent: ViewNode,\n\t\tpublic readonly repoPath: string,\n\t\tprivate _ref: NamedRef,\n\t\tprivate _compareWith: NamedRef,\n\t\tprivate _pinned: number = 0,\n\t) {\n\t\tsuper(GitUri.fromRepoPath(repoPath), view, parent);\n\t\tthis._instanceId = instanceId++;\n\t}\n\n\tget ahead(): { readonly ref1: string; readonly ref2: string } {\n\t\treturn {\n\t\t\tref1: this._compareWith.ref || 'HEAD',\n\t\t\tref2: this._ref.ref,\n\t\t};\n\t}\n\n\tget behind(): { readonly ref1: string; readonly ref2: string } {\n\t\treturn {\n\t\t\tref1: this._ref.ref,\n\t\t\tref2: this._compareWith.ref || 'HEAD',\n\t\t};\n\t}\n\n\toverride get id(): string {\n\t\treturn CompareResultsNode.getId(this.repoPath, this._ref.ref, this._compareWith.ref, this._instanceId);\n\t}\n\n\tget canDismiss(): boolean {\n\t\treturn !this.pinned;\n\t}\n\n\tprivate readonly _order: number = Date.now();\n\tget order(): number {\n\t\treturn this._pinned || this._order;\n\t}\n\n\tget pinned(): boolean {\n\t\treturn this._pinned !== 0;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._children == null) {\n\t\t\tconst ahead = this.ahead;\n\t\t\tconst behind = this.behind;\n\n\t\t\tconst aheadBehindCounts = await Container.git.getAheadBehindCommitCount(this.repoPath, [\n\t\t\t\tGitRevision.createRange(behind.ref1 || 'HEAD', behind.ref2, '...'),\n\t\t\t]);\n\t\t\tconst mergeBase =\n\t\t\t\t(await Container.git.getMergeBase(this.repoPath, behind.ref1, behind.ref2, { forkPoint: true })) ??\n\t\t\t\t(await Container.git.getMergeBase(this.repoPath, behind.ref1, behind.ref2));\n\n\t\t\tthis._children = [\n\t\t\t\tnew ResultsCommitsNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\tthis.uri.repoPath!,\n\t\t\t\t\t'Behind',\n\t\t\t\t\t{\n\t\t\t\t\t\tquery: this.getCommitsQuery(GitRevision.createRange(behind.ref1, behind.ref2, '..')),\n\t\t\t\t\t\tcomparison: behind,\n\t\t\t\t\t\tdirection: 'behind',\n\t\t\t\t\t\tfiles: {\n\t\t\t\t\t\t\tref1: behind.ref1 === '' ? '' : mergeBase ?? behind.ref1,\n\t\t\t\t\t\t\tref2: behind.ref2,\n\t\t\t\t\t\t\tquery: this.getBehindFilesQuery.bind(this),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'behind',\n\t\t\t\t\t\tdescription: Strings.pluralize('commit', aheadBehindCounts?.behind ?? 0),\n\t\t\t\t\t\texpand: false,\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t\tnew ResultsCommitsNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\tthis.uri.repoPath!,\n\t\t\t\t\t'Ahead',\n\t\t\t\t\t{\n\t\t\t\t\t\tquery: this.getCommitsQuery(GitRevision.createRange(ahead.ref1, ahead.ref2, '..')),\n\t\t\t\t\t\tcomparison: ahead,\n\t\t\t\t\t\tdirection: 'ahead',\n\t\t\t\t\t\tfiles: {\n\t\t\t\t\t\t\tref1: mergeBase ?? ahead.ref1,\n\t\t\t\t\t\t\tref2: ahead.ref2,\n\t\t\t\t\t\t\tquery: this.getAheadFilesQuery.bind(this),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'ahead',\n\t\t\t\t\t\tdescription: Strings.pluralize('commit', aheadBehindCounts?.ahead ?? 0),\n\t\t\t\t\t\texpand: false,\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t\tnew ResultsFilesNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\tthis.uri.repoPath!,\n\t\t\t\t\tthis._compareWith.ref,\n\t\t\t\t\tthis._ref.ref,\n\t\t\t\t\tthis.getFilesQuery.bind(this),\n\t\t\t\t\tundefined,\n\t\t\t\t\t{\n\t\t\t\t\t\texpand: false,\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t];\n\t\t}\n\t\treturn this._children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tlet description;\n\t\tif ((await Container.git.getRepositoryCount()) > 1) {\n\t\t\tconst repo = await Container.git.getRepository(this.uri.repoPath!);\n\t\t\tdescription = repo?.formattedName ?? this.uri.repoPath;\n\t\t}\n\n\t\tconst item = new TreeItem(\n\t\t\t`Comparing ${\n\t\t\t\tthis._ref.label ?? GitRevision.shorten(this._ref.ref, { strings: { working: 'Working Tree' } })\n\t\t\t} with ${\n\t\t\t\tthis._compareWith.label ??\n\t\t\t\tGitRevision.shorten(this._compareWith.ref, { strings: { working: 'Working Tree' } })\n\t\t\t}`,\n\t\t\tTreeItemCollapsibleState.Collapsed,\n\t\t);\n\t\titem.id = this.id;\n\t\titem.contextValue = `${ContextValues.CompareResults}${this._pinned ? '+pinned' : ''}`;\n\t\titem.description = description;\n\t\tif (this._pinned) {\n\t\t\titem.iconPath = new ThemeIcon('pinned');\n\t\t}\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\tasync getDiffRefs(): Promise<[string, string]> {\n\t\treturn Promise.resolve([this._compareWith.ref, this._ref.ref]);\n\t}\n\n\t@log()\n\tasync pin() {\n\t\tif (this.pinned) return;\n\n\t\tthis._pinned = Date.now();\n\t\tawait this.updatePinned();\n\n\t\tsetImmediate(() => this.view.reveal(this, { focus: true, select: true }));\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset: boolean = false) {\n\t\tif (!reset) return;\n\n\t\tthis._children = undefined;\n\t}\n\n\t@log()\n\tasync swap() {\n\t\t// Save the current id so we can update it later\n\t\tconst currentId = this.getPinnableId();\n\n\t\tconst ref1 = this._ref;\n\t\tthis._ref = this._compareWith;\n\t\tthis._compareWith = ref1;\n\n\t\t// If we were pinned, remove the existing pin and save a new one\n\t\tif (this.pinned) {\n\t\t\tawait this.view.updatePinned(currentId);\n\t\t\tawait this.updatePinned();\n\t\t}\n\n\t\tthis._children = undefined;\n\t\tthis.view.triggerNodeChange(this.parent);\n\t\tsetImmediate(() => this.view.reveal(this, { expand: true, focus: true, select: true }));\n\t}\n\n\t@log()\n\tasync unpin() {\n\t\tif (!this.pinned) return;\n\n\t\tthis._pinned = 0;\n\t\tawait this.view.updatePinned(this.getPinnableId());\n\n\t\tsetImmediate(() => this.view.reveal(this, { focus: true, select: true }));\n\t}\n\n\tprivate getPinnableId() {\n\t\treturn CompareResultsNode.getPinnableId(this.repoPath, this._ref.ref, this._compareWith.ref);\n\t}\n\n\tprivate async getAheadFilesQuery(): Promise<FilesQueryResults> {\n\t\tlet files = await Container.git.getDiffStatus(\n\t\t\tthis.repoPath,\n\t\t\tGitRevision.createRange(this._compareWith?.ref || 'HEAD', this._ref.ref || 'HEAD', '...'),\n\t\t);\n\n\t\tif (this._ref.ref === '') {\n\t\t\tconst workingFiles = await Container.git.getDiffStatus(this.repoPath, 'HEAD');\n\t\t\tif (workingFiles != null) {\n\t\t\t\tif (files != null) {\n\t\t\t\t\tfor (const wf of workingFiles) {\n\t\t\t\t\t\tconst index = files.findIndex(f => f.fileName === wf.fileName);\n\t\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\t\tfiles.splice(index, 1, wf);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfiles.push(wf);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfiles = workingFiles;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tlabel: `${Strings.pluralize('file', files?.length ?? 0, { zero: 'No' })} changed`,\n\t\t\tfiles: files,\n\t\t};\n\t}\n\n\tprivate async getBehindFilesQuery(): Promise<FilesQueryResults> {\n\t\tlet files = await Container.git.getDiffStatus(\n\t\t\tthis.repoPath,\n\t\t\tGitRevision.createRange(this._ref.ref || 'HEAD', this._compareWith.ref || 'HEAD', '...'),\n\t\t);\n\n\t\tif (this._compareWith.ref === '') {\n\t\t\tconst workingFiles = await Container.git.getDiffStatus(this.repoPath, 'HEAD');\n\t\t\tif (workingFiles != null) {\n\t\t\t\tif (files != null) {\n\t\t\t\t\tfor (const wf of workingFiles) {\n\t\t\t\t\t\tconst index = files.findIndex(f => f.fileName === wf.fileName);\n\t\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\t\tfiles.splice(index, 1, wf);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfiles.push(wf);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfiles = workingFiles;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tlabel: `${Strings.pluralize('file', files?.length ?? 0, { zero: 'No' })} changed`,\n\t\t\tfiles: files,\n\t\t};\n\t}\n\n\tprivate getCommitsQuery(range: string): (limit: number | undefined) => Promise<CommitsQueryResults> {\n\t\tconst repoPath = this.repoPath;\n\t\treturn async (limit: number | undefined) => {\n\t\t\tconst log = await Container.git.getLog(repoPath, {\n\t\t\t\tlimit: limit,\n\t\t\t\tref: range,\n\t\t\t});\n\n\t\t\tconst results: Mutable<Partial<CommitsQueryResults>> = {\n\t\t\t\tlog: log,\n\t\t\t\thasMore: log?.hasMore ?? true,\n\t\t\t};\n\t\t\tif (results.hasMore) {\n\t\t\t\tresults.more = async (limit: number | undefined) => {\n\t\t\t\t\tresults.log = (await results.log?.more?.(limit)) ?? results.log;\n\t\t\t\t\tresults.hasMore = results.log?.hasMore ?? true;\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn results as CommitsQueryResults;\n\t\t};\n\t}\n\n\tprivate async getFilesQuery(): Promise<FilesQueryResults> {\n\t\tlet comparison;\n\t\tif (this._compareWith.ref === '') {\n\t\t\tcomparison = this._ref.ref;\n\t\t} else if (this._ref.ref === '') {\n\t\t\tcomparison = this._compareWith.ref;\n\t\t} else {\n\t\t\tcomparison = `${this._compareWith.ref}..${this._ref.ref}`;\n\t\t}\n\n\t\tconst files = await Container.git.getDiffStatus(this.uri.repoPath!, comparison);\n\n\t\treturn {\n\t\t\tlabel: `${Strings.pluralize('file', files?.length ?? 0, { zero: 'No' })} changed`,\n\t\t\tfiles: files,\n\t\t};\n\t}\n\n\tprivate updatePinned() {\n\t\treturn this.view.updatePinned(this.getPinnableId(), {\n\t\t\ttype: 'comparison',\n\t\t\ttimestamp: this._pinned,\n\t\t\tpath: this.repoPath,\n\t\t\tref1: { label: this._ref.label, ref: this._ref.ref },\n\t\t\tref2: { label: this._compareWith.label, ref: this._compareWith.ref },\n\t\t});\n\t}\n}\n","'use strict';\nimport { Disposable, FileType, TextEditor, TreeItem, TreeItemCollapsibleState, window, workspace } from 'vscode';\nimport { UriComparer } from '../../comparers';\nimport { ContextKeys, setContext } from '../../constants';\nimport { Container } from '../../container';\nimport { GitReference, GitRevision } from '../../git/git';\nimport { GitCommitish, GitUri } from '../../git/gitUri';\nimport { Logger } from '../../logger';\nimport { ReferencePicker } from '../../quickpicks';\nimport { debug, Functions, gate, log } from '../../system';\nimport { FileHistoryView } from '../fileHistoryView';\nimport { FileHistoryNode } from './fileHistoryNode';\nimport { ContextValues, SubscribeableViewNode, unknownGitUri, ViewNode } from './viewNode';\n\nexport class FileHistoryTrackerNode extends SubscribeableViewNode<FileHistoryView> {\n\tprivate _base: string | undefined;\n\tprivate _child: FileHistoryNode | undefined;\n\tprotected override splatted = true;\n\n\tconstructor(view: FileHistoryView) {\n\t\tsuper(unknownGitUri, view);\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\n\t\tthis.resetChild();\n\t}\n\n\t@debug()\n\tprivate resetChild() {\n\t\tif (this._child == null) return;\n\n\t\tthis._child.dispose();\n\t\tthis._child = undefined;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._child == null) {\n\t\t\tif (!this.hasUri) {\n\t\t\t\tthis.view.description = undefined;\n\n\t\t\t\tthis.view.message = 'There are no editors open that can provide file history information.';\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tthis.view.message = undefined;\n\n\t\t\tconst commitish: GitCommitish = {\n\t\t\t\t...this.uri,\n\t\t\t\trepoPath: this.uri.repoPath!,\n\t\t\t\tsha: this._base ?? this.uri.sha,\n\t\t\t};\n\t\t\tconst fileUri = new GitUri(this.uri, commitish);\n\n\t\t\tlet folder = false;\n\t\t\ttry {\n\t\t\t\tconst stat = await workspace.fs.stat(this.uri);\n\t\t\t\tif (stat.type === FileType.Directory) {\n\t\t\t\t\tfolder = true;\n\t\t\t\t}\n\t\t\t} catch {}\n\n\t\t\tthis.view.title = folder ? 'Folder History' : 'File History';\n\n\t\t\tlet branch;\n\t\t\tif (!commitish.sha || commitish.sha === 'HEAD') {\n\t\t\t\tbranch = await Container.git.getBranch(this.uri.repoPath);\n\t\t\t} else if (!GitRevision.isSha(commitish.sha)) {\n\t\t\t\t[branch] = await Container.git.getBranches(this.uri.repoPath, {\n\t\t\t\t\tfilter: b => b.name === commitish.sha,\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis._child = new FileHistoryNode(fileUri, this.view, this, folder, branch);\n\t\t}\n\n\t\treturn this._child.getChildren();\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tthis.splatted = false;\n\n\t\tconst item = new TreeItem('File History', TreeItemCollapsibleState.Expanded);\n\t\titem.contextValue = ContextValues.ActiveFileHistory;\n\n\t\treturn item;\n\t}\n\n\tget followingEditor(): boolean {\n\t\treturn this.canSubscribe;\n\t}\n\n\tget hasUri(): boolean {\n\t\treturn this._uri != unknownGitUri;\n\t}\n\n\t@gate()\n\t@log()\n\tasync changeBase() {\n\t\tconst pick = await ReferencePicker.show(\n\t\t\tthis.uri.repoPath!,\n\t\t\t'Change File History Base',\n\t\t\t'Choose a reference to set as the new base',\n\t\t\t{\n\t\t\t\tallowEnteringRefs: true,\n\t\t\t\tpicked: this._base,\n\t\t\t\t// checkmarks: true,\n\t\t\t\tsort: { branches: { current: true }, tags: {} },\n\t\t\t},\n\t\t);\n\t\tif (pick == null) return;\n\n\t\tif (GitReference.isBranch(pick)) {\n\t\t\tconst branch = await Container.git.getBranch(this.uri.repoPath);\n\t\t\tthis._base = branch?.name === pick.name ? undefined : pick.ref;\n\t\t} else {\n\t\t\tthis._base = pick.ref;\n\t\t}\n\t\tif (this._child == null) return;\n\n\t\tthis.setUri();\n\t\tawait this.triggerChange();\n\t}\n\n\t@gate()\n\t@debug({\n\t\texit: r => `returned ${r}`,\n\t})\n\toverride async refresh(reset: boolean = false) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tif (!this.canSubscribe) return false;\n\n\t\tif (reset) {\n\t\t\tthis.setUri();\n\t\t\tthis.resetChild();\n\t\t}\n\n\t\tconst editor = window.activeTextEditor;\n\t\tif (editor == null || !Container.git.isTrackable(editor.document.uri)) {\n\t\t\tif (\n\t\t\t\t!this.hasUri ||\n\t\t\t\t(Container.git.isTrackable(this.uri) &&\n\t\t\t\t\twindow.visibleTextEditors.some(e => e.document?.uri.path === this.uri.path))\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.setUri();\n\t\t\tthis.resetChild();\n\n\t\t\tif (cc != null) {\n\t\t\t\tcc.exitDetails = `, uri=${Logger.toLoggable(this._uri)}`;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\tif (editor.document.uri.path === this.uri.path) {\n\t\t\tif (cc != null) {\n\t\t\t\tcc.exitDetails = `, uri=${Logger.toLoggable(this._uri)}`;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tlet gitUri = await GitUri.fromUri(editor.document.uri);\n\n\t\tlet uri;\n\t\tif (gitUri.sha != null) {\n\t\t\t// If we have a sha, normalize the history to the working file (so we get a full history all the time)\n\t\t\tconst workingUri = await Container.git.getWorkingUri(gitUri.repoPath!, gitUri);\n\t\t\tif (workingUri != null) {\n\t\t\t\turi = workingUri;\n\t\t\t}\n\t\t}\n\n\t\tif (this.hasUri && UriComparer.equals(uri ?? gitUri, this.uri)) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (uri != null) {\n\t\t\tgitUri = await GitUri.fromUri(uri);\n\t\t}\n\n\t\tthis.setUri(gitUri);\n\t\tthis.resetChild();\n\n\t\tif (cc != null) {\n\t\t\tcc.exitDetails = `, uri=${Logger.toLoggable(this._uri)}`;\n\t\t}\n\t\treturn false;\n\t}\n\n\t@log()\n\tsetEditorFollowing(enabled: boolean) {\n\t\tif (enabled) {\n\t\t\tthis.setUri();\n\t\t\t// Don't need to call triggerChange here, since canSubscribe will do it\n\t\t}\n\n\t\tthis.canSubscribe = enabled;\n\t\tif (!enabled) {\n\t\t\tvoid this.triggerChange();\n\t\t}\n\t}\n\n\t@log()\n\tasync showHistoryForUri(uri: GitUri) {\n\t\tthis.setUri(uri);\n\t\tawait this.triggerChange();\n\t}\n\n\t@debug()\n\tprotected subscribe() {\n\t\treturn Disposable.from(\n\t\t\twindow.onDidChangeActiveTextEditor(Functions.debounce(this.onActiveEditorChanged, 250), this),\n\t\t);\n\t}\n\n\t@debug({ args: false })\n\tprivate onActiveEditorChanged(_editor: TextEditor | undefined) {\n\t\tvoid this.triggerChange();\n\t}\n\n\tsetUri(uri?: GitUri) {\n\t\tthis._uri = uri ?? unknownGitUri;\n\t\tvoid setContext(ContextKeys.ViewsFileHistoryCanPin, this.hasUri);\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { Disposable, TreeItem, TreeItemCollapsibleState, window } from 'vscode';\nimport { configuration } from '../../configuration';\nimport { Container } from '../../container';\nimport {\n\tGitBranch,\n\tGitLog,\n\tGitRevision,\n\tRepositoryChange,\n\tRepositoryChangeComparisonMode,\n\tRepositoryChangeEvent,\n\tRepositoryFileSystemChangeEvent,\n\ttoFolderGlob,\n} from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { Logger } from '../../logger';\nimport { Arrays, debug, gate, Iterables, memoize } from '../../system';\nimport { FileHistoryView } from '../fileHistoryView';\nimport { CommitNode } from './commitNode';\nimport { LoadMoreNode, MessageNode } from './common';\nimport { FileHistoryTrackerNode } from './fileHistoryTrackerNode';\nimport { FileRevisionAsCommitNode } from './fileRevisionAsCommitNode';\nimport { insertDateMarkers } from './helpers';\nimport { RepositoryNode } from './repositoryNode';\nimport { ContextValues, PageableViewNode, SubscribeableViewNode, ViewNode } from './viewNode';\n\nexport class FileHistoryNode extends SubscribeableViewNode<FileHistoryView> implements PageableViewNode {\n\tstatic key = ':history:file';\n\tstatic getId(repoPath: string, uri: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${uri})`;\n\t}\n\n\tprotected override splatted = true;\n\n\tconstructor(\n\t\turi: GitUri,\n\t\tview: FileHistoryView,\n\t\tparent: ViewNode,\n\t\tprivate readonly folder: boolean,\n\t\tprivate readonly branch: GitBranch | undefined,\n\t) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\toverride toClipboard(): string {\n\t\treturn this.uri.fileName;\n\t}\n\n\toverride get id(): string {\n\t\treturn FileHistoryNode.getId(this.uri.repoPath!, this.uri.toString(true));\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tthis.view.description = `${this.label}${\n\t\t\tthis.parent instanceof FileHistoryTrackerNode && !this.parent.followingEditor ? ' (pinned)' : ''\n\t\t}`;\n\n\t\tconst children: ViewNode[] = [];\n\n\t\tconst range = this.branch != null ? await Container.git.getBranchAheadRange(this.branch) : undefined;\n\t\tconst [log, fileStatuses, currentUser, getBranchAndTagTips, unpublishedCommits] = await Promise.all([\n\t\t\tthis.getLog(),\n\t\t\tthis.uri.sha == null\n\t\t\t\t? Container.git.getStatusForFiles(this.uri.repoPath!, this.getPathOrGlob())\n\t\t\t\t: undefined,\n\t\t\tthis.uri.sha == null ? Container.git.getCurrentUser(this.uri.repoPath!) : undefined,\n\t\t\tthis.branch != null\n\t\t\t\t? Container.git.getBranchesAndTagsTipsFn(this.uri.repoPath, this.branch.name)\n\t\t\t\t: undefined,\n\t\t\trange\n\t\t\t\t? Container.git.getLogRefsOnly(this.uri.repoPath!, {\n\t\t\t\t\t\tlimit: 0,\n\t\t\t\t\t\tref: range,\n\t\t\t\t  })\n\t\t\t\t: undefined,\n\t\t]);\n\n\t\tif (fileStatuses?.length) {\n\t\t\tif (this.folder) {\n\t\t\t\tconst commits = Arrays.uniqueBy(\n\t\t\t\t\t[...Iterables.flatMap(fileStatuses, f => f.toPsuedoCommits(currentUser))],\n\t\t\t\t\tc => c.sha,\n\t\t\t\t\t(original, c) => void original.files.push(...c.files),\n\t\t\t\t);\n\t\t\t\tif (commits.length) {\n\t\t\t\t\tchildren.push(...commits.map(commit => new CommitNode(this.view, this, commit)));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst [file] = fileStatuses;\n\t\t\t\tconst commits = file.toPsuedoCommits(currentUser);\n\t\t\t\tif (commits.length) {\n\t\t\t\t\tchildren.push(\n\t\t\t\t\t\t...commits.map(commit => new FileRevisionAsCommitNode(this.view, this, file, commit)),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (log != null) {\n\t\t\tchildren.push(\n\t\t\t\t...insertDateMarkers(\n\t\t\t\t\tIterables.map(log.commits.values(), c =>\n\t\t\t\t\t\tthis.folder\n\t\t\t\t\t\t\t? new CommitNode(\n\t\t\t\t\t\t\t\t\tthis.view as any,\n\t\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\t\tc,\n\t\t\t\t\t\t\t\t\tunpublishedCommits?.has(c.ref),\n\t\t\t\t\t\t\t\t\tthis.branch,\n\t\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\texpand: false,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t: new FileRevisionAsCommitNode(this.view, this, c.files[0], c, {\n\t\t\t\t\t\t\t\t\tbranch: this.branch,\n\t\t\t\t\t\t\t\t\tgetBranchAndTagTips: getBranchAndTagTips,\n\t\t\t\t\t\t\t\t\tunpublished: unpublishedCommits?.has(c.ref),\n\t\t\t\t\t\t\t  }),\n\t\t\t\t\t),\n\t\t\t\t\tthis,\n\t\t\t\t),\n\t\t\t);\n\n\t\t\tif (log.hasMore) {\n\t\t\t\tchildren.push(new LoadMoreNode(this.view, this, children[children.length - 1]));\n\t\t\t}\n\t\t}\n\n\t\tif (children.length === 0) return [new MessageNode(this.view, this, 'No file history could be found.')];\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tthis.splatted = false;\n\n\t\tconst label = this.label;\n\t\tconst item = new TreeItem(label, TreeItemCollapsibleState.Expanded);\n\t\titem.contextValue = ContextValues.FileHistory;\n\t\titem.description = this.uri.directory;\n\t\titem.tooltip = `History of ${this.uri.fileName}\\n${this.uri.directory}/${\n\t\t\tthis.uri.sha == null ? '' : `\\n\\n${this.uri.sha}`\n\t\t}`;\n\n\t\tthis.view.description = `${label}${\n\t\t\tthis.parent instanceof FileHistoryTrackerNode && !this.parent.followingEditor ? ' (pinned)' : ''\n\t\t}`;\n\n\t\treturn item;\n\t}\n\n\tget label() {\n\t\t// Check if this is a base folder\n\t\tif (this.folder && this.uri.fileName === '') {\n\t\t\treturn `${paths.basename(this.uri.fsPath)}${\n\t\t\t\tthis.uri.sha\n\t\t\t\t\t? ` ${this.uri.sha === GitRevision.deletedOrMissing ? this.uri.shortSha : `(${this.uri.shortSha})`}`\n\t\t\t\t\t: ''\n\t\t\t}`;\n\t\t}\n\n\t\treturn `${this.uri.fileName}${\n\t\t\tthis.uri.sha\n\t\t\t\t? ` ${this.uri.sha === GitRevision.deletedOrMissing ? this.uri.shortSha : `(${this.uri.shortSha})`}`\n\t\t\t\t: ''\n\t\t}`;\n\t}\n\n\t@debug()\n\tprotected async subscribe() {\n\t\tconst repo = await Container.git.getRepository(this.uri);\n\t\tif (repo == null) return undefined;\n\n\t\tconst subscription = Disposable.from(\n\t\t\trepo.onDidChange(this.onRepositoryChanged, this),\n\t\t\trepo.onDidChangeFileSystem(this.onFileSystemChanged, this),\n\t\t\trepo.startWatchingFileSystem(),\n\t\t\tconfiguration.onDidChange(e => {\n\t\t\t\tif (configuration.changed(e, 'advanced.fileHistoryFollowsRenames')) {\n\t\t\t\t\tthis.view.resetNodeLastKnownLimit(this);\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\treturn subscription;\n\t}\n\n\tprotected override get requiresResetOnVisible(): boolean {\n\t\treturn true;\n\t}\n\n\tprivate onRepositoryChanged(e: RepositoryChangeEvent) {\n\t\tif (\n\t\t\t!e.changed(\n\t\t\t\tRepositoryChange.Index,\n\t\t\t\tRepositoryChange.Heads,\n\t\t\t\tRepositoryChange.Remotes,\n\t\t\t\tRepositoryChange.RemoteProviders,\n\t\t\t\tRepositoryChange.Status,\n\t\t\t\tRepositoryChange.Unknown,\n\t\t\t\tRepositoryChangeComparisonMode.Any,\n\t\t\t)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tLogger.debug(`FileHistoryNode.onRepositoryChanged(${e.toString()}); triggering node refresh`);\n\n\t\tvoid this.triggerChange(true);\n\t}\n\n\tprivate onFileSystemChanged(e: RepositoryFileSystemChangeEvent) {\n\t\tif (this.folder) {\n\t\t\tif (!e.uris.some(uri => uri.fsPath.startsWith(this.uri.fsPath))) return;\n\t\t} else if (!e.uris.some(uri => uri.toString() === this.uri.toString())) {\n\t\t\treturn;\n\t\t}\n\n\t\tLogger.debug(`FileHistoryNode.onFileSystemChanged(${this.uri.toString(true)}); triggering node refresh`);\n\n\t\tvoid this.triggerChange(true);\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset?: boolean) {\n\t\tif (reset) {\n\t\t\tthis._log = undefined;\n\t\t}\n\t}\n\n\tprivate _log: GitLog | undefined;\n\tprivate async getLog() {\n\t\tif (this._log == null) {\n\t\t\tthis._log = await Container.git.getLogForFile(this.uri.repoPath, this.getPathOrGlob(), {\n\t\t\t\tlimit: this.limit ?? this.view.config.pageItemLimit,\n\t\t\t\tref: this.uri.sha,\n\t\t\t});\n\t\t}\n\n\t\treturn this._log;\n\t}\n\n\t@memoize()\n\tprivate getPathOrGlob() {\n\t\treturn this.folder ? toFolderGlob(this.uri.fsPath) : this.uri.fsPath;\n\t}\n\n\tget hasMore() {\n\t\treturn this._log?.hasMore ?? true;\n\t}\n\n\tlimit: number | undefined = this.view.getNodeLastKnownLimit(this);\n\t@gate()\n\tasync loadMore(limit?: number | { until?: any }) {\n\t\tlet log = await window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: { viewId: this.view.id },\n\t\t\t},\n\t\t\t() => this.getLog(),\n\t\t);\n\t\tif (log == null || !log.hasMore) return;\n\n\t\tlog = await log.more?.(limit ?? this.view.config.pageItemLimit);\n\t\tif (this._log === log) return;\n\n\t\tthis._log = log;\n\t\tthis.limit = log?.count;\n\n\t\t// Needs to force if splatted, since the parent node will cancel the refresh (since it thinks nothing changed)\n\t\tvoid this.triggerChange(false, this.splatted);\n\t}\n}\n","'use strict';\nimport { Selection, TreeItem, TreeItemCollapsibleState, window } from 'vscode';\nimport { UriComparer } from '../../comparers';\nimport { ContextKeys, setContext } from '../../constants';\nimport { Container } from '../../container';\nimport { GitReference, GitRevision } from '../../git/git';\nimport { GitCommitish, GitUri } from '../../git/gitUri';\nimport { Logger } from '../../logger';\nimport { ReferencePicker } from '../../quickpicks';\nimport { debug, Functions, gate, log } from '../../system';\nimport { LinesChangeEvent } from '../../trackers/gitLineTracker';\nimport { FileHistoryView } from '../fileHistoryView';\nimport { LineHistoryView } from '../lineHistoryView';\nimport { LineHistoryNode } from './lineHistoryNode';\nimport { ContextValues, SubscribeableViewNode, unknownGitUri, ViewNode } from './viewNode';\n\nexport class LineHistoryTrackerNode extends SubscribeableViewNode<FileHistoryView | LineHistoryView> {\n\tprivate _base: string | undefined;\n\tprivate _child: LineHistoryNode | undefined;\n\tprivate _editorContents: string | undefined;\n\tprivate _selection: Selection | undefined;\n\tprotected override splatted = true;\n\n\tconstructor(view: FileHistoryView | LineHistoryView) {\n\t\tsuper(unknownGitUri, view);\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\n\t\tthis.resetChild();\n\t}\n\n\t@debug()\n\tprivate resetChild() {\n\t\tif (this._child == null) return;\n\n\t\tthis._child.dispose();\n\t\tthis._child = undefined;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._child == null) {\n\t\t\tif (!this.hasUri) {\n\t\t\t\tthis.view.description = undefined;\n\n\t\t\t\tthis.view.message = 'There are no editors open that can provide line history information.';\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tif (this._selection == null) {\n\t\t\t\tthis.view.description = undefined;\n\n\t\t\t\tthis.view.message = 'There was no selection provided for line history.';\n\t\t\t\tthis.view.description = `${this.uri.fileName}${\n\t\t\t\t\tthis.uri.sha\n\t\t\t\t\t\t? ` ${\n\t\t\t\t\t\t\t\tthis.uri.sha === GitRevision.deletedOrMissing\n\t\t\t\t\t\t\t\t\t? this.uri.shortSha\n\t\t\t\t\t\t\t\t\t: `(${this.uri.shortSha})`\n\t\t\t\t\t\t  }`\n\t\t\t\t\t\t: ''\n\t\t\t\t}${!this.followingEditor ? ' (pinned)' : ''}`;\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tthis.view.message = undefined;\n\n\t\t\tconst commitish: GitCommitish = {\n\t\t\t\t...this.uri,\n\t\t\t\trepoPath: this.uri.repoPath!,\n\t\t\t\tsha: this.uri.sha ?? this._base,\n\t\t\t};\n\t\t\tconst fileUri = new GitUri(this.uri, commitish);\n\n\t\t\tlet branch;\n\t\t\tif (!commitish.sha || commitish.sha === 'HEAD') {\n\t\t\t\tbranch = await Container.git.getBranch(this.uri.repoPath);\n\t\t\t} else if (!GitRevision.isSha(commitish.sha)) {\n\t\t\t\t[branch] = await Container.git.getBranches(this.uri.repoPath, {\n\t\t\t\t\tfilter: b => b.name === commitish.sha,\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis._child = new LineHistoryNode(fileUri, this.view, this, branch, this._selection, this._editorContents);\n\t\t}\n\n\t\treturn this._child.getChildren();\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tthis.splatted = false;\n\n\t\tconst item = new TreeItem('Line History', TreeItemCollapsibleState.Expanded);\n\t\titem.contextValue = ContextValues.ActiveLineHistory;\n\n\t\tvoid this.ensureSubscription();\n\n\t\treturn item;\n\t}\n\n\tget followingEditor(): boolean {\n\t\treturn this.canSubscribe;\n\t}\n\n\tget hasUri(): boolean {\n\t\treturn this._uri != unknownGitUri;\n\t}\n\n\t@gate()\n\t@log()\n\tasync changeBase() {\n\t\tconst pick = await ReferencePicker.show(\n\t\t\tthis.uri.repoPath!,\n\t\t\t'Change Line History Base',\n\t\t\t'Choose a reference to set as the new base',\n\t\t\t{\n\t\t\t\tallowEnteringRefs: true,\n\t\t\t\tpicked: this._base,\n\t\t\t\t// checkmarks: true,\n\t\t\t\tsort: { branches: { current: true }, tags: {} },\n\t\t\t},\n\t\t);\n\t\tif (pick == null) return;\n\n\t\tif (GitReference.isBranch(pick)) {\n\t\t\tconst branch = await Container.git.getBranch(this.uri.repoPath);\n\t\t\tthis._base = branch?.name === pick.name ? undefined : pick.ref;\n\t\t} else {\n\t\t\tthis._base = pick.ref;\n\t\t}\n\t\tif (this._child == null) return;\n\n\t\tthis.setUri();\n\t\tawait this.triggerChange();\n\t}\n\n\t@gate()\n\t@debug({\n\t\texit: r => `returned ${r}`,\n\t})\n\toverride async refresh(reset: boolean = false) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tif (!this.canSubscribe) return false;\n\n\t\tif (reset) {\n\t\t\tthis.setUri();\n\t\t\tthis._editorContents = undefined;\n\t\t\tthis._selection = undefined;\n\t\t\tthis.resetChild();\n\t\t}\n\n\t\tconst editor = window.activeTextEditor;\n\t\tif (editor == null || !Container.git.isTrackable(editor.document.uri)) {\n\t\t\tif (\n\t\t\t\t!this.hasUri ||\n\t\t\t\t(Container.git.isTrackable(this.uri) &&\n\t\t\t\t\twindow.visibleTextEditors.some(e => e.document?.uri.path === this.uri.path))\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.setUri();\n\t\t\tthis._editorContents = undefined;\n\t\t\tthis._selection = undefined;\n\t\t\tthis.resetChild();\n\n\t\t\tif (cc != null) {\n\t\t\t\tcc.exitDetails = `, uri=${Logger.toLoggable(this._uri)}`;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\teditor.document.uri.path === this.uri.path &&\n\t\t\tthis._selection != null &&\n\t\t\teditor.selection.isEqual(this._selection)\n\t\t) {\n\t\t\tif (cc != null) {\n\t\t\t\tcc.exitDetails = `, uri=${Logger.toLoggable(this._uri)}`;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tconst gitUri = await GitUri.fromUri(editor.document.uri);\n\n\t\tif (\n\t\t\tthis.hasUri &&\n\t\t\tUriComparer.equals(gitUri, this.uri) &&\n\t\t\tthis._selection != null &&\n\t\t\teditor.selection.isEqual(this._selection)\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.setUri(gitUri);\n\t\tthis._editorContents = editor.document.isDirty ? editor.document.getText() : undefined;\n\t\tthis._selection = editor.selection;\n\t\tthis.resetChild();\n\n\t\tif (cc != null) {\n\t\t\tcc.exitDetails = `, uri=${Logger.toLoggable(this._uri)}`;\n\t\t}\n\t\treturn false;\n\t}\n\n\t@log()\n\tsetEditorFollowing(enabled: boolean) {\n\t\tthis.canSubscribe = enabled;\n\t}\n\n\t@debug()\n\tprotected subscribe() {\n\t\tif (Container.lineTracker.isSubscribed(this)) return undefined;\n\n\t\tconst onActiveLinesChanged = Functions.debounce(this.onActiveLinesChanged.bind(this), 250);\n\n\t\treturn Container.lineTracker.start(\n\t\t\tthis,\n\t\t\tContainer.lineTracker.onDidChangeActiveLines((e: LinesChangeEvent) => {\n\t\t\t\tif (e.pending) return;\n\n\t\t\t\tonActiveLinesChanged(e);\n\t\t\t}),\n\t\t);\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (e: LinesChangeEvent) =>\n\t\t\t\t`editor=${e.editor?.document.uri.toString(true)}, selections=${e.selections\n\t\t\t\t\t?.map(s => `[${s.anchor}-${s.active}]`)\n\t\t\t\t\t.join(',')}, pending=${Boolean(e.pending)}, reason=${e.reason}`,\n\t\t},\n\t})\n\tprivate onActiveLinesChanged(_e: LinesChangeEvent) {\n\t\tvoid this.triggerChange();\n\t}\n\n\tsetUri(uri?: GitUri) {\n\t\tthis._uri = uri ?? unknownGitUri;\n\t\tvoid setContext(ContextKeys.ViewsFileHistoryCanPin, this.hasUri);\n\t}\n}\n","'use strict';\nimport { Disposable, Selection, TreeItem, TreeItemCollapsibleState, window } from 'vscode';\nimport { Container } from '../../container';\nimport {\n\tGitBranch,\n\tGitCommitType,\n\tGitFile,\n\tGitFileIndexStatus,\n\tGitLog,\n\tGitLogCommit,\n\tGitRevision,\n\tRepositoryChange,\n\tRepositoryChangeComparisonMode,\n\tRepositoryChangeEvent,\n\tRepositoryFileSystemChangeEvent,\n} from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { Logger } from '../../logger';\nimport { debug, gate, Iterables, memoize } from '../../system';\nimport { FileHistoryView } from '../fileHistoryView';\nimport { LineHistoryView } from '../lineHistoryView';\nimport { LoadMoreNode, MessageNode } from './common';\nimport { FileRevisionAsCommitNode } from './fileRevisionAsCommitNode';\nimport { insertDateMarkers } from './helpers';\nimport { LineHistoryTrackerNode } from './lineHistoryTrackerNode';\nimport { RepositoryNode } from './repositoryNode';\nimport { ContextValues, PageableViewNode, SubscribeableViewNode, ViewNode } from './viewNode';\n\nexport class LineHistoryNode\n\textends SubscribeableViewNode<FileHistoryView | LineHistoryView>\n\timplements PageableViewNode\n{\n\tstatic key = ':history:line';\n\tstatic getId(repoPath: string, uri: string, selection: Selection): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${uri}[${selection.start.line},${\n\t\t\tselection.start.character\n\t\t}-${selection.end.line},${selection.end.character}])`;\n\t}\n\n\tprotected override splatted = true;\n\n\tconstructor(\n\t\turi: GitUri,\n\t\tview: FileHistoryView | LineHistoryView,\n\t\tparent: ViewNode,\n\t\tprivate readonly branch: GitBranch | undefined,\n\t\tpublic readonly selection: Selection,\n\t\tprivate readonly editorContents: string | undefined,\n\t) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\toverride toClipboard(): string {\n\t\treturn this.uri.fileName;\n\t}\n\n\toverride get id(): string {\n\t\treturn LineHistoryNode.getId(this.uri.repoPath!, this.uri.toString(true), this.selection);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tthis.view.description = `${this.label}${\n\t\t\tthis.parent instanceof LineHistoryTrackerNode && !this.parent.followingEditor ? ' (pinned)' : ''\n\t\t}`;\n\n\t\tconst children: ViewNode[] = [];\n\n\t\tlet selection = this.selection;\n\n\t\tconst range = this.branch != null ? await Container.git.getBranchAheadRange(this.branch) : undefined;\n\t\tconst [log, blame, getBranchAndTagTips, unpublishedCommits] = await Promise.all([\n\t\t\tthis.getLog(selection),\n\t\t\tthis.uri.sha == null\n\t\t\t\t? this.editorContents\n\t\t\t\t\t? await Container.git.getBlameForRangeContents(this.uri, selection, this.editorContents)\n\t\t\t\t\t: await Container.git.getBlameForRange(this.uri, selection)\n\t\t\t\t: undefined,\n\t\t\tthis.branch != null\n\t\t\t\t? Container.git.getBranchesAndTagsTipsFn(this.uri.repoPath, this.branch.name)\n\t\t\t\t: undefined,\n\t\t\trange\n\t\t\t\t? Container.git.getLogRefsOnly(this.uri.repoPath!, {\n\t\t\t\t\t\tlimit: 0,\n\t\t\t\t\t\tref: range,\n\t\t\t\t  })\n\t\t\t\t: undefined,\n\t\t]);\n\n\t\tif (this.uri.sha == null) {\n\t\t\t// Check for any uncommitted changes in the range\n\t\t\tif (blame != null) {\n\t\t\t\tfor (const commit of blame.commits.values()) {\n\t\t\t\t\tif (!commit.isUncommitted) continue;\n\n\t\t\t\t\tconst firstLine = blame.lines[0];\n\t\t\t\t\tconst lastLine = blame.lines[blame.lines.length - 1];\n\n\t\t\t\t\t// Since there could be a change in the line numbers, update the selection\n\t\t\t\t\tconst firstActive = selection.active.line === firstLine.line - 1;\n\t\t\t\t\tselection = new Selection(\n\t\t\t\t\t\t(firstActive ? lastLine : firstLine).originalLine - 1,\n\t\t\t\t\t\tselection.anchor.character,\n\t\t\t\t\t\t(firstActive ? firstLine : lastLine).originalLine - 1,\n\t\t\t\t\t\tselection.active.character,\n\t\t\t\t\t);\n\n\t\t\t\t\tconst status = await Container.git.getStatusForFile(this.uri.repoPath!, this.uri.fsPath);\n\n\t\t\t\t\tconst file: GitFile = {\n\t\t\t\t\t\tconflictStatus: status?.conflictStatus,\n\t\t\t\t\t\tfileName: commit.fileName,\n\t\t\t\t\t\tindexStatus: status?.indexStatus,\n\t\t\t\t\t\toriginalFileName: commit.originalFileName,\n\t\t\t\t\t\trepoPath: this.uri.repoPath!,\n\t\t\t\t\t\tstatus: status?.status ?? GitFileIndexStatus.Modified,\n\t\t\t\t\t\tworkingTreeStatus: status?.workingTreeStatus,\n\t\t\t\t\t};\n\n\t\t\t\t\tif (status?.workingTreeStatus != null && status?.indexStatus != null) {\n\t\t\t\t\t\tlet uncommitted = new GitLogCommit(\n\t\t\t\t\t\t\tGitCommitType.LogFile,\n\t\t\t\t\t\t\tthis.uri.repoPath!,\n\t\t\t\t\t\t\tGitRevision.uncommittedStaged,\n\t\t\t\t\t\t\t'You',\n\t\t\t\t\t\t\tcommit.email,\n\t\t\t\t\t\t\tcommit.authorDate,\n\t\t\t\t\t\t\tcommit.committerDate,\n\t\t\t\t\t\t\tcommit.message,\n\t\t\t\t\t\t\tcommit.fileName,\n\t\t\t\t\t\t\t[file],\n\t\t\t\t\t\t\tGitFileIndexStatus.Modified,\n\t\t\t\t\t\t\tcommit.originalFileName,\n\t\t\t\t\t\t\tcommit.previousSha,\n\t\t\t\t\t\t\tcommit.originalFileName ?? commit.fileName,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tchildren.splice(\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tnew FileRevisionAsCommitNode(this.view, this, file, uncommitted, {\n\t\t\t\t\t\t\t\tselection: selection,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tuncommitted = new GitLogCommit(\n\t\t\t\t\t\t\tGitCommitType.LogFile,\n\t\t\t\t\t\t\tthis.uri.repoPath!,\n\t\t\t\t\t\t\tGitRevision.uncommitted,\n\t\t\t\t\t\t\t'You',\n\t\t\t\t\t\t\tcommit.email,\n\t\t\t\t\t\t\tcommit.authorDate,\n\t\t\t\t\t\t\tcommit.committerDate,\n\t\t\t\t\t\t\tcommit.message,\n\t\t\t\t\t\t\tcommit.fileName,\n\t\t\t\t\t\t\t[file],\n\t\t\t\t\t\t\tGitFileIndexStatus.Modified,\n\t\t\t\t\t\t\tcommit.originalFileName,\n\t\t\t\t\t\t\tGitRevision.uncommittedStaged,\n\t\t\t\t\t\t\tcommit.originalFileName ?? commit.fileName,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tchildren.splice(\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tnew FileRevisionAsCommitNode(this.view, this, file, uncommitted, {\n\t\t\t\t\t\t\t\tselection: selection,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst uncommitted = new GitLogCommit(\n\t\t\t\t\t\t\tGitCommitType.LogFile,\n\t\t\t\t\t\t\tthis.uri.repoPath!,\n\t\t\t\t\t\t\tstatus?.workingTreeStatus != null\n\t\t\t\t\t\t\t\t? GitRevision.uncommitted\n\t\t\t\t\t\t\t\t: status?.indexStatus != null\n\t\t\t\t\t\t\t\t? GitRevision.uncommittedStaged\n\t\t\t\t\t\t\t\t: commit.sha,\n\t\t\t\t\t\t\t'You',\n\t\t\t\t\t\t\tcommit.email,\n\t\t\t\t\t\t\tcommit.authorDate,\n\t\t\t\t\t\t\tcommit.committerDate,\n\t\t\t\t\t\t\tcommit.message,\n\t\t\t\t\t\t\tcommit.fileName,\n\t\t\t\t\t\t\t[file],\n\t\t\t\t\t\t\tGitFileIndexStatus.Modified,\n\t\t\t\t\t\t\tcommit.originalFileName,\n\t\t\t\t\t\t\tcommit.previousSha,\n\t\t\t\t\t\t\tcommit.originalFileName ?? commit.fileName,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tchildren.splice(\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tnew FileRevisionAsCommitNode(this.view, this, file, uncommitted, {\n\t\t\t\t\t\t\t\tselection: selection,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (log != null) {\n\t\t\tchildren.push(\n\t\t\t\t...insertDateMarkers(\n\t\t\t\t\tIterables.filterMap(\n\t\t\t\t\t\tlog.commits.values(),\n\t\t\t\t\t\tc =>\n\t\t\t\t\t\t\tnew FileRevisionAsCommitNode(this.view, this, c.files[0], c, {\n\t\t\t\t\t\t\t\tbranch: this.branch,\n\t\t\t\t\t\t\t\tgetBranchAndTagTips: getBranchAndTagTips,\n\t\t\t\t\t\t\t\tselection: selection,\n\t\t\t\t\t\t\t\tunpublished: unpublishedCommits?.has(c.ref),\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t),\n\t\t\t\t\tthis,\n\t\t\t\t),\n\t\t\t);\n\n\t\t\tif (log.hasMore) {\n\t\t\t\tchildren.push(new LoadMoreNode(this.view, this, children[children.length - 1]));\n\t\t\t}\n\t\t}\n\n\t\tif (children.length === 0) return [new MessageNode(this.view, this, 'No line history could be found.')];\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tthis.splatted = false;\n\n\t\tconst label = this.label;\n\t\tconst item = new TreeItem(label, TreeItemCollapsibleState.Expanded);\n\t\titem.contextValue = ContextValues.LineHistory;\n\t\titem.description = this.uri.directory;\n\t\titem.tooltip = `History of ${this.uri.fileName}${this.lines}\\n${this.uri.directory}/${\n\t\t\tthis.uri.sha == null ? '' : `\\n\\n${this.uri.sha}`\n\t\t}`;\n\n\t\tthis.view.description = `${label}${\n\t\t\tthis.parent instanceof LineHistoryTrackerNode && !this.parent.followingEditor ? ' (pinned)' : ''\n\t\t}`;\n\n\t\treturn item;\n\t}\n\n\tget label() {\n\t\treturn `${this.uri.fileName}${this.lines}${\n\t\t\tthis.uri.sha\n\t\t\t\t? ` ${this.uri.sha === GitRevision.deletedOrMissing ? this.uri.shortSha : `(${this.uri.shortSha})`}`\n\t\t\t\t: ''\n\t\t}`;\n\t}\n\n\t@memoize()\n\tget lines() {\n\t\treturn this.selection.isSingleLine\n\t\t\t? `:${this.selection.start.line + 1}`\n\t\t\t: `:${this.selection.start.line + 1}-${this.selection.end.line + 1}`;\n\t}\n\n\t@debug()\n\tprotected async subscribe() {\n\t\tconst repo = await Container.git.getRepository(this.uri);\n\t\tif (repo == null) return undefined;\n\n\t\tconst subscription = Disposable.from(\n\t\t\trepo.onDidChange(this.onRepositoryChanged, this),\n\t\t\trepo.onDidChangeFileSystem(this.onFileSystemChanged, this),\n\t\t\trepo.startWatchingFileSystem(),\n\t\t);\n\n\t\treturn subscription;\n\t}\n\n\tprotected override get requiresResetOnVisible(): boolean {\n\t\treturn true;\n\t}\n\n\tprivate onRepositoryChanged(e: RepositoryChangeEvent) {\n\t\tif (\n\t\t\t!e.changed(\n\t\t\t\tRepositoryChange.Index,\n\t\t\t\tRepositoryChange.Heads,\n\t\t\t\tRepositoryChange.Remotes,\n\t\t\t\tRepositoryChange.RemoteProviders,\n\t\t\t\tRepositoryChange.Status,\n\t\t\t\tRepositoryChange.Unknown,\n\t\t\t\tRepositoryChangeComparisonMode.Any,\n\t\t\t)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tLogger.debug(`LineHistoryNode.onRepositoryChanged(${e.toString()}); triggering node refresh`);\n\n\t\tvoid this.triggerChange(true);\n\t}\n\n\tprivate onFileSystemChanged(e: RepositoryFileSystemChangeEvent) {\n\t\tif (!e.uris.some(uri => uri.toString() === this.uri.toString())) return;\n\n\t\tLogger.debug(`LineHistoryNode.onFileSystemChanged(${this.uri.toString(true)}); triggering node refresh`);\n\n\t\tvoid this.triggerChange(true);\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset?: boolean) {\n\t\tif (reset) {\n\t\t\tthis._log = undefined;\n\t\t}\n\t}\n\n\tprivate _log: GitLog | undefined;\n\tprivate async getLog(selection?: Selection) {\n\t\tif (this._log == null) {\n\t\t\tthis._log = await Container.git.getLogForFile(this.uri.repoPath, this.uri.fsPath, {\n\t\t\t\tall: false,\n\t\t\t\tlimit: this.limit ?? this.view.config.pageItemLimit,\n\t\t\t\trange: selection ?? this.selection,\n\t\t\t\tref: this.uri.sha,\n\t\t\t\trenames: false,\n\t\t\t});\n\t\t}\n\n\t\treturn this._log;\n\t}\n\n\tget hasMore() {\n\t\treturn this._log?.hasMore ?? true;\n\t}\n\n\tlimit: number | undefined = this.view.getNodeLastKnownLimit(this);\n\t@gate()\n\tasync loadMore(limit?: number | { until?: any }) {\n\t\tlet log = await window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: { viewId: this.view.id },\n\t\t\t},\n\t\t\t() => this.getLog(),\n\t\t);\n\t\tif (log == null || !log.hasMore) return;\n\n\t\tlog = await log.more?.(limit ?? this.view.config.pageItemLimit);\n\t\tif (this._log === log) return;\n\n\t\tthis._log = log;\n\t\tthis.limit = log?.count;\n\n\t\t// Needs to force if splatted, since the parent node will cancel the refresh (since it thinks nothing changed)\n\t\tvoid this.triggerChange(false, this.splatted);\n\t}\n}\n","'use strict';\nimport { Disposable, TextEditor, TreeItem, TreeItemCollapsibleState, window } from 'vscode';\nimport { Container } from '../../container';\nimport { GitUri } from '../../git/gitUri';\nimport { Logger } from '../../logger';\nimport { debug, Functions, gate } from '../../system';\nimport { RepositoriesView } from '../repositoriesView';\nimport { MessageNode } from './common';\nimport { RepositoryNode } from './repositoryNode';\nimport { ContextValues, SubscribeableViewNode, unknownGitUri, ViewNode } from './viewNode';\n\nexport class RepositoriesNode extends SubscribeableViewNode<RepositoriesView> {\n\tprivate _children: (RepositoryNode | MessageNode)[] | undefined;\n\n\tconstructor(view: RepositoriesView) {\n\t\tsuper(unknownGitUri, view);\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\n\t\tthis.resetChildren();\n\t}\n\n\t@debug()\n\tprivate resetChildren() {\n\t\tif (this._children === undefined) return;\n\n\t\tfor (const child of this._children) {\n\t\t\tif (child instanceof RepositoryNode) {\n\t\t\t\tchild.dispose();\n\t\t\t}\n\t\t}\n\t\tthis._children = undefined;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._children === undefined) {\n\t\t\tconst repositories = await Container.git.getOrderedRepositories();\n\t\t\tif (repositories.length === 0) return [new MessageNode(this.view, this, 'No repositories could be found.')];\n\n\t\t\tthis._children = repositories.map(r => new RepositoryNode(GitUri.fromRepoPath(r.path), this.view, this, r));\n\t\t}\n\n\t\treturn this._children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Repositories', TreeItemCollapsibleState.Expanded);\n\t\titem.contextValue = ContextValues.Repositories;\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride async refresh(reset: boolean = false) {\n\t\tif (this._children === undefined) return;\n\n\t\tif (reset) {\n\t\t\tthis.resetChildren();\n\t\t\tawait this.unsubscribe();\n\t\t\tvoid this.ensureSubscription();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst repositories = await Container.git.getOrderedRepositories();\n\t\tif (repositories.length === 0 && (this._children === undefined || this._children.length === 0)) return;\n\n\t\tif (repositories.length === 0) {\n\t\t\tthis._children = [new MessageNode(this.view, this, 'No repositories could be found.')];\n\t\t\treturn;\n\t\t}\n\n\t\tconst children = [];\n\t\tfor (const repo of repositories) {\n\t\t\tconst normalizedPath = repo.normalizedPath;\n\t\t\tconst child = (this._children as RepositoryNode[]).find(c => c.repo.normalizedPath === normalizedPath);\n\t\t\tif (child !== undefined) {\n\t\t\t\tchildren.push(child);\n\t\t\t\tvoid child.refresh();\n\t\t\t} else {\n\t\t\t\tchildren.push(new RepositoryNode(GitUri.fromRepoPath(repo.path), this.view, this, repo));\n\t\t\t}\n\t\t}\n\n\t\tfor (const child of this._children as RepositoryNode[]) {\n\t\t\tif (children.includes(child)) continue;\n\n\t\t\tchild.dispose();\n\t\t}\n\n\t\tthis._children = children;\n\n\t\tvoid this.ensureSubscription();\n\t}\n\n\t@debug()\n\tprotected subscribe() {\n\t\tconst subscriptions = [Container.git.onDidChangeRepositories(this.onRepositoriesChanged, this)];\n\n\t\tif (this.view.config.autoReveal) {\n\t\t\tsubscriptions.push(\n\t\t\t\twindow.onDidChangeActiveTextEditor(Functions.debounce(this.onActiveEditorChanged, 500), this),\n\t\t\t);\n\t\t}\n\n\t\treturn Disposable.from(...subscriptions);\n\t}\n\n\tprotected override get requiresResetOnVisible(): boolean {\n\t\treturn true;\n\t}\n\n\t@debug({ args: false })\n\tprivate onActiveEditorChanged(editor: TextEditor | undefined) {\n\t\tif (editor == null || this._children === undefined || this._children.length === 1) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tconst uri = editor.document.uri;\n\t\t\tconst node = this._children.find(n => n instanceof RepositoryNode && n.repo.containsUri(uri)) as\n\t\t\t\t| RepositoryNode\n\t\t\t\t| undefined;\n\t\t\tif (node === undefined) return;\n\n\t\t\t// Check to see if this repo has a descendent that is already selected\n\t\t\tlet parent = this.view.selection.length === 0 ? undefined : this.view.selection[0];\n\t\t\twhile (parent !== undefined) {\n\t\t\t\tif (parent === node) return;\n\n\t\t\t\tparent = parent.getParent();\n\t\t\t}\n\n\t\t\tvoid this.view.reveal(node, { expand: true });\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t}\n\t}\n\n\t@debug()\n\tprivate onRepositoriesChanged() {\n\t\tvoid this.triggerChange();\n\t}\n}\n","'use strict';\nimport { ThemeIcon, TreeItem } from 'vscode';\nimport { executeGitCommand } from '../../commands';\nimport { Container } from '../../container';\nimport { GitLog, SearchPattern } from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { debug, gate, log, Strings } from '../../system';\nimport { SearchAndCompareView } from '../searchAndCompareView';\nimport { RepositoryNode } from './repositoryNode';\nimport { CommitsQueryResults, ResultsCommitsNode } from './resultsCommitsNode';\nimport { ContextValues, PageableViewNode, ViewNode } from './viewNode';\n\nlet instanceId = 0;\n\ninterface SearchQueryResults {\n\treadonly label: string;\n\treadonly log: GitLog | undefined;\n\treadonly hasMore: boolean;\n\tmore?(limit: number | undefined): Promise<void>;\n}\n\nexport class SearchResultsNode extends ViewNode<SearchAndCompareView> implements PageableViewNode {\n\tstatic key = ':search-results';\n\tstatic getId(repoPath: string, search: SearchPattern | undefined, instanceId: number): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${\n\t\t\tsearch == null ? '?' : SearchPattern.toKey(search)\n\t\t}):${instanceId}`;\n\t}\n\n\tstatic getPinnableId(repoPath: string, search: SearchPattern) {\n\t\treturn Strings.sha1(`${repoPath}|${SearchPattern.toKey(search)}`);\n\t}\n\n\tstatic override is(node: any): node is SearchResultsNode {\n\t\treturn node instanceof SearchResultsNode;\n\t}\n\n\tprivate _instanceId: number;\n\tconstructor(\n\t\tview: SearchAndCompareView,\n\t\tparent: ViewNode,\n\t\tpublic readonly repoPath: string,\n\t\tsearch: SearchPattern,\n\t\tprivate _labels: {\n\t\t\tlabel: string;\n\t\t\tqueryLabel:\n\t\t\t\t| string\n\t\t\t\t| {\n\t\t\t\t\t\tlabel: string;\n\t\t\t\t\t\tresultsType?: { singular: string; plural: string };\n\t\t\t\t  };\n\t\t\tresultsType?: { singular: string; plural: string };\n\t\t},\n\t\tprivate _searchQueryOrLog?:\n\t\t\t| ((limit: number | undefined) => Promise<CommitsQueryResults>)\n\t\t\t| Promise<GitLog | undefined>\n\t\t\t| GitLog\n\t\t\t| undefined,\n\t\tprivate _pinned: number = 0,\n\t) {\n\t\tsuper(GitUri.fromRepoPath(repoPath), view, parent);\n\n\t\tthis._search = search;\n\t\tthis._instanceId = instanceId++;\n\t\tthis._order = Date.now();\n\t}\n\n\toverride get id(): string {\n\t\treturn SearchResultsNode.getId(this.repoPath, this.search, this._instanceId);\n\t}\n\n\tget canDismiss(): boolean {\n\t\treturn !this.pinned;\n\t}\n\n\tprivate readonly _order: number = Date.now();\n\tget order(): number {\n\t\treturn this._pinned || this._order;\n\t}\n\n\tget pinned(): boolean {\n\t\treturn this._pinned !== 0;\n\t}\n\n\tprivate _search: SearchPattern;\n\tget search(): SearchPattern {\n\t\treturn this._search;\n\t}\n\n\tprivate _resultsNode: ResultsCommitsNode | undefined;\n\tprivate ensureResults() {\n\t\tif (this._resultsNode == null) {\n\t\t\tlet deferred;\n\t\t\tif (this._searchQueryOrLog == null) {\n\t\t\t\tdeferred = true;\n\t\t\t\tthis._searchQueryOrLog = this.getSearchQuery({\n\t\t\t\t\tlabel: this._labels.queryLabel,\n\t\t\t\t});\n\t\t\t} else if (typeof this._searchQueryOrLog !== 'function') {\n\t\t\t\tthis._searchQueryOrLog = this.getSearchQuery(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: this._labels.queryLabel,\n\t\t\t\t\t},\n\t\t\t\t\tthis._searchQueryOrLog,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis._resultsNode = new ResultsCommitsNode(\n\t\t\t\tthis.view,\n\t\t\t\tthis,\n\t\t\t\tthis.repoPath,\n\t\t\t\tthis._labels.label,\n\t\t\t\t{\n\t\t\t\t\tquery: this._searchQueryOrLog,\n\t\t\t\t\tdeferred: deferred,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\texpand: !this.pinned,\n\t\t\t\t},\n\t\t\t\ttrue,\n\t\t\t);\n\t\t}\n\n\t\treturn this._resultsNode;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\treturn this.ensureResults().getChildren();\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tconst item = await this.ensureResults().getTreeItem();\n\t\titem.id = this.id;\n\t\titem.contextValue = `${ContextValues.SearchResults}${this._pinned ? '+pinned' : ''}`;\n\t\tif ((await Container.git.getRepositoryCount()) > 1) {\n\t\t\tconst repo = await Container.git.getRepository(this.repoPath);\n\t\t\titem.description = repo?.formattedName ?? this.repoPath;\n\t\t}\n\t\tif (this._pinned) {\n\t\t\titem.iconPath = new ThemeIcon('pinned');\n\t\t}\n\n\t\treturn item;\n\t}\n\n\tget hasMore() {\n\t\treturn this.ensureResults().hasMore;\n\t}\n\n\tasync loadMore(limit?: number) {\n\t\treturn this.ensureResults().loadMore(limit);\n\t}\n\n\tasync edit(search?: {\n\t\tpattern: SearchPattern;\n\t\tlabels: {\n\t\t\tlabel: string;\n\t\t\tqueryLabel:\n\t\t\t\t| string\n\t\t\t\t| {\n\t\t\t\t\t\tlabel: string;\n\t\t\t\t\t\tresultsType?: { singular: string; plural: string };\n\t\t\t\t  };\n\t\t\tresultsType?: { singular: string; plural: string };\n\t\t};\n\t\tlog: Promise<GitLog | undefined> | GitLog | undefined;\n\t}) {\n\t\tif (search == null) {\n\t\t\tvoid (await executeGitCommand({\n\t\t\t\tcommand: 'search',\n\t\t\t\tprefillOnly: true,\n\t\t\t\tstate: {\n\t\t\t\t\trepo: this.repoPath,\n\t\t\t\t\t...this.search,\n\t\t\t\t\tshowResultsInSideBar: this,\n\t\t\t\t},\n\t\t\t}));\n\n\t\t\treturn;\n\t\t}\n\n\t\t// Save the current id so we can update it later\n\t\tconst currentId = this.getPinnableId();\n\n\t\tthis._search = search.pattern;\n\t\tthis._labels = search.labels;\n\t\tthis._searchQueryOrLog = search.log;\n\t\tthis._resultsNode = undefined;\n\n\t\t// If we were pinned, remove the existing pin and save a new one\n\t\tif (this.pinned) {\n\t\t\tawait this.view.updatePinned(currentId);\n\t\t\tawait this.updatePinned();\n\t\t}\n\n\t\tvoid this.triggerChange(false);\n\t\tsetImmediate(() => this.view.reveal(this, { expand: true, focus: true, select: true }));\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset: boolean = false) {\n\t\tthis._resultsNode?.refresh(reset);\n\t}\n\n\t@log()\n\tasync pin() {\n\t\tif (this.pinned) return;\n\n\t\tthis._pinned = Date.now();\n\t\tawait this.updatePinned();\n\n\t\tsetImmediate(() => this.view.reveal(this, { focus: true, select: true }));\n\t}\n\n\t@log()\n\tasync unpin() {\n\t\tif (!this.pinned) return;\n\n\t\tthis._pinned = 0;\n\t\tawait this.view.updatePinned(this.getPinnableId());\n\n\t\tsetImmediate(() => this.view.reveal(this, { focus: true, select: true }));\n\t}\n\n\tprivate getPinnableId() {\n\t\treturn SearchResultsNode.getPinnableId(this.repoPath, this.search);\n\t}\n\n\tprivate getSearchLabel(\n\t\tlabel:\n\t\t\t| string\n\t\t\t| {\n\t\t\t\t\tlabel: string;\n\t\t\t\t\tresultsType?: { singular: string; plural: string };\n\t\t\t  },\n\t\tlog: GitLog | undefined,\n\t): string {\n\t\tif (typeof label === 'string') return label;\n\n\t\tconst count = log?.count ?? 0;\n\n\t\tconst resultsType =\n\t\t\tlabel.resultsType === undefined ? { singular: 'result', plural: 'results' } : label.resultsType;\n\n\t\treturn `${Strings.pluralize(resultsType.singular, count, {\n\t\t\tnumber: log?.hasMore ?? false ? `${count}+` : undefined,\n\t\t\tplural: resultsType.plural,\n\t\t\tzero: 'No',\n\t\t})} ${label.label}`;\n\t}\n\n\tprivate getSearchQuery(\n\t\toptions: {\n\t\t\tlabel:\n\t\t\t\t| string\n\t\t\t\t| {\n\t\t\t\t\t\tlabel: string;\n\t\t\t\t\t\tresultsType?: { singular: string; plural: string };\n\t\t\t\t  };\n\t\t},\n\t\tlog?: Promise<GitLog | undefined> | GitLog,\n\t): (limit: number | undefined) => Promise<SearchQueryResults> {\n\t\tlet useCacheOnce = true;\n\n\t\treturn async (limit: number | undefined) => {\n\t\t\tlog = await (log ?? Container.git.getLogForSearch(this.repoPath, this.search));\n\n\t\t\tif (!useCacheOnce && log != null && log.query != null) {\n\t\t\t\tlog = await log.query(limit);\n\t\t\t}\n\t\t\tuseCacheOnce = false;\n\n\t\t\tconst results: Mutable<SearchQueryResults> = {\n\t\t\t\tlabel: this.getSearchLabel(options.label, log),\n\t\t\t\tlog: log,\n\t\t\t\thasMore: log?.hasMore ?? false,\n\t\t\t};\n\t\t\tif (results.hasMore) {\n\t\t\t\tresults.more = async (limit: number | undefined) => {\n\t\t\t\t\tresults.log = (await results.log?.more?.(limit)) ?? results.log;\n\n\t\t\t\t\tresults.label = this.getSearchLabel(options.label, results.log);\n\t\t\t\t\tresults.hasMore = results.log?.hasMore ?? true;\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn results;\n\t\t};\n\t}\n\n\tprivate updatePinned() {\n\t\treturn this.view.updatePinned(this.getPinnableId(), {\n\t\t\ttype: 'search',\n\t\t\ttimestamp: this._pinned,\n\t\t\tpath: this.repoPath,\n\t\t\tlabels: this._labels,\n\t\t\tsearch: this.search,\n\t\t});\n\t}\n}\n","'use strict';\nimport { GitFile, GitLogCommit } from '../../git/git';\nimport { RepositoriesView } from '../repositoriesView';\nimport { StashesView } from '../stashesView';\nimport { CommitFileNode } from './commitFileNode';\nimport { ContextValues, ViewNode } from './viewNode';\n\nexport class StashFileNode extends CommitFileNode<StashesView | RepositoriesView> {\n\tconstructor(view: StashesView | RepositoriesView, parent: ViewNode, file: GitFile, commit: GitLogCommit) {\n\t\tsuper(view, parent, file, commit);\n\t}\n\n\tprotected override get contextValue(): string {\n\t\treturn `${ContextValues.File}+stashed`;\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { GlyphChars, NamedRef } from '../../constants';\nimport { Container } from '../../container';\nimport { SearchAndCompareView, SearchAndCompareViewNode } from '../searchAndCompareView';\nimport { ContextValues, unknownGitUri, ViewNode } from './viewNode';\n\ninterface RepoRef {\n\tlabel: string;\n\trepoPath: string;\n\tref: string | NamedRef;\n}\n\nexport class ComparePickerNode extends ViewNode<SearchAndCompareView> {\n\treadonly order: number = Date.now();\n\treadonly pinned: boolean = false;\n\n\tconstructor(view: SearchAndCompareView, parent: SearchAndCompareViewNode, public readonly selectedRef: RepoRef) {\n\t\tsuper(unknownGitUri, view, parent);\n\t}\n\n\tget canDismiss(): boolean {\n\t\treturn true;\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\treturn [];\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tconst selectedRef = this.selectedRef;\n\t\tconst repoPath = selectedRef?.repoPath;\n\n\t\tlet description;\n\t\tif (repoPath !== undefined) {\n\t\t\tif ((await Container.git.getRepositoryCount()) > 1) {\n\t\t\t\tconst repo = await Container.git.getRepository(repoPath);\n\t\t\t\tdescription = repo?.formattedName ?? repoPath;\n\t\t\t}\n\t\t}\n\n\t\tlet item;\n\t\tif (selectedRef == null) {\n\t\t\titem = new TreeItem(\n\t\t\t\t'Compare <branch, tag, or ref> with <branch, tag, or ref>',\n\t\t\t\tTreeItemCollapsibleState.None,\n\t\t\t);\n\t\t\titem.contextValue = ContextValues.ComparePicker;\n\t\t\titem.description = description;\n\t\t\titem.tooltip = `Click to select or enter a reference for compare${GlyphChars.Ellipsis}`;\n\t\t\titem.command = {\n\t\t\t\ttitle: `Compare${GlyphChars.Ellipsis}`,\n\t\t\t\tcommand: this.view.getQualifiedCommand('selectForCompare'),\n\t\t\t};\n\t\t} else {\n\t\t\titem = new TreeItem(\n\t\t\t\t`Compare ${selectedRef.label} with <branch, tag, or ref>`,\n\t\t\t\tTreeItemCollapsibleState.None,\n\t\t\t);\n\t\t\titem.contextValue = ContextValues.ComparePickerWithRef;\n\t\t\titem.description = description;\n\t\t\titem.tooltip = `Click to compare ${selectedRef.label} with${GlyphChars.Ellipsis}`;\n\t\t\titem.command = {\n\t\t\t\ttitle: `Compare ${selectedRef.label} with${GlyphChars.Ellipsis}`,\n\t\t\t\tcommand: this.view.getQualifiedCommand('compareWithSelected'),\n\t\t\t};\n\t\t}\n\n\t\treturn item;\n\t}\n}\n","'use strict';\nimport {\n\tCommand,\n\tDisposable,\n\tEvent,\n\tMarkdownString,\n\tTreeItem,\n\tTreeItemCollapsibleState,\n\tTreeViewVisibilityChangeEvent,\n} from 'vscode';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport {\n\tGitFile,\n\tGitReference,\n\tGitRemote,\n\tGitRevisionReference,\n\tRepository,\n\tRepositoryChange,\n\tRepositoryChangeComparisonMode,\n\tRepositoryChangeEvent,\n} from '../../git/git';\nimport { GitUri } from '../../git/gitUri';\nimport { Logger } from '../../logger';\nimport { debug, Functions, gate, log, logName, Strings } from '../../system';\nimport { TreeViewNodeCollapsibleStateChangeEvent, View } from '../viewBase';\n\nexport enum ContextValues {\n\tActiveFileHistory = 'gitlens:history:active:file',\n\tActiveLineHistory = 'gitlens:history:active:line',\n\tBranch = 'gitlens:branch',\n\tBranches = 'gitlens:branches',\n\tBranchStatusAheadOfUpstream = 'gitlens:status-branch:upstream:ahead',\n\tBranchStatusBehindUpstream = 'gitlens:status-branch:upstream:behind',\n\tBranchStatusNoUpstream = 'gitlens:status-branch:upstream:none',\n\tBranchStatusSameAsUpstream = 'gitlens:status-branch:upstream:same',\n\tBranchStatusFiles = 'gitlens:status-branch:files',\n\tCommit = 'gitlens:commit',\n\tCommits = 'gitlens:commits',\n\tCompare = 'gitlens:compare',\n\tCompareBranch = 'gitlens:compare:branch',\n\tComparePicker = 'gitlens:compare:picker',\n\tComparePickerWithRef = 'gitlens:compare:picker:ref',\n\tCompareResults = 'gitlens:compare:results',\n\tCompareResultsCommits = 'gitlens:compare:results:commits',\n\tContributor = 'gitlens:contributor',\n\tContributors = 'gitlens:contributors',\n\tDateMarker = 'gitlens:date-marker',\n\tFile = 'gitlens:file',\n\tFileHistory = 'gitlens:history:file',\n\tFolder = 'gitlens:folder',\n\tLineHistory = 'gitlens:history:line',\n\tMerge = 'gitlens:merge',\n\tMergeConflictCurrentChanges = 'gitlens:merge-conflict:current',\n\tMergeConflictIncomingChanges = 'gitlens:merge-conflict:incoming',\n\tMessage = 'gitlens:message',\n\tPager = 'gitlens:pager',\n\tPullRequest = 'gitlens:pullrequest',\n\tRebase = 'gitlens:rebase',\n\tReflog = 'gitlens:reflog',\n\tReflogRecord = 'gitlens:reflog-record',\n\tRemote = 'gitlens:remote',\n\tRemotes = 'gitlens:remotes',\n\tRepositories = 'gitlens:repositories',\n\tRepository = 'gitlens:repository',\n\tRepositoryFolder = 'gitlens:repo-folder',\n\tResultsFile = 'gitlens:file:results',\n\tResultsFiles = 'gitlens:results:files',\n\tSearchAndCompare = 'gitlens:searchAndCompare',\n\tSearchResults = 'gitlens:search:results',\n\tSearchResultsCommits = 'gitlens:search:results:commits',\n\tStash = 'gitlens:stash',\n\tStashes = 'gitlens:stashes',\n\tStatusFileCommits = 'gitlens:status:file:commits',\n\tStatusFiles = 'gitlens:status:files',\n\tStatusAheadOfUpstream = 'gitlens:status:upstream:ahead',\n\tStatusBehindUpstream = 'gitlens:status:upstream:behind',\n\tStatusNoUpstream = 'gitlens:status:upstream:none',\n\tStatusSameAsUpstream = 'gitlens:status:upstream:same',\n\tTag = 'gitlens:tag',\n\tTags = 'gitlens:tags',\n}\n\nexport const unknownGitUri = new GitUri();\n\nexport interface ViewNode {\n\treadonly id?: string;\n}\n\n@logName<ViewNode>((c, name) => `${name}${c.id != null ? `(${c.id})` : ''}`)\nexport abstract class ViewNode<TView extends View = View> {\n\tstatic is(node: any): node is ViewNode {\n\t\treturn node instanceof ViewNode;\n\t}\n\n\tprotected splatted = false;\n\n\tconstructor(uri: GitUri, public readonly view: TView, protected readonly parent?: ViewNode) {\n\t\tthis._uri = uri;\n\t}\n\n\ttoClipboard?(): string;\n\n\ttoString(): string {\n\t\treturn `${Logger.toLoggableName(this)}${this.id != null ? `(${this.id})` : ''}`;\n\t}\n\n\tprotected _uri: GitUri;\n\tget uri() {\n\t\treturn this._uri;\n\t}\n\n\tabstract getChildren(): ViewNode[] | Promise<ViewNode[]>;\n\n\tgetParent(): ViewNode | undefined {\n\t\t// If this node's parent has been splatted (e.g. not shown itself, but its children are), then return its grandparent\n\t\treturn this.parent?.splatted ? this.parent?.getParent() : this.parent;\n\t}\n\n\tabstract getTreeItem(): TreeItem | Promise<TreeItem>;\n\n\tresolveTreeItem(item: TreeItem): TreeItem | Promise<TreeItem> {\n\t\treturn item;\n\t}\n\n\tgetCommand(): Command | undefined {\n\t\treturn undefined;\n\t}\n\n\trefresh?(reset?: boolean): boolean | void | Promise<void> | Promise<boolean>;\n\n\t@gate<ViewNode['triggerChange']>((reset: boolean = false, force: boolean = false, avoidSelf?: ViewNode) =>\n\t\tJSON.stringify([reset, force, avoidSelf?.toString()]),\n\t)\n\t@debug()\n\ttriggerChange(reset: boolean = false, force: boolean = false, avoidSelf?: ViewNode): Promise<void> {\n\t\t// If this node has been splatted (e.g. not shown itself, but its children are), then delegate the change to its parent\n\t\tif (this.splatted && this.parent != null && this.parent !== avoidSelf) {\n\t\t\treturn this.parent.triggerChange(reset, force);\n\t\t}\n\n\t\treturn this.view.refreshNode(this, reset, force);\n\t}\n\n\tgetSplattedChild?(): Promise<ViewNode | undefined>;\n}\n\nexport abstract class ViewRefNode<\n\tTView extends View = View,\n\tTReference extends GitReference = GitReference,\n> extends ViewNode<TView> {\n\tabstract get ref(): TReference;\n\n\tget repoPath(): string {\n\t\treturn this.uri.repoPath!;\n\t}\n\n\toverride toString(): string {\n\t\treturn `${super.toString()}:${GitReference.toString(this.ref, false)}`;\n\t}\n}\n\nexport abstract class ViewRefFileNode<TView extends View = View> extends ViewRefNode<TView, GitRevisionReference> {\n\tabstract get file(): GitFile;\n\tabstract get fileName(): string;\n\n\toverride toString(): string {\n\t\treturn `${super.toString()}:${this.fileName}`;\n\t}\n}\n\nexport interface PageableViewNode {\n\treadonly id: string;\n\tlimit?: number;\n\treadonly hasMore: boolean;\n\tloadMore(limit?: number | { until?: any }): Promise<void>;\n}\n\nexport namespace PageableViewNode {\n\texport function is(node: ViewNode): node is ViewNode & PageableViewNode {\n\t\treturn Functions.is<ViewNode & PageableViewNode>(node, 'loadMore');\n\t}\n}\n\nexport abstract class SubscribeableViewNode<TView extends View = View> extends ViewNode<TView> {\n\tprotected disposable: Disposable;\n\tprotected subscription: Promise<Disposable | undefined> | undefined;\n\n\tprotected loaded: boolean = false;\n\n\tconstructor(uri: GitUri, view: TView, parent?: ViewNode) {\n\t\tsuper(uri, view, parent);\n\n\t\tconst disposables = [\n\t\t\tthis.view.onDidChangeVisibility(this.onVisibilityChanged, this),\n\t\t\tthis.view.onDidChangeNodeCollapsibleState(this.onNodeCollapsibleStateChanged, this),\n\t\t];\n\n\t\tif (canAutoRefreshView(this.view)) {\n\t\t\tdisposables.push(this.view.onDidChangeAutoRefresh(this.onAutoRefreshChanged, this));\n\t\t}\n\n\t\tconst getTreeItem = this.getTreeItem;\n\t\tthis.getTreeItem = function (this: SubscribeableViewNode<TView>) {\n\t\t\tthis.loaded = true;\n\t\t\tvoid this.ensureSubscription();\n\t\t\treturn getTreeItem.apply(this);\n\t\t};\n\n\t\tconst getChildren = this.getChildren;\n\t\tthis.getChildren = function (this: SubscribeableViewNode<TView>) {\n\t\t\tthis.loaded = true;\n\t\t\tvoid this.ensureSubscription();\n\t\t\treturn getChildren.apply(this);\n\t\t};\n\n\t\tthis.disposable = Disposable.from(...disposables);\n\t}\n\n\t@debug()\n\tdispose() {\n\t\tvoid this.unsubscribe();\n\n\t\tthis.disposable?.dispose();\n\t}\n\n\t@gate()\n\t@debug()\n\toverride async triggerChange(reset: boolean = false, force: boolean = false): Promise<void> {\n\t\tif (!this.loaded) return;\n\n\t\tawait super.triggerChange(reset, force);\n\t}\n\n\tprivate _canSubscribe: boolean = true;\n\tprotected get canSubscribe(): boolean {\n\t\treturn this._canSubscribe;\n\t}\n\tprotected set canSubscribe(value: boolean) {\n\t\tif (this._canSubscribe === value) return;\n\n\t\tthis._canSubscribe = value;\n\n\t\tvoid this.ensureSubscription();\n\t\tif (value) {\n\t\t\tvoid this.triggerChange();\n\t\t}\n\t}\n\n\tprotected get requiresResetOnVisible(): boolean {\n\t\treturn false;\n\t}\n\n\tprotected abstract subscribe(): Disposable | undefined | Promise<Disposable | undefined>;\n\n\t@debug()\n\tprotected async unsubscribe(): Promise<void> {\n\t\tif (this.subscription != null) {\n\t\t\tconst subscriptionPromise = this.subscription;\n\t\t\tthis.subscription = undefined;\n\n\t\t\t(await subscriptionPromise)?.dispose();\n\t\t}\n\t}\n\n\t@debug()\n\tprotected onAutoRefreshChanged() {\n\t\tthis.onVisibilityChanged({ visible: this.view.visible });\n\t}\n\n\tprotected onParentCollapsibleStateChanged?(state: TreeItemCollapsibleState): void;\n\tprotected onCollapsibleStateChanged?(state: TreeItemCollapsibleState): void;\n\n\tprotected collapsibleState: TreeItemCollapsibleState | undefined;\n\tprotected onNodeCollapsibleStateChanged(e: TreeViewNodeCollapsibleStateChangeEvent<ViewNode>) {\n\t\tif (e.element === this) {\n\t\t\tthis.collapsibleState = e.state;\n\t\t\tif (this.onCollapsibleStateChanged !== undefined) {\n\t\t\t\tthis.onCollapsibleStateChanged(e.state);\n\t\t\t}\n\t\t} else if (e.element === this.parent) {\n\t\t\tif (this.onParentCollapsibleStateChanged !== undefined) {\n\t\t\t\tthis.onParentCollapsibleStateChanged(e.state);\n\t\t\t}\n\t\t}\n\t}\n\n\t@debug()\n\tprotected onVisibilityChanged(e: TreeViewVisibilityChangeEvent) {\n\t\tvoid this.ensureSubscription();\n\n\t\tif (e.visible) {\n\t\t\tvoid this.triggerChange(this.requiresResetOnVisible);\n\t\t}\n\t}\n\n\t@gate()\n\t@debug()\n\tasync ensureSubscription() {\n\t\t// We only need to subscribe if we are visible and if auto-refresh enabled (when supported)\n\t\tif (!this.canSubscribe || !this.view.visible || (canAutoRefreshView(this.view) && !this.view.autoRefresh)) {\n\t\t\tawait this.unsubscribe();\n\n\t\t\treturn;\n\t\t}\n\n\t\t// If we already have a subscription, just kick out\n\t\tif (this.subscription != null) return;\n\n\t\tthis.subscription = Promise.resolve(this.subscribe());\n\t\tawait this.subscription;\n\t}\n\n\t@gate()\n\t@debug()\n\tasync resetSubscription() {\n\t\tawait this.unsubscribe();\n\t\tawait this.ensureSubscription();\n\t}\n}\n\nexport abstract class RepositoryFolderNode<\n\tTView extends View = View,\n\tTChild extends ViewNode = ViewNode,\n> extends SubscribeableViewNode<TView> {\n\tstatic key = ':repository';\n\tstatic getId(repoPath: string): string {\n\t\treturn `gitlens${this.key}(${repoPath})`;\n\t}\n\n\tprotected override splatted = true;\n\tprotected child: TChild | undefined;\n\n\tconstructor(\n\t\turi: GitUri,\n\t\tview: TView,\n\t\tparent: ViewNode,\n\t\tpublic readonly repo: Repository,\n\t\tsplatted: boolean,\n\t\tprivate readonly options?: { showBranchAndLastFetched?: boolean },\n\t) {\n\t\tsuper(uri, view, parent);\n\n\t\tthis.splatted = splatted;\n\t}\n\n\toverride toClipboard(): string {\n\t\treturn this.repo.path;\n\t}\n\n\toverride get id(): string {\n\t\treturn RepositoryFolderNode.getId(this.repo.path);\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tthis.splatted = false;\n\n\t\tlet expand = this.repo.starred;\n\t\tconst [active, branch] = await Promise.all([\n\t\t\texpand ? undefined : Container.git.isActiveRepoPath(this.uri.repoPath),\n\t\t\tthis.repo.getBranch(),\n\t\t]);\n\n\t\tconst ahead = (branch?.state.ahead ?? 0) > 0;\n\t\tconst behind = (branch?.state.behind ?? 0) > 0;\n\n\t\tif (!expand && (active || ahead || behind)) {\n\t\t\texpand = true;\n\t\t}\n\n\t\tconst item = new TreeItem(\n\t\t\tthis.repo.formattedName ?? this.uri.repoPath ?? '',\n\t\t\texpand ? TreeItemCollapsibleState.Expanded : TreeItemCollapsibleState.Collapsed,\n\t\t);\n\t\titem.contextValue = `${ContextValues.RepositoryFolder}${this.repo.starred ? '+starred' : ''}`;\n\t\tif (ahead) {\n\t\t\titem.contextValue += '+ahead';\n\t\t}\n\t\tif (behind) {\n\t\t\titem.contextValue += '+behind';\n\t\t}\n\n\t\tif (branch != null && this.options?.showBranchAndLastFetched) {\n\t\t\tconst lastFetched = (await this.repo.getLastFetched()) ?? 0;\n\n\t\t\tconst status = branch.getTrackingStatus();\n\t\t\titem.description = `${this.repo.supportsChangeEvents ? '' : Strings.pad(GlyphChars.Warning, 1, 2)}${\n\t\t\t\tstatus ? `${status}${Strings.pad(GlyphChars.Dot, 1, 1)}` : ''\n\t\t\t}${branch.name}${\n\t\t\t\tlastFetched\n\t\t\t\t\t? `${Strings.pad(GlyphChars.Dot, 1, 1)}Last fetched ${Repository.formatLastFetched(lastFetched)}`\n\t\t\t\t\t: ''\n\t\t\t}`;\n\n\t\t\tlet providerName;\n\t\t\tif (branch.upstream != null) {\n\t\t\t\tconst providers = GitRemote.getHighlanderProviders(await Container.git.getRemotes(branch.repoPath));\n\t\t\t\tproviderName = providers?.length ? providers[0].name : undefined;\n\t\t\t} else {\n\t\t\t\tconst remote = await branch.getRemote();\n\t\t\t\tproviderName = remote?.provider?.name;\n\t\t\t}\n\n\t\t\titem.tooltip = new MarkdownString(\n\t\t\t\t`${this.repo.formattedName ?? this.uri.repoPath ?? ''}${\n\t\t\t\t\tlastFetched\n\t\t\t\t\t\t? `${Strings.pad(GlyphChars.Dash, 2, 2)}Last fetched ${Repository.formatLastFetched(\n\t\t\t\t\t\t\t\tlastFetched,\n\t\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t  )}`\n\t\t\t\t\t\t: ''\n\t\t\t\t}${this.repo.formattedName ? `\\n${this.uri.repoPath}` : ''}\\n\\nCurrent branch $(git-branch) ${\n\t\t\t\t\tbranch.name\n\t\t\t\t}${\n\t\t\t\t\tbranch.upstream != null\n\t\t\t\t\t\t? ` is ${branch.getTrackingStatus({\n\t\t\t\t\t\t\t\tempty: branch.upstream.missing\n\t\t\t\t\t\t\t\t\t? `missing upstream $(git-branch) ${branch.upstream.name}`\n\t\t\t\t\t\t\t\t\t: `up to date with $(git-branch) ${branch.upstream.name}${\n\t\t\t\t\t\t\t\t\t\t\tproviderName ? ` on ${providerName}` : ''\n\t\t\t\t\t\t\t\t\t  }`,\n\t\t\t\t\t\t\t\texpand: true,\n\t\t\t\t\t\t\t\ticons: true,\n\t\t\t\t\t\t\t\tseparator: ', ',\n\t\t\t\t\t\t\t\tsuffix: ` $(git-branch) ${branch.upstream.name}${\n\t\t\t\t\t\t\t\t\tproviderName ? ` on ${providerName}` : ''\n\t\t\t\t\t\t\t\t}`,\n\t\t\t\t\t\t  })}`\n\t\t\t\t\t\t: `hasn't been published to ${providerName ?? 'a remote'}`\n\t\t\t\t}${\n\t\t\t\t\tthis.repo.supportsChangeEvents\n\t\t\t\t\t\t? ''\n\t\t\t\t\t\t: `\\n\\n${GlyphChars.Warning} Unable to automatically detect repository changes`\n\t\t\t\t}`,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t} else {\n\t\t\titem.description = this.repo.supportsChangeEvents ? undefined : Strings.pad(GlyphChars.Warning, 1, 0);\n\t\t\titem.tooltip = `${\n\t\t\t\tthis.repo.formattedName ? `${this.repo.formattedName}\\n${this.uri.repoPath}` : this.uri.repoPath ?? ''\n\t\t\t}${\n\t\t\t\tthis.repo.supportsChangeEvents\n\t\t\t\t\t? ''\n\t\t\t\t\t: `\\n\\n${GlyphChars.Warning} Unable to automatically detect repository changes`\n\t\t\t}`;\n\t\t}\n\n\t\treturn item;\n\t}\n\n\toverride async getSplattedChild() {\n\t\tif (this.child == null) {\n\t\t\tawait this.getChildren();\n\t\t}\n\n\t\treturn this.child;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride async refresh(reset: boolean = false) {\n\t\tawait this.child?.triggerChange(reset, false, this);\n\n\t\tawait this.ensureSubscription();\n\t}\n\n\t@log()\n\tasync star() {\n\t\tawait this.repo.star();\n\t\t// void this.parent!.triggerChange();\n\t}\n\n\t@log()\n\tasync unstar() {\n\t\tawait this.repo.unstar();\n\t\t// void this.parent!.triggerChange();\n\t}\n\n\t@debug()\n\tprotected subscribe(): Disposable | Promise<Disposable> {\n\t\treturn this.repo.onDidChange(this.onRepositoryChanged, this);\n\t}\n\n\tprotected override get requiresResetOnVisible(): boolean {\n\t\treturn this._repoUpdatedAt !== this.repo.updatedAt;\n\t}\n\n\tprivate _repoUpdatedAt: number = this.repo.updatedAt;\n\n\tprotected abstract changed(e: RepositoryChangeEvent): boolean;\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (e: RepositoryChangeEvent) => e.toString(),\n\t\t},\n\t})\n\tprivate onRepositoryChanged(e: RepositoryChangeEvent) {\n\t\tthis._repoUpdatedAt = this.repo.updatedAt;\n\n\t\tif (e.changed(RepositoryChange.Closed, RepositoryChangeComparisonMode.Any)) {\n\t\t\tthis.dispose();\n\t\t\tvoid this.parent?.triggerChange(true);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.changed(RepositoryChange.Starred, RepositoryChangeComparisonMode.Any)) {\n\t\t\tvoid this.parent?.triggerChange(true);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.changed(e)) {\n\t\t\tvoid (this.loaded ? this : this.parent ?? this).triggerChange(true);\n\t\t}\n\t}\n}\n\ninterface AutoRefreshableView {\n\tautoRefresh: boolean;\n\tonDidChangeAutoRefresh: Event<void>;\n}\n\nexport function canAutoRefreshView(view: View): view is View & AutoRefreshableView {\n\treturn Functions.is<View & AutoRefreshableView>(view, 'onDidChangeAutoRefresh');\n}\n\nexport function canClearNode(node: ViewNode): node is ViewNode & { clear(): void | Promise<void> } {\n\treturn typeof (node as ViewNode & { clear(): void | Promise<void> }).clear === 'function';\n}\n\nexport function canEditNode(node: ViewNode): node is ViewNode & { edit(): void | Promise<void> } {\n\treturn typeof (node as ViewNode & { edit(): void | Promise<void> }).edit === 'function';\n}\n\nexport function canViewDismissNode(view: View): view is View & { dismissNode(node: ViewNode): void } {\n\treturn typeof (view as View & { dismissNode(node: ViewNode): void }).dismissNode === 'function';\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tcommands,\n\tConfigurationChangeEvent,\n\tProgressLocation,\n\tTreeItem,\n\tTreeItemCollapsibleState,\n\twindow,\n} from 'vscode';\nimport { configuration, RemotesViewConfig, ViewBranchesLayout, ViewFilesLayout } from '../configuration';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport {\n\tGitBranch,\n\tGitBranchReference,\n\tGitLogCommit,\n\tGitReference,\n\tGitRemote,\n\tGitRevisionReference,\n\tRepositoryChange,\n\tRepositoryChangeComparisonMode,\n\tRepositoryChangeEvent,\n} from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { debug, gate, Strings } from '../system';\nimport {\n\tBranchNode,\n\tBranchOrTagFolderNode,\n\tRemoteNode,\n\tRemotesNode,\n\tRepositoryFolderNode,\n\tRepositoryNode,\n\tunknownGitUri,\n\tViewNode,\n} from './nodes';\nimport { ViewBase } from './viewBase';\n\nexport class RemotesRepositoryNode extends RepositoryFolderNode<RemotesView, RemotesNode> {\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this.child == null) {\n\t\t\tthis.child = new RemotesNode(this.uri, this.view, this, this.repo);\n\t\t}\n\n\t\treturn this.child.getChildren();\n\t}\n\n\tprotected changed(e: RepositoryChangeEvent) {\n\t\treturn e.changed(\n\t\t\tRepositoryChange.Config,\n\t\t\tRepositoryChange.Remotes,\n\t\t\tRepositoryChange.RemoteProviders,\n\t\t\tRepositoryChange.Unknown,\n\t\t\tRepositoryChangeComparisonMode.Any,\n\t\t);\n\t}\n}\n\nexport class RemotesViewNode extends ViewNode<RemotesView> {\n\tprotected override splatted = true;\n\tprivate children: RemotesRepositoryNode[] | undefined;\n\n\tconstructor(view: RemotesView) {\n\t\tsuper(unknownGitUri, view);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this.children == null) {\n\t\t\tconst repositories = await Container.git.getOrderedRepositories();\n\t\t\tif (repositories.length === 0) {\n\t\t\t\tthis.view.message = 'No remotes could be found.';\n\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tthis.view.message = undefined;\n\n\t\t\tconst splat = repositories.length === 1;\n\t\t\tthis.children = repositories.map(\n\t\t\t\tr => new RemotesRepositoryNode(GitUri.fromRepoPath(r.path), this.view, this, r, splat),\n\t\t\t);\n\t\t}\n\n\t\tif (this.children.length === 1) {\n\t\t\tconst [child] = this.children;\n\n\t\t\tif (!child.repo.supportsChangeEvents) {\n\t\t\t\tthis.view.description = `${Strings.pad(GlyphChars.Warning, 0, 2)}Auto-refresh unavailable`;\n\t\t\t}\n\n\t\t\tconst remotes = await child.repo.getRemotes();\n\t\t\tif (remotes.length === 0) {\n\t\t\t\tthis.view.message = 'No remotes could be found.';\n\t\t\t\tthis.view.title = 'Remotes';\n\n\t\t\t\tvoid child.ensureSubscription();\n\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tthis.view.message = undefined;\n\t\t\tthis.view.title = `Remotes (${remotes.length})`;\n\n\t\t\treturn child.getChildren();\n\t\t}\n\n\t\treturn this.children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Remotes', TreeItemCollapsibleState.Expanded);\n\t\treturn item;\n\t}\n\n\toverride async getSplattedChild() {\n\t\tif (this.children == null) {\n\t\t\tawait this.getChildren();\n\t\t}\n\n\t\treturn this.children?.length === 1 ? this.children[0] : undefined;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset: boolean = false) {\n\t\tif (reset && this.children != null) {\n\t\t\tfor (const child of this.children) {\n\t\t\t\tchild.dispose();\n\t\t\t}\n\t\t\tthis.children = undefined;\n\t\t}\n\t}\n}\n\nexport class RemotesView extends ViewBase<RemotesViewNode, RemotesViewConfig> {\n\tprotected readonly configKey = 'remotes';\n\n\tconstructor() {\n\t\tsuper('gitlens.views.remotes', 'Remotes');\n\t}\n\n\tgetRoot() {\n\t\treturn new RemotesViewNode(this);\n\t}\n\n\tprotected registerCommands() {\n\t\tvoid Container.viewCommands;\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('copy'),\n\t\t\t() => commands.executeCommand('gitlens.views.copy', this.selection),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('refresh'),\n\t\t\tasync () => {\n\t\t\t\tawait Container.git.resetCaches('branches', 'remotes');\n\t\t\t\treturn this.refresh(true);\n\t\t\t},\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setLayoutToList'),\n\t\t\t() => this.setLayout(ViewBranchesLayout.List),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setLayoutToTree'),\n\t\t\t() => this.setLayout(ViewBranchesLayout.Tree),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToAuto'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Auto),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToList'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.List),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToTree'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Tree),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOn'), () => this.setShowAvatars(true), this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOff'), () => this.setShowAvatars(false), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowBranchPullRequestOn'),\n\t\t\t() => this.setShowBranchPullRequest(true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowBranchPullRequestOff'),\n\t\t\t() => this.setShowBranchPullRequest(false),\n\t\t\tthis,\n\t\t);\n\t}\n\n\tprotected override filterConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tconst changed = super.filterConfigurationChanged(e);\n\t\tif (\n\t\t\t!changed &&\n\t\t\t!configuration.changed(e, 'defaultDateFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateShortFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateSource') &&\n\t\t\t!configuration.changed(e, 'defaultDateStyle') &&\n\t\t\t!configuration.changed(e, 'defaultGravatarsStyle') &&\n\t\t\t!configuration.changed(e, 'defaultTimeFormat') &&\n\t\t\t!configuration.changed(e, 'integrations.enabled') &&\n\t\t\t!configuration.changed(e, 'sortBranchesBy')\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tfindBranch(branch: GitBranchReference, token?: CancellationToken) {\n\t\tif (!branch.remote) return undefined;\n\n\t\tconst repoNodeId = RepositoryNode.getId(branch.repoPath);\n\n\t\treturn this.findNode((n: any) => n.branch?.ref === branch.ref, {\n\t\t\tallowPaging: true,\n\t\t\tmaxDepth: 5,\n\t\t\tcanTraverse: n => {\n\t\t\t\tif (n instanceof RemotesViewNode) return true;\n\n\t\t\t\tif (n instanceof RemotesRepositoryNode || n instanceof BranchOrTagFolderNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\tif (n instanceof RemoteNode) {\n\t\t\t\t\tif (!n.id.startsWith(repoNodeId)) return false;\n\n\t\t\t\t\treturn n.remote.name === GitBranch.getRemote(branch.name);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\ttoken: token,\n\t\t});\n\t}\n\n\tasync findCommit(commit: GitLogCommit | { repoPath: string; ref: string }, token?: CancellationToken) {\n\t\tconst repoNodeId = RepositoryNode.getId(commit.repoPath);\n\n\t\t// Get all the remote branches the commit is on\n\t\tconst branches = await Container.git.getCommitBranches(commit.repoPath, commit.ref, { remotes: true });\n\t\tif (branches.length === 0) return undefined;\n\n\t\tconst remotes = branches.map(b => b.split('/', 1)[0]);\n\n\t\treturn this.findNode((n: any) => n.commit !== undefined && n.commit.ref === commit.ref, {\n\t\t\tallowPaging: true,\n\t\t\tmaxDepth: 6,\n\t\t\tcanTraverse: n => {\n\t\t\t\tif (n instanceof RemotesViewNode) return true;\n\n\t\t\t\tif (n instanceof RemotesRepositoryNode || n instanceof BranchOrTagFolderNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\tif (n instanceof RemoteNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId) && remotes.includes(n.remote.name);\n\t\t\t\t}\n\n\t\t\t\tif (n instanceof BranchNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId) && branches.includes(n.branch.name);\n\t\t\t\t}\n\n\t\t\t\tif (n instanceof RepositoryNode || n instanceof RemotesNode || n instanceof BranchOrTagFolderNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\ttoken: token,\n\t\t});\n\t}\n\n\tfindRemote(remote: GitRemote, token?: CancellationToken) {\n\t\tconst repoNodeId = RepositoryNode.getId(remote.repoPath);\n\n\t\treturn this.findNode((n: any) => n.remote?.name === remote.name, {\n\t\t\tallowPaging: true,\n\t\t\tmaxDepth: 2,\n\t\t\tcanTraverse: n => {\n\t\t\t\tif (n instanceof RemotesViewNode) return true;\n\n\t\t\t\tif (n instanceof RemotesRepositoryNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\ttoken: token,\n\t\t});\n\t}\n\n\t@gate(() => '')\n\trevealBranch(\n\t\tbranch: GitBranchReference,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\treturn window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Revealing ${GitReference.toString(branch, { icon: false })} in the side bar...`,\n\t\t\t\tcancellable: true,\n\t\t\t},\n\t\t\tasync (progress, token) => {\n\t\t\t\tconst node = await this.findBranch(branch, token);\n\t\t\t\tif (node == null) return undefined;\n\n\t\t\t\tawait this.ensureRevealNode(node, options);\n\n\t\t\t\treturn node;\n\t\t\t},\n\t\t);\n\t}\n\n\t@gate(() => '')\n\tasync revealCommit(\n\t\tcommit: GitRevisionReference,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\treturn window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Revealing ${GitReference.toString(commit, { icon: false })} in the side bar...`,\n\t\t\t\tcancellable: true,\n\t\t\t},\n\t\t\tasync (progress, token) => {\n\t\t\t\tconst node = await this.findCommit(commit, token);\n\t\t\t\tif (node == null) return undefined;\n\n\t\t\t\tawait this.ensureRevealNode(node, options);\n\n\t\t\t\treturn node;\n\t\t\t},\n\t\t);\n\t}\n\n\t@gate(() => '')\n\trevealRemote(\n\t\tremote: GitRemote,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\treturn window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Revealing remote ${remote.name} in the side bar...`,\n\t\t\t\tcancellable: true,\n\t\t\t},\n\t\t\tasync (progress, token) => {\n\t\t\t\tconst node = await this.findRemote(remote, token);\n\t\t\t\tif (node == null) return undefined;\n\n\t\t\t\tawait this.ensureRevealNode(node, options);\n\n\t\t\t\treturn node;\n\t\t\t},\n\t\t);\n\t}\n\n\tprivate setLayout(layout: ViewBranchesLayout) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.branches.layout` as const, layout);\n\t}\n\n\tprivate setFilesLayout(layout: ViewFilesLayout) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.files.layout` as const, layout);\n\t}\n\n\tprivate setShowAvatars(enabled: boolean) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.avatars` as const, enabled);\n\t}\n\n\tprivate async setShowBranchPullRequest(enabled: boolean) {\n\t\tawait configuration.updateEffective(`views.${this.configKey}.pullRequests.showForBranches` as const, enabled);\n\t\tawait configuration.updateEffective(`views.${this.configKey}.pullRequests.enabled` as const, enabled);\n\t}\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tcommands,\n\tConfigurationChangeEvent,\n\tEvent,\n\tEventEmitter,\n\tProgressLocation,\n\twindow,\n} from 'vscode';\nimport {\n\tconfiguration,\n\tRepositoriesViewConfig,\n\tViewBranchesLayout,\n\tViewFilesLayout,\n\tViewShowBranchComparison,\n} from '../configuration';\nimport { ContextKeys, setContext, WorkspaceState } from '../constants';\nimport { Container } from '../container';\nimport {\n\tGitBranch,\n\tGitBranchReference,\n\tGitLogCommit,\n\tGitReference,\n\tGitRevisionReference,\n\tGitStashReference,\n\tGitTagReference,\n} from '../git/git';\nimport { gate } from '../system';\nimport {\n\tBranchesNode,\n\tBranchNode,\n\tBranchOrTagFolderNode,\n\tBranchTrackingStatusNode,\n\tCompareBranchNode,\n\tContributorsNode,\n\tReflogNode,\n\tRemoteNode,\n\tRemotesNode,\n\tRepositoriesNode,\n\tRepositoryNode,\n\tStashesNode,\n\tStashNode,\n\tTagsNode,\n} from './nodes';\nimport { ViewBase } from './viewBase';\n\nexport class RepositoriesView extends ViewBase<RepositoriesNode, RepositoriesViewConfig> {\n\tprotected readonly configKey = 'repositories';\n\n\tconstructor() {\n\t\tsuper('gitlens.views.repositories', 'Repositories');\n\t}\n\n\tprivate _onDidChangeAutoRefresh = new EventEmitter<void>();\n\tget onDidChangeAutoRefresh(): Event<void> {\n\t\treturn this._onDidChangeAutoRefresh.event;\n\t}\n\n\tgetRoot() {\n\t\treturn new RepositoriesNode(this);\n\t}\n\n\tprotected registerCommands() {\n\t\tvoid Container.viewCommands;\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('copy'),\n\t\t\t() => commands.executeCommand('gitlens.views.copy', this.selection),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('refresh'),\n\t\t\tasync () => {\n\t\t\t\tawait Container.git.resetCaches('branches', 'contributors', 'remotes', 'stashes', 'status', 'tags');\n\t\t\t\treturn this.refresh(true);\n\t\t\t},\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setBranchesLayoutToList'),\n\t\t\t() => this.setBranchesLayout(ViewBranchesLayout.List),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setBranchesLayoutToTree'),\n\t\t\t() => this.setBranchesLayout(ViewBranchesLayout.Tree),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToAuto'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Auto),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToList'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.List),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToTree'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Tree),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setAutoRefreshToOn'),\n\t\t\t() => this.setAutoRefresh(Container.config.views.repositories.autoRefresh, true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setAutoRefreshToOff'),\n\t\t\t() => this.setAutoRefresh(Container.config.views.repositories.autoRefresh, false),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOn'), () => this.setShowAvatars(true), this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOff'), () => this.setShowAvatars(false), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowBranchComparisonOn'),\n\t\t\t() => this.setShowBranchComparison(true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowBranchComparisonOff'),\n\t\t\t() => this.setShowBranchComparison(false),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setBranchesShowBranchComparisonOn'),\n\t\t\t() => this.setBranchShowBranchComparison(true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setBranchesShowBranchComparisonOff'),\n\t\t\t() => this.setBranchShowBranchComparison(false),\n\t\t\tthis,\n\t\t);\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowBranchesOn'),\n\t\t\t() => this.toggleSection('showBranches', true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowBranchesOff'),\n\t\t\t() => this.toggleSection('showBranches', false),\n\t\t\tthis,\n\t\t);\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowCommitsOn'),\n\t\t\t() => this.toggleSection('showCommits', true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowCommitsOff'),\n\t\t\t() => this.toggleSection('showCommits', false),\n\t\t\tthis,\n\t\t);\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowContributorsOn'),\n\t\t\t() => this.toggleSection('showContributors', true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowContributorsOff'),\n\t\t\t() => this.toggleSection('showContributors', false),\n\t\t\tthis,\n\t\t);\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowRemotesOn'),\n\t\t\t() => this.toggleSection('showRemotes', true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowRemotesOff'),\n\t\t\t() => this.toggleSection('showRemotes', false),\n\t\t\tthis,\n\t\t);\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowStashesOn'),\n\t\t\t() => this.toggleSection('showStashes', true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowStashesOff'),\n\t\t\t() => this.toggleSection('showStashes', false),\n\t\t\tthis,\n\t\t);\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowTagsOn'),\n\t\t\t() => this.toggleSection('showTags', true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowTagsOff'),\n\t\t\t() => this.toggleSection('showTags', false),\n\t\t\tthis,\n\t\t);\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowUpstreamStatusOn'),\n\t\t\t() => this.toggleSection('showUpstreamStatus', true),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowUpstreamStatusOff'),\n\t\t\t() => this.toggleSection('showUpstreamStatus', false),\n\t\t\tthis,\n\t\t);\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setShowSectionOff'),\n\t\t\t(\n\t\t\t\tnode:\n\t\t\t\t\t| BranchesNode\n\t\t\t\t\t| BranchNode\n\t\t\t\t\t| BranchTrackingStatusNode\n\t\t\t\t\t| CompareBranchNode\n\t\t\t\t\t| ContributorsNode\n\t\t\t\t\t| ReflogNode\n\t\t\t\t\t| RemotesNode\n\t\t\t\t\t| StashesNode\n\t\t\t\t\t| TagsNode,\n\t\t\t) => this.toggleSectionByNode(node, false),\n\t\t\tthis,\n\t\t);\n\t}\n\n\tprotected override filterConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tconst changed = super.filterConfigurationChanged(e);\n\t\tif (\n\t\t\t!changed &&\n\t\t\t!configuration.changed(e, 'defaultDateFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateShortFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateSource') &&\n\t\t\t!configuration.changed(e, 'defaultDateStyle') &&\n\t\t\t!configuration.changed(e, 'defaultGravatarsStyle') &&\n\t\t\t!configuration.changed(e, 'defaultTimeFormat') &&\n\t\t\t!configuration.changed(e, 'sortBranchesBy') &&\n\t\t\t!configuration.changed(e, 'sortContributorsBy') &&\n\t\t\t!configuration.changed(e, 'sortTagsBy')\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\tprotected override onConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tif (configuration.changed(e, `views.${this.configKey}.autoRefresh` as const)) {\n\t\t\tvoid this.setAutoRefresh(Container.config.views.repositories.autoRefresh);\n\t\t}\n\n\t\tsuper.onConfigurationChanged(e);\n\t}\n\n\tget autoRefresh() {\n\t\treturn (\n\t\t\tthis.config.autoRefresh &&\n\t\t\tContainer.context.workspaceState.get<boolean>(WorkspaceState.ViewsRepositoriesAutoRefresh, true)\n\t\t);\n\t}\n\n\tfindBranch(branch: GitBranchReference, token?: CancellationToken) {\n\t\tconst repoNodeId = RepositoryNode.getId(branch.repoPath);\n\n\t\tif (branch.remote) {\n\t\t\treturn this.findNode((n: any) => n.branch !== undefined && n.branch.ref === branch.ref, {\n\t\t\t\tallowPaging: true,\n\t\t\t\tmaxDepth: 6,\n\t\t\t\tcanTraverse: n => {\n\t\t\t\t\t// Only search for branch nodes in the same repo within BranchesNode\n\t\t\t\t\tif (n instanceof RepositoriesNode) return true;\n\n\t\t\t\t\tif (n instanceof RemoteNode) {\n\t\t\t\t\t\tif (!n.id.startsWith(repoNodeId)) return false;\n\n\t\t\t\t\t\treturn branch.remote && n.remote.name === GitBranch.getRemote(branch.name); //branch.getRemoteName();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tn instanceof RepositoryNode ||\n\t\t\t\t\t\tn instanceof BranchesNode ||\n\t\t\t\t\t\tn instanceof RemotesNode ||\n\t\t\t\t\t\tn instanceof BranchOrTagFolderNode\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\ttoken: token,\n\t\t\t});\n\t\t}\n\n\t\treturn this.findNode((n: any) => n.branch !== undefined && n.branch.ref === branch.ref, {\n\t\t\tallowPaging: true,\n\t\t\tmaxDepth: 5,\n\t\t\tcanTraverse: n => {\n\t\t\t\t// Only search for branch nodes in the same repo within BranchesNode\n\t\t\t\tif (n instanceof RepositoriesNode) return true;\n\n\t\t\t\tif (n instanceof RepositoryNode || n instanceof BranchesNode || n instanceof BranchOrTagFolderNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\ttoken: token,\n\t\t});\n\t}\n\n\tasync findCommit(commit: GitLogCommit | { repoPath: string; ref: string }, token?: CancellationToken) {\n\t\tconst repoNodeId = RepositoryNode.getId(commit.repoPath);\n\n\t\t// Get all the branches the commit is on\n\t\tlet branches = await Container.git.getCommitBranches(commit.repoPath, commit.ref);\n\t\tif (branches.length !== 0) {\n\t\t\treturn this.findNode((n: any) => n.commit !== undefined && n.commit.ref === commit.ref, {\n\t\t\t\tallowPaging: true,\n\t\t\t\tmaxDepth: 6,\n\t\t\t\tcanTraverse: async n => {\n\t\t\t\t\t// Only search for commit nodes in the same repo within BranchNodes\n\t\t\t\t\tif (n instanceof RepositoriesNode) return true;\n\n\t\t\t\t\tif (n instanceof BranchNode) {\n\t\t\t\t\t\tif (n.id.startsWith(repoNodeId) && branches.includes(n.branch.name)) {\n\t\t\t\t\t\t\tawait n.loadMore({ until: commit.ref });\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tn instanceof RepositoryNode ||\n\t\t\t\t\t\tn instanceof BranchesNode ||\n\t\t\t\t\t\tn instanceof BranchOrTagFolderNode\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\ttoken: token,\n\t\t\t});\n\t\t}\n\n\t\t// If we didn't find the commit on any local branches, check remote branches\n\t\tbranches = await Container.git.getCommitBranches(commit.repoPath, commit.ref, { remotes: true });\n\t\tif (branches.length === 0) return undefined;\n\n\t\tconst remotes = branches.map(b => b.split('/', 1)[0]);\n\n\t\treturn this.findNode((n: any) => n.commit !== undefined && n.commit.ref === commit.ref, {\n\t\t\tallowPaging: true,\n\t\t\tmaxDepth: 8,\n\t\t\tcanTraverse: n => {\n\t\t\t\t// Only search for commit nodes in the same repo within BranchNodes\n\t\t\t\tif (n instanceof RepositoriesNode) return true;\n\n\t\t\t\tif (n instanceof RemoteNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId) && remotes.includes(n.remote.name);\n\t\t\t\t}\n\n\t\t\t\tif (n instanceof BranchNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId) && branches.includes(n.branch.name);\n\t\t\t\t}\n\n\t\t\t\tif (n instanceof RepositoryNode || n instanceof RemotesNode || n instanceof BranchOrTagFolderNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\ttoken: token,\n\t\t});\n\t}\n\n\tfindStash(stash: GitStashReference, token?: CancellationToken) {\n\t\tconst repoNodeId = RepositoryNode.getId(stash.repoPath);\n\n\t\treturn this.findNode(StashNode.getId(stash.repoPath, stash.ref), {\n\t\t\tmaxDepth: 3,\n\t\t\tcanTraverse: n => {\n\t\t\t\t// Only search for stash nodes in the same repo within a StashesNode\n\t\t\t\tif (n instanceof RepositoriesNode) return true;\n\n\t\t\t\tif (n instanceof RepositoryNode || n instanceof StashesNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\ttoken: token,\n\t\t});\n\t}\n\n\tfindTag(tag: GitTagReference, token?: CancellationToken) {\n\t\tconst repoNodeId = RepositoryNode.getId(tag.repoPath);\n\n\t\treturn this.findNode((n: any) => n.tag !== undefined && n.tag.ref === tag.ref, {\n\t\t\tallowPaging: true,\n\t\t\tmaxDepth: 5,\n\t\t\tcanTraverse: n => {\n\t\t\t\t// Only search for tag nodes in the same repo within TagsNode\n\t\t\t\tif (n instanceof RepositoriesNode) return true;\n\n\t\t\t\tif (n instanceof RepositoryNode || n instanceof TagsNode || n instanceof BranchOrTagFolderNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\ttoken: token,\n\t\t});\n\t}\n\n\t@gate(() => '')\n\trevealBranch(\n\t\tbranch: GitBranchReference,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\treturn window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Revealing ${GitReference.toString(branch, { icon: false })} in the Repositories view...`,\n\t\t\t\tcancellable: true,\n\t\t\t},\n\t\t\tasync (progress, token) => {\n\t\t\t\tconst node = await this.findBranch(branch, token);\n\t\t\t\tif (node == null) return undefined;\n\n\t\t\t\tawait this.ensureRevealNode(node, options);\n\n\t\t\t\treturn node;\n\t\t\t},\n\t\t);\n\t}\n\n\t@gate(() => '')\n\tasync revealBranches(\n\t\trepoPath: string,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\tconst repoNodeId = RepositoryNode.getId(repoPath);\n\n\t\tconst node = await this.findNode(BranchesNode.getId(repoPath), {\n\t\t\tmaxDepth: 2,\n\t\t\tcanTraverse: n => {\n\t\t\t\t// Only search for branches nodes in the same repo\n\t\t\t\tif (n instanceof RepositoriesNode) return true;\n\n\t\t\t\tif (n instanceof RepositoryNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t});\n\n\t\tif (node !== undefined) {\n\t\t\tawait this.reveal(node, options);\n\t\t}\n\n\t\treturn node;\n\t}\n\n\t@gate(() => '')\n\tasync revealCommit(\n\t\tcommit: GitRevisionReference,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\treturn window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Revealing ${GitReference.toString(commit, { icon: false })} in the Repositories view...`,\n\t\t\t\tcancellable: true,\n\t\t\t},\n\t\t\tasync (progress, token) => {\n\t\t\t\tconst node = await this.findCommit(commit, token);\n\t\t\t\tif (node == null) return undefined;\n\n\t\t\t\tawait this.ensureRevealNode(node, options);\n\n\t\t\t\treturn node;\n\t\t\t},\n\t\t);\n\t}\n\n\t@gate(() => '')\n\tasync revealRepository(\n\t\trepoPath: string,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\tconst repoNodeId = RepositoryNode.getId(repoPath);\n\n\t\tconst node = await this.findNode(repoNodeId, {\n\t\t\tmaxDepth: 1,\n\t\t\tcanTraverse: n => {\n\t\t\t\t// Only search for branches nodes in the same repo\n\t\t\t\tif (n instanceof RepositoriesNode) return true;\n\n\t\t\t\t// if (n instanceof RepositoryNode) {\n\t\t\t\t// \treturn n.id.startsWith(repoNodeId);\n\t\t\t\t// }\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t});\n\n\t\tif (node !== undefined) {\n\t\t\tawait this.reveal(node, options);\n\t\t}\n\n\t\treturn node;\n\t}\n\n\t@gate(() => '')\n\tasync revealStash(\n\t\tstash: GitStashReference,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\treturn window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Revealing ${GitReference.toString(stash, { icon: false })} in the Repositories view...`,\n\t\t\t\tcancellable: true,\n\t\t\t},\n\t\t\tasync (progress, token) => {\n\t\t\t\tconst node = await this.findStash(stash, token);\n\t\t\t\tif (node !== undefined) {\n\t\t\t\t\tawait this.reveal(node, options);\n\t\t\t\t}\n\n\t\t\t\treturn node;\n\t\t\t},\n\t\t);\n\t}\n\n\t@gate(() => '')\n\tasync revealStashes(\n\t\trepoPath: string,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\tconst repoNodeId = RepositoryNode.getId(repoPath);\n\n\t\tconst node = await this.findNode(StashesNode.getId(repoPath), {\n\t\t\tmaxDepth: 2,\n\t\t\tcanTraverse: n => {\n\t\t\t\t// Only search for stashes nodes in the same repo\n\t\t\t\tif (n instanceof RepositoriesNode) return true;\n\n\t\t\t\tif (n instanceof RepositoryNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t});\n\n\t\tif (node !== undefined) {\n\t\t\tawait this.reveal(node, options);\n\t\t}\n\n\t\treturn node;\n\t}\n\n\t@gate(() => '')\n\trevealTag(\n\t\ttag: GitTagReference,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\treturn window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Revealing ${GitReference.toString(tag, { icon: false })} in the Repositories view...`,\n\t\t\t\tcancellable: true,\n\t\t\t},\n\t\t\tasync (progress, token) => {\n\t\t\t\tconst node = await this.findTag(tag, token);\n\t\t\t\tif (node == null) return undefined;\n\n\t\t\t\tawait this.ensureRevealNode(node, options);\n\n\t\t\t\treturn node;\n\t\t\t},\n\t\t);\n\t}\n\n\t@gate(() => '')\n\tasync revealTags(\n\t\trepoPath: string,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\tconst repoNodeId = RepositoryNode.getId(repoPath);\n\n\t\tconst node = await this.findNode(TagsNode.getId(repoPath), {\n\t\t\tmaxDepth: 2,\n\t\t\tcanTraverse: n => {\n\t\t\t\t// Only search for tags nodes in the same repo\n\t\t\t\tif (n instanceof RepositoriesNode) return true;\n\n\t\t\t\tif (n instanceof RepositoryNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t});\n\n\t\tif (node !== undefined) {\n\t\t\tawait this.reveal(node, options);\n\t\t}\n\n\t\treturn node;\n\t}\n\n\tprivate async setAutoRefresh(enabled: boolean, workspaceEnabled?: boolean) {\n\t\tif (enabled) {\n\t\t\tif (workspaceEnabled === undefined) {\n\t\t\t\tworkspaceEnabled = Container.context.workspaceState.get<boolean>(\n\t\t\t\t\tWorkspaceState.ViewsRepositoriesAutoRefresh,\n\t\t\t\t\ttrue,\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tawait Container.context.workspaceState.update(\n\t\t\t\t\tWorkspaceState.ViewsRepositoriesAutoRefresh,\n\t\t\t\t\tworkspaceEnabled,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tvoid setContext(ContextKeys.ViewsRepositoriesAutoRefresh, enabled && workspaceEnabled);\n\n\t\tthis._onDidChangeAutoRefresh.fire();\n\t}\n\n\tprivate setBranchesLayout(layout: ViewBranchesLayout) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.branches.layout` as const, layout);\n\t}\n\n\tprivate setFilesLayout(layout: ViewFilesLayout) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.files.layout` as const, layout);\n\t}\n\n\tprivate setShowAvatars(enabled: boolean) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.avatars` as const, enabled);\n\t}\n\n\tprivate setShowBranchComparison(enabled: boolean) {\n\t\treturn configuration.updateEffective(\n\t\t\t`views.${this.configKey}.showBranchComparison` as const,\n\t\t\tenabled ? ViewShowBranchComparison.Working : false,\n\t\t);\n\t}\n\n\tprivate setBranchShowBranchComparison(enabled: boolean) {\n\t\treturn configuration.updateEffective(\n\t\t\t`views.${this.configKey}.branches.showBranchComparison` as const,\n\t\t\tenabled ? ViewShowBranchComparison.Branch : false,\n\t\t);\n\t}\n\n\ttoggleSection(\n\t\tkey:\n\t\t\t| 'showBranches'\n\t\t\t| 'showCommits'\n\t\t\t| 'showContributors'\n\t\t\t// | 'showIncomingActivity'\n\t\t\t| 'showRemotes'\n\t\t\t| 'showStashes'\n\t\t\t| 'showTags'\n\t\t\t| 'showUpstreamStatus',\n\t\tenabled: boolean,\n\t) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.${key}` as const, enabled);\n\t}\n\n\ttoggleSectionByNode(\n\t\tnode:\n\t\t\t| BranchesNode\n\t\t\t| BranchNode\n\t\t\t| BranchTrackingStatusNode\n\t\t\t| CompareBranchNode\n\t\t\t| ContributorsNode\n\t\t\t| ReflogNode\n\t\t\t| RemotesNode\n\t\t\t| StashesNode\n\t\t\t| TagsNode,\n\t\tenabled: boolean,\n\t) {\n\t\tif (node instanceof BranchesNode) {\n\t\t\treturn configuration.updateEffective(`views.${this.configKey}.showBranches` as const, enabled);\n\t\t}\n\n\t\tif (node instanceof BranchNode) {\n\t\t\treturn configuration.updateEffective(`views.${this.configKey}.showCommits` as const, enabled);\n\t\t}\n\n\t\tif (node instanceof BranchTrackingStatusNode) {\n\t\t\treturn configuration.updateEffective(`views.${this.configKey}.showUpstreamStatus` as const, enabled);\n\t\t}\n\n\t\tif (node instanceof CompareBranchNode) {\n\t\t\treturn this.setShowBranchComparison(enabled);\n\t\t}\n\n\t\tif (node instanceof ContributorsNode) {\n\t\t\treturn configuration.updateEffective(`views.${this.configKey}.showContributors` as const, enabled);\n\t\t}\n\n\t\tif (node instanceof ReflogNode) {\n\t\t\treturn configuration.updateEffective(`views.${this.configKey}.showIncomingActivity` as const, enabled);\n\t\t}\n\n\t\tif (node instanceof RemotesNode) {\n\t\t\treturn configuration.updateEffective(`views.${this.configKey}.showRemotes` as const, enabled);\n\t\t}\n\n\t\tif (node instanceof StashesNode) {\n\t\t\treturn configuration.updateEffective(`views.${this.configKey}.showStashes` as const, enabled);\n\t\t}\n\n\t\tif (node instanceof TagsNode) {\n\t\t\treturn configuration.updateEffective(`views.${this.configKey}.showTags` as const, enabled);\n\t\t}\n\n\t\treturn Promise.resolve();\n\t}\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tcommands,\n\tConfigurationChangeEvent,\n\tProgressLocation,\n\tTreeItem,\n\tTreeItemCollapsibleState,\n\twindow,\n} from 'vscode';\nimport { configuration, TagsViewConfig, ViewBranchesLayout, ViewFilesLayout } from '../configuration';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport {\n\tGitReference,\n\tGitTagReference,\n\tRepositoryChange,\n\tRepositoryChangeComparisonMode,\n\tRepositoryChangeEvent,\n} from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { debug, gate, Strings } from '../system';\nimport {\n\tBranchOrTagFolderNode,\n\tRepositoryFolderNode,\n\tRepositoryNode,\n\tTagsNode,\n\tunknownGitUri,\n\tViewNode,\n} from './nodes';\nimport { ViewBase } from './viewBase';\n\nexport class TagsRepositoryNode extends RepositoryFolderNode<TagsView, TagsNode> {\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this.child == null) {\n\t\t\tthis.child = new TagsNode(this.uri, this.view, this, this.repo);\n\t\t}\n\n\t\treturn this.child.getChildren();\n\t}\n\n\tprotected changed(e: RepositoryChangeEvent) {\n\t\treturn e.changed(RepositoryChange.Tags, RepositoryChange.Unknown, RepositoryChangeComparisonMode.Any);\n\t}\n}\n\nexport class TagsViewNode extends ViewNode<TagsView> {\n\tprotected override splatted = true;\n\tprivate children: TagsRepositoryNode[] | undefined;\n\n\tconstructor(view: TagsView) {\n\t\tsuper(unknownGitUri, view);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this.children == null) {\n\t\t\tconst repositories = await Container.git.getOrderedRepositories();\n\t\t\tif (repositories.length === 0) {\n\t\t\t\tthis.view.message = 'No tags could be found.';\n\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tthis.view.message = undefined;\n\n\t\t\tconst splat = repositories.length === 1;\n\t\t\tthis.children = repositories.map(\n\t\t\t\tr => new TagsRepositoryNode(GitUri.fromRepoPath(r.path), this.view, this, r, splat),\n\t\t\t);\n\t\t}\n\n\t\tif (this.children.length === 1) {\n\t\t\tconst [child] = this.children;\n\n\t\t\tif (!child.repo.supportsChangeEvents) {\n\t\t\t\tthis.view.description = `${Strings.pad(GlyphChars.Warning, 0, 2)}Auto-refresh unavailable`;\n\t\t\t}\n\n\t\t\tconst tags = await child.repo.getTags();\n\t\t\tif (tags.length === 0) {\n\t\t\t\tthis.view.message = 'No tags could be found.';\n\t\t\t\tthis.view.title = 'Tags';\n\n\t\t\t\tvoid child.ensureSubscription();\n\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tthis.view.message = undefined;\n\t\t\tthis.view.title = `Tags (${tags.length})`;\n\n\t\t\treturn child.getChildren();\n\t\t}\n\n\t\treturn this.children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Tags', TreeItemCollapsibleState.Expanded);\n\t\treturn item;\n\t}\n\n\toverride async getSplattedChild() {\n\t\tif (this.children == null) {\n\t\t\tawait this.getChildren();\n\t\t}\n\n\t\treturn this.children?.length === 1 ? this.children[0] : undefined;\n\t}\n\n\t@gate()\n\t@debug()\n\toverride refresh(reset: boolean = false) {\n\t\tif (reset && this.children != null) {\n\t\t\tfor (const child of this.children) {\n\t\t\t\tchild.dispose();\n\t\t\t}\n\t\t\tthis.children = undefined;\n\t\t}\n\t}\n}\n\nexport class TagsView extends ViewBase<TagsViewNode, TagsViewConfig> {\n\tprotected readonly configKey = 'tags';\n\n\tconstructor() {\n\t\tsuper('gitlens.views.tags', 'Tags');\n\t}\n\n\tgetRoot() {\n\t\treturn new TagsViewNode(this);\n\t}\n\n\tprotected registerCommands() {\n\t\tvoid Container.viewCommands;\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('copy'),\n\t\t\t() => commands.executeCommand('gitlens.views.copy', this.selection),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('refresh'),\n\t\t\tasync () => {\n\t\t\t\tawait Container.git.resetCaches('tags');\n\t\t\t\treturn this.refresh(true);\n\t\t\t},\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setLayoutToList'),\n\t\t\t() => this.setLayout(ViewBranchesLayout.List),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setLayoutToTree'),\n\t\t\t() => this.setLayout(ViewBranchesLayout.Tree),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToAuto'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Auto),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToList'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.List),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToTree'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Tree),\n\t\t\tthis,\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOn'), () => this.setShowAvatars(true), this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setShowAvatarsOff'), () => this.setShowAvatars(false), this);\n\t}\n\n\tprotected override filterConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tconst changed = super.filterConfigurationChanged(e);\n\t\tif (\n\t\t\t!changed &&\n\t\t\t!configuration.changed(e, 'defaultDateFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateShortFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateSource') &&\n\t\t\t!configuration.changed(e, 'defaultDateStyle') &&\n\t\t\t!configuration.changed(e, 'defaultGravatarsStyle') &&\n\t\t\t!configuration.changed(e, 'defaultTimeFormat') &&\n\t\t\t!configuration.changed(e, 'sortTagsBy')\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tfindTag(tag: GitTagReference, token?: CancellationToken) {\n\t\tconst repoNodeId = RepositoryNode.getId(tag.repoPath);\n\n\t\treturn this.findNode((n: any) => n.tag?.ref === tag.ref, {\n\t\t\tallowPaging: true,\n\t\t\tmaxDepth: 2,\n\t\t\tcanTraverse: n => {\n\t\t\t\tif (n instanceof TagsViewNode) return true;\n\n\t\t\t\tif (n instanceof TagsRepositoryNode || n instanceof BranchOrTagFolderNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\ttoken: token,\n\t\t});\n\t}\n\n\t@gate(() => '')\n\trevealTag(\n\t\ttag: GitTagReference,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\treturn window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Revealing ${GitReference.toString(tag, { icon: false })} in the side bar...`,\n\t\t\t\tcancellable: true,\n\t\t\t},\n\t\t\tasync (progress, token) => {\n\t\t\t\tconst node = await this.findTag(tag, token);\n\t\t\t\tif (node == null) return undefined;\n\n\t\t\t\tawait this.ensureRevealNode(node, options);\n\n\t\t\t\treturn node;\n\t\t\t},\n\t\t);\n\t}\n\n\tprivate setLayout(layout: ViewBranchesLayout) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.branches.layout` as const, layout);\n\t}\n\n\tprivate setFilesLayout(layout: ViewFilesLayout) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.files.layout` as const, layout);\n\t}\n\n\tprivate setShowAvatars(enabled: boolean) {\n\t\treturn configuration.updateEffective(`views.${this.configKey}.avatars` as const, enabled);\n\t}\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tcommands,\n\tConfigurationChangeEvent,\n\tDisposable,\n\tEvent,\n\tEventEmitter,\n\tMarkdownString,\n\tTreeDataProvider,\n\tTreeItem,\n\tTreeItemCollapsibleState,\n\tTreeView,\n\tTreeViewExpansionEvent,\n\tTreeViewVisibilityChangeEvent,\n\twindow,\n} from 'vscode';\nimport {\n\tBranchesViewConfig,\n\tCommitsViewConfig,\n\tconfiguration,\n\tContributorsViewConfig,\n\tFileHistoryViewConfig,\n\tLineHistoryViewConfig,\n\tRemotesViewConfig,\n\tRepositoriesViewConfig,\n\tSearchAndCompareViewConfig,\n\tStashesViewConfig,\n\tTagsViewConfig,\n\tViewsCommonConfig,\n\tviewsCommonConfigKeys,\n\tviewsConfigKeys,\n\tViewsConfigKeys,\n} from '../configuration';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { debug, Functions, log, Promises } from '../system';\nimport { BranchesView } from './branchesView';\nimport { CommitsView } from './commitsView';\nimport { ContributorsView } from './contributorsView';\nimport { FileHistoryView } from './fileHistoryView';\nimport { LineHistoryView } from './lineHistoryView';\nimport { PageableViewNode, ViewNode } from './nodes';\nimport { RemotesView } from './remotesView';\nimport { RepositoriesView } from './repositoriesView';\nimport { SearchAndCompareView } from './searchAndCompareView';\nimport { StashesView } from './stashesView';\nimport { TagsView } from './tagsView';\n\nexport type View =\n\t| BranchesView\n\t| CommitsView\n\t| ContributorsView\n\t| FileHistoryView\n\t| LineHistoryView\n\t| RemotesView\n\t| RepositoriesView\n\t| SearchAndCompareView\n\t| StashesView\n\t| TagsView;\nexport type ViewsWithCommits =\n\t| BranchesView\n\t| CommitsView\n\t| ContributorsView\n\t| RemotesView\n\t| RepositoriesView\n\t| SearchAndCompareView\n\t| TagsView;\n\nexport interface TreeViewNodeCollapsibleStateChangeEvent<T> extends TreeViewExpansionEvent<T> {\n\tstate: TreeItemCollapsibleState;\n}\n\nexport abstract class ViewBase<\n\tRootNode extends ViewNode<View>,\n\tViewConfig extends\n\t\t| BranchesViewConfig\n\t\t| ContributorsViewConfig\n\t\t| FileHistoryViewConfig\n\t\t| CommitsViewConfig\n\t\t| LineHistoryViewConfig\n\t\t| RemotesViewConfig\n\t\t| RepositoriesViewConfig\n\t\t| SearchAndCompareViewConfig\n\t\t| StashesViewConfig\n\t\t| TagsViewConfig,\n> implements TreeDataProvider<ViewNode>, Disposable\n{\n\tprotected _onDidChangeTreeData = new EventEmitter<ViewNode | undefined>();\n\tget onDidChangeTreeData(): Event<ViewNode | undefined> {\n\t\treturn this._onDidChangeTreeData.event;\n\t}\n\n\tprivate _onDidChangeVisibility = new EventEmitter<TreeViewVisibilityChangeEvent>();\n\tget onDidChangeVisibility(): Event<TreeViewVisibilityChangeEvent> {\n\t\treturn this._onDidChangeVisibility.event;\n\t}\n\n\tprivate _onDidChangeNodeCollapsibleState = new EventEmitter<TreeViewNodeCollapsibleStateChangeEvent<ViewNode>>();\n\tget onDidChangeNodeCollapsibleState(): Event<TreeViewNodeCollapsibleStateChangeEvent<ViewNode>> {\n\t\treturn this._onDidChangeNodeCollapsibleState.event;\n\t}\n\n\tprotected disposable: Disposable | undefined;\n\tprotected root: RootNode | undefined;\n\tprotected tree: TreeView<ViewNode> | undefined;\n\n\tprivate readonly _lastKnownLimits = new Map<string, number | undefined>();\n\n\tconstructor(public readonly id: string, public readonly name: string) {\n\t\tif (Logger.isDebugging || Container.config.debug) {\n\t\t\tfunction addDebuggingInfo(item: TreeItem, node: ViewNode, parent: ViewNode | undefined) {\n\t\t\t\tif (item.tooltip == null) {\n\t\t\t\t\titem.tooltip = new MarkdownString(\n\t\t\t\t\t\titem.label != null && typeof item.label !== 'string' ? item.label.label : item.label ?? '',\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (typeof item.tooltip === 'string') {\n\t\t\t\t\titem.tooltip = `${item.tooltip}\\n\\n---\\ncontext: ${item.contextValue}\\nnode: ${node.toString()}${\n\t\t\t\t\t\tparent != null ? `\\nparent: ${parent.toString()}` : ''\n\t\t\t\t\t}`;\n\t\t\t\t} else {\n\t\t\t\t\titem.tooltip.appendMarkdown(\n\t\t\t\t\t\t`\\n\\n---\\n\\ncontext: \\`${item.contextValue}\\`\\\\\\nnode: \\`${node.toString()}\\`${\n\t\t\t\t\t\t\tparent != null ? `\\\\\\nparent: \\`${parent.toString()}\\`` : ''\n\t\t\t\t\t\t}`,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst getTreeItem = this.getTreeItem;\n\t\t\tthis.getTreeItem = async function (this: ViewBase<RootNode, ViewConfig>, node: ViewNode) {\n\t\t\t\tconst item = await getTreeItem.apply(this, [node]);\n\n\t\t\t\tconst parent = node.getParent();\n\n\t\t\t\tif (node.resolveTreeItem != null) {\n\t\t\t\t\tconst resolveTreeItem = node.resolveTreeItem;\n\t\t\t\t\tnode.resolveTreeItem = async function (this: ViewBase<RootNode, ViewConfig>, item: TreeItem) {\n\t\t\t\t\t\tconst resolvedItem = await resolveTreeItem.apply(this, [item]);\n\n\t\t\t\t\t\taddDebuggingInfo(resolvedItem, node, parent);\n\n\t\t\t\t\t\treturn resolvedItem;\n\t\t\t\t\t};\n\n\t\t\t\t\treturn item;\n\t\t\t\t}\n\n\t\t\t\taddDebuggingInfo(item, node, parent);\n\n\t\t\t\treturn item;\n\t\t\t};\n\t\t}\n\n\t\tthis.registerCommands();\n\n\t\tContainer.context.subscriptions.push(\n\t\t\tconfiguration.onDidChange(e => {\n\t\t\t\tif (!this.filterConfigurationChanged(e)) return;\n\n\t\t\t\tthis._config = undefined;\n\t\t\t\tthis.onConfigurationChanged(e);\n\t\t\t}, this),\n\t\t);\n\n\t\tthis.initialize({ showCollapseAll: this.showCollapseAll });\n\n\t\tsetImmediate(() => this.onConfigurationChanged());\n\t}\n\n\tprotected get showCollapseAll(): boolean {\n\t\treturn true;\n\t}\n\n\tprotected filterConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tif (!configuration.changed(e, 'views')) return false;\n\n\t\tif (configuration.changed(e, `views.${this.configKey}` as const)) return true;\n\t\tfor (const key of viewsCommonConfigKeys) {\n\t\t\tif (configuration.changed(e, `views.${key}` as const)) return true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tdispose() {\n\t\tthis.disposable?.dispose();\n\t}\n\n\tprivate _title: string | undefined;\n\tget title(): string | undefined {\n\t\treturn this._title;\n\t}\n\tset title(value: string | undefined) {\n\t\tthis._title = value;\n\t\tif (this.tree != null) {\n\t\t\tthis.tree.title = value;\n\t\t}\n\t}\n\n\tprivate _description: string | undefined;\n\tget description(): string | undefined {\n\t\treturn this._description;\n\t}\n\tset description(value: string | undefined) {\n\t\tthis._description = value;\n\t\tif (this.tree != null) {\n\t\t\tthis.tree.description = value;\n\t\t}\n\t}\n\n\tprivate _message: string | undefined;\n\tget message(): string | undefined {\n\t\treturn this._message;\n\t}\n\tset message(value: string | undefined) {\n\t\tthis._message = value;\n\t\tif (this.tree != null) {\n\t\t\tthis.tree.message = value;\n\t\t}\n\t}\n\n\tgetQualifiedCommand(command: string) {\n\t\treturn `${this.id}.${command}`;\n\t}\n\n\tprotected abstract getRoot(): RootNode;\n\tprotected abstract registerCommands(): void;\n\tprotected onConfigurationChanged(e?: ConfigurationChangeEvent): void {\n\t\tif (e != null && this.root != null) {\n\t\t\tvoid this.refresh(true);\n\t\t}\n\t}\n\n\tprotected initialize(options: { showCollapseAll?: boolean } = {}) {\n\t\tif (this.disposable != null) {\n\t\t\tthis.disposable.dispose();\n\t\t\tthis._onDidChangeTreeData = new EventEmitter<ViewNode>();\n\t\t}\n\n\t\tthis.tree = window.createTreeView<ViewNode<View>>(this.id, {\n\t\t\t...options,\n\t\t\ttreeDataProvider: this,\n\t\t});\n\t\tthis.disposable = Disposable.from(\n\t\t\tthis.tree,\n\t\t\tthis.tree.onDidChangeVisibility(Functions.debounce(this.onVisibilityChanged, 250), this),\n\t\t\tthis.tree.onDidCollapseElement(this.onElementCollapsed, this),\n\t\t\tthis.tree.onDidExpandElement(this.onElementExpanded, this),\n\t\t);\n\t\tthis._title = this.tree.title;\n\t}\n\n\tprotected ensureRoot(force: boolean = false) {\n\t\tif (this.root == null || force) {\n\t\t\tthis.root = this.getRoot();\n\t\t}\n\n\t\treturn this.root;\n\t}\n\n\tgetChildren(node?: ViewNode): ViewNode[] | Promise<ViewNode[]> {\n\t\tif (node != null) return node.getChildren();\n\n\t\tconst root = this.ensureRoot();\n\t\treturn root.getChildren();\n\t}\n\n\tgetParent(node: ViewNode): ViewNode | undefined {\n\t\treturn node.getParent();\n\t}\n\n\tgetTreeItem(node: ViewNode): TreeItem | Promise<TreeItem> {\n\t\treturn node.getTreeItem();\n\t}\n\n\tresolveTreeItem(item: TreeItem, node: ViewNode): TreeItem | Promise<TreeItem> {\n\t\treturn node.resolveTreeItem(item);\n\t}\n\n\tprotected onElementCollapsed(e: TreeViewExpansionEvent<ViewNode>) {\n\t\tthis._onDidChangeNodeCollapsibleState.fire({ ...e, state: TreeItemCollapsibleState.Collapsed });\n\t}\n\n\tprotected onElementExpanded(e: TreeViewExpansionEvent<ViewNode>) {\n\t\tthis._onDidChangeNodeCollapsibleState.fire({ ...e, state: TreeItemCollapsibleState.Expanded });\n\t}\n\n\tprotected onVisibilityChanged(e: TreeViewVisibilityChangeEvent) {\n\t\tthis._onDidChangeVisibility.fire(e);\n\t}\n\n\tget selection(): ViewNode[] {\n\t\tif (this.tree == null || this.root == null) return [];\n\n\t\treturn this.tree.selection;\n\t}\n\n\tget visible(): boolean {\n\t\treturn this.tree != null ? this.tree.visible : false;\n\t}\n\n\tasync findNode(\n\t\tid: string,\n\t\toptions?: {\n\t\t\tallowPaging?: boolean;\n\t\t\tcanTraverse?: (node: ViewNode) => boolean | Promise<boolean>;\n\t\t\tmaxDepth?: number;\n\t\t\ttoken?: CancellationToken;\n\t\t},\n\t): Promise<ViewNode | undefined>;\n\tasync findNode(\n\t\tpredicate: (node: ViewNode) => boolean,\n\t\toptions?: {\n\t\t\tallowPaging?: boolean;\n\t\t\tcanTraverse?: (node: ViewNode) => boolean | Promise<boolean>;\n\t\t\tmaxDepth?: number;\n\t\t\ttoken?: CancellationToken;\n\t\t},\n\t): Promise<ViewNode | undefined>;\n\t@log({\n\t\targs: {\n\t\t\t0: (predicate: string | ((node: ViewNode) => boolean)) =>\n\t\t\t\ttypeof predicate === 'string' ? predicate : 'function',\n\t\t\t1: (opts: {\n\t\t\t\tallowPaging?: boolean;\n\t\t\t\tcanTraverse?: (node: ViewNode) => boolean | Promise<boolean>;\n\t\t\t\tmaxDepth?: number;\n\t\t\t\ttoken?: CancellationToken;\n\t\t\t}) => `options=${JSON.stringify({ ...opts, canTraverse: undefined, token: undefined })}`,\n\t\t},\n\t})\n\tasync findNode(\n\t\tpredicate: string | ((node: ViewNode) => boolean),\n\t\t{\n\t\t\tallowPaging = false,\n\t\t\tcanTraverse,\n\t\t\tmaxDepth = 2,\n\t\t\ttoken,\n\t\t}: {\n\t\t\tallowPaging?: boolean;\n\t\t\tcanTraverse?: (node: ViewNode) => boolean | Promise<boolean>;\n\t\t\tmaxDepth?: number;\n\t\t\ttoken?: CancellationToken;\n\t\t} = {},\n\t): Promise<ViewNode | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\t// If we have no root (e.g. never been initialized) force it so the tree will load properly\n\t\tif (this.root == null) {\n\t\t\tawait this.show();\n\t\t}\n\n\t\ttry {\n\t\t\tconst node = await this.findNodeCoreBFS(\n\t\t\t\ttypeof predicate === 'string' ? n => n.id === predicate : predicate,\n\t\t\t\tthis.ensureRoot(),\n\t\t\t\tallowPaging,\n\t\t\t\tcanTraverse,\n\t\t\t\tmaxDepth,\n\t\t\t\ttoken,\n\t\t\t);\n\n\t\t\treturn node;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprivate async findNodeCoreBFS(\n\t\tpredicate: (node: ViewNode) => boolean,\n\t\troot: ViewNode,\n\t\tallowPaging: boolean,\n\t\tcanTraverse: ((node: ViewNode) => boolean | Promise<boolean>) | undefined,\n\t\tmaxDepth: number,\n\t\ttoken: CancellationToken | undefined,\n\t): Promise<ViewNode | undefined> {\n\t\tconst queue: (ViewNode | undefined)[] = [root, undefined];\n\n\t\tconst defaultPageSize = Container.config.advanced.maxListItems;\n\n\t\tlet depth = 0;\n\t\tlet node: ViewNode | undefined;\n\t\tlet children: ViewNode[];\n\t\tlet pagedChildren: ViewNode[];\n\t\twhile (queue.length > 1) {\n\t\t\tif (token?.isCancellationRequested) return undefined;\n\n\t\t\tnode = queue.shift();\n\t\t\tif (node == null) {\n\t\t\t\tdepth++;\n\n\t\t\t\tqueue.push(undefined);\n\t\t\t\tif (depth > maxDepth) break;\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (predicate(node)) return node;\n\t\t\tif (canTraverse != null) {\n\t\t\t\tconst traversable = canTraverse(node);\n\t\t\t\tif (Promises.is(traversable)) {\n\t\t\t\t\tif (!(await traversable)) continue;\n\t\t\t\t} else if (!traversable) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tchildren = await node.getChildren();\n\t\t\tif (children.length === 0) continue;\n\n\t\t\twhile (node != null && !PageableViewNode.is(node)) {\n\t\t\t\tnode = await node.getSplattedChild?.();\n\t\t\t}\n\n\t\t\tif (node != null && PageableViewNode.is(node)) {\n\t\t\t\tlet child = children.find(predicate);\n\t\t\t\tif (child != null) return child;\n\n\t\t\t\tif (allowPaging && node.hasMore) {\n\t\t\t\t\twhile (true) {\n\t\t\t\t\t\tif (token?.isCancellationRequested) return undefined;\n\n\t\t\t\t\t\tawait this.loadMoreNodeChildren(node, defaultPageSize);\n\n\t\t\t\t\t\tpagedChildren = await Promises.cancellable(\n\t\t\t\t\t\t\tPromise.resolve(node.getChildren()),\n\t\t\t\t\t\t\ttoken ?? 60000,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tonDidCancel: resolve => resolve([]),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tchild = pagedChildren.find(predicate);\n\t\t\t\t\t\tif (child != null) return child;\n\n\t\t\t\t\t\tif (!node.hasMore) break;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Don't traverse into paged children\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tqueue.push(...children);\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprotected async ensureRevealNode(\n\t\tnode: ViewNode,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\t// Not sure why I need to reveal each parent, but without it the node won't be revealed\n\t\tconst nodes: ViewNode[] = [];\n\n\t\tlet parent: ViewNode | undefined = node;\n\t\twhile (parent != null) {\n\t\t\tnodes.push(parent);\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\tif (nodes.length > 1) {\n\t\t\tnodes.pop();\n\t\t}\n\n\t\tfor (const n of nodes.reverse()) {\n\t\t\ttry {\n\t\t\t\tawait this.reveal(n, options);\n\t\t\t} catch {}\n\t\t}\n\t}\n\n\t@debug()\n\tasync refresh(reset: boolean = false) {\n\t\tawait this.root?.refresh?.(reset);\n\n\t\tthis.triggerNodeChange();\n\t}\n\n\t@debug({\n\t\targs: { 0: (n: ViewNode) => n.toString() },\n\t})\n\tasync refreshNode(node: ViewNode, reset: boolean = false, force: boolean = false) {\n\t\tconst cancel = await node.refresh?.(reset);\n\t\tif (!force && cancel === true) return;\n\n\t\tthis.triggerNodeChange(node);\n\t}\n\n\t@log({\n\t\targs: { 0: (n: ViewNode) => n.toString() },\n\t})\n\tasync reveal(\n\t\tnode: ViewNode,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t},\n\t) {\n\t\tif (this.tree == null) return;\n\n\t\ttry {\n\t\t\tawait this.tree.reveal(node, options);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t}\n\t}\n\n\t@log()\n\tasync show() {\n\t\ttry {\n\t\t\tvoid (await commands.executeCommand(`${this.id}.focus`));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t}\n\t}\n\n\t// @debug({ args: { 0: (n: ViewNode) => n.toString() }, singleLine: true })\n\tgetNodeLastKnownLimit(node: PageableViewNode) {\n\t\treturn this._lastKnownLimits.get(node.id);\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (n: ViewNode & PageableViewNode) => n.toString(),\n\t\t\t3: (n?: ViewNode) => (n == null ? '' : n.toString()),\n\t\t},\n\t})\n\tasync loadMoreNodeChildren(\n\t\tnode: ViewNode & PageableViewNode,\n\t\tlimit: number | { until: any } | undefined,\n\t\tpreviousNode?: ViewNode,\n\t) {\n\t\tif (previousNode != null) {\n\t\t\tvoid (await this.reveal(previousNode, { select: true }));\n\t\t}\n\n\t\tawait node.loadMore(limit);\n\t\tthis._lastKnownLimits.set(node.id, node.limit);\n\t}\n\n\t@debug({ args: { 0: (n: ViewNode) => n.toString() }, singleLine: true })\n\tresetNodeLastKnownLimit(node: PageableViewNode) {\n\t\tthis._lastKnownLimits.delete(node.id);\n\t}\n\n\t@debug({\n\t\targs: { 0: (n: ViewNode) => (n != null ? n.toString() : '') },\n\t})\n\ttriggerNodeChange(node?: ViewNode) {\n\t\t// Since the root node won't actually refresh, force everything\n\t\tthis._onDidChangeTreeData.fire(node != null && node !== this.root ? node : undefined);\n\t}\n\n\tprotected abstract readonly configKey: ViewsConfigKeys;\n\n\tprivate _config: (ViewConfig & ViewsCommonConfig) | undefined;\n\tget config(): ViewConfig & ViewsCommonConfig {\n\t\tif (this._config == null) {\n\t\t\tconst cfg = { ...Container.config.views };\n\t\t\tfor (const view of viewsConfigKeys) {\n\t\t\t\tdelete cfg[view];\n\t\t\t}\n\n\t\t\tthis._config = { ...(cfg as ViewsCommonConfig), ...(Container.config.views[this.configKey] as ViewConfig) };\n\t\t}\n\n\t\treturn this._config;\n\t}\n}\n","'use strict';\nimport type { GitCommandOptions } from '../git/git';\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport class RequestType<Request, Response> {\n\tconstructor(public readonly name: string) {}\n}\n\nexport interface GitCommandRequest {\n\toptions: GitCommandOptions;\n\targs: any[];\n}\n\nexport interface GitCommandResponse {\n\tdata: string;\n\tisBuffer?: boolean;\n}\n\nexport const GitCommandRequestType = new RequestType<GitCommandRequest, GitCommandResponse>('git');\n\nexport interface RepositoryProxy {\n\tfolderUri: string;\n\tpath: string;\n\troot: boolean;\n\tclosed: boolean;\n}\n\nexport interface RepositoriesInFolderRequest {\n\tfolderUri: string;\n}\n\nexport interface RepositoriesInFolderResponse {\n\trepositories: RepositoryProxy[];\n}\n\nexport const RepositoriesInFolderRequestType = new RequestType<\n\tRepositoriesInFolderRequest,\n\tRepositoriesInFolderResponse\n>('repositories/inFolder');\n","'use strict';\nimport { CancellationToken, Disposable, Uri, workspace, WorkspaceFoldersChangeEvent } from 'vscode';\nimport type { LiveShare, SharedService } from '../@types/vsls';\nimport { Container } from '../container';\nimport { git } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { debug, Iterables, log, Strings } from '../system';\nimport {\n\tGitCommandRequest,\n\tGitCommandRequestType,\n\tGitCommandResponse,\n\tRepositoriesInFolderRequest,\n\tRepositoriesInFolderRequestType,\n\tRepositoriesInFolderResponse,\n\tRequestType,\n} from './protocol';\nimport { vslsUriRootRegex } from './vsls';\n\nconst defaultWhitelistFn = () => true;\nconst gitWhitelist = new Map<string, (args: any[]) => boolean>([\n\t['blame', defaultWhitelistFn],\n\t['branch', args => args[1] === '--contains'],\n\t['cat-file', defaultWhitelistFn],\n\t['check-mailmap', defaultWhitelistFn],\n\t['check-ref-format', defaultWhitelistFn],\n\t['config', args => args[1] === '--get' || args[1] === '--get-regex'],\n\t['diff', defaultWhitelistFn],\n\t['difftool', defaultWhitelistFn],\n\t['for-each-ref', defaultWhitelistFn],\n\t['log', defaultWhitelistFn],\n\t['ls-files', defaultWhitelistFn],\n\t['ls-tree', defaultWhitelistFn],\n\t['merge-base', defaultWhitelistFn],\n\t['remote', args => args[1] === '-v' || args[1] === 'get-url'],\n\t['rev-list', defaultWhitelistFn],\n\t['rev-parse', defaultWhitelistFn],\n\t['shortlog', defaultWhitelistFn],\n\t['show', defaultWhitelistFn],\n\t['show-ref', defaultWhitelistFn],\n\t['stash', args => args[1] === 'list'],\n\t['status', defaultWhitelistFn],\n\t['symbolic-ref', defaultWhitelistFn],\n\t['tag', args => args[1] === '-l'],\n]);\n\nconst leadingSlashRegex = /^[/|\\\\]/;\n\nexport class VslsHostService implements Disposable {\n\tstatic ServiceId = 'proxy';\n\n\t@log()\n\tstatic async share(api: LiveShare) {\n\t\tconst service = await api.shareService(this.ServiceId);\n\t\tif (service == null) {\n\t\t\tthrow new Error('Failed to share host service');\n\t\t}\n\n\t\treturn new VslsHostService(api, service);\n\t}\n\n\tprivate readonly _disposable: Disposable;\n\tprivate _localPathsRegex: RegExp | undefined;\n\tprivate _localToSharedPaths = new Map<string, string>();\n\tprivate _sharedPathsRegex: RegExp | undefined;\n\tprivate _sharedToLocalPaths = new Map<string, string>();\n\n\tconstructor(private readonly _api: LiveShare, private readonly _service: SharedService) {\n\t\t_service.onDidChangeIsServiceAvailable(this.onAvailabilityChanged.bind(this));\n\n\t\tthis._disposable = Disposable.from(workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged, this));\n\n\t\tthis.onRequest(GitCommandRequestType, this.onGitCommandRequest.bind(this));\n\t\tthis.onRequest(RepositoriesInFolderRequestType, this.onRepositoriesInFolderRequest.bind(this));\n\n\t\tvoid this.onWorkspaceFoldersChanged();\n\t}\n\n\tdispose() {\n\t\tthis._disposable.dispose();\n\t\tvoid this._api.unshareService(VslsHostService.ServiceId);\n\t}\n\n\tprivate onRequest<TRequest, TResponse>(\n\t\trequestType: RequestType<TRequest, TResponse>,\n\t\thandler: (request: TRequest, cancellation: CancellationToken) => Promise<TResponse>,\n\t) {\n\t\tthis._service.onRequest(requestType.name, (args: any[], cancellation: CancellationToken) =>\n\t\t\thandler(args[0], cancellation),\n\t\t);\n\t}\n\n\t@log()\n\tprivate onAvailabilityChanged(_available: boolean) {\n\t\t// TODO\n\t}\n\n\t@debug()\n\tprivate onWorkspaceFoldersChanged(_e?: WorkspaceFoldersChangeEvent) {\n\t\tif (workspace.workspaceFolders === undefined || workspace.workspaceFolders.length === 0) return;\n\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tthis._localToSharedPaths.clear();\n\t\tthis._sharedToLocalPaths.clear();\n\n\t\tlet localPath;\n\t\tlet sharedPath;\n\t\tfor (const f of workspace.workspaceFolders) {\n\t\t\tlocalPath = Strings.normalizePath(f.uri.fsPath);\n\t\t\tsharedPath = Strings.normalizePath(this.convertLocalUriToShared(f.uri).fsPath);\n\n\t\t\tLogger.debug(cc, `shared='${sharedPath}' \\u2194 local='${localPath}'`);\n\t\t\tthis._localToSharedPaths.set(localPath, sharedPath);\n\t\t\tthis._sharedToLocalPaths.set(sharedPath, localPath);\n\t\t}\n\n\t\tlet localPaths = Iterables.join(this._sharedToLocalPaths.values(), '|');\n\t\tlocalPaths = localPaths.replace(/(\\/|\\\\)/g, '[\\\\\\\\/|\\\\\\\\]');\n\t\tthis._localPathsRegex = new RegExp(`(${localPaths})`, 'gi');\n\n\t\tlet sharedPaths = Iterables.join(this._localToSharedPaths.values(), '|');\n\t\tsharedPaths = sharedPaths.replace(/(\\/|\\\\)/g, '[\\\\\\\\/|\\\\\\\\]');\n\t\tthis._sharedPathsRegex = new RegExp(`^(${sharedPaths})`, 'i');\n\t}\n\n\t@log()\n\tprivate async onGitCommandRequest(\n\t\trequest: GitCommandRequest,\n\t\t_cancellation: CancellationToken,\n\t): Promise<GitCommandResponse> {\n\t\tconst { options, args } = request;\n\n\t\tconst fn = gitWhitelist.get(request.args[0]);\n\t\tif (fn === undefined || !fn(request.args)) throw new Error(`Git ${request.args[0]} command is not allowed`);\n\n\t\tlet isRootWorkspace = false;\n\t\tif (options.cwd !== undefined && options.cwd.length > 0 && this._sharedToLocalPaths !== undefined) {\n\t\t\t// This is all so ugly, but basically we are converting shared paths to local paths\n\t\t\tif (this._sharedPathsRegex?.test(options.cwd)) {\n\t\t\t\toptions.cwd = Strings.normalizePath(options.cwd).replace(this._sharedPathsRegex, (match, shared) => {\n\t\t\t\t\tif (!isRootWorkspace) {\n\t\t\t\t\t\tisRootWorkspace = shared === '/~0';\n\t\t\t\t\t}\n\n\t\t\t\t\tconst local = this._sharedToLocalPaths.get(shared);\n\t\t\t\t\treturn local != null ? local : shared;\n\t\t\t\t});\n\t\t\t} else if (leadingSlashRegex.test(options.cwd)) {\n\t\t\t\tconst localCwd = this._sharedToLocalPaths.get('/~0');\n\t\t\t\tif (localCwd !== undefined) {\n\t\t\t\t\tisRootWorkspace = true;\n\t\t\t\t\toptions.cwd = GitUri.resolve(options.cwd, localCwd);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet files = false;\n\t\tlet i = -1;\n\t\tfor (const arg of args) {\n\t\t\ti++;\n\t\t\tif (arg === '--') {\n\t\t\t\tfiles = true;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (!files) continue;\n\n\t\t\tif (typeof arg === 'string') {\n\t\t\t\t// If we are the \"root\" workspace, then we need to remove the leading slash off the path (otherwise it will not be treated as a relative path)\n\t\t\t\tif (isRootWorkspace && leadingSlashRegex.test(arg[0])) {\n\t\t\t\t\targs.splice(i, 1, arg.substr(1));\n\t\t\t\t}\n\n\t\t\t\tif (this._sharedPathsRegex?.test(arg)) {\n\t\t\t\t\targs.splice(\n\t\t\t\t\t\ti,\n\t\t\t\t\t\t1,\n\t\t\t\t\t\tStrings.normalizePath(arg).replace(this._sharedPathsRegex, (match, shared) => {\n\t\t\t\t\t\t\tconst local = this._sharedToLocalPaths.get(shared);\n\t\t\t\t\t\t\treturn local != null ? local : shared;\n\t\t\t\t\t\t}),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet data = await git(options, ...args);\n\t\tif (typeof data === 'string') {\n\t\t\t// And then we convert local paths to shared paths\n\t\t\tif (this._localPathsRegex !== undefined && data.length > 0) {\n\t\t\t\tdata = data.replace(this._localPathsRegex, (match, local) => {\n\t\t\t\t\tconst shared = this._localToSharedPaths.get(local);\n\t\t\t\t\treturn shared != null ? shared : local;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn { data: data };\n\t\t}\n\n\t\treturn { data: data.toString('binary'), isBuffer: true };\n\t}\n\n\t@log()\n\tprivate async onRepositoriesInFolderRequest(\n\t\trequest: RepositoriesInFolderRequest,\n\t\t_cancellation: CancellationToken,\n\t): Promise<RepositoriesInFolderResponse> {\n\t\tconst uri = this.convertSharedUriToLocal(Uri.parse(request.folderUri));\n\t\tconst normalized = Strings.normalizePath(uri.fsPath, { stripTrailingSlash: true }).toLowerCase();\n\n\t\tconst repos = [\n\t\t\t...Iterables.filterMap(await Container.git.getRepositories(), r => {\n\t\t\t\tif (!r.normalizedPath.startsWith(normalized)) return undefined;\n\n\t\t\t\tconst vslsUri = this.convertLocalUriToShared(r.folder.uri);\n\t\t\t\treturn {\n\t\t\t\t\tfolderUri: vslsUri.toString(true),\n\t\t\t\t\tpath: vslsUri.path,\n\t\t\t\t\troot: r.root,\n\t\t\t\t\tclosed: r.closed,\n\t\t\t\t};\n\t\t\t}),\n\t\t];\n\n\t\treturn {\n\t\t\trepositories: repos,\n\t\t};\n\t}\n\n\t@debug({\n\t\texit: result => `returned ${result.toString(true)}`,\n\t})\n\tprivate convertLocalUriToShared(localUri: Uri) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tlet sharedUri = this._api.convertLocalUriToShared(localUri);\n\t\tLogger.debug(\n\t\t\tcc,\n\t\t\t`LiveShare.convertLocalUriToShared(${localUri.toString(true)}) returned ${sharedUri.toString(true)}`,\n\t\t);\n\n\t\tconst localPath = localUri.path;\n\t\tlet sharedPath = sharedUri.path;\n\t\tif (sharedUri.authority.length > 0) {\n\t\t\tsharedPath = `/${sharedUri.authority}${sharedPath}`;\n\t\t}\n\n\t\tif (new RegExp(`${localPath}$`, 'i').test(sharedPath)) {\n\t\t\tif (sharedPath.length === localPath.length) {\n\t\t\t\tconst folder = workspace.getWorkspaceFolder(localUri)!;\n\t\t\t\tsharedUri = sharedUri.with({ path: `/~${folder.index}` });\n\t\t\t} else {\n\t\t\t\tsharedUri = sharedUri.with({ path: sharedPath.substr(0, sharedPath.length - localPath.length) });\n\t\t\t}\n\t\t} else if (!sharedPath.startsWith('/~')) {\n\t\t\tconst folder = workspace.getWorkspaceFolder(localUri)!;\n\t\t\tsharedUri = sharedUri.with({ path: `/~${folder.index}${sharedPath}` });\n\t\t}\n\n\t\treturn sharedUri;\n\t}\n\n\tprivate convertSharedUriToLocal(sharedUri: Uri) {\n\t\tif (vslsUriRootRegex.test(sharedUri.path)) {\n\t\t\tsharedUri = sharedUri.with({ path: `${sharedUri.path}/` });\n\t\t}\n\n\t\tconst localUri = this._api.convertSharedUriToLocal(sharedUri);\n\n\t\tconst localPath = localUri.path;\n\t\tconst sharedPath = sharedUri.path;\n\t\tif (localPath.endsWith(sharedPath)) {\n\t\t\treturn localUri.with({ path: localPath.substr(0, localPath.length - sharedPath.length) });\n\t\t}\n\t\treturn localUri;\n\t}\n}\n","'use strict';\nimport { CancellationToken, Disposable, window, WorkspaceFolder } from 'vscode';\nimport type { LiveShare, SharedServiceProxy } from '../@types/vsls';\nimport { setEnabled } from '../extension';\nimport { GitCommandOptions, Repository, RepositoryChangeEvent } from '../git/git';\nimport { Logger } from '../logger';\nimport { debug, log } from '../system';\nimport { VslsHostService } from './host';\nimport { GitCommandRequestType, RepositoriesInFolderRequestType, RepositoryProxy, RequestType } from './protocol';\n\nexport class VslsGuestService implements Disposable {\n\t@log()\n\tstatic async connect(api: LiveShare) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\ttry {\n\t\t\tconst service = await api.getSharedService(VslsHostService.ServiceId);\n\t\t\tif (service == null) {\n\t\t\t\tthrow new Error('Failed to connect to host service');\n\t\t\t}\n\n\t\t\treturn new VslsGuestService(api, service);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tconstructor(private readonly _api: LiveShare, private readonly _service: SharedServiceProxy) {\n\t\t_service.onDidChangeIsServiceAvailable(this.onAvailabilityChanged.bind(this));\n\t\tthis.onAvailabilityChanged(_service.isServiceAvailable);\n\t}\n\n\tdispose() {\n\t\t// nothing to dispose\n\t}\n\n\t@log()\n\tprivate onAvailabilityChanged(available: boolean) {\n\t\tif (available) {\n\t\t\tvoid setEnabled(true);\n\n\t\t\treturn;\n\t\t}\n\n\t\tvoid setEnabled(false);\n\t\tvoid window.showWarningMessage(\n\t\t\t'GitLens features will be unavailable. Unable to connect to the host GitLens service. The host may have disabled GitLens guest access or may not have GitLens installed.',\n\t\t);\n\t}\n\n\t@log()\n\tasync git<TOut extends string | Buffer>(options: GitCommandOptions, ...args: any[]) {\n\t\tconst response = await this.sendRequest(GitCommandRequestType, { options: options, args: args });\n\n\t\tif (response.isBuffer) {\n\t\t\treturn Buffer.from(response.data, 'binary') as TOut;\n\t\t}\n\t\treturn response.data as TOut;\n\t}\n\n\t@log()\n\tasync getRepositoriesInFolder(\n\t\tfolder: WorkspaceFolder,\n\t\tonAnyRepositoryChanged: (repo: Repository, e: RepositoryChangeEvent) => void,\n\t): Promise<Repository[]> {\n\t\tconst response = await this.sendRequest(RepositoriesInFolderRequestType, {\n\t\t\tfolderUri: folder.uri.toString(true),\n\t\t});\n\n\t\treturn response.repositories.map(\n\t\t\t(r: RepositoryProxy) =>\n\t\t\t\tnew Repository(folder, r.path, r.root, onAnyRepositoryChanged, !window.state.focused, r.closed),\n\t\t);\n\t}\n\n\t@debug()\n\tprivate sendRequest<TRequest, TResponse>(\n\t\trequestType: RequestType<TRequest, TResponse>,\n\t\trequest: TRequest,\n\t\t_cancellation?: CancellationToken,\n\t): Promise<TResponse> {\n\t\treturn this._service.request(requestType.name, [request]);\n\t}\n}\n","'use strict';\nimport { Disposable, extensions, workspace } from 'vscode';\nimport type { LiveShare, LiveShareExtension, SessionChangeEvent } from '../@types/vsls';\nimport { ContextKeys, DocumentSchemes, setContext } from '../constants';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { debug, timeout } from '../system';\nimport { VslsGuestService } from './guest';\nimport { VslsHostService } from './host';\n\nexport const vslsUriPrefixRegex = /^[/|\\\\]~(?:\\d+?|external)(?:[/|\\\\]|$)/;\nexport const vslsUriRootRegex = /^[/|\\\\]~(?:\\d+?|external)$/;\n\nexport interface ContactPresence {\n\tstatus: ContactPresenceStatus;\n\tstatusText: string;\n}\nexport type ContactPresenceStatus = 'online' | 'away' | 'busy' | 'dnd' | 'offline';\n\nfunction contactStatusToPresence(status: string | undefined): ContactPresence {\n\tswitch (status) {\n\t\tcase 'available':\n\t\t\treturn { status: 'online', statusText: 'Available' };\n\t\tcase 'away':\n\t\t\treturn { status: 'away', statusText: 'Away' };\n\t\tcase 'busy':\n\t\t\treturn { status: 'busy', statusText: 'Busy' };\n\t\tcase 'doNotDisturb':\n\t\t\treturn { status: 'dnd', statusText: 'DND' };\n\t\tdefault:\n\t\t\treturn { status: 'offline', statusText: 'Offline' };\n\t}\n}\n\nexport class VslsController implements Disposable {\n\tprivate _disposable: Disposable | undefined;\n\tprivate _guest: VslsGuestService | undefined;\n\tprivate _host: VslsHostService | undefined;\n\n\tprivate _onReady: (() => void) | undefined;\n\tprivate _waitForReady: Promise<void> | undefined;\n\n\tprivate _api: Promise<LiveShare | undefined> | undefined;\n\n\tconstructor() {\n\t\tvoid this.initialize();\n\t}\n\n\tdispose() {\n\t\tthis._disposable?.dispose();\n\t\tthis._host?.dispose();\n\t\tthis._guest?.dispose();\n\t}\n\n\tprivate async initialize() {\n\t\ttry {\n\t\t\t// If we have a vsls: workspace open, we might be a guest, so wait until live share transitions into a mode\n\t\t\tif (workspace.workspaceFolders?.some(f => f.uri.scheme === DocumentSchemes.Vsls)) {\n\t\t\t\tthis.setReadonly(true);\n\t\t\t\tthis._waitForReady = new Promise(resolve => (this._onReady = resolve));\n\t\t\t}\n\n\t\t\tthis._api = this.getLiveShareApi();\n\t\t\tconst api = await this._api;\n\t\t\tif (api == null) {\n\t\t\t\tvoid setContext(ContextKeys.Vsls, false);\n\t\t\t\t// Tear it down if we can't talk to live share\n\t\t\t\tif (this._onReady !== undefined) {\n\t\t\t\t\tthis._onReady();\n\t\t\t\t\tthis._waitForReady = undefined;\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvoid setContext(ContextKeys.Vsls, true);\n\n\t\t\tthis._disposable = Disposable.from(\n\t\t\t\tapi.onDidChangeSession(e => this.onLiveShareSessionChanged(api, e), this),\n\t\t\t);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t}\n\t}\n\n\tprivate async getLiveShareApi(): Promise<LiveShare | undefined> {\n\t\ttry {\n\t\t\tconst extension = extensions.getExtension<LiveShareExtension>('ms-vsliveshare.vsliveshare');\n\t\t\tif (extension != null) {\n\t\t\t\tconst liveshareExtension = extension.isActive ? extension.exports : await extension.activate();\n\t\t\t\treturn (await liveshareExtension.getApi('1.0.3015')) ?? undefined;\n\t\t\t}\n\t\t} catch {}\n\n\t\treturn undefined;\n\t}\n\n\tget isMaybeGuest() {\n\t\treturn this._guest !== undefined || this._waitForReady !== undefined;\n\t}\n\n\tprivate _readonly: boolean = false;\n\tget readonly() {\n\t\treturn this._readonly;\n\t}\n\tprivate setReadonly(value: boolean) {\n\t\tthis._readonly = value;\n\t\tvoid setContext(ContextKeys.Readonly, value ? true : undefined);\n\t}\n\n\t@debug()\n\tasync getContact(email: string | undefined) {\n\t\tif (email === undefined) return undefined;\n\n\t\tconst api = await this._api;\n\t\tif (api == null) return undefined;\n\n\t\tconst contacts = await api.getContacts([email]);\n\t\treturn contacts.contacts[email];\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (emails: string[]) => `length=${emails.length}`,\n\t\t},\n\t})\n\tprivate async getContacts(emails: string[]) {\n\t\tconst api = await this._api;\n\t\tif (api == null) return undefined;\n\n\t\tconst contacts = await api.getContacts(emails);\n\t\treturn Object.values(contacts.contacts);\n\t}\n\n\t@debug()\n\tasync getContactPresence(email: string | undefined): Promise<ContactPresence | undefined> {\n\t\tconst contact = await this.getContact(email);\n\t\tif (contact == null) return undefined;\n\n\t\treturn contactStatusToPresence(contact.status);\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (emails: string[]) => `length=${emails.length}`,\n\t\t},\n\t})\n\tasync getContactsPresence(emails: string[]): Promise<Map<string, ContactPresence> | undefined> {\n\t\tconst contacts = await this.getContacts(emails);\n\t\tif (contacts == null) return undefined;\n\n\t\treturn new Map<string, ContactPresence>(\n\t\t\tObject.values(contacts).map(c => [c.email, contactStatusToPresence(c.status)]),\n\t\t);\n\t}\n\n\t@debug()\n\t@timeout(250)\n\tmaybeGetPresence(email: string | undefined): Promise<ContactPresence | undefined> {\n\t\treturn Container.vsls.getContactPresence(email);\n\t}\n\n\tasync invite(email: string | undefined) {\n\t\tif (email == null) return undefined;\n\n\t\tconst contact = await this.getContact(email);\n\t\tif (contact == null) return undefined;\n\n\t\treturn contact.invite();\n\t}\n\n\tasync startSession() {\n\t\tconst api = await this._api;\n\t\tif (api == null) return undefined;\n\n\t\treturn api.share();\n\t}\n\n\tasync guest() {\n\t\tif (this._waitForReady !== undefined) {\n\t\t\tawait this._waitForReady;\n\t\t\tthis._waitForReady = undefined;\n\t\t}\n\n\t\treturn this._guest;\n\t}\n\n\thost() {\n\t\treturn this._host;\n\t}\n\n\tprivate async onLiveShareSessionChanged(api: LiveShare, e: SessionChangeEvent) {\n\t\tthis._host?.dispose();\n\t\tthis._guest?.dispose();\n\n\t\tswitch (e.session.role) {\n\t\t\tcase 1 /*Role.Host*/:\n\t\t\t\tthis.setReadonly(false);\n\t\t\t\tvoid setContext(ContextKeys.Vsls, 'host');\n\t\t\t\tif (Container.config.liveshare.allowGuestAccess) {\n\t\t\t\t\tthis._host = await VslsHostService.share(api);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 2 /*Role.Guest*/:\n\t\t\t\tthis.setReadonly(true);\n\t\t\t\tvoid setContext(ContextKeys.Vsls, 'guest');\n\t\t\t\tthis._guest = await VslsGuestService.connect(api);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthis.setReadonly(false);\n\t\t\t\tvoid setContext(ContextKeys.Vsls, true);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (this._onReady !== undefined) {\n\t\t\tthis._onReady();\n\t\t\tthis._onReady = undefined;\n\t\t}\n\t}\n}\n","\"use strict\";\nvar Buffer = require(\"safer-buffer\").Buffer;\n\n// Multibyte codec. In this scheme, a character is represented by 1 or more bytes.\n// Our codec supports UTF-16 surrogates, extensions for GB18030 and unicode sequences.\n// To save memory and loading time, we read table files only when requested.\n\nexports._dbcs = DBCSCodec;\n\nvar UNASSIGNED = -1,\n    GB18030_CODE = -2,\n    SEQ_START  = -10,\n    NODE_START = -1000,\n    UNASSIGNED_NODE = new Array(0x100),\n    DEF_CHAR = -1;\n\nfor (var i = 0; i < 0x100; i++)\n    UNASSIGNED_NODE[i] = UNASSIGNED;\n\n\n// Class DBCSCodec reads and initializes mapping tables.\nfunction DBCSCodec(codecOptions, iconv) {\n    this.encodingName = codecOptions.encodingName;\n    if (!codecOptions)\n        throw new Error(\"DBCS codec is called without the data.\")\n    if (!codecOptions.table)\n        throw new Error(\"Encoding '\" + this.encodingName + \"' has no data.\");\n\n    // Load tables.\n    var mappingTable = codecOptions.table();\n\n\n    // Decode tables: MBCS -> Unicode.\n\n    // decodeTables is a trie, encoded as an array of arrays of integers. Internal arrays are trie nodes and all have len = 256.\n    // Trie root is decodeTables[0].\n    // Values: >=  0 -> unicode character code. can be > 0xFFFF\n    //         == UNASSIGNED -> unknown/unassigned sequence.\n    //         == GB18030_CODE -> this is the end of a GB18030 4-byte sequence.\n    //         <= NODE_START -> index of the next node in our trie to process next byte.\n    //         <= SEQ_START  -> index of the start of a character code sequence, in decodeTableSeq.\n    this.decodeTables = [];\n    this.decodeTables[0] = UNASSIGNED_NODE.slice(0); // Create root node.\n\n    // Sometimes a MBCS char corresponds to a sequence of unicode chars. We store them as arrays of integers here. \n    this.decodeTableSeq = [];\n\n    // Actual mapping tables consist of chunks. Use them to fill up decode tables.\n    for (var i = 0; i < mappingTable.length; i++)\n        this._addDecodeChunk(mappingTable[i]);\n\n    // Load & create GB18030 tables when needed.\n    if (typeof codecOptions.gb18030 === 'function') {\n        this.gb18030 = codecOptions.gb18030(); // Load GB18030 ranges.\n\n        // Add GB18030 common decode nodes.\n        var commonThirdByteNodeIdx = this.decodeTables.length;\n        this.decodeTables.push(UNASSIGNED_NODE.slice(0));\n\n        var commonFourthByteNodeIdx = this.decodeTables.length;\n        this.decodeTables.push(UNASSIGNED_NODE.slice(0));\n\n        // Fill out the tree\n        var firstByteNode = this.decodeTables[0];\n        for (var i = 0x81; i <= 0xFE; i++) {\n            var secondByteNode = this.decodeTables[NODE_START - firstByteNode[i]];\n            for (var j = 0x30; j <= 0x39; j++) {\n                if (secondByteNode[j] === UNASSIGNED) {\n                    secondByteNode[j] = NODE_START - commonThirdByteNodeIdx;\n                } else if (secondByteNode[j] > NODE_START) {\n                    throw new Error(\"gb18030 decode tables conflict at byte 2\");\n                }\n\n                var thirdByteNode = this.decodeTables[NODE_START - secondByteNode[j]];\n                for (var k = 0x81; k <= 0xFE; k++) {\n                    if (thirdByteNode[k] === UNASSIGNED) {\n                        thirdByteNode[k] = NODE_START - commonFourthByteNodeIdx;\n                    } else if (thirdByteNode[k] === NODE_START - commonFourthByteNodeIdx) {\n                        continue;\n                    } else if (thirdByteNode[k] > NODE_START) {\n                        throw new Error(\"gb18030 decode tables conflict at byte 3\");\n                    }\n\n                    var fourthByteNode = this.decodeTables[NODE_START - thirdByteNode[k]];\n                    for (var l = 0x30; l <= 0x39; l++) {\n                        if (fourthByteNode[l] === UNASSIGNED)\n                            fourthByteNode[l] = GB18030_CODE;\n                    }\n                }\n            }\n        }\n    }\n\n    this.defaultCharUnicode = iconv.defaultCharUnicode;\n\n    \n    // Encode tables: Unicode -> DBCS.\n\n    // `encodeTable` is array mapping from unicode char to encoded char. All its values are integers for performance.\n    // Because it can be sparse, it is represented as array of buckets by 256 chars each. Bucket can be null.\n    // Values: >=  0 -> it is a normal char. Write the value (if <=256 then 1 byte, if <=65536 then 2 bytes, etc.).\n    //         == UNASSIGNED -> no conversion found. Output a default char.\n    //         <= SEQ_START  -> it's an index in encodeTableSeq, see below. The character starts a sequence.\n    this.encodeTable = [];\n    \n    // `encodeTableSeq` is used when a sequence of unicode characters is encoded as a single code. We use a tree of\n    // objects where keys correspond to characters in sequence and leafs are the encoded dbcs values. A special DEF_CHAR key\n    // means end of sequence (needed when one sequence is a strict subsequence of another).\n    // Objects are kept separately from encodeTable to increase performance.\n    this.encodeTableSeq = [];\n\n    // Some chars can be decoded, but need not be encoded.\n    var skipEncodeChars = {};\n    if (codecOptions.encodeSkipVals)\n        for (var i = 0; i < codecOptions.encodeSkipVals.length; i++) {\n            var val = codecOptions.encodeSkipVals[i];\n            if (typeof val === 'number')\n                skipEncodeChars[val] = true;\n            else\n                for (var j = val.from; j <= val.to; j++)\n                    skipEncodeChars[j] = true;\n        }\n        \n    // Use decode trie to recursively fill out encode tables.\n    this._fillEncodeTable(0, 0, skipEncodeChars);\n\n    // Add more encoding pairs when needed.\n    if (codecOptions.encodeAdd) {\n        for (var uChar in codecOptions.encodeAdd)\n            if (Object.prototype.hasOwnProperty.call(codecOptions.encodeAdd, uChar))\n                this._setEncodeChar(uChar.charCodeAt(0), codecOptions.encodeAdd[uChar]);\n    }\n\n    this.defCharSB  = this.encodeTable[0][iconv.defaultCharSingleByte.charCodeAt(0)];\n    if (this.defCharSB === UNASSIGNED) this.defCharSB = this.encodeTable[0]['?'];\n    if (this.defCharSB === UNASSIGNED) this.defCharSB = \"?\".charCodeAt(0);\n}\n\nDBCSCodec.prototype.encoder = DBCSEncoder;\nDBCSCodec.prototype.decoder = DBCSDecoder;\n\n// Decoder helpers\nDBCSCodec.prototype._getDecodeTrieNode = function(addr) {\n    var bytes = [];\n    for (; addr > 0; addr >>>= 8)\n        bytes.push(addr & 0xFF);\n    if (bytes.length == 0)\n        bytes.push(0);\n\n    var node = this.decodeTables[0];\n    for (var i = bytes.length-1; i > 0; i--) { // Traverse nodes deeper into the trie.\n        var val = node[bytes[i]];\n\n        if (val == UNASSIGNED) { // Create new node.\n            node[bytes[i]] = NODE_START - this.decodeTables.length;\n            this.decodeTables.push(node = UNASSIGNED_NODE.slice(0));\n        }\n        else if (val <= NODE_START) { // Existing node.\n            node = this.decodeTables[NODE_START - val];\n        }\n        else\n            throw new Error(\"Overwrite byte in \" + this.encodingName + \", addr: \" + addr.toString(16));\n    }\n    return node;\n}\n\n\nDBCSCodec.prototype._addDecodeChunk = function(chunk) {\n    // First element of chunk is the hex mbcs code where we start.\n    var curAddr = parseInt(chunk[0], 16);\n\n    // Choose the decoding node where we'll write our chars.\n    var writeTable = this._getDecodeTrieNode(curAddr);\n    curAddr = curAddr & 0xFF;\n\n    // Write all other elements of the chunk to the table.\n    for (var k = 1; k < chunk.length; k++) {\n        var part = chunk[k];\n        if (typeof part === \"string\") { // String, write as-is.\n            for (var l = 0; l < part.length;) {\n                var code = part.charCodeAt(l++);\n                if (0xD800 <= code && code < 0xDC00) { // Decode surrogate\n                    var codeTrail = part.charCodeAt(l++);\n                    if (0xDC00 <= codeTrail && codeTrail < 0xE000)\n                        writeTable[curAddr++] = 0x10000 + (code - 0xD800) * 0x400 + (codeTrail - 0xDC00);\n                    else\n                        throw new Error(\"Incorrect surrogate pair in \"  + this.encodingName + \" at chunk \" + chunk[0]);\n                }\n                else if (0x0FF0 < code && code <= 0x0FFF) { // Character sequence (our own encoding used)\n                    var len = 0xFFF - code + 2;\n                    var seq = [];\n                    for (var m = 0; m < len; m++)\n                        seq.push(part.charCodeAt(l++)); // Simple variation: don't support surrogates or subsequences in seq.\n\n                    writeTable[curAddr++] = SEQ_START - this.decodeTableSeq.length;\n                    this.decodeTableSeq.push(seq);\n                }\n                else\n                    writeTable[curAddr++] = code; // Basic char\n            }\n        } \n        else if (typeof part === \"number\") { // Integer, meaning increasing sequence starting with prev character.\n            var charCode = writeTable[curAddr - 1] + 1;\n            for (var l = 0; l < part; l++)\n                writeTable[curAddr++] = charCode++;\n        }\n        else\n            throw new Error(\"Incorrect type '\" + typeof part + \"' given in \"  + this.encodingName + \" at chunk \" + chunk[0]);\n    }\n    if (curAddr > 0xFF)\n        throw new Error(\"Incorrect chunk in \"  + this.encodingName + \" at addr \" + chunk[0] + \": too long\" + curAddr);\n}\n\n// Encoder helpers\nDBCSCodec.prototype._getEncodeBucket = function(uCode) {\n    var high = uCode >> 8; // This could be > 0xFF because of astral characters.\n    if (this.encodeTable[high] === undefined)\n        this.encodeTable[high] = UNASSIGNED_NODE.slice(0); // Create bucket on demand.\n    return this.encodeTable[high];\n}\n\nDBCSCodec.prototype._setEncodeChar = function(uCode, dbcsCode) {\n    var bucket = this._getEncodeBucket(uCode);\n    var low = uCode & 0xFF;\n    if (bucket[low] <= SEQ_START)\n        this.encodeTableSeq[SEQ_START-bucket[low]][DEF_CHAR] = dbcsCode; // There's already a sequence, set a single-char subsequence of it.\n    else if (bucket[low] == UNASSIGNED)\n        bucket[low] = dbcsCode;\n}\n\nDBCSCodec.prototype._setEncodeSequence = function(seq, dbcsCode) {\n    \n    // Get the root of character tree according to first character of the sequence.\n    var uCode = seq[0];\n    var bucket = this._getEncodeBucket(uCode);\n    var low = uCode & 0xFF;\n\n    var node;\n    if (bucket[low] <= SEQ_START) {\n        // There's already a sequence with  - use it.\n        node = this.encodeTableSeq[SEQ_START-bucket[low]];\n    }\n    else {\n        // There was no sequence object - allocate a new one.\n        node = {};\n        if (bucket[low] !== UNASSIGNED) node[DEF_CHAR] = bucket[low]; // If a char was set before - make it a single-char subsequence.\n        bucket[low] = SEQ_START - this.encodeTableSeq.length;\n        this.encodeTableSeq.push(node);\n    }\n\n    // Traverse the character tree, allocating new nodes as needed.\n    for (var j = 1; j < seq.length-1; j++) {\n        var oldVal = node[uCode];\n        if (typeof oldVal === 'object')\n            node = oldVal;\n        else {\n            node = node[uCode] = {}\n            if (oldVal !== undefined)\n                node[DEF_CHAR] = oldVal\n        }\n    }\n\n    // Set the leaf to given dbcsCode.\n    uCode = seq[seq.length-1];\n    node[uCode] = dbcsCode;\n}\n\nDBCSCodec.prototype._fillEncodeTable = function(nodeIdx, prefix, skipEncodeChars) {\n    var node = this.decodeTables[nodeIdx];\n    var hasValues = false;\n    var subNodeEmpty = {};\n    for (var i = 0; i < 0x100; i++) {\n        var uCode = node[i];\n        var mbCode = prefix + i;\n        if (skipEncodeChars[mbCode])\n            continue;\n\n        if (uCode >= 0) {\n            this._setEncodeChar(uCode, mbCode);\n            hasValues = true;\n        } else if (uCode <= NODE_START) {\n            var subNodeIdx = NODE_START - uCode;\n            if (!subNodeEmpty[subNodeIdx]) {  // Skip empty subtrees (they are too large in gb18030).\n                var newPrefix = (mbCode << 8) >>> 0;  // NOTE: '>>> 0' keeps 32-bit num positive.\n                if (this._fillEncodeTable(subNodeIdx, newPrefix, skipEncodeChars))\n                    hasValues = true;\n                else\n                    subNodeEmpty[subNodeIdx] = true;\n            }\n        } else if (uCode <= SEQ_START) {\n            this._setEncodeSequence(this.decodeTableSeq[SEQ_START - uCode], mbCode);\n            hasValues = true;\n        }\n    }\n    return hasValues;\n}\n\n\n\n// == Encoder ==================================================================\n\nfunction DBCSEncoder(options, codec) {\n    // Encoder state\n    this.leadSurrogate = -1;\n    this.seqObj = undefined;\n    \n    // Static data\n    this.encodeTable = codec.encodeTable;\n    this.encodeTableSeq = codec.encodeTableSeq;\n    this.defaultCharSingleByte = codec.defCharSB;\n    this.gb18030 = codec.gb18030;\n}\n\nDBCSEncoder.prototype.write = function(str) {\n    var newBuf = Buffer.alloc(str.length * (this.gb18030 ? 4 : 3)),\n        leadSurrogate = this.leadSurrogate,\n        seqObj = this.seqObj, nextChar = -1,\n        i = 0, j = 0;\n\n    while (true) {\n        // 0. Get next character.\n        if (nextChar === -1) {\n            if (i == str.length) break;\n            var uCode = str.charCodeAt(i++);\n        }\n        else {\n            var uCode = nextChar;\n            nextChar = -1;    \n        }\n\n        // 1. Handle surrogates.\n        if (0xD800 <= uCode && uCode < 0xE000) { // Char is one of surrogates.\n            if (uCode < 0xDC00) { // We've got lead surrogate.\n                if (leadSurrogate === -1) {\n                    leadSurrogate = uCode;\n                    continue;\n                } else {\n                    leadSurrogate = uCode;\n                    // Double lead surrogate found.\n                    uCode = UNASSIGNED;\n                }\n            } else { // We've got trail surrogate.\n                if (leadSurrogate !== -1) {\n                    uCode = 0x10000 + (leadSurrogate - 0xD800) * 0x400 + (uCode - 0xDC00);\n                    leadSurrogate = -1;\n                } else {\n                    // Incomplete surrogate pair - only trail surrogate found.\n                    uCode = UNASSIGNED;\n                }\n                \n            }\n        }\n        else if (leadSurrogate !== -1) {\n            // Incomplete surrogate pair - only lead surrogate found.\n            nextChar = uCode; uCode = UNASSIGNED; // Write an error, then current char.\n            leadSurrogate = -1;\n        }\n\n        // 2. Convert uCode character.\n        var dbcsCode = UNASSIGNED;\n        if (seqObj !== undefined && uCode != UNASSIGNED) { // We are in the middle of the sequence\n            var resCode = seqObj[uCode];\n            if (typeof resCode === 'object') { // Sequence continues.\n                seqObj = resCode;\n                continue;\n\n            } else if (typeof resCode == 'number') { // Sequence finished. Write it.\n                dbcsCode = resCode;\n\n            } else if (resCode == undefined) { // Current character is not part of the sequence.\n\n                // Try default character for this sequence\n                resCode = seqObj[DEF_CHAR];\n                if (resCode !== undefined) {\n                    dbcsCode = resCode; // Found. Write it.\n                    nextChar = uCode; // Current character will be written too in the next iteration.\n\n                } else {\n                    // TODO: What if we have no default? (resCode == undefined)\n                    // Then, we should write first char of the sequence as-is and try the rest recursively.\n                    // Didn't do it for now because no encoding has this situation yet.\n                    // Currently, just skip the sequence and write current char.\n                }\n            }\n            seqObj = undefined;\n        }\n        else if (uCode >= 0) {  // Regular character\n            var subtable = this.encodeTable[uCode >> 8];\n            if (subtable !== undefined)\n                dbcsCode = subtable[uCode & 0xFF];\n            \n            if (dbcsCode <= SEQ_START) { // Sequence start\n                seqObj = this.encodeTableSeq[SEQ_START-dbcsCode];\n                continue;\n            }\n\n            if (dbcsCode == UNASSIGNED && this.gb18030) {\n                // Use GB18030 algorithm to find character(s) to write.\n                var idx = findIdx(this.gb18030.uChars, uCode);\n                if (idx != -1) {\n                    var dbcsCode = this.gb18030.gbChars[idx] + (uCode - this.gb18030.uChars[idx]);\n                    newBuf[j++] = 0x81 + Math.floor(dbcsCode / 12600); dbcsCode = dbcsCode % 12600;\n                    newBuf[j++] = 0x30 + Math.floor(dbcsCode / 1260); dbcsCode = dbcsCode % 1260;\n                    newBuf[j++] = 0x81 + Math.floor(dbcsCode / 10); dbcsCode = dbcsCode % 10;\n                    newBuf[j++] = 0x30 + dbcsCode;\n                    continue;\n                }\n            }\n        }\n\n        // 3. Write dbcsCode character.\n        if (dbcsCode === UNASSIGNED)\n            dbcsCode = this.defaultCharSingleByte;\n        \n        if (dbcsCode < 0x100) {\n            newBuf[j++] = dbcsCode;\n        }\n        else if (dbcsCode < 0x10000) {\n            newBuf[j++] = dbcsCode >> 8;   // high byte\n            newBuf[j++] = dbcsCode & 0xFF; // low byte\n        }\n        else if (dbcsCode < 0x1000000) {\n            newBuf[j++] = dbcsCode >> 16;\n            newBuf[j++] = (dbcsCode >> 8) & 0xFF;\n            newBuf[j++] = dbcsCode & 0xFF;\n        } else {\n            newBuf[j++] = dbcsCode >>> 24;\n            newBuf[j++] = (dbcsCode >>> 16) & 0xFF;\n            newBuf[j++] = (dbcsCode >>> 8) & 0xFF;\n            newBuf[j++] = dbcsCode & 0xFF;\n        }\n    }\n\n    this.seqObj = seqObj;\n    this.leadSurrogate = leadSurrogate;\n    return newBuf.slice(0, j);\n}\n\nDBCSEncoder.prototype.end = function() {\n    if (this.leadSurrogate === -1 && this.seqObj === undefined)\n        return; // All clean. Most often case.\n\n    var newBuf = Buffer.alloc(10), j = 0;\n\n    if (this.seqObj) { // We're in the sequence.\n        var dbcsCode = this.seqObj[DEF_CHAR];\n        if (dbcsCode !== undefined) { // Write beginning of the sequence.\n            if (dbcsCode < 0x100) {\n                newBuf[j++] = dbcsCode;\n            }\n            else {\n                newBuf[j++] = dbcsCode >> 8;   // high byte\n                newBuf[j++] = dbcsCode & 0xFF; // low byte\n            }\n        } else {\n            // See todo above.\n        }\n        this.seqObj = undefined;\n    }\n\n    if (this.leadSurrogate !== -1) {\n        // Incomplete surrogate pair - only lead surrogate found.\n        newBuf[j++] = this.defaultCharSingleByte;\n        this.leadSurrogate = -1;\n    }\n    \n    return newBuf.slice(0, j);\n}\n\n// Export for testing\nDBCSEncoder.prototype.findIdx = findIdx;\n\n\n// == Decoder ==================================================================\n\nfunction DBCSDecoder(options, codec) {\n    // Decoder state\n    this.nodeIdx = 0;\n    this.prevBytes = [];\n\n    // Static data\n    this.decodeTables = codec.decodeTables;\n    this.decodeTableSeq = codec.decodeTableSeq;\n    this.defaultCharUnicode = codec.defaultCharUnicode;\n    this.gb18030 = codec.gb18030;\n}\n\nDBCSDecoder.prototype.write = function(buf) {\n    var newBuf = Buffer.alloc(buf.length*2),\n        nodeIdx = this.nodeIdx, \n        prevBytes = this.prevBytes, prevOffset = this.prevBytes.length,\n        seqStart = -this.prevBytes.length, // idx of the start of current parsed sequence.\n        uCode;\n\n    for (var i = 0, j = 0; i < buf.length; i++) {\n        var curByte = (i >= 0) ? buf[i] : prevBytes[i + prevOffset];\n\n        // Lookup in current trie node.\n        var uCode = this.decodeTables[nodeIdx][curByte];\n\n        if (uCode >= 0) { \n            // Normal character, just use it.\n        }\n        else if (uCode === UNASSIGNED) { // Unknown char.\n            // TODO: Callback with seq.\n            uCode = this.defaultCharUnicode.charCodeAt(0);\n            i = seqStart; // Skip one byte ('i' will be incremented by the for loop) and try to parse again.\n        }\n        else if (uCode === GB18030_CODE) {\n            if (i >= 3) {\n                var ptr = (buf[i-3]-0x81)*12600 + (buf[i-2]-0x30)*1260 + (buf[i-1]-0x81)*10 + (curByte-0x30);\n            } else {\n                var ptr = (prevBytes[i-3+prevOffset]-0x81)*12600 + \n                          (((i-2 >= 0) ? buf[i-2] : prevBytes[i-2+prevOffset])-0x30)*1260 + \n                          (((i-1 >= 0) ? buf[i-1] : prevBytes[i-1+prevOffset])-0x81)*10 + \n                          (curByte-0x30);\n            }\n            var idx = findIdx(this.gb18030.gbChars, ptr);\n            uCode = this.gb18030.uChars[idx] + ptr - this.gb18030.gbChars[idx];\n        }\n        else if (uCode <= NODE_START) { // Go to next trie node.\n            nodeIdx = NODE_START - uCode;\n            continue;\n        }\n        else if (uCode <= SEQ_START) { // Output a sequence of chars.\n            var seq = this.decodeTableSeq[SEQ_START - uCode];\n            for (var k = 0; k < seq.length - 1; k++) {\n                uCode = seq[k];\n                newBuf[j++] = uCode & 0xFF;\n                newBuf[j++] = uCode >> 8;\n            }\n            uCode = seq[seq.length-1];\n        }\n        else\n            throw new Error(\"iconv-lite internal error: invalid decoding table value \" + uCode + \" at \" + nodeIdx + \"/\" + curByte);\n\n        // Write the character to buffer, handling higher planes using surrogate pair.\n        if (uCode >= 0x10000) { \n            uCode -= 0x10000;\n            var uCodeLead = 0xD800 | (uCode >> 10);\n            newBuf[j++] = uCodeLead & 0xFF;\n            newBuf[j++] = uCodeLead >> 8;\n\n            uCode = 0xDC00 | (uCode & 0x3FF);\n        }\n        newBuf[j++] = uCode & 0xFF;\n        newBuf[j++] = uCode >> 8;\n\n        // Reset trie node.\n        nodeIdx = 0; seqStart = i+1;\n    }\n\n    this.nodeIdx = nodeIdx;\n    this.prevBytes = (seqStart >= 0)\n        ? Array.prototype.slice.call(buf, seqStart)\n        : prevBytes.slice(seqStart + prevOffset).concat(Array.prototype.slice.call(buf));\n\n    return newBuf.slice(0, j).toString('ucs2');\n}\n\nDBCSDecoder.prototype.end = function() {\n    var ret = '';\n\n    // Try to parse all remaining chars.\n    while (this.prevBytes.length > 0) {\n        // Skip 1 character in the buffer.\n        ret += this.defaultCharUnicode;\n        var bytesArr = this.prevBytes.slice(1);\n\n        // Parse remaining as usual.\n        this.prevBytes = [];\n        this.nodeIdx = 0;\n        if (bytesArr.length > 0)\n            ret += this.write(bytesArr);\n    }\n\n    this.prevBytes = [];\n    this.nodeIdx = 0;\n    return ret;\n}\n\n// Binary search for GB18030. Returns largest i such that table[i] <= val.\nfunction findIdx(table, val) {\n    if (table[0] > val)\n        return -1;\n\n    var l = 0, r = table.length;\n    while (l < r-1) { // always table[l] <= val < table[r]\n        var mid = l + ((r-l+1) >> 1);\n        if (table[mid] <= val)\n            l = mid;\n        else\n            r = mid;\n    }\n    return l;\n}\n\n","\"use strict\";\n\n// Description of supported double byte encodings and aliases.\n// Tables are not require()-d until they are needed to speed up library load.\n// require()-s are direct to support Browserify.\n\nmodule.exports = {\n    \n    // == Japanese/ShiftJIS ====================================================\n    // All japanese encodings are based on JIS X set of standards:\n    // JIS X 0201 - Single-byte encoding of ASCII +  + Kana chars at 0xA1-0xDF.\n    // JIS X 0208 - Main set of 6879 characters, placed in 94x94 plane, to be encoded by 2 bytes. \n    //              Has several variations in 1978, 1983, 1990 and 1997.\n    // JIS X 0212 - Supplementary plane of 6067 chars in 94x94 plane. 1990. Effectively dead.\n    // JIS X 0213 - Extension and modern replacement of 0208 and 0212. Total chars: 11233.\n    //              2 planes, first is superset of 0208, second - revised 0212.\n    //              Introduced in 2000, revised 2004. Some characters are in Unicode Plane 2 (0x2xxxx)\n\n    // Byte encodings are:\n    //  * Shift_JIS: Compatible with 0201, uses not defined chars in top half as lead bytes for double-byte\n    //               encoding of 0208. Lead byte ranges: 0x81-0x9F, 0xE0-0xEF; Trail byte ranges: 0x40-0x7E, 0x80-0x9E, 0x9F-0xFC.\n    //               Windows CP932 is a superset of Shift_JIS. Some companies added more chars, notably KDDI.\n    //  * EUC-JP:    Up to 3 bytes per character. Used mostly on *nixes.\n    //               0x00-0x7F       - lower part of 0201\n    //               0x8E, 0xA1-0xDF - upper part of 0201\n    //               (0xA1-0xFE)x2   - 0208 plane (94x94).\n    //               0x8F, (0xA1-0xFE)x2 - 0212 plane (94x94).\n    //  * JIS X 208: 7-bit, direct encoding of 0208. Byte ranges: 0x21-0x7E (94 values). Uncommon.\n    //               Used as-is in ISO2022 family.\n    //  * ISO2022-JP: Stateful encoding, with escape sequences to switch between ASCII, \n    //                0201-1976 Roman, 0208-1978, 0208-1983.\n    //  * ISO2022-JP-1: Adds esc seq for 0212-1990.\n    //  * ISO2022-JP-2: Adds esc seq for GB2313-1980, KSX1001-1992, ISO8859-1, ISO8859-7.\n    //  * ISO2022-JP-3: Adds esc seq for 0201-1976 Kana set, 0213-2000 Planes 1, 2.\n    //  * ISO2022-JP-2004: Adds 0213-2004 Plane 1.\n    //\n    // After JIS X 0213 appeared, Shift_JIS-2004, EUC-JISX0213 and ISO2022-JP-2004 followed, with just changing the planes.\n    //\n    // Overall, it seems that it's a mess :( http://www8.plala.or.jp/tkubota1/unicode-symbols-map2.html\n\n    'shiftjis': {\n        type: '_dbcs',\n        table: function() { return require('./tables/shiftjis.json') },\n        encodeAdd: {'\\u00a5': 0x5C, '\\u203E': 0x7E},\n        encodeSkipVals: [{from: 0xED40, to: 0xF940}],\n    },\n    'csshiftjis': 'shiftjis',\n    'mskanji': 'shiftjis',\n    'sjis': 'shiftjis',\n    'windows31j': 'shiftjis',\n    'ms31j': 'shiftjis',\n    'xsjis': 'shiftjis',\n    'windows932': 'shiftjis',\n    'ms932': 'shiftjis',\n    '932': 'shiftjis',\n    'cp932': 'shiftjis',\n\n    'eucjp': {\n        type: '_dbcs',\n        table: function() { return require('./tables/eucjp.json') },\n        encodeAdd: {'\\u00a5': 0x5C, '\\u203E': 0x7E},\n    },\n\n    // TODO: KDDI extension to Shift_JIS\n    // TODO: IBM CCSID 942 = CP932, but F0-F9 custom chars and other char changes.\n    // TODO: IBM CCSID 943 = Shift_JIS = CP932 with original Shift_JIS lower 128 chars.\n\n\n    // == Chinese/GBK ==========================================================\n    // http://en.wikipedia.org/wiki/GBK\n    // We mostly implement W3C recommendation: https://www.w3.org/TR/encoding/#gbk-encoder\n\n    // Oldest GB2312 (1981, ~7600 chars) is a subset of CP936\n    'gb2312': 'cp936',\n    'gb231280': 'cp936',\n    'gb23121980': 'cp936',\n    'csgb2312': 'cp936',\n    'csiso58gb231280': 'cp936',\n    'euccn': 'cp936',\n\n    // Microsoft's CP936 is a subset and approximation of GBK.\n    'windows936': 'cp936',\n    'ms936': 'cp936',\n    '936': 'cp936',\n    'cp936': {\n        type: '_dbcs',\n        table: function() { return require('./tables/cp936.json') },\n    },\n\n    // GBK (~22000 chars) is an extension of CP936 that added user-mapped chars and some other.\n    'gbk': {\n        type: '_dbcs',\n        table: function() { return require('./tables/cp936.json').concat(require('./tables/gbk-added.json')) },\n    },\n    'xgbk': 'gbk',\n    'isoir58': 'gbk',\n\n    // GB18030 is an algorithmic extension of GBK.\n    // Main source: https://www.w3.org/TR/encoding/#gbk-encoder\n    // http://icu-project.org/docs/papers/gb18030.html\n    // http://source.icu-project.org/repos/icu/data/trunk/charset/data/xml/gb-18030-2000.xml\n    // http://www.khngai.com/chinese/charmap/tblgbk.php?page=0\n    'gb18030': {\n        type: '_dbcs',\n        table: function() { return require('./tables/cp936.json').concat(require('./tables/gbk-added.json')) },\n        gb18030: function() { return require('./tables/gb18030-ranges.json') },\n        encodeSkipVals: [0x80],\n        encodeAdd: {'': 0xA2E3},\n    },\n\n    'chinese': 'gb18030',\n\n\n    // == Korean ===============================================================\n    // EUC-KR, KS_C_5601 and KS X 1001 are exactly the same.\n    'windows949': 'cp949',\n    'ms949': 'cp949',\n    '949': 'cp949',\n    'cp949': {\n        type: '_dbcs',\n        table: function() { return require('./tables/cp949.json') },\n    },\n\n    'cseuckr': 'cp949',\n    'csksc56011987': 'cp949',\n    'euckr': 'cp949',\n    'isoir149': 'cp949',\n    'korean': 'cp949',\n    'ksc56011987': 'cp949',\n    'ksc56011989': 'cp949',\n    'ksc5601': 'cp949',\n\n\n    // == Big5/Taiwan/Hong Kong ================================================\n    // There are lots of tables for Big5 and cp950. Please see the following links for history:\n    // http://moztw.org/docs/big5/  http://www.haible.de/bruno/charsets/conversion-tables/Big5.html\n    // Variations, in roughly number of defined chars:\n    //  * Windows CP 950: Microsoft variant of Big5. Canonical: http://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/WINDOWS/CP950.TXT\n    //  * Windows CP 951: Microsoft variant of Big5-HKSCS-2001. Seems to be never public. http://me.abelcheung.org/articles/research/what-is-cp951/\n    //  * Big5-2003 (Taiwan standard) almost superset of cp950.\n    //  * Unicode-at-on (UAO) / Mozilla 1.8. Falling out of use on the Web. Not supported by other browsers.\n    //  * Big5-HKSCS (-2001, -2004, -2008). Hong Kong standard. \n    //    many unicode code points moved from PUA to Supplementary plane (U+2XXXX) over the years.\n    //    Plus, it has 4 combining sequences.\n    //    Seems that Mozilla refused to support it for 10 yrs. https://bugzilla.mozilla.org/show_bug.cgi?id=162431 https://bugzilla.mozilla.org/show_bug.cgi?id=310299\n    //    because big5-hkscs is the only encoding to include astral characters in non-algorithmic way.\n    //    Implementations are not consistent within browsers; sometimes labeled as just big5.\n    //    MS Internet Explorer switches from big5 to big5-hkscs when a patch applied.\n    //    Great discussion & recap of what's going on https://bugzilla.mozilla.org/show_bug.cgi?id=912470#c31\n    //    In the encoder, it might make sense to support encoding old PUA mappings to Big5 bytes seq-s.\n    //    Official spec: http://www.ogcio.gov.hk/en/business/tech_promotion/ccli/terms/doc/2003cmp_2008.txt\n    //                   http://www.ogcio.gov.hk/tc/business/tech_promotion/ccli/terms/doc/hkscs-2008-big5-iso.txt\n    // \n    // Current understanding of how to deal with Big5(-HKSCS) is in the Encoding Standard, http://encoding.spec.whatwg.org/#big5-encoder\n    // Unicode mapping (http://www.unicode.org/Public/MAPPINGS/OBSOLETE/EASTASIA/OTHER/BIG5.TXT) is said to be wrong.\n\n    'windows950': 'cp950',\n    'ms950': 'cp950',\n    '950': 'cp950',\n    'cp950': {\n        type: '_dbcs',\n        table: function() { return require('./tables/cp950.json') },\n    },\n\n    // Big5 has many variations and is an extension of cp950. We use Encoding Standard's as a consensus.\n    'big5': 'big5hkscs',\n    'big5hkscs': {\n        type: '_dbcs',\n        table: function() { return require('./tables/cp950.json').concat(require('./tables/big5-added.json')) },\n        encodeSkipVals: [\n            // Although Encoding Standard says we should avoid encoding to HKSCS area (See Step 1 of\n            // https://encoding.spec.whatwg.org/#index-big5-pointer), we still do it to increase compatibility with ICU.\n            // But if a single unicode point can be encoded both as HKSCS and regular Big5, we prefer the latter.\n            0x8e69, 0x8e6f, 0x8e7e, 0x8eab, 0x8eb4, 0x8ecd, 0x8ed0, 0x8f57, 0x8f69, 0x8f6e, 0x8fcb, 0x8ffe,\n            0x906d, 0x907a, 0x90c4, 0x90dc, 0x90f1, 0x91bf, 0x92af, 0x92b0, 0x92b1, 0x92b2, 0x92d1, 0x9447, 0x94ca,\n            0x95d9, 0x96fc, 0x9975, 0x9b76, 0x9b78, 0x9b7b, 0x9bc6, 0x9bde, 0x9bec, 0x9bf6, 0x9c42, 0x9c53, 0x9c62,\n            0x9c68, 0x9c6b, 0x9c77, 0x9cbc, 0x9cbd, 0x9cd0, 0x9d57, 0x9d5a, 0x9dc4, 0x9def, 0x9dfb, 0x9ea9, 0x9eef,\n            0x9efd, 0x9f60, 0x9fcb, 0xa077, 0xa0dc, 0xa0df, 0x8fcc, 0x92c8, 0x9644, 0x96ed,\n\n            // Step 2 of https://encoding.spec.whatwg.org/#index-big5-pointer: Use last pointer for U+2550, U+255E, U+2561, U+256A, U+5341, or U+5345\n            0xa2a4, 0xa2a5, 0xa2a7, 0xa2a6, 0xa2cc, 0xa2ce,\n        ],\n    },\n\n    'cnbig5': 'big5hkscs',\n    'csbig5': 'big5hkscs',\n    'xxbig5': 'big5hkscs',\n};\n","\"use strict\";\n\n// Update this array if you add/rename/remove files in this directory.\n// We support Browserify by skipping automatic module discovery and requiring modules directly.\nvar modules = [\n    require(\"./internal\"),\n    require(\"./utf32\"),\n    require(\"./utf16\"),\n    require(\"./utf7\"),\n    require(\"./sbcs-codec\"),\n    require(\"./sbcs-data\"),\n    require(\"./sbcs-data-generated\"),\n    require(\"./dbcs-codec\"),\n    require(\"./dbcs-data\"),\n];\n\n// Put all encoding/alias/codec definitions to single object and export it.\nfor (var i = 0; i < modules.length; i++) {\n    var module = modules[i];\n    for (var enc in module)\n        if (Object.prototype.hasOwnProperty.call(module, enc))\n            exports[enc] = module[enc];\n}\n","\"use strict\";\nvar Buffer = require(\"safer-buffer\").Buffer;\n\n// Export Node.js internal encodings.\n\nmodule.exports = {\n    // Encodings\n    utf8:   { type: \"_internal\", bomAware: true},\n    cesu8:  { type: \"_internal\", bomAware: true},\n    unicode11utf8: \"utf8\",\n\n    ucs2:   { type: \"_internal\", bomAware: true},\n    utf16le: \"ucs2\",\n\n    binary: { type: \"_internal\" },\n    base64: { type: \"_internal\" },\n    hex:    { type: \"_internal\" },\n\n    // Codec.\n    _internal: InternalCodec,\n};\n\n//------------------------------------------------------------------------------\n\nfunction InternalCodec(codecOptions, iconv) {\n    this.enc = codecOptions.encodingName;\n    this.bomAware = codecOptions.bomAware;\n\n    if (this.enc === \"base64\")\n        this.encoder = InternalEncoderBase64;\n    else if (this.enc === \"cesu8\") {\n        this.enc = \"utf8\"; // Use utf8 for decoding.\n        this.encoder = InternalEncoderCesu8;\n\n        // Add decoder for versions of Node not supporting CESU-8\n        if (Buffer.from('eda0bdedb2a9', 'hex').toString() !== '') {\n            this.decoder = InternalDecoderCesu8;\n            this.defaultCharUnicode = iconv.defaultCharUnicode;\n        }\n    }\n}\n\nInternalCodec.prototype.encoder = InternalEncoder;\nInternalCodec.prototype.decoder = InternalDecoder;\n\n//------------------------------------------------------------------------------\n\n// We use node.js internal decoder. Its signature is the same as ours.\nvar StringDecoder = require('string_decoder').StringDecoder;\n\nif (!StringDecoder.prototype.end) // Node v0.8 doesn't have this method.\n    StringDecoder.prototype.end = function() {};\n\n\nfunction InternalDecoder(options, codec) {\n    this.decoder = new StringDecoder(codec.enc);\n}\n\nInternalDecoder.prototype.write = function(buf) {\n    if (!Buffer.isBuffer(buf)) {\n        buf = Buffer.from(buf);\n    }\n\n    return this.decoder.write(buf);\n}\n\nInternalDecoder.prototype.end = function() {\n    return this.decoder.end();\n}\n\n\n//------------------------------------------------------------------------------\n// Encoder is mostly trivial\n\nfunction InternalEncoder(options, codec) {\n    this.enc = codec.enc;\n}\n\nInternalEncoder.prototype.write = function(str) {\n    return Buffer.from(str, this.enc);\n}\n\nInternalEncoder.prototype.end = function() {\n}\n\n\n//------------------------------------------------------------------------------\n// Except base64 encoder, which must keep its state.\n\nfunction InternalEncoderBase64(options, codec) {\n    this.prevStr = '';\n}\n\nInternalEncoderBase64.prototype.write = function(str) {\n    str = this.prevStr + str;\n    var completeQuads = str.length - (str.length % 4);\n    this.prevStr = str.slice(completeQuads);\n    str = str.slice(0, completeQuads);\n\n    return Buffer.from(str, \"base64\");\n}\n\nInternalEncoderBase64.prototype.end = function() {\n    return Buffer.from(this.prevStr, \"base64\");\n}\n\n\n//------------------------------------------------------------------------------\n// CESU-8 encoder is also special.\n\nfunction InternalEncoderCesu8(options, codec) {\n}\n\nInternalEncoderCesu8.prototype.write = function(str) {\n    var buf = Buffer.alloc(str.length * 3), bufIdx = 0;\n    for (var i = 0; i < str.length; i++) {\n        var charCode = str.charCodeAt(i);\n        // Naive implementation, but it works because CESU-8 is especially easy\n        // to convert from UTF-16 (which all JS strings are encoded in).\n        if (charCode < 0x80)\n            buf[bufIdx++] = charCode;\n        else if (charCode < 0x800) {\n            buf[bufIdx++] = 0xC0 + (charCode >>> 6);\n            buf[bufIdx++] = 0x80 + (charCode & 0x3f);\n        }\n        else { // charCode will always be < 0x10000 in javascript.\n            buf[bufIdx++] = 0xE0 + (charCode >>> 12);\n            buf[bufIdx++] = 0x80 + ((charCode >>> 6) & 0x3f);\n            buf[bufIdx++] = 0x80 + (charCode & 0x3f);\n        }\n    }\n    return buf.slice(0, bufIdx);\n}\n\nInternalEncoderCesu8.prototype.end = function() {\n}\n\n//------------------------------------------------------------------------------\n// CESU-8 decoder is not implemented in Node v4.0+\n\nfunction InternalDecoderCesu8(options, codec) {\n    this.acc = 0;\n    this.contBytes = 0;\n    this.accBytes = 0;\n    this.defaultCharUnicode = codec.defaultCharUnicode;\n}\n\nInternalDecoderCesu8.prototype.write = function(buf) {\n    var acc = this.acc, contBytes = this.contBytes, accBytes = this.accBytes, \n        res = '';\n    for (var i = 0; i < buf.length; i++) {\n        var curByte = buf[i];\n        if ((curByte & 0xC0) !== 0x80) { // Leading byte\n            if (contBytes > 0) { // Previous code is invalid\n                res += this.defaultCharUnicode;\n                contBytes = 0;\n            }\n\n            if (curByte < 0x80) { // Single-byte code\n                res += String.fromCharCode(curByte);\n            } else if (curByte < 0xE0) { // Two-byte code\n                acc = curByte & 0x1F;\n                contBytes = 1; accBytes = 1;\n            } else if (curByte < 0xF0) { // Three-byte code\n                acc = curByte & 0x0F;\n                contBytes = 2; accBytes = 1;\n            } else { // Four or more are not supported for CESU-8.\n                res += this.defaultCharUnicode;\n            }\n        } else { // Continuation byte\n            if (contBytes > 0) { // We're waiting for it.\n                acc = (acc << 6) | (curByte & 0x3f);\n                contBytes--; accBytes++;\n                if (contBytes === 0) {\n                    // Check for overlong encoding, but support Modified UTF-8 (encoding NULL as C0 80)\n                    if (accBytes === 2 && acc < 0x80 && acc > 0)\n                        res += this.defaultCharUnicode;\n                    else if (accBytes === 3 && acc < 0x800)\n                        res += this.defaultCharUnicode;\n                    else\n                        // Actually add character.\n                        res += String.fromCharCode(acc);\n                }\n            } else { // Unexpected continuation byte\n                res += this.defaultCharUnicode;\n            }\n        }\n    }\n    this.acc = acc; this.contBytes = contBytes; this.accBytes = accBytes;\n    return res;\n}\n\nInternalDecoderCesu8.prototype.end = function() {\n    var res = 0;\n    if (this.contBytes > 0)\n        res += this.defaultCharUnicode;\n    return res;\n}\n","\"use strict\";\nvar Buffer = require(\"safer-buffer\").Buffer;\n\n// Single-byte codec. Needs a 'chars' string parameter that contains 256 or 128 chars that\n// correspond to encoded bytes (if 128 - then lower half is ASCII). \n\nexports._sbcs = SBCSCodec;\nfunction SBCSCodec(codecOptions, iconv) {\n    if (!codecOptions)\n        throw new Error(\"SBCS codec is called without the data.\")\n    \n    // Prepare char buffer for decoding.\n    if (!codecOptions.chars || (codecOptions.chars.length !== 128 && codecOptions.chars.length !== 256))\n        throw new Error(\"Encoding '\"+codecOptions.type+\"' has incorrect 'chars' (must be of len 128 or 256)\");\n    \n    if (codecOptions.chars.length === 128) {\n        var asciiString = \"\";\n        for (var i = 0; i < 128; i++)\n            asciiString += String.fromCharCode(i);\n        codecOptions.chars = asciiString + codecOptions.chars;\n    }\n\n    this.decodeBuf = Buffer.from(codecOptions.chars, 'ucs2');\n    \n    // Encoding buffer.\n    var encodeBuf = Buffer.alloc(65536, iconv.defaultCharSingleByte.charCodeAt(0));\n\n    for (var i = 0; i < codecOptions.chars.length; i++)\n        encodeBuf[codecOptions.chars.charCodeAt(i)] = i;\n\n    this.encodeBuf = encodeBuf;\n}\n\nSBCSCodec.prototype.encoder = SBCSEncoder;\nSBCSCodec.prototype.decoder = SBCSDecoder;\n\n\nfunction SBCSEncoder(options, codec) {\n    this.encodeBuf = codec.encodeBuf;\n}\n\nSBCSEncoder.prototype.write = function(str) {\n    var buf = Buffer.alloc(str.length);\n    for (var i = 0; i < str.length; i++)\n        buf[i] = this.encodeBuf[str.charCodeAt(i)];\n    \n    return buf;\n}\n\nSBCSEncoder.prototype.end = function() {\n}\n\n\nfunction SBCSDecoder(options, codec) {\n    this.decodeBuf = codec.decodeBuf;\n}\n\nSBCSDecoder.prototype.write = function(buf) {\n    // Strings are immutable in JS -> we use ucs2 buffer to speed up computations.\n    var decodeBuf = this.decodeBuf;\n    var newBuf = Buffer.alloc(buf.length*2);\n    var idx1 = 0, idx2 = 0;\n    for (var i = 0; i < buf.length; i++) {\n        idx1 = buf[i]*2; idx2 = i*2;\n        newBuf[idx2] = decodeBuf[idx1];\n        newBuf[idx2+1] = decodeBuf[idx1+1];\n    }\n    return newBuf.toString('ucs2');\n}\n\nSBCSDecoder.prototype.end = function() {\n}\n","\"use strict\";\n\n// Generated data for sbcs codec. Don't edit manually. Regenerate using generation/gen-sbcs.js script.\nmodule.exports = {\n  \"437\": \"cp437\",\n  \"737\": \"cp737\",\n  \"775\": \"cp775\",\n  \"850\": \"cp850\",\n  \"852\": \"cp852\",\n  \"855\": \"cp855\",\n  \"856\": \"cp856\",\n  \"857\": \"cp857\",\n  \"858\": \"cp858\",\n  \"860\": \"cp860\",\n  \"861\": \"cp861\",\n  \"862\": \"cp862\",\n  \"863\": \"cp863\",\n  \"864\": \"cp864\",\n  \"865\": \"cp865\",\n  \"866\": \"cp866\",\n  \"869\": \"cp869\",\n  \"874\": \"windows874\",\n  \"922\": \"cp922\",\n  \"1046\": \"cp1046\",\n  \"1124\": \"cp1124\",\n  \"1125\": \"cp1125\",\n  \"1129\": \"cp1129\",\n  \"1133\": \"cp1133\",\n  \"1161\": \"cp1161\",\n  \"1162\": \"cp1162\",\n  \"1163\": \"cp1163\",\n  \"1250\": \"windows1250\",\n  \"1251\": \"windows1251\",\n  \"1252\": \"windows1252\",\n  \"1253\": \"windows1253\",\n  \"1254\": \"windows1254\",\n  \"1255\": \"windows1255\",\n  \"1256\": \"windows1256\",\n  \"1257\": \"windows1257\",\n  \"1258\": \"windows1258\",\n  \"28591\": \"iso88591\",\n  \"28592\": \"iso88592\",\n  \"28593\": \"iso88593\",\n  \"28594\": \"iso88594\",\n  \"28595\": \"iso88595\",\n  \"28596\": \"iso88596\",\n  \"28597\": \"iso88597\",\n  \"28598\": \"iso88598\",\n  \"28599\": \"iso88599\",\n  \"28600\": \"iso885910\",\n  \"28601\": \"iso885911\",\n  \"28603\": \"iso885913\",\n  \"28604\": \"iso885914\",\n  \"28605\": \"iso885915\",\n  \"28606\": \"iso885916\",\n  \"windows874\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win874\": \"windows874\",\n  \"cp874\": \"windows874\",\n  \"windows1250\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1250\": \"windows1250\",\n  \"cp1250\": \"windows1250\",\n  \"windows1251\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1251\": \"windows1251\",\n  \"cp1251\": \"windows1251\",\n  \"windows1252\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1252\": \"windows1252\",\n  \"cp1252\": \"windows1252\",\n  \"windows1253\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1253\": \"windows1253\",\n  \"cp1253\": \"windows1253\",\n  \"windows1254\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1254\": \"windows1254\",\n  \"cp1254\": \"windows1254\",\n  \"windows1255\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1255\": \"windows1255\",\n  \"cp1255\": \"windows1255\",\n  \"windows1256\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1256\": \"windows1256\",\n  \"cp1256\": \"windows1256\",\n  \"windows1257\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1257\": \"windows1257\",\n  \"cp1257\": \"windows1257\",\n  \"windows1258\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1258\": \"windows1258\",\n  \"cp1258\": \"windows1258\",\n  \"iso88591\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28591\": \"iso88591\",\n  \"iso88592\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28592\": \"iso88592\",\n  \"iso88593\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28593\": \"iso88593\",\n  \"iso88594\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28594\": \"iso88594\",\n  \"iso88595\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28595\": \"iso88595\",\n  \"iso88596\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28596\": \"iso88596\",\n  \"iso88597\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28597\": \"iso88597\",\n  \"iso88598\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28598\": \"iso88598\",\n  \"iso88599\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28599\": \"iso88599\",\n  \"iso885910\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28600\": \"iso885910\",\n  \"iso885911\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28601\": \"iso885911\",\n  \"iso885913\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28603\": \"iso885913\",\n  \"iso885914\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28604\": \"iso885914\",\n  \"iso885915\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28605\": \"iso885915\",\n  \"iso885916\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28606\": \"iso885916\",\n  \"cp437\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm437\": \"cp437\",\n  \"csibm437\": \"cp437\",\n  \"cp737\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm737\": \"cp737\",\n  \"csibm737\": \"cp737\",\n  \"cp775\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm775\": \"cp775\",\n  \"csibm775\": \"cp775\",\n  \"cp850\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm850\": \"cp850\",\n  \"csibm850\": \"cp850\",\n  \"cp852\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm852\": \"cp852\",\n  \"csibm852\": \"cp852\",\n  \"cp855\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm855\": \"cp855\",\n  \"csibm855\": \"cp855\",\n  \"cp856\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm856\": \"cp856\",\n  \"csibm856\": \"cp856\",\n  \"cp857\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm857\": \"cp857\",\n  \"csibm857\": \"cp857\",\n  \"cp858\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm858\": \"cp858\",\n  \"csibm858\": \"cp858\",\n  \"cp860\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm860\": \"cp860\",\n  \"csibm860\": \"cp860\",\n  \"cp861\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm861\": \"cp861\",\n  \"csibm861\": \"cp861\",\n  \"cp862\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm862\": \"cp862\",\n  \"csibm862\": \"cp862\",\n  \"cp863\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm863\": \"cp863\",\n  \"csibm863\": \"cp863\",\n  \"cp864\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\"\n  },\n  \"ibm864\": \"cp864\",\n  \"csibm864\": \"cp864\",\n  \"cp865\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm865\": \"cp865\",\n  \"csibm865\": \"cp865\",\n  \"cp866\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm866\": \"cp866\",\n  \"csibm866\": \"cp866\",\n  \"cp869\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm869\": \"cp869\",\n  \"csibm869\": \"cp869\",\n  \"cp922\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm922\": \"cp922\",\n  \"csibm922\": \"cp922\",\n  \"cp1046\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm1046\": \"cp1046\",\n  \"csibm1046\": \"cp1046\",\n  \"cp1124\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm1124\": \"cp1124\",\n  \"csibm1124\": \"cp1124\",\n  \"cp1125\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm1125\": \"cp1125\",\n  \"csibm1125\": \"cp1125\",\n  \"cp1129\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm1129\": \"cp1129\",\n  \"csibm1129\": \"cp1129\",\n  \"cp1133\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm1133\": \"cp1133\",\n  \"csibm1133\": \"cp1133\",\n  \"cp1161\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm1161\": \"cp1161\",\n  \"csibm1161\": \"cp1161\",\n  \"cp1162\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm1162\": \"cp1162\",\n  \"csibm1162\": \"cp1162\",\n  \"cp1163\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm1163\": \"cp1163\",\n  \"csibm1163\": \"cp1163\",\n  \"maccroatian\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"maccyrillic\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"macgreek\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"maciceland\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"macroman\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"macromania\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"macthai\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"macturkish\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"macukraine\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"koi8r\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"koi8u\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"koi8ru\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"koi8t\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"armscii8\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \")(.,-\"\n  },\n  \"rk1048\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"tcvn\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\\u0000\\u0003\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\"\n  },\n  \"georgianacademy\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"georgianps\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"pt154\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"viscii\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\\u0000\\u0001\\u0003\\u0004\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0015\\u0016\\u0017\\u0018\\u001a\\u001b\\u001c\\u001d\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\"\n  },\n  \"iso646cn\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}\"\n  },\n  \"iso646jp\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}\"\n  },\n  \"hproman8\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"macintosh\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ascii\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"tis620\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  }\n}","\"use strict\";\n\n// Manually added data to be used by sbcs codec in addition to generated one.\n\nmodule.exports = {\n    // Not supported by iconv, not sure why.\n    \"10029\": \"maccenteuro\",\n    \"maccenteuro\": {\n        \"type\": \"_sbcs\",\n        \"chars\": \"\"\n    },\n\n    \"808\": \"cp808\",\n    \"ibm808\": \"cp808\",\n    \"cp808\": {\n        \"type\": \"_sbcs\",\n        \"chars\": \"\"\n    },\n\n    \"mik\": {\n        \"type\": \"_sbcs\",\n        \"chars\": \"\"\n    },\n\n    \"cp720\": {\n        \"type\": \"_sbcs\",\n        \"chars\": \"\\x80\\x81\\x84\\x86\\x8d\\x8e\\x8f\\x90\\u0651\\u0652\\u064b\\u064c\\u064d\\u064e\\u064f\\u0650\\u00a0\"\n    },\n\n    // Aliases of generated encodings.\n    \"ascii8bit\": \"ascii\",\n    \"usascii\": \"ascii\",\n    \"ansix34\": \"ascii\",\n    \"ansix341968\": \"ascii\",\n    \"ansix341986\": \"ascii\",\n    \"csascii\": \"ascii\",\n    \"cp367\": \"ascii\",\n    \"ibm367\": \"ascii\",\n    \"isoir6\": \"ascii\",\n    \"iso646us\": \"ascii\",\n    \"iso646irv\": \"ascii\",\n    \"us\": \"ascii\",\n\n    \"latin1\": \"iso88591\",\n    \"latin2\": \"iso88592\",\n    \"latin3\": \"iso88593\",\n    \"latin4\": \"iso88594\",\n    \"latin5\": \"iso88599\",\n    \"latin6\": \"iso885910\",\n    \"latin7\": \"iso885913\",\n    \"latin8\": \"iso885914\",\n    \"latin9\": \"iso885915\",\n    \"latin10\": \"iso885916\",\n\n    \"csisolatin1\": \"iso88591\",\n    \"csisolatin2\": \"iso88592\",\n    \"csisolatin3\": \"iso88593\",\n    \"csisolatin4\": \"iso88594\",\n    \"csisolatincyrillic\": \"iso88595\",\n    \"csisolatinarabic\": \"iso88596\",\n    \"csisolatingreek\" : \"iso88597\",\n    \"csisolatinhebrew\": \"iso88598\",\n    \"csisolatin5\": \"iso88599\",\n    \"csisolatin6\": \"iso885910\",\n\n    \"l1\": \"iso88591\",\n    \"l2\": \"iso88592\",\n    \"l3\": \"iso88593\",\n    \"l4\": \"iso88594\",\n    \"l5\": \"iso88599\",\n    \"l6\": \"iso885910\",\n    \"l7\": \"iso885913\",\n    \"l8\": \"iso885914\",\n    \"l9\": \"iso885915\",\n    \"l10\": \"iso885916\",\n\n    \"isoir14\": \"iso646jp\",\n    \"isoir57\": \"iso646cn\",\n    \"isoir100\": \"iso88591\",\n    \"isoir101\": \"iso88592\",\n    \"isoir109\": \"iso88593\",\n    \"isoir110\": \"iso88594\",\n    \"isoir144\": \"iso88595\",\n    \"isoir127\": \"iso88596\",\n    \"isoir126\": \"iso88597\",\n    \"isoir138\": \"iso88598\",\n    \"isoir148\": \"iso88599\",\n    \"isoir157\": \"iso885910\",\n    \"isoir166\": \"tis620\",\n    \"isoir179\": \"iso885913\",\n    \"isoir199\": \"iso885914\",\n    \"isoir203\": \"iso885915\",\n    \"isoir226\": \"iso885916\",\n\n    \"cp819\": \"iso88591\",\n    \"ibm819\": \"iso88591\",\n\n    \"cyrillic\": \"iso88595\",\n\n    \"arabic\": \"iso88596\",\n    \"arabic8\": \"iso88596\",\n    \"ecma114\": \"iso88596\",\n    \"asmo708\": \"iso88596\",\n\n    \"greek\" : \"iso88597\",\n    \"greek8\" : \"iso88597\",\n    \"ecma118\" : \"iso88597\",\n    \"elot928\" : \"iso88597\",\n\n    \"hebrew\": \"iso88598\",\n    \"hebrew8\": \"iso88598\",\n\n    \"turkish\": \"iso88599\",\n    \"turkish8\": \"iso88599\",\n\n    \"thai\": \"iso885911\",\n    \"thai8\": \"iso885911\",\n\n    \"celtic\": \"iso885914\",\n    \"celtic8\": \"iso885914\",\n    \"isoceltic\": \"iso885914\",\n\n    \"tis6200\": \"tis620\",\n    \"tis62025291\": \"tis620\",\n    \"tis62025330\": \"tis620\",\n\n    \"10000\": \"macroman\",\n    \"10006\": \"macgreek\",\n    \"10007\": \"maccyrillic\",\n    \"10079\": \"maciceland\",\n    \"10081\": \"macturkish\",\n\n    \"cspc8codepage437\": \"cp437\",\n    \"cspc775baltic\": \"cp775\",\n    \"cspc850multilingual\": \"cp850\",\n    \"cspcp852\": \"cp852\",\n    \"cspc862latinhebrew\": \"cp862\",\n    \"cpgr\": \"cp869\",\n\n    \"msee\": \"cp1250\",\n    \"mscyrl\": \"cp1251\",\n    \"msansi\": \"cp1252\",\n    \"msgreek\": \"cp1253\",\n    \"msturk\": \"cp1254\",\n    \"mshebr\": \"cp1255\",\n    \"msarab\": \"cp1256\",\n    \"winbaltrim\": \"cp1257\",\n\n    \"cp20866\": \"koi8r\",\n    \"20866\": \"koi8r\",\n    \"ibm878\": \"koi8r\",\n    \"cskoi8r\": \"koi8r\",\n\n    \"cp21866\": \"koi8u\",\n    \"21866\": \"koi8u\",\n    \"ibm1168\": \"koi8u\",\n\n    \"strk10482002\": \"rk1048\",\n\n    \"tcvn5712\": \"tcvn\",\n    \"tcvn57121\": \"tcvn\",\n\n    \"gb198880\": \"iso646cn\",\n    \"cn\": \"iso646cn\",\n\n    \"csiso14jisc6220ro\": \"iso646jp\",\n    \"jisc62201969ro\": \"iso646jp\",\n    \"jp\": \"iso646jp\",\n\n    \"cshproman8\": \"hproman8\",\n    \"r8\": \"hproman8\",\n    \"roman8\": \"hproman8\",\n    \"xroman8\": \"hproman8\",\n    \"ibm1051\": \"hproman8\",\n\n    \"mac\": \"macintosh\",\n    \"csmacintosh\": \"macintosh\",\n};\n\n","\"use strict\";\nvar Buffer = require(\"safer-buffer\").Buffer;\n\n// Note: UTF16-LE (or UCS2) codec is Node.js native. See encodings/internal.js\n\n// == UTF16-BE codec. ==========================================================\n\nexports.utf16be = Utf16BECodec;\nfunction Utf16BECodec() {\n}\n\nUtf16BECodec.prototype.encoder = Utf16BEEncoder;\nUtf16BECodec.prototype.decoder = Utf16BEDecoder;\nUtf16BECodec.prototype.bomAware = true;\n\n\n// -- Encoding\n\nfunction Utf16BEEncoder() {\n}\n\nUtf16BEEncoder.prototype.write = function(str) {\n    var buf = Buffer.from(str, 'ucs2');\n    for (var i = 0; i < buf.length; i += 2) {\n        var tmp = buf[i]; buf[i] = buf[i+1]; buf[i+1] = tmp;\n    }\n    return buf;\n}\n\nUtf16BEEncoder.prototype.end = function() {\n}\n\n\n// -- Decoding\n\nfunction Utf16BEDecoder() {\n    this.overflowByte = -1;\n}\n\nUtf16BEDecoder.prototype.write = function(buf) {\n    if (buf.length == 0)\n        return '';\n\n    var buf2 = Buffer.alloc(buf.length + 1),\n        i = 0, j = 0;\n\n    if (this.overflowByte !== -1) {\n        buf2[0] = buf[0];\n        buf2[1] = this.overflowByte;\n        i = 1; j = 2;\n    }\n\n    for (; i < buf.length-1; i += 2, j+= 2) {\n        buf2[j] = buf[i+1];\n        buf2[j+1] = buf[i];\n    }\n\n    this.overflowByte = (i == buf.length-1) ? buf[buf.length-1] : -1;\n\n    return buf2.slice(0, j).toString('ucs2');\n}\n\nUtf16BEDecoder.prototype.end = function() {\n    this.overflowByte = -1;\n}\n\n\n// == UTF-16 codec =============================================================\n// Decoder chooses automatically from UTF-16LE and UTF-16BE using BOM and space-based heuristic.\n// Defaults to UTF-16LE, as it's prevalent and default in Node.\n// http://en.wikipedia.org/wiki/UTF-16 and http://encoding.spec.whatwg.org/#utf-16le\n// Decoder default can be changed: iconv.decode(buf, 'utf16', {defaultEncoding: 'utf-16be'});\n\n// Encoder uses UTF-16LE and prepends BOM (which can be overridden with addBOM: false).\n\nexports.utf16 = Utf16Codec;\nfunction Utf16Codec(codecOptions, iconv) {\n    this.iconv = iconv;\n}\n\nUtf16Codec.prototype.encoder = Utf16Encoder;\nUtf16Codec.prototype.decoder = Utf16Decoder;\n\n\n// -- Encoding (pass-through)\n\nfunction Utf16Encoder(options, codec) {\n    options = options || {};\n    if (options.addBOM === undefined)\n        options.addBOM = true;\n    this.encoder = codec.iconv.getEncoder('utf-16le', options);\n}\n\nUtf16Encoder.prototype.write = function(str) {\n    return this.encoder.write(str);\n}\n\nUtf16Encoder.prototype.end = function() {\n    return this.encoder.end();\n}\n\n\n// -- Decoding\n\nfunction Utf16Decoder(options, codec) {\n    this.decoder = null;\n    this.initialBufs = [];\n    this.initialBufsLen = 0;\n\n    this.options = options || {};\n    this.iconv = codec.iconv;\n}\n\nUtf16Decoder.prototype.write = function(buf) {\n    if (!this.decoder) {\n        // Codec is not chosen yet. Accumulate initial bytes.\n        this.initialBufs.push(buf);\n        this.initialBufsLen += buf.length;\n        \n        if (this.initialBufsLen < 16) // We need more bytes to use space heuristic (see below)\n            return '';\n\n        // We have enough bytes -> detect endianness.\n        var encoding = detectEncoding(this.initialBufs, this.options.defaultEncoding);\n        this.decoder = this.iconv.getDecoder(encoding, this.options);\n\n        var resStr = '';\n        for (var i = 0; i < this.initialBufs.length; i++)\n            resStr += this.decoder.write(this.initialBufs[i]);\n\n        this.initialBufs.length = this.initialBufsLen = 0;\n        return resStr;\n    }\n\n    return this.decoder.write(buf);\n}\n\nUtf16Decoder.prototype.end = function() {\n    if (!this.decoder) {\n        var encoding = detectEncoding(this.initialBufs, this.options.defaultEncoding);\n        this.decoder = this.iconv.getDecoder(encoding, this.options);\n\n        var resStr = '';\n        for (var i = 0; i < this.initialBufs.length; i++)\n            resStr += this.decoder.write(this.initialBufs[i]);\n\n        var trail = this.decoder.end();\n        if (trail)\n            resStr += trail;\n\n        this.initialBufs.length = this.initialBufsLen = 0;\n        return resStr;\n    }\n    return this.decoder.end();\n}\n\nfunction detectEncoding(bufs, defaultEncoding) {\n    var b = [];\n    var charsProcessed = 0;\n    var asciiCharsLE = 0, asciiCharsBE = 0; // Number of ASCII chars when decoded as LE or BE.\n\n    outer_loop:\n    for (var i = 0; i < bufs.length; i++) {\n        var buf = bufs[i];\n        for (var j = 0; j < buf.length; j++) {\n            b.push(buf[j]);\n            if (b.length === 2) {\n                if (charsProcessed === 0) {\n                    // Check BOM first.\n                    if (b[0] === 0xFF && b[1] === 0xFE) return 'utf-16le';\n                    if (b[0] === 0xFE && b[1] === 0xFF) return 'utf-16be';\n                }\n\n                if (b[0] === 0 && b[1] !== 0) asciiCharsBE++;\n                if (b[0] !== 0 && b[1] === 0) asciiCharsLE++;\n\n                b.length = 0;\n                charsProcessed++;\n\n                if (charsProcessed >= 100) {\n                    break outer_loop;\n                }\n            }\n        }\n    }\n\n    // Make decisions.\n    // Most of the time, the content has ASCII chars (U+00**), but the opposite (U+**00) is uncommon.\n    // So, we count ASCII as if it was LE or BE, and decide from that.\n    if (asciiCharsBE > asciiCharsLE) return 'utf-16be';\n    if (asciiCharsBE < asciiCharsLE) return 'utf-16le';\n\n    // Couldn't decide (likely all zeros or not enough data).\n    return defaultEncoding || 'utf-16le';\n}\n\n\n","'use strict';\n\nvar Buffer = require('safer-buffer').Buffer;\n\n// == UTF32-LE/BE codec. ==========================================================\n\nexports._utf32 = Utf32Codec;\n\nfunction Utf32Codec(codecOptions, iconv) {\n    this.iconv = iconv;\n    this.bomAware = true;\n    this.isLE = codecOptions.isLE;\n}\n\nexports.utf32le = { type: '_utf32', isLE: true };\nexports.utf32be = { type: '_utf32', isLE: false };\n\n// Aliases\nexports.ucs4le = 'utf32le';\nexports.ucs4be = 'utf32be';\n\nUtf32Codec.prototype.encoder = Utf32Encoder;\nUtf32Codec.prototype.decoder = Utf32Decoder;\n\n// -- Encoding\n\nfunction Utf32Encoder(options, codec) {\n    this.isLE = codec.isLE;\n    this.highSurrogate = 0;\n}\n\nUtf32Encoder.prototype.write = function(str) {\n    var src = Buffer.from(str, 'ucs2');\n    var dst = Buffer.alloc(src.length * 2);\n    var write32 = this.isLE ? dst.writeUInt32LE : dst.writeUInt32BE;\n    var offset = 0;\n\n    for (var i = 0; i < src.length; i += 2) {\n        var code = src.readUInt16LE(i);\n        var isHighSurrogate = (0xD800 <= code && code < 0xDC00);\n        var isLowSurrogate = (0xDC00 <= code && code < 0xE000);\n\n        if (this.highSurrogate) {\n            if (isHighSurrogate || !isLowSurrogate) {\n                // There shouldn't be two high surrogates in a row, nor a high surrogate which isn't followed by a low\n                // surrogate. If this happens, keep the pending high surrogate as a stand-alone semi-invalid character\n                // (technically wrong, but expected by some applications, like Windows file names).\n                write32.call(dst, this.highSurrogate, offset);\n                offset += 4;\n            }\n            else {\n                // Create 32-bit value from high and low surrogates;\n                var codepoint = (((this.highSurrogate - 0xD800) << 10) | (code - 0xDC00)) + 0x10000;\n\n                write32.call(dst, codepoint, offset);\n                offset += 4;\n                this.highSurrogate = 0;\n\n                continue;\n            }\n        }\n\n        if (isHighSurrogate)\n            this.highSurrogate = code;\n        else {\n            // Even if the current character is a low surrogate, with no previous high surrogate, we'll\n            // encode it as a semi-invalid stand-alone character for the same reasons expressed above for\n            // unpaired high surrogates.\n            write32.call(dst, code, offset);\n            offset += 4;\n            this.highSurrogate = 0;\n        }\n    }\n\n    if (offset < dst.length)\n        dst = dst.slice(0, offset);\n\n    return dst;\n};\n\nUtf32Encoder.prototype.end = function() {\n    // Treat any leftover high surrogate as a semi-valid independent character.\n    if (!this.highSurrogate)\n        return;\n\n    var buf = Buffer.alloc(4);\n\n    if (this.isLE)\n        buf.writeUInt32LE(this.highSurrogate, 0);\n    else\n        buf.writeUInt32BE(this.highSurrogate, 0);\n\n    this.highSurrogate = 0;\n\n    return buf;\n};\n\n// -- Decoding\n\nfunction Utf32Decoder(options, codec) {\n    this.isLE = codec.isLE;\n    this.badChar = codec.iconv.defaultCharUnicode.charCodeAt(0);\n    this.overflow = [];\n}\n\nUtf32Decoder.prototype.write = function(src) {\n    if (src.length === 0)\n        return '';\n\n    var i = 0;\n    var codepoint = 0;\n    var dst = Buffer.alloc(src.length + 4);\n    var offset = 0;\n    var isLE = this.isLE;\n    var overflow = this.overflow;\n    var badChar = this.badChar;\n\n    if (overflow.length > 0) {\n        for (; i < src.length && overflow.length < 4; i++)\n            overflow.push(src[i]);\n        \n        if (overflow.length === 4) {\n            // NOTE: codepoint is a signed int32 and can be negative.\n            // NOTE: We copied this block from below to help V8 optimize it (it works with array, not buffer).\n            if (isLE) {\n                codepoint = overflow[i] | (overflow[i+1] << 8) | (overflow[i+2] << 16) | (overflow[i+3] << 24);\n            } else {\n                codepoint = overflow[i+3] | (overflow[i+2] << 8) | (overflow[i+1] << 16) | (overflow[i] << 24);\n            }\n            overflow.length = 0;\n\n            offset = _writeCodepoint(dst, offset, codepoint, badChar);\n        }\n    }\n\n    // Main loop. Should be as optimized as possible.\n    for (; i < src.length - 3; i += 4) {\n        // NOTE: codepoint is a signed int32 and can be negative.\n        if (isLE) {\n            codepoint = src[i] | (src[i+1] << 8) | (src[i+2] << 16) | (src[i+3] << 24);\n        } else {\n            codepoint = src[i+3] | (src[i+2] << 8) | (src[i+1] << 16) | (src[i] << 24);\n        }\n        offset = _writeCodepoint(dst, offset, codepoint, badChar);\n    }\n\n    // Keep overflowing bytes.\n    for (; i < src.length; i++) {\n        overflow.push(src[i]);\n    }\n\n    return dst.slice(0, offset).toString('ucs2');\n};\n\nfunction _writeCodepoint(dst, offset, codepoint, badChar) {\n    // NOTE: codepoint is signed int32 and can be negative. We keep it that way to help V8 with optimizations.\n    if (codepoint < 0 || codepoint > 0x10FFFF) {\n        // Not a valid Unicode codepoint\n        codepoint = badChar;\n    } \n\n    // Ephemeral Planes: Write high surrogate.\n    if (codepoint >= 0x10000) {\n        codepoint -= 0x10000;\n\n        var high = 0xD800 | (codepoint >> 10);\n        dst[offset++] = high & 0xff;\n        dst[offset++] = high >> 8;\n\n        // Low surrogate is written below.\n        var codepoint = 0xDC00 | (codepoint & 0x3FF);\n    }\n\n    // Write BMP char or low surrogate.\n    dst[offset++] = codepoint & 0xff;\n    dst[offset++] = codepoint >> 8;\n\n    return offset;\n};\n\nUtf32Decoder.prototype.end = function() {\n    this.overflow.length = 0;\n};\n\n// == UTF-32 Auto codec =============================================================\n// Decoder chooses automatically from UTF-32LE and UTF-32BE using BOM and space-based heuristic.\n// Defaults to UTF-32LE. http://en.wikipedia.org/wiki/UTF-32\n// Encoder/decoder default can be changed: iconv.decode(buf, 'utf32', {defaultEncoding: 'utf-32be'});\n\n// Encoder prepends BOM (which can be overridden with (addBOM: false}).\n\nexports.utf32 = Utf32AutoCodec;\nexports.ucs4 = 'utf32';\n\nfunction Utf32AutoCodec(options, iconv) {\n    this.iconv = iconv;\n}\n\nUtf32AutoCodec.prototype.encoder = Utf32AutoEncoder;\nUtf32AutoCodec.prototype.decoder = Utf32AutoDecoder;\n\n// -- Encoding\n\nfunction Utf32AutoEncoder(options, codec) {\n    options = options || {};\n\n    if (options.addBOM === undefined)\n        options.addBOM = true;\n\n    this.encoder = codec.iconv.getEncoder(options.defaultEncoding || 'utf-32le', options);\n}\n\nUtf32AutoEncoder.prototype.write = function(str) {\n    return this.encoder.write(str);\n};\n\nUtf32AutoEncoder.prototype.end = function() {\n    return this.encoder.end();\n};\n\n// -- Decoding\n\nfunction Utf32AutoDecoder(options, codec) {\n    this.decoder = null;\n    this.initialBufs = [];\n    this.initialBufsLen = 0;\n    this.options = options || {};\n    this.iconv = codec.iconv;\n}\n\nUtf32AutoDecoder.prototype.write = function(buf) {\n    if (!this.decoder) { \n        // Codec is not chosen yet. Accumulate initial bytes.\n        this.initialBufs.push(buf);\n        this.initialBufsLen += buf.length;\n\n        if (this.initialBufsLen < 32) // We need more bytes to use space heuristic (see below)\n            return '';\n\n        // We have enough bytes -> detect endianness.\n        var encoding = detectEncoding(this.initialBufs, this.options.defaultEncoding);\n        this.decoder = this.iconv.getDecoder(encoding, this.options);\n\n        var resStr = '';\n        for (var i = 0; i < this.initialBufs.length; i++)\n            resStr += this.decoder.write(this.initialBufs[i]);\n\n        this.initialBufs.length = this.initialBufsLen = 0;\n        return resStr;\n    }\n\n    return this.decoder.write(buf);\n};\n\nUtf32AutoDecoder.prototype.end = function() {\n    if (!this.decoder) {\n        var encoding = detectEncoding(this.initialBufs, this.options.defaultEncoding);\n        this.decoder = this.iconv.getDecoder(encoding, this.options);\n\n        var resStr = '';\n        for (var i = 0; i < this.initialBufs.length; i++)\n            resStr += this.decoder.write(this.initialBufs[i]);\n\n        var trail = this.decoder.end();\n        if (trail)\n            resStr += trail;\n\n        this.initialBufs.length = this.initialBufsLen = 0;\n        return resStr;\n    }\n\n    return this.decoder.end();\n};\n\nfunction detectEncoding(bufs, defaultEncoding) {\n    var b = [];\n    var charsProcessed = 0;\n    var invalidLE = 0, invalidBE = 0;   // Number of invalid chars when decoded as LE or BE.\n    var bmpCharsLE = 0, bmpCharsBE = 0; // Number of BMP chars when decoded as LE or BE.\n\n    outer_loop:\n    for (var i = 0; i < bufs.length; i++) {\n        var buf = bufs[i];\n        for (var j = 0; j < buf.length; j++) {\n            b.push(buf[j]);\n            if (b.length === 4) {\n                if (charsProcessed === 0) {\n                    // Check BOM first.\n                    if (b[0] === 0xFF && b[1] === 0xFE && b[2] === 0 && b[3] === 0) {\n                        return 'utf-32le';\n                    }\n                    if (b[0] === 0 && b[1] === 0 && b[2] === 0xFE && b[3] === 0xFF) {\n                        return 'utf-32be';\n                    }\n                }\n\n                if (b[0] !== 0 || b[1] > 0x10) invalidBE++;\n                if (b[3] !== 0 || b[2] > 0x10) invalidLE++;\n\n                if (b[0] === 0 && b[1] === 0 && (b[2] !== 0 || b[3] !== 0)) bmpCharsBE++;\n                if ((b[0] !== 0 || b[1] !== 0) && b[2] === 0 && b[3] === 0) bmpCharsLE++;\n\n                b.length = 0;\n                charsProcessed++;\n\n                if (charsProcessed >= 100) {\n                    break outer_loop;\n                }\n            }\n        }\n    }\n\n    // Make decisions.\n    if (bmpCharsBE - invalidBE > bmpCharsLE - invalidLE)  return 'utf-32be';\n    if (bmpCharsBE - invalidBE < bmpCharsLE - invalidLE)  return 'utf-32le';\n\n    // Couldn't decide (likely all zeros or not enough data).\n    return defaultEncoding || 'utf-32le';\n}\n","\"use strict\";\nvar Buffer = require(\"safer-buffer\").Buffer;\n\n// UTF-7 codec, according to https://tools.ietf.org/html/rfc2152\n// See also below a UTF-7-IMAP codec, according to http://tools.ietf.org/html/rfc3501#section-5.1.3\n\nexports.utf7 = Utf7Codec;\nexports.unicode11utf7 = 'utf7'; // Alias UNICODE-1-1-UTF-7\nfunction Utf7Codec(codecOptions, iconv) {\n    this.iconv = iconv;\n};\n\nUtf7Codec.prototype.encoder = Utf7Encoder;\nUtf7Codec.prototype.decoder = Utf7Decoder;\nUtf7Codec.prototype.bomAware = true;\n\n\n// -- Encoding\n\nvar nonDirectChars = /[^A-Za-z0-9'\\(\\),-\\.\\/:\\? \\n\\r\\t]+/g;\n\nfunction Utf7Encoder(options, codec) {\n    this.iconv = codec.iconv;\n}\n\nUtf7Encoder.prototype.write = function(str) {\n    // Naive implementation.\n    // Non-direct chars are encoded as \"+<base64>-\"; single \"+\" char is encoded as \"+-\".\n    return Buffer.from(str.replace(nonDirectChars, function(chunk) {\n        return \"+\" + (chunk === '+' ? '' : \n            this.iconv.encode(chunk, 'utf16-be').toString('base64').replace(/=+$/, '')) \n            + \"-\";\n    }.bind(this)));\n}\n\nUtf7Encoder.prototype.end = function() {\n}\n\n\n// -- Decoding\n\nfunction Utf7Decoder(options, codec) {\n    this.iconv = codec.iconv;\n    this.inBase64 = false;\n    this.base64Accum = '';\n}\n\nvar base64Regex = /[A-Za-z0-9\\/+]/;\nvar base64Chars = [];\nfor (var i = 0; i < 256; i++)\n    base64Chars[i] = base64Regex.test(String.fromCharCode(i));\n\nvar plusChar = '+'.charCodeAt(0), \n    minusChar = '-'.charCodeAt(0),\n    andChar = '&'.charCodeAt(0);\n\nUtf7Decoder.prototype.write = function(buf) {\n    var res = \"\", lastI = 0,\n        inBase64 = this.inBase64,\n        base64Accum = this.base64Accum;\n\n    // The decoder is more involved as we must handle chunks in stream.\n\n    for (var i = 0; i < buf.length; i++) {\n        if (!inBase64) { // We're in direct mode.\n            // Write direct chars until '+'\n            if (buf[i] == plusChar) {\n                res += this.iconv.decode(buf.slice(lastI, i), \"ascii\"); // Write direct chars.\n                lastI = i+1;\n                inBase64 = true;\n            }\n        } else { // We decode base64.\n            if (!base64Chars[buf[i]]) { // Base64 ended.\n                if (i == lastI && buf[i] == minusChar) {// \"+-\" -> \"+\"\n                    res += \"+\";\n                } else {\n                    var b64str = base64Accum + this.iconv.decode(buf.slice(lastI, i), \"ascii\");\n                    res += this.iconv.decode(Buffer.from(b64str, 'base64'), \"utf16-be\");\n                }\n\n                if (buf[i] != minusChar) // Minus is absorbed after base64.\n                    i--;\n\n                lastI = i+1;\n                inBase64 = false;\n                base64Accum = '';\n            }\n        }\n    }\n\n    if (!inBase64) {\n        res += this.iconv.decode(buf.slice(lastI), \"ascii\"); // Write direct chars.\n    } else {\n        var b64str = base64Accum + this.iconv.decode(buf.slice(lastI), \"ascii\");\n\n        var canBeDecoded = b64str.length - (b64str.length % 8); // Minimal chunk: 2 quads -> 2x3 bytes -> 3 chars.\n        base64Accum = b64str.slice(canBeDecoded); // The rest will be decoded in future.\n        b64str = b64str.slice(0, canBeDecoded);\n\n        res += this.iconv.decode(Buffer.from(b64str, 'base64'), \"utf16-be\");\n    }\n\n    this.inBase64 = inBase64;\n    this.base64Accum = base64Accum;\n\n    return res;\n}\n\nUtf7Decoder.prototype.end = function() {\n    var res = \"\";\n    if (this.inBase64 && this.base64Accum.length > 0)\n        res = this.iconv.decode(Buffer.from(this.base64Accum, 'base64'), \"utf16-be\");\n\n    this.inBase64 = false;\n    this.base64Accum = '';\n    return res;\n}\n\n\n// UTF-7-IMAP codec.\n// RFC3501 Sec. 5.1.3 Modified UTF-7 (http://tools.ietf.org/html/rfc3501#section-5.1.3)\n// Differences:\n//  * Base64 part is started by \"&\" instead of \"+\"\n//  * Direct characters are 0x20-0x7E, except \"&\" (0x26)\n//  * In Base64, \",\" is used instead of \"/\"\n//  * Base64 must not be used to represent direct characters.\n//  * No implicit shift back from Base64 (should always end with '-')\n//  * String must end in non-shifted position.\n//  * \"-&\" while in base64 is not allowed.\n\n\nexports.utf7imap = Utf7IMAPCodec;\nfunction Utf7IMAPCodec(codecOptions, iconv) {\n    this.iconv = iconv;\n};\n\nUtf7IMAPCodec.prototype.encoder = Utf7IMAPEncoder;\nUtf7IMAPCodec.prototype.decoder = Utf7IMAPDecoder;\nUtf7IMAPCodec.prototype.bomAware = true;\n\n\n// -- Encoding\n\nfunction Utf7IMAPEncoder(options, codec) {\n    this.iconv = codec.iconv;\n    this.inBase64 = false;\n    this.base64Accum = Buffer.alloc(6);\n    this.base64AccumIdx = 0;\n}\n\nUtf7IMAPEncoder.prototype.write = function(str) {\n    var inBase64 = this.inBase64,\n        base64Accum = this.base64Accum,\n        base64AccumIdx = this.base64AccumIdx,\n        buf = Buffer.alloc(str.length*5 + 10), bufIdx = 0;\n\n    for (var i = 0; i < str.length; i++) {\n        var uChar = str.charCodeAt(i);\n        if (0x20 <= uChar && uChar <= 0x7E) { // Direct character or '&'.\n            if (inBase64) {\n                if (base64AccumIdx > 0) {\n                    bufIdx += buf.write(base64Accum.slice(0, base64AccumIdx).toString('base64').replace(/\\//g, ',').replace(/=+$/, ''), bufIdx);\n                    base64AccumIdx = 0;\n                }\n\n                buf[bufIdx++] = minusChar; // Write '-', then go to direct mode.\n                inBase64 = false;\n            }\n\n            if (!inBase64) {\n                buf[bufIdx++] = uChar; // Write direct character\n\n                if (uChar === andChar)  // Ampersand -> '&-'\n                    buf[bufIdx++] = minusChar;\n            }\n\n        } else { // Non-direct character\n            if (!inBase64) {\n                buf[bufIdx++] = andChar; // Write '&', then go to base64 mode.\n                inBase64 = true;\n            }\n            if (inBase64) {\n                base64Accum[base64AccumIdx++] = uChar >> 8;\n                base64Accum[base64AccumIdx++] = uChar & 0xFF;\n\n                if (base64AccumIdx == base64Accum.length) {\n                    bufIdx += buf.write(base64Accum.toString('base64').replace(/\\//g, ','), bufIdx);\n                    base64AccumIdx = 0;\n                }\n            }\n        }\n    }\n\n    this.inBase64 = inBase64;\n    this.base64AccumIdx = base64AccumIdx;\n\n    return buf.slice(0, bufIdx);\n}\n\nUtf7IMAPEncoder.prototype.end = function() {\n    var buf = Buffer.alloc(10), bufIdx = 0;\n    if (this.inBase64) {\n        if (this.base64AccumIdx > 0) {\n            bufIdx += buf.write(this.base64Accum.slice(0, this.base64AccumIdx).toString('base64').replace(/\\//g, ',').replace(/=+$/, ''), bufIdx);\n            this.base64AccumIdx = 0;\n        }\n\n        buf[bufIdx++] = minusChar; // Write '-', then go to direct mode.\n        this.inBase64 = false;\n    }\n\n    return buf.slice(0, bufIdx);\n}\n\n\n// -- Decoding\n\nfunction Utf7IMAPDecoder(options, codec) {\n    this.iconv = codec.iconv;\n    this.inBase64 = false;\n    this.base64Accum = '';\n}\n\nvar base64IMAPChars = base64Chars.slice();\nbase64IMAPChars[','.charCodeAt(0)] = true;\n\nUtf7IMAPDecoder.prototype.write = function(buf) {\n    var res = \"\", lastI = 0,\n        inBase64 = this.inBase64,\n        base64Accum = this.base64Accum;\n\n    // The decoder is more involved as we must handle chunks in stream.\n    // It is forgiving, closer to standard UTF-7 (for example, '-' is optional at the end).\n\n    for (var i = 0; i < buf.length; i++) {\n        if (!inBase64) { // We're in direct mode.\n            // Write direct chars until '&'\n            if (buf[i] == andChar) {\n                res += this.iconv.decode(buf.slice(lastI, i), \"ascii\"); // Write direct chars.\n                lastI = i+1;\n                inBase64 = true;\n            }\n        } else { // We decode base64.\n            if (!base64IMAPChars[buf[i]]) { // Base64 ended.\n                if (i == lastI && buf[i] == minusChar) { // \"&-\" -> \"&\"\n                    res += \"&\";\n                } else {\n                    var b64str = base64Accum + this.iconv.decode(buf.slice(lastI, i), \"ascii\").replace(/,/g, '/');\n                    res += this.iconv.decode(Buffer.from(b64str, 'base64'), \"utf16-be\");\n                }\n\n                if (buf[i] != minusChar) // Minus may be absorbed after base64.\n                    i--;\n\n                lastI = i+1;\n                inBase64 = false;\n                base64Accum = '';\n            }\n        }\n    }\n\n    if (!inBase64) {\n        res += this.iconv.decode(buf.slice(lastI), \"ascii\"); // Write direct chars.\n    } else {\n        var b64str = base64Accum + this.iconv.decode(buf.slice(lastI), \"ascii\").replace(/,/g, '/');\n\n        var canBeDecoded = b64str.length - (b64str.length % 8); // Minimal chunk: 2 quads -> 2x3 bytes -> 3 chars.\n        base64Accum = b64str.slice(canBeDecoded); // The rest will be decoded in future.\n        b64str = b64str.slice(0, canBeDecoded);\n\n        res += this.iconv.decode(Buffer.from(b64str, 'base64'), \"utf16-be\");\n    }\n\n    this.inBase64 = inBase64;\n    this.base64Accum = base64Accum;\n\n    return res;\n}\n\nUtf7IMAPDecoder.prototype.end = function() {\n    var res = \"\";\n    if (this.inBase64 && this.base64Accum.length > 0)\n        res = this.iconv.decode(Buffer.from(this.base64Accum, 'base64'), \"utf16-be\");\n\n    this.inBase64 = false;\n    this.base64Accum = '';\n    return res;\n}\n\n\n","\"use strict\";\n\nvar BOMChar = '\\uFEFF';\n\nexports.PrependBOM = PrependBOMWrapper\nfunction PrependBOMWrapper(encoder, options) {\n    this.encoder = encoder;\n    this.addBOM = true;\n}\n\nPrependBOMWrapper.prototype.write = function(str) {\n    if (this.addBOM) {\n        str = BOMChar + str;\n        this.addBOM = false;\n    }\n\n    return this.encoder.write(str);\n}\n\nPrependBOMWrapper.prototype.end = function() {\n    return this.encoder.end();\n}\n\n\n//------------------------------------------------------------------------------\n\nexports.StripBOM = StripBOMWrapper;\nfunction StripBOMWrapper(decoder, options) {\n    this.decoder = decoder;\n    this.pass = false;\n    this.options = options || {};\n}\n\nStripBOMWrapper.prototype.write = function(buf) {\n    var res = this.decoder.write(buf);\n    if (this.pass || !res)\n        return res;\n\n    if (res[0] === BOMChar) {\n        res = res.slice(1);\n        if (typeof this.options.stripBOM === 'function')\n            this.options.stripBOM();\n    }\n\n    this.pass = true;\n    return res;\n}\n\nStripBOMWrapper.prototype.end = function() {\n    return this.decoder.end();\n}\n\n","\"use strict\";\n\nvar Buffer = require(\"safer-buffer\").Buffer;\n\nvar bomHandling = require(\"./bom-handling\"),\n    iconv = module.exports;\n\n// All codecs and aliases are kept here, keyed by encoding name/alias.\n// They are lazy loaded in `iconv.getCodec` from `encodings/index.js`.\niconv.encodings = null;\n\n// Characters emitted in case of error.\niconv.defaultCharUnicode = '';\niconv.defaultCharSingleByte = '?';\n\n// Public API.\niconv.encode = function encode(str, encoding, options) {\n    str = \"\" + (str || \"\"); // Ensure string.\n\n    var encoder = iconv.getEncoder(encoding, options);\n\n    var res = encoder.write(str);\n    var trail = encoder.end();\n    \n    return (trail && trail.length > 0) ? Buffer.concat([res, trail]) : res;\n}\n\niconv.decode = function decode(buf, encoding, options) {\n    if (typeof buf === 'string') {\n        if (!iconv.skipDecodeWarning) {\n            console.error('Iconv-lite warning: decode()-ing strings is deprecated. Refer to https://github.com/ashtuchkin/iconv-lite/wiki/Use-Buffers-when-decoding');\n            iconv.skipDecodeWarning = true;\n        }\n\n        buf = Buffer.from(\"\" + (buf || \"\"), \"binary\"); // Ensure buffer.\n    }\n\n    var decoder = iconv.getDecoder(encoding, options);\n\n    var res = decoder.write(buf);\n    var trail = decoder.end();\n\n    return trail ? (res + trail) : res;\n}\n\niconv.encodingExists = function encodingExists(enc) {\n    try {\n        iconv.getCodec(enc);\n        return true;\n    } catch (e) {\n        return false;\n    }\n}\n\n// Legacy aliases to convert functions\niconv.toEncoding = iconv.encode;\niconv.fromEncoding = iconv.decode;\n\n// Search for a codec in iconv.encodings. Cache codec data in iconv._codecDataCache.\niconv._codecDataCache = {};\niconv.getCodec = function getCodec(encoding) {\n    if (!iconv.encodings)\n        iconv.encodings = require(\"../encodings\"); // Lazy load all encoding definitions.\n    \n    // Canonicalize encoding name: strip all non-alphanumeric chars and appended year.\n    var enc = iconv._canonicalizeEncoding(encoding);\n\n    // Traverse iconv.encodings to find actual codec.\n    var codecOptions = {};\n    while (true) {\n        var codec = iconv._codecDataCache[enc];\n        if (codec)\n            return codec;\n\n        var codecDef = iconv.encodings[enc];\n\n        switch (typeof codecDef) {\n            case \"string\": // Direct alias to other encoding.\n                enc = codecDef;\n                break;\n\n            case \"object\": // Alias with options. Can be layered.\n                for (var key in codecDef)\n                    codecOptions[key] = codecDef[key];\n\n                if (!codecOptions.encodingName)\n                    codecOptions.encodingName = enc;\n                \n                enc = codecDef.type;\n                break;\n\n            case \"function\": // Codec itself.\n                if (!codecOptions.encodingName)\n                    codecOptions.encodingName = enc;\n\n                // The codec function must load all tables and return object with .encoder and .decoder methods.\n                // It'll be called only once (for each different options object).\n                codec = new codecDef(codecOptions, iconv);\n\n                iconv._codecDataCache[codecOptions.encodingName] = codec; // Save it to be reused later.\n                return codec;\n\n            default:\n                throw new Error(\"Encoding not recognized: '\" + encoding + \"' (searched as: '\"+enc+\"')\");\n        }\n    }\n}\n\niconv._canonicalizeEncoding = function(encoding) {\n    // Canonicalize encoding name: strip all non-alphanumeric chars and appended year.\n    return (''+encoding).toLowerCase().replace(/:\\d{4}$|[^0-9a-z]/g, \"\");\n}\n\niconv.getEncoder = function getEncoder(encoding, options) {\n    var codec = iconv.getCodec(encoding),\n        encoder = new codec.encoder(options, codec);\n\n    if (codec.bomAware && options && options.addBOM)\n        encoder = new bomHandling.PrependBOM(encoder, options);\n\n    return encoder;\n}\n\niconv.getDecoder = function getDecoder(encoding, options) {\n    var codec = iconv.getCodec(encoding),\n        decoder = new codec.decoder(options, codec);\n\n    if (codec.bomAware && !(options && options.stripBOM === false))\n        decoder = new bomHandling.StripBOM(decoder, options);\n\n    return decoder;\n}\n\n// Streaming API\n// NOTE: Streaming API naturally depends on 'stream' module from Node.js. Unfortunately in browser environments this module can add\n// up to 100Kb to the output bundle. To avoid unnecessary code bloat, we don't enable Streaming API in browser by default.\n// If you would like to enable it explicitly, please add the following code to your app:\n// > iconv.enableStreamingAPI(require('stream'));\niconv.enableStreamingAPI = function enableStreamingAPI(stream_module) {\n    if (iconv.supportsStreams)\n        return;\n\n    // Dependency-inject stream module to create IconvLite stream classes.\n    var streams = require(\"./streams\")(stream_module);\n\n    // Not public API yet, but expose the stream classes.\n    iconv.IconvLiteEncoderStream = streams.IconvLiteEncoderStream;\n    iconv.IconvLiteDecoderStream = streams.IconvLiteDecoderStream;\n\n    // Streaming API.\n    iconv.encodeStream = function encodeStream(encoding, options) {\n        return new iconv.IconvLiteEncoderStream(iconv.getEncoder(encoding, options), options);\n    }\n\n    iconv.decodeStream = function decodeStream(encoding, options) {\n        return new iconv.IconvLiteDecoderStream(iconv.getDecoder(encoding, options), options);\n    }\n\n    iconv.supportsStreams = true;\n}\n\n// Enable Streaming API automatically if 'stream' module is available and non-empty (the majority of environments).\nvar stream_module;\ntry {\n    stream_module = require(\"stream\");\n} catch (e) {}\n\nif (stream_module && stream_module.Transform) {\n    iconv.enableStreamingAPI(stream_module);\n\n} else {\n    // In rare cases where 'stream' module is not available by default, throw a helpful exception.\n    iconv.encodeStream = iconv.decodeStream = function() {\n        throw new Error(\"iconv-lite Streaming API is not enabled. Use iconv.enableStreamingAPI(require('stream')); to enable it.\");\n    };\n}\n\nif (\"\" != \"\\u0100\") {\n    console.error(\"iconv-lite warning: js files use non-utf8 encoding. See https://github.com/ashtuchkin/iconv-lite/wiki/Javascript-source-file-encodings for more info.\");\n}\n","\"use strict\";\n\nvar Buffer = require(\"safer-buffer\").Buffer;\n\n// NOTE: Due to 'stream' module being pretty large (~100Kb, significant in browser environments), \n// we opt to dependency-inject it instead of creating a hard dependency.\nmodule.exports = function(stream_module) {\n    var Transform = stream_module.Transform;\n\n    // == Encoder stream =======================================================\n\n    function IconvLiteEncoderStream(conv, options) {\n        this.conv = conv;\n        options = options || {};\n        options.decodeStrings = false; // We accept only strings, so we don't need to decode them.\n        Transform.call(this, options);\n    }\n\n    IconvLiteEncoderStream.prototype = Object.create(Transform.prototype, {\n        constructor: { value: IconvLiteEncoderStream }\n    });\n\n    IconvLiteEncoderStream.prototype._transform = function(chunk, encoding, done) {\n        if (typeof chunk != 'string')\n            return done(new Error(\"Iconv encoding stream needs strings as its input.\"));\n        try {\n            var res = this.conv.write(chunk);\n            if (res && res.length) this.push(res);\n            done();\n        }\n        catch (e) {\n            done(e);\n        }\n    }\n\n    IconvLiteEncoderStream.prototype._flush = function(done) {\n        try {\n            var res = this.conv.end();\n            if (res && res.length) this.push(res);\n            done();\n        }\n        catch (e) {\n            done(e);\n        }\n    }\n\n    IconvLiteEncoderStream.prototype.collect = function(cb) {\n        var chunks = [];\n        this.on('error', cb);\n        this.on('data', function(chunk) { chunks.push(chunk); });\n        this.on('end', function() {\n            cb(null, Buffer.concat(chunks));\n        });\n        return this;\n    }\n\n\n    // == Decoder stream =======================================================\n\n    function IconvLiteDecoderStream(conv, options) {\n        this.conv = conv;\n        options = options || {};\n        options.encoding = this.encoding = 'utf8'; // We output strings.\n        Transform.call(this, options);\n    }\n\n    IconvLiteDecoderStream.prototype = Object.create(Transform.prototype, {\n        constructor: { value: IconvLiteDecoderStream }\n    });\n\n    IconvLiteDecoderStream.prototype._transform = function(chunk, encoding, done) {\n        if (!Buffer.isBuffer(chunk) && !(chunk instanceof Uint8Array))\n            return done(new Error(\"Iconv decoding stream needs buffers as its input.\"));\n        try {\n            var res = this.conv.write(chunk);\n            if (res && res.length) this.push(res, this.encoding);\n            done();\n        }\n        catch (e) {\n            done(e);\n        }\n    }\n\n    IconvLiteDecoderStream.prototype._flush = function(done) {\n        try {\n            var res = this.conv.end();\n            if (res && res.length) this.push(res, this.encoding);                \n            done();\n        }\n        catch (e) {\n            done(e);\n        }\n    }\n\n    IconvLiteDecoderStream.prototype.collect = function(cb) {\n        var res = '';\n        this.on('error', cb);\n        this.on('data', function(chunk) { res += chunk; });\n        this.on('end', function() {\n            cb(null, res);\n        });\n        return this;\n    }\n\n    return {\n        IconvLiteEncoderStream: IconvLiteEncoderStream,\n        IconvLiteDecoderStream: IconvLiteDecoderStream,\n    };\n};\n","var wrappy = require('wrappy')\nmodule.exports = wrappy(once)\nmodule.exports.strict = wrappy(onceStrict)\n\nonce.proto = once(function () {\n  Object.defineProperty(Function.prototype, 'once', {\n    value: function () {\n      return once(this)\n    },\n    configurable: true\n  })\n\n  Object.defineProperty(Function.prototype, 'onceStrict', {\n    value: function () {\n      return onceStrict(this)\n    },\n    configurable: true\n  })\n})\n\nfunction once (fn) {\n  var f = function () {\n    if (f.called) return f.value\n    f.called = true\n    return f.value = fn.apply(this, arguments)\n  }\n  f.called = false\n  return f\n}\n\nfunction onceStrict (fn) {\n  var f = function () {\n    if (f.called)\n      throw new Error(f.onceError)\n    f.called = true\n    return f.value = fn.apply(this, arguments)\n  }\n  var name = fn.name || 'Function wrapped with `once`'\n  f.onceError = name + \" shouldn't be called more than once\"\n  f.called = false\n  return f\n}\n","/* eslint-disable node/no-deprecated-api */\n\n'use strict'\n\nvar buffer = require('buffer')\nvar Buffer = buffer.Buffer\n\nvar safer = {}\n\nvar key\n\nfor (key in buffer) {\n  if (!buffer.hasOwnProperty(key)) continue\n  if (key === 'SlowBuffer' || key === 'Buffer') continue\n  safer[key] = buffer[key]\n}\n\nvar Safer = safer.Buffer = {}\nfor (key in Buffer) {\n  if (!Buffer.hasOwnProperty(key)) continue\n  if (key === 'allocUnsafe' || key === 'allocUnsafeSlow') continue\n  Safer[key] = Buffer[key]\n}\n\nsafer.Buffer.prototype = Buffer.prototype\n\nif (!Safer.from || Safer.from === Uint8Array.from) {\n  Safer.from = function (value, encodingOrOffset, length) {\n    if (typeof value === 'number') {\n      throw new TypeError('The \"value\" argument must not be of type number. Received type ' + typeof value)\n    }\n    if (value && typeof value.length === 'undefined') {\n      throw new TypeError('The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type ' + typeof value)\n    }\n    return Buffer(value, encodingOrOffset, length)\n  }\n}\n\nif (!Safer.alloc) {\n  Safer.alloc = function (size, fill, encoding) {\n    if (typeof size !== 'number') {\n      throw new TypeError('The \"size\" argument must be of type number. Received type ' + typeof size)\n    }\n    if (size < 0 || size >= 2 * (1 << 30)) {\n      throw new RangeError('The value \"' + size + '\" is invalid for option \"size\"')\n    }\n    var buf = Buffer(size)\n    if (!fill || fill.length === 0) {\n      buf.fill(0)\n    } else if (typeof encoding === 'string') {\n      buf.fill(fill, encoding)\n    } else {\n      buf.fill(fill)\n    }\n    return buf\n  }\n}\n\nif (!safer.kStringMaxLength) {\n  try {\n    safer.kStringMaxLength = process.binding('buffer').kStringMaxLength\n  } catch (e) {\n    // we can't determine kStringMaxLength in environments where process.binding\n    // is unsupported, so let's not set it\n  }\n}\n\nif (!safer.constants) {\n  safer.constants = {\n    MAX_LENGTH: safer.kMaxLength\n  }\n  if (safer.kStringMaxLength) {\n    safer.constants.MAX_STRING_LENGTH = safer.kStringMaxLength\n  }\n}\n\nmodule.exports = safer\n","\"use strict\";\n\nvar punycode = require(\"punycode\");\nvar mappingTable = require(\"./lib/mappingTable.json\");\n\nvar PROCESSING_OPTIONS = {\n  TRANSITIONAL: 0,\n  NONTRANSITIONAL: 1\n};\n\nfunction normalize(str) { // fix bug in v8\n  return str.split('\\u0000').map(function (s) { return s.normalize('NFC'); }).join('\\u0000');\n}\n\nfunction findStatus(val) {\n  var start = 0;\n  var end = mappingTable.length - 1;\n\n  while (start <= end) {\n    var mid = Math.floor((start + end) / 2);\n\n    var target = mappingTable[mid];\n    if (target[0][0] <= val && target[0][1] >= val) {\n      return target;\n    } else if (target[0][0] > val) {\n      end = mid - 1;\n    } else {\n      start = mid + 1;\n    }\n  }\n\n  return null;\n}\n\nvar regexAstralSymbols = /[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n\nfunction countSymbols(string) {\n  return string\n    // replace every surrogate pair with a BMP symbol\n    .replace(regexAstralSymbols, '_')\n    // then get the length\n    .length;\n}\n\nfunction mapChars(domain_name, useSTD3, processing_option) {\n  var hasError = false;\n  var processed = \"\";\n\n  var len = countSymbols(domain_name);\n  for (var i = 0; i < len; ++i) {\n    var codePoint = domain_name.codePointAt(i);\n    var status = findStatus(codePoint);\n\n    switch (status[1]) {\n      case \"disallowed\":\n        hasError = true;\n        processed += String.fromCodePoint(codePoint);\n        break;\n      case \"ignored\":\n        break;\n      case \"mapped\":\n        processed += String.fromCodePoint.apply(String, status[2]);\n        break;\n      case \"deviation\":\n        if (processing_option === PROCESSING_OPTIONS.TRANSITIONAL) {\n          processed += String.fromCodePoint.apply(String, status[2]);\n        } else {\n          processed += String.fromCodePoint(codePoint);\n        }\n        break;\n      case \"valid\":\n        processed += String.fromCodePoint(codePoint);\n        break;\n      case \"disallowed_STD3_mapped\":\n        if (useSTD3) {\n          hasError = true;\n          processed += String.fromCodePoint(codePoint);\n        } else {\n          processed += String.fromCodePoint.apply(String, status[2]);\n        }\n        break;\n      case \"disallowed_STD3_valid\":\n        if (useSTD3) {\n          hasError = true;\n        }\n\n        processed += String.fromCodePoint(codePoint);\n        break;\n    }\n  }\n\n  return {\n    string: processed,\n    error: hasError\n  };\n}\n\nvar combiningMarksRegex = /[\\u0300-\\u036F\\u0483-\\u0489\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u0610-\\u061A\\u064B-\\u065F\\u0670\\u06D6-\\u06DC\\u06DF-\\u06E4\\u06E7\\u06E8\\u06EA-\\u06ED\\u0711\\u0730-\\u074A\\u07A6-\\u07B0\\u07EB-\\u07F3\\u0816-\\u0819\\u081B-\\u0823\\u0825-\\u0827\\u0829-\\u082D\\u0859-\\u085B\\u08E4-\\u0903\\u093A-\\u093C\\u093E-\\u094F\\u0951-\\u0957\\u0962\\u0963\\u0981-\\u0983\\u09BC\\u09BE-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CD\\u09D7\\u09E2\\u09E3\\u0A01-\\u0A03\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A70\\u0A71\\u0A75\\u0A81-\\u0A83\\u0ABC\\u0ABE-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AE2\\u0AE3\\u0B01-\\u0B03\\u0B3C\\u0B3E-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B62\\u0B63\\u0B82\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD7\\u0C00-\\u0C03\\u0C3E-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C62\\u0C63\\u0C81-\\u0C83\\u0CBC\\u0CBE-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CE2\\u0CE3\\u0D01-\\u0D03\\u0D3E-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4D\\u0D57\\u0D62\\u0D63\\u0D82\\u0D83\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DF2\\u0DF3\\u0E31\\u0E34-\\u0E3A\\u0E47-\\u0E4E\\u0EB1\\u0EB4-\\u0EB9\\u0EBB\\u0EBC\\u0EC8-\\u0ECD\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F3E\\u0F3F\\u0F71-\\u0F84\\u0F86\\u0F87\\u0F8D-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u102B-\\u103E\\u1056-\\u1059\\u105E-\\u1060\\u1062-\\u1064\\u1067-\\u106D\\u1071-\\u1074\\u1082-\\u108D\\u108F\\u109A-\\u109D\\u135D-\\u135F\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17B4-\\u17D3\\u17DD\\u180B-\\u180D\\u18A9\\u1920-\\u192B\\u1930-\\u193B\\u19B0-\\u19C0\\u19C8\\u19C9\\u1A17-\\u1A1B\\u1A55-\\u1A5E\\u1A60-\\u1A7C\\u1A7F\\u1AB0-\\u1ABE\\u1B00-\\u1B04\\u1B34-\\u1B44\\u1B6B-\\u1B73\\u1B80-\\u1B82\\u1BA1-\\u1BAD\\u1BE6-\\u1BF3\\u1C24-\\u1C37\\u1CD0-\\u1CD2\\u1CD4-\\u1CE8\\u1CED\\u1CF2-\\u1CF4\\u1CF8\\u1CF9\\u1DC0-\\u1DF5\\u1DFC-\\u1DFF\\u20D0-\\u20F0\\u2CEF-\\u2CF1\\u2D7F\\u2DE0-\\u2DFF\\u302A-\\u302F\\u3099\\u309A\\uA66F-\\uA672\\uA674-\\uA67D\\uA69F\\uA6F0\\uA6F1\\uA802\\uA806\\uA80B\\uA823-\\uA827\\uA880\\uA881\\uA8B4-\\uA8C4\\uA8E0-\\uA8F1\\uA926-\\uA92D\\uA947-\\uA953\\uA980-\\uA983\\uA9B3-\\uA9C0\\uA9E5\\uAA29-\\uAA36\\uAA43\\uAA4C\\uAA4D\\uAA7B-\\uAA7D\\uAAB0\\uAAB2-\\uAAB4\\uAAB7\\uAAB8\\uAABE\\uAABF\\uAAC1\\uAAEB-\\uAAEF\\uAAF5\\uAAF6\\uABE3-\\uABEA\\uABEC\\uABED\\uFB1E\\uFE00-\\uFE0F\\uFE20-\\uFE2D]|\\uD800[\\uDDFD\\uDEE0\\uDF76-\\uDF7A]|\\uD802[\\uDE01-\\uDE03\\uDE05\\uDE06\\uDE0C-\\uDE0F\\uDE38-\\uDE3A\\uDE3F\\uDEE5\\uDEE6]|\\uD804[\\uDC00-\\uDC02\\uDC38-\\uDC46\\uDC7F-\\uDC82\\uDCB0-\\uDCBA\\uDD00-\\uDD02\\uDD27-\\uDD34\\uDD73\\uDD80-\\uDD82\\uDDB3-\\uDDC0\\uDE2C-\\uDE37\\uDEDF-\\uDEEA\\uDF01-\\uDF03\\uDF3C\\uDF3E-\\uDF44\\uDF47\\uDF48\\uDF4B-\\uDF4D\\uDF57\\uDF62\\uDF63\\uDF66-\\uDF6C\\uDF70-\\uDF74]|\\uD805[\\uDCB0-\\uDCC3\\uDDAF-\\uDDB5\\uDDB8-\\uDDC0\\uDE30-\\uDE40\\uDEAB-\\uDEB7]|\\uD81A[\\uDEF0-\\uDEF4\\uDF30-\\uDF36]|\\uD81B[\\uDF51-\\uDF7E\\uDF8F-\\uDF92]|\\uD82F[\\uDC9D\\uDC9E]|\\uD834[\\uDD65-\\uDD69\\uDD6D-\\uDD72\\uDD7B-\\uDD82\\uDD85-\\uDD8B\\uDDAA-\\uDDAD\\uDE42-\\uDE44]|\\uD83A[\\uDCD0-\\uDCD6]|\\uDB40[\\uDD00-\\uDDEF]/;\n\nfunction validateLabel(label, processing_option) {\n  if (label.substr(0, 4) === \"xn--\") {\n    label = punycode.toUnicode(label);\n    processing_option = PROCESSING_OPTIONS.NONTRANSITIONAL;\n  }\n\n  var error = false;\n\n  if (normalize(label) !== label ||\n      (label[3] === \"-\" && label[4] === \"-\") ||\n      label[0] === \"-\" || label[label.length - 1] === \"-\" ||\n      label.indexOf(\".\") !== -1 ||\n      label.search(combiningMarksRegex) === 0) {\n    error = true;\n  }\n\n  var len = countSymbols(label);\n  for (var i = 0; i < len; ++i) {\n    var status = findStatus(label.codePointAt(i));\n    if ((processing === PROCESSING_OPTIONS.TRANSITIONAL && status[1] !== \"valid\") ||\n        (processing === PROCESSING_OPTIONS.NONTRANSITIONAL &&\n         status[1] !== \"valid\" && status[1] !== \"deviation\")) {\n      error = true;\n      break;\n    }\n  }\n\n  return {\n    label: label,\n    error: error\n  };\n}\n\nfunction processing(domain_name, useSTD3, processing_option) {\n  var result = mapChars(domain_name, useSTD3, processing_option);\n  result.string = normalize(result.string);\n\n  var labels = result.string.split(\".\");\n  for (var i = 0; i < labels.length; ++i) {\n    try {\n      var validation = validateLabel(labels[i]);\n      labels[i] = validation.label;\n      result.error = result.error || validation.error;\n    } catch(e) {\n      result.error = true;\n    }\n  }\n\n  return {\n    string: labels.join(\".\"),\n    error: result.error\n  };\n}\n\nmodule.exports.toASCII = function(domain_name, useSTD3, processing_option, verifyDnsLength) {\n  var result = processing(domain_name, useSTD3, processing_option);\n  var labels = result.string.split(\".\");\n  labels = labels.map(function(l) {\n    try {\n      return punycode.toASCII(l);\n    } catch(e) {\n      result.error = true;\n      return l;\n    }\n  });\n\n  if (verifyDnsLength) {\n    var total = labels.slice(0, labels.length - 1).join(\".\").length;\n    if (total.length > 253 || total.length === 0) {\n      result.error = true;\n    }\n\n    for (var i=0; i < labels.length; ++i) {\n      if (labels.length > 63 || labels.length === 0) {\n        result.error = true;\n        break;\n      }\n    }\n  }\n\n  if (result.error) return null;\n  return labels.join(\".\");\n};\n\nmodule.exports.toUnicode = function(domain_name, useSTD3) {\n  var result = processing(domain_name, useSTD3, PROCESSING_OPTIONS.NONTRANSITIONAL);\n\n  return {\n    domain: result.string,\n    error: result.error\n  };\n};\n\nmodule.exports.PROCESSING_OPTIONS = PROCESSING_OPTIONS;\n","'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nfunction getUserAgent() {\n  if (typeof navigator === \"object\" && \"userAgent\" in navigator) {\n    return navigator.userAgent;\n  }\n\n  if (typeof process === \"object\" && \"version\" in process) {\n    return `Node.js/${process.version.substr(1)} (${process.platform}; ${process.arch})`;\n  }\n\n  return \"<environment undetectable>\";\n}\n\nexports.getUserAgent = getUserAgent;\n//# sourceMappingURL=index.js.map\n","\"use strict\";\n\nvar conversions = {};\nmodule.exports = conversions;\n\nfunction sign(x) {\n    return x < 0 ? -1 : 1;\n}\n\nfunction evenRound(x) {\n    // Round x to the nearest integer, choosing the even integer if it lies halfway between two.\n    if ((x % 1) === 0.5 && (x & 1) === 0) { // [even number].5; round down (i.e. floor)\n        return Math.floor(x);\n    } else {\n        return Math.round(x);\n    }\n}\n\nfunction createNumberConversion(bitLength, typeOpts) {\n    if (!typeOpts.unsigned) {\n        --bitLength;\n    }\n    const lowerBound = typeOpts.unsigned ? 0 : -Math.pow(2, bitLength);\n    const upperBound = Math.pow(2, bitLength) - 1;\n\n    const moduloVal = typeOpts.moduloBitLength ? Math.pow(2, typeOpts.moduloBitLength) : Math.pow(2, bitLength);\n    const moduloBound = typeOpts.moduloBitLength ? Math.pow(2, typeOpts.moduloBitLength - 1) : Math.pow(2, bitLength - 1);\n\n    return function(V, opts) {\n        if (!opts) opts = {};\n\n        let x = +V;\n\n        if (opts.enforceRange) {\n            if (!Number.isFinite(x)) {\n                throw new TypeError(\"Argument is not a finite number\");\n            }\n\n            x = sign(x) * Math.floor(Math.abs(x));\n            if (x < lowerBound || x > upperBound) {\n                throw new TypeError(\"Argument is not in byte range\");\n            }\n\n            return x;\n        }\n\n        if (!isNaN(x) && opts.clamp) {\n            x = evenRound(x);\n\n            if (x < lowerBound) x = lowerBound;\n            if (x > upperBound) x = upperBound;\n            return x;\n        }\n\n        if (!Number.isFinite(x) || x === 0) {\n            return 0;\n        }\n\n        x = sign(x) * Math.floor(Math.abs(x));\n        x = x % moduloVal;\n\n        if (!typeOpts.unsigned && x >= moduloBound) {\n            return x - moduloVal;\n        } else if (typeOpts.unsigned) {\n            if (x < 0) {\n              x += moduloVal;\n            } else if (x === -0) { // don't return negative zero\n              return 0;\n            }\n        }\n\n        return x;\n    }\n}\n\nconversions[\"void\"] = function () {\n    return undefined;\n};\n\nconversions[\"boolean\"] = function (val) {\n    return !!val;\n};\n\nconversions[\"byte\"] = createNumberConversion(8, { unsigned: false });\nconversions[\"octet\"] = createNumberConversion(8, { unsigned: true });\n\nconversions[\"short\"] = createNumberConversion(16, { unsigned: false });\nconversions[\"unsigned short\"] = createNumberConversion(16, { unsigned: true });\n\nconversions[\"long\"] = createNumberConversion(32, { unsigned: false });\nconversions[\"unsigned long\"] = createNumberConversion(32, { unsigned: true });\n\nconversions[\"long long\"] = createNumberConversion(32, { unsigned: false, moduloBitLength: 64 });\nconversions[\"unsigned long long\"] = createNumberConversion(32, { unsigned: true, moduloBitLength: 64 });\n\nconversions[\"double\"] = function (V) {\n    const x = +V;\n\n    if (!Number.isFinite(x)) {\n        throw new TypeError(\"Argument is not a finite floating-point value\");\n    }\n\n    return x;\n};\n\nconversions[\"unrestricted double\"] = function (V) {\n    const x = +V;\n\n    if (isNaN(x)) {\n        throw new TypeError(\"Argument is NaN\");\n    }\n\n    return x;\n};\n\n// not quite valid, but good enough for JS\nconversions[\"float\"] = conversions[\"double\"];\nconversions[\"unrestricted float\"] = conversions[\"unrestricted double\"];\n\nconversions[\"DOMString\"] = function (V, opts) {\n    if (!opts) opts = {};\n\n    if (opts.treatNullAsEmptyString && V === null) {\n        return \"\";\n    }\n\n    return String(V);\n};\n\nconversions[\"ByteString\"] = function (V, opts) {\n    const x = String(V);\n    let c = undefined;\n    for (let i = 0; (c = x.codePointAt(i)) !== undefined; ++i) {\n        if (c > 255) {\n            throw new TypeError(\"Argument is not a valid bytestring\");\n        }\n    }\n\n    return x;\n};\n\nconversions[\"USVString\"] = function (V) {\n    const S = String(V);\n    const n = S.length;\n    const U = [];\n    for (let i = 0; i < n; ++i) {\n        const c = S.charCodeAt(i);\n        if (c < 0xD800 || c > 0xDFFF) {\n            U.push(String.fromCodePoint(c));\n        } else if (0xDC00 <= c && c <= 0xDFFF) {\n            U.push(String.fromCodePoint(0xFFFD));\n        } else {\n            if (i === n - 1) {\n                U.push(String.fromCodePoint(0xFFFD));\n            } else {\n                const d = S.charCodeAt(i + 1);\n                if (0xDC00 <= d && d <= 0xDFFF) {\n                    const a = c & 0x3FF;\n                    const b = d & 0x3FF;\n                    U.push(String.fromCodePoint((2 << 15) + (2 << 9) * a + b));\n                    ++i;\n                } else {\n                    U.push(String.fromCodePoint(0xFFFD));\n                }\n            }\n        }\n    }\n\n    return U.join('');\n};\n\nconversions[\"Date\"] = function (V, opts) {\n    if (!(V instanceof Date)) {\n        throw new TypeError(\"Argument is not a Date object\");\n    }\n    if (isNaN(V)) {\n        return undefined;\n    }\n\n    return V;\n};\n\nconversions[\"RegExp\"] = function (V, opts) {\n    if (!(V instanceof RegExp)) {\n        V = new RegExp(V);\n    }\n\n    return V;\n};\n","\"use strict\";\nconst usm = require(\"./url-state-machine\");\n\nexports.implementation = class URLImpl {\n  constructor(constructorArgs) {\n    const url = constructorArgs[0];\n    const base = constructorArgs[1];\n\n    let parsedBase = null;\n    if (base !== undefined) {\n      parsedBase = usm.basicURLParse(base);\n      if (parsedBase === \"failure\") {\n        throw new TypeError(\"Invalid base URL\");\n      }\n    }\n\n    const parsedURL = usm.basicURLParse(url, { baseURL: parsedBase });\n    if (parsedURL === \"failure\") {\n      throw new TypeError(\"Invalid URL\");\n    }\n\n    this._url = parsedURL;\n\n    // TODO: query stuff\n  }\n\n  get href() {\n    return usm.serializeURL(this._url);\n  }\n\n  set href(v) {\n    const parsedURL = usm.basicURLParse(v);\n    if (parsedURL === \"failure\") {\n      throw new TypeError(\"Invalid URL\");\n    }\n\n    this._url = parsedURL;\n  }\n\n  get origin() {\n    return usm.serializeURLOrigin(this._url);\n  }\n\n  get protocol() {\n    return this._url.scheme + \":\";\n  }\n\n  set protocol(v) {\n    usm.basicURLParse(v + \":\", { url: this._url, stateOverride: \"scheme start\" });\n  }\n\n  get username() {\n    return this._url.username;\n  }\n\n  set username(v) {\n    if (usm.cannotHaveAUsernamePasswordPort(this._url)) {\n      return;\n    }\n\n    usm.setTheUsername(this._url, v);\n  }\n\n  get password() {\n    return this._url.password;\n  }\n\n  set password(v) {\n    if (usm.cannotHaveAUsernamePasswordPort(this._url)) {\n      return;\n    }\n\n    usm.setThePassword(this._url, v);\n  }\n\n  get host() {\n    const url = this._url;\n\n    if (url.host === null) {\n      return \"\";\n    }\n\n    if (url.port === null) {\n      return usm.serializeHost(url.host);\n    }\n\n    return usm.serializeHost(url.host) + \":\" + usm.serializeInteger(url.port);\n  }\n\n  set host(v) {\n    if (this._url.cannotBeABaseURL) {\n      return;\n    }\n\n    usm.basicURLParse(v, { url: this._url, stateOverride: \"host\" });\n  }\n\n  get hostname() {\n    if (this._url.host === null) {\n      return \"\";\n    }\n\n    return usm.serializeHost(this._url.host);\n  }\n\n  set hostname(v) {\n    if (this._url.cannotBeABaseURL) {\n      return;\n    }\n\n    usm.basicURLParse(v, { url: this._url, stateOverride: \"hostname\" });\n  }\n\n  get port() {\n    if (this._url.port === null) {\n      return \"\";\n    }\n\n    return usm.serializeInteger(this._url.port);\n  }\n\n  set port(v) {\n    if (usm.cannotHaveAUsernamePasswordPort(this._url)) {\n      return;\n    }\n\n    if (v === \"\") {\n      this._url.port = null;\n    } else {\n      usm.basicURLParse(v, { url: this._url, stateOverride: \"port\" });\n    }\n  }\n\n  get pathname() {\n    if (this._url.cannotBeABaseURL) {\n      return this._url.path[0];\n    }\n\n    if (this._url.path.length === 0) {\n      return \"\";\n    }\n\n    return \"/\" + this._url.path.join(\"/\");\n  }\n\n  set pathname(v) {\n    if (this._url.cannotBeABaseURL) {\n      return;\n    }\n\n    this._url.path = [];\n    usm.basicURLParse(v, { url: this._url, stateOverride: \"path start\" });\n  }\n\n  get search() {\n    if (this._url.query === null || this._url.query === \"\") {\n      return \"\";\n    }\n\n    return \"?\" + this._url.query;\n  }\n\n  set search(v) {\n    // TODO: query stuff\n\n    const url = this._url;\n\n    if (v === \"\") {\n      url.query = null;\n      return;\n    }\n\n    const input = v[0] === \"?\" ? v.substring(1) : v;\n    url.query = \"\";\n    usm.basicURLParse(input, { url, stateOverride: \"query\" });\n  }\n\n  get hash() {\n    if (this._url.fragment === null || this._url.fragment === \"\") {\n      return \"\";\n    }\n\n    return \"#\" + this._url.fragment;\n  }\n\n  set hash(v) {\n    if (v === \"\") {\n      this._url.fragment = null;\n      return;\n    }\n\n    const input = v[0] === \"#\" ? v.substring(1) : v;\n    this._url.fragment = \"\";\n    usm.basicURLParse(input, { url: this._url, stateOverride: \"fragment\" });\n  }\n\n  toJSON() {\n    return this.href;\n  }\n};\n","\"use strict\";\n\nconst conversions = require(\"webidl-conversions\");\nconst utils = require(\"./utils.js\");\nconst Impl = require(\".//URL-impl.js\");\n\nconst impl = utils.implSymbol;\n\nfunction URL(url) {\n  if (!this || this[impl] || !(this instanceof URL)) {\n    throw new TypeError(\"Failed to construct 'URL': Please use the 'new' operator, this DOM object constructor cannot be called as a function.\");\n  }\n  if (arguments.length < 1) {\n    throw new TypeError(\"Failed to construct 'URL': 1 argument required, but only \" + arguments.length + \" present.\");\n  }\n  const args = [];\n  for (let i = 0; i < arguments.length && i < 2; ++i) {\n    args[i] = arguments[i];\n  }\n  args[0] = conversions[\"USVString\"](args[0]);\n  if (args[1] !== undefined) {\n  args[1] = conversions[\"USVString\"](args[1]);\n  }\n\n  module.exports.setup(this, args);\n}\n\nURL.prototype.toJSON = function toJSON() {\n  if (!this || !module.exports.is(this)) {\n    throw new TypeError(\"Illegal invocation\");\n  }\n  const args = [];\n  for (let i = 0; i < arguments.length && i < 0; ++i) {\n    args[i] = arguments[i];\n  }\n  return this[impl].toJSON.apply(this[impl], args);\n};\nObject.defineProperty(URL.prototype, \"href\", {\n  get() {\n    return this[impl].href;\n  },\n  set(V) {\n    V = conversions[\"USVString\"](V);\n    this[impl].href = V;\n  },\n  enumerable: true,\n  configurable: true\n});\n\nURL.prototype.toString = function () {\n  if (!this || !module.exports.is(this)) {\n    throw new TypeError(\"Illegal invocation\");\n  }\n  return this.href;\n};\n\nObject.defineProperty(URL.prototype, \"origin\", {\n  get() {\n    return this[impl].origin;\n  },\n  enumerable: true,\n  configurable: true\n});\n\nObject.defineProperty(URL.prototype, \"protocol\", {\n  get() {\n    return this[impl].protocol;\n  },\n  set(V) {\n    V = conversions[\"USVString\"](V);\n    this[impl].protocol = V;\n  },\n  enumerable: true,\n  configurable: true\n});\n\nObject.defineProperty(URL.prototype, \"username\", {\n  get() {\n    return this[impl].username;\n  },\n  set(V) {\n    V = conversions[\"USVString\"](V);\n    this[impl].username = V;\n  },\n  enumerable: true,\n  configurable: true\n});\n\nObject.defineProperty(URL.prototype, \"password\", {\n  get() {\n    return this[impl].password;\n  },\n  set(V) {\n    V = conversions[\"USVString\"](V);\n    this[impl].password = V;\n  },\n  enumerable: true,\n  configurable: true\n});\n\nObject.defineProperty(URL.prototype, \"host\", {\n  get() {\n    return this[impl].host;\n  },\n  set(V) {\n    V = conversions[\"USVString\"](V);\n    this[impl].host = V;\n  },\n  enumerable: true,\n  configurable: true\n});\n\nObject.defineProperty(URL.prototype, \"hostname\", {\n  get() {\n    return this[impl].hostname;\n  },\n  set(V) {\n    V = conversions[\"USVString\"](V);\n    this[impl].hostname = V;\n  },\n  enumerable: true,\n  configurable: true\n});\n\nObject.defineProperty(URL.prototype, \"port\", {\n  get() {\n    return this[impl].port;\n  },\n  set(V) {\n    V = conversions[\"USVString\"](V);\n    this[impl].port = V;\n  },\n  enumerable: true,\n  configurable: true\n});\n\nObject.defineProperty(URL.prototype, \"pathname\", {\n  get() {\n    return this[impl].pathname;\n  },\n  set(V) {\n    V = conversions[\"USVString\"](V);\n    this[impl].pathname = V;\n  },\n  enumerable: true,\n  configurable: true\n});\n\nObject.defineProperty(URL.prototype, \"search\", {\n  get() {\n    return this[impl].search;\n  },\n  set(V) {\n    V = conversions[\"USVString\"](V);\n    this[impl].search = V;\n  },\n  enumerable: true,\n  configurable: true\n});\n\nObject.defineProperty(URL.prototype, \"hash\", {\n  get() {\n    return this[impl].hash;\n  },\n  set(V) {\n    V = conversions[\"USVString\"](V);\n    this[impl].hash = V;\n  },\n  enumerable: true,\n  configurable: true\n});\n\n\nmodule.exports = {\n  is(obj) {\n    return !!obj && obj[impl] instanceof Impl.implementation;\n  },\n  create(constructorArgs, privateData) {\n    let obj = Object.create(URL.prototype);\n    this.setup(obj, constructorArgs, privateData);\n    return obj;\n  },\n  setup(obj, constructorArgs, privateData) {\n    if (!privateData) privateData = {};\n    privateData.wrapper = obj;\n\n    obj[impl] = new Impl.implementation(constructorArgs, privateData);\n    obj[impl][utils.wrapperSymbol] = obj;\n  },\n  interface: URL,\n  expose: {\n    Window: { URL: URL },\n    Worker: { URL: URL }\n  }\n};\n\n","\"use strict\";\n\nexports.URL = require(\"./URL\").interface;\nexports.serializeURL = require(\"./url-state-machine\").serializeURL;\nexports.serializeURLOrigin = require(\"./url-state-machine\").serializeURLOrigin;\nexports.basicURLParse = require(\"./url-state-machine\").basicURLParse;\nexports.setTheUsername = require(\"./url-state-machine\").setTheUsername;\nexports.setThePassword = require(\"./url-state-machine\").setThePassword;\nexports.serializeHost = require(\"./url-state-machine\").serializeHost;\nexports.serializeInteger = require(\"./url-state-machine\").serializeInteger;\nexports.parseURL = require(\"./url-state-machine\").parseURL;\n","\"use strict\";\r\nconst punycode = require(\"punycode\");\r\nconst tr46 = require(\"tr46\");\r\n\r\nconst specialSchemes = {\r\n  ftp: 21,\r\n  file: null,\r\n  gopher: 70,\r\n  http: 80,\r\n  https: 443,\r\n  ws: 80,\r\n  wss: 443\r\n};\r\n\r\nconst failure = Symbol(\"failure\");\r\n\r\nfunction countSymbols(str) {\r\n  return punycode.ucs2.decode(str).length;\r\n}\r\n\r\nfunction at(input, idx) {\r\n  const c = input[idx];\r\n  return isNaN(c) ? undefined : String.fromCodePoint(c);\r\n}\r\n\r\nfunction isASCIIDigit(c) {\r\n  return c >= 0x30 && c <= 0x39;\r\n}\r\n\r\nfunction isASCIIAlpha(c) {\r\n  return (c >= 0x41 && c <= 0x5A) || (c >= 0x61 && c <= 0x7A);\r\n}\r\n\r\nfunction isASCIIAlphanumeric(c) {\r\n  return isASCIIAlpha(c) || isASCIIDigit(c);\r\n}\r\n\r\nfunction isASCIIHex(c) {\r\n  return isASCIIDigit(c) || (c >= 0x41 && c <= 0x46) || (c >= 0x61 && c <= 0x66);\r\n}\r\n\r\nfunction isSingleDot(buffer) {\r\n  return buffer === \".\" || buffer.toLowerCase() === \"%2e\";\r\n}\r\n\r\nfunction isDoubleDot(buffer) {\r\n  buffer = buffer.toLowerCase();\r\n  return buffer === \"..\" || buffer === \"%2e.\" || buffer === \".%2e\" || buffer === \"%2e%2e\";\r\n}\r\n\r\nfunction isWindowsDriveLetterCodePoints(cp1, cp2) {\r\n  return isASCIIAlpha(cp1) && (cp2 === 58 || cp2 === 124);\r\n}\r\n\r\nfunction isWindowsDriveLetterString(string) {\r\n  return string.length === 2 && isASCIIAlpha(string.codePointAt(0)) && (string[1] === \":\" || string[1] === \"|\");\r\n}\r\n\r\nfunction isNormalizedWindowsDriveLetterString(string) {\r\n  return string.length === 2 && isASCIIAlpha(string.codePointAt(0)) && string[1] === \":\";\r\n}\r\n\r\nfunction containsForbiddenHostCodePoint(string) {\r\n  return string.search(/\\u0000|\\u0009|\\u000A|\\u000D|\\u0020|#|%|\\/|:|\\?|@|\\[|\\\\|\\]/) !== -1;\r\n}\r\n\r\nfunction containsForbiddenHostCodePointExcludingPercent(string) {\r\n  return string.search(/\\u0000|\\u0009|\\u000A|\\u000D|\\u0020|#|\\/|:|\\?|@|\\[|\\\\|\\]/) !== -1;\r\n}\r\n\r\nfunction isSpecialScheme(scheme) {\r\n  return specialSchemes[scheme] !== undefined;\r\n}\r\n\r\nfunction isSpecial(url) {\r\n  return isSpecialScheme(url.scheme);\r\n}\r\n\r\nfunction defaultPort(scheme) {\r\n  return specialSchemes[scheme];\r\n}\r\n\r\nfunction percentEncode(c) {\r\n  let hex = c.toString(16).toUpperCase();\r\n  if (hex.length === 1) {\r\n    hex = \"0\" + hex;\r\n  }\r\n\r\n  return \"%\" + hex;\r\n}\r\n\r\nfunction utf8PercentEncode(c) {\r\n  const buf = new Buffer(c);\r\n\r\n  let str = \"\";\r\n\r\n  for (let i = 0; i < buf.length; ++i) {\r\n    str += percentEncode(buf[i]);\r\n  }\r\n\r\n  return str;\r\n}\r\n\r\nfunction utf8PercentDecode(str) {\r\n  const input = new Buffer(str);\r\n  const output = [];\r\n  for (let i = 0; i < input.length; ++i) {\r\n    if (input[i] !== 37) {\r\n      output.push(input[i]);\r\n    } else if (input[i] === 37 && isASCIIHex(input[i + 1]) && isASCIIHex(input[i + 2])) {\r\n      output.push(parseInt(input.slice(i + 1, i + 3).toString(), 16));\r\n      i += 2;\r\n    } else {\r\n      output.push(input[i]);\r\n    }\r\n  }\r\n  return new Buffer(output).toString();\r\n}\r\n\r\nfunction isC0ControlPercentEncode(c) {\r\n  return c <= 0x1F || c > 0x7E;\r\n}\r\n\r\nconst extraPathPercentEncodeSet = new Set([32, 34, 35, 60, 62, 63, 96, 123, 125]);\r\nfunction isPathPercentEncode(c) {\r\n  return isC0ControlPercentEncode(c) || extraPathPercentEncodeSet.has(c);\r\n}\r\n\r\nconst extraUserinfoPercentEncodeSet =\r\n  new Set([47, 58, 59, 61, 64, 91, 92, 93, 94, 124]);\r\nfunction isUserinfoPercentEncode(c) {\r\n  return isPathPercentEncode(c) || extraUserinfoPercentEncodeSet.has(c);\r\n}\r\n\r\nfunction percentEncodeChar(c, encodeSetPredicate) {\r\n  const cStr = String.fromCodePoint(c);\r\n\r\n  if (encodeSetPredicate(c)) {\r\n    return utf8PercentEncode(cStr);\r\n  }\r\n\r\n  return cStr;\r\n}\r\n\r\nfunction parseIPv4Number(input) {\r\n  let R = 10;\r\n\r\n  if (input.length >= 2 && input.charAt(0) === \"0\" && input.charAt(1).toLowerCase() === \"x\") {\r\n    input = input.substring(2);\r\n    R = 16;\r\n  } else if (input.length >= 2 && input.charAt(0) === \"0\") {\r\n    input = input.substring(1);\r\n    R = 8;\r\n  }\r\n\r\n  if (input === \"\") {\r\n    return 0;\r\n  }\r\n\r\n  const regex = R === 10 ? /[^0-9]/ : (R === 16 ? /[^0-9A-Fa-f]/ : /[^0-7]/);\r\n  if (regex.test(input)) {\r\n    return failure;\r\n  }\r\n\r\n  return parseInt(input, R);\r\n}\r\n\r\nfunction parseIPv4(input) {\r\n  const parts = input.split(\".\");\r\n  if (parts[parts.length - 1] === \"\") {\r\n    if (parts.length > 1) {\r\n      parts.pop();\r\n    }\r\n  }\r\n\r\n  if (parts.length > 4) {\r\n    return input;\r\n  }\r\n\r\n  const numbers = [];\r\n  for (const part of parts) {\r\n    if (part === \"\") {\r\n      return input;\r\n    }\r\n    const n = parseIPv4Number(part);\r\n    if (n === failure) {\r\n      return input;\r\n    }\r\n\r\n    numbers.push(n);\r\n  }\r\n\r\n  for (let i = 0; i < numbers.length - 1; ++i) {\r\n    if (numbers[i] > 255) {\r\n      return failure;\r\n    }\r\n  }\r\n  if (numbers[numbers.length - 1] >= Math.pow(256, 5 - numbers.length)) {\r\n    return failure;\r\n  }\r\n\r\n  let ipv4 = numbers.pop();\r\n  let counter = 0;\r\n\r\n  for (const n of numbers) {\r\n    ipv4 += n * Math.pow(256, 3 - counter);\r\n    ++counter;\r\n  }\r\n\r\n  return ipv4;\r\n}\r\n\r\nfunction serializeIPv4(address) {\r\n  let output = \"\";\r\n  let n = address;\r\n\r\n  for (let i = 1; i <= 4; ++i) {\r\n    output = String(n % 256) + output;\r\n    if (i !== 4) {\r\n      output = \".\" + output;\r\n    }\r\n    n = Math.floor(n / 256);\r\n  }\r\n\r\n  return output;\r\n}\r\n\r\nfunction parseIPv6(input) {\r\n  const address = [0, 0, 0, 0, 0, 0, 0, 0];\r\n  let pieceIndex = 0;\r\n  let compress = null;\r\n  let pointer = 0;\r\n\r\n  input = punycode.ucs2.decode(input);\r\n\r\n  if (input[pointer] === 58) {\r\n    if (input[pointer + 1] !== 58) {\r\n      return failure;\r\n    }\r\n\r\n    pointer += 2;\r\n    ++pieceIndex;\r\n    compress = pieceIndex;\r\n  }\r\n\r\n  while (pointer < input.length) {\r\n    if (pieceIndex === 8) {\r\n      return failure;\r\n    }\r\n\r\n    if (input[pointer] === 58) {\r\n      if (compress !== null) {\r\n        return failure;\r\n      }\r\n      ++pointer;\r\n      ++pieceIndex;\r\n      compress = pieceIndex;\r\n      continue;\r\n    }\r\n\r\n    let value = 0;\r\n    let length = 0;\r\n\r\n    while (length < 4 && isASCIIHex(input[pointer])) {\r\n      value = value * 0x10 + parseInt(at(input, pointer), 16);\r\n      ++pointer;\r\n      ++length;\r\n    }\r\n\r\n    if (input[pointer] === 46) {\r\n      if (length === 0) {\r\n        return failure;\r\n      }\r\n\r\n      pointer -= length;\r\n\r\n      if (pieceIndex > 6) {\r\n        return failure;\r\n      }\r\n\r\n      let numbersSeen = 0;\r\n\r\n      while (input[pointer] !== undefined) {\r\n        let ipv4Piece = null;\r\n\r\n        if (numbersSeen > 0) {\r\n          if (input[pointer] === 46 && numbersSeen < 4) {\r\n            ++pointer;\r\n          } else {\r\n            return failure;\r\n          }\r\n        }\r\n\r\n        if (!isASCIIDigit(input[pointer])) {\r\n          return failure;\r\n        }\r\n\r\n        while (isASCIIDigit(input[pointer])) {\r\n          const number = parseInt(at(input, pointer));\r\n          if (ipv4Piece === null) {\r\n            ipv4Piece = number;\r\n          } else if (ipv4Piece === 0) {\r\n            return failure;\r\n          } else {\r\n            ipv4Piece = ipv4Piece * 10 + number;\r\n          }\r\n          if (ipv4Piece > 255) {\r\n            return failure;\r\n          }\r\n          ++pointer;\r\n        }\r\n\r\n        address[pieceIndex] = address[pieceIndex] * 0x100 + ipv4Piece;\r\n\r\n        ++numbersSeen;\r\n\r\n        if (numbersSeen === 2 || numbersSeen === 4) {\r\n          ++pieceIndex;\r\n        }\r\n      }\r\n\r\n      if (numbersSeen !== 4) {\r\n        return failure;\r\n      }\r\n\r\n      break;\r\n    } else if (input[pointer] === 58) {\r\n      ++pointer;\r\n      if (input[pointer] === undefined) {\r\n        return failure;\r\n      }\r\n    } else if (input[pointer] !== undefined) {\r\n      return failure;\r\n    }\r\n\r\n    address[pieceIndex] = value;\r\n    ++pieceIndex;\r\n  }\r\n\r\n  if (compress !== null) {\r\n    let swaps = pieceIndex - compress;\r\n    pieceIndex = 7;\r\n    while (pieceIndex !== 0 && swaps > 0) {\r\n      const temp = address[compress + swaps - 1];\r\n      address[compress + swaps - 1] = address[pieceIndex];\r\n      address[pieceIndex] = temp;\r\n      --pieceIndex;\r\n      --swaps;\r\n    }\r\n  } else if (compress === null && pieceIndex !== 8) {\r\n    return failure;\r\n  }\r\n\r\n  return address;\r\n}\r\n\r\nfunction serializeIPv6(address) {\r\n  let output = \"\";\r\n  const seqResult = findLongestZeroSequence(address);\r\n  const compress = seqResult.idx;\r\n  let ignore0 = false;\r\n\r\n  for (let pieceIndex = 0; pieceIndex <= 7; ++pieceIndex) {\r\n    if (ignore0 && address[pieceIndex] === 0) {\r\n      continue;\r\n    } else if (ignore0) {\r\n      ignore0 = false;\r\n    }\r\n\r\n    if (compress === pieceIndex) {\r\n      const separator = pieceIndex === 0 ? \"::\" : \":\";\r\n      output += separator;\r\n      ignore0 = true;\r\n      continue;\r\n    }\r\n\r\n    output += address[pieceIndex].toString(16);\r\n\r\n    if (pieceIndex !== 7) {\r\n      output += \":\";\r\n    }\r\n  }\r\n\r\n  return output;\r\n}\r\n\r\nfunction parseHost(input, isSpecialArg) {\r\n  if (input[0] === \"[\") {\r\n    if (input[input.length - 1] !== \"]\") {\r\n      return failure;\r\n    }\r\n\r\n    return parseIPv6(input.substring(1, input.length - 1));\r\n  }\r\n\r\n  if (!isSpecialArg) {\r\n    return parseOpaqueHost(input);\r\n  }\r\n\r\n  const domain = utf8PercentDecode(input);\r\n  const asciiDomain = tr46.toASCII(domain, false, tr46.PROCESSING_OPTIONS.NONTRANSITIONAL, false);\r\n  if (asciiDomain === null) {\r\n    return failure;\r\n  }\r\n\r\n  if (containsForbiddenHostCodePoint(asciiDomain)) {\r\n    return failure;\r\n  }\r\n\r\n  const ipv4Host = parseIPv4(asciiDomain);\r\n  if (typeof ipv4Host === \"number\" || ipv4Host === failure) {\r\n    return ipv4Host;\r\n  }\r\n\r\n  return asciiDomain;\r\n}\r\n\r\nfunction parseOpaqueHost(input) {\r\n  if (containsForbiddenHostCodePointExcludingPercent(input)) {\r\n    return failure;\r\n  }\r\n\r\n  let output = \"\";\r\n  const decoded = punycode.ucs2.decode(input);\r\n  for (let i = 0; i < decoded.length; ++i) {\r\n    output += percentEncodeChar(decoded[i], isC0ControlPercentEncode);\r\n  }\r\n  return output;\r\n}\r\n\r\nfunction findLongestZeroSequence(arr) {\r\n  let maxIdx = null;\r\n  let maxLen = 1; // only find elements > 1\r\n  let currStart = null;\r\n  let currLen = 0;\r\n\r\n  for (let i = 0; i < arr.length; ++i) {\r\n    if (arr[i] !== 0) {\r\n      if (currLen > maxLen) {\r\n        maxIdx = currStart;\r\n        maxLen = currLen;\r\n      }\r\n\r\n      currStart = null;\r\n      currLen = 0;\r\n    } else {\r\n      if (currStart === null) {\r\n        currStart = i;\r\n      }\r\n      ++currLen;\r\n    }\r\n  }\r\n\r\n  // if trailing zeros\r\n  if (currLen > maxLen) {\r\n    maxIdx = currStart;\r\n    maxLen = currLen;\r\n  }\r\n\r\n  return {\r\n    idx: maxIdx,\r\n    len: maxLen\r\n  };\r\n}\r\n\r\nfunction serializeHost(host) {\r\n  if (typeof host === \"number\") {\r\n    return serializeIPv4(host);\r\n  }\r\n\r\n  // IPv6 serializer\r\n  if (host instanceof Array) {\r\n    return \"[\" + serializeIPv6(host) + \"]\";\r\n  }\r\n\r\n  return host;\r\n}\r\n\r\nfunction trimControlChars(url) {\r\n  return url.replace(/^[\\u0000-\\u001F\\u0020]+|[\\u0000-\\u001F\\u0020]+$/g, \"\");\r\n}\r\n\r\nfunction trimTabAndNewline(url) {\r\n  return url.replace(/\\u0009|\\u000A|\\u000D/g, \"\");\r\n}\r\n\r\nfunction shortenPath(url) {\r\n  const path = url.path;\r\n  if (path.length === 0) {\r\n    return;\r\n  }\r\n  if (url.scheme === \"file\" && path.length === 1 && isNormalizedWindowsDriveLetter(path[0])) {\r\n    return;\r\n  }\r\n\r\n  path.pop();\r\n}\r\n\r\nfunction includesCredentials(url) {\r\n  return url.username !== \"\" || url.password !== \"\";\r\n}\r\n\r\nfunction cannotHaveAUsernamePasswordPort(url) {\r\n  return url.host === null || url.host === \"\" || url.cannotBeABaseURL || url.scheme === \"file\";\r\n}\r\n\r\nfunction isNormalizedWindowsDriveLetter(string) {\r\n  return /^[A-Za-z]:$/.test(string);\r\n}\r\n\r\nfunction URLStateMachine(input, base, encodingOverride, url, stateOverride) {\r\n  this.pointer = 0;\r\n  this.input = input;\r\n  this.base = base || null;\r\n  this.encodingOverride = encodingOverride || \"utf-8\";\r\n  this.stateOverride = stateOverride;\r\n  this.url = url;\r\n  this.failure = false;\r\n  this.parseError = false;\r\n\r\n  if (!this.url) {\r\n    this.url = {\r\n      scheme: \"\",\r\n      username: \"\",\r\n      password: \"\",\r\n      host: null,\r\n      port: null,\r\n      path: [],\r\n      query: null,\r\n      fragment: null,\r\n\r\n      cannotBeABaseURL: false\r\n    };\r\n\r\n    const res = trimControlChars(this.input);\r\n    if (res !== this.input) {\r\n      this.parseError = true;\r\n    }\r\n    this.input = res;\r\n  }\r\n\r\n  const res = trimTabAndNewline(this.input);\r\n  if (res !== this.input) {\r\n    this.parseError = true;\r\n  }\r\n  this.input = res;\r\n\r\n  this.state = stateOverride || \"scheme start\";\r\n\r\n  this.buffer = \"\";\r\n  this.atFlag = false;\r\n  this.arrFlag = false;\r\n  this.passwordTokenSeenFlag = false;\r\n\r\n  this.input = punycode.ucs2.decode(this.input);\r\n\r\n  for (; this.pointer <= this.input.length; ++this.pointer) {\r\n    const c = this.input[this.pointer];\r\n    const cStr = isNaN(c) ? undefined : String.fromCodePoint(c);\r\n\r\n    // exec state machine\r\n    const ret = this[\"parse \" + this.state](c, cStr);\r\n    if (!ret) {\r\n      break; // terminate algorithm\r\n    } else if (ret === failure) {\r\n      this.failure = true;\r\n      break;\r\n    }\r\n  }\r\n}\r\n\r\nURLStateMachine.prototype[\"parse scheme start\"] = function parseSchemeStart(c, cStr) {\r\n  if (isASCIIAlpha(c)) {\r\n    this.buffer += cStr.toLowerCase();\r\n    this.state = \"scheme\";\r\n  } else if (!this.stateOverride) {\r\n    this.state = \"no scheme\";\r\n    --this.pointer;\r\n  } else {\r\n    this.parseError = true;\r\n    return failure;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse scheme\"] = function parseScheme(c, cStr) {\r\n  if (isASCIIAlphanumeric(c) || c === 43 || c === 45 || c === 46) {\r\n    this.buffer += cStr.toLowerCase();\r\n  } else if (c === 58) {\r\n    if (this.stateOverride) {\r\n      if (isSpecial(this.url) && !isSpecialScheme(this.buffer)) {\r\n        return false;\r\n      }\r\n\r\n      if (!isSpecial(this.url) && isSpecialScheme(this.buffer)) {\r\n        return false;\r\n      }\r\n\r\n      if ((includesCredentials(this.url) || this.url.port !== null) && this.buffer === \"file\") {\r\n        return false;\r\n      }\r\n\r\n      if (this.url.scheme === \"file\" && (this.url.host === \"\" || this.url.host === null)) {\r\n        return false;\r\n      }\r\n    }\r\n    this.url.scheme = this.buffer;\r\n    this.buffer = \"\";\r\n    if (this.stateOverride) {\r\n      return false;\r\n    }\r\n    if (this.url.scheme === \"file\") {\r\n      if (this.input[this.pointer + 1] !== 47 || this.input[this.pointer + 2] !== 47) {\r\n        this.parseError = true;\r\n      }\r\n      this.state = \"file\";\r\n    } else if (isSpecial(this.url) && this.base !== null && this.base.scheme === this.url.scheme) {\r\n      this.state = \"special relative or authority\";\r\n    } else if (isSpecial(this.url)) {\r\n      this.state = \"special authority slashes\";\r\n    } else if (this.input[this.pointer + 1] === 47) {\r\n      this.state = \"path or authority\";\r\n      ++this.pointer;\r\n    } else {\r\n      this.url.cannotBeABaseURL = true;\r\n      this.url.path.push(\"\");\r\n      this.state = \"cannot-be-a-base-URL path\";\r\n    }\r\n  } else if (!this.stateOverride) {\r\n    this.buffer = \"\";\r\n    this.state = \"no scheme\";\r\n    this.pointer = -1;\r\n  } else {\r\n    this.parseError = true;\r\n    return failure;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse no scheme\"] = function parseNoScheme(c) {\r\n  if (this.base === null || (this.base.cannotBeABaseURL && c !== 35)) {\r\n    return failure;\r\n  } else if (this.base.cannotBeABaseURL && c === 35) {\r\n    this.url.scheme = this.base.scheme;\r\n    this.url.path = this.base.path.slice();\r\n    this.url.query = this.base.query;\r\n    this.url.fragment = \"\";\r\n    this.url.cannotBeABaseURL = true;\r\n    this.state = \"fragment\";\r\n  } else if (this.base.scheme === \"file\") {\r\n    this.state = \"file\";\r\n    --this.pointer;\r\n  } else {\r\n    this.state = \"relative\";\r\n    --this.pointer;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse special relative or authority\"] = function parseSpecialRelativeOrAuthority(c) {\r\n  if (c === 47 && this.input[this.pointer + 1] === 47) {\r\n    this.state = \"special authority ignore slashes\";\r\n    ++this.pointer;\r\n  } else {\r\n    this.parseError = true;\r\n    this.state = \"relative\";\r\n    --this.pointer;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse path or authority\"] = function parsePathOrAuthority(c) {\r\n  if (c === 47) {\r\n    this.state = \"authority\";\r\n  } else {\r\n    this.state = \"path\";\r\n    --this.pointer;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse relative\"] = function parseRelative(c) {\r\n  this.url.scheme = this.base.scheme;\r\n  if (isNaN(c)) {\r\n    this.url.username = this.base.username;\r\n    this.url.password = this.base.password;\r\n    this.url.host = this.base.host;\r\n    this.url.port = this.base.port;\r\n    this.url.path = this.base.path.slice();\r\n    this.url.query = this.base.query;\r\n  } else if (c === 47) {\r\n    this.state = \"relative slash\";\r\n  } else if (c === 63) {\r\n    this.url.username = this.base.username;\r\n    this.url.password = this.base.password;\r\n    this.url.host = this.base.host;\r\n    this.url.port = this.base.port;\r\n    this.url.path = this.base.path.slice();\r\n    this.url.query = \"\";\r\n    this.state = \"query\";\r\n  } else if (c === 35) {\r\n    this.url.username = this.base.username;\r\n    this.url.password = this.base.password;\r\n    this.url.host = this.base.host;\r\n    this.url.port = this.base.port;\r\n    this.url.path = this.base.path.slice();\r\n    this.url.query = this.base.query;\r\n    this.url.fragment = \"\";\r\n    this.state = \"fragment\";\r\n  } else if (isSpecial(this.url) && c === 92) {\r\n    this.parseError = true;\r\n    this.state = \"relative slash\";\r\n  } else {\r\n    this.url.username = this.base.username;\r\n    this.url.password = this.base.password;\r\n    this.url.host = this.base.host;\r\n    this.url.port = this.base.port;\r\n    this.url.path = this.base.path.slice(0, this.base.path.length - 1);\r\n\r\n    this.state = \"path\";\r\n    --this.pointer;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse relative slash\"] = function parseRelativeSlash(c) {\r\n  if (isSpecial(this.url) && (c === 47 || c === 92)) {\r\n    if (c === 92) {\r\n      this.parseError = true;\r\n    }\r\n    this.state = \"special authority ignore slashes\";\r\n  } else if (c === 47) {\r\n    this.state = \"authority\";\r\n  } else {\r\n    this.url.username = this.base.username;\r\n    this.url.password = this.base.password;\r\n    this.url.host = this.base.host;\r\n    this.url.port = this.base.port;\r\n    this.state = \"path\";\r\n    --this.pointer;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse special authority slashes\"] = function parseSpecialAuthoritySlashes(c) {\r\n  if (c === 47 && this.input[this.pointer + 1] === 47) {\r\n    this.state = \"special authority ignore slashes\";\r\n    ++this.pointer;\r\n  } else {\r\n    this.parseError = true;\r\n    this.state = \"special authority ignore slashes\";\r\n    --this.pointer;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse special authority ignore slashes\"] = function parseSpecialAuthorityIgnoreSlashes(c) {\r\n  if (c !== 47 && c !== 92) {\r\n    this.state = \"authority\";\r\n    --this.pointer;\r\n  } else {\r\n    this.parseError = true;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse authority\"] = function parseAuthority(c, cStr) {\r\n  if (c === 64) {\r\n    this.parseError = true;\r\n    if (this.atFlag) {\r\n      this.buffer = \"%40\" + this.buffer;\r\n    }\r\n    this.atFlag = true;\r\n\r\n    // careful, this is based on buffer and has its own pointer (this.pointer != pointer) and inner chars\r\n    const len = countSymbols(this.buffer);\r\n    for (let pointer = 0; pointer < len; ++pointer) {\r\n      const codePoint = this.buffer.codePointAt(pointer);\r\n\r\n      if (codePoint === 58 && !this.passwordTokenSeenFlag) {\r\n        this.passwordTokenSeenFlag = true;\r\n        continue;\r\n      }\r\n      const encodedCodePoints = percentEncodeChar(codePoint, isUserinfoPercentEncode);\r\n      if (this.passwordTokenSeenFlag) {\r\n        this.url.password += encodedCodePoints;\r\n      } else {\r\n        this.url.username += encodedCodePoints;\r\n      }\r\n    }\r\n    this.buffer = \"\";\r\n  } else if (isNaN(c) || c === 47 || c === 63 || c === 35 ||\r\n             (isSpecial(this.url) && c === 92)) {\r\n    if (this.atFlag && this.buffer === \"\") {\r\n      this.parseError = true;\r\n      return failure;\r\n    }\r\n    this.pointer -= countSymbols(this.buffer) + 1;\r\n    this.buffer = \"\";\r\n    this.state = \"host\";\r\n  } else {\r\n    this.buffer += cStr;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse hostname\"] =\r\nURLStateMachine.prototype[\"parse host\"] = function parseHostName(c, cStr) {\r\n  if (this.stateOverride && this.url.scheme === \"file\") {\r\n    --this.pointer;\r\n    this.state = \"file host\";\r\n  } else if (c === 58 && !this.arrFlag) {\r\n    if (this.buffer === \"\") {\r\n      this.parseError = true;\r\n      return failure;\r\n    }\r\n\r\n    const host = parseHost(this.buffer, isSpecial(this.url));\r\n    if (host === failure) {\r\n      return failure;\r\n    }\r\n\r\n    this.url.host = host;\r\n    this.buffer = \"\";\r\n    this.state = \"port\";\r\n    if (this.stateOverride === \"hostname\") {\r\n      return false;\r\n    }\r\n  } else if (isNaN(c) || c === 47 || c === 63 || c === 35 ||\r\n             (isSpecial(this.url) && c === 92)) {\r\n    --this.pointer;\r\n    if (isSpecial(this.url) && this.buffer === \"\") {\r\n      this.parseError = true;\r\n      return failure;\r\n    } else if (this.stateOverride && this.buffer === \"\" &&\r\n               (includesCredentials(this.url) || this.url.port !== null)) {\r\n      this.parseError = true;\r\n      return false;\r\n    }\r\n\r\n    const host = parseHost(this.buffer, isSpecial(this.url));\r\n    if (host === failure) {\r\n      return failure;\r\n    }\r\n\r\n    this.url.host = host;\r\n    this.buffer = \"\";\r\n    this.state = \"path start\";\r\n    if (this.stateOverride) {\r\n      return false;\r\n    }\r\n  } else {\r\n    if (c === 91) {\r\n      this.arrFlag = true;\r\n    } else if (c === 93) {\r\n      this.arrFlag = false;\r\n    }\r\n    this.buffer += cStr;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse port\"] = function parsePort(c, cStr) {\r\n  if (isASCIIDigit(c)) {\r\n    this.buffer += cStr;\r\n  } else if (isNaN(c) || c === 47 || c === 63 || c === 35 ||\r\n             (isSpecial(this.url) && c === 92) ||\r\n             this.stateOverride) {\r\n    if (this.buffer !== \"\") {\r\n      const port = parseInt(this.buffer);\r\n      if (port > Math.pow(2, 16) - 1) {\r\n        this.parseError = true;\r\n        return failure;\r\n      }\r\n      this.url.port = port === defaultPort(this.url.scheme) ? null : port;\r\n      this.buffer = \"\";\r\n    }\r\n    if (this.stateOverride) {\r\n      return false;\r\n    }\r\n    this.state = \"path start\";\r\n    --this.pointer;\r\n  } else {\r\n    this.parseError = true;\r\n    return failure;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nconst fileOtherwiseCodePoints = new Set([47, 92, 63, 35]);\r\n\r\nURLStateMachine.prototype[\"parse file\"] = function parseFile(c) {\r\n  this.url.scheme = \"file\";\r\n\r\n  if (c === 47 || c === 92) {\r\n    if (c === 92) {\r\n      this.parseError = true;\r\n    }\r\n    this.state = \"file slash\";\r\n  } else if (this.base !== null && this.base.scheme === \"file\") {\r\n    if (isNaN(c)) {\r\n      this.url.host = this.base.host;\r\n      this.url.path = this.base.path.slice();\r\n      this.url.query = this.base.query;\r\n    } else if (c === 63) {\r\n      this.url.host = this.base.host;\r\n      this.url.path = this.base.path.slice();\r\n      this.url.query = \"\";\r\n      this.state = \"query\";\r\n    } else if (c === 35) {\r\n      this.url.host = this.base.host;\r\n      this.url.path = this.base.path.slice();\r\n      this.url.query = this.base.query;\r\n      this.url.fragment = \"\";\r\n      this.state = \"fragment\";\r\n    } else {\r\n      if (this.input.length - this.pointer - 1 === 0 || // remaining consists of 0 code points\r\n          !isWindowsDriveLetterCodePoints(c, this.input[this.pointer + 1]) ||\r\n          (this.input.length - this.pointer - 1 >= 2 && // remaining has at least 2 code points\r\n           !fileOtherwiseCodePoints.has(this.input[this.pointer + 2]))) {\r\n        this.url.host = this.base.host;\r\n        this.url.path = this.base.path.slice();\r\n        shortenPath(this.url);\r\n      } else {\r\n        this.parseError = true;\r\n      }\r\n\r\n      this.state = \"path\";\r\n      --this.pointer;\r\n    }\r\n  } else {\r\n    this.state = \"path\";\r\n    --this.pointer;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse file slash\"] = function parseFileSlash(c) {\r\n  if (c === 47 || c === 92) {\r\n    if (c === 92) {\r\n      this.parseError = true;\r\n    }\r\n    this.state = \"file host\";\r\n  } else {\r\n    if (this.base !== null && this.base.scheme === \"file\") {\r\n      if (isNormalizedWindowsDriveLetterString(this.base.path[0])) {\r\n        this.url.path.push(this.base.path[0]);\r\n      } else {\r\n        this.url.host = this.base.host;\r\n      }\r\n    }\r\n    this.state = \"path\";\r\n    --this.pointer;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse file host\"] = function parseFileHost(c, cStr) {\r\n  if (isNaN(c) || c === 47 || c === 92 || c === 63 || c === 35) {\r\n    --this.pointer;\r\n    if (!this.stateOverride && isWindowsDriveLetterString(this.buffer)) {\r\n      this.parseError = true;\r\n      this.state = \"path\";\r\n    } else if (this.buffer === \"\") {\r\n      this.url.host = \"\";\r\n      if (this.stateOverride) {\r\n        return false;\r\n      }\r\n      this.state = \"path start\";\r\n    } else {\r\n      let host = parseHost(this.buffer, isSpecial(this.url));\r\n      if (host === failure) {\r\n        return failure;\r\n      }\r\n      if (host === \"localhost\") {\r\n        host = \"\";\r\n      }\r\n      this.url.host = host;\r\n\r\n      if (this.stateOverride) {\r\n        return false;\r\n      }\r\n\r\n      this.buffer = \"\";\r\n      this.state = \"path start\";\r\n    }\r\n  } else {\r\n    this.buffer += cStr;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse path start\"] = function parsePathStart(c) {\r\n  if (isSpecial(this.url)) {\r\n    if (c === 92) {\r\n      this.parseError = true;\r\n    }\r\n    this.state = \"path\";\r\n\r\n    if (c !== 47 && c !== 92) {\r\n      --this.pointer;\r\n    }\r\n  } else if (!this.stateOverride && c === 63) {\r\n    this.url.query = \"\";\r\n    this.state = \"query\";\r\n  } else if (!this.stateOverride && c === 35) {\r\n    this.url.fragment = \"\";\r\n    this.state = \"fragment\";\r\n  } else if (c !== undefined) {\r\n    this.state = \"path\";\r\n    if (c !== 47) {\r\n      --this.pointer;\r\n    }\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse path\"] = function parsePath(c) {\r\n  if (isNaN(c) || c === 47 || (isSpecial(this.url) && c === 92) ||\r\n      (!this.stateOverride && (c === 63 || c === 35))) {\r\n    if (isSpecial(this.url) && c === 92) {\r\n      this.parseError = true;\r\n    }\r\n\r\n    if (isDoubleDot(this.buffer)) {\r\n      shortenPath(this.url);\r\n      if (c !== 47 && !(isSpecial(this.url) && c === 92)) {\r\n        this.url.path.push(\"\");\r\n      }\r\n    } else if (isSingleDot(this.buffer) && c !== 47 &&\r\n               !(isSpecial(this.url) && c === 92)) {\r\n      this.url.path.push(\"\");\r\n    } else if (!isSingleDot(this.buffer)) {\r\n      if (this.url.scheme === \"file\" && this.url.path.length === 0 && isWindowsDriveLetterString(this.buffer)) {\r\n        if (this.url.host !== \"\" && this.url.host !== null) {\r\n          this.parseError = true;\r\n          this.url.host = \"\";\r\n        }\r\n        this.buffer = this.buffer[0] + \":\";\r\n      }\r\n      this.url.path.push(this.buffer);\r\n    }\r\n    this.buffer = \"\";\r\n    if (this.url.scheme === \"file\" && (c === undefined || c === 63 || c === 35)) {\r\n      while (this.url.path.length > 1 && this.url.path[0] === \"\") {\r\n        this.parseError = true;\r\n        this.url.path.shift();\r\n      }\r\n    }\r\n    if (c === 63) {\r\n      this.url.query = \"\";\r\n      this.state = \"query\";\r\n    }\r\n    if (c === 35) {\r\n      this.url.fragment = \"\";\r\n      this.state = \"fragment\";\r\n    }\r\n  } else {\r\n    // TODO: If c is not a URL code point and not \"%\", parse error.\r\n\r\n    if (c === 37 &&\r\n      (!isASCIIHex(this.input[this.pointer + 1]) ||\r\n        !isASCIIHex(this.input[this.pointer + 2]))) {\r\n      this.parseError = true;\r\n    }\r\n\r\n    this.buffer += percentEncodeChar(c, isPathPercentEncode);\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse cannot-be-a-base-URL path\"] = function parseCannotBeABaseURLPath(c) {\r\n  if (c === 63) {\r\n    this.url.query = \"\";\r\n    this.state = \"query\";\r\n  } else if (c === 35) {\r\n    this.url.fragment = \"\";\r\n    this.state = \"fragment\";\r\n  } else {\r\n    // TODO: Add: not a URL code point\r\n    if (!isNaN(c) && c !== 37) {\r\n      this.parseError = true;\r\n    }\r\n\r\n    if (c === 37 &&\r\n        (!isASCIIHex(this.input[this.pointer + 1]) ||\r\n         !isASCIIHex(this.input[this.pointer + 2]))) {\r\n      this.parseError = true;\r\n    }\r\n\r\n    if (!isNaN(c)) {\r\n      this.url.path[0] = this.url.path[0] + percentEncodeChar(c, isC0ControlPercentEncode);\r\n    }\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse query\"] = function parseQuery(c, cStr) {\r\n  if (isNaN(c) || (!this.stateOverride && c === 35)) {\r\n    if (!isSpecial(this.url) || this.url.scheme === \"ws\" || this.url.scheme === \"wss\") {\r\n      this.encodingOverride = \"utf-8\";\r\n    }\r\n\r\n    const buffer = new Buffer(this.buffer); // TODO: Use encoding override instead\r\n    for (let i = 0; i < buffer.length; ++i) {\r\n      if (buffer[i] < 0x21 || buffer[i] > 0x7E || buffer[i] === 0x22 || buffer[i] === 0x23 ||\r\n          buffer[i] === 0x3C || buffer[i] === 0x3E) {\r\n        this.url.query += percentEncode(buffer[i]);\r\n      } else {\r\n        this.url.query += String.fromCodePoint(buffer[i]);\r\n      }\r\n    }\r\n\r\n    this.buffer = \"\";\r\n    if (c === 35) {\r\n      this.url.fragment = \"\";\r\n      this.state = \"fragment\";\r\n    }\r\n  } else {\r\n    // TODO: If c is not a URL code point and not \"%\", parse error.\r\n    if (c === 37 &&\r\n      (!isASCIIHex(this.input[this.pointer + 1]) ||\r\n        !isASCIIHex(this.input[this.pointer + 2]))) {\r\n      this.parseError = true;\r\n    }\r\n\r\n    this.buffer += cStr;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nURLStateMachine.prototype[\"parse fragment\"] = function parseFragment(c) {\r\n  if (isNaN(c)) { // do nothing\r\n  } else if (c === 0x0) {\r\n    this.parseError = true;\r\n  } else {\r\n    // TODO: If c is not a URL code point and not \"%\", parse error.\r\n    if (c === 37 &&\r\n      (!isASCIIHex(this.input[this.pointer + 1]) ||\r\n        !isASCIIHex(this.input[this.pointer + 2]))) {\r\n      this.parseError = true;\r\n    }\r\n\r\n    this.url.fragment += percentEncodeChar(c, isC0ControlPercentEncode);\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nfunction serializeURL(url, excludeFragment) {\r\n  let output = url.scheme + \":\";\r\n  if (url.host !== null) {\r\n    output += \"//\";\r\n\r\n    if (url.username !== \"\" || url.password !== \"\") {\r\n      output += url.username;\r\n      if (url.password !== \"\") {\r\n        output += \":\" + url.password;\r\n      }\r\n      output += \"@\";\r\n    }\r\n\r\n    output += serializeHost(url.host);\r\n\r\n    if (url.port !== null) {\r\n      output += \":\" + url.port;\r\n    }\r\n  } else if (url.host === null && url.scheme === \"file\") {\r\n    output += \"//\";\r\n  }\r\n\r\n  if (url.cannotBeABaseURL) {\r\n    output += url.path[0];\r\n  } else {\r\n    for (const string of url.path) {\r\n      output += \"/\" + string;\r\n    }\r\n  }\r\n\r\n  if (url.query !== null) {\r\n    output += \"?\" + url.query;\r\n  }\r\n\r\n  if (!excludeFragment && url.fragment !== null) {\r\n    output += \"#\" + url.fragment;\r\n  }\r\n\r\n  return output;\r\n}\r\n\r\nfunction serializeOrigin(tuple) {\r\n  let result = tuple.scheme + \"://\";\r\n  result += serializeHost(tuple.host);\r\n\r\n  if (tuple.port !== null) {\r\n    result += \":\" + tuple.port;\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nmodule.exports.serializeURL = serializeURL;\r\n\r\nmodule.exports.serializeURLOrigin = function (url) {\r\n  // https://url.spec.whatwg.org/#concept-url-origin\r\n  switch (url.scheme) {\r\n    case \"blob\":\r\n      try {\r\n        return module.exports.serializeURLOrigin(module.exports.parseURL(url.path[0]));\r\n      } catch (e) {\r\n        // serializing an opaque origin returns \"null\"\r\n        return \"null\";\r\n      }\r\n    case \"ftp\":\r\n    case \"gopher\":\r\n    case \"http\":\r\n    case \"https\":\r\n    case \"ws\":\r\n    case \"wss\":\r\n      return serializeOrigin({\r\n        scheme: url.scheme,\r\n        host: url.host,\r\n        port: url.port\r\n      });\r\n    case \"file\":\r\n      // spec says \"exercise to the reader\", chrome says \"file://\"\r\n      return \"file://\";\r\n    default:\r\n      // serializing an opaque origin returns \"null\"\r\n      return \"null\";\r\n  }\r\n};\r\n\r\nmodule.exports.basicURLParse = function (input, options) {\r\n  if (options === undefined) {\r\n    options = {};\r\n  }\r\n\r\n  const usm = new URLStateMachine(input, options.baseURL, options.encodingOverride, options.url, options.stateOverride);\r\n  if (usm.failure) {\r\n    return \"failure\";\r\n  }\r\n\r\n  return usm.url;\r\n};\r\n\r\nmodule.exports.setTheUsername = function (url, username) {\r\n  url.username = \"\";\r\n  const decoded = punycode.ucs2.decode(username);\r\n  for (let i = 0; i < decoded.length; ++i) {\r\n    url.username += percentEncodeChar(decoded[i], isUserinfoPercentEncode);\r\n  }\r\n};\r\n\r\nmodule.exports.setThePassword = function (url, password) {\r\n  url.password = \"\";\r\n  const decoded = punycode.ucs2.decode(password);\r\n  for (let i = 0; i < decoded.length; ++i) {\r\n    url.password += percentEncodeChar(decoded[i], isUserinfoPercentEncode);\r\n  }\r\n};\r\n\r\nmodule.exports.serializeHost = serializeHost;\r\n\r\nmodule.exports.cannotHaveAUsernamePasswordPort = cannotHaveAUsernamePasswordPort;\r\n\r\nmodule.exports.serializeInteger = function (integer) {\r\n  return String(integer);\r\n};\r\n\r\nmodule.exports.parseURL = function (input, options) {\r\n  if (options === undefined) {\r\n    options = {};\r\n  }\r\n\r\n  // We don't handle blobs, so this just delegates:\r\n  return module.exports.basicURLParse(input, { baseURL: options.baseURL, encodingOverride: options.encodingOverride });\r\n};\r\n","\"use strict\";\n\nmodule.exports.mixin = function mixin(target, source) {\n  const keys = Object.getOwnPropertyNames(source);\n  for (let i = 0; i < keys.length; ++i) {\n    Object.defineProperty(target, keys[i], Object.getOwnPropertyDescriptor(source, keys[i]));\n  }\n};\n\nmodule.exports.wrapperSymbol = Symbol(\"wrapper\");\nmodule.exports.implSymbol = Symbol(\"impl\");\n\nmodule.exports.wrapperForImpl = function (impl) {\n  return impl[module.exports.wrapperSymbol];\n};\n\nmodule.exports.implForWrapper = function (wrapper) {\n  return wrapper[module.exports.implSymbol];\n};\n\n","// Returns a wrapper function that returns a wrapped callback\n// The wrapper function should do some stuff, and return a\n// presumably different callback function.\n// This makes sure that own properties are retained, so that\n// decorations and such are not lost along the way.\nmodule.exports = wrappy\nfunction wrappy (fn, cb) {\n  if (fn && cb) return wrappy(fn)(cb)\n\n  if (typeof fn !== 'function')\n    throw new TypeError('need wrapper function')\n\n  Object.keys(fn).forEach(function (k) {\n    wrapper[k] = fn[k]\n  })\n\n  return wrapper\n\n  function wrapper() {\n    var args = new Array(arguments.length)\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i]\n    }\n    var ret = fn.apply(this, args)\n    var cb = args[args.length-1]\n    if (typeof ret === 'function' && ret !== cb) {\n      Object.keys(cb).forEach(function (k) {\n        ret[k] = cb[k]\n      })\n    }\n    return ret\n  }\n}\n","module.exports = require(\"vscode\");","module.exports = require(\"buffer\");","module.exports = require(\"crypto\");","module.exports = require(\"fs\");","module.exports = require(\"path\");","module.exports = require(\"punycode\");","module.exports = require(\"stream\");","module.exports = require(\"string_decoder\");","module.exports = require(\"util\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"feature-\" + \"heatmap-chroma\" + \".js\";\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"loaded\", otherwise not loaded yet\nvar installedChunks = {\n\t179: 1\n};\n\n// no on chunks loaded\n\nvar installChunk = (chunk) => {\n\tvar moreModules = chunk.modules, chunkIds = chunk.ids, runtime = chunk.runtime;\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\tfor(var i = 0; i < chunkIds.length; i++)\n\t\tinstalledChunks[chunkIds[i]] = 1;\n\n};\n\n// require() chunk loading for javascript\n__webpack_require__.f.require = (chunkId, promises) => {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\tinstallChunk(require(\"./\" + __webpack_require__.u(chunkId)));\n\t\t} else installedChunks[chunkId] = 1;\n\t}\n};\n\n// no external install chunk\n\n// no HMR\n\n// no HMR manifest","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(7820);\n"],"sourceRoot":""}