#!/bin/sh
#
# Updates all git repositories in a directory.
# Optional `-s` argument for safe mode (requires input for each update).

while getopts ":s" opt; do
    case $opt in
        s) SAFE_MODE=true ;;
        \?) "Invalid option: -$OPTARG" >&2 ;;
    esac
done

for dir in $(ls -d */); do
    if [[ $SAFE_MODE ]]; then
        read -p "Update $dir?" -n 1 -r
        echo
    fi
    if [[ $REPLY =~ ^[Yy]$ || -z "$SAFE_MODE" ]]; then
        cd $dir
        git pu
        cd ../
    fi
done

